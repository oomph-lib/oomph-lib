<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
<title>oomph-lib: driven_cavity.txt_doxygenified.h Source File</title>
<link rel="apple-touch-icon" sizes="57x57" href="../../../figures/apple-touch-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="../../../figures/apple-touch-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="../../../figures/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="../../../figures/apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="../../../figures/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="../../../figures/apple-touch-icon-120x120.png">
<link rel="icon" type="image/png" href="../../../figures/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="../../../figures/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="../../../figures/favicon-16x16.png" sizes="16x16">
<link rel="manifest" href="../../../figures/manifest.json">
<link rel="mask-icon" href="../../../figures/safari-pinned-tab.svg" color="#008000">
<link rel="shortcut icon" href="../../../figures/favicon.ico">
<meta name="msapplication-TileColor" content="#00a300">
<meta name="msapplication-config" content="../../../figures/browserconfig.xml">
<meta name="theme-color" content="#008000">
<link href="http://fonts.googleapis.com/css?family=Open+Sans:400,300,600" rel="stylesheet" type="text/css">
<!-- Doxygen css-->
<!-- <link rel="stylesheet" type="text/css" href="doxygen.css"> -->
<!-- Bootstrap -->
<link href="../../../css/bootstrap.css" rel="stylesheet">
<!-- oomph-lib specific overrides -->
<link rel="stylesheet" type="text/css" href="../../../css/oomph_header.css">
</head>
<body>
<nav class="navbar navbar-default">
<div class="container">
<div class="container-fluid">
  <!-- Brand and toggle get grouped for better mobile display -->
  <div class="navbar-header">
    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
      <span class="sr-only">Toggle navigation</span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="../../../html/index.html"><img alt="oomph-lib" src="../../../figures/oomph_logo.png"></a>
  </div>
  <!-- Collect the nav links, forms, and other content for toggling -->
  <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
    <ul class="nav navbar-nav">          
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Documentation <span class="caret"></span></a>
        <ul class="dropdown-menu">
          <li class="dropdown-header">Big picture</li>
          <li><a href="../../../../doc/intro/html/index.html">The finite element method</a></li>
          <li><a href="../../../../doc/the_data_structure/html/index.html">The data structure</a></li>
          <li><a href="../../../../doc/quick_guide/html/index.html">Not-so-quick guide</a></li>
          <li><a href="../../../../doc/optimisation/html/index.html">Optimisation</a></li>
          <li><a href="../../../../doc/order_of_action_functions/html/index.html">Order of action functions</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Example codes and tutorials</li>
          <li><a href="../../../../doc/example_code_list/html/index.html">List of example codes and tutorials</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#meshes">Meshing</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#solvers">Solvers</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#parallel">MPI parallel processing</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#visualisation">Post-processing/visualisation</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Other</li>
          <li><a href="../../../../doc/change_log/html/index.html">Change log</a></li>
          <li><a href="../../../../doc/creating_doc/html/index.html">Creating documentation</a></li>
          <li><a href="../../../../doc/coding_conventions/html/index.html">Coding conventions</a></li>
          <li><a href="../../../../doc/index/html/index.html">Index</a></li>
          <li><a href="../../../../doc/FAQ/html/index.html">FAQ</a></li>
        </ul>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Get it <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../../doc/the_distribution/html/index.html">Installation guide</a></li>
            <li><a href="../../../../doc/subversion/html/index.html">Get code from subversion repository</a></li>
            <li><a href="../../../../doc/download/html/index.html">Get code as tar file</a></li>
            <li><a href="../../../../doc/copyright/html/index.html">Copyright</a></li>
          </ul>
        </li>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">About <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../../doc/people/html/index.html">People</a></li>            
            <li><a href="../../../../doc/contact/html/index.html">Contact/Get involved</a></li>
            <li><a href="../../../../doc/publications/html/index.html">Publications</a></li>
            <li><a href="../../../../doc/acknowledgements/html/index.html">Acknowledgements</a></li>
            <li><a href="../../../../doc/picture_show/index.html">Picture show</a></li>
          </ul>
        </li>
      </li>
    </ul>
    <ul class="nav navbar-nav navbar-right navbar-search">
      <form class="navbar-form" role="search" action="../../../../doc/search_results/html/index.html">
        <div class="input-group">
          <input type="text" class="form-control" placeholder="Search" name="q">
          <span class="input-group-btn">
            <button class="btn btn-default" type="submit">Go</button>
          </span>
        </div><!-- /input-group -->
       <!--<div class="form-group">
          <input type="text" class="form-control" placeholder="Search">
        </div>
        <button type="submit" class="btn btn-default">Submit</button>-->
      </form>
    </ul>
  </div><!-- /.navbar-collapse -->
</div><!-- /.container-fluid -->
</div>
</nav>
<!-- Generated by Doxygen 1.8.17 -->
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">driven_cavity.txt_doxygenified.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="driven__cavity_8txt__doxygenified_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">\mainpage Example problem: The 2D Driven Cavity Problem</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">This is our first Navier-Stokes example problem. We discuss the</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">non-dimensionalisation of the equations and their implementation in \c</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">oomph-lib, and demonstrate the solution of the 2D driven cavity</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">problem. </span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">\section equation The Navier-Stokes equations</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">In dimensional form the 2D [3D] Navier-Stokes equations (in cartesian</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">coordinates \f$ x_i^*; \ i=1,2 [,3] \f$) are given by the momentum equations</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">&lt;CENTER&gt;</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">\rho\left(\frac{\partial u_i^*}{\partial t^*} + </span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">u_j^*\frac{\partial u_i^*}{\partial x_j^*}\right) </span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">=</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">- \frac{\partial p^*}{\partial x_i^*} + </span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">B_i^*(x_j^*,t^*) + \rho \, G^*_i +</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">\frac{\partial }{\partial x_j^*} \left[ \mu\left(</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">\frac{\partial u_i^*}{\partial x_j^*} +  </span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">\frac{\partial u_j^*}{\partial x_i^*} \right) \right],</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment">&lt;/CENTER&gt;</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment">and the continuity equation</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">&lt;CENTER&gt;</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment">\frac{\partial u_i^*}{\partial x_i^*} = Q^*,</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment">&lt;/CENTER&gt;</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment">where we have used index notation and the summation convention. </span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment">Here, the velocity components are denoted by \f$ u_i^* \f$,</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment">the pressure by \f$ p^* \f$, and time by \f$ t^* \f$, and we</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment">have split the body force into two components: A constant</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment">vector \f$ \rho \, G_i^* \f$ which typically represents gravitational</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment">forces; and a variable body force, \f$ B_i^*(x^*_j,t^*) \f$.</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment">\f$ Q^*(x^*_j,t^*) \f$ is a volumetric source term for the continuity equation </span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment">and is typically equal to zero.</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment">We non-dimensionalise the equations, using problem-specific reference</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment">quantities for the velocity, \f$ {\cal U},\f$ length, \f$</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment">{\cal L}, \f$ and time, \f${\cal T},\f$ and </span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment">scale the constant body force vector on the gravitational</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment">acceleration, \f$g, \f$ so that</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment">&lt;CENTER&gt;</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment">u_i^* = {\cal U} \, u_i, \qquad        </span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment">x_i^* = {\cal L}\, x_i, \qquad        </span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment">t^* = {\cal T}\, t,     \qquad</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment">G_i^* = g \, G_i,</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment">p^* = \frac{\mu_{ref} {\cal U}}{{\cal L}} \, p, \qquad</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment">B_i^* = \frac{{\cal U}\mu_{ref}}{{\cal L}^2} \, B_i, \qquad </span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment"> Q^* = \frac{{\cal U}}{{\cal L}}\, Q, \qquad</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment">&lt;/CENTER&gt;</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment">where we note that the pressure and the variable body force have </span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment">been non-dimensionalised on the viscous scale.</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment">\f$ \mu_{ref} \f$ and \f$ \rho_{ref} \f$ (used below) are reference values </span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment">for the fluid viscosity and density, respectively. In single-fluid</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment">problems, they are identical to the viscosity \f$ \mu \f$ and </span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="comment">density \f$ \rho \f$ of the (one and only) fluid in the problem.</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="comment">The non-dimensional form of the Navier-Stokes equations</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment">is then given by</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="comment">&lt;CENTER&gt;</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="comment">R_\rho Re \left( St \frac{\partial u_i}{\partial t} + </span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="comment">u_j \frac{\partial u_i}{\partial x_j} \right) =</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="comment">- \frac{\partial p}{\partial x_i}  + B_i(x_j,t) +</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="comment">R_\rho \frac{Re}{Fr} G_i +</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="comment">\frac{\partial }{\partial x_j} \left[  R_\mu \left(</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="comment">\frac{\partial u_i}{\partial x_j} +  </span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment">\frac{\partial u_j}{\partial x_i} \right) \right],</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="comment">&lt;/CENTER&gt;</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="comment">and</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="comment">&lt;CENTER&gt;</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="comment">\frac{\partial u_i}{\partial x_i} = Q,</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="comment">&lt;/CENTER&gt;</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="comment">where the dimensionless parameters</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="comment">&lt;CENTER&gt;</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="comment">Re = \frac{{\cal U}{\cal L}\rho_{ref}}{\mu_{ref}}, \qquad </span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="comment">St = \frac{{\cal L}}{{\cal U}{\cal T}}, \qquad </span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment">Fr = \frac{{\cal U}^2}{g{\cal L}},</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="comment">&lt;/CENTER&gt;</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="comment">are the Reynolds number, Strouhal number and Froude number</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="comment">respectively. \f$ R_\rho=\rho/\rho_{ref} \f$ and </span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="comment">\f$ R_\mu =\mu/\mu_{ref}\f$ represent the ratios</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="comment">of the fluid&#39;s density and its dynamic viscosity, relative to the</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="comment">density and viscosity values used to form the non-dimensional</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="comment">parameters (By default, \f$ R_\rho  = R_\mu = 1 \f$; other values</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="comment">tend to be used in problems involving multiple fluids). </span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="comment">The above equations are typically augmented by Dirichlet boundary conditions</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="comment">for (some of) the velocity components. On boundaries where </span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="comment">no velocity boundary conditions are applied, the flow satisfies the</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="comment">&quot;traction free&quot; natural boundary condition</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="comment">\f$ t_i = -p \, n_i + R_\mu (\partial u_i/\partial x_j + </span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="comment">\partial u_j/\partial x_i ) \, n_j = 0. \f$ </span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="comment">(We refer to &lt;A HREF=&quot;../../rayleigh_traction_channel/html/index.html&quot;&gt; another</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="comment">example &lt;/A&gt; for an illustration of how to apply traction  boundary</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="comment">conditions for  the Navier-Stokes equations.)</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="comment">If the velocity is prescribed along the entire domain boundary, </span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="comment">the fluid pressure \f$ p \f$ is only determined up to an arbitrary</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="comment">constant. This indeterminacy may be overcome by prescribing the </span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="comment">value of the pressure at a single point in the domain (see </span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="comment">&lt;A HREF=&quot;#exercises&quot;&gt; exercise&lt;/A&gt;).</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="comment">\section element_types Implementation </span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="comment">\subsection el The elements</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="comment">\c oomph-lib provides two LBB-stable isoparametric Navier-Stokes </span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="comment">elements that are based on the \c QElement&lt;DIM,3&gt; family of </span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="comment">geometric finite elements. They are nine-node quadrilateral</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="comment">(for \c DIM=2), and 27-node brick (for \c DIM=3) elements  in which</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="comment">the mapping between local and global (Eulerian) coordinates</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="comment">is given by</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="comment">&lt;CENTER&gt;</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="comment">x_i = \sum_{j=1}^{N^{(E)}} X^{(E)}_{ij} \, \psi_j, \qquad</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="comment">i=1,2\quad [\mbox{and }3].</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="comment">&lt;/CENTER&gt;</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="comment">Here \f$ N^{(E)} = 3^{DIM}\f$ is the number of nodes in the element, \f$ X^{(E)}_{ij} \f$ is the \f$ i \f$-th global (Eulerian) coordinate</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="comment">of the \f$ j \f$-th \c Node in the element, and the \f$ \psi_j \f$ </span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="comment">are the element&#39;s geometric shape functions, defined in the \c QElement&lt;DIM,3&gt;</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="comment">class.</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="comment">In both elements the velocity components \f$ u_1, \f$ \f$ u_2, \f$ </span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="comment">[and \f$ u_3 \f$] are stored as nodal values and the geometric</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="comment">shape functions are used to interpolate the velocities inside the</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="comment">element, </span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="comment">&lt;CENTER&gt;</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="comment">u_i = \sum_{j=1}^{N^{(E)}} U^{(E)}_{ij} \, \psi_j, \qquad </span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="comment">i=1,2\quad [\mbox{and }3],</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="comment">&lt;/CENTER&gt;</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="comment">where \f$  U^{(E)}_{ij} \f$  is the \f$ i \f$-th velocity component </span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="comment">at \f$ j \f$-th \c Node in the element. Nodal values of the velocity </span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="comment">components are accessible via the access function</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="comment">\code</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="comment">NavierStokesEquations&lt;DIM&gt;::u(i,j)</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="comment">\endcode</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="comment">which returns the \c i-th velocity component stored at the element&#39;s </span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="comment">\c j-th \c Node.</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="comment">The two elements differ in the way in which the pressure is</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="comment">represented:</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="comment">\subsubsection CR Crouzeix-Raviart elements</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="comment">In \c oomph-lib&#39;s \c QCrouzeixRaviartElements the pressure</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="comment">is represented by,</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;<span class="comment">&lt;CENTER&gt;</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="comment">p = P_0^{(E)} + P_1^{(E)} \, s_1 + P_2^{(E)} \, s_2 </span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="comment">\quad \left[+ P_3^{(E)}  \, s_3\right],</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="comment">&lt;/CENTER&gt;</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="comment">where the \f$ s_i \in [-1,1]\f$ are the element&#39;s local coordinates.</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="comment">This provides a discontinuous, piecewise bi-[tri-]linear</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;<span class="comment">representation of the pressure in terms of 3 [4] pressure degrees</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="comment">of freedom per element.  Crouzeix-Raviart elements ensure that the </span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<span class="comment">continuity equation is satisfied within each element.</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<span class="comment">The pressure degrees of freedom are local to the element and are </span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="comment">stored in the element&#39;s internal \c Data. They are accessible</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="comment">via the member function</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="comment">\code</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="comment">QCrouzeixRaviartElement&lt;DIM&gt;::p(j)</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="comment">\endcode</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="comment">which returns the value of the \c j-th pressure degree of freedom </span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="comment">in this element.</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="comment">Each \c Node in a 2D [3D] Crouzeix-Raviart element stores 2 [3] nodal</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="comment">values, representing the two [three] velocity components at that \c Node.</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="comment">\subsubsection TH Taylor-Hood elements</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="comment">In \c oomph-lib&#39;s \c QTaylorHoodElements the pressure</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="comment">is represented by a globally-continuous, piecewise bi-[tri-]linear</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="comment">interpolation between the pressure values \f$ P_j^{(E)} \f$ </span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="comment">that are stored at the elements&#39; \f$ N_p^{(E)} = 2^{DIM}\f$</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="comment">corner/vertex nodes,</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="comment">&lt;CENTER&gt;</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="comment">p = \sum_{j=1}^{N_p^{(E)}} P_j^{(E)} \, \psi_j^{(p)},</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="comment">&lt;/CENTER&gt;</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;<span class="comment">where the \f$\psi_j^{(p)}\f$ are the bi-[tri-]linear pressure shape functions.</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="comment">The first 2 [3] values of each \c Node in a 2D [3D] Taylor-Hood element store</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="comment">the two [three] velocity components at that \c Node. The corner</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="comment">[vertex] nodes store an additional value which represents the</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="comment">pressure at that \c Node. The access function </span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="comment">\code</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="comment">QTaylorHoodElement&lt;DIM&gt;::p(j)</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="comment">\endcode</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="comment">returns the nodal pressure value at the element&#39;s \c j-th corner</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<span class="comment">[vertex] \c Node.</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="comment">In sufficiently fine meshes, Taylor-Hood elements generate a </span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;<span class="comment">much smaller number of pressure degrees of freedom than the </span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;<span class="comment">corresponding Crouzeix-Raviart elements. However, Taylor-Hood elements </span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="comment">do not conserve mass locally. </span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;<span class="comment">\section params Non-dimensional parameters and their default values</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="comment">The Reynolds number, Strouhal number, inverse-Froude number, density</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;<span class="comment">ratio and viscosity ratio are assumed to be constant within</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="comment">each element. Their values are accessed via pointers which are</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="comment">accessible via the member functions \c</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="comment">re_pt() for \f$ Re, \f$ \c re_st_pt() for \f$ Re \ St, \f$ \c</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="comment">re_invfr_pt() for \f$ Re/Fr, \f$ \c density_ratio_pt() for \f$ R_\rho \f$</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="comment">and \c viscosity_ratio_pt() for \f$ R_\mu \f$.</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;<span class="comment">By default the pointers point to default values (implemented as</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;<span class="comment">static member data in the \c NavierStokesEquations class), therefore</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;<span class="comment">they only need to be over-written if the default values</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;<span class="comment">are not appropriate. The default values are:</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;<span class="comment">- Default Reynolds number:</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;<span class="comment">Re = 0 \mbox{\ \ \ \ (Stokes flow)}</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;<span class="comment">\f] </span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;<span class="comment">- Default Womersley number (product of Reynolds and Strouhal number):</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;<span class="comment">Re St = 0 \mbox{\ \ \ \ (steady flow)}</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="comment">- Default product of Reynolds and inverse Froude number (a measure of</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="comment">gravity on the viscous scale)</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="comment">Re/Fr = 0 \mbox{\ \ \ \ (no gravity)}</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="comment">- Default viscosity ratio:</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="comment">R_\mu = 1 \mbox{\ \ \ \ (viscosity = viscosity used in the definition</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="comment">of $Re$)}</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;<span class="comment">- Default density ratio:</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;<span class="comment">R_\rho = 1 \mbox{\ \ \ \ (density = density used in the definition</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;<span class="comment">of $Re$)}</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;<span class="comment">.</span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;<span class="comment">We use the same approach for the specification of the body force</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;<span class="comment">vector \f$ G_i \f$, accessible via the function \c g_pt (),</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;<span class="comment">the variable body force \f$ B_i \f$, accessible via the </span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;<span class="comment">function pointer \c body_force_fct_pt(), and the volumetric</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<span class="comment">source function \f$ Q \f$, accessible via the function pointer \c</span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;<span class="comment">source_fct_pt(time,x). By default the (function) pointers are set</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;<span class="comment">such that </span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;<span class="comment">- Default gravity vector:</span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;<span class="comment">G_i = 0 \mbox{\ \ \ \ (no gravity)}</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;<span class="comment">\f] </span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;<span class="comment">- Default body force function:</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;<span class="comment">B_i(x_j,t) = 0 \mbox{\ \ \ \ (no body force)}</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;<span class="comment">\f] </span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;<span class="comment">- Default volumetric source function</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<span class="comment">Q(x_j,t) = 0 \mbox{\ \ \ \ (flow is divergence free)}</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;<span class="comment">\f] </span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;<span class="comment">.</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="comment">\section example The example problem</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;<span class="comment">We will illustrate the solution of the steady 2D Navier-Stokes</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="comment">equations using the well-known example of the driven cavity.</span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;<span class="comment">&lt;CENTER&gt;</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;<span class="comment">&lt;TABLE&gt;</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;<span class="comment">&lt;TR&gt; </span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;<span class="comment">&lt;TD&gt;</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;<span class="comment">&lt;CENTER&gt;</span></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;<span class="comment">&lt;B&gt;The 2D steady driven-cavity problem in a square domain.&lt;/B&gt;</span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;<span class="comment">&lt;/CENTER&gt; </span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;<span class="comment">Solve</span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<span class="comment">Re\phantom{i}u_j\frac{\partial u_i}{\partial x_j} =</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="comment">- \frac{\partial p}{\partial x_i} +</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="comment">\frac{\partial }{\partial x_j} \left(</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<span class="comment">\frac{\partial u_i}{\partial x_j} +  </span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="comment">\frac{\partial u_j}{\partial x_i} \right),</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="comment"> \ \ \ \ \ \ \ \ \ \ (1)</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;<span class="comment">and</span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;<span class="comment">\frac{\partial u_i}{\partial x_i} = 0,</span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;<span class="comment">in the square domain \f$ D = \{x_i \in [0,1]; i=1,2 \} \f$,</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;<span class="comment">subject to the Dirichlet boundary conditions:</span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;<span class="comment">\left. \mathbf{u}\right|_{\partial D}=(0,0),</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;<span class="comment">\ \ \ \ \ \ \ \ \ \ (2)</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;<span class="comment">on the right, top and left boundaries and </span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;<span class="comment">\left. \mathbf{u}\right|_{\partial D}=(1,0),</span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;<span class="comment">\ \ \ \ \ \ \ \ \ \ (3)</span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="comment">on the bottom boundary, \f$ x_2=0.\f$</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;<span class="comment">&lt;/TD&gt;</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;<span class="comment">&lt;/TR&gt;</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;<span class="comment">&lt;/TABLE&gt;  </span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;<span class="comment">&lt;/CENTER&gt;</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;<span class="comment">\section results Results</span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;<span class="comment">\subsection results_CR Crouzeix-Raviart elements</span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;<span class="comment">The figure below shows &quot;carpet plots&quot; of the velocity and pressure</span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;<span class="comment">fields as well as a contour plot of the pressure distribution with</span></div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;<span class="comment">superimposed streamlines. The velocity vanishes along the entire</span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;<span class="comment">domain boundary, apart from the bottom boundary \f$ (x_2=0) \f$</span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;<span class="comment">where the moving &quot;lid&quot; imposes a unit tangential velocity which drives a</span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;<span class="comment">large vortex, centred at \f$ (x_1,x_2) \approx (0.62,0.26)\f$. The</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;<span class="comment">discontinuity in the velocity boundary conditions creates pressure</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;<span class="comment">singularities at \f$ (x_1,x_2) = (0,0)\f$ and \f$ (x_1,x_2) =</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;<span class="comment">(1,0)\f$. The rapidly varying pressure in the vicinity of these points</span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;<span class="comment">clearly shows the discontinuous pressure interpolation employed by the</span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;<span class="comment">Crouzeix-Raviart elements.</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;<span class="comment">\image html CrouzeixRaviart.gif &quot;Plot of the velocity and pressure fields for Re=100 computed with Crouzeix-Raviart (Q2P-1) elements. &quot; </span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;<span class="comment">\image latex CrouzeixRaviart.eps &quot;Plot of the velocity and pressure fields for Re=100 computed with Crouzeix-Raviart (Q2P-1) elements. &quot; width=0.75\textwidth</span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;<span class="comment">\subsection results_TH Taylor-Hood elements</span></div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="comment">The next figure shows the corresponding results obtained from a </span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;<span class="comment">computation with \c QTaylorHoodElements. The pressure plot illustrates</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;<span class="comment">how the interpolation between the corner nodes creates</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;<span class="comment">a globally continuous representation of the pressure. </span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;<span class="comment">\image html TaylorHood.gif &quot;Plot of the velocity and pressure fields for Re=100 computed with Taylor-Hood (Q2Q1) elements. &quot; </span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;<span class="comment">\image latex TaylorHood.eps &quot;Plot of the velocity and pressure fields for Re=100 computed with Taylor-Hood (Q2Q1) elements. &quot; width=0.75\textwidth</span></div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;<span class="comment">Note that in both simulations, the flow field is clearly</span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;<span class="comment">under-resolved near the ends of the &quot;lid&quot;. In </span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;<span class="comment">&lt;A HREF=&quot;../../adaptive_driven_cavity/html/index.html&quot;&gt;</span></div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;<span class="comment">another example&lt;/A&gt; we will demonstrate the use of spatial</span></div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;<span class="comment">adaptivity to obtain much better solutions for this problem.</span></div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;<span class="comment">\section namespace Global parameters and functions</span></div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;<span class="comment">The Reynolds number is the only non-dimensional parameter</span></div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;<span class="comment">needed in this problem. As usual, we define it in a namespace:</span></div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;<span class="comment">\dontinclude driven_cavity.cc</span></div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;<span class="comment">\skipline start_of_namespace</span></div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;<span class="comment">\until end_of_namespace</span></div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;<span class="comment">\section main The driver code</span></div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;<span class="comment">We start by creating a \c DocInfo object to store the output directory and</span></div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;<span class="comment">the label for the output files.</span></div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;<span class="comment">\skipline start_of_main</span></div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;<span class="comment">\until doc_info.number()=0</span></div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;<span class="comment">We build the problem using \c QCrouzeixRaviartElements, solve</span></div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;<span class="comment">using the \c Problem::newton_solve() function, and document</span></div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;<span class="comment">the result before incrementing the label for the output files.</span></div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;<span class="comment">\skipline Doing QCrouzeixRaviartElements</span></div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;<span class="comment">\until end of QCrouzeixRaviartElements</span></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;<span class="comment">Finally, we repeat the process with \c QTaylorHoodElements.</span></div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;<span class="comment">\skipline Doing QTaylorHoodElements</span></div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;<span class="comment">\until end_of_main</span></div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;<span class="comment">\section problem The problem class </span></div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;<span class="comment">The \c Problem class for our steady Navier-Stokes problem is very similar to</span></div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;<span class="comment">those used for the steady scalar problems (Poisson and advection-diffusion)</span></div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;<span class="comment">that we considered in previous examples. We provide a helper function</span></div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;<span class="comment">\c fix_pressure(...) which pins a pressure value in a specified element</span></div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;<span class="comment">and assigns a specific value. </span></div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;<span class="comment">\dontinclude driven_cavity.cc</span></div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;<span class="comment">\skipline start_of_problem_class</span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;<span class="comment">\until end of fix_pressure</span></div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;<span class="comment">No actions are performed after the solution is found, since the</span></div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;<span class="comment">solution is documented in \c main. However, before solving, the</span></div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;<span class="comment">boundary conditions must be set.</span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;<span class="comment">\skipline empty</span></div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;<span class="comment">\until end_of_actions_before_newton_solve</span></div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;<span class="comment">Finally, we provide an access function to the specific mesh and define the</span></div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;<span class="comment">post-processing function \c doc_solution(...).</span></div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;<span class="comment">\skipline Access function for the specific mesh</span></div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;<span class="comment">\until end_of_problem_class</span></div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;<span class="comment">\section constructor The problem constructor</span></div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;<span class="comment">Since this is a steady problem, the constructor is quite simple. We</span></div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;<span class="comment">begin by building the mesh and pin the velocities on the boundaries.</span></div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;<span class="comment">\skipline start_of_constructor</span></div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;<span class="comment">\until end loop over boundaries</span></div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;<span class="comment">Next we pass a pointer to the Reynolds number (stored in</span></div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;<span class="comment">\c Global_Physical_Variables::Re) to all elements.</span></div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;<span class="comment">\skipline Complete the build</span></div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;<span class="comment">\until end loop over elements</span></div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;<span class="comment">Since Dirichlet conditions are applied to both velocity components</span></div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;<span class="comment">on all boundaries, the pressure is only determined up to an </span></div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;<span class="comment">arbitrary constant. We use the \c fix_pressure(...) function to</span></div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;<span class="comment">pin the first pressure value in the first element and set its value</span></div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;<span class="comment">to zero.</span></div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;<span class="comment">\skipline Now set the</span></div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;<span class="comment">\until fix_pressure</span></div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;<span class="comment">Finally, the equation numbering scheme is set up, using the function \c</span></div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;<span class="comment">assign_eqn_numbers().</span></div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;<span class="comment">\skipline Setup equation</span></div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;<span class="comment">\until end_of_constructor</span></div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;<span class="comment">\section doc Post-processing</span></div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;<span class="comment">As expected, this member function documents the computed solution.</span></div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;<span class="comment">\skipline start_of_doc_solution</span></div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;<span class="comment">\until end_of_doc_solution</span></div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;<span class="comment">\section comments Comments and Exercises</span></div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;<span class="comment">\subsection stress_divergence The stress-divergence form</span></div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;<span class="comment">As discussed in the introduction, by default \c oomph-lib&#39;s Navier-Stokes</span></div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;<span class="comment">elements use the stress-divergence form of the momentum equations,</span></div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;<span class="comment">&lt;CENTER&gt;</span></div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;<span class="comment">R_\rho Re \left( St \frac{\partial u_i}{\partial t} + </span></div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;<span class="comment">u_j \frac{\partial u_i}{\partial x_j} \right) =</span></div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;<span class="comment">- \frac{\partial p}{\partial x_i}  +  B_i(x_j) +</span></div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;<span class="comment">R_\rho \frac{Re}{Fr} G_i +</span></div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;<span class="comment">\frac{\partial }{\partial x_j} \left[  R_\mu \left(</span></div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;<span class="comment">\frac{\partial u_i}{\partial x_j} +  </span></div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;<span class="comment">\frac{\partial u_j}{\partial x_i} \right) \right],</span></div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;<span class="comment">&lt;/CENTER&gt;</span></div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;<span class="comment">as this form is required in problems with free surfaces</span></div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;<span class="comment">or problems in which traction boundary conditions are applied.</span></div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;<span class="comment">If the flow is divergence free (\f$ Q = 0 \Longrightarrow \partial</span></div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;<span class="comment">u_i/\partial x_i =0\f$), the viscous term may be simplified to</span></div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;<span class="comment">&lt;CENTER&gt;</span></div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;<span class="comment">R_\rho Re \left( St \frac{\partial u_i}{\partial t} + </span></div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;<span class="comment">u_j \frac{\partial u_i}{\partial x_j} \right) =</span></div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;<span class="comment">- \frac{\partial p}{\partial x_i}  +  B_i(x_j) +</span></div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;<span class="comment">R_\rho \frac{Re}{Fr} G_i +  R_\mu</span></div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;<span class="comment">\frac{\partial^2 u_i }{\partial x_j^2},</span></div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;<span class="comment">&lt;/CENTER&gt;</span></div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;<span class="comment">assuming that the viscosity ratio \f$ R_\mu \f$ remains constant</span></div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;<span class="comment">This simpler form of the equations can be used to solve problems that</span></div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;<span class="comment">do not incorporate traction boundaries or free surfaces. We illustrate</span></div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;<span class="comment">the use of these equations in </span></div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;<span class="comment">&lt;A HREF=&quot;../../circular_driven_cavity/html/index.html&quot;&gt;another example.&lt;/A&gt;</span></div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;<span class="comment">\subsection exercises Exercises</span></div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;<span class="comment">-# Compare the pressure distributions obtained with Taylor-Hood</span></div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;<span class="comment">   elements to that computed with </span></div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;<span class="comment">   Crouzeix-Raviart elements. Why do they differ? [Hint: Consider how</span></div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;<span class="comment">   the pressure is represented in the two elements.]</span></div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;<span class="comment">-# Confirm that the velocities stored at boundary nodes must be</span></div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;<span class="comment">   pinned. Investigate what happens if you do not apply \e any </span></div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;<span class="comment">   velocity boundary conditions [Hint: You should still be able to    </span></div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;<span class="comment">   compute a solution -- what does this solution represent?]</span></div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;<span class="comment">-# Investigate what happens when no pressure value is fixed. </span></div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;<span class="comment">   </span></div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;<span class="comment">\section sources Source files for this tutorial</span></div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;<span class="comment">- The source files for this tutorial are located in the directory:</span></div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;<span class="comment">&lt;CENTER&gt;</span></div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;<span class="comment">&lt;A HREF=&quot;../../../../demo_drivers/navier_stokes/driven_cavity/&quot;&gt;</span></div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;<span class="comment">demo_drivers/navier_stokes/driven_cavity/</span></div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;<span class="comment">&lt;/A&gt;</span></div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;<span class="comment">&lt;/CENTER&gt;</span></div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;<span class="comment">- The driver code is: </span></div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;<span class="comment">&lt;CENTER&gt;</span></div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;<span class="comment">&lt;A HREF=&quot;../../../../demo_drivers/navier_stokes/driven_cavity/driven_cavity.cc&quot;&gt;</span></div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;<span class="comment">demo_drivers/navier_stokes/driven_cavity/driven_cavity.cc</span></div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;<span class="comment">&lt;/A&gt;</span></div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;<span class="comment">&lt;/CENTER&gt;</span></div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;<span class="comment">.</span></div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;<span class="comment">&lt;hr&gt;</span></div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;<span class="comment">&lt;hr&gt;</span></div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;<span class="comment">\section pdf PDF file</span></div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;<span class="comment">A &lt;a href=&quot;../latex/refman.pdf&quot;&gt;pdf version&lt;/a&gt; of this document is available.</span></div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;<span class="comment">**/</span></div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160; </div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="adriven__cavity_8txt_html_ad41166763ce6cf42d7fcfa924b469bc6"><div class="ttname"><a href="driven__cavity_8txt.html#ad41166763ce6cf42d7fcfa924b469bc6">conditions</a></div><div class="ttdeci">E[2DNavierStokes] f and f[\frac{\partial u_i}{\partial x_i}=0,\f] in the square domain f subject to the Dirichlet boundary conditions</div><div class="ttdef"><b>Definition:</b> <a href="driven__cavity_8txt_source.html#l00324">driven_cavity.txt:324</a></div></div>
<div class="ttc" id="adriven__cavity_8txt_html_a7b26d402a104b43ae73026a93aecf7b1"><div class="ttname"><a href="driven__cavity_8txt.html#a7b26d402a104b43ae73026a93aecf7b1">equations</a></div><div class="ttdeci">and a variable body f B_i *x t *f f Q *x t *f is a volumetric source term for the continuity equation and is typically equal to zero We non dimensionalise the equations</div><div class="ttdef"><b>Definition:</b> <a href="driven__cavity_8txt_source.html#l00044">driven_cavity.txt:44</a></div></div>
<div class="ttc" id="adriven__cavity_8txt_html_aec68cbea5a9f69a48aca2e89f91dfb6c"><div class="ttname"><a href="driven__cavity_8txt.html#aec68cbea5a9f69a48aca2e89f91dfb6c">functions</a></div><div class="ttdeci">other values tend to be used in problems involving multiple fluids The above equations are typically augmented by Dirichlet boundary conditions the flow satisfies the traction free natural boundary condition f n_i R_ the fluid pressure f p f is only determined up to an arbitrary constant This indeterminacy may be overcome by prescribing the value of the pressure at a single point in the family of geometric finite elements They are nine node and node qquad quad[\mbox{and }3] f&lt;/CENTER &gt; Here f f and the f psi_j f are the element s geometric shape functions</div><div class="ttdef"><b>Definition:</b> <a href="driven__cavity_8txt_source.html#l00143">driven_cavity.txt:143</a></div></div>
<div class="ttc" id="adriven__cavity_8txt_html_a3cee65b01151654c9676060a1daff93c"><div class="ttname"><a href="driven__cavity_8txt.html#a3cee65b01151654c9676060a1daff93c">right</a></div><div class="ttdeci">E[2DNavierStokes] f and f[\frac{\partial u_i}{\partial x_i}=0,\f] in the square domain f subject to the Dirichlet boundary E[2DNavierStokes_BC1] f on the right</div><div class="ttdef"><b>Definition:</b> <a href="driven__cavity_8txt_source.html#l00324">driven_cavity.txt:324</a></div></div>
<div class="ttc" id="adriven__cavity_8txt_html_a216bf40f2c25cea7f65aab86675756e9"><div class="ttname"><a href="driven__cavity_8txt.html#a216bf40f2c25cea7f65aab86675756e9">mu</a></div><div class="ttdeci">other values tend to be used in problems involving multiple fluids The above equations are typically augmented by Dirichlet boundary conditions the flow satisfies the traction free natural boundary condition f n_i R_ mu(\partial u_i/\partial x_j+\partial u_j/\partial x_i) \</div></div>
<div class="ttc" id="adriven__cavity_8txt_html_a13c74b72761ba317b4efbdb067a1dacc"><div class="ttname"><a href="driven__cavity_8txt.html#a13c74b72761ba317b4efbdb067a1dacc">U</a></div><div class="ttdeci">other values tend to be used in problems involving multiple fluids The above equations are typically augmented by Dirichlet boundary conditions the flow satisfies the traction free natural boundary condition f n_i R_ the fluid pressure f p f is only determined up to an arbitrary constant This indeterminacy may be overcome by prescribing the value of the pressure at a single point in the family of geometric finite elements They are nine node and node qquad quad[\mbox{and }3] f&lt;/CENTER &gt; Here f f and the f psi_j f are the element s geometric shape defined in the c QElement&lt; DIM, 3 &gt; class In both elements the velocity components f f f f[and \f$ u_3 \f$] are stored as nodal values and the geometric shape functions are used to interpolate the velocities inside the&lt; CENTER &gt; f[u_i=\sum_{j=1}^{N^{(E)}} U^{(E)}_{ij} \, \psi_j, \qquad i=1, 2\quad[\mbox{and }3],\f]&lt;/CENTER &gt; where f U</div><div class="ttdef"><b>Definition:</b> <a href="driven__cavity_8txt_source.html#l00156">driven_cavity.txt:156</a></div></div>
<div class="ttc" id="adriven__cavity_8txt_html_ae230b92eee2bdca8d29b77db2525d9e9"><div class="ttname"><a href="driven__cavity_8txt.html#ae230b92eee2bdca8d29b77db2525d9e9">u_2</a></div><div class="ttdeci">other values tend to be used in problems involving multiple fluids The above equations are typically augmented by Dirichlet boundary conditions the flow satisfies the traction free natural boundary condition f n_i R_ the fluid pressure f p f is only determined up to an arbitrary constant This indeterminacy may be overcome by prescribing the value of the pressure at a single point in the family of geometric finite elements They are nine node and node qquad quad[\mbox{and }3] f&lt;/CENTER &gt; Here f f and the f psi_j f are the element s geometric shape defined in the c QElement&lt; DIM, 3 &gt; class In both elements the velocity components f f f u_2</div><div class="ttdef"><b>Definition:</b> <a href="driven__cavity_8txt_source.html#l00146">driven_cavity.txt:146</a></div></div>
<div class="ttc" id="adriven__cavity_8txt_html_a8c7463ce8fa3bf342a9ac236eac0b986"><div class="ttname"><a href="driven__cavity_8txt.html#a8c7463ce8fa3bf342a9ac236eac0b986">u_1</a></div><div class="ttdeci">other values tend to be used in problems involving multiple fluids The above equations are typically augmented by Dirichlet boundary conditions the flow satisfies the traction free natural boundary condition f n_i R_ the fluid pressure f p f is only determined up to an arbitrary constant This indeterminacy may be overcome by prescribing the value of the pressure at a single point in the family of geometric finite elements They are nine node and node qquad quad[\mbox{and }3] f&lt;/CENTER &gt; Here f f and the f psi_j f are the element s geometric shape defined in the c QElement&lt; DIM, 3 &gt; class In both elements the velocity components f u_1</div><div class="ttdef"><b>Definition:</b> <a href="driven__cavity_8txt_source.html#l00146">driven_cavity.txt:146</a></div></div>
<div class="ttc" id="adriven__cavity_8txt_html_a166cbca57a565fbc62a4eb62226f4f07"><div class="ttname"><a href="driven__cavity_8txt.html#a166cbca57a565fbc62a4eb62226f4f07">N</a></div><div class="ttdeci">other values tend to be used in problems involving multiple fluids The above equations are typically augmented by Dirichlet boundary conditions the flow satisfies the traction free natural boundary condition f n_i R_ the fluid pressure f p f is only determined up to an arbitrary constant This indeterminacy may be overcome by prescribing the value of the pressure at a single point in the family of geometric finite elements They are nine node and node qquad quad[\mbox{and }3] f&lt;/CENTER &gt; Here f N</div><div class="ttdef"><b>Definition:</b> <a href="driven__cavity_8txt_source.html#l00141">driven_cavity.txt:141</a></div></div>
<div class="ttc" id="adriven__cavity_8txt_html_a038054a12f4dd0f32dcd7387b1b1fcec"><div class="ttname"><a href="driven__cavity_8txt.html#a038054a12f4dd0f32dcd7387b1b1fcec">_j</a></div><div class="ttdeci">and a variable body f B_i *x * _j</div><div class="ttdef"><b>Definition:</b> <a href="driven__cavity_8txt_source.html#l00039">driven_cavity.txt:39</a></div></div>
<div class="ttc" id="adriven__cavity_8txt_html_a7f1193f045df214969e96bb574779995"><div class="ttname"><a href="driven__cavity_8txt.html#a7f1193f045df214969e96bb574779995">number</a></div><div class="ttdeci">other values tend to be used in problems involving multiple fluids The above equations are typically augmented by Dirichlet boundary conditions the flow satisfies the traction free natural boundary condition f n_i R_ the fluid pressure f p f is only determined up to an arbitrary constant This indeterminacy may be overcome by prescribing the value of the pressure at a single point in the family of geometric finite elements They are nine node and node qquad quad[\mbox{and }3] f&lt;/CENTER &gt; Here f f and the f psi_j f are the element s geometric shape defined in the c QElement&lt; DIM, 3 &gt; class In both elements the velocity components f f f f[and \f$ u_3 \f$] are stored as nodal values and the geometric shape functions are used to interpolate the velocities inside the&lt; CENTER &gt; f[u_i=\sum_{j=1}^{N^{(E)}} U^{(E)}_{ij} \, \psi_j, \qquad i=1, 2\quad[\mbox{and }3],\f]&lt;/CENTER &gt; where f&lt; CENTER &gt; f[p=P_0^{(E)}+P_1^{(E)} \, s_1+P_2^{(E)} \, s_2 \quad \left[+P_3^{(E)} \, s_3\right],\f]&lt;/CENTER &gt; where the f s_i in[-1, 1] f are the element s coordinates This provides a piecewise bi[tri-] linear representation of the pressure in terms of[4] pressure degrees of freedom per element Crouzeix Raviart elements ensure that the continuity equation is satisfied within each element The pressure degrees of freedom are to the element and are stored in the element s internal c Data They are accessible via the member function code representing the two[three] velocity components at that c Node&lt; HR &gt; subsubsection TH Taylor Hood elements In c oomph lib s c QTaylorHoodElements the pressure is represented by a globally piecewise bi[tri-] linear interpolation between the pressure values f&lt; CENTER &gt; f[p=\sum_{j=1}^{N_p^{(E)}} P_j^{(E)} \, \psi_j^{(p)},\f]&lt;/CENTER &gt; where the f Taylor Hood elements generate a much smaller number of pressure degrees of freedom than the corresponding Crouzeix Raviart elements Taylor Hood elements do not conserve mass locally&lt; HR &gt; section params Non dimensional parameters and their default values The Reynolds number</div><div class="ttdef"><b>Definition:</b> <a href="driven__cavity_8txt_source.html#l00236">driven_cavity.txt:236</a></div></div>
<div class="ttc" id="adriven__cavity_8txt_html_a79491e0569e63939f3beb7f5277604fc"><div class="ttname"><a href="driven__cavity_8txt.html#a79491e0569e63939f3beb7f5277604fc">element</a></div><div class="ttdeci">other values tend to be used in problems involving multiple fluids The above equations are typically augmented by Dirichlet boundary conditions the flow satisfies the traction free natural boundary condition f n_i R_ the fluid pressure f p f is only determined up to an arbitrary constant This indeterminacy may be overcome by prescribing the value of the pressure at a single point in the family of geometric finite elements They are nine node and node qquad quad[\mbox{and }3] f&lt;/CENTER &gt; Here f f and the f psi_j f are the element s geometric shape defined in the c QElement&lt; DIM, 3 &gt; class In both elements the velocity components f f f f[and \f$ u_3 \f$] are stored as nodal values and the geometric shape functions are used to interpolate the velocities inside the element</div><div class="ttdef"><b>Definition:</b> <a href="driven__cavity_8txt_source.html#l00149">driven_cavity.txt:149</a></div></div>
<div class="ttc" id="adriven__cavity_8txt_html_a3999228f16bf26800d15356372c52411"><div class="ttname"><a href="driven__cavity_8txt.html#a3999228f16bf26800d15356372c52411">i</a></div><div class="ttdeci">other values tend to be used in problems involving multiple fluids The above equations are typically augmented by Dirichlet boundary conditions the flow satisfies the traction free natural boundary condition f n_i R_ the fluid pressure f p f is only determined up to an arbitrary constant This indeterminacy may be overcome by prescribing the value of the pressure at a single point in the family of geometric finite elements They are nine node and node qquad i</div><div class="ttdef"><b>Definition:</b> <a href="driven__cavity_8txt_source.html#l00138">driven_cavity.txt:138</a></div></div>
<div class="ttc" id="adriven__cavity_8txt_html_a5522070762791873bd68e8ffb2a665b2"><div class="ttname"><a href="driven__cavity_8txt.html#a5522070762791873bd68e8ffb2a665b2">boundary</a></div><div class="ttdeci">E[2DNavierStokes] f and f[\frac{\partial u_i}{\partial x_i}=0,\f] in the square domain f subject to the Dirichlet boundary E[2DNavierStokes_BC1] f on the top and left boundaries and f[\left. \mathbf{u}\right|_{\partial D}=(1, 0),\ \ \ \ \ \ \ \ \ \ @E[2DNavierStokes_BC2]@\f] on the bottom boundary</div><div class="ttdef"><b>Definition:</b> <a href="driven__cavity_8txt_source.html#l00332">driven_cavity.txt:332</a></div></div>
<div class="ttc" id="adriven__cavity_8txt_html_a8d9f95331cc83b1a4dcaa1673334b2b1"><div class="ttname"><a href="driven__cavity_8txt.html#a8d9f95331cc83b1a4dcaa1673334b2b1">psi_j</a></div><div class="ttdeci">other values tend to be used in problems involving multiple fluids The above equations are typically augmented by Dirichlet boundary conditions the flow satisfies the traction free natural boundary condition f n_i R_ the fluid pressure f p f is only determined up to an arbitrary constant This indeterminacy may be overcome by prescribing the value of the pressure at a single point in the family of geometric finite elements They are nine node and node psi_j</div><div class="ttdef"><b>Definition:</b> <a href="driven__cavity_8txt_source.html#l00137">driven_cavity.txt:137</a></div></div>
<div class="ttc" id="adriven__cavity_8txt_html_a8d895bb93cd829890aa4c1a2d5682792"><div class="ttname"><a href="driven__cavity_8txt.html#a8d895bb93cd829890aa4c1a2d5682792">problem</a></div><div class="ttdeci">mainpage Example problem</div><div class="ttdef"><b>Definition:</b> <a href="driven__cavity_8txt_source.html#l00005">driven_cavity.txt:5</a></div></div>
<div class="ttc" id="adriven__cavity_8txt_html_ad443d2a7c41b59c225b8ecc881f1b053"><div class="ttname"><a href="driven__cavity_8txt.html#ad443d2a7c41b59c225b8ecc881f1b053">u_i</a></div><div class="ttdeci">{\cal U} \, u_i, \qquad x_i^ *={\cal L}\, x_i, \qquad t^ *={\cal T}\, t, \qquad G_i^ *=g \, G_i, \f] \f[p^ *=\frac{\mu_{ref} {\cal U}}{{\cal L}} \, p, \qquad B_i^ *=\frac{{\cal U}\mu_{ref}}{{\cal L}^2} \, B_i, \qquad Q^ *=\frac{{\cal U}}{{\cal L}}\, Q, \qquad \f]&lt;/CENTER &gt; where we note that the pressure and the variable body force have been non-dimensionalised on the viscous scale. \f$ \mu_{ref} \f$ and \f$ \rho_{ref} \f$(used below) are reference values for the fluid viscosity and density, respectively. In single-fluid problems, they are identical to the viscosity \f$ \mu \f$ and density \f$ \rho \f$ of the(one and only) fluid in the problem. The non-dimensional form of the Navier-Stokes equations is then given by&lt; CENTER &gt; \f[R_\rho Re \left(St \frac{\partial u_i}{\partial t}+u_j \frac{\partial u_i}{\partial x_j} \right)=- \frac{\partial p}{\partial x_i}+B_i(x_j, t)+R_\rho \frac{Re}{Fr} G_i+\frac{\partial }{\partial x_j} \left[R_\mu \left(\frac{\partial u_i}{\partial x_j}+\frac{\partial u_j}{\partial x_i} \right) \right], \f]&lt;/CENTER &gt; and&lt; CENTER &gt; \f[\frac{\partial u_i}{\partial x_i}=Q, \f]&lt;/CENTER &gt; where the dimensionless parameters&lt; CENTER &gt; \f[Re=\frac{{\cal U}{\cal L}\rho_{ref}}{\mu_{ref}}, \qquad St=\frac{{\cal L}}{{\cal U}{\cal T}}, \qquad Fr=\frac{{\cal U}^2}{g{\cal L}}, \f]&lt;/CENTER &gt; are the Reynolds number, Strouhal number and Froude number respectively. \f$ R_\rho=\rho/\rho_{ref} \f$ and \f$ R_\mu=\mu/\mu_{ref}\f$ represent the ratios of the fluid 's density and its dynamic viscosity, relative to the density and viscosity values used to form the non-dimensional parameters(By default, \f$ R_\rho=R_\mu=1 \f$ u_i</div><div class="ttdef"><b>Definition:</b> <a href="driven__cavity_8txt_source.html#l00102">driven_cavity.txt:102</a></div></div>
<div class="ttc" id="adriven__cavity_8txt_html_aad442c6c125e4f3823bbe35e0c0d7572"><div class="ttname"><a href="driven__cavity_8txt.html#aad442c6c125e4f3823bbe35e0c0d7572">D</a></div><div class="ttdeci">E[2DNavierStokes] f and f[\frac{\partial u_i}{\partial x_i}=0,\f] in the square domain f D</div><div class="ttdef"><b>Definition:</b> <a href="driven__cavity_8txt_source.html#l00321">driven_cavity.txt:321</a></div></div>
<div class="ttc" id="adriven__cavity_8txt_html_a3e49a068843173bd66002716d8aff68b"><div class="ttname"><a href="driven__cavity_8txt.html#a3e49a068843173bd66002716d8aff68b">are</a></div><div class="ttdeci">other values tend to be used in problems involving multiple fluids The above equations are typically augmented by Dirichlet boundary conditions the flow satisfies the traction free natural boundary condition f n_i R_ the fluid pressure f p f is only determined up to an arbitrary constant This indeterminacy may be overcome by prescribing the value of the pressure at a single point in the family of geometric finite elements They are nine node and node qquad quad[\mbox{and }3] f&lt;/CENTER &gt; Here f f and the f psi_j f are the element s geometric shape defined in the c QElement&lt; DIM, 3 &gt; class In both elements the velocity components f f f f[and \f$ u_3 \f$] are stored as nodal values and the geometric shape functions are used to interpolate the velocities inside the&lt; CENTER &gt; f[u_i=\sum_{j=1}^{N^{(E)}} U^{(E)}_{ij} \, \psi_j, \qquad i=1, 2\quad[\mbox{and }3],\f]&lt;/CENTER &gt; where f&lt; CENTER &gt; f[p=P_0^{(E)}+P_1^{(E)} \, s_1+P_2^{(E)} \, s_2 \quad \left[+P_3^{(E)} \, s_3\right],\f]&lt;/CENTER &gt; where the f s_i in[-1, 1] f are the element s coordinates This provides a piecewise bi[tri-] linear representation of the pressure in terms of[4] pressure degrees of freedom per element Crouzeix Raviart elements ensure that the continuity equation is satisfied within each element The pressure degrees of freedom are to the element and are stored in the element s internal c Data They are accessible via the member function code representing the two[three] velocity components at that c Node&lt; HR &gt; subsubsection TH Taylor Hood elements In c oomph lib s c QTaylorHoodElements the pressure is represented by a globally piecewise bi[tri-] linear interpolation between the pressure values f&lt; CENTER &gt; f[p=\sum_{j=1}^{N_p^{(E)}} P_j^{(E)} \, \psi_j^{(p)},\f]&lt;/CENTER &gt; where the f Taylor Hood elements generate a much smaller number of pressure degrees of freedom than the corresponding Crouzeix Raviart elements Taylor Hood elements do not conserve mass locally&lt; HR &gt; section params Non dimensional parameters and their default values The Reynolds Strouhal inverse Froude density ratio and viscosity ratio are assumed to be constant within each element Their values are accessed via pointers which are accessible via the member functions c f c f c f c therefore they only need to be over written if the default values are not appropriate The default values are</div><div class="ttdef"><b>Definition:</b> <a href="driven__cavity_8txt_source.html#l00275">driven_cavity.txt:275</a></div></div>
<div class="ttc" id="adriven__cavity_8txt_html_a1e99b2506b619d5623f846bc246c1e91"><div class="ttname"><a href="driven__cavity_8txt.html#a1e99b2506b619d5623f846bc246c1e91">f</a></div><div class="ttdeci">other values tend to be used in problems involving multiple fluids The above equations are typically augmented by Dirichlet boundary conditions the flow satisfies the traction free natural boundary condition f n_i R_ the fluid pressure f p f is only determined up to an arbitrary constant This indeterminacy may be overcome by prescribing the value of the pressure at a single point in the family of geometric finite elements They are nine node and node qquad quad[\mbox{and }3] f&lt;/CENTER &gt; Here f f and the f psi_j f are the element s geometric shape defined in the c QElement&lt; DIM, 3 &gt; class In both elements the velocity components f f f f[and \f$ u_3 \f$] are stored as nodal values and the geometric shape functions are used to interpolate the velocities inside the&lt; CENTER &gt; f[u_i=\sum_{j=1}^{N^{(E)}} U^{(E)}_{ij} \, \psi_j, \qquad i=1, 2\quad[\mbox{and }3],\f]&lt;/CENTER &gt; where f&lt; CENTER &gt; f[p=P_0^{(E)}+P_1^{(E)} \, s_1+P_2^{(E)} \, s_2 \quad \left[+P_3^{(E)} \, s_3\right],\f]&lt;/CENTER &gt; where the f s_i in[-1, 1] f are the element s coordinates This provides a piecewise bi[tri-] linear representation of the pressure in terms of[4] pressure degrees of freedom per element Crouzeix Raviart elements ensure that the continuity equation is satisfied within each element The pressure degrees of freedom are to the element and are stored in the element s internal c Data They are accessible via the member function code representing the two[three] velocity components at that c Node&lt; HR &gt; subsubsection TH Taylor Hood elements In c oomph lib s c QTaylorHoodElements the pressure is represented by a globally piecewise bi[tri-] linear interpolation between the pressure values f&lt; CENTER &gt; f[p=\sum_{j=1}^{N_p^{(E)}} P_j^{(E)} \, \psi_j^{(p)},\f]&lt;/CENTER &gt; where the f Taylor Hood elements generate a much smaller number of pressure degrees of freedom than the corresponding Crouzeix Raviart elements Taylor Hood elements do not conserve mass locally&lt; HR &gt; section params Non dimensional parameters and their default values The Reynolds Strouhal inverse Froude density ratio and viscosity ratio are assumed to be constant within each element Their values are accessed via pointers which are accessible via the member functions c f c f c f c therefore they only need to be over written if the default values are not appropriate The default values accessible via the function c the variable body force f B_i f</div><div class="ttdef"><b>Definition:</b> <a href="driven__cavity_8txt_source.html#l00276">driven_cavity.txt:276</a></div></div>
<div class="ttc" id="adriven__cavity_8txt_html_a4808597a8a128ee7e0f1cfbff4e67b7b"><div class="ttname"><a href="driven__cavity_8txt.html#a4808597a8a128ee7e0f1cfbff4e67b7b">P_j</a></div><div class="ttdeci">other values tend to be used in problems involving multiple fluids The above equations are typically augmented by Dirichlet boundary conditions the flow satisfies the traction free natural boundary condition f n_i R_ the fluid pressure f p f is only determined up to an arbitrary constant This indeterminacy may be overcome by prescribing the value of the pressure at a single point in the family of geometric finite elements They are nine node and node qquad quad[\mbox{and }3] f&lt;/CENTER &gt; Here f f and the f psi_j f are the element s geometric shape defined in the c QElement&lt; DIM, 3 &gt; class In both elements the velocity components f f f f[and \f$ u_3 \f$] are stored as nodal values and the geometric shape functions are used to interpolate the velocities inside the&lt; CENTER &gt; f[u_i=\sum_{j=1}^{N^{(E)}} U^{(E)}_{ij} \, \psi_j, \qquad i=1, 2\quad[\mbox{and }3],\f]&lt;/CENTER &gt; where f&lt; CENTER &gt; f[p=P_0^{(E)}+P_1^{(E)} \, s_1+P_2^{(E)} \, s_2 \quad \left[+P_3^{(E)} \, s_3\right],\f]&lt;/CENTER &gt; where the f s_i in[-1, 1] f are the element s coordinates This provides a piecewise bi[tri-] linear representation of the pressure in terms of[4] pressure degrees of freedom per element Crouzeix Raviart elements ensure that the continuity equation is satisfied within each element The pressure degrees of freedom are to the element and are stored in the element s internal c Data They are accessible via the member function code representing the two[three] velocity components at that c Node&lt; HR &gt; subsubsection TH Taylor Hood elements In c oomph lib s c QTaylorHoodElements the pressure is represented by a globally piecewise bi[tri-] linear interpolation between the pressure values f P_j</div><div class="ttdef"><b>Definition:</b> <a href="driven__cavity_8txt_source.html#l00206">driven_cavity.txt:206</a></div></div>
<div class="ttc" id="anamespaceGlobal__Physical__Variables_html_ab814e627d2eb5bc50318879d19ab16b9"><div class="ttname"><a href="namespaceGlobal__Physical__Variables.html#ab814e627d2eb5bc50318879d19ab16b9">Global_Physical_Variables::Re</a></div><div class="ttdeci">double Re</div><div class="ttdoc">Reynolds number.</div><div class="ttdef"><b>Definition:</b> <a href="driven__cavity_8cc_source.html#l00047">driven_cavity.cc:47</a></div></div>
<div class="ttc" id="adriven__cavity_8txt_html_a0d868283bc52c8fee06e26bbb407bb43"><div class="ttname"><a href="driven__cavity_8txt.html#a0d868283bc52c8fee06e26bbb407bb43">force</a></div><div class="ttdeci">and a variable body force</div><div class="ttdef"><b>Definition:</b> <a href="driven__cavity_8txt_source.html#l00017">driven_cavity.txt:17</a></div></div>

    <!-- jQuery for Bootstrap and Doxygen -->
    <script src="../../../js/jquery-1.12.0.min.js"></script>
    <!-- Minified boostrap plugins-->
    <script src="../../../js/bootstrap.js"></script>
    <!-- Doxygen dependency to add powertips to source code-->
    <script src="../../../js/jquery.powertip.min.js"></script>
    <!-- The  following script is generated by doxygen and hides/shows levels in 
         the data structure lists and adds powertips to source code-->
    <script src="../../../js/dynsections.js" ></script>
    <!-- add to Doxygen's class names so bootstrap css and js recognises them-->
    <script type="text/javascript">
    $(".contents").addClass("container");
    $(".header").addClass("container");
    $(".navpath").addClass("container");
    $("#navrow3").addClass("container");
    $("#navrow4").addClass("container");
    $(".mlabel").addClass("label");
    $(".mlabel").addClass("label-default");
    $(".memitem").addClass("panel");
    $(".memitem").addClass("panel-info");
    $(".memproto").addClass("panel-heading");
    $(".memdoc").addClass("panel-body");
    </script>
    <footer>
      <div class="container">
        <div class="text-muted" style="float:right;">Generated by <a href="http://www.doxygen.org/index.html">
          <img style="height:18px;" class="footer-img" src="doxygen.png" alt="doxygen"></a> on Tue Jul 27 2021 11:12:17
        </div>
      </div>
    </footer>
</body>
</html>

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
<title>oomph-lib: rayleigh_traction_channel.txt_doxygenified.h Source File</title>
<link rel="apple-touch-icon" sizes="57x57" href="../../../figures/apple-touch-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="../../../figures/apple-touch-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="../../../figures/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="../../../figures/apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="../../../figures/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="../../../figures/apple-touch-icon-120x120.png">
<link rel="icon" type="image/png" href="../../../figures/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="../../../figures/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="../../../figures/favicon-16x16.png" sizes="16x16">
<link rel="manifest" href="../../../figures/manifest.json">
<link rel="mask-icon" href="../../../figures/safari-pinned-tab.svg" color="#008000">
<link rel="shortcut icon" href="../../../figures/favicon.ico">
<meta name="msapplication-TileColor" content="#00a300">
<meta name="msapplication-config" content="../../../figures/browserconfig.xml">
<meta name="theme-color" content="#008000">
<link href="http://fonts.googleapis.com/css?family=Open+Sans:400,300,600" rel="stylesheet" type="text/css">
<!-- Doxygen css-->
<!-- <link rel="stylesheet" type="text/css" href="doxygen.css"> -->
<!-- Bootstrap -->
<link href="../../../css/bootstrap.css" rel="stylesheet">
<!-- oomph-lib specific overrides -->
<link rel="stylesheet" type="text/css" href="../../../css/oomph_header.css">
</head>
<body>
<nav class="navbar navbar-default">
<div class="container">
<div class="container-fluid">
  <!-- Brand and toggle get grouped for better mobile display -->
  <div class="navbar-header">
    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
      <span class="sr-only">Toggle navigation</span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="../../../html/index.html"><img alt="oomph-lib" src="../../../figures/oomph_logo.png"></a>
  </div>
  <!-- Collect the nav links, forms, and other content for toggling -->
  <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
    <ul class="nav navbar-nav">          
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Documentation <span class="caret"></span></a>
        <ul class="dropdown-menu">
          <li class="dropdown-header">Big picture</li>
          <li><a href="../../../../doc/intro/html/index.html">The finite element method</a></li>
          <li><a href="../../../../doc/the_data_structure/html/index.html">The data structure</a></li>
          <li><a href="../../../../doc/quick_guide/html/index.html">Not-so-quick guide</a></li>
          <li><a href="../../../../doc/optimisation/html/index.html">Optimisation</a></li>
          <li><a href="../../../../doc/order_of_action_functions/html/index.html">Order of action functions</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Example codes and tutorials</li>
          <li><a href="../../../../doc/example_code_list/html/index.html">List of example codes and tutorials</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#meshes">Meshing</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#solvers">Solvers</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#parallel">MPI parallel processing</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#visualisation">Post-processing/visualisation</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Other</li>
          <li><a href="../../../../doc/change_log/html/index.html">Change log</a></li>
          <li><a href="../../../../doc/creating_doc/html/index.html">Creating documentation</a></li>
          <li><a href="../../../../doc/coding_conventions/html/index.html">Coding conventions</a></li>
          <li><a href="../../../../doc/index/html/index.html">Index</a></li>
          <li><a href="../../../../doc/FAQ/html/index.html">FAQ</a></li>
        </ul>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Get it <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../../doc/the_distribution/html/index.html">Installation guide</a></li>
            <li><a href="../../../../doc/subversion/html/index.html">Get code from subversion repository</a></li>
            <li><a href="../../../../doc/download/html/index.html">Get code as tar file</a></li>
            <li><a href="../../../../doc/copyright/html/index.html">Copyright</a></li>
          </ul>
        </li>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">About <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../../doc/people/html/index.html">People</a></li>            
            <li><a href="../../../../doc/contact/html/index.html">Contact/Get involved</a></li>
            <li><a href="../../../../doc/publications/html/index.html">Publications</a></li>
            <li><a href="../../../../doc/acknowledgements/html/index.html">Acknowledgements</a></li>
            <li><a href="../../../../doc/picture_show/index.html">Picture show</a></li>
          </ul>
        </li>
      </li>
    </ul>
    <ul class="nav navbar-nav navbar-right navbar-search">
      <form class="navbar-form" role="search" action="../../../../doc/search_results/html/index.html">
        <div class="input-group">
          <input type="text" class="form-control" placeholder="Search" name="q">
          <span class="input-group-btn">
            <button class="btn btn-default" type="submit">Go</button>
          </span>
        </div><!-- /input-group -->
       <!--<div class="form-group">
          <input type="text" class="form-control" placeholder="Search">
        </div>
        <button type="submit" class="btn btn-default">Submit</button>-->
      </form>
    </ul>
  </div><!-- /.navbar-collapse -->
</div><!-- /.container-fluid -->
</div>
</nav>
<!-- Generated by Doxygen 1.8.17 -->
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">rayleigh_traction_channel.txt_doxygenified.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="rayleigh__traction__channel_8txt__doxygenified_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">\mainpage Example problem: Unsteady flow in a 2D channel, driven by an applied traction</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">In this example we consider a variation of the unsteady 2D channel</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">flow problem considered elsewhere. In the </span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">&lt;A HREF=&quot;../../rayleigh_channel/html/index.html&quot;&gt;previous example&lt;/A&gt;</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">the flow was driven by the imposed wall motion. Here we shall consider </span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">the case in which the flow is driven by an applied traction </span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">\f$ {\bf t}^{[prescribed]}\f$ which balances the fluid stress so that</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">t_i^{[prescribed]} = \tau_{ij} \ n_j = </span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">\left( -p\ \delta_{ij} + </span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">\left(\frac{\partial u_i}{\partial x_j} + </span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">\frac{\partial u_j}{\partial x_i}\right)\right) n_j</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment"> \ \ \ \ \ \ \ \ \ \ (1)</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">along the upper, horizontal boundary of the channel.</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">Here \f$ n_j \f$ is the outward unit normal, \f$ \delta_{ij} \f$</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">is the Kronecker delta and \f$ \tau_{ij} \f$ the stress tensor. \c</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">oomph-lib provides traction elements that can be applied along a</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">domain boundary to (weakly) impose the above boundary condition. </span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">The traction elements are used in the same way as flux-elements in the </span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">&lt;A HREF=&quot;../../../poisson/two_d_poisson_flux_bc/html/index.html&quot;&gt;</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">Poisson &lt;/A&gt; and </span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">&lt;A HREF=&quot;../../../unsteady_heat/two_d_unsteady_heat_adapt/html/index.html&quot;&gt;</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">unsteady heat&lt;/A&gt; examples. The section \ref comments at the end</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment">of this documents provides more detail on the underlying theory and </span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment">its implementation in \c oomph-lib.</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment">\section example The example problem</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment">We consider the unsteady finite-Reynolds-number flow in a 2D channel</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment">that is driven by an applied traction along its upper boundary.</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment">&lt;CENTER&gt;</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment">&lt;TABLE&gt;</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment">&lt;TR&gt; </span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment">&lt;TD&gt;</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment">&lt;CENTER&gt;</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment">&lt;B&gt;Unsteady flow in a 2D channel, driven by an applied traction.&lt;/B&gt;</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment">&lt;/CENTER&gt; </span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment">Here is a sketch of the problem:</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment">\image html rayleigh_traction_channel.gif &quot;Sketch of the problem. &quot; </span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment">\image latex rayleigh_traction_channel.eps &quot;Sketch of the problem. &quot; width=0.75\textwidth</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment">The flow is governed by the 2D unsteady Navier-Stokes equations,</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment">Re\left(St\frac{\partial u_i}{\partial t} + </span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment">u_j\frac{\partial u_i}{\partial x_j}\right) =</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment">- \frac{\partial p}{\partial x_i} +</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="comment">\frac{\partial }{\partial x_j} \left(</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment">\frac{\partial u_i}{\partial x_j} +  </span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment">\frac{\partial u_j}{\partial x_i} \right),</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment"> \ \ \ \ \ \ \ \ \ \ (2)</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment">and</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment">\frac{\partial u_i}{\partial x_i} = 0,</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment">in the square domain </span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment">D = \bigg\{(x_1,x_2) \ | \ x_1 \in [0,1], \ x_2 \in [0,1] \bigg\}.</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="comment">We apply the Dirichlet (no-slip) boundary condition</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="comment">\left. \mathbf{u}\right|_{\partial D_{lower}}=(0,0),</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment">\ \ \ \ \ \ \ \ \ \ (3)</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="comment">on the lower, stationary wall, \f$ \partial D_{lower} = </span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="comment">\big\{(x_1,x_2) \ | \ x_2=0 \big\} \f$ and</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="comment">the traction</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="comment">\mathbf{t}^{[prescribed]}= (\tau(t), 0)</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="comment">\ \ \ \ \ \ \ \ \ \ (4)</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment">where \f$ \tau(t)\f$ is a given function, on the upper boundary, </span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="comment">\f$ \partial D_{upper} = \big\{(x_1,x_2) \ | \ x_2=1 \big\} \f$ .</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="comment">As in the </span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="comment">&lt;A HREF=&quot;../../rayleigh_channel/html/index.html&quot;&gt;previous example&lt;/A&gt;</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="comment">we apply periodic boundary conditions on the &quot;left&quot; and &quot;right&quot; boundaries:</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="comment">\left.\mathbf{u}\right|_{x_1=0} = \left.\mathbf{u}\right|_{x_1=1}.</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="comment">\ \ \ \ \ \ \ \ \ \ (5)</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="comment">Initial conditions for the velocities are given by</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="comment">{\bf u}(x_1,x_2,t=0) = {\bf u}_{IC}(x_1,x_2),</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="comment">where \f$ {\bf u}_{IC}(x_1,x_2)\f$ is given.</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment">&lt;/TD&gt;</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="comment">&lt;/TR&gt;</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="comment">&lt;/TABLE&gt;  </span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="comment">&lt;/CENTER&gt;</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="comment">\subsection solution An exact, parallel-flow solution</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="comment">We choose the prescribed traction \f$ {\bf t}^{[prescribed]} =</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="comment">(\tau(t), 0) \f$ such</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="comment">that the parallel-flow solution </span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="comment">{\bf u}_{exact}(x_1,x_2,t) = U(x_2,t) \ {\bf e}_1 \mbox{ \ \ \ \ \ and</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="comment">\ \ \ \ }</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="comment">p_{exact}(x_1,x_2,t) = 0,</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="comment">derived in the </span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="comment">&lt;A HREF=&quot;../../rayleigh_channel/html/index.html&quot;&gt;previous example&lt;/A&gt;</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="comment">remains valid. For this purpose we set</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="comment">\tau(t) = \left. \frac{\partial U(x_2,t)}{\partial x_2}\right|_{x_2=1},</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="comment">where </span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="comment">U(x_2,t) = Re\left\{\frac{e^{i\omega</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="comment">t}}{e^{i\lambda}-e^{-i\lambda}}\left(e^{i\lambda y}-e^{-i\lambda y}</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="comment">\right)\right\}</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="comment">and</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="comment">\lambda = i\sqrt{i\omega Re\, St}.</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="comment">\section results Results</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="comment">The two animations below show the computed solutions obtained from</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="comment">a spatial discretisation with Taylor-Hood and Crouzeix-Raviart</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="comment">elements, respectively. In both cases we set \f$ \omega=2\pi, \ Re =</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="comment">ReSt = 10 \f$ and specified the exact, time-periodic solution as the</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="comment">initial condition, i.e. \f$ {\bf u}_{IC}(x_1,x_2) = {\bf</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="comment">u}_{exact}(x_1,x_2,t=0)\f$ . The computed solutions agree extremely</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="comment">well with the exact solution throughout the simulation.</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="comment">\image html velocity_vectors_CR.gif &quot;Plot of the velocity field computed with 2D Crouzeix-Raviart elements, starting from the exact, time-periodic solution. &quot; </span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="comment">\image latex velocity_vectors_CR.eps &quot;Plot of the velocity field computed with 2D Crouzeix-Raviart elements, starting from the exact, time-periodic solution. &quot; width=0.75\textwidth</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="comment">\image html velocity_vectors_TH.gif &quot;Plot of the velocity field computed with 2D Taylor-Hood elements, starting from the exact, time-periodic solution. &quot; </span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="comment">\image latex velocity_vectors_TH.eps &quot;Plot of the velocity field computed with 2D Taylor-Hood elements, starting from the exact, time-periodic solution. &quot; width=0.75\textwidth</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="comment">\section namespace The global parameters</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="comment">As usual, we use a namespace to define the problem parameters, the</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="comment">Reynolds number, \f$ Re\f$, and the Womersley number, \f$ Re\, St\f$ .</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="comment">We also provide two flags that indicate the length of the run </span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="comment">(to allow a short run to be performed when the code is run as a self-test),</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="comment">and the initial condition (allowing a start from \f$ {\bf u}_{exact}\f$ or </span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="comment">an impulsive start in which the fluid is initially at rest).</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="comment"> </span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="comment">\dontinclude rayleigh_traction_channel.cc</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="comment">\skipline start_of_namespace</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="comment">\until end of namespace</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="comment">&lt;HR&gt; </span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="comment">\section exact The exact solution</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="comment">We use a second namespace to define the time-periodic, parallel flow </span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="comment">\f$ {\bf u}_{exact}\f$, and the traction \f$ {\bf t}^{[prescribed]}\f$ </span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="comment">required to make  \f$ {\bf u}_{exact}\f$ a solution of the problem. </span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="comment">\dontinclude rayleigh_traction_channel.cc</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="comment">\skipline start_of_exact_solution</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="comment">\until // end of exact_solution</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="comment">\section main The driver code</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="comment">As in the </span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="comment">&lt;A HREF=&quot;../../rayleigh_channel/html/index.html&quot;&gt;previous example&lt;/A&gt;</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="comment">we use optional command line arguments to specify which mode</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="comment">the code is run in: Either as a short or a long run (indicated by</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="comment">the first command line argument being 0 or 1, respectively), and with</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="comment">initial conditions corresponding to an impulsive start or a start</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;<span class="comment">from the time-periodic exact solution (indicated by the second command </span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="comment">line argument being 1 or 0, respectively). If no command line arguments are</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<span class="comment">specified the code is run in the default mode, specified by</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<span class="comment">parameter values assigned in the namespace \c Global_Parameters.</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="comment">\skipline main</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="comment">\until Global_Parameters::Impulsive_start_flag &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="comment">Next we set the physical and mesh parameters.</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="comment">\until ny=</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="comment">Finally we set up \c DocInfo objects and solve for both Taylor-Hood</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="comment">elements and Crouzeix-Raviart elements.</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="comment">\until end of main</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="comment">\section problem The problem class </span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="comment">The problem class remains similar to that in the </span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="comment">&lt;A HREF=&quot;../../rayleigh_channel/html/index.html&quot;&gt; previous</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="comment">example&lt;/A&gt;. Since we are no longer driving the flow by prescribing</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="comment">a time-periodic tangential velocity at the upper wall, the</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="comment">function \c actions_before_implicit_timestep() can remain empty.</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="comment">\dontinclude rayleigh_traction_channel.cc</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="comment">\skipline start_of_problem_class</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="comment">\until set_initial_condition</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;<span class="comment">The function \c create_traction_elements(...) (discussed in</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="comment">more detail below) creates the traction elements and &quot;attaches&quot;</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="comment">them to the specified boundary of the &quot;bulk&quot; mesh.</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="comment">\until surface_mesh_pt);</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="comment">The traction boundary condition sets the pressure so </span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="comment">the function \c fix_pressure(...)  used in the </span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="comment">&lt;A HREF=&quot;../../rayleigh_channel/html/index.html&quot;&gt; previous</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="comment">example&lt;/A&gt; is no longer required. The problem&#39;s private</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<span class="comment">member data contains pointers to the bulk and surface meshes</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;<span class="comment">and the output stream that we use to record the time-trace</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="comment">of the solution.</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;<span class="comment">\until end of problem_class </span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="comment">\section constructor The problem constructor</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;<span class="comment">We start by building the timestepper, determining its type from the</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="comment">class&#39;s second template argument, and pass a pointer to it to </span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="comment">the Problem, using the function \c Problem::add_time_stepper_pt(...).</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="comment">\skipline start_of_constructor</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="comment">\until add_time_stepper_pt</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="comment">Next we build the periodic bulk mesh,</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;<span class="comment">\until time_stepper_pt()</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;<span class="comment">and the surface mesh,</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;<span class="comment">\until new Mesh;</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;<span class="comment">and use the function \c create_traction_elements(...) to populate it </span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;<span class="comment">with traction elements that attach themselves to the specified </span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;<span class="comment">boundary (2) of the bulk mesh.</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;<span class="comment">\until create</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;<span class="comment"> We add both sub-meshes to the \c Problem, using the function</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="comment">\c Problem::add_sub_mesh(...) and use the function </span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="comment">\c Problem::build_global_mesh() to combine the sub-meshes into the</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="comment">\c Problem&#39;s single,  global mesh.</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="comment">\until build_global_mesh</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="comment">We apply Dirichlet boundary conditions where required: No-slip on </span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="comment">the stationary, lower wall, at \f$ x_2=0 \f$, parallel outflow </span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="comment">on the left and right boundaries, at \f$ x_1=0 \f$ and \f$ x_1=1 \f$.</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="comment">No velocity boundary conditions are applied at the &quot;upper&quot; boundary,</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="comment">at \f$ x_2=1 \f$, where the traction boundary condition is applied.</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;<span class="comment">\until end loop over boundaries</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;<span class="comment">Next we pass the pointers to the Reynolds and Strouhal numbers, </span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;<span class="comment">\f$ Re \f$, \f$ Re\, St \f$, to the bulk elements.</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;<span class="comment">\until }</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;<span class="comment">Finally we pass pointers to the applied traction function</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;<span class="comment">to the traction elements and assign the equation </span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;<span class="comment">numbers.</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;<span class="comment">\until end of constructor</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;<span class="comment">\section traction Create traction elements</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;<span class="comment">The creation of the traction elements is performed exactly </span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;<span class="comment">as in the &lt;A HREF=&quot;../../../poisson/two_d_poisson_flux_bc2/html/index.html&quot;&gt;</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<span class="comment">Poisson &lt;/A&gt; and </span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<span class="comment">&lt;A HREF=&quot;../../../unsteady_heat/two_d_unsteady_heat_adapt/html/index.html&quot;&gt;</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;<span class="comment">unsteady heat&lt;/A&gt; problems with flux boundary</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;<span class="comment">conditions, discussed earlier. We obtain pointers to the &quot;bulk&quot;</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="comment">elements that are adjacent to the specified boundary of the bulk mesh</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="comment">from the function \c Mesh::boundary_element_pt(...), determine which of the</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;<span class="comment">elements&#39; local coordinate(s) are constant along that boundary, and</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="comment">pass these parameters to the constructors of the traction elements</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;<span class="comment">which &quot;attach&quot; themselves to the appropriate face of the</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="comment">&quot;bulk&quot; element. Finally, we store the pointers to the newly created</span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;<span class="comment">traction elements in the surface mesh.</span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;<span class="comment">\skipline start_of_create_traction_elements</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;<span class="comment">\until  end of create_traction_elements</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;<span class="comment">\</span></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;<span class="comment">\section IC Initial conditions</span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<span class="comment">The function \c set_initial_conditions(...) remains the same as in the </span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="comment">&lt;A HREF=&quot;../../rayleigh_channel/html/index.html#IC&quot;&gt; previous</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="comment">example&lt;/A&gt;.</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;<span class="comment">\section doc Post processing</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;<span class="comment">The function \c doc_solution(...) remains the same as in the </span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;<span class="comment">&lt;A HREF=&quot;../../rayleigh_channel/html/index.html#doc&quot;&gt; previous</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;<span class="comment">example&lt;/A&gt;.</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;<span class="comment">\section unsteady_run The timestepping loop</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;<span class="comment">The function \c unsteady_run(...) remains the same as in the </span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;<span class="comment">&lt;A HREF=&quot;../../rayleigh_channel/html/index.html#unsteady_run&quot;&gt; previous</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;<span class="comment">example&lt;/A&gt;, except that the default number of timesteps is</span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;<span class="comment">increased to 500.</span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;<span class="comment">\section comments Comments and Exercises</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;<span class="comment">\subsection traction_theory How do the traction elements work?</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;<span class="comment">The finite element solution of the Navier-Stokes equations is</span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;<span class="comment">based on their weak form, obtained by weighting the</span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;<span class="comment">stress-divergence form of the momentum equations</span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;<span class="comment">Re\left(St\frac{\partial u_i}{\partial t} + </span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;<span class="comment">u_j\frac{\partial u_i}{\partial x_j}\right) =</span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;<span class="comment">\frac{\partial \tau_{ij}}{\partial x_j},</span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;<span class="comment"> \ \ \ \ \ \ \ \ \ \ (6)</span></div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;<span class="comment">with the global test functions \f$ \psi_l \f$, and integrating</span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;<span class="comment">by parts to obtain the discrete residuals</span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;<span class="comment">f_{il} = </span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;<span class="comment">\int_D \left[</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;<span class="comment">Re\left(St\frac{\partial u_i}{\partial t} + </span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;<span class="comment">u_j\frac{\partial u_i}{\partial x_j}\right)  \ \psi_l +</span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;<span class="comment"> \tau_{ij} \ \frac{\partial \psi_l}{\partial x_j}   \right] \, dV -</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;<span class="comment">\int_{\partial D}  \tau_{ij} \ n_j \ \psi_l \ dS = 0.</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;<span class="comment"> \ \ \ \ \ \ \ \ \ \ (7)</span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;<span class="comment">The volume integral in this residual is computed by</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;<span class="comment">the &quot;bulk&quot; Navier-Stokes elements. </span></div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="comment">&lt;A HREF=&quot;../../../intro/html/index.html#galerkin&quot;&gt;Recall&lt;/A&gt; </span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;<span class="comment">that in the residual </span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;<span class="comment">for the \f$ i \f$ -th momentum equation, the global test functions </span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;<span class="comment">\f$ \psi_l \f$ vanish on those parts of the domain boundary </span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;<span class="comment">\f$ \partial D\f$ where the \f$ i \f$ -th</span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;<span class="comment">velocity component is prescribed by Dirichlet boundary conditions.</span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;<span class="comment">On such boundaries, the surface integral in</span></div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;<span class="comment">(7) vanishes</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;<span class="comment">because \f$ \psi_l=0. \f$ If the velocity on a certain part of the</span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;<span class="comment">domain boundary, \f$ \partial D_{natural} \subset \partial D\f$, </span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;<span class="comment">is not prescribed by Dirichlet boundary conditions and the</span></div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;<span class="comment">surface integral over \f$ \partial D_{natural} \f$ is not added </span></div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;<span class="comment">to the discrete residual, the velocity degrees of freedom on those</span></div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;<span class="comment">boundaries are regarded as unknowns and the &quot;traction-free&quot;</span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;<span class="comment">(or natural) boundary condition</span></div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;<span class="comment">\tau_{ij} \ n_j = 0 \mbox{ \ \ \ on \ \  $\partial D_{natural}$}</span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;<span class="comment">is &quot;implied&quot;. Finally, traction boundary conditions of the form</span></div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;<span class="comment">(1) may be applied along a</span></div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;<span class="comment">part, \f$ \partial D_{traction} \subset \partial D\f$, of the </span></div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;<span class="comment">domain boundary. The surface integral along this part of the</span></div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;<span class="comment">domain boundary is given by</span></div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;<span class="comment">\int_{\partial D_{traction} }  \tau_{ij} \ n_j \ \psi_l \ dS = </span></div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;<span class="comment">\int_{\partial D_{traction} }  t_i^{[prescribed]} \ \psi_l \ dS,</span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;<span class="comment"> \ \ \ \ \ \ \ \ \ \ (8)</span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;<span class="comment">where  \f$ t_i^{[prescribed]}  \f$ is given,</span></div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;<span class="comment">and it is this contribution that the traction elements add </span></div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;<span class="comment">to the residual of the momentum equations. </span></div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;<span class="comment"> </span></div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;<span class="comment">\subsection ex Exercises</span></div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;<span class="comment">-# Pin the vertical velocity along the upper boundary, \f$ x_2 = 1\f$,</span></div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;<span class="comment">   and compare the results against those obtained with the original </span></div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;<span class="comment">   version of the code. How does the change affect the velocity field?</span></div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;<span class="comment">   Why is pressure likely to change?</span></div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;<span class="comment">-# Pin the horizontal velocity along the upper boundary, \f$ x_2 = 1\f$,</span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;<span class="comment">   and start the simulation with an impulsive start. </span></div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;<span class="comment">   Compare the results against those obtained with the original</span></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;<span class="comment">   version of the code and explain your findings, referring to the</span></div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;<span class="comment">   theory provided in the section \ref traction_theory .</span></div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;<span class="comment">-# Run the code with an impulsive start and confirm that it takes</span></div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;<span class="comment">   longer for the solution to approach the time-periodic</span></div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;<span class="comment">   solution than in the </span></div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;<span class="comment">   &lt;A HREF=&quot;../../rayleigh_channel/html/index.html&quot;&gt;  previous case&lt;/A&gt; </span></div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;<span class="comment">   where the flow was driven by the wall motion. [Here are some</span></div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;<span class="comment">   animations of the velocity fields obtained following </span></div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;<span class="comment">   an impulsive start, for a discretisation with </span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;<span class="comment">   &lt;A HREF=&quot;../figures/velocity_vectors_TH.avi&quot;&gt; Taylor-Hood</span></div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;<span class="comment">   elements&lt;/A&gt; and &lt;A HREF=&quot;../figures/velocity_vectors_CR.avi&quot;&gt; </span></div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;<span class="comment">   Crouzeix-Raviart elements&lt;/A&gt;.]</span></div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;<span class="comment">-# Investigate the effects of applying a non-zero value for \f$ t_2</span></div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;<span class="comment">   \f$ on the top boundary.</span></div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;<span class="comment">\section sources Source files for this tutorial</span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;<span class="comment">- The source files for this tutorial are located in the directory:</span></div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;<span class="comment">&lt;CENTER&gt;</span></div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;<span class="comment">&lt;A HREF=&quot;../../../../demo_drivers/navier_stokes/rayleigh_traction_channel/&quot;&gt;</span></div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;<span class="comment">demo_drivers/navier_stokes/rayleigh_traction_channel/</span></div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;<span class="comment">&lt;/A&gt;</span></div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;<span class="comment">&lt;/CENTER&gt;</span></div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;<span class="comment">- The driver code is:</span></div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;<span class="comment">&lt;CENTER&gt;</span></div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;<span class="comment">&lt;A HREF=&quot;../../../../demo_drivers/navier_stokes/rayleigh_traction_channel/rayleigh_traction_channel.cc&quot;&gt;</span></div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;<span class="comment">demo_drivers/navier_stokes/rayleigh_traction_channel/rayleigh_traction_channel.cc</span></div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;<span class="comment">&lt;/A&gt;</span></div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;<span class="comment">&lt;/CENTER&gt;</span></div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;<span class="comment">.</span></div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;<span class="comment">&lt;hr&gt;</span></div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;<span class="comment">&lt;hr&gt;</span></div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;<span class="comment">\section pdf PDF file</span></div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;<span class="comment">A &lt;a href=&quot;../latex/refman.pdf&quot;&gt;pdf version&lt;/a&gt; of this document is available.</span></div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;<span class="comment">**/</span></div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160; </div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="arayleigh__traction__channel_8txt_html_ad37339aba2062c36c10b89b43966b78d"><div class="ttname"><a href="rayleigh__traction__channel_8txt.html#ad37339aba2062c36c10b89b43966b78d">omega</a></div><div class="ttdeci">right E[2DNavierStokes_BC1] f on the stationary f partial on the upper f partial parallel flow solution We choose the prescribed traction respectively In both cases we set f omega</div><div class="ttdef"><b>Definition:</b> <a href="rayleigh__traction__channel_8txt_source.html#l00130">rayleigh_traction_channel.txt:130</a></div></div>
<div class="ttc" id="arayleigh__traction__channel_8txt_html_a61b3efba5ec4753fd9efffbd2acfcaa5"><div class="ttname"><a href="rayleigh__traction__channel_8txt.html#a61b3efba5ec4753fd9efffbd2acfcaa5">delta_</a></div><div class="ttdeci">mainpage Example driven by an applied traction In this example we consider a variation of the unsteady channel flow problem considered elsewhere In the&lt; A HREF=&quot;../../rayleigh_channel/html/index.html&quot;&gt; previous example&lt;/A &gt; the flow was driven by the imposed wall motion Here we shall consider the case in which the flow is driven by an applied traction horizontal boundary of the channel Here f n_j f is the outward unit f delta_</div><div class="ttdef"><b>Definition:</b> <a href="rayleigh__traction__channel_8txt_source.html#l00017">rayleigh_traction_channel.txt:17</a></div></div>
<div class="ttc" id="anamespaceGlobal__Parameters_html_a7a59a32365e87566069e458dc83bd18a"><div class="ttname"><a href="namespaceGlobal__Parameters.html#a7a59a32365e87566069e458dc83bd18a">Global_Parameters::ReSt</a></div><div class="ttdeci">double ReSt</div><div class="ttdoc">Womersley = Reynolds times Strouhal.</div><div class="ttdef"><b>Definition:</b> <a href="rayleigh__traction__channel_8cc_source.html#l00048">rayleigh_traction_channel.cc:48</a></div></div>
<div class="ttc" id="arayleigh__traction__channel_8txt_html_a2b46f734a1a4daa4920f680aefac42f2"><div class="ttname"><a href="rayleigh__traction__channel_8txt.html#a2b46f734a1a4daa4920f680aefac42f2">problem</a></div><div class="ttdeci">mainpage Example problem</div><div class="ttdef"><b>Definition:</b> <a href="rayleigh__traction__channel_8txt_source.html#l00001">rayleigh_traction_channel.txt:1</a></div></div>
<div class="ttc" id="arayleigh__traction__channel_8txt_html_a5c1ca9c8c364d5f1f24b554747fa1140"><div class="ttname"><a href="rayleigh__traction__channel_8txt.html#a5c1ca9c8c364d5f1f24b554747fa1140">D_</a></div><div class="ttdeci">right E[2DNavierStokes_BC1] f on the stationary f partial D_</div><div class="ttdef"><b>Definition:</b> <a href="rayleigh__traction__channel_8txt_source.html#l00072">rayleigh_traction_channel.txt:72</a></div></div>
<div class="ttc" id="arayleigh__traction__channel_8txt_html_a02e34db161a7ba9c2e3e83c88d1c0118"><div class="ttname"><a href="rayleigh__traction__channel_8txt.html#a02e34db161a7ba9c2e3e83c88d1c0118">f</a></div><div class="ttdeci">mainpage Example driven by an applied traction In this example we consider a variation of the unsteady channel flow problem considered elsewhere In the&lt; A HREF=&quot;../../rayleigh_channel/html/index.html&quot;&gt; previous example&lt;/A &gt; the flow was driven by the imposed wall motion Here we shall consider the case in which the flow is driven by an applied traction f</div><div class="ttdef"><b>Definition:</b> <a href="rayleigh__traction__channel_8txt_source.html#l00008">rayleigh_traction_channel.txt:8</a></div></div>
<div class="ttc" id="arayleigh__traction__channel_8txt_html_a45ee3e745fcae0c16dfb588971759e25"><div class="ttname"><a href="rayleigh__traction__channel_8txt.html#a45ee3e745fcae0c16dfb588971759e25">wall</a></div><div class="ttdeci">right E[2DNavierStokes_BC1] f on the stationary wall</div><div class="ttdef"><b>Definition:</b> <a href="rayleigh__traction__channel_8txt_source.html#l00072">rayleigh_traction_channel.txt:72</a></div></div>
<div class="ttc" id="arayleigh__traction__channel_8txt_html_ac21b320bf98c8470afd5d2b42f5a4f17"><div class="ttname"><a href="rayleigh__traction__channel_8txt.html#ac21b320bf98c8470afd5d2b42f5a4f17">lower</a></div><div class="ttdeci">right E[2DNavierStokes_BC1] f on the lower</div><div class="ttdef"><b>Definition:</b> <a href="rayleigh__traction__channel_8txt_source.html#l00072">rayleigh_traction_channel.txt:72</a></div></div>
<div class="ttc" id="anamespaceGlobal__Parameters_html_aec41eb8da4929003e5d78ef4b43c0ed9"><div class="ttname"><a href="namespaceGlobal__Parameters.html#aec41eb8da4929003e5d78ef4b43c0ed9">Global_Parameters::Impulsive_start_flag</a></div><div class="ttdeci">unsigned Impulsive_start_flag</div><div class="ttdoc">Flag for impulsive start: Default = start from exact time-periodic solution.</div><div class="ttdef"><b>Definition:</b> <a href="rayleigh__traction__channel_8cc_source.html#l00055">rayleigh_traction_channel.cc:55</a></div></div>
<div class="ttc" id="arayleigh__traction__channel_8txt_html_acd5361a9c3445f52db53d61311570688"><div class="ttname"><a href="rayleigh__traction__channel_8txt.html#acd5361a9c3445f52db53d61311570688">normal</a></div><div class="ttdeci">mainpage Example driven by an applied traction In this example we consider a variation of the unsteady channel flow problem considered elsewhere In the&lt; A HREF=&quot;../../rayleigh_channel/html/index.html&quot;&gt; previous example&lt;/A &gt; the flow was driven by the imposed wall motion Here we shall consider the case in which the flow is driven by an applied traction horizontal boundary of the channel Here f n_j f is the outward unit normal</div><div class="ttdef"><b>Definition:</b> <a href="rayleigh__traction__channel_8txt_source.html#l00017">rayleigh_traction_channel.txt:17</a></div></div>
<div class="ttc" id="arayleigh__traction__channel_8cc_html_a0ddf1224851353fc92bfbff6f499fa97"><div class="ttname"><a href="rayleigh__traction__channel_8cc.html#a0ddf1224851353fc92bfbff6f499fa97">main</a></div><div class="ttdeci">int main(int argc, char *argv[])</div><div class="ttdoc">Driver code for Rayleigh-type problem.</div><div class="ttdef"><b>Definition:</b> <a href="rayleigh__traction__channel_8cc_source.html#l00537">rayleigh_traction_channel.cc:537</a></div></div>
<div class="ttc" id="anamespaceGlobal__Parameters_html"><div class="ttname"><a href="namespaceGlobal__Parameters.html">Global_Parameters</a></div><div class="ttdoc">Namepspace for global parameters.</div><div class="ttdef"><b>Definition:</b> <a href="rayleigh__traction__channel_8cc_source.html#l00042">rayleigh_traction_channel.cc:42</a></div></div>
<div class="ttc" id="arayleigh__traction__channel_8txt_html_a1bb7408df5f27e156f26c84cf899b75d"><div class="ttname"><a href="rayleigh__traction__channel_8txt.html#a1bb7408df5f27e156f26c84cf899b75d">boundary</a></div><div class="ttdeci">right E[2DNavierStokes_BC1] f on the stationary f partial on the upper boundary</div><div class="ttdef"><b>Definition:</b> <a href="rayleigh__traction__channel_8txt_source.html#l00079">rayleigh_traction_channel.txt:79</a></div></div>
<div class="ttc" id="arayleigh__traction__channel_8txt_html_af2518d923442411850d5c85b9822ed04"><div class="ttname"><a href="rayleigh__traction__channel_8txt.html#af2518d923442411850d5c85b9822ed04">_</a></div><div class="ttdeci">right _</div><div class="ttdef"><b>Definition:</b> <a href="rayleigh__traction__channel_8txt_source.html#l00069">rayleigh_traction_channel.txt:69</a></div></div>
<div class="ttc" id="arayleigh__traction__channel_8txt_html_a9ee216bbe33912fa70fdb9dfae7725e9"><div class="ttname"><a href="rayleigh__traction__channel_8txt.html#a9ee216bbe33912fa70fdb9dfae7725e9">condition</a></div><div class="ttdeci">right E[2DNavierStokes_BC1] f on the stationary f partial on the upper f partial parallel flow solution We choose the prescribed traction respectively In both cases we set f time periodic solution as the initial condition</div><div class="ttdef"><b>Definition:</b> <a href="rayleigh__traction__channel_8txt_source.html#l00132">rayleigh_traction_channel.txt:132</a></div></div>
<div class="ttc" id="arayleigh__traction__channel_8txt_html_a8ec7de031cee1688bd5b20f58544271a"><div class="ttname"><a href="rayleigh__traction__channel_8txt.html#a8ec7de031cee1688bd5b20f58544271a">run</a></div><div class="ttdeci">namespace to define the problem parameters the Reynolds number f Re f and the Womersley number f Re St f We also provide two flags that indicate the length of the run(to allow a short run to be performed when the code is run as a self-test)</div></div>
<div class="ttc" id="arayleigh__traction__channel_8txt_html_a1a9a36ce57fdac8b7c27c9b6e9e5dbb7"><div class="ttname"><a href="rayleigh__traction__channel_8txt.html#a1a9a36ce57fdac8b7c27c9b6e9e5dbb7">Dirichlet</a></div><div class="ttdeci">mainpage Example driven by an applied traction In this example we consider a variation of the unsteady channel flow problem considered elsewhere In the&lt; A HREF=&quot;../../rayleigh_channel/html/index.html&quot;&gt; previous example&lt;/A &gt; the flow was driven by the imposed wall motion Here we shall consider the case in which the flow is driven by an applied traction horizontal boundary of the channel Here f n_j f is the outward unit f driven by an applied traction&lt;/B &gt;&lt;/CENTER &gt; Here is a sketch of the f[Re\left(St\frac{\partial u_i}{\partial t}+u_j\frac{\partial u_i}{\partial x_j}\right)=- \frac{\partial p}{\partial x_i}+\frac{\partial }{\partial x_j} \left(\frac{\partial u_i}{\partial x_j}+\frac{\partial u_j}{\partial x_i} \right), \ \ \ \ \ \ \ \ \ \ @E[2DNavierStokes]@\f] and f[\frac{\partial u_i}{\partial x_i}=0,\f] in the square domain f[D=\bigg\{(x_1, x_2) \|\ x_1 \in[0, 1], \ x_2 \in[0, 1] \bigg\}.\f] We apply the Dirichlet(no-slip) boundary condition \f[\left. \mathbf</div><div class="ttdef"><b>Definition:</b> <a href="rayleigh__traction__channel_8txt_source.html#l00067">rayleigh_traction_channel.txt:67</a></div></div>
<div class="ttc" id="arayleigh__traction__channel_8txt_html_a9fe39ef33bc6e6ee9c7d4b01d86aeb13"><div class="ttname"><a href="rayleigh__traction__channel_8txt.html#a9fe39ef33bc6e6ee9c7d4b01d86aeb13">solution</a></div><div class="ttdeci">namespace to define the problem parameters the Reynolds number f Re f and the Womersley number f Re St f We also provide two flags that indicate the length of the and the initial parallel flow and the traction and with initial conditions corresponding to an impulsive start or a start from the time periodic exact solution(indicated by the second command line argument being 1 or 0, respectively). If no command line arguments are specified the code is run in the default mode</div></div>
<div class="ttc" id="arayleigh__traction__channel_8txt_html_a2a594229ff9b6ac8526cee7a6b1df06d"><div class="ttname"><a href="rayleigh__traction__channel_8txt.html#a2a594229ff9b6ac8526cee7a6b1df06d">Re</a></div><div class="ttdeci">right E[2DNavierStokes_BC1] f on the stationary f partial on the upper f partial parallel flow solution We choose the prescribed traction respectively In both cases we set f Re</div><div class="ttdef"><b>Definition:</b> <a href="rayleigh__traction__channel_8txt_source.html#l00130">rayleigh_traction_channel.txt:130</a></div></div>

    <!-- jQuery for Bootstrap and Doxygen -->
    <script src="../../../js/jquery-1.12.0.min.js"></script>
    <!-- Minified boostrap plugins-->
    <script src="../../../js/bootstrap.js"></script>
    <!-- Doxygen dependency to add powertips to source code-->
    <script src="../../../js/jquery.powertip.min.js"></script>
    <!-- The  following script is generated by doxygen and hides/shows levels in 
         the data structure lists and adds powertips to source code-->
    <script src="../../../js/dynsections.js" ></script>
    <!-- add to Doxygen's class names so bootstrap css and js recognises them-->
    <script type="text/javascript">
    $(".contents").addClass("container");
    $(".header").addClass("container");
    $(".navpath").addClass("container");
    $("#navrow3").addClass("container");
    $("#navrow4").addClass("container");
    $(".mlabel").addClass("label");
    $(".mlabel").addClass("label-default");
    $(".memitem").addClass("panel");
    $(".memitem").addClass("panel-info");
    $(".memproto").addClass("panel-heading");
    $(".memdoc").addClass("panel-body");
    </script>
    <footer>
      <div class="container">
        <div class="text-muted" style="float:right;">Generated by <a href="http://www.doxygen.org/index.html">
          <img style="height:18px;" class="footer-img" src="doxygen.png" alt="doxygen"></a> on Fri Jul 9 2021 15:09:20
        </div>
      </div>
    </footer>
</body>
</html>

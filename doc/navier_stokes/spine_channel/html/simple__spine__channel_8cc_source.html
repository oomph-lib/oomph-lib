<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
<title>oomph-lib: simple_spine_channel.cc Source File</title>
<link rel="apple-touch-icon" sizes="57x57" href="../../../figures/apple-touch-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="../../../figures/apple-touch-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="../../../figures/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="../../../figures/apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="../../../figures/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="../../../figures/apple-touch-icon-120x120.png">
<link rel="icon" type="image/png" href="../../../figures/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="../../../figures/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="../../../figures/favicon-16x16.png" sizes="16x16">
<link rel="manifest" href="../../../figures/manifest.json">
<link rel="mask-icon" href="../../../figures/safari-pinned-tab.svg" color="#008000">
<link rel="shortcut icon" href="../../../figures/favicon.ico">
<meta name="msapplication-TileColor" content="#00a300">
<meta name="msapplication-config" content="../../../figures/browserconfig.xml">
<meta name="theme-color" content="#008000">
<link href="http://fonts.googleapis.com/css?family=Open+Sans:400,300,600" rel="stylesheet" type="text/css">
<!-- Doxygen css-->
<!-- <link rel="stylesheet" type="text/css" href="doxygen.css"> -->
<!-- Bootstrap -->
<link href="../../../css/bootstrap.css" rel="stylesheet">
<!-- oomph-lib specific overrides -->
<link rel="stylesheet" type="text/css" href="../../../css/oomph_header.css">
</head>
<body>
<nav class="navbar navbar-default">
<div class="container">
<div class="container-fluid">
  <!-- Brand and toggle get grouped for better mobile display -->
  <div class="navbar-header">
    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
      <span class="sr-only">Toggle navigation</span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="../../../html/index.html"><img alt="oomph-lib" src="../../../figures/oomph_logo.png"></a>
  </div>
  <!-- Collect the nav links, forms, and other content for toggling -->
  <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
    <ul class="nav navbar-nav">          
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Documentation <span class="caret"></span></a>
        <ul class="dropdown-menu">
          <li class="dropdown-header">Big picture</li>
          <li><a href="../../../../doc/intro/html/index.html">The finite element method</a></li>
          <li><a href="../../../../doc/the_data_structure/html/index.html">The data structure</a></li>
          <li><a href="../../../../doc/quick_guide/html/index.html">Not-so-quick guide</a></li>
          <li><a href="../../../../doc/optimisation/html/index.html">Optimisation</a></li>
          <li><a href="../../../../doc/order_of_action_functions/html/index.html">Order of action functions</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Example codes and tutorials</li>
          <li><a href="../../../../doc/example_code_list/html/index.html">List of example codes and tutorials</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#meshes">Meshing</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#solvers">Solvers</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#parallel">MPI parallel processing</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#visualisation">Post-processing/visualisation</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Other</li>
          <li><a href="../../../../doc/change_log/html/index.html">Change log</a></li>
          <li><a href="../../../../doc/creating_doc/html/index.html">Creating documentation</a></li>
          <li><a href="../../../../doc/coding_conventions/html/index.html">Coding conventions</a></li>
          <li><a href="../../../../doc/index/html/index.html">Index</a></li>
          <li><a href="../../../../doc/FAQ/html/index.html">FAQ</a></li>
        </ul>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Get it <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../../doc/the_distribution/html/index.html">Installation guide</a></li>
            <li><a href="../../../../doc/subversion/html/index.html">Get code from subversion repository</a></li>
            <li><a href="../../../../doc/download/html/index.html">Get code as tar file</a></li>
            <li><a href="../../../../doc/copyright/html/index.html">Copyright</a></li>
          </ul>
        </li>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">About <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../../doc/people/html/index.html">People</a></li>            
            <li><a href="../../../../doc/contact/html/index.html">Contact/Get involved</a></li>
            <li><a href="../../../../doc/publications/html/index.html">Publications</a></li>
            <li><a href="../../../../doc/acknowledgements/html/index.html">Acknowledgements</a></li>
            <li><a href="../../../../doc/picture_show/index.html">Picture show</a></li>
          </ul>
        </li>
      </li>
    </ul>
    <ul class="nav navbar-nav navbar-right navbar-search">
      <form class="navbar-form" role="search" action="../../../../doc/search_results/html/index.html">
        <div class="input-group">
          <input type="text" class="form-control" placeholder="Search" name="q">
          <span class="input-group-btn">
            <button class="btn btn-default" type="submit">Go</button>
          </span>
        </div><!-- /input-group -->
       <!--<div class="form-group">
          <input type="text" class="form-control" placeholder="Search">
        </div>
        <button type="submit" class="btn btn-default">Submit</button>-->
      </form>
    </ul>
  </div><!-- /.navbar-collapse -->
</div><!-- /.container-fluid -->
</div>
</nav>
<!-- Generated by Doxygen 1.8.17 -->
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_ddb094a380b94394dbbcf95a63b535e6.html">demo_drivers</a></li><li class="navelem"><a class="el" href="dir_600eb748837abd3a599f824dcb8c690e.html">navier_stokes</a></li><li class="navelem"><a class="el" href="dir_43c088749fe9b13db603f1386668d16b.html">spine_channel</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">simple_spine_channel.cc</div>  </div>
</div><!--header-->
<div class="contents">
<a href="simple__spine__channel_8cc.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">//LIC// ====================================================================</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">//LIC// This file forms part of oomph-lib, the object-oriented, </span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">//LIC// multi-physics finite-element library, available </span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">//LIC// at http://www.oomph-lib.org.</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">//LIC// Copyright (C) 2006-2021 Matthias Heil and Andrew Hazel</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">//LIC// This library is free software; you can redistribute it and/or</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">//LIC// modify it under the terms of the GNU Lesser General Public</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">//LIC// License as published by the Free Software Foundation; either</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">//LIC// version 2.1 of the License, or (at your option) any later version.</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">//LIC// This library is distributed in the hope that it will be useful,</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">//LIC// but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">//LIC// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">//LIC// Lesser General Public License for more details.</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">//LIC// You should have received a copy of the GNU Lesser General Public</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">//LIC// License along with this library; if not, write to the Free Software</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">//LIC// Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">//LIC// 02110-1301  USA.</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">//LIC// The authors may be contacted at oomph-lib@maths.man.ac.uk.</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">//LIC//====================================================================</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">// Driver for 2-D Channel with changing width, using Taylor Hood </span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">// and Crouzeix Raviart elements.</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160; </div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment">// Generic oomph-lib header</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#include &quot;generic.h&quot;</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160; </div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment">// Navier Stokes headers</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#include &quot;navier_stokes.h&quot;</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160; </div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment">// The mesh</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#include &quot;meshes/simple_rectangular_quadmesh.h&quot;</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160; </div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="keyword">using namespace </span>std;</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160; </div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="keyword">using namespace </span>oomph;</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment">///////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment">///////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160; </div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160; </div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment">//=========================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment">/// Geometric object representing a wavy wall, parametrised by</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment">///  \f[ x = \zeta \f]</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment">///  \f[ y = A (1 - \cos(2\pi\zeta/L) )\f]</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment"></span><span class="comment">//=========================================================================</span></div>
<div class="line"><a name="l00052"></a><span class="lineno"><a class="line" href="classWavyWall.html">   52</a></span>&#160;<span class="keyword">class </span><a class="code" href="classWavyWall.html">WavyWall</a> : <span class="keyword">public</span> GeomObject</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;{</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160; </div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="comment"> /// \short Constructor:  Pass wavelength and amplitude</span></div>
<div class="line"><a name="l00058"></a><span class="lineno"><a class="line" href="classWavyWall.html#a7ef7a36cbce8798c1e4a99165dee8cc0">   58</a></span>&#160;<span class="comment"></span> <a class="code" href="classWavyWall.html#a7ef7a36cbce8798c1e4a99165dee8cc0">WavyWall</a>(<span class="keyword">const</span> <span class="keywordtype">double</span>&amp; l, <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; amplitude)</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  : GeomObject(1,2), <a class="code" href="spine__channel_8txt.html#a96c0ab3a0b092769001018d4f44e37ff">L</a>(l), <a class="code" href="spine__channel_8txt.html#a6278222265b62552409f8aac35d11539">A</a>(amplitude) {}</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment"> /// Position vector to wavy wall.</span></div>
<div class="line"><a name="l00062"></a><span class="lineno"><a class="line" href="classWavyWall.html#a9a9f5a98cb0d15ee801b52495be5e5bf">   62</a></span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classWavyWall.html#a9a9f5a98cb0d15ee801b52495be5e5bf">position</a>(<span class="keyword">const</span> Vector&lt;double&gt;&amp; zeta, Vector&lt;double&gt;&amp; r)<span class="keyword"> const</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;   r[0]=zeta[0];</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;   r[1]=<a class="code" href="spine__channel_8txt.html#a6278222265b62552409f8aac35d11539">A</a>*(1.0-cos(2.0*MathematicalConstants::Pi*zeta[0]/<a class="code" href="spine__channel_8txt.html#a96c0ab3a0b092769001018d4f44e37ff">L</a>));</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  }</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160; </div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="keyword">protected</span>:</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="comment"> /// Wavelength</span></div>
<div class="line"><a name="l00071"></a><span class="lineno"><a class="line" href="classWavyWall.html#a598b42ece2600db9eb8c4d1dfeca9ad1">   71</a></span>&#160;<span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="classWavyWall.html#a598b42ece2600db9eb8c4d1dfeca9ad1">L</a>;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment"> /// Amplitude </span></div>
<div class="line"><a name="l00074"></a><span class="lineno"><a class="line" href="classWavyWall.html#a435f0fb4db45b51eb371b66b244c7630">   74</a></span>&#160;<span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="classWavyWall.html#a435f0fb4db45b51eb371b66b244c7630">A</a>;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160; </div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160; </div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;};</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160; </div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="comment">///////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="comment">///////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160; </div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="comment">//======================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="comment">/// Simple spine mesh class derived from standard 2D mesh.</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="comment">/// Vertical lines of nodes are located on spines.</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="comment"></span><span class="comment">//======================================================================</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> ELEMENT&gt;</div>
<div class="line"><a name="l00089"></a><span class="lineno"><a class="line" href="classSimpleSpineMesh.html">   89</a></span>&#160;<span class="keyword">class </span><a class="code" href="classSimpleSpineMesh.html">SimpleSpineMesh</a> : <span class="keyword">public</span> SimpleRectangularQuadMesh&lt;ELEMENT &gt;, </div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;                        <span class="keyword">public</span> SpineMesh</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;{</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160; </div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="comment"> /// \short Constructor: Pass number of elements in x-direction,</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment"> /// number of elements in y-direction, length in x direction, initial </span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="comment"> /// height of mesh, and pointer to timestepper (defaults to </span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="comment"> /// Steady timestepper)</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="comment"></span> <a class="code" href="classSimpleSpineMesh.html">SimpleSpineMesh</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;nx, </div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;                 <span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;ny,</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;                 <span class="keyword">const</span> <span class="keywordtype">double</span> &amp;lx, </div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;                 <span class="keyword">const</span> <span class="keywordtype">double</span> &amp;h, </div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;                 GeomObject* substrate_pt,</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;                 TimeStepper* time_stepper_pt=&amp;Mesh::Default_TimeStepper);</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160; </div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="comment"> /// \short Function pointer to  function, h(x), that may be used </span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="comment"> /// to specify the &quot;height&quot; of the domain, by assigning the function</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="comment"> /// values to the spine heights.</span></div>
<div class="line"><a name="l00110"></a><span class="lineno"><a class="line" href="classSimpleSpineMesh.html#a671d96f0143dfeb7aaba8af56c0c0620">  110</a></span>&#160;<span class="comment"></span> <span class="keyword">typedef</span> double (*HeightFctPt)(<span class="keyword">const</span> <span class="keywordtype">double</span>&amp; x);</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="comment"> /// Access function: Pointer to height function</span></div>
<div class="line"><a name="l00113"></a><span class="lineno"><a class="line" href="classSimpleSpineMesh.html#af84290225b4aea3fd6ba27ad979059a0">  113</a></span>&#160;<span class="comment"></span> HeightFctPt&amp; <a class="code" href="classSimpleSpineMesh.html#af84290225b4aea3fd6ba27ad979059a0">height_fct_pt</a>() </div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  {</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;   <span class="keywordflow">return</span> Height_fct_pt;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  }</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160; </div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="comment"> /// \short Height function -- this is called by update_spine_heights()</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="comment"> /// when spine heights are assigned.</span></div>
<div class="line"><a name="l00121"></a><span class="lineno"><a class="line" href="classSimpleSpineMesh.html#a99398fc7ef50db36d30f6c1d01aa3758">  121</a></span>&#160;<span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="classSimpleSpineMesh.html#a99398fc7ef50db36d30f6c1d01aa3758">height_fct</a>(<span class="keyword">const</span> <span class="keywordtype">double</span>&amp; x) </div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  {</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;   <span class="comment">// Resolve function pointer if non-NULL</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;   <span class="keywordflow">if</span> (Height_fct_pt==0)</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    {</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;     <span class="keywordflow">return</span> Default_height;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    }</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;   <span class="keywordflow">else</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;   {</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <span class="keywordflow">return</span> Height_fct_pt(x);</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;   }</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  }</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160; </div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="comment"> /// \short Update the spine heights according to the function specified</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="comment"> /// by height_fct_pt().</span></div>
<div class="line"><a name="l00137"></a><span class="lineno"><a class="line" href="classSimpleSpineMesh.html#a2248fb8df448b0a02377a0cfb6f57851">  137</a></span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classSimpleSpineMesh.html#a2248fb8df448b0a02377a0cfb6f57851">update_spine_heights</a>()</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;  {</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;   <span class="keywordtype">unsigned</span> n_spine=nspine();</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i=0;i&lt;n_spine;i++)</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    {</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;     <span class="comment">// Zero-th geometric parameter of the spine is the x-coordinate</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;     <span class="comment">// of its basis</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;     <span class="keywordtype">double</span> x=spine_pt(i)-&gt;geom_parameter(0);</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160; </div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;     <span class="comment">// Set spine height</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;     spine_pt(i)-&gt;height()=height_fct(x);</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    }</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;  }</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160; </div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="comment"> /// \short General node update function implements pure virtual function </span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="comment"> /// defined in SpineMesh base class and performs specific node update</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="comment"> /// actions: Nodes are located along vertical &quot;spines&quot; that emanate</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="comment"> /// from the &quot;substrate&quot; (the lower wall) specified by a</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="comment"> /// GeomObject.</span></div>
<div class="line"><a name="l00157"></a><span class="lineno"><a class="line" href="classSimpleSpineMesh.html#a4735e047eab146cafc3090f829373ef2">  157</a></span>&#160;<span class="comment"></span> <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classSimpleSpineMesh.html#a4735e047eab146cafc3090f829373ef2">spine_node_update</a>(SpineNode* spine_node_pt)</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  {</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160; </div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;   <span class="comment">//Get fraction along the spine</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;   <span class="keywordtype">double</span> w = spine_node_pt-&gt;fraction();</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;   </div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;   <span class="comment">// Get height of spine</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;   <span class="keywordtype">double</span> h = spine_node_pt-&gt;spine_pt()-&gt;height();</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160; </div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;   <span class="comment">// Get x-position of spine origin (as vector)</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;   Vector&lt;double&gt; x_spine_origin(1);</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;   x_spine_origin[0]=spine_node_pt-&gt;spine_pt()-&gt;geom_parameter(0);</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;   </div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;   <span class="comment">// Get position vector to substrate (lower wall) for this spine</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;   Vector&lt;double&gt; spine_base(2);</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;   spine_node_pt-&gt;spine_pt()-&gt;geom_object_pt(0)-&gt;</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    position(x_spine_origin,spine_base);</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;     </div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;   <span class="comment">//Update the nodal position</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;   spine_node_pt-&gt;x(0) = spine_base[0];</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;   spine_node_pt-&gt;x(1) = spine_base[1]+w*h;</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;  }</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160; </div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160; </div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="comment"> /// Default height</span></div>
<div class="line"><a name="l00184"></a><span class="lineno"><a class="line" href="classSimpleSpineMesh.html#a7a6d3f655da48ed9d18f6ca8e29f6576">  184</a></span>&#160;<span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="classSimpleSpineMesh.html#a7a6d3f655da48ed9d18f6ca8e29f6576">Default_height</a>;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="comment"> /// Pointer to height function</span></div>
<div class="line"><a name="l00187"></a><span class="lineno"><a class="line" href="classSimpleSpineMesh.html#ac0509d0d0868d37ef87834b39d2a084b">  187</a></span>&#160;<span class="comment"></span> HeightFctPt <a class="code" href="classSimpleSpineMesh.html#ac0509d0d0868d37ef87834b39d2a084b">Height_fct_pt</a>;</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<span class="comment"> /// Pointer to GeomObject that specifies the &quot;substrate&quot; (the lower wall)</span></div>
<div class="line"><a name="l00190"></a><span class="lineno"><a class="line" href="classSimpleSpineMesh.html#a9031e27d5855e029312d356f6a38da76">  190</a></span>&#160;<span class="comment"></span> GeomObject* <a class="code" href="classSimpleSpineMesh.html#a9031e27d5855e029312d356f6a38da76">Substrate_pt</a>;</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160; </div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;};</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160; </div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160; </div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160; </div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="comment">//===========================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="comment">/// Constructor for spine 2D mesh: Pass number of elements in x-direction, </span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="comment">/// number of elements in y-direction, axial length and height of layer, </span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="comment">/// pointer to geometric object that specifies the substrate (the lower wall)</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="comment">/// and pointer to timestepper (defaults to Static timestepper).</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="comment">/// The mesh contains a layer of spine-ified fluid elements (of type ELEMENT;</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="comment">/// e.g  SpineElement&lt;QCrouzeixRaviartElement&lt;2&gt;)</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="comment"></span><span class="comment">//===========================================================================</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> ELEMENT&gt;</div>
<div class="line"><a name="l00206"></a><span class="lineno"><a class="line" href="classSimpleSpineMesh.html#a69815e3a950e6e5ede2f85004796dadb">  206</a></span>&#160;<a class="code" href="classSimpleSpineMesh.html#a69815e3a950e6e5ede2f85004796dadb">SimpleSpineMesh&lt;ELEMENT&gt;::SimpleSpineMesh</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;nx, </div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;                                          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;ny,</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;                                          <span class="keyword">const</span> <span class="keywordtype">double</span> &amp;lx, </div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;                                          <span class="keyword">const</span> <span class="keywordtype">double</span> &amp;h, </div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;                                          GeomObject* substrate_pt,</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;                                          TimeStepper* time_stepper_pt) :</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160; SimpleRectangularQuadMesh&lt;ELEMENT&gt;(nx,ny,lx,h,time_stepper_pt),</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160; Default_height(h), Height_fct_pt(0), Substrate_pt(substrate_pt)</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160; </div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;{</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160; </div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160; <span class="comment">// We&#39;ve already called the constructor for the SimpleRectangularQuadMesh</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160; <span class="comment">// which sets up nodal positons/topology etc. Now attach the spine</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160; <span class="comment">// information </span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160; </div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160; </div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160; <span class="comment">// Allocate memory for the spines and fractions along spines</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160; </div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160; <span class="comment">// Read out number of linear points in the element</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160; <span class="keywordtype">unsigned</span> np = <span class="keyword">dynamic_cast&lt;</span>ELEMENT*<span class="keyword">&gt;</span>(finite_element_pt(0))-&gt;nnode_1d();</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160; </div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160; <span class="comment">// Number of spines</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160; <span class="keywordtype">unsigned</span> nspine = (np-1)*nx+1;</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160; Spine_pt.reserve(nspine);</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160; </div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160; <span class="comment">// Set up x-increments between spine origins</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160; <span class="keywordtype">double</span> x_lo=0.0;</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160; <span class="keywordtype">double</span> dx=lx/double(nx);</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160; </div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160; <span class="comment">//FIRST SPINE</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160; <span class="comment">//-----------</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160; </div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160; <span class="comment">//Element 0</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160; <span class="comment">//Node 0</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160; <span class="comment">//Assign the new spine with specified height</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160; <a class="code" href="spine__channel_8txt.html#a914410aeeaf61a0d6c75c43ec26ecbaa">Spine</a>* new_spine_pt=<span class="keyword">new</span> <a class="code" href="spine__channel_8txt.html#a914410aeeaf61a0d6c75c43ec26ecbaa">Spine</a>(h);</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160; Spine_pt.push_back(new_spine_pt);</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160; </div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160; <span class="comment">// Get pointer to node</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160; SpineNode* nod_pt=element_node_pt(0,0);</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160; </div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160; <span class="comment">//Pass the pointer to the spine to the node</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160; nod_pt-&gt;spine_pt() = new_spine_pt;</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160; </div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160; <span class="comment">//Set the node&#39;s fraction along the spine</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160; nod_pt-&gt;fraction() = 0.0;</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160; </div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160; <span class="comment">// Set the pointer to the mesh that implements the update fct for this node</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160; nod_pt-&gt;spine_mesh_pt() = <span class="keyword">this</span>; </div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160; </div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160; <span class="comment">// Set update fct id (not really needed here...)</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160; nod_pt-&gt;node_update_fct_id()=0;</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160; </div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160; </div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160; <span class="comment">// Create vector that stores additional geometric parameters that</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160; <span class="comment">// are required during the execution of the remesh function:</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160; <span class="comment">// For our remesh function, we need the x-coordinate of the </span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160; <span class="comment">// spine origin. </span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160; </div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160; <span class="comment">// Vector with enough storage for one geometic parameter</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;  Vector&lt;double&gt; parameters(1);</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160; </div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;  <span class="comment">// Store the x-coordinate in it</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;  parameters[0]=x_lo;</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160; </div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;  <span class="comment">// Pass the parameter to the spine</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;  new_spine_pt-&gt;set_geom_parameter(parameters);</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;     </div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160; </div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160; </div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;  <span class="comment">// The remesh function involving this spine only involves</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;  <span class="comment">// a single geometric object: The substrate</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;  Vector&lt;GeomObject*&gt; geom_object_pt(1);</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;  geom_object_pt[0] = <a class="code" href="classSimpleSpineMesh.html#a9031e27d5855e029312d356f6a38da76">Substrate_pt</a>;</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;  </div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;  <span class="comment">// Pass geom object(s) to spine</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;  new_spine_pt-&gt;set_geom_object_pt(geom_object_pt);</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;  </div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160; </div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160; <span class="comment">//Loop vertically along the first spine</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160; </div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160; <span class="comment">//Loop over the elements </span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160; <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i=0;i&lt;ny;i++)</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;  {</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;   <span class="comment">//Loop over the vertical nodes, apart from the first</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l1=1;l1&lt;np;l1++)</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    {</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;     <span class="comment">// Get pointer to node</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;     SpineNode* nod_pt=element_node_pt(i*nx,l1*np);</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160; </div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;     <span class="comment">//Pass the pointer to the spine to the node</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;     nod_pt-&gt;spine_pt() = new_spine_pt;</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160; </div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;     <span class="comment">//Set the fraction</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;     nod_pt-&gt;fraction()=(double(i)+double(l1)/double(np-1))/<span class="keywordtype">double</span>(ny);</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160; </div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;     <span class="comment">// Pointer to the mesh that implements the update fct</span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;     nod_pt-&gt;spine_mesh_pt() = <span class="keyword">this</span>; </div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160; </div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;     <span class="comment">// Set update fct id (not really needed here)</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;     nod_pt-&gt;node_update_fct_id()=0;</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160; </div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    }</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;  } <span class="comment">// end loop over elements</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160; </div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160; </div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160; <span class="comment">//LOOP OVER OTHER SPINES</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160; <span class="comment">//----------------------</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160; </div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160; <span class="comment">//Now loop over the elements horizontally</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160; <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> j=0;j&lt;nx;j++)</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;  {</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;   <span class="comment">//Loop over the nodes in the elements horizontally, ignoring </span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;   <span class="comment">//the first column</span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;   <span class="keywordtype">unsigned</span> npmax=np;</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l2=1;l2&lt;npmax;l2++)</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    {</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;     <span class="comment">//Assign the new spine with specified height</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;     new_spine_pt=<span class="keyword">new</span> <a class="code" href="spine__channel_8txt.html#a914410aeeaf61a0d6c75c43ec26ecbaa">Spine</a>(h);</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160; </div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;     <span class="comment">// Add to collection of spines</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;     Spine_pt.push_back(new_spine_pt);</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;     </div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;     <span class="comment">// Get the node</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;     SpineNode* nod_pt=element_node_pt(j,l2);</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160; </div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;     <span class="comment">//Pass the pointer to the spine to the node</span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;     nod_pt-&gt;spine_pt() = new_spine_pt;</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160; </div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;     <span class="comment">//Set the fraction</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;     nod_pt-&gt;fraction() = 0.0;</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160; </div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;     <span class="comment">// Pointer to the mesh that implements the update fct</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;     nod_pt-&gt;spine_mesh_pt() = <span class="keyword">this</span>; </div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160; </div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;     <span class="comment">// Set update fct id (not really needed here)</span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;     nod_pt-&gt;node_update_fct_id()=0;</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160; </div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;     <span class="comment">// Create vector that stores additional geometric parameters that</span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;     <span class="comment">// are required during the execution of the remesh function:</span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;     <span class="comment">// For our remesh function, we need the x-coordinate of the </span></div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;     <span class="comment">// spine origin. </span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;     </div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;     <span class="comment">// Vector with enough storage for one geometic parameter</span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;     Vector&lt;double&gt; parameters(1);</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;     </div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;     <span class="comment">// Store the x-coordinate in it</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;     parameters[0]=x_lo+double(j)*dx + double(l2)*dx/double(np-1);</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;     </div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;     <span class="comment">// Pass the parameter to the spine</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;     new_spine_pt-&gt;set_geom_parameter(parameters);</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;     </div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160; </div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;     <span class="comment">// The remesh function involving this spine only involves</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;     <span class="comment">// a single geometric object: The substrate</span></div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;     Vector&lt;GeomObject*&gt; geom_object_pt(1);</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;     geom_object_pt[0] = <a class="code" href="classSimpleSpineMesh.html#a9031e27d5855e029312d356f6a38da76">Substrate_pt</a>;</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;     </div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;     <span class="comment">// Pass geom object(s) to spine</span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;     new_spine_pt-&gt;set_geom_object_pt(geom_object_pt);</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;     </div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;     <span class="comment">//Loop vertically along the spine</span></div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;     <span class="comment">//Loop over the elements </span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i=0;i&lt;ny;i++)</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;      {</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;       <span class="comment">//Loop over the vertical nodes, apart from the first</span></div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;       <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l1=1;l1&lt;np;l1++)</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;        {</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;         <span class="comment">// Get the node</span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;         SpineNode* nod_pt=element_node_pt(i*nx+j,l1*np+l2);</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160; </div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;         <span class="comment">//Set the pointer to the spine</span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;         nod_pt-&gt;spine_pt() = new_spine_pt;</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160; </div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;         <span class="comment">//Set the fraction</span></div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;         nod_pt-&gt;fraction()=(double(i)+double(l1)/double(np-1))/<span class="keywordtype">double</span>(ny);</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160; </div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;         <span class="comment">// Pointer to the mesh that implements the update fct</span></div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;         nod_pt-&gt;spine_mesh_pt() = <span class="keyword">this</span>; </div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160; </div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;         <span class="comment">// Set update fct id (not really needed here)</span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;         nod_pt-&gt;node_update_fct_id()=0;</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;        }  </div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;      }</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    }</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;  }</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160; </div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;} <span class="comment">// end of constructor</span></div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160; </div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160; </div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160; </div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160; </div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;<span class="comment">///////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;<span class="comment">///////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160; </div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160; </div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;<span class="comment">//==start_of_namespace===================================================</span><span class="comment"></span></div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;<span class="comment">/// Namespace for physical parameters</span></div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;<span class="comment"></span><span class="comment">//=======================================================================</span></div>
<div class="line"><a name="l00407"></a><span class="lineno"><a class="line" href="namespaceGlobal__Physical__Variables.html">  407</a></span>&#160;<span class="keyword">namespace </span><a class="code" href="namespaceGlobal__Physical__Variables.html">Global_Physical_Variables</a></div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;{</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;<span class="comment"> /// Reynolds number</span></div>
<div class="line"><a name="l00411"></a><span class="lineno"><a class="line" href="namespaceGlobal__Physical__Variables.html#ab814e627d2eb5bc50318879d19ab16b9">  411</a></span>&#160;<span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="namespaceGlobal__Physical__Variables.html#ab814e627d2eb5bc50318879d19ab16b9">Re</a>=100;</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;<span class="comment"> /// Start of indented region</span></div>
<div class="line"><a name="l00414"></a><span class="lineno"><a class="line" href="namespaceGlobal__Physical__Variables.html#a84cf50616e15acc4db0d9d8765302128">  414</a></span>&#160;<span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="namespaceGlobal__Physical__Variables.html#a84cf50616e15acc4db0d9d8765302128">X_indent_start</a>=0.5;</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;<span class="comment"> /// Length of indented region</span></div>
<div class="line"><a name="l00417"></a><span class="lineno"><a class="line" href="namespaceGlobal__Physical__Variables.html#a1b8bfc451f6b7ac89eca18f04338f47f">  417</a></span>&#160;<span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="namespaceGlobal__Physical__Variables.html#a1b8bfc451f6b7ac89eca18f04338f47f">L</a>=1.0;</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;<span class="comment"> /// Total length of domain</span></div>
<div class="line"><a name="l00420"></a><span class="lineno"><a class="line" href="namespaceGlobal__Physical__Variables.html#a9ec945e33c27b1cfe2e4da7cf3a89f72">  420</a></span>&#160;<span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="namespaceGlobal__Physical__Variables.html#a9ec945e33c27b1cfe2e4da7cf3a89f72">L_total</a>=4.0;</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;<span class="comment"> /// Undeformed height of domain</span></div>
<div class="line"><a name="l00423"></a><span class="lineno"><a class="line" href="namespaceGlobal__Physical__Variables.html#af6e07423e22c0991084d9a2f43727805">  423</a></span>&#160;<span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="namespaceGlobal__Physical__Variables.html#af6e07423e22c0991084d9a2f43727805">H</a>=1.0;</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;<span class="comment"> /// Amplitude of indentation</span></div>
<div class="line"><a name="l00426"></a><span class="lineno"><a class="line" href="namespaceGlobal__Physical__Variables.html#a4894f9a3a9cbf84f00d0719f2841e624">  426</a></span>&#160;<span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="namespaceGlobal__Physical__Variables.html#a4894f9a3a9cbf84f00d0719f2841e624">A</a>=-0.6;</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;<span class="comment"> /// Height of domain</span></div>
<div class="line"><a name="l00429"></a><span class="lineno"><a class="line" href="namespaceGlobal__Physical__Variables.html#aad3f0468efff43e7f235a64c27d3acf2">  429</a></span>&#160;<span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="namespaceGlobal__Physical__Variables.html#aad3f0468efff43e7f235a64c27d3acf2">height</a>(<span class="keyword">const</span> <span class="keywordtype">double</span>&amp; x)</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160; {</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;  <span class="keywordflow">if</span> ((x&gt;<a class="code" href="namespaceGlobal__Physical__Variables.html#a84cf50616e15acc4db0d9d8765302128">X_indent_start</a>)&amp;&amp;(x&lt;(<a class="code" href="namespaceGlobal__Physical__Variables.html#a84cf50616e15acc4db0d9d8765302128">X_indent_start</a>+<a class="code" href="namespaceGlobal__Physical__Variables.html#a1b8bfc451f6b7ac89eca18f04338f47f">L</a>)))</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;   {</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespaceGlobal__Physical__Variables.html#af6e07423e22c0991084d9a2f43727805">H</a> + <a class="code" href="namespaceGlobal__Physical__Variables.html#a4894f9a3a9cbf84f00d0719f2841e624">A</a>*sin(MathematicalConstants::Pi*(x-<a class="code" href="namespaceGlobal__Physical__Variables.html#a84cf50616e15acc4db0d9d8765302128">X_indent_start</a>)/<a class="code" href="namespaceGlobal__Physical__Variables.html#a1b8bfc451f6b7ac89eca18f04338f47f">L</a>);</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;   }</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;   {</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespaceGlobal__Physical__Variables.html#af6e07423e22c0991084d9a2f43727805">H</a>;</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;   }</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160; }</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160; </div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;} <span class="comment">// end_of_namespace</span></div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160; </div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160; </div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160; </div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160; </div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;<span class="comment">///////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;<span class="comment">///////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;<span class="comment">///////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160; </div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160; </div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;<span class="comment">//==start_of_problem_class============================================</span><span class="comment"></span></div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;<span class="comment">/// Channel flow through a non-uniform channel whose geometry is defined </span></div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;<span class="comment">/// by a spine mesh.</span></div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;<span class="comment"></span><span class="comment">//====================================================================</span></div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> ELEMENT&gt;</div>
<div class="line"><a name="l00458"></a><span class="lineno"><a class="line" href="classChannelSpineFlowProblem.html">  458</a></span>&#160;<span class="keyword">class </span><a class="code" href="classChannelSpineFlowProblem.html">ChannelSpineFlowProblem</a> : <span class="keyword">public</span> Problem</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;{</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160; </div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;<span class="comment"> /// Constructor</span></div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;<span class="comment"></span> <a class="code" href="classChannelSpineFlowProblem.html#a23f1b987e3395b1d101eaf3f3b5c94b2">ChannelSpineFlowProblem</a>();</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;<span class="comment"> /// Destructor: (empty)</span></div>
<div class="line"><a name="l00467"></a><span class="lineno"><a class="line" href="classChannelSpineFlowProblem.html#abdf2cc520915167d8718499459df348b">  467</a></span>&#160;<span class="comment"></span> <a class="code" href="classChannelSpineFlowProblem.html#abdf2cc520915167d8718499459df348b">~ChannelSpineFlowProblem</a>(){}</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;<span class="comment"> /// \short Update the problem specs before solve. Update the nodal</span></div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;<span class="comment"> /// positions</span></div>
<div class="line"><a name="l00471"></a><span class="lineno"><a class="line" href="classChannelSpineFlowProblem.html#aaf6dd8a8a472ccd938df579aba61ec97">  471</a></span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classChannelSpineFlowProblem.html#aaf6dd8a8a472ccd938df579aba61ec97">actions_before_newton_solve</a>()</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;  { </div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;   <span class="comment">// Update the mesh</span></div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;   <a class="code" href="classChannelSpineFlowProblem.html#ab68c7ab5406b90a0ef56c39b67f83a09">mesh_pt</a>()-&gt;node_update();</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160; </div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;  } <span class="comment">// end_of_actions_before_newton_solve</span></div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;<span class="comment"> /// Update the after solve (empty)</span></div>
<div class="line"><a name="l00479"></a><span class="lineno"><a class="line" href="classChannelSpineFlowProblem.html#a419a80ef3d19438f193bd7843f72446a">  479</a></span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classChannelSpineFlowProblem.html#a419a80ef3d19438f193bd7843f72446a">actions_after_newton_solve</a>(){}</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;<span class="comment"> /// Doc the solution</span></div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classChannelSpineFlowProblem.html#a101bdeee56502231945cbac272ca21f6">doc_solution</a>(DocInfo&amp; doc_info);</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;<span class="comment"> /// Overload access to mesh</span></div>
<div class="line"><a name="l00485"></a><span class="lineno"><a class="line" href="classChannelSpineFlowProblem.html#ab68c7ab5406b90a0ef56c39b67f83a09">  485</a></span>&#160;<span class="comment"></span> <a class="code" href="classSimpleSpineMesh.html">SimpleSpineMesh&lt;ELEMENT&gt;</a>* <a class="code" href="classChannelSpineFlowProblem.html#ab68c7ab5406b90a0ef56c39b67f83a09">mesh_pt</a>()</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;  {</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;   <span class="keywordflow">return</span> <span class="keyword">dynamic_cast&lt;</span><a class="code" href="classSimpleSpineMesh.html">SimpleSpineMesh&lt;ELEMENT&gt;</a>*<span class="keyword">&gt;</span>(Problem::mesh_pt());</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;  }</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160; </div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160; </div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;<span class="comment"> /// Width of channel</span></div>
<div class="line"><a name="l00494"></a><span class="lineno"><a class="line" href="classChannelSpineFlowProblem.html#a6ac51c3c9d400869e694fe00452e293f">  494</a></span>&#160;<span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="classChannelSpineFlowProblem.html#a6ac51c3c9d400869e694fe00452e293f">Ly</a>;</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160; </div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160; </div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;}; <span class="comment">// end_of_problem_class</span></div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160; </div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160; </div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160; </div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;<span class="comment">//==start_of_constructor==================================================</span><span class="comment"></span></div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;<span class="comment">/// Constructor for ChannelSpineFlow problem </span></div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;<span class="comment"></span><span class="comment">//========================================================================</span></div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> ELEMENT&gt;</div>
<div class="line"><a name="l00505"></a><span class="lineno"><a class="line" href="classChannelSpineFlowProblem.html#a23f1b987e3395b1d101eaf3f3b5c94b2">  505</a></span>&#160;<a class="code" href="classChannelSpineFlowProblem.html#a23f1b987e3395b1d101eaf3f3b5c94b2">ChannelSpineFlowProblem&lt;ELEMENT&gt;::ChannelSpineFlowProblem</a>()</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;{ </div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160; </div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160; <span class="comment">// Setup mesh</span></div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160; </div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160; <span class="comment">// Domain length in x-direction</span></div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160; <span class="keywordtype">double</span> Lx=<a class="code" href="namespaceGlobal__Physical__Variables.html#a9ec945e33c27b1cfe2e4da7cf3a89f72">Global_Physical_Variables::L_total</a>;</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160; </div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160; <span class="comment">// Domain length in y-direction</span></div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160; Ly=<a class="code" href="namespaceGlobal__Physical__Variables.html#af6e07423e22c0991084d9a2f43727805">Global_Physical_Variables::H</a>;</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160; </div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160; <span class="comment">// # of elements in x-direction</span></div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160; <span class="keywordtype">unsigned</span> Nx=40;</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160; </div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160; <span class="comment">// # of elements in y-direction</span></div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160; <span class="keywordtype">unsigned</span> Ny=10;</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160; </div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160; <span class="comment">// Substrate (lower wall): A wavy wall</span></div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160; GeomObject* substrate_pt=</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;  <span class="keyword">new</span> <a class="code" href="classWavyWall.html">WavyWall</a>(<a class="code" href="namespaceGlobal__Physical__Variables.html#a9ec945e33c27b1cfe2e4da7cf3a89f72">Global_Physical_Variables::L_total</a>,-0.2);</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160; </div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160; <span class="comment">// Build and assign mesh -- pass pointer to geometric object</span></div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160; <span class="comment">// that represents the sinusoidal bump on the upper wall</span></div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160; Problem::mesh_pt() = <span class="keyword">new</span> <a class="code" href="classSimpleSpineMesh.html">SimpleSpineMesh&lt;ELEMENT&gt;</a>(Nx,Ny,Lx,Ly,substrate_pt);</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160; </div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160; <span class="comment">// Set function pointer for height function</span></div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160; mesh_pt()-&gt;height_fct_pt()=&amp;<a class="code" href="namespaceGlobal__Physical__Variables.html#aad3f0468efff43e7f235a64c27d3acf2">Global_Physical_Variables::height</a>;</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160; </div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160; <span class="comment">// Update spine heights according to the function just specified</span></div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160; mesh_pt()-&gt;update_spine_heights();</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160; </div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160; <span class="comment">// Update nodal positions</span></div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160; mesh_pt()-&gt;node_update();</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160; </div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160; <span class="comment">// Pin all spine heights</span></div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160; <span class="keywordtype">unsigned</span> nspine=mesh_pt()-&gt;nspine();</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160; <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i=0;i&lt;nspine;i++)</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;  {</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;   mesh_pt()-&gt;spine_pt(i)-&gt;spine_height_pt()-&gt;pin(0);</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;  }</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160; </div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160; </div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160; <span class="comment">// Set the boundary conditions for this problem: All nodes are</span></div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160; <span class="comment">// free by default -- just pin the ones that have Dirichlet conditions</span></div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160; <span class="comment">// here: All boundaries are Dirichlet boundaries, except on boundary 1</span></div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160; <span class="keywordtype">unsigned</span> num_bound = mesh_pt()-&gt;nboundary();</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160; <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> ibound=0;ibound&lt;num_bound;ibound++)</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;  {</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;   <span class="keywordtype">unsigned</span> num_nod= mesh_pt()-&gt;nboundary_node(ibound);</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> inod=0;inod&lt;num_nod;inod++)</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;    {</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;     <span class="keywordflow">if</span> (ibound!=1)</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;      {</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;       <span class="comment">// Loop over values (u and v velocities)</span></div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;       <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i=0;i&lt;2;i++)</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;        {</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;         mesh_pt()-&gt;boundary_node_pt(ibound,inod)-&gt;pin(i); </div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;        }</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;      }</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;     <span class="keywordflow">else</span></div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;      {</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;       <span class="comment">// Parallel outflow ==&gt; no-slip</span></div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;       mesh_pt()-&gt;boundary_node_pt(ibound,inod)-&gt;pin(1); </div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;      }</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;    }</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;  } <span class="comment">// end loop over boundaries</span></div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160; </div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160; </div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160; <span class="comment">// No slip on stationary upper and lower walls (boundaries 0 and 2) </span></div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160; <span class="comment">// and parallel outflow (boundary 1) </span></div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160; <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> ibound=0;ibound&lt;num_bound-1;ibound++)</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;  {</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;   <span class="keywordtype">unsigned</span> num_nod= mesh_pt()-&gt;nboundary_node(ibound);</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> inod=0;inod&lt;num_nod;inod++)</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;    {</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;     <span class="keywordflow">if</span> (ibound!=1)</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;      {</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;       <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i=0;i&lt;2;i++)</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;        {</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;         mesh_pt()-&gt;boundary_node_pt(ibound,inod)-&gt;set_value(i,0.0);</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;        }</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;      }</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;     <span class="keywordflow">else</span></div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;      {</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;       mesh_pt()-&gt;boundary_node_pt(ibound,inod)-&gt;set_value(1,0.0);</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;      }</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;    }</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;  }</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160; </div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160; </div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160; <span class="comment">// Setup parabolic inflow along boundary 3:</span></div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160; <span class="keywordtype">unsigned</span> ibound=3; </div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160; <span class="keywordtype">unsigned</span> num_nod= mesh_pt()-&gt;nboundary_node(ibound);</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160; <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> inod=0;inod&lt;num_nod;inod++)</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;  {</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;   <span class="keywordtype">double</span> y=mesh_pt()-&gt;boundary_node_pt(ibound,inod)-&gt;x(1);</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;   <span class="comment">// Parallel, parabolic inflow</span></div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;   mesh_pt()-&gt;boundary_node_pt(ibound,inod)-&gt;set_value(0,y*(Ly-y));</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;   mesh_pt()-&gt;boundary_node_pt(ibound,inod)-&gt;set_value(1,0.0);</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;  }</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160; </div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160; </div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160; <span class="comment">// Loop over the elements to set up element-specific </span></div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160; <span class="comment">// things that cannot be handled by constructor: Pass </span></div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160; <span class="comment">// pointer to Reynolds number</span></div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160; <span class="keywordtype">unsigned</span> n_element = mesh_pt()-&gt;nelement();</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160; <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> e=0;e&lt;n_element;e++)</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;  {</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;   <span class="comment">// Upcast from GeneralisedElement to the present element</span></div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;   ELEMENT* el_pt = <span class="keyword">dynamic_cast&lt;</span>ELEMENT*<span class="keyword">&gt;</span>(mesh_pt()-&gt;element_pt(e));</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;   <span class="comment">//Set the Reynolds number</span></div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;   el_pt-&gt;re_pt() = &amp;<a class="code" href="namespaceGlobal__Physical__Variables.html#ab814e627d2eb5bc50318879d19ab16b9">Global_Physical_Variables::Re</a>;</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;  } </div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160; </div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160; <span class="comment">// Setup equation numbering scheme</span></div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160; cout &lt;&lt;<span class="stringliteral">&quot;Number of equations: &quot;</span> &lt;&lt; assign_eqn_numbers() &lt;&lt; std::endl; </div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160; </div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;} <span class="comment">// end_of_constructor</span></div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160; </div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160; </div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160; </div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160; </div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;<span class="comment">//==start_of_doc_solution=================================================</span><span class="comment"></span></div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;<span class="comment">/// Doc the solution</span></div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;<span class="comment"></span><span class="comment">//========================================================================</span></div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> ELEMENT&gt;</div>
<div class="line"><a name="l00631"></a><span class="lineno"><a class="line" href="classChannelSpineFlowProblem.html#a101bdeee56502231945cbac272ca21f6">  631</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classChannelSpineFlowProblem.html#a101bdeee56502231945cbac272ca21f6">ChannelSpineFlowProblem&lt;ELEMENT&gt;::doc_solution</a>(DocInfo&amp; doc_info)</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;{ </div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160; </div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160; ofstream some_file;</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160; <span class="keywordtype">char</span> filename[100];</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160; </div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160; <span class="comment">// Number of plot points</span></div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160; <span class="keywordtype">unsigned</span> npts=5; </div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160; </div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160; <span class="comment">// Output solution </span></div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160; sprintf(filename,<span class="stringliteral">&quot;%s/soln%i.dat&quot;</span>,doc_info.directory().c_str(),</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;         doc_info.number());</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160; some_file.open(filename);</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160; mesh_pt()-&gt;output(some_file,npts);</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160; some_file.close();</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160; </div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;} <span class="comment">// end_of_doc_solution</span></div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160; </div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160; </div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160; </div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;<span class="comment">//==start_of_main======================================================</span><span class="comment"></span></div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;<span class="comment">/// Driver for channel flow problem with spine mesh.</span></div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;<span class="comment"></span><span class="comment">//=====================================================================</span></div>
<div class="line"><a name="l00654"></a><span class="lineno"><a class="line" href="simple__spine__channel_8cc.html#ae66f6b31b5ad750f1fe042a706a4e3d4">  654</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="simple__spine__channel_8cc.html#ae66f6b31b5ad750f1fe042a706a4e3d4">main</a>()</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;{</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160; </div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160; <span class="comment">// Set output directory</span></div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160; DocInfo doc_info;</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160; doc_info.set_directory(<span class="stringliteral">&quot;RESLT&quot;</span>);</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160; doc_info.number()=0;</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160; </div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160; <span class="comment">// Solve problem with Taylor Hood elements</span></div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160; <span class="comment">//---------------------------------------</span></div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160; {</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;  <span class="comment">//Build problem</span></div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;  <a class="code" href="classChannelSpineFlowProblem.html">ChannelSpineFlowProblem&lt;SpineElement&lt;QTaylorHoodElement&lt;2&gt;</a> &gt; &gt; <a class="code" href="spine__channel_8txt.html#a8d895bb93cd829890aa4c1a2d5682792">problem</a>;</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;  </div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;  <span class="comment">// Solve the problem</span></div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;  <a class="code" href="spine__channel_8txt.html#a8d895bb93cd829890aa4c1a2d5682792">problem</a>.newton_solve();</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;  </div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;  <span class="comment">//Output solution</span></div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;  <a class="code" href="spine__channel_8txt.html#a8d895bb93cd829890aa4c1a2d5682792">problem</a>.doc_solution(doc_info);</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160; </div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;  <span class="comment">// Step number</span></div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;  doc_info.number()++;</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160; </div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160; } <span class="comment">// end of Taylor Hood elements</span></div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160; </div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160; </div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160; <span class="comment">// Solve problem with Crouzeix Raviart elements</span></div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160; <span class="comment">//--------------------------------------------</span></div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160; {</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;  <span class="comment">// Build problem</span></div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;  <a class="code" href="classChannelSpineFlowProblem.html">ChannelSpineFlowProblem&lt;SpineElement&lt;QCrouzeixRaviartElement&lt;2&gt;</a> &gt; &gt;</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;   <a class="code" href="spine__channel_8txt.html#a8d895bb93cd829890aa4c1a2d5682792">problem</a>;</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;  </div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;  <span class="comment">// Solve the problem with automatic adaptation</span></div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;  <a class="code" href="spine__channel_8txt.html#a8d895bb93cd829890aa4c1a2d5682792">problem</a>.newton_solve();</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;  </div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;  <span class="comment">//Output solution</span></div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;  <a class="code" href="spine__channel_8txt.html#a8d895bb93cd829890aa4c1a2d5682792">problem</a>.doc_solution(doc_info);</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;  <span class="comment">// Step number</span></div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;  doc_info.number()++;</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;  </div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160; } <span class="comment">// end of Crouzeix Raviart elements</span></div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;      </div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160; </div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;     </div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;} <span class="comment">// end_of_main</span></div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160; </div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160; </div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160; </div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160; </div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;<span class="comment">// //====================================================================</span></div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;<span class="comment">// /// Create the files to illustrate the sparse node update operation</span></div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;<span class="comment">// //====================================================================</span></div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;<span class="comment">// void doc_sparse_node_update()</span></div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;<span class="comment">// {</span></div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160; </div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;<span class="comment">//  // Set output directory</span></div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;<span class="comment">//  DocInfo doc_info;</span></div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;<span class="comment">//  doc_info.set_directory(&quot;RESLT&quot;);</span></div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160; </div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;<span class="comment">//  // Setup mesh</span></div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160; </div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;<span class="comment">//  // # of elements in x-direction</span></div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;<span class="comment">//  unsigned Nx=5;</span></div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160; </div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;<span class="comment">//  // # of elements in y-direction</span></div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;<span class="comment">//  unsigned Ny=5;</span></div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160; </div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;<span class="comment">//  // Domain length in x-direction</span></div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;<span class="comment">//  double Lx=5.0;</span></div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160; </div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;<span class="comment">//  // Domain length in y-direction</span></div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;<span class="comment">//  double Ly=1.0;</span></div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160; </div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;<span class="comment">//  // Build and assign mesh</span></div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;<span class="comment">//  SimpleSpineMesh&lt;SpineElement&lt;QTaylorHoodElement&lt;2&gt; &gt; &gt;* mesh_pt =</span></div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;<span class="comment">//   new SimpleSpineMesh&lt;SpineElement&lt;QTaylorHoodElement&lt;2&gt; &gt; &gt;(Nx,Ny,Lx,Ly);</span></div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160; </div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;<span class="comment">//  // Update *all* nodal positions</span></div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;<span class="comment">//  mesh_pt-&gt;node_update();</span></div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160; </div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;<span class="comment">//  unsigned count=0;</span></div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;<span class="comment">//  ofstream some_file;</span></div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;<span class="comment">//  char filename[100];</span></div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160; </div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;<span class="comment">//  // Number of plot points</span></div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;<span class="comment">//  unsigned npts=5; </span></div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160; </div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;<span class="comment">//  // Output solution </span></div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;<span class="comment">//  sprintf(filename,&quot;%s/mesh_update%i.dat&quot;,doc_info.directory().c_str(),</span></div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;<span class="comment">//          count);</span></div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;<span class="comment">//  count++;</span></div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160; </div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;<span class="comment">//  // Loop over spines</span></div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;<span class="comment">//  unsigned n_node = mesh_pt-&gt;nnode();</span></div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;<span class="comment">//  for (unsigned inode=0;inode&lt;n_node;inode++)</span></div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;<span class="comment">//   {</span></div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;<span class="comment">//    SpineNode* node_pt=dynamic_cast&lt;SpineNode*&gt;(mesh_pt-&gt;node_pt(inode));</span></div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;<span class="comment">//    node_pt-&gt;node_update();</span></div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;<span class="comment">//    // Output solution </span></div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;<span class="comment">//    some_file.open(filename);</span></div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;<span class="comment">//    sprintf(filename,&quot;%s/mesh_update%i.dat&quot;,doc_info.directory().c_str(),</span></div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;<span class="comment">//            count);</span></div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;<span class="comment">//    count++;</span></div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;<span class="comment">//    mesh_pt-&gt;output(some_file,npts);</span></div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;<span class="comment">//    some_file.close();</span></div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;<span class="comment">//   }</span></div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;<span class="comment">// }</span></div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160; </div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;     </div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160; </div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160; </div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160; </div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160; </div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160; </div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160; </div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160; </div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160; </div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160; </div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160; </div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160; </div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160; </div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="aclassChannelSpineFlowProblem_html"><div class="ttname"><a href="classChannelSpineFlowProblem.html">ChannelSpineFlowProblem</a></div><div class="ttdef"><b>Definition:</b> <a href="simple__spine__channel_8cc_source.html#l00458">simple_spine_channel.cc:458</a></div></div>
<div class="ttc" id="aclassSimpleSpineMesh_html_a2248fb8df448b0a02377a0cfb6f57851"><div class="ttname"><a href="classSimpleSpineMesh.html#a2248fb8df448b0a02377a0cfb6f57851">SimpleSpineMesh::update_spine_heights</a></div><div class="ttdeci">void update_spine_heights()</div><div class="ttdoc">Update the spine heights according to the function specified by height_fct_pt().</div><div class="ttdef"><b>Definition:</b> <a href="simple__spine__channel_8cc_source.html#l00137">simple_spine_channel.cc:137</a></div></div>
<div class="ttc" id="aclassSimpleSpineMesh_html_ac0509d0d0868d37ef87834b39d2a084b"><div class="ttname"><a href="classSimpleSpineMesh.html#ac0509d0d0868d37ef87834b39d2a084b">SimpleSpineMesh::Height_fct_pt</a></div><div class="ttdeci">HeightFctPt Height_fct_pt</div><div class="ttdoc">Pointer to height function.</div><div class="ttdef"><b>Definition:</b> <a href="simple__spine__channel_8cc_source.html#l00187">simple_spine_channel.cc:187</a></div></div>
<div class="ttc" id="aspine__channel_8txt_html_a6278222265b62552409f8aac35d11539"><div class="ttname"><a href="spine__channel_8txt.html#a6278222265b62552409f8aac35d11539">A</a></div><div class="ttdeci">mainpage Example curvilinear boundaries These examples had the following common in which the mesh velocity is determined from the history values of the nodal positions We will now consider problems in which the position of the domain boundary is unknown and has to be determined as part of the overall solution This situation e in free surface fluid flow problems and in fluid structure interaction problems We shall explain why c Domain c MacroElement based node update strategies are unlikely to be efficient for such problems and then introduce the Method of Spines as one of a number of f and f[\frac{\partial u_i}{\partial x_i}=0,\f] in the region f where f[h(x_1)=\left\{\begin{array}{cl}H &amp;0 \leq x_1 \leq L_1 \\H+A\sin\left(\frac{x_1-L_1}{L_2-L_1}\right) &amp;L_1 \leq x_1 \leq L_2 \\H &amp;L_2 \leq x_1 \leq L\end{array} \right.\f] shown in this sketch I w textwidth channel_sketch Sketch of the problem subject to the no slip Dirichlet boundary conditions on the top and bottom rigid walls f[\left. \mathbf{u}\right|_{\partial D_{wall}}=(0, 0),\f] parabolic inflow on the left inflow f partial f[\left. \mathbf{u}\right|_{\partial D_{inflow}}=\left(x_2\left(H-x_2\right), 0\right),\f] and axially traction parallel outflow on the outflow f partial f[\left. u_2\right|_{\partial D_{outflow}}=0.\f]&lt;/TD &gt;&lt;/TR &gt;&lt;/TABLE &gt;&lt;/CENTER &gt;&lt; HR &gt;&lt; HR &gt; section results Results The figures below show the obtained from computations with Taylor Hood and Crouzeix Raviart elements for a channel of length f height f with deflection amplitude f A</div><div class="ttdef"><b>Definition:</b> <a href="spine__channel_8txt_source.html#l00215">spine_channel.txt:215</a></div></div>
<div class="ttc" id="aclassChannelSpineFlowProblem_html_a101bdeee56502231945cbac272ca21f6"><div class="ttname"><a href="classChannelSpineFlowProblem.html#a101bdeee56502231945cbac272ca21f6">ChannelSpineFlowProblem::doc_solution</a></div><div class="ttdeci">void doc_solution(DocInfo &amp;doc_info)</div><div class="ttdoc">Doc the solution.</div><div class="ttdef"><b>Definition:</b> <a href="simple__spine__channel_8cc_source.html#l00631">simple_spine_channel.cc:631</a></div></div>
<div class="ttc" id="aclassChannelSpineFlowProblem_html_a6ac51c3c9d400869e694fe00452e293f"><div class="ttname"><a href="classChannelSpineFlowProblem.html#a6ac51c3c9d400869e694fe00452e293f">ChannelSpineFlowProblem::Ly</a></div><div class="ttdeci">double Ly</div><div class="ttdoc">Width of channel.</div><div class="ttdef"><b>Definition:</b> <a href="simple__spine__channel_8cc_source.html#l00494">simple_spine_channel.cc:494</a></div></div>
<div class="ttc" id="anamespaceGlobal__Physical__Variables_html_a1b8bfc451f6b7ac89eca18f04338f47f"><div class="ttname"><a href="namespaceGlobal__Physical__Variables.html#a1b8bfc451f6b7ac89eca18f04338f47f">Global_Physical_Variables::L</a></div><div class="ttdeci">double L</div><div class="ttdoc">Length of indented region.</div><div class="ttdef"><b>Definition:</b> <a href="simple__spine__channel_8cc_source.html#l00417">simple_spine_channel.cc:417</a></div></div>
<div class="ttc" id="aclassSimpleSpineMesh_html_a99398fc7ef50db36d30f6c1d01aa3758"><div class="ttname"><a href="classSimpleSpineMesh.html#a99398fc7ef50db36d30f6c1d01aa3758">SimpleSpineMesh::height_fct</a></div><div class="ttdeci">double height_fct(const double &amp;x)</div><div class="ttdoc">Height function  this is called by update_spine_heights() when spine heights are assigned.</div><div class="ttdef"><b>Definition:</b> <a href="simple__spine__channel_8cc_source.html#l00121">simple_spine_channel.cc:121</a></div></div>
<div class="ttc" id="aclassChannelSpineFlowProblem_html_a419a80ef3d19438f193bd7843f72446a"><div class="ttname"><a href="classChannelSpineFlowProblem.html#a419a80ef3d19438f193bd7843f72446a">ChannelSpineFlowProblem::actions_after_newton_solve</a></div><div class="ttdeci">void actions_after_newton_solve()</div><div class="ttdoc">Update the after solve (empty)</div><div class="ttdef"><b>Definition:</b> <a href="simple__spine__channel_8cc_source.html#l00479">simple_spine_channel.cc:479</a></div></div>
<div class="ttc" id="aclassChannelSpineFlowProblem_html_a23f1b987e3395b1d101eaf3f3b5c94b2"><div class="ttname"><a href="classChannelSpineFlowProblem.html#a23f1b987e3395b1d101eaf3f3b5c94b2">ChannelSpineFlowProblem::ChannelSpineFlowProblem</a></div><div class="ttdeci">ChannelSpineFlowProblem()</div><div class="ttdoc">Constructor.</div><div class="ttdef"><b>Definition:</b> <a href="simple__spine__channel_8cc_source.html#l00505">simple_spine_channel.cc:505</a></div></div>
<div class="ttc" id="asimple__spine__channel_8cc_html_ae66f6b31b5ad750f1fe042a706a4e3d4"><div class="ttname"><a href="simple__spine__channel_8cc.html#ae66f6b31b5ad750f1fe042a706a4e3d4">main</a></div><div class="ttdeci">int main()</div><div class="ttdoc">Driver for channel flow problem with spine mesh.</div><div class="ttdef"><b>Definition:</b> <a href="simple__spine__channel_8cc_source.html#l00654">simple_spine_channel.cc:654</a></div></div>
<div class="ttc" id="aclassWavyWall_html_a598b42ece2600db9eb8c4d1dfeca9ad1"><div class="ttname"><a href="classWavyWall.html#a598b42ece2600db9eb8c4d1dfeca9ad1">WavyWall::L</a></div><div class="ttdeci">double L</div><div class="ttdoc">Wavelength.</div><div class="ttdef"><b>Definition:</b> <a href="simple__spine__channel_8cc_source.html#l00071">simple_spine_channel.cc:71</a></div></div>
<div class="ttc" id="anamespaceGlobal__Physical__Variables_html_a9ec945e33c27b1cfe2e4da7cf3a89f72"><div class="ttname"><a href="namespaceGlobal__Physical__Variables.html#a9ec945e33c27b1cfe2e4da7cf3a89f72">Global_Physical_Variables::L_total</a></div><div class="ttdeci">double L_total</div><div class="ttdoc">Total length of domain.</div><div class="ttdef"><b>Definition:</b> <a href="simple__spine__channel_8cc_source.html#l00420">simple_spine_channel.cc:420</a></div></div>
<div class="ttc" id="anamespaceGlobal__Physical__Variables_html_a4894f9a3a9cbf84f00d0719f2841e624"><div class="ttname"><a href="namespaceGlobal__Physical__Variables.html#a4894f9a3a9cbf84f00d0719f2841e624">Global_Physical_Variables::A</a></div><div class="ttdeci">double A</div><div class="ttdoc">Amplitude of indentation.</div><div class="ttdef"><b>Definition:</b> <a href="simple__spine__channel_8cc_source.html#l00426">simple_spine_channel.cc:426</a></div></div>
<div class="ttc" id="aclassSimpleSpineMesh_html_a69815e3a950e6e5ede2f85004796dadb"><div class="ttname"><a href="classSimpleSpineMesh.html#a69815e3a950e6e5ede2f85004796dadb">SimpleSpineMesh::SimpleSpineMesh</a></div><div class="ttdeci">SimpleSpineMesh(const unsigned &amp;nx, const unsigned &amp;ny, const double &amp;lx, const double &amp;h, GeomObject *substrate_pt, TimeStepper *time_stepper_pt=&amp;Mesh::Default_TimeStepper)</div><div class="ttdoc">Constructor: Pass number of elements in x-direction, number of elements in y-direction,...</div><div class="ttdef"><b>Definition:</b> <a href="simple__spine__channel_8cc_source.html#l00206">simple_spine_channel.cc:206</a></div></div>
<div class="ttc" id="aclassChannelSpineFlowProblem_html_abdf2cc520915167d8718499459df348b"><div class="ttname"><a href="classChannelSpineFlowProblem.html#abdf2cc520915167d8718499459df348b">ChannelSpineFlowProblem::~ChannelSpineFlowProblem</a></div><div class="ttdeci">~ChannelSpineFlowProblem()</div><div class="ttdoc">Destructor: (empty)</div><div class="ttdef"><b>Definition:</b> <a href="simple__spine__channel_8cc_source.html#l00467">simple_spine_channel.cc:467</a></div></div>
<div class="ttc" id="aspine__channel_8txt_html_a96c0ab3a0b092769001018d4f44e37ff"><div class="ttname"><a href="spine__channel_8txt.html#a96c0ab3a0b092769001018d4f44e37ff">L</a></div><div class="ttdeci">mainpage Example curvilinear boundaries These examples had the following common in which the mesh velocity is determined from the history values of the nodal positions We will now consider problems in which the position of the domain boundary is unknown and has to be determined as part of the overall solution This situation e in free surface fluid flow problems and in fluid structure interaction problems We shall explain why c Domain c MacroElement based node update strategies are unlikely to be efficient for such problems and then introduce the Method of Spines as one of a number of f and f[\frac{\partial u_i}{\partial x_i}=0,\f] in the region f where f[h(x_1)=\left\{\begin{array}{cl}H &amp;0 \leq x_1 \leq L_1 \\H+A\sin\left(\frac{x_1-L_1}{L_2-L_1}\right) &amp;L_1 \leq x_1 \leq L_2 \\H &amp;L_2 \leq x_1 \leq L\end{array} \right.\f] shown in this sketch I w textwidth channel_sketch Sketch of the problem subject to the no slip Dirichlet boundary conditions on the top and bottom rigid walls f[\left. \mathbf{u}\right|_{\partial D_{wall}}=(0, 0),\f] parabolic inflow on the left inflow f partial f[\left. \mathbf{u}\right|_{\partial D_{inflow}}=\left(x_2\left(H-x_2\right), 0\right),\f] and axially traction parallel outflow on the outflow f partial f[\left. u_2\right|_{\partial D_{outflow}}=0.\f]&lt;/TD &gt;&lt;/TR &gt;&lt;/TABLE &gt;&lt;/CENTER &gt;&lt; HR &gt;&lt; HR &gt; section results Results The figures below show the obtained from computations with Taylor Hood and Crouzeix Raviart elements for a channel of length f L</div><div class="ttdef"><b>Definition:</b> <a href="spine__channel_8txt_source.html#l00214">spine_channel.txt:214</a></div></div>
<div class="ttc" id="aclassSimpleSpineMesh_html"><div class="ttname"><a href="classSimpleSpineMesh.html">SimpleSpineMesh</a></div><div class="ttdef"><b>Definition:</b> <a href="simple__spine__channel_8cc_source.html#l00089">simple_spine_channel.cc:89</a></div></div>
<div class="ttc" id="aclassWavyWall_html"><div class="ttname"><a href="classWavyWall.html">WavyWall</a></div><div class="ttdef"><b>Definition:</b> <a href="simple__spine__channel_8cc_source.html#l00052">simple_spine_channel.cc:52</a></div></div>
<div class="ttc" id="aclassChannelSpineFlowProblem_html_aaf6dd8a8a472ccd938df579aba61ec97"><div class="ttname"><a href="classChannelSpineFlowProblem.html#aaf6dd8a8a472ccd938df579aba61ec97">ChannelSpineFlowProblem::actions_before_newton_solve</a></div><div class="ttdeci">void actions_before_newton_solve()</div><div class="ttdoc">Update the problem specs before solve. Update the nodal positions.</div><div class="ttdef"><b>Definition:</b> <a href="simple__spine__channel_8cc_source.html#l00471">simple_spine_channel.cc:471</a></div></div>
<div class="ttc" id="aclassWavyWall_html_a435f0fb4db45b51eb371b66b244c7630"><div class="ttname"><a href="classWavyWall.html#a435f0fb4db45b51eb371b66b244c7630">WavyWall::A</a></div><div class="ttdeci">double A</div><div class="ttdoc">Amplitude.</div><div class="ttdef"><b>Definition:</b> <a href="simple__spine__channel_8cc_source.html#l00074">simple_spine_channel.cc:74</a></div></div>
<div class="ttc" id="aspine__channel_8txt_html_a914410aeeaf61a0d6c75c43ec26ecbaa"><div class="ttname"><a href="spine__channel_8txt.html#a914410aeeaf61a0d6c75c43ec26ecbaa">Spine</a></div><div class="ttdeci">When we built the Spine</div><div class="ttdef"><b>Definition:</b> <a href="spine__channel_8txt_source.html#l00434">spine_channel.txt:434</a></div></div>
<div class="ttc" id="anamespaceGlobal__Physical__Variables_html_aad3f0468efff43e7f235a64c27d3acf2"><div class="ttname"><a href="namespaceGlobal__Physical__Variables.html#aad3f0468efff43e7f235a64c27d3acf2">Global_Physical_Variables::height</a></div><div class="ttdeci">double height(const double &amp;x)</div><div class="ttdoc">Height of domain.</div><div class="ttdef"><b>Definition:</b> <a href="simple__spine__channel_8cc_source.html#l00429">simple_spine_channel.cc:429</a></div></div>
<div class="ttc" id="aclassWavyWall_html_a9a9f5a98cb0d15ee801b52495be5e5bf"><div class="ttname"><a href="classWavyWall.html#a9a9f5a98cb0d15ee801b52495be5e5bf">WavyWall::position</a></div><div class="ttdeci">void position(const Vector&lt; double &gt; &amp;zeta, Vector&lt; double &gt; &amp;r) const</div><div class="ttdoc">Position vector to wavy wall.</div><div class="ttdef"><b>Definition:</b> <a href="simple__spine__channel_8cc_source.html#l00062">simple_spine_channel.cc:62</a></div></div>
<div class="ttc" id="aclassWavyWall_html_a7ef7a36cbce8798c1e4a99165dee8cc0"><div class="ttname"><a href="classWavyWall.html#a7ef7a36cbce8798c1e4a99165dee8cc0">WavyWall::WavyWall</a></div><div class="ttdeci">WavyWall(const double &amp;l, const double &amp;amplitude)</div><div class="ttdoc">Constructor: Pass wavelength and amplitude.</div><div class="ttdef"><b>Definition:</b> <a href="simple__spine__channel_8cc_source.html#l00058">simple_spine_channel.cc:58</a></div></div>
<div class="ttc" id="aspine__channel_8txt_html_a8d895bb93cd829890aa4c1a2d5682792"><div class="ttname"><a href="spine__channel_8txt.html#a8d895bb93cd829890aa4c1a2d5682792">problem</a></div><div class="ttdeci">mainpage Example problem</div><div class="ttdef"><b>Definition:</b> <a href="spine__channel_8txt_source.html#l00006">spine_channel.txt:6</a></div></div>
<div class="ttc" id="anamespaceGlobal__Physical__Variables_html_a84cf50616e15acc4db0d9d8765302128"><div class="ttname"><a href="namespaceGlobal__Physical__Variables.html#a84cf50616e15acc4db0d9d8765302128">Global_Physical_Variables::X_indent_start</a></div><div class="ttdeci">double X_indent_start</div><div class="ttdoc">Start of indented region.</div><div class="ttdef"><b>Definition:</b> <a href="simple__spine__channel_8cc_source.html#l00414">simple_spine_channel.cc:414</a></div></div>
<div class="ttc" id="aclassSimpleSpineMesh_html_a7a6d3f655da48ed9d18f6ca8e29f6576"><div class="ttname"><a href="classSimpleSpineMesh.html#a7a6d3f655da48ed9d18f6ca8e29f6576">SimpleSpineMesh::Default_height</a></div><div class="ttdeci">double Default_height</div><div class="ttdoc">Default height.</div><div class="ttdef"><b>Definition:</b> <a href="simple__spine__channel_8cc_source.html#l00184">simple_spine_channel.cc:184</a></div></div>
<div class="ttc" id="anamespaceGlobal__Physical__Variables_html_af6e07423e22c0991084d9a2f43727805"><div class="ttname"><a href="namespaceGlobal__Physical__Variables.html#af6e07423e22c0991084d9a2f43727805">Global_Physical_Variables::H</a></div><div class="ttdeci">double H</div><div class="ttdoc">Undeformed height of domain.</div><div class="ttdef"><b>Definition:</b> <a href="simple__spine__channel_8cc_source.html#l00423">simple_spine_channel.cc:423</a></div></div>
<div class="ttc" id="aclassSimpleSpineMesh_html_a9031e27d5855e029312d356f6a38da76"><div class="ttname"><a href="classSimpleSpineMesh.html#a9031e27d5855e029312d356f6a38da76">SimpleSpineMesh::Substrate_pt</a></div><div class="ttdeci">GeomObject * Substrate_pt</div><div class="ttdoc">Pointer to GeomObject that specifies the &quot;substrate&quot; (the lower wall)</div><div class="ttdef"><b>Definition:</b> <a href="simple__spine__channel_8cc_source.html#l00190">simple_spine_channel.cc:190</a></div></div>
<div class="ttc" id="anamespaceGlobal__Physical__Variables_html"><div class="ttname"><a href="namespaceGlobal__Physical__Variables.html">Global_Physical_Variables</a></div><div class="ttdoc">Namespace for physical parameters.</div><div class="ttdef"><b>Definition:</b> <a href="simple__spine__channel_8cc_source.html#l00407">simple_spine_channel.cc:407</a></div></div>
<div class="ttc" id="aclassChannelSpineFlowProblem_html_ab68c7ab5406b90a0ef56c39b67f83a09"><div class="ttname"><a href="classChannelSpineFlowProblem.html#ab68c7ab5406b90a0ef56c39b67f83a09">ChannelSpineFlowProblem::mesh_pt</a></div><div class="ttdeci">SimpleSpineMesh&lt; ELEMENT &gt; * mesh_pt()</div><div class="ttdoc">Overload access to mesh.</div><div class="ttdef"><b>Definition:</b> <a href="simple__spine__channel_8cc_source.html#l00485">simple_spine_channel.cc:485</a></div></div>
<div class="ttc" id="aclassSimpleSpineMesh_html_a4735e047eab146cafc3090f829373ef2"><div class="ttname"><a href="classSimpleSpineMesh.html#a4735e047eab146cafc3090f829373ef2">SimpleSpineMesh::spine_node_update</a></div><div class="ttdeci">virtual void spine_node_update(SpineNode *spine_node_pt)</div><div class="ttdoc">General node update function implements pure virtual function defined in SpineMesh base class and per...</div><div class="ttdef"><b>Definition:</b> <a href="simple__spine__channel_8cc_source.html#l00157">simple_spine_channel.cc:157</a></div></div>
<div class="ttc" id="anamespaceGlobal__Physical__Variables_html_ab814e627d2eb5bc50318879d19ab16b9"><div class="ttname"><a href="namespaceGlobal__Physical__Variables.html#ab814e627d2eb5bc50318879d19ab16b9">Global_Physical_Variables::Re</a></div><div class="ttdeci">double Re</div><div class="ttdoc">Reynolds number.</div><div class="ttdef"><b>Definition:</b> <a href="simple__spine__channel_8cc_source.html#l00411">simple_spine_channel.cc:411</a></div></div>
<div class="ttc" id="aclassSimpleSpineMesh_html_af84290225b4aea3fd6ba27ad979059a0"><div class="ttname"><a href="classSimpleSpineMesh.html#af84290225b4aea3fd6ba27ad979059a0">SimpleSpineMesh::height_fct_pt</a></div><div class="ttdeci">HeightFctPt &amp; height_fct_pt()</div><div class="ttdoc">Access function: Pointer to height function.</div><div class="ttdef"><b>Definition:</b> <a href="simple__spine__channel_8cc_source.html#l00113">simple_spine_channel.cc:113</a></div></div>

    <!-- jQuery for Bootstrap and Doxygen -->
    <script src="../../../js/jquery-1.12.0.min.js"></script>
    <!-- Minified boostrap plugins-->
    <script src="../../../js/bootstrap.js"></script>
    <!-- Doxygen dependency to add powertips to source code-->
    <script src="../../../js/jquery.powertip.min.js"></script>
    <!-- The  following script is generated by doxygen and hides/shows levels in 
         the data structure lists and adds powertips to source code-->
    <script src="../../../js/dynsections.js" ></script>
    <!-- add to Doxygen's class names so bootstrap css and js recognises them-->
    <script type="text/javascript">
    $(".contents").addClass("container");
    $(".header").addClass("container");
    $(".navpath").addClass("container");
    $("#navrow3").addClass("container");
    $("#navrow4").addClass("container");
    $(".mlabel").addClass("label");
    $(".mlabel").addClass("label-default");
    $(".memitem").addClass("panel");
    $(".memitem").addClass("panel-info");
    $(".memproto").addClass("panel-heading");
    $(".memdoc").addClass("panel-body");
    </script>
    <footer>
      <div class="container">
        <div class="text-muted" style="float:right;">Generated by <a href="http://www.doxygen.org/index.html">
          <img style="height:18px;" class="footer-img" src="doxygen.png" alt="doxygen"></a> on Thu Jul 8 2021 23:10:07
        </div>
      </div>
    </footer>
</body>
</html>

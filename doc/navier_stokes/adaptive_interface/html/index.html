<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
<title>oomph-lib: Example problem: A rigid cylinder rotating in a viscous fluid beneath a free surface.</title>
<link rel="apple-touch-icon" sizes="57x57" href="../../../figures/apple-touch-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="../../../figures/apple-touch-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="../../../figures/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="../../../figures/apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="../../../figures/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="../../../figures/apple-touch-icon-120x120.png">
<link rel="icon" type="image/png" href="../../../figures/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="../../../figures/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="../../../figures/favicon-16x16.png" sizes="16x16">
<link rel="manifest" href="../../../figures/manifest.json">
<link rel="mask-icon" href="../../../figures/safari-pinned-tab.svg" color="#008000">
<link rel="shortcut icon" href="../../../figures/favicon.ico">
<meta name="msapplication-TileColor" content="#00a300">
<meta name="msapplication-config" content="../../../figures/browserconfig.xml">
<meta name="theme-color" content="#008000">
<link href="http://fonts.googleapis.com/css?family=Open+Sans:400,300,600" rel="stylesheet" type="text/css">
<!-- Doxygen css-->
<!-- <link rel="stylesheet" type="text/css" href="doxygen.css"> -->
<!-- Bootstrap -->
<link href="../../../css/bootstrap.css" rel="stylesheet">
<!-- oomph-lib specific overrides -->
<link rel="stylesheet" type="text/css" href="../../../css/oomph_header.css">
</head>
<body>
<nav class="navbar navbar-default">
<div class="container">
<div class="container-fluid">
  <!-- Brand and toggle get grouped for better mobile display -->
  <div class="navbar-header">
    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
      <span class="sr-only">Toggle navigation</span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="../../../html/index.html"><img alt="oomph-lib" src="../../../figures/oomph_logo.png"></a>
  </div>
  <!-- Collect the nav links, forms, and other content for toggling -->
  <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
    <ul class="nav navbar-nav">          
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Documentation <span class="caret"></span></a>
        <ul class="dropdown-menu">
          <li class="dropdown-header">Big picture</li>
          <li><a href="../../../../doc/intro/html/index.html">The finite element method</a></li>
          <li><a href="../../../../doc/the_data_structure/html/index.html">The data structure</a></li>
          <li><a href="../../../../doc/quick_guide/html/index.html">Not-so-quick guide</a></li>
          <li><a href="../../../../doc/optimisation/html/index.html">Optimisation</a></li>
          <li><a href="../../../../doc/order_of_action_functions/html/index.html">Order of action functions</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Example codes and tutorials</li>
          <li><a href="../../../../doc/example_code_list/html/index.html">List of example codes and tutorials</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#meshes">Meshing</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#solvers">Solvers</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#parallel">MPI parallel processing</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#visualisation">Post-processing/visualisation</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Other</li>
          <li><a href="../../../../doc/change_log/html/index.html">Change log</a></li>
          <li><a href="../../../../doc/creating_doc/html/index.html">Creating documentation</a></li>
          <li><a href="../../../../doc/coding_conventions/html/index.html">Coding conventions</a></li>
          <li><a href="../../../../doc/index/html/index.html">Index</a></li>
          <li><a href="../../../../doc/FAQ/html/index.html">FAQ</a></li>
        </ul>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">About <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../../doc/people/html/index.html">People</a></li>            
            <li><a href="../../../../doc/contact/html/index.html">Contact/Get involved</a></li>
            <li><a href="../../../../doc/publications/html/index.html">Publications</a></li>
            <li><a href="../../../../doc/acknowledgements/html/index.html">Acknowledgements</a></li>
            <li><a href="../../../../doc/copyright/html/index.html">Copyright</a></li>
            <li><a href="../../../../doc/picture_show/index.html">Picture show</a></li>
          </ul>
        </li>
      </li>
    </ul>
    <ul class="nav navbar-nav navbar-right navbar-search">
      <form class="navbar-form" role="search" action="../../../../doc/search_results/html/index.html">
        <div class="input-group">
          <input type="text" class="form-control" placeholder="Search" name="q">
          <span class="input-group-btn">
            <button class="btn btn-default" type="submit">Go</button>
          </span>
        </div><!-- /input-group -->
       <!--<div class="form-group">
          <input type="text" class="form-control" placeholder="Search">
        </div>
        <button type="submit" class="btn btn-default">Submit</button>-->
      </form>
    </ul>
  </div><!-- /.navbar-collapse -->
</div><!-- /.container-fluid -->
</div>
</nav>
<!-- Generated by Doxygen 1.9.8 -->
</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">Example problem: A rigid cylinder rotating in a viscous fluid beneath a free surface. </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Detailed documentation to be written. Here's the driver code...</p>
<p>(This problem is solved using spatially adaptive elements with a pseudo-elastic remesh strategy)</p>
<div class="fragment"><div class="line"><span class="comment">//LIC// ====================================================================</span></div>
<div class="line"><span class="comment">//LIC// This file forms part of oomph-lib, the object-oriented, </span></div>
<div class="line"><span class="comment">//LIC// multi-physics finite-element library, available </span></div>
<div class="line"><span class="comment">//LIC// at http://www.oomph-lib.org.</span></div>
<div class="line"><span class="comment">//LIC// </span></div>
<div class="line"><span class="comment">//LIC// Copyright (C) 2006-2026 Matthias Heil and Andrew Hazel</span></div>
<div class="line"><span class="comment">//LIC// </span></div>
<div class="line"><span class="comment">//LIC// This library is free software; you can redistribute it and/or</span></div>
<div class="line"><span class="comment">//LIC// modify it under the terms of the GNU Lesser General Public</span></div>
<div class="line"><span class="comment">//LIC// License as published by the Free Software Foundation; either</span></div>
<div class="line"><span class="comment">//LIC// version 2.1 of the License, or (at your option) any later version.</span></div>
<div class="line"><span class="comment">//LIC// </span></div>
<div class="line"><span class="comment">//LIC// This library is distributed in the hope that it will be useful,</span></div>
<div class="line"><span class="comment">//LIC// but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div>
<div class="line"><span class="comment">//LIC// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</span></div>
<div class="line"><span class="comment">//LIC// Lesser General Public License for more details.</span></div>
<div class="line"><span class="comment">//LIC// </span></div>
<div class="line"><span class="comment">//LIC// You should have received a copy of the GNU Lesser General Public</span></div>
<div class="line"><span class="comment">//LIC// License along with this library; if not, write to the Free Software</span></div>
<div class="line"><span class="comment">//LIC// Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA</span></div>
<div class="line"><span class="comment">//LIC// 02110-1301  USA.</span></div>
<div class="line"><span class="comment">//LIC// </span></div>
<div class="line"><span class="comment">//LIC// The authors may be contacted at oomph-lib@maths.man.ac.uk.</span></div>
<div class="line"><span class="comment">//LIC// </span></div>
<div class="line"><span class="comment">//LIC//====================================================================</span></div>
<div class="line"><span class="comment">//A driver program to solve the problem of a cylinder rotating near a free</span></div>
<div class="line"><span class="comment">//surface</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &quot;generic.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;navier_stokes.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;solid.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;fluid_interface.h&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">using namespace </span>oomph;</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment">//=start_of_namespace================================================</span><span class="comment"></span></div>
<div class="line"><span class="comment">/// Namespace for physical parameters</span></div>
<div class="line"><span class="comment"></span><span class="comment">//===================================================================</span></div>
<div class="line"><span class="keyword">namespace </span><a class="code hl_namespace" href="namespaceGlobal__Physical__Variables.html">Global_Physical_Variables</a></div>
<div class="line">{</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Pseudo-solid Poisson ratio</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">double</span> <a class="code hl_variable" href="namespaceGlobal__Physical__Variables.html#a3962c36313826b19f216f6bbbdd6a477">Nu</a>=0.1;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Direction of the wall normal vector</span></div>
<div class="line"><span class="comment"></span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Vector&lt;double&gt;</a> <a class="code hl_variable" href="namespaceGlobal__Physical__Variables.html#a5feb3df21fc4a0adefadecb8a8ed98d7">Wall_normal</a>;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Function that specifies the wall unit normal</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">void</span> <a class="code hl_function" href="namespaceGlobal__Physical__Variables.html#a0d48e8726fa485de2b2df2d5031ec41b">wall_unit_normal_fct</a>(<span class="keyword">const</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Vector&lt;double&gt;</a> &amp;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">x</a>, </div>
<div class="line">                      <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Vector&lt;double&gt;</a> &amp;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">normal</a>)</div>
<div class="line"> {</div>
<div class="line">  <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">normal</a>=<a class="code hl_variable" href="namespaceGlobal__Physical__Variables.html#a5feb3df21fc4a0adefadecb8a8ed98d7">Wall_normal</a>;</div>
<div class="line"> }</div>
<div class="line"> </div>
<div class="line">} <span class="comment">// end_of_namespace</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment">//My own Ellipse class</span></div>
<div class="line"><span class="keyword">class </span><a class="code hl_class" href="classGeneralEllipse.html">GeneralEllipse</a> : <span class="keyword">public</span> GeomObject</div>
<div class="line">{</div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line"> <span class="comment">//Internal data to store the centre and semi-axes</span></div>
<div class="line"> <span class="keywordtype">double</span> *<a class="code hl_variable" href="classGeneralEllipse.html#a94a4648c20c4a51e2e9599634e32f9f1">centre_x_pt</a>, *<a class="code hl_variable" href="classGeneralEllipse.html#a64b87c57aa9b725a9099fb64aa2586dd">centre_y_pt</a>, *<a class="code hl_variable" href="classGeneralEllipse.html#ab7accdeac49aacf9f6a1b2fc935e9692">a_pt</a>, *<a class="code hl_variable" href="classGeneralEllipse.html#ae9fda2830674311985eaf2fddeeec1e3">b_pt</a>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line"> </div>
<div class="line"> <span class="comment">//Constructor</span></div>
<div class="line"> <a class="code hl_class" href="classGeneralEllipse.html">GeneralEllipse</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> &amp;centre_x, <span class="keyword">const</span> <span class="keywordtype">double</span> &amp;centre_y,</div>
<div class="line">                <span class="keyword">const</span> <span class="keywordtype">double</span> &amp;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">a</a>, <span class="keyword">const</span> <span class="keywordtype">double</span> &amp;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">b</a>)</div>
<div class="line">  : GeomObject(1,2), <a class="code hl_variable" href="classGeneralEllipse.html#a94a4648c20c4a51e2e9599634e32f9f1">centre_x_pt</a>(0), <a class="code hl_variable" href="classGeneralEllipse.html#a64b87c57aa9b725a9099fb64aa2586dd">centre_y_pt</a>(0), <a class="code hl_variable" href="classGeneralEllipse.html#ab7accdeac49aacf9f6a1b2fc935e9692">a_pt</a>(0), <a class="code hl_variable" href="classGeneralEllipse.html#ae9fda2830674311985eaf2fddeeec1e3">b_pt</a>(0)</div>
<div class="line">  {</div>
<div class="line">   <a class="code hl_variable" href="classGeneralEllipse.html#a94a4648c20c4a51e2e9599634e32f9f1">centre_x_pt</a> = <span class="keyword">new</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">double</a>(centre_x);</div>
<div class="line">   <a class="code hl_variable" href="classGeneralEllipse.html#a64b87c57aa9b725a9099fb64aa2586dd">centre_y_pt</a> = <span class="keyword">new</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">double</a>(centre_y);</div>
<div class="line">   <a class="code hl_variable" href="classGeneralEllipse.html#ab7accdeac49aacf9f6a1b2fc935e9692">a_pt</a> = <span class="keyword">new</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">double</a>(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">a</a>);</div>
<div class="line">   <a class="code hl_variable" href="classGeneralEllipse.html#ae9fda2830674311985eaf2fddeeec1e3">b_pt</a> = <span class="keyword">new</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">double</a>(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">b</a>);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> <span class="comment">//Destructor</span></div>
<div class="line"> <a class="code hl_function" href="classGeneralEllipse.html#a3ac5c17cf8c4998f1b74913860cb3bb9">~GeneralEllipse</a>()</div>
<div class="line">  {</div>
<div class="line">   <span class="keyword">delete</span> <a class="code hl_variable" href="classGeneralEllipse.html#a94a4648c20c4a51e2e9599634e32f9f1">centre_x_pt</a>;</div>
<div class="line">   <span class="keyword">delete</span> <a class="code hl_variable" href="classGeneralEllipse.html#a64b87c57aa9b725a9099fb64aa2586dd">centre_y_pt</a>;</div>
<div class="line">   <span class="keyword">delete</span> <a class="code hl_variable" href="classGeneralEllipse.html#ab7accdeac49aacf9f6a1b2fc935e9692">a_pt</a>;</div>
<div class="line">   <span class="keyword">delete</span> <a class="code hl_variable" href="classGeneralEllipse.html#ae9fda2830674311985eaf2fddeeec1e3">b_pt</a>;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> <span class="comment">//Return the position</span></div>
<div class="line"> <span class="keywordtype">void</span> <a class="code hl_function" href="classGeneralEllipse.html#a85e975c70441a9c9c711b5e27d124bff">position</a>(<span class="keyword">const</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Vector&lt;double&gt;</a> &amp;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">xi</a>, <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Vector&lt;double&gt;</a> &amp;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">r</a>)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword">  </span>{</div>
<div class="line">   <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">r</a>[0] = *<a class="code hl_variable" href="classGeneralEllipse.html#a94a4648c20c4a51e2e9599634e32f9f1">centre_x_pt</a> + *<a class="code hl_variable" href="classGeneralEllipse.html#ab7accdeac49aacf9f6a1b2fc935e9692">a_pt</a>*<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">cos</a>(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">xi</a>[0]);</div>
<div class="line">   <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">r</a>[1] = *<a class="code hl_variable" href="classGeneralEllipse.html#a64b87c57aa9b725a9099fb64aa2586dd">centre_y_pt</a> + *<a class="code hl_variable" href="classGeneralEllipse.html#ae9fda2830674311985eaf2fddeeec1e3">b_pt</a>*<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">sin</a>(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">xi</a>[0]);</div>
<div class="line">  }</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment">//A Domain</span></div>
<div class="line"><span class="keyword">class </span><a class="code hl_class" href="classCylinderAndInterfaceDomain.html">CylinderAndInterfaceDomain</a> : <span class="keyword">public</span> Domain</div>
<div class="line">{</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line"> <span class="keywordtype">double</span> <a class="code hl_variable" href="classCylinderAndInterfaceDomain.html#a0b5aefe768267a1dff936ab491bee938">centre_x</a>, <a class="code hl_variable" href="classCylinderAndInterfaceDomain.html#ac461297e0b08287a1909f245569c77f0">centre_y</a>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line"> </div>
<div class="line"> <span class="keywordtype">double</span> <a class="code hl_variable" href="classCylinderAndInterfaceDomain.html#a27c21e714221edda1d21995f941e74e3">Lower_left</a>[2], <a class="code hl_variable" href="classCylinderAndInterfaceDomain.html#a04206f6c72189356d5eecf32b81595f4">Lower_right</a>[2], <a class="code hl_variable" href="classCylinderAndInterfaceDomain.html#a5285785212f1cbcfb3910e87421d831c">Lower_mid_left</a>[2], <a class="code hl_variable" href="classCylinderAndInterfaceDomain.html#a390ef76333ff22e7331b37ac7d5412bb">Lower_mid_right</a>[2];</div>
<div class="line"> <span class="keywordtype">double</span> <a class="code hl_variable" href="classCylinderAndInterfaceDomain.html#a2ad3d09d983dfcd5cc2a2b4c0d3d8b62">Upper_left</a>[2], <a class="code hl_variable" href="classCylinderAndInterfaceDomain.html#a87b1a618cc0116816b5460f00f3875a6">Upper_right</a>[2], <a class="code hl_variable" href="classCylinderAndInterfaceDomain.html#a01c924b854c98cb5a45ba2d1af43aa46">Upper_mid_left</a>[2], <a class="code hl_variable" href="classCylinderAndInterfaceDomain.html#afb8019b28889f581f79541d571fb6386">Upper_mid_right</a>[2];</div>
<div class="line"> <span class="keywordtype">double</span> <a class="code hl_variable" href="classCylinderAndInterfaceDomain.html#a389bb3200199cf6098461f884e1b4d09">Lower_centre_left</a>[2], <a class="code hl_variable" href="classCylinderAndInterfaceDomain.html#a1f1363c5343672e04be3b9f3285b0a25">Lower_centre_right</a>[2];</div>
<div class="line"> <span class="keywordtype">double</span> <a class="code hl_variable" href="classCylinderAndInterfaceDomain.html#a231d89466e433b65d0a6fd74b29b4609">Upper_centre_left</a>[2], <a class="code hl_variable" href="classCylinderAndInterfaceDomain.html#a21972e49d0da0a5c1cbb89422b8bcfc3">Upper_centre_right</a>[2];</div>
<div class="line"> </div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Geometric object that represents the rotating cylinder</span></div>
<div class="line"><span class="comment"></span> GeomObject* <a class="code hl_variable" href="classCylinderAndInterfaceDomain.html#aa0afda5d24ea33ff58957731e5b7dfd7">Cylinder_pt</a>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line"> </div>
<div class="line"> <span class="comment">//Constructor, pass the length and height of the domain</span></div>
<div class="line"> <a class="code hl_class" href="classCylinderAndInterfaceDomain.html">CylinderAndInterfaceDomain</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> &amp;Length, <span class="keyword">const</span> <span class="keywordtype">double</span> &amp;Height)</div>
<div class="line">  {   </div>
<div class="line"> </div>
<div class="line">   <a class="code hl_variable" href="classCylinderAndInterfaceDomain.html#a0b5aefe768267a1dff936ab491bee938">centre_x</a> = Length/2.0;</div>
<div class="line">   <a class="code hl_variable" href="classCylinderAndInterfaceDomain.html#ac461297e0b08287a1909f245569c77f0">centre_y</a> = Height/2.0; <span class="comment">//3.0*Height/4.0;</span></div>
<div class="line">  <span class="comment">//Create a new ellipse object to represent the rotating cylinder</span></div>
<div class="line">   <a class="code hl_variable" href="classCylinderAndInterfaceDomain.html#aa0afda5d24ea33ff58957731e5b7dfd7">Cylinder_pt</a> = <span class="keyword">new</span> <a class="code hl_class" href="classGeneralEllipse.html">GeneralEllipse</a>(<a class="code hl_variable" href="classCylinderAndInterfaceDomain.html#a0b5aefe768267a1dff936ab491bee938">centre_x</a>,<a class="code hl_variable" href="classCylinderAndInterfaceDomain.html#ac461297e0b08287a1909f245569c77f0">centre_y</a>,0.2*Height,0.2*Height);</div>
<div class="line"> </div>
<div class="line">   <span class="comment">//Set some basic coordinates</span></div>
<div class="line"> </div>
<div class="line">   <a class="code hl_variable" href="classCylinderAndInterfaceDomain.html#a27c21e714221edda1d21995f941e74e3">Lower_left</a>[0] = 0.0;</div>
<div class="line">   <a class="code hl_variable" href="classCylinderAndInterfaceDomain.html#a27c21e714221edda1d21995f941e74e3">Lower_left</a>[1] = 0.0;</div>
<div class="line">   </div>
<div class="line">   <a class="code hl_variable" href="classCylinderAndInterfaceDomain.html#a2ad3d09d983dfcd5cc2a2b4c0d3d8b62">Upper_left</a>[0] = 0.0;</div>
<div class="line">   <a class="code hl_variable" href="classCylinderAndInterfaceDomain.html#a2ad3d09d983dfcd5cc2a2b4c0d3d8b62">Upper_left</a>[1] = Height;</div>
<div class="line"> </div>
<div class="line">   <a class="code hl_variable" href="classCylinderAndInterfaceDomain.html#a04206f6c72189356d5eecf32b81595f4">Lower_right</a>[0] = Length;</div>
<div class="line">   <a class="code hl_variable" href="classCylinderAndInterfaceDomain.html#a04206f6c72189356d5eecf32b81595f4">Lower_right</a>[1] = 0.0;</div>
<div class="line">   </div>
<div class="line">   <a class="code hl_variable" href="classCylinderAndInterfaceDomain.html#a87b1a618cc0116816b5460f00f3875a6">Upper_right</a>[0] = Length;</div>
<div class="line">   <a class="code hl_variable" href="classCylinderAndInterfaceDomain.html#a87b1a618cc0116816b5460f00f3875a6">Upper_right</a>[1] = Height;</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">   <span class="comment">//Let&#39;s just do some mid coordinates</span></div>
<div class="line">   <a class="code hl_variable" href="classCylinderAndInterfaceDomain.html#a5285785212f1cbcfb3910e87421d831c">Lower_mid_left</a>[0] = Length/10.0;</div>
<div class="line">   <a class="code hl_variable" href="classCylinderAndInterfaceDomain.html#a5285785212f1cbcfb3910e87421d831c">Lower_mid_left</a>[1] = 0.0;</div>
<div class="line"> </div>
<div class="line">   <a class="code hl_variable" href="classCylinderAndInterfaceDomain.html#a01c924b854c98cb5a45ba2d1af43aa46">Upper_mid_left</a>[0] = Length/10.0;</div>
<div class="line">   <a class="code hl_variable" href="classCylinderAndInterfaceDomain.html#a01c924b854c98cb5a45ba2d1af43aa46">Upper_mid_left</a>[1] = Height;</div>
<div class="line"> </div>
<div class="line">   <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Vector&lt;double&gt;</a> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">xi</a>(1), <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">f</a>(2);</div>
<div class="line">   <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">xi</a>[0] = -3.0*<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">atan</a>(1.0);</div>
<div class="line">   <a class="code hl_variable" href="classCylinderAndInterfaceDomain.html#aa0afda5d24ea33ff58957731e5b7dfd7">Cylinder_pt</a>-&gt;position(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">xi</a>,<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">f</a>);</div>
<div class="line"> </div>
<div class="line">   <a class="code hl_variable" href="classCylinderAndInterfaceDomain.html#a389bb3200199cf6098461f884e1b4d09">Lower_centre_left</a>[0] = <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">f</a>[0];</div>
<div class="line">   <a class="code hl_variable" href="classCylinderAndInterfaceDomain.html#a389bb3200199cf6098461f884e1b4d09">Lower_centre_left</a>[1] = <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">f</a>[1];</div>
<div class="line">   </div>
<div class="line">   <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">xi</a>[0] = 3.0*<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">atan</a>(1.0);</div>
<div class="line">   <a class="code hl_variable" href="classCylinderAndInterfaceDomain.html#aa0afda5d24ea33ff58957731e5b7dfd7">Cylinder_pt</a>-&gt;position(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">xi</a>,<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">f</a>);</div>
<div class="line"> </div>
<div class="line">   <a class="code hl_variable" href="classCylinderAndInterfaceDomain.html#a231d89466e433b65d0a6fd74b29b4609">Upper_centre_left</a>[0] = <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">f</a>[0];</div>
<div class="line">   <a class="code hl_variable" href="classCylinderAndInterfaceDomain.html#a231d89466e433b65d0a6fd74b29b4609">Upper_centre_left</a>[1] = <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">f</a>[1];</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">   <a class="code hl_variable" href="classCylinderAndInterfaceDomain.html#a390ef76333ff22e7331b37ac7d5412bb">Lower_mid_right</a>[0] = 9.0*Length/10.0;</div>
<div class="line">   <a class="code hl_variable" href="classCylinderAndInterfaceDomain.html#a390ef76333ff22e7331b37ac7d5412bb">Lower_mid_right</a>[1] = 0.0;</div>
<div class="line"> </div>
<div class="line">   <a class="code hl_variable" href="classCylinderAndInterfaceDomain.html#afb8019b28889f581f79541d571fb6386">Upper_mid_right</a>[0] = 9.0*Length/10.0;</div>
<div class="line">   <a class="code hl_variable" href="classCylinderAndInterfaceDomain.html#afb8019b28889f581f79541d571fb6386">Upper_mid_right</a>[1] = Height;</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">   <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">xi</a>[0] = -1.0*<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">atan</a>(1.0);</div>
<div class="line">   <a class="code hl_variable" href="classCylinderAndInterfaceDomain.html#aa0afda5d24ea33ff58957731e5b7dfd7">Cylinder_pt</a>-&gt;position(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">xi</a>,<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">f</a>);</div>
<div class="line"> </div>
<div class="line">   <a class="code hl_variable" href="classCylinderAndInterfaceDomain.html#a1f1363c5343672e04be3b9f3285b0a25">Lower_centre_right</a>[0] = <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">f</a>[0];</div>
<div class="line">   <a class="code hl_variable" href="classCylinderAndInterfaceDomain.html#a1f1363c5343672e04be3b9f3285b0a25">Lower_centre_right</a>[1] = <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">f</a>[1];</div>
<div class="line">   </div>
<div class="line">   <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">xi</a>[0] = 1.0*<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">atan</a>(1.0);</div>
<div class="line">   <a class="code hl_variable" href="classCylinderAndInterfaceDomain.html#aa0afda5d24ea33ff58957731e5b7dfd7">Cylinder_pt</a>-&gt;position(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">xi</a>,<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">f</a>);</div>
<div class="line"> </div>
<div class="line">   <a class="code hl_variable" href="classCylinderAndInterfaceDomain.html#a21972e49d0da0a5c1cbb89422b8bcfc3">Upper_centre_right</a>[0] = <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">f</a>[0];</div>
<div class="line">   <a class="code hl_variable" href="classCylinderAndInterfaceDomain.html#a21972e49d0da0a5c1cbb89422b8bcfc3">Upper_centre_right</a>[1] = <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">f</a>[1];</div>
<div class="line">   </div>
<div class="line">   <span class="comment">//There are six macro elements</span></div>
<div class="line">   <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Macro_element_pt</a>.resize(6); </div>
<div class="line"> </div>
<div class="line">   <span class="comment">// Build the macro elements</span></div>
<div class="line">   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">i</a>=0;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">i</a>&lt;6;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">i</a>++)</div>
<div class="line">    {<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Macro_element_pt</a>[<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">i</a>]= <span class="keyword">new</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">QMacroElement&lt;2&gt;</a>(<span class="keyword">this</span>,<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">i</a>);}</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Destructor: Empty; cleanup done in base class</span></div>
<div class="line"> <a class="code hl_function" href="classCylinderAndInterfaceDomain.html#aa204e83ef6332f121123465f4167d341">~CylinderAndInterfaceDomain</a>() {}</div>
<div class="line"> </div>
<div class="line"> <span class="comment">//Private little interpolation problem</span></div>
<div class="line"> <span class="keywordtype">void</span> <a class="code hl_function" href="classCylinderAndInterfaceDomain.html#acab40651417c703e6b3dc592198c7497">linear_interpolate</a>(<span class="keywordtype">double</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Left</a>[2], <span class="keywordtype">double</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Right</a>[2],</div>
<div class="line">                         <span class="keyword">const</span> <span class="keywordtype">double</span> &amp;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">s</a>, <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Vector&lt;double&gt;</a> &amp;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">f</a>)</div>
<div class="line">  {</div>
<div class="line">   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">i</a>=0;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">i</a>&lt;2;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">i</a>++)</div>
<div class="line">    {</div>
<div class="line">     <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">f</a>[<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">i</a>] = <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Left</a>[<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">i</a>] + (<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Right</a>[<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">i</a>] - <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Left</a>[<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">i</a>])*0.5*(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">s</a>+1.0);</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">   </div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Sort out the vector representation of the i-th macro element</span></div>
<div class="line"> <span class="keywordtype">void</span> <a class="code hl_function" href="classCylinderAndInterfaceDomain.html#a6afdef0d863b2833884aed2f571eeb79">macro_element_boundary</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">time</a>,</div>
<div class="line">                             <span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">m</a>,</div>
<div class="line">                             <span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">direction</a>,</div>
<div class="line">                             <span class="keyword">const</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Vector&lt;double&gt;</a> &amp;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">s</a>,</div>
<div class="line">                             <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Vector&lt;double&gt;</a>&amp; <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">f</a>)</div>
<div class="line"> {</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">using namespace </span><a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">QuadTreeNames</a>;</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#ifdef WARN_ABOUT_SUBTLY_CHANGED_OOMPH_INTERFACES</span></div>
<div class="line">   <span class="comment">// Warn about time argument being moved to the front</span></div>
<div class="line">   <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">OomphLibWarning</a>(</div>
<div class="line">    <span class="stringliteral">&quot;Order of function arguments has changed between versions 0.8 and 0.85&quot;</span>,</div>
<div class="line">    <span class="stringliteral">&quot;CylinderAndInterfaceDomain::macro_element_boundary(...)&quot;</span>,</div>
<div class="line">    <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"> </div>
<div class="line">  <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Vector&lt;double&gt;</a> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">xi</a>(1);  </div>
<div class="line"> </div>
<div class="line">  <span class="comment">//Switch on the macro element</span></div>
<div class="line">  <span class="keywordflow">switch</span>(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">m</a>)</div>
<div class="line">   {</div>
<div class="line">    <span class="comment">//Macro element 0, is the left-hand film</span></div>
<div class="line">   <span class="keywordflow">case</span> 0:</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">switch</span>(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">direction</a>)</div>
<div class="line">     {</div>
<div class="line">     <span class="keywordflow">case</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">N</a>:</div>
<div class="line">      <a class="code hl_function" href="classCylinderAndInterfaceDomain.html#acab40651417c703e6b3dc592198c7497">linear_interpolate</a>(<a class="code hl_variable" href="classCylinderAndInterfaceDomain.html#a2ad3d09d983dfcd5cc2a2b4c0d3d8b62">Upper_left</a>,<a class="code hl_variable" href="classCylinderAndInterfaceDomain.html#a01c924b854c98cb5a45ba2d1af43aa46">Upper_mid_left</a>,<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">s</a>[0],<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">f</a>);</div>
<div class="line">      <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">     <span class="keywordflow">case</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">S</a>:  </div>
<div class="line">       <a class="code hl_function" href="classCylinderAndInterfaceDomain.html#acab40651417c703e6b3dc592198c7497">linear_interpolate</a>(<a class="code hl_variable" href="classCylinderAndInterfaceDomain.html#a27c21e714221edda1d21995f941e74e3">Lower_left</a>,<a class="code hl_variable" href="classCylinderAndInterfaceDomain.html#a5285785212f1cbcfb3910e87421d831c">Lower_mid_left</a>,<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">s</a>[0],<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">f</a>);</div>
<div class="line">      <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">     <span class="keywordflow">case</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">W</a>:</div>
<div class="line">       <a class="code hl_function" href="classCylinderAndInterfaceDomain.html#acab40651417c703e6b3dc592198c7497">linear_interpolate</a>(<a class="code hl_variable" href="classCylinderAndInterfaceDomain.html#a27c21e714221edda1d21995f941e74e3">Lower_left</a>,<a class="code hl_variable" href="classCylinderAndInterfaceDomain.html#a2ad3d09d983dfcd5cc2a2b4c0d3d8b62">Upper_left</a>,<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">s</a>[0],<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">f</a>);</div>
<div class="line">      <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">     <span class="keywordflow">case</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">E</a>:</div>
<div class="line">       <a class="code hl_function" href="classCylinderAndInterfaceDomain.html#acab40651417c703e6b3dc592198c7497">linear_interpolate</a>(<a class="code hl_variable" href="classCylinderAndInterfaceDomain.html#a5285785212f1cbcfb3910e87421d831c">Lower_mid_left</a>,<a class="code hl_variable" href="classCylinderAndInterfaceDomain.html#a01c924b854c98cb5a45ba2d1af43aa46">Upper_mid_left</a>,<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">s</a>[0],<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">f</a>);</div>
<div class="line">      <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">     <span class="keywordflow">default</span>:</div>
<div class="line">      <a class="code hl_function" href="classRefineableCylinderAndInterfaceMesh.html#a2f42954cee8f7ba47d87f842dbdc4cc2">std::ostringstream</a> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">error_stream</a>;</div>
<div class="line">      <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">error_stream</a> &lt;&lt; <span class="stringliteral">&quot;Direction is incorrect: &quot;</span> &lt;&lt; <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">direction</a> &lt;&lt; <a class="code hl_function" href="classRefineableCylinderAndInterfaceMesh.html#a2f42954cee8f7ba47d87f842dbdc4cc2">std::endl</a>;</div>
<div class="line"> </div>
<div class="line">      <span class="keywordflow">throw</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">OomphLibError</a>(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">error_stream</a>.str(),</div>
<div class="line">                          <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line">                          <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line">     }</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">break</span>;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">//Macro element 1, is immediately left of the cylinder</span></div>
<div class="line">   <span class="keywordflow">case</span> 1:</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">switch</span>(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">direction</a>)</div>
<div class="line">     {</div>
<div class="line">     <span class="keywordflow">case</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">N</a>:</div>
<div class="line">       <a class="code hl_function" href="classCylinderAndInterfaceDomain.html#acab40651417c703e6b3dc592198c7497">linear_interpolate</a>(<a class="code hl_variable" href="classCylinderAndInterfaceDomain.html#a01c924b854c98cb5a45ba2d1af43aa46">Upper_mid_left</a>,<a class="code hl_variable" href="classCylinderAndInterfaceDomain.html#a231d89466e433b65d0a6fd74b29b4609">Upper_centre_left</a>,<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">s</a>[0],<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">f</a>);</div>
<div class="line">      <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">     <span class="keywordflow">case</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">S</a>:  </div>
<div class="line">       <a class="code hl_function" href="classCylinderAndInterfaceDomain.html#acab40651417c703e6b3dc592198c7497">linear_interpolate</a>(<a class="code hl_variable" href="classCylinderAndInterfaceDomain.html#a5285785212f1cbcfb3910e87421d831c">Lower_mid_left</a>,<a class="code hl_variable" href="classCylinderAndInterfaceDomain.html#a389bb3200199cf6098461f884e1b4d09">Lower_centre_left</a>,<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">s</a>[0],<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">f</a>);</div>
<div class="line">      <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">     <span class="keywordflow">case</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">W</a>:</div>
<div class="line">       <a class="code hl_function" href="classCylinderAndInterfaceDomain.html#acab40651417c703e6b3dc592198c7497">linear_interpolate</a>(<a class="code hl_variable" href="classCylinderAndInterfaceDomain.html#a5285785212f1cbcfb3910e87421d831c">Lower_mid_left</a>,<a class="code hl_variable" href="classCylinderAndInterfaceDomain.html#a01c924b854c98cb5a45ba2d1af43aa46">Upper_mid_left</a>,<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">s</a>[0],<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">f</a>);</div>
<div class="line">      <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">     <span class="keywordflow">case</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">E</a>:</div>
<div class="line">      <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">xi</a>[0] = 5.0*<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">atan</a>(1.0) - 2.0*<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">atan</a>(1.0)*0.5*(1.0+<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">s</a>[0]);</div>
<div class="line">      <a class="code hl_variable" href="classCylinderAndInterfaceDomain.html#aa0afda5d24ea33ff58957731e5b7dfd7">Cylinder_pt</a>-&gt;position(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">xi</a>,<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">f</a>);</div>
<div class="line">      <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">     <span class="keywordflow">default</span>:</div>
<div class="line">      <a class="code hl_function" href="classRefineableCylinderAndInterfaceMesh.html#a2f42954cee8f7ba47d87f842dbdc4cc2">std::ostringstream</a> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">error_stream</a>;</div>
<div class="line">      <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">error_stream</a> &lt;&lt; <span class="stringliteral">&quot;Direction is incorrect: &quot;</span> &lt;&lt; <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">direction</a> &lt;&lt; <a class="code hl_function" href="classRefineableCylinderAndInterfaceMesh.html#a2f42954cee8f7ba47d87f842dbdc4cc2">std::endl</a>;</div>
<div class="line">      </div>
<div class="line">      <span class="keywordflow">throw</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">OomphLibError</a>(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">error_stream</a>.str(),</div>
<div class="line">                          <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line">                          <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line">     }</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">   <span class="comment">//Macro element 2, is immediately above the cylinder</span></div>
<div class="line">   <span class="keywordflow">case</span> 2:</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">switch</span>(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">direction</a>)</div>
<div class="line">     {</div>
<div class="line">     <span class="keywordflow">case</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">N</a>:</div>
<div class="line">       <a class="code hl_function" href="classCylinderAndInterfaceDomain.html#acab40651417c703e6b3dc592198c7497">linear_interpolate</a>(<a class="code hl_variable" href="classCylinderAndInterfaceDomain.html#a01c924b854c98cb5a45ba2d1af43aa46">Upper_mid_left</a>,<a class="code hl_variable" href="classCylinderAndInterfaceDomain.html#afb8019b28889f581f79541d571fb6386">Upper_mid_right</a>,<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">s</a>[0],<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">f</a>);</div>
<div class="line">      <span class="keywordflow">break</span>;</div>
<div class="line">      </div>
<div class="line">     <span class="keywordflow">case</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">S</a>:  </div>
<div class="line">      <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">xi</a>[0] = 3.0*<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">atan</a>(1.0) - 2.0*<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">atan</a>(1.0)*0.5*(1.0+<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">s</a>[0]);</div>
<div class="line">      <a class="code hl_variable" href="classCylinderAndInterfaceDomain.html#aa0afda5d24ea33ff58957731e5b7dfd7">Cylinder_pt</a>-&gt;position(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">xi</a>,<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">f</a>);</div>
<div class="line">      <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">     <span class="keywordflow">case</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">W</a>:</div>
<div class="line">       <a class="code hl_function" href="classCylinderAndInterfaceDomain.html#acab40651417c703e6b3dc592198c7497">linear_interpolate</a>(<a class="code hl_variable" href="classCylinderAndInterfaceDomain.html#a231d89466e433b65d0a6fd74b29b4609">Upper_centre_left</a>,<a class="code hl_variable" href="classCylinderAndInterfaceDomain.html#a01c924b854c98cb5a45ba2d1af43aa46">Upper_mid_left</a>,<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">s</a>[0],<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">f</a>);</div>
<div class="line">      <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">     <span class="keywordflow">case</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">E</a>:</div>
<div class="line">       <a class="code hl_function" href="classCylinderAndInterfaceDomain.html#acab40651417c703e6b3dc592198c7497">linear_interpolate</a>(<a class="code hl_variable" href="classCylinderAndInterfaceDomain.html#a21972e49d0da0a5c1cbb89422b8bcfc3">Upper_centre_right</a>,<a class="code hl_variable" href="classCylinderAndInterfaceDomain.html#afb8019b28889f581f79541d571fb6386">Upper_mid_right</a>,<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">s</a>[0],<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">f</a>);</div>
<div class="line">      <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">     <span class="keywordflow">default</span>:</div>
<div class="line">      <a class="code hl_function" href="classRefineableCylinderAndInterfaceMesh.html#a2f42954cee8f7ba47d87f842dbdc4cc2">std::ostringstream</a> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">error_stream</a>;</div>
<div class="line">      <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">error_stream</a> &lt;&lt; <span class="stringliteral">&quot;Direction is incorrect: &quot;</span> &lt;&lt; <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">direction</a> &lt;&lt; <a class="code hl_function" href="classRefineableCylinderAndInterfaceMesh.html#a2f42954cee8f7ba47d87f842dbdc4cc2">std::endl</a>;</div>
<div class="line">      </div>
<div class="line">      <span class="keywordflow">throw</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">OomphLibError</a>(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">error_stream</a>.str(),</div>
<div class="line">                          <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line">                          <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line">     }</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">//Macro element 3, is immediately right of the cylinder</span></div>
<div class="line">   <span class="keywordflow">case</span> 3:</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">switch</span>(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">direction</a>)</div>
<div class="line">     {</div>
<div class="line">     <span class="keywordflow">case</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">N</a>:</div>
<div class="line">       <a class="code hl_function" href="classCylinderAndInterfaceDomain.html#acab40651417c703e6b3dc592198c7497">linear_interpolate</a>(<a class="code hl_variable" href="classCylinderAndInterfaceDomain.html#a21972e49d0da0a5c1cbb89422b8bcfc3">Upper_centre_right</a>,<a class="code hl_variable" href="classCylinderAndInterfaceDomain.html#afb8019b28889f581f79541d571fb6386">Upper_mid_right</a>,<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">s</a>[0],<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">f</a>);</div>
<div class="line">      <span class="keywordflow">break</span>;</div>
<div class="line">      </div>
<div class="line">     <span class="keywordflow">case</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">S</a>:  </div>
<div class="line">       <a class="code hl_function" href="classCylinderAndInterfaceDomain.html#acab40651417c703e6b3dc592198c7497">linear_interpolate</a>(<a class="code hl_variable" href="classCylinderAndInterfaceDomain.html#a1f1363c5343672e04be3b9f3285b0a25">Lower_centre_right</a>,<a class="code hl_variable" href="classCylinderAndInterfaceDomain.html#a390ef76333ff22e7331b37ac7d5412bb">Lower_mid_right</a>,<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">s</a>[0],<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">f</a>);</div>
<div class="line">      <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">     <span class="keywordflow">case</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">W</a>:</div>
<div class="line">      <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">xi</a>[0] = -<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">atan</a>(1.0) + 2.0*<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">atan</a>(1.0)*0.5*(1.0+<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">s</a>[0]);</div>
<div class="line">      <a class="code hl_variable" href="classCylinderAndInterfaceDomain.html#aa0afda5d24ea33ff58957731e5b7dfd7">Cylinder_pt</a>-&gt;position(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">xi</a>,<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">f</a>);</div>
<div class="line">      <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">     <span class="keywordflow">case</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">E</a>:</div>
<div class="line">       <a class="code hl_function" href="classCylinderAndInterfaceDomain.html#acab40651417c703e6b3dc592198c7497">linear_interpolate</a>(<a class="code hl_variable" href="classCylinderAndInterfaceDomain.html#a390ef76333ff22e7331b37ac7d5412bb">Lower_mid_right</a>,<a class="code hl_variable" href="classCylinderAndInterfaceDomain.html#afb8019b28889f581f79541d571fb6386">Upper_mid_right</a>,<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">s</a>[0],<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">f</a>);</div>
<div class="line">      <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">     <span class="keywordflow">default</span>:</div>
<div class="line">      <a class="code hl_function" href="classRefineableCylinderAndInterfaceMesh.html#a2f42954cee8f7ba47d87f842dbdc4cc2">std::ostringstream</a> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">error_stream</a>;</div>
<div class="line">      <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">error_stream</a> &lt;&lt; <span class="stringliteral">&quot;Direction is incorrect: &quot;</span> &lt;&lt; <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">direction</a> &lt;&lt; <a class="code hl_function" href="classRefineableCylinderAndInterfaceMesh.html#a2f42954cee8f7ba47d87f842dbdc4cc2">std::endl</a>;</div>
<div class="line"> </div>
<div class="line">      <span class="keywordflow">throw</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">OomphLibError</a>(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">error_stream</a>.str(),</div>
<div class="line">                          <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line">                          <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line">     }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">break</span>;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">//Macro element 4, is immediately below cylinder</span></div>
<div class="line">   <span class="keywordflow">case</span> 4:</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">switch</span>(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">direction</a>)</div>
<div class="line">     {</div>
<div class="line">     <span class="keywordflow">case</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">N</a>:</div>
<div class="line">      <span class="comment">//linear_interpolate(Lower_centre_left,Lower_centre_right,s[0],f);</span></div>
<div class="line">      <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">xi</a>[0] = -3.0*<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">atan</a>(1.0) + 2.0*<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">atan</a>(1.0)*0.5*(1.0+<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">s</a>[0]);</div>
<div class="line">      <a class="code hl_variable" href="classCylinderAndInterfaceDomain.html#aa0afda5d24ea33ff58957731e5b7dfd7">Cylinder_pt</a>-&gt;position(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">xi</a>,<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">f</a>);</div>
<div class="line">      <span class="keywordflow">break</span>;</div>
<div class="line">      </div>
<div class="line">     <span class="keywordflow">case</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">S</a>:  </div>
<div class="line">       <a class="code hl_function" href="classCylinderAndInterfaceDomain.html#acab40651417c703e6b3dc592198c7497">linear_interpolate</a>(<a class="code hl_variable" href="classCylinderAndInterfaceDomain.html#a5285785212f1cbcfb3910e87421d831c">Lower_mid_left</a>,<a class="code hl_variable" href="classCylinderAndInterfaceDomain.html#a390ef76333ff22e7331b37ac7d5412bb">Lower_mid_right</a>,<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">s</a>[0],<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">f</a>);</div>
<div class="line">      <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">     <span class="keywordflow">case</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">W</a>:</div>
<div class="line">       <a class="code hl_function" href="classCylinderAndInterfaceDomain.html#acab40651417c703e6b3dc592198c7497">linear_interpolate</a>(<a class="code hl_variable" href="classCylinderAndInterfaceDomain.html#a5285785212f1cbcfb3910e87421d831c">Lower_mid_left</a>,<a class="code hl_variable" href="classCylinderAndInterfaceDomain.html#a389bb3200199cf6098461f884e1b4d09">Lower_centre_left</a>,<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">s</a>[0],<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">f</a>);</div>
<div class="line">      <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">     <span class="keywordflow">case</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">E</a>:</div>
<div class="line">       <a class="code hl_function" href="classCylinderAndInterfaceDomain.html#acab40651417c703e6b3dc592198c7497">linear_interpolate</a>(<a class="code hl_variable" href="classCylinderAndInterfaceDomain.html#a390ef76333ff22e7331b37ac7d5412bb">Lower_mid_right</a>,<a class="code hl_variable" href="classCylinderAndInterfaceDomain.html#a1f1363c5343672e04be3b9f3285b0a25">Lower_centre_right</a>,<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">s</a>[0],<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">f</a>);</div>
<div class="line">      <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">     <span class="keywordflow">default</span>:</div>
<div class="line">      <a class="code hl_function" href="classRefineableCylinderAndInterfaceMesh.html#a2f42954cee8f7ba47d87f842dbdc4cc2">std::ostringstream</a> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">error_stream</a>;</div>
<div class="line">      <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">error_stream</a> &lt;&lt; <span class="stringliteral">&quot;Direction is incorrect: &quot;</span> &lt;&lt; <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">direction</a> &lt;&lt; <a class="code hl_function" href="classRefineableCylinderAndInterfaceMesh.html#a2f42954cee8f7ba47d87f842dbdc4cc2">std::endl</a>;</div>
<div class="line"> </div>
<div class="line">      <span class="keywordflow">throw</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">OomphLibError</a>(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">error_stream</a>.str(),</div>
<div class="line">                          <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line">                          <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line">     }  </div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">//Macro element 5, is right film</span></div>
<div class="line">   <span class="keywordflow">case</span> 5:</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">switch</span>(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">direction</a>)</div>
<div class="line">     {</div>
<div class="line">     <span class="keywordflow">case</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">N</a>:</div>
<div class="line">       <a class="code hl_function" href="classCylinderAndInterfaceDomain.html#acab40651417c703e6b3dc592198c7497">linear_interpolate</a>(<a class="code hl_variable" href="classCylinderAndInterfaceDomain.html#afb8019b28889f581f79541d571fb6386">Upper_mid_right</a>,<a class="code hl_variable" href="classCylinderAndInterfaceDomain.html#a87b1a618cc0116816b5460f00f3875a6">Upper_right</a>,<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">s</a>[0],<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">f</a>);</div>
<div class="line">      <span class="keywordflow">break</span>;</div>
<div class="line">      </div>
<div class="line">     <span class="keywordflow">case</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">S</a>:  </div>
<div class="line">       <a class="code hl_function" href="classCylinderAndInterfaceDomain.html#acab40651417c703e6b3dc592198c7497">linear_interpolate</a>(<a class="code hl_variable" href="classCylinderAndInterfaceDomain.html#a390ef76333ff22e7331b37ac7d5412bb">Lower_mid_right</a>,<a class="code hl_variable" href="classCylinderAndInterfaceDomain.html#a04206f6c72189356d5eecf32b81595f4">Lower_right</a>,<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">s</a>[0],<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">f</a>);</div>
<div class="line">      <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">     <span class="keywordflow">case</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">W</a>:</div>
<div class="line">       <a class="code hl_function" href="classCylinderAndInterfaceDomain.html#acab40651417c703e6b3dc592198c7497">linear_interpolate</a>(<a class="code hl_variable" href="classCylinderAndInterfaceDomain.html#a390ef76333ff22e7331b37ac7d5412bb">Lower_mid_right</a>,<a class="code hl_variable" href="classCylinderAndInterfaceDomain.html#afb8019b28889f581f79541d571fb6386">Upper_mid_right</a>,<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">s</a>[0],<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">f</a>);</div>
<div class="line">      <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">     <span class="keywordflow">case</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">E</a>:</div>
<div class="line">       <a class="code hl_function" href="classCylinderAndInterfaceDomain.html#acab40651417c703e6b3dc592198c7497">linear_interpolate</a>(<a class="code hl_variable" href="classCylinderAndInterfaceDomain.html#a04206f6c72189356d5eecf32b81595f4">Lower_right</a>,<a class="code hl_variable" href="classCylinderAndInterfaceDomain.html#a87b1a618cc0116816b5460f00f3875a6">Upper_right</a>,<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">s</a>[0],<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">f</a>);</div>
<div class="line">      <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">     <span class="keywordflow">default</span>:</div>
<div class="line">      <a class="code hl_function" href="classRefineableCylinderAndInterfaceMesh.html#a2f42954cee8f7ba47d87f842dbdc4cc2">std::ostringstream</a> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">error_stream</a>;</div>
<div class="line">      <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">error_stream</a> &lt;&lt; <span class="stringliteral">&quot;Direction is incorrect: &quot;</span> &lt;&lt; <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">direction</a> &lt;&lt; <a class="code hl_function" href="classRefineableCylinderAndInterfaceMesh.html#a2f42954cee8f7ba47d87f842dbdc4cc2">std::endl</a>;</div>
<div class="line"> </div>
<div class="line">      <span class="keywordflow">throw</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">OomphLibError</a>(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">error_stream</a>.str(),</div>
<div class="line">                          <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line">                          <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line">     }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">break</span>;</div>
<div class="line">    </div>
<div class="line">   <span class="keywordflow">default</span>:</div>
<div class="line">    <a class="code hl_function" href="classRefineableCylinderAndInterfaceMesh.html#a2f42954cee8f7ba47d87f842dbdc4cc2">std::ostringstream</a> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">error_stream</a>;</div>
<div class="line">      <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">error_stream</a> &lt;&lt; <span class="stringliteral">&quot;Wrong domain number: &quot;</span> &lt;&lt; <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">m</a>&lt;&lt; <a class="code hl_function" href="classRefineableCylinderAndInterfaceMesh.html#a2f42954cee8f7ba47d87f842dbdc4cc2">std::endl</a>;</div>
<div class="line"> </div>
<div class="line">      <span class="keywordflow">throw</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">OomphLibError</a>(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">error_stream</a>.str(),</div>
<div class="line">                          <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line">                          <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line">   }</div>
<div class="line"> </div>
<div class="line"> }</div>
<div class="line"> </div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="comment">//Now I need to actually create a Mesh</span></div>
<div class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> ELEMENT&gt;</div>
<div class="line"><span class="keyword">class </span><a class="code hl_class" href="classCylinderAndInterfaceMesh.html">CylinderAndInterfaceMesh</a> : <span class="keyword">public</span> <span class="keyword">virtual</span> SolidMesh</div>
<div class="line">{</div>
<div class="line"> <span class="keywordtype">double</span> <a class="code hl_variable" href="classCylinderAndInterfaceMesh.html#a5ad81e65a9e9fb4c709a0c84f38216b1">Height</a>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">protected</span>:</div>
<div class="line"> <span class="comment">//Pointer to the domain</span></div>
<div class="line"> <a class="code hl_class" href="classCylinderAndInterfaceDomain.html">CylinderAndInterfaceDomain</a>* <a class="code hl_variable" href="classCylinderAndInterfaceMesh.html#aa7b43c0cab4ffc92bb47813a8e255374">Domain_pt</a>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line"> </div>
<div class="line"> <span class="comment">//Access function to the domain</span></div>
<div class="line"> <a class="code hl_class" href="classCylinderAndInterfaceDomain.html">CylinderAndInterfaceDomain</a>* <a class="code hl_function" href="classCylinderAndInterfaceMesh.html#aff1ea3970c93a046d9c02a47eeeca639">domain_pt</a>() {<span class="keywordflow">return</span> <a class="code hl_variable" href="classCylinderAndInterfaceMesh.html#aa7b43c0cab4ffc92bb47813a8e255374">Domain_pt</a>;}</div>
<div class="line"> </div>
<div class="line"> <span class="comment">//Constructor, </span></div>
<div class="line"> <a class="code hl_class" href="classCylinderAndInterfaceMesh.html">CylinderAndInterfaceMesh</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> &amp;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">length</a>, <span class="keyword">const</span> <span class="keywordtype">double</span> &amp;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">height</a>,</div>
<div class="line">                            <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">TimeStepper</a>* <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">time_stepper_pt</a>) : <a class="code hl_variable" href="classCylinderAndInterfaceMesh.html#a5ad81e65a9e9fb4c709a0c84f38216b1">Height</a>(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">height</a>)</div>
<div class="line">  {</div>
<div class="line">   <span class="comment">//Create the domain</span></div>
<div class="line">   <a class="code hl_variable" href="classCylinderAndInterfaceMesh.html#aa7b43c0cab4ffc92bb47813a8e255374">Domain_pt</a> = <span class="keyword">new</span> <a class="code hl_class" href="classCylinderAndInterfaceDomain.html">CylinderAndInterfaceDomain</a>(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">length</a>,<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">height</a>);</div>
<div class="line"> </div>
<div class="line">   <span class="comment">//Initialise the node counter</span></div>
<div class="line">   <span class="keywordtype">unsigned</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">node_count</a>=0;</div>
<div class="line">   <span class="comment">//Vectors Used to get data from domains</span></div>
<div class="line">   <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Vector&lt;double&gt;</a> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">s</a>(2), <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">r</a>(2);</div>
<div class="line">   </div>
<div class="line">   <span class="comment">//Setup temporary storage for the Node</span></div>
<div class="line">   <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Vector&lt;Node *&gt;</a> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Tmp_node_pt</a>;</div>
<div class="line"> </div>
<div class="line">   <span class="comment">//Now blindly loop over the macro elements and associate and finite</span></div>
<div class="line">   <span class="comment">//element with each</span></div>
<div class="line">   <span class="keywordtype">unsigned</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Nmacro_element</a> = <a class="code hl_variable" href="classCylinderAndInterfaceMesh.html#aa7b43c0cab4ffc92bb47813a8e255374">Domain_pt</a>-&gt;nmacro_element();</div>
<div class="line">   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">e</a>=0;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">e</a>&lt;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Nmacro_element</a>;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">e</a>++)</div>
<div class="line">    {</div>
<div class="line">     <span class="comment">//Create the FiniteElement and add to the Element_pt Vector</span></div>
<div class="line">     <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Element_pt</a>.push_back(<span class="keyword">new</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">ELEMENT</a>);</div>
<div class="line"> </div>
<div class="line">     <span class="comment">//Read out the number of linear points in the element</span></div>
<div class="line">     <span class="keywordtype">unsigned</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Np</a> = </div>
<div class="line">      <span class="keyword">dynamic_cast&lt;</span><a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">ELEMENT</a>*<span class="keyword">&gt;</span>(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">finite_element_pt</a>(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">e</a>))-&gt;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">nnode_1d</a>();</div>
<div class="line">     </div>
<div class="line">     <span class="comment">//Loop over nodes in the column</span></div>
<div class="line">     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">l1</a>=0;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">l1</a>&lt;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Np</a>;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">l1</a>++)</div>
<div class="line">      {</div>
<div class="line">       <span class="comment">//Loop over the nodes in the row</span></div>
<div class="line">       <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">l2</a>=0;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">l2</a>&lt;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Np</a>;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">l2</a>++)</div>
<div class="line">        {</div>
<div class="line">         <span class="comment">//Allocate the memory for the node</span></div>
<div class="line">         <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Tmp_node_pt</a>.push_back(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">finite_element_pt</a>(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">e</a>)-&gt;</div>
<div class="line">                           <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">construct_node</a>(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">l1</a>*<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Np</a>+<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">l2</a>,<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">time_stepper_pt</a>));</div>
<div class="line">         </div>
<div class="line">         <span class="comment">//Read out the position of the node from the macro element</span></div>
<div class="line">         <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">s</a>[0] = -1.0 + 2.0*(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">double</a>)<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">l2</a>/(<span class="keywordtype">double</span>)(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Np</a>-1);</div>
<div class="line">         <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">s</a>[1] = -1.0 + 2.0*(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">double</a>)<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">l1</a>/(<span class="keywordtype">double</span>)(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Np</a>-1);</div>
<div class="line">         <a class="code hl_variable" href="classCylinderAndInterfaceMesh.html#aa7b43c0cab4ffc92bb47813a8e255374">Domain_pt</a>-&gt;macro_element_pt(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">e</a>)-&gt;macro_map(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">s</a>,<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">r</a>);</div>
<div class="line">         </div>
<div class="line">         <span class="comment">//Set the position of the node</span></div>
<div class="line">         <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Tmp_node_pt</a>[<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">node_count</a>]-&gt;x(0) = <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">r</a>[0];</div>
<div class="line">         <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Tmp_node_pt</a>[<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">node_count</a>]-&gt;x(1) = <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">r</a>[1];</div>
<div class="line">         </div>
<div class="line">         <span class="comment">//Increment the node number</span></div>
<div class="line">         <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">node_count</a>++;</div>
<div class="line">        }</div>
<div class="line">      }</div>
<div class="line">    } <span class="comment">//End of loop over macro elements</span></div>
<div class="line"> </div>
<div class="line">   <span class="comment">//Now the elements have been created, but there will be nodes in </span></div>
<div class="line">   <span class="comment">//common, need to loop over the common edges and sort it, by reassigning</span></div>
<div class="line">   <span class="comment">//pointers and the deleting excess nodes</span></div>
<div class="line">   </div>
<div class="line">   <span class="comment">//Read out the number of linear points in the element</span></div>
<div class="line">   <span class="keywordtype">unsigned</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Np</a> = </div>
<div class="line">    <span class="keyword">dynamic_cast&lt;</span><a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">ELEMENT</a>*<span class="keyword">&gt;</span>(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">finite_element_pt</a>(0))-&gt;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">nnode_1d</a>();</div>
<div class="line"> </div>
<div class="line">   <span class="comment">//DelaunayEdge between Elements 0 and 1</span></div>
<div class="line">   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">n</a>=0;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">n</a>&lt;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Np</a>;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">n</a>++)</div>
<div class="line">    {</div>
<div class="line">     <span class="comment">//Set the nodes in element 1 to be the same as in element 0</span></div>
<div class="line">     <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">finite_element_pt</a>(1)-&gt;node_pt(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Np</a>*<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">n</a>)</div>
<div class="line">      = <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">finite_element_pt</a>(0)-&gt;node_pt(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">n</a>*<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Np</a>+<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Np</a>-1);</div>
<div class="line"> </div>
<div class="line">     <span class="comment">//Remove the nodes in element 1 from the temporaray node list</span></div>
<div class="line">     <span class="keyword">delete</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Tmp_node_pt</a>[<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Np</a>*<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Np</a> + <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Np</a>*<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">n</a>];</div>
<div class="line">     <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Tmp_node_pt</a>[<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Np</a>*<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Np</a> + <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Np</a>*<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">n</a>] = 0;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">   <span class="comment">//DelaunayEdge between Elements 1 and 2</span></div>
<div class="line">   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">n</a>=0;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">n</a>&lt;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Np</a>;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">n</a>++)</div>
<div class="line">    {</div>
<div class="line">     <span class="comment">//Set the nodes in element 2 to be the same as in element 1</span></div>
<div class="line">     <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">finite_element_pt</a>(2)-&gt;node_pt(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">n</a>*<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Np</a>)</div>
<div class="line">      = <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">finite_element_pt</a>(1)-&gt;node_pt((<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Np</a>-1)*<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Np</a>+<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Np</a>-1-<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">n</a>);</div>
<div class="line"> </div>
<div class="line">     <span class="comment">//Remove the nodes in element 2 from the temporaray node list</span></div>
<div class="line">     <span class="keyword">delete</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Tmp_node_pt</a>[2*<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Np</a>*<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Np</a> + <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">n</a>*<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Np</a>];</div>
<div class="line">     <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Tmp_node_pt</a>[2*<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Np</a>*<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Np</a> + <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">n</a>*<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Np</a>] = 0;</div>
<div class="line">    }</div>
<div class="line">   </div>
<div class="line">   <span class="comment">//DelaunayEdge between Elements 1 and 4</span></div>
<div class="line">   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">n</a>=0;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">n</a>&lt;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Np</a>;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">n</a>++)</div>
<div class="line">    {</div>
<div class="line">     <span class="comment">//Set the nodes in element 4 to be the same as in element 1</span></div>
<div class="line">     <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">finite_element_pt</a>(4)-&gt;node_pt(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">n</a>*<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Np</a>)</div>
<div class="line">      = <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">finite_element_pt</a>(1)-&gt;node_pt(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">n</a>);</div>
<div class="line"> </div>
<div class="line">     <span class="comment">//Remove the nodes in element 2 from the temporaray node list</span></div>
<div class="line">     <span class="keyword">delete</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Tmp_node_pt</a>[4*<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Np</a>*<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Np</a> + <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">n</a>*<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Np</a>];</div>
<div class="line">     <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Tmp_node_pt</a>[4*<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Np</a>*<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Np</a> + <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">n</a>*<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Np</a>] = 0;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">   <span class="comment">//DelaunayEdge between Element 2 and 3</span></div>
<div class="line">   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">n</a>=0;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">n</a>&lt;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Np</a>;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">n</a>++)</div>
<div class="line">    {</div>
<div class="line">     <span class="comment">//Set the nodes in element 3 to be the same as in element 2</span></div>
<div class="line">     <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">finite_element_pt</a>(3)-&gt;node_pt(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Np</a>*(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Np</a>-1)+<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">n</a>)</div>
<div class="line">      = <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">finite_element_pt</a>(2)-&gt;node_pt(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Np</a>*<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">n</a>+<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Np</a>-1);</div>
<div class="line"> </div>
<div class="line">     <span class="comment">//Remove the nodes in element 3 from the temporaray node list</span></div>
<div class="line">     <span class="keyword">delete</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Tmp_node_pt</a>[3*<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Np</a>*<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Np</a> + <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Np</a>*(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Np</a>-1)+<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">n</a>];</div>
<div class="line">     <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Tmp_node_pt</a>[3*<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Np</a>*<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Np</a> + <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Np</a>*(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Np</a>-1)+<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">n</a>] = 0;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">   <span class="comment">//DelaunayEdge between Element 4 and 3</span></div>
<div class="line">   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">n</a>=0;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">n</a>&lt;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Np</a>;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">n</a>++)</div>
<div class="line">    {</div>
<div class="line">     <span class="comment">//Set the nodes in element 3 to be the same as in element 4</span></div>
<div class="line">     <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">finite_element_pt</a>(3)-&gt;node_pt(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">n</a>)</div>
<div class="line">      = <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">finite_element_pt</a>(4)-&gt;node_pt(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Np</a>*(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Np</a>-<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">n</a>-1)+<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Np</a>-1);</div>
<div class="line"> </div>
<div class="line">     <span class="comment">//Remove the nodes in element 3 from the temporaray node list</span></div>
<div class="line">     <span class="keyword">delete</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Tmp_node_pt</a>[3*<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Np</a>*<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Np</a> + <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">n</a>];</div>
<div class="line">     <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Tmp_node_pt</a>[3*<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Np</a>*<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Np</a> + <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">n</a>] = 0;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">   <span class="comment">//DelaunayEdge between Element 3 and 5</span></div>
<div class="line">   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">n</a>=0;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">n</a>&lt;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Np</a>;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">n</a>++)</div>
<div class="line">    {</div>
<div class="line">     <span class="comment">//Set the nodes in element 5 to be the same as in element 3</span></div>
<div class="line">     <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">finite_element_pt</a>(5)-&gt;node_pt(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">n</a>*<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Np</a>)</div>
<div class="line">      = <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">finite_element_pt</a>(3)-&gt;node_pt(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Np</a>*<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">n</a>+<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Np</a>-1);</div>
<div class="line"> </div>
<div class="line">     <span class="comment">//Remove the nodes in element 5 from the temporaray node list</span></div>
<div class="line">     <span class="keyword">delete</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Tmp_node_pt</a>[5*<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Np</a>*<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Np</a> + <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">n</a>*<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Np</a>];</div>
<div class="line">     <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Tmp_node_pt</a>[5*<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Np</a>*<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Np</a> + <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">n</a>*<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Np</a>] = 0;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">   <span class="comment">//Now set the actual true nodes</span></div>
<div class="line">   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">n</a>=0;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">n</a>&lt;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">node_count</a>;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">n</a>++)</div>
<div class="line">    {</div>
<div class="line">     <span class="keywordflow">if</span>(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Tmp_node_pt</a>[<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">n</a>]!=0) {<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Node_pt</a>.push_back(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Tmp_node_pt</a>[<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">n</a>]);}</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">   <span class="comment">//Finally set the nodes on the boundaries</span></div>
<div class="line">   <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">set_nboundary</a>(5);</div>
<div class="line">   </div>
<div class="line">   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">n</a>=0;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">n</a>&lt;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Np</a>;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">n</a>++)</div>
<div class="line">    {</div>
<div class="line">     <span class="comment">//Left hand side</span></div>
<div class="line">     <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Node</a>* <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">temp_node_pt</a> = <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">finite_element_pt</a>(0)-&gt;node_pt(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">n</a>*<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Np</a>);</div>
<div class="line">     this-&gt;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">convert_to_boundary_node</a>(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">temp_node_pt</a>);</div>
<div class="line">     <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">add_boundary_node</a>(3,<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">temp_node_pt</a>);</div>
<div class="line">     </div>
<div class="line"> </div>
<div class="line">     <span class="comment">//Right hand side</span></div>
<div class="line">     <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">temp_node_pt</a> = <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">finite_element_pt</a>(5)-&gt;node_pt(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">n</a>*<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Np</a>+<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Np</a>-1);</div>
<div class="line">     this-&gt;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">convert_to_boundary_node</a>(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">temp_node_pt</a>);</div>
<div class="line">     <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">add_boundary_node</a>(1,<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">temp_node_pt</a>);</div>
<div class="line">     </div>
<div class="line">     <span class="comment">//LH part of lower boundary</span></div>
<div class="line">     <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">temp_node_pt</a> = <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">finite_element_pt</a>(0)-&gt;node_pt(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">n</a>);</div>
<div class="line">     this-&gt;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">convert_to_boundary_node</a>(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">temp_node_pt</a>);</div>
<div class="line">     <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">add_boundary_node</a>(0,<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">temp_node_pt</a>);</div>
<div class="line"> </div>
<div class="line">     <span class="comment">//First part of upper boundary</span></div>
<div class="line">     <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">temp_node_pt</a> = <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">finite_element_pt</a>(0)-&gt;node_pt(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Np</a>*(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Np</a>-1)+<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">n</a>);</div>
<div class="line">     this-&gt;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">convert_to_boundary_node</a>(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">temp_node_pt</a>);</div>
<div class="line">     <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">add_boundary_node</a>(2,<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">temp_node_pt</a>);</div>
<div class="line">     </div>
<div class="line">     <span class="comment">//First part of hole boundary</span></div>
<div class="line">     <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">temp_node_pt</a> = <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">finite_element_pt</a>(4)-&gt;node_pt(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Np</a>*(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Np</a>-1)+<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">n</a>);</div>
<div class="line">     this-&gt;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">convert_to_boundary_node</a>(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">temp_node_pt</a>);</div>
<div class="line">     <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">add_boundary_node</a>(4,<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">temp_node_pt</a>);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">n</a>=1;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">n</a>&lt;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Np</a>;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">n</a>++)</div>
<div class="line">    {</div>
<div class="line">     <span class="comment">//Middle of lower boundary</span></div>
<div class="line">     <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Node</a>* <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">temp_node_pt</a> = <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">finite_element_pt</a>(4)-&gt;node_pt(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">n</a>);</div>
<div class="line">     this-&gt;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">convert_to_boundary_node</a>(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">temp_node_pt</a>);</div>
<div class="line">     <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">add_boundary_node</a>(0,<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">temp_node_pt</a>);</div>
<div class="line">     </div>
<div class="line">     <span class="comment">//Middle of upper boundary                                </span></div>
<div class="line">     <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">temp_node_pt</a> = <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">finite_element_pt</a>(2)-&gt;node_pt(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Np</a>*(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Np</a>-1)+<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">n</a>);</div>
<div class="line">     this-&gt;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">convert_to_boundary_node</a>(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">temp_node_pt</a>);</div>
<div class="line">     <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">add_boundary_node</a>(2,<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">temp_node_pt</a>);</div>
<div class="line"> </div>
<div class="line">     <span class="comment">//Next part of hole</span></div>
<div class="line">     <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">temp_node_pt</a> = <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">finite_element_pt</a>(3)-&gt;node_pt(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">n</a>*<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Np</a>);</div>
<div class="line">     this-&gt;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">convert_to_boundary_node</a>(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">temp_node_pt</a>);</div>
<div class="line">     <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">add_boundary_node</a>(4,<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">temp_node_pt</a>);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">n</a>=1;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">n</a>&lt;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Np</a>;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">n</a>++)</div>
<div class="line">    {</div>
<div class="line">     <span class="comment">//Final part of lower boundary</span></div>
<div class="line">     <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Node</a>* <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">temp_node_pt</a> = <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">finite_element_pt</a>(5)-&gt;node_pt(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">n</a>);</div>
<div class="line">     this-&gt;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">convert_to_boundary_node</a>(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">temp_node_pt</a>);</div>
<div class="line">     <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">add_boundary_node</a>(0,<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">temp_node_pt</a>);</div>
<div class="line">     </div>
<div class="line">     <span class="comment">//Middle of upper boundary                                </span></div>
<div class="line">     <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">temp_node_pt</a> = <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">finite_element_pt</a>(5)-&gt;node_pt(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Np</a>*(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Np</a>-1)+<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">n</a>);</div>
<div class="line">     this-&gt;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">convert_to_boundary_node</a>(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">temp_node_pt</a>);</div>
<div class="line">     <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">add_boundary_node</a>(2,<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">temp_node_pt</a>);</div>
<div class="line">     </div>
<div class="line">     <span class="comment">//Next part of hole</span></div>
<div class="line">     <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">temp_node_pt</a> = <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">finite_element_pt</a>(2)-&gt;node_pt(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Np</a>-<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">n</a>-1);</div>
<div class="line">     this-&gt;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">convert_to_boundary_node</a>(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">temp_node_pt</a>);</div>
<div class="line">     <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">add_boundary_node</a>(4,<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">temp_node_pt</a>);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">n</a>=1;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">n</a>&lt;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Np</a>-1;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">n</a>++)</div>
<div class="line">    {</div>
<div class="line">     <span class="comment">//Final part of hole</span></div>
<div class="line">     <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Node</a>* <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">temp_node_pt</a> = <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">finite_element_pt</a>(1)-&gt;node_pt(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Np</a>*(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Np</a>-<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">n</a>-1)+<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Np</a>-1);</div>
<div class="line">     this-&gt;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">convert_to_boundary_node</a>(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">temp_node_pt</a>);</div>
<div class="line">     <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">add_boundary_node</a>(4,<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">temp_node_pt</a>);</div>
<div class="line">    }</div>
<div class="line">   </div>
<div class="line">   <span class="comment">//Now loop over all the nodes and set their Lagrangian coordinates</span></div>
<div class="line">   <span class="keywordtype">unsigned</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Nnode</a> = <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">nnode</a>();</div>
<div class="line">   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">n</a>=0;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">n</a>&lt;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Nnode</a>;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">n</a>++)</div>
<div class="line">   {</div>
<div class="line">    <span class="comment">//Cast node to an elastic node</span></div>
<div class="line">    <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">SolidNode</a>* <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">temp_pt</a> = <span class="keyword">static_cast&lt;</span><a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">SolidNode</a>*<span class="keyword">&gt;</span>(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Node_pt</a>[<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">n</a>]);</div>
<div class="line">    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">i</a>=0;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">i</a>&lt;2;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">i</a>++)</div>
<div class="line">     {<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">temp_pt</a>-&gt;xi(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">i</a>) = <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">temp_pt</a>-&gt;x(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">i</a>);}</div>
<div class="line">   }</div>
<div class="line"> }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="comment">//Now let&#39;s do the adaptive mesh</span></div>
<div class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> ELEMENT&gt;</div>
<div class="line"><span class="keyword">class </span><a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">RefineableCylinderAndInterfaceMesh</a> :</div>
<div class="line"> <span class="keyword">public</span> <a class="code hl_class" href="classCylinderAndInterfaceMesh.html">CylinderAndInterfaceMesh</a>&lt;ELEMENT&gt;, <span class="keyword">public</span> RefineableQuadMesh&lt;ELEMENT&gt;</div>
<div class="line">{</div>
<div class="line"><span class="keyword">public</span>: </div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Constructor</span></div>
<div class="line"> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">RefineableCylinderAndInterfaceMesh</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> &amp;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">length</a>, <span class="keyword">const</span> <span class="keywordtype">double</span> &amp;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">height</a>,</div>
<div class="line">                                    <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">TimeStepper</a>* <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">time_stepper_pt</a>) :</div>
<div class="line">  <a class="code hl_class" href="classCylinderAndInterfaceMesh.html">CylinderAndInterfaceMesh</a>&lt;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">ELEMENT</a>&gt;(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">length</a>,<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">height</a>,<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">time_stepper_pt</a>) </div>
<div class="line">  {</div>
<div class="line"> </div>
<div class="line">   <span class="comment">// Nodal positions etc. were created in constructor for</span></div>
<div class="line">   <span class="comment">// Cylinder...&lt;...&gt;. Need to setup adaptive information.</span></div>
<div class="line"> </div>
<div class="line">   <span class="comment">// Loop over all elements and set macro element pointer</span></div>
<div class="line">   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">e</a>=0;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">e</a>&lt;6;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">e</a>++)</div>
<div class="line">    {</div>
<div class="line">     <span class="keyword">dynamic_cast&lt;</span><a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">ELEMENT</a>*<span class="keyword">&gt;</span>(this-&gt;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">element_pt</a>(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">e</a>))-&gt;</div>
<div class="line">      <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">set_macro_elem_pt</a>(this-&gt;Domain_pt-&gt;macro_element_pt(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">e</a>));</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">   <span class="comment">// Setup quadtree forest for mesh refinement</span></div>
<div class="line">   this-&gt;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">setup_quadtree_forest</a>();</div>
<div class="line">   </div>
<div class="line">   <span class="comment">// Setup the boundary element info</span></div>
<div class="line">   this-&gt;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">setup_boundary_element_info</a>();</div>
<div class="line"> </div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> <span class="comment"></span></div>
<div class="line"><span class="comment"> /// Destructor: Empty</span></div>
<div class="line"><span class="comment"></span> <span class="keyword">virtual</span> <a class="code hl_function" href="classRefineableCylinderAndInterfaceMesh.html#ad661ea3bc9100aaac36bc10aab9b2648">~RefineableCylinderAndInterfaceMesh</a>() {}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> ELEMENT&gt;</div>
<div class="line"><span class="keyword">class </span><a class="code hl_class" href="classRefineableRotatingCylinderProblem.html">RefineableRotatingCylinderProblem</a> : <span class="keyword">public</span> Problem</div>
<div class="line">{</div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line"> <span class="keywordtype">double</span> <a class="code hl_variable" href="classRefineableRotatingCylinderProblem.html#acfa616d36346f557244146d4b2db9197">Length</a>, <a class="code hl_variable" href="classRefineableRotatingCylinderProblem.html#a3521efd0bfad036e20a6a8ba7e4547f4">Height</a>;</div>
<div class="line"> </div>
<div class="line"> <span class="comment">//Constitutive law used to determine the mesh deformation</span></div>
<div class="line"> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">ConstitutiveLaw</a> *<a class="code hl_variable" href="classRefineableRotatingCylinderProblem.html#a4e832fa2d6e1faafd39425d132d732e2">Constitutive_law_pt</a>;</div>
<div class="line"> </div>
<div class="line"> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Data</a>* <a class="code hl_variable" href="classRefineableRotatingCylinderProblem.html#a712d1cdcab28b62e1df830ffe1818009">Traded_pressure_data_pt</a>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line"> </div>
<div class="line"> <span class="keywordtype">double</span> <a class="code hl_variable" href="classRefineableRotatingCylinderProblem.html#a3a7fe3dd801eb1ef71dcf8e4c6a237ef">Re</a>, <a class="code hl_variable" href="classRefineableRotatingCylinderProblem.html#a2e47341fa1a71da29907ead94aeb5ec2">Ca</a>, <a class="code hl_variable" href="classRefineableRotatingCylinderProblem.html#acf70c93c4b4db46c1809f6b9f68214ee">ReInvFr</a>, <a class="code hl_variable" href="classRefineableRotatingCylinderProblem.html#a253a0d7954a3527bf1410f01080e5c70">Bo</a>;</div>
<div class="line"> </div>
<div class="line"> <span class="keywordtype">double</span> <a class="code hl_variable" href="classRefineableRotatingCylinderProblem.html#aaf1d39e57b4fc4d470b69f01121d93a3">Omega</a>;</div>
<div class="line"> </div>
<div class="line"> <span class="keywordtype">double</span> <a class="code hl_variable" href="classRefineableRotatingCylinderProblem.html#aa476013effb3f9a45cf1e1e2198aad14">Volume</a>;</div>
<div class="line"> </div>
<div class="line"> <span class="keywordtype">double</span> <a class="code hl_variable" href="classRefineableRotatingCylinderProblem.html#a54c8bf3a55597f50087c82ed5f955f5b">Angle</a>;</div>
<div class="line"> </div>
<div class="line"> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Vector&lt;double&gt;</a> <a class="code hl_variable" href="classRefineableRotatingCylinderProblem.html#a270f2243978a54c8d787cc912168bb90">G</a>;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Constructor: Pass flag to indicate if you want</span></div>
<div class="line"><span class="comment"> /// a constant source function or the tanh profile.</span></div>
<div class="line"><span class="comment"></span> <a class="code hl_class" href="classRefineableRotatingCylinderProblem.html">RefineableRotatingCylinderProblem</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> &amp;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">length</a>, <span class="keyword">const</span> <span class="keywordtype">double</span> &amp;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">height</a>);</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Update the problem specs after solve (empty)</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">void</span> <a class="code hl_function" href="classRefineableRotatingCylinderProblem.html#af559552a0c8cba56b883cd8b5b283b7f">actions_after_newton_solve</a>() {}</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Update the problem specs before solve: </span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">void</span> <a class="code hl_function" href="classRefineableRotatingCylinderProblem.html#a382bc388316b410c45f337558b5ad577">actions_before_newton_solve</a>() {<a class="code hl_function" href="classRefineableRotatingCylinderProblem.html#acd510f2c06fa3f38d2911781656dbf20">set_boundary_conditions</a>();}</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Strip off the interface before adaptation</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">void</span> <a class="code hl_function" href="classRefineableRotatingCylinderProblem.html#a705922ef2d96697ea5a110a412db5287">actions_before_adapt</a>() </div>
<div class="line">  {</div>
<div class="line">   this-&gt;<a class="code hl_function" href="classRefineableRotatingCylinderProblem.html#a37cc1af7c83c5c1b7ae57f7f434be2f1">delete_volume_constraint_elements</a>();</div>
<div class="line">   this-&gt;<a class="code hl_function" href="classRefineableRotatingCylinderProblem.html#ada026864153cf9954011bcea592cc5b7">delete_free_surface_elements</a>();</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> <span class="keywordtype">void</span> <a class="code hl_function" href="classRefineableRotatingCylinderProblem.html#af914476e487ad5ed623384adb7c68c66">actions_after_adapt</a>() {<a class="code hl_function" href="classRefineableRotatingCylinderProblem.html#a417d18c2584ed1ea38daefe5dd68b4a4">finish_problem_setup</a>(); this-&gt;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">rebuild_global_mesh</a>();}</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Complete problem setup: Setup element-specific things </span></div>
<div class="line"><span class="comment"> /// (source fct pointers etc.)</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">void</span> <a class="code hl_function" href="classRefineableRotatingCylinderProblem.html#a417d18c2584ed1ea38daefe5dd68b4a4">finish_problem_setup</a>();</div>
<div class="line"> </div>
<div class="line"> <span class="comment">//Access function for the mesh</span></div>
<div class="line"> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">RefineableCylinderAndInterfaceMesh&lt;ELEMENT&gt;</a>* <a class="code hl_variable" href="classRefineableRotatingCylinderProblem.html#aeb99a895bfdcceea6d13b41df7a59545">Bulk_mesh_pt</a>;</div>
<div class="line"> </div>
<div class="line"> <span class="comment">//Access function for surface mesh</span></div>
<div class="line"> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Mesh</a>* <a class="code hl_variable" href="classRefineableRotatingCylinderProblem.html#a48cc95921f8a03c220609d9666bcf406">Surface_mesh_pt</a>;</div>
<div class="line"> </div>
<div class="line"> <span class="comment">//Access function for point mesh</span></div>
<div class="line"> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Mesh</a>* <a class="code hl_variable" href="classRefineableRotatingCylinderProblem.html#af438026e310576c522706dbff92ee750">Point_mesh_pt</a>;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// The volume constraint mesh </span></div>
<div class="line"><span class="comment"></span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Mesh</a>* <a class="code hl_variable" href="classRefineableRotatingCylinderProblem.html#a3bb79346179cb5ef1dad280530ea24e8">Volume_constraint_mesh_pt</a>;</div>
<div class="line"> </div>
<div class="line"> <span class="keywordtype">void</span> <a class="code hl_function" href="classRefineableRotatingCylinderProblem.html#acd510f2c06fa3f38d2911781656dbf20">set_boundary_conditions</a>();</div>
<div class="line"> </div>
<div class="line"> <span class="keywordtype">void</span> <a class="code hl_function" href="classRefineableRotatingCylinderProblem.html#a664bfd373351a401619b06c3494fdcdc">solve</a>();</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Create the volume constraint elements</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">void</span> <a class="code hl_function" href="classRefineableRotatingCylinderProblem.html#a2de094b437cba9e9b71dca0afe587d65">create_volume_constraint_elements</a>()</div>
<div class="line">  {</div>
<div class="line">   <span class="comment">//The single volume constraint element</span></div>
<div class="line">   <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">VolumeConstraintElement</a>* <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">vol_constraint_element</a> = </div>
<div class="line">    <span class="keyword">new</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">VolumeConstraintElement</a>(&amp;<a class="code hl_variable" href="classRefineableRotatingCylinderProblem.html#aa476013effb3f9a45cf1e1e2198aad14">Volume</a>,<a class="code hl_variable" href="classRefineableRotatingCylinderProblem.html#a712d1cdcab28b62e1df830ffe1818009">Traded_pressure_data_pt</a>,0);</div>
<div class="line">   <a class="code hl_variable" href="classRefineableRotatingCylinderProblem.html#a3bb79346179cb5ef1dad280530ea24e8">Volume_constraint_mesh_pt</a>-&gt;add_element_pt(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">vol_constraint_element</a>);</div>
<div class="line">   </div>
<div class="line">   <span class="comment">//Loop over all boundaries (or just 1 and 2 why?)</span></div>
<div class="line">   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">b</a>=0;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">b</a>&lt;4;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">b</a>++)</div>
<div class="line">    {</div>
<div class="line">     <span class="comment">// How many bulk fluid elements are adjacent to boundary b?</span></div>
<div class="line">     <span class="keywordtype">unsigned</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">n_element</a> = <a class="code hl_variable" href="classRefineableRotatingCylinderProblem.html#aeb99a895bfdcceea6d13b41df7a59545">Bulk_mesh_pt</a>-&gt;nboundary_element(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">b</a>);</div>
<div class="line">     </div>
<div class="line">     <span class="comment">// Loop over the bulk fluid elements adjacent to boundary b?</span></div>
<div class="line">     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">e</a>=0;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">e</a>&lt;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">n_element</a>;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">e</a>++)</div>
<div class="line">      {</div>
<div class="line">       <span class="comment">// Get pointer to the bulk fluid element that is </span></div>
<div class="line">       <span class="comment">// adjacent to boundary b</span></div>
<div class="line">       <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">ELEMENT</a>* <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">bulk_elem_pt</a> = <span class="keyword">dynamic_cast&lt;</span><a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">ELEMENT</a>*<span class="keyword">&gt;</span>(</div>
<div class="line">        <a class="code hl_variable" href="classRefineableRotatingCylinderProblem.html#aeb99a895bfdcceea6d13b41df7a59545">Bulk_mesh_pt</a>-&gt;boundary_element_pt(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">b</a>,<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">e</a>));</div>
<div class="line">       </div>
<div class="line">       <span class="comment">//Find the index of the face of element e along boundary b</span></div>
<div class="line">       <span class="keywordtype">int</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">face_index</a> = <a class="code hl_variable" href="classRefineableRotatingCylinderProblem.html#aeb99a895bfdcceea6d13b41df7a59545">Bulk_mesh_pt</a>-&gt;face_index_at_boundary(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">b</a>,<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">e</a>);</div>
<div class="line">       </div>
<div class="line">       <span class="comment">// Create new element</span></div>
<div class="line">       <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">ElasticLineVolumeConstraintBoundingElement&lt;ELEMENT&gt;</a>* <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">el_pt</a> =</div>
<div class="line">        <span class="keyword">new</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">ElasticLineVolumeConstraintBoundingElement&lt;ELEMENT&gt;</a>(</div>
<div class="line">         <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">bulk_elem_pt</a>,<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">face_index</a>);   </div>
<div class="line">       </div>
<div class="line">       <span class="comment">//Set the &quot;master&quot; volume control element</span></div>
<div class="line">       <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">el_pt</a>-&gt;set_volume_constraint_element(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">vol_constraint_element</a>);</div>
<div class="line">       </div>
<div class="line">       <span class="comment">// Add it to the mesh</span></div>
<div class="line">       <a class="code hl_variable" href="classRefineableRotatingCylinderProblem.html#a3bb79346179cb5ef1dad280530ea24e8">Volume_constraint_mesh_pt</a>-&gt;add_element_pt(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">el_pt</a>);     </div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> <span class="keywordtype">void</span> <a class="code hl_function" href="classRefineableRotatingCylinderProblem.html#a37cc1af7c83c5c1b7ae57f7f434be2f1">delete_volume_constraint_elements</a>()</div>
<div class="line">  {</div>
<div class="line">   <span class="keywordtype">unsigned</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">n_element</a> = <a class="code hl_variable" href="classRefineableRotatingCylinderProblem.html#a3bb79346179cb5ef1dad280530ea24e8">Volume_constraint_mesh_pt</a>-&gt;nelement();</div>
<div class="line">   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">e</a>=0;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">e</a>&lt;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">n_element</a>;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">e</a>++)</div>
<div class="line">    {</div>
<div class="line">     <span class="keyword">delete</span> <a class="code hl_variable" href="classRefineableRotatingCylinderProblem.html#a3bb79346179cb5ef1dad280530ea24e8">Volume_constraint_mesh_pt</a>-&gt;element_pt(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">e</a>);</div>
<div class="line">    }</div>
<div class="line">   <a class="code hl_variable" href="classRefineableRotatingCylinderProblem.html#a3bb79346179cb5ef1dad280530ea24e8">Volume_constraint_mesh_pt</a>-&gt;flush_element_and_node_storage();</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> <span class="keywordtype">void</span> <a class="code hl_function" href="classRefineableRotatingCylinderProblem.html#a57623d36f2c97d300215c00ac917d449">create_free_surface_elements</a>()</div>
<div class="line">  {</div>
<div class="line">   <span class="comment">//Find number of elements adjacent to upper boundary</span></div>
<div class="line">   <span class="keywordtype">unsigned</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">n_boundary_element</a> = <a class="code hl_variable" href="classRefineableRotatingCylinderProblem.html#aeb99a895bfdcceea6d13b41df7a59545">Bulk_mesh_pt</a>-&gt;nboundary_element(2);</div>
<div class="line">   <span class="comment">//The boundary elements do no necessarily come in order, so we will</span></div>
<div class="line">   <span class="comment">//need to detect the element adjacent to boundary 1.</span></div>
<div class="line">   <span class="comment">//The index of that element in our array will be stored in this variable</span></div>
<div class="line">   <span class="comment">//(initialised to a negative and therefore invalid number)</span></div>
<div class="line">   <span class="keywordtype">int</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">final_element_index</a>=-1;</div>
<div class="line">   <span class="comment">//Loop over the elements adjacent to the boundary</span></div>
<div class="line">   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">e</a>=0;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">e</a>&lt;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">n_boundary_element</a>;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">e</a>++)</div>
<div class="line">    {</div>
<div class="line">     <span class="comment">//Create the free surface element (on face 2)</span></div>
<div class="line">     <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">FiniteElement</a> *<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">free_surface_element_pt</a> </div>
<div class="line">      = <span class="keyword">new</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">ElasticLineFluidInterfaceElement&lt;ELEMENT&gt;</a></div>
<div class="line">      (<a class="code hl_variable" href="classRefineableRotatingCylinderProblem.html#aeb99a895bfdcceea6d13b41df7a59545">Bulk_mesh_pt</a>-&gt;boundary_element_pt(2,<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">e</a>),</div>
<div class="line">       <a class="code hl_variable" href="classRefineableRotatingCylinderProblem.html#aeb99a895bfdcceea6d13b41df7a59545">Bulk_mesh_pt</a>-&gt;face_index_at_boundary(2,<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">e</a>));</div>
<div class="line">     <span class="comment">//Push it back onto the stack</span></div>
<div class="line">     <a class="code hl_variable" href="classRefineableRotatingCylinderProblem.html#a48cc95921f8a03c220609d9666bcf406">Surface_mesh_pt</a>-&gt;add_element_pt(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">free_surface_element_pt</a>);       </div>
<div class="line"> </div>
<div class="line">      <span class="comment">//Check whether the element is on the boundary 1</span></div>
<div class="line">      <span class="keywordtype">unsigned</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">n_node</a> = <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">free_surface_element_pt</a>-&gt;nnode();</div>
<div class="line">      <span class="comment">//Only need to check the end nodes</span></div>
<div class="line">      <span class="keywordflow">if</span>((<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">free_surface_element_pt</a>-&gt;node_pt(0)-&gt;is_on_boundary(1)) ||</div>
<div class="line">         (<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">free_surface_element_pt</a>-&gt;node_pt(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">n_node</a>-1)-&gt;is_on_boundary(1)))</div>
<div class="line">       {</div>
<div class="line">          <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">final_element_index</a>=<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">e</a>;</div>
<div class="line">       }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">   <span class="keywordtype">unsigned</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Nfree</a> = <a class="code hl_variable" href="classRefineableRotatingCylinderProblem.html#a48cc95921f8a03c220609d9666bcf406">Surface_mesh_pt</a>-&gt;nelement();</div>
<div class="line">   <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">oomph_info</a> &lt;&lt; <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Nfree</a> &lt;&lt; <span class="stringliteral">&quot; free surface elements assigned&quot;</span> &lt;&lt; <a class="code hl_function" href="classRefineableCylinderAndInterfaceMesh.html#a2f42954cee8f7ba47d87f842dbdc4cc2">std::endl</a>;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span>(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">final_element_index</a> == -1)</div>
<div class="line">     {</div>
<div class="line">      <span class="keywordflow">throw</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">OomphLibError</a>(<span class="stringliteral">&quot;No Surface Element adjacent to boundary 1\n&quot;</span>,</div>
<div class="line">                          <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line">                          <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line">     }</div>
<div class="line">   </div>
<div class="line">    <span class="comment">//Make the edge point</span></div>
<div class="line">    <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">FiniteElement</a>* <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">point_element_pt</a>= </div>
<div class="line">     <span class="keyword">dynamic_cast&lt;</span><a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">ElasticLineFluidInterfaceElement&lt;ELEMENT&gt;</a>*<span class="keyword">&gt;</span></div>
<div class="line">     (<a class="code hl_variable" href="classRefineableRotatingCylinderProblem.html#a48cc95921f8a03c220609d9666bcf406">Surface_mesh_pt</a>-&gt;element_pt(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">final_element_index</a>))</div>
<div class="line">     -&gt;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">make_bounding_element</a>(1);</div>
<div class="line">    </div>
<div class="line">    <span class="comment">//Add it to the stack</span></div>
<div class="line">    <a class="code hl_variable" href="classRefineableRotatingCylinderProblem.html#af438026e310576c522706dbff92ee750">Point_mesh_pt</a>-&gt;add_element_pt(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">point_element_pt</a>);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> <span class="comment">//Function to delete the free surface elements</span></div>
<div class="line"> <span class="keywordtype">void</span> <a class="code hl_function" href="classRefineableRotatingCylinderProblem.html#ada026864153cf9954011bcea592cc5b7">delete_free_surface_elements</a>()</div>
<div class="line">  {</div>
<div class="line">   <span class="comment">//Find the number of traction elements</span></div>
<div class="line">   <span class="keywordtype">unsigned</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Nfree_surface</a> = <a class="code hl_variable" href="classRefineableRotatingCylinderProblem.html#a48cc95921f8a03c220609d9666bcf406">Surface_mesh_pt</a>-&gt;nelement();</div>
<div class="line">   </div>
<div class="line">   <span class="comment">//The traction elements are ALWAYS? stored at the end</span></div>
<div class="line">   <span class="comment">//So delete and remove them, add one to get rid of the constraint</span></div>
<div class="line">   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">e</a>=0;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">e</a>&lt;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Nfree_surface</a>;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">e</a>++)</div>
<div class="line">    {</div>
<div class="line">     <span class="keyword">delete</span> <a class="code hl_variable" href="classRefineableRotatingCylinderProblem.html#a48cc95921f8a03c220609d9666bcf406">Surface_mesh_pt</a>-&gt;element_pt(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">e</a>);</div>
<div class="line">    }</div>
<div class="line">   <a class="code hl_variable" href="classRefineableRotatingCylinderProblem.html#a48cc95921f8a03c220609d9666bcf406">Surface_mesh_pt</a>-&gt;flush_element_and_node_storage();</div>
<div class="line"> </div>
<div class="line">   <span class="keyword">delete</span> <a class="code hl_variable" href="classRefineableRotatingCylinderProblem.html#af438026e310576c522706dbff92ee750">Point_mesh_pt</a>-&gt;element_pt(0);</div>
<div class="line">   <a class="code hl_variable" href="classRefineableRotatingCylinderProblem.html#af438026e310576c522706dbff92ee750">Point_mesh_pt</a>-&gt;flush_element_and_node_storage();</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment">//========================================================================</span><span class="comment"></span></div>
<div class="line"><span class="comment">/// Constructor for adaptive Poisson problem in deformable fish-shaped</span></div>
<div class="line"><span class="comment">/// domain. Pass bool to indicate if we want a constant source</span></div>
<div class="line"><span class="comment">/// function or the one that produces a tanh step.</span></div>
<div class="line"><span class="comment"></span><span class="comment">//========================================================================</span></div>
<div class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> ELEMENT&gt;</div>
<div class="line"><a class="code hl_function" href="classRefineableRotatingCylinderProblem.html#aa597c4240ce9affbd7540998167c8f21">RefineableRotatingCylinderProblem&lt;ELEMENT&gt;::RefineableRotatingCylinderProblem</a>(</div>
<div class="line"> <span class="keyword">const</span> <span class="keywordtype">double</span> &amp;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">length</a>, <span class="keyword">const</span> <span class="keywordtype">double</span> &amp;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">height</a>) : Length(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">length</a>), Height(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">height</a>),</div>
<div class="line">                                               Re(0.0), Ca(0.001), </div>
<div class="line">                                               ReInvFr(0.0),</div>
<div class="line">                                               Bo(0.0), Omega(1.0), </div>
<div class="line">                                               Volume(12.0),</div>
<div class="line">                                               Angle(1.57)</div>
<div class="line">{ </div>
<div class="line"> <a class="code hl_variable" href="namespaceGlobal__Physical__Variables.html#a5feb3df21fc4a0adefadecb8a8ed98d7">Global_Physical_Variables::Wall_normal</a>.resize(2);</div>
<div class="line"> <a class="code hl_variable" href="namespaceGlobal__Physical__Variables.html#a5feb3df21fc4a0adefadecb8a8ed98d7">Global_Physical_Variables::Wall_normal</a>[0] = 1.0; </div>
<div class="line"> <a class="code hl_variable" href="namespaceGlobal__Physical__Variables.html#a5feb3df21fc4a0adefadecb8a8ed98d7">Global_Physical_Variables::Wall_normal</a>[1] = 0.0;</div>
<div class="line"> </div>
<div class="line"> G.resize(2);</div>
<div class="line"> G[0] = 0.0; G[1] = -1.0;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Set the initial value of the ReInvFr = Bo/Ca</span></div>
<div class="line"><span class="comment"></span> ReInvFr = Bo/Ca;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Build a linear solver: Use HSL&#39;s MA42 frontal solver</span></div>
<div class="line"><span class="comment"></span> <span class="comment">//linear_solver_pt() = new HSL_MA42;</span></div>
<div class="line"> </div>
<div class="line"> <span class="comment">//Set the constituive law</span></div>
<div class="line"> Constitutive_law_pt = <span class="keyword">new</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">GeneralisedHookean</a>(&amp;<a class="code hl_variable" href="namespaceGlobal__Physical__Variables.html#a3962c36313826b19f216f6bbbdd6a477">Global_Physical_Variables::Nu</a>);</div>
<div class="line"> </div>
<div class="line"> <span class="comment"></span></div>
<div class="line"><span class="comment"> /// Switch off full doc for frontal solver</span></div>
<div class="line"><span class="comment"></span> <span class="comment">//static_cast&lt;HSL_MA42*&gt;(linear_solver_pt())-&gt;disable_doc_stats();</span></div>
<div class="line"> </div>
<div class="line"> <span class="comment">//Allocate the timestepper (no timedependence)</span></div>
<div class="line"> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">add_time_stepper_pt</a>(<span class="keyword">new</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Steady&lt;0&gt;</a>);</div>
<div class="line">   </div>
<div class="line"> <span class="comment">// Build mesh</span></div>
<div class="line"> Bulk_mesh_pt= </div>
<div class="line">  <span class="keyword">new</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">RefineableCylinderAndInterfaceMesh&lt;ELEMENT&gt;</a>(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">length</a>,<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">height</a>,</div>
<div class="line">                                                  Problem::time_stepper_pt());</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Set error estimator</span></div>
<div class="line"> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Z2ErrorEstimator</a>* <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">error_estimator_pt</a>=<span class="keyword">new</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Z2ErrorEstimator</a>;</div>
<div class="line"> Bulk_mesh_pt-&gt;spatial_error_estimator_pt()=<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">error_estimator_pt</a>;</div>
<div class="line">  </div>
<div class="line"> </div>
<div class="line"> <span class="comment">//Refine the problem a couple of times</span></div>
<div class="line"> <span class="keywordtype">bool</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">update_all_solid_nodes</a>=<span class="keyword">true</span>;</div>
<div class="line"> Bulk_mesh_pt-&gt;refine_uniformly();</div>
<div class="line"> Bulk_mesh_pt-&gt;node_update(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">update_all_solid_nodes</a>);</div>
<div class="line"> Bulk_mesh_pt-&gt;refine_uniformly();</div>
<div class="line"> Bulk_mesh_pt-&gt;node_update(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">update_all_solid_nodes</a>);</div>
<div class="line"> <span class="comment">//Bulk_mesh_pt-&gt;refine_uniformly();</span></div>
<div class="line"> <span class="comment">//refine_uniformly();</span></div>
<div class="line"> <span class="comment">//refine_uniformly();</span></div>
<div class="line">  </div>
<div class="line"> <span class="comment">// Loop over all elements and unset macro element pointer</span></div>
<div class="line"> <span class="keywordtype">unsigned</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Nelement</a> = Bulk_mesh_pt-&gt;nelement();</div>
<div class="line"> <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">e</a>=0;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">e</a>&lt;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Nelement</a>;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">e</a>++)</div>
<div class="line">  {</div>
<div class="line">   <span class="keyword">dynamic_cast&lt;</span><a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">ELEMENT</a>*<span class="keyword">&gt;</span>(Bulk_mesh_pt-&gt;element_pt(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">e</a>))-&gt;</div>
<div class="line">    <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">set_macro_elem_pt</a>(0);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> <span class="comment">//The external pressure is a piece of global data</span></div>
<div class="line"> Traded_pressure_data_pt = <span class="keyword">new</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Data</a>(1);</div>
<div class="line"> this-&gt;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">add_global_data</a>(Traded_pressure_data_pt);</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Complete the build of all elements so they are fully functional</span></div>
<div class="line"> </div>
<div class="line"> Surface_mesh_pt = <span class="keyword">new</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Mesh</a>;</div>
<div class="line"> Point_mesh_pt = <span class="keyword">new</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Mesh</a>;</div>
<div class="line"> Volume_constraint_mesh_pt = <span class="keyword">new</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Mesh</a>;</div>
<div class="line"> </div>
<div class="line"> finish_problem_setup();</div>
<div class="line">  </div>
<div class="line"> this-&gt;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">add_sub_mesh</a>(Bulk_mesh_pt);</div>
<div class="line"> this-&gt;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">add_sub_mesh</a>(Surface_mesh_pt);</div>
<div class="line"> this-&gt;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">add_sub_mesh</a>(Point_mesh_pt);</div>
<div class="line"> this-&gt;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">add_sub_mesh</a>(Volume_constraint_mesh_pt);</div>
<div class="line"> </div>
<div class="line"> this-&gt;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">build_global_mesh</a>();</div>
<div class="line"> </div>
<div class="line"> <span class="comment">//Attach the boundary conditions to the mesh</span></div>
<div class="line"> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">oomph_info</a> &lt;&lt;<span class="stringliteral">&quot;Number of equations: &quot;</span> &lt;&lt; <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">assign_eqn_numbers</a>() &lt;&lt; <a class="code hl_function" href="classRefineableCylinderAndInterfaceMesh.html#a2f42954cee8f7ba47d87f842dbdc4cc2">std::endl</a>; </div>
<div class="line"> </div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment">//========================================================================</span><span class="comment"></span></div>
<div class="line"><span class="comment">/// Complete build of Poisson problem:</span></div>
<div class="line"><span class="comment">/// Loop over elements and setup pointers to source function</span></div>
<div class="line"><span class="comment">///</span></div>
<div class="line"><span class="comment"></span><span class="comment">//========================================================================</span></div>
<div class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> ELEMENT&gt;</div>
<div class="line"><span class="keywordtype">void</span> <a class="code hl_function" href="classRefineableRotatingCylinderProblem.html#a417d18c2584ed1ea38daefe5dd68b4a4">RefineableRotatingCylinderProblem&lt;ELEMENT&gt;::finish_problem_setup</a>()</div>
<div class="line">{ </div>
<div class="line"> <span class="comment">//Now sort out the free surface</span></div>
<div class="line"> this-&gt;create_free_surface_elements();</div>
<div class="line"> <span class="comment">//Create the volume constraint elements</span></div>
<div class="line"> this-&gt;create_volume_constraint_elements();</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Set the boundary conditions for this problem: All nodes are</span></div>
<div class="line"> <span class="comment">// free by default -- just pin the ones that have Dirichlet conditions</span></div>
<div class="line"> <span class="comment">// here. </span></div>
<div class="line"> </div>
<div class="line"> <span class="comment">//Pin bottom and cylinder</span></div>
<div class="line">  <span class="keywordtype">unsigned</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">num_bound</a> = Bulk_mesh_pt-&gt;nboundary();</div>
<div class="line">  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">ibound</a>=0;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">ibound</a>&lt;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">num_bound</a>;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">ibound</a>+=4)</div>
<div class="line">   {</div>
<div class="line">    <span class="keywordtype">unsigned</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">num_nod</a>= Bulk_mesh_pt-&gt;nboundary_node(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">ibound</a>);</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">inod</a>=0;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">inod</a>&lt;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">num_nod</a>;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">inod</a>++)</div>
<div class="line">     {</div>
<div class="line">      Bulk_mesh_pt-&gt;boundary_node_pt(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">ibound</a>,<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">inod</a>)-&gt;pin(0);</div>
<div class="line">      Bulk_mesh_pt-&gt;boundary_node_pt(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">ibound</a>,<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">inod</a>)-&gt;pin(1);</div>
<div class="line">     }</div>
<div class="line">   }</div>
<div class="line">  </div>
<div class="line">  <span class="comment">//Pin u and v on LHS</span></div>
<div class="line">  {</div>
<div class="line">   <span class="keywordtype">unsigned</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">num_nod</a>= Bulk_mesh_pt-&gt;nboundary_node(3);</div>
<div class="line">   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">inod</a>=0;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">inod</a>&lt;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">num_nod</a>;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">inod</a>++)</div>
<div class="line">    {</div>
<div class="line">     Bulk_mesh_pt-&gt;boundary_node_pt(3,<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">inod</a>)-&gt;pin(0);</div>
<div class="line">     <span class="comment">//Bulk_mesh_pt-&gt;boundary_node_pt(3,inod)-&gt;pin(1);</span></div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line">  </div>
<div class="line">  <span class="comment">//Pin u and v on RHS</span></div>
<div class="line">  {</div>
<div class="line">   <span class="keywordtype">unsigned</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">num_nod</a>= Bulk_mesh_pt-&gt;nboundary_node(1);</div>
<div class="line">   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">inod</a>=0;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">inod</a>&lt;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">num_nod</a>;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">inod</a>++)</div>
<div class="line">    {</div>
<div class="line">     Bulk_mesh_pt-&gt;boundary_node_pt(1,<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">inod</a>)-&gt;pin(0);</div>
<div class="line">     Bulk_mesh_pt-&gt;boundary_node_pt(1,<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">inod</a>)-&gt;pin(1);</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  </div>
<div class="line">  <span class="keyword">dynamic_cast&lt;</span><a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">FluidInterfaceBoundingElement</a>*<span class="keyword">&gt;</span></div>
<div class="line">   (Point_mesh_pt-&gt;element_pt(0))-&gt;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">set_contact_angle</a>(&amp;Angle);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">dynamic_cast&lt;</span><a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">FluidInterfaceBoundingElement</a>*<span class="keyword">&gt;</span></div>
<div class="line">   (Point_mesh_pt-&gt;element_pt(0))-&gt;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">ca_pt</a>() = &amp;Ca;</div>
<div class="line"> </div>
<div class="line">  </div>
<div class="line">  <span class="keyword">dynamic_cast&lt;</span><a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">FluidInterfaceBoundingElement</a>*<span class="keyword">&gt;</span></div>
<div class="line">   (Point_mesh_pt-&gt;element_pt(0))-&gt;</div>
<div class="line">   <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">wall_unit_normal_fct_pt</a>() = &amp;<a class="code hl_function" href="namespaceGlobal__Physical__Variables.html#a0d48e8726fa485de2b2df2d5031ec41b">Global_Physical_Variables::wall_unit_normal_fct</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">//Pin one pressure</span></div>
<div class="line">  <span class="keyword">dynamic_cast&lt;</span><a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">ELEMENT</a>*<span class="keyword">&gt;</span>(Bulk_mesh_pt-&gt;element_pt(0))-&gt;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">fix_pressure</a>(0,0.0);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">//Loop over the lower boundary and pin nodal positions in both directions</span></div>
<div class="line">  <span class="keywordtype">unsigned</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">num_nod</a>= Bulk_mesh_pt-&gt;nboundary_node(0);</div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">inod</a>=0;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">inod</a>&lt;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">num_nod</a>;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">inod</a>++)</div>
<div class="line">   {</div>
<div class="line">    Bulk_mesh_pt-&gt;boundary_node_pt(0,<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">inod</a>)-&gt;pin_position(0);</div>
<div class="line">    Bulk_mesh_pt-&gt;boundary_node_pt(0,<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">inod</a>)-&gt;pin_position(1);</div>
<div class="line">   }</div>
<div class="line">  </div>
<div class="line">  <span class="comment">//Loop over the RHS side and pin in x and y</span></div>
<div class="line">  <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">num_nod</a>= Bulk_mesh_pt-&gt;nboundary_node(1);</div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">inod</a>=0;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">inod</a>&lt;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">num_nod</a>;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">inod</a>++)</div>
<div class="line">   {</div>
<div class="line">    Bulk_mesh_pt-&gt;boundary_node_pt(1,<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">inod</a>)-&gt;pin_position(0);</div>
<div class="line">    <span class="comment">//Bulk_mesh_pt-&gt;boundary_node_pt(1,inod)-&gt;pin_position(1);</span></div>
<div class="line">  }</div>
<div class="line">  </div>
<div class="line">  </div>
<div class="line"> <span class="comment">//Loop over the LHS side and pin in x</span></div>
<div class="line">  <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">num_nod</a>= Bulk_mesh_pt-&gt;nboundary_node(3);</div>
<div class="line"> <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">inod</a>=0;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">inod</a>&lt;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">num_nod</a>;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">inod</a>++)</div>
<div class="line">  {</div>
<div class="line">   Bulk_mesh_pt-&gt;boundary_node_pt(3,<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">inod</a>)-&gt;pin_position(0);</div>
<div class="line">   <span class="comment">//Bulk_mesh_pt-&gt;boundary_node_pt(3,inod)-&gt;pin_position(1);</span></div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> <span class="comment">//Loop over the cylinder and pin nodal positions in both directions</span></div>
<div class="line"> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">num_nod</a>= Bulk_mesh_pt-&gt;nboundary_node(4);</div>
<div class="line"> <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">inod</a>=0;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">inod</a>&lt;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">num_nod</a>;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">inod</a>++)</div>
<div class="line">  {</div>
<div class="line">   Bulk_mesh_pt-&gt;boundary_node_pt(4,<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">inod</a>)-&gt;pin_position(0);</div>
<div class="line">   Bulk_mesh_pt-&gt;boundary_node_pt(4,<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">inod</a>)-&gt;pin_position(1);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> <span class="comment">//Find number of elements in mesh</span></div>
<div class="line"> <span class="keywordtype">unsigned</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Nfluid</a> = Bulk_mesh_pt-&gt;nelement();</div>
<div class="line"> <span class="comment">//Find the number of free surface elements</span></div>
<div class="line"> <span class="keywordtype">unsigned</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Nfree</a> = Surface_mesh_pt-&gt;nelement();</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Loop over the elements to set up element-specific </span></div>
<div class="line">    <span class="comment">// things that cannot be handled by constructor</span></div>
<div class="line">    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">i</a>=0;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">i</a>&lt;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Nfluid</a>;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">i</a>++)</div>
<div class="line">     {</div>
<div class="line">      <span class="comment">// Upcast from FiniteElement to the present element</span></div>
<div class="line">      <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">ELEMENT</a> *<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">temp_pt</a> = <span class="keyword">dynamic_cast&lt;</span><a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">ELEMENT</a>*<span class="keyword">&gt;</span>(Bulk_mesh_pt-&gt;element_pt(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">i</a>));</div>
<div class="line">      </div>
<div class="line">      <span class="comment">//Set the source function pointer</span></div>
<div class="line">      <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">temp_pt</a>-&gt;re_pt() = &amp;Re;</div>
<div class="line">      <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">temp_pt</a>-&gt;re_invfr_pt() = &amp;ReInvFr;</div>
<div class="line">      <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">temp_pt</a>-&gt;g_pt() = &amp;G;</div>
<div class="line">      </div>
<div class="line">      <span class="comment">//Assign the mesh deformation constitutive law</span></div>
<div class="line">      <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">temp_pt</a>-&gt;constitutive_law_pt() = Constitutive_law_pt;</div>
<div class="line">      </div>
<div class="line">     }</div>
<div class="line">    </div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Pin the redundant solid pressures (if any)</span></div>
<div class="line">    <a class="code hl_function" href="classRefineableCylinderAndInterfaceMesh.html#a2f42954cee8f7ba47d87f842dbdc4cc2">PVDEquationsBase&lt;2&gt;::pin_redundant_nodal_solid_pressures</a>(</div>
<div class="line">     Bulk_mesh_pt-&gt;element_pt());</div>
<div class="line">    </div>
<div class="line">    <span class="comment">//Loop over the free surface elements</span></div>
<div class="line">    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">i</a>=0;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">i</a>&lt;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Nfree</a>;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">i</a>++)</div>
<div class="line">     {</div>
<div class="line">      <span class="comment">// Upcast from FiniteElement to the present element</span></div>
<div class="line">      <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">ElasticLineFluidInterfaceElement&lt;ELEMENT&gt;</a> *<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">temp_pt</a> = </div>
<div class="line">       <span class="keyword">dynamic_cast&lt;</span><a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">ElasticLineFluidInterfaceElement&lt;ELEMENT&gt;</a>*<span class="keyword">&gt;</span></div>
<div class="line">       (Surface_mesh_pt-&gt;element_pt(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">i</a>));</div>
<div class="line">      <span class="comment">//Set the Capillary number</span></div>
<div class="line">      <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">temp_pt</a>-&gt;ca_pt() = &amp;Ca;</div>
<div class="line">      </div>
<div class="line">      <span class="comment">//Pass the Data item that contains the external pressure</span></div>
<div class="line">      <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">temp_pt</a>-&gt;set_external_pressure_data(this-&gt;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">global_data_pt</a>(0));</div>
<div class="line">     }</div>
<div class="line">   </div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> ELEMENT&gt;</div>
<div class="line"><span class="keywordtype">void</span> <a class="code hl_function" href="classRefineableRotatingCylinderProblem.html#acd510f2c06fa3f38d2911781656dbf20">RefineableRotatingCylinderProblem&lt;ELEMENT&gt;::set_boundary_conditions</a>()</div>
<div class="line">{ </div>
<div class="line"> <span class="comment">//Only bother to set non-zero velocity on the cylinder</span></div>
<div class="line"> <span class="keywordtype">unsigned</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Nnode</a> = Bulk_mesh_pt-&gt;nboundary_node(4);</div>
<div class="line"> <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">n</a>=0;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">n</a>&lt;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Nnode</a>;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">n</a>++)</div>
<div class="line">  {</div>
<div class="line">   <span class="comment">//Get x and y</span></div>
<div class="line">   <span class="keywordtype">double</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">x</a> = Bulk_mesh_pt-&gt;boundary_node_pt(4,<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">n</a>)-&gt;x(0);</div>
<div class="line">   <span class="keywordtype">double</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">y</a> = Bulk_mesh_pt-&gt;boundary_node_pt(4,<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">n</a>)-&gt;x(1);</div>
<div class="line"> </div>
<div class="line">   <span class="comment">//Now find the vector distance to the centre</span></div>
<div class="line">   <span class="keywordtype">double</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">len_x</a> = <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">x</a> - Bulk_mesh_pt-&gt;<a class="code hl_function" href="classCylinderAndInterfaceMesh.html#aff1ea3970c93a046d9c02a47eeeca639">domain_pt</a>()-&gt;<a class="code hl_variable" href="classCylinderAndInterfaceDomain.html#a0b5aefe768267a1dff936ab491bee938">centre_x</a>;</div>
<div class="line">   <span class="keywordtype">double</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">len_y</a> = <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">y</a> - Bulk_mesh_pt-&gt;<a class="code hl_function" href="classCylinderAndInterfaceMesh.html#aff1ea3970c93a046d9c02a47eeeca639">domain_pt</a>()-&gt;<a class="code hl_variable" href="classCylinderAndInterfaceDomain.html#ac461297e0b08287a1909f245569c77f0">centre_y</a>;</div>
<div class="line"> </div>
<div class="line">   <span class="comment">//Calculate the angle and radius</span></div>
<div class="line">   <span class="keywordtype">double</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">r</a> = <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">sqrt</a>(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">len_x</a>*<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">len_x</a> + <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">len_y</a>*<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">len_y</a>);</div>
<div class="line">   <span class="keywordtype">double</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">theta</a> = <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">atan2</a>(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">len_y</a>,<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">len_x</a>);</div>
<div class="line">   </div>
<div class="line">   <span class="comment">//Now set the velocities</span></div>
<div class="line">   Bulk_mesh_pt-&gt;boundary_node_pt(4,<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">n</a>)-&gt;set_value(0,-Omega*<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">r</a>*<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">sin</a>(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">theta</a>));</div>
<div class="line">   Bulk_mesh_pt-&gt;boundary_node_pt(4,<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">n</a>)-&gt;set_value(1, Omega*<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">r</a>*<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">cos</a>(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">theta</a>));</div>
<div class="line">  }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> ELEMENT&gt;</div>
<div class="line"><span class="keywordtype">void</span> <a class="code hl_function" href="classRefineableRotatingCylinderProblem.html#a664bfd373351a401619b06c3494fdcdc">RefineableRotatingCylinderProblem&lt;ELEMENT&gt;::solve</a>()</div>
<div class="line">{ </div>
<div class="line"> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Newton_solver_tolerance</a> = 1.0e-8;</div>
<div class="line"> <span class="comment">//Document the solution</span></div>
<div class="line"> <a class="code hl_function" href="classRefineableCylinderAndInterfaceMesh.html#a2f42954cee8f7ba47d87f842dbdc4cc2">std::ofstream</a> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">filenamee</a>(<span class="stringliteral">&quot;input.dat&quot;</span>);</div>
<div class="line"> Bulk_mesh_pt-&gt;output(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">filenamee</a>,5);</div>
<div class="line"> Surface_mesh_pt-&gt;output(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">filenamee</a>,5);</div>
<div class="line"> <span class="comment">//Point_mesh_pt-&gt;output(filenamee,5);</span></div>
<div class="line"> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">filenamee</a>.close();</div>
<div class="line"> </div>
<div class="line"> <span class="comment">//Solve the initial value problem</span></div>
<div class="line"> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">newton_solve</a>();</div>
<div class="line"> </div>
<div class="line"> <a class="code hl_function" href="classRefineableCylinderAndInterfaceMesh.html#a2f42954cee8f7ba47d87f842dbdc4cc2">std::ofstream</a> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">filename</a>(<span class="stringliteral">&quot;first.dat&quot;</span>); </div>
<div class="line"> Bulk_mesh_pt-&gt;output(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">filename</a>,5); </div>
<div class="line"> Surface_mesh_pt-&gt;output(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">filename</a>,5); </div>
<div class="line"> <span class="comment">//Point_mesh_pt-&gt;output(filename,5);</span></div>
<div class="line"> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">filename</a>.close();</div>
<div class="line"> </div>
<div class="line"> <span class="comment">//Initialise the value of the arc-length</span></div>
<div class="line"> <span class="keywordtype">double</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">ds</a>=0.001;</div>
<div class="line"> </div>
<div class="line"> <a class="code hl_function" href="classRefineableCylinderAndInterfaceMesh.html#a2f42954cee8f7ba47d87f842dbdc4cc2">std::ofstream</a> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">trace</a>(<span class="stringliteral">&quot;trace.dat&quot;</span>);</div>
<div class="line"> </div>
<div class="line"> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">trace</a> &lt;&lt; Ca &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; ReInvFr &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line">       &lt;&lt; Bulk_mesh_pt-&gt;boundary_node_pt(2,0)-&gt;x(1) &lt;&lt; <a class="code hl_function" href="classRefineableCylinderAndInterfaceMesh.html#a2f42954cee8f7ba47d87f842dbdc4cc2">std::endl</a>;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// bool flag=true, fflag=true;</span></div>
<div class="line"> </div>
<div class="line"> <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">i</a>=0;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">i</a>&lt;2;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">i</a>++)</div>
<div class="line">  {</div>
<div class="line">   <span class="keywordflow">if</span>(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">i</a>&lt;5)</div>
<div class="line">    {</div>
<div class="line">     <span class="comment">//Decrease the contact angle</span></div>
<div class="line">     Angle -= 0.1;</div>
<div class="line">     <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">newton_solve</a>(2);</div>
<div class="line">     <span class="comment">//newton_solve();</span></div>
<div class="line">    }</div>
<div class="line">   <span class="keywordflow">else</span></div>
<div class="line">    {</div>
<div class="line">     <span class="comment">//do an arc-length continuation step in Ca</span></div>
<div class="line">     <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">ds</a> = <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">arc_length_step_solve</a>(&amp;Ca,<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">ds</a>);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">  <span class="comment">//  if(flag)</span></div>
<div class="line"><span class="comment">//     {</span></div>
<div class="line"><span class="comment">//      //Do an arc-length continuation step in ReInvFr</span></div>
<div class="line"><span class="comment">//      ds = arc_length_step_solve(&amp;ReInvFr,ds);</span></div>
<div class="line"><span class="comment">//     }</span></div>
<div class="line"><span class="comment">//    else</span></div>
<div class="line"><span class="comment">//     {</span></div>
<div class="line"><span class="comment">//      //Reset arc-length parameters</span></div>
<div class="line"><span class="comment">//      if(fflag) {reset_arc_length_parameters(); fflag=false;}</span></div>
<div class="line"><span class="comment">//      ds = 0.001;</span></div>
<div class="line"><span class="comment">//      //Now do it in Ca</span></div>
<div class="line"><span class="comment">//      ds = arc_length_step_solve(&amp;Ca,ds);</span></div>
<div class="line"><span class="comment">//     }</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">//    if(Bulk_mesh_pt-&gt;boundary_node_pt(2,0)-&gt;x(1) &lt; 4.0)</span></div>
<div class="line"><span class="comment">//     {flag=false;}</span></div>
<div class="line"> </div>
<div class="line">   <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">trace</a> &lt;&lt; Ca &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; ReInvFr &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; Angle &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line">         &lt;&lt; Bulk_mesh_pt-&gt;boundary_node_pt(2,0)-&gt;x(1) &lt;&lt; <a class="code hl_function" href="classRefineableCylinderAndInterfaceMesh.html#a2f42954cee8f7ba47d87f842dbdc4cc2">std::endl</a>;   </div>
<div class="line">   </div>
<div class="line">   <span class="keywordtype">char</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">file</a>[100];</div>
<div class="line">   <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">snprintf</a>(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">file</a>, <span class="keyword">sizeof</span>(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">file</a>), <span class="stringliteral">&quot;step%i.dat&quot;</span>,<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">i</a>);</div>
<div class="line">   <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">filename</a>.open(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">file</a>);</div>
<div class="line">   Bulk_mesh_pt-&gt;output(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">filename</a>,5);</div>
<div class="line">   Surface_mesh_pt-&gt;output(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">filename</a>,5);</div>
<div class="line">   <span class="comment">//Point_mesh_pt-&gt;output(filename,5);</span></div>
<div class="line">   <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">filename</a>.close();</div>
<div class="line"> </div>
<div class="line">   <span class="comment">//Now reset the values of the lagrange multipliers and the xi&#39;s</span></div>
<div class="line">   <span class="comment">//An updated lagrangian approach</span></div>
<div class="line">   </div>
<div class="line">   <span class="comment">//Now loop over all the nodes and set their Lagrangian coordinates</span></div>
<div class="line">   <span class="keywordtype">unsigned</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Nnode</a> = Bulk_mesh_pt-&gt;nnode();</div>
<div class="line">   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">n</a>=0;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">n</a>&lt;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Nnode</a>;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">n</a>++)</div>
<div class="line">    {</div>
<div class="line">     <span class="comment">//Cast node to an elastic node</span></div>
<div class="line">     <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">SolidNode</a>* <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">temp_pt</a> = <span class="keyword">static_cast&lt;</span><a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">SolidNode</a>*<span class="keyword">&gt;</span>(Bulk_mesh_pt-&gt;node_pt(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">n</a>));</div>
<div class="line">     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">j</a>=0;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">j</a>&lt;2;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">j</a>++) {<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">temp_pt</a>-&gt;xi(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">j</a>) = <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">temp_pt</a>-&gt;x(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">j</a>);}</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">   <span class="comment">//Find the number of free surface elements</span></div>
<div class="line">   <span class="keywordtype">unsigned</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Nfree</a> = Surface_mesh_pt-&gt;nelement();</div>
<div class="line">   <span class="comment">//Loop over the free surface elements</span></div>
<div class="line">   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">n</a>=0;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">n</a>&lt;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Nfree</a>;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">n</a>++)</div>
<div class="line">    {</div>
<div class="line">     <span class="comment">// Upcast from FiniteElement to the present element</span></div>
<div class="line">     <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">ElasticLineFluidInterfaceElement&lt;ELEMENT&gt;</a> *<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">temp_pt</a> = </div>
<div class="line">      <span class="keyword">dynamic_cast&lt;</span><a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">ElasticLineFluidInterfaceElement&lt;ELEMENT&gt;</a>*<span class="keyword">&gt;</span></div>
<div class="line">      (Surface_mesh_pt-&gt;element_pt(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">n</a>));</div>
<div class="line">     <span class="keywordtype">unsigned</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Nnode</a> = <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">temp_pt</a>-&gt;nnode();</div>
<div class="line">     <span class="comment">//Reset the lagrange multipliers</span></div>
<div class="line">     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">j</a>=0;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">j</a>&lt;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">Nnode</a>;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">j</a>++) {<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">temp_pt</a>-&gt;lagrange(<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">j</a>) = 0.0;}</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> <span class="comment">//Document the solution</span></div>
<div class="line"> <span class="comment">//filename.open(&quot;output.dat&quot;);</span></div>
<div class="line"> <span class="comment">//Bulk_mesh_pt-&gt;output(filename,5);</span></div>
<div class="line"> <span class="comment">//filename.close();</span></div>
<div class="line"> <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">trace</a>.close();</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">///////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><span class="comment">///////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><span class="comment">///////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"> </div>
<div class="line"> <span class="keywordtype">int</span> <a class="code hl_function" href="adaptive__interface_8cc.html#ae66f6b31b5ad750f1fe042a706a4e3d4">main</a>()</div>
<div class="line">  {</div>
<div class="line"> </div>
<div class="line">   <a class="code hl_class" href="classRefineableRotatingCylinderProblem.html">RefineableRotatingCylinderProblem</a></div>
<div class="line">    &lt;<a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">RefineablePseudoSolidNodeUpdateElement&lt;RefineableQCrouzeixRaviartElement&lt;2&gt;</a>,</div>
<div class="line">    <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">RefineableQPVDElementWithContinuousPressure&lt;2&gt;</a> &gt; &gt; <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">problem</a>(3.0,4.0);</div>
<div class="line">   </div>
<div class="line">   <span class="comment">//ofstream filename(&quot;mesh.dat&quot;);</span></div>
<div class="line">   <span class="comment">//problem.Bulk_mesh_pt-&gt;output(filename,5);</span></div>
<div class="line"> </div>
<div class="line">   <a class="code hl_class" href="classRefineableCylinderAndInterfaceMesh.html">problem</a>.solve();</div>
<div class="line">  }</div>
<div class="ttc" id="aadaptive__interface_8cc_html_ae66f6b31b5ad750f1fe042a706a4e3d4"><div class="ttname"><a href="adaptive__interface_8cc.html#ae66f6b31b5ad750f1fe042a706a4e3d4">main</a></div><div class="ttdeci">int main()</div><div class="ttdef"><b>Definition</b> <a href="adaptive__interface_8cc_source.html#l01274">adaptive_interface.cc:1274</a></div></div>
<div class="ttc" id="aclassCylinderAndInterfaceDomain_html"><div class="ttname"><a href="classCylinderAndInterfaceDomain.html">CylinderAndInterfaceDomain</a></div><div class="ttdef"><b>Definition</b> <a href="adaptive__interface_8cc_source.html#l00098">adaptive_interface.cc:99</a></div></div>
<div class="ttc" id="aclassCylinderAndInterfaceDomain_html_a01c924b854c98cb5a45ba2d1af43aa46"><div class="ttname"><a href="classCylinderAndInterfaceDomain.html#a01c924b854c98cb5a45ba2d1af43aa46">CylinderAndInterfaceDomain::Upper_mid_left</a></div><div class="ttdeci">double Upper_mid_left[2]</div><div class="ttdef"><b>Definition</b> <a href="adaptive__interface_8cc_source.html#l00106">adaptive_interface.cc:106</a></div></div>
<div class="ttc" id="aclassCylinderAndInterfaceDomain_html_a04206f6c72189356d5eecf32b81595f4"><div class="ttname"><a href="classCylinderAndInterfaceDomain.html#a04206f6c72189356d5eecf32b81595f4">CylinderAndInterfaceDomain::Lower_right</a></div><div class="ttdeci">double Lower_right[2]</div><div class="ttdef"><b>Definition</b> <a href="adaptive__interface_8cc_source.html#l00105">adaptive_interface.cc:105</a></div></div>
<div class="ttc" id="aclassCylinderAndInterfaceDomain_html_a0b5aefe768267a1dff936ab491bee938"><div class="ttname"><a href="classCylinderAndInterfaceDomain.html#a0b5aefe768267a1dff936ab491bee938">CylinderAndInterfaceDomain::centre_x</a></div><div class="ttdeci">double centre_x</div><div class="ttdef"><b>Definition</b> <a href="adaptive__interface_8cc_source.html#l00101">adaptive_interface.cc:101</a></div></div>
<div class="ttc" id="aclassCylinderAndInterfaceDomain_html_a1f1363c5343672e04be3b9f3285b0a25"><div class="ttname"><a href="classCylinderAndInterfaceDomain.html#a1f1363c5343672e04be3b9f3285b0a25">CylinderAndInterfaceDomain::Lower_centre_right</a></div><div class="ttdeci">double Lower_centre_right[2]</div><div class="ttdef"><b>Definition</b> <a href="adaptive__interface_8cc_source.html#l00107">adaptive_interface.cc:107</a></div></div>
<div class="ttc" id="aclassCylinderAndInterfaceDomain_html_a21972e49d0da0a5c1cbb89422b8bcfc3"><div class="ttname"><a href="classCylinderAndInterfaceDomain.html#a21972e49d0da0a5c1cbb89422b8bcfc3">CylinderAndInterfaceDomain::Upper_centre_right</a></div><div class="ttdeci">double Upper_centre_right[2]</div><div class="ttdef"><b>Definition</b> <a href="adaptive__interface_8cc_source.html#l00108">adaptive_interface.cc:108</a></div></div>
<div class="ttc" id="aclassCylinderAndInterfaceDomain_html_a231d89466e433b65d0a6fd74b29b4609"><div class="ttname"><a href="classCylinderAndInterfaceDomain.html#a231d89466e433b65d0a6fd74b29b4609">CylinderAndInterfaceDomain::Upper_centre_left</a></div><div class="ttdeci">double Upper_centre_left[2]</div><div class="ttdef"><b>Definition</b> <a href="adaptive__interface_8cc_source.html#l00108">adaptive_interface.cc:108</a></div></div>
<div class="ttc" id="aclassCylinderAndInterfaceDomain_html_a27c21e714221edda1d21995f941e74e3"><div class="ttname"><a href="classCylinderAndInterfaceDomain.html#a27c21e714221edda1d21995f941e74e3">CylinderAndInterfaceDomain::Lower_left</a></div><div class="ttdeci">double Lower_left[2]</div><div class="ttdef"><b>Definition</b> <a href="adaptive__interface_8cc_source.html#l00105">adaptive_interface.cc:105</a></div></div>
<div class="ttc" id="aclassCylinderAndInterfaceDomain_html_a2ad3d09d983dfcd5cc2a2b4c0d3d8b62"><div class="ttname"><a href="classCylinderAndInterfaceDomain.html#a2ad3d09d983dfcd5cc2a2b4c0d3d8b62">CylinderAndInterfaceDomain::Upper_left</a></div><div class="ttdeci">double Upper_left[2]</div><div class="ttdef"><b>Definition</b> <a href="adaptive__interface_8cc_source.html#l00106">adaptive_interface.cc:106</a></div></div>
<div class="ttc" id="aclassCylinderAndInterfaceDomain_html_a389bb3200199cf6098461f884e1b4d09"><div class="ttname"><a href="classCylinderAndInterfaceDomain.html#a389bb3200199cf6098461f884e1b4d09">CylinderAndInterfaceDomain::Lower_centre_left</a></div><div class="ttdeci">double Lower_centre_left[2]</div><div class="ttdef"><b>Definition</b> <a href="adaptive__interface_8cc_source.html#l00107">adaptive_interface.cc:107</a></div></div>
<div class="ttc" id="aclassCylinderAndInterfaceDomain_html_a390ef76333ff22e7331b37ac7d5412bb"><div class="ttname"><a href="classCylinderAndInterfaceDomain.html#a390ef76333ff22e7331b37ac7d5412bb">CylinderAndInterfaceDomain::Lower_mid_right</a></div><div class="ttdeci">double Lower_mid_right[2]</div><div class="ttdef"><b>Definition</b> <a href="adaptive__interface_8cc_source.html#l00105">adaptive_interface.cc:105</a></div></div>
<div class="ttc" id="aclassCylinderAndInterfaceDomain_html_a5285785212f1cbcfb3910e87421d831c"><div class="ttname"><a href="classCylinderAndInterfaceDomain.html#a5285785212f1cbcfb3910e87421d831c">CylinderAndInterfaceDomain::Lower_mid_left</a></div><div class="ttdeci">double Lower_mid_left[2]</div><div class="ttdef"><b>Definition</b> <a href="adaptive__interface_8cc_source.html#l00105">adaptive_interface.cc:105</a></div></div>
<div class="ttc" id="aclassCylinderAndInterfaceDomain_html_a6afdef0d863b2833884aed2f571eeb79"><div class="ttname"><a href="classCylinderAndInterfaceDomain.html#a6afdef0d863b2833884aed2f571eeb79">CylinderAndInterfaceDomain::macro_element_boundary</a></div><div class="ttdeci">void macro_element_boundary(const unsigned &amp;time, const unsigned &amp;m, const unsigned &amp;direction, const Vector&lt; double &gt; &amp;s, Vector&lt; double &gt; &amp;f)</div><div class="ttdef"><b>Definition</b> <a href="adaptive__interface_8cc_source.html#l00204">adaptive_interface.cc:204</a></div></div>
<div class="ttc" id="aclassCylinderAndInterfaceDomain_html_a87b1a618cc0116816b5460f00f3875a6"><div class="ttname"><a href="classCylinderAndInterfaceDomain.html#a87b1a618cc0116816b5460f00f3875a6">CylinderAndInterfaceDomain::Upper_right</a></div><div class="ttdeci">double Upper_right[2]</div><div class="ttdef"><b>Definition</b> <a href="adaptive__interface_8cc_source.html#l00106">adaptive_interface.cc:106</a></div></div>
<div class="ttc" id="aclassCylinderAndInterfaceDomain_html_aa0afda5d24ea33ff58957731e5b7dfd7"><div class="ttname"><a href="classCylinderAndInterfaceDomain.html#aa0afda5d24ea33ff58957731e5b7dfd7">CylinderAndInterfaceDomain::Cylinder_pt</a></div><div class="ttdeci">GeomObject * Cylinder_pt</div><div class="ttdoc">Geometric object that represents the rotating cylinder.</div><div class="ttdef"><b>Definition</b> <a href="adaptive__interface_8cc_source.html#l00112">adaptive_interface.cc:112</a></div></div>
<div class="ttc" id="aclassCylinderAndInterfaceDomain_html_aa204e83ef6332f121123465f4167d341"><div class="ttname"><a href="classCylinderAndInterfaceDomain.html#aa204e83ef6332f121123465f4167d341">CylinderAndInterfaceDomain::~CylinderAndInterfaceDomain</a></div><div class="ttdeci">~CylinderAndInterfaceDomain()</div><div class="ttdef"><b>Definition</b> <a href="adaptive__interface_8cc_source.html#l00189">adaptive_interface.cc:189</a></div></div>
<div class="ttc" id="aclassCylinderAndInterfaceDomain_html_ac461297e0b08287a1909f245569c77f0"><div class="ttname"><a href="classCylinderAndInterfaceDomain.html#ac461297e0b08287a1909f245569c77f0">CylinderAndInterfaceDomain::centre_y</a></div><div class="ttdeci">double centre_y</div><div class="ttdef"><b>Definition</b> <a href="adaptive__interface_8cc_source.html#l00101">adaptive_interface.cc:101</a></div></div>
<div class="ttc" id="aclassCylinderAndInterfaceDomain_html_acab40651417c703e6b3dc592198c7497"><div class="ttname"><a href="classCylinderAndInterfaceDomain.html#acab40651417c703e6b3dc592198c7497">CylinderAndInterfaceDomain::linear_interpolate</a></div><div class="ttdeci">void linear_interpolate(double Left[2], double Right[2], const double &amp;s, Vector&lt; double &gt; &amp;f)</div><div class="ttdef"><b>Definition</b> <a href="adaptive__interface_8cc_source.html#l00192">adaptive_interface.cc:192</a></div></div>
<div class="ttc" id="aclassCylinderAndInterfaceDomain_html_afb8019b28889f581f79541d571fb6386"><div class="ttname"><a href="classCylinderAndInterfaceDomain.html#afb8019b28889f581f79541d571fb6386">CylinderAndInterfaceDomain::Upper_mid_right</a></div><div class="ttdeci">double Upper_mid_right[2]</div><div class="ttdef"><b>Definition</b> <a href="adaptive__interface_8cc_source.html#l00106">adaptive_interface.cc:106</a></div></div>
<div class="ttc" id="aclassCylinderAndInterfaceMesh_html"><div class="ttname"><a href="classCylinderAndInterfaceMesh.html">CylinderAndInterfaceMesh</a></div><div class="ttdef"><b>Definition</b> <a href="adaptive__interface_8cc_source.html#l00438">adaptive_interface.cc:439</a></div></div>
<div class="ttc" id="aclassCylinderAndInterfaceMesh_html_a5ad81e65a9e9fb4c709a0c84f38216b1"><div class="ttname"><a href="classCylinderAndInterfaceMesh.html#a5ad81e65a9e9fb4c709a0c84f38216b1">CylinderAndInterfaceMesh::Height</a></div><div class="ttdeci">double Height</div><div class="ttdef"><b>Definition</b> <a href="adaptive__interface_8cc_source.html#l00440">adaptive_interface.cc:440</a></div></div>
<div class="ttc" id="aclassCylinderAndInterfaceMesh_html_aa7b43c0cab4ffc92bb47813a8e255374"><div class="ttname"><a href="classCylinderAndInterfaceMesh.html#aa7b43c0cab4ffc92bb47813a8e255374">CylinderAndInterfaceMesh::Domain_pt</a></div><div class="ttdeci">CylinderAndInterfaceDomain * Domain_pt</div><div class="ttdef"><b>Definition</b> <a href="adaptive__interface_8cc_source.html#l00444">adaptive_interface.cc:444</a></div></div>
<div class="ttc" id="aclassCylinderAndInterfaceMesh_html_aff1ea3970c93a046d9c02a47eeeca639"><div class="ttname"><a href="classCylinderAndInterfaceMesh.html#aff1ea3970c93a046d9c02a47eeeca639">CylinderAndInterfaceMesh::domain_pt</a></div><div class="ttdeci">CylinderAndInterfaceDomain * domain_pt()</div><div class="ttdef"><b>Definition</b> <a href="adaptive__interface_8cc_source.html#l00449">adaptive_interface.cc:449</a></div></div>
<div class="ttc" id="aclassGeneralEllipse_html"><div class="ttname"><a href="classGeneralEllipse.html">GeneralEllipse</a></div><div class="ttdef"><b>Definition</b> <a href="adaptive__interface_8cc_source.html#l00060">adaptive_interface.cc:61</a></div></div>
<div class="ttc" id="aclassGeneralEllipse_html_a3ac5c17cf8c4998f1b74913860cb3bb9"><div class="ttname"><a href="classGeneralEllipse.html#a3ac5c17cf8c4998f1b74913860cb3bb9">GeneralEllipse::~GeneralEllipse</a></div><div class="ttdeci">~GeneralEllipse()</div><div class="ttdef"><b>Definition</b> <a href="adaptive__interface_8cc_source.html#l00080">adaptive_interface.cc:80</a></div></div>
<div class="ttc" id="aclassGeneralEllipse_html_a64b87c57aa9b725a9099fb64aa2586dd"><div class="ttname"><a href="classGeneralEllipse.html#a64b87c57aa9b725a9099fb64aa2586dd">GeneralEllipse::centre_y_pt</a></div><div class="ttdeci">double * centre_y_pt</div><div class="ttdef"><b>Definition</b> <a href="adaptive__interface_8cc_source.html#l00064">adaptive_interface.cc:64</a></div></div>
<div class="ttc" id="aclassGeneralEllipse_html_a85e975c70441a9c9c711b5e27d124bff"><div class="ttname"><a href="classGeneralEllipse.html#a85e975c70441a9c9c711b5e27d124bff">GeneralEllipse::position</a></div><div class="ttdeci">void position(const Vector&lt; double &gt; &amp;xi, Vector&lt; double &gt; &amp;r) const</div><div class="ttdef"><b>Definition</b> <a href="adaptive__interface_8cc_source.html#l00089">adaptive_interface.cc:89</a></div></div>
<div class="ttc" id="aclassGeneralEllipse_html_a94a4648c20c4a51e2e9599634e32f9f1"><div class="ttname"><a href="classGeneralEllipse.html#a94a4648c20c4a51e2e9599634e32f9f1">GeneralEllipse::centre_x_pt</a></div><div class="ttdeci">double * centre_x_pt</div><div class="ttdef"><b>Definition</b> <a href="adaptive__interface_8cc_source.html#l00064">adaptive_interface.cc:64</a></div></div>
<div class="ttc" id="aclassGeneralEllipse_html_ab7accdeac49aacf9f6a1b2fc935e9692"><div class="ttname"><a href="classGeneralEllipse.html#ab7accdeac49aacf9f6a1b2fc935e9692">GeneralEllipse::a_pt</a></div><div class="ttdeci">double * a_pt</div><div class="ttdef"><b>Definition</b> <a href="adaptive__interface_8cc_source.html#l00064">adaptive_interface.cc:64</a></div></div>
<div class="ttc" id="aclassGeneralEllipse_html_ae9fda2830674311985eaf2fddeeec1e3"><div class="ttname"><a href="classGeneralEllipse.html#ae9fda2830674311985eaf2fddeeec1e3">GeneralEllipse::b_pt</a></div><div class="ttdeci">double * b_pt</div><div class="ttdef"><b>Definition</b> <a href="adaptive__interface_8cc_source.html#l00064">adaptive_interface.cc:64</a></div></div>
<div class="ttc" id="aclassRefineableCylinderAndInterfaceMesh_html"><div class="ttname"><a href="classRefineableCylinderAndInterfaceMesh.html">RefineableCylinderAndInterfaceMesh</a></div><div class="ttdef"><b>Definition</b> <a href="adaptive__interface_8cc_source.html#l00685">adaptive_interface.cc:687</a></div></div>
<div class="ttc" id="aclassRefineableCylinderAndInterfaceMesh_html_a2f42954cee8f7ba47d87f842dbdc4cc2"><div class="ttname"><a href="classRefineableCylinderAndInterfaceMesh.html#a2f42954cee8f7ba47d87f842dbdc4cc2">RefineableCylinderAndInterfaceMesh::RefineableCylinderAndInterfaceMesh</a></div><div class="ttdeci">RefineableCylinderAndInterfaceMesh(const double &amp;length, const double &amp;height, TimeStepper *time_stepper_pt)</div><div class="ttdef"><b>Definition</b> <a href="adaptive__interface_8cc_source.html#l00691">adaptive_interface.cc:691</a></div></div>
<div class="ttc" id="aclassRefineableCylinderAndInterfaceMesh_html_ad661ea3bc9100aaac36bc10aab9b2648"><div class="ttname"><a href="classRefineableCylinderAndInterfaceMesh.html#ad661ea3bc9100aaac36bc10aab9b2648">RefineableCylinderAndInterfaceMesh::~RefineableCylinderAndInterfaceMesh</a></div><div class="ttdeci">virtual ~RefineableCylinderAndInterfaceMesh()</div><div class="ttdoc">Destructor: Empty.</div><div class="ttdef"><b>Definition</b> <a href="adaptive__interface_8cc_source.html#l00716">adaptive_interface.cc:716</a></div></div>
<div class="ttc" id="aclassRefineableRotatingCylinderProblem_html"><div class="ttname"><a href="classRefineableRotatingCylinderProblem.html">RefineableRotatingCylinderProblem</a></div><div class="ttdef"><b>Definition</b> <a href="adaptive__interface_8cc_source.html#l00722">adaptive_interface.cc:723</a></div></div>
<div class="ttc" id="aclassRefineableRotatingCylinderProblem_html_a253a0d7954a3527bf1410f01080e5c70"><div class="ttname"><a href="classRefineableRotatingCylinderProblem.html#a253a0d7954a3527bf1410f01080e5c70">RefineableRotatingCylinderProblem::Bo</a></div><div class="ttdeci">double Bo</div><div class="ttdef"><b>Definition</b> <a href="adaptive__interface_8cc_source.html#l00734">adaptive_interface.cc:734</a></div></div>
<div class="ttc" id="aclassRefineableRotatingCylinderProblem_html_a270f2243978a54c8d787cc912168bb90"><div class="ttname"><a href="classRefineableRotatingCylinderProblem.html#a270f2243978a54c8d787cc912168bb90">RefineableRotatingCylinderProblem::G</a></div><div class="ttdeci">Vector&lt; double &gt; G</div><div class="ttdef"><b>Definition</b> <a href="adaptive__interface_8cc_source.html#l00742">adaptive_interface.cc:742</a></div></div>
<div class="ttc" id="aclassRefineableRotatingCylinderProblem_html_a2de094b437cba9e9b71dca0afe587d65"><div class="ttname"><a href="classRefineableRotatingCylinderProblem.html#a2de094b437cba9e9b71dca0afe587d65">RefineableRotatingCylinderProblem::create_volume_constraint_elements</a></div><div class="ttdeci">void create_volume_constraint_elements()</div><div class="ttdoc">Create the volume constraint elements.</div><div class="ttdef"><b>Definition</b> <a href="adaptive__interface_8cc_source.html#l00784">adaptive_interface.cc:784</a></div></div>
<div class="ttc" id="aclassRefineableRotatingCylinderProblem_html_a2e47341fa1a71da29907ead94aeb5ec2"><div class="ttname"><a href="classRefineableRotatingCylinderProblem.html#a2e47341fa1a71da29907ead94aeb5ec2">RefineableRotatingCylinderProblem::Ca</a></div><div class="ttdeci">double Ca</div><div class="ttdef"><b>Definition</b> <a href="adaptive__interface_8cc_source.html#l00734">adaptive_interface.cc:734</a></div></div>
<div class="ttc" id="aclassRefineableRotatingCylinderProblem_html_a3521efd0bfad036e20a6a8ba7e4547f4"><div class="ttname"><a href="classRefineableRotatingCylinderProblem.html#a3521efd0bfad036e20a6a8ba7e4547f4">RefineableRotatingCylinderProblem::Height</a></div><div class="ttdeci">double Height</div><div class="ttdef"><b>Definition</b> <a href="adaptive__interface_8cc_source.html#l00725">adaptive_interface.cc:725</a></div></div>
<div class="ttc" id="aclassRefineableRotatingCylinderProblem_html_a37cc1af7c83c5c1b7ae57f7f434be2f1"><div class="ttname"><a href="classRefineableRotatingCylinderProblem.html#a37cc1af7c83c5c1b7ae57f7f434be2f1">RefineableRotatingCylinderProblem::delete_volume_constraint_elements</a></div><div class="ttdeci">void delete_volume_constraint_elements()</div><div class="ttdef"><b>Definition</b> <a href="adaptive__interface_8cc_source.html#l00822">adaptive_interface.cc:822</a></div></div>
<div class="ttc" id="aclassRefineableRotatingCylinderProblem_html_a382bc388316b410c45f337558b5ad577"><div class="ttname"><a href="classRefineableRotatingCylinderProblem.html#a382bc388316b410c45f337558b5ad577">RefineableRotatingCylinderProblem::actions_before_newton_solve</a></div><div class="ttdeci">void actions_before_newton_solve()</div><div class="ttdoc">Update the problem specs before solve:</div><div class="ttdef"><b>Definition</b> <a href="adaptive__interface_8cc_source.html#l00752">adaptive_interface.cc:752</a></div></div>
<div class="ttc" id="aclassRefineableRotatingCylinderProblem_html_a3a7fe3dd801eb1ef71dcf8e4c6a237ef"><div class="ttname"><a href="classRefineableRotatingCylinderProblem.html#a3a7fe3dd801eb1ef71dcf8e4c6a237ef">RefineableRotatingCylinderProblem::Re</a></div><div class="ttdeci">double Re</div><div class="ttdef"><b>Definition</b> <a href="adaptive__interface_8cc_source.html#l00734">adaptive_interface.cc:734</a></div></div>
<div class="ttc" id="aclassRefineableRotatingCylinderProblem_html_a3bb79346179cb5ef1dad280530ea24e8"><div class="ttname"><a href="classRefineableRotatingCylinderProblem.html#a3bb79346179cb5ef1dad280530ea24e8">RefineableRotatingCylinderProblem::Volume_constraint_mesh_pt</a></div><div class="ttdeci">Mesh * Volume_constraint_mesh_pt</div><div class="ttdoc">The volume constraint mesh.</div><div class="ttdef"><b>Definition</b> <a href="adaptive__interface_8cc_source.html#l00777">adaptive_interface.cc:777</a></div></div>
<div class="ttc" id="aclassRefineableRotatingCylinderProblem_html_a417d18c2584ed1ea38daefe5dd68b4a4"><div class="ttname"><a href="classRefineableRotatingCylinderProblem.html#a417d18c2584ed1ea38daefe5dd68b4a4">RefineableRotatingCylinderProblem::finish_problem_setup</a></div><div class="ttdeci">void finish_problem_setup()</div><div class="ttdoc">Complete problem setup: Setup element-specific things (source fct pointers etc.)</div><div class="ttdef"><b>Definition</b> <a href="adaptive__interface_8cc_source.html#l01001">adaptive_interface.cc:1001</a></div></div>
<div class="ttc" id="aclassRefineableRotatingCylinderProblem_html_a48cc95921f8a03c220609d9666bcf406"><div class="ttname"><a href="classRefineableRotatingCylinderProblem.html#a48cc95921f8a03c220609d9666bcf406">RefineableRotatingCylinderProblem::Surface_mesh_pt</a></div><div class="ttdeci">Mesh * Surface_mesh_pt</div><div class="ttdef"><b>Definition</b> <a href="adaptive__interface_8cc_source.html#l00771">adaptive_interface.cc:771</a></div></div>
<div class="ttc" id="aclassRefineableRotatingCylinderProblem_html_a4e832fa2d6e1faafd39425d132d732e2"><div class="ttname"><a href="classRefineableRotatingCylinderProblem.html#a4e832fa2d6e1faafd39425d132d732e2">RefineableRotatingCylinderProblem::Constitutive_law_pt</a></div><div class="ttdeci">ConstitutiveLaw * Constitutive_law_pt</div><div class="ttdef"><b>Definition</b> <a href="adaptive__interface_8cc_source.html#l00728">adaptive_interface.cc:728</a></div></div>
<div class="ttc" id="aclassRefineableRotatingCylinderProblem_html_a54c8bf3a55597f50087c82ed5f955f5b"><div class="ttname"><a href="classRefineableRotatingCylinderProblem.html#a54c8bf3a55597f50087c82ed5f955f5b">RefineableRotatingCylinderProblem::Angle</a></div><div class="ttdeci">double Angle</div><div class="ttdef"><b>Definition</b> <a href="adaptive__interface_8cc_source.html#l00740">adaptive_interface.cc:740</a></div></div>
<div class="ttc" id="aclassRefineableRotatingCylinderProblem_html_a57623d36f2c97d300215c00ac917d449"><div class="ttname"><a href="classRefineableRotatingCylinderProblem.html#a57623d36f2c97d300215c00ac917d449">RefineableRotatingCylinderProblem::create_free_surface_elements</a></div><div class="ttdeci">void create_free_surface_elements()</div><div class="ttdef"><b>Definition</b> <a href="adaptive__interface_8cc_source.html#l00832">adaptive_interface.cc:832</a></div></div>
<div class="ttc" id="aclassRefineableRotatingCylinderProblem_html_a664bfd373351a401619b06c3494fdcdc"><div class="ttname"><a href="classRefineableRotatingCylinderProblem.html#a664bfd373351a401619b06c3494fdcdc">RefineableRotatingCylinderProblem::solve</a></div><div class="ttdeci">void solve()</div><div class="ttdef"><b>Definition</b> <a href="adaptive__interface_8cc_source.html#l01162">adaptive_interface.cc:1162</a></div></div>
<div class="ttc" id="aclassRefineableRotatingCylinderProblem_html_a705922ef2d96697ea5a110a412db5287"><div class="ttname"><a href="classRefineableRotatingCylinderProblem.html#a705922ef2d96697ea5a110a412db5287">RefineableRotatingCylinderProblem::actions_before_adapt</a></div><div class="ttdeci">void actions_before_adapt()</div><div class="ttdoc">Strip off the interface before adaptation.</div><div class="ttdef"><b>Definition</b> <a href="adaptive__interface_8cc_source.html#l00755">adaptive_interface.cc:755</a></div></div>
<div class="ttc" id="aclassRefineableRotatingCylinderProblem_html_a712d1cdcab28b62e1df830ffe1818009"><div class="ttname"><a href="classRefineableRotatingCylinderProblem.html#a712d1cdcab28b62e1df830ffe1818009">RefineableRotatingCylinderProblem::Traded_pressure_data_pt</a></div><div class="ttdeci">Data * Traded_pressure_data_pt</div><div class="ttdef"><b>Definition</b> <a href="adaptive__interface_8cc_source.html#l00730">adaptive_interface.cc:730</a></div></div>
<div class="ttc" id="aclassRefineableRotatingCylinderProblem_html_aa476013effb3f9a45cf1e1e2198aad14"><div class="ttname"><a href="classRefineableRotatingCylinderProblem.html#aa476013effb3f9a45cf1e1e2198aad14">RefineableRotatingCylinderProblem::Volume</a></div><div class="ttdeci">double Volume</div><div class="ttdef"><b>Definition</b> <a href="adaptive__interface_8cc_source.html#l00738">adaptive_interface.cc:738</a></div></div>
<div class="ttc" id="aclassRefineableRotatingCylinderProblem_html_aa597c4240ce9affbd7540998167c8f21"><div class="ttname"><a href="classRefineableRotatingCylinderProblem.html#aa597c4240ce9affbd7540998167c8f21">RefineableRotatingCylinderProblem::RefineableRotatingCylinderProblem</a></div><div class="ttdeci">RefineableRotatingCylinderProblem(const double &amp;length, const double &amp;height)</div><div class="ttdoc">Constructor: Pass flag to indicate if you want a constant source function or the tanh profile.</div><div class="ttdef"><b>Definition</b> <a href="adaptive__interface_8cc_source.html#l00910">adaptive_interface.cc:910</a></div></div>
<div class="ttc" id="aclassRefineableRotatingCylinderProblem_html_aaf1d39e57b4fc4d470b69f01121d93a3"><div class="ttname"><a href="classRefineableRotatingCylinderProblem.html#aaf1d39e57b4fc4d470b69f01121d93a3">RefineableRotatingCylinderProblem::Omega</a></div><div class="ttdeci">double Omega</div><div class="ttdef"><b>Definition</b> <a href="adaptive__interface_8cc_source.html#l00736">adaptive_interface.cc:736</a></div></div>
<div class="ttc" id="aclassRefineableRotatingCylinderProblem_html_acd510f2c06fa3f38d2911781656dbf20"><div class="ttname"><a href="classRefineableRotatingCylinderProblem.html#acd510f2c06fa3f38d2911781656dbf20">RefineableRotatingCylinderProblem::set_boundary_conditions</a></div><div class="ttdeci">void set_boundary_conditions()</div><div class="ttdef"><b>Definition</b> <a href="adaptive__interface_8cc_source.html#l01137">adaptive_interface.cc:1137</a></div></div>
<div class="ttc" id="aclassRefineableRotatingCylinderProblem_html_acf70c93c4b4db46c1809f6b9f68214ee"><div class="ttname"><a href="classRefineableRotatingCylinderProblem.html#acf70c93c4b4db46c1809f6b9f68214ee">RefineableRotatingCylinderProblem::ReInvFr</a></div><div class="ttdeci">double ReInvFr</div><div class="ttdef"><b>Definition</b> <a href="adaptive__interface_8cc_source.html#l00734">adaptive_interface.cc:734</a></div></div>
<div class="ttc" id="aclassRefineableRotatingCylinderProblem_html_acfa616d36346f557244146d4b2db9197"><div class="ttname"><a href="classRefineableRotatingCylinderProblem.html#acfa616d36346f557244146d4b2db9197">RefineableRotatingCylinderProblem::Length</a></div><div class="ttdeci">double Length</div><div class="ttdef"><b>Definition</b> <a href="adaptive__interface_8cc_source.html#l00725">adaptive_interface.cc:725</a></div></div>
<div class="ttc" id="aclassRefineableRotatingCylinderProblem_html_ada026864153cf9954011bcea592cc5b7"><div class="ttname"><a href="classRefineableRotatingCylinderProblem.html#ada026864153cf9954011bcea592cc5b7">RefineableRotatingCylinderProblem::delete_free_surface_elements</a></div><div class="ttdeci">void delete_free_surface_elements()</div><div class="ttdef"><b>Definition</b> <a href="adaptive__interface_8cc_source.html#l00883">adaptive_interface.cc:883</a></div></div>
<div class="ttc" id="aclassRefineableRotatingCylinderProblem_html_aeb99a895bfdcceea6d13b41df7a59545"><div class="ttname"><a href="classRefineableRotatingCylinderProblem.html#aeb99a895bfdcceea6d13b41df7a59545">RefineableRotatingCylinderProblem::Bulk_mesh_pt</a></div><div class="ttdeci">RefineableCylinderAndInterfaceMesh&lt; ELEMENT &gt; * Bulk_mesh_pt</div><div class="ttdef"><b>Definition</b> <a href="adaptive__interface_8cc_source.html#l00768">adaptive_interface.cc:768</a></div></div>
<div class="ttc" id="aclassRefineableRotatingCylinderProblem_html_af438026e310576c522706dbff92ee750"><div class="ttname"><a href="classRefineableRotatingCylinderProblem.html#af438026e310576c522706dbff92ee750">RefineableRotatingCylinderProblem::Point_mesh_pt</a></div><div class="ttdeci">Mesh * Point_mesh_pt</div><div class="ttdef"><b>Definition</b> <a href="adaptive__interface_8cc_source.html#l00774">adaptive_interface.cc:774</a></div></div>
<div class="ttc" id="aclassRefineableRotatingCylinderProblem_html_af559552a0c8cba56b883cd8b5b283b7f"><div class="ttname"><a href="classRefineableRotatingCylinderProblem.html#af559552a0c8cba56b883cd8b5b283b7f">RefineableRotatingCylinderProblem::actions_after_newton_solve</a></div><div class="ttdeci">void actions_after_newton_solve()</div><div class="ttdoc">Update the problem specs after solve (empty)</div><div class="ttdef"><b>Definition</b> <a href="adaptive__interface_8cc_source.html#l00749">adaptive_interface.cc:749</a></div></div>
<div class="ttc" id="aclassRefineableRotatingCylinderProblem_html_af914476e487ad5ed623384adb7c68c66"><div class="ttname"><a href="classRefineableRotatingCylinderProblem.html#af914476e487ad5ed623384adb7c68c66">RefineableRotatingCylinderProblem::actions_after_adapt</a></div><div class="ttdeci">void actions_after_adapt()</div><div class="ttdef"><b>Definition</b> <a href="adaptive__interface_8cc_source.html#l00761">adaptive_interface.cc:761</a></div></div>
<div class="ttc" id="anamespaceGlobal__Physical__Variables_html"><div class="ttname"><a href="namespaceGlobal__Physical__Variables.html">Global_Physical_Variables</a></div><div class="ttdoc">Namespace for physical parameters.</div><div class="ttdef"><b>Definition</b> <a href="adaptive__interface_8cc_source.html#l00040">adaptive_interface.cc:41</a></div></div>
<div class="ttc" id="anamespaceGlobal__Physical__Variables_html_a0d48e8726fa485de2b2df2d5031ec41b"><div class="ttname"><a href="namespaceGlobal__Physical__Variables.html#a0d48e8726fa485de2b2df2d5031ec41b">Global_Physical_Variables::wall_unit_normal_fct</a></div><div class="ttdeci">void wall_unit_normal_fct(const Vector&lt; double &gt; &amp;x, Vector&lt; double &gt; &amp;normal)</div><div class="ttdoc">Function that specifies the wall unit normal.</div><div class="ttdef"><b>Definition</b> <a href="adaptive__interface_8cc_source.html#l00050">adaptive_interface.cc:50</a></div></div>
<div class="ttc" id="anamespaceGlobal__Physical__Variables_html_a3962c36313826b19f216f6bbbdd6a477"><div class="ttname"><a href="namespaceGlobal__Physical__Variables.html#a3962c36313826b19f216f6bbbdd6a477">Global_Physical_Variables::Nu</a></div><div class="ttdeci">double Nu</div><div class="ttdoc">Pseudo-solid Poisson ratio.</div><div class="ttdef"><b>Definition</b> <a href="adaptive__interface_8cc_source.html#l00044">adaptive_interface.cc:44</a></div></div>
<div class="ttc" id="anamespaceGlobal__Physical__Variables_html_a5feb3df21fc4a0adefadecb8a8ed98d7"><div class="ttname"><a href="namespaceGlobal__Physical__Variables.html#a5feb3df21fc4a0adefadecb8a8ed98d7">Global_Physical_Variables::Wall_normal</a></div><div class="ttdeci">Vector&lt; double &gt; Wall_normal</div><div class="ttdoc">Direction of the wall normal vector.</div><div class="ttdef"><b>Definition</b> <a href="adaptive__interface_8cc_source.html#l00047">adaptive_interface.cc:47</a></div></div>
</div><!-- fragment --><hr  />
 <hr  />
 <h1><a class="anchor" id="pdf"></a>
PDF file</h1>
<p>A <a href="../latex/refman.pdf">pdf version</a> of this document is available. \ </p>
</div></div><!-- PageDoc -->
</div><!-- contents -->

    <!-- jQuery for Bootstrap and Doxygen -->
    <script src="../../../js/jquery-1.12.0.min.js"></script>
    <!-- Minified boostrap plugins-->
    <script src="../../../js/bootstrap.js"></script>
    <!-- Doxygen dependency to add powertips to source code-->
    <script src="../../../js/jquery.powertip.min.js"></script>
    <!-- The  following script is generated by doxygen and hides/shows levels in 
         the data structure lists and adds powertips to source code-->
    <script src="../../../js/dynsections.js" ></script>
    <!-- add to Doxygen's class names so bootstrap css and js recognises them-->
    <script type="text/javascript">
    $(".contents").addClass("container");
    $(".header").addClass("container");
    $(".navpath").addClass("container");
    $("#navrow3").addClass("container");
    $("#navrow4").addClass("container");
    $(".mlabel").addClass("label");
    $(".mlabel").addClass("label-default");
    $(".memitem").addClass("panel");
    $(".memitem").addClass("panel-info");
    $(".memproto").addClass("panel-heading");
    $(".memdoc").addClass("panel-body");
    </script>
    <footer>
      <div class="container">
        <div class="text-muted" style="float:right;">Generated by <a href="http://www.doxygen.org/index.html">
          <img style="height:18px;" class="footer-img" src="doxygen.png" alt="doxygen"></a> on Tue Jan 13 2026 16:19:54
        </div>
      </div>
    </footer>
</body>
</html>

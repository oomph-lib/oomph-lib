<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
<title>oomph-lib: collapsible_channel_algebraic.cc Source File</title>
<link rel="apple-touch-icon" sizes="57x57" href="../../../figures/apple-touch-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="../../../figures/apple-touch-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="../../../figures/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="../../../figures/apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="../../../figures/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="../../../figures/apple-touch-icon-120x120.png">
<link rel="icon" type="image/png" href="../../../figures/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="../../../figures/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="../../../figures/favicon-16x16.png" sizes="16x16">
<link rel="manifest" href="../../../figures/manifest.json">
<link rel="mask-icon" href="../../../figures/safari-pinned-tab.svg" color="#008000">
<link rel="shortcut icon" href="../../../figures/favicon.ico">
<meta name="msapplication-TileColor" content="#00a300">
<meta name="msapplication-config" content="../../../figures/browserconfig.xml">
<meta name="theme-color" content="#008000">
<link href="http://fonts.googleapis.com/css?family=Open+Sans:400,300,600" rel="stylesheet" type="text/css">
<!-- Doxygen css-->
<!-- <link rel="stylesheet" type="text/css" href="doxygen.css"> -->
<!-- Bootstrap -->
<link href="../../../css/bootstrap.css" rel="stylesheet">
<!-- oomph-lib specific overrides -->
<link rel="stylesheet" type="text/css" href="../../../css/oomph_header.css">
</head>
<body>
<nav class="navbar navbar-default">
<div class="container">
<div class="container-fluid">
  <!-- Brand and toggle get grouped for better mobile display -->
  <div class="navbar-header">
    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
      <span class="sr-only">Toggle navigation</span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="../../../html/index.html"><img alt="oomph-lib" src="../../../figures/oomph_logo.png"></a>
  </div>
  <!-- Collect the nav links, forms, and other content for toggling -->
  <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
    <ul class="nav navbar-nav">          
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Documentation <span class="caret"></span></a>
        <ul class="dropdown-menu">
          <li class="dropdown-header">Big picture</li>
          <li><a href="../../../../doc/intro/html/index.html">The finite element method</a></li>
          <li><a href="../../../../doc/the_data_structure/html/index.html">The data structure</a></li>
          <li><a href="../../../../doc/quick_guide/html/index.html">Not-so-quick guide</a></li>
          <li><a href="../../../../doc/optimisation/html/index.html">Optimisation</a></li>
          <li><a href="../../../../doc/order_of_action_functions/html/index.html">Order of action functions</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Example codes and tutorials</li>
          <li><a href="../../../../doc/example_code_list/html/index.html">List of example codes and tutorials</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#meshes">Meshing</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#solvers">Solvers</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#parallel">MPI parallel processing</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#visualisation">Post-processing/visualisation</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Other</li>
          <li><a href="../../../../doc/change_log/html/index.html">Change log</a></li>
          <li><a href="../../../../doc/creating_doc/html/index.html">Creating documentation</a></li>
          <li><a href="../../../../doc/coding_conventions/html/index.html">Coding conventions</a></li>
          <li><a href="../../../../doc/index/html/index.html">Index</a></li>
          <li><a href="../../../../doc/FAQ/html/index.html">FAQ</a></li>
        </ul>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Get it <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../../doc/the_distribution/html/index.html">Installation guide</a></li>
            <li><a href="../../../../doc/subversion/html/index.html">Get code from subversion repository</a></li>
            <li><a href="../../../../doc/download/html/index.html">Get code as tar file</a></li>
            <li><a href="../../../../doc/copyright/html/index.html">Copyright</a></li>
          </ul>
        </li>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">About <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../../doc/people/html/index.html">People</a></li>            
            <li><a href="../../../../doc/contact/html/index.html">Contact/Get involved</a></li>
            <li><a href="../../../../doc/publications/html/index.html">Publications</a></li>
            <li><a href="../../../../doc/acknowledgements/html/index.html">Acknowledgements</a></li>
            <li><a href="../../../../doc/picture_show/index.html">Picture show</a></li>
          </ul>
        </li>
      </li>
    </ul>
    <ul class="nav navbar-nav navbar-right navbar-search">
      <form class="navbar-form" role="search" action="../../../../doc/search_results/html/index.html">
        <div class="input-group">
          <input type="text" class="form-control" placeholder="Search" name="q">
          <span class="input-group-btn">
            <button class="btn btn-default" type="submit">Go</button>
          </span>
        </div><!-- /input-group -->
       <!--<div class="form-group">
          <input type="text" class="form-control" placeholder="Search">
        </div>
        <button type="submit" class="btn btn-default">Submit</button>-->
      </form>
    </ul>
  </div><!-- /.navbar-collapse -->
</div><!-- /.container-fluid -->
</div>
</nav>
<!-- Generated by Doxygen 1.8.17 -->
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_ddb094a380b94394dbbcf95a63b535e6.html">demo_drivers</a></li><li class="navelem"><a class="el" href="dir_600eb748837abd3a599f824dcb8c690e.html">navier_stokes</a></li><li class="navelem"><a class="el" href="dir_725b0e3f7cd4adb2f63eb064b7b4beec.html">collapsible_channel</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">collapsible_channel_algebraic.cc</div>  </div>
</div><!--header-->
<div class="contents">
<a href="collapsible__channel__algebraic_8cc.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">//LIC// ====================================================================</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">//LIC// This file forms part of oomph-lib, the object-oriented, </span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">//LIC// multi-physics finite-element library, available </span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">//LIC// at http://www.oomph-lib.org.</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">//LIC// Copyright (C) 2006-2021 Matthias Heil and Andrew Hazel</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">//LIC// This library is free software; you can redistribute it and/or</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">//LIC// modify it under the terms of the GNU Lesser General Public</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">//LIC// License as published by the Free Software Foundation; either</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">//LIC// version 2.1 of the License, or (at your option) any later version.</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">//LIC// This library is distributed in the hope that it will be useful,</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">//LIC// but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">//LIC// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">//LIC// Lesser General Public License for more details.</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">//LIC// You should have received a copy of the GNU Lesser General Public</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">//LIC// License along with this library; if not, write to the Free Software</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">//LIC// Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">//LIC// 02110-1301  USA.</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">//LIC// The authors may be contacted at oomph-lib@maths.man.ac.uk.</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">//LIC//====================================================================</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160; </div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment">// Generic oomph-lib includes</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#include &quot;generic.h&quot;</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160; </div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment">// Generic oomph-lib includes</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#include &quot;navier_stokes.h&quot;</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160; </div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment">//Include the mesh</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="my__alg__channel__mesh_8h.html">my_alg_channel_mesh.h</a>&quot;</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160; </div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="keyword">using namespace </span>std;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160; </div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="keyword">using namespace </span><a class="code" href="namespaceoomph.html">oomph</a>;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160; </div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment">//==========start_of_BL_Squash =========================================</span><span class="comment"></span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment">/// Namespace to define the mapping [0,1] -&gt; [0,1] that re-distributes</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment">/// nodal points across the channel width.</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment"></span><span class="comment">//======================================================================</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespaceBL__Squash.html">BL_Squash</a></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;{</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment"> /// Boundary layer width</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="namespaceBL__Squash.html#a3c4183891049bca81f3a011db24fc579">Delta</a>=0.1;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment"> /// Fraction of points in boundary layer</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="namespaceBL__Squash.html#af84bda39008884cd2b01e630957573df">Fract_in_BL</a>=0.5;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment"> /// \short Mapping [0,1] -&gt; [0,1] that re-distributes</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment"> /// nodal points across the channel width</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="namespaceBL__Squash.html#a0fdaf7661591150041b7102dbe578cdc">squash_fct</a>(<span class="keyword">const</span> <span class="keywordtype">double</span>&amp; s)</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160; {</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  <span class="comment">// Default return</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  <span class="keywordtype">double</span> y=s;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  <span class="keywordflow">if</span> (s&lt;0.5*<a class="code" href="namespaceBL__Squash.html#af84bda39008884cd2b01e630957573df">Fract_in_BL</a>)</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;   {</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    y=<a class="code" href="namespaceBL__Squash.html#a3c4183891049bca81f3a011db24fc579">Delta</a>*2.0*s/<a class="code" href="namespaceBL__Squash.html#af84bda39008884cd2b01e630957573df">Fract_in_BL</a>;</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;   }</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (s&gt;1.0-0.5*<a class="code" href="namespaceBL__Squash.html#af84bda39008884cd2b01e630957573df">Fract_in_BL</a>)</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;   {</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    y=2.0*<a class="code" href="namespaceBL__Squash.html#a3c4183891049bca81f3a011db24fc579">Delta</a>/<a class="code" href="namespaceBL__Squash.html#af84bda39008884cd2b01e630957573df">Fract_in_BL</a>*s+1.0-2.0*<a class="code" href="namespaceBL__Squash.html#a3c4183891049bca81f3a011db24fc579">Delta</a>/<a class="code" href="namespaceBL__Squash.html#af84bda39008884cd2b01e630957573df">Fract_in_BL</a>;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;   }</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;   {</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    y=(1.0-2.0*<a class="code" href="namespaceBL__Squash.html#a3c4183891049bca81f3a011db24fc579">Delta</a>)/(1.0-<a class="code" href="namespaceBL__Squash.html#af84bda39008884cd2b01e630957573df">Fract_in_BL</a>)*s+</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;      (<a class="code" href="namespaceBL__Squash.html#a3c4183891049bca81f3a011db24fc579">Delta</a>-0.5*<a class="code" href="namespaceBL__Squash.html#af84bda39008884cd2b01e630957573df">Fract_in_BL</a>)/(1.0-<a class="code" href="namespaceBL__Squash.html#af84bda39008884cd2b01e630957573df">Fract_in_BL</a>);</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;   }</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160; </div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  <span class="keywordflow">return</span> y;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160; }</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;}<span class="comment">// end of BL_Squash</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160; </div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160; </div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160; </div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160; </div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160; </div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment">//===============start_of_oscillating_wall=================================</span><span class="comment"></span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="comment">/// Straight, horizontal channel wall at \f$ y=H \f$ deforms into an </span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="comment">/// oscillating parabola. The amplitude of the oscillation </span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="comment">/// \f$ A \f$ and its period is \f$ T \f$.</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="comment">/// The position vector to a point on the wall, parametrised by</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="comment">/// the Lagrangian coordinate \f$ \zeta \in [0,L]\f$, is therefore given by</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="comment">/// \f[ {\bf R}(\zeta,t) = </span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="comment">///   \left(</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="comment">///   \begin{array}{c}</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="comment">///   L_{up} + \zeta  \newline</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="comment">///   1 </span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="comment">///   \end{array}</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="comment">///   \right)</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="comment">///   + A</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment">///   \left(</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="comment">///   \begin{array}{l}</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="comment">///   - B \sin\left(\frac{2\pi}{L_{collapsible}}\zeta\right) \newline</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="comment">///   \left(\frac{2}{L_{collapsible}}\right)^2 \zeta \ (L-\zeta)</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="comment">///   \end{array}</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="comment">///   \right)   </span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="comment">///   \ \sin\left(\frac{2\pi t}{T}\right)</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="comment">///   \ {\cal R}(t)</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="comment">///  \f]</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="comment">/// The parameter \f$ B \f$ is zero by default. If it is set to a nonzero</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="comment">/// value, the material particles on the wall also perform some </span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="comment">/// horizontal motion. The &quot;ramp&quot; function </span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="comment">/// \f[ </span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="comment">/// {\cal R}(t) =  \left\{ </span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="comment">/// \begin{array}{ll}  </span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="comment">/// \frac{1}{2}(1-\cos(\pi t/T)) &amp; \mbox{for $t&lt;T$} \\ 1 &amp; \mbox{for $t \ge T$}</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="comment">/// \end{array} </span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="comment">/// \right.</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="comment">/// \f]</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="comment">/// provides a &quot;smooth&quot; startup of the oscillation. </span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="comment"></span><span class="comment">//=========================================================================</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="keyword">class </span><a class="code" href="classOscillatingWall.html">OscillatingWall</a> : <span class="keyword">public</span> GeomObject</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;{</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160; </div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="comment"> /// \short Constructor : It&#39;s a 2D object, parametrised by </span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="comment"> /// one Lagrangian coordinate. Arguments: height at ends, x-coordinate of </span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="comment"> /// left end, length, amplitude of deflection, period of oscillation, and</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="comment"> /// pointer to time object</span></div>
<div class="line"><a name="l00126"></a><span class="lineno"><a class="line" href="classOscillatingWall.html#a5ededc3d27eef5c4ef7e82ac5cdf6ff9">  126</a></span>&#160;<span class="comment"></span> <a class="code" href="classOscillatingWall.html#a5ededc3d27eef5c4ef7e82ac5cdf6ff9">OscillatingWall</a>(<span class="keyword">const</span> <span class="keywordtype">double</span>&amp; h, <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; x_left, <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; l, </div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;                 <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; a, <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; period, Time* time_pt) : </div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  GeomObject(1,2), H(h), Length(l), X_left(x_left), A(a), B(0.0), T(period), </div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  Time_pt(time_pt) </div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;  {}</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="comment"> /// Destructor:  Empty</span></div>
<div class="line"><a name="l00133"></a><span class="lineno"><a class="line" href="classOscillatingWall.html#adc35b40bdd733a244d6399d91fa20ade">  133</a></span>&#160;<span class="comment"></span> <a class="code" href="classOscillatingWall.html#adc35b40bdd733a244d6399d91fa20ade">~OscillatingWall</a>(){}</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="comment">///Access function to the amplitude</span></div>
<div class="line"><a name="l00136"></a><span class="lineno"><a class="line" href="classOscillatingWall.html#ae923c6a7abefe33efaf47a4b69d1b621">  136</a></span>&#160;<span class="comment"></span> <span class="keywordtype">double</span>&amp; <a class="code" href="classOscillatingWall.html#ae923c6a7abefe33efaf47a4b69d1b621">amplitude</a>(){<span class="keywordflow">return</span> A;}</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="comment">///Access function to the period</span></div>
<div class="line"><a name="l00139"></a><span class="lineno"><a class="line" href="classOscillatingWall.html#ac3e0098c026e23dd8be8ea29f6a9c101">  139</a></span>&#160;<span class="comment"></span> <span class="keywordtype">double</span>&amp; <a class="code" href="classOscillatingWall.html#ac3e0098c026e23dd8be8ea29f6a9c101">period</a>(){<span class="keywordflow">return</span> T;}</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="comment"> /// \short Position vector at Lagrangian coordinate zeta </span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="comment"> /// at time level t.</span></div>
<div class="line"><a name="l00143"></a><span class="lineno"><a class="line" href="classOscillatingWall.html#abb4ae7e556479d2980a56963bd8d4558">  143</a></span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classOscillatingWall.html#abb4ae7e556479d2980a56963bd8d4558">position</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; <a class="code" href="algebraic__collapsible__channel_8txt.html#a0dc44f34a836b7b9cdeda9a988c97756">t</a>, <span class="keyword">const</span> Vector&lt;double&gt;&amp;zeta, </div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;               Vector&lt;double&gt;&amp; r)<span class="keyword"> const</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;   <span class="keyword">using namespace </span>MathematicalConstants;</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160; </div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;   <span class="comment">// Smoothly ramp up the oscillation during the first period</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;   <span class="keywordtype">double</span> ramp=1.0;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;   <span class="keywordflow">if</span> (Time_pt-&gt;time(<a class="code" href="algebraic__collapsible__channel_8txt.html#a0dc44f34a836b7b9cdeda9a988c97756">t</a>)&lt;T)</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    {</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;     ramp=0.5*(1.0-cos(Pi*Time_pt-&gt;time(<a class="code" href="algebraic__collapsible__channel_8txt.html#a0dc44f34a836b7b9cdeda9a988c97756">t</a>)/T));</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    }</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;   </div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;   <span class="comment">// Position vector</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;   r[0] = zeta[0]+X_left </div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    -B*A*sin(2.0*3.14159*zeta[0]/Length)*</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    sin(2.0*Pi*(Time_pt-&gt;time(<a class="code" href="algebraic__collapsible__channel_8txt.html#a0dc44f34a836b7b9cdeda9a988c97756">t</a>))/T)*ramp;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160; </div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;   r[1] = H+A*((Length-zeta[0])*zeta[0])/pow(0.5*Length,2)*</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    sin(2.0*Pi*(Time_pt-&gt;time(<a class="code" href="algebraic__collapsible__channel_8txt.html#a0dc44f34a836b7b9cdeda9a988c97756">t</a>))/T)*ramp;</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160; </div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;  } <span class="comment">// end of &quot;unsteady&quot; version</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160; </div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="comment"> /// \short &quot;Current&quot; position vector at Lagrangian coordinate zeta </span></div>
<div class="line"><a name="l00167"></a><span class="lineno"><a class="line" href="classOscillatingWall.html#a5fce6728f975003d9e85f64c18ba7f55">  167</a></span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classOscillatingWall.html#a5fce6728f975003d9e85f64c18ba7f55">position</a>(<span class="keyword">const</span> Vector&lt;double&gt;&amp;zeta, Vector&lt;double&gt;&amp; r)<span class="keyword"> const</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;   position (0, zeta, r);</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;  }</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="comment"> /// Number of geometric Data in GeomObject: None.</span></div>
<div class="line"><a name="l00173"></a><span class="lineno"><a class="line" href="classOscillatingWall.html#ae3fa3ef50ef7e082b255ba8125373581">  173</a></span>&#160;<span class="comment"></span> <span class="keywordtype">unsigned</span> <a class="code" href="classOscillatingWall.html#ae3fa3ef50ef7e082b255ba8125373581">ngeom_data</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> 0;}              </div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160; </div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;<span class="comment"> /// Height at ends</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="comment"></span> <span class="keywordtype">double</span> H;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="comment"> /// Length</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="comment"></span> <span class="keywordtype">double</span> Length;</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="comment"> /// x-coordinate of left end</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="comment"></span> <span class="keywordtype">double</span> X_left;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="comment"> /// Amplitude of oscillation</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<span class="comment"></span> <span class="keywordtype">double</span> A;</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<span class="comment"> /// Relative amplitude of horizontal wall motion</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="comment"></span> <span class="keywordtype">double</span> B;</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="comment"> ///Period of the oscillations</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="comment"></span> <span class="keywordtype">double</span> T;</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="comment"> ///Pointer to the global time object</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="comment"></span> Time* Time_pt;</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160; </div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;}; <span class="comment">// end of oscillating wall</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160; </div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160; </div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160; </div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160; </div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="comment">//====start_of_Global_Physical_Variables================</span><span class="comment"></span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="comment">/// Namespace for phyical parameters</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="comment"></span><span class="comment">//======================================================</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespaceGlobal__Physical__Variables.html">Global_Physical_Variables</a></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;{<span class="comment"></span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="comment"> /// Reynolds number</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="namespaceGlobal__Physical__Variables.html#ab814e627d2eb5bc50318879d19ab16b9">Re</a>=50.0;</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="comment"> /// Womersley = Reynolds times Strouhal</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="namespaceGlobal__Physical__Variables.html#a085ee4bf968ffdd01a41b8c41864f907">ReSt</a>=50.0;</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="comment"> /// Default pressure on the left boundary</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="namespaceGlobal__Physical__Variables.html#ae1a493695b7f4619af32f405b0b28861">P_up</a>=0.0;</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="comment"> /// Traction required at the left boundary</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="namespaceGlobal__Physical__Variables.html#a0de42ee6d39e85c77c16a04c3a05f7a2">prescribed_traction</a>(<span class="keyword">const</span> <span class="keywordtype">double</span>&amp; <a class="code" href="algebraic__collapsible__channel_8txt.html#a0dc44f34a836b7b9cdeda9a988c97756">t</a>,</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;                          <span class="keyword">const</span> Vector&lt;double&gt;&amp; x,</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;                          <span class="keyword">const</span> Vector&lt;double&gt;&amp; n,</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;                          Vector&lt;double&gt;&amp; traction)</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160; {</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;  traction.resize(2);</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;  traction[0]=<a class="code" href="namespaceGlobal__Physical__Variables.html#ae1a493695b7f4619af32f405b0b28861">P_up</a>;</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;  traction[1]=0.0;</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160; } </div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160; </div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;} <span class="comment">// end of Global_Physical_Variables</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160; </div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160; </div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160; </div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="comment">//=======start_of_problem_class=======================================</span><span class="comment"></span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="comment">///Problem class</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="comment"></span><span class="comment">//====================================================================</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> ELEMENT&gt;</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;<span class="keyword">class </span><a class="code" href="classCollapsibleChannelProblem.html">CollapsibleChannelProblem</a> : <span class="keyword">public</span> Problem</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;{</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160; </div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160; public :</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="comment"> /// \short Constructor : the arguments are the number of elements,</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="comment"> /// the length of the domain and the amplitude and period of </span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="comment"> ///the oscillations</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="comment"></span> <a class="code" href="classCollapsibleChannelProblem.html">CollapsibleChannelProblem</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; nup, </div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;                           <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; ncollapsible,</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;                           <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; ndown,</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;                           <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; ny,</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;                           <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; lup,</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;                           <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; lcollapsible, </div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;                           <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; ldown,</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;                           <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; ly,</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;                           <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; amplitude,</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;                           <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; period);</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;<span class="comment"> /// Empty destructor</span></div>
<div class="line"><a name="l00256"></a><span class="lineno"><a class="line" href="classCollapsibleChannelProblem.html#a205e3e654d3205d1d55ac46e7b63ca9d">  256</a></span>&#160;<span class="comment"></span> <a class="code" href="classCollapsibleChannelProblem.html#a205e3e654d3205d1d55ac46e7b63ca9d">~CollapsibleChannelProblem</a>() {} </div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160; </div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160; </div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="preprocessor">#ifdef ADAPTIVE</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="comment"> /// Access function for the specific mesh</span></div>
<div class="line"><a name="l00262"></a><span class="lineno"><a class="line" href="classCollapsibleChannelProblem.html#abe1a38b5c84188910435874511a877f6">  262</a></span>&#160;<span class="comment"></span> <a class="code" href="classoomph_1_1MyRefineableAlgebraicCollapsibleChannelMesh.html">MyRefineableAlgebraicCollapsibleChannelMesh&lt;ELEMENT&gt;</a>* <a class="code" href="classCollapsibleChannelProblem.html#abe1a38b5c84188910435874511a877f6">bulk_mesh_pt</a>() </div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;  {</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160; </div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;   <span class="comment">// Upcast from pointer to the Mesh base class to the specific </span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;   <span class="comment">// element type that we&#39;re using here.</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;   <span class="keywordflow">return</span> <span class="keyword">dynamic_cast&lt;</span><a class="code" href="classoomph_1_1MyRefineableAlgebraicCollapsibleChannelMesh.html">MyRefineableAlgebraicCollapsibleChannelMesh&lt;ELEMENT&gt;</a>*<span class="keyword">&gt;</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    (Bulk_mesh_pt);</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160; </div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;  } <span class="comment">// end of access to bulk mesh</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160; </div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;<span class="comment"> /// Access function for the specific mesh</span></div>
<div class="line"><a name="l00275"></a><span class="lineno"><a class="line" href="classCollapsibleChannelProblem.html#a411441ab7ac76c04613b1a7f558a6621">  275</a></span>&#160;<span class="comment"></span> <a class="code" href="classoomph_1_1MyAlgebraicCollapsibleChannelMesh.html">MyAlgebraicCollapsibleChannelMesh&lt;ELEMENT&gt;</a>* <a class="code" href="classCollapsibleChannelProblem.html#a411441ab7ac76c04613b1a7f558a6621">bulk_mesh_pt</a>() </div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;  {</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160; </div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;   <span class="comment">// Upcast from pointer to the Mesh base class to the specific </span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;   <span class="comment">// element type that we&#39;re using here.</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;   <span class="keywordflow">return</span> <span class="keyword">dynamic_cast&lt;</span><a class="code" href="classoomph_1_1MyAlgebraicCollapsibleChannelMesh.html">MyAlgebraicCollapsibleChannelMesh&lt;ELEMENT&gt;</a>*<span class="keyword">&gt;</span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    (Bulk_mesh_pt);</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160; </div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;  } <span class="comment">// end of access to bulk mesh</span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160; </div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160; </div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;<span class="comment"> /// \short Update the problem specs before solve (empty) </span></div>
<div class="line"><a name="l00289"></a><span class="lineno"><a class="line" href="classCollapsibleChannelProblem.html#ad7597f95eb755184ec1f9581c713ff78">  289</a></span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classCollapsibleChannelProblem.html#ad7597f95eb755184ec1f9581c713ff78">actions_before_newton_solve</a>(){}</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;<span class="comment"> /// Update the problem after solve (empty)</span></div>
<div class="line"><a name="l00292"></a><span class="lineno"><a class="line" href="classCollapsibleChannelProblem.html#a34299672cba0f3c1db3901427eb4da4a">  292</a></span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classCollapsibleChannelProblem.html#a34299672cba0f3c1db3901427eb4da4a">actions_after_newton_solve</a>(){}</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;<span class="comment"> /// Update the velocity boundary condition on the moving wall</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> actions_before_implicit_timestep();</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="comment"> /// Actions before adapt: Wipe the mesh of prescribed traction elements</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> actions_before_adapt();</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;<span class="comment"> /// Actions after adapt: Rebuild the mesh of prescribed traction elements</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> actions_after_adapt();</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;<span class="comment"> /// Apply initial conditions</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> set_initial_condition();</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;<span class="comment"> /// Doc the solution</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> doc_solution(DocInfo&amp; doc_info, ofstream&amp; trace_file);</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160; </div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;private : </div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;<span class="comment"> /// Create the prescribed traction elements on boundary b</span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<span class="comment"> /// of the bulk mesh and stick them into the surface mesh.</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> create_traction_elements(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;b, </div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;                               Mesh* <span class="keyword">const</span> &amp;bulk_mesh_pt,</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;                               Mesh* <span class="keyword">const</span> &amp;surface_mesh_pt);</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="comment"> /// Delete prescribed traction elements from the surface mesh</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> delete_traction_elements(Mesh* <span class="keyword">const</span> &amp;surface_mesh_pt);</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;<span class="comment"> ///Number of elements in the x direction in the upstream part of the channel</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;<span class="comment"></span> <span class="keywordtype">unsigned</span> Nup;</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;<span class="comment"> /// \short Number of elements in the x direction in the &quot;collapsible&quot; </span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;<span class="comment"> /// part of the channel</span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;<span class="comment"></span> <span class="keywordtype">unsigned</span> Ncollapsible;</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;<span class="comment"> ///Number of elements in the x direction in the downstream part of the channel</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;<span class="comment"></span> <span class="keywordtype">unsigned</span> Ndown;</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;<span class="comment"> ///Number of elements across the channel</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;<span class="comment"></span> <span class="keywordtype">unsigned</span> Ny;</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;<span class="comment"> ///x-length in the upstream part of the channel</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="comment"></span> <span class="keywordtype">double</span> Lup;</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;<span class="comment"> ///x-length in the &quot;collapsible&quot; part of the channel</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;<span class="comment"></span> <span class="keywordtype">double</span> Lcollapsible;</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;<span class="comment"> ///x-length in the downstream part of the channel</span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;<span class="comment"></span> <span class="keywordtype">double</span> Ldown;</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;<span class="comment"> ///Transverse length</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;<span class="comment"></span> <span class="keywordtype">double</span> Ly;</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;<span class="comment"> ///Pointer to the geometric object that parametrises the &quot;collapsible&quot; wall</span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;<span class="comment"></span> <a class="code" href="classOscillatingWall.html">OscillatingWall</a>* Wall_pt;</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;<span class="comment"> /// Pointer to the &quot;bulk&quot; mesh</span></div>
<div class="line"><a name="l00349"></a><span class="lineno"><a class="line" href="classCollapsibleChannelProblem.html#a0c3c4c226afe7d14f6967ac6d28ff15f">  349</a></span>&#160;<span class="comment"></span> <a class="code" href="classoomph_1_1MyAlgebraicCollapsibleChannelMesh.html">MyAlgebraicCollapsibleChannelMesh&lt;ELEMENT&gt;</a>* <a class="code" href="classCollapsibleChannelProblem.html#a0c3c4c226afe7d14f6967ac6d28ff15f">Bulk_mesh_pt</a>;</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;<span class="comment"> /// \short Pointer to the &quot;surface&quot; mesh that contains the applied traction</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;<span class="comment"> /// elements</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;<span class="comment"></span> Mesh* Surface_mesh_pt; </div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;<span class="comment"> /// Pointer to the left control node</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;<span class="comment"></span> Node* Left_node_pt;</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;<span class="comment"> /// Pointer to right control node</span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;<span class="comment"></span> Node* Right_node_pt;</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;  </div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;}; <span class="comment">// end of problem class</span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160; </div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160; </div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160; </div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160; </div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;<span class="comment">//===start_of_constructor=======================================</span><span class="comment"></span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;<span class="comment">/// Constructor for the collapsible channel problem</span></div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;<span class="comment"></span><span class="comment">//===============================================================</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> ELEMENT&gt;</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;<a class="code" href="classCollapsibleChannelProblem.html#ab43fa30667f57e8019c8b30fd93156f8">CollapsibleChannelProblem&lt;ELEMENT&gt;::CollapsibleChannelProblem</a>(</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160; <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; nup, </div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160; <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; ncollapsible,</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160; <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; ndown,</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160; <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; ny,</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160; <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; lup,</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160; <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; lcollapsible, </div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160; <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; ldown,</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160; <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; ly,</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160; <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; amplitude,</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160; <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; period)</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;{</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160; <span class="comment">// Number of elements</span></div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160; Nup=nup;</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160; Ncollapsible=ncollapsible;</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160; Ndown=ndown;</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160; Ny=ny;</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160; </div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160; <span class="comment">// Lengths of domain</span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160; Lup=lup;</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160; Lcollapsible=lcollapsible;</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160; Ldown=ldown;</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160; Ly=ly;</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160; </div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160; <span class="comment">// Overwrite maximum allowed residual to accomodate possibly</span></div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160; <span class="comment">// poor initial guess for solution</span></div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160; Problem::Max_residuals=10000;</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160; </div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160; <span class="comment">// Allocate the timestepper -- this constructs the Problem&#39;s </span></div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160; <span class="comment">// time object with a sufficient amount of storage to store the</span></div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160; <span class="comment">// previous timsteps. </span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160; add_time_stepper_pt(<span class="keyword">new</span> BDF&lt;2&gt;);</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160; </div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160; <span class="comment">// Parameters for wall object</span></div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160; <span class="keywordtype">double</span> height=ly;</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160; <span class="keywordtype">double</span> length=lcollapsible;</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160; <span class="keywordtype">double</span> x_left=lup;</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160; </div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160; <span class="comment">//Create the geometric object that represents the wall</span></div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160; Wall_pt=<span class="keyword">new</span> <a class="code" href="classOscillatingWall.html">OscillatingWall</a>(height, x_left, length, amplitude, period,</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;                             time_pt());</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160; </div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;<span class="preprocessor">#ifdef ADAPTIVE</span></div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160; </div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160; <span class="comment">// Build mesh </span></div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160; Bulk_mesh_pt = <span class="keyword">new</span> <a class="code" href="classoomph_1_1MyRefineableAlgebraicCollapsibleChannelMesh.html">MyRefineableAlgebraicCollapsibleChannelMesh&lt;ELEMENT&gt;</a>(</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;  nup, ncollapsible, ndown, ny,</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;  lup, lcollapsible, ldown, ly,</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;  Wall_pt,</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;#ifdef USE_BL_SQUASH_FCT</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;  &amp;<a class="code" href="namespaceBL__Squash.html#a0fdaf7661591150041b7102dbe578cdc">BL_Squash::squash_fct</a>,</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;#endif</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;  time_stepper_pt());</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160; </div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160; </div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160; <span class="comment">// Build mesh </span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160; Bulk_mesh_pt = <span class="keyword">new</span> <a class="code" href="classoomph_1_1MyAlgebraicCollapsibleChannelMesh.html">MyAlgebraicCollapsibleChannelMesh&lt;ELEMENT&gt;</a>(</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;  nup, ncollapsible, ndown, ny,</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;  lup, lcollapsible, ldown, ly,</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;  Wall_pt,</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;#ifdef USE_BL_SQUASH_FCT</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;  &amp;<a class="code" href="namespaceBL__Squash.html#a0fdaf7661591150041b7102dbe578cdc">BL_Squash::squash_fct</a>,</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;#endif</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;  time_stepper_pt());</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160; </div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160; </div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160; </div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160; <span class="comment">// Create &quot;surface mesh&quot; that will contain only the prescribed-traction </span></div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160; <span class="comment">// elements at the inflow. The default constructor just creates the mesh </span></div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160; <span class="comment">// without giving it any elements, nodes, etc.</span></div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160; Surface_mesh_pt = <span class="keyword">new</span> Mesh;</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160; </div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160; <span class="comment">// Create prescribed-traction elements from all elements that are </span></div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160; <span class="comment">// adjacent to boundary 5 (inflow boundary), and add them to the surface mesh.</span></div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160; create_traction_elements(5,Bulk_mesh_pt,Surface_mesh_pt);</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160; </div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160; <span class="comment">// Add the two sub meshes to the problem</span></div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160; add_sub_mesh(Bulk_mesh_pt);</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160; add_sub_mesh(Surface_mesh_pt);</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160; </div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160; <span class="comment">// Combine all submeshes added so far into a single Mesh</span></div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160; build_global_mesh();</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160; </div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160; </div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;<span class="preprocessor">#ifdef ADAPTIVE</span></div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160; </div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160; <span class="comment">//Set errror estimator  for bulk mesh</span></div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160; Z2ErrorEstimator* error_estimator_pt=<span class="keyword">new</span> Z2ErrorEstimator;</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160; <span class="keyword">dynamic_cast&lt;</span><a class="code" href="classoomph_1_1MyRefineableAlgebraicCollapsibleChannelMesh.html">MyRefineableAlgebraicCollapsibleChannelMesh&lt;ELEMENT&gt;</a>*<span class="keyword">&gt;</span></div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;  (Bulk_mesh_pt)-&gt;spatial_error_estimator_pt()=error_estimator_pt;</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160; </div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160; </div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160; <span class="comment">// Loop over the elements to set up element-specific </span></div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160; <span class="comment">// things that cannot be handled by constructor</span></div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160; <span class="keywordtype">unsigned</span> n_element=Bulk_mesh_pt-&gt;nelement();</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160; <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> e=0;e&lt;n_element;e++)</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;  {</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;   <span class="comment">// Upcast from GeneralisedElement to the present element</span></div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;   ELEMENT* el_pt = <span class="keyword">dynamic_cast&lt;</span>ELEMENT*<span class="keyword">&gt;</span>(Bulk_mesh_pt-&gt;element_pt(e));</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;   </div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;   <span class="comment">//Set the Reynolds number</span></div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;   el_pt-&gt;re_pt() = &amp;<a class="code" href="namespaceGlobal__Physical__Variables.html#ab814e627d2eb5bc50318879d19ab16b9">Global_Physical_Variables::Re</a>;</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160; </div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;   <span class="comment">// Set the Womersley number</span></div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;   el_pt-&gt;re_st_pt() = &amp;<a class="code" href="namespaceGlobal__Physical__Variables.html#a085ee4bf968ffdd01a41b8c41864f907">Global_Physical_Variables::ReSt</a>;</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;   </div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;  } <span class="comment">// end loop over bulk elements</span></div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160; </div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160; </div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160; </div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;  <span class="comment">// Loop over the traction elements to pass pointer to prescribed </span></div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;  <span class="comment">// traction function</span></div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;  <span class="keywordtype">unsigned</span> n_el=Surface_mesh_pt-&gt;nelement();</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> e=0;e&lt;n_el;e++)</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;   {</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    <span class="comment">// Upcast from GeneralisedElement to NavierStokes traction element</span></div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    NavierStokesTractionElement&lt;ELEMENT&gt; *el_pt = </div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;     <span class="keyword">dynamic_cast&lt;</span> NavierStokesTractionElement&lt;ELEMENT&gt;*<span class="keyword">&gt;</span>(</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;      Surface_mesh_pt-&gt;element_pt(e));</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    </div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    <span class="comment">// Set the pointer to the prescribed traction function</span></div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    el_pt-&gt;traction_fct_pt() = &amp;<a class="code" href="namespaceGlobal__Physical__Variables.html#a0de42ee6d39e85c77c16a04c3a05f7a2">Global_Physical_Variables::prescribed_traction</a>;</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    </div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;   }  <span class="comment">// end loop over applied traction elements</span></div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160; </div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;  </div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;  </div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160; </div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160; <span class="comment">//Pin the velocity on the boundaries</span></div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160; <span class="comment">//x and y-velocities pinned along boundary 0 (bottom boundary) :</span></div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160; <span class="keywordtype">unsigned</span> ibound=0; </div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160; <span class="keywordtype">unsigned</span> num_nod= bulk_mesh_pt()-&gt;nboundary_node(ibound);</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160; <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> inod=0;inod&lt;num_nod;inod++)</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;  {</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i=0;i&lt;2;i++)</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    {</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;     bulk_mesh_pt()-&gt;boundary_node_pt(ibound, inod)-&gt;pin(i);</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    }</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;  }</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160; </div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160; </div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;  <span class="comment">//x and y-velocities pinned along boundary 2, 3, 4 (top boundaries) :</span></div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160; <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> ib=2;ib&lt;5;ib++)</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;  { </div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;   num_nod= bulk_mesh_pt()-&gt;nboundary_node(ib);</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> inod=0;inod&lt;num_nod;inod++)</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;    {</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i=0;i&lt;2;i++)</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;      {</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;       bulk_mesh_pt()-&gt;boundary_node_pt(ib, inod)-&gt;pin(i);</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;      }</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;    }</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;  }</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160; </div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;   <span class="comment">//y-velocity pinned along boundary 1 (right boundary):</span></div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;  ibound=1; </div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;  num_nod= bulk_mesh_pt()-&gt;nboundary_node(ibound);</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> inod=0;inod&lt;num_nod;inod++)</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;   {</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;    bulk_mesh_pt()-&gt;boundary_node_pt(ibound, inod)-&gt;pin(1);</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;   }</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160; </div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160; </div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;  <span class="comment">//y-velocity pinned along boundary 5 (left boundary):</span></div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;  ibound=5; </div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;  num_nod= bulk_mesh_pt()-&gt;nboundary_node(ibound);</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> inod=0;inod&lt;num_nod;inod++)</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;   {</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;    bulk_mesh_pt()-&gt;boundary_node_pt(ibound, inod)-&gt;pin(1);</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;   }<span class="comment">// end of pin_velocity</span></div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160; </div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160; </div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160; </div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;  <span class="comment">//Select control nodes &quot;half way&quot; up the inflow/outflow cross-sections</span></div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;  <span class="comment">//--------------------------------------------------------------------</span></div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;  </div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;  <span class="comment">// Left boundary</span></div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;  ibound=5; </div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;  num_nod= bulk_mesh_pt()-&gt;nboundary_node(ibound);</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;  <span class="keywordtype">unsigned</span> control_nod=num_nod/2;</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;  Left_node_pt= bulk_mesh_pt()-&gt;boundary_node_pt(ibound, control_nod);</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;  </div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;  <span class="comment">// Right boundary</span></div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;  ibound=1; </div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;  num_nod= bulk_mesh_pt()-&gt;nboundary_node(ibound);</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;  control_nod=num_nod/2;</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;  Right_node_pt= bulk_mesh_pt()-&gt;boundary_node_pt(ibound, control_nod);</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;  </div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;  <span class="comment">// Setup equation numbering scheme</span></div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;  cout &lt;&lt;<span class="stringliteral">&quot;Number of equations: &quot;</span> &lt;&lt; assign_eqn_numbers() &lt;&lt; std::endl; </div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;  </div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;} <span class="comment">//end of constructor</span></div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160; </div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160; </div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160; </div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160; </div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;<span class="comment">//====start_of_doc_solution===================================================</span><span class="comment"></span></div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;<span class="comment">/// Doc the solution</span></div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;<span class="comment"></span><span class="comment">//============================================================================</span></div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> ELEMENT&gt;</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classCollapsibleChannelProblem.html#afc4af9796c01d904d4074bd5bbfc5b9b">CollapsibleChannelProblem&lt;ELEMENT&gt;:: doc_solution</a>(DocInfo&amp; doc_info, </div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;                                                       ofstream&amp; trace_file)</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;{ </div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160; ofstream some_file;</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160; <span class="keywordtype">char</span> filename[100];</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160; </div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160; <span class="comment">// Number of plot points</span></div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160; <span class="keywordtype">unsigned</span> npts;</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160; npts=5; </div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160; </div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160; <span class="comment">// Output solution </span></div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160; sprintf(filename,<span class="stringliteral">&quot;%s/soln%i.dat&quot;</span>,doc_info.directory().c_str(),</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;         doc_info.number());</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160; some_file.open(filename);</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160; bulk_mesh_pt()-&gt;output(some_file,npts);</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160; some_file.close();</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160; </div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160; </div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160; <span class="comment">// Get the position of the midpoint on the geometric object</span></div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160; Vector&lt;double&gt; zeta(1);</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160; zeta[0]=0.5*Lcollapsible;</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160; Vector&lt;double&gt; wall_point(2);</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160; Wall_pt-&gt;position(zeta,wall_point);</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160; </div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160; <span class="comment">// Write trace file</span></div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160; trace_file &lt;&lt; time_pt()-&gt;time() &lt;&lt; <span class="stringliteral">&quot; &quot;</span> </div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;            &lt;&lt; wall_point[1]  &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;            &lt;&lt; Left_node_pt-&gt;value(0) &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;            &lt;&lt; Right_node_pt-&gt;value(0) &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;            &lt;&lt; std::endl;</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160; </div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160; <span class="comment">// Output wall shape</span></div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160; sprintf(filename,<span class="stringliteral">&quot;%s/wall%i.dat&quot;</span>,doc_info.directory().c_str(),</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;         doc_info.number());</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160; some_file.open(filename);</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160; <span class="keywordtype">unsigned</span> nplot=100; </div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160; <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i=0;i&lt;nplot;i++)</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;  {</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;   zeta[0]=double(i)/double(nplot-1)*Lcollapsible;</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;   Wall_pt-&gt;position(zeta,wall_point);</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;   some_file &lt;&lt; wall_point[0]  &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;             &lt;&lt; wall_point[1]  &lt;&lt; std::endl;</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;  }</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160; some_file.close();</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160; </div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;} <span class="comment">// end_of_doc_solution</span></div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160; </div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160; </div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160; </div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160; </div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;<span class="comment">//==========start_of_create_traction_elements==================================</span><span class="comment"></span></div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;<span class="comment">/// Create the traction elements</span></div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;<span class="comment"></span><span class="comment">//============================================================================</span></div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> ELEMENT&gt;</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classCollapsibleChannelProblem.html#a70cfe97c12c0cb6a2a81266cdd4d6088">CollapsibleChannelProblem&lt;ELEMENT&gt;::create_traction_elements</a>(</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160; <span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;b, Mesh* <span class="keyword">const</span> &amp;bulk_mesh_pt, Mesh* <span class="keyword">const</span> &amp;surface_mesh_pt)</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;{</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160; <span class="comment">// How many bulk elements are adjacent to boundary b?</span></div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160; <span class="keywordtype">unsigned</span> n_element = bulk_mesh_pt-&gt;nboundary_element(b);</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160; </div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160; <span class="comment">// Loop over the bulk elements adjacent to boundary b</span></div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160; <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> e=0;e&lt;n_element;e++)</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;  {</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;   <span class="comment">// Get pointer to the bulk element that is adjacent to boundary b</span></div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;   ELEMENT* bulk_elem_pt = <span class="keyword">dynamic_cast&lt;</span>ELEMENT*<span class="keyword">&gt;</span></div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;    (bulk_mesh_pt-&gt;boundary_element_pt(b,e));</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;   </div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;   <span class="comment">//What is the index of the face of element e that lies along boundary b</span></div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;   <span class="keywordtype">int</span> face_index = bulk_mesh_pt-&gt;face_index_at_boundary(b,e);</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160; </div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;   <span class="comment">// Build the corresponding prescribed-traction element</span></div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;   NavierStokesTractionElement&lt;ELEMENT&gt;* traction_element_pt = </div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;    <span class="keyword">new</span>  NavierStokesTractionElement&lt;ELEMENT&gt;(bulk_elem_pt,face_index);</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;   </div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;   <span class="comment">//Add the prescribed-flux element to the surface mesh</span></div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;   surface_mesh_pt-&gt;add_element_pt(traction_element_pt);</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160; </div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;  } <span class="comment">//end of loop over bulk elements adjacent to boundary b</span></div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160; </div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;} <span class="comment">// end of create_traction_elements</span></div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160; </div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160; </div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;<span class="comment">//============start_of_delete_traction_elements==============================</span><span class="comment"></span></div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;<span class="comment">/// Delete traction elements and wipe the surface mesh</span></div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;<span class="comment"></span><span class="comment">//=======================================================================</span></div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> ELEMENT&gt;</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classCollapsibleChannelProblem.html#a6a5324dd1efb8c517a7e4d431b10fca4">CollapsibleChannelProblem&lt;ELEMENT&gt;::</a></div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;<a class="code" href="classCollapsibleChannelProblem.html#a6a5324dd1efb8c517a7e4d431b10fca4">delete_traction_elements</a>(Mesh* <span class="keyword">const</span> &amp;surface_mesh_pt)</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;{</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160; <span class="comment">// How many surface elements are in the surface mesh</span></div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160; <span class="keywordtype">unsigned</span> n_element = surface_mesh_pt-&gt;nelement();</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160; </div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160; <span class="comment">// Loop over the surface elements</span></div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160; <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> e=0;e&lt;n_element;e++)</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;  {</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;   <span class="comment">// Kill surface element</span></div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;   <span class="keyword">delete</span> surface_mesh_pt-&gt;element_pt(e);</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;  }</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160; </div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160; <span class="comment">// Wipe the mesh</span></div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160; surface_mesh_pt-&gt;flush_element_and_node_storage();</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160; </div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;} <span class="comment">// end of delete_traction_elements</span></div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160; </div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160; </div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160; </div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;<span class="comment">//=======start_of_apply_initial_conditions===================================</span><span class="comment"></span></div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;<span class="comment">/// Apply initial conditions: Impulsive start from steady Poiseuille</span></div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;<span class="comment">//============================================================================</span></div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> ELEMENT&gt;</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classCollapsibleChannelProblem.html#a646147fb75669cfcc5bb56ee79d9b8da">CollapsibleChannelProblem&lt;ELEMENT&gt;::set_initial_condition</a>()</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;{ </div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160; </div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160; <span class="comment">// Check that timestepper is from the BDF family</span></div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160; <span class="keywordflow">if</span> (time_stepper_pt()-&gt;type()!=<span class="stringliteral">&quot;BDF&quot;</span>)</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;  {</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;   std::ostringstream error_stream;</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;   error_stream </div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;    &lt;&lt; <span class="stringliteral">&quot;Timestepper has to be from the BDF family!\n&quot;</span></div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;    &lt;&lt; <span class="stringliteral">&quot;You have specified a timestepper from the &quot;</span></div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;    &lt;&lt; time_stepper_pt()-&gt;type() &lt;&lt; <span class="stringliteral">&quot; family&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160; </div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;   <span class="keywordflow">throw</span> OomphLibError(error_stream.str(),</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;                       OOMPH_CURRENT_FUNCTION,</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;                       OOMPH_EXCEPTION_LOCATION);</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;  }</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160; </div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160; <span class="comment">// Update the mesh</span></div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160; bulk_mesh_pt()-&gt;node_update();</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160; </div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160; <span class="comment">// Loop over the nodes to set initial guess everywhere</span></div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160; <span class="keywordtype">unsigned</span> num_nod = bulk_mesh_pt()-&gt;nnode();</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160; <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> n=0;n&lt;num_nod;n++)</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;  {</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;   <span class="comment">// Get nodal coordinates</span></div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;   Vector&lt;double&gt; x(2);</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;   x[0]=bulk_mesh_pt()-&gt;node_pt(n)-&gt;x(0);</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;   x[1]=bulk_mesh_pt()-&gt;node_pt(n)-&gt;x(1);</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;   </div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;   <span class="comment">// Assign initial condition: Steady Poiseuille flow</span></div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;   bulk_mesh_pt()-&gt;node_pt(n)-&gt;set_value(0,6.0*(x[1]/Ly)*(1.0-(x[1]/Ly)));</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;   bulk_mesh_pt()-&gt;node_pt(n)-&gt;set_value(1,0.0);</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;  } </div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160; </div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160; <span class="comment">// Assign initial values for an impulsive start</span></div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160; bulk_mesh_pt()-&gt;assign_initial_values_impulsive();</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160; </div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160; </div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;} <span class="comment">// end of set_initial_condition</span></div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160; </div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160; </div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160; </div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;<span class="comment">//=====start_of_actions_before_implicit_timestep==============================</span><span class="comment"></span></div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;<span class="comment">/// Execute the actions before timestep: Update the velocity</span></div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;<span class="comment">/// boundary condition on the moving wall</span></div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;<span class="comment"></span><span class="comment">//============================================================================</span></div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> ELEMENT&gt;</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classCollapsibleChannelProblem.html#a4c365050b11c184007b8e1cd6079147f">CollapsibleChannelProblem&lt;ELEMENT&gt;::actions_before_implicit_timestep</a>()</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;{</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160; <span class="comment">// Update the domain shape</span></div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160; bulk_mesh_pt()-&gt;node_update();</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160; </div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160; <span class="comment">// Moving wall: No slip; this implies that the velocity needs</span></div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160; <span class="comment">// to be updated in response to wall motion</span></div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160; <span class="keywordtype">unsigned</span> ibound=3;</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160; <span class="keywordtype">unsigned</span> num_nod=bulk_mesh_pt()-&gt;nboundary_node(ibound);</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> inod=0;inod&lt;num_nod;inod++)</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;  {</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;   <span class="comment">// Which node are we dealing with?</span></div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;   Node* <a class="code" href="algebraic__collapsible__channel_8txt.html#a788a9986732a5f0588dc91417ffacde6">node_pt</a>=bulk_mesh_pt()-&gt;boundary_node_pt(ibound,inod);</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;   </div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;   <span class="comment">// Apply no slip</span></div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;   FSI_functions::apply_no_slip_on_moving_wall(<a class="code" href="algebraic__collapsible__channel_8txt.html#a788a9986732a5f0588dc91417ffacde6">node_pt</a>);</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;  }</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;} <span class="comment">//end of actions_before_implicit_timestep</span></div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160; </div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160; </div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160; </div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160; </div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;<span class="comment">//=========start_of_actions_before_adapt==================================</span><span class="comment"></span></div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;<span class="comment">/// Actions before adapt: Wipe the mesh of prescribed traction elements</span></div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;<span class="comment"></span><span class="comment">//========================================================================</span></div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> ELEMENT&gt;</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classCollapsibleChannelProblem.html#a54abc5259d590154e5dfa458d885c16c">CollapsibleChannelProblem&lt;ELEMENT&gt;::actions_before_adapt</a>()</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;{</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160; <span class="comment">// Kill the traction elements and wipe surface mesh</span></div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160; delete_traction_elements(Surface_mesh_pt);</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160; </div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160; <span class="comment">// Rebuild the global mesh. </span></div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160; rebuild_global_mesh();</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160; </div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;} <span class="comment">// end of actions_before_adapt</span></div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160; </div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160; </div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;<span class="comment">//==========start_of_actions_after_adapt==================================</span><span class="comment"></span></div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;<span class="comment">/// Actions after adapt: Rebuild the mesh of prescribed traction elements</span></div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;<span class="comment"></span><span class="comment">//========================================================================</span></div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> ELEMENT&gt;</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classCollapsibleChannelProblem.html#a3ea01d83f0256c588a652741c6c33e0e">CollapsibleChannelProblem&lt;ELEMENT&gt;::actions_after_adapt</a>()</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;{</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160; <span class="comment">// Create prescribed-flux elements from all elements that are </span></div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160; <span class="comment">// adjacent to boundary 5 and add them to surface mesh</span></div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160; create_traction_elements(5,Bulk_mesh_pt,Surface_mesh_pt);</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160; </div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160; <span class="comment">// Rebuild the global mesh</span></div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160; rebuild_global_mesh();</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160; </div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160; <span class="comment">// Loop over the traction elements to pass pointer to prescribed </span></div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160; <span class="comment">// traction function</span></div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160; <span class="keywordtype">unsigned</span> n_element=Surface_mesh_pt-&gt;nelement();</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160; <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> e=0;e&lt;n_element;e++)</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;  {</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;   <span class="comment">// Upcast from GeneralisedElement to NavierStokesTractionElement element</span></div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;   NavierStokesTractionElement&lt;ELEMENT&gt; *el_pt = </div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;    <span class="keyword">dynamic_cast&lt;</span>NavierStokesTractionElement&lt;ELEMENT&gt;*<span class="keyword">&gt;</span>(</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;     Surface_mesh_pt-&gt;element_pt(e));</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;   </div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;   <span class="comment">// Set the pointer to the prescribed traction function</span></div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;   el_pt-&gt;traction_fct_pt() = &amp;<a class="code" href="namespaceGlobal__Physical__Variables.html#a0de42ee6d39e85c77c16a04c3a05f7a2">Global_Physical_Variables::prescribed_traction</a>;</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;  }</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;} <span class="comment">// end of actions_after_adapt</span></div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160; </div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160; </div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160; </div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;<span class="comment">//=======start_of_driver_code==================================================</span><span class="comment"></span></div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;<span class="comment">/// Driver code for an unsteady adaptive collapsible channel problem</span></div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;<span class="comment">/// with prescribed wall motion. Presence of command line arguments</span></div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;<span class="comment">/// indicates validation run with coarse resolution and small number of</span></div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;<span class="comment">/// timesteps.</span></div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;<span class="comment"></span><span class="comment">//=============================================================================</span></div>
<div class="line"><a name="l00804"></a><span class="lineno"><a class="line" href="collapsible__channel__algebraic_8cc.html#a0ddf1224851353fc92bfbff6f499fa97">  804</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="collapsible__channel__algebraic_8cc.html#a0ddf1224851353fc92bfbff6f499fa97">main</a>(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>* argv[])</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;{</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160; </div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160; <span class="comment">// Store command line arguments</span></div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160; CommandLineArgs::setup(argc,argv);</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;  </div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160; <span class="comment">// Reduction in resolution for validation run?</span></div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160; <span class="keywordtype">unsigned</span> coarsening_factor=1;</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160; <span class="keywordflow">if</span> (CommandLineArgs::Argc&gt;1)</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;  {</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;   coarsening_factor=4;</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;  }</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160; </div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160; <span class="comment">// Number of elements in the domain</span></div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160; <span class="keywordtype">unsigned</span> nup=20/coarsening_factor;</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160; <span class="keywordtype">unsigned</span> ncollapsible=40/coarsening_factor;</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160; <span class="keywordtype">unsigned</span> ndown=40/coarsening_factor;</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160; <span class="keywordtype">unsigned</span> ny=16/coarsening_factor;</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160; </div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160; <span class="comment">// Length of the domain</span></div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160; <span class="keywordtype">double</span> lup=5.0;</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160; <span class="keywordtype">double</span> lcollapsible=10.0;</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160; <span class="keywordtype">double</span> ldown=10.0;</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160; <span class="keywordtype">double</span> ly=1.0;</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160; </div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160; <span class="comment">// Initial amplitude of the wall deformation</span></div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160; <span class="keywordtype">double</span> amplitude=1.0e-2; <span class="comment">// ADJUST </span></div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;  </div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160; <span class="comment">// Period of oscillation</span></div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160; <span class="keywordtype">double</span> period=0.45;</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160; </div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160; <span class="comment">// Pressure/applied traction on the left boundary: This is consistent with </span></div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160; <span class="comment">// steady Poiseuille flow</span></div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160; <a class="code" href="namespaceGlobal__Physical__Variables.html#ae1a493695b7f4619af32f405b0b28861">Global_Physical_Variables::P_up</a>=12.0*(lup+lcollapsible+ldown);</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160; </div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160; </div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160; <span class="comment">//Set output directory</span></div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160; DocInfo doc_info;</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160; doc_info.set_directory(<span class="stringliteral">&quot;RESLT&quot;</span>);</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160; </div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160; <span class="comment">// Open a trace file </span></div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160; ofstream trace_file;</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160; <span class="keywordtype">char</span> filename[100];   </div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160; sprintf(filename,<span class="stringliteral">&quot;%s/trace.dat&quot;</span>,doc_info.directory().c_str());</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160; trace_file.open(filename);</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160; </div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160; </div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;<span class="preprocessor">#ifdef ADAPTIVE</span></div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160; </div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160; <span class="comment">// Build the problem with Crouzeix Raviart Element</span></div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160; <a class="code" href="classCollapsibleChannelProblem.html">CollapsibleChannelProblem&lt;AlgebraicElement&lt;RefineableQCrouzeixRaviartElement&lt;2&gt;</a> &gt; &gt; </div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;  <a class="code" href="algebraic__collapsible__channel_8txt.html#a4074baada03976c061d5672f4237cca5">problem</a>(nup, ncollapsible, ndown, ny, </div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;          lup, lcollapsible, ldown, ly, </div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;          amplitude,period);</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160; </div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160; </div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160; <span class="comment">// Build the problem with Crouzeix Raviart Element</span></div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160; <a class="code" href="classCollapsibleChannelProblem.html">CollapsibleChannelProblem&lt;AlgebraicElement&lt;QCrouzeixRaviartElement&lt;2&gt;</a> &gt; &gt; </div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;  <a class="code" href="algebraic__collapsible__channel_8txt.html#a4074baada03976c061d5672f4237cca5">problem</a>(nup, ncollapsible, ndown, ny, </div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;          lup, lcollapsible, ldown, ly, </div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;          amplitude,period);</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160; </div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160; </div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160; </div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160; </div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160; </div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160; <span class="comment">// Number of timesteps per period</span></div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160; <span class="keywordtype">unsigned</span> nsteps_per_period=40;</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160; </div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160; <span class="comment">// Number of periods</span></div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160; <span class="keywordtype">unsigned</span> nperiod=3; </div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160; </div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160; <span class="comment">// Number of timesteps (reduced for validation)</span></div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160; <span class="keywordtype">unsigned</span> nstep=nsteps_per_period*nperiod;</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160; <span class="keywordflow">if</span> (CommandLineArgs::Argc&gt;1)</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;  {</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;   nstep=3;</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;  }</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160; </div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160; <span class="comment">//Timestep: </span></div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160; <span class="keywordtype">double</span> dt=period/double(nsteps_per_period);</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160; </div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160; <span class="comment">// Start time</span></div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160; <span class="keywordtype">double</span> t_min=0.0;</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160; </div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160; <span class="comment">// Initialise timestep and set initial conditions</span></div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160; <a class="code" href="algebraic__collapsible__channel_8txt.html#a4074baada03976c061d5672f4237cca5">problem</a>.time_pt()-&gt;time()=t_min;</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160; <a class="code" href="algebraic__collapsible__channel_8txt.html#a4074baada03976c061d5672f4237cca5">problem</a>.initialise_dt(dt);</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160; <a class="code" href="algebraic__collapsible__channel_8txt.html#a4074baada03976c061d5672f4237cca5">problem</a>.set_initial_condition();</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160; </div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;  <span class="comment">// Output the initial solution</span></div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160; <a class="code" href="algebraic__collapsible__channel_8txt.html#a4074baada03976c061d5672f4237cca5">problem</a>.doc_solution(doc_info, trace_file);</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160; </div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160; <span class="comment">// Step number</span></div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160; doc_info.number()++;</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160; </div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;<span class="preprocessor">#ifdef ADAPTIVE</span></div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160; </div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160; <span class="comment">// Set targets for spatial adaptivity</span></div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160; <a class="code" href="algebraic__collapsible__channel_8txt.html#a4074baada03976c061d5672f4237cca5">problem</a>.bulk_mesh_pt()-&gt;max_permitted_error()=1.0e-3;</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160; <a class="code" href="algebraic__collapsible__channel_8txt.html#a4074baada03976c061d5672f4237cca5">problem</a>.bulk_mesh_pt()-&gt;min_permitted_error()=1.0e-5;</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160; </div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160; <span class="comment">// Overwrite with reduced targets for validation run to force</span></div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160; <span class="comment">// some refinement during the first few timesteps</span></div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160; <span class="keywordflow">if</span> (CommandLineArgs::Argc&gt;1)</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;  {</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;   <a class="code" href="algebraic__collapsible__channel_8txt.html#a4074baada03976c061d5672f4237cca5">problem</a>.bulk_mesh_pt()-&gt;max_permitted_error()=1.0e-4;</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;   <a class="code" href="algebraic__collapsible__channel_8txt.html#a4074baada03976c061d5672f4237cca5">problem</a>.bulk_mesh_pt()-&gt;min_permitted_error()=1.0e-6;</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;  }</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160; </div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160; <span class="comment">// First timestep: We may re-assign the initial condition</span></div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160; <span class="comment">// following any mesh adaptation.</span></div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160; <span class="keywordtype">bool</span> first=<span class="keyword">true</span>;</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160; </div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160; <span class="comment">// Max. number of adaptations during first timestep</span></div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160; <span class="keywordtype">unsigned</span> max_adapt=10;</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160; </div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160; </div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160; <span class="comment">// Timestepping loop</span></div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160; <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> istep=0;istep&lt;nstep;istep++)</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;  {</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160; </div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;<span class="preprocessor">#ifdef ADAPTIVE</span></div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160; </div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;   <span class="comment">// Solve the problem</span></div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;   <a class="code" href="algebraic__collapsible__channel_8txt.html#a4074baada03976c061d5672f4237cca5">problem</a>.unsteady_newton_solve(dt, max_adapt, first);</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;    </div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160; </div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160; </div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;   <span class="comment">// Solve the problem</span></div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;   <a class="code" href="algebraic__collapsible__channel_8txt.html#a4074baada03976c061d5672f4237cca5">problem</a>.unsteady_newton_solve(dt);</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;    </div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160; </div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;   <span class="comment">// Outpt the solution</span></div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;   <a class="code" href="algebraic__collapsible__channel_8txt.html#a4074baada03976c061d5672f4237cca5">problem</a>.doc_solution(doc_info, trace_file);</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;   </div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;   <span class="comment">// Step number</span></div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;   doc_info.number()++;</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160; </div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;<span class="preprocessor">#ifdef ADAPTIVE</span></div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160; </div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;   <span class="comment">// We&#39;ve done one step: Don&#39;t re-assign the initial conditions</span></div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;   <span class="comment">// and limit the number of adaptive mesh refinements to one</span></div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;   <span class="comment">// per timestep.</span></div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;   first=<span class="keyword">false</span>;</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;   max_adapt=1;</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160; </div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160; </div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;  }</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160; </div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160; trace_file.close();</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160; </div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;} <span class="comment">//end of driver code</span></div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160; </div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;  </div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160; </div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;<span class="comment">//  {</span></div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;<span class="comment">//   unsigned n=100;</span></div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;<span class="comment">//   for (unsigned i=0;i&lt;n;i++)</span></div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;<span class="comment">//    {</span></div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;<span class="comment">//     double s=double(i)/double(n-1);</span></div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;<span class="comment">//     cout &lt;&lt; s &lt;&lt; &quot; &quot; &lt;&lt;  BL_Squash::squash_fct(s) &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;<span class="comment">//    }</span></div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;<span class="comment">//   pause(&quot;done&quot;);</span></div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;<span class="comment">//  }</span></div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="anamespaceBL__Squash_html"><div class="ttname"><a href="namespaceBL__Squash.html">BL_Squash</a></div><div class="ttdef"><b>Definition:</b> <a href="collapsible__channel_8cc_source.html#l00045">collapsible_channel.cc:45</a></div></div>
<div class="ttc" id="aclassCollapsibleChannelProblem_html_a4c365050b11c184007b8e1cd6079147f"><div class="ttname"><a href="classCollapsibleChannelProblem.html#a4c365050b11c184007b8e1cd6079147f">CollapsibleChannelProblem::actions_before_implicit_timestep</a></div><div class="ttdeci">void actions_before_implicit_timestep()</div><div class="ttdoc">Update the velocity boundary condition on the moving wall.</div><div class="ttdef"><b>Definition:</b> <a href="collapsible__channel_8cc_source.html#l00700">collapsible_channel.cc:700</a></div></div>
<div class="ttc" id="anamespaceBL__Squash_html_a3c4183891049bca81f3a011db24fc579"><div class="ttname"><a href="namespaceBL__Squash.html#a3c4183891049bca81f3a011db24fc579">BL_Squash::Delta</a></div><div class="ttdeci">double Delta</div><div class="ttdoc">Boundary layer width.</div><div class="ttdef"><b>Definition:</b> <a href="collapsible__channel_8cc_source.html#l00049">collapsible_channel.cc:49</a></div></div>
<div class="ttc" id="aclassCollapsibleChannelProblem_html_a54abc5259d590154e5dfa458d885c16c"><div class="ttname"><a href="classCollapsibleChannelProblem.html#a54abc5259d590154e5dfa458d885c16c">CollapsibleChannelProblem::actions_before_adapt</a></div><div class="ttdeci">void actions_before_adapt()</div><div class="ttdoc">Actions before adapt: Wipe the mesh of prescribed traction elements.</div><div class="ttdef"><b>Definition:</b> <a href="collapsible__channel_8cc_source.html#l00726">collapsible_channel.cc:726</a></div></div>
<div class="ttc" id="aclassCollapsibleChannelProblem_html_a34299672cba0f3c1db3901427eb4da4a"><div class="ttname"><a href="classCollapsibleChannelProblem.html#a34299672cba0f3c1db3901427eb4da4a">CollapsibleChannelProblem::actions_after_newton_solve</a></div><div class="ttdeci">void actions_after_newton_solve()</div><div class="ttdoc">Update the problem after solve (empty)</div><div class="ttdef"><b>Definition:</b> <a href="collapsible__channel__algebraic_8cc_source.html#l00292">collapsible_channel_algebraic.cc:292</a></div></div>
<div class="ttc" id="aclassCollapsibleChannelProblem_html_a646147fb75669cfcc5bb56ee79d9b8da"><div class="ttname"><a href="classCollapsibleChannelProblem.html#a646147fb75669cfcc5bb56ee79d9b8da">CollapsibleChannelProblem::set_initial_condition</a></div><div class="ttdeci">void set_initial_condition()</div><div class="ttdoc">Apply initial conditions.</div><div class="ttdef"><b>Definition:</b> <a href="collapsible__channel_8cc_source.html#l00653">collapsible_channel.cc:653</a></div></div>
<div class="ttc" id="aclassOscillatingWall_html_ac3e0098c026e23dd8be8ea29f6a9c101"><div class="ttname"><a href="classOscillatingWall.html#ac3e0098c026e23dd8be8ea29f6a9c101">OscillatingWall::period</a></div><div class="ttdeci">double &amp; period()</div><div class="ttdoc">Access function to the period.</div><div class="ttdef"><b>Definition:</b> <a href="collapsible__channel__algebraic_8cc_source.html#l00139">collapsible_channel_algebraic.cc:139</a></div></div>
<div class="ttc" id="aclassOscillatingWall_html_a5fce6728f975003d9e85f64c18ba7f55"><div class="ttname"><a href="classOscillatingWall.html#a5fce6728f975003d9e85f64c18ba7f55">OscillatingWall::position</a></div><div class="ttdeci">void position(const Vector&lt; double &gt; &amp;zeta, Vector&lt; double &gt; &amp;r) const</div><div class="ttdoc">&quot;Current&quot; position vector at Lagrangian coordinate zeta</div><div class="ttdef"><b>Definition:</b> <a href="collapsible__channel__algebraic_8cc_source.html#l00167">collapsible_channel_algebraic.cc:167</a></div></div>
<div class="ttc" id="aclassCollapsibleChannelProblem_html_a70cfe97c12c0cb6a2a81266cdd4d6088"><div class="ttname"><a href="classCollapsibleChannelProblem.html#a70cfe97c12c0cb6a2a81266cdd4d6088">CollapsibleChannelProblem::create_traction_elements</a></div><div class="ttdeci">void create_traction_elements(const unsigned &amp;b, Mesh *const &amp;bulk_mesh_pt, Mesh *const &amp;surface_mesh_pt)</div><div class="ttdoc">Create the traction elements.</div><div class="ttdef"><b>Definition:</b> <a href="collapsible__channel_8cc_source.html#l00597">collapsible_channel.cc:597</a></div></div>
<div class="ttc" id="aclassCollapsibleChannelProblem_html_abe1a38b5c84188910435874511a877f6"><div class="ttname"><a href="classCollapsibleChannelProblem.html#abe1a38b5c84188910435874511a877f6">CollapsibleChannelProblem::bulk_mesh_pt</a></div><div class="ttdeci">MyRefineableAlgebraicCollapsibleChannelMesh&lt; ELEMENT &gt; * bulk_mesh_pt()</div><div class="ttdoc">Access function for the specific mesh.</div><div class="ttdef"><b>Definition:</b> <a href="collapsible__channel__algebraic_8cc_source.html#l00262">collapsible_channel_algebraic.cc:262</a></div></div>
<div class="ttc" id="aalgebraic__collapsible__channel_8txt_html_a0dc44f34a836b7b9cdeda9a988c97756"><div class="ttname"><a href="algebraic__collapsible__channel_8txt.html#a0dc44f34a836b7b9cdeda9a988c97756">t</a></div><div class="ttdeci">endcode which must be implemented in every specific c AlgebraicMesh Its task is to update the position of the node specified by the pointer valued argument n n The specific implementation of the node update operation is obviously problem dependent but it is easy to illustrate the general procedure by considering the collapsible channel mesh sketched t</div><div class="ttdef"><b>Definition:</b> <a href="algebraic__collapsible__channel_8txt_source.html#l00087">algebraic_collapsible_channel.txt:87</a></div></div>
<div class="ttc" id="aclassCollapsibleChannelProblem_html_a3ea01d83f0256c588a652741c6c33e0e"><div class="ttname"><a href="classCollapsibleChannelProblem.html#a3ea01d83f0256c588a652741c6c33e0e">CollapsibleChannelProblem::actions_after_adapt</a></div><div class="ttdeci">void actions_after_adapt()</div><div class="ttdoc">Actions after adapt: Rebuild the mesh of prescribed traction elements.</div><div class="ttdef"><b>Definition:</b> <a href="collapsible__channel_8cc_source.html#l00741">collapsible_channel.cc:741</a></div></div>
<div class="ttc" id="anamespaceBL__Squash_html_a0fdaf7661591150041b7102dbe578cdc"><div class="ttname"><a href="namespaceBL__Squash.html#a0fdaf7661591150041b7102dbe578cdc">BL_Squash::squash_fct</a></div><div class="ttdeci">double squash_fct(const double &amp;s)</div><div class="ttdoc">Mapping [0,1] -&gt; [0,1] that re-distributes nodal points across the channel width.</div><div class="ttdef"><b>Definition:</b> <a href="collapsible__channel_8cc_source.html#l00056">collapsible_channel.cc:56</a></div></div>
<div class="ttc" id="aclassCollapsibleChannelProblem_html_a0c3c4c226afe7d14f6967ac6d28ff15f"><div class="ttname"><a href="classCollapsibleChannelProblem.html#a0c3c4c226afe7d14f6967ac6d28ff15f">CollapsibleChannelProblem::Bulk_mesh_pt</a></div><div class="ttdeci">MyAlgebraicCollapsibleChannelMesh&lt; ELEMENT &gt; * Bulk_mesh_pt</div><div class="ttdoc">Pointer to the &quot;bulk&quot; mesh.</div><div class="ttdef"><b>Definition:</b> <a href="collapsible__channel__algebraic_8cc_source.html#l00349">collapsible_channel_algebraic.cc:349</a></div></div>
<div class="ttc" id="aclassCollapsibleChannelProblem_html_ad7597f95eb755184ec1f9581c713ff78"><div class="ttname"><a href="classCollapsibleChannelProblem.html#ad7597f95eb755184ec1f9581c713ff78">CollapsibleChannelProblem::actions_before_newton_solve</a></div><div class="ttdeci">void actions_before_newton_solve()</div><div class="ttdoc">Update the problem specs before solve (empty)</div><div class="ttdef"><b>Definition:</b> <a href="collapsible__channel__algebraic_8cc_source.html#l00289">collapsible_channel_algebraic.cc:289</a></div></div>
<div class="ttc" id="aclassCollapsibleChannelProblem_html_a411441ab7ac76c04613b1a7f558a6621"><div class="ttname"><a href="classCollapsibleChannelProblem.html#a411441ab7ac76c04613b1a7f558a6621">CollapsibleChannelProblem::bulk_mesh_pt</a></div><div class="ttdeci">MyAlgebraicCollapsibleChannelMesh&lt; ELEMENT &gt; * bulk_mesh_pt()</div><div class="ttdoc">Access function for the specific mesh.</div><div class="ttdef"><b>Definition:</b> <a href="collapsible__channel__algebraic_8cc_source.html#l00275">collapsible_channel_algebraic.cc:275</a></div></div>
<div class="ttc" id="aclassCollapsibleChannelProblem_html"><div class="ttname"><a href="classCollapsibleChannelProblem.html">CollapsibleChannelProblem</a></div><div class="ttdoc">Problem class.</div><div class="ttdef"><b>Definition:</b> <a href="collapsible__channel_8cc_source.html#l00235">collapsible_channel.cc:235</a></div></div>
<div class="ttc" id="aclassCollapsibleChannelProblem_html_ab43fa30667f57e8019c8b30fd93156f8"><div class="ttname"><a href="classCollapsibleChannelProblem.html#ab43fa30667f57e8019c8b30fd93156f8">CollapsibleChannelProblem::CollapsibleChannelProblem</a></div><div class="ttdeci">CollapsibleChannelProblem(const unsigned &amp;nup, const unsigned &amp;ncollapsible, const unsigned &amp;ndown, const unsigned &amp;ny, const double &amp;lup, const double &amp;lcollapsible, const double &amp;ldown, const double &amp;ly, const double &amp;amplitude, const double &amp;period)</div><div class="ttdoc">Constructor : the arguments are the number of elements, the length of the domain and the amplitude an...</div><div class="ttdef"><b>Definition:</b> <a href="collapsible__channel_8cc_source.html#l00350">collapsible_channel.cc:350</a></div></div>
<div class="ttc" id="aalgebraic__collapsible__channel_8txt_html_a4074baada03976c061d5672f4237cca5"><div class="ttname"><a href="algebraic__collapsible__channel_8txt.html#a4074baada03976c061d5672f4237cca5">problem</a></div><div class="ttdeci">mainpage Demo problem</div><div class="ttdef"><b>Definition:</b> <a href="algebraic__collapsible__channel_8txt_source.html#l00005">algebraic_collapsible_channel.txt:5</a></div></div>
<div class="ttc" id="anamespaceoomph_html"><div class="ttname"><a href="namespaceoomph.html">oomph</a></div><div class="ttdef"><b>Definition:</b> <a href="my__alg__channel__mesh_8h_source.html#l00040">my_alg_channel_mesh.h:40</a></div></div>
<div class="ttc" id="aclassOscillatingWall_html_abb4ae7e556479d2980a56963bd8d4558"><div class="ttname"><a href="classOscillatingWall.html#abb4ae7e556479d2980a56963bd8d4558">OscillatingWall::position</a></div><div class="ttdeci">void position(const unsigned &amp;t, const Vector&lt; double &gt; &amp;zeta, Vector&lt; double &gt; &amp;r) const</div><div class="ttdoc">Position vector at Lagrangian coordinate zeta at time level t.</div><div class="ttdef"><b>Definition:</b> <a href="collapsible__channel__algebraic_8cc_source.html#l00143">collapsible_channel_algebraic.cc:143</a></div></div>
<div class="ttc" id="acollapsible__channel__algebraic_8cc_html_a0ddf1224851353fc92bfbff6f499fa97"><div class="ttname"><a href="collapsible__channel__algebraic_8cc.html#a0ddf1224851353fc92bfbff6f499fa97">main</a></div><div class="ttdeci">int main(int argc, char *argv[])</div><div class="ttdef"><b>Definition:</b> <a href="collapsible__channel__algebraic_8cc_source.html#l00804">collapsible_channel_algebraic.cc:804</a></div></div>
<div class="ttc" id="anamespaceGlobal__Physical__Variables_html_a0de42ee6d39e85c77c16a04c3a05f7a2"><div class="ttname"><a href="namespaceGlobal__Physical__Variables.html#a0de42ee6d39e85c77c16a04c3a05f7a2">Global_Physical_Variables::prescribed_traction</a></div><div class="ttdeci">void prescribed_traction(const double &amp;t, const Vector&lt; double &gt; &amp;x, const Vector&lt; double &gt; &amp;n, Vector&lt; double &gt; &amp;traction)</div><div class="ttdoc">Traction required at the left boundary.</div><div class="ttdef"><b>Definition:</b> <a href="collapsible__channel_8cc_source.html#l00217">collapsible_channel.cc:217</a></div></div>
<div class="ttc" id="aclassOscillatingWall_html_ae3fa3ef50ef7e082b255ba8125373581"><div class="ttname"><a href="classOscillatingWall.html#ae3fa3ef50ef7e082b255ba8125373581">OscillatingWall::ngeom_data</a></div><div class="ttdeci">unsigned ngeom_data() const</div><div class="ttdoc">Number of geometric Data in GeomObject: None.</div><div class="ttdef"><b>Definition:</b> <a href="collapsible__channel__algebraic_8cc_source.html#l00173">collapsible_channel_algebraic.cc:173</a></div></div>
<div class="ttc" id="anamespaceGlobal__Physical__Variables_html_a085ee4bf968ffdd01a41b8c41864f907"><div class="ttname"><a href="namespaceGlobal__Physical__Variables.html#a085ee4bf968ffdd01a41b8c41864f907">Global_Physical_Variables::ReSt</a></div><div class="ttdeci">double ReSt</div><div class="ttdoc">Womersley = Reynolds times Strouhal.</div><div class="ttdef"><b>Definition:</b> <a href="collapsible__channel_8cc_source.html#l00211">collapsible_channel.cc:211</a></div></div>
<div class="ttc" id="aclassCollapsibleChannelProblem_html_a205e3e654d3205d1d55ac46e7b63ca9d"><div class="ttname"><a href="classCollapsibleChannelProblem.html#a205e3e654d3205d1d55ac46e7b63ca9d">CollapsibleChannelProblem::~CollapsibleChannelProblem</a></div><div class="ttdeci">~CollapsibleChannelProblem()</div><div class="ttdoc">Empty destructor.</div><div class="ttdef"><b>Definition:</b> <a href="collapsible__channel__algebraic_8cc_source.html#l00256">collapsible_channel_algebraic.cc:256</a></div></div>
<div class="ttc" id="aclassoomph_1_1MyRefineableAlgebraicCollapsibleChannelMesh_html"><div class="ttname"><a href="classoomph_1_1MyRefineableAlgebraicCollapsibleChannelMesh.html">oomph::MyRefineableAlgebraicCollapsibleChannelMesh</a></div><div class="ttdef"><b>Definition:</b> <a href="my__alg__channel__mesh_8h_source.html#l00180">my_alg_channel_mesh.h:180</a></div></div>
<div class="ttc" id="aclassOscillatingWall_html_a5ededc3d27eef5c4ef7e82ac5cdf6ff9"><div class="ttname"><a href="classOscillatingWall.html#a5ededc3d27eef5c4ef7e82ac5cdf6ff9">OscillatingWall::OscillatingWall</a></div><div class="ttdeci">OscillatingWall(const double &amp;h, const double &amp;x_left, const double &amp;l, const double &amp;a, const double &amp;period, Time *time_pt)</div><div class="ttdoc">Constructor : It's a 2D object, parametrised by one Lagrangian coordinate. Arguments: height at ends,...</div><div class="ttdef"><b>Definition:</b> <a href="collapsible__channel__algebraic_8cc_source.html#l00126">collapsible_channel_algebraic.cc:126</a></div></div>
<div class="ttc" id="aclassCollapsibleChannelProblem_html_a6a5324dd1efb8c517a7e4d431b10fca4"><div class="ttname"><a href="classCollapsibleChannelProblem.html#a6a5324dd1efb8c517a7e4d431b10fca4">CollapsibleChannelProblem::delete_traction_elements</a></div><div class="ttdeci">void delete_traction_elements(Mesh *const &amp;surface_mesh_pt)</div><div class="ttdoc">Delete prescribed traction elements from the surface mesh.</div><div class="ttdef"><b>Definition:</b> <a href="collapsible__channel_8cc_source.html#l00630">collapsible_channel.cc:630</a></div></div>
<div class="ttc" id="aclassOscillatingWall_html"><div class="ttname"><a href="classOscillatingWall.html">OscillatingWall</a></div><div class="ttdef"><b>Definition:</b> <a href="collapsible__channel_8cc_source.html#l00116">collapsible_channel.cc:116</a></div></div>
<div class="ttc" id="aclassOscillatingWall_html_adc35b40bdd733a244d6399d91fa20ade"><div class="ttname"><a href="classOscillatingWall.html#adc35b40bdd733a244d6399d91fa20ade">OscillatingWall::~OscillatingWall</a></div><div class="ttdeci">~OscillatingWall()</div><div class="ttdoc">Destructor: Empty.</div><div class="ttdef"><b>Definition:</b> <a href="collapsible__channel__algebraic_8cc_source.html#l00133">collapsible_channel_algebraic.cc:133</a></div></div>
<div class="ttc" id="anamespaceBL__Squash_html_af84bda39008884cd2b01e630957573df"><div class="ttname"><a href="namespaceBL__Squash.html#af84bda39008884cd2b01e630957573df">BL_Squash::Fract_in_BL</a></div><div class="ttdeci">double Fract_in_BL</div><div class="ttdoc">Fraction of points in boundary layer.</div><div class="ttdef"><b>Definition:</b> <a href="collapsible__channel_8cc_source.html#l00052">collapsible_channel.cc:52</a></div></div>
<div class="ttc" id="aalgebraic__collapsible__channel_8txt_html_a788a9986732a5f0588dc91417ffacde6"><div class="ttname"><a href="algebraic__collapsible__channel_8txt.html#a788a9986732a5f0588dc91417ffacde6">node_pt</a></div><div class="ttdeci">mainpage Demo curvilinear boundaries for once the curvilinear domain is represented by a c Domain object domain boundaries n n in the position of the domain s curvilinear boundaries may be performed by the black box function c either because the mesh deformation generated by the black box procedure is not appropriate or because it is not efficient The latter problem arises particularly in fluid structure interaction problems In this tutorial we shall demonstrate an alternative node update based on c oomph lib s c c and c AlgebraicMesh classes The key feature of this approach is that it allows each node to update its own position This is in contrast to the c Domain MacroElement based approach in which we can only update the nodal positions of e all nodes in the mesh simultaneously not a particularly sparse operation[We note that the \c Node and \c FiniteElement base classesprovide the virtual functions \c Node::node_update() and \c FiniteElement::node_update(). These functions are intendedto be used for node-by-node or element-by-element node-updates butin their default implementations they are empty. Hence no node-update isperformed unless these functions are overloaded in derived classessuch as \c AlgebraicNode and \c AlgebraicElement.]&lt; HR &gt;&lt; HR &gt; section overview Overview The idea behind the algebraic node updates is AlgebraicNode * node_pt</div><div class="ttdef"><b>Definition:</b> <a href="algebraic__collapsible__channel_8txt_source.html#l00071">algebraic_collapsible_channel.txt:71</a></div></div>
<div class="ttc" id="aclassCollapsibleChannelProblem_html_afc4af9796c01d904d4074bd5bbfc5b9b"><div class="ttname"><a href="classCollapsibleChannelProblem.html#afc4af9796c01d904d4074bd5bbfc5b9b">CollapsibleChannelProblem::doc_solution</a></div><div class="ttdeci">void doc_solution(DocInfo &amp;doc_info, ofstream &amp;trace_file)</div><div class="ttdoc">Doc the solution.</div><div class="ttdef"><b>Definition:</b> <a href="collapsible__channel_8cc_source.html#l00543">collapsible_channel.cc:543</a></div></div>
<div class="ttc" id="aclassoomph_1_1MyAlgebraicCollapsibleChannelMesh_html"><div class="ttname"><a href="classoomph_1_1MyAlgebraicCollapsibleChannelMesh.html">oomph::MyAlgebraicCollapsibleChannelMesh</a></div><div class="ttdoc">Collapsible channel mesh with algebraic node update.</div><div class="ttdef"><b>Definition:</b> <a href="my__alg__channel__mesh_8h_source.html#l00048">my_alg_channel_mesh.h:48</a></div></div>
<div class="ttc" id="anamespaceGlobal__Physical__Variables_html"><div class="ttname"><a href="namespaceGlobal__Physical__Variables.html">Global_Physical_Variables</a></div><div class="ttdoc">Namespace for phyical parameters.</div><div class="ttdef"><b>Definition:</b> <a href="collapsible__channel_8cc_source.html#l00205">collapsible_channel.cc:205</a></div></div>
<div class="ttc" id="amy__alg__channel__mesh_8h_html"><div class="ttname"><a href="my__alg__channel__mesh_8h.html">my_alg_channel_mesh.h</a></div></div>
<div class="ttc" id="aclassOscillatingWall_html_ae923c6a7abefe33efaf47a4b69d1b621"><div class="ttname"><a href="classOscillatingWall.html#ae923c6a7abefe33efaf47a4b69d1b621">OscillatingWall::amplitude</a></div><div class="ttdeci">double &amp; amplitude()</div><div class="ttdoc">Access function to the amplitude.</div><div class="ttdef"><b>Definition:</b> <a href="collapsible__channel__algebraic_8cc_source.html#l00136">collapsible_channel_algebraic.cc:136</a></div></div>
<div class="ttc" id="anamespaceGlobal__Physical__Variables_html_ae1a493695b7f4619af32f405b0b28861"><div class="ttname"><a href="namespaceGlobal__Physical__Variables.html#ae1a493695b7f4619af32f405b0b28861">Global_Physical_Variables::P_up</a></div><div class="ttdeci">double P_up</div><div class="ttdoc">Default pressure on the left boundary.</div><div class="ttdef"><b>Definition:</b> <a href="collapsible__channel_8cc_source.html#l00214">collapsible_channel.cc:214</a></div></div>
<div class="ttc" id="anamespaceGlobal__Physical__Variables_html_ab814e627d2eb5bc50318879d19ab16b9"><div class="ttname"><a href="namespaceGlobal__Physical__Variables.html#ab814e627d2eb5bc50318879d19ab16b9">Global_Physical_Variables::Re</a></div><div class="ttdeci">double Re</div><div class="ttdoc">Reynolds number.</div><div class="ttdef"><b>Definition:</b> <a href="collapsible__channel_8cc_source.html#l00208">collapsible_channel.cc:208</a></div></div>

    <!-- jQuery for Bootstrap and Doxygen -->
    <script src="../../../js/jquery-1.12.0.min.js"></script>
    <!-- Minified boostrap plugins-->
    <script src="../../../js/bootstrap.js"></script>
    <!-- Doxygen dependency to add powertips to source code-->
    <script src="../../../js/jquery.powertip.min.js"></script>
    <!-- The  following script is generated by doxygen and hides/shows levels in 
         the data structure lists and adds powertips to source code-->
    <script src="../../../js/dynsections.js" ></script>
    <!-- add to Doxygen's class names so bootstrap css and js recognises them-->
    <script type="text/javascript">
    $(".contents").addClass("container");
    $(".header").addClass("container");
    $(".navpath").addClass("container");
    $("#navrow3").addClass("container");
    $("#navrow4").addClass("container");
    $(".mlabel").addClass("label");
    $(".mlabel").addClass("label-default");
    $(".memitem").addClass("panel");
    $(".memitem").addClass("panel-info");
    $(".memproto").addClass("panel-heading");
    $(".memdoc").addClass("panel-body");
    </script>
    <footer>
      <div class="container">
        <div class="text-muted" style="float:right;">Generated by <a href="http://www.doxygen.org/index.html">
          <img style="height:18px;" class="footer-img" src="doxygen.png" alt="doxygen"></a> on Tue Jul 27 2021 11:16:12
        </div>
      </div>
    </footer>
</body>
</html>

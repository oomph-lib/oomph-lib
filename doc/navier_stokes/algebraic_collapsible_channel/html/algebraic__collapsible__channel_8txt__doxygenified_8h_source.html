<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
<title>oomph-lib: algebraic_collapsible_channel.txt_doxygenified.h Source File</title>
<link rel="apple-touch-icon" sizes="57x57" href="../../../figures/apple-touch-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="../../../figures/apple-touch-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="../../../figures/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="../../../figures/apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="../../../figures/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="../../../figures/apple-touch-icon-120x120.png">
<link rel="icon" type="image/png" href="../../../figures/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="../../../figures/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="../../../figures/favicon-16x16.png" sizes="16x16">
<link rel="manifest" href="../../../figures/manifest.json">
<link rel="mask-icon" href="../../../figures/safari-pinned-tab.svg" color="#008000">
<link rel="shortcut icon" href="../../../figures/favicon.ico">
<meta name="msapplication-TileColor" content="#00a300">
<meta name="msapplication-config" content="../../../figures/browserconfig.xml">
<meta name="theme-color" content="#008000">
<link href="http://fonts.googleapis.com/css?family=Open+Sans:400,300,600" rel="stylesheet" type="text/css">
<!-- Doxygen css-->
<!-- <link rel="stylesheet" type="text/css" href="doxygen.css"> -->
<!-- Bootstrap -->
<link href="../../../css/bootstrap.css" rel="stylesheet">
<!-- oomph-lib specific overrides -->
<link rel="stylesheet" type="text/css" href="../../../css/oomph_header.css">
</head>
<body>
<nav class="navbar navbar-default">
<div class="container">
<div class="container-fluid">
  <!-- Brand and toggle get grouped for better mobile display -->
  <div class="navbar-header">
    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
      <span class="sr-only">Toggle navigation</span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="../../../html/index.html"><img alt="oomph-lib" src="../../../figures/oomph_logo.png"></a>
  </div>
  <!-- Collect the nav links, forms, and other content for toggling -->
  <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
    <ul class="nav navbar-nav">          
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Documentation <span class="caret"></span></a>
        <ul class="dropdown-menu">
          <li class="dropdown-header">Big picture</li>
          <li><a href="../../../../doc/intro/html/index.html">The finite element method</a></li>
          <li><a href="../../../../doc/the_data_structure/html/index.html">The data structure</a></li>
          <li><a href="../../../../doc/quick_guide/html/index.html">Not-so-quick guide</a></li>
          <li><a href="../../../../doc/optimisation/html/index.html">Optimisation</a></li>
          <li><a href="../../../../doc/order_of_action_functions/html/index.html">Order of action functions</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Example codes and tutorials</li>
          <li><a href="../../../../doc/example_code_list/html/index.html">List of example codes and tutorials</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#meshes">Meshing</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#solvers">Solvers</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#parallel">MPI parallel processing</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#visualisation">Post-processing/visualisation</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Other</li>
          <li><a href="../../../../doc/change_log/html/index.html">Change log</a></li>
          <li><a href="../../../../doc/creating_doc/html/index.html">Creating documentation</a></li>
          <li><a href="../../../../doc/coding_conventions/html/index.html">Coding conventions</a></li>
          <li><a href="../../../../doc/index/html/index.html">Index</a></li>
          <li><a href="../../../../doc/FAQ/html/index.html">FAQ</a></li>
        </ul>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Get it <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../../doc/the_distribution/html/index.html">Installation guide</a></li>
            <li><a href="../../../../doc/subversion/html/index.html">Get code from subversion repository</a></li>
            <li><a href="../../../../doc/download/html/index.html">Get code as tar file</a></li>
            <li><a href="../../../../doc/copyright/html/index.html">Copyright</a></li>
          </ul>
        </li>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">About <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../../doc/people/html/index.html">People</a></li>            
            <li><a href="../../../../doc/contact/html/index.html">Contact/Get involved</a></li>
            <li><a href="../../../../doc/publications/html/index.html">Publications</a></li>
            <li><a href="../../../../doc/acknowledgements/html/index.html">Acknowledgements</a></li>
            <li><a href="../../../../doc/picture_show/index.html">Picture show</a></li>
          </ul>
        </li>
      </li>
    </ul>
    <ul class="nav navbar-nav navbar-right navbar-search">
      <form class="navbar-form" role="search" action="../../../../doc/search_results/html/index.html">
        <div class="input-group">
          <input type="text" class="form-control" placeholder="Search" name="q">
          <span class="input-group-btn">
            <button class="btn btn-default" type="submit">Go</button>
          </span>
        </div><!-- /input-group -->
       <!--<div class="form-group">
          <input type="text" class="form-control" placeholder="Search">
        </div>
        <button type="submit" class="btn btn-default">Submit</button>-->
      </form>
    </ul>
  </div><!-- /.navbar-collapse -->
</div><!-- /.container-fluid -->
</div>
</nav>
<!-- Generated by Doxygen 1.8.17 -->
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">algebraic_collapsible_channel.txt_doxygenified.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="algebraic__collapsible__channel_8txt__doxygenified_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">\mainpage Demo problem: Flow in a 2D channel with an oscillating wall revisited -- AlgebraicElements: How to customise the mesh update</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">In many previous examples we illustrated how \c oomph-lib&#39;s</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">\c Domain  and \c MacroElement objects facilitate the generation of</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">refineable (and non-refineable) meshes in domains with moving, </span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">curvilinear boundaries. Consult, for instance:</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">- The tutorial &lt;A HREF=&quot;../../../poisson/fish_poisson2/html/index.html&quot;&gt;</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">  &quot;How to create refineable meshes in domains with curvilinear and/or</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">  moving boundaries&quot;&lt;/A&gt; for a general discussion of the methodology. \n\n</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">- The tutorial </span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">  &lt;A HREF=&quot;../../../unsteady_heat/two_d_unsteady_heat_ALE/html/index.html&quot;&gt;</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">  &quot;Spatially adaptive solution of the 2D unsteady heat equation with </span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">  flux boundary conditions in a moving domain: ALE methods&quot;&lt;/A&gt;</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">  for an example involving the unsteady heat equation. \n\n</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">- The tutorials \n\n</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">  - &lt;A HREF=&quot;../../../navier_stokes/osc_ellipse/html/index.html&quot;&gt;</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">    &quot;Finite-Reynolds-number flow inside an oscillating ellipse&quot;&lt;/A&gt; \n\n</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">  .</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">  or </span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">  - &lt;A HREF=&quot;../../../navier_stokes/collapsible_channel/html/index.html&quot;&gt;</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">     &quot;Flow in a 2D channel with an oscillating wall&quot;&lt;/A&gt; \n\n</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">  .</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">  for examples involving the Navier-Stokes equations.</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">.</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment">The two main features of the \c MacroElement/Domain - based</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">node-update are that, once the curvilinear domain</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment">is represented by a \c Domain object</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment">-# Any subsequent mesh refinement will respect the curvilinear </span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment">   domain boundaries. \n\n</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment">-# The udate of the nodal positions in response to a change</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment">   in the position of the domain&#39;s curvilinear boundaries</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment">   may be performed by the &quot;black-box&quot; function </span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment">   \c Mesh::node_update().</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment">.</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment">The availability of a &quot;black-box&quot; node-update procedure is</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment">very convenient but in some applications it may be desirable (or</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment">even necessary) to provide a customised node-update function, either</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment">because the mesh deformation generated by the &quot;black-box&quot; procedure</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment">is not appropriate or because it is not efficient. The latter problem</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment">arises particularly in fluid-structure interaction problems. </span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment">In this tutorial we shall demonstrate an alternative</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment">node-update technique, based on \c oomph-lib&#39;s \c AlgebraicNode,</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment">\c AlgebraicElement, and \c AlgebraicMesh classes. The key feature</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment">of this approach is that it allows &quot;each node to update its own</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment">position&quot;. This is in contrast to the \c Domain/MacroElement-based approach </span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment">in which we can only update the nodal positions of \e all nodes in the</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment">mesh simultaneously -- not a particularly sparse operation!</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment">[We note that the \c Node and \c FiniteElement base classes</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment">provide the virtual functions \c Node::node_update()</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="comment">and \c FiniteElement::node_update(). These functions are intended</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment">to be used for node-by-node or element-by-element node-updates but</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment">in their default implementations they are empty. Hence no node-update is</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment">performed unless these functions are overloaded in derived classes</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment">such as \c AlgebraicNode and \c AlgebraicElement.]</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment">\section overview Overview</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment">The idea behind the algebraic node-updates is simple: The \c</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment">AlgebraicMesh class (the base class for meshes containing \c</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="comment">AlgebraicElements and \c AlgebraicNodes) contains the </span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="comment">pure virtual function</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="comment">\code</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment">void AlgebraicMesh::algebraic_node_update(..., AlgebraicNode* node_pt)=0;</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="comment">\endcode</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="comment">which must be implemented in every specific \c AlgebraicMesh.</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="comment">Its task is to update the position of the node specified by </span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="comment">the pointer-valued argument. \n\n</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="comment">The specific implementation of the node-update operation is obviously </span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="comment">problem-dependent but it is easy to illustrate the general </span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment">procedure  by considering the collapsible channel mesh</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="comment">sketched below:</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="comment">\image html alg_node_update_sketch.gif &quot;Sketch of the algebraic node-update procedure for the collapsible channel mesh. &quot; </span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="comment">\image latex alg_node_update_sketch.eps &quot;Sketch of the algebraic node-update procedure for the collapsible channel mesh. &quot; width=0.75\textwidth</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="comment">  The upper figure shows the mesh in the undeformed domain</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="comment">in which wall shape is parametrised by the intrinsic (Lagrangian)</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="comment">coordinate \f$ \zeta \f$ as \f$ {\bf R}(\zeta,t=0) =</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="comment">(L_{up} + \zeta, 1) ^T. \f$  In this</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="comment">configuration each node is located at a certain fraction along the </span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="comment">vertical lines across the channel. For instance, the \f$ j\f$-th</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="comment">node (drawn in blue) is located at a fraction of \f$ \omega_j = 1/3</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="comment">\f$ along the straight line</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment">that connects reference point \f$ {\bf A}_j \f$ on the bottom wall to</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="comment">reference point \f$ {\bf B}_j \f$ on the flexible upper wall.</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="comment">We note that reference point  \f$ {\bf B}_j \f$ may be identified by </span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="comment">its Lagrangian coordinate \f$ \zeta_j \f$ on the wall.</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="comment">The lower figure shows a sketch of the deformed domain and </span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="comment">illustrates a possible algebraic node-update strategy: Given the</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="comment">new wall shape, described by \f$ {\bf R}(\zeta,t) \f$, we position each node </span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="comment">on the straight line that connects its reference point </span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="comment">\f$ {\bf A}&#39;_j = {\bf A}_j \f$ on the lower wall to the reference</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="comment">point \f$ {\bf B}&#39;_j = {\bf R}(\zeta_j,t) \f$  on the deformable upper wall.</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="comment">To perform this node-update procedure for a specific node, we</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="comment">generally have to store</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="comment">- A pointer to one (or more) \c GeomObject(s) that define the</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="comment">  curvilinear domain boundaries. \n\n</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="comment">- A number of node-specific reference values (such as \f$ \omega_j, \ </span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="comment">  \zeta_j \f$, and the \f$ x_1 \f$ -coordinate of point \f$ {\bf A}_j</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="comment">  \f$, \f$ X^{(A)}_j \f$, say)</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="comment">  that establish the node&#39;s position relative to these \c GeomObjects.</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="comment">  \n\n</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="comment">- A pointer to the \c AlgebraicMesh that implements </span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="comment">  the node-update procedure.</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="comment">.</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="comment">Since the node-update data is node-specific, we provide storage</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="comment">for it in the \c AlgebraicNode class -- a class that is derived from</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="comment">the \c Node class. The node-update function itself is shared by </span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="comment">many nodes in the mesh and is implemented in </span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="comment">\c AlgebraicMesh::algebraic_node_update(...).</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="comment">This function extracts the node-update parameters, \f$ \omega_j, \ </span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="comment">\zeta_j \f$, and \f$ X^{(A)}_j \f$ and the pointer to the \c GeomObject</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="comment">that parametrises the wall, \c wall_pt, say, from the </span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="comment">\c AlgebraicNode passed to it. With these parameters, the position </span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="comment">of reference point\f${\bf A}&#39;_j \f$ is given by </span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="comment">\f$ {\bf A}&#39;_j = (X_j^{(A)},0)^T \f$ while the coordinates of</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="comment">reference point  \f$ {\bf B}&#39;_j = {\bf R}(\zeta_j,t)\f$ may be</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="comment">obtained from a call to \c wall_pt-&gt;position(...). The nodal </span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="comment">position  \f$ {\bf r}_j \f$ may then be updated via</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="comment">{\bf r}_j = </span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="comment">{\bf A}_j&#39; </span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="comment">+ \omega_j</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="comment">\left(</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="comment">{\bf B}_j&#39;-{\bf A}_j&#39;</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="comment">\right)</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="comment">&lt;HR&gt; </span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="comment">\section how_to_use How to use existing AlgebraicMeshes</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="comment">To use the algebraic node-update capabilities of an existing </span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="comment">\c AlgebraicMesh, all \c Nodes must be replaced by \c AlgebraicNodes</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="comment">to allow the storage of the node-specific node-update parameters. </span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="comment">Recall that within \c oomph-lib \c Nodes are usually created by the </span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="comment">elements, using the function \c FiniteElement::construct_node(...)</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="comment">whose argument specifies the local node number of the</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="comment">newly created \c Node within the element that creates it. </span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="comment">(The specification of the local node number is required to allow the </span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="comment">\c FiniteElement::construct_node(...) function to create a \c Node</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="comment">with the appropriate number of values and history values. For instance,</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="comment">in 2D Taylor-Hood Navier-Stokes elements, the elements&#39; vertex nodes have</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="comment">to store three values, representing the two velocity components and</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="comment">the pressure, whereas all other nodes only require storage for the</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="comment">two velocity components.) </span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="comment">  To ensure that the \c FiniteElement::construct_node(...) function creates</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="comment">\c AlgebraicNodes rather than &quot;ordinary&quot; \c Nodes, we provide</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="comment">the templated wrapper class</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="comment">\code</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="comment">template&lt;ELEMENT&gt;</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="comment">class AlgebraicElement&lt;ELEMENT&gt; : public ELEMENT</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="comment">\endcode</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="comment">which overloads the \c FiniteElement::construct_node(...) function so that it</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="comment">creates \c AlgebraicNodes instead. In most other respects, the</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="comment">&quot;wrapped&quot; element behaves exactly as the underlying \c ELEMENT itself.</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="comment">To use an existing \c AlgebraicMesh</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;<span class="comment">with a certain element type, \c QTaylorHoodElement&lt;2&gt;, say, we </span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="comment">simply &quot;upgrade&quot; the element to an \c AlgebraicElement by </span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="comment">specifying the element type as \c AlgebraicElement&lt;QTaylorHoodElement&lt;2&gt; &gt;.  </span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="comment">The changes to an existing driver code that performs the node update</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="comment">by the default \c Domain/MacroElement methodology are therefore</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="comment">completely trivial. You may wish to compare the driver code</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="comment">&lt;A HREF=&quot;../../../../demo_drivers/navier_stokes/collapsible_channel/collapsible_channel.cc&quot;&gt;collapsible_channel.cc&lt;/A&gt;, discussed in </span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;<span class="comment">&lt;A HREF=&quot;../../collapsible_channel/html/index.html&quot;&gt;an</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="comment">earlier example&lt;/A&gt;, to the driver code &lt;A HREF=&quot;../../../../demo_drivers/navier_stokes/collapsible_channel/collapsible_channel_algebraic.cc&quot;&gt;</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<span class="comment">collapsible_channel_algebraic.cc&lt;/A&gt; in which the fluid domain is</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<span class="comment">discretised by the \c MyAlgebraicCollapsibleChannelMesh, discussed</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<span class="comment">below.</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="comment"> </span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="comment">\section how_to_write How to create a new AlgebraicMesh -- a basic example</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="comment">To illustrate how to create a new \c AlgebraicMesh, we will now</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="comment">discuss the implementation of the \c MyAlgebraicCollapsibleChannelMesh</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="comment">-- an \c AlgebraicMesh - version of the \c CollapsibleChannelMesh,</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="comment">used in &lt;A HREF=&quot;../../collapsible_channel/html/index.html&quot;&gt; the</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="comment">earlier example&lt;/A&gt;. </span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="comment">\subsection class The class definition</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="comment">We construct the mesh by multiple inheritance from the \c AlgebraicMesh</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="comment">base class, and the already-existing \c CollapsibleChannelMesh.</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="comment">The constructor first calls the constructor of the underlying </span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="comment">\c CollapsibleChannelMesh (thus &quot;recycling&quot; the basic mesh</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="comment">generation process, i.e. the generation of nodes and elements etc.) </span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="comment">and then adds the algebraic node-update information </span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="comment">by calling the function \c setup_algebraic_node_update().</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="comment">\dontinclude my_alg_channel_mesh.h</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="comment">\skipline start_algebraic_mesh</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;<span class="comment">\until }</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="comment">We declare the interface for the pure virtual function </span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="comment">\c algebraic_node_update(...), to be discussed below, and</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="comment">implement a second pure virtual function,</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="comment">\c AlgebraicMesh::update_node_update(), that may be used to update</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="comment">reference values following a mesh adaptation. Since the current</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="comment">mesh is not refineable, we leave this function empty and refer to</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="comment">&lt;A HREF=&quot;../../../interaction/fsi_collapsible_channel_adapt/html/index.html&quot;&gt;</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="comment">another example&lt;/A&gt; for a more detailed discussion of its role.</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="comment">\skipline Update nodal</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="comment">\until update_node_update</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;<span class="comment">The protected member function  \c setup_algebraic_node_update() </span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="comment">will be discussed below.</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="comment">\skipline protected:</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="comment">\until };</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;<span class="comment">\subsection setting_up Setting up the algebraic node update </span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="comment">When the function \c setup_algebraic_node_update() is called,</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="comment">the constructor of the underlying \c CollapsibleChannelMesh will </span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="comment">already have created the mesh&#39;s elements and nodes, and the</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="comment">nodes will be located at their initial positions in the undeformed</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="comment">domain.</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;<span class="comment">To set up the algebraic node-update data, we start by extracting the </span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;<span class="comment">lengths of the upstream rigid section, \f$ L_{up} \f$, and the </span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;<span class="comment">length of the collapsible segment,</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;<span class="comment">\f$ L_{collapsible} \f$, from the \c CollapsibleChannelDomain:</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;<span class="comment">\skipline start_setup</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;<span class="comment">\until l_collapsible</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;<span class="comment">Next, we loop over all \c AlgebraicNodes in the mesh and</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;<span class="comment">determine their current positions:</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;<span class="comment">\skipline Loop over</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="comment">\until y=</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="comment">If the \c j -th node is located in the &quot;collapsible&quot; section of the mesh</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="comment">we determine its reference coordinate, \f$ \zeta_j \f$, on the wall</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="comment">and determine the coordinates of its reference point \f$ {\bf B}_j</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="comment">\f$ from the \c GeomObject that represents the moving wall.</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="comment">\skipline Check</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="comment">\until -&gt;position(</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;<span class="comment">Just to be on the safe side, we check that the wall is actually in its</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;<span class="comment">undeformed configuration, as assumed.</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;<span class="comment">\skipline Confirm that</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;<span class="comment">\until endif</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;<span class="comment">Next, we package the data required for the node-update</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;<span class="comment">operations (the pointers to \c GeomObject(s) and the reference </span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;<span class="comment">values) into vectors. In the present example, the node-update</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;<span class="comment">operation only involves a single \c GeomObject:</span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<span class="comment">\skipline Only a single</span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;<span class="comment">\until =this-&gt;Wall_pt;</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;<span class="comment">We have three reference values: The \f$ x_1 \f$ - coordinate of</span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;<span class="comment">point \f$ {\bf A}_j \f$,</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;<span class="comment">\skipline The update </span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;<span class="comment">\until r_wall[0];</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;<span class="comment">as well as the fractional height, \f$ \omega_j \f$,</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;<span class="comment">\skipline Second</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<span class="comment">\until r_wall[1];</span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;<span class="comment">and the reference coordinate, \f$ \zeta_j \f$, along the wall:</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="comment">\skipline Third</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="comment">\until zeta[0];</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="comment">The vectors of reference values and geometric objects are then</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;<span class="comment">passed to the node, together with the pointer to the mesh</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="comment">(\c this) that implements the node-update function. </span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;<span class="comment">\until end of </span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;<span class="comment">\subsection node_update The node-update function</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;<span class="comment">The function \c algebraic_node_update(...) reverses the setup process:</span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;<span class="comment">It extracts the node-update data from the \c AlgebraicNode and</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;<span class="comment">updates its position at the \c t -th previous time-level:</span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<span class="comment">\skipline start_of_algebraic</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="comment">\until {</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<span class="comment">We start by extracting the vectors of reference values and \c</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="comment">GeomObjects involved in this node&#39;s node-update, using the functions</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="comment">\c AlgebraicNode::vector_ref_value() which returns a Vector</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;<span class="comment">of reference values, and the function  </span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;<span class="comment">\c AlgebraicNode::vector_geom_object_pt() which returns a Vector of</span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;<span class="comment">pointers to \c GeomObjects. </span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;<span class="comment">\skipline Extract</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;<span class="comment">\until Vector&lt;GeomObject*&gt;</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;<span class="comment">Next, we translate these into local variables,</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;<span class="comment">  </span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;<span class="comment">\skipline First reference</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;<span class="comment">\until GeomObject*</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;<span class="comment">and obtain the current wall position from the wall \c GeomObject.</span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="comment">\skipline Get position vector</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;<span class="comment">\until wall_pt</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;<span class="comment">Finally, we update the nodal position:</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;<span class="comment">\skipline Assign</span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;<span class="comment">\until }</span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;<span class="comment">Done!</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;<span class="comment">\section comments Comments and Exercises</span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;<span class="comment">\subsection comm Comments</span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;<span class="comment">- &lt;B&gt;Element-by-element and global node updates:&lt;/B&gt; \n \n</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;<span class="comment">  As explained above, the re-implementation of the (empty) </span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;<span class="comment">  \c Node::node_update() function </span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;<span class="comment">  by \c AlgebraicNode::node_update() allows each node to &quot;update its </span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;<span class="comment">  own position&quot;. The \c AlgebraicMesh and </span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;<span class="comment">  \c AlgebraicElement classes provide their own re-implementation</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;<span class="comment">  of the \c node_update() functions in the \c Mesh and \c</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;<span class="comment">  FiniteElement classes, and perform the node-updates by executing</span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;<span class="comment">  the \c AlgebraicNode::node_update() function of their constituent</span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;<span class="comment">  nodes. \n\n</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;<span class="comment">- &lt;B&gt;Default node-update function:&lt;/B&gt; \n \n</span></div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="comment">  We stress that, in the above example, it was only necessary to set </span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;<span class="comment">  up the node-update data for the</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;<span class="comment">  nodes in the central &quot;collapsible&quot; part of the mesh as they are</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;<span class="comment">  the only modes whose position is affected by the motion of the </span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;<span class="comment">  curvilinear boundary. This is possible because the \c</span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;<span class="comment">  AlgebraicNode constructor provides default assignments for </span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;<span class="comment">  the node-update data. In particular, the pointer to the Mesh that</span></div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;<span class="comment">  performs the node update is initialised by a pointer to the</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;<span class="comment">  (static instantiation of a) \c DummyMesh whose </span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;<span class="comment">  \c AlgebraicMesh::algebraic_node_update(...) and</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;<span class="comment">  \c AlgebraicMesh::update_node_update(...) functions are empty. </span></div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;<span class="comment">  This ensures that nodes for which these default assignments are not</span></div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;<span class="comment">  overwritten stay at their original position when the node udate</span></div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;<span class="comment">  is performed. This implementation provides a sensible</span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;<span class="comment">  default behaviour for the node update. \n\n</span></div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;<span class="comment">- &lt;B&gt;Multiple node-update functions:&lt;/B&gt; \n \n</span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;<span class="comment">  In the simple example considered here, a single node-update function</span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;<span class="comment">  was sufficient to update the positions of all moving nodes in</span></div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;<span class="comment">  the mesh. In more complicated meshes, it may be be necessary to</span></div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;<span class="comment">  provide different node-update functions for nodes that are located</span></div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;<span class="comment">  in different parts of the mesh. To facilitate the implementation of</span></div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;<span class="comment">  such cases, it is possible to specify an identifier for the </span></div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;<span class="comment">  node-update function when calling the </span></div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;<span class="comment">  \c AlgebraicNode::add_node_update_info(...) function, using its</span></div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;<span class="comment">  alternative interface</span></div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;<span class="comment">  \code</span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;<span class="comment">  void AlgebraicNode::add_node_update_info(</span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;<span class="comment">      const int&amp; id,                              // ID of the node-update fct</span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;<span class="comment">      AlgebraicMesh* mesh_pt,                     // pointer to mesh</span></div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;<span class="comment">      const Vector&lt;GeomObject*&gt;&amp; geom_object_pt,  // vector of geom objects</span></div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;<span class="comment">      const Vector&lt;double&gt;&amp; ref_value);           // vector of ref. values</span></div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;<span class="comment">  \endcode</span></div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;<span class="comment">  When implementing the \c AlgebraicMesh::algebraic_node_update(...)</span></div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;<span class="comment">  function for a mesh that contains multiple node-update functions,</span></div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;<span class="comment">  the ID of the node-update function associated with a particular</span></div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;<span class="comment">  node can be obtained from \c AlgebraicNode::node_update_fct_id(),</span></div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;<span class="comment">  allowing the node-update function to take the appropriate</span></div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;<span class="comment">  action. (As an example, consider the implementation of the</span></div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;<span class="comment">  algebraic node-update function for the \c</span></div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;<span class="comment">  RefineableAlgebraicFishMesh in which different node-update</span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;<span class="comment">  functions are used to update the position of nodes in the fish&#39;s &quot;body&quot;</span></div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;<span class="comment">  and in its &quot;tail&quot;.)  If the  \c AlgebraicNode::add_node_update_info(...) </span></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;<span class="comment">  function is called without specifying an ID, a default ID of 0 is assigned. </span></div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;<span class="comment">  \n\n</span></div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;<span class="comment">- &lt;B&gt;Consistency between multiple node-update functions:&lt;/B&gt; \n \n</span></div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;<span class="comment">  If a mesh contains multiple node-update functions, it is likely</span></div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;<span class="comment">  that some nodes are located at the interface between </span></div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;<span class="comment">  regions that are updated by different node-update functions.</span></div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;<span class="comment">  As indicated by the \c &quot;add_...&quot; in the </span></div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;<span class="comment">  \c AlgebraicNode::add_node_update_info(...) function,</span></div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;<span class="comment">  \c AlgebraicNodes may be associated with</span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;<span class="comment">  multiple node-update functions, though the different node-update functions</span></div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;<span class="comment">  associated with a node must, of course, give the same result. This</span></div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;<span class="comment">  may be verified by calling the \c AlgebraicNode::self_test() </span></div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;<span class="comment">  function for all nodes in an \c AlgebraicMesh.</span></div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;<span class="comment">  \n \n</span></div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;<span class="comment">  \b Note: In refineable \c AlgebraicMeshes (discussed in more detail</span></div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;<span class="comment">  below), \c AlgebraicNodes \b must be associated with all possible </span></div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;<span class="comment">  node-update functions to ensure that the reference values for</span></div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;<span class="comment">  newly created nodes are determined correctly during the </span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;<span class="comment">  adaptive mesh refinement.</span></div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;<span class="comment">  \n\n</span></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;<span class="comment">- &lt;B&gt;Adaptivity:&lt;/B&gt; \n \n</span></div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;<span class="comment">  Refineable \c AlgebraicMeshes may be created by multiple inheritance</span></div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;<span class="comment">  from a suitable \c RefineableMesh base class (e.g. the \c</span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;<span class="comment">  RefineableQuadMesh class), and setting up the required tree</span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;<span class="comment">  representation of the coarse initial mesh, exactly </span></div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;<span class="comment">  as for &quot;ordinary&quot; meshes (see the tutorial </span></div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;<span class="comment">  &lt;A HREF=&quot;../../../poisson/two_d_poisson_adapt/html/index.html&quot;&gt;</span></div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;<span class="comment">  &quot;How to create simple refineable meshes&quot;&lt;/A&gt; for details).</span></div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;<span class="comment">  As an example, here is the class definition for a refineable</span></div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;<span class="comment">  version of the \c MyAlgebraicCollapsibleChannelMesh discussed above:</span></div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;<span class="comment">  \n \n </span></div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;<span class="comment">  \dontinclude my_alg_channel_mesh.h</span></div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;<span class="comment">  \skipline start_refineable_algebraic_collapsible_channel_mesh</span></div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;<span class="comment">  \until }</span></div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;<span class="comment">  \skipline };</span></div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;<span class="comment">  \n </span></div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;<span class="comment">  Note that none of the functions defined in the non-refineable</span></div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;<span class="comment">  version of this mesh have to be re-implemented. This raises the</span></div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;<span class="comment">  question of how the node-update data for any newly created nodes</span></div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;<span class="comment">  are determined when the mesh is refined. By default, </span></div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;<span class="comment">  the reference values for any newly created </span></div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;<span class="comment">  \c AlgebraicNodes are determined by interpolation from</span></div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;<span class="comment">  the node&#39;s &quot;father element&quot;. Furthermore, it is assumed  </span></div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;<span class="comment">  that the same \c GeomObjects are involved</span></div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;<span class="comment">  in the node-update function for the newly created node.  </span></div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;<span class="comment">  This default behaviour is appropriate for the</span></div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;<span class="comment">  mesh considered here. In other cases, (e.g. in the corresponding </span></div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;<span class="comment">  &lt;A HREF=&quot;../../../interaction/fsi_collapsible_channel_algebraic/html/index.html&quot;&gt;</span></div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;<span class="comment">  fluid-structure interaction problem&lt;/A&gt;), some or all of the</span></div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;<span class="comment">  node-update data may have to be recomputed when the mesh</span></div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;<span class="comment">  is adapted. Such updates may be performed by </span></div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;<span class="comment">  the \c AlgebraicMesh::update_node_update(...) function</span></div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;<span class="comment">  which is executed automatically whenever a refineable</span></div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;<span class="comment">  \c AlgebraicMesh is adapted.</span></div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;<span class="comment">  \n\n</span></div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;<span class="comment">- &lt;B&gt;Node updates for hanging nodes:&lt;/B&gt; \n \n</span></div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;<span class="comment">  Recall that refineable meshes may contain hanging nodes whose </span></div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;<span class="comment">  position is constrained by its &quot;master nodes&quot;.</span></div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;<span class="comment">  When the \c AlgebraicNode::node_update(...) function is</span></div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;<span class="comment">  called for a hanging node, it first updates the position </span></div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;<span class="comment">  of its master nodes (using their own node-update functions)</span></div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;<span class="comment">  and then updates its own constrained position accordingly.</span></div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;<span class="comment">  \n\n</span></div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;<span class="comment">- &lt;B&gt;Automatic finite-differencing with respect to geometric Data:&lt;/B&gt; </span></div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;<span class="comment">  \n\n</span></div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;<span class="comment">  Algebraic node updates are particularly useful in fluid-structure </span></div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;<span class="comment">  interaction problems since they allow the development of &quot;sparse&quot;</span></div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;<span class="comment">  node update procedures in which each (solid mechanics) degree of</span></div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;<span class="comment">  freedom only affects the position of a small number of nodes in the </span></div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;<span class="comment">  fluid mesh. We will discuss fluid-structure interaction problems</span></div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;<span class="comment">  in more detail </span></div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;<span class="comment">  &lt;A HREF=&quot;../../../interaction/fsi_collapsible_channel_algebraic/html/index.html&quot;&gt;</span></div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;<span class="comment">elsewhere&lt;/A&gt; but stress already that one of </span></div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;<span class="comment">  the major complications in such problems (and, in fact, in any</span></div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;<span class="comment">  free-boundary problem) is the need to evaluate the so-called</span></div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;<span class="comment">  shape derivatives -- the derivatives of the &quot;bulk&quot; (here the</span></div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;<span class="comment">  Navier-Stokes) equations with respect to the degrees of freedom</span></div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;<span class="comment">  (here the nodal positions in the wall mesh) that affect the </span></div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;<span class="comment">  position of the nodes in the &quot;bulk&quot; mesh.</span></div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;<span class="comment">  \n\n</span></div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;<span class="comment">  The algebraic node update procedures discussed above are </span></div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;<span class="comment">  sufficiently general to handle such interactions. The </span></div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;<span class="comment">  shape/position of the \c GeomObjects that are involved in an </span></div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;<span class="comment">  \c AlgebraicNode&#39;s node update, may depend on unknowns in the</span></div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;<span class="comment">  overall problem. Such unknowns constitute a \c GeomObject&#39;s</span></div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;<span class="comment">  geometric \c Data which may be obtained from its member function </span></div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;<span class="comment">  \c GeomObject::geom_data_pt(...).</span></div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;<span class="comment">  \c AlgebraicElements use finite differencing to include the</span></div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;<span class="comment">  shape derivatives (i.e. the derivatives</span></div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;<span class="comment">  of the residuals of the underlying (wrapped) element with respect</span></div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;<span class="comment">  to the geometric \c Data involved in the element&#39;s node update)</span></div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;<span class="comment">  into the element&#39;s Jacobian matrix.</span></div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;<span class="comment">  \n\n</span></div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;<span class="comment">- &lt;B&gt;Additional sanity checks and other generalisations:&lt;/B&gt; \n \n</span></div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;<span class="comment">  The \c MyAlgebraicCollapsibleChannelMesh and its refineable </span></div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;<span class="comment">  equivalent are slightly simplified versions of the</span></div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;<span class="comment">  meshes in \c oomph-lib&#39;s \c src/meshes directory. These meshes</span></div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;<span class="comment">  contain a number of additional sanity checks that we omitted</span></div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;<span class="comment">  here for the sake of brevity. Furthermore, these meshes</span></div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;<span class="comment">  can be used with \c GeomObjects that comprise &quot;sub-&quot;\c</span></div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;<span class="comment">  GeomObjects, a feature that is essential in problems with</span></div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;<span class="comment">  proper fluid-structure interaction. We will discuss this in </span></div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;<span class="comment">  &lt;A HREF=&quot;../../../interaction/fsi_collapsible_channel_algebraic/html/index.html&quot;&gt;</span></div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;<span class="comment">  another example.&lt;/A&gt;</span></div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;<span class="comment">  </span></div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;<span class="comment">\subsection exx Exercises</span></div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;<span class="comment">-# If you inspect the  </span></div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;<span class="comment">   &lt;A HREF=&quot;../../../../demo_drivers/navier_stokes/collapsible_channel/my_alg_channel_mesh.h&quot;&gt;source</span></div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;<span class="comment">code&lt;/A&gt; </span></div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;<span class="comment">   for the \c MyAlgebraicCollapsibleChannelMesh, you will notice that</span></div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;<span class="comment">   the mesh has an additional constructor that allows the</span></div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;<span class="comment">   specification of the &quot;boundary layer squash function&quot; first </span></div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;<span class="comment">   introduced in the original \c CollapsibleChannelMesh. </span></div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;<span class="comment">   Explain why in the \c AlgebraicMesh version of this mesh, the</span></div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;<span class="comment">   function pointer to the &quot;boundary layer</span></div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;<span class="comment">   squash function&quot; can only be specified via the constructor -- the </span></div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;<span class="comment">   access function is deliberately broken.</span></div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;<span class="comment">\section sources Source files for this tutorial</span></div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;<span class="comment">- The source files for this tutorial are located in the directory:\n\n</span></div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;<span class="comment">&lt;CENTER&gt;</span></div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;<span class="comment">&lt;A HREF=&quot;../../../../demo_drivers/navier_stokes/collapsible_channel/&quot;&gt;</span></div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;<span class="comment">demo_drivers/navier_stokes/collapsible_channel/</span></div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;<span class="comment">&lt;/A&gt;</span></div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;<span class="comment">&lt;/CENTER&gt;\n</span></div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;<span class="comment">- The driver code is: \n\n</span></div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;<span class="comment">&lt;CENTER&gt;</span></div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;<span class="comment">&lt;A HREF=&quot;../../../../demo_drivers/navier_stokes/collapsible_channel/collapsible_channel_algebraic.cc&quot;&gt;</span></div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;<span class="comment">demo_drivers/navier_stokes/collapsible_channel/collapsible_channel_algebraic.cc</span></div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;<span class="comment">&lt;/A&gt;</span></div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;<span class="comment">&lt;/CENTER&gt;</span></div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;<span class="comment">.</span></div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;<span class="comment">&lt;hr&gt;</span></div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;<span class="comment">&lt;hr&gt;</span></div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;<span class="comment">\section pdf PDF file</span></div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;<span class="comment">A &lt;a href=&quot;../latex/refman.pdf&quot;&gt;pdf version&lt;/a&gt; of this document is available.</span></div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;<span class="comment">**/</span></div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160; </div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="aalgebraic__collapsible__channel_8txt_html_aa10b5364beaced5a17381e9ce69e10b0"><div class="ttname"><a href="algebraic__collapsible__channel_8txt.html#aa10b5364beaced5a17381e9ce69e10b0">L_</a></div><div class="ttdeci">&lt; HR &gt; subsection setting_up Setting up the algebraic node update When the function c the constructor of the underlying c CollapsibleChannelMesh will already have created the mesh s elements and and the nodes will be located at their initial positions in the undeformed domain To set up the algebraic node update we start by extracting the lengths of the upstream rigid f L_</div><div class="ttdef"><b>Definition:</b> <a href="algebraic__collapsible__channel_8txt_source.html#l00244">algebraic_collapsible_channel.txt:244</a></div></div>
<div class="ttc" id="aalgebraic__collapsible__channel_8txt_html_a7e97ac933d366bc3753e03932028b5c6"><div class="ttname"><a href="algebraic__collapsible__channel_8txt.html#a7e97ac933d366bc3753e03932028b5c6">segment</a></div><div class="ttdeci">&lt; HR &gt; subsection setting_up Setting up the algebraic node update When the function c the constructor of the underlying c CollapsibleChannelMesh will already have created the mesh s elements and and the nodes will be located at their initial positions in the undeformed domain To set up the algebraic node update we start by extracting the lengths of the upstream rigid f and the length of the collapsible segment</div><div class="ttdef"><b>Definition:</b> <a href="algebraic__collapsible__channel_8txt_source.html#l00245">algebraic_collapsible_channel.txt:245</a></div></div>
<div class="ttc" id="aalgebraic__collapsible__channel_8txt_html_a0dc44f34a836b7b9cdeda9a988c97756"><div class="ttname"><a href="algebraic__collapsible__channel_8txt.html#a0dc44f34a836b7b9cdeda9a988c97756">t</a></div><div class="ttdeci">endcode which must be implemented in every specific c AlgebraicMesh Its task is to update the position of the node specified by the pointer valued argument n n The specific implementation of the node update operation is obviously problem dependent but it is easy to illustrate the general procedure by considering the collapsible channel mesh sketched t</div><div class="ttdef"><b>Definition:</b> <a href="algebraic__collapsible__channel_8txt_source.html#l00087">algebraic_collapsible_channel.txt:87</a></div></div>
<div class="ttc" id="aalgebraic__collapsible__channel_8txt_html_a72a47bdc6a0d5435cd93d8e17ab16cd1"><div class="ttname"><a href="algebraic__collapsible__channel_8txt.html#a72a47bdc6a0d5435cd93d8e17ab16cd1">AlgebraicElement</a></div><div class="ttdeci">mainpage Demo curvilinear boundaries for once the curvilinear domain is represented by a c Domain object domain boundaries n n in the position of the domain s curvilinear boundaries may be performed by the black box function c either because the mesh deformation generated by the black box procedure is not appropriate or because it is not efficient The latter problem arises particularly in fluid structure interaction problems In this tutorial we shall demonstrate an alternative node update based on c oomph lib s c c AlgebraicElement</div><div class="ttdef"><b>Definition:</b> <a href="algebraic__collapsible__channel_8txt_source.html#l00048">algebraic_collapsible_channel.txt:48</a></div></div>
<div class="ttc" id="aalgebraic__collapsible__channel_8txt_html_ac923024cc66afc5643976daa05c664f2"><div class="ttname"><a href="algebraic__collapsible__channel_8txt.html#ac923024cc66afc5643976daa05c664f2">nodes</a></div><div class="ttdeci">&lt; HR &gt; subsection setting_up Setting up the algebraic node update When the function c the constructor of the underlying c CollapsibleChannelMesh will already have created the mesh s elements and nodes</div><div class="ttdef"><b>Definition:</b> <a href="algebraic__collapsible__channel_8txt_source.html#l00239">algebraic_collapsible_channel.txt:239</a></div></div>
<div class="ttc" id="aalgebraic__collapsible__channel_8txt_html_a7b1d3a5d6e218b2bf33cb350d2e27df9"><div class="ttname"><a href="algebraic__collapsible__channel_8txt.html#a7b1d3a5d6e218b2bf33cb350d2e27df9">data</a></div><div class="ttdeci">&lt; HR &gt; subsection setting_up Setting up the algebraic node update When the function c the constructor of the underlying c CollapsibleChannelMesh will already have created the mesh s elements and and the nodes will be located at their initial positions in the undeformed domain To set up the algebraic node update data</div><div class="ttdef"><b>Definition:</b> <a href="algebraic__collapsible__channel_8txt_source.html#l00243">algebraic_collapsible_channel.txt:243</a></div></div>
<div class="ttc" id="aalgebraic__collapsible__channel_8txt_html_aeffd03a6d116d17198b42167719e462c"><div class="ttname"><a href="algebraic__collapsible__channel_8txt.html#aeffd03a6d116d17198b42167719e462c">simple</a></div><div class="ttdeci">mainpage Demo curvilinear boundaries for once the curvilinear domain is represented by a c Domain object domain boundaries n n in the position of the domain s curvilinear boundaries may be performed by the black box function c either because the mesh deformation generated by the black box procedure is not appropriate or because it is not efficient The latter problem arises particularly in fluid structure interaction problems In this tutorial we shall demonstrate an alternative node update based on c oomph lib s c c and c AlgebraicMesh classes The key feature of this approach is that it allows each node to update its own position This is in contrast to the c Domain MacroElement based approach in which we can only update the nodal positions of e all nodes in the mesh simultaneously not a particularly sparse operation[We note that the \c Node and \c FiniteElement base classesprovide the virtual functions \c Node::node_update() and \c FiniteElement::node_update(). These functions are intendedto be used for node-by-node or element-by-element node-updates butin their default implementations they are empty. Hence no node-update isperformed unless these functions are overloaded in derived classessuch as \c AlgebraicNode and \c AlgebraicElement.]&lt; HR &gt;&lt; HR &gt; section overview Overview The idea behind the algebraic node updates is simple</div><div class="ttdef"><b>Definition:</b> <a href="algebraic__collapsible__channel_8txt_source.html#l00071">algebraic_collapsible_channel.txt:71</a></div></div>
<div class="ttc" id="aalgebraic__collapsible__channel_8txt_html_a68b1caea0bdc42e4517fb850fe372805"><div class="ttname"><a href="algebraic__collapsible__channel_8txt.html#a68b1caea0bdc42e4517fb850fe372805">technique</a></div><div class="ttdeci">mainpage Demo curvilinear boundaries for once the curvilinear domain is represented by a c Domain object domain boundaries n n in the position of the domain s curvilinear boundaries may be performed by the black box function c either because the mesh deformation generated by the black box procedure is not appropriate or because it is not efficient The latter problem arises particularly in fluid structure interaction problems In this tutorial we shall demonstrate an alternative node update technique</div><div class="ttdef"><b>Definition:</b> <a href="algebraic__collapsible__channel_8txt_source.html#l00047">algebraic_collapsible_channel.txt:47</a></div></div>
<div class="ttc" id="aalgebraic__collapsible__channel_8txt_html_a5af91bb353f2d2177a4e348406985a40"><div class="ttname"><a href="algebraic__collapsible__channel_8txt.html#a5af91bb353f2d2177a4e348406985a40">setup_algebraic_node_update</a></div><div class="ttdeci">&lt; HR &gt; subsection setting_up Setting up the algebraic node update When the function c setup_algebraic_node_update() is called</div></div>
<div class="ttc" id="aalgebraic__collapsible__channel_8txt_html_a9726c2841c7dd7a3e70136e92847254b"><div class="ttname"><a href="algebraic__collapsible__channel_8txt.html#a9726c2841c7dd7a3e70136e92847254b">AlgebraicNode</a></div><div class="ttdeci">mainpage Demo curvilinear boundaries for once the curvilinear domain is represented by a c Domain object domain boundaries n n in the position of the domain s curvilinear boundaries may be performed by the black box function c either because the mesh deformation generated by the black box procedure is not appropriate or because it is not efficient The latter problem arises particularly in fluid structure interaction problems In this tutorial we shall demonstrate an alternative node update based on c oomph lib s c AlgebraicNode</div><div class="ttdef"><b>Definition:</b> <a href="algebraic__collapsible__channel_8txt_source.html#l00047">algebraic_collapsible_channel.txt:47</a></div></div>
<div class="ttc" id="aalgebraic__collapsible__channel_8txt_html_ac0f34caed2e36d9333a34feb158f41cb"><div class="ttname"><a href="algebraic__collapsible__channel_8txt.html#ac0f34caed2e36d9333a34feb158f41cb">section</a></div><div class="ttdeci">&lt; HR &gt; subsection setting_up Setting up the algebraic node update When the function c the constructor of the underlying c CollapsibleChannelMesh will already have created the mesh s elements and and the nodes will be located at their initial positions in the undeformed domain To set up the algebraic node update we start by extracting the lengths of the upstream rigid section</div><div class="ttdef"><b>Definition:</b> <a href="algebraic__collapsible__channel_8txt_source.html#l00244">algebraic_collapsible_channel.txt:244</a></div></div>
<div class="ttc" id="aalgebraic__collapsible__channel_8txt_html_a4074baada03976c061d5672f4237cca5"><div class="ttname"><a href="algebraic__collapsible__channel_8txt.html#a4074baada03976c061d5672f4237cca5">problem</a></div><div class="ttdeci">mainpage Demo problem</div><div class="ttdef"><b>Definition:</b> <a href="algebraic__collapsible__channel_8txt_source.html#l00005">algebraic_collapsible_channel.txt:5</a></div></div>
<div class="ttc" id="aalgebraic__collapsible__channel_8txt_html_a563872ee894f8742728abd3429be29ac"><div class="ttname"><a href="algebraic__collapsible__channel_8txt.html#a563872ee894f8742728abd3429be29ac">f</a></div><div class="ttdeci">&lt; HR &gt; subsection setting_up Setting up the algebraic node update When the function c the constructor of the underlying c CollapsibleChannelMesh will already have created the mesh s elements and and the nodes will be located at their initial positions in the undeformed domain To set up the algebraic node update we start by extracting the lengths of the upstream rigid f and the length of the collapsible f from the c we loop over all c AlgebraicNodes in the mesh and determine their current f zeta_j f</div><div class="ttdef"><b>Definition:</b> <a href="algebraic__collapsible__channel_8txt_source.html#l00259">algebraic_collapsible_channel.txt:259</a></div></div>
<div class="ttc" id="anamespaceoomph_html"><div class="ttname"><a href="namespaceoomph.html">oomph</a></div><div class="ttdef"><b>Definition:</b> <a href="my__alg__channel__mesh_8h_source.html#l00040">my_alg_channel_mesh.h:40</a></div></div>
<div class="ttc" id="aalgebraic__collapsible__channel_8txt_html_af08331fcf6fcc367aae81f33c48d1cc7"><div class="ttname"><a href="algebraic__collapsible__channel_8txt.html#af08331fcf6fcc367aae81f33c48d1cc7">positions</a></div><div class="ttdeci">&lt; HR &gt; subsection setting_up Setting up the algebraic node update When the function c the constructor of the underlying c CollapsibleChannelMesh will already have created the mesh s elements and and the nodes will be located at their initial positions in the undeformed domain To set up the algebraic node update we start by extracting the lengths of the upstream rigid f and the length of the collapsible f from the c we loop over all c AlgebraicNodes in the mesh and determine their current positions</div><div class="ttdef"><b>Definition:</b> <a href="algebraic__collapsible__channel_8txt_source.html#l00259">algebraic_collapsible_channel.txt:259</a></div></div>
<div class="ttc" id="aalgebraic__collapsible__channel_8txt_html_adc983c93246415f5a4325cde895c26e6"><div class="ttname"><a href="algebraic__collapsible__channel_8txt.html#adc983c93246415f5a4325cde895c26e6">instance</a></div><div class="ttdeci">mainpage Demo curvilinear boundaries for instance</div><div class="ttdef"><b>Definition:</b> <a href="algebraic__collapsible__channel_8txt_source.html#l00028">algebraic_collapsible_channel.txt:28</a></div></div>
<div class="ttc" id="aalgebraic__collapsible__channel_8txt_html_a2e1eb542c66e8c9c1b10328c1ad57f7f"><div class="ttname"><a href="algebraic__collapsible__channel_8txt.html#a2e1eb542c66e8c9c1b10328c1ad57f7f">below</a></div><div class="ttdeci">endcode which must be implemented in every specific c AlgebraicMesh Its task is to update the position of the node specified by the pointer valued argument n n The specific implementation of the node update operation is obviously problem dependent but it is easy to illustrate the general procedure by considering the collapsible channel mesh sketched below</div><div class="ttdef"><b>Definition:</b> <a href="algebraic__collapsible__channel_8txt_source.html#l00087">algebraic_collapsible_channel.txt:87</a></div></div>
<div class="ttc" id="aalgebraic__collapsible__channel_8txt_html_a7d1d40aa4faf63e8d5a30a3804465863"><div class="ttname"><a href="algebraic__collapsible__channel_8txt.html#a7d1d40aa4faf63e8d5a30a3804465863">CollapsibleChannelDomain</a></div><div class="ttdeci">&lt; HR &gt; subsection setting_up Setting up the algebraic node update When the function c the constructor of the underlying c CollapsibleChannelMesh will already have created the mesh s elements and and the nodes will be located at their initial positions in the undeformed domain To set up the algebraic node update we start by extracting the lengths of the upstream rigid f and the length of the collapsible f from the c CollapsibleChannelDomain</div><div class="ttdef"><b>Definition:</b> <a href="algebraic__collapsible__channel_8txt_source.html#l00251">algebraic_collapsible_channel.txt:251</a></div></div>

    <!-- jQuery for Bootstrap and Doxygen -->
    <script src="../../../js/jquery-1.12.0.min.js"></script>
    <!-- Minified boostrap plugins-->
    <script src="../../../js/bootstrap.js"></script>
    <!-- Doxygen dependency to add powertips to source code-->
    <script src="../../../js/jquery.powertip.min.js"></script>
    <!-- The  following script is generated by doxygen and hides/shows levels in 
         the data structure lists and adds powertips to source code-->
    <script src="../../../js/dynsections.js" ></script>
    <!-- add to Doxygen's class names so bootstrap css and js recognises them-->
    <script type="text/javascript">
    $(".contents").addClass("container");
    $(".header").addClass("container");
    $(".navpath").addClass("container");
    $("#navrow3").addClass("container");
    $("#navrow4").addClass("container");
    $(".mlabel").addClass("label");
    $(".mlabel").addClass("label-default");
    $(".memitem").addClass("panel");
    $(".memitem").addClass("panel-info");
    $(".memproto").addClass("panel-heading");
    $(".memdoc").addClass("panel-body");
    </script>
    <footer>
      <div class="container">
        <div class="text-muted" style="float:right;">Generated by <a href="http://www.doxygen.org/index.html">
          <img style="height:18px;" class="footer-img" src="doxygen.png" alt="doxygen"></a> on Fri Jul 9 2021 15:10:23
        </div>
      </div>
    </footer>
</body>
</html>

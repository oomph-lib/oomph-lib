<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
<title>oomph-lib: inclined_plane.cc Source File</title>
<link rel="apple-touch-icon" sizes="57x57" href="../../../figures/apple-touch-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="../../../figures/apple-touch-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="../../../figures/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="../../../figures/apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="../../../figures/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="../../../figures/apple-touch-icon-120x120.png">
<link rel="icon" type="image/png" href="../../../figures/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="../../../figures/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="../../../figures/favicon-16x16.png" sizes="16x16">
<link rel="manifest" href="../../../figures/manifest.json">
<link rel="mask-icon" href="../../../figures/safari-pinned-tab.svg" color="#008000">
<link rel="shortcut icon" href="../../../figures/favicon.ico">
<meta name="msapplication-TileColor" content="#00a300">
<meta name="msapplication-config" content="../../../figures/browserconfig.xml">
<meta name="theme-color" content="#008000">
<link href="http://fonts.googleapis.com/css?family=Open+Sans:400,300,600" rel="stylesheet" type="text/css">
<!-- Doxygen css-->
<!-- <link rel="stylesheet" type="text/css" href="doxygen.css"> -->
<!-- Bootstrap -->
<link href="../../../css/bootstrap.css" rel="stylesheet">
<!-- oomph-lib specific overrides -->
<link rel="stylesheet" type="text/css" href="../../../css/oomph_header.css">
</head>
<body>
<nav class="navbar navbar-default">
<div class="container">
<div class="container-fluid">
  <!-- Brand and toggle get grouped for better mobile display -->
  <div class="navbar-header">
    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
      <span class="sr-only">Toggle navigation</span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="../../../html/index.html"><img alt="oomph-lib" src="../../../figures/oomph_logo.png"></a>
  </div>
  <!-- Collect the nav links, forms, and other content for toggling -->
  <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
    <ul class="nav navbar-nav">          
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Documentation <span class="caret"></span></a>
        <ul class="dropdown-menu">
          <li class="dropdown-header">Big picture</li>
          <li><a href="../../../../doc/intro/html/index.html">The finite element method</a></li>
          <li><a href="../../../../doc/the_data_structure/html/index.html">The data structure</a></li>
          <li><a href="../../../../doc/quick_guide/html/index.html">Not-so-quick guide</a></li>
          <li><a href="../../../../doc/optimisation/html/index.html">Optimisation</a></li>
          <li><a href="../../../../doc/order_of_action_functions/html/index.html">Order of action functions</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Example codes and tutorials</li>
          <li><a href="../../../../doc/example_code_list/html/index.html">List of example codes and tutorials</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#meshes">Meshing</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#solvers">Solvers</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#parallel">MPI parallel processing</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#visualisation">Post-processing/visualisation</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Other</li>
          <li><a href="../../../../doc/change_log/html/index.html">Change log</a></li>
          <li><a href="../../../../doc/creating_doc/html/index.html">Creating documentation</a></li>
          <li><a href="../../../../doc/coding_conventions/html/index.html">Coding conventions</a></li>
          <li><a href="../../../../doc/index/html/index.html">Index</a></li>
          <li><a href="../../../../doc/FAQ/html/index.html">FAQ</a></li>
        </ul>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Get it <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../../doc/the_distribution/html/index.html">Installation guide</a></li>
            <li><a href="../../../../doc/subversion/html/index.html">Get code from subversion repository</a></li>
            <li><a href="../../../../doc/download/html/index.html">Get code as tar file</a></li>
            <li><a href="../../../../doc/copyright/html/index.html">Copyright</a></li>
          </ul>
        </li>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">About <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../../doc/people/html/index.html">People</a></li>            
            <li><a href="../../../../doc/contact/html/index.html">Contact/Get involved</a></li>
            <li><a href="../../../../doc/publications/html/index.html">Publications</a></li>
            <li><a href="../../../../doc/acknowledgements/html/index.html">Acknowledgements</a></li>
            <li><a href="../../../../doc/picture_show/index.html">Picture show</a></li>
          </ul>
        </li>
      </li>
    </ul>
    <ul class="nav navbar-nav navbar-right navbar-search">
      <form class="navbar-form" role="search" action="../../../../doc/search_results/html/index.html">
        <div class="input-group">
          <input type="text" class="form-control" placeholder="Search" name="q">
          <span class="input-group-btn">
            <button class="btn btn-default" type="submit">Go</button>
          </span>
        </div><!-- /input-group -->
       <!--<div class="form-group">
          <input type="text" class="form-control" placeholder="Search">
        </div>
        <button type="submit" class="btn btn-default">Submit</button>-->
      </form>
    </ul>
  </div><!-- /.navbar-collapse -->
</div><!-- /.container-fluid -->
</div>
</nav>
<!-- Generated by Doxygen 1.8.17 -->
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_ddb094a380b94394dbbcf95a63b535e6.html">demo_drivers</a></li><li class="navelem"><a class="el" href="dir_600eb748837abd3a599f824dcb8c690e.html">navier_stokes</a></li><li class="navelem"><a class="el" href="dir_eaa02f43beeaae204de1b1831a9c6886.html">inclined_plane</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">inclined_plane.cc</div>  </div>
</div><!--header-->
<div class="contents">
<a href="inclined__plane_8cc.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">//LIC// ====================================================================</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">//LIC// This file forms part of oomph-lib, the object-oriented, </span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">//LIC// multi-physics finite-element library, available </span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">//LIC// at http://www.oomph-lib.org.</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">//LIC// Copyright (C) 2006-2021 Matthias Heil and Andrew Hazel</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">//LIC// This library is free software; you can redistribute it and/or</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">//LIC// modify it under the terms of the GNU Lesser General Public</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">//LIC// License as published by the Free Software Foundation; either</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">//LIC// version 2.1 of the License, or (at your option) any later version.</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">//LIC// This library is distributed in the hope that it will be useful,</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">//LIC// but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">//LIC// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">//LIC// Lesser General Public License for more details.</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">//LIC// You should have received a copy of the GNU Lesser General Public</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">//LIC// License along with this library; if not, write to the Free Software</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">//LIC// Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">//LIC// 02110-1301  USA.</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">//LIC// The authors may be contacted at oomph-lib@maths.man.ac.uk.</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">//LIC//====================================================================</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">//A demo driver that solves the classic fluid flow problem of flow</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">//of a fluid film along an inclined plane. Stability analysis performed by </span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment">//Yih (1963), Benjamin (1957), ... and Blyth &amp; Pozrikidis (2004).</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160; </div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">//This is an example of the subtleties involved in even a seemingly simple</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment">//free surface problem.</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160; </div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment">//Standard C++ library includes</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#include &lt;fstream&gt;</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#include &lt;string&gt;</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="preprocessor">#include &lt;cmath&gt;</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160; </div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment">//Finite-Element library routines</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="preprocessor">#include &quot;generic.h&quot;</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="preprocessor">#include &quot;navier_stokes.h&quot;</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="preprocessor">#include &quot;solid.h&quot;</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="preprocessor">#include &quot;fluid_interface.h&quot;</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="preprocessor">#include &quot;meshes/simple_rectangular_quadmesh.h&quot;</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160; </div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="keyword">using namespace </span>std;</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160; </div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="keyword">using namespace </span>oomph;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160; </div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment">//The global physical variables</span></div>
<div class="line"><a name="l00051"></a><span class="lineno"><a class="line" href="namespaceGlobal__Physical__Variables.html">   51</a></span>&#160;<span class="keyword">namespace </span><a class="code" href="namespaceGlobal__Physical__Variables.html">Global_Physical_Variables</a></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;{<span class="comment"></span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment"> ///Reynolds number, based on the average velocity within the fluid film</span></div>
<div class="line"><a name="l00054"></a><span class="lineno"><a class="line" href="namespaceGlobal__Physical__Variables.html#ab814e627d2eb5bc50318879d19ab16b9">   54</a></span>&#160;<span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="inclined__plane_8txt.html#aa0f8159f7168040576baa2fd5f94acb1">Re</a>=0.0;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment"> ///The product of Reynolds number and inverse Froude number </span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="comment"> ///is set to two in this problem, which gives the free surface velocity</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment"> ///to be sin(alpha). [Set to three in order to get the same scale as </span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment"> ///used by Yih, Benjamin, etc]</span></div>
<div class="line"><a name="l00060"></a><span class="lineno"><a class="line" href="namespaceGlobal__Physical__Variables.html#aa6286f02b476912dd7550eced538331a">   60</a></span>&#160;<span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="namespaceGlobal__Physical__Variables.html#aa6286f02b476912dd7550eced538331a">ReInvFr</a>=2.0;</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment"> ///Angle of incline of the slope (45 degrees)</span></div>
<div class="line"><a name="l00063"></a><span class="lineno"><a class="line" href="namespaceGlobal__Physical__Variables.html#aa2e802ee7cc8e1ac900ba94c3ce86eb7">   63</a></span>&#160;<span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="namespaceGlobal__Physical__Variables.html#aa2e802ee7cc8e1ac900ba94c3ce86eb7">Alpha</a> = 1.0*atan(1.0);</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment"> ///\short The Vector direction of gravity, set in main()</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment"></span> Vector&lt;double&gt; <a class="code" href="namespaceGlobal__Physical__Variables.html#aa868968dead376240a69f9152bd599b9">G</a>(2,0.0);</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment"> ///The Capillary number</span></div>
<div class="line"><a name="l00069"></a><span class="lineno"><a class="line" href="namespaceGlobal__Physical__Variables.html#a8b32b93d2e546f9375ec418474107838">   69</a></span>&#160;<span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="inclined__plane_8txt.html#a578f5c14427faf3876df90e82c7d8fbe">Ca</a>= 1.0;</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="comment"> ///Set the wavenumber</span></div>
<div class="line"><a name="l00072"></a><span class="lineno"><a class="line" href="namespaceGlobal__Physical__Variables.html#a9da8be10d9e20eb0329af7fd8d6e0e98">   72</a></span>&#160;<span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="namespaceGlobal__Physical__Variables.html#a9da8be10d9e20eb0329af7fd8d6e0e98">K</a> = 0.1;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="comment"> ///Set the number of waves desired in the domain</span></div>
<div class="line"><a name="l00075"></a><span class="lineno"><a class="line" href="namespaceGlobal__Physical__Variables.html#adf0e913323310713bf58ec469fb586e6">   75</a></span>&#160;<span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="namespaceGlobal__Physical__Variables.html#adf0e913323310713bf58ec469fb586e6">N_wave</a> = 3;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="comment"> ///The length of the domain to fit the desired number of waves</span></div>
<div class="line"><a name="l00078"></a><span class="lineno"><a class="line" href="namespaceGlobal__Physical__Variables.html#a987847160c3cfad8977836291fb9d0e0">   78</a></span>&#160;<span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="namespaceGlobal__Physical__Variables.html#a987847160c3cfad8977836291fb9d0e0">Length</a> = 2*<a class="code" href="namespaceGlobal__Physical__Variables.html#adf0e913323310713bf58ec469fb586e6">N_wave</a>*4.0*atan(1.0)/<a class="code" href="namespaceGlobal__Physical__Variables.html#a9da8be10d9e20eb0329af7fd8d6e0e98">K</a>;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="comment"> ///Direction of the wall normal vector (at the inlet)</span></div>
<div class="line"><a name="l00081"></a><span class="lineno"><a class="line" href="namespaceGlobal__Physical__Variables.html#a5feb3df21fc4a0adefadecb8a8ed98d7">   81</a></span>&#160;<span class="comment"></span> Vector&lt;double&gt; <a class="code" href="namespaceGlobal__Physical__Variables.html#a5feb3df21fc4a0adefadecb8a8ed98d7">Wall_normal</a>;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="comment"> /// \short Function that specifies the wall unit normal at the inlet</span></div>
<div class="line"><a name="l00084"></a><span class="lineno"><a class="line" href="namespaceGlobal__Physical__Variables.html#aa26e74c1f9f93f8212e45380f55fb562">   84</a></span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="namespaceGlobal__Physical__Variables.html#aa26e74c1f9f93f8212e45380f55fb562">wall_unit_normal_inlet_fct</a>(<span class="keyword">const</span> Vector&lt;double&gt; &amp;<a class="code" href="inclined__plane_8txt.html#a54012ea45635a54675f4997d85309327">x</a>, </div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;                                 Vector&lt;double&gt; &amp;normal)</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160; {</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  normal=<a class="code" href="namespaceGlobal__Physical__Variables.html#a5feb3df21fc4a0adefadecb8a8ed98d7">Wall_normal</a>;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160; }</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="comment"> /// \short Function that specified the wall unit normal at the outlet</span></div>
<div class="line"><a name="l00091"></a><span class="lineno"><a class="line" href="namespaceGlobal__Physical__Variables.html#a8ab8f6e823e4cd204ed7264121a42bfb">   91</a></span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="namespaceGlobal__Physical__Variables.html#a8ab8f6e823e4cd204ed7264121a42bfb">wall_unit_normal_outlet_fct</a>(<span class="keyword">const</span> Vector&lt;double&gt; &amp;<a class="code" href="inclined__plane_8txt.html#a54012ea45635a54675f4997d85309327">x</a>, </div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;                                 Vector&lt;double&gt; &amp;normal)</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160; {</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  <span class="comment">//Set the normal</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  normal = <a class="code" href="namespaceGlobal__Physical__Variables.html#a5feb3df21fc4a0adefadecb8a8ed98d7">Wall_normal</a>;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  <span class="comment">//and flip the sign</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  <span class="keywordtype">unsigned</span> n_dim = normal.size();</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i=0;i&lt;n_dim;++i) {normal[i] *= -1.0;}</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160; }</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="comment"> ///The contact angle that is imposed at the inlet (pi)</span></div>
<div class="line"><a name="l00102"></a><span class="lineno"><a class="line" href="namespaceGlobal__Physical__Variables.html#a1c3587461447262715bd444ac91a29c9">  102</a></span>&#160;<span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="namespaceGlobal__Physical__Variables.html#a1c3587461447262715bd444ac91a29c9">Inlet_Angle</a> = 2.0*atan(1.0);</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160; </div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="comment"> /// Function that prescribes the hydrostatic pressure field at the outlet</span></div>
<div class="line"><a name="l00106"></a><span class="lineno"><a class="line" href="namespaceGlobal__Physical__Variables.html#ab577639e7c51979d3db7565c08c69c70">  106</a></span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="namespaceGlobal__Physical__Variables.html#ab577639e7c51979d3db7565c08c69c70">hydrostatic_pressure_outlet</a>(<span class="keyword">const</span> <span class="keywordtype">double</span>&amp; time, <span class="keyword">const</span> Vector&lt;double&gt; &amp;<a class="code" href="inclined__plane_8txt.html#a54012ea45635a54675f4997d85309327">x</a>, </div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;                                  <span class="keyword">const</span> Vector&lt;double&gt; &amp;n, </div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;                                  Vector&lt;double&gt; &amp;traction)</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160; {</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  traction[0] = <a class="code" href="namespaceGlobal__Physical__Variables.html#aa6286f02b476912dd7550eced538331a">ReInvFr</a>*<a class="code" href="namespaceGlobal__Physical__Variables.html#aa868968dead376240a69f9152bd599b9">G</a>[1]*(1.0 - <a class="code" href="inclined__plane_8txt.html#a54012ea45635a54675f4997d85309327">x</a>[1]);</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  traction[1] = 0.0;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160; }</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="comment"> /// Function that prescribes hydrostatic pressure field at the inlet</span></div>
<div class="line"><a name="l00115"></a><span class="lineno"><a class="line" href="namespaceGlobal__Physical__Variables.html#af1f48eb04a3c7f97b1efacea533acdbc">  115</a></span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="namespaceGlobal__Physical__Variables.html#af1f48eb04a3c7f97b1efacea533acdbc">hydrostatic_pressure_inlet</a>(<span class="keyword">const</span> <span class="keywordtype">double</span>&amp; time, <span class="keyword">const</span> Vector&lt;double&gt; &amp;<a class="code" href="inclined__plane_8txt.html#a54012ea45635a54675f4997d85309327">x</a>, </div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;                                 <span class="keyword">const</span> Vector&lt;double&gt; &amp;n,</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;                                 Vector&lt;double&gt; &amp;traction)</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160; {</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  traction[0] = -<a class="code" href="namespaceGlobal__Physical__Variables.html#aa6286f02b476912dd7550eced538331a">ReInvFr</a>*<a class="code" href="namespaceGlobal__Physical__Variables.html#aa868968dead376240a69f9152bd599b9">G</a>[1]*(1.0 - <a class="code" href="inclined__plane_8txt.html#a54012ea45635a54675f4997d85309327">x</a>[1]);</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  traction[1] = 0.0;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160; }</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160; <span class="comment">//end of traction functions</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="comment"> ///Constitutive law used to determine the mesh deformation</span></div>
<div class="line"><a name="l00125"></a><span class="lineno"><a class="line" href="namespaceGlobal__Physical__Variables.html#a2a37fb040c832ee7a086bb13bb02a100">  125</a></span>&#160;<span class="comment"></span> ConstitutiveLaw *<a class="code" href="namespaceGlobal__Physical__Variables.html#a2a37fb040c832ee7a086bb13bb02a100">Constitutive_law_pt</a>;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="comment"> /// Pseudo-solid Poisson ratio</span></div>
<div class="line"><a name="l00128"></a><span class="lineno"><a class="line" href="namespaceGlobal__Physical__Variables.html#a3962c36313826b19f216f6bbbdd6a477">  128</a></span>&#160;<span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="namespaceGlobal__Physical__Variables.html#a3962c36313826b19f216f6bbbdd6a477">Nu</a>=0.1;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160; </div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;}</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160; </div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="comment">//=====================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="comment">///\short Generic problem class that will form the base class for both </span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="comment">///spine and elastic mesh-updates of the problem.</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="comment">///Templated by the bulk element and interface element types</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="comment"></span><span class="comment">//====================================================================</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> ELEMENT, <span class="keyword">class</span> INTERFACE_ELEMENT&gt;</div>
<div class="line"><a name="l00138"></a><span class="lineno"><a class="line" href="classInclinedPlaneProblem.html">  138</a></span>&#160;<span class="keyword">class </span><a class="code" href="classInclinedPlaneProblem.html">InclinedPlaneProblem</a> : <span class="keyword">public</span> Problem</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;{</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160; </div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="keyword">protected</span>:</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="comment"> ///Bulk fluid mesh</span></div>
<div class="line"><a name="l00144"></a><span class="lineno"><a class="line" href="classInclinedPlaneProblem.html#a20c506fe684dc146424b8ec019239783">  144</a></span>&#160;<span class="comment"></span> Mesh* <a class="code" href="classInclinedPlaneProblem.html#a20c506fe684dc146424b8ec019239783">Bulk_mesh_pt</a>;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="comment"> ///Mesh for the traction elements that are added at inlet and outlet</span></div>
<div class="line"><a name="l00147"></a><span class="lineno"><a class="line" href="classInclinedPlaneProblem.html#a85bcc36a8ad4ad7aa3595585e73a3197">  147</a></span>&#160;<span class="comment"></span> Mesh* <a class="code" href="classInclinedPlaneProblem.html#a85bcc36a8ad4ad7aa3595585e73a3197">Traction_mesh_pt</a>;</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="comment"> ///Mesh for the free surface elements</span></div>
<div class="line"><a name="l00150"></a><span class="lineno"><a class="line" href="classInclinedPlaneProblem.html#aba36d367278218bf00356c3bee0733a0">  150</a></span>&#160;<span class="comment"></span> Mesh* <a class="code" href="classInclinedPlaneProblem.html#aba36d367278218bf00356c3bee0733a0">Surface_mesh_pt</a>;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="comment"> ///Mesh for the point elements at each end of the free surface</span></div>
<div class="line"><a name="l00153"></a><span class="lineno"><a class="line" href="classInclinedPlaneProblem.html#adefbac5880323d7de622e2ba0c526746">  153</a></span>&#160;<span class="comment"></span> Mesh* <a class="code" href="classInclinedPlaneProblem.html#adefbac5880323d7de622e2ba0c526746">Point_mesh_pt</a>;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="comment"> ///Prefix for output files</span></div>
<div class="line"><a name="l00156"></a><span class="lineno"><a class="line" href="classInclinedPlaneProblem.html#a6ad45c76bd24f63c0162313042ce2e7d">  156</a></span>&#160;<span class="comment"></span> std::string <a class="code" href="classInclinedPlaneProblem.html#a6ad45c76bd24f63c0162313042ce2e7d">Output_prefix</a>;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160; </div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="comment"> ///Generic Constructor (empty)</span></div>
<div class="line"><a name="l00161"></a><span class="lineno"><a class="line" href="classInclinedPlaneProblem.html#a52d15d242c8f17a340914996b49a32a3">  161</a></span>&#160;<span class="comment"></span> <a class="code" href="classInclinedPlaneProblem.html#a52d15d242c8f17a340914996b49a32a3">InclinedPlaneProblem</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;nx, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;ny,</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;                      <span class="keyword">const</span> <span class="keywordtype">double</span> &amp;length) :</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;  Output_prefix(<span class="stringliteral">&quot;Unset&quot;</span>) { }</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="comment"> ///Solve the steady problem</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> solve_steady();</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="comment"> ///Take n_tsteps timesteps of size dt</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> timestep(<span class="keyword">const</span> <span class="keywordtype">double</span> &amp;dt, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;n_tsteps);</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="comment"> /// \short Actions before the timestep </span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="comment"> /// (update the time-dependent boundary conditions)</span></div>
<div class="line"><a name="l00173"></a><span class="lineno"><a class="line" href="classInclinedPlaneProblem.html#af9cf7a9677e823c52f1646105dfa7937">  173</a></span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classInclinedPlaneProblem.html#af9cf7a9677e823c52f1646105dfa7937">actions_before_implicit_timestep</a>()</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  {</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;   <span class="comment">//Read out the current time</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;   <span class="keywordtype">double</span> time = this-&gt;time_pt()-&gt;time();</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;   <span class="comment">//Now add a temporary sinusoidal suction and blowing to the base</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;   <span class="comment">//Amplitude of the perturbation</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;   <span class="keywordtype">double</span> epsilon = 0.01;</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;   <span class="comment">//Loop over the nodes on the base</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;   <span class="keywordtype">unsigned</span> n_node = this-&gt;Bulk_mesh_pt-&gt;nboundary_node(0);</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> n=0;n&lt;n_node;n++)</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    {</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;     Node* nod_pt = this-&gt;Bulk_mesh_pt-&gt;boundary_node_pt(0,n);</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;     <span class="keywordtype">double</span> arg = <a class="code" href="namespaceGlobal__Physical__Variables.html#a9da8be10d9e20eb0329af7fd8d6e0e98">Global_Physical_Variables::K</a>*nod_pt-&gt;x(0);</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;     <span class="keywordtype">double</span> value = sin(arg)*epsilon*time*exp(-time);</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;     nod_pt-&gt;set_value(1,value);</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    }</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;  } <span class="comment">//end_of_actions_before_implicit_timestep</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="comment"> ///\short Function to add the traction boundary elements to boundaries</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="comment"> /// 3(inlet) and 1(outlet) of the mesh</span></div>
<div class="line"><a name="l00193"></a><span class="lineno"><a class="line" href="classInclinedPlaneProblem.html#a39ab8005f7603bd1f06f13d6e7a3ae64">  193</a></span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classInclinedPlaneProblem.html#a39ab8005f7603bd1f06f13d6e7a3ae64">make_traction_elements</a>()</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;  {</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;   <span class="comment">//Create a new (empty mesh)</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;   Traction_mesh_pt = <span class="keyword">new</span> Mesh;</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;   <span class="comment">//Inlet boundary conditions (boundary 3)</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;   {</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <span class="keywordtype">unsigned</span> b = 3;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <span class="comment">//Find the number of elements adjacent to mesh boundary</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    <span class="keywordtype">unsigned</span> n_boundary_element = Bulk_mesh_pt-&gt;nboundary_element(b);</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    <span class="comment">//Loop over these elements and create the traction elements</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> e=0;e&lt;n_boundary_element;e++)</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;     {</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;      NavierStokesTractionElement&lt;ELEMENT&gt; *surface_element_pt =</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;       <span class="keyword">new</span> NavierStokesTractionElement&lt;ELEMENT&gt;</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;       (Bulk_mesh_pt-&gt;boundary_element_pt(b,e),</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;        Bulk_mesh_pt-&gt;face_index_at_boundary(b,e));</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;      <span class="comment">//Add the elements to the mesh</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;      Traction_mesh_pt-&gt;add_element_pt(surface_element_pt);</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;      <span class="comment">//Set the traction function</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;      surface_element_pt-&gt;traction_fct_pt() = </div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;       &amp;<a class="code" href="namespaceGlobal__Physical__Variables.html#af1f48eb04a3c7f97b1efacea533acdbc">Global_Physical_Variables::hydrostatic_pressure_inlet</a>;</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;     }</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;   }</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;   </div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;   <span class="comment">//Outlet boundary conditions (boundary 1)</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;   {</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    <span class="keywordtype">unsigned</span> b=1;</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    <span class="comment">//Find the number of elements adjacent to mesh boundary</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    <span class="keywordtype">unsigned</span> n_boundary_element = Bulk_mesh_pt-&gt;nboundary_element(b);</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    <span class="comment">//Loop over these elements and create the traction elements</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> e=0;e&lt;n_boundary_element;e++)</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;     {</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;      NavierStokesTractionElement&lt;ELEMENT&gt; *surface_element_pt =</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;       <span class="keyword">new</span> NavierStokesTractionElement&lt;ELEMENT&gt;</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;       (Bulk_mesh_pt-&gt;boundary_element_pt(b,e),</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;        Bulk_mesh_pt-&gt;face_index_at_boundary(b,e));</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;      <span class="comment">//Add the elements to the mesh</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;      Traction_mesh_pt-&gt;add_element_pt(surface_element_pt);</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;      <span class="comment">//Set the traction function</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;      surface_element_pt-&gt;traction_fct_pt() = </div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;       &amp;<a class="code" href="namespaceGlobal__Physical__Variables.html#ab577639e7c51979d3db7565c08c69c70">Global_Physical_Variables::hydrostatic_pressure_outlet</a>;</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;     }</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;   }</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;  } <span class="comment">//end of make_traction_elements</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160; </div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160; <span class="comment">//Make the free surface elements on the top surface</span></div>
<div class="line"><a name="l00239"></a><span class="lineno"><a class="line" href="classInclinedPlaneProblem.html#a78d06d406af81a3dddbec0a31b65e8a4">  239</a></span>&#160; <span class="keywordtype">void</span> <a class="code" href="classInclinedPlaneProblem.html#a78d06d406af81a3dddbec0a31b65e8a4">make_free_surface_elements</a>()</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;  {</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;   <span class="comment">//Create the (empty) meshes</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;   Surface_mesh_pt = <span class="keyword">new</span> Mesh;</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;   Point_mesh_pt = <span class="keyword">new</span> Mesh;</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160; </div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;   <span class="comment">//The free surface is on the boundary 2</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;   <span class="keywordtype">unsigned</span> b = 2;</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;   <span class="keywordtype">unsigned</span> n_boundary_element = Bulk_mesh_pt-&gt;nboundary_element(b);</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;   <span class="comment">//Loop over the elements and create the appropriate interface elements</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> e=0;e&lt;n_boundary_element;e++)</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    {</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;     INTERFACE_ELEMENT *surface_element_pt =</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;      <span class="keyword">new</span> INTERFACE_ELEMENT</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;      (Bulk_mesh_pt-&gt;boundary_element_pt(b,e),</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;       Bulk_mesh_pt-&gt;face_index_at_boundary(b,e));</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;     <span class="comment">//Add elements to the mesh</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;     Surface_mesh_pt-&gt;add_element_pt(surface_element_pt);</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;     <span class="comment">//Assign the capillary number to the free surface</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;     surface_element_pt-&gt;ca_pt() = </div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;      &amp;<a class="code" href="namespaceGlobal__Physical__Variables.html#a8b32b93d2e546f9375ec418474107838">Global_Physical_Variables::Ca</a>;</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;     </div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;     <span class="comment">//Make a point element from left-hand side of the </span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;     <span class="comment">//first surface element (note that this relies on knowledge of </span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;     <span class="comment">//the element order within the mesh)</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;     <span class="keywordflow">if</span>(e==0)</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;      {</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;       FluidInterfaceBoundingElement* point_element_pt =</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;        surface_element_pt-&gt;make_bounding_element(-1);</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;       <span class="comment">//Add element to the point mesh</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;       Point_mesh_pt-&gt;add_element_pt(point_element_pt);</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;       <span class="comment">//Set the capillary number</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;       point_element_pt-&gt;ca_pt() = &amp;<a class="code" href="namespaceGlobal__Physical__Variables.html#a8b32b93d2e546f9375ec418474107838">Global_Physical_Variables::Ca</a>;</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;       <span class="comment">//Set the wall normal</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;       point_element_pt-&gt;wall_unit_normal_fct_pt() = </div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;        &amp;<a class="code" href="namespaceGlobal__Physical__Variables.html#aa26e74c1f9f93f8212e45380f55fb562">Global_Physical_Variables::wall_unit_normal_inlet_fct</a>;</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;       <span class="comment">//Set the contact angle (using the strong version of the constraint)</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;       point_element_pt-&gt;set_contact_angle(</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;        &amp;<a class="code" href="namespaceGlobal__Physical__Variables.html#a1c3587461447262715bd444ac91a29c9">Global_Physical_Variables::Inlet_Angle</a>);</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;      }</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;     </div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;     <span class="comment">//Make another point element from the right-hand side of the </span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;     <span class="comment">//last surface element (note that this relies on knowledge of </span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;     <span class="comment">//the element order within the mesh)</span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;     <span class="keywordflow">if</span>(e==n_boundary_element-1)</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;      {</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;       FluidInterfaceBoundingElement* point_element_pt =</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;        surface_element_pt-&gt;make_bounding_element(1);</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;       <span class="comment">//Add element to the mesh</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;       Point_mesh_pt-&gt;add_element_pt(point_element_pt);</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;       <span class="comment">//Set the capillary number</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;       point_element_pt-&gt;ca_pt() = &amp;<a class="code" href="namespaceGlobal__Physical__Variables.html#a8b32b93d2e546f9375ec418474107838">Global_Physical_Variables::Ca</a>;</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;       <span class="comment">// Set the function that specifies the wall normal</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;       point_element_pt-&gt;wall_unit_normal_fct_pt() = </div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;        &amp;<a class="code" href="namespaceGlobal__Physical__Variables.html#a8ab8f6e823e4cd204ed7264121a42bfb">Global_Physical_Variables::wall_unit_normal_outlet_fct</a>;</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;      }</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    }</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;  } <span class="comment">//end of make_free_surface_elements</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;<span class="comment"> ///\short Complete the build of the problem setting all standard</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="comment"> ///parameters and boundary conditions</span></div>
<div class="line"><a name="l00300"></a><span class="lineno"><a class="line" href="classInclinedPlaneProblem.html#ae44e360be4a46e1343c3960c3a43380f">  300</a></span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classInclinedPlaneProblem.html#ae44e360be4a46e1343c3960c3a43380f">complete_build</a>()</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;  {</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;   <span class="keyword">using namespace </span><a class="code" href="namespaceGlobal__Physical__Variables.html">Global_Physical_Variables</a>;</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;   </div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;   <span class="comment">//Complete the build of the fluid elements by passing physical parameters</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;   <span class="comment">//Find the number of bulk elements</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;   <span class="keywordtype">unsigned</span> n_element = Bulk_mesh_pt-&gt;nelement();</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;   <span class="comment">//Loop over all the fluid elements </span></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> e=0;e&lt;n_element;e++)</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    {</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;     <span class="comment">//Cast to a fluid element</span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;     ELEMENT *temp_pt = <span class="keyword">dynamic_cast&lt;</span>ELEMENT*<span class="keyword">&gt;</span>(Bulk_mesh_pt-&gt;element_pt(e));</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;     </div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;     <span class="comment">//Set the Reynolds number</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;     temp_pt-&gt;re_pt() = &amp;<a class="code" href="inclined__plane_8txt.html#aa0f8159f7168040576baa2fd5f94acb1">Re</a>;</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;     <span class="comment">//The Strouhal number is 1, so ReSt = Re</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;     temp_pt-&gt;re_st_pt() = &amp;<a class="code" href="inclined__plane_8txt.html#aa0f8159f7168040576baa2fd5f94acb1">Re</a>;</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;     <span class="comment">//Set the Reynolds number / Froude number</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;     temp_pt-&gt;re_invfr_pt() = &amp;<a class="code" href="namespaceGlobal__Physical__Variables.html#aa6286f02b476912dd7550eced538331a">ReInvFr</a>;</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;     <span class="comment">//Set the direction of gravity</span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;     temp_pt-&gt;g_pt() = &amp;<a class="code" href="namespaceGlobal__Physical__Variables.html#aa868968dead376240a69f9152bd599b9">G</a>;</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    }</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;   </div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;   <span class="comment">//------------Set the boundary conditions for this problem----------</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160; </div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;   {</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    <span class="comment">//Determine whether we are solving an elastic problem or not</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    <span class="keywordtype">bool</span> elastic = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    <span class="keywordflow">if</span>(<span class="keyword">dynamic_cast&lt;</span>SolidNode*<span class="keyword">&gt;</span>(Bulk_mesh_pt-&gt;node_pt(0))) {elastic=<span class="keyword">true</span>;}</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160; </div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    <span class="comment">//Loop over the bottom of the mesh (the wall of the channel)</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    <span class="keywordtype">unsigned</span> n_node = Bulk_mesh_pt-&gt;nboundary_node(0);</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> j=0;j&lt;n_node;j++)</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;     {</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;      <span class="comment">//Pin the u- and v- velocities</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;      Bulk_mesh_pt-&gt;boundary_node_pt(0,j)-&gt;pin(0);</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;      Bulk_mesh_pt-&gt;boundary_node_pt(0,j)-&gt;pin(1);</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160; </div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;      <span class="comment">//If we are formulating the elastic problem pin both positions</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;      <span class="comment">//of nodes</span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;      <span class="keywordflow">if</span>(elastic)</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;       {</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;        <span class="keyword">static_cast&lt;</span>SolidNode*<span class="keyword">&gt;</span>(Bulk_mesh_pt-&gt;boundary_node_pt(0,j))</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;         -&gt;pin_position(0);</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;        <span class="keyword">static_cast&lt;</span>SolidNode*<span class="keyword">&gt;</span>(Bulk_mesh_pt-&gt;boundary_node_pt(0,j))</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;         -&gt;pin_position(1);</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;       }</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;     }</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    </div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    <span class="comment">//Loop over the inlet and set the Dirichlet condition</span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    <span class="comment">//of no vertical velocity</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    n_node = Bulk_mesh_pt-&gt;nboundary_node(3);</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> j=0;j&lt;n_node;j++)</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;     {</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;      Bulk_mesh_pt-&gt;boundary_node_pt(3,j)-&gt;pin(1);</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160; </div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;      <span class="comment">//If elastic pin horizontal position of nodes</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;      <span class="keywordflow">if</span>(elastic)</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;       { </div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;        <span class="keyword">static_cast&lt;</span>SolidNode*<span class="keyword">&gt;</span>(Bulk_mesh_pt-&gt;boundary_node_pt(3,j))</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;         -&gt;pin_position(0);</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;       }</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;     }</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    </div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    <span class="comment">//Loop over the outlet and set the Dirichlet condition</span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    <span class="comment">//of no vertical velocity</span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    n_node = Bulk_mesh_pt-&gt;nboundary_node(1);</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> j=0;j&lt;n_node;j++)</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;     {</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;      Bulk_mesh_pt-&gt;boundary_node_pt(1,j)-&gt;pin(1);</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160; </div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;      <span class="comment">//If elastic pin horizontal position</span></div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;      <span class="keywordflow">if</span>(elastic)</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;       { </div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;        <span class="keyword">static_cast&lt;</span>SolidNode*<span class="keyword">&gt;</span>(Bulk_mesh_pt-&gt;boundary_node_pt(1,j))</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;         -&gt;pin_position(0);</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;       }</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;     }</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;   }</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160; </div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;   <span class="comment">//Attach the boundary conditions to the mesh</span></div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;   std::cout &lt;&lt; assign_eqn_numbers() &lt;&lt; <span class="stringliteral">&quot; in the main problem&quot;</span> &lt;&lt; std::endl; </div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;  } <span class="comment">//end of complete_build</span></div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;<span class="comment"> ///Generic desructor to clean up the memory allocated in the problem</span></div>
<div class="line"><a name="l00385"></a><span class="lineno"><a class="line" href="classInclinedPlaneProblem.html#ad89c7dc7975bf128a7c249496fabc97f">  385</a></span>&#160;<span class="comment"></span> <a class="code" href="classInclinedPlaneProblem.html#ad89c7dc7975bf128a7c249496fabc97f">~InclinedPlaneProblem</a>()</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;  {</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;   <span class="comment">//Clear node storage before the mesh can be deleted, </span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;   <span class="comment">//to avoid double deletion</span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;   this-&gt;Point_mesh_pt-&gt;flush_node_storage();</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;   <span class="comment">//Then delete the mesh</span></div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;   <span class="keyword">delete</span> this-&gt;Point_mesh_pt;</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;   <span class="comment">//Clear node storage and then delete mesh</span></div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;   this-&gt;Surface_mesh_pt-&gt;flush_node_storage();</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;   <span class="keyword">delete</span> this-&gt;Surface_mesh_pt;</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;   <span class="comment">//Clear node storage and then delete mesh</span></div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;   this-&gt;Traction_mesh_pt-&gt;flush_node_storage();</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;   <span class="keyword">delete</span> this-&gt;Traction_mesh_pt;</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;   <span class="comment">//Delete the bulk mesh (no need to clear node storage)</span></div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;   <span class="keyword">delete</span> this-&gt;Bulk_mesh_pt;</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;   <span class="comment">//Delete the time stepper</span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;   <span class="keyword">delete</span> this-&gt;time_stepper_pt();</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;  }</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160; </div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;};</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160; </div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160; </div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;<span class="comment">//-------------------------------------------------------------------------</span><span class="comment"></span></div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;<span class="comment">///Solve the steady problem</span></div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;<span class="comment"></span><span class="comment">//-------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> ELEMENT,<span class="keyword">class</span> INTERFACE_ELEMENT&gt;</div>
<div class="line"><a name="l00411"></a><span class="lineno"><a class="line" href="classInclinedPlaneProblem.html#a0e2fcfdb8230df82729ba7d728e58040">  411</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classInclinedPlaneProblem.html#a0e2fcfdb8230df82729ba7d728e58040">InclinedPlaneProblem&lt;ELEMENT,INTERFACE_ELEMENT&gt;::solve_steady</a>()</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;{</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160; <span class="comment">//Load the namespace</span></div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160; <span class="keyword">using namespace </span><a class="code" href="namespaceGlobal__Physical__Variables.html">Global_Physical_Variables</a>;</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160; </div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160; <span class="comment">//Initially set all nodes to the Nusselt flat-film solution</span></div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160; {</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;  <span class="keywordtype">unsigned</span> n_node = Bulk_mesh_pt-&gt;nnode();</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span>  n=0;n&lt;n_node;n++)</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;   {</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    <span class="keywordtype">double</span> y = Bulk_mesh_pt-&gt;node_pt(n)-&gt;x(1);</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    <span class="comment">//Top row</span></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    Bulk_mesh_pt-&gt;node_pt(n)-&gt;set_value(0,0.5*<a class="code" href="namespaceGlobal__Physical__Variables.html#aa6286f02b476912dd7550eced538331a">ReInvFr</a>*sin(<a class="code" href="namespaceGlobal__Physical__Variables.html#aa2e802ee7cc8e1ac900ba94c3ce86eb7">Alpha</a>)*(2.0*y - y*y));</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;   }</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160; }</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160; </div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160; <span class="comment">//Do one steady solve</span></div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160; steady_newton_solve();</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160; </div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160; <span class="comment">//Output the full flow field</span></div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160; std::string filename = Output_prefix;;</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160; filename.append(<span class="stringliteral">&quot;_output.dat&quot;</span>);</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160; ofstream file(filename.c_str());</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160; Bulk_mesh_pt-&gt;output(file,5);</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160; file.close();</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;} <span class="comment">//end of solve_steady</span></div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160; </div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160; </div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;<span class="comment">//----------------------------------------------------------------------</span><span class="comment"></span></div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;<span class="comment">/// Perform n_tsteps timesteps of size dt</span></div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;<span class="comment"></span><span class="comment">//----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> ELEMENT, <span class="keyword">class</span> INTERFACE_ELEMENT&gt;</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classInclinedPlaneProblem.html#a74bbd1ccfd3dd82c999a16924c230f51">InclinedPlaneProblem&lt;ELEMENT, INTERFACE_ELEMENT&gt;::</a></div>
<div class="line"><a name="l00444"></a><span class="lineno"><a class="line" href="classInclinedPlaneProblem.html#a74bbd1ccfd3dd82c999a16924c230f51">  444</a></span>&#160;<a class="code" href="classInclinedPlaneProblem.html#a74bbd1ccfd3dd82c999a16924c230f51">timestep</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> &amp;dt, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;n_tsteps)</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;{</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160; <span class="comment">//Need to use the Global variables here</span></div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160; <span class="keyword">using namespace </span><a class="code" href="namespaceGlobal__Physical__Variables.html">Global_Physical_Variables</a>;</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160; </div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160; <span class="comment">//Open an output file</span></div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160; std::string filename = Output_prefix;</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160; filename.append(<span class="stringliteral">&quot;_time_trace.dat&quot;</span>);</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160; ofstream trace(filename.c_str()); </div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160; <span class="comment">//Counter that will be used to output the full flowfield</span></div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160; <span class="comment">//at certain timesteps</span></div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160; <span class="keywordtype">int</span> counter=0; </div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160; </div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160; <span class="comment">//Initial output of the time and the value of the vertical position at the</span></div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160; <span class="comment">//left and right-hand end of the free surface</span></div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160; trace &lt;&lt; time_pt()-&gt;time() &lt;&lt; <span class="stringliteral">&quot; &quot;</span> </div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;       &lt;&lt; Bulk_mesh_pt-&gt;boundary_node_pt(2,0)-&gt;value(1) </div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;       &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;       &lt;&lt;  Bulk_mesh_pt-&gt;</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;  boundary_node_pt(2, Bulk_mesh_pt-&gt;nboundary_node(2)-1)-&gt;x(1) </div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;       &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;       &lt;&lt; std::endl;</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160; </div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160; <span class="comment">//Loop over the desired number of timesteps</span></div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160; <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> t=1;t&lt;=n_tsteps;t++)</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;  {</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;   <span class="comment">//Increase the counter</span></div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;   counter++;</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;   cout &lt;&lt; std::endl;</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;   cout &lt;&lt; <span class="stringliteral">&quot;--------------TIMESTEP &quot;</span> &lt;&lt; t&lt;&lt; <span class="stringliteral">&quot; ------------------&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;   </div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;   <span class="comment">//Take a timestep of size dt</span></div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;   unsteady_newton_solve(dt);</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;   </div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;   <span class="comment">//Uncomment to get full solution output</span></div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;   <span class="keywordflow">if</span>(counter==2) <span class="comment">//Change this number to get output every n steps</span></div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    {</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;     std::ofstream file;</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;     std::ostringstream filename;</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;     filename &lt;&lt; Output_prefix &lt;&lt; <span class="stringliteral">&quot;_step&quot;</span> &lt;&lt; <a class="code" href="inclined__plane_8txt.html#aa0f8159f7168040576baa2fd5f94acb1">Re</a> &lt;&lt; <span class="stringliteral">&quot;_&quot;</span> &lt;&lt; t &lt;&lt; <span class="stringliteral">&quot;.dat&quot;</span>;</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;     file.open(filename.str().c_str());</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;     Bulk_mesh_pt-&gt;output(file,5);</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;     file.close();</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;     </div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;     counter=0;</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    }</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160; </div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;   <span class="comment">//Always output the interface</span></div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;   {</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    std::ofstream file;</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;     std::ostringstream filename;</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;     filename &lt;&lt; Output_prefix &lt;&lt; <span class="stringliteral">&quot;_interface_&quot;</span> &lt;&lt; <a class="code" href="inclined__plane_8txt.html#aa0f8159f7168040576baa2fd5f94acb1">Re</a> &lt;&lt; <span class="stringliteral">&quot;_&quot;</span> &lt;&lt; t &lt;&lt; <span class="stringliteral">&quot;.dat&quot;</span>;</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;     file.open(filename.str().c_str());</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;     Surface_mesh_pt-&gt;output(file,5);</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;     file.close();</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;   }</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;   </div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;   <span class="comment">//Output the time and value of the vertical position of the free surface</span></div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;   <span class="comment">//at the left- and right-hand ends</span></div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;   trace &lt;&lt; time_pt()-&gt;time() &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;         &lt;&lt; Bulk_mesh_pt-&gt;boundary_node_pt(2,0)-&gt;x(1) &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;         &lt;&lt; </div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    Bulk_mesh_pt-&gt;</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    boundary_node_pt(2,Bulk_mesh_pt-&gt;nboundary_node(2)-1)-&gt;x(1) &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;         &lt;&lt; std::endl;</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;  }</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;} <span class="comment">//end of timestep</span></div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160; </div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160; </div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;<span class="comment">//====================================================================</span></div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;<span class="comment">// Spine formulation of the problem</span></div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;<span class="comment">//===================================================================</span></div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160; </div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160; </div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;<span class="comment">//======================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;<span class="comment">/// Create a spine mesh for the problem</span></div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;<span class="comment"></span><span class="comment">//======================================================================</span></div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> ELEMENT&gt;</div>
<div class="line"><a name="l00522"></a><span class="lineno"><a class="line" href="classSpineInclinedPlaneMesh.html">  522</a></span>&#160;<span class="keyword">class </span><a class="code" href="classSpineInclinedPlaneMesh.html">SpineInclinedPlaneMesh</a> : </div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160; <span class="keyword">public</span> SimpleRectangularQuadMesh&lt;ELEMENT&gt;,</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160; <span class="keyword">public</span> SpineMesh</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;{</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00527"></a><span class="lineno"><a class="line" href="classSpineInclinedPlaneMesh.html#a97e770220d4cd41e11c86c5cfa289133">  527</a></span>&#160; <a class="code" href="classSpineInclinedPlaneMesh.html#a97e770220d4cd41e11c86c5cfa289133">SpineInclinedPlaneMesh</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;nx, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;ny,</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;                        <span class="keyword">const</span> <span class="keywordtype">double</span> &amp;lx, <span class="keyword">const</span> <span class="keywordtype">double</span> &amp;ly,</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;                        TimeStepper* time_stepper_pt) :</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;  SimpleRectangularQuadMesh&lt;ELEMENT&gt;</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160; (nx,ny,lx,ly,time_stepper_pt), SpineMesh()</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;  {</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;   <span class="comment">//Find the number of linear points in the element</span></div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;   <span class="keywordtype">unsigned</span> n_p =  <span class="keyword">dynamic_cast&lt;</span>ELEMENT*<span class="keyword">&gt;</span>(finite_element_pt(0))-&gt;nnode_1d();</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;   <span class="comment">//Reserve storage for the number of spines</span></div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;   Spine_pt.reserve((n_p-1)*nx + 1);</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;   </div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;   <span class="comment">//Create single pointer to a spine</span></div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;   Spine* new_spine_pt=0;</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160; </div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;   <span class="comment">//Now loop over the elements horizontally</span></div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> j=0;j&lt;nx;j++)</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;    {</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;     <span class="comment">//In most elements, we don&#39;t assign a spine to the last column,</span></div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;     <span class="comment">//beacuse that will be done by the next element</span></div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;     <span class="keywordtype">unsigned</span> n_pmax = n_p-1;</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;     <span class="comment">//In the last element, however, we must assign the final spine</span></div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;     <span class="keywordflow">if</span>(j==nx-1) {n_pmax = n_p;}</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160; </div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;     <span class="comment">//Loop over all nodes horizontally</span></div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l2=0;l2&lt;n_pmax;l2++)</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;      {</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;       <span class="comment">//Create a new spine with unit height and add to the mesh</span></div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;       new_spine_pt=<span class="keyword">new</span> Spine(1.0);</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;       Spine_pt.push_back(new_spine_pt);</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;       </div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;       <span class="comment">// Get the node</span></div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;       SpineNode* nod_pt=element_node_pt(j,l2);</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;       <span class="comment">//Set the pointer to spine</span></div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;       nod_pt-&gt;spine_pt() = new_spine_pt;</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;       <span class="comment">//Set the fraction</span></div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;       nod_pt-&gt;fraction() = 0.0;</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;       <span class="comment">// Pointer to the mesh that implements the update fct</span></div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;       nod_pt-&gt;spine_mesh_pt() = <span class="keyword">this</span>; </div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;       </div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;       <span class="comment">//Loop vertically along the spine</span></div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;       <span class="comment">//Loop over the elements </span></div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;       <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> i=0;i&lt;ny;i++)</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;        {</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;         <span class="comment">//Loop over the vertical nodes, apart from the first</span></div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;         <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l1=1;l1&lt;n_p;l1++)</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;          {</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;           <span class="comment">// Get the node</span></div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;           SpineNode* nod_pt=element_node_pt(i*nx+j,l1*n_p+l2);</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;           <span class="comment">//Set the pointer to the spine</span></div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;           nod_pt-&gt;spine_pt() = new_spine_pt;</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;           <span class="comment">//Set the fraction</span></div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;           nod_pt-&gt;fraction()=(double(i)+double(l1)/double(n_p-1))/<span class="keywordtype">double</span>(ny);</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;           <span class="comment">// Pointer to the mesh that implements the update fct</span></div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;           nod_pt-&gt;spine_mesh_pt() = <span class="keyword">this</span>; </div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;          }  </div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;        }</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;      }</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;    } <span class="comment">//End of horizontal loop over elements  </span></div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;  } <span class="comment">//end of constructor</span></div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;<span class="comment"> /// \short General node update function implements pure virtual function </span></div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;<span class="comment"> /// defined in SpineMesh base class and performs specific node update</span></div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;<span class="comment"> /// actions:  along vertical spines</span></div>
<div class="line"><a name="l00590"></a><span class="lineno"><a class="line" href="classSpineInclinedPlaneMesh.html#a01fa9c443029a6a00b1679a6785029f6">  590</a></span>&#160;<span class="comment"></span> <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classSpineInclinedPlaneMesh.html#a01fa9c443029a6a00b1679a6785029f6">spine_node_update</a>(SpineNode* spine_node_pt)</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;  {</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;   <span class="comment">//Get fraction along the spine</span></div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;   <span class="keywordtype">double</span> W = spine_node_pt-&gt;fraction();</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;   <span class="comment">//Get spine height</span></div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;   <span class="keywordtype">double</span> H = spine_node_pt-&gt;h();</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;   <span class="comment">//Set the value of y</span></div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;   spine_node_pt-&gt;x(1) = W*H;</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;  }</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;};</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160; </div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160; </div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160; </div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;<span class="comment">//============================================================================</span></div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;<span class="comment">//Specific class for inclined plane problem using spines</span></div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;<span class="comment">//============================================================================</span></div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> ELEMENT, <span class="keyword">class</span> TIMESTEPPER&gt;</div>
<div class="line"><a name="l00607"></a><span class="lineno"><a class="line" href="classSpineInclinedPlaneProblem.html">  607</a></span>&#160;<span class="keyword">class </span><a class="code" href="classSpineInclinedPlaneProblem.html">SpineInclinedPlaneProblem</a> : </div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160; <span class="keyword">public</span> <a class="code" href="classInclinedPlaneProblem.html">InclinedPlaneProblem</a>&lt;ELEMENT,SpineLineFluidInterfaceElement&lt;ELEMENT&gt; &gt;</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;{</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160; </div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160; <span class="comment">//Constructor</span></div>
<div class="line"><a name="l00613"></a><span class="lineno"><a class="line" href="classSpineInclinedPlaneProblem.html#a5eba548aaedf82845fd02403f06a42f7">  613</a></span>&#160; <a class="code" href="classSpineInclinedPlaneProblem.html#a5eba548aaedf82845fd02403f06a42f7">SpineInclinedPlaneProblem</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;nx, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;ny,</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;                      <span class="keyword">const</span> <span class="keywordtype">double</span> &amp;length): </div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;  <a class="code" href="classInclinedPlaneProblem.html">InclinedPlaneProblem</a>&lt;ELEMENT,SpineLineFluidInterfaceElement&lt;ELEMENT&gt; &gt;</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;  (nx,ny,length) </div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;  {</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;   <span class="comment">//Set the name</span></div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;   this-&gt;Output_prefix = <span class="stringliteral">&quot;spine&quot;</span>;</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160; </div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;   <span class="comment">//Create our one and only timestepper, with adaptive timestepping</span></div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;   this-&gt;add_time_stepper_pt(<span class="keyword">new</span> TIMESTEPPER);</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160; </div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;   <span class="comment">//Create the bulk mesh</span></div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;   this-&gt;Bulk_mesh_pt = <span class="keyword">new</span>  <a class="code" href="classSpineInclinedPlaneMesh.html">SpineInclinedPlaneMesh&lt;ELEMENT&gt;</a>(</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;    nx,ny,length,1.0,this-&gt;time_stepper_pt());</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160; </div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;   <span class="comment">//Create the traction elements</span></div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;   this-&gt;make_traction_elements();</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;   <span class="comment">//Create the free surface elements</span></div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;   this-&gt;make_free_surface_elements();</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160; </div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;   <span class="comment">//Add all sub meshes to the problem</span></div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;   this-&gt;add_sub_mesh(this-&gt;Bulk_mesh_pt);</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;   this-&gt;add_sub_mesh(this-&gt;Traction_mesh_pt);</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;   this-&gt;add_sub_mesh(this-&gt;Surface_mesh_pt);</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;   this-&gt;add_sub_mesh(this-&gt;Point_mesh_pt);</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;   <span class="comment">//Create the global mesh</span></div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;   this-&gt;build_global_mesh();</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160; </div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;   <span class="comment">//Complete the build of the problem</span></div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;   this-&gt;complete_build();</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;  }</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;<span class="comment"> /// Spine heights/lengths are unknowns in the problem so their</span></div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;<span class="comment"> /// values get corrected during each Newton step. However,</span></div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;<span class="comment"> /// changing their value does not automatically change the</span></div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;<span class="comment"> /// nodal positions, so we need to update all of them</span></div>
<div class="line"><a name="l00649"></a><span class="lineno"><a class="line" href="classSpineInclinedPlaneProblem.html#af05f87be8b233df5a296f6375001d385">  649</a></span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classSpineInclinedPlaneProblem.html#af05f87be8b233df5a296f6375001d385">actions_before_newton_convergence_check</a>()</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;  {this-&gt;Bulk_mesh_pt-&gt;node_update();}</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160; </div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;};</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160; </div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160; </div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;<span class="comment">//====================================================================</span></div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;<span class="comment">// Elastic formulation of the problem</span></div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;<span class="comment">//===================================================================</span></div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160; </div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160; </div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;<span class="comment">//======================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;<span class="comment">/// Create an Elastic mesh for the problem</span></div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;<span class="comment"></span><span class="comment">//======================================================================</span></div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> ELEMENT&gt;</div>
<div class="line"><a name="l00664"></a><span class="lineno"><a class="line" href="classElasticInclinedPlaneMesh.html">  664</a></span>&#160;<span class="keyword">class </span><a class="code" href="classElasticInclinedPlaneMesh.html">ElasticInclinedPlaneMesh</a> : </div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160; <span class="keyword">public</span> SimpleRectangularQuadMesh&lt;ELEMENT&gt;,</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160; <span class="keyword">public</span> SolidMesh</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;{</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160; <span class="comment">//Public functions</span></div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160; <span class="keyword">public</span>:</div>
<div class="line"><a name="l00670"></a><span class="lineno"><a class="line" href="classElasticInclinedPlaneMesh.html#a61ba6d852505dd1353e791223fdfce04">  670</a></span>&#160; <a class="code" href="classElasticInclinedPlaneMesh.html#a61ba6d852505dd1353e791223fdfce04">ElasticInclinedPlaneMesh</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;nx, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;ny,</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;                          <span class="keyword">const</span> <span class="keywordtype">double</span> &amp;lx, <span class="keyword">const</span> <span class="keywordtype">double</span> &amp;ly,</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;                          TimeStepper* time_stepper_pt) :</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;  SimpleRectangularQuadMesh&lt;ELEMENT&gt;(nx,ny,lx,ly,time_stepper_pt), SolidMesh()</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;  {</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;   <span class="comment">//Make the current configuration the undeformed one</span></div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;   set_lagrangian_nodal_coordinates();</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;  }</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;};</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160; </div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160; </div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160; </div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160; </div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;<span class="comment">//============================================================================</span></div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;<span class="comment">//Specific class for inclined plane problem using pseudo-elastic formulation</span></div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;<span class="comment">//============================================================================</span></div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> ELEMENT, <span class="keyword">class</span> TIMESTEPPER&gt;</div>
<div class="line"><a name="l00687"></a><span class="lineno"><a class="line" href="classElasticInclinedPlaneProblem.html">  687</a></span>&#160;<span class="keyword">class </span><a class="code" href="classElasticInclinedPlaneProblem.html">ElasticInclinedPlaneProblem</a> : </div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160; <span class="keyword">public</span> <a class="code" href="classInclinedPlaneProblem.html">InclinedPlaneProblem</a>&lt;ELEMENT,ElasticLineFluidInterfaceElement&lt;ELEMENT&gt; &gt;</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;{</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160; <span class="comment">//Constructor</span></div>
<div class="line"><a name="l00692"></a><span class="lineno"><a class="line" href="classElasticInclinedPlaneProblem.html#a5006b73d91fcb4bd20d0591577e50f61">  692</a></span>&#160; <a class="code" href="classElasticInclinedPlaneProblem.html#a5006b73d91fcb4bd20d0591577e50f61">ElasticInclinedPlaneProblem</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;nx, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;ny,</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;                      <span class="keyword">const</span> <span class="keywordtype">double</span> &amp;length) :</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;  <a class="code" href="classInclinedPlaneProblem.html">InclinedPlaneProblem</a>&lt;ELEMENT,ElasticLineFluidInterfaceElement&lt;ELEMENT&gt; &gt;</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;  (nx,ny,length) </div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;  {</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;   <span class="comment">//Set the name</span></div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;   this-&gt;Output_prefix = <span class="stringliteral">&quot;elastic&quot;</span>;</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;   </div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;   <span class="comment">//Create our one and only timestepper, with adaptive timestepping</span></div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;   this-&gt;add_time_stepper_pt(<span class="keyword">new</span> TIMESTEPPER);</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160; </div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;   <span class="comment">//Create the bulk mesh</span></div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;   this-&gt;Bulk_mesh_pt = <span class="keyword">new</span>  <a class="code" href="classElasticInclinedPlaneMesh.html">ElasticInclinedPlaneMesh&lt;ELEMENT&gt;</a>(</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;    nx,ny,length,1.0,this-&gt;time_stepper_pt());</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160; </div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;   <span class="comment">//Set the consititutive law for the elements</span></div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;   <span class="keywordtype">unsigned</span> n_element = this-&gt;Bulk_mesh_pt-&gt;nelement();</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;   <span class="comment">//Loop over all the fluid elements </span></div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> e=0;e&lt;n_element;e++)</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;    {</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;     <span class="comment">//Cast to a fluid element</span></div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;     ELEMENT *temp_pt = <span class="keyword">dynamic_cast&lt;</span>ELEMENT*<span class="keyword">&gt;</span>(</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;      this-&gt;Bulk_mesh_pt-&gt;element_pt(e));</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;     <span class="comment">//Set the constitutive law </span></div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;     temp_pt-&gt;constitutive_law_pt() = </div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;      <a class="code" href="namespaceGlobal__Physical__Variables.html#a2a37fb040c832ee7a086bb13bb02a100">Global_Physical_Variables::Constitutive_law_pt</a>;</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;    }</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;   </div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;   <span class="comment">//Create the traction elements</span></div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;   this-&gt;make_traction_elements();</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;   <span class="comment">//Create the free surface element</span></div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;   this-&gt;make_free_surface_elements();</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160; </div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;   <span class="comment">//Add all sub meshes to the problem</span></div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;   this-&gt;add_sub_mesh(this-&gt;Bulk_mesh_pt);</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;   this-&gt;add_sub_mesh(this-&gt;Traction_mesh_pt);</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;   this-&gt;add_sub_mesh(this-&gt;Surface_mesh_pt);</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;   this-&gt;add_sub_mesh(this-&gt;Point_mesh_pt);</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;   <span class="comment">//Create the global mesh</span></div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;   this-&gt;build_global_mesh();</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160; </div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;   <span class="comment">//Complete the rest of the build</span></div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;   this-&gt;complete_build();</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;  } <span class="comment">//end of constructor</span></div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;<span class="comment"> ///\short Update Lagrangian positions after each timestep </span></div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;<span class="comment"> ///(updated-lagrangian approach)</span></div>
<div class="line"><a name="l00739"></a><span class="lineno"><a class="line" href="classElasticInclinedPlaneProblem.html#a7e61d0cb5e10b7e98f949a43749477a6">  739</a></span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classElasticInclinedPlaneProblem.html#a7e61d0cb5e10b7e98f949a43749477a6">actions_after_implicit_timestep</a>()</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;  {</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;   <span class="comment">//Now loop over all the nodes and reset their Lagrangian coordinates</span></div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;   <span class="keywordtype">unsigned</span> n_node = this-&gt;Bulk_mesh_pt-&gt;nnode();</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> n=0;n&lt;n_node;n++)</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;    {</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;     <span class="comment">//Cast node to an elastic node</span></div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;     SolidNode* temp_pt = </div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;      <span class="keyword">static_cast&lt;</span>SolidNode*<span class="keyword">&gt;</span>(this-&gt;Bulk_mesh_pt-&gt;node_pt(n));</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> j=0;j&lt;2;j++) {temp_pt-&gt;xi(j) = temp_pt-&gt;x(j);}</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;    }</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;  } <span class="comment">//end of actions_after_implicit_timestep</span></div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160; </div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;};</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160; </div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160; </div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;<span class="comment">//start of main</span></div>
<div class="line"><a name="l00756"></a><span class="lineno"><a class="line" href="inclined__plane_8cc.html#a3c04138a5bfe5d72780bb7e82a18e627">  756</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="inclined__plane_8cc.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a>(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv)</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;{</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160; <span class="keyword">using namespace </span><a class="code" href="namespaceGlobal__Physical__Variables.html">Global_Physical_Variables</a>;</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160; </div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160; <span class="comment">//Set the constitutive law for the mesh deformation</span></div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160; <a class="code" href="namespaceGlobal__Physical__Variables.html#a2a37fb040c832ee7a086bb13bb02a100">Constitutive_law_pt</a>  = <span class="keyword">new</span> GeneralisedHookean(&amp;<a class="code" href="namespaceGlobal__Physical__Variables.html#a3962c36313826b19f216f6bbbdd6a477">Global_Physical_Variables::Nu</a>);</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160; </div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;<span class="preprocessor">#ifdef CR_ELEMENT</span></div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;<span class="preprocessor">#define FLUID_ELEMENT QCrouzeixRaviartElement&lt;2&gt;</span></div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;<span class="preprocessor">#define FLUID_ELEMENT QTaylorHoodElement&lt;2&gt;</span></div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;<span class="preprocessor">#endif </span></div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160; </div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160; <span class="comment">//Initialise physical parameters</span></div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160; <span class="comment">//Scale Reynolds number to be independent of alpha.</span></div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160; <a class="code" href="inclined__plane_8txt.html#aa0f8159f7168040576baa2fd5f94acb1">Re</a> = 4.0/sin(<a class="code" href="namespaceGlobal__Physical__Variables.html#aa2e802ee7cc8e1ac900ba94c3ce86eb7">Alpha</a>); </div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160; </div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160; <span class="comment">//Set the direction of gravity</span></div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160; <a class="code" href="namespaceGlobal__Physical__Variables.html#aa868968dead376240a69f9152bd599b9">G</a>[0] = sin(<a class="code" href="namespaceGlobal__Physical__Variables.html#aa2e802ee7cc8e1ac900ba94c3ce86eb7">Alpha</a>);</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160; <a class="code" href="namespaceGlobal__Physical__Variables.html#aa868968dead376240a69f9152bd599b9">G</a>[1] = -cos(<a class="code" href="namespaceGlobal__Physical__Variables.html#aa2e802ee7cc8e1ac900ba94c3ce86eb7">Alpha</a>);</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160; </div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160; <span class="comment">//The wall normal to the inlet is in the negative x direction</span></div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160; <a class="code" href="namespaceGlobal__Physical__Variables.html#a5feb3df21fc4a0adefadecb8a8ed98d7">Wall_normal</a>.resize(2);</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160; <a class="code" href="namespaceGlobal__Physical__Variables.html#a5feb3df21fc4a0adefadecb8a8ed98d7">Wall_normal</a>[0] = -1.0;</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160; <a class="code" href="namespaceGlobal__Physical__Variables.html#a5feb3df21fc4a0adefadecb8a8ed98d7">Wall_normal</a>[1] = 0.0;</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160; </div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160; <span class="comment">//Spine problem</span></div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160; {</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;  <span class="comment">//Create the problem</span></div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;  <a class="code" href="classSpineInclinedPlaneProblem.html">SpineInclinedPlaneProblem&lt;SpineElement&lt;FLUID_ELEMENT &gt;</a>, BDF&lt;2&gt; &gt; </div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;   <a class="code" href="inclined__plane_8txt.html#a4074baada03976c061d5672f4237cca5">problem</a>(30,4,<a class="code" href="namespaceGlobal__Physical__Variables.html#a987847160c3cfad8977836291fb9d0e0">Global_Physical_Variables::Length</a>);</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;  </div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;  <span class="comment">//Solve the steady problem</span></div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;  <a class="code" href="inclined__plane_8txt.html#a4074baada03976c061d5672f4237cca5">problem</a>.solve_steady();</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;  </div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;  <span class="comment">//Prepare the problem for timestepping </span></div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;  <span class="comment">//(assume that it&#39;s been at the flat-film solution for all previous time)</span></div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;  <span class="keywordtype">double</span> dt = 0.1;</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;  <a class="code" href="inclined__plane_8txt.html#a4074baada03976c061d5672f4237cca5">problem</a>.assign_initial_values_impulsive(dt);</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;  </div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;  <span class="comment">//Timestep it </span></div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;  <a class="code" href="inclined__plane_8txt.html#a4074baada03976c061d5672f4237cca5">problem</a>.timestep(dt,2);</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160; } <span class="comment">//End of spine problem</span></div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160; </div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160; </div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160; <span class="comment">//Elastic problem</span></div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160; {</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;  <span class="comment">//Create the problem</span></div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;  <a class="code" href="classElasticInclinedPlaneProblem.html">ElasticInclinedPlaneProblem</a>&lt;</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;   PseudoSolidNodeUpdateElement&lt;FLUID_ELEMENT,QPVDElement&lt;2,3&gt; &gt;, BDF&lt;2&gt; &gt; </div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;     <a class="code" href="inclined__plane_8txt.html#a4074baada03976c061d5672f4237cca5">problem</a>(30,4,<a class="code" href="namespaceGlobal__Physical__Variables.html#a987847160c3cfad8977836291fb9d0e0">Global_Physical_Variables::Length</a>);</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;  </div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;  <span class="comment">//Solve the steady problem</span></div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;  <a class="code" href="inclined__plane_8txt.html#a4074baada03976c061d5672f4237cca5">problem</a>.solve_steady();</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;  </div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;  <span class="comment">//Prepare the problem for timestepping </span></div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;  <span class="comment">//(assume that it&#39;s been at the flat-film solution for all previous time)</span></div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;  <span class="keywordtype">double</span> dt = 0.1;</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;  <a class="code" href="inclined__plane_8txt.html#a4074baada03976c061d5672f4237cca5">problem</a>.assign_initial_values_impulsive(dt);</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160; </div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;  <span class="comment">//Timestep it</span></div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;  <a class="code" href="inclined__plane_8txt.html#a4074baada03976c061d5672f4237cca5">problem</a>.timestep(dt,2);</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160; } <span class="comment">//End of elastic problem</span></div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;}</div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="anamespaceGlobal__Physical__Variables_html_a8ab8f6e823e4cd204ed7264121a42bfb"><div class="ttname"><a href="namespaceGlobal__Physical__Variables.html#a8ab8f6e823e4cd204ed7264121a42bfb">Global_Physical_Variables::wall_unit_normal_outlet_fct</a></div><div class="ttdeci">void wall_unit_normal_outlet_fct(const Vector&lt; double &gt; &amp;x, Vector&lt; double &gt; &amp;normal)</div><div class="ttdoc">Function that specified the wall unit normal at the outlet.</div><div class="ttdef"><b>Definition:</b> <a href="inclined__plane_8cc_source.html#l00091">inclined_plane.cc:91</a></div></div>
<div class="ttc" id="anamespaceGlobal__Physical__Variables_html_aa6286f02b476912dd7550eced538331a"><div class="ttname"><a href="namespaceGlobal__Physical__Variables.html#aa6286f02b476912dd7550eced538331a">Global_Physical_Variables::ReInvFr</a></div><div class="ttdeci">double ReInvFr</div><div class="ttdef"><b>Definition:</b> <a href="inclined__plane_8cc_source.html#l00060">inclined_plane.cc:60</a></div></div>
<div class="ttc" id="anamespaceGlobal__Physical__Variables_html_af1f48eb04a3c7f97b1efacea533acdbc"><div class="ttname"><a href="namespaceGlobal__Physical__Variables.html#af1f48eb04a3c7f97b1efacea533acdbc">Global_Physical_Variables::hydrostatic_pressure_inlet</a></div><div class="ttdeci">void hydrostatic_pressure_inlet(const double &amp;time, const Vector&lt; double &gt; &amp;x, const Vector&lt; double &gt; &amp;n, Vector&lt; double &gt; &amp;traction)</div><div class="ttdoc">Function that prescribes hydrostatic pressure field at the inlet.</div><div class="ttdef"><b>Definition:</b> <a href="inclined__plane_8cc_source.html#l00115">inclined_plane.cc:115</a></div></div>
<div class="ttc" id="ainclined__plane_8cc_html_a3c04138a5bfe5d72780bb7e82a18e627"><div class="ttname"><a href="inclined__plane_8cc.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a></div><div class="ttdeci">int main(int argc, char **argv)</div><div class="ttdef"><b>Definition:</b> <a href="inclined__plane_8cc_source.html#l00756">inclined_plane.cc:756</a></div></div>
<div class="ttc" id="aclassInclinedPlaneProblem_html_a6ad45c76bd24f63c0162313042ce2e7d"><div class="ttname"><a href="classInclinedPlaneProblem.html#a6ad45c76bd24f63c0162313042ce2e7d">InclinedPlaneProblem::Output_prefix</a></div><div class="ttdeci">std::string Output_prefix</div><div class="ttdoc">Prefix for output files.</div><div class="ttdef"><b>Definition:</b> <a href="inclined__plane_8cc_source.html#l00156">inclined_plane.cc:156</a></div></div>
<div class="ttc" id="aclassInclinedPlaneProblem_html_a78d06d406af81a3dddbec0a31b65e8a4"><div class="ttname"><a href="classInclinedPlaneProblem.html#a78d06d406af81a3dddbec0a31b65e8a4">InclinedPlaneProblem::make_free_surface_elements</a></div><div class="ttdeci">void make_free_surface_elements()</div><div class="ttdef"><b>Definition:</b> <a href="inclined__plane_8cc_source.html#l00239">inclined_plane.cc:239</a></div></div>
<div class="ttc" id="anamespaceGlobal__Physical__Variables_html_a5feb3df21fc4a0adefadecb8a8ed98d7"><div class="ttname"><a href="namespaceGlobal__Physical__Variables.html#a5feb3df21fc4a0adefadecb8a8ed98d7">Global_Physical_Variables::Wall_normal</a></div><div class="ttdeci">Vector&lt; double &gt; Wall_normal</div><div class="ttdoc">Direction of the wall normal vector (at the inlet)</div><div class="ttdef"><b>Definition:</b> <a href="inclined__plane_8cc_source.html#l00081">inclined_plane.cc:81</a></div></div>
<div class="ttc" id="aclassElasticInclinedPlaneProblem_html_a5006b73d91fcb4bd20d0591577e50f61"><div class="ttname"><a href="classElasticInclinedPlaneProblem.html#a5006b73d91fcb4bd20d0591577e50f61">ElasticInclinedPlaneProblem::ElasticInclinedPlaneProblem</a></div><div class="ttdeci">ElasticInclinedPlaneProblem(const unsigned &amp;nx, const unsigned &amp;ny, const double &amp;length)</div><div class="ttdef"><b>Definition:</b> <a href="inclined__plane_8cc_source.html#l00692">inclined_plane.cc:692</a></div></div>
<div class="ttc" id="anamespaceGlobal__Physical__Variables_html_aa868968dead376240a69f9152bd599b9"><div class="ttname"><a href="namespaceGlobal__Physical__Variables.html#aa868968dead376240a69f9152bd599b9">Global_Physical_Variables::G</a></div><div class="ttdeci">Vector&lt; double &gt; G(2, 0.0)</div><div class="ttdoc">The Vector direction of gravity, set in main()</div></div>
<div class="ttc" id="aclassElasticInclinedPlaneMesh_html_a61ba6d852505dd1353e791223fdfce04"><div class="ttname"><a href="classElasticInclinedPlaneMesh.html#a61ba6d852505dd1353e791223fdfce04">ElasticInclinedPlaneMesh::ElasticInclinedPlaneMesh</a></div><div class="ttdeci">ElasticInclinedPlaneMesh(const unsigned &amp;nx, const unsigned &amp;ny, const double &amp;lx, const double &amp;ly, TimeStepper *time_stepper_pt)</div><div class="ttdef"><b>Definition:</b> <a href="inclined__plane_8cc_source.html#l00670">inclined_plane.cc:670</a></div></div>
<div class="ttc" id="aclassInclinedPlaneProblem_html_a0e2fcfdb8230df82729ba7d728e58040"><div class="ttname"><a href="classInclinedPlaneProblem.html#a0e2fcfdb8230df82729ba7d728e58040">InclinedPlaneProblem::solve_steady</a></div><div class="ttdeci">void solve_steady()</div><div class="ttdoc">Solve the steady problem.</div><div class="ttdef"><b>Definition:</b> <a href="inclined__plane_8cc_source.html#l00411">inclined_plane.cc:411</a></div></div>
<div class="ttc" id="aclassInclinedPlaneProblem_html_aba36d367278218bf00356c3bee0733a0"><div class="ttname"><a href="classInclinedPlaneProblem.html#aba36d367278218bf00356c3bee0733a0">InclinedPlaneProblem::Surface_mesh_pt</a></div><div class="ttdeci">Mesh * Surface_mesh_pt</div><div class="ttdoc">Mesh for the free surface elements.</div><div class="ttdef"><b>Definition:</b> <a href="inclined__plane_8cc_source.html#l00150">inclined_plane.cc:150</a></div></div>
<div class="ttc" id="aclassInclinedPlaneProblem_html_ad89c7dc7975bf128a7c249496fabc97f"><div class="ttname"><a href="classInclinedPlaneProblem.html#ad89c7dc7975bf128a7c249496fabc97f">InclinedPlaneProblem::~InclinedPlaneProblem</a></div><div class="ttdeci">~InclinedPlaneProblem()</div><div class="ttdoc">Generic desructor to clean up the memory allocated in the problem.</div><div class="ttdef"><b>Definition:</b> <a href="inclined__plane_8cc_source.html#l00385">inclined_plane.cc:385</a></div></div>
<div class="ttc" id="aclassSpineInclinedPlaneMesh_html_a97e770220d4cd41e11c86c5cfa289133"><div class="ttname"><a href="classSpineInclinedPlaneMesh.html#a97e770220d4cd41e11c86c5cfa289133">SpineInclinedPlaneMesh::SpineInclinedPlaneMesh</a></div><div class="ttdeci">SpineInclinedPlaneMesh(const unsigned &amp;nx, const unsigned &amp;ny, const double &amp;lx, const double &amp;ly, TimeStepper *time_stepper_pt)</div><div class="ttdef"><b>Definition:</b> <a href="inclined__plane_8cc_source.html#l00527">inclined_plane.cc:527</a></div></div>
<div class="ttc" id="aclassElasticInclinedPlaneProblem_html_a7e61d0cb5e10b7e98f949a43749477a6"><div class="ttname"><a href="classElasticInclinedPlaneProblem.html#a7e61d0cb5e10b7e98f949a43749477a6">ElasticInclinedPlaneProblem::actions_after_implicit_timestep</a></div><div class="ttdeci">void actions_after_implicit_timestep()</div><div class="ttdoc">Update Lagrangian positions after each timestep (updated-lagrangian approach)</div><div class="ttdef"><b>Definition:</b> <a href="inclined__plane_8cc_source.html#l00739">inclined_plane.cc:739</a></div></div>
<div class="ttc" id="aclassSpineInclinedPlaneProblem_html_a5eba548aaedf82845fd02403f06a42f7"><div class="ttname"><a href="classSpineInclinedPlaneProblem.html#a5eba548aaedf82845fd02403f06a42f7">SpineInclinedPlaneProblem::SpineInclinedPlaneProblem</a></div><div class="ttdeci">SpineInclinedPlaneProblem(const unsigned &amp;nx, const unsigned &amp;ny, const double &amp;length)</div><div class="ttdef"><b>Definition:</b> <a href="inclined__plane_8cc_source.html#l00613">inclined_plane.cc:613</a></div></div>
<div class="ttc" id="anamespaceGlobal__Physical__Variables_html_a3962c36313826b19f216f6bbbdd6a477"><div class="ttname"><a href="namespaceGlobal__Physical__Variables.html#a3962c36313826b19f216f6bbbdd6a477">Global_Physical_Variables::Nu</a></div><div class="ttdeci">double Nu</div><div class="ttdoc">Pseudo-solid Poisson ratio.</div><div class="ttdef"><b>Definition:</b> <a href="inclined__plane_8cc_source.html#l00128">inclined_plane.cc:128</a></div></div>
<div class="ttc" id="anamespaceGlobal__Physical__Variables_html_adf0e913323310713bf58ec469fb586e6"><div class="ttname"><a href="namespaceGlobal__Physical__Variables.html#adf0e913323310713bf58ec469fb586e6">Global_Physical_Variables::N_wave</a></div><div class="ttdeci">double N_wave</div><div class="ttdoc">Set the number of waves desired in the domain.</div><div class="ttdef"><b>Definition:</b> <a href="inclined__plane_8cc_source.html#l00075">inclined_plane.cc:75</a></div></div>
<div class="ttc" id="anamespaceGlobal__Physical__Variables_html_aa26e74c1f9f93f8212e45380f55fb562"><div class="ttname"><a href="namespaceGlobal__Physical__Variables.html#aa26e74c1f9f93f8212e45380f55fb562">Global_Physical_Variables::wall_unit_normal_inlet_fct</a></div><div class="ttdeci">void wall_unit_normal_inlet_fct(const Vector&lt; double &gt; &amp;x, Vector&lt; double &gt; &amp;normal)</div><div class="ttdoc">Function that specifies the wall unit normal at the inlet.</div><div class="ttdef"><b>Definition:</b> <a href="inclined__plane_8cc_source.html#l00084">inclined_plane.cc:84</a></div></div>
<div class="ttc" id="aclassInclinedPlaneProblem_html_a85bcc36a8ad4ad7aa3595585e73a3197"><div class="ttname"><a href="classInclinedPlaneProblem.html#a85bcc36a8ad4ad7aa3595585e73a3197">InclinedPlaneProblem::Traction_mesh_pt</a></div><div class="ttdeci">Mesh * Traction_mesh_pt</div><div class="ttdoc">Mesh for the traction elements that are added at inlet and outlet.</div><div class="ttdef"><b>Definition:</b> <a href="inclined__plane_8cc_source.html#l00147">inclined_plane.cc:147</a></div></div>
<div class="ttc" id="aclassElasticInclinedPlaneMesh_html"><div class="ttname"><a href="classElasticInclinedPlaneMesh.html">ElasticInclinedPlaneMesh</a></div><div class="ttdoc">Create an Elastic mesh for the problem.</div><div class="ttdef"><b>Definition:</b> <a href="inclined__plane_8cc_source.html#l00664">inclined_plane.cc:664</a></div></div>
<div class="ttc" id="anamespaceGlobal__Physical__Variables_html_aa2e802ee7cc8e1ac900ba94c3ce86eb7"><div class="ttname"><a href="namespaceGlobal__Physical__Variables.html#aa2e802ee7cc8e1ac900ba94c3ce86eb7">Global_Physical_Variables::Alpha</a></div><div class="ttdeci">double Alpha</div><div class="ttdoc">Angle of incline of the slope (45 degrees)</div><div class="ttdef"><b>Definition:</b> <a href="inclined__plane_8cc_source.html#l00063">inclined_plane.cc:63</a></div></div>
<div class="ttc" id="ainclined__plane_8txt_html_a4074baada03976c061d5672f4237cca5"><div class="ttname"><a href="inclined__plane_8txt.html#a4074baada03976c061d5672f4237cca5">problem</a></div><div class="ttdeci">mainpage Demo problem</div><div class="ttdef"><b>Definition:</b> <a href="inclined__plane_8txt_source.html#l00006">inclined_plane.txt:6</a></div></div>
<div class="ttc" id="ainclined__plane_8txt_html_a54012ea45635a54675f4997d85309327"><div class="ttname"><a href="inclined__plane_8txt.html#a54012ea45635a54675f4997d85309327">x</a></div><div class="ttdeci">H x,\qquad y^{ *}=H y,\qquad u^ *=U u,\qquad p^ *=\mu U/H,\f] and the governing equations become&lt; CENTER &gt; \f[\frac{\partial p}{\partial x}=\frac{\rho \, g H^{2}}{\mu U} \sin\alpha+\frac{\partial^{2} u}{\partial y^{2}}=\frac{Re}{Fr} \sin \alpha+\frac{\partial^{2} u}{\partial y^{2}}, \f] \f[\frac{\partial p}{\partial y}=-\frac{\rho \, g H^{2}}{\mu U} \cos\alpha=- \frac{Re}{Fr} \cos\alpha. \f]&lt;/CENTER &gt; The dimensionless grouping \f$ \rho g H^{2}/(\mu U) \f$ represents the ratio of gravitational forces to viscous forces and we choose to identify it as a Reynolds number \f$ Re=\rho U H/\mu\f$ divided by a Froude number \f$ Fr=U^{2}/(g H)\f$. We proceed by assuming that the flow is driven entirely by the gravitational body force and that there is no additional tangential pressure gradient. Then, integrating the tangential momentum balance twice and using the boundary conditions of no-slip at the plane(\f $y=0\f$) and that the free surface(\f $y=1\f$) is tangentially stress-free gives \f[u=\frac{1}{2}\frac{Re}{Fr}\sin\alpha \left(2 y - y^{2}\right). \f] Integrating the normal momentum balance and setting the reference external pressure to be zero at the free surface gives \f[p=\frac{Re}{Fr}\cos\alpha(1 - y).\f] Finally, we specify a &quot;natural&quot; velocity scale by setting \f $Re/Fr=2\f$, corresponding to the velocity of the free-surface for a vertical film(\f$\alpha=\pi/2\f$). We shall assess the stability of the flat-film solution by applying a small, short-duration perturbation to the wall velocity and evolving the system in time. If the interface is stable, the perturbation should decay, if not it should grow. A linear stability analysis for this problem was performed by Benjamin(1957) and Yih(1963), who both found that for long waves in the absence of surface tension, the interface was unstable when \f[Re &gt; \frac{5}{4} \sin\alpha. \f](If you read the papers you will see that the Reynolds number was defined such that the average fluid downslope velocity was one x</div><div class="ttdef"><b>Definition:</b> <a href="inclined__plane_8txt_source.html#l00072">inclined_plane.txt:72</a></div></div>
<div class="ttc" id="aclassSpineInclinedPlaneProblem_html"><div class="ttname"><a href="classSpineInclinedPlaneProblem.html">SpineInclinedPlaneProblem</a></div><div class="ttdef"><b>Definition:</b> <a href="inclined__plane_8cc_source.html#l00607">inclined_plane.cc:607</a></div></div>
<div class="ttc" id="aclassInclinedPlaneProblem_html_af9cf7a9677e823c52f1646105dfa7937"><div class="ttname"><a href="classInclinedPlaneProblem.html#af9cf7a9677e823c52f1646105dfa7937">InclinedPlaneProblem::actions_before_implicit_timestep</a></div><div class="ttdeci">void actions_before_implicit_timestep()</div><div class="ttdoc">Actions before the timestep (update the time-dependent boundary conditions)</div><div class="ttdef"><b>Definition:</b> <a href="inclined__plane_8cc_source.html#l00173">inclined_plane.cc:173</a></div></div>
<div class="ttc" id="aclassSpineInclinedPlaneProblem_html_af05f87be8b233df5a296f6375001d385"><div class="ttname"><a href="classSpineInclinedPlaneProblem.html#af05f87be8b233df5a296f6375001d385">SpineInclinedPlaneProblem::actions_before_newton_convergence_check</a></div><div class="ttdeci">void actions_before_newton_convergence_check()</div><div class="ttdef"><b>Definition:</b> <a href="inclined__plane_8cc_source.html#l00649">inclined_plane.cc:649</a></div></div>
<div class="ttc" id="aclassInclinedPlaneProblem_html_a74bbd1ccfd3dd82c999a16924c230f51"><div class="ttname"><a href="classInclinedPlaneProblem.html#a74bbd1ccfd3dd82c999a16924c230f51">InclinedPlaneProblem::timestep</a></div><div class="ttdeci">void timestep(const double &amp;dt, const unsigned &amp;n_tsteps)</div><div class="ttdoc">Take n_tsteps timesteps of size dt.</div><div class="ttdef"><b>Definition:</b> <a href="inclined__plane_8cc_source.html#l00444">inclined_plane.cc:444</a></div></div>
<div class="ttc" id="aclassInclinedPlaneProblem_html_a52d15d242c8f17a340914996b49a32a3"><div class="ttname"><a href="classInclinedPlaneProblem.html#a52d15d242c8f17a340914996b49a32a3">InclinedPlaneProblem::InclinedPlaneProblem</a></div><div class="ttdeci">InclinedPlaneProblem(const unsigned &amp;nx, const unsigned &amp;ny, const double &amp;length)</div><div class="ttdoc">Generic Constructor (empty)</div><div class="ttdef"><b>Definition:</b> <a href="inclined__plane_8cc_source.html#l00161">inclined_plane.cc:161</a></div></div>
<div class="ttc" id="anamespaceGlobal__Physical__Variables_html_a8b32b93d2e546f9375ec418474107838"><div class="ttname"><a href="namespaceGlobal__Physical__Variables.html#a8b32b93d2e546f9375ec418474107838">Global_Physical_Variables::Ca</a></div><div class="ttdeci">double Ca</div><div class="ttdoc">The Capillary number.</div><div class="ttdef"><b>Definition:</b> <a href="inclined__plane_8cc_source.html#l00069">inclined_plane.cc:69</a></div></div>
<div class="ttc" id="aclassElasticInclinedPlaneProblem_html"><div class="ttname"><a href="classElasticInclinedPlaneProblem.html">ElasticInclinedPlaneProblem</a></div><div class="ttdef"><b>Definition:</b> <a href="inclined__plane_8cc_source.html#l00687">inclined_plane.cc:687</a></div></div>
<div class="ttc" id="aclassInclinedPlaneProblem_html_a39ab8005f7603bd1f06f13d6e7a3ae64"><div class="ttname"><a href="classInclinedPlaneProblem.html#a39ab8005f7603bd1f06f13d6e7a3ae64">InclinedPlaneProblem::make_traction_elements</a></div><div class="ttdeci">void make_traction_elements()</div><div class="ttdoc">Function to add the traction boundary elements to boundaries 3(inlet) and 1(outlet) of the mesh.</div><div class="ttdef"><b>Definition:</b> <a href="inclined__plane_8cc_source.html#l00193">inclined_plane.cc:193</a></div></div>
<div class="ttc" id="anamespaceGlobal__Physical__Variables_html_a9da8be10d9e20eb0329af7fd8d6e0e98"><div class="ttname"><a href="namespaceGlobal__Physical__Variables.html#a9da8be10d9e20eb0329af7fd8d6e0e98">Global_Physical_Variables::K</a></div><div class="ttdeci">double K</div><div class="ttdoc">Set the wavenumber.</div><div class="ttdef"><b>Definition:</b> <a href="inclined__plane_8cc_source.html#l00072">inclined_plane.cc:72</a></div></div>
<div class="ttc" id="aclassSpineInclinedPlaneMesh_html_a01fa9c443029a6a00b1679a6785029f6"><div class="ttname"><a href="classSpineInclinedPlaneMesh.html#a01fa9c443029a6a00b1679a6785029f6">SpineInclinedPlaneMesh::spine_node_update</a></div><div class="ttdeci">virtual void spine_node_update(SpineNode *spine_node_pt)</div><div class="ttdoc">General node update function implements pure virtual function defined in SpineMesh base class and per...</div><div class="ttdef"><b>Definition:</b> <a href="inclined__plane_8cc_source.html#l00590">inclined_plane.cc:590</a></div></div>
<div class="ttc" id="anamespaceGlobal__Physical__Variables_html_a2a37fb040c832ee7a086bb13bb02a100"><div class="ttname"><a href="namespaceGlobal__Physical__Variables.html#a2a37fb040c832ee7a086bb13bb02a100">Global_Physical_Variables::Constitutive_law_pt</a></div><div class="ttdeci">ConstitutiveLaw * Constitutive_law_pt</div><div class="ttdoc">Constitutive law used to determine the mesh deformation.</div><div class="ttdef"><b>Definition:</b> <a href="inclined__plane_8cc_source.html#l00125">inclined_plane.cc:125</a></div></div>
<div class="ttc" id="anamespaceGlobal__Physical__Variables_html"><div class="ttname"><a href="namespaceGlobal__Physical__Variables.html">Global_Physical_Variables</a></div><div class="ttdef"><b>Definition:</b> <a href="inclined__plane_8cc_source.html#l00051">inclined_plane.cc:51</a></div></div>
<div class="ttc" id="aclassInclinedPlaneProblem_html_a20c506fe684dc146424b8ec019239783"><div class="ttname"><a href="classInclinedPlaneProblem.html#a20c506fe684dc146424b8ec019239783">InclinedPlaneProblem::Bulk_mesh_pt</a></div><div class="ttdeci">Mesh * Bulk_mesh_pt</div><div class="ttdoc">Bulk fluid mesh.</div><div class="ttdef"><b>Definition:</b> <a href="inclined__plane_8cc_source.html#l00144">inclined_plane.cc:144</a></div></div>
<div class="ttc" id="ainclined__plane_8txt_html_a578f5c14427faf3876df90e82c7d8fbe"><div class="ttname"><a href="inclined__plane_8txt.html#a578f5c14427faf3876df90e82c7d8fbe">Ca</a></div><div class="ttdeci">The hydrostatic pressure field is specified as an applied traction. At the outlet(inlet), the outer unit normal is in the positive(negative) \f $x\f$ direction and so the required traction is given by \f$-p\f$(\f $p\f$), \f[\mbox{\boldmath $t$}|_{\mbox{outlet}}=(-(Re/Fr)\cos\alpha(1 - y), 0), \qquad \mbox{\boldmath $t$}|_{\mbox{inlet}}=((Re/Fr)\cos\alpha(1 - y), 0).\f] These tractions are specified by the two different functions \skipline hydrostatic \until end of traction Note that \c G[\c 1] is the component of the gravitational body force in the vertical direction, so \f$ G[1]=- \cos\alpha\f$. We must also specify the direction of the normals(directed out of the fluid) to the notional walls that form the inlet and outlet and a contact angle of \f$ \pi/2 \f$ that will be used as a boundary condition on the free surface at the upstream end of the domain. In this case the normal to the inlet is in the negative x-direction and the normal to the outlet is in the positive x-direction. The actual value of the \c Wall_normal vector is set in \c main() \dontinclude inclined_plane.cc \skipline wall normal \until Inlet_Angle&lt; HR &gt;&lt; HR &gt; \section main The driver code We start by specifying the constitutive law used to define the mesh motion when pseudo-elastic deformation is used. \skipline start of main \until ::Nu Next, the type of fluid element is chosen according to specified compiler flags \skipline CR_ELEMENT \until #endif We then initialise the physical parameters, the Reynolds number and the direction of the gravitational body force, both based on the angle of inclination \f$\alpha\f$. \skipline Initialise physical \until G[1] We also set the direction of the notional wall normal vector. \until Wall_normal[1] We now create the spine version of the problem, solve the steady problem, assign initial conditions by assuming that the problem has been at the steady state for all previous times, and then evolve the system in time. \skipline Spine problem \until End of spine problem Finally, exactly the same procedure is performed for the elastic problem \skipline Elastic problem \until End of elastic problem&lt; HR &gt;&lt; HR &gt; \section mesh The mesh classes The base mesh class is the \c SimpleRectangularQuadMesh:boundary 0 will be the wall Ca</div><div class="ttdef"><b>Definition:</b> <a href="inclined__plane_8txt_source.html#l00205">inclined_plane.txt:205</a></div></div>
<div class="ttc" id="anamespaceGlobal__Physical__Variables_html_ab577639e7c51979d3db7565c08c69c70"><div class="ttname"><a href="namespaceGlobal__Physical__Variables.html#ab577639e7c51979d3db7565c08c69c70">Global_Physical_Variables::hydrostatic_pressure_outlet</a></div><div class="ttdeci">void hydrostatic_pressure_outlet(const double &amp;time, const Vector&lt; double &gt; &amp;x, const Vector&lt; double &gt; &amp;n, Vector&lt; double &gt; &amp;traction)</div><div class="ttdoc">Function that prescribes the hydrostatic pressure field at the outlet.</div><div class="ttdef"><b>Definition:</b> <a href="inclined__plane_8cc_source.html#l00106">inclined_plane.cc:106</a></div></div>
<div class="ttc" id="anamespaceGlobal__Physical__Variables_html_a987847160c3cfad8977836291fb9d0e0"><div class="ttname"><a href="namespaceGlobal__Physical__Variables.html#a987847160c3cfad8977836291fb9d0e0">Global_Physical_Variables::Length</a></div><div class="ttdeci">double Length</div><div class="ttdoc">The length of the domain to fit the desired number of waves.</div><div class="ttdef"><b>Definition:</b> <a href="inclined__plane_8cc_source.html#l00078">inclined_plane.cc:78</a></div></div>
<div class="ttc" id="aclassInclinedPlaneProblem_html_ae44e360be4a46e1343c3960c3a43380f"><div class="ttname"><a href="classInclinedPlaneProblem.html#ae44e360be4a46e1343c3960c3a43380f">InclinedPlaneProblem::complete_build</a></div><div class="ttdeci">void complete_build()</div><div class="ttdoc">Complete the build of the problem setting all standard parameters and boundary conditions.</div><div class="ttdef"><b>Definition:</b> <a href="inclined__plane_8cc_source.html#l00300">inclined_plane.cc:300</a></div></div>
<div class="ttc" id="aclassInclinedPlaneProblem_html_adefbac5880323d7de622e2ba0c526746"><div class="ttname"><a href="classInclinedPlaneProblem.html#adefbac5880323d7de622e2ba0c526746">InclinedPlaneProblem::Point_mesh_pt</a></div><div class="ttdeci">Mesh * Point_mesh_pt</div><div class="ttdoc">Mesh for the point elements at each end of the free surface.</div><div class="ttdef"><b>Definition:</b> <a href="inclined__plane_8cc_source.html#l00153">inclined_plane.cc:153</a></div></div>
<div class="ttc" id="aclassInclinedPlaneProblem_html"><div class="ttname"><a href="classInclinedPlaneProblem.html">InclinedPlaneProblem</a></div><div class="ttdoc">Generic problem class that will form the base class for both spine and elastic mesh-updates of the pr...</div><div class="ttdef"><b>Definition:</b> <a href="inclined__plane_8cc_source.html#l00138">inclined_plane.cc:138</a></div></div>
<div class="ttc" id="aclassSpineInclinedPlaneMesh_html"><div class="ttname"><a href="classSpineInclinedPlaneMesh.html">SpineInclinedPlaneMesh</a></div><div class="ttdoc">Create a spine mesh for the problem.</div><div class="ttdef"><b>Definition:</b> <a href="inclined__plane_8cc_source.html#l00522">inclined_plane.cc:522</a></div></div>
<div class="ttc" id="anamespaceGlobal__Physical__Variables_html_a1c3587461447262715bd444ac91a29c9"><div class="ttname"><a href="namespaceGlobal__Physical__Variables.html#a1c3587461447262715bd444ac91a29c9">Global_Physical_Variables::Inlet_Angle</a></div><div class="ttdeci">double Inlet_Angle</div><div class="ttdoc">The contact angle that is imposed at the inlet (pi)</div><div class="ttdef"><b>Definition:</b> <a href="inclined__plane_8cc_source.html#l00102">inclined_plane.cc:102</a></div></div>
<div class="ttc" id="ainclined__plane_8txt_html_aa0f8159f7168040576baa2fd5f94acb1"><div class="ttname"><a href="inclined__plane_8txt.html#aa0f8159f7168040576baa2fd5f94acb1">Re</a></div><div class="ttdeci">to convert to our Reynolds we must multiply by The figure below shows the time evolution of the interface on a slope of f pi f for Reynolds numbers of but decay when f Re</div><div class="ttdef"><b>Definition:</b> <a href="inclined__plane_8txt_source.html#l00080">inclined_plane.txt:80</a></div></div>

    <!-- jQuery for Bootstrap and Doxygen -->
    <script src="../../../js/jquery-1.12.0.min.js"></script>
    <!-- Minified boostrap plugins-->
    <script src="../../../js/bootstrap.js"></script>
    <!-- Doxygen dependency to add powertips to source code-->
    <script src="../../../js/jquery.powertip.min.js"></script>
    <!-- The  following script is generated by doxygen and hides/shows levels in 
         the data structure lists and adds powertips to source code-->
    <script src="../../../js/dynsections.js" ></script>
    <!-- add to Doxygen's class names so bootstrap css and js recognises them-->
    <script type="text/javascript">
    $(".contents").addClass("container");
    $(".header").addClass("container");
    $(".navpath").addClass("container");
    $("#navrow3").addClass("container");
    $("#navrow4").addClass("container");
    $(".mlabel").addClass("label");
    $(".mlabel").addClass("label-default");
    $(".memitem").addClass("panel");
    $(".memitem").addClass("panel-info");
    $(".memproto").addClass("panel-heading");
    $(".memdoc").addClass("panel-body");
    </script>
    <footer>
      <div class="container">
        <div class="text-muted" style="float:right;">Generated by <a href="http://www.doxygen.org/index.html">
          <img style="height:18px;" class="footer-img" src="doxygen.png" alt="doxygen"></a> on Fri Jul 9 2021 15:08:09
        </div>
      </div>
    </footer>
</body>
</html>

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
<title>oomph-lib: collapsible_channel.txt_doxygenified.h Source File</title>
<link rel="apple-touch-icon" sizes="57x57" href="../../../figures/apple-touch-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="../../../figures/apple-touch-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="../../../figures/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="../../../figures/apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="../../../figures/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="../../../figures/apple-touch-icon-120x120.png">
<link rel="icon" type="image/png" href="../../../figures/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="../../../figures/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="../../../figures/favicon-16x16.png" sizes="16x16">
<link rel="manifest" href="../../../figures/manifest.json">
<link rel="mask-icon" href="../../../figures/safari-pinned-tab.svg" color="#008000">
<link rel="shortcut icon" href="../../../figures/favicon.ico">
<meta name="msapplication-TileColor" content="#00a300">
<meta name="msapplication-config" content="../../../figures/browserconfig.xml">
<meta name="theme-color" content="#008000">
<link href="http://fonts.googleapis.com/css?family=Open+Sans:400,300,600" rel="stylesheet" type="text/css">
<!-- Doxygen css-->
<!-- <link rel="stylesheet" type="text/css" href="doxygen.css"> -->
<!-- Bootstrap -->
<link href="../../../css/bootstrap.css" rel="stylesheet">
<!-- oomph-lib specific overrides -->
<link rel="stylesheet" type="text/css" href="../../../css/oomph_header.css">
</head>
<body>
<nav class="navbar navbar-default">
<div class="container">
<div class="container-fluid">
  <!-- Brand and toggle get grouped for better mobile display -->
  <div class="navbar-header">
    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
      <span class="sr-only">Toggle navigation</span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="../../../html/index.html"><img alt="oomph-lib" src="../../../figures/oomph_logo.png"></a>
  </div>
  <!-- Collect the nav links, forms, and other content for toggling -->
  <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
    <ul class="nav navbar-nav">          
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Documentation <span class="caret"></span></a>
        <ul class="dropdown-menu">
          <li class="dropdown-header">Big picture</li>
          <li><a href="../../../../doc/intro/html/index.html">The finite element method</a></li>
          <li><a href="../../../../doc/the_data_structure/html/index.html">The data structure</a></li>
          <li><a href="../../../../doc/quick_guide/html/index.html">Not-so-quick guide</a></li>
          <li><a href="../../../../doc/optimisation/html/index.html">Optimisation</a></li>
          <li><a href="../../../../doc/order_of_action_functions/html/index.html">Order of action functions</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Example codes and tutorials</li>
          <li><a href="../../../../doc/example_code_list/html/index.html">List of example codes and tutorials</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#meshes">Meshing</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#solvers">Solvers</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#parallel">MPI parallel processing</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#visualisation">Post-processing/visualisation</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Other</li>
          <li><a href="../../../../doc/change_log/html/index.html">Change log</a></li>
          <li><a href="../../../../doc/creating_doc/html/index.html">Creating documentation</a></li>
          <li><a href="../../../../doc/coding_conventions/html/index.html">Coding conventions</a></li>
          <li><a href="../../../../doc/index/html/index.html">Index</a></li>
          <li><a href="../../../../doc/FAQ/html/index.html">FAQ</a></li>
        </ul>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Get it <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../../doc/the_distribution/html/index.html">Installation guide</a></li>
            <li><a href="../../../../doc/subversion/html/index.html">Get code from subversion repository</a></li>
            <li><a href="../../../../doc/download/html/index.html">Get code as tar file</a></li>
            <li><a href="../../../../doc/copyright/html/index.html">Copyright</a></li>
          </ul>
        </li>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">About <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../../doc/people/html/index.html">People</a></li>            
            <li><a href="../../../../doc/contact/html/index.html">Contact/Get involved</a></li>
            <li><a href="../../../../doc/publications/html/index.html">Publications</a></li>
            <li><a href="../../../../doc/acknowledgements/html/index.html">Acknowledgements</a></li>
            <li><a href="../../../../doc/picture_show/index.html">Picture show</a></li>
          </ul>
        </li>
      </li>
    </ul>
    <ul class="nav navbar-nav navbar-right navbar-search">
      <form class="navbar-form" role="search" action="../../../../doc/search_results/html/index.html">
        <div class="input-group">
          <input type="text" class="form-control" placeholder="Search" name="q">
          <span class="input-group-btn">
            <button class="btn btn-default" type="submit">Go</button>
          </span>
        </div><!-- /input-group -->
       <!--<div class="form-group">
          <input type="text" class="form-control" placeholder="Search">
        </div>
        <button type="submit" class="btn btn-default">Submit</button>-->
      </form>
    </ul>
  </div><!-- /.navbar-collapse -->
</div><!-- /.container-fluid -->
</div>
</nav>
<!-- Generated by Doxygen 1.8.17 -->
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">collapsible_channel.txt_doxygenified.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="collapsible__channel_8txt__doxygenified_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">\mainpage Demo problem: Flow in a 2D channel with an oscillating wall</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">The moving-boundary Navier-Stokes problem discussed in this document</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">is a &quot;warm-up&quot; problem for the classical fluid-structure interaction</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">problem of flow in a 2D collapsible channel. Here we compute the flow</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">through a 2D channel in which part of one wall is replaced by a moving</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">&quot;membrane&quot; whose motion is prescribed. In</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">&lt;A HREF=&quot;../../../interaction/fsi_collapsible_channel/html/index.html&quot;&gt;</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">another example&lt;/A&gt;, we will </span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">demonstrate how easy it is to extend the driver code for the current </span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">problem to a fluid-structure interaction problem in which the &quot;membrane&quot; is </span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">represented by an elastic beam that deforms in response to the</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">fluid traction.</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">We note that the (FSI version of the) problem considered here </span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">was analysed in much more detail in</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment"> </span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">&lt;UL&gt;</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">&lt;LI&gt; Jensen, O.E. &amp; Heil, M. (2003) High-frequency self-excited</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">oscillations in a collapsible-channel flow.</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">&lt;EM&gt;Journal of Fluid Mechanics&lt;/EM&gt; &lt;STRONG&gt;481&lt;/STRONG&gt;</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">235-268. </span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">&lt;A HREF=&quot;http://www.maths.man.ac.uk/~mheil/MATTHIAS/PDF/JensenHeil2003.pdf&quot;&gt;(pdf</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment"> preprint)&lt;/A&gt; </span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment">&lt;A HREF=&quot;http://www.maths.man.ac.uk/~mheil/MATTHIAS/ABSTRACTS/JensenHeil02.html&quot;&gt;(abstract)&lt;/A&gt;</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment">&lt;/UL&gt;</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">where a detailed discussion (and an asymptotic analysis) of the </span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment">flow-structures described below may be found. </span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment"> </span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment">&lt;HR&gt; </span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment">\section problem The problem </span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment">&lt;CENTER&gt;</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment">&lt;TABLE&gt;</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment">&lt;TR&gt; </span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment">&lt;TD&gt;</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment">&lt;CENTER&gt;</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment">&lt;B&gt;Finite-Reynolds-number flow in a 2D channel with an oscillating wall .&lt;/B&gt;</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment">&lt;/CENTER&gt; </span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment">The figure below shows a sketch of the problem: Flow is driven by a </span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment">prescribed pressure drop through a 2D channel of width </span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment">\f$ H^* \f$ and total length</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment">\f$ L^*_{total} = L^*_{up} + L^*_{collapsible} + L^*_{down}. \f$</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment">The upstream and downstream lengths of the channel are rigid, whereas</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment">the upper wall in the central section performs a prescribed</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment">oscillation. The shape of the moving segment is parametrised by a Lagrangian</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment">coordinate, \f$ \zeta^* \f$ , so that the position vector to </span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment">the moving wall is given by \f$ {\bf R}_w^*(\zeta^*,t^*)\f$ .</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="comment">\image html collapsible_channel_sketch.gif &quot;Sketch of the problem. &quot; </span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment">\image latex collapsible_channel_sketch.eps &quot;Sketch of the problem. &quot; width=0.75\textwidth</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment">We scale all lengths on the channel width, \f$ H^* \f$ , use the</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment">average velocity through the undeformed channel, </span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment">\f$ U =P^*_{up} H^{*2}/(12 \mu L^*_{total}) \f$ , </span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment">to scale the velocities, and use \f$ H^{*}/U \f$ to non-dimensionalise</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment">time. (As usual, we employ asterisks distinguish dimensional parameters from </span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment">their non-dimensional equivalents.)</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment">The flow is then governed by the unsteady Navier-Stokes equations</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment">\f[ </span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="comment">Re\left(St\frac{\partial u_i}{\partial t} +  </span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="comment">u_j\frac{\partial u_i}{\partial x_j}\right) =</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="comment">- \frac{\partial p}{\partial x_i} +</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="comment">\frac{\partial }{\partial x_j} \left(</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment">\frac{\partial u_i}{\partial x_j} +  </span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="comment">\frac{\partial u_j}{\partial x_i} \right)</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="comment"> \ \ \ \ \ \ \ \ \ \ (1)</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="comment">and the continuity equation</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="comment">\frac{\partial u_i}{\partial x_i} = 0</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="comment"> \ \ \ \ \ \ \ \ \ \ (2)</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment">with \f$ St=1 \f$ , subject to the following boundary and initial</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="comment">conditions:</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="comment">- Initial condition: Poiseuille flow, i.e. </span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="comment">  \f[</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="comment">  {\bf u}(x_1,x_2,t=0) = {\bf u}_{Poiseuille}(x_1,x_2) =   </span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="comment">  6 \ x_2 \  (1-x_2) \ {\bf e}_1.</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="comment">  \ \ \ \ \ \ \ \ \ \ (3)</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="comment">  \f]</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="comment">- Parallel inflow, \f$ {\bf u} \cdot {\bf e}_2 = {\bf 0}, \f$</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="comment">  and an applied axial traction of \f$ {\bf t} \cdot {\bf e}_1 = </span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="comment">  p_{up} = 12 \ L_{total} \f$ at the upstream end, \f$ x_1=0 \f$ .</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="comment">- Parallel, axially traction-free outflow at the downstream end, i.e.</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment">  \f$ {\bf u} \cdot {\bf e}_2 = {\bf 0} \f$ and  </span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="comment">  \f$ {\bf t} \cdot {\bf e}_1 = p_{down} = 0  \f$ at  \f$</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="comment">  x_1=L_{total} \f$ . </span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="comment">- No slip on all channel walls, i.e.  \f$ {\bf u} = {\bf 0} \f$ on </span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="comment">  the rigid walls and </span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="comment">  \f[</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="comment">  {\bf u} = \frac{\partial {\bf R}_w}{\partial t}</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="comment">  \mbox{\ \ \ \ on the moving wall.}</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="comment">  \ \ \ \ \ \ \ \ \ \ (4)</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="comment">  \f]</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="comment">&lt;/TD&gt;</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="comment">&lt;/TR&gt;</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="comment">&lt;/TABLE&gt;  </span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="comment">&lt;/CENTER&gt;</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="comment"> </span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="comment">We consider a wall motion that deforms the initially &quot;flush&quot; wall into </span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="comment">a parabolic shape. We denote the non-dimensional  </span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="comment">amplitude of the oscillation by \f$ A \f$ and its period by \f$ T \f$ ,</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="comment">and parametrise the position vector to a point on the wall by</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="comment">the Lagrangian coordinate \f$ \zeta \in [0,L_{collapsible}] \f$ as</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="comment">\f[ {\bf R}_w(\zeta,t) =</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="comment">\left(</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="comment">\begin{array}{l}</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="comment">L_{up} + \zeta  \\</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="comment">1 + A \left(\frac{2}{L_{collapsible}}\right)^2 \zeta \ (L-\zeta)</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="comment">   \ \sin(2\pi t / T)</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="comment">    \ {\cal R}(t)</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="comment">\end{array}</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="comment">\right),</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="comment"> \ \ \ \ \ \ \ \ \ \ (5)</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="comment">where the &quot;ramp&quot; function </span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="comment">{\cal R}(t) =  \left\{</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="comment">\begin{array}{ll}</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="comment">\frac{1}{2}(1-\cos(\pi t/T)) &amp; \mbox{for $t&lt;T$} \\</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="comment">1  &amp; \mbox{for $t \ge T$}</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="comment">\end{array}</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="comment">\right.</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="comment"> is used </span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="comment">to facilitate the start-up of the simulation from</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="comment">the initial condition of steady Poiseuille flow. \f$ {\cal R}(t) \f$</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="comment">provides a &quot;smooth&quot; startup of the wall motion during the first period </span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="comment">of the oscillation.</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="comment">\section reslt The results</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="comment">The figure below shows a snapshot, taken from </span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="comment">&lt;A HREF=&quot;../figures/flow.avi&quot;&gt;the animation of the</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="comment">computational results&lt;/A&gt;. The first four figures show (from top left to bottom</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="comment">right) &quot;carpet plots&quot; of the axial and transverse velocities,</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="comment">the axial component of the perturbation velocity </span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="comment">\f$ {\bf u} - {\bf u}_{Poiseuille} \f$ , and the pressure</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="comment">distribution. The 2D contour plot at the bottom</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="comment">of the figure shows a contour plot of the pressure and a few</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="comment">instantaneous streamlines.</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="comment">\image html flow.gif &quot;Snapshot from the animation of the flow field for Re = Re St = 50, T=0.45, A=0.01. &quot; </span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="comment">\image latex flow.eps &quot;Snapshot from the animation of the flow field for Re = Re St = 50, T=0.45, A=0.01. &quot; width=0.20\textwidth</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="comment">The figures illustrate the flow structures identified in</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="comment">&lt;A HREF=&quot;http://www.maths.man.ac.uk/~mheil/MATTHIAS/PDF/JensenHeil2003.pdf&quot;&gt;Jensen \&amp; Heil&#39;s (2003)&lt;/A&gt; asymptotic analysis of 2D channel flows </span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="comment">that are driven by high-frequency, small-amplitude oscillations of </span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="comment">a finite section of one of their walls: The flow consists of oscillatory</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="comment">axial &quot;sloshing flows&quot;, superimposed on the mean Poiseuille</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="comment">flow that is driven by the applied pressure drop. During phases when</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="comment">the wall moves inwards (outwards) the flow generated by the moving</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="comment">wall decelerates (accelerates) the flow in the upstream region as the wall</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="comment">&quot;injects&quot; fluid into (&quot;sucks&quot; fluid out of)  the domain. Conversely, </span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="comment">in the downstream region the flow generated by the wall</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="comment">adds to the pressure-driven mean flow during phases when the wall</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="comment">moves inwards. This is shown most clearly in the plot of the</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="comment">axial velocity perturbation. In the plots shown above, the wall</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="comment">moves outwards and the axial perturbation velocity is positive</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;<span class="comment">(i.e. in the direction of the pressure-driven mean flow) </span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="comment">in the upstream region, and negative in the downstream region. </span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="comment">This is also shown in the time-traces of the velocities</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="comment">at two control points in the in- and outflow cross-sections, </span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="comment">shown in the figure below:</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="comment">\image html trace.gif &quot;Time-trace of the axial velocities at two control points in the upstream and downstream cross-sections, and the vertical position of a control point on the wall. (Re = Re St = 50, T=0.45, A=0.01.) &quot; </span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;<span class="comment">\image latex trace.eps &quot;Time-trace of the axial velocities at two control points in the upstream and downstream cross-sections, and the vertical position of a control point on the wall. (Re = Re St = 50, T=0.45, A=0.01.) &quot; width=0.20\textwidth</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<span class="comment">Finally, we comment that the plot of the perturbation velocities </span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<span class="comment">confirms the two-layer structure of the sloshing flows predicted </span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="comment">in the asymptotic analysis.</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="comment">The sloshing flow comprises a blunt core flow region in which the flow is</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="comment">dominated by inertial effects while thin Stokes layers develop near the wall.</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="comment">Within these layers, the fluid viscosity reduces the axial velocity to zero. </span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="comment">The carpet plot of the pressure shows that the pressure </span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="comment">distribution is dominated by the variations induced by the oscillatory </span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="comment">sloshing  flows. For a detailed discussion of the flow structure we refer</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="comment">to &lt;A HREF=&quot;http://www.maths.man.ac.uk/~mheil/MATTHIAS/PDF/JensenHeil2003.pdf&quot;&gt;</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="comment">Jensen \&amp; Heil (2003).&lt;/A&gt;</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="comment">\section overview Overview of the driver code</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="comment">Overall, the driver code is very similar to codes developed </span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="comment">for other moving-boundary Navier-Stokes problems, such as the</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="comment">driver code used to simulate the &lt;A HREF=&quot;../../osc_ellipse/html/index.html&quot;&gt;</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="comment">flow inside an oscillating ellipse.&lt;/A&gt; The present code is slightly</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="comment">lengthier because of the traction boundary conditions</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="comment">which we impose by attaching traction elements to the upstream end of</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="comment">the mesh. (Refer to the </span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="comment">&lt;A HREF=&quot;../../../navier_stokes/rayleigh_traction_channel/html/index.html&quot;&gt;</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="comment">traction-driven Rayleigh problem&lt;/A&gt; for a more detailed</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="comment">discussion of this technique.) Also, as discussed in </span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;<span class="comment">&lt;A HREF=&quot;../../../poisson/two_d_poisson_flux_bc_adapt/html/index.html&quot;&gt;</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="comment">another example&lt;/A&gt;, the traction elements must be removed/re-attached </span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="comment">before/after every mesh adaptation.</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="comment">The domain is discretised by the  </span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="comment">&lt;A HREF=&quot;../../../meshes/mesh_list/html/index.html#collapsible_channel&quot;&gt;</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="comment">&lt;CODE&gt;CollapsibleChannelMesh&lt;/CODE&gt;&lt;/A&gt;</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="comment">which employs the &lt;CODE&gt;CollapsibleChannelDomain&lt;/CODE&gt;</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="comment">to provide a \c MacroElement - based representation of the </span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<span class="comment">deforming domain in terms of the \c GeomObject that describes the motion </span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;<span class="comment">of the &quot;collapsible&quot; section of the wall (boundary 3). The sketch </span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="comment">below illustrates</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="comment">the topology and the mesh deformation: As the wall deforms, the  </span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;<span class="comment">boundaries of the \c MacroElements in the &quot;collapsible&quot; part </span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;<span class="comment">of the \c Domain follow the wall motion.</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="comment">\image html mesh.gif &quot;Sketch of the CollapsibleChannelDomain/Mesh. &quot; </span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="comment">\image latex mesh.eps &quot;Sketch of the CollapsibleChannelDomain/Mesh. &quot; width=0.20\textwidth</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="comment">The no-slip boundary conditions on the moving wall are applied</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="comment">as in the &lt;A HREF=&quot;../../osc_ellipse/html/index.html&quot;&gt;</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;<span class="comment">oscillating ellipse problem,&lt;/A&gt; by executing the function</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="comment">\c FSI_functions::apply_no_slip_on_moving_wall(...)</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="comment">in \c Problem::actions_before_implicit_timestep() for all</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="comment">nodes that are located on boundary 3. </span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="comment">The following sections provide a complete annotated listing of the</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;<span class="comment">driver code. Most functions should already be familiar from </span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;<span class="comment">previous examples and you may want to skip straight to the</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;<span class="comment">\ref comments. </span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;<span class="comment">\section wall The moving wall </span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;<span class="comment">As usual, we represent the moving wall as a \c GeomObject and define</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;<span class="comment">its shape by implementing the pure virtual function </span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;<span class="comment">\c GeomObject::position(...). The arguments to the constructor</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;<span class="comment">specify the Eulerian coordinates of wall&#39;s left end, its</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;<span class="comment">undeformed length, the amplitude of the oscillations, </span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="comment">\f$ A \f$ , and the period of the oscillations \f$ T \f$ . We </span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="comment">also pass the pointer to a \c Time object to the constructor and </span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="comment">store it in a private data member, to </span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="comment">allow the \c position(...) functions to access the current </span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="comment">value of the continuous time. </span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="comment">The amplitude of the wall motion, and the period of its oscillations</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="comment">are stored as private data members, accessible via suitable</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="comment">member functions.</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="comment">\dontinclude collapsible_channel.cc</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="comment">\skipline start_of_oscillating_wall</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;<span class="comment">\until {return T;}</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;<span class="comment">Since the \c GeomObject represents a moving (i.e. time-dependent)</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;<span class="comment">boundary, we implement both versions of the \c</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;<span class="comment">GeomObject::position(...) function: The &quot;unsteady&quot; version </span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;<span class="comment">computes the position vector at the \c t -th previous timestep.</span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;<span class="comment">\until end of &quot;unsteady&quot;</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;<span class="comment">The version without additional argument computes the position vector</span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;<span class="comment">at the present time:</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;<span class="comment">\until }</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;<span class="comment">Finally, here are the various private data members:</span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;<span class="comment">\until end of oscillating wall</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;<span class="comment">[\b Note: We note that the \c OscillatingWall class</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;<span class="comment">allows the wall shape to be slightly more complicated than </span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;<span class="comment">required by (5). If the parameter</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;<span class="comment">\c B is set to a non-zero value, the material points </span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;<span class="comment">on the wall also undergo some horizontal displacement. </span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<span class="comment">We will use this capability in one of the exercises in </span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<span class="comment">section \ref comments.]</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;<span class="comment">\section variables  Namespace for the &quot;global&quot; physical variables</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="comment">As usual, we define the problem parameters in a namespace and</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;<span class="comment">assign default values that can be overwritten if required.</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;<span class="comment">\dontinclude collapsible_channel.cc</span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;<span class="comment">\skipline start_of_Global_Physical_Variables</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;<span class="comment">\until  double P_up=0.0</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;<span class="comment">We also implement the function that defines the prescribed (axial) </span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;<span class="comment">traction at the inflow boundary.</span></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;<span class="comment">\until end of Global_Physical_Variables</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="comment">\section main The driver code</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;<span class="comment">\dontinclude collapsible_channel.cc</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;<span class="comment">As with most previous time-dependent codes, we use command line</span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;<span class="comment">arguments to indicate if the code is run during \c oomph-lib&#39;s</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;<span class="comment">self-test. If any command line arguments are specified, we</span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;<span class="comment">use a coarser discretisation and perform fewer timesteps. </span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;<span class="comment">After storing the command line arguments, we choose the</span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;<span class="comment">number of elements in the mesh, set the lengths of the</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;<span class="comment">domain and choose the amplitude and period of the oscillation. </span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;<span class="comment">The parameter values are chosen such that the wall motion</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;<span class="comment">resembles that in the FSI simulations shown in Fig. 5 of </span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;<span class="comment"> &lt;A HREF=&quot;http://www.maths.man.ac.uk/~mheil/MATTHIAS/PDF/JensenHeil2003.pdf&quot;&gt;</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;<span class="comment">Jensen \&amp; Heil (2003).&lt;/A&gt;</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;<span class="comment">\skipline start_of_driver_code</span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;<span class="comment">\until  double period=0.45;</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;<span class="comment">We set the (non-dimensional) upstream pressure to </span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;<span class="comment">\f$ p_{up} = 12 L_{total }\f$ , </span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;<span class="comment">so that in the absence of any wall oscillation, the steady flow through the</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;<span class="comment">channel is Poiseuille flow, \f$ {\bf u} = {\bf u}_{Poiseuille} = </span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;<span class="comment">6 \ x_2 \ (1-x_2) \ {\bf e}_1 \f$ ; see \ref comments.</span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;<span class="comment">\until  Global_Physical_Variables::P_up=12.0*(lup+lcollapsible+ldown);</span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;<span class="comment">Next, we specify the output directory and build the problem with </span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;<span class="comment">refineable 2D Crouzeix Raviart Elements.</span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;<span class="comment">\until amplitude,period);</span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;<span class="comment">Next we set up the time-stepping parameters for a simulation </span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;<span class="comment">of three periods of the oscillation, performed with 40 timesteps</span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;<span class="comment">per period. Fewer timesteps are performed </span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;<span class="comment">if the code is run in self-test mode. </span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;<span class="comment">\until double t_min</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;<span class="comment">We initialise the timestepper and set the initial conditions before</span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;<span class="comment">documenting the initial condition. </span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;<span class="comment">\until doc_info.number()++;</span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;<span class="comment">Next we set the error targets for the adaptive mesh refinement; a</span></div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="comment">smaller target error is used when the code is run in self-test mode to ensure</span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;<span class="comment">that some mesh refinement is performed during the first few timesteps.</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;<span class="comment">\until  }</span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;<span class="comment">The timestepping loop itself is identical to that used in </span></div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;<span class="comment">&lt;A HREF=&quot;../../../unsteady_heat/two_d_unsteady_heat_adapt/html/index.html&quot;&gt;</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;<span class="comment">other time-dependent driver codes with adaptive mesh refinement&lt;/A&gt;.</span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;<span class="comment">During the first timestep, an arbitrary number of spatial adaptations</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;<span class="comment">may be performed, as the initial condition can be re-assigned</span></div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;<span class="comment">on the refined mesh. (This is indicated by setting the boolean flag</span></div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;<span class="comment">\c first to \c true when calling the spatially adaptive, </span></div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;<span class="comment">unsteady Newton solver.) During subsequent timesteps the need to interpolate</span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;<span class="comment">the history values onto the refined mesh limits the benefits of </span></div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;<span class="comment">repeated mesh adaptations and we limit the number of spatial </span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;<span class="comment">adaptations per timestep to 1. </span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;<span class="comment">\until end of driver code</span></div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;<span class="comment">\section problemclass The problem class </span></div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;<span class="comment">As usual, we template the problem class by the element type and </span></div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;<span class="comment">provide an access functions to the &quot;bulk&quot; Navier-Stokes mesh.</span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;<span class="comment">\dontinclude collapsible_channel.cc</span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;<span class="comment">\skipline start_of_problem_class</span></div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;<span class="comment">\until end of access to bulk mesh</span></div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;<span class="comment">No action is needed before or after solving, so </span></div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;<span class="comment">the pure virtual functions  \c Problem::actions_before_newton_solve() and</span></div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;<span class="comment">\c Problem::actions_after_newton_solve() can remain empty.</span></div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;<span class="comment">\until actions_after_newton_solve()</span></div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;<span class="comment">We will use the function \c Problem::actions_before_implicit_timestep()</span></div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;<span class="comment">to update the no-slip boundary conditions on the moving  wall before</span></div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;<span class="comment">each timestep and employ \c</span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;<span class="comment">Problem::actions_before_adapt() and  \c Problem::actions_after_adapt()</span></div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;<span class="comment">to wipe and rebuild the mesh of prescribed traction elements each time</span></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;<span class="comment">a mesh adaptation is performed. The functions</span></div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;<span class="comment">\c Problem::doc_solution(...) and </span></div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;<span class="comment">\c Problem::set_initial_condition() will do what they say...</span></div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;<span class="comment">\until  void doc_solution</span></div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;<span class="comment">The private helper functions \c create_traction_elements(...) and \c</span></div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;<span class="comment">delete_traction_elements() attach and remove the traction elements</span></div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;<span class="comment">from the upstream boundary of the &quot;bulk&quot; Navier-Stokes mesh.</span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;<span class="comment">\until void delete_traction_elements(Mesh* const &amp;surface_mesh_pt);</span></div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;<span class="comment">The private member data contains the geometric parameters</span></div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;<span class="comment">as well as the pointer to the \c GeomObject that describes the moving</span></div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;<span class="comment">wall.</span></div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;<span class="comment">\until  Wall_pt</span></div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;<span class="comment">Further private member data includes pointers to the &quot;bulk&quot; mesh and the</span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;<span class="comment">surface mesh that contains the traction elements, and pointers to control</span></div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;<span class="comment">nodes in the in- and outflow cross-sections.</span></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;<span class="comment">\until end of problem class</span></div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;<span class="comment">\section problemcontr The problem constructor</span></div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;<span class="comment">The arguments passed to the problem constructor specify the </span></div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;<span class="comment">number of elements and lengths of the various parts of the channel, </span></div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;<span class="comment">as well as the amplitude and period of the wall oscillations. </span></div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;<span class="comment">We store the parameters in the problem&#39;s private member data</span></div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;<span class="comment">and increase the maximum permitted residual for the Newton iteration.</span></div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;<span class="comment">\dontinclude collapsible_channel.cc</span></div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;<span class="comment">\skipline start_of_constructor</span></div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;<span class="comment">\until  Max_residuals</span></div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;<span class="comment">We continue by building the \c BDF&lt;2&gt; timestepper and pass a pointer </span></div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;<span class="comment">to it to  the \c Problem</span></div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;<span class="comment">\until  add_time_stepper_pt(new BDF&lt;2&gt;);</span></div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;<span class="comment">Next, we create the \c GeomObject that represents the oscillating wall, </span></div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;<span class="comment">and pass a pointer to it to the constructor of the </span></div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;<span class="comment">&lt;A HREF=&quot;../../../meshes/mesh_list/html/index.html#collapsible_channel&quot;&gt;</span></div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;<span class="comment">&lt;CODE&gt;CollapsibleChannelMesh&lt;/CODE&gt;&lt;/A&gt;</span></div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;<span class="comment">\skipline Create</span></div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;<span class="comment">\until time_stepper_pt()</span></div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;<span class="comment">We create a second mesh to store the applied traction elements</span></div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;<span class="comment">and attach them to the inflow boundary (boundary 5) of the &quot;bulk&quot; fluid </span></div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;<span class="comment">mesh, using the function \c create_traction_elements(...). </span></div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;<span class="comment">Both submeshes are then combined into a global mesh. </span></div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;<span class="comment">\skipline Create</span></div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;<span class="comment">\until build_global_mesh();</span></div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;<span class="comment">We create the spatial error estimator for the fluid mesh and loop</span></div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;<span class="comment">over the various elements to set the pointers to the relevant physical</span></div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;<span class="comment">parameters, first for the Navier-Stokes elements in the bulk mesh,</span></div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;<span class="comment">\until end loop over bulk elements</span></div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;<span class="comment">and then for the applied traction elements in the surface mesh:</span></div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;<span class="comment">\until end loop over applied traction elements </span></div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;<span class="comment">We apply the boundary conditions and pin the velocity on the</span></div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;<span class="comment">relevant mesh boundaries:</span></div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;<span class="comment">- both axial and transverse velocities are pinned along the bottom</span></div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;<span class="comment">  and the top boundaries (boundaries 0, 2, 3 and 4).</span></div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;<span class="comment">- the transverse velocities are pinned along the in- and outflow boundaries</span></div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;<span class="comment">  (boundaries 1 and 5).</span></div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;<span class="comment">.</span></div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;<span class="comment">\until pin_velocity</span></div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;<span class="comment">We select two control nodes on the inflow and outflow</span></div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;<span class="comment">boundaries to document the velocities.</span></div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;<span class="comment">\until  Right_node_pt= bulk_mesh_pt()-&gt;boundary_node_pt(ibound, control_nod);</span></div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;<span class="comment">Finally, we set up the equation numbering scheme.</span></div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;<span class="comment">\until end of constructor</span></div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;<span class="comment">&lt;HR&gt;  </span></div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;<span class="comment">\section doc Post processing</span></div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;<span class="comment">The function \c doc_solution(...) documents the</span></div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;<span class="comment">results, and records the time-trace of the axial velocities</span></div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;<span class="comment">at the two control nodes and the position of the midpoint </span></div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;<span class="comment">on the oscillating wall.</span></div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;<span class="comment">\dontinclude collapsible_channel.cc</span></div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;<span class="comment">\skipline start_of_doc_solution</span></div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;<span class="comment">\until end_of_doc_solution</span></div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;<span class="comment"> \section tractioncre Creation of the traction elements</span></div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;<span class="comment">The creation of the applied traction elements follows the usual </span></div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;<span class="comment">pattern, explained in detail </span></div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;<span class="comment">&lt;A HREF=&quot;../../../poisson/two_d_poisson_flux_bc_adapt/html/index.html&quot;&gt;</span></div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;<span class="comment">elsewhere&lt;/A&gt;: We loop over the elements in the fluid mesh that are </span></div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;<span class="comment">adjacent to the specified mesh boundary, and build the corresponding </span></div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;<span class="comment">traction elements, which are added to the surface mesh.</span></div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;<span class="comment">\dontinclude collapsible_channel.cc</span></div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;<span class="comment">\skipline start_of_create_traction_elements</span></div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;<span class="comment">\until end of create_traction_elements</span></div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;<span class="comment"> </span></div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;<span class="comment"> \section tractiondel Delete the traction elements</span></div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;<span class="comment">Since the &quot;bulk&quot; elements that the applied traction elements are</span></div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;<span class="comment">attached to may disappear during mesh adaptation, </span></div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;<span class="comment">we delete all traction elements before the adaptation</span></div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;<span class="comment">and re-attach them afterwards. The deletion is performed</span></div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;<span class="comment">by the following member function. Note that the surface mesh</span></div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;<span class="comment">that contains the traction elements is \e not deleted, as this would </span></div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;<span class="comment">also delete the associated nodes which are shared with the </span></div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;<span class="comment">corresponding bulk elements. </span></div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;<span class="comment">\dontinclude collapsible_channel.cc</span></div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;<span class="comment">\skipline start_of_delete_traction_elements</span></div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;<span class="comment">\until end of delete_traction_elements</span></div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;<span class="comment"> \section IC Apply the initial conditions</span></div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;<span class="comment">Initial conditions are applied as usual. We start by confirming</span></div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;<span class="comment">that the timestepper is a member of the \c BDF family </span></div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;<span class="comment">and therefore operates on history values that represent </span></div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;<span class="comment">the solution at previous timesteps. We assign the previous</span></div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;<span class="comment">nodal positions and velocities at all nodes, assuming that</span></div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;<span class="comment">for \f$ t&lt; 0 \f$ the wall is at rest and the flow field is </span></div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;<span class="comment">given by steady Poiseuille flow.</span></div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;<span class="comment">\dontinclude collapsible_channel.cc</span></div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;<span class="comment">\skipline start_of_apply_initial_conditions</span></div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;<span class="comment">\until end of set_initial_condition</span></div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;<span class="comment"> \section beforestep Actions before the timestep</span></div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;<span class="comment">Before each timestep, we update the nodal positions in the fluid mesh, and</span></div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;<span class="comment">apply the no-slip condition to each node on mesh boundary 3. </span></div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;<span class="comment">\dontinclude collapsible_channel.cc</span></div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;<span class="comment">\skipline start_of_actions_before_implicit_timestep</span></div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;<span class="comment">\until end of actions_before_implicit_timestep</span></div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;<span class="comment">\section beforeadapt Actions before the mesh adaptation</span></div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;<span class="comment">As discussed above, we delete the applied traction elements</span></div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;<span class="comment">before performing any mesh adaptation and then</span></div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;<span class="comment">rebuild the global mesh.</span></div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;<span class="comment">\dontinclude collapsible_channel.cc</span></div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;<span class="comment">\skipline start_of_actions_before_adapt</span></div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;<span class="comment">\until end of actions_before_adapt</span></div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;<span class="comment">\section beforeadapt Actions after the mesh adaptation</span></div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;<span class="comment">Once the mesh has been adapted, we (re-)create the prescribed </span></div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;<span class="comment">traction elements and rebuild the global mesh. </span></div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;<span class="comment">We also have to pass the pointers to prescribed traction function</span></div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;<span class="comment">to the newly created traction elements. </span></div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;<span class="comment">\skipline start_of_actions_after_adapt</span></div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;<span class="comment">\until end of actions_after_adapt</span></div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;<span class="comment">\section comments Comments and Exercises</span></div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;<span class="comment">-# Check the non-dimensionalisation of the governing</span></div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;<span class="comment">   equations and confirm that a (non-dimensional) upstream pressure</span></div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;<span class="comment">   \f$ p_{up} = 12 \ L_{total} \f$ is required to drive the steady</span></div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;<span class="comment">   Poiseuille flow specified by (3) through the </span></div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;<span class="comment">   static, undeformed channel. Use this to &quot;validate&quot; (well, </span></div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;<span class="comment">   &quot;plausibility-check&quot;, anyway...) the code by setting the </span></div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;<span class="comment">   amplitude of the wall oscillation to zero.</span></div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;<span class="comment">-# Double the upstream pressure while keeping the amplitude</span></div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;<span class="comment">   of the wall oscillation at zero and confirm that the flow </span></div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;<span class="comment">   accelerates until it (asymptotically) approaches Poiseuille</span></div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;<span class="comment">   flow with twice the initial flowrate as \f$ t \to \infty. \f$</span></div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;<span class="comment">-# The flow field has the largest velocity gradients in the thin</span></div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;<span class="comment">   Stokes layers near the wall, causing the automatic mesh adaptation</span></div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;<span class="comment">   procedure to refine the mesh pre-dominantly in these regions.</span></div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;<span class="comment">   To facilitate the resolution of such layers the</span></div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;<span class="comment">   \c CollapsibleChannelDomain and \c CollapsibleChannelMesh </span></div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;<span class="comment">   allow the specification of a mapping [0,1] -&gt; [0,1] that </span></div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;<span class="comment">   redistributes the nodal points in the vertical direction </span></div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;<span class="comment">   so that the elements near the wall become more squashed. </span></div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;<span class="comment">   By default the &quot;boundary-layer squash function&quot; is the identity</span></div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;<span class="comment">   but it may be overloaded by specifying a function pointer to an</span></div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;<span class="comment">   alternative function. The driver code already includes a demonstration of </span></div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;<span class="comment">   this capability which may be activated by compiling the driver</span></div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;<span class="comment">   code with \c -DUSE_BL_SQUASH_FCT. This activates the code</span></div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;<span class="comment">   segment</span></div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;<span class="comment">   \dontinclude collapsible_channel.cc</span></div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;<span class="comment">   \skipline ifdef USE</span></div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;<span class="comment">   \until endif</span></div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;<span class="comment">   in the Problem constructor. The &quot;squash function&quot; used for this </span></div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;<span class="comment">   example is defined in the following namespace:</span></div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;<span class="comment">   \dontinclude collapsible_channel.cc</span></div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;<span class="comment">   \skipline start_of_BL_Squash</span></div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;<span class="comment">   \until end of BL_Squash</span></div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;<span class="comment">   With this function 50% of the nodal points in the vertical</span></div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;<span class="comment">   direction are located within two boundary-layer regions which</span></div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;<span class="comment">   occupy 2 x 10% of the channel&#39;s width. The figure below</span></div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;<span class="comment">   shows the element shapes for a (coarse) initial mesh </span></div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;<span class="comment">   that is used in the validation run, with and</span></div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;<span class="comment">   without the boundary-layer squashing function:</span></div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;<span class="comment">\image html bl_squashing.gif &quot;Coarse initial meshes with and without the boundary-layer squash function. &quot; </span></div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;<span class="comment">\image latex bl_squashing.eps &quot;Coarse initial meshes with and without the boundary-layer squash function. &quot; width=0.75\textwidth</span></div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;<span class="comment">   Confirm that if this &quot;squashing function&quot; is applied to the</span></div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;<span class="comment">   mesh that is used during the non-self-test runs (this mesh has 16 x</span></div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;<span class="comment">   larger number of elements than the meshes shown above), the quality of the </span></div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;<span class="comment">   computed solution improves so much that no subsequent</span></div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;<span class="comment">   mesh adaptation is required.</span></div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;<span class="comment">-# The flow structures observed during the small-amplitude</span></div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;<span class="comment">   oscillations (shown in the animation at the beginning of this</span></div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;<span class="comment">   document) are in perfect agreement with the structures predicted</span></div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;<span class="comment">   by </span></div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;<span class="comment">   &lt;A HREF=&quot;http://www.maths.man.ac.uk/~mheil/MATTHIAS/PDF/JensenHeil2003.pdf&quot;&gt;</span></div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;<span class="comment">   Jensen \&amp; Heil&#39;s (2003)&lt;/A&gt; asymptotic analysis. As an exercise,</span></div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;<span class="comment">   increase the amplitude of the wall oscillation (to \f$ A=0.5\f$ ,</span></div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;<span class="comment">   say) to confirm that</span></div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;<span class="comment">   the flow-structure predicted by the theory (which is strictly</span></div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;<span class="comment">   applicable only for small-amplitude     </span></div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;<span class="comment">   oscillations) also provides an excellent description of of the</span></div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;<span class="comment">   system&#39;s behaviour during large-amplitude oscillations with</span></div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;<span class="comment">   more complicated wall motions.</span></div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;<span class="comment">   \n \n</span></div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;<span class="comment">   For instance, the figure below shows a snapshot of the</span></div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;<span class="comment">   &lt;A HREF=&quot;../figures/large_amplitude_flow.avi&quot;&gt;the animation of </span></div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;<span class="comment">   the computational </span></div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;<span class="comment">   results&lt;/A&gt;</span></div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;<span class="comment">   for an oscillation in which the wall undergoes a more complicated</span></div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;<span class="comment">   motion, described by</span></div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;<span class="comment">   \f[ {\bf R}_w(\zeta,t) =</span></div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;<span class="comment">   \left(</span></div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;<span class="comment">   \begin{array}{c}</span></div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;<span class="comment">   L_{up} + \zeta  \\</span></div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;<span class="comment">   1 </span></div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;<span class="comment">   \end{array}</span></div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;<span class="comment">   \right)</span></div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;<span class="comment">   + A</span></div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;<span class="comment">   \left(</span></div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;<span class="comment">   \begin{array}{l}</span></div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;<span class="comment">   - B \sin\left(\frac{2\pi}{L_{collapsible}}\zeta\right) \\</span></div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;<span class="comment">   \left(\frac{2}{L_{collapsible}}\right)^2 \zeta \ (L-\zeta)</span></div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;<span class="comment">   \end{array}</span></div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;<span class="comment">   \right)   </span></div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;<span class="comment">   \ \sin\left(\frac{2\pi t}{T}\right)</span></div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;<span class="comment">   \ {\cal R}(t)</span></div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;<span class="comment">   \ \ \ \ \ \ \ \ \ \ (6)</span></div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;<span class="comment">   \f]</span></div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;<span class="comment">   for \f$ A= B = 0.5 \f$ . For these parameter values, the wall performs</span></div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;<span class="comment">   a large-amplitude oscillation in the course of which material particles</span></div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;<span class="comment">   are not only displaced vertically but also in the horizontal</span></div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;<span class="comment">   direction. Nevertheless, the flow generated by the moving wall</span></div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;<span class="comment">   may be described as arising from the superposition of Poiseuille flow </span></div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;<span class="comment">   and an axial sloshing motion, the latter obviously having a </span></div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;<span class="comment">   much larger amplitude than in the previous case. The  </span></div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;<span class="comment">   &lt;A HREF=&quot;../figures/large_amplitude_flow.avi&quot;&gt;animation of</span></div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;<span class="comment">   the flow field&lt;/A&gt; shows that more complex local flow features </span></div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;<span class="comment">   develop briefly whenever the flow separates from the wall. However,</span></div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;<span class="comment">   the  appearance of these features does not change the macroscopic </span></div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;<span class="comment">   behaviour of the flow.</span></div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;<span class="comment">\image html large_amplitude_flow.gif &quot;Flow field for a large-amplitude wall motion. Re=ReSt=50; A=B=0.5; T=0.45. &quot; </span></div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;<span class="comment">\image latex large_amplitude_flow.eps &quot;Flow field for a large-amplitude wall motion. Re=ReSt=50; A=B=0.5; T=0.45. &quot; width=0.75\textwidth</span></div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;<span class="comment">\section sources Source files for this tutorial</span></div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;<span class="comment">- The source files for this tutorial are located in the directory:</span></div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;<span class="comment">&lt;CENTER&gt;</span></div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;<span class="comment">&lt;A HREF=&quot;../../../../demo_drivers/navier_stokes/collapsible_channel/&quot;&gt;</span></div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;<span class="comment">demo_drivers/navier_stokes/collapsible_channel/</span></div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;<span class="comment">&lt;/A&gt;</span></div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;<span class="comment">&lt;/CENTER&gt;</span></div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;<span class="comment">- The driver code is:</span></div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;<span class="comment">&lt;CENTER&gt;</span></div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;<span class="comment">&lt;A HREF=&quot;../../../../demo_drivers/navier_stokes/collapsible_channel/collapsible_channel.cc&quot;&gt;</span></div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;<span class="comment">demo_drivers/navier_stokes/collapsible_channel/collapsible_channel.cc</span></div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;<span class="comment">&lt;/A&gt;</span></div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;<span class="comment">&lt;/CENTER&gt;</span></div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;<span class="comment">.</span></div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;<span class="comment">&lt;hr&gt;</span></div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;<span class="comment">&lt;hr&gt;</span></div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;<span class="comment">\section pdf PDF file</span></div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;<span class="comment">A &lt;a href=&quot;../latex/refman.pdf&quot;&gt;pdf version&lt;/a&gt; of this document is available.</span></div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;<span class="comment">**/</span></div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160; </div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="anamespaceBL__Squash_html"><div class="ttname"><a href="namespaceBL__Squash.html">BL_Squash</a></div><div class="ttdef"><b>Definition:</b> <a href="collapsible__channel_8cc_source.html#l00045">collapsible_channel.cc:45</a></div></div>
<div class="ttc" id="acollapsible__channel_8txt_html_a2915e1695d3a1b958511c874d728cec0"><div class="ttname"><a href="collapsible__channel_8txt.html#a2915e1695d3a1b958511c874d728cec0">A</a></div><div class="ttdeci">mainpage Demo we will demonstrate how easy it is to extend the driver code for the current problem to a fluid structure interaction problem in which the membrane is represented by an elastic beam that deforms in response to the fluid traction We note that O E E[wall_shape] f where the ramp function f[{\cal R}(t)=\left\{\begin{array}{ll}\frac{1}{2}(1-\cos(\pi t/T)) &amp;\mbox{for $t&lt; T$} \\1 &amp;\mbox{for $t \ge T$}\end{array}\right.\f] is used to facilitate the start up of the simulation from the initial condition of steady Poiseuille flow taken from&lt; A HREF=&quot;../figures/flow.avi&quot;&gt; the animation of the computational results&lt;/A &gt; The first four figures the axial component of the perturbation velocity and the pressure distribution The contour plot at the bottom of the figure shows a contour plot of the pressure and a few instantaneous streamlines I w textwidth flow Snapshot from the animation of the flow field for A</div><div class="ttdef"><b>Definition:</b> <a href="collapsible__channel_8txt_source.html#l00157">collapsible_channel.txt:157</a></div></div>
<div class="ttc" id="acollapsible__channel_8txt_html_a5029cbcfe380e20c7fde05aef0838490"><div class="ttname"><a href="collapsible__channel_8txt.html#a5029cbcfe380e20c7fde05aef0838490">f</a></div><div class="ttdeci">mainpage Demo we will demonstrate how easy it is to extend the driver code for the current problem to a fluid structure interaction problem in which the membrane is represented by an elastic beam that deforms in response to the fluid traction We note that O E E[wall_shape] f where the ramp function f[{\cal R}(t)=\left\{\begin{array}{ll}\frac{1}{2}(1-\cos(\pi t/T)) &amp;\mbox{for $t&lt; T$} \\1 &amp;\mbox{for $t \ge T$}\end{array}\right.\f] is used to facilitate the start up of the simulation from the initial condition of steady Poiseuille flow f</div><div class="ttdef"><b>Definition:</b> <a href="collapsible__channel_8txt_source.html#l00137">collapsible_channel.txt:137</a></div></div>
<div class="ttc" id="acollapsible__channel_8txt_html_a61838f9c47f6d43a9f5f33c23be2b552"><div class="ttname"><a href="collapsible__channel_8txt.html#a61838f9c47f6d43a9f5f33c23be2b552">sections</a></div><div class="ttdeci">mainpage Demo we will demonstrate how easy it is to extend the driver code for the current problem to a fluid structure interaction problem in which the membrane is represented by an elastic beam that deforms in response to the fluid traction We note that O E E[wall_shape] f where the ramp function f[{\cal R}(t)=\left\{\begin{array}{ll}\frac{1}{2}(1-\cos(\pi t/T)) &amp;\mbox{for $t&lt; T$} \\1 &amp;\mbox{for $t \ge T$}\end{array}\right.\f] is used to facilitate the start up of the simulation from the initial condition of steady Poiseuille flow taken from&lt; A HREF=&quot;../figures/flow.avi&quot;&gt; the animation of the computational results&lt;/A &gt; The first four figures the axial component of the perturbation velocity and the pressure distribution The contour plot at the bottom of the figure shows a contour plot of the pressure and a few instantaneous streamlines I w textwidth flow Snapshot from the animation of the flow field for small amplitude oscillations of a finite section of one of their superimposed on the mean Poiseuille flow that is driven by the applied pressure drop During phases when the wall moves in the downstream region the flow generated by the wall adds to the pressure driven mean flow during phases when the wall moves inwards This is shown most clearly in the plot of the axial velocity perturbation In the plots shown the wall moves outwards and the axial perturbation velocity is and negative in the downstream region This is also shown in the time traces of the velocities at two control points in the in and outflow cross sections</div><div class="ttdef"><b>Definition:</b> <a href="collapsible__channel_8txt_source.html#l00176">collapsible_channel.txt:176</a></div></div>
<div class="ttc" id="acollapsible__channel_8txt_html_aa9ab2df18f14f109c1813f54982d34fa"><div class="ttname"><a href="collapsible__channel_8txt.html#aa9ab2df18f14f109c1813f54982d34fa">the</a></div><div class="ttdeci">mainpage Demo we will demonstrate how easy it is to extend the driver code for the current problem to a fluid structure interaction problem in which the membrane is represented by an elastic beam that deforms in response to the fluid traction We note that the(FSI version of the) problem considered here was analysed in much more detail in&lt; UL &gt;&lt; LI &gt; Jensen</div></div>
<div class="ttc" id="acollapsible__channel_8txt_html_a44bf80850ac2118ea51286f6ff188243"><div class="ttname"><a href="collapsible__channel_8txt.html#a44bf80850ac2118ea51286f6ff188243">Heil</a></div><div class="ttdeci">mainpage Demo we will demonstrate how easy it is to extend the driver code for the current problem to a fluid structure interaction problem in which the membrane is represented by an elastic beam that deforms in response to the fluid traction We note that O E &amp; Heil</div><div class="ttdef"><b>Definition:</b> <a href="collapsible__channel_8txt_source.html#l00020">collapsible_channel.txt:20</a></div></div>
<div class="ttc" id="acollapsible__channel_8txt_html_ab6f2ff3d7b4cb9e1dfd1922675cfbb68"><div class="ttname"><a href="collapsible__channel_8txt.html#ab6f2ff3d7b4cb9e1dfd1922675cfbb68">show</a></div><div class="ttdeci">mainpage Demo we will demonstrate how easy it is to extend the driver code for the current problem to a fluid structure interaction problem in which the membrane is represented by an elastic beam that deforms in response to the fluid traction We note that O E E[wall_shape] f where the ramp function f[{\cal R}(t)=\left\{\begin{array}{ll}\frac{1}{2}(1-\cos(\pi t/T)) &amp;\mbox{for $t&lt; T$} \\1 &amp;\mbox{for $t \ge T$}\end{array}\right.\f] is used to facilitate the start up of the simulation from the initial condition of steady Poiseuille flow taken from&lt; A HREF=&quot;../figures/flow.avi&quot;&gt; the animation of the computational results&lt;/A &gt; The first four figures show(from top left to bottom right) &quot;carpet plots&quot; of the axial and transverse velocities</div></div>
<div class="ttc" id="acollapsible__channel_8txt_html_a6731da7547887debc821595175472553"><div class="ttname"><a href="collapsible__channel_8txt.html#a6731da7547887debc821595175472553">below</a></div><div class="ttdeci">mainpage Demo we will demonstrate how easy it is to extend the driver code for the current problem to a fluid structure interaction problem in which the membrane is represented by an elastic beam that deforms in response to the fluid traction We note that O E E[wall_shape] f where the ramp function f[{\cal R}(t)=\left\{\begin{array}{ll}\frac{1}{2}(1-\cos(\pi t/T)) &amp;\mbox{for $t&lt; T$} \\1 &amp;\mbox{for $t \ge T$}\end{array}\right.\f] is used to facilitate the start up of the simulation from the initial condition of steady Poiseuille flow taken from&lt; A HREF=&quot;../figures/flow.avi&quot;&gt; the animation of the computational results&lt;/A &gt; The first four figures the axial component of the perturbation velocity and the pressure distribution The contour plot at the bottom of the figure shows a contour plot of the pressure and a few instantaneous streamlines I w textwidth flow Snapshot from the animation of the flow field for small amplitude oscillations of a finite section of one of their superimposed on the mean Poiseuille flow that is driven by the applied pressure drop During phases when the wall moves in the downstream region the flow generated by the wall adds to the pressure driven mean flow during phases when the wall moves inwards This is shown most clearly in the plot of the axial velocity perturbation In the plots shown the wall moves outwards and the axial perturbation velocity is and negative in the downstream region This is also shown in the time traces of the velocities at two control points in the in and outflow cross shown in the figure below</div><div class="ttdef"><b>Definition:</b> <a href="collapsible__channel_8txt_source.html#l00180">collapsible_channel.txt:180</a></div></div>
<div class="ttc" id="acollapsible__channel_8txt_html_a7973e216d985946cf3476a15baad81ca"><div class="ttname"><a href="collapsible__channel_8txt.html#a7973e216d985946cf3476a15baad81ca">L_</a></div><div class="ttdeci">mainpage Demo we will demonstrate how easy it is to extend the driver code for the current problem to a fluid structure interaction problem in which the membrane is represented by an elastic beam that deforms in response to the fluid traction We note that O E L_</div><div class="ttdef"><b>Definition:</b> <a href="collapsible__channel_8txt_source.html#l00114">collapsible_channel.txt:114</a></div></div>
<div class="ttc" id="acollapsible__channel_8txt_html_ab1643ef54464821a630b9ff8e91d5a54"><div class="ttname"><a href="collapsible__channel_8txt.html#ab1643ef54464821a630b9ff8e91d5a54">wall</a></div><div class="ttdeci">mainpage Demo we will demonstrate how easy it is to extend the driver code for the current problem to a fluid structure interaction problem in which the membrane is represented by an elastic beam that deforms in response to the fluid traction We note that O E E[wall_shape] f where the ramp function f[{\cal R}(t)=\left\{\begin{array}{ll}\frac{1}{2}(1-\cos(\pi t/T)) &amp;\mbox{for $t&lt; T$} \\1 &amp;\mbox{for $t \ge T$}\end{array}\right.\f] is used to facilitate the start up of the simulation from the initial condition of steady Poiseuille flow taken from&lt; A HREF=&quot;../figures/flow.avi&quot;&gt; the animation of the computational results&lt;/A &gt; The first four figures the axial component of the perturbation velocity and the pressure distribution The contour plot at the bottom of the figure shows a contour plot of the pressure and a few instantaneous streamlines I w textwidth flow Snapshot from the animation of the flow field for small amplitude oscillations of a finite section of one of their superimposed on the mean Poiseuille flow that is driven by the applied pressure drop During phases when the wall moves in the downstream region the flow generated by the wall adds to the pressure driven mean flow during phases when the wall moves inwards This is shown most clearly in the plot of the axial velocity perturbation In the plots shown the wall moves outwards and the axial perturbation velocity is and negative in the downstream region This is also shown in the time traces of the velocities at two control points in the in and outflow cross shown in the figure and the vertical position of a control point on the wall(Re=Re St=50, T=0.45, A=0.01.) &quot; Finally</div></div>
<div class="ttc" id="acollapsible__channel_8txt_html_ac4952e657b7da1dbb7923ec12b675021"><div class="ttname"><a href="collapsible__channel_8txt.html#ac4952e657b7da1dbb7923ec12b675021">T</a></div><div class="ttdeci">mainpage Demo we will demonstrate how easy it is to extend the driver code for the current problem to a fluid structure interaction problem in which the membrane is represented by an elastic beam that deforms in response to the fluid traction We note that O E E[wall_shape] f where the ramp function f[{\cal R}(t)=\left\{\begin{array}{ll}\frac{1}{2}(1-\cos(\pi t/T)) &amp;\mbox{for $t&lt; T$} \\1 &amp;\mbox{for $t \ge T$}\end{array}\right.\f] is used to facilitate the start up of the simulation from the initial condition of steady Poiseuille flow taken from&lt; A HREF=&quot;../figures/flow.avi&quot;&gt; the animation of the computational results&lt;/A &gt; The first four figures the axial component of the perturbation velocity and the pressure distribution The contour plot at the bottom of the figure shows a contour plot of the pressure and a few instantaneous streamlines I w textwidth flow Snapshot from the animation of the flow field for T</div><div class="ttdef"><b>Definition:</b> <a href="collapsible__channel_8txt_source.html#l00157">collapsible_channel.txt:157</a></div></div>
<div class="ttc" id="anamespaceoomph_html"><div class="ttname"><a href="namespaceoomph.html">oomph</a></div><div class="ttdef"><b>Definition:</b> <a href="my__alg__channel__mesh_8h_source.html#l00040">my_alg_channel_mesh.h:40</a></div></div>
<div class="ttc" id="acollapsible__channel_8txt_html_a3dc8dd8c3d19f6ce879e28f0edbdb968"><div class="ttname"><a href="collapsible__channel_8txt.html#a3dc8dd8c3d19f6ce879e28f0edbdb968">M</a></div><div class="ttdeci">mainpage Demo we will demonstrate how easy it is to extend the driver code for the current problem to a fluid structure interaction problem in which the membrane is represented by an elastic beam that deforms in response to the fluid traction We note that O E M(2003) High-frequency self-excited oscillations in a collapsible-channel flow.&lt; EM &gt;Journal of Fluid Mechanics&lt;/EM &gt;&lt; STRONG &gt;481&lt;/STRONG &gt; 235-268.&lt; A HREF</div></div>
<div class="ttc" id="aclassOscillatingWall_html"><div class="ttname"><a href="classOscillatingWall.html">OscillatingWall</a></div><div class="ttdef"><b>Definition:</b> <a href="collapsible__channel_8cc_source.html#l00116">collapsible_channel.cc:116</a></div></div>
<div class="ttc" id="acollapsible__channel_8txt_html_ac6d7f0f8d4edea7349659b55aaf3c386"><div class="ttname"><a href="collapsible__channel_8txt.html#ac6d7f0f8d4edea7349659b55aaf3c386">above</a></div><div class="ttdeci">mainpage Demo we will demonstrate how easy it is to extend the driver code for the current problem to a fluid structure interaction problem in which the membrane is represented by an elastic beam that deforms in response to the fluid traction We note that O E E[wall_shape] f where the ramp function f[{\cal R}(t)=\left\{\begin{array}{ll}\frac{1}{2}(1-\cos(\pi t/T)) &amp;\mbox{for $t&lt; T$} \\1 &amp;\mbox{for $t \ge T$}\end{array}\right.\f] is used to facilitate the start up of the simulation from the initial condition of steady Poiseuille flow taken from&lt; A HREF=&quot;../figures/flow.avi&quot;&gt; the animation of the computational results&lt;/A &gt; The first four figures the axial component of the perturbation velocity and the pressure distribution The contour plot at the bottom of the figure shows a contour plot of the pressure and a few instantaneous streamlines I w textwidth flow Snapshot from the animation of the flow field for small amplitude oscillations of a finite section of one of their superimposed on the mean Poiseuille flow that is driven by the applied pressure drop During phases when the wall moves in the downstream region the flow generated by the wall adds to the pressure driven mean flow during phases when the wall moves inwards This is shown most clearly in the plot of the axial velocity perturbation In the plots shown above</div><div class="ttdef"><b>Definition:</b> <a href="collapsible__channel_8txt_source.html#l00171">collapsible_channel.txt:171</a></div></div>
<div class="ttc" id="acollapsible__channel_8txt_html_a4796b25d82d7887f208d57321e1b4184"><div class="ttname"><a href="collapsible__channel_8txt.html#a4796b25d82d7887f208d57321e1b4184">walls</a></div><div class="ttdeci">mainpage Demo we will demonstrate how easy it is to extend the driver code for the current problem to a fluid structure interaction problem in which the membrane is represented by an elastic beam that deforms in response to the fluid traction We note that O E E[wall_shape] f where the ramp function f[{\cal R}(t)=\left\{\begin{array}{ll}\frac{1}{2}(1-\cos(\pi t/T)) &amp;\mbox{for $t&lt; T$} \\1 &amp;\mbox{for $t \ge T$}\end{array}\right.\f] is used to facilitate the start up of the simulation from the initial condition of steady Poiseuille flow taken from&lt; A HREF=&quot;../figures/flow.avi&quot;&gt; the animation of the computational results&lt;/A &gt; The first four figures the axial component of the perturbation velocity and the pressure distribution The contour plot at the bottom of the figure shows a contour plot of the pressure and a few instantaneous streamlines I w textwidth flow Snapshot from the animation of the flow field for small amplitude oscillations of a finite section of one of their walls</div><div class="ttdef"><b>Definition:</b> <a href="collapsible__channel_8txt_source.html#l00163">collapsible_channel.txt:163</a></div></div>
<div class="ttc" id="anamespaceGlobal__Physical__Variables_html"><div class="ttname"><a href="namespaceGlobal__Physical__Variables.html">Global_Physical_Variables</a></div><div class="ttdoc">Namespace for phyical parameters.</div><div class="ttdef"><b>Definition:</b> <a href="collapsible__channel_8cc_source.html#l00205">collapsible_channel.cc:205</a></div></div>
<div class="ttc" id="acollapsible__channel_8txt_html_a4074baada03976c061d5672f4237cca5"><div class="ttname"><a href="collapsible__channel_8txt.html#a4074baada03976c061d5672f4237cca5">problem</a></div><div class="ttdeci">mainpage Demo problem</div><div class="ttdef"><b>Definition:</b> <a href="collapsible__channel_8txt_source.html#l00009">collapsible_channel.txt:9</a></div></div>
<div class="ttc" id="acollapsible__channel_8cc_html_a0ddf1224851353fc92bfbff6f499fa97"><div class="ttname"><a href="collapsible__channel_8cc.html#a0ddf1224851353fc92bfbff6f499fa97">main</a></div><div class="ttdeci">int main(int argc, char *argv[])</div><div class="ttdef"><b>Definition:</b> <a href="collapsible__channel_8cc_source.html#l00772">collapsible_channel.cc:772</a></div></div>
<div class="ttc" id="anamespaceGlobal__Physical__Variables_html_ae1a493695b7f4619af32f405b0b28861"><div class="ttname"><a href="namespaceGlobal__Physical__Variables.html#ae1a493695b7f4619af32f405b0b28861">Global_Physical_Variables::P_up</a></div><div class="ttdeci">double P_up</div><div class="ttdoc">Default pressure on the left boundary.</div><div class="ttdef"><b>Definition:</b> <a href="collapsible__channel_8cc_source.html#l00214">collapsible_channel.cc:214</a></div></div>

    <!-- jQuery for Bootstrap and Doxygen -->
    <script src="../../../js/jquery-1.12.0.min.js"></script>
    <!-- Minified boostrap plugins-->
    <script src="../../../js/bootstrap.js"></script>
    <!-- Doxygen dependency to add powertips to source code-->
    <script src="../../../js/jquery.powertip.min.js"></script>
    <!-- The  following script is generated by doxygen and hides/shows levels in 
         the data structure lists and adds powertips to source code-->
    <script src="../../../js/dynsections.js" ></script>
    <!-- add to Doxygen's class names so bootstrap css and js recognises them-->
    <script type="text/javascript">
    $(".contents").addClass("container");
    $(".header").addClass("container");
    $(".navpath").addClass("container");
    $("#navrow3").addClass("container");
    $("#navrow4").addClass("container");
    $(".mlabel").addClass("label");
    $(".mlabel").addClass("label-default");
    $(".memitem").addClass("panel");
    $(".memitem").addClass("panel-info");
    $(".memproto").addClass("panel-heading");
    $(".memdoc").addClass("panel-body");
    </script>
    <footer>
      <div class="container">
        <div class="text-muted" style="float:right;">Generated by <a href="http://www.doxygen.org/index.html">
          <img style="height:18px;" class="footer-img" src="doxygen.png" alt="doxygen"></a> on Mon Aug 9 2021 08:55:27
        </div>
      </div>
    </footer>
</body>
</html>

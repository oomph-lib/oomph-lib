\hypertarget{jeffery__orbit_8cc_source}{}\doxysection{jeffery\+\_\+orbit.\+cc}
\label{jeffery__orbit_8cc_source}\index{jeffery\_orbit.cc@{jeffery\_orbit.cc}}
\mbox{\hyperlink{jeffery__orbit_8cc}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00001}00001 \textcolor{comment}{//LIC// ====================================================================}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00002}00002 \textcolor{comment}{//LIC// This file forms part of oomph-\/lib, the object-\/oriented, }}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00003}00003 \textcolor{comment}{//LIC// multi-\/physics finite-\/element library, available }}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00004}00004 \textcolor{comment}{//LIC// at http://www.oomph-\/lib.org.}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00005}00005 \textcolor{comment}{//LIC// }}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00006}00006 \textcolor{comment}{//LIC// Copyright (C) 2006-\/2021 Matthias Heil and Andrew Hazel}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00007}00007 \textcolor{comment}{//LIC// }}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00008}00008 \textcolor{comment}{//LIC// This library is free software; you can redistribute it and/or}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00009}00009 \textcolor{comment}{//LIC// modify it under the terms of the GNU Lesser General Public}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00010}00010 \textcolor{comment}{//LIC// License as published by the Free Software Foundation; either}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00011}00011 \textcolor{comment}{//LIC// version 2.1 of the License, or (at your option) any later version.}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00012}00012 \textcolor{comment}{//LIC// }}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00013}00013 \textcolor{comment}{//LIC// This library is distributed in the hope that it will be useful,}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00014}00014 \textcolor{comment}{//LIC// but WITHOUT ANY WARRANTY; without even the implied warranty of}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00015}00015 \textcolor{comment}{//LIC// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00016}00016 \textcolor{comment}{//LIC// Lesser General Public License for more details.}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00017}00017 \textcolor{comment}{//LIC// }}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00018}00018 \textcolor{comment}{//LIC// You should have received a copy of the GNU Lesser General Public}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00019}00019 \textcolor{comment}{//LIC// License along with this library; if not, write to the Free Software}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00020}00020 \textcolor{comment}{//LIC// Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00021}00021 \textcolor{comment}{//LIC// 02110-\/1301  USA.}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00022}00022 \textcolor{comment}{//LIC// }}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00023}00023 \textcolor{comment}{//LIC// The authors may be contacted at oomph-\/lib@maths.man.ac.uk.}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00024}00024 \textcolor{comment}{//LIC// }}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00025}00025 \textcolor{comment}{//LIC//====================================================================}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00026}00026 \textcolor{comment}{// Driver to demonstrate the interaction of a fluid flow with a rigid body.}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00027}00027 \textcolor{comment}{// The driver solves a classic problem of the motion of an rigid ellipse in}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00028}00028 \textcolor{comment}{// a shear flow. The problem imposes a smooth, but rapid, start-\/up from}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00029}00029 \textcolor{comment}{// no flow to a shear imposed on the boundaries of a rectangular domain}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00030}00030 \textcolor{comment}{// and the ellipse soon settles into approximate Jeffery orbits for small}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00031}00031 \textcolor{comment}{// enough Reynolds number.}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00032}00032 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00033}00033 \textcolor{comment}{//Generic routines}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00034}00034 \textcolor{preprocessor}{\#include "{}generic.h"{}}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00035}00035 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00036}00036 \textcolor{comment}{// The equations}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00037}00037 \textcolor{preprocessor}{\#include "{}navier\_stokes.h"{}}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00038}00038 \textcolor{preprocessor}{\#include "{}solid.h"{}}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00039}00039 \textcolor{preprocessor}{\#include "{}constitutive.h"{}}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00040}00040 \textcolor{preprocessor}{\#include "{}rigid\_body.h"{}}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00041}00041 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00042}00042 \textcolor{comment}{// The mesh}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00043}00043 \textcolor{preprocessor}{\#include "{}meshes/triangle\_mesh.h"{}}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00044}00044 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00045}00045 \textcolor{comment}{//Thin wrapper to "{}custom"{} TaylorHoodElements that overload output functions}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00046}00046 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{my__taylor__hood__elements_8h}{my\_taylor\_hood\_elements.h}}"{}}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00047}00047 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00048}00048 \textcolor{preprocessor}{\#include <algorithm>}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00049}00049 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00050}00050 \textcolor{keyword}{using namespace }std;}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00051}00051 \textcolor{keyword}{using namespace }\mbox{\hyperlink{namespaceoomph}{oomph}};}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00052}00052 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00053}00053 \textcolor{comment}{//==start\_of\_namespace==============================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00054}00054 \textcolor{comment}{/// Namespace for Problem Parameters}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00055}00055 \textcolor{comment}{}\textcolor{comment}{//==================================================}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00056}\mbox{\hyperlink{namespaceProblem__Parameter}{00056}}  \textcolor{keyword}{namespace }\mbox{\hyperlink{namespaceProblem__Parameter}{Problem\_Parameter}}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00057}00057  \{    \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00058}00058 \textcolor{comment}{  /// Reynolds number}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00059}\mbox{\hyperlink{namespaceProblem__Parameter_acc656299287d4d9a8374c2c501750b4f}{00059}} \textcolor{comment}{}  \textcolor{keywordtype}{double} \mbox{\hyperlink{namespaceProblem__Parameter_acc656299287d4d9a8374c2c501750b4f}{Re}}=1.0;}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00060}00060 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00061}00061 \textcolor{comment}{  /// Strouhal number}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00062}\mbox{\hyperlink{namespaceProblem__Parameter_a8d9b76e390569bac0095bd0952281a30}{00062}} \textcolor{comment}{}  \textcolor{keywordtype}{double} \mbox{\hyperlink{namespaceProblem__Parameter_a8d9b76e390569bac0095bd0952281a30}{St}} = 1.0;}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00063}00063  \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00064}00064 \textcolor{comment}{  /// Density ratio (Solid density / Fluid density)}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00065}\mbox{\hyperlink{namespaceProblem__Parameter_a7fcb9a415485247d626190923235be2a}{00065}} \textcolor{comment}{}  \textcolor{keywordtype}{double} \mbox{\hyperlink{namespaceProblem__Parameter_a7fcb9a415485247d626190923235be2a}{Density\_ratio}} = 1.0;}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00066}00066 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00067}00067 \textcolor{comment}{  /// Initial axis of the elliptical solid in x-\/direction}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00068}\mbox{\hyperlink{namespaceProblem__Parameter_a23071148de0fea3597c2a7eb848320b6}{00068}} \textcolor{comment}{}  \textcolor{keywordtype}{double} \mbox{\hyperlink{namespaceProblem__Parameter_a23071148de0fea3597c2a7eb848320b6}{A}} = 0.25;}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00069}00069   \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00070}00070 \textcolor{comment}{  /// Initial axis of the elliptical solid in y-\/direction}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00071}00071 \textcolor{comment}{  /// (N.B. 2B = 1 is the reference length scale)}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00072}\mbox{\hyperlink{namespaceProblem__Parameter_ac2362a46222574a21338a113e2bee27e}{00072}} \textcolor{comment}{}  \textcolor{keywordtype}{double} \mbox{\hyperlink{namespaceProblem__Parameter_ac2362a46222574a21338a113e2bee27e}{B}} = 0.5;}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00073}00073 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00074}00074 \textcolor{comment}{  /// Pseudo-\/solid (mesh) Poisson ratio}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00075}\mbox{\hyperlink{namespaceProblem__Parameter_abec2e733c8f2d3c18ebc702b3f80cc17}{00075}} \textcolor{comment}{}  \textcolor{keywordtype}{double} \mbox{\hyperlink{namespaceProblem__Parameter_abec2e733c8f2d3c18ebc702b3f80cc17}{Nu}}=0.3;}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00076}00076 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00077}00077 \textcolor{comment}{  /// Pseudo-\/solid (mesh) "{}density"{} }}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00078}00078 \textcolor{comment}{  /// Set to zero because we don't want inertia in the node update!}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00079}\mbox{\hyperlink{namespaceProblem__Parameter_a20ea33c391abd96d43f79913377c1e12}{00079}} \textcolor{comment}{}  \textcolor{keywordtype}{double} \mbox{\hyperlink{namespaceProblem__Parameter_a20ea33c391abd96d43f79913377c1e12}{Lambda\_sq}}=0.0;}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00080}00080 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00081}00081 \textcolor{comment}{  /// Constitutive law used to determine the mesh deformation}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00082}\mbox{\hyperlink{namespaceProblem__Parameter_a9852a6077458693983628319d429f11f}{00082}} \textcolor{comment}{}  ConstitutiveLaw *\mbox{\hyperlink{namespaceProblem__Parameter_a9852a6077458693983628319d429f11f}{Constitutive\_law\_pt}}=   }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00083}00083    \textcolor{keyword}{new} GeneralisedHookean(\&\mbox{\hyperlink{namespaceProblem__Parameter_abec2e733c8f2d3c18ebc702b3f80cc17}{Problem\_Parameter::Nu}});}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00084}00084 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00085}00085  \} \textcolor{comment}{// end\_of\_namespace}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00086}00086 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00087}00087 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00088}00088 \textcolor{comment}{//=======================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00089}00089 \textcolor{comment}{/// Exact solution for the rotation of an ellipse in unbounded shear flow}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00090}00090 \textcolor{comment}{/// as computed by Jeffery (1922)}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00091}00091 \textcolor{comment}{}\textcolor{comment}{//=======================================================================}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00092}\mbox{\hyperlink{namespaceJeffery__Solution}{00092}} \textcolor{keyword}{namespace }\mbox{\hyperlink{namespaceJeffery__Solution}{Jeffery\_Solution}}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00093}00093 \{\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00094}00094 \textcolor{comment}{ /// Null function}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00095}\mbox{\hyperlink{namespaceJeffery__Solution_a6a47b12e9a89f545c7467fae2e6a4350}{00095}} \textcolor{comment}{} \textcolor{keywordtype}{double} \textcolor{keyword}{null}(\textcolor{keyword}{const} \textcolor{keywordtype}{double} \&t) \{\textcolor{keywordflow}{return} 0.0;\}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00096}00096 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00097}00097 \textcolor{comment}{ /// Angular position as a function of time t}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00098}\mbox{\hyperlink{namespaceJeffery__Solution_ad3bd18834ecba370674e34242f8125c1}{00098}} \textcolor{comment}{} \textcolor{keywordtype}{double} \mbox{\hyperlink{namespaceJeffery__Solution_ad3bd18834ecba370674e34242f8125c1}{angle}}(\textcolor{keyword}{const} \textcolor{keywordtype}{double} \&t)}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00099}00099  \{}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00100}00100   \textcolor{keyword}{const} \textcolor{keywordtype}{double} a = \mbox{\hyperlink{namespaceProblem__Parameter_a23071148de0fea3597c2a7eb848320b6}{Problem\_Parameter::A}};}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00101}00101   \textcolor{keyword}{const} \textcolor{keywordtype}{double} b = \mbox{\hyperlink{namespaceProblem__Parameter_ac2362a46222574a21338a113e2bee27e}{Problem\_Parameter::B}};}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00102}00102   }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00103}00103   \textcolor{keywordflow}{return} atan((b/a)*tan((a*b*t)/(b*b + a*a)));}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00104}00104  \}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00105}00105 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00106}00106 \textcolor{comment}{ /// Angular velocity as function of time t}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00107}\mbox{\hyperlink{namespaceJeffery__Solution_acf35d547e7d28609a17c66c9a191090b}{00107}} \textcolor{comment}{} \textcolor{keywordtype}{double} \mbox{\hyperlink{namespaceJeffery__Solution_acf35d547e7d28609a17c66c9a191090b}{velocity}}(\textcolor{keyword}{const} \textcolor{keywordtype}{double} \&t)}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00108}00108  \{}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00109}00109   \textcolor{keyword}{const} \textcolor{keywordtype}{double} a = \mbox{\hyperlink{namespaceProblem__Parameter_a23071148de0fea3597c2a7eb848320b6}{Problem\_Parameter::A}};}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00110}00110   \textcolor{keyword}{const} \textcolor{keywordtype}{double} b = \mbox{\hyperlink{namespaceProblem__Parameter_ac2362a46222574a21338a113e2bee27e}{Problem\_Parameter::B}};}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00111}00111 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00112}00112   \textcolor{comment}{//Get the angle}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00113}00113   \textcolor{keywordtype}{double} chi = \mbox{\hyperlink{namespaceJeffery__Solution_ad3bd18834ecba370674e34242f8125c1}{angle}}(t);}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00114}00114 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00115}00115   \textcolor{comment}{//Now return the velocity}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00116}00116   \textcolor{keywordflow}{return} (a*a*sin(chi)*sin(chi) + b*b*cos(chi)*cos(chi))/(a*a + b*b);}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00117}00117  \}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00118}00118 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00119}00119 \textcolor{comment}{ /// Angular acceleration as a function of time t (should always be zero)}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00120}\mbox{\hyperlink{namespaceJeffery__Solution_afe09bdca1fe833f94f510e206d5df08c}{00120}} \textcolor{comment}{} \textcolor{keywordtype}{double} \mbox{\hyperlink{namespaceJeffery__Solution_afe09bdca1fe833f94f510e206d5df08c}{acceleration}}(\textcolor{keyword}{const} \textcolor{keywordtype}{double} \&t)}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00121}00121  \{}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00122}00122   \textcolor{keyword}{const} \textcolor{keywordtype}{double} a = \mbox{\hyperlink{namespaceProblem__Parameter_a23071148de0fea3597c2a7eb848320b6}{Problem\_Parameter::A}};}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00123}00123   \textcolor{keyword}{const} \textcolor{keywordtype}{double} b = \mbox{\hyperlink{namespaceProblem__Parameter_a23071148de0fea3597c2a7eb848320b6}{Problem\_Parameter::A}};}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00124}00124 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00125}00125   \textcolor{comment}{//Get the angle and velocity}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00126}00126   \textcolor{keywordtype}{double} chi = \mbox{\hyperlink{namespaceJeffery__Solution_ad3bd18834ecba370674e34242f8125c1}{angle}}(t);}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00127}00127   \textcolor{keywordtype}{double} chi\_dot = \mbox{\hyperlink{namespaceJeffery__Solution_acf35d547e7d28609a17c66c9a191090b}{velocity}}(t);}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00128}00128 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00129}00129   \textcolor{comment}{//Now return the acceleration}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00130}00130   \textcolor{keywordflow}{return} 2.0*(a*a -\/ b*b)*(sin(chi)*cos(chi))*chi\_dot/(a*a + b*b);}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00131}00131  \}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00132}00132 \}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00133}00133 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00134}00134 \textcolor{comment}{/// ////////////////////////////////////////////////////////}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00135}00135 \textcolor{comment}{/// ////////////////////////////////////////////////////////}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00136}00136 \textcolor{comment}{/// ////////////////////////////////////////////////////////}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00137}00137 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00138}00138 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00139}00139 \textcolor{comment}{//===================start\_of\_general\_ellipse=================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00140}00140 \textcolor{comment}{/// A geometric object for an ellipse with initial centre of mass at}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00141}00141 \textcolor{comment}{/// (centre\_x, centre\_y) with axis in the x direction given by 2a}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00142}00142 \textcolor{comment}{/// and in the y-\/direction given by 2b. The boundary of the ellipse is}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00143}00143 \textcolor{comment}{/// parametrised by its angle.}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00144}00144 \textcolor{comment}{}\textcolor{comment}{//============================================================================}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00145}\mbox{\hyperlink{classGeneralEllipse}{00145}} \textcolor{keyword}{class }\mbox{\hyperlink{classGeneralEllipse}{GeneralEllipse}} : \textcolor{keyword}{public} GeomObject}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00146}00146 \{}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00147}00147 \textcolor{keyword}{private}:}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00148}00148  }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00149}00149  \textcolor{comment}{//Storage for the centre of mass and semi-\/major and semi-\/minor axes}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00150}\mbox{\hyperlink{classGeneralEllipse_ae583e1437da6ad4eb228dda60b61808a}{00150}}  \textcolor{keywordtype}{double} \mbox{\hyperlink{classGeneralEllipse_aeb974769f58d136a12ac1532506304cc}{Centre\_x}}, \mbox{\hyperlink{classGeneralEllipse_abf2def5a5140bb35e381b800c4b91dc9}{Centre\_y}}, \mbox{\hyperlink{classGeneralEllipse_ae583e1437da6ad4eb228dda60b61808a}{A}}, \mbox{\hyperlink{classGeneralEllipse_a185ae9786d5c6c82eef61e163e9310c6}{B}};}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00151}00151 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00152}00152 \textcolor{keyword}{public}:}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00153}00153  \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00154}00154 \textcolor{comment}{ /// Simple Constructor that transfers appropriate geometric }}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00155}00155 \textcolor{comment}{ /// parameters into internal data}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00156}\mbox{\hyperlink{classGeneralEllipse_a50dc036d709bcd1d53eafb62b5548f67}{00156}} \textcolor{comment}{} \mbox{\hyperlink{classGeneralEllipse_a50dc036d709bcd1d53eafb62b5548f67}{GeneralEllipse}}(\textcolor{keyword}{const} \textcolor{keywordtype}{double} \&centre\_x, \textcolor{keyword}{const} \textcolor{keywordtype}{double} \&centre\_y,}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00157}00157                 \textcolor{keyword}{const} \textcolor{keywordtype}{double} \&a, \textcolor{keyword}{const} \textcolor{keywordtype}{double} \&b)}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00158}00158   : GeomObject(1,2), \mbox{\hyperlink{classGeneralEllipse_aeb974769f58d136a12ac1532506304cc}{Centre\_x}}(centre\_x), \mbox{\hyperlink{classGeneralEllipse_abf2def5a5140bb35e381b800c4b91dc9}{Centre\_y}}(centre\_y), \mbox{\hyperlink{classGeneralEllipse_ae583e1437da6ad4eb228dda60b61808a}{A}}(a), \mbox{\hyperlink{classGeneralEllipse_a185ae9786d5c6c82eef61e163e9310c6}{B}}(b)}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00159}00159   \{\}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00160}00160 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00161}00161 \textcolor{comment}{ /// Empty Destructor}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00162}\mbox{\hyperlink{classGeneralEllipse_a3ac5c17cf8c4998f1b74913860cb3bb9}{00162}} \textcolor{comment}{} \mbox{\hyperlink{classGeneralEllipse_a3ac5c17cf8c4998f1b74913860cb3bb9}{\string~GeneralEllipse}}() \{\}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00163}00163 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00164}00164 \textcolor{comment}{ /// Return the position of the ellipse boundary as a function of }}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00165}00165 \textcolor{comment}{ /// the angle xi[0]}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00166}\mbox{\hyperlink{classGeneralEllipse_a85e975c70441a9c9c711b5e27d124bff}{00166}} \textcolor{comment}{} \textcolor{keywordtype}{void} \mbox{\hyperlink{classGeneralEllipse_a85e975c70441a9c9c711b5e27d124bff}{position}}(\textcolor{keyword}{const} Vector<double> \&xi, Vector<double> \&r)\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00167}00167 \textcolor{keyword}{  }\{}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00168}00168    r[0] = \mbox{\hyperlink{classGeneralEllipse_aeb974769f58d136a12ac1532506304cc}{Centre\_x}} + \mbox{\hyperlink{classGeneralEllipse_ae583e1437da6ad4eb228dda60b61808a}{A}}*cos(xi[0]);}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00169}00169    r[1] = \mbox{\hyperlink{classGeneralEllipse_abf2def5a5140bb35e381b800c4b91dc9}{Centre\_y}} + \mbox{\hyperlink{classGeneralEllipse_a185ae9786d5c6c82eef61e163e9310c6}{B}}*sin(xi[0]);}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00170}00170   \}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00171}00171 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00172}00172  \textcolor{comment}{//Return the position which is always fixed}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00173}\mbox{\hyperlink{classGeneralEllipse_a2bdcc69fcb1f1725124d625c032d171a}{00173}}  \textcolor{keywordtype}{void} \mbox{\hyperlink{classGeneralEllipse_a2bdcc69fcb1f1725124d625c032d171a}{position}}(\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \&t,}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00174}00174                \textcolor{keyword}{const} Vector<double> \&xi, Vector<double> \&r)\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00175}00175 \textcolor{keyword}{  }\{}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00176}00176    \textcolor{keywordflow}{return} \mbox{\hyperlink{classGeneralEllipse_a85e975c70441a9c9c711b5e27d124bff}{position}}(xi,r);}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00177}00177   \}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00178}00178 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00179}00179 \};}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00180}00180 \textcolor{comment}{//end\_of\_general\_ellipse}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00181}00181 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00182}00182 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00183}00183 \textcolor{comment}{/// ////////////////////////////////////////////////////////}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00184}00184 \textcolor{comment}{/// ////////////////////////////////////////////////////////}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00185}00185 \textcolor{comment}{/// ////////////////////////////////////////////////////////}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00186}00186 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00187}00187 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00188}00188 \textcolor{comment}{//==start\_of\_problem\_class============================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00189}00189 \textcolor{comment}{/// Unstructured Navier-\/Stokes ALE Problem for a rigid ellipse }}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00190}00190 \textcolor{comment}{/// immersed within a viscous fluid}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00191}00191 \textcolor{comment}{}\textcolor{comment}{//====================================================================}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00192}00192 \textcolor{keyword}{template}<\textcolor{keyword}{class} ELEMENT>}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00193}\mbox{\hyperlink{classUnstructuredImmersedEllipseProblem}{00193}} \textcolor{keyword}{class }\mbox{\hyperlink{classUnstructuredImmersedEllipseProblem}{UnstructuredImmersedEllipseProblem}} : \textcolor{keyword}{public} Problem}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00194}00194 \{}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00195}00195 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00196}00196 \textcolor{keyword}{public}:}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00197}00197 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00198}00198 \textcolor{comment}{ /// Constructor}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00199}00199 \textcolor{comment}{} \mbox{\hyperlink{classUnstructuredImmersedEllipseProblem_a544a35f261200bb4a4e29a88faa1a69c}{UnstructuredImmersedEllipseProblem}}();}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00200}00200  \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00201}00201 \textcolor{comment}{ /// Destructor}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00202}00202 \textcolor{comment}{} \mbox{\hyperlink{classUnstructuredImmersedEllipseProblem_a84cdf81be59fc646eb4d5b3bc0ff4280}{\string~UnstructuredImmersedEllipseProblem}}();}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00203}00203 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00204}00204 \textcolor{comment}{ /// Reset the boundary conditions when timestepping}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00205}\mbox{\hyperlink{classUnstructuredImmersedEllipseProblem_a368c412c4c9a9e9403b4e67d3582e3a5}{00205}} \textcolor{comment}{} \textcolor{keywordtype}{void} \mbox{\hyperlink{classUnstructuredImmersedEllipseProblem_a368c412c4c9a9e9403b4e67d3582e3a5}{actions\_before\_implicit\_timestep}}()}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00206}00206   \{}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00207}00207    this-\/>\mbox{\hyperlink{classUnstructuredImmersedEllipseProblem_ab201b187b240105fd8d444d943f6dada}{set\_boundary\_velocity}}();}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00208}00208   \}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00209}00209  \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00210}00210 \textcolor{comment}{ /// Wipe the meshes of Lagrange multiplier and drag elements}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00211}00211 \textcolor{comment}{} \textcolor{keywordtype}{void} \mbox{\hyperlink{classUnstructuredImmersedEllipseProblem_aa560217a33a9a9bc150fbdf15dbf1877}{actions\_before\_adapt}}();}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00212}00212  \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00213}00213 \textcolor{comment}{ /// Rebuild the meshes of Lagrange multiplier and drag elements}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00214}00214 \textcolor{comment}{} \textcolor{keywordtype}{void} \mbox{\hyperlink{classUnstructuredImmersedEllipseProblem_ab1558b409285aea617f4abf7d3a64b3d}{actions\_after\_adapt}}();}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00215}00215  \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00216}00216 \textcolor{comment}{ /// Re-\/apply the no slip condition (imposed indirectly via dependent}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00217}00217 \textcolor{comment}{ /// velocities)}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00218}\mbox{\hyperlink{classUnstructuredImmersedEllipseProblem_afa51876a2af9dd7640ff1f5a434804bf}{00218}} \textcolor{comment}{} \textcolor{keywordtype}{void} \mbox{\hyperlink{classUnstructuredImmersedEllipseProblem_afa51876a2af9dd7640ff1f5a434804bf}{actions\_before\_newton\_convergence\_check}}()}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00219}00219   \{}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00220}00220    \textcolor{comment}{// Update mesh -\/-\/ this applies the auxiliary node update function}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00221}00221    \mbox{\hyperlink{classUnstructuredImmersedEllipseProblem_a0ba79ccde26b781b66d9839460f08bd3}{Fluid\_mesh\_pt}}-\/>node\_update();}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00222}00222   \}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00223}00223  \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00224}00224 \textcolor{comment}{ /// Set boundary condition, assign auxiliary node update fct.}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00225}00225 \textcolor{comment}{ /// Complete the build of all elements, attach power elements that allow}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00226}00226 \textcolor{comment}{ /// computation of drag vector}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00227}00227 \textcolor{comment}{} \textcolor{keywordtype}{void} \mbox{\hyperlink{classUnstructuredImmersedEllipseProblem_a42b13e3306ff2a94053907644ba17c8d}{complete\_problem\_setup}}();}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00228}00228 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00229}00229 \textcolor{comment}{ /// Set the boundary velocity}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00230}00230 \textcolor{comment}{} \textcolor{keywordtype}{void} \mbox{\hyperlink{classUnstructuredImmersedEllipseProblem_ab201b187b240105fd8d444d943f6dada}{set\_boundary\_velocity}}();}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00231}00231 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00232}00232 \textcolor{comment}{ /// Function that solves a simplified problem to ensure that }}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00233}00233 \textcolor{comment}{ /// the positions of the boundary nodes are initially consistent with}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00234}00234 \textcolor{comment}{ /// the lagrange multiplier formulation}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00235}00235 \textcolor{comment}{} \textcolor{keywordtype}{void} \mbox{\hyperlink{classUnstructuredImmersedEllipseProblem_a2a88b40ff1988de0fc696f1eb755ea54}{solve\_for\_consistent\_nodal\_positions}}();}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00236}00236 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00237}00237 \textcolor{comment}{ /// Doc the solution}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00238}00238 \textcolor{comment}{} \textcolor{keywordtype}{void} \mbox{\hyperlink{classUnstructuredImmersedEllipseProblem_a08e12dd83c98f96e14e8152cc758d398}{doc\_solution}}(\textcolor{keyword}{const} \textcolor{keywordtype}{bool}\& project=\textcolor{keyword}{false});}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00239}00239   \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00240}00240 \textcolor{comment}{ /// Output the exact solution}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00241}00241 \textcolor{comment}{} \textcolor{keywordtype}{void} \mbox{\hyperlink{classUnstructuredImmersedEllipseProblem_a29a232dfac18ea901332bebdc14fad15}{output\_exact\_solution}}(std::ofstream \&output\_file);}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00242}00242 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00243}00243 \textcolor{keyword}{private}:}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00244}00244  \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00245}00245 \textcolor{comment}{ /// Create elements that enforce prescribed boundary motion}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00246}00246 \textcolor{comment}{ /// for the pseudo-\/solid fluid mesh by Lagrange multipliers}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00247}00247 \textcolor{comment}{} \textcolor{keywordtype}{void} \mbox{\hyperlink{classUnstructuredImmersedEllipseProblem_a3b4a4e279a11b37d79d040b348008765}{create\_lagrange\_multiplier\_elements}}();}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00248}00248 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00249}00249 \textcolor{comment}{ /// Delete elements that impose the prescribed boundary displacement}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00250}00250 \textcolor{comment}{ /// and wipe the associated mesh}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00251}00251 \textcolor{comment}{} \textcolor{keywordtype}{void} \mbox{\hyperlink{classUnstructuredImmersedEllipseProblem_a51555f77dc360c94591ee68c3fc9928a}{delete\_lagrange\_multiplier\_elements}}();}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00252}00252 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00253}00253 \textcolor{comment}{ /// Create elements that calculate the drag and torque on}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00254}00254 \textcolor{comment}{ /// the boundaries}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00255}00255 \textcolor{comment}{} \textcolor{keywordtype}{void} \mbox{\hyperlink{classUnstructuredImmersedEllipseProblem_a16a7c6022867f709ebdd59b8fee2004a}{create\_drag\_elements}}();}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00256}00256  \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00257}00257 \textcolor{comment}{ /// Delete elements that calculate the drag and torque on the }}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00258}00258 \textcolor{comment}{ /// boundaries}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00259}00259 \textcolor{comment}{} \textcolor{keywordtype}{void} \mbox{\hyperlink{classUnstructuredImmersedEllipseProblem_a7d7b84968988d37091b29957b0af5bfa}{delete\_drag\_elements}}();}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00260}00260 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00261}00261 \textcolor{comment}{ /// Pin the degrees of freedom associated with the solid bodies}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00262}00262 \textcolor{comment}{} \textcolor{keywordtype}{void} \mbox{\hyperlink{classUnstructuredImmersedEllipseProblem_a07dc16909c0223fe4b656fd270f27c11}{pin\_rigid\_body}}();}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00263}00263 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00264}00264 \textcolor{comment}{ /// Unpin the degrees of freedom associated with the solid bodies}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00265}00265 \textcolor{comment}{} \textcolor{keywordtype}{void} \mbox{\hyperlink{classUnstructuredImmersedEllipseProblem_a4f8c7e7e4d626084f6515a152b165567}{unpin\_rigid\_body}}();}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00266}00266  \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00267}00267 \textcolor{comment}{ /// Pointers to mesh of Lagrange multiplier elements}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00268}\mbox{\hyperlink{classUnstructuredImmersedEllipseProblem_ad644e67ccd6ab0811c5fe2b7b944fbca}{00268}} \textcolor{comment}{} SolidMesh* \mbox{\hyperlink{classUnstructuredImmersedEllipseProblem_ad644e67ccd6ab0811c5fe2b7b944fbca}{Lagrange\_multiplier\_mesh\_pt}};}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00269}00269 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00270}00270 \textcolor{comment}{ /// Pointer to Fluid\_mesh}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00271}\mbox{\hyperlink{classUnstructuredImmersedEllipseProblem_a0ba79ccde26b781b66d9839460f08bd3}{00271}} \textcolor{comment}{} RefineableSolidTriangleMesh<ELEMENT>* \mbox{\hyperlink{classUnstructuredImmersedEllipseProblem_a0ba79ccde26b781b66d9839460f08bd3}{Fluid\_mesh\_pt}};}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00272}00272  \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00273}00273 \textcolor{comment}{ /// Triangle mesh polygon for outer boundary }}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00274}\mbox{\hyperlink{classUnstructuredImmersedEllipseProblem_ae0b35188432c371804887b6de86b48c7}{00274}} \textcolor{comment}{} TriangleMeshPolygon* \mbox{\hyperlink{classUnstructuredImmersedEllipseProblem_ae0b35188432c371804887b6de86b48c7}{Outer\_boundary\_polygon\_pt}};}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00275}00275 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00276}00276 \textcolor{comment}{ /// Mesh of drag elements}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00277}\mbox{\hyperlink{classUnstructuredImmersedEllipseProblem_a9b4d04277b1f42c9428b610968f6f10d}{00277}} \textcolor{comment}{} Vector<Mesh*> \mbox{\hyperlink{classUnstructuredImmersedEllipseProblem_a9b4d04277b1f42c9428b610968f6f10d}{Drag\_mesh\_pt}};}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00278}00278 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00279}00279 \textcolor{comment}{ /// Mesh of the generalised elements for the rigid bodies}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00280}\mbox{\hyperlink{classUnstructuredImmersedEllipseProblem_a34f1376227d4b995678eedd77813388b}{00280}} \textcolor{comment}{} Mesh* \mbox{\hyperlink{classUnstructuredImmersedEllipseProblem_a34f1376227d4b995678eedd77813388b}{Rigid\_body\_mesh\_pt}};}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00281}00281 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00282}00282 \textcolor{comment}{ /// Storage for the geom object}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00283}\mbox{\hyperlink{classUnstructuredImmersedEllipseProblem_aaa6d1c19f3634a6f08f3dd7e5046217e}{00283}} \textcolor{comment}{} Vector<GeomObject*> \mbox{\hyperlink{classUnstructuredImmersedEllipseProblem_aaa6d1c19f3634a6f08f3dd7e5046217e}{Rigid\_body\_pt}};}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00284}00284  \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00285}00285 \textcolor{comment}{ /// Internal DocInfo object}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00286}\mbox{\hyperlink{classUnstructuredImmersedEllipseProblem_a1c463ed904f01e6466baae0533c79780}{00286}} \textcolor{comment}{} DocInfo \mbox{\hyperlink{classUnstructuredImmersedEllipseProblem_a1c463ed904f01e6466baae0533c79780}{Doc\_info}};}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00287}00287  \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00288}00288 \textcolor{comment}{ /// File to document the norm of the solution (for validation purposes)}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00289}\mbox{\hyperlink{classUnstructuredImmersedEllipseProblem_a71a3b24b610e05f7be916c4214dab8dc}{00289}} \textcolor{comment}{} ofstream \mbox{\hyperlink{classUnstructuredImmersedEllipseProblem_a71a3b24b610e05f7be916c4214dab8dc}{Norm\_file}};}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00290}00290  \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00291}00291 \textcolor{comment}{ /// File to document the motion of the centre of gravity}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00292}\mbox{\hyperlink{classUnstructuredImmersedEllipseProblem_acd1e8ec8e510f029f449f13dfdebbc99}{00292}} \textcolor{comment}{} ofstream \mbox{\hyperlink{classUnstructuredImmersedEllipseProblem_acd1e8ec8e510f029f449f13dfdebbc99}{Cog\_file}};}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00293}00293  \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00294}00294 \textcolor{comment}{ /// File to document the exact motion of the centre of gravity}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00295}\mbox{\hyperlink{classUnstructuredImmersedEllipseProblem_a3dc1ec2e066466a6f228864b873d95fa}{00295}} \textcolor{comment}{} ofstream \mbox{\hyperlink{classUnstructuredImmersedEllipseProblem_a3dc1ec2e066466a6f228864b873d95fa}{Cog\_exact\_file}};}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00296}00296 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00297}00297 \}; \textcolor{comment}{// end\_of\_problem\_class}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00298}00298 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00299}00299 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00300}00300 \textcolor{comment}{//==start\_constructor=====================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00301}00301 \textcolor{comment}{/// Constructor: Open output files, construct time steppers, build }}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00302}00302 \textcolor{comment}{///  fluid mesh, immersed rigid body and combine to form the problem}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00303}00303 \textcolor{comment}{}\textcolor{comment}{//========================================================================}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00304}00304 \textcolor{keyword}{template}<\textcolor{keyword}{class} ELEMENT>}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00305}\mbox{\hyperlink{classUnstructuredImmersedEllipseProblem_a544a35f261200bb4a4e29a88faa1a69c}{00305}} \mbox{\hyperlink{classUnstructuredImmersedEllipseProblem_a544a35f261200bb4a4e29a88faa1a69c}{UnstructuredImmersedEllipseProblem<ELEMENT>::}}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00306}00306 \mbox{\hyperlink{classUnstructuredImmersedEllipseProblem_a544a35f261200bb4a4e29a88faa1a69c}{UnstructuredImmersedEllipseProblem}}()}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00307}00307 \{ }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00308}00308  \textcolor{comment}{// Output directory}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00309}00309  this-\/>Doc\_info.set\_directory(\textcolor{stringliteral}{"{}RESLT"{}});}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00310}00310 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00311}00311  \textcolor{comment}{// Open norm file}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00312}00312  this-\/>Norm\_file.open(\textcolor{stringliteral}{"{}RESLT/norm.dat"{}});}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00313}00313 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00314}00314  \textcolor{comment}{// Open file to trace the centre of gravity}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00315}00315  this-\/>Cog\_file.open(\textcolor{stringliteral}{"{}RESLT/cog\_trace.dat"{}});}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00316}00316 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00317}00317  \textcolor{comment}{// Open file to document the exact motion of the centre of gravity}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00318}00318  this-\/>Cog\_exact\_file.open(\textcolor{stringliteral}{"{}RESLT/cog\_exact\_trace.dat"{}});}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00319}00319 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00320}00320  \textcolor{comment}{// Allocate the timestepper -\/-\/ this constructs the Problem's }}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00321}00321  \textcolor{comment}{// time object with a sufficient amount of storage to store the}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00322}00322  \textcolor{comment}{// previous timsteps. }}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00323}00323  this-\/>add\_time\_stepper\_pt(\textcolor{keyword}{new} BDF<2>);}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00324}00324 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00325}00325  \textcolor{comment}{// Allocate a timestepper for the rigid body}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00326}00326  this-\/>add\_time\_stepper\_pt(\textcolor{keyword}{new} Newmark<2>);}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00327}00327 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00328}00328  \textcolor{comment}{// Define the boundaries: Polyline with 4 different}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00329}00329  \textcolor{comment}{// boundaries for the outer boundary and 1 internal elliptical hole}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00330}00330  }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00331}00331  \textcolor{comment}{// Build the boundary segments for outer boundary, consisting of}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00332}00332  \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00333}00333  \textcolor{comment}{// four separate polyline segments}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00334}00334  \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00335}00335  Vector<TriangleMeshCurveSection*> boundary\_segment\_pt(4);}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00336}00336 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00337}00337  \textcolor{comment}{//Set the length of the channel}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00338}00338  \textcolor{keywordtype}{double} half\_length = 5.0;}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00339}00339  \textcolor{keywordtype}{double} half\_height = 2.5;}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00340}00340  }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00341}00341  \textcolor{comment}{// Initialize boundary segment}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00342}00342  Vector<Vector<double> > bound\_seg(2);}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00343}00343  \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned} i=0;i<2;i++) \{bound\_seg[i].resize(2);\}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00344}00344 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00345}00345  \textcolor{comment}{// First boundary segment}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00346}00346  bound\_seg[0][0]=-\/half\_length;}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00347}00347  bound\_seg[0][1]=-\/half\_height;}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00348}00348  bound\_seg[1][0]=-\/half\_length;}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00349}00349  bound\_seg[1][1]=half\_height;}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00350}00350  }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00351}00351  \textcolor{comment}{// Specify 1st boundary id}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00352}00352  \textcolor{keywordtype}{unsigned} bound\_id = 0;}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00353}00353 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00354}00354  \textcolor{comment}{// Build the 1st boundary segment}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00355}00355  boundary\_segment\_pt[0] = \textcolor{keyword}{new} TriangleMeshPolyLine(bound\_seg,bound\_id);}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00356}00356  }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00357}00357  \textcolor{comment}{// Second boundary segment}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00358}00358  bound\_seg[0][0]=-\/half\_length;}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00359}00359  bound\_seg[0][1]=half\_height;}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00360}00360  bound\_seg[1][0]=half\_length;}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00361}00361  bound\_seg[1][1]=half\_height;}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00362}00362 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00363}00363  \textcolor{comment}{// Specify 2nd boundary id}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00364}00364  bound\_id = 1;}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00365}00365 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00366}00366  \textcolor{comment}{// Build the 2nd boundary segment}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00367}00367  boundary\_segment\_pt[1] = \textcolor{keyword}{new} TriangleMeshPolyLine(bound\_seg,bound\_id);}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00368}00368 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00369}00369  \textcolor{comment}{// Third boundary segment}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00370}00370  bound\_seg[0][0]=half\_length;}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00371}00371  bound\_seg[0][1]=half\_height;}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00372}00372  bound\_seg[1][0]=half\_length;}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00373}00373  bound\_seg[1][1]=-\/half\_height;}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00374}00374 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00375}00375  \textcolor{comment}{// Specify 3rd boundary id}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00376}00376  bound\_id = 2;}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00377}00377 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00378}00378  \textcolor{comment}{// Build the 3rd boundary segment}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00379}00379  boundary\_segment\_pt[2] = \textcolor{keyword}{new} TriangleMeshPolyLine(bound\_seg,bound\_id);}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00380}00380 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00381}00381  \textcolor{comment}{// Fourth boundary segment}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00382}00382  bound\_seg[0][0]=half\_length;}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00383}00383  bound\_seg[0][1]=-\/half\_height;}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00384}00384  bound\_seg[1][0]=-\/half\_length;}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00385}00385  bound\_seg[1][1]=-\/half\_height;}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00386}00386 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00387}00387  \textcolor{comment}{// Specify 4th boundary id}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00388}00388  bound\_id = 3;}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00389}00389 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00390}00390  \textcolor{comment}{// Build the 4th boundary segment}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00391}00391  boundary\_segment\_pt[3] = \textcolor{keyword}{new} TriangleMeshPolyLine(bound\_seg,bound\_id);}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00392}00392   }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00393}00393  \textcolor{comment}{// Create the triangle mesh polygon for outer boundary using boundary segment}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00394}00394  Outer\_boundary\_polygon\_pt = \textcolor{keyword}{new} TriangleMeshPolygon(boundary\_segment\_pt);}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00395}00395 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00396}00396  \textcolor{comment}{// Now build the moving rigid body}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00397}00397  \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00398}00398 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00399}00399  \textcolor{comment}{// We have one rigid body}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00400}00400  Rigid\_body\_pt.resize(1);}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00401}00401  Vector<TriangleMeshClosedCurve*> hole\_pt(1);}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00402}00402 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00403}00403  \textcolor{comment}{// Build Rigid Body}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00404}00404  \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00405}00405  \textcolor{keywordtype}{double} x\_center = 0.0;}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00406}00406  \textcolor{keywordtype}{double} y\_center = 0.0;}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00407}00407  \textcolor{keywordtype}{double} \mbox{\hyperlink{namespaceProblem__Parameter_a23071148de0fea3597c2a7eb848320b6}{A}} = \mbox{\hyperlink{namespaceProblem__Parameter_a23071148de0fea3597c2a7eb848320b6}{Problem\_Parameter::A}};}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00408}00408  \textcolor{keywordtype}{double} \mbox{\hyperlink{namespaceProblem__Parameter_ac2362a46222574a21338a113e2bee27e}{B}} = \mbox{\hyperlink{namespaceProblem__Parameter_ac2362a46222574a21338a113e2bee27e}{Problem\_Parameter::B}};}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00409}00409  GeomObject* temp\_hole\_pt = \textcolor{keyword}{new} \mbox{\hyperlink{classGeneralEllipse}{GeneralEllipse}}(x\_center,y\_center,\mbox{\hyperlink{namespaceProblem__Parameter_a23071148de0fea3597c2a7eb848320b6}{A}},\mbox{\hyperlink{namespaceProblem__Parameter_ac2362a46222574a21338a113e2bee27e}{B}});}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00410}00410  Rigid\_body\_pt[0] = \textcolor{keyword}{new} ImmersedRigidBodyElement(temp\_hole\_pt,}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00411}00411                                                  this-\/>time\_stepper\_pt(1));}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00412}00412 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00413}00413  \textcolor{comment}{// Build the two parts of the curvilinear boundary from the rigid body}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00414}00414  Vector<TriangleMeshCurveSection*> curvilinear\_boundary\_pt(2);}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00415}00415 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00416}00416  \textcolor{comment}{//First section (boundary 4)}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00417}00417  \textcolor{keywordtype}{double} zeta\_start=0.0;}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00418}00418  \textcolor{keywordtype}{double} zeta\_end=MathematicalConstants::Pi;}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00419}00419  \textcolor{keywordtype}{unsigned} nsegment=8; }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00420}00420  \textcolor{keywordtype}{unsigned} boundary\_id=4; }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00421}00421  curvilinear\_boundary\_pt[0]=\textcolor{keyword}{new} TriangleMeshCurviLine(}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00422}00422   Rigid\_body\_pt[0],zeta\_start,zeta\_end,nsegment,boundary\_id);}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00423}00423 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00424}00424  \textcolor{comment}{//Second section (boundary 5)}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00425}00425  zeta\_start=MathematicalConstants::Pi;}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00426}00426  zeta\_end=2.0*MathematicalConstants::Pi;}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00427}00427  nsegment=8; }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00428}00428  boundary\_id=5; }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00429}00429  curvilinear\_boundary\_pt[1]=\textcolor{keyword}{new} TriangleMeshCurviLine(}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00430}00430   Rigid\_body\_pt[0],zeta\_start,zeta\_end, }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00431}00431   nsegment,boundary\_id);}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00432}00432   }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00433}00433  \textcolor{comment}{// Combine to form a hole in the fluid mesh}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00434}00434  Vector<double> hole\_coords(2);}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00435}00435  hole\_coords[0]=0.0;}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00436}00436  hole\_coords[1]=0.0;}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00437}00437  Vector<TriangleMeshClosedCurve*> curvilinear\_hole\_pt(1);}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00438}00438  hole\_pt[0]=}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00439}00439   \textcolor{keyword}{new} TriangleMeshClosedCurve(}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00440}00440    curvilinear\_boundary\_pt,hole\_coords);}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00441}00441  }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00442}00442  \textcolor{comment}{// Now build the mesh, based on the boundaries specified by}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00443}00443  \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00444}00444  \textcolor{comment}{// polygons just created}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00445}00445  \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00446}00446 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00447}00447  TriangleMeshClosedCurve* closed\_curve\_pt=Outer\_boundary\_polygon\_pt;}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00448}00448 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00449}00449  \textcolor{keywordtype}{double} uniform\_element\_area=1.0;}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00450}00450 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00451}00451  \textcolor{comment}{// Use the TriangleMeshParameters object for gathering all}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00452}00452  \textcolor{comment}{// the necessary arguments for the TriangleMesh object}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00453}00453  TriangleMeshParameters triangle\_mesh\_parameters(}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00454}00454    closed\_curve\_pt);}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00455}00455 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00456}00456  \textcolor{comment}{// Define the holes on the domain}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00457}00457  triangle\_mesh\_parameters.internal\_closed\_curve\_pt() =}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00458}00458    hole\_pt;}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00459}00459 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00460}00460  \textcolor{comment}{// Define the maximum element area}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00461}00461  triangle\_mesh\_parameters.element\_area() =}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00462}00462    uniform\_element\_area;}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00463}00463 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00464}00464  \textcolor{comment}{// Create the mesh}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00465}00465  Fluid\_mesh\_pt =}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00466}00466    \textcolor{keyword}{new} RefineableSolidTriangleMesh<ELEMENT>(}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00467}00467      triangle\_mesh\_parameters, this-\/>time\_stepper\_pt());}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00468}00468 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00469}00469  \textcolor{comment}{// Set error estimator for bulk mesh}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00470}00470  Z2ErrorEstimator* error\_estimator\_pt=\textcolor{keyword}{new} Z2ErrorEstimator;}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00471}00471  Fluid\_mesh\_pt-\/>spatial\_error\_estimator\_pt()=error\_estimator\_pt;}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00472}00472 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00473}00473  \textcolor{comment}{// Set targets for spatial adaptivity}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00474}00474  Fluid\_mesh\_pt-\/>max\_permitted\_error()=0.005;}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00475}00475  Fluid\_mesh\_pt-\/>min\_permitted\_error()=0.001; }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00476}00476  Fluid\_mesh\_pt-\/>max\_element\_size()=1.0;}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00477}00477  Fluid\_mesh\_pt-\/>min\_element\_size()=0.001; }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00478}00478 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00479}00479  \textcolor{comment}{// Use coarser mesh during validation}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00480}00480  \textcolor{keywordflow}{if} (CommandLineArgs::command\_line\_flag\_has\_been\_set(\textcolor{stringliteral}{"{}-\/-\/validation"{}}))}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00481}00481   \{}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00482}00482    Fluid\_mesh\_pt-\/>min\_element\_size()=0.01; }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00483}00483   \}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00484}00484 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00485}00485  \textcolor{comment}{// Set boundary condition, assign auxiliary node update fct,}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00486}00486  \textcolor{comment}{// complete the build of all elements, attach power elements that allow}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00487}00487  \textcolor{comment}{// computation of drag vector}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00488}00488  complete\_problem\_setup();}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00489}00489   }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00490}00490  \textcolor{comment}{//Set the parameters of the rigid body elements}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00491}00491  ImmersedRigidBodyElement* rigid\_element1\_pt = }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00492}00492   \textcolor{keyword}{dynamic\_cast<}ImmersedRigidBodyElement*\textcolor{keyword}{>}(Rigid\_body\_pt[0]);}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00493}00493  rigid\_element1\_pt-\/>initial\_centre\_of\_mass(0) = x\_center;}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00494}00494  rigid\_element1\_pt-\/>initial\_centre\_of\_mass(1) = y\_center; }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00495}00495  rigid\_element1\_pt-\/>mass\_shape() = MathematicalConstants::Pi*\mbox{\hyperlink{namespaceProblem__Parameter_a23071148de0fea3597c2a7eb848320b6}{A}}*\mbox{\hyperlink{namespaceProblem__Parameter_ac2362a46222574a21338a113e2bee27e}{B}};}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00496}00496  rigid\_element1\_pt-\/>moment\_of\_inertia\_shape() = }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00497}00497  0.25*MathematicalConstants::Pi*\mbox{\hyperlink{namespaceProblem__Parameter_a23071148de0fea3597c2a7eb848320b6}{A}}*\mbox{\hyperlink{namespaceProblem__Parameter_ac2362a46222574a21338a113e2bee27e}{B}}*(\mbox{\hyperlink{namespaceProblem__Parameter_a23071148de0fea3597c2a7eb848320b6}{A}}*\mbox{\hyperlink{namespaceProblem__Parameter_a23071148de0fea3597c2a7eb848320b6}{A}} + \mbox{\hyperlink{namespaceProblem__Parameter_ac2362a46222574a21338a113e2bee27e}{B}}*\mbox{\hyperlink{namespaceProblem__Parameter_ac2362a46222574a21338a113e2bee27e}{B}});}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00498}00498  rigid\_element1\_pt-\/>re\_pt() = \&\mbox{\hyperlink{namespaceProblem__Parameter_acc656299287d4d9a8374c2c501750b4f}{Problem\_Parameter::Re}};}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00499}00499  rigid\_element1\_pt-\/>st\_pt() = \&\mbox{\hyperlink{namespaceProblem__Parameter_a8d9b76e390569bac0095bd0952281a30}{Problem\_Parameter::St}};}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00500}00500  rigid\_element1\_pt-\/>density\_ratio\_pt() = \&\mbox{\hyperlink{namespaceProblem__Parameter_a7fcb9a415485247d626190923235be2a}{Problem\_Parameter::Density\_ratio}};}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00501}00501 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00502}00502  \textcolor{comment}{//Pin the position of the centre of mass}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00503}00503  rigid\_element1\_pt-\/>pin\_centre\_of\_mass\_coordinate(0);}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00504}00504  rigid\_element1\_pt-\/>pin\_centre\_of\_mass\_coordinate(1);}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00505}00505 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00506}00506   \textcolor{comment}{// Create the mesh for the rigid bodies}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00507}00507  Rigid\_body\_mesh\_pt = \textcolor{keyword}{new} Mesh;}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00508}00508  Rigid\_body\_mesh\_pt-\/>add\_element\_pt(rigid\_element1\_pt);}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00509}00509 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00510}00510  \textcolor{comment}{// Create the drag mesh for the rigid bodies}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00511}00511  Drag\_mesh\_pt.resize(1);}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00512}00512  \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned} m=0;m<1;m++) \{Drag\_mesh\_pt[m] = \textcolor{keyword}{new} Mesh;\}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00513}00513  this-\/>create\_drag\_elements();}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00514}00514 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00515}00515  \textcolor{comment}{//Add the drag mesh to the appropriate rigid bodies}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00516}00516  rigid\_element1\_pt-\/>set\_drag\_mesh(Drag\_mesh\_pt[0]);}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00517}00517 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00518}00518 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00519}00519 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00520}00520  \textcolor{comment}{// Create Lagrange multiplier mesh for boundary motion}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00521}00521  \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00522}00522  \textcolor{comment}{// Construct the mesh of elements that enforce prescribed boundary motion}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00523}00523  \textcolor{comment}{// of pseudo-\/solid fluid mesh by Lagrange multipliers}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00524}00524  Lagrange\_multiplier\_mesh\_pt=\textcolor{keyword}{new} SolidMesh;}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00525}00525  create\_lagrange\_multiplier\_elements();}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00526}00526 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00527}00527 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00528}00528  \textcolor{comment}{// Combine meshes}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00529}00529  \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00530}00530  }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00531}00531  \textcolor{comment}{// Add Fluid\_mesh\_pt sub meshes}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00532}00532  this-\/>add\_sub\_mesh(Fluid\_mesh\_pt);}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00533}00533 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00534}00534  \textcolor{comment}{// Add Lagrange\_multiplier sub meshes}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00535}00535  this-\/>add\_sub\_mesh(this-\/>Lagrange\_multiplier\_mesh\_pt);}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00536}00536 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00537}00537  this-\/>add\_sub\_mesh(this-\/>Rigid\_body\_mesh\_pt);}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00538}00538  }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00539}00539  \textcolor{comment}{// Build global mesh}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00540}00540  this-\/>build\_global\_mesh();}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00541}00541     }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00542}00542  \textcolor{comment}{// Setup equation numbering scheme}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00543}00543  cout <<\textcolor{stringliteral}{"{}Number of equations: "{}} << this-\/>assign\_eqn\_numbers() << std::endl;}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00544}00544  }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00545}00545 \} \textcolor{comment}{// end\_of\_constructor}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00546}00546 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00547}00547 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00548}00548 \textcolor{comment}{//========================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00549}00549 \textcolor{comment}{/// Destructor that cleans up memory and closes files}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00550}00550 \textcolor{comment}{}\textcolor{comment}{//========================================================================}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00551}00551 \textcolor{keyword}{template}<\textcolor{keyword}{class} ELEMENT>}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00552}\mbox{\hyperlink{classUnstructuredImmersedEllipseProblem_a84cdf81be59fc646eb4d5b3bc0ff4280}{00552}} \mbox{\hyperlink{classUnstructuredImmersedEllipseProblem_a84cdf81be59fc646eb4d5b3bc0ff4280}{UnstructuredImmersedEllipseProblem<ELEMENT>::}}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00553}00553 \mbox{\hyperlink{classUnstructuredImmersedEllipseProblem_a84cdf81be59fc646eb4d5b3bc0ff4280}{\string~UnstructuredImmersedEllipseProblem}}()}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00554}00554 \{}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00555}00555  \textcolor{comment}{// Delete Fluid timestepper}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00556}00556  \textcolor{keyword}{delete} this-\/>time\_stepper\_pt(0);}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00557}00557  }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00558}00558  \textcolor{comment}{//Delete solid timestepper}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00559}00559  \textcolor{keyword}{delete} this-\/>time\_stepper\_pt(1);}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00560}00560  }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00561}00561  \textcolor{comment}{// Kill data associated with outer boundary}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00562}00562  \textcolor{keywordtype}{unsigned} n=Outer\_boundary\_polygon\_pt-\/>npolyline();}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00563}00563  \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j=0;j<n;j++)}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00564}00564   \{}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00565}00565    \textcolor{keyword}{delete} Outer\_boundary\_polygon\_pt-\/>polyline\_pt(j);}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00566}00566   \}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00567}00567  \textcolor{keyword}{delete} Outer\_boundary\_polygon\_pt;}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00568}00568  }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00569}00569  \textcolor{comment}{//Flush the drag mesh from the rigid body}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00570}00570  \textcolor{keyword}{dynamic\_cast<}ImmersedRigidBodyElement*\textcolor{keyword}{>}(Rigid\_body\_pt[0])-\/>}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00571}00571   flush\_drag\_mesh();}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00572}00572 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00573}00573  \textcolor{comment}{// Flush Lagrange multiplier mesh}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00574}00574  delete\_lagrange\_multiplier\_elements();}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00575}00575  \textcolor{keyword}{delete} Lagrange\_multiplier\_mesh\_pt;}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00576}00576  }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00577}00577  \textcolor{comment}{// Delete error estimator}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00578}00578  \textcolor{keyword}{delete} Fluid\_mesh\_pt-\/>spatial\_error\_estimator\_pt();}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00579}00579  }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00580}00580  \textcolor{comment}{// Delete fluid mesh}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00581}00581  \textcolor{keyword}{delete} Fluid\_mesh\_pt;}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00582}00582  }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00583}00583  \textcolor{comment}{// Kill const eqn}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00584}00584  \textcolor{keyword}{delete} \mbox{\hyperlink{namespaceProblem__Parameter_a9852a6077458693983628319d429f11f}{Problem\_Parameter::Constitutive\_law\_pt}};}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00585}00585  }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00586}00586  \textcolor{comment}{// Close norm and trace files}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00587}00587  this-\/>Cog\_exact\_file.close();}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00588}00588  this-\/>Cog\_file.close();}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00589}00589  this-\/>Norm\_file.close();}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00590}00590 \}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00591}00591 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00592}00592 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00593}00593 \textcolor{comment}{//==========start\_actions\_before\_adapt==================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00594}00594 \textcolor{comment}{/// Actions before adapt: Wipe the mesh of Lagrange multiplier elements}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00595}00595 \textcolor{comment}{}\textcolor{comment}{//=======================================================================}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00596}00596 \textcolor{keyword}{template}<\textcolor{keyword}{class} ELEMENT>}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00597}\mbox{\hyperlink{classUnstructuredImmersedEllipseProblem_aa560217a33a9a9bc150fbdf15dbf1877}{00597}} \textcolor{keywordtype}{void} \mbox{\hyperlink{classUnstructuredImmersedEllipseProblem_aa560217a33a9a9bc150fbdf15dbf1877}{UnstructuredImmersedEllipseProblem<ELEMENT>::actions\_before\_adapt}}()}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00598}00598 \{}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00599}00599  \textcolor{comment}{//Flush the drag mesh from the rigid body}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00600}00600  \textcolor{keyword}{dynamic\_cast<}ImmersedRigidBodyElement*\textcolor{keyword}{>}(Rigid\_body\_pt[0])-\/>}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00601}00601   flush\_drag\_mesh();}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00602}00602 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00603}00603  \textcolor{comment}{//Kill the drag element}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00604}00604  delete\_drag\_elements();}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00605}00605 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00606}00606  \textcolor{comment}{// Kill the  elements and wipe surface mesh}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00607}00607  delete\_lagrange\_multiplier\_elements();}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00608}00608 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00609}00609  \textcolor{comment}{// Rebuild the Problem's global mesh from its various sub-\/meshes}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00610}00610  this-\/>rebuild\_global\_mesh();}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00611}00611 \} \textcolor{comment}{// end of actions\_before\_adapt}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00612}00612 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00613}00613 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00614}00614 \textcolor{comment}{//============start\_actions\_after\_adapt===================================== }\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00615}00615 \textcolor{comment}{/// Actions after adapt: Rebuild the mesh of Lagrange multiplier elements}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00616}00616 \textcolor{comment}{}\textcolor{comment}{//==========================================================================}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00617}00617 \textcolor{keyword}{template}<\textcolor{keyword}{class} ELEMENT>}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00618}\mbox{\hyperlink{classUnstructuredImmersedEllipseProblem_ab1558b409285aea617f4abf7d3a64b3d}{00618}} \textcolor{keywordtype}{void} \mbox{\hyperlink{classUnstructuredImmersedEllipseProblem_ab1558b409285aea617f4abf7d3a64b3d}{UnstructuredImmersedEllipseProblem<ELEMENT>::actions\_after\_adapt}}()}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00619}00619 \{}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00620}00620  \textcolor{comment}{//Reset the lagrangian coordinates for the solid mechanics}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00621}00621  \textcolor{comment}{//an updated lagrangian approach}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00622}00622  Fluid\_mesh\_pt-\/>set\_lagrangian\_nodal\_coordinates();}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00623}00623 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00624}00624  \textcolor{comment}{// Create the elements that impose the displacement constraint }}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00625}00625  create\_lagrange\_multiplier\_elements();}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00626}00626  }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00627}00627  \textcolor{comment}{// Create the drag elements anew}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00628}00628  create\_drag\_elements();}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00629}00629  }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00630}00630  \textcolor{comment}{// Add the drag elements to the rigid body}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00631}00631  \textcolor{keyword}{dynamic\_cast<}ImmersedRigidBodyElement*\textcolor{keyword}{>}(Rigid\_body\_pt[0])-\/>}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00632}00632   set\_drag\_mesh(this-\/>Drag\_mesh\_pt[0]);}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00633}00633  }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00634}00634  \textcolor{comment}{// Rebuild the Problem's global mesh from its various sub-\/meshes}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00635}00635  this-\/>rebuild\_global\_mesh();}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00636}00636  }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00637}00637  \textcolor{comment}{// Setup the problem again -\/-\/ remember that fluid mesh has been}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00638}00638  \textcolor{comment}{// completely rebuilt and its element's don't have any}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00639}00639  \textcolor{comment}{// pointers to Re etc. yet}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00640}00640  complete\_problem\_setup();}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00641}00641  }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00642}00642  \textcolor{comment}{// Output solution after adaptation/projection}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00643}00643  \textcolor{keywordtype}{bool} doc\_projection=\textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00644}00644  doc\_solution(doc\_projection);}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00645}00645 \}\textcolor{comment}{// end of actions\_after\_adapt}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00646}00646 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00647}00647 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00648}00648 \textcolor{comment}{//============start\_complete\_problem\_setup=================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00649}00649 \textcolor{comment}{/// Set boundary condition, assign auxiliary node update fct.}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00650}00650 \textcolor{comment}{/// Complete the build of all elements, attach power elements that allow}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00651}00651 \textcolor{comment}{/// computation of drag vector}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00652}00652 \textcolor{comment}{}\textcolor{comment}{//=========================================================================}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00653}00653 \textcolor{keyword}{template}<\textcolor{keyword}{class} ELEMENT>}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00654}\mbox{\hyperlink{classUnstructuredImmersedEllipseProblem_a42b13e3306ff2a94053907644ba17c8d}{00654}} \textcolor{keywordtype}{void} \mbox{\hyperlink{classUnstructuredImmersedEllipseProblem_a42b13e3306ff2a94053907644ba17c8d}{UnstructuredImmersedEllipseProblem<ELEMENT>::complete\_problem\_setup}}()}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00655}00655 \{   }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00656}00656  \textcolor{comment}{// Set the boundary conditions for fluid problem: All nodes are}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00657}00657  \textcolor{comment}{// free by default -\/-\/ just pin the ones that have Dirichlet conditions}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00658}00658  \textcolor{comment}{// here. }}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00659}00659  \textcolor{keywordtype}{unsigned} nbound=Fluid\_mesh\_pt-\/>nboundary();}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00660}00660  \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned} ibound=0;ibound<nbound;ibound++)}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00661}00661   \{}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00662}00662    \textcolor{keywordtype}{unsigned} num\_nod=Fluid\_mesh\_pt-\/>nboundary\_node(ibound);}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00663}00663    \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} inod=0;inod<num\_nod;inod++)}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00664}00664     \{}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00665}00665      \textcolor{comment}{// Cache pointer to node}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00666}00666      Node* \textcolor{keyword}{const} nod\_pt=Fluid\_mesh\_pt-\/>boundary\_node\_pt(ibound,inod);}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00667}00667      }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00668}00668      \textcolor{comment}{//Pin x-\/velocity unless on inlet (0) and outlet (2) boundaries}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00669}00669      \textcolor{comment}{//of the external rectangular box}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00670}00670      \textcolor{keywordflow}{if}((ibound!=0) \&\& (ibound!=2)) \{nod\_pt-\/>pin(0);\}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00671}00671      \textcolor{comment}{//Pin the y-\/velocity on all boundaries}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00672}00672      nod\_pt-\/>pin(1);}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00673}00673      }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00674}00674      \textcolor{comment}{// Pin pseudo-\/solid positions apart from on the }}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00675}00675      \textcolor{comment}{// ellipse boundary that is allowed to move}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00676}00676      \textcolor{comment}{// Cache cast pointer to solid node}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00677}00677      SolidNode* \textcolor{keyword}{const} solid\_node\_pt = \textcolor{keyword}{dynamic\_cast<}SolidNode*\textcolor{keyword}{>}(nod\_pt);}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00678}00678           }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00679}00679      \textcolor{comment}{//Pin the solid positions on all external boundaries}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00680}00680      \textcolor{keywordflow}{if}(ibound < 4)}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00681}00681       \{}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00682}00682        solid\_node\_pt-\/>pin\_position(0);}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00683}00683        solid\_node\_pt-\/>pin\_position(1);}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00684}00684       \}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00685}00685      \textcolor{comment}{// Unpin the position of all the nodes on hole boundaries:}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00686}00686      \textcolor{comment}{// since they will be moved using Lagrange Multiplier}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00687}00687      \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00688}00688       \{}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00689}00689        solid\_node\_pt-\/>unpin\_position(0);}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00690}00690        solid\_node\_pt-\/>unpin\_position(1);}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00691}00691        }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00692}00692        \textcolor{comment}{// Assign auxiliary node update fct, which determines the}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00693}00693        \textcolor{comment}{// velocity on the moving boundary using the position history}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00694}00694        \textcolor{comment}{// values}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00695}00695        \textcolor{comment}{// A more accurate version may be obtained by using velocity}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00696}00696        \textcolor{comment}{// based on the actual position of the geometric object,}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00697}00697        \textcolor{comment}{// but this introduces additional dependencies between the}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00698}00698        \textcolor{comment}{// Data of the rigid body and the fluid elements.}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00699}00699        nod\_pt-\/>set\_auxiliary\_node\_update\_fct\_pt(}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00700}00700         FSI\_functions::apply\_no\_slip\_on\_moving\_wall); }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00701}00701       \}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00702}00702     \} \textcolor{comment}{//End of loop over boundary nodes}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00703}00703   \} \textcolor{comment}{// End loop over boundaries}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00704}00704  }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00705}00705  \textcolor{comment}{// Complete the build of all elements so they are fully functional}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00706}00706  \textcolor{keywordtype}{unsigned} n\_element = Fluid\_mesh\_pt-\/>nelement();}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00707}00707  \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned} e=0;e<n\_element;e++)}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00708}00708   \{}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00709}00709    \textcolor{comment}{// Upcast from GeneralisedElement to the present element}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00710}00710    ELEMENT* el\_pt = \textcolor{keyword}{dynamic\_cast<}ELEMENT*\textcolor{keyword}{>}(Fluid\_mesh\_pt-\/>element\_pt(e));}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00711}00711    }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00712}00712    \textcolor{comment}{// Set the Reynolds number}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00713}00713    el\_pt-\/>re\_pt() = \&\mbox{\hyperlink{namespaceProblem__Parameter_acc656299287d4d9a8374c2c501750b4f}{Problem\_Parameter::Re}};}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00714}00714    }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00715}00715    \textcolor{comment}{// Set the Womersley number (same as Re since St=1)}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00716}00716    el\_pt-\/>re\_st\_pt() = \&\mbox{\hyperlink{namespaceProblem__Parameter_acc656299287d4d9a8374c2c501750b4f}{Problem\_Parameter::Re}};}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00717}00717    }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00718}00718    \textcolor{comment}{// Set the constitutive law for pseudo-\/elastic mesh deformation}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00719}00719    el\_pt-\/>constitutive\_law\_pt()=\mbox{\hyperlink{namespaceProblem__Parameter_a9852a6077458693983628319d429f11f}{Problem\_Parameter::Constitutive\_law\_pt}};}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00720}00720    }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00721}00721    \textcolor{comment}{// Set the "{}density"{} for pseudo-\/elastic mesh deformation}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00722}00722    el\_pt-\/>lambda\_sq\_pt()=\&\mbox{\hyperlink{namespaceProblem__Parameter_a20ea33c391abd96d43f79913377c1e12}{Problem\_Parameter::Lambda\_sq}};}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00723}00723   \}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00724}00724  }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00725}00725  \textcolor{comment}{// Re-\/apply Dirichlet boundary conditions for current and history values}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00726}00726  \textcolor{comment}{// (projection ignores boundary conditions!)}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00727}00727  this-\/>set\_boundary\_velocity();}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00728}00728 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00729}00729 \} \textcolor{comment}{//end\_of\_complete\_problem\_setup}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00730}00730 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00731}00731 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00732}00732 \textcolor{comment}{//=================start\_set\_boundary\_velocity===========================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00733}00733 \textcolor{comment}{/// Set the boundary velocity for current and history values}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00734}00734 \textcolor{comment}{}\textcolor{comment}{//=======================================================================}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00735}00735 \textcolor{keyword}{template}<\textcolor{keyword}{class} ELEMENT>}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00736}\mbox{\hyperlink{classUnstructuredImmersedEllipseProblem_ab201b187b240105fd8d444d943f6dada}{00736}} \textcolor{keywordtype}{void} \mbox{\hyperlink{classUnstructuredImmersedEllipseProblem_ab201b187b240105fd8d444d943f6dada}{UnstructuredImmersedEllipseProblem<ELEMENT>::}}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00737}00737 \mbox{\hyperlink{classUnstructuredImmersedEllipseProblem_ab201b187b240105fd8d444d943f6dada}{set\_boundary\_velocity}}()}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00738}00738 \{}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00739}00739  \textcolor{comment}{//Loop over top and bottom walls, inlet and outlet}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00740}00740  \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned} ibound=0;ibound<4;ibound++)}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00741}00741   \{}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00742}00742    \textcolor{comment}{//If we are on the inlet or outlet only zero the }}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00743}00743    \textcolor{comment}{//y velocity, leave x alone}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00744}00744    \textcolor{keywordflow}{if}((ibound==0) || (ibound==2))}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00745}00745     \{}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00746}00746      \textcolor{keywordtype}{unsigned} num\_nod=this-\/>Fluid\_mesh\_pt-\/>nboundary\_node(ibound);}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00747}00747      \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} inod=0;inod<num\_nod;inod++)}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00748}00748       \{}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00749}00749        \textcolor{comment}{// Get node}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00750}00750        Node* \textcolor{keyword}{const} nod\_pt=this-\/>Fluid\_mesh\_pt-\/>boundary\_node\_pt(ibound,inod);}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00751}00751        }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00752}00752        \textcolor{comment}{// Get number of previous (history) values}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00753}00753        \textcolor{keywordtype}{unsigned} n\_prev=nod\_pt-\/>time\_stepper\_pt()-\/>nprev\_values();}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00754}00754        }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00755}00755        \textcolor{comment}{//Zero all current and previous y-\/velocities}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00756}00756        \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned} t=0;t<=n\_prev;t++)}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00757}00757         \{}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00758}00758          nod\_pt-\/>set\_value(t,1,0.0);}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00759}00759         \}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00760}00760       \}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00761}00761     \}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00762}00762    \textcolor{comment}{//Otherwise on the top and bottom walls set a smooth x-\/velocity}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00763}00763    \textcolor{comment}{//and zero y-\/velocity}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00764}00764    \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00765}00765     \{}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00766}00766      \textcolor{keywordtype}{unsigned} num\_nod=this-\/>Fluid\_mesh\_pt-\/>nboundary\_node(ibound);}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00767}00767      \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} inod=0;inod<num\_nod;inod++)}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00768}00768       \{}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00769}00769        \textcolor{comment}{// Get node}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00770}00770        Node* nod\_pt=this-\/>Fluid\_mesh\_pt-\/>boundary\_node\_pt(ibound,inod);}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00771}00771        }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00772}00772        \textcolor{comment}{// Get number of previous (history) values}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00773}00773        \textcolor{keywordtype}{unsigned} n\_prev=nod\_pt-\/>time\_stepper\_pt()-\/>nprev\_values();}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00774}00774        }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00775}00775        \textcolor{comment}{//Now set the boundary velocity}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00776}00776        \textcolor{keywordtype}{double} y = nod\_pt-\/>x(1);}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00777}00777        \textcolor{comment}{//Get the previous time}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00778}00778        \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned} t=0;t<=n\_prev;t++)}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00779}00779         \{}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00780}00780          \textcolor{comment}{//Get the time}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00781}00781          \textcolor{keywordtype}{double} time\_ = this-\/>time\_pt()-\/>time(t);}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00782}00782          }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00783}00783          \textcolor{comment}{//Get the velocity ramp}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00784}00784          \textcolor{comment}{//Initially zero (nothing at all is going on)}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00785}00785          \textcolor{keywordtype}{double} ramp = 0.0;}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00786}00786          \textcolor{keywordtype}{double} delta = 5.0;}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00787}00787          }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00788}00788          \textcolor{keywordtype}{double} e1 = exp(-\/delta);}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00789}00789          \textcolor{keywordtype}{double} a1 = 1.0 -\/ (1.0 + delta + 0.5*delta*delta)*e1;}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00790}00790          \textcolor{keywordtype}{double} b1 = (3.0 + 3.0*delta + delta*delta)*e1 -\/ 3.0;}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00791}00791          \textcolor{keywordtype}{double} c1 = 3.0 -\/ (3.0 + 2.0*delta + 0.5*delta*delta)*e1;}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00792}00792          \textcolor{comment}{//Smooth start}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00793}00793          \textcolor{keywordflow}{if}((time\_ >= 0.0) \& (time\_ <= 1.0)) }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00794}00794           \{ }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00795}00795            ramp = a1*time\_*time\_*time\_}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00796}00796             + b1*time\_*time\_}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00797}00797               + c1*time\_;}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00798}00798           \}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00799}00799          \textcolor{comment}{//Coupled to exponential levelling}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00800}00800          \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (time\_ > 1.0)}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00801}00801           \{}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00802}00802            ramp = 1.0 -\/ exp(-\/delta*time\_);}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00803}00803           \}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00804}00804          }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00805}00805          nod\_pt-\/>set\_value(t,0,-\/y*ramp);}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00806}00806         \}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00807}00807        }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00808}00808        \textcolor{comment}{// Zero all current and previous veloc values}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00809}00809        \textcolor{comment}{// for the v-\/velocity}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00810}00810        \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} t=0;t<=n\_prev;t++)}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00811}00811         \{}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00812}00812          nod\_pt-\/>set\_value(t,1,0.0);}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00813}00813         \}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00814}00814       \}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00815}00815     \}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00816}00816   \}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00817}00817 \}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00818}00818 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00819}00819 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00820}00820 \textcolor{comment}{//====================start\_of\_pin\_rigid\_body=====================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00821}00821 \textcolor{comment}{/// Pin the degrees of freedom associated with the solid bodies}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00822}00822 \textcolor{comment}{}\textcolor{comment}{//================================================================}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00823}00823 \textcolor{keyword}{template}<\textcolor{keyword}{class} ELEMENT>}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00824}\mbox{\hyperlink{classUnstructuredImmersedEllipseProblem_a07dc16909c0223fe4b656fd270f27c11}{00824}} \textcolor{keywordtype}{void} \mbox{\hyperlink{classUnstructuredImmersedEllipseProblem_a07dc16909c0223fe4b656fd270f27c11}{UnstructuredImmersedEllipseProblem<ELEMENT>::pin\_rigid\_body}}()}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00825}00825 \{}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00826}00826  \textcolor{keywordtype}{unsigned} n\_rigid\_body = Rigid\_body\_pt.size();}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00827}00827  \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned} i=0;i<n\_rigid\_body;++i)}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00828}00828   \{}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00829}00829    \textcolor{keywordtype}{unsigned} n\_geom\_data = Rigid\_body\_pt[i]-\/>ngeom\_data();}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00830}00830    \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned} j=0;j<n\_geom\_data;j++)}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00831}00831     \{}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00832}00832      Rigid\_body\_pt[i]-\/>geom\_data\_pt(j)-\/>pin\_all();}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00833}00833     \}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00834}00834   \}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00835}00835 \}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00836}00836 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00837}00837 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00838}00838 \textcolor{comment}{//=================start\_unpin\_rigid\_body==========================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00839}00839 \textcolor{comment}{/// Unpin the degrees of freedom associated with the solid bodies}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00840}00840 \textcolor{comment}{}\textcolor{comment}{//=================================================================}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00841}00841 \textcolor{keyword}{template}<\textcolor{keyword}{class} ELEMENT>}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00842}\mbox{\hyperlink{classUnstructuredImmersedEllipseProblem_a4f8c7e7e4d626084f6515a152b165567}{00842}} \textcolor{keywordtype}{void} \mbox{\hyperlink{classUnstructuredImmersedEllipseProblem_a4f8c7e7e4d626084f6515a152b165567}{UnstructuredImmersedEllipseProblem<ELEMENT>::unpin\_rigid\_body}}()}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00843}00843 \{}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00844}00844  \textcolor{keywordtype}{unsigned} n\_rigid\_body = Rigid\_body\_pt.size();}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00845}00845  \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned} i=0;i<n\_rigid\_body;++i)}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00846}00846   \{}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00847}00847    \textcolor{keywordtype}{unsigned} n\_geom\_data = Rigid\_body\_pt[i]-\/>ngeom\_data();}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00848}00848    \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned} j=0;j<n\_geom\_data;j++)}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00849}00849     \{}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00850}00850      Rigid\_body\_pt[i]-\/>geom\_data\_pt(j)-\/>unpin\_all();}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00851}00851     \}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00852}00852   \}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00853}00853 \}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00854}00854 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00855}00855 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00856}00856 \textcolor{comment}{//==========start\_solve\_for\_consistent\_nodal\_positions================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00857}00857 \textcolor{comment}{/// Assemble and solve a simplified problem that ensures that the }}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00858}00858 \textcolor{comment}{/// positions of the boundary nodes are consistent with the weak }}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00859}00859 \textcolor{comment}{/// imposition of the displacement boundary conditions on the surface}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00860}00860 \textcolor{comment}{/// of the ellipse.}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00861}00861 \textcolor{comment}{}\textcolor{comment}{//===================================================================}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00862}00862 \textcolor{keyword}{template}<\textcolor{keyword}{class} ELEMENT>}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00863}\mbox{\hyperlink{classUnstructuredImmersedEllipseProblem_a2a88b40ff1988de0fc696f1eb755ea54}{00863}} \textcolor{keywordtype}{void} \mbox{\hyperlink{classUnstructuredImmersedEllipseProblem_a2a88b40ff1988de0fc696f1eb755ea54}{UnstructuredImmersedEllipseProblem<ELEMENT>::}}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00864}00864 \mbox{\hyperlink{classUnstructuredImmersedEllipseProblem_a2a88b40ff1988de0fc696f1eb755ea54}{solve\_for\_consistent\_nodal\_positions}}()}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00865}00865 \{}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00866}00866  \textcolor{comment}{//First pin all degrees of freedom in the rigid body}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00867}00867  this-\/>pin\_rigid\_body();}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00868}00868 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00869}00869  \textcolor{comment}{//Must reassign equation numbrs}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00870}00870  this-\/>assign\_eqn\_numbers();}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00871}00871 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00872}00872  \textcolor{comment}{//Do a steady solve to map the nodes to the boundary of the ellipse}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00873}00873  this-\/>steady\_newton\_solve();}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00874}00874 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00875}00875  \textcolor{comment}{//Now unpin the rigid body...}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00876}00876  this-\/>unpin\_rigid\_body();}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00877}00877 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00878}00878  \textcolor{comment}{//...and then repin the position of the centre of mass}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00879}00879  ImmersedRigidBodyElement* rigid\_element1\_pt = }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00880}00880   \textcolor{keyword}{dynamic\_cast<}ImmersedRigidBodyElement*\textcolor{keyword}{>}(Rigid\_body\_pt[0]);}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00881}00881  rigid\_element1\_pt-\/>pin\_centre\_of\_mass\_coordinate(0);}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00882}00882  rigid\_element1\_pt-\/>pin\_centre\_of\_mass\_coordinate(1);}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00883}00883 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00884}00884  \textcolor{comment}{//and then reassign equation numbers}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00885}00885  this-\/>assign\_eqn\_numbers();}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00886}00886 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00887}00887 \} \textcolor{comment}{//end\_solve\_for\_consistent\_nodal\_positions}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00888}00888 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00889}00889 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00890}00890 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00891}00891 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00892}00892 \textcolor{comment}{//============start\_of\_create\_lagrange\_multiplier\_elements===============}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00893}00893 \textcolor{comment}{/// Create elements that impose the prescribed boundary displacement}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00894}00894 \textcolor{comment}{/// for the pseudo-\/solid fluid mesh}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00895}00895 \textcolor{comment}{}\textcolor{comment}{//=======================================================================}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00896}00896 \textcolor{keyword}{template}<\textcolor{keyword}{class} ELEMENT>}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00897}\mbox{\hyperlink{classUnstructuredImmersedEllipseProblem_a3b4a4e279a11b37d79d040b348008765}{00897}} \textcolor{keywordtype}{void} \mbox{\hyperlink{classUnstructuredImmersedEllipseProblem_a3b4a4e279a11b37d79d040b348008765}{UnstructuredImmersedEllipseProblem<ELEMENT>::}}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00898}00898 \mbox{\hyperlink{classUnstructuredImmersedEllipseProblem_a3b4a4e279a11b37d79d040b348008765}{create\_lagrange\_multiplier\_elements}}()}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00899}00899 \{ }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00900}00900  \textcolor{comment}{// The idea is to apply Lagrange multipliers to the boundaries in }}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00901}00901  \textcolor{comment}{// the mesh that have associated geometric objects}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00902}00902 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00903}00903  \textcolor{comment}{//Find the number of boundaries}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00904}00904  \textcolor{keywordtype}{unsigned} n\_boundary = Fluid\_mesh\_pt-\/>nboundary();}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00905}00905 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00906}00906  \textcolor{comment}{// Loop over the boundaries}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00907}00907  \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned} b=0;b<n\_boundary;b++)}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00908}00908   \{}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00909}00909    \textcolor{comment}{//Get the geometric object associated with the boundary}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00910}00910    GeomObject* boundary\_geom\_obj\_pt = }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00911}00911     Fluid\_mesh\_pt-\/>boundary\_geom\_object\_pt(b);}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00912}00912 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00913}00913    \textcolor{comment}{//Only bother to do anything if there is a geometric object}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00914}00914    \textcolor{keywordflow}{if}(boundary\_geom\_obj\_pt!=0)}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00915}00915     \{}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00916}00916      \textcolor{comment}{// How many bulk fluid elements are adjacent to boundary b?}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00917}00917      \textcolor{keywordtype}{unsigned} n\_element = Fluid\_mesh\_pt-\/>nboundary\_element(b);}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00918}00918      }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00919}00919      \textcolor{comment}{// Loop over the bulk fluid elements adjacent to boundary b?}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00920}00920      \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned} e=0;e<n\_element;e++)}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00921}00921       \{}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00922}00922        \textcolor{comment}{// Get pointer to the bulk fluid element that is }}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00923}00923        \textcolor{comment}{// adjacent to boundary b}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00924}00924        ELEMENT* bulk\_elem\_pt = \textcolor{keyword}{dynamic\_cast<}ELEMENT*\textcolor{keyword}{>}(}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00925}00925         Fluid\_mesh\_pt-\/>boundary\_element\_pt(b,e));}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00926}00926        }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00927}00927        \textcolor{comment}{//Find the index of the face of element e along boundary b}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00928}00928        \textcolor{keywordtype}{int} face\_index = Fluid\_mesh\_pt-\/>face\_index\_at\_boundary(b,e);}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00929}00929        }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00930}00930        \textcolor{comment}{// Create new element. Note that we use different Lagrange}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00931}00931        \textcolor{comment}{// multiplier fields for each distinct boundary (here indicated}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00932}00932        \textcolor{comment}{// by b.}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00933}00933        ImposeDisplacementByLagrangeMultiplierElement<ELEMENT>* el\_pt =}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00934}00934         \textcolor{keyword}{new} ImposeDisplacementByLagrangeMultiplierElement<ELEMENT>(}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00935}00935          bulk\_elem\_pt,face\_index,b);   }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00936}00936        }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00937}00937        \textcolor{comment}{// Add it to the mesh}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00938}00938        Lagrange\_multiplier\_mesh\_pt-\/>add\_element\_pt(el\_pt);}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00939}00939        }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00940}00940        \textcolor{comment}{// Set the GeomObject that defines the boundary shape and set}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00941}00941        \textcolor{comment}{// which bulk boundary we are attached to (needed to extract}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00942}00942        \textcolor{comment}{// the boundary coordinate from the bulk nodes)}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00943}00943        el\_pt-\/>set\_boundary\_shape\_geom\_object\_pt(}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00944}00944         boundary\_geom\_obj\_pt,b);}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00945}00945        }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00946}00946        \textcolor{comment}{// Loop over the nodes to pin Lagrange multiplier}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00947}00947        \textcolor{keywordtype}{unsigned} nnod=el\_pt-\/>nnode();}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00948}00948        \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned} j=0;j<nnod;j++)}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00949}00949         \{}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00950}00950          Node* nod\_pt = el\_pt-\/>node\_pt(j);}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00951}00951          }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00952}00952          \textcolor{comment}{// How many nodal values were used by the "{}bulk"{} element}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00953}00953          \textcolor{comment}{// that originally created this node?}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00954}00954          \textcolor{keywordtype}{unsigned} n\_bulk\_value=el\_pt-\/>nbulk\_value(j);}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00955}00955          }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00956}00956          \textcolor{comment}{// Pin two of the four Lagrange multipliers at vertices}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00957}00957          \textcolor{comment}{// This is not totally robust, but will work in this application}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00958}00958          \textcolor{keywordtype}{unsigned} nval=nod\_pt-\/>nvalue();}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00959}00959          \textcolor{keywordflow}{if} (nval==7)}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00960}00960           \{}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00961}00961            \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} i=0;i<2;i++) }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00962}00962             \{ }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00963}00963              \textcolor{comment}{// Pin lagrangian multipliers}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00964}00964              nod\_pt-\/>pin(n\_bulk\_value+2+i);}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00965}00965             \}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00966}00966           \}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00967}00967         \}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00968}00968       \} \textcolor{comment}{// end loop over the element}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00969}00969     \} \textcolor{comment}{//End of  case if there is a geometric object}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00970}00970   \} \textcolor{comment}{//End of loop over boundaries}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00971}00971 \}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00972}00972 \textcolor{comment}{// end of create\_lagrange\_multiplier\_elements}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00973}00973 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00974}00974 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00975}00975 \textcolor{comment}{//===============start\_delete\_lagrange\_multiplier\_elements==================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00976}00976 \textcolor{comment}{/// Delete elements that impose the prescribed boundary displacement}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00977}00977 \textcolor{comment}{/// and wipe the associated mesh}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00978}00978 \textcolor{comment}{}\textcolor{comment}{//==========================================================================}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00979}00979 \textcolor{keyword}{template}<\textcolor{keyword}{class} ELEMENT>}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00980}\mbox{\hyperlink{classUnstructuredImmersedEllipseProblem_a51555f77dc360c94591ee68c3fc9928a}{00980}} \textcolor{keywordtype}{void} \mbox{\hyperlink{classUnstructuredImmersedEllipseProblem_a51555f77dc360c94591ee68c3fc9928a}{UnstructuredImmersedEllipseProblem<ELEMENT>::}}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00981}00981 \mbox{\hyperlink{classUnstructuredImmersedEllipseProblem_a51555f77dc360c94591ee68c3fc9928a}{delete\_lagrange\_multiplier\_elements}}()}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00982}00982 \{}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00983}00983  \textcolor{comment}{// How many surface elements are in the surface mesh}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00984}00984  \textcolor{keywordtype}{unsigned} n\_element = Lagrange\_multiplier\_mesh\_pt-\/>nelement();}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00985}00985  }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00986}00986  \textcolor{comment}{// Loop over the surface elements}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00987}00987  \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned} e=0;e<n\_element;e++)}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00988}00988   \{}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00989}00989    \textcolor{comment}{// Kill surface element}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00990}00990    \textcolor{keyword}{delete} Lagrange\_multiplier\_mesh\_pt-\/>element\_pt(e);}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00991}00991   \}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00992}00992  }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00993}00993  \textcolor{comment}{// Wipe the mesh}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00994}00994  Lagrange\_multiplier\_mesh\_pt-\/>flush\_element\_and\_node\_storage();}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00995}00995  }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00996}00996 \} \textcolor{comment}{// end of delete\_lagrange\_multiplier\_elements}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00997}00997 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00998}00998 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l00999}00999 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01000}01000 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01001}01001 \textcolor{comment}{//============start\_of\_create\_drag\_elements===============}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01002}01002 \textcolor{comment}{/// Create elements that calculate the drag and torque on}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01003}01003 \textcolor{comment}{/// the obstacles in the fluid mesh}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01004}01004 \textcolor{comment}{}\textcolor{comment}{//=======================================================================}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01005}01005 \textcolor{keyword}{template}<\textcolor{keyword}{class} ELEMENT>}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01006}\mbox{\hyperlink{classUnstructuredImmersedEllipseProblem_a16a7c6022867f709ebdd59b8fee2004a}{01006}} \textcolor{keywordtype}{void} \mbox{\hyperlink{classUnstructuredImmersedEllipseProblem_a16a7c6022867f709ebdd59b8fee2004a}{UnstructuredImmersedEllipseProblem<ELEMENT>::create\_drag\_elements}}()}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01007}01007 \{ }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01008}01008  \textcolor{comment}{//The idea is only to attach drag elements to those}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01009}01009  \textcolor{comment}{//boundaries associated with each particular rigid body}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01010}01010  \textcolor{comment}{//The loop is slightly inefficient, but should work in general}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01011}01011 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01012}01012  \textcolor{comment}{// Get the number of rigid bodies}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01013}01013  \textcolor{keywordtype}{unsigned} n\_rigid = Rigid\_body\_pt.size();}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01014}01014 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01015}01015  \textcolor{comment}{// Get the number of boundaries in the mesh}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01016}01016  \textcolor{keywordtype}{unsigned} n\_boundary = Fluid\_mesh\_pt-\/>nboundary();}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01017}01017 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01018}01018  \textcolor{comment}{//Loop over the rigid bodies}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01019}01019  \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned} r=0;r<n\_rigid;r++)}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01020}01020   \{}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01021}01021    \textcolor{comment}{//Get the rigid boundary geometric object}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01022}01022    ImmersedRigidBodyElement* rigid\_el\_pt = }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01023}01023     \textcolor{keyword}{dynamic\_cast<}ImmersedRigidBodyElement*\textcolor{keyword}{>}(this-\/>Rigid\_body\_pt[r]);}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01024}01024    }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01025}01025    \textcolor{comment}{// Loop over all boundaries}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01026}01026    \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned} b=0;b<n\_boundary;b++)}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01027}01027     \{}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01028}01028      \textcolor{comment}{//Does the boundary correspond to the current rigid body}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01029}01029      \textcolor{keywordflow}{if}(\textcolor{keyword}{dynamic\_cast<}ImmersedRigidBodyElement*\textcolor{keyword}{>}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01030}01030         (Fluid\_mesh\_pt-\/>boundary\_geom\_object\_pt(b)) == rigid\_el\_pt)}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01031}01031       \{}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01032}01032        \textcolor{comment}{// How many bulk fluid elements are adjacent to boundary b?}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01033}01033        \textcolor{keywordtype}{unsigned} n\_element = Fluid\_mesh\_pt-\/>nboundary\_element(b);}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01034}01034        }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01035}01035        \textcolor{comment}{// Loop over the bulk fluid elements adjacent to boundary b?}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01036}01036        \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned} e=0;e<n\_element;e++)}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01037}01037         \{}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01038}01038          \textcolor{comment}{// Get pointer to the bulk fluid element that is }}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01039}01039          \textcolor{comment}{// adjacent to boundary b}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01040}01040          ELEMENT* bulk\_elem\_pt = \textcolor{keyword}{dynamic\_cast<}ELEMENT*\textcolor{keyword}{>}(}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01041}01041           Fluid\_mesh\_pt-\/>boundary\_element\_pt(b,e));}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01042}01042        }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01043}01043          \textcolor{comment}{//Find the index of the face of element e along boundary b}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01044}01044          \textcolor{keywordtype}{int} face\_index = Fluid\_mesh\_pt-\/>face\_index\_at\_boundary(b,e);}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01045}01045          }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01046}01046          \textcolor{comment}{// Create new element. Note that we use different Lagrange}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01047}01047          \textcolor{comment}{// multiplier fields for each distinct boundary (here indicated}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01048}01048          \textcolor{comment}{// by b.}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01049}01049          NavierStokesSurfaceDragTorqueElement<ELEMENT>* el\_pt =}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01050}01050           \textcolor{keyword}{new} NavierStokesSurfaceDragTorqueElement<ELEMENT>(}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01051}01051            bulk\_elem\_pt,face\_index);   }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01052}01052          }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01053}01053          \textcolor{comment}{// Add it to the mesh}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01054}01054          Drag\_mesh\_pt[r]-\/>add\_element\_pt(el\_pt);}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01055}01055          }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01056}01056          \textcolor{comment}{//Set the original centre of rotation }}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01057}01057          \textcolor{comment}{//from the rigid body in the drag element}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01058}01058          \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned} i=0;i<2;i++) }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01059}01059           \{el\_pt-\/>centre\_of\_rotation(i) = }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01060}01060             rigid\_el\_pt-\/>initial\_centre\_of\_mass(i);\}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01061}01061          }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01062}01062          \textcolor{comment}{//Set the data to the translation and rotation data}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01063}01063          \textcolor{comment}{//as well because these data will enter the Jacobian terms}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01064}01064          \textcolor{comment}{//in the DragTorqueElement}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01065}01065          el\_pt-\/>set\_translation\_and\_rotation(rigid\_el\_pt-\/>geom\_data\_pt(0));}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01066}01066         \} \textcolor{comment}{// end loop over the element}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01067}01067       \}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01068}01068     \} \textcolor{comment}{//End of loop over boundaries}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01069}01069   \} \textcolor{comment}{// end loop over the rigid bodies}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01070}01070 \}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01071}01071 \textcolor{comment}{// end of create\_drag\_elements}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01072}01072 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01073}01073 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01074}01074 \textcolor{comment}{//=======================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01075}01075 \textcolor{comment}{/// Delete elements that calculate the drag and torque on the }}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01076}01076 \textcolor{comment}{/// boundaries}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01077}01077 \textcolor{comment}{}\textcolor{comment}{//=======================================================================}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01078}01078 \textcolor{keyword}{template}<\textcolor{keyword}{class} ELEMENT>}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01079}\mbox{\hyperlink{classUnstructuredImmersedEllipseProblem_a7d7b84968988d37091b29957b0af5bfa}{01079}} \textcolor{keywordtype}{void} \mbox{\hyperlink{classUnstructuredImmersedEllipseProblem_a7d7b84968988d37091b29957b0af5bfa}{UnstructuredImmersedEllipseProblem<ELEMENT>::delete\_drag\_elements}}()}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01080}01080 \{}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01081}01081  \textcolor{keywordtype}{unsigned} n\_bodies = Drag\_mesh\_pt.size();}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01082}01082  \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned} n=0;n<n\_bodies;n++)}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01083}01083   \{}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01084}01084    \textcolor{comment}{// How many surface elements are in the surface mesh}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01085}01085    \textcolor{keywordtype}{unsigned} n\_element = Drag\_mesh\_pt[n]-\/>nelement();}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01086}01086    }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01087}01087    \textcolor{comment}{// Loop over the surface elements}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01088}01088    \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned} e=0;e<n\_element;e++)}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01089}01089     \{}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01090}01090      \textcolor{comment}{// Kill surface element}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01091}01091      \textcolor{keyword}{delete} Drag\_mesh\_pt[n]-\/>element\_pt(e);}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01092}01092     \}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01093}01093    }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01094}01094    \textcolor{comment}{// Wipe the mesh}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01095}01095    Drag\_mesh\_pt[n]-\/>flush\_element\_and\_node\_storage();}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01096}01096   \}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01097}01097 \} \textcolor{comment}{// end of delete\_drag\_elements}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01098}01098 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01099}01099 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01100}01100 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01101}01101 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01102}01102 \textcolor{comment}{//==start\_of\_doc\_solution=================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01103}01103 \textcolor{comment}{/// Doc the solution}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01104}01104 \textcolor{comment}{}\textcolor{comment}{//========================================================================}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01105}01105 \textcolor{keyword}{template}<\textcolor{keyword}{class} ELEMENT>}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01106}\mbox{\hyperlink{classUnstructuredImmersedEllipseProblem_a08e12dd83c98f96e14e8152cc758d398}{01106}} \textcolor{keywordtype}{void} \mbox{\hyperlink{classUnstructuredImmersedEllipseProblem_a08e12dd83c98f96e14e8152cc758d398}{UnstructuredImmersedEllipseProblem<ELEMENT>::doc\_solution}}(}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01107}01107  \textcolor{keyword}{const} \textcolor{keywordtype}{bool}\& project)}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01108}01108 \{ }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01109}01109 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01110}01110  oomph\_info << \textcolor{stringliteral}{"{}Docing step: "{}} << this-\/>Doc\_info.number()}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01111}01111             << std::endl;}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01112}01112 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01113}01113  ofstream some\_file;}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01114}01114  \textcolor{keywordtype}{char} filename[100];}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01115}01115 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01116}01116  \textcolor{comment}{// Number of plot points}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01117}01117  \textcolor{keywordtype}{unsigned} npts;}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01118}01118  npts=5; }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01119}01119 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01120}01120  }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01121}01121  \textcolor{comment}{// Output solution and projection files}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01122}01122  \textcolor{keywordflow}{if}(!project)}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01123}01123   \{}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01124}01124    sprintf(filename,\textcolor{stringliteral}{"{}\%s/soln\%i.dat"{}},}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01125}01125            this-\/>Doc\_info.directory().c\_str(),}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01126}01126            this-\/>Doc\_info.number());}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01127}01127   \}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01128}01128  \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01129}01129   \{}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01130}01130    sprintf(filename,\textcolor{stringliteral}{"{}\%s/proj\%i.dat"{}},}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01131}01131            this-\/>Doc\_info.directory().c\_str(),}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01132}01132            this-\/>Doc\_info.number()-\/1);}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01133}01133   \}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01134}01134 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01135}01135  \textcolor{comment}{// Assemble square of L2 norm }}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01136}01136  \textcolor{keywordtype}{double} square\_of\_l2\_norm=0.0;}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01137}01137  \textcolor{keywordtype}{unsigned} nel=Fluid\_mesh\_pt-\/>nelement();}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01138}01138  \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} e=0;e<nel;e++)}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01139}01139   \{}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01140}01140    square\_of\_l2\_norm+=}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01141}01141     \textcolor{keyword}{dynamic\_cast<}ELEMENT*\textcolor{keyword}{>}(this-\/>Fluid\_mesh\_pt-\/>element\_pt(e))-\/>}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01142}01142     square\_of\_l2\_norm();}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01143}01143   \}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01144}01144 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01145}01145  std::cout << \textcolor{stringliteral}{"{}Checking "{}} << sqrt(square\_of\_l2\_norm) << \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01146}01146  this-\/>Norm\_file << sqrt(square\_of\_l2\_norm) << \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01147}01147  }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01148}01148  some\_file.open(filename);}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01149}01149  some\_file << dynamic\_cast<ELEMENT*>(this-\/>Fluid\_mesh\_pt-\/>element\_pt(0))}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01150}01150   -\/>variable\_identifier();}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01151}01151  this-\/>Fluid\_mesh\_pt-\/>output(some\_file,npts);   }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01152}01152  some\_file.close();}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01153}01153 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01154}01154  \textcolor{comment}{// No trace file writing after projection}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01155}01155  \textcolor{keywordflow}{if}(project) \textcolor{keywordflow}{return};}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01156}01156 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01157}01157  \textcolor{comment}{//Output the boundary only if not projecting}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01158}01158  sprintf(filename,\textcolor{stringliteral}{"{}\%s/int\%i.dat"{}},}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01159}01159          this-\/>Doc\_info.directory().c\_str(),}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01160}01160          this-\/>Doc\_info.number());}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01161}01161  some\_file.open(filename);}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01162}01162  this-\/>Lagrange\_multiplier\_mesh\_pt-\/>output(some\_file);}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01163}01163  some\_file.close();}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01164}01164 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01165}01165  \textcolor{comment}{// Increment the doc\_info number}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01166}01166  this-\/>Doc\_info.number()++;}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01167}01167 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01168}01168  \textcolor{comment}{//Output the motion of the centre of gravity}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01169}01169  \textcolor{keyword}{dynamic\_cast<}ImmersedRigidBodyElement*\textcolor{keyword}{>}(this-\/>Rigid\_body\_pt[0])-\/>}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01170}01170   output\_centre\_of\_gravity(this-\/>Cog\_file);}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01171}01171 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01172}01172  \textcolor{comment}{//Output the exact solution}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01173}01173  this-\/>output\_exact\_solution(this-\/>Cog\_exact\_file);}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01174}01174 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01175}01175 \}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01176}01176 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01177}01177 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01178}01178 \textcolor{comment}{//=====================================================================  }\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01179}01179 \textcolor{comment}{/// Output the exact solution}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01180}01180 \textcolor{comment}{}\textcolor{comment}{//=====================================================================  }}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01181}01181 \textcolor{keyword}{template}<\textcolor{keyword}{class} ELEMENT>}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01182}\mbox{\hyperlink{classUnstructuredImmersedEllipseProblem_a29a232dfac18ea901332bebdc14fad15}{01182}} \textcolor{keywordtype}{void} \mbox{\hyperlink{classUnstructuredImmersedEllipseProblem_a29a232dfac18ea901332bebdc14fad15}{UnstructuredImmersedEllipseProblem<ELEMENT>::}}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01183}01183 \mbox{\hyperlink{classUnstructuredImmersedEllipseProblem_a29a232dfac18ea901332bebdc14fad15}{output\_exact\_solution}}(std::ofstream \&output\_file)}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01184}01184   \{}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01185}01185    \textcolor{comment}{//Get the current time}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01186}01186    \textcolor{keywordtype}{double} time = this-\/>time();}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01187}01187    \textcolor{comment}{//Output the exact solution}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01188}01188    output\_file << time << \textcolor{stringliteral}{"{} "{}} << \mbox{\hyperlink{namespaceJeffery__Solution_ad3bd18834ecba370674e34242f8125c1}{Jeffery\_Solution::angle}}(time)}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01189}01189                << \textcolor{stringliteral}{"{} "{}} << \mbox{\hyperlink{namespaceJeffery__Solution_acf35d547e7d28609a17c66c9a191090b}{Jeffery\_Solution::velocity}}(time)}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01190}01190                << \textcolor{stringliteral}{"{} "{}} << \mbox{\hyperlink{namespaceJeffery__Solution_afe09bdca1fe833f94f510e206d5df08c}{Jeffery\_Solution::acceleration}}(time) << std::endl;}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01191}01191   \}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01192}01192 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01193}01193 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01194}01194 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01195}01195 \textcolor{comment}{//==========start\_of\_main======================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01196}01196 \textcolor{comment}{/// Driver code for immersed ellipse problem}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01197}01197 \textcolor{comment}{}\textcolor{comment}{//============================================================}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01198}\mbox{\hyperlink{jeffery__orbit_8cc_a3c04138a5bfe5d72780bb7e82a18e627}{01198}} \textcolor{keywordtype}{int} \mbox{\hyperlink{jeffery__orbit_8cc_a3c04138a5bfe5d72780bb7e82a18e627}{main}}(\textcolor{keywordtype}{int} argc, \textcolor{keywordtype}{char} **argv)}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01199}01199 \{}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01200}01200  \textcolor{comment}{// Store command line arguments}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01201}01201  CommandLineArgs::setup(argc,argv);}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01202}01202 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01203}01203  \textcolor{comment}{// Define possible command line arguments and parse the ones that}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01204}01204  \textcolor{comment}{// were actually specified}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01205}01205  }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01206}01206  \textcolor{comment}{// Validation?}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01207}01207  CommandLineArgs::specify\_command\_line\_flag(\textcolor{stringliteral}{"{}-\/-\/validation"{}});}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01208}01208 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01209}01209  \textcolor{comment}{// Parse command line}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01210}01210  CommandLineArgs::parse\_and\_assign(); }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01211}01211  }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01212}01212  \textcolor{comment}{// Doc what has actually been specified on the command line}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01213}01213  CommandLineArgs::doc\_specified\_flags();}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01214}01214   }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01215}01215  \textcolor{comment}{// Create problem in initial configuration}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01216}01216  \mbox{\hyperlink{classUnstructuredImmersedEllipseProblem}{UnstructuredImmersedEllipseProblem}}<}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01217}01217  ProjectableTaylorHoodElement<MyTaylorHoodElement> > problem;  }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01218}01218 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01219}01219  \textcolor{comment}{//Initially ensure that the nodal positions are consistent with }}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01220}01220  \textcolor{comment}{//their weak imposition}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01221}01221  problem.\mbox{\hyperlink{classUnstructuredImmersedEllipseProblem_a2a88b40ff1988de0fc696f1eb755ea54}{solve\_for\_consistent\_nodal\_positions}}();}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01222}01222  }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01223}01223  \textcolor{comment}{// Initialise timestepper}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01224}01224  \textcolor{keywordtype}{double} dt=0.05;}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01225}01225  problem.initialise\_dt(dt);}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01226}01226 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01227}01227  \textcolor{comment}{// Perform impulsive start}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01228}01228  problem.assign\_initial\_values\_impulsive();}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01229}01229 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01230}01230  \textcolor{comment}{// Output initial conditions}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01231}01231  problem.doc\_solution();}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01232}01232 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01233}01233  \textcolor{comment}{// Solve problem a few times on given mesh}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01234}01234  \textcolor{keywordtype}{unsigned} nstep=3;}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01235}01235  \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} i=0;i<nstep;i++)}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01236}01236   \{}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01237}01237    \textcolor{comment}{// Solve the problem}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01238}01238    problem.unsteady\_newton\_solve(dt);    }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01239}01239    problem.doc\_solution();}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01240}01240   \}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01241}01241 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01242}01242  \textcolor{comment}{// Now do a couple of adaptations}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01243}01243  \textcolor{keywordtype}{unsigned} ncycle=200;}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01244}01244  \textcolor{keywordflow}{if} (CommandLineArgs::command\_line\_flag\_has\_been\_set(\textcolor{stringliteral}{"{}-\/-\/validation"{}}))}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01245}01245   \{}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01246}01246    ncycle=1;}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01247}01247    oomph\_info << \textcolor{stringliteral}{"{}Only doing one cycle during validation\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01248}01248   \}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01249}01249 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01250}01250  \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j=0;j<ncycle;j++)}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01251}01251   \{       }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01252}01252    \textcolor{comment}{// Adapt the problem}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01253}01253    problem.adapt();}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01254}01254 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01255}01255    \textcolor{comment}{//Solve problem a few times}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01256}01256    \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} i=0;i<nstep;i++)}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01257}01257     \{     }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01258}01258      \textcolor{comment}{// Solve the problem}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01259}01259      problem.unsteady\_newton\_solve(dt);}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01260}01260      problem.doc\_solution();}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01261}01261     \}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01262}01262   \}}
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01263}01263 }
\DoxyCodeLine{\Hypertarget{jeffery__orbit_8cc_source_l01264}01264 \} \textcolor{comment}{//end of main}}

\end{DoxyCode}

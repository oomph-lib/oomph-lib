<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
<title>oomph-lib: refineable_two_layer_interface.cc Source File</title>
<link rel="apple-touch-icon" sizes="57x57" href="../../../figures/apple-touch-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="../../../figures/apple-touch-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="../../../figures/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="../../../figures/apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="../../../figures/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="../../../figures/apple-touch-icon-120x120.png">
<link rel="icon" type="image/png" href="../../../figures/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="../../../figures/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="../../../figures/favicon-16x16.png" sizes="16x16">
<link rel="manifest" href="../../../figures/manifest.json">
<link rel="mask-icon" href="../../../figures/safari-pinned-tab.svg" color="#008000">
<link rel="shortcut icon" href="../../../figures/favicon.ico">
<meta name="msapplication-TileColor" content="#00a300">
<meta name="msapplication-config" content="../../../figures/browserconfig.xml">
<meta name="theme-color" content="#008000">
<link href="http://fonts.googleapis.com/css?family=Open+Sans:400,300,600" rel="stylesheet" type="text/css">
<!-- Doxygen css-->
<!-- <link rel="stylesheet" type="text/css" href="doxygen.css"> -->
<!-- Bootstrap -->
<link href="../../../css/bootstrap.css" rel="stylesheet">
<!-- oomph-lib specific overrides -->
<link rel="stylesheet" type="text/css" href="../../../css/oomph_header.css">
</head>
<body>
<nav class="navbar navbar-default">
<div class="container">
<div class="container-fluid">
  <!-- Brand and toggle get grouped for better mobile display -->
  <div class="navbar-header">
    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
      <span class="sr-only">Toggle navigation</span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="../../../html/index.html"><img alt="oomph-lib" src="../../../figures/oomph_logo.png"></a>
  </div>
  <!-- Collect the nav links, forms, and other content for toggling -->
  <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
    <ul class="nav navbar-nav">          
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Documentation <span class="caret"></span></a>
        <ul class="dropdown-menu">
          <li class="dropdown-header">Big picture</li>
          <li><a href="../../../../doc/intro/html/index.html">The finite element method</a></li>
          <li><a href="../../../../doc/the_data_structure/html/index.html">The data structure</a></li>
          <li><a href="../../../../doc/quick_guide/html/index.html">Not-so-quick guide</a></li>
          <li><a href="../../../../doc/optimisation/html/index.html">Optimisation</a></li>
          <li><a href="../../../../doc/order_of_action_functions/html/index.html">Order of action functions</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Example codes and tutorials</li>
          <li><a href="../../../../doc/example_code_list/html/index.html">List of example codes and tutorials</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#meshes">Meshing</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#solvers">Solvers</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#parallel">MPI parallel processing</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#visualisation">Post-processing/visualisation</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Other</li>
          <li><a href="../../../../doc/change_log/html/index.html">Change log</a></li>
          <li><a href="../../../../doc/creating_doc/html/index.html">Creating documentation</a></li>
          <li><a href="../../../../doc/coding_conventions/html/index.html">Coding conventions</a></li>
          <li><a href="../../../../doc/index/html/index.html">Index</a></li>
          <li><a href="../../../../doc/FAQ/html/index.html">FAQ</a></li>
        </ul>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Get it <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../../doc/the_distribution/html/index.html">Installation guide</a></li>
            <li><a href="../../../../doc/subversion/html/index.html">Get code from subversion repository</a></li>
            <li><a href="../../../../doc/download/html/index.html">Get code as tar file</a></li>
            <li><a href="../../../../doc/copyright/html/index.html">Copyright</a></li>
          </ul>
        </li>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">About <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../../doc/people/html/index.html">People</a></li>            
            <li><a href="../../../../doc/contact/html/index.html">Contact/Get involved</a></li>
            <li><a href="../../../../doc/publications/html/index.html">Publications</a></li>
            <li><a href="../../../../doc/acknowledgements/html/index.html">Acknowledgements</a></li>
            <li><a href="../../../../doc/picture_show/index.html">Picture show</a></li>
          </ul>
        </li>
      </li>
    </ul>
    <ul class="nav navbar-nav navbar-right navbar-search">
      <form class="navbar-form" role="search" action="../../../../doc/search_results/html/index.html">
        <div class="input-group">
          <input type="text" class="form-control" placeholder="Search" name="q">
          <span class="input-group-btn">
            <button class="btn btn-default" type="submit">Go</button>
          </span>
        </div><!-- /input-group -->
       <!--<div class="form-group">
          <input type="text" class="form-control" placeholder="Search">
        </div>
        <button type="submit" class="btn btn-default">Submit</button>-->
      </form>
    </ul>
  </div><!-- /.navbar-collapse -->
</div><!-- /.container-fluid -->
</div>
</nav>
<!-- Generated by Doxygen 1.8.17 -->
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_ddb094a380b94394dbbcf95a63b535e6.html">demo_drivers</a></li><li class="navelem"><a class="el" href="dir_600eb748837abd3a599f824dcb8c690e.html">navier_stokes</a></li><li class="navelem"><a class="el" href="dir_c0a26ba0ab790636477cbd425673b84c.html">two_layer_interface</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">refineable_two_layer_interface.cc</div>  </div>
</div><!--header-->
<div class="contents">
<a href="refineable__two__layer__interface_8cc.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">//LIC// ====================================================================</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">//LIC// This file forms part of oomph-lib, the object-oriented, </span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">//LIC// multi-physics finite-element library, available </span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">//LIC// at http://www.oomph-lib.org.</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">//LIC// Copyright (C) 2006-2021 Matthias Heil and Andrew Hazel</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">//LIC// This library is free software; you can redistribute it and/or</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">//LIC// modify it under the terms of the GNU Lesser General Public</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">//LIC// License as published by the Free Software Foundation; either</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">//LIC// version 2.1 of the License, or (at your option) any later version.</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">//LIC// This library is distributed in the hope that it will be useful,</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">//LIC// but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">//LIC// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">//LIC// Lesser General Public License for more details.</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">//LIC// You should have received a copy of the GNU Lesser General Public</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">//LIC// License along with this library; if not, write to the Free Software</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">//LIC// Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">//LIC// 02110-1301  USA.</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">//LIC// The authors may be contacted at oomph-lib@maths.man.ac.uk.</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">//LIC//====================================================================</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160; </div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">//Generic routines</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#include &quot;generic.h&quot;</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160; </div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160; </div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment">// The equations</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#include &quot;navier_stokes.h&quot;</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#include &quot;solid.h&quot;</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#include &quot;constitutive.h&quot;</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#include &quot;fluid_interface.h&quot;</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160; </div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment">// The mesh</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="preprocessor">#include &quot;meshes/triangle_mesh.h&quot;</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160; </div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="keyword">using namespace </span>std;</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="keyword">using namespace </span><a class="code" href="namespaceoomph.html">oomph</a>;</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160; </div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160; </div>
<div class="line"><a name="l00044"></a><span class="lineno"><a class="line" href="namespaceoomph.html">   44</a></span>&#160;<span class="keyword">namespace </span><a class="code" href="namespaceoomph.html">oomph</a></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;{</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160; </div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160; </div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment">//==============================================================</span><span class="comment"></span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment">/// Overload CrouzeixRaviart element to modify output</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment"></span><span class="comment">//==============================================================</span></div>
<div class="line"><a name="l00051"></a><span class="lineno"><a class="line" href="classoomph_1_1MyCrouzeixRaviartElement.html">   51</a></span>&#160; <span class="keyword">class </span><a class="code" href="classoomph_1_1MyCrouzeixRaviartElement.html">MyCrouzeixRaviartElement</a> : </div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  <span class="keyword">public</span> <span class="keyword">virtual</span> PseudoSolidNodeUpdateElement&lt;TCrouzeixRaviartElement&lt;2&gt;, </div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  TPVDBubbleEnrichedElement&lt;2,3&gt; &gt;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160; {</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;  </div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160; <span class="keyword">private</span>:</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  <span class="comment"></span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment">  /// Storage for elemental error estimate -- used for post-processing</span></div>
<div class="line"><a name="l00059"></a><span class="lineno"><a class="line" href="classoomph_1_1MyCrouzeixRaviartElement.html#aac525f961951f5d621f141b4fcdda357">   59</a></span>&#160;<span class="comment"></span>  <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1MyCrouzeixRaviartElement.html#aac525f961951f5d621f141b4fcdda357">Error</a>;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160; </div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160; <span class="keyword">public</span>:</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment">  /// Constructor initialise error</span></div>
<div class="line"><a name="l00064"></a><span class="lineno"><a class="line" href="classoomph_1_1MyCrouzeixRaviartElement.html#a6719573c11157d360cb0a0fd0d2b92f4">   64</a></span>&#160;<span class="comment"></span>  <a class="code" href="classoomph_1_1MyCrouzeixRaviartElement.html#a6719573c11157d360cb0a0fd0d2b92f4">MyCrouzeixRaviartElement</a>() : PseudoSolidNodeUpdateElement&lt;TCrouzeixRaviartElement&lt;2&gt;, </div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;                                                            TPVDBubbleEnrichedElement&lt;2,3&gt; &gt;()</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;   {</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    Error=0.0;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;   }</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="comment">  /// Set error value for post-processing</span></div>
<div class="line"><a name="l00071"></a><span class="lineno"><a class="line" href="classoomph_1_1MyCrouzeixRaviartElement.html#a0b1ccbfb0eda6807c3a332aa0b6ea6e2">   71</a></span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1MyCrouzeixRaviartElement.html#a0b1ccbfb0eda6807c3a332aa0b6ea6e2">set_error</a>(<span class="keyword">const</span> <span class="keywordtype">double</span>&amp; error){Error=error;}</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  <span class="comment"></span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment">  /// Return variable identifier</span></div>
<div class="line"><a name="l00074"></a><span class="lineno"><a class="line" href="classoomph_1_1MyCrouzeixRaviartElement.html#afbec727a48f104b945cc54f798cbd1d3">   74</a></span>&#160;<span class="comment"></span>  std::string <a class="code" href="classoomph_1_1MyCrouzeixRaviartElement.html#afbec727a48f104b945cc54f798cbd1d3">variable_identifier</a>()</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;   {</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    std::string txt=<span class="stringliteral">&quot;VARIABLES=&quot;</span>;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    txt+=<span class="stringliteral">&quot;\&quot;x\&quot;,&quot;</span>;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    txt+=<span class="stringliteral">&quot;\&quot;y\&quot;,&quot;</span>;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    txt+=<span class="stringliteral">&quot;\&quot;u\&quot;,&quot;</span>;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    txt+=<span class="stringliteral">&quot;\&quot;v\&quot;,&quot;</span>;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    txt+=<span class="stringliteral">&quot;\&quot;p\&quot;,&quot;</span>;   </div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    txt+=<span class="stringliteral">&quot;\&quot;du/dt\&quot;,&quot;</span>;</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    txt+=<span class="stringliteral">&quot;\&quot;dv/dt\&quot;,&quot;</span>;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    txt+=<span class="stringliteral">&quot;\&quot;u_m\&quot;,&quot;</span>;   </div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    txt+=<span class="stringliteral">&quot;\&quot;v_m\&quot;,&quot;</span>;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    txt+=<span class="stringliteral">&quot;\&quot;x_h1\&quot;,&quot;</span>;</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    txt+=<span class="stringliteral">&quot;\&quot;y_h1\&quot;,&quot;</span>;   </div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    txt+=<span class="stringliteral">&quot;\&quot;x_h2\&quot;,&quot;</span>;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    txt+=<span class="stringliteral">&quot;\&quot;y_h2\&quot;,&quot;</span>;   </div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    txt+=<span class="stringliteral">&quot;\&quot;u_h1\&quot;,&quot;</span>;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    txt+=<span class="stringliteral">&quot;\&quot;v_h1\&quot;,&quot;</span>;   </div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    txt+=<span class="stringliteral">&quot;\&quot;u_h2\&quot;,&quot;</span>;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    txt+=<span class="stringliteral">&quot;\&quot;v_h2\&quot;,&quot;</span>;   </div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    txt+=<span class="stringliteral">&quot;\&quot;error\&quot;,&quot;</span>;   </div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    txt+=<span class="stringliteral">&quot;\&quot;size\&quot;,&quot;</span>;   </div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    txt+=<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <span class="keywordflow">return</span> txt;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;   }</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160; </div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  <span class="comment"></span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="comment">  /// Overload output function</span></div>
<div class="line"><a name="l00102"></a><span class="lineno"><a class="line" href="classoomph_1_1MyCrouzeixRaviartElement.html#ad1ea7115e6cb090d687ac421e56f4d16">  102</a></span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1MyCrouzeixRaviartElement.html#ad1ea7115e6cb090d687ac421e56f4d16">output</a>(std::ostream &amp;outfile, </div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;              <span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;nplot)</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;   {</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    </div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <span class="comment">// Assign dimension </span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <span class="keywordtype">unsigned</span> el_dim=2;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    </div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <span class="comment">// Vector of local coordinates</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    Vector&lt;double&gt; s(el_dim);</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    </div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <span class="comment">// Acceleration</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    Vector&lt;double&gt; dudt(el_dim);</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    </div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <span class="comment">// Mesh elocity</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    Vector&lt;double&gt; mesh_veloc(el_dim,0.0);</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;   </div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <span class="comment">// Tecplot header info</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    outfile &lt;&lt; tecplot_zone_string(nplot);</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;   </div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    <span class="comment">// Find out how many nodes there are</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <span class="keywordtype">unsigned</span> n_node = nnode();</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;   </div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <span class="comment">//Set up memory for the shape functions</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    Shape psif(n_node);</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    DShape dpsifdx(n_node,el_dim);</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;   </div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    <span class="comment">// Loop over plot points</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <span class="keywordtype">unsigned</span> num_plot_points=nplot_points(nplot);</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> iplot=0;iplot&lt;num_plot_points;iplot++)</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;     {</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;     </div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;      <span class="comment">// Get local coordinates of plot point</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;      get_s_plot(iplot,nplot,s);</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;     </div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;      <span class="comment">//Call the derivatives of the shape and test functions</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;      dshape_eulerian(s,psif,dpsifdx);</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;     </div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;      <span class="comment">//Allocate storage</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;      Vector&lt;double&gt; mesh_veloc(el_dim);</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;      Vector&lt;double&gt; dudt(el_dim);</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;      Vector&lt;double&gt; dudt_ALE(el_dim);</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;      DenseMatrix&lt;double&gt; interpolated_dudx(el_dim,el_dim);</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;     </div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;      <span class="comment">//Initialise everything to zero</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i=0;i&lt;el_dim;i++)</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;       {</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        mesh_veloc[i]=0.0;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        dudt[i]=0.0;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        dudt_ALE[i]=0.0;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> j=0;j&lt;el_dim;j++)</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;         {</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;          interpolated_dudx(i,j) = 0.0;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;         }</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;       }</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;     </div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;      <span class="comment">//Calculate velocities and derivatives</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160; </div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;      <span class="comment">//Loop over directions</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i=0;i&lt;el_dim;i++)</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;       {</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        <span class="comment">//Get the index at which velocity i is stored</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;        <span class="keywordtype">unsigned</span> u_nodal_index = u_index_nst(i);</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;        <span class="comment">// Loop over nodes</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l=0;l&lt;n_node;l++) </div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;         {</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;          dudt[i]+=du_dt_nst(l,u_nodal_index)*psif[l];</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;          mesh_veloc[i]+=dnodal_position_dt(l,i)*psif[l];</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;          </div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;          <span class="comment">//Loop over derivative directions for velocity gradients</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;          <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> j=0;j&lt;el_dim;j++)</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;           {                               </div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;            interpolated_dudx(i,j) += nodal_value(l,u_nodal_index)*</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;             dpsifdx(l,j);</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;           }</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;         }</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;       }</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;     </div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;     </div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;      <span class="comment">// Get dudt in ALE form (incl mesh veloc)</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i=0;i&lt;el_dim;i++)</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;       {</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;        dudt_ALE[i]=dudt[i];</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> k=0;k&lt;el_dim;k++)</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;         {</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;          dudt_ALE[i]-=mesh_veloc[k]*interpolated_dudx(i,k);</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;         }</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;       }</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;     </div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;     </div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;      <span class="comment">// Coordinates</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i=0;i&lt;el_dim;i++) </div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;       {</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;        outfile &lt;&lt; interpolated_x(s,i) &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;       }</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;     </div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;      <span class="comment">// Velocities</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i=0;i&lt;el_dim;i++) </div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;       {</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;        outfile &lt;&lt; interpolated_u_nst(s,i) &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;       }</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;     </div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;      <span class="comment">// Pressure</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;      outfile &lt;&lt; interpolated_p_nst(s)  &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;     </div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;      <span class="comment">// Accelerations</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i=0;i&lt;el_dim;i++) </div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;       {</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;        outfile &lt;&lt; dudt_ALE[i] &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;       }</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;     </div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;      <span class="comment">// Mesh velocity</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i=0;i&lt;el_dim;i++) </div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;       {</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;        outfile &lt;&lt; mesh_veloc[i] &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;       }</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;     </div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;      <span class="comment">// History values of coordinates</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;      <span class="keywordtype">unsigned</span> n_prev=node_pt(0)-&gt;position_time_stepper_pt()-&gt;ntstorage();</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> t=1;t&lt;n_prev;t++)</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;       {</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i=0;i&lt;el_dim;i++) </div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;         {</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;          outfile &lt;&lt; interpolated_x(t,s,i) &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;         }</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;       }</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;     </div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;      <span class="comment">// History values of velocities</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;      n_prev=node_pt(0)-&gt;time_stepper_pt()-&gt;ntstorage();</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> t=1;t&lt;n_prev;t++)</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;       {</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i=0;i&lt;el_dim;i++) </div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;         {</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;          outfile &lt;&lt; interpolated_u_nst(t,s,i) &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;         }</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;       }</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160; </div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;      outfile &lt;&lt; Error &lt;&lt; <span class="stringliteral">&quot; &quot;</span> </div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;              &lt;&lt; size() &lt;&lt; std::endl;        </div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;     }</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    </div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    <span class="comment">// Write tecplot footer (e.g. FE connectivity lists)</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    write_tecplot_zone_footer(outfile,nplot); </div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    }</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160; </div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160; };</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160; </div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160; </div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;<span class="comment">//=======================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;<span class="comment">/// Face geometry for element is the same as that for the underlying</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;<span class="comment">/// wrapped element</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;<span class="comment"></span><span class="comment">//=======================================================================</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160; <span class="keyword">template</span>&lt;&gt;</div>
<div class="line"><a name="l00254"></a><span class="lineno"><a class="line" href="classoomph_1_1FaceGeometry_3_01MyCrouzeixRaviartElement_01_4.html">  254</a></span>&#160; <span class="keyword">class </span>FaceGeometry&lt;<a class="code" href="classoomph_1_1MyCrouzeixRaviartElement.html">MyCrouzeixRaviartElement</a>&gt;</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;  : <span class="keyword">public</span> <span class="keyword">virtual</span> SolidTElement&lt;1,3&gt; </div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160; {</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160; <span class="keyword">public</span>:</div>
<div class="line"><a name="l00258"></a><span class="lineno"><a class="line" href="classoomph_1_1FaceGeometry_3_01MyCrouzeixRaviartElement_01_4.html#a28b4b942614e6cfee40e773deb3e3003">  258</a></span>&#160;  <a class="code" href="classoomph_1_1FaceGeometry_3_01MyCrouzeixRaviartElement_01_4.html#a28b4b942614e6cfee40e773deb3e3003">FaceGeometry</a>() : SolidTElement&lt;1,3&gt;() {}</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160; };</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160; </div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160; </div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="comment">//=======================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="comment">/// Face geometry of Face geometry for element is the same </span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="comment">/// as that for the underlying</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="comment">/// wrapped element</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="comment"></span><span class="comment">//=======================================================================</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160; <span class="keyword">template</span>&lt;&gt;</div>
<div class="line"><a name="l00268"></a><span class="lineno"><a class="line" href="classoomph_1_1FaceGeometry_3_01FaceGeometry_3_01MyCrouzeixRaviartElement_01_4_01_4.html">  268</a></span>&#160; <span class="keyword">class </span>FaceGeometry&lt;FaceGeometry&lt;<a class="code" href="classoomph_1_1MyCrouzeixRaviartElement.html">MyCrouzeixRaviartElement</a>&gt; &gt;</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;  : <span class="keyword">public</span> <span class="keyword">virtual</span> SolidPointElement </div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160; {</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160; <span class="keyword">public</span>:</div>
<div class="line"><a name="l00272"></a><span class="lineno"><a class="line" href="classoomph_1_1FaceGeometry_3_01FaceGeometry_3_01MyCrouzeixRaviartElement_01_4_01_4.html#ace1479da1535c271d7dc671dacbbdcca">  272</a></span>&#160;  <a class="code" href="classoomph_1_1FaceGeometry_3_01FaceGeometry_3_01MyCrouzeixRaviartElement_01_4_01_4.html#ace1479da1535c271d7dc671dacbbdcca">FaceGeometry</a>() : SolidPointElement() {}</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160; };</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160; </div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160; </div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;} <span class="comment">//End of namespace extension</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160; </div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160; </div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<span class="comment">///////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;<span class="comment">///////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;<span class="comment">///////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160; </div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;<span class="comment">//==start_of_namespace==============================</span><span class="comment"></span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;<span class="comment">/// Namespace for Problem Parameter</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;<span class="comment"></span><span class="comment">//==================================================</span></div>
<div class="line"><a name="l00288"></a><span class="lineno"><a class="line" href="namespaceProblem__Parameter.html">  288</a></span>&#160; <span class="keyword">namespace </span><a class="code" href="namespaceProblem__Parameter.html">Problem_Parameter</a></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160; {    <span class="comment"></span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;<span class="comment">  /// Doc info</span></div>
<div class="line"><a name="l00291"></a><span class="lineno"><a class="line" href="namespaceProblem__Parameter.html#a1dd3c6bcf97360c8fe0d288ca7610351">  291</a></span>&#160;<span class="comment"></span>  DocInfo <a class="code" href="namespaceProblem__Parameter.html#a1dd3c6bcf97360c8fe0d288ca7610351">Doc_info</a>;</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;  <span class="comment"></span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<span class="comment">  /// Reynolds number</span></div>
<div class="line"><a name="l00294"></a><span class="lineno"><a class="line" href="namespaceProblem__Parameter.html#acc656299287d4d9a8374c2c501750b4f">  294</a></span>&#160;<span class="comment"></span>  <span class="keywordtype">double</span> <a class="code" href="two__layer__interface_8txt.html#af738d67f78bdf64bc92c89e9596d14db">Re</a>=5.0;</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="comment">  /// Strouhal number</span></div>
<div class="line"><a name="l00297"></a><span class="lineno"><a class="line" href="namespaceProblem__Parameter.html#a8d9b76e390569bac0095bd0952281a30">  297</a></span>&#160;<span class="comment"></span>  <span class="keywordtype">double</span> <a class="code" href="two__layer__interface_8txt.html#ac97470a3d889ea4d3ec5e3a143ed0f2f">St</a> = 1.0;</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="comment">  /// Womersley number (Reynolds x Strouhal)</span></div>
<div class="line"><a name="l00300"></a><span class="lineno"><a class="line" href="namespaceProblem__Parameter.html#a1be099d26a4388edccc1592236dda50c">  300</a></span>&#160;<span class="comment"></span>  <span class="keywordtype">double</span> <a class="code" href="namespaceProblem__Parameter.html#a1be099d26a4388edccc1592236dda50c">ReSt</a> = 5.0;</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;  <span class="comment"></span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;<span class="comment">  /// Product of Reynolds number and inverse of Froude number</span></div>
<div class="line"><a name="l00303"></a><span class="lineno"><a class="line" href="namespaceProblem__Parameter.html#ab5e1078e81238be42d304c9cd3f7a9cc">  303</a></span>&#160;<span class="comment"></span>  <span class="keywordtype">double</span> <a class="code" href="namespaceProblem__Parameter.html#ab5e1078e81238be42d304c9cd3f7a9cc">ReInvFr</a> = 5.0;</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;  <span class="comment"></span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;<span class="comment">  /// \short Ratio of viscosity in upper fluid to viscosity in lower</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;<span class="comment">  /// fluid. Reynolds number etc. is based on viscosity in lower fluid.</span></div>
<div class="line"><a name="l00307"></a><span class="lineno"><a class="line" href="namespaceProblem__Parameter.html#ac643ff6a132687f67099ab5b35849c51">  307</a></span>&#160;<span class="comment"></span>  <span class="keywordtype">double</span> <a class="code" href="namespaceProblem__Parameter.html#ac643ff6a132687f67099ab5b35849c51">Viscosity_Ratio</a> = 0.1;</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;  <span class="comment"></span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;<span class="comment">  /// \short Ratio of density in upper fluid to density in lower</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;<span class="comment">  /// fluid. Reynolds number etc. is based on density in lower fluid.</span></div>
<div class="line"><a name="l00311"></a><span class="lineno"><a class="line" href="namespaceProblem__Parameter.html#a8cdfc2498b04d7887068b1daf03ba0e1">  311</a></span>&#160;<span class="comment"></span>  <span class="keywordtype">double</span> <a class="code" href="namespaceProblem__Parameter.html#a8cdfc2498b04d7887068b1daf03ba0e1">Density_Ratio</a> = 0.5;</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;  <span class="comment"></span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="comment">  /// Capillary number</span></div>
<div class="line"><a name="l00314"></a><span class="lineno"><a class="line" href="namespaceProblem__Parameter.html#af6194d2571881779c678fbabc1503d47">  314</a></span>&#160;<span class="comment"></span>  <span class="keywordtype">double</span> <a class="code" href="namespaceProblem__Parameter.html#af6194d2571881779c678fbabc1503d47">Ca</a> = 0.01; </div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="comment">  /// Direction of gravity</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="comment"></span>  Vector&lt;double&gt; <a class="code" href="namespaceProblem__Parameter.html#a7e5c502c4f97a31cc7d757c43d4b17e7">G</a>(2);</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;  <span class="comment"></span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;<span class="comment">  /// Pseudo-solid Poisson ratio</span></div>
<div class="line"><a name="l00320"></a><span class="lineno"><a class="line" href="namespaceProblem__Parameter.html#abec2e733c8f2d3c18ebc702b3f80cc17">  320</a></span>&#160;<span class="comment"></span>  <span class="keywordtype">double</span> <a class="code" href="namespaceProblem__Parameter.html#abec2e733c8f2d3c18ebc702b3f80cc17">Nu</a>=0.1;</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;<span class="comment">  /// \short Length of the channel</span></div>
<div class="line"><a name="l00323"></a><span class="lineno"><a class="line" href="namespaceProblem__Parameter.html#a7b67840fea463f29b53d12f7bd7cb34b">  323</a></span>&#160;<span class="comment"></span>  <span class="keywordtype">double</span> <a class="code" href="namespaceProblem__Parameter.html#a7b67840fea463f29b53d12f7bd7cb34b">Length</a> = 1.0;</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160; </div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;  <span class="comment">// Height of the channel</span></div>
<div class="line"><a name="l00326"></a><span class="lineno"><a class="line" href="namespaceProblem__Parameter.html#aef705e249abde5f1527cbc01497dcabb">  326</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="namespaceProblem__Parameter.html#aef705e249abde5f1527cbc01497dcabb">Height</a> = 2.0;</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;  </div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;  <span class="comment">// Relative Height of the interface</span></div>
<div class="line"><a name="l00329"></a><span class="lineno"><a class="line" href="namespaceProblem__Parameter.html#a0d53d8c976c13e0723304666b87324e1">  329</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="namespaceProblem__Parameter.html#a0d53d8c976c13e0723304666b87324e1">Interface_Height</a> = 0.5;</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;  <span class="comment"></span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;<span class="comment">  /// Constitutive law used to determine the mesh deformation</span></div>
<div class="line"><a name="l00332"></a><span class="lineno"><a class="line" href="namespaceProblem__Parameter.html#a9852a6077458693983628319d429f11f">  332</a></span>&#160;<span class="comment"></span>  ConstitutiveLaw *<a class="code" href="namespaceProblem__Parameter.html#a9852a6077458693983628319d429f11f">Constitutive_law_pt</a>=0;</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="comment">  /// Trace file</span></div>
<div class="line"><a name="l00335"></a><span class="lineno"><a class="line" href="namespaceProblem__Parameter.html#a55310be5f2dfcb5fcfe35d71f9c16e06">  335</a></span>&#160;<span class="comment"></span>  ofstream <a class="code" href="namespaceProblem__Parameter.html#a55310be5f2dfcb5fcfe35d71f9c16e06">Trace_file</a>;</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;<span class="comment">  /// \short File to document the norm of the solution (for validation </span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;<span class="comment">  /// purposes -- triangle doesn&#39;t give fully reproducible results so</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;<span class="comment">  /// mesh generation/adaptation may generate slightly different numbers</span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;<span class="comment">  /// of elements on different machines!)</span></div>
<div class="line"><a name="l00341"></a><span class="lineno"><a class="line" href="namespaceProblem__Parameter.html#a388e06a5e637b21378ab1832e5564bec">  341</a></span>&#160;<span class="comment"></span>  ofstream <a class="code" href="namespaceProblem__Parameter.html#a388e06a5e637b21378ab1832e5564bec">Norm_file</a>;</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160; </div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160; } <span class="comment">// end_of_namespace</span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160; </div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160; </div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160; </div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;<span class="comment">//==start_of_problem_class============================================</span><span class="comment"></span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;<span class="comment">/// Problem class to simulate viscous drop propagating along 2D channel</span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;<span class="comment"></span><span class="comment">//====================================================================</span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> ELEMENT&gt;</div>
<div class="line"><a name="l00351"></a><span class="lineno"><a class="line" href="classTwoLayerInterfaceProblem.html">  351</a></span>&#160;<span class="keyword">class </span><a class="code" href="classTwoLayerInterfaceProblem.html">TwoLayerInterfaceProblem</a> : <span class="keyword">public</span> Problem</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;{</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160; </div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;<span class="comment"> /// Constructor</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;<span class="comment"></span> <a class="code" href="classTwoLayerInterfaceProblem.html">TwoLayerInterfaceProblem</a>();</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;<span class="comment"> /// Destructor</span></div>
<div class="line"><a name="l00360"></a><span class="lineno"><a class="line" href="classTwoLayerInterfaceProblem.html#a5034f5c3d7ec8fd556b1af7f0c2351ef">  360</a></span>&#160;<span class="comment"></span> <a class="code" href="classTwoLayerInterfaceProblem.html#a5034f5c3d7ec8fd556b1af7f0c2351ef">~TwoLayerInterfaceProblem</a>()</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;  {</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;   <span class="comment">// Fluid timestepper</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;   <span class="keyword">delete</span> this-&gt;time_stepper_pt(0);</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160; </div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;   <span class="comment">// Kill data associated with outer boundary</span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;   <span class="keywordtype">unsigned</span> n=Outer_boundary_polyline_pt-&gt;npolyline();</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j=0;j&lt;n;j++)</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    {</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;     <span class="keyword">delete</span> Outer_boundary_polyline_pt-&gt;polyline_pt(j);</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    }</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;   <span class="keyword">delete</span> Outer_boundary_polyline_pt;</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;   </div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;   <span class="comment">// Flush element of free surface elements</span></div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;   delete_free_surface_elements();</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;   <span class="keyword">delete</span> Free_surface_mesh_pt;</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160; </div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;   <span class="comment">// Delete error estimator</span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;   <span class="keyword">delete</span> Fluid_mesh_pt-&gt;spatial_error_estimator_pt();</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160; </div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;   <span class="comment">// Delete fluid mesh</span></div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;   <span class="keyword">delete</span> Fluid_mesh_pt;</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160; </div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;   <span class="comment">// Delete the global pressure drop data</span></div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;   <span class="keyword">delete</span> Drop_pressure_data_pt;</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160; </div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;   <span class="comment">// Kill const eqn</span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;   <span class="keyword">delete</span> <a class="code" href="namespaceProblem__Parameter.html#a9852a6077458693983628319d429f11f">Problem_Parameter::Constitutive_law_pt</a>;</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160; </div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;  }</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160; </div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;<span class="comment"> /// Actions before adapt: Wipe the mesh of free surface elements</span></div>
<div class="line"><a name="l00393"></a><span class="lineno"><a class="line" href="classTwoLayerInterfaceProblem.html#a89431a4ad9400976c295c4cfd04b3727">  393</a></span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classTwoLayerInterfaceProblem.html#a89431a4ad9400976c295c4cfd04b3727">actions_before_adapt</a>()</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;  {</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;   <span class="comment">// Kill the  elements and wipe surface mesh</span></div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;   delete_free_surface_elements();</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160; </div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;   <span class="comment">// Rebuild the Problem&#39;s global mesh from its various sub-meshes</span></div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;   this-&gt;rebuild_global_mesh();</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;  </div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;  }<span class="comment">// end of actions_before_adapt</span></div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160; </div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;<span class="comment"> /// Actions after adapt: Rebuild the mesh of free surface elements</span></div>
<div class="line"><a name="l00405"></a><span class="lineno"><a class="line" href="classTwoLayerInterfaceProblem.html#a496c283472765b000a0348137c1b560b">  405</a></span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classTwoLayerInterfaceProblem.html#a496c283472765b000a0348137c1b560b">actions_after_adapt</a>()</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;  {</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;   <span class="comment">// Create the elements that impose the displacement constraint </span></div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;   create_free_surface_elements();</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160; </div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;   <span class="comment">// Rebuild the Problem&#39;s global mesh from its various sub-meshes</span></div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;   this-&gt;rebuild_global_mesh();</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;   </div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;   <span class="comment">// Setup the problem again -- remember that fluid mesh has been</span></div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;   <span class="comment">// completely rebuilt and its element&#39;s don&#39;t have any</span></div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;   <span class="comment">// pointers to Re etc. yet</span></div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;   complete_problem_setup();</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;   </div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;  }<span class="comment">// end of actions_after_adapt</span></div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160; </div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;<span class="comment"> /// Update the after solve (empty)</span></div>
<div class="line"><a name="l00422"></a><span class="lineno"><a class="line" href="classTwoLayerInterfaceProblem.html#aa3798e4cbf4cfebf7652aea3fd2fbdff">  422</a></span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classTwoLayerInterfaceProblem.html#aa3798e4cbf4cfebf7652aea3fd2fbdff">actions_after_newton_solve</a>(){}</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;<span class="comment"> /// Update the problem specs before solve </span></div>
<div class="line"><a name="l00425"></a><span class="lineno"><a class="line" href="classTwoLayerInterfaceProblem.html#aa34b7c3a13847571a9fedc2465daab30">  425</a></span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classTwoLayerInterfaceProblem.html#aa34b7c3a13847571a9fedc2465daab30">actions_before_newton_solve</a>()</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;  {</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;   <span class="comment">//Reset the Lagrangian coordinates of the nodes to be the current</span></div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;   <span class="comment">//Eulerian coordinates -- this makes the current configuration</span></div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;   <span class="comment">//stress free</span></div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;   Fluid_mesh_pt-&gt;set_lagrangian_nodal_coordinates();</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;  }</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;<span class="comment"> /// \short Set boundary conditions and complete the build of all elements</span></div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> complete_problem_setup();</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;<span class="comment"> /// Doc the solution</span></div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> doc_solution(<span class="keyword">const</span> std::string&amp; comment=<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;<span class="comment"> /// Compute the error estimates and assign to elements for plotting</span></div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> compute_error_estimate(<span class="keywordtype">double</span>&amp; max_err,</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;                             <span class="keywordtype">double</span>&amp; min_err);</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;<span class="comment">/// Set the initial conditions</span></div>
<div class="line"><a name="l00444"></a><span class="lineno"><a class="line" href="classTwoLayerInterfaceProblem.html#ac2852a90a68b7cde5c6d04f79d029047">  444</a></span>&#160;<span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="classTwoLayerInterfaceProblem.html#ac2852a90a68b7cde5c6d04f79d029047">set_initial_condition</a>()</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;{</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160; <span class="comment">// Determine number of nodes in mesh</span></div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160; <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_node = Fluid_mesh_pt-&gt;nnode();</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160; </div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160; <span class="comment">// Loop over all nodes in mesh</span></div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160; <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> n=0;n&lt;n_node;n++)</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;  {</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;   <span class="comment">// Loop over the two velocity components</span></div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i=0;i&lt;2;i++)</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    {</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;     <span class="comment">// Set velocity component i of node n to zero</span></div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;     Fluid_mesh_pt-&gt;node_pt(n)-&gt;set_value(i,0.0);</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    }</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;  }</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160; </div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160; <span class="comment">// Initialise the previous velocity values for timestepping</span></div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160; <span class="comment">// corresponding to an impulsive start</span></div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160; assign_initial_values_impulsive();</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160; </div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;} <span class="comment">// End of set_initial_condition</span></div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160; </div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160; </div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160; </div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;<span class="comment"> /// Function to deform the interface</span></div>
<div class="line"><a name="l00470"></a><span class="lineno"><a class="line" href="classTwoLayerInterfaceProblem.html#adac700fd7368550b91620a7f79091857">  470</a></span>&#160;<span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="classTwoLayerInterfaceProblem.html#adac700fd7368550b91620a7f79091857">deform_interface</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> &amp;<a class="code" href="two__layer__interface_8txt.html#a12ad175f862d3fe119900bd546c618c2">epsilon</a>,<span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;n_periods)</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;  {</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;   <span class="comment">// Determine number of nodes in the &quot;bulk&quot; mesh</span></div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_node = Fluid_mesh_pt-&gt;nnode();</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160; </div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160; <span class="comment">// Loop over all nodes in mesh</span></div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160; <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> n=0;n&lt;n_node;n++)</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;  {</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;   <span class="comment">// Determine eulerian position of node</span></div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">double</span> current_x_pos = Fluid_mesh_pt-&gt;node_pt(n)-&gt;x(0);</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">double</span> current_y_pos = Fluid_mesh_pt-&gt;node_pt(n)-&gt;x(1);</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;   </div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;   <span class="comment">// Determine new vertical position of node</span></div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">double</span> new_y_pos = current_y_pos</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    + (1.0-fabs(1.0-current_y_pos))*<a class="code" href="two__layer__interface_8txt.html#a12ad175f862d3fe119900bd546c618c2">epsilon</a></div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    *(cos(2.0*n_periods*MathematicalConstants::Pi*current_x_pos/<a class="code" href="namespaceProblem__Parameter.html#a7b67840fea463f29b53d12f7bd7cb34b">Problem_Parameter::Length</a>));</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;   </div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;   <span class="comment">// Set new position</span></div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;   Fluid_mesh_pt-&gt;node_pt(n)-&gt;x(1) = new_y_pos;</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;  }</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;} <span class="comment">// End of deform_interface</span></div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160; </div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160; </div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;<span class="comment"> /// Fix pressure in element e at pressure dof pdof and set to pvalue</span></div>
<div class="line"><a name="l00495"></a><span class="lineno"><a class="line" href="classTwoLayerInterfaceProblem.html#a81589b120683037dc07ab9251bf81e85">  495</a></span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classTwoLayerInterfaceProblem.html#a81589b120683037dc07ab9251bf81e85">fix_pressure</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;e,</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;                   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;pdof, </div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;                   <span class="keyword">const</span> <span class="keywordtype">double</span> &amp;pvalue)</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;  {</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;   <span class="comment">// Fix the pressure at that element</span></div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;   <span class="keyword">dynamic_cast&lt;</span>ELEMENT*<span class="keyword">&gt;</span>(Fluid_mesh_pt-&gt;element_pt(e))-&gt;</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;                          fix_pressure(pdof,pvalue);</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;  }</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160; </div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160; </div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160; </div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;<span class="comment"> /// \short Create free surface elements</span></div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> create_free_surface_elements();</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;<span class="comment"> /// \short Delete free surface elements </span></div>
<div class="line"><a name="l00512"></a><span class="lineno"><a class="line" href="classTwoLayerInterfaceProblem.html#a474a9ea9fda21eb1cddf79809b2de6d4">  512</a></span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classTwoLayerInterfaceProblem.html#a474a9ea9fda21eb1cddf79809b2de6d4">delete_free_surface_elements</a>()</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;  {</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;   <span class="comment">// How many surface elements are in the surface mesh</span></div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;   <span class="keywordtype">unsigned</span> n_element = Free_surface_mesh_pt-&gt;nelement();</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;   </div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;   <span class="comment">// Loop over the surface elements</span></div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> e=0;e&lt;n_element;e++)</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;    {</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;     <span class="comment">// Kill surface element</span></div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;     <span class="keyword">delete</span> Free_surface_mesh_pt-&gt;element_pt(e);</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;    }</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;  </div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160; </div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;   <span class="comment">// Wipe the mesh</span></div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;   Free_surface_mesh_pt-&gt;flush_element_and_node_storage();</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;   </div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160; </div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;  } <span class="comment">// end of delete_free_surface_elements</span></div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160; </div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;<span class="comment"> /// Pointers to mesh of free surface elements</span></div>
<div class="line"><a name="l00533"></a><span class="lineno"><a class="line" href="classTwoLayerInterfaceProblem.html#a406dd9cb8b718773530a3d1170bece96">  533</a></span>&#160;<span class="comment"></span> Mesh* <a class="code" href="classTwoLayerInterfaceProblem.html#a406dd9cb8b718773530a3d1170bece96">Free_surface_mesh_pt</a>;</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160; </div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;<span class="comment"> /// Pointer to Fluid_mesh</span></div>
<div class="line"><a name="l00537"></a><span class="lineno"><a class="line" href="classTwoLayerInterfaceProblem.html#accfab13c26afb181d320bd5dc25ed878">  537</a></span>&#160;<span class="comment"></span> RefineableSolidTriangleMesh&lt;ELEMENT&gt;* <a class="code" href="classTwoLayerInterfaceProblem.html#accfab13c26afb181d320bd5dc25ed878">Fluid_mesh_pt</a>;</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;<span class="comment"> /// Vector storing pointer to the drop polygons</span></div>
<div class="line"><a name="l00540"></a><span class="lineno"><a class="line" href="classTwoLayerInterfaceProblem.html#ac3c380cea3010fcf83b41d854e4595f9">  540</a></span>&#160;<span class="comment"></span> Vector&lt;TriangleMeshPolygon*&gt; <a class="code" href="classTwoLayerInterfaceProblem.html#ac3c380cea3010fcf83b41d854e4595f9">Drop_polygon_pt</a>;</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;<span class="comment"> /// Triangle mesh polygon for outer boundary </span></div>
<div class="line"><a name="l00543"></a><span class="lineno"><a class="line" href="classTwoLayerInterfaceProblem.html#ade0bdb2267a9fdbab1bea08fc2d87104">  543</a></span>&#160;<span class="comment"></span> TriangleMeshPolygon* <a class="code" href="classTwoLayerInterfaceProblem.html#ade0bdb2267a9fdbab1bea08fc2d87104">Outer_boundary_polyline_pt</a>; </div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;<span class="comment"> /// Pointer to a global drop pressure datum</span></div>
<div class="line"><a name="l00546"></a><span class="lineno"><a class="line" href="classTwoLayerInterfaceProblem.html#ae9d05acfe4e978cdfd727afb4f27969f">  546</a></span>&#160;<span class="comment"></span> Data* <a class="code" href="classTwoLayerInterfaceProblem.html#ae9d05acfe4e978cdfd727afb4f27969f">Drop_pressure_data_pt</a>;</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;<span class="comment"> /// Backed up drop pressure between adaptations</span></div>
<div class="line"><a name="l00549"></a><span class="lineno"><a class="line" href="classTwoLayerInterfaceProblem.html#afa49f2cb784a03dfb93d33d678cfc1f9">  549</a></span>&#160;<span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="classTwoLayerInterfaceProblem.html#afa49f2cb784a03dfb93d33d678cfc1f9">Initial_value_for_drop_pressure</a>;</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;<span class="comment"> /// Pointer to hijacked element</span></div>
<div class="line"><a name="l00552"></a><span class="lineno"><a class="line" href="classTwoLayerInterfaceProblem.html#a12d0b30397350f3a6dcf56d67216d6ff">  552</a></span>&#160;<span class="comment"></span> ELEMENT* <a class="code" href="classTwoLayerInterfaceProblem.html#a12d0b30397350f3a6dcf56d67216d6ff">Hijacked_element_pt</a>;</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;<span class="comment"> /// Bool to indicate if volume constraint is applied (only for steady run)</span></div>
<div class="line"><a name="l00555"></a><span class="lineno"><a class="line" href="classTwoLayerInterfaceProblem.html#add2bdae31e9372250c62608f1a30fdc4">  555</a></span>&#160;<span class="comment"></span> <span class="keywordtype">bool</span> <a class="code" href="classTwoLayerInterfaceProblem.html#add2bdae31e9372250c62608f1a30fdc4">Use_volume_constraint</a>;</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;<span class="comment"> /// Enumeration of channel boundaries</span></div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;<span class="comment"></span> <span class="keyword">enum</span> </div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160; {</div>
<div class="line"><a name="l00560"></a><span class="lineno"><a class="line" href="classTwoLayerInterfaceProblem.html#ad9d1e892e0530f82166a932c24ec5843a582586eb71c1946acb7c015f522ca25a">  560</a></span>&#160;  Inflow_boundary_id=0,</div>
<div class="line"><a name="l00561"></a><span class="lineno"><a class="line" href="classTwoLayerInterfaceProblem.html#ad9d1e892e0530f82166a932c24ec5843ab1b61715cc4516f188fd88dc95877254">  561</a></span>&#160;  Upper_wall_boundary_id=1,</div>
<div class="line"><a name="l00562"></a><span class="lineno"><a class="line" href="classTwoLayerInterfaceProblem.html#ad9d1e892e0530f82166a932c24ec5843a23dd316467ea3d5ee5f372bb76fbe0ed">  562</a></span>&#160;  Outflow_boundary_id=2,</div>
<div class="line"><a name="l00563"></a><span class="lineno"><a class="line" href="classTwoLayerInterfaceProblem.html#ad9d1e892e0530f82166a932c24ec5843a9df123da5b21353b2a8400c70f3d4328">  563</a></span>&#160;  Bottom_wall_boundary_id=3,</div>
<div class="line"><a name="l00564"></a><span class="lineno"><a class="line" href="classTwoLayerInterfaceProblem.html#ad9d1e892e0530f82166a932c24ec5843a0252430699fd738de92b51854db0e932">  564</a></span>&#160;  Interface_boundary_id=4,</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160; };</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160; </div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160; </div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;}; <span class="comment">// end_of_problem_class</span></div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160; </div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160; </div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;<span class="comment">//==start_constructor=====================================================</span><span class="comment"></span></div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;<span class="comment">/// Constructor</span></div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;<span class="comment"></span><span class="comment">//========================================================================</span></div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> ELEMENT&gt;</div>
<div class="line"><a name="l00575"></a><span class="lineno"><a class="line" href="classTwoLayerInterfaceProblem.html#abf42cfea7dd731795995051c1de78a32">  575</a></span>&#160;<a class="code" href="classTwoLayerInterfaceProblem.html#abf42cfea7dd731795995051c1de78a32">TwoLayerInterfaceProblem&lt;ELEMENT&gt;::TwoLayerInterfaceProblem</a>()</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;{ </div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160; <span class="comment">// Output directory</span></div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160; <a class="code" href="namespaceProblem__Parameter.html#a1dd3c6bcf97360c8fe0d288ca7610351">Problem_Parameter::Doc_info</a>.set_directory(<span class="stringliteral">&quot;RESLT&quot;</span>);</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160; </div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160; <span class="comment">// Allocate the timestepper -- this constructs the Problem&#39;s </span></div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160; <span class="comment">// time object with a sufficient amount of storage to store the</span></div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160; <span class="comment">// previous timsteps. </span></div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160; this-&gt;add_time_stepper_pt(<span class="keyword">new</span> BDF&lt;2&gt;);</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160; </div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160; <span class="comment">// Build the boundary segments for outer boundary, consisting of</span></div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160; <span class="comment">//--------------------------------------------------------------</span></div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160; <span class="comment">// four separate polylines</span></div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160; <span class="comment">//------------------------</span></div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160; Vector&lt;TriangleMeshCurveSection*&gt; boundary_polyline_pt(4);</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160; </div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160; <span class="comment">// Each polyline only has three vertices -- provide storage for their</span></div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160; <span class="comment">// coordinates</span></div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160; Vector&lt;Vector&lt;double&gt; &gt; vertex_coord(3);</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160; <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i=0;i&lt;3;i++)</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;  {</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;   vertex_coord[i].resize(2);</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;  }</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160; </div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160; <span class="keyword">const</span> <span class="keywordtype">double</span> H = <a class="code" href="namespaceProblem__Parameter.html#aef705e249abde5f1527cbc01497dcabb">Problem_Parameter::Height</a>;</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160; <span class="keyword">const</span> <span class="keywordtype">double</span> h = <a class="code" href="namespaceProblem__Parameter.html#a0d53d8c976c13e0723304666b87324e1">Problem_Parameter::Interface_Height</a>*H;</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160; </div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160; <span class="comment">// First polyline: Inflow</span></div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160; vertex_coord[0][0]=0.0;</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160; vertex_coord[0][1]=0.0;</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160; vertex_coord[1][0]=0.0;</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160; vertex_coord[1][1]= h;</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160; vertex_coord[2][0]=0.0;</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160; vertex_coord[2][1]= H;</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160; </div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160; <span class="comment">// Build the 1st boundary polyline</span></div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160; boundary_polyline_pt[0] = <span class="keyword">new</span> TriangleMeshPolyLine(vertex_coord,</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;                                                   Inflow_boundary_id);</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160; </div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160; <span class="comment">// Second boundary polyline: Upper wall</span></div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160; vertex_coord[0][0]=0.0;</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160; vertex_coord[0][1]=H;</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160; vertex_coord[1][0]=0.5*<a class="code" href="namespaceProblem__Parameter.html#a7b67840fea463f29b53d12f7bd7cb34b">Problem_Parameter::Length</a>;</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160; vertex_coord[1][1]=H;</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160; vertex_coord[2][0]=<a class="code" href="namespaceProblem__Parameter.html#a7b67840fea463f29b53d12f7bd7cb34b">Problem_Parameter::Length</a>;</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160; vertex_coord[2][1]=H;</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160; </div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160; <span class="comment">// Build the 2nd boundary polyline</span></div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160; boundary_polyline_pt[1] = <span class="keyword">new</span> TriangleMeshPolyLine(vertex_coord,</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;                                                   Upper_wall_boundary_id);</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160; </div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160; <span class="comment">// Third boundary polyline: Outflow</span></div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160; vertex_coord[0][0]=<a class="code" href="namespaceProblem__Parameter.html#a7b67840fea463f29b53d12f7bd7cb34b">Problem_Parameter::Length</a>;</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160; vertex_coord[0][1]=H;</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160; vertex_coord[1][0]=<a class="code" href="namespaceProblem__Parameter.html#a7b67840fea463f29b53d12f7bd7cb34b">Problem_Parameter::Length</a>;</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160; vertex_coord[1][1]=h;</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160; vertex_coord[2][0]=<a class="code" href="namespaceProblem__Parameter.html#a7b67840fea463f29b53d12f7bd7cb34b">Problem_Parameter::Length</a>;</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160; vertex_coord[2][1]=0.0;</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160; </div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160; <span class="comment">// Build the 3rd boundary polyline</span></div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160; boundary_polyline_pt[2] = <span class="keyword">new</span> TriangleMeshPolyLine(vertex_coord,</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;                                                   Outflow_boundary_id);</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160; </div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160; <span class="comment">// Fourth boundary polyline: Bottom wall</span></div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160; vertex_coord[0][0]=<a class="code" href="namespaceProblem__Parameter.html#a7b67840fea463f29b53d12f7bd7cb34b">Problem_Parameter::Length</a>;</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160; vertex_coord[0][1]=0.0;</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160; vertex_coord[1][0]=0.5*<a class="code" href="namespaceProblem__Parameter.html#a7b67840fea463f29b53d12f7bd7cb34b">Problem_Parameter::Length</a>;</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160; vertex_coord[1][1]=0.0;</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160; vertex_coord[2][0]=0.0;</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160; vertex_coord[2][1]=0.0;</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160; </div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160; <span class="comment">// Build the 4th boundary polyline</span></div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160; boundary_polyline_pt[3] = <span class="keyword">new</span> TriangleMeshPolyLine(vertex_coord,</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;                                                    Bottom_wall_boundary_id);</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160; </div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160; <span class="comment">// Create the triangle mesh polygon for outer boundary</span></div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160; Outer_boundary_polyline_pt = <span class="keyword">new</span> TriangleMeshPolygon(boundary_polyline_pt);</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160; </div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160; <span class="comment">//Here we need to put the dividing internal line in</span></div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160; Vector&lt;TriangleMeshOpenCurve *&gt; interface_pt(1);</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160; <span class="comment">//Set the vertex coordinates</span></div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160; vertex_coord[0][0]=0.0;</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160; vertex_coord[0][1]=h;</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160; vertex_coord[1][0]=0.5*<a class="code" href="namespaceProblem__Parameter.html#a7b67840fea463f29b53d12f7bd7cb34b">Problem_Parameter::Length</a>;</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160; vertex_coord[1][1]=h;</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160; vertex_coord[2][0]=<a class="code" href="namespaceProblem__Parameter.html#a7b67840fea463f29b53d12f7bd7cb34b">Problem_Parameter::Length</a>;</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160; vertex_coord[2][1]=h;</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160; </div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;<span class="comment">//Create the internal line</span></div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;  TriangleMeshPolyLine* interface_polyline_pt =</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;   <span class="keyword">new</span> TriangleMeshPolyLine(vertex_coord,</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;                            Interface_boundary_id);</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160; </div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;  <span class="comment">// Do the connection with the destination boundary, in this case</span></div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;  <span class="comment">// the connection is done with the inflow boundary</span></div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;  interface_polyline_pt-&gt;connect_initial_vertex_to_polyline(</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;   <span class="keyword">dynamic_cast&lt;</span>TriangleMeshPolyLine*<span class="keyword">&gt;</span>(boundary_polyline_pt[0]),1);</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160; </div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;  <span class="comment">// Do the connection with the destination boundary, in this case</span></div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;  <span class="comment">// the connection is done with the outflow boundary</span></div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;  interface_polyline_pt-&gt;connect_final_vertex_to_polyline(</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;   <span class="keyword">dynamic_cast&lt;</span>TriangleMeshPolyLine*<span class="keyword">&gt;</span>(boundary_polyline_pt[2]),1);</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160; </div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;  Vector&lt;TriangleMeshCurveSection*&gt; interface_curve_pt(1);</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;  interface_curve_pt[0] = interface_polyline_pt;</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;  </div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;  interface_pt[0] = <span class="keyword">new</span> TriangleMeshOpenCurve(interface_curve_pt);</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;  </div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160; <span class="comment">// Now build the mesh, based on the boundaries specified by</span></div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160; <span class="comment">//---------------------------------------------------------</span></div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160; <span class="comment">// polygons just created</span></div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160; <span class="comment">//----------------------</span></div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160; </div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160; <span class="comment">// Convert to &quot;closed curve&quot; objects</span></div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160; TriangleMeshClosedCurve* outer_closed_curve_pt=Outer_boundary_polyline_pt;</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160; </div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160; <span class="keywordtype">unsigned</span> n_internal_closed_boundaries = 0;</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160; Vector&lt;TriangleMeshClosedCurve *&gt;</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;  inner_boundaries_pt(n_internal_closed_boundaries);</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160; </div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160; <span class="comment">// Target area for initial mesh</span></div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160; <span class="keywordtype">double</span> uniform_element_area=0.01;</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160; </div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160; <span class="comment">// Use the TriangleMeshParameter object for gathering all</span></div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160; <span class="comment">// the necessary arguments for the TriangleMesh object</span></div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160; TriangleMeshParameters triangle_mesh_parameters(</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;   outer_closed_curve_pt);</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160; </div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160; <span class="comment">//Define the inner boundaries</span></div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160; triangle_mesh_parameters.internal_closed_curve_pt() = inner_boundaries_pt;</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160; </div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160; <span class="comment">// Define the holes on the boundary</span></div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160; triangle_mesh_parameters.internal_open_curves_pt() = interface_pt;</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160; </div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160; <span class="comment">// Define the maximum element area</span></div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160; triangle_mesh_parameters.element_area() =</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;   uniform_element_area;</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160; </div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160; Vector&lt;double&gt; lower_region(2);</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160; lower_region[0] = 0.5*<a class="code" href="namespaceProblem__Parameter.html#a7b67840fea463f29b53d12f7bd7cb34b">Problem_Parameter::Length</a>;</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160; lower_region[1] = 0.5*<a class="code" href="namespaceProblem__Parameter.html#a0d53d8c976c13e0723304666b87324e1">Problem_Parameter::Interface_Height</a>;</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160; </div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160; <span class="comment">// Define the region</span></div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160; triangle_mesh_parameters.add_region_coordinates(1, lower_region);</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160; </div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160; <span class="comment">// Create the mesh</span></div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160; Fluid_mesh_pt =</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;   <span class="keyword">new</span> RefineableSolidTriangleMesh&lt;ELEMENT&gt;(</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;     triangle_mesh_parameters, this-&gt;time_stepper_pt());</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160; </div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160; <span class="comment">// Set error estimator for bulk mesh</span></div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160; Z2ErrorEstimator* error_estimator_pt=<span class="keyword">new</span> Z2ErrorEstimator;</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160; Fluid_mesh_pt-&gt;spatial_error_estimator_pt()=error_estimator_pt;</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160; </div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160; <span class="comment">// Set targets for spatial adaptivity</span></div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160; Fluid_mesh_pt-&gt;max_permitted_error()=0.005;</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160; Fluid_mesh_pt-&gt;min_permitted_error()=0.001;  </div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160; Fluid_mesh_pt-&gt;max_element_size()=0.2;</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160; Fluid_mesh_pt-&gt;min_element_size()=0.001; </div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160; </div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160; <span class="comment">// Use coarser mesh during validation</span></div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160; <span class="keywordflow">if</span> (CommandLineArgs::command_line_flag_has_been_set(<span class="stringliteral">&quot;--validation&quot;</span>))</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;  {</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;   Fluid_mesh_pt-&gt;min_element_size()=0.01; </div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;  }</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160; </div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160; <span class="comment">// Output boundary and mesh initial mesh for information</span></div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160; this-&gt;Fluid_mesh_pt-&gt;output_boundaries(<span class="stringliteral">&quot;boundaries.dat&quot;</span>);</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160; this-&gt;Fluid_mesh_pt-&gt;output(<span class="stringliteral">&quot;mesh.dat&quot;</span>);</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160; </div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160; <span class="comment">// Set boundary condition and complete the build of all elements</span></div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160; complete_problem_setup();</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160; </div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160; <span class="comment">// Construct the mesh of free surface elements</span></div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160; Free_surface_mesh_pt=<span class="keyword">new</span> Mesh;</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160; create_free_surface_elements();</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160; </div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160; <span class="comment">// Combine meshes</span></div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160; <span class="comment">//---------------</span></div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160; </div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160; <span class="comment">// Add Fluid_mesh_pt sub meshes</span></div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160; this-&gt;add_sub_mesh(Fluid_mesh_pt);</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160; </div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160; <span class="comment">// Add Free_surface sub meshes</span></div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160; this-&gt;add_sub_mesh(this-&gt;Free_surface_mesh_pt);</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160; </div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160; <span class="comment">// Build global mesh</span></div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160; this-&gt;build_global_mesh();</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;  </div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160; <span class="comment">// Setup equation numbering scheme</span></div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160; cout &lt;&lt;<span class="stringliteral">&quot;Number of equations: &quot;</span> &lt;&lt; this-&gt;assign_eqn_numbers() &lt;&lt; std::endl;</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160; </div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;} <span class="comment">// end_of_constructor</span></div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160; </div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160; </div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;<span class="comment">//============start_of_create_free_surface_elements===============</span><span class="comment"></span></div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;<span class="comment">/// Create elements that impose the kinematic and dynamic bcs</span></div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;<span class="comment">/// for the pseudo-solid fluid mesh</span></div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;<span class="comment"></span><span class="comment">//=======================================================================</span></div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> ELEMENT&gt;</div>
<div class="line"><a name="l00775"></a><span class="lineno"><a class="line" href="classTwoLayerInterfaceProblem.html#a94c52097a6333dd830449ce83b512a4f">  775</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classTwoLayerInterfaceProblem.html#a94c52097a6333dd830449ce83b512a4f">TwoLayerInterfaceProblem&lt;ELEMENT&gt;::create_free_surface_elements</a>()</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;{ </div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160; </div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160; <span class="comment">//Loop over the free surface boundaries</span></div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160; <span class="keywordtype">unsigned</span> nb=Fluid_mesh_pt-&gt;nboundary();</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160; <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> b=4;b&lt;nb;b++)</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;  {</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;   <span class="comment">// Note: region is important</span></div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;   <span class="comment">// How many bulk fluid elements are adjacent to boundary b in region 0?</span></div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;   <span class="keywordtype">unsigned</span> n_element = Fluid_mesh_pt-&gt;nboundary_element_in_region(b,0);</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;   </div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;   <span class="comment">// Loop over the bulk fluid elements adjacent to boundary b?</span></div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> e=0;e&lt;n_element;e++)</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;    {</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;     <span class="comment">// Get pointer to the bulk fluid element that is </span></div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;     <span class="comment">// adjacent to boundary b in region 0</span></div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;     ELEMENT* bulk_elem_pt = <span class="keyword">dynamic_cast&lt;</span>ELEMENT*<span class="keyword">&gt;</span>(</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;      Fluid_mesh_pt-&gt;boundary_element_in_region_pt(b,0,e));</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;     </div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;     <span class="comment">//Find the index of the face of element e along boundary b in region 0</span></div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;     <span class="keywordtype">int</span> face_index = Fluid_mesh_pt-&gt;face_index_at_boundary_in_region(b,0,e);</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;     </div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;     <span class="comment">// Create new element</span></div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;     ElasticLineFluidInterfaceElement&lt;ELEMENT&gt;* el_pt =</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;      <span class="keyword">new</span> ElasticLineFluidInterfaceElement&lt;ELEMENT&gt;(</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;       bulk_elem_pt,face_index);   </div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;     </div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;     <span class="comment">// Add it to the mesh</span></div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;     Free_surface_mesh_pt-&gt;add_element_pt(el_pt);</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;     </div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;     <span class="comment">//Add the appropriate boundary number</span></div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;     el_pt-&gt;set_boundary_number_in_bulk_mesh(b);</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160; </div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;     <span class="comment">//Specify the Strouhal number</span></div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;     el_pt-&gt;st_pt() = &amp;<a class="code" href="namespaceProblem__Parameter.html#a8d9b76e390569bac0095bd0952281a30">Problem_Parameter::St</a>;</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;     </div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;     <span class="comment">//Specify the capillary number</span></div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;     el_pt-&gt;ca_pt() = &amp;<a class="code" href="namespaceProblem__Parameter.html#af6194d2571881779c678fbabc1503d47">Problem_Parameter::Ca</a>;</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;    }</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;  }</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;}</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;<span class="comment">// end of create_free_surface_elements</span></div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160; </div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160; </div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160; </div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160; </div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;<span class="comment">//==start_of_complete_problem_setup=======================================</span><span class="comment"></span></div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;<span class="comment">/// Set boundary conditions and complete the build of all elements</span></div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;<span class="comment"></span><span class="comment">//========================================================================</span></div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> ELEMENT&gt;</div>
<div class="line"><a name="l00825"></a><span class="lineno"><a class="line" href="classTwoLayerInterfaceProblem.html#a96392e407b2c1f5fc295fe423404c943">  825</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classTwoLayerInterfaceProblem.html#a96392e407b2c1f5fc295fe423404c943">TwoLayerInterfaceProblem&lt;ELEMENT&gt;::complete_problem_setup</a>()</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;  {      </div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;   <span class="comment">// Re-set the boundary conditions for fluid problem: All nodes are</span></div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;   <span class="comment">// free by default -- just pin the ones that have Dirichlet conditions</span></div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;   <span class="comment">// here. </span></div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;   <span class="keywordtype">unsigned</span> nbound=Fluid_mesh_pt-&gt;nboundary();</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> ibound=0;ibound&lt;nbound;ibound++)</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;    {</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;     <span class="keywordtype">unsigned</span> num_nod=Fluid_mesh_pt-&gt;nboundary_node(ibound);</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> inod=0;inod&lt;num_nod;inod++)</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;      {</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;       <span class="comment">// Get node</span></div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;       Node* nod_pt=Fluid_mesh_pt-&gt;boundary_node_pt(ibound,inod);</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;      </div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;       <span class="comment">//Pin both velocities on side boundaries (1 and 3)</span></div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;       <span class="keywordflow">if</span>((ibound==1) || (ibound==3))</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;        {</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;         nod_pt-&gt;pin(0);</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;         nod_pt-&gt;pin(1);</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;        }</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;      </div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;       <span class="comment">//If it&#39;s the inflow or outflow pin only the horizontal velocity</span></div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;       <span class="keywordflow">if</span>((ibound==0) || (ibound==2)) {nod_pt-&gt;pin(0);}</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;       </div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;       <span class="comment">// Pin horizontal pseudo-solid positions</span></div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;       SolidNode* solid_node_pt = <span class="keyword">dynamic_cast&lt;</span>SolidNode*<span class="keyword">&gt;</span>(nod_pt);</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;       solid_node_pt-&gt;pin_position(0);</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160; </div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;       <span class="comment">//Pin the vertical position on the upper and lower walls</span></div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;       <span class="keywordflow">if</span>((ibound==1) || (ibound==3))</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;        {</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;         solid_node_pt-&gt;pin_position(1);</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;        }</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;       <span class="keywordflow">else</span></div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;        {</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;         solid_node_pt-&gt;unpin_position(1);</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;        }</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;      } <span class="comment">//End of loop over nodes</span></div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;    } <span class="comment">// end loop over boundaries</span></div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;   </div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;   <span class="comment">// Complete the build of all elements so they are fully functional</span></div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;   <span class="comment">// Remember that adaptation for triangle meshes involves a complete</span></div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;   <span class="comment">// regneration of the mesh (rather than splitting as in tree-based</span></div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;   <span class="comment">// meshes where such parameters can be passed down from the father</span></div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;   <span class="comment">// element!)</span></div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;   <span class="keywordtype">unsigned</span> n_element = Fluid_mesh_pt-&gt;nelement();</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> e=0;e&lt;n_element;e++)</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;    {</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;     <span class="comment">// Upcast from GeneralisedElement to the present element</span></div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;     ELEMENT* el_pt = <span class="keyword">dynamic_cast&lt;</span>ELEMENT*<span class="keyword">&gt;</span>(Fluid_mesh_pt-&gt;element_pt(e));</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;     </div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;     <span class="comment">// Set the Reynolds number</span></div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;     el_pt-&gt;re_pt() = &amp;<a class="code" href="namespaceProblem__Parameter.html#acc656299287d4d9a8374c2c501750b4f">Problem_Parameter::Re</a>;</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160; </div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;     <span class="comment">// Set the Womersley number (same as Re since St=1)</span></div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;     el_pt-&gt;re_st_pt() = &amp;<a class="code" href="namespaceProblem__Parameter.html#a1be099d26a4388edccc1592236dda50c">Problem_Parameter::ReSt</a>;</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;     </div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;     <span class="comment">// Set the product of the Reynolds number and the inverse of the</span></div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;     <span class="comment">// Froude number</span></div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;     el_pt-&gt;re_invfr_pt() = &amp;<a class="code" href="namespaceProblem__Parameter.html#ab5e1078e81238be42d304c9cd3f7a9cc">Problem_Parameter::ReInvFr</a>;</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;     </div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;     <span class="comment">// Set the direction of gravity</span></div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;     el_pt-&gt;g_pt() = &amp;<a class="code" href="namespaceProblem__Parameter.html#a7e5c502c4f97a31cc7d757c43d4b17e7">Problem_Parameter::G</a>;</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;     </div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;     <span class="comment">// Set the constitutive law for pseudo-elastic mesh deformation</span></div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;     el_pt-&gt;constitutive_law_pt()=<a class="code" href="namespaceProblem__Parameter.html#a9852a6077458693983628319d429f11f">Problem_Parameter::Constitutive_law_pt</a>;</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;    }</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160; </div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;   <span class="comment">//For the elements in the upper region (region 0),</span></div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;   <span class="comment">//set the viscosity ratio</span></div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;   n_element = Fluid_mesh_pt-&gt;nregion_element(1);</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> e=0;e&lt;n_element;e++)</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;    {</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;     <span class="comment">// Upcast from GeneralisedElement to the present element</span></div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;     ELEMENT* el_pt = </div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;      <span class="keyword">dynamic_cast&lt;</span>ELEMENT*<span class="keyword">&gt;</span>(Fluid_mesh_pt-&gt;region_element_pt(1,e));</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;     </div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;     el_pt-&gt;viscosity_ratio_pt() = &amp;<a class="code" href="namespaceProblem__Parameter.html#ac643ff6a132687f67099ab5b35849c51">Problem_Parameter::Viscosity_Ratio</a>;</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160; </div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;     el_pt-&gt;density_ratio_pt() = &amp;<a class="code" href="namespaceProblem__Parameter.html#a8cdfc2498b04d7887068b1daf03ba0e1">Problem_Parameter::Density_Ratio</a>;</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;    }</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160; </div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;   </div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;   <span class="comment">// Re-apply boundary values on Dirichlet boundary conditions </span></div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;   <span class="comment">// (Boundary conditions are ignored when the solution is transferred</span></div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;   <span class="comment">// from the old to the new mesh by projection; this leads to a slight</span></div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;   <span class="comment">// change in the boundary values (which are, of course, never changed,</span></div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;   <span class="comment">// unlike the actual unknowns for which the projected values only</span></div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;   <span class="comment">// serve as an initial guess)</span></div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160; </div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;   <span class="comment">// Set velocity and history values of velocity on walls</span></div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;   nbound=this-&gt;Fluid_mesh_pt-&gt;nboundary();</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> ibound=0;ibound&lt;nbound;++ibound)</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;    {</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;     <span class="comment">// Loop over nodes on this boundary</span></div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;     <span class="keywordtype">unsigned</span> num_nod=this-&gt;Fluid_mesh_pt-&gt;nboundary_node(ibound);</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> inod=0;inod&lt;num_nod;inod++)</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;      {</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;       <span class="comment">// Get node</span></div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;       Node* nod_pt=this-&gt;Fluid_mesh_pt-&gt;boundary_node_pt(ibound,inod);</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;       </div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;       <span class="comment">// Get number of previous (history) values</span></div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;       <span class="keywordtype">unsigned</span> n_prev=nod_pt-&gt;time_stepper_pt()-&gt;nprev_values();</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160; </div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;       <span class="comment">//If we are on the upper or lower walls</span></div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;       <span class="comment">// Velocity is and was zero at all previous times</span></div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;       <span class="keywordflow">if</span>((ibound==1) || (ibound==3))</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;        {</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;         <span class="comment">//Loop over time history values</span></div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;         <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> t=0;t&lt;=n_prev;t++)</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;          {</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;           nod_pt-&gt;set_value(t,0,0.0); </div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;           nod_pt-&gt;set_value(t,1,0.0);</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;           </div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;           <span class="comment">// Nodes have always been there...</span></div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;           nod_pt-&gt;x(t,0)=nod_pt-&gt;x(0,0);</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;           nod_pt-&gt;x(t,1)=nod_pt-&gt;x(0,1);</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;          }</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;        }</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;       <span class="comment">//If we are on the side wals there is no horizontal velocity or</span></div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;       <span class="comment">//change in horizontal position</span></div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;       <span class="keywordflow">if</span>((ibound==0) || (ibound==2))</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;        {</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;         <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> t=0;t&lt;=n_prev;t++)</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;          {</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;           nod_pt-&gt;set_value(t,0,0.0); </div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;           <span class="comment">// Nodes have always been there...</span></div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;           nod_pt-&gt;x(t,0)=nod_pt-&gt;x(0,0);</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;          }</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;        }</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;       <span class="comment">//But there is a change in vertical position!</span></div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;      }</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;    } <span class="comment">//End of loop over boundaries</span></div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;   </div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;   fix_pressure(0,0,0.0);</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160; </div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;  }</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160; </div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160; </div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160; </div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;<span class="comment">//==start_of_doc_solution=================================================</span><span class="comment"></span></div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;<span class="comment">/// Doc the solution</span></div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;<span class="comment"></span><span class="comment">//========================================================================</span></div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> ELEMENT&gt;</div>
<div class="line"><a name="l00969"></a><span class="lineno"><a class="line" href="classTwoLayerInterfaceProblem.html#a234f5fe08dbb1286868cf6b1eff7c6a3">  969</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classTwoLayerInterfaceProblem.html#a234f5fe08dbb1286868cf6b1eff7c6a3">TwoLayerInterfaceProblem&lt;ELEMENT&gt;::doc_solution</a>(<span class="keyword">const</span> std::string&amp; comment)</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;{</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160; </div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160; <span class="comment">// Output the time</span></div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160; cout &lt;&lt; <span class="stringliteral">&quot;Time is now &quot;</span> &lt;&lt; time_pt()-&gt;time() &lt;&lt; std::endl;</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160; </div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160; <span class="keywordtype">double</span> min_x_coordinate = 2.0;</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160; <span class="keywordtype">unsigned</span> min_boundary_node = 0;</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160; <span class="comment">//Find the left-most node on the boundary</span></div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160; <span class="keywordtype">unsigned</span> n_bound = Fluid_mesh_pt-&gt;nboundary_node(4);</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160; <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> n=0;n&lt;n_bound;++n)</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;  {</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;   Node* nod_pt = Fluid_mesh_pt-&gt;boundary_node_pt(4,n);</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;   <span class="keywordflow">if</span>(nod_pt-&gt;x(0) &lt; min_x_coordinate)</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;    {</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;     min_x_coordinate = nod_pt-&gt;x(0);</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;     min_boundary_node = n;</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;    }</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;  }</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160; </div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160; <span class="comment">// Document time and vertical position of left hand side of interface</span></div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160; <span class="comment">// in trace file</span></div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160; <a class="code" href="namespaceProblem__Parameter.html#a55310be5f2dfcb5fcfe35d71f9c16e06">Problem_Parameter::Trace_file</a></div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;  &lt;&lt; time_pt()-&gt;time() &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;  &lt;&lt; Fluid_mesh_pt-&gt;boundary_node_pt(4,min_boundary_node)-&gt;x(1) &lt;&lt; std::endl;</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160; </div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160; ofstream some_file;</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160; <span class="keywordtype">char</span> filename[100];</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160; </div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160; <span class="comment">// Set number of plot points (in each coordinate direction)</span></div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160; <span class="keyword">const</span> <span class="keywordtype">unsigned</span> npts = 5;</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160; </div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160; <span class="comment">// Open solution output file</span></div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160; sprintf(filename,<span class="stringliteral">&quot;%s/soln%i.dat&quot;</span>,</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;         <a class="code" href="namespaceProblem__Parameter.html#a1dd3c6bcf97360c8fe0d288ca7610351">Problem_Parameter::Doc_info</a>.directory().c_str(),</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;         <a class="code" href="namespaceProblem__Parameter.html#a1dd3c6bcf97360c8fe0d288ca7610351">Problem_Parameter::Doc_info</a>.number());</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160; some_file.open(filename);</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160; </div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160; <span class="comment">// Output solution to file</span></div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160; Fluid_mesh_pt-&gt;output(some_file,npts);</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160; </div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160; <span class="comment">// Close solution output file</span></div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160; some_file.close();</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160; </div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160; <span class="comment">// Open interface solution output file</span></div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160; sprintf(filename,<span class="stringliteral">&quot;%s/interface_soln%i.dat&quot;</span>,</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;         <a class="code" href="namespaceProblem__Parameter.html#a1dd3c6bcf97360c8fe0d288ca7610351">Problem_Parameter::Doc_info</a>.directory().c_str(),</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;         <a class="code" href="namespaceProblem__Parameter.html#a1dd3c6bcf97360c8fe0d288ca7610351">Problem_Parameter::Doc_info</a>.number());</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160; some_file.open(filename);</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160; </div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160; <span class="comment">// Output solution to file</span></div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160; Free_surface_mesh_pt-&gt;output(some_file,npts);</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160; </div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160; <span class="comment">// Close solution output file</span></div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160; some_file.close();</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160; </div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160; <span class="comment">// Increment the doc_info number</span></div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160; <a class="code" href="namespaceProblem__Parameter.html#a1dd3c6bcf97360c8fe0d288ca7610351">Problem_Parameter::Doc_info</a>.number()++;</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;}</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160; </div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;<span class="comment">//========================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;<span class="comment">/// Compute error estimates and assign to elements for plotting</span></div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;<span class="comment"></span><span class="comment">//========================================================================</span></div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> ELEMENT&gt;</div>
<div class="line"><a name="l01033"></a><span class="lineno"><a class="line" href="classTwoLayerInterfaceProblem.html#a87ef8df1cf7f548b19f14163a085370f"> 1033</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classTwoLayerInterfaceProblem.html#a87ef8df1cf7f548b19f14163a085370f">TwoLayerInterfaceProblem&lt;ELEMENT&gt;::compute_error_estimate</a>(<span class="keywordtype">double</span>&amp; max_err,</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;                                                             <span class="keywordtype">double</span>&amp; min_err)</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;{ </div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160; <span class="comment">// Get error estimator</span></div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160; ErrorEstimator* err_est_pt=Fluid_mesh_pt-&gt;spatial_error_estimator_pt();</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160; </div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160; <span class="comment">// Get/output error estimates</span></div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160; <span class="keywordtype">unsigned</span> nel=Fluid_mesh_pt-&gt;nelement();</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160; Vector&lt;double&gt; elemental_error(nel);</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160; </div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160; <span class="comment">// We need a dynamic cast, get_element_errors from the Fluid_mesh_pt</span></div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160; <span class="comment">// Dynamic cast is used because get_element_errors require a Mesh* ans</span></div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160; <span class="comment">// not a SolidMesh*</span></div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160; Mesh* fluid_mesh_pt=<span class="keyword">dynamic_cast&lt;</span>Mesh*<span class="keyword">&gt;</span>(Fluid_mesh_pt);</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160; err_est_pt-&gt;get_element_errors(fluid_mesh_pt,</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;                                elemental_error);</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160; </div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160; <span class="comment">// Set errors for post-processing and find extrema</span></div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160; max_err=0.0;</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160; min_err=DBL_MAX;</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160; <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> e=0;e&lt;nel;e++)</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;  {</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;   <span class="keyword">dynamic_cast&lt;</span><a class="code" href="classoomph_1_1MyCrouzeixRaviartElement.html">MyCrouzeixRaviartElement</a>*<span class="keyword">&gt;</span>(Fluid_mesh_pt-&gt;element_pt(e))-&gt;</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;    set_error(elemental_error[e]);</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160; </div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;   max_err=std::max(max_err,elemental_error[e]);</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;   min_err=std::min(min_err,elemental_error[e]);</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;  }</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;  </div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;}</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160; </div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160; </div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;<span class="comment">//============================================================</span><span class="comment"></span></div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;<span class="comment">///Driver code for moving block problem</span></div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;<span class="comment"></span><span class="comment">//============================================================</span></div>
<div class="line"><a name="l01068"></a><span class="lineno"><a class="line" href="refineable__two__layer__interface_8cc.html#a3c04138a5bfe5d72780bb7e82a18e627"> 1068</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="refineable__two__layer__interface_8cc.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a>(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv)</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;{</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160; </div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160; <span class="comment">// Store command line arguments</span></div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160; CommandLineArgs::setup(argc,argv);</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160; </div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160; <span class="comment">// Define possible command line arguments and parse the ones that</span></div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160; <span class="comment">// were actually specified</span></div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160; </div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160; <span class="comment">// Validation?</span></div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160; CommandLineArgs::specify_command_line_flag(<span class="stringliteral">&quot;--validation&quot;</span>);</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160; </div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160; <span class="comment">// Parse command line</span></div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160; CommandLineArgs::parse_and_assign(); </div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160; </div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160; <span class="comment">// Doc what has actually been specified on the command line</span></div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160; CommandLineArgs::doc_specified_flags();</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160; </div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160; <span class="comment">// Create generalised Hookean constitutive equations</span></div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160; <a class="code" href="namespaceProblem__Parameter.html#a9852a6077458693983628319d429f11f">Problem_Parameter::Constitutive_law_pt</a> = </div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;  <span class="keyword">new</span> GeneralisedHookean(&amp;<a class="code" href="namespaceProblem__Parameter.html#abec2e733c8f2d3c18ebc702b3f80cc17">Problem_Parameter::Nu</a>);</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160; </div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160; <a class="code" href="namespaceProblem__Parameter.html#a7e5c502c4f97a31cc7d757c43d4b17e7">Problem_Parameter::G</a>[0] = 0.0;</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160; <a class="code" href="namespaceProblem__Parameter.html#a7e5c502c4f97a31cc7d757c43d4b17e7">Problem_Parameter::G</a>[1] = -1.0;</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160; </div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160; <span class="comment">// Create problem in initial configuration</span></div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160; <a class="code" href="classTwoLayerInterfaceProblem.html">TwoLayerInterfaceProblem</a>&lt;Hijacked&lt;ProjectableCrouzeixRaviartElement&lt;</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160; <a class="code" href="classoomph_1_1MyCrouzeixRaviartElement.html">MyCrouzeixRaviartElement</a>&gt; &gt; &gt; <a class="code" href="two__layer__interface_8txt.html#a4074baada03976c061d5672f4237cca5">problem</a>;  </div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160; </div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160; <span class="comment">// Set value of epsilon</span></div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160; <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="two__layer__interface_8txt.html#a12ad175f862d3fe119900bd546c618c2">epsilon</a> = 0.1;</div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160; </div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160; <span class="comment">// Set number of periods for cosine term</span></div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160; <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_periods = 1;</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160; </div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160; <span class="keyword">const</span> <span class="keywordtype">double</span> dt = 0.0025;</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160; </div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160; <span class="keywordtype">double</span> t_max = 0.6;</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160; </div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160; <span class="comment">// Deform the mesh/free surface</span></div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160; <a class="code" href="two__layer__interface_8txt.html#a4074baada03976c061d5672f4237cca5">problem</a>.deform_interface(<a class="code" href="two__layer__interface_8txt.html#a12ad175f862d3fe119900bd546c618c2">epsilon</a>,n_periods);</div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160; </div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160; <span class="comment">// Open trace file</span></div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160; <span class="keywordtype">char</span> filename[100];   </div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160; sprintf(filename,<span class="stringliteral">&quot;%s/trace.dat&quot;</span>,<a class="code" href="namespaceProblem__Parameter.html#a1dd3c6bcf97360c8fe0d288ca7610351">Problem_Parameter::Doc_info</a>.directory().c_str());</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160; <a class="code" href="namespaceProblem__Parameter.html#a55310be5f2dfcb5fcfe35d71f9c16e06">Problem_Parameter::Trace_file</a>.open(filename);</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160; </div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160; <span class="comment">// Initialise trace file</span></div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160; <a class="code" href="namespaceProblem__Parameter.html#a55310be5f2dfcb5fcfe35d71f9c16e06">Problem_Parameter::Trace_file</a> &lt;&lt; <span class="stringliteral">&quot;time, interface height&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160; </div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160; <span class="comment">// Initialise timestep</span></div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160; <a class="code" href="two__layer__interface_8txt.html#a4074baada03976c061d5672f4237cca5">problem</a>.initialise_dt(dt);</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160; </div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160; <span class="comment">// Set initial condition</span></div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160; <a class="code" href="two__layer__interface_8txt.html#a4074baada03976c061d5672f4237cca5">problem</a>.set_initial_condition();</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160; </div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160; <span class="comment">// Maximum number of spatial adaptations per timestep</span></div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160; <span class="keywordtype">unsigned</span> max_adapt = 2;</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160; </div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160; <span class="comment">// Doc initial solution</span></div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160; <a class="code" href="two__layer__interface_8txt.html#a4074baada03976c061d5672f4237cca5">problem</a>.doc_solution();</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160; </div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160; <span class="comment">// Determine number of timesteps</span></div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160; <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_timestep = unsigned(t_max/dt);</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160; </div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160; <span class="comment">// Are we on the first timestep? At this point, yes!</span></div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160; <span class="keywordtype">bool</span> first_timestep = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160; </div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160; <span class="comment">// Timestepping loop</span></div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160; <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> t=1;t&lt;=n_timestep;t++)</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;  {</div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;   <span class="comment">// Output current timestep to screen</span></div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;   cout &lt;&lt; <span class="stringliteral">&quot;\nTimestep &quot;</span> &lt;&lt; t &lt;&lt; <span class="stringliteral">&quot; of &quot;</span> &lt;&lt; n_timestep &lt;&lt; std::endl;</div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;   </div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;   <span class="comment">// Take one fixed timestep with spatial adaptivity</span></div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;   <a class="code" href="two__layer__interface_8txt.html#a4074baada03976c061d5672f4237cca5">problem</a>.unsteady_newton_solve(dt,max_adapt,first_timestep);</div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160; </div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;   <span class="comment">// No longer on first timestep, so set first_timestep flag to false</span></div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;   first_timestep = <span class="keyword">false</span>; </div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160; </div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;   <span class="comment">// Reset maximum number of adaptations for all future timesteps</span></div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;   max_adapt = 1;</div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160; </div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;   <span class="comment">// Doc solution</span></div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;   <a class="code" href="two__layer__interface_8txt.html#a4074baada03976c061d5672f4237cca5">problem</a>.doc_solution();</div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160; </div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;  } <span class="comment">// End of timestepping loop</span></div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160; </div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160; </div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;} <span class="comment">//End of main</span></div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="atwo__layer__interface_8txt_html_a12ad175f862d3fe119900bd546c618c2"><div class="ttname"><a href="two__layer__interface_8txt.html#a12ad175f862d3fe119900bd546c618c2">epsilon</a></div><div class="ttdeci">qquad R_ E[eqn:kinematicBC] f and the dynamic condition f[\tau_{ij}^{[2]} \, n_j^{[1]}=\tau_{ij}^{[1]} \, n_j^{[1]}+\frac{1}{Ca} \, \kappa \, n_i^{[1]}.\ \ \ \ \ \ \ \ \ \ @E[eqn:dynamicBC]@\f] The stress tensor in the lower fluid is defined as f[\tau_{ij}^{[1]}=-p^{[1]} \, \delta_{ij}+\left(\frac{\partial u^{ epsilon[1]}_i}{\partial x_j}+\frac{\partial u^{[1]}_j}{\partial x_i}\right),\ \ \ \ \ \ \ \ \ \ @E[eqn:stresstensorlower]@\f] and that in the upper fluid is defined as f[\tau_{ij}^{[2]}=-p^{[2]} \, \delta_{ij}+R_\mu \left(\frac{\partial u^{[2]}_i}{\partial x_j}+\frac{\partial u^{[2]}_j}{\partial x_i}\right).\ \ \ \ \ \ \ \ \ \ @E[eqn:stresstensorupper]@\f] The initial shape of the interface is defined by f[\mathbf{R}=x_1 \, \mathbf{i}+\left[1.0+\epsilon\cos\left(2 n \pi x_1 \right)\right] \, \mathbf{j},\ \ \ \ \ \ \ \ \ \ @E[eqn:interfacedeformation]@\f] where f epsilon f is the amplitude of the initial deflection and f n f is an integer&lt;/TD &gt;&lt;/TR &gt;&lt;/TABLE &gt;&lt;/CENTER &gt;&lt; HR &gt;&lt; HR &gt; section results Results The figure below shows a contour plot of the pressure distribution taken from&lt; A HREF=&quot;../figures/two_layer_interface.avi&quot;&gt; an animation of the flow for the parameters f f R_ f R_ but the motion is damped as the energy in the system is dissipated through viscous forces Eventually the interface settles down to its equilibrium as can be seen in the following time trace of the height of the interface at the left hand edge of the and we present the results in the figure below For sufficiently small f epsilon ll we can linearise the governing equations and obtain a dispersion relation f the derivation of which is discussed in the&lt; A HREF=&quot;../../single_layer_free_surface/html/index.html#validation&quot;&gt; previous tutorial&lt;/A &gt; The only difference in this two layer case is that the linear system which needs to be solved contains nine unknowns rather than since the two fluids have different properties The real and imaginary parts of f lambda f correspond to the growth rate and the frequency of the oscillating interface and can be compared to numerical results computed for given values of the wavenumber f k f We choose an initial deflection amplitude of f</div><div class="ttdef"><b>Definition:</b> <a href="two__layer__interface_8txt_source.html#l00238">two_layer_interface.txt:238</a></div></div>
<div class="ttc" id="aclassTwoLayerInterfaceProblem_html_a234f5fe08dbb1286868cf6b1eff7c6a3"><div class="ttname"><a href="classTwoLayerInterfaceProblem.html#a234f5fe08dbb1286868cf6b1eff7c6a3">TwoLayerInterfaceProblem::doc_solution</a></div><div class="ttdeci">void doc_solution(const std::string &amp;comment=&quot;&quot;)</div><div class="ttdoc">Doc the solution.</div><div class="ttdef"><b>Definition:</b> <a href="refineable__two__layer__interface_8cc_source.html#l00969">refineable_two_layer_interface.cc:969</a></div></div>
<div class="ttc" id="aclassTwoLayerInterfaceProblem_html_a496c283472765b000a0348137c1b560b"><div class="ttname"><a href="classTwoLayerInterfaceProblem.html#a496c283472765b000a0348137c1b560b">TwoLayerInterfaceProblem::actions_after_adapt</a></div><div class="ttdeci">void actions_after_adapt()</div><div class="ttdoc">Actions after adapt: Rebuild the mesh of free surface elements.</div><div class="ttdef"><b>Definition:</b> <a href="refineable__two__layer__interface_8cc_source.html#l00405">refineable_two_layer_interface.cc:405</a></div></div>
<div class="ttc" id="anamespaceProblem__Parameter_html"><div class="ttname"><a href="namespaceProblem__Parameter.html">Problem_Parameter</a></div><div class="ttdoc">Namespace for Problem Parameter.</div><div class="ttdef"><b>Definition:</b> <a href="refineable__two__layer__interface_8cc_source.html#l00288">refineable_two_layer_interface.cc:288</a></div></div>
<div class="ttc" id="aclassTwoLayerInterfaceProblem_html_aa3798e4cbf4cfebf7652aea3fd2fbdff"><div class="ttname"><a href="classTwoLayerInterfaceProblem.html#aa3798e4cbf4cfebf7652aea3fd2fbdff">TwoLayerInterfaceProblem::actions_after_newton_solve</a></div><div class="ttdeci">void actions_after_newton_solve()</div><div class="ttdoc">Update the after solve (empty)</div><div class="ttdef"><b>Definition:</b> <a href="refineable__two__layer__interface_8cc_source.html#l00422">refineable_two_layer_interface.cc:422</a></div></div>
<div class="ttc" id="aclassTwoLayerInterfaceProblem_html_a94c52097a6333dd830449ce83b512a4f"><div class="ttname"><a href="classTwoLayerInterfaceProblem.html#a94c52097a6333dd830449ce83b512a4f">TwoLayerInterfaceProblem::create_free_surface_elements</a></div><div class="ttdeci">void create_free_surface_elements()</div><div class="ttdoc">Create free surface elements.</div><div class="ttdef"><b>Definition:</b> <a href="refineable__two__layer__interface_8cc_source.html#l00775">refineable_two_layer_interface.cc:775</a></div></div>
<div class="ttc" id="anamespaceProblem__Parameter_html_a8cdfc2498b04d7887068b1daf03ba0e1"><div class="ttname"><a href="namespaceProblem__Parameter.html#a8cdfc2498b04d7887068b1daf03ba0e1">Problem_Parameter::Density_Ratio</a></div><div class="ttdeci">double Density_Ratio</div><div class="ttdoc">Ratio of density in upper fluid to density in lower fluid. Reynolds number etc. is based on density i...</div><div class="ttdef"><b>Definition:</b> <a href="refineable__two__layer__interface_8cc_source.html#l00311">refineable_two_layer_interface.cc:311</a></div></div>
<div class="ttc" id="atwo__layer__interface_8txt_html_af738d67f78bdf64bc92c89e9596d14db"><div class="ttname"><a href="two__layer__interface_8txt.html#af738d67f78bdf64bc92c89e9596d14db">Re</a></div><div class="ttdeci">qquad R_ E[eqn:kinematicBC] f and the dynamic condition f[\tau_{ij}^{[2]} \, n_j^{[1]}=\tau_{ij}^{[1]} \, n_j^{[1]}+\frac{1}{Ca} \, \kappa \, n_i^{[1]}.\ \ \ \ \ \ \ \ \ \ @E[eqn:dynamicBC]@\f] The stress tensor in the lower fluid is defined as f[\tau_{ij}^{[1]}=-p^{[1]} \, \delta_{ij}+\left(\frac{\partial u^{ Re[1]}_i}{\partial x_j}+\frac{\partial u^{[1]}_j}{\partial x_i}\right),\ \ \ \ \ \ \ \ \ \ @E[eqn:stresstensorlower]@\f] and that in the upper fluid is defined as f[\tau_{ij}^{[2]}=-p^{[2]} \, \delta_{ij}+R_\mu \left(\frac{\partial u^{[2]}_i}{\partial x_j}+\frac{\partial u^{[2]}_j}{\partial x_i}\right).\ \ \ \ \ \ \ \ \ \ @E[eqn:stresstensorupper]@\f] The initial shape of the interface is defined by f[\mathbf{R}=x_1 \, \mathbf{i}+\left[1.0+\epsilon\cos\left(2 n \pi x_1 \right)\right] \, \mathbf{j},\ \ \ \ \ \ \ \ \ \ @E[eqn:interfacedeformation]@\f] where f epsilon f is the amplitude of the initial deflection and f n f is an integer&lt;/TD &gt;&lt;/TR &gt;&lt;/TABLE &gt;&lt;/CENTER &gt;&lt; HR &gt;&lt; HR &gt; section results Results The figure below shows a contour plot of the pressure distribution taken from&lt; A HREF=&quot;../figures/two_layer_interface.avi&quot;&gt; an animation of the flow for the parameters f</div><div class="ttdef"><b>Definition:</b> <a href="two__layer__interface_8txt_source.html#l00204">two_layer_interface.txt:204</a></div></div>
<div class="ttc" id="aclassTwoLayerInterfaceProblem_html_a89431a4ad9400976c295c4cfd04b3727"><div class="ttname"><a href="classTwoLayerInterfaceProblem.html#a89431a4ad9400976c295c4cfd04b3727">TwoLayerInterfaceProblem::actions_before_adapt</a></div><div class="ttdeci">void actions_before_adapt()</div><div class="ttdoc">Actions before adapt: Wipe the mesh of free surface elements.</div><div class="ttdef"><b>Definition:</b> <a href="refineable__two__layer__interface_8cc_source.html#l00393">refineable_two_layer_interface.cc:393</a></div></div>
<div class="ttc" id="aclassoomph_1_1MyCrouzeixRaviartElement_html_a6719573c11157d360cb0a0fd0d2b92f4"><div class="ttname"><a href="classoomph_1_1MyCrouzeixRaviartElement.html#a6719573c11157d360cb0a0fd0d2b92f4">oomph::MyCrouzeixRaviartElement::MyCrouzeixRaviartElement</a></div><div class="ttdeci">MyCrouzeixRaviartElement()</div><div class="ttdoc">Constructor initialise error.</div><div class="ttdef"><b>Definition:</b> <a href="refineable__two__layer__interface_8cc_source.html#l00064">refineable_two_layer_interface.cc:64</a></div></div>
<div class="ttc" id="aclassTwoLayerInterfaceProblem_html_ade0bdb2267a9fdbab1bea08fc2d87104"><div class="ttname"><a href="classTwoLayerInterfaceProblem.html#ade0bdb2267a9fdbab1bea08fc2d87104">TwoLayerInterfaceProblem::Outer_boundary_polyline_pt</a></div><div class="ttdeci">TriangleMeshPolygon * Outer_boundary_polyline_pt</div><div class="ttdoc">Triangle mesh polygon for outer boundary.</div><div class="ttdef"><b>Definition:</b> <a href="refineable__two__layer__interface_8cc_source.html#l00543">refineable_two_layer_interface.cc:543</a></div></div>
<div class="ttc" id="atwo__layer__interface_8txt_html_ac97470a3d889ea4d3ec5e3a143ed0f2f"><div class="ttname"><a href="two__layer__interface_8txt.html#ac97470a3d889ea4d3ec5e3a143ed0f2f">St</a></div><div class="ttdeci">qquad R_ E[eqn:kinematicBC] f and the dynamic condition f[\tau_{ij}^{[2]} \, n_j^{[1]}=\tau_{ij}^{[1]} \, n_j^{[1]}+\frac{1}{Ca} \, \kappa \, n_i^{[1]}.\ \ \ \ \ \ \ \ \ \ @E[eqn:dynamicBC]@\f] The stress tensor in the lower fluid is defined as f[\tau_{ij}^{[1]}=-p^{[1]} \, \delta_{ij}+\left(\frac{\partial u^{ St[1]}_i}{\partial x_j}+\frac{\partial u^{[1]}_j}{\partial x_i}\right),\ \ \ \ \ \ \ \ \ \ @E[eqn:stresstensorlower]@\f] and that in the upper fluid is defined as f[\tau_{ij}^{[2]}=-p^{[2]} \, \delta_{ij}+R_\mu \left(\frac{\partial u^{[2]}_i}{\partial x_j}+\frac{\partial u^{[2]}_j}{\partial x_i}\right).\ \ \ \ \ \ \ \ \ \ @E[eqn:stresstensorupper]@\f] The initial shape of the interface is defined by f[\mathbf{R}=x_1 \, \mathbf{i}+\left[1.0+\epsilon\cos\left(2 n \pi x_1 \right)\right] \, \mathbf{j},\ \ \ \ \ \ \ \ \ \ @E[eqn:interfacedeformation]@\f] where f epsilon f is the amplitude of the initial deflection and f n f is an integer&lt;/TD &gt;&lt;/TR &gt;&lt;/TABLE &gt;&lt;/CENTER &gt;&lt; HR &gt;&lt; HR &gt; section results Results The figure below shows a contour plot of the pressure distribution taken from&lt; A HREF=&quot;../figures/two_layer_interface.avi&quot;&gt; an animation of the flow for the parameters f</div><div class="ttdef"><b>Definition:</b> <a href="two__layer__interface_8txt_source.html#l00204">two_layer_interface.txt:204</a></div></div>
<div class="ttc" id="aclassTwoLayerInterfaceProblem_html_add2bdae31e9372250c62608f1a30fdc4"><div class="ttname"><a href="classTwoLayerInterfaceProblem.html#add2bdae31e9372250c62608f1a30fdc4">TwoLayerInterfaceProblem::Use_volume_constraint</a></div><div class="ttdeci">bool Use_volume_constraint</div><div class="ttdoc">Bool to indicate if volume constraint is applied (only for steady run)</div><div class="ttdef"><b>Definition:</b> <a href="refineable__two__layer__interface_8cc_source.html#l00555">refineable_two_layer_interface.cc:555</a></div></div>
<div class="ttc" id="aclassTwoLayerInterfaceProblem_html_a406dd9cb8b718773530a3d1170bece96"><div class="ttname"><a href="classTwoLayerInterfaceProblem.html#a406dd9cb8b718773530a3d1170bece96">TwoLayerInterfaceProblem::Free_surface_mesh_pt</a></div><div class="ttdeci">Mesh * Free_surface_mesh_pt</div><div class="ttdoc">Pointers to mesh of free surface elements.</div><div class="ttdef"><b>Definition:</b> <a href="refineable__two__layer__interface_8cc_source.html#l00533">refineable_two_layer_interface.cc:533</a></div></div>
<div class="ttc" id="aclassTwoLayerInterfaceProblem_html"><div class="ttname"><a href="classTwoLayerInterfaceProblem.html">TwoLayerInterfaceProblem</a></div><div class="ttdoc">Problem class to simulate viscous drop propagating along 2D channel.</div><div class="ttdef"><b>Definition:</b> <a href="refineable__two__layer__interface_8cc_source.html#l00351">refineable_two_layer_interface.cc:351</a></div></div>
<div class="ttc" id="aclassTwoLayerInterfaceProblem_html_a12d0b30397350f3a6dcf56d67216d6ff"><div class="ttname"><a href="classTwoLayerInterfaceProblem.html#a12d0b30397350f3a6dcf56d67216d6ff">TwoLayerInterfaceProblem::Hijacked_element_pt</a></div><div class="ttdeci">ELEMENT * Hijacked_element_pt</div><div class="ttdoc">Pointer to hijacked element.</div><div class="ttdef"><b>Definition:</b> <a href="refineable__two__layer__interface_8cc_source.html#l00552">refineable_two_layer_interface.cc:552</a></div></div>
<div class="ttc" id="aclassoomph_1_1FaceGeometry_3_01FaceGeometry_3_01MyCrouzeixRaviartElement_01_4_01_4_html_ace1479da1535c271d7dc671dacbbdcca"><div class="ttname"><a href="classoomph_1_1FaceGeometry_3_01FaceGeometry_3_01MyCrouzeixRaviartElement_01_4_01_4.html#ace1479da1535c271d7dc671dacbbdcca">oomph::FaceGeometry&lt; FaceGeometry&lt; MyCrouzeixRaviartElement &gt; &gt;::FaceGeometry</a></div><div class="ttdeci">FaceGeometry()</div><div class="ttdef"><b>Definition:</b> <a href="refineable__two__layer__interface_8cc_source.html#l00272">refineable_two_layer_interface.cc:272</a></div></div>
<div class="ttc" id="aclassTwoLayerInterfaceProblem_html_a5034f5c3d7ec8fd556b1af7f0c2351ef"><div class="ttname"><a href="classTwoLayerInterfaceProblem.html#a5034f5c3d7ec8fd556b1af7f0c2351ef">TwoLayerInterfaceProblem::~TwoLayerInterfaceProblem</a></div><div class="ttdeci">~TwoLayerInterfaceProblem()</div><div class="ttdoc">Destructor.</div><div class="ttdef"><b>Definition:</b> <a href="refineable__two__layer__interface_8cc_source.html#l00360">refineable_two_layer_interface.cc:360</a></div></div>
<div class="ttc" id="aclassTwoLayerInterfaceProblem_html_aa34b7c3a13847571a9fedc2465daab30"><div class="ttname"><a href="classTwoLayerInterfaceProblem.html#aa34b7c3a13847571a9fedc2465daab30">TwoLayerInterfaceProblem::actions_before_newton_solve</a></div><div class="ttdeci">void actions_before_newton_solve()</div><div class="ttdoc">Update the problem specs before solve.</div><div class="ttdef"><b>Definition:</b> <a href="refineable__two__layer__interface_8cc_source.html#l00425">refineable_two_layer_interface.cc:425</a></div></div>
<div class="ttc" id="aclassTwoLayerInterfaceProblem_html_ac2852a90a68b7cde5c6d04f79d029047"><div class="ttname"><a href="classTwoLayerInterfaceProblem.html#ac2852a90a68b7cde5c6d04f79d029047">TwoLayerInterfaceProblem::set_initial_condition</a></div><div class="ttdeci">void set_initial_condition()</div><div class="ttdoc">Set the initial conditions.</div><div class="ttdef"><b>Definition:</b> <a href="refineable__two__layer__interface_8cc_source.html#l00444">refineable_two_layer_interface.cc:444</a></div></div>
<div class="ttc" id="aclassTwoLayerInterfaceProblem_html_a474a9ea9fda21eb1cddf79809b2de6d4"><div class="ttname"><a href="classTwoLayerInterfaceProblem.html#a474a9ea9fda21eb1cddf79809b2de6d4">TwoLayerInterfaceProblem::delete_free_surface_elements</a></div><div class="ttdeci">void delete_free_surface_elements()</div><div class="ttdoc">Delete free surface elements.</div><div class="ttdef"><b>Definition:</b> <a href="refineable__two__layer__interface_8cc_source.html#l00512">refineable_two_layer_interface.cc:512</a></div></div>
<div class="ttc" id="aclassTwoLayerInterfaceProblem_html_a96392e407b2c1f5fc295fe423404c943"><div class="ttname"><a href="classTwoLayerInterfaceProblem.html#a96392e407b2c1f5fc295fe423404c943">TwoLayerInterfaceProblem::complete_problem_setup</a></div><div class="ttdeci">void complete_problem_setup()</div><div class="ttdoc">Set boundary conditions and complete the build of all elements.</div><div class="ttdef"><b>Definition:</b> <a href="refineable__two__layer__interface_8cc_source.html#l00825">refineable_two_layer_interface.cc:825</a></div></div>
<div class="ttc" id="atwo__layer__interface_8txt_html_a4074baada03976c061d5672f4237cca5"><div class="ttname"><a href="two__layer__interface_8txt.html#a4074baada03976c061d5672f4237cca5">problem</a></div><div class="ttdeci">mainpage Demo problem</div><div class="ttdef"><b>Definition:</b> <a href="two__layer__interface_8txt_source.html#l00017">two_layer_interface.txt:17</a></div></div>
<div class="ttc" id="aclassoomph_1_1MyCrouzeixRaviartElement_html_a0b1ccbfb0eda6807c3a332aa0b6ea6e2"><div class="ttname"><a href="classoomph_1_1MyCrouzeixRaviartElement.html#a0b1ccbfb0eda6807c3a332aa0b6ea6e2">oomph::MyCrouzeixRaviartElement::set_error</a></div><div class="ttdeci">void set_error(const double &amp;error)</div><div class="ttdoc">Set error value for post-processing.</div><div class="ttdef"><b>Definition:</b> <a href="refineable__two__layer__interface_8cc_source.html#l00071">refineable_two_layer_interface.cc:71</a></div></div>
<div class="ttc" id="aclassoomph_1_1FaceGeometry_3_01MyCrouzeixRaviartElement_01_4_html_a28b4b942614e6cfee40e773deb3e3003"><div class="ttname"><a href="classoomph_1_1FaceGeometry_3_01MyCrouzeixRaviartElement_01_4.html#a28b4b942614e6cfee40e773deb3e3003">oomph::FaceGeometry&lt; MyCrouzeixRaviartElement &gt;::FaceGeometry</a></div><div class="ttdeci">FaceGeometry()</div><div class="ttdef"><b>Definition:</b> <a href="refineable__two__layer__interface_8cc_source.html#l00258">refineable_two_layer_interface.cc:258</a></div></div>
<div class="ttc" id="aclassTwoLayerInterfaceProblem_html_adac700fd7368550b91620a7f79091857"><div class="ttname"><a href="classTwoLayerInterfaceProblem.html#adac700fd7368550b91620a7f79091857">TwoLayerInterfaceProblem::deform_interface</a></div><div class="ttdeci">void deform_interface(const double &amp;epsilon, const unsigned &amp;n_periods)</div><div class="ttdoc">Function to deform the interface.</div><div class="ttdef"><b>Definition:</b> <a href="refineable__two__layer__interface_8cc_source.html#l00470">refineable_two_layer_interface.cc:470</a></div></div>
<div class="ttc" id="aclassTwoLayerInterfaceProblem_html_ae9d05acfe4e978cdfd727afb4f27969f"><div class="ttname"><a href="classTwoLayerInterfaceProblem.html#ae9d05acfe4e978cdfd727afb4f27969f">TwoLayerInterfaceProblem::Drop_pressure_data_pt</a></div><div class="ttdeci">Data * Drop_pressure_data_pt</div><div class="ttdoc">Pointer to a global drop pressure datum.</div><div class="ttdef"><b>Definition:</b> <a href="refineable__two__layer__interface_8cc_source.html#l00546">refineable_two_layer_interface.cc:546</a></div></div>
<div class="ttc" id="anamespaceProblem__Parameter_html_a7b67840fea463f29b53d12f7bd7cb34b"><div class="ttname"><a href="namespaceProblem__Parameter.html#a7b67840fea463f29b53d12f7bd7cb34b">Problem_Parameter::Length</a></div><div class="ttdeci">double Length</div><div class="ttdoc">Length of the channel.</div><div class="ttdef"><b>Definition:</b> <a href="refineable__two__layer__interface_8cc_source.html#l00323">refineable_two_layer_interface.cc:323</a></div></div>
<div class="ttc" id="aclassTwoLayerInterfaceProblem_html_accfab13c26afb181d320bd5dc25ed878"><div class="ttname"><a href="classTwoLayerInterfaceProblem.html#accfab13c26afb181d320bd5dc25ed878">TwoLayerInterfaceProblem::Fluid_mesh_pt</a></div><div class="ttdeci">RefineableSolidTriangleMesh&lt; ELEMENT &gt; * Fluid_mesh_pt</div><div class="ttdoc">Pointer to Fluid_mesh.</div><div class="ttdef"><b>Definition:</b> <a href="refineable__two__layer__interface_8cc_source.html#l00537">refineable_two_layer_interface.cc:537</a></div></div>
<div class="ttc" id="anamespaceProblem__Parameter_html_acc656299287d4d9a8374c2c501750b4f"><div class="ttname"><a href="namespaceProblem__Parameter.html#acc656299287d4d9a8374c2c501750b4f">Problem_Parameter::Re</a></div><div class="ttdeci">double Re</div><div class="ttdoc">Reynolds number.</div><div class="ttdef"><b>Definition:</b> <a href="refineable__two__layer__interface_8cc_source.html#l00294">refineable_two_layer_interface.cc:294</a></div></div>
<div class="ttc" id="anamespaceProblem__Parameter_html_a388e06a5e637b21378ab1832e5564bec"><div class="ttname"><a href="namespaceProblem__Parameter.html#a388e06a5e637b21378ab1832e5564bec">Problem_Parameter::Norm_file</a></div><div class="ttdeci">ofstream Norm_file</div><div class="ttdoc">File to document the norm of the solution (for validation purposes  triangle doesn't give fully repr...</div><div class="ttdef"><b>Definition:</b> <a href="refineable__two__layer__interface_8cc_source.html#l00341">refineable_two_layer_interface.cc:341</a></div></div>
<div class="ttc" id="anamespaceProblem__Parameter_html_a7e5c502c4f97a31cc7d757c43d4b17e7"><div class="ttname"><a href="namespaceProblem__Parameter.html#a7e5c502c4f97a31cc7d757c43d4b17e7">Problem_Parameter::G</a></div><div class="ttdeci">Vector&lt; double &gt; G(2)</div><div class="ttdoc">Direction of gravity.</div></div>
<div class="ttc" id="anamespaceoomph_html"><div class="ttname"><a href="namespaceoomph.html">oomph</a></div><div class="ttdef"><b>Definition:</b> <a href="refineable__two__layer__interface_8cc_source.html#l00044">refineable_two_layer_interface.cc:44</a></div></div>
<div class="ttc" id="anamespaceProblem__Parameter_html_aef705e249abde5f1527cbc01497dcabb"><div class="ttname"><a href="namespaceProblem__Parameter.html#aef705e249abde5f1527cbc01497dcabb">Problem_Parameter::Height</a></div><div class="ttdeci">double Height</div><div class="ttdef"><b>Definition:</b> <a href="refineable__two__layer__interface_8cc_source.html#l00326">refineable_two_layer_interface.cc:326</a></div></div>
<div class="ttc" id="anamespaceProblem__Parameter_html_abec2e733c8f2d3c18ebc702b3f80cc17"><div class="ttname"><a href="namespaceProblem__Parameter.html#abec2e733c8f2d3c18ebc702b3f80cc17">Problem_Parameter::Nu</a></div><div class="ttdeci">double Nu</div><div class="ttdoc">Pseudo-solid Poisson ratio.</div><div class="ttdef"><b>Definition:</b> <a href="refineable__two__layer__interface_8cc_source.html#l00320">refineable_two_layer_interface.cc:320</a></div></div>
<div class="ttc" id="anamespaceProblem__Parameter_html_a9852a6077458693983628319d429f11f"><div class="ttname"><a href="namespaceProblem__Parameter.html#a9852a6077458693983628319d429f11f">Problem_Parameter::Constitutive_law_pt</a></div><div class="ttdeci">ConstitutiveLaw * Constitutive_law_pt</div><div class="ttdoc">Constitutive law used to determine the mesh deformation.</div><div class="ttdef"><b>Definition:</b> <a href="refineable__two__layer__interface_8cc_source.html#l00332">refineable_two_layer_interface.cc:332</a></div></div>
<div class="ttc" id="aclassTwoLayerInterfaceProblem_html_a81589b120683037dc07ab9251bf81e85"><div class="ttname"><a href="classTwoLayerInterfaceProblem.html#a81589b120683037dc07ab9251bf81e85">TwoLayerInterfaceProblem::fix_pressure</a></div><div class="ttdeci">void fix_pressure(const unsigned &amp;e, const unsigned &amp;pdof, const double &amp;pvalue)</div><div class="ttdoc">Fix pressure in element e at pressure dof pdof and set to pvalue.</div><div class="ttdef"><b>Definition:</b> <a href="refineable__two__layer__interface_8cc_source.html#l00495">refineable_two_layer_interface.cc:495</a></div></div>
<div class="ttc" id="aclassTwoLayerInterfaceProblem_html_a87ef8df1cf7f548b19f14163a085370f"><div class="ttname"><a href="classTwoLayerInterfaceProblem.html#a87ef8df1cf7f548b19f14163a085370f">TwoLayerInterfaceProblem::compute_error_estimate</a></div><div class="ttdeci">void compute_error_estimate(double &amp;max_err, double &amp;min_err)</div><div class="ttdoc">Compute the error estimates and assign to elements for plotting.</div><div class="ttdef"><b>Definition:</b> <a href="refineable__two__layer__interface_8cc_source.html#l01033">refineable_two_layer_interface.cc:1033</a></div></div>
<div class="ttc" id="aclassoomph_1_1MyCrouzeixRaviartElement_html_aac525f961951f5d621f141b4fcdda357"><div class="ttname"><a href="classoomph_1_1MyCrouzeixRaviartElement.html#aac525f961951f5d621f141b4fcdda357">oomph::MyCrouzeixRaviartElement::Error</a></div><div class="ttdeci">double Error</div><div class="ttdoc">Storage for elemental error estimate  used for post-processing.</div><div class="ttdef"><b>Definition:</b> <a href="refineable__two__layer__interface_8cc_source.html#l00059">refineable_two_layer_interface.cc:59</a></div></div>
<div class="ttc" id="anamespaceProblem__Parameter_html_a8d9b76e390569bac0095bd0952281a30"><div class="ttname"><a href="namespaceProblem__Parameter.html#a8d9b76e390569bac0095bd0952281a30">Problem_Parameter::St</a></div><div class="ttdeci">double St</div><div class="ttdoc">Strouhal number.</div><div class="ttdef"><b>Definition:</b> <a href="refineable__two__layer__interface_8cc_source.html#l00297">refineable_two_layer_interface.cc:297</a></div></div>
<div class="ttc" id="anamespaceProblem__Parameter_html_a1be099d26a4388edccc1592236dda50c"><div class="ttname"><a href="namespaceProblem__Parameter.html#a1be099d26a4388edccc1592236dda50c">Problem_Parameter::ReSt</a></div><div class="ttdeci">double ReSt</div><div class="ttdoc">Womersley number (Reynolds x Strouhal)</div><div class="ttdef"><b>Definition:</b> <a href="refineable__two__layer__interface_8cc_source.html#l00300">refineable_two_layer_interface.cc:300</a></div></div>
<div class="ttc" id="aclassTwoLayerInterfaceProblem_html_afa49f2cb784a03dfb93d33d678cfc1f9"><div class="ttname"><a href="classTwoLayerInterfaceProblem.html#afa49f2cb784a03dfb93d33d678cfc1f9">TwoLayerInterfaceProblem::Initial_value_for_drop_pressure</a></div><div class="ttdeci">double Initial_value_for_drop_pressure</div><div class="ttdoc">Backed up drop pressure between adaptations.</div><div class="ttdef"><b>Definition:</b> <a href="refineable__two__layer__interface_8cc_source.html#l00549">refineable_two_layer_interface.cc:549</a></div></div>
<div class="ttc" id="aclassoomph_1_1MyCrouzeixRaviartElement_html_ad1ea7115e6cb090d687ac421e56f4d16"><div class="ttname"><a href="classoomph_1_1MyCrouzeixRaviartElement.html#ad1ea7115e6cb090d687ac421e56f4d16">oomph::MyCrouzeixRaviartElement::output</a></div><div class="ttdeci">void output(std::ostream &amp;outfile, const unsigned &amp;nplot)</div><div class="ttdoc">Overload output function.</div><div class="ttdef"><b>Definition:</b> <a href="refineable__two__layer__interface_8cc_source.html#l00102">refineable_two_layer_interface.cc:102</a></div></div>
<div class="ttc" id="anamespaceProblem__Parameter_html_af6194d2571881779c678fbabc1503d47"><div class="ttname"><a href="namespaceProblem__Parameter.html#af6194d2571881779c678fbabc1503d47">Problem_Parameter::Ca</a></div><div class="ttdeci">double Ca</div><div class="ttdoc">Capillary number.</div><div class="ttdef"><b>Definition:</b> <a href="refineable__two__layer__interface_8cc_source.html#l00314">refineable_two_layer_interface.cc:314</a></div></div>
<div class="ttc" id="aclassTwoLayerInterfaceProblem_html_ac3c380cea3010fcf83b41d854e4595f9"><div class="ttname"><a href="classTwoLayerInterfaceProblem.html#ac3c380cea3010fcf83b41d854e4595f9">TwoLayerInterfaceProblem::Drop_polygon_pt</a></div><div class="ttdeci">Vector&lt; TriangleMeshPolygon * &gt; Drop_polygon_pt</div><div class="ttdoc">Vector storing pointer to the drop polygons.</div><div class="ttdef"><b>Definition:</b> <a href="refineable__two__layer__interface_8cc_source.html#l00540">refineable_two_layer_interface.cc:540</a></div></div>
<div class="ttc" id="anamespaceProblem__Parameter_html_ac643ff6a132687f67099ab5b35849c51"><div class="ttname"><a href="namespaceProblem__Parameter.html#ac643ff6a132687f67099ab5b35849c51">Problem_Parameter::Viscosity_Ratio</a></div><div class="ttdeci">double Viscosity_Ratio</div><div class="ttdoc">Ratio of viscosity in upper fluid to viscosity in lower fluid. Reynolds number etc....</div><div class="ttdef"><b>Definition:</b> <a href="refineable__two__layer__interface_8cc_source.html#l00307">refineable_two_layer_interface.cc:307</a></div></div>
<div class="ttc" id="anamespaceProblem__Parameter_html_a0d53d8c976c13e0723304666b87324e1"><div class="ttname"><a href="namespaceProblem__Parameter.html#a0d53d8c976c13e0723304666b87324e1">Problem_Parameter::Interface_Height</a></div><div class="ttdeci">double Interface_Height</div><div class="ttdef"><b>Definition:</b> <a href="refineable__two__layer__interface_8cc_source.html#l00329">refineable_two_layer_interface.cc:329</a></div></div>
<div class="ttc" id="anamespaceProblem__Parameter_html_ab5e1078e81238be42d304c9cd3f7a9cc"><div class="ttname"><a href="namespaceProblem__Parameter.html#ab5e1078e81238be42d304c9cd3f7a9cc">Problem_Parameter::ReInvFr</a></div><div class="ttdeci">double ReInvFr</div><div class="ttdoc">Product of Reynolds number and inverse of Froude number.</div><div class="ttdef"><b>Definition:</b> <a href="refineable__two__layer__interface_8cc_source.html#l00303">refineable_two_layer_interface.cc:303</a></div></div>
<div class="ttc" id="anamespaceProblem__Parameter_html_a1dd3c6bcf97360c8fe0d288ca7610351"><div class="ttname"><a href="namespaceProblem__Parameter.html#a1dd3c6bcf97360c8fe0d288ca7610351">Problem_Parameter::Doc_info</a></div><div class="ttdeci">DocInfo Doc_info</div><div class="ttdoc">Doc info.</div><div class="ttdef"><b>Definition:</b> <a href="refineable__two__layer__interface_8cc_source.html#l00291">refineable_two_layer_interface.cc:291</a></div></div>
<div class="ttc" id="anamespaceProblem__Parameter_html_a55310be5f2dfcb5fcfe35d71f9c16e06"><div class="ttname"><a href="namespaceProblem__Parameter.html#a55310be5f2dfcb5fcfe35d71f9c16e06">Problem_Parameter::Trace_file</a></div><div class="ttdeci">ofstream Trace_file</div><div class="ttdoc">Trace file.</div><div class="ttdef"><b>Definition:</b> <a href="refineable__two__layer__interface_8cc_source.html#l00335">refineable_two_layer_interface.cc:335</a></div></div>
<div class="ttc" id="aclassTwoLayerInterfaceProblem_html_abf42cfea7dd731795995051c1de78a32"><div class="ttname"><a href="classTwoLayerInterfaceProblem.html#abf42cfea7dd731795995051c1de78a32">TwoLayerInterfaceProblem::TwoLayerInterfaceProblem</a></div><div class="ttdeci">TwoLayerInterfaceProblem()</div><div class="ttdoc">Constructor.</div><div class="ttdef"><b>Definition:</b> <a href="refineable__two__layer__interface_8cc_source.html#l00575">refineable_two_layer_interface.cc:575</a></div></div>
<div class="ttc" id="arefineable__two__layer__interface_8cc_html_a3c04138a5bfe5d72780bb7e82a18e627"><div class="ttname"><a href="refineable__two__layer__interface_8cc.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a></div><div class="ttdeci">int main(int argc, char **argv)</div><div class="ttdoc">Driver code for moving block problem.</div><div class="ttdef"><b>Definition:</b> <a href="refineable__two__layer__interface_8cc_source.html#l01068">refineable_two_layer_interface.cc:1068</a></div></div>
<div class="ttc" id="aclassoomph_1_1MyCrouzeixRaviartElement_html_afbec727a48f104b945cc54f798cbd1d3"><div class="ttname"><a href="classoomph_1_1MyCrouzeixRaviartElement.html#afbec727a48f104b945cc54f798cbd1d3">oomph::MyCrouzeixRaviartElement::variable_identifier</a></div><div class="ttdeci">std::string variable_identifier()</div><div class="ttdoc">Return variable identifier.</div><div class="ttdef"><b>Definition:</b> <a href="refineable__two__layer__interface_8cc_source.html#l00074">refineable_two_layer_interface.cc:74</a></div></div>
<div class="ttc" id="aclassoomph_1_1MyCrouzeixRaviartElement_html"><div class="ttname"><a href="classoomph_1_1MyCrouzeixRaviartElement.html">oomph::MyCrouzeixRaviartElement</a></div><div class="ttdoc">Overload CrouzeixRaviart element to modify output.</div><div class="ttdef"><b>Definition:</b> <a href="refineable__two__layer__interface_8cc_source.html#l00051">refineable_two_layer_interface.cc:51</a></div></div>

    <!-- jQuery for Bootstrap and Doxygen -->
    <script src="../../../js/jquery-1.12.0.min.js"></script>
    <!-- Minified boostrap plugins-->
    <script src="../../../js/bootstrap.js"></script>
    <!-- Doxygen dependency to add powertips to source code-->
    <script src="../../../js/jquery.powertip.min.js"></script>
    <!-- The  following script is generated by doxygen and hides/shows levels in 
         the data structure lists and adds powertips to source code-->
    <script src="../../../js/dynsections.js" ></script>
    <!-- add to Doxygen's class names so bootstrap css and js recognises them-->
    <script type="text/javascript">
    $(".contents").addClass("container");
    $(".header").addClass("container");
    $(".navpath").addClass("container");
    $("#navrow3").addClass("container");
    $("#navrow4").addClass("container");
    $(".mlabel").addClass("label");
    $(".mlabel").addClass("label-default");
    $(".memitem").addClass("panel");
    $(".memitem").addClass("panel-info");
    $(".memproto").addClass("panel-heading");
    $(".memdoc").addClass("panel-body");
    </script>
    <footer>
      <div class="container">
        <div class="text-muted" style="float:right;">Generated by <a href="http://www.doxygen.org/index.html">
          <img style="height:18px;" class="footer-img" src="doxygen.png" alt="doxygen"></a> on Wed Aug 18 2021 17:48:52
        </div>
      </div>
    </footer>
</body>
</html>

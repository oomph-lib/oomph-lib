<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
<title>oomph-lib: Demo problem: Fluid Mechanics on unstructured 3D meshes</title>
<link rel="apple-touch-icon" sizes="57x57" href="../../../figures/apple-touch-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="../../../figures/apple-touch-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="../../../figures/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="../../../figures/apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="../../../figures/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="../../../figures/apple-touch-icon-120x120.png">
<link rel="icon" type="image/png" href="../../../figures/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="../../../figures/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="../../../figures/favicon-16x16.png" sizes="16x16">
<link rel="manifest" href="../../../figures/manifest.json">
<link rel="mask-icon" href="../../../figures/safari-pinned-tab.svg" color="#008000">
<link rel="shortcut icon" href="../../../figures/favicon.ico">
<meta name="msapplication-TileColor" content="#00a300">
<meta name="msapplication-config" content="../../../figures/browserconfig.xml">
<meta name="theme-color" content="#008000">
<link href="http://fonts.googleapis.com/css?family=Open+Sans:400,300,600" rel="stylesheet" type="text/css">
<!-- Doxygen css-->
<!-- <link rel="stylesheet" type="text/css" href="doxygen.css"> -->
<!-- Bootstrap -->
<link href="../../../css/bootstrap.css" rel="stylesheet">
<!-- oomph-lib specific overrides -->
<link rel="stylesheet" type="text/css" href="../../../css/oomph_header.css">
</head>
<body>
<nav class="navbar navbar-default">
<div class="container">
<div class="container-fluid">
  <!-- Brand and toggle get grouped for better mobile display -->
  <div class="navbar-header">
    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
      <span class="sr-only">Toggle navigation</span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="../../../html/index.html"><img alt="oomph-lib" src="../../../figures/oomph_logo.png"></a>
  </div>
  <!-- Collect the nav links, forms, and other content for toggling -->
  <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
    <ul class="nav navbar-nav">          
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Documentation <span class="caret"></span></a>
        <ul class="dropdown-menu">
          <li class="dropdown-header">Big picture</li>
          <li><a href="../../../../doc/intro/html/index.html">The finite element method</a></li>
          <li><a href="../../../../doc/the_data_structure/html/index.html">The data structure</a></li>
          <li><a href="../../../../doc/quick_guide/html/index.html">Not-so-quick guide</a></li>
          <li><a href="../../../../doc/optimisation/html/index.html">Optimisation</a></li>
          <li><a href="../../../../doc/order_of_action_functions/html/index.html">Order of action functions</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Example codes and tutorials</li>
          <li><a href="../../../../doc/example_code_list/html/index.html">List of example codes and tutorials</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#meshes">Meshing</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#solvers">Solvers</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#parallel">MPI parallel processing</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#visualisation">Post-processing/visualisation</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Other</li>
          <li><a href="../../../../doc/change_log/html/index.html">Change log</a></li>
          <li><a href="../../../../doc/creating_doc/html/index.html">Creating documentation</a></li>
          <li><a href="../../../../doc/coding_conventions/html/index.html">Coding conventions</a></li>
          <li><a href="../../../../doc/index/html/index.html">Index</a></li>
          <li><a href="../../../../doc/FAQ/html/index.html">FAQ</a></li>
        </ul>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Installation<span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../../doc/the_distribution/html/index.html">Installation guide</a></li>
            <li><a href="../../../../doc/copyright/html/index.html">Copyright</a></li>
          </ul>
        </li>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">About <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../../doc/people/html/index.html">People</a></li>            
            <li><a href="../../../../doc/contact/html/index.html">Contact/Get involved</a></li>
            <li><a href="../../../../doc/publications/html/index.html">Publications</a></li>
            <li><a href="../../../../doc/acknowledgements/html/index.html">Acknowledgements</a></li>
            <li><a href="../../../../doc/picture_show/index.html">Picture show</a></li>
          </ul>
        </li>
      </li>
    </ul>
    <ul class="nav navbar-nav navbar-right navbar-search">
      <form class="navbar-form" role="search" action="../../../../doc/search_results/html/index.html">
        <div class="input-group">
          <input type="text" class="form-control" placeholder="Search" name="q">
          <span class="input-group-btn">
            <button class="btn btn-default" type="submit">Go</button>
          </span>
        </div><!-- /input-group -->
       <!--<div class="form-group">
          <input type="text" class="form-control" placeholder="Search">
        </div>
        <button type="submit" class="btn btn-default">Submit</button>-->
      </form>
    </ul>
  </div><!-- /.navbar-collapse -->
</div><!-- /.container-fluid -->
</div>
</nav>
<!-- Generated by Doxygen 1.9.1 -->
</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Demo problem: Fluid Mechanics on unstructured 3D meshes </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This tutorial provides another demonstration of how to use 3D unstructured meshes for the solution of fluid flow problems. (The main <a href="../../../meshes/mesh_from_tetgen/html/index.html">tetgen tutorial</a> already contains a 3D unstructured fluid example.)</p>
<p>The specific problem considered here also serves as a "warm-up problem" for the <a href="../../../interaction/unstructured_three_d_fsi/html/index.html">corresponding fluid-structure interaction problem</a> in which the domain boundary is replaced by an elastic vessel.</p>
<hr  />
 <hr  />
<h1><a class="anchor" id="problem"></a>
The problem</h1>
<p>Here is a sketch of the problem: Flow is driven through a 3D rigid vessel made of three rectangular tubes that meet at a common junction. The flow is driven by a prescribed pressure drop between the upstream and the two downstream ends, <img class="formulaInl" alt="$ \Delta P^* = P^*_{in} - P^*_{out}, $" src="form_0.png" width="103" height="14"/> and we assume/impose parallel in- and outflow in the inlet and outlet cross-sections, all of which are parallel to <img class="formulaInl" alt="$ x-y $" src="form_1.png" width="30" height="9"/> coordinate plane.</p>
<div class="image">
<img src="problem_sketch.gif" alt=""/>
<div class="caption">
Sketch of the domain with boundary conditions. </div></div>
 <p>We non-dimensionalise all lengths on the half-width, <img class="formulaInl" alt="$ W $" src="form_2.png" width="14" height="10"/>, of the square main vessel and use the overall pressure drop, <img class="formulaInl" alt="$ \Delta P^* $" src="form_3.png" width="25" height="10"/> to define the (viscous) velocity scale </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ {\cal U} = \frac{\Delta P^*\ W}{\mu}. \]" src="form_4.png" width="76" height="30"/>
</p>
<p> With this choice the Reynolds number becomes </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ Re = \frac{\rho {\cal U} W }{\mu} = \frac{ \Delta P^* \rho W^2 }{\mu^2}, \]" src="form_5.png" width="139" height="31"/>
</p>
<p> and we choose to drive the flow with a dimensionless pressure drop of <img class="formulaInl" alt="$ \Delta P = 1. $" src="form_6.png" width="46" height="10"/> An increase in Reynolds number may therefore be interpreted as in increase in the applied (dimensional) pressure drop along the vessel.</p>
<hr  />
 <hr  />
<h1><a class="anchor" id="mesh"></a>
3D unstructured mesh generation</h1>
<p>We use <a href="http://www.wias-berlin.de/~si ">Hang Si's</a> open-source mesh generator <a href="http://wias-berlin.de/software/tetgen//"><code>tetgen</code> </a> to generate the unstructured tetrahedral mesh "offline". We then process the output files produced by <br  />
 <a href="http://wias-berlin.de/software/tetgen//"><code>tetgen</code> </a> to generate an unstructured <code>oomph-lib</code> mesh.</p>
<p><a href="http://wias-berlin.de/software/tetgen//"><code>Tetgen</code> </a> requires the specification of the domain boundaries via so-called facets &ndash; planar surface patches that are bounded by closed polygonal line segments. In our simple geometry each of the three tube segments has four external faces. Together with the three in- and outflow sections this results in a total of 15 facets.</p>
<p>The 15 facets are defined in a <code>*.poly</code> file that specifies the position of the vertices, and identifies the facets via a "face list" that establishes their bounding vertices. The well-annotated <code>*.poly</code> file for this problem is located at:</p>
<center> <a href="../../../../demo_drivers/navier_stokes/unstructured_three_d_fluid/fsi_bifurcation_fluid.poly">demo_drivers/navier_stokes/unstructured_three_d_fluid/fsi_bifurcation_fluid.poly</a> </center><p>We refer to the <a href="http://wias-berlin.de/software/tetgen//"><code>tetgen</code> webpages </a> and <code>oomph-lib's</code> own <a href="../../../meshes/mesh_from_tetgen/html/index.html">tetgen tutorial</a> for further details on how to create <code>*.poly</code> files.</p>
<p>Here is a plot of the domain specified by <a href="../../../../demo_drivers/navier_stokes/unstructured_three_d_fluid/fsi_bifurcation_fluid.poly">fsi_bifurcation_fluid.poly</a>. The plot was created using <code>tetview</code> which is distributed with <a href="http://wias-berlin.de/software/tetgen//"><code>tetgen</code> </a>.</p>
<div class="image">
<img src="tetgen_boundaries.gif" alt=""/>
<div class="caption">
The domain and its bounding facets. </div></div>
 <p>Note that we have deliberately assigned a different boundary ID to each facet. This will make the assignment of the boundary condition somewhat tedious as the domain boundaries of interest tend to be represented by multiple, separate mesh boundaries. However, the assignment of distinct boundary IDs for the different facets is essential for the automatic generation of boundary coordinates in the <a href="../../../interaction/unstructured_three_d_fsi/html/index.html">corresponding fluid-structure interaction problem </a> and is therefore <b>strongly recommended</b>.</p>
<p><a href="http://wias-berlin.de/software/tetgen//"><code>Tetgen</code> </a> generates an unstructured volumetric mesh from the information contained in the <code>*.poly</code> file and outputs the mesh's nodes, elements and faces in the files</p><ul>
<li><a href="../../../../demo_drivers/navier_stokes/unstructured_three_d_fluid/fsi_bifurcation_fluid.1.node">demo_drivers/navier_stokes/unstructured_three_d_fluid/fsi_bifurcation_fluid.1.node</a></li>
<li><a href="../../../../demo_drivers/navier_stokes/unstructured_three_d_fluid/fsi_bifurcation_fluid.1.ele">demo_drivers/navier_stokes/unstructured_three_d_fluid/fsi_bifurcation_fluid.1.ele</a></li>
<li><a href="../../../../demo_drivers/navier_stokes/unstructured_three_d_fluid/fsi_bifurcation_fluid.1.face">demo_drivers/navier_stokes/unstructured_three_d_fluid/fsi_bifurcation_fluid.1.face</a></li>
</ul>
<p>These files can be used as input to <code>oomph-lib's</code> <code>TetgenMesh</code> class, using the procedure discussed in <a href="../../../meshes/mesh_from_tetgen/html/index.html">another tutorial.</a></p>
<p>The figure below shows a <code>tetview</code> plot of the mesh, created with a volume constraint of 0.2 (i.e. the maximum volume of each tetrahedron is guaranteed to be less than 0.2 units), using the command </p><div class="fragment"><div class="line">tetgen -a0.2 fsi_bifurcation_fluid.poly </div>
</div><!-- fragment --><div class="image">
<img src="mesh_boundaries.gif" alt=""/>
<div class="caption">
Plot of the mesh, generated by tetgen. </div></div>
 <p>Note how <a href="http://wias-berlin.de/software/tetgen//"><code>tetgen</code> </a> has subdivided each of the 15 original facets specified in the <code>*.poly</code> file into a surface triangulation. The nodes and tetrahedral elements that are located on (or adjacent to) the 15 original facets inherit their boundary IDs. This is important when we assign the boundary conditions for the actual computation.</p>
<hr  />
 <hr  />
<h1><a class="anchor" id="results"></a>
Results</h1>
<p>The plot shown below illustrates the flow field (streamribbons coloured by pressure contours) for a Reynolds number of <img class="formulaInl" alt="$ Re = 100. $" src="form_7.png" width="54" height="10"/> The transparent faces show the boundaries of the fluid elements and illustrate that the mesh is very coarse. As a result, the flow is clearly under-resolved, particularly near the two outflow cross-sections where the imposition of parallel outflow forces the fluid velocity to re-adjust rapidly as it approaches the outlet. (See <a class="el" href="index.html#finer_mesh">Creating a finer mesh and applying more appropriate outflow boundary conditions</a> in <a class="el" href="index.html#comm_ex">Comments and Exercises</a> for a more detailed discussion of this aspect.)</p>
<div class="image">
<img src="flow_with_stream_ribbons.gif" alt=""/>
<div class="caption">
Flowfield (streamribbons, coloured by the pressure contours) and element boundaries. </div></div>
 <hr  />
 <hr  />
<h1><a class="anchor" id="namespace"></a>
Problem parameters</h1>
<p>As usual we define the various problem parameters in a global namespace. We define the Reynolds number and specify the tractions to be applied at the in- and outflow cross-sections:</p>
 <div class="fragment"><div class="line"><span class="comment">//=======start_namespace==========================================</span></div>
<div class="line"><span class="comment">/// Global variables</span></div>
<div class="line"><span class="comment"></span><span class="comment">//================================================================</span></div>
<div class="line"><span class="keyword">namespace </span><a class="code" href="namespaceGlobal__Parameters.html">Global_Parameters</a></div>
<div class="line">{</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Default Reynolds number</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="namespaceGlobal__Parameters.html#a9d72e94a9305c6a310940a6a427ebe06">Re</a>=100.0;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Fluid pressure on inflow boundary</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="namespaceGlobal__Parameters.html#a05b26d00935600b5e0149872844f224c">P_in</a>=0.5;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Applied traction on fluid at the inflow boundary</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="namespaceGlobal__Parameters.html#af7faf65214ed9ead637f7c208addb095">prescribed_inflow_traction</a>(<span class="keyword">const</span> <span class="keywordtype">double</span>&amp; t,</div>
<div class="line">                                 <span class="keyword">const</span> Vector&lt;double&gt;&amp; x,</div>
<div class="line">                                 <span class="keyword">const</span> Vector&lt;double&gt;&amp; n,</div>
<div class="line">                                 Vector&lt;double&gt;&amp; traction)</div>
<div class="line"> {</div>
<div class="line">  traction[0]=0.0;</div>
<div class="line">  traction[1]=0.0;</div>
<div class="line">  traction[2]=<a class="code" href="namespaceGlobal__Parameters.html#a05b26d00935600b5e0149872844f224c">P_in</a>;</div>
<div class="line"> } </div>
<div class="line"> </div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Fluid pressure on outflow boundary</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="namespaceGlobal__Parameters.html#ac680ed856897793d54c9c867da19169c">P_out</a>=-0.5; </div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Applied traction on fluid at the inflow boundary</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="namespaceGlobal__Parameters.html#a83155358b144cff7e29ecb6b209a2d3e">prescribed_outflow_traction</a>(<span class="keyword">const</span> <span class="keywordtype">double</span>&amp; t,</div>
<div class="line">                                  <span class="keyword">const</span> Vector&lt;double&gt;&amp; x,</div>
<div class="line">                                  <span class="keyword">const</span> Vector&lt;double&gt;&amp; n,</div>
<div class="line">                                  Vector&lt;double&gt;&amp; traction)</div>
<div class="line"> {</div>
<div class="line">  traction[0]=0.0;</div>
<div class="line">  traction[1]=0.0;</div>
<div class="line">  traction[2]=-<a class="code" href="namespaceGlobal__Parameters.html#ac680ed856897793d54c9c867da19169c">P_out</a>;</div>
<div class="line"> } </div>
<div class="line"> </div>
<div class="line">} <span class="comment">//end namespace</span></div>
<div class="ttc" id="anamespaceGlobal__Parameters_html"><div class="ttname"><a href="namespaceGlobal__Parameters.html">Global_Parameters</a></div><div class="ttdoc">/////////////////////////////////////////////////////////////// /////////////////////////////////////...</div><div class="ttdef"><b>Definition:</b> <a href="unstructured__three__d__fluid_8cc_source.html#l00051">unstructured_three_d_fluid.cc:52</a></div></div>
<div class="ttc" id="anamespaceGlobal__Parameters_html_a05b26d00935600b5e0149872844f224c"><div class="ttname"><a href="namespaceGlobal__Parameters.html#a05b26d00935600b5e0149872844f224c">Global_Parameters::P_in</a></div><div class="ttdeci">double P_in</div><div class="ttdoc">Fluid pressure on inflow boundary.</div><div class="ttdef"><b>Definition:</b> <a href="unstructured__three__d__fluid_8cc_source.html#l00058">unstructured_three_d_fluid.cc:58</a></div></div>
<div class="ttc" id="anamespaceGlobal__Parameters_html_a83155358b144cff7e29ecb6b209a2d3e"><div class="ttname"><a href="namespaceGlobal__Parameters.html#a83155358b144cff7e29ecb6b209a2d3e">Global_Parameters::prescribed_outflow_traction</a></div><div class="ttdeci">void prescribed_outflow_traction(const double &amp;t, const Vector&lt; double &gt; &amp;x, const Vector&lt; double &gt; &amp;n, Vector&lt; double &gt; &amp;traction)</div><div class="ttdoc">Applied traction on fluid at the inflow boundary.</div><div class="ttdef"><b>Definition:</b> <a href="unstructured__three__d__fluid_8cc_source.html#l00076">unstructured_three_d_fluid.cc:76</a></div></div>
<div class="ttc" id="anamespaceGlobal__Parameters_html_a9d72e94a9305c6a310940a6a427ebe06"><div class="ttname"><a href="namespaceGlobal__Parameters.html#a9d72e94a9305c6a310940a6a427ebe06">Global_Parameters::Re</a></div><div class="ttdeci">double Re</div><div class="ttdoc">Default Reynolds number.</div><div class="ttdef"><b>Definition:</b> <a href="unstructured__three__d__fluid_8cc_source.html#l00055">unstructured_three_d_fluid.cc:55</a></div></div>
<div class="ttc" id="anamespaceGlobal__Parameters_html_ac680ed856897793d54c9c867da19169c"><div class="ttname"><a href="namespaceGlobal__Parameters.html#ac680ed856897793d54c9c867da19169c">Global_Parameters::P_out</a></div><div class="ttdeci">double P_out</div><div class="ttdoc">Fluid pressure on outflow boundary.</div><div class="ttdef"><b>Definition:</b> <a href="unstructured__three__d__fluid_8cc_source.html#l00073">unstructured_three_d_fluid.cc:73</a></div></div>
<div class="ttc" id="anamespaceGlobal__Parameters_html_af7faf65214ed9ead637f7c208addb095"><div class="ttname"><a href="namespaceGlobal__Parameters.html#af7faf65214ed9ead637f7c208addb095">Global_Parameters::prescribed_inflow_traction</a></div><div class="ttdeci">void prescribed_inflow_traction(const double &amp;t, const Vector&lt; double &gt; &amp;x, const Vector&lt; double &gt; &amp;n, Vector&lt; double &gt; &amp;traction)</div><div class="ttdoc">Applied traction on fluid at the inflow boundary.</div><div class="ttdef"><b>Definition:</b> <a href="unstructured__three__d__fluid_8cc_source.html#l00061">unstructured_three_d_fluid.cc:61</a></div></div>
</div><!-- fragment --> <hr  />
 <hr  />
<h1><a class="anchor" id="main"></a>
The driver code</h1>
<p>We specify an output directory, create the <code>Problem</code> object using ten-node tetrahedral Taylor-Hood elements, and output the initial guess for the flow field:</p>
<div class="fragment"><div class="line"><span class="comment">//=============start_main=================================================</span></div>
<div class="line"><span class="comment">/// Demonstrate how to solve an unstructured 3D fluids problem</span></div>
<div class="line"><span class="comment"></span><span class="comment">//========================================================================</span></div>
<div class="line"><span class="keywordtype">int</span> <a class="code" href="unstructured__three__d__fluid_8cc.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a>(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv)</div>
<div class="line">{</div>
<div class="line"> <span class="comment">// Store command line arguments</span></div>
<div class="line"> CommandLineArgs::setup(argc,argv);</div>
<div class="line">  </div>
<div class="line"> <span class="comment">// Label for output</span></div>
<div class="line"> DocInfo doc_info;</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Parameter study</span></div>
<div class="line"> <span class="keywordtype">double</span> Re_increment=100.0;</div>
<div class="line"> <span class="keywordtype">unsigned</span> nstep=4;</div>
<div class="line"> <span class="keywordflow">if</span> (CommandLineArgs::Argc==2)</div>
<div class="line">  {</div>
<div class="line">   std::cout &lt;&lt; <span class="stringliteral">&quot;Validation -- only doing two steps&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">   nstep=2;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> <span class="comment">//Taylor--Hood</span></div>
<div class="line"> {</div>
<div class="line">  <span class="comment">// Output directory</span></div>
<div class="line">  doc_info.set_directory(<span class="stringliteral">&quot;RESLT_TH&quot;</span>);</div>
<div class="line">  </div>
<div class="line">  <span class="comment">//Set up the problem</span></div>
<div class="line">  <a class="code" href="classUnstructuredFluidProblem.html">UnstructuredFluidProblem&lt;TTaylorHoodElement&lt;3&gt;</a> &gt; problem;</div>
<div class="line">  </div>
<div class="line">  <span class="comment">//Output initial guess</span></div>
<div class="line">  problem.<a class="code" href="classUnstructuredFluidProblem.html#abcc9f0065665ae5239988b1a812e3f78">doc_solution</a>(doc_info);</div>
<div class="line">  doc_info.number()++;   </div>
<div class="ttc" id="aclassUnstructuredFluidProblem_html"><div class="ttname"><a href="classUnstructuredFluidProblem.html">UnstructuredFluidProblem</a></div><div class="ttdoc">Unstructured fluid problem.</div><div class="ttdef"><b>Definition:</b> <a href="unstructured__three__d__fluid_8cc_source.html#l00097">unstructured_three_d_fluid.cc:98</a></div></div>
<div class="ttc" id="aclassUnstructuredFluidProblem_html_abcc9f0065665ae5239988b1a812e3f78"><div class="ttname"><a href="classUnstructuredFluidProblem.html#abcc9f0065665ae5239988b1a812e3f78">UnstructuredFluidProblem::doc_solution</a></div><div class="ttdeci">void doc_solution(DocInfo &amp;doc_info)</div><div class="ttdoc">Doc the solution.</div><div class="ttdef"><b>Definition:</b> <a href="unstructured__three__d__fluid_8cc_source.html#l00384">unstructured_three_d_fluid.cc:384</a></div></div>
<div class="ttc" id="aunstructured__three__d__fluid_8cc_html_a3c04138a5bfe5d72780bb7e82a18e627"><div class="ttname"><a href="unstructured__three__d__fluid_8cc.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a></div><div class="ttdeci">int main(int argc, char **argv)</div><div class="ttdoc">Demonstrate how to solve an unstructured 3D fluids problem.</div><div class="ttdef"><b>Definition:</b> <a href="unstructured__three__d__fluid_8cc_source.html#l00411">unstructured_three_d_fluid.cc:411</a></div></div>
</div><!-- fragment --><p> Next we perform a parameter study in which we increase the Reynolds number of the flow &ndash; corresponding to an increase in the applied pressure drop. (As usual we perform a smaller number of steps in a validation run &ndash; performed when the code is run with nonzero number of command-line arguments.)</p>
<div class="fragment"><div class="line">  </div>
<div class="line">  <span class="comment">// Parameter study: Crank up the pressure drop along the vessel</span></div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> istep=0;istep&lt;nstep;istep++)</div>
<div class="line">   {</div>
<div class="line">    <span class="comment">// Solve the problem</span></div>
<div class="line">    problem.newton_solve();</div>
<div class="line">    </div>
<div class="line">    <span class="comment">//Output solution</span></div>
<div class="line">    problem.<a class="code" href="classUnstructuredFluidProblem.html#abcc9f0065665ae5239988b1a812e3f78">doc_solution</a>(doc_info);</div>
<div class="line">    doc_info.number()++;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Bump up Reynolds number (equivalent to increasing the imposed pressure</span></div>
<div class="line">    <span class="comment">// drop)</span></div>
<div class="line">    <a class="code" href="namespaceGlobal__Parameters.html#a9d72e94a9305c6a310940a6a427ebe06">Global_Parameters::Re</a>+=Re_increment;   </div>
<div class="line">   }</div>
<div class="line"> }</div>
<div class="line"> </div>
<div class="line"> <span class="comment">//Crouzeix Raviart</span></div>
<div class="line"> {</div>
<div class="line">  <span class="comment">//Reset to default Reynolds number</span></div>
<div class="line">  <a class="code" href="namespaceGlobal__Parameters.html#a9d72e94a9305c6a310940a6a427ebe06">Global_Parameters::Re</a> = 100.0;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">//Reset doc info number</span></div>
<div class="line">  doc_info.number()=0;   </div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Output directory</span></div>
<div class="line">  doc_info.set_directory(<span class="stringliteral">&quot;RESLT_CR&quot;</span>);</div>
<div class="line">  </div>
<div class="line">  <span class="comment">//Set up the problem</span></div>
<div class="line">  <a class="code" href="classUnstructuredFluidProblem.html">UnstructuredFluidProblem&lt;TCrouzeixRaviartElement&lt;3&gt;</a> &gt; problem;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">//Output initial guess</span></div>
<div class="line">  problem.<a class="code" href="classUnstructuredFluidProblem.html#abcc9f0065665ae5239988b1a812e3f78">doc_solution</a>(doc_info);</div>
<div class="line">  doc_info.number()++;   </div>
<div class="line">  </div>
<div class="line">  <span class="comment">// Parameter study: Crank up the pressure drop along the vessel</span></div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> istep=0;istep&lt;nstep;istep++)</div>
<div class="line">   {</div>
<div class="line">    <span class="comment">// Solve the problem</span></div>
<div class="line">    problem.newton_solve();</div>
<div class="line">    </div>
<div class="line">    <span class="comment">//Output solution</span></div>
<div class="line">    problem.<a class="code" href="classUnstructuredFluidProblem.html#abcc9f0065665ae5239988b1a812e3f78">doc_solution</a>(doc_info);</div>
<div class="line">    doc_info.number()++;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Bump up Reynolds number (equivalent to increasing the imposed pressure</span></div>
<div class="line">    <span class="comment">// drop)</span></div>
<div class="line">    <a class="code" href="namespaceGlobal__Parameters.html#a9d72e94a9305c6a310940a6a427ebe06">Global_Parameters::Re</a>+=Re_increment;   </div>
<div class="line">   }</div>
<div class="line"> }</div>
<div class="line"> </div>
<div class="line">} <span class="comment">// end_of_main</span></div>
</div><!-- fragment --><hr  />
 <hr  />
<h1><a class="anchor" id="class"></a>
The Problem class</h1>
<p>The <code>Problem</code> class has the usual member functions and provides explicit storage for the fluid mesh and the meshes containing the <code>FaceElements</code> that apply the traction conditions at the in- and outflow boundaries. We also provide storage for the IDs of the mesh boundaries that constitute the in- and outflow boundaries to facilitate the application of the boundary conditions.</p>
 <div class="fragment"><div class="line"><span class="comment">//======start_problem_class===========================================</span></div>
<div class="line"><span class="comment">/// Unstructured fluid problem</span></div>
<div class="line"><span class="comment"></span><span class="comment">//====================================================================</span></div>
<div class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> ELEMENT&gt;</div>
<div class="line"><span class="keyword">class </span><a class="code" href="classUnstructuredFluidProblem.html">UnstructuredFluidProblem</a> : <span class="keyword">public</span> Problem</div>
<div class="line">{</div>
<div class="line"> </div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Constructor: </span></div>
<div class="line"><span class="comment"></span> <a class="code" href="classUnstructuredFluidProblem.html#a9751f4afac540e148b3d90ae43dd5187">UnstructuredFluidProblem</a>();</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Destructor (empty)</span></div>
<div class="line"><span class="comment"></span> <a class="code" href="classUnstructuredFluidProblem.html#a4d660faa6bae35197a4ea73139ac9963">~UnstructuredFluidProblem</a>(){}</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Doc the solution</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classUnstructuredFluidProblem.html#abcc9f0065665ae5239988b1a812e3f78">doc_solution</a>(DocInfo&amp; doc_info);</div>
<div class="line"> <span class="comment"></span></div>
<div class="line"><span class="comment"> /// Return total number of fluid inflow traction boundaries</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">unsigned</span> <a class="code" href="classUnstructuredFluidProblem.html#a8afc18327561107094fa94f2918a385f">nfluid_inflow_traction_boundary</a>()</div>
<div class="line">  {</div>
<div class="line">   <span class="keywordflow">return</span> <a class="code" href="classUnstructuredFluidProblem.html#a2923e009bcea7cdbdd7ea5788580a3f8">Inflow_boundary_id</a>.size();</div>
<div class="line">  }</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Return total number of fluid outflow traction boundaries</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">unsigned</span> <a class="code" href="classUnstructuredFluidProblem.html#abcaa700f2e0e1b2097e7dc25fe087862">nfluid_outflow_traction_boundary</a>()</div>
<div class="line">  {</div>
<div class="line">   <span class="keywordflow">return</span> <a class="code" href="classUnstructuredFluidProblem.html#a9bace139103152045dfe88e3d0163811">Outflow_boundary_id</a>.size();</div>
<div class="line">  }</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Return total number of fluid outflow traction boundaries</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">unsigned</span> <a class="code" href="classUnstructuredFluidProblem.html#ae04e768e915a5e097527cea22558203d">nfluid_traction_boundary</a>()</div>
<div class="line">  {</div>
<div class="line">   <span class="keywordflow">return</span> <a class="code" href="classUnstructuredFluidProblem.html#a2923e009bcea7cdbdd7ea5788580a3f8">Inflow_boundary_id</a>.size()+<a class="code" href="classUnstructuredFluidProblem.html#a9bace139103152045dfe88e3d0163811">Outflow_boundary_id</a>.size();</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> <span class="comment">//private:</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Create fluid traction elements at inflow</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classUnstructuredFluidProblem.html#ae95f1912572e8a5f0543eab9c0eb2634">create_fluid_traction_elements</a>();</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Bulk fluid mesh</span></div>
<div class="line"><span class="comment"></span> TetgenMesh&lt;ELEMENT&gt;* <a class="code" href="classUnstructuredFluidProblem.html#ade90cb92dd49b9d897ed538b1876b060">Fluid_mesh_pt</a>;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Meshes of fluid traction elements that apply pressure at in/outflow</span></div>
<div class="line"><span class="comment"></span> Vector&lt;Mesh*&gt; <a class="code" href="classUnstructuredFluidProblem.html#ad2fd96c077dbc69077daaf20a314896c">Fluid_traction_mesh_pt</a>;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// IDs of fluid mesh boundaries along which inflow boundary conditions</span></div>
<div class="line"><span class="comment"> /// are applied</span></div>
<div class="line"><span class="comment"></span> Vector&lt;unsigned&gt; <a class="code" href="classUnstructuredFluidProblem.html#a2923e009bcea7cdbdd7ea5788580a3f8">Inflow_boundary_id</a>;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// IDs of fluid mesh boundaries along which inflow boundary conditions</span></div>
<div class="line"><span class="comment"> /// are applied</span></div>
<div class="line"><span class="comment"></span> Vector&lt;unsigned&gt; <a class="code" href="classUnstructuredFluidProblem.html#a9bace139103152045dfe88e3d0163811">Outflow_boundary_id</a>;</div>
<div class="line"> </div>
<div class="line">};</div>
<div class="ttc" id="aclassUnstructuredFluidProblem_html_a2923e009bcea7cdbdd7ea5788580a3f8"><div class="ttname"><a href="classUnstructuredFluidProblem.html#a2923e009bcea7cdbdd7ea5788580a3f8">UnstructuredFluidProblem::Inflow_boundary_id</a></div><div class="ttdeci">Vector&lt; unsigned &gt; Inflow_boundary_id</div><div class="ttdoc">IDs of fluid mesh boundaries along which inflow boundary conditions are applied.</div><div class="ttdef"><b>Definition:</b> <a href="unstructured__three__d__fluid_8cc_source.html#l00142">unstructured_three_d_fluid.cc:142</a></div></div>
<div class="ttc" id="aclassUnstructuredFluidProblem_html_a4d660faa6bae35197a4ea73139ac9963"><div class="ttname"><a href="classUnstructuredFluidProblem.html#a4d660faa6bae35197a4ea73139ac9963">UnstructuredFluidProblem::~UnstructuredFluidProblem</a></div><div class="ttdeci">~UnstructuredFluidProblem()</div><div class="ttdoc">Destructor (empty)</div><div class="ttdef"><b>Definition:</b> <a href="unstructured__three__d__fluid_8cc_source.html#l00106">unstructured_three_d_fluid.cc:106</a></div></div>
<div class="ttc" id="aclassUnstructuredFluidProblem_html_a8afc18327561107094fa94f2918a385f"><div class="ttname"><a href="classUnstructuredFluidProblem.html#a8afc18327561107094fa94f2918a385f">UnstructuredFluidProblem::nfluid_inflow_traction_boundary</a></div><div class="ttdeci">unsigned nfluid_inflow_traction_boundary()</div><div class="ttdoc">Return total number of fluid inflow traction boundaries.</div><div class="ttdef"><b>Definition:</b> <a href="unstructured__three__d__fluid_8cc_source.html#l00112">unstructured_three_d_fluid.cc:112</a></div></div>
<div class="ttc" id="aclassUnstructuredFluidProblem_html_a9751f4afac540e148b3d90ae43dd5187"><div class="ttname"><a href="classUnstructuredFluidProblem.html#a9751f4afac540e148b3d90ae43dd5187">UnstructuredFluidProblem::UnstructuredFluidProblem</a></div><div class="ttdeci">UnstructuredFluidProblem()</div><div class="ttdoc">Constructor:</div><div class="ttdef"><b>Definition:</b> <a href="unstructured__three__d__fluid_8cc_source.html#l00156">unstructured_three_d_fluid.cc:156</a></div></div>
<div class="ttc" id="aclassUnstructuredFluidProblem_html_a9bace139103152045dfe88e3d0163811"><div class="ttname"><a href="classUnstructuredFluidProblem.html#a9bace139103152045dfe88e3d0163811">UnstructuredFluidProblem::Outflow_boundary_id</a></div><div class="ttdeci">Vector&lt; unsigned &gt; Outflow_boundary_id</div><div class="ttdoc">IDs of fluid mesh boundaries along which inflow boundary conditions are applied.</div><div class="ttdef"><b>Definition:</b> <a href="unstructured__three__d__fluid_8cc_source.html#l00146">unstructured_three_d_fluid.cc:146</a></div></div>
<div class="ttc" id="aclassUnstructuredFluidProblem_html_abcaa700f2e0e1b2097e7dc25fe087862"><div class="ttname"><a href="classUnstructuredFluidProblem.html#abcaa700f2e0e1b2097e7dc25fe087862">UnstructuredFluidProblem::nfluid_outflow_traction_boundary</a></div><div class="ttdeci">unsigned nfluid_outflow_traction_boundary()</div><div class="ttdoc">Return total number of fluid outflow traction boundaries.</div><div class="ttdef"><b>Definition:</b> <a href="unstructured__three__d__fluid_8cc_source.html#l00118">unstructured_three_d_fluid.cc:118</a></div></div>
<div class="ttc" id="aclassUnstructuredFluidProblem_html_ad2fd96c077dbc69077daaf20a314896c"><div class="ttname"><a href="classUnstructuredFluidProblem.html#ad2fd96c077dbc69077daaf20a314896c">UnstructuredFluidProblem::Fluid_traction_mesh_pt</a></div><div class="ttdeci">Vector&lt; Mesh * &gt; Fluid_traction_mesh_pt</div><div class="ttdoc">Meshes of fluid traction elements that apply pressure at in/outflow.</div><div class="ttdef"><b>Definition:</b> <a href="unstructured__three__d__fluid_8cc_source.html#l00138">unstructured_three_d_fluid.cc:138</a></div></div>
<div class="ttc" id="aclassUnstructuredFluidProblem_html_ade90cb92dd49b9d897ed538b1876b060"><div class="ttname"><a href="classUnstructuredFluidProblem.html#ade90cb92dd49b9d897ed538b1876b060">UnstructuredFluidProblem::Fluid_mesh_pt</a></div><div class="ttdeci">TetgenMesh&lt; ELEMENT &gt; * Fluid_mesh_pt</div><div class="ttdoc">Bulk fluid mesh.</div><div class="ttdef"><b>Definition:</b> <a href="unstructured__three__d__fluid_8cc_source.html#l00135">unstructured_three_d_fluid.cc:135</a></div></div>
<div class="ttc" id="aclassUnstructuredFluidProblem_html_ae04e768e915a5e097527cea22558203d"><div class="ttname"><a href="classUnstructuredFluidProblem.html#ae04e768e915a5e097527cea22558203d">UnstructuredFluidProblem::nfluid_traction_boundary</a></div><div class="ttdeci">unsigned nfluid_traction_boundary()</div><div class="ttdoc">Return total number of fluid outflow traction boundaries.</div><div class="ttdef"><b>Definition:</b> <a href="unstructured__three__d__fluid_8cc_source.html#l00124">unstructured_three_d_fluid.cc:124</a></div></div>
<div class="ttc" id="aclassUnstructuredFluidProblem_html_ae95f1912572e8a5f0543eab9c0eb2634"><div class="ttname"><a href="classUnstructuredFluidProblem.html#ae95f1912572e8a5f0543eab9c0eb2634">UnstructuredFluidProblem::create_fluid_traction_elements</a></div><div class="ttdeci">void create_fluid_traction_elements()</div><div class="ttdoc">Create fluid traction elements at inflow.</div><div class="ttdef"><b>Definition:</b> <a href="unstructured__three__d__fluid_8cc_source.html#l00313">unstructured_three_d_fluid.cc:313</a></div></div>
</div><!-- fragment --><hr  />
 <hr  />
<h1><a class="anchor" id="constructor"></a>
The Problem constructor</h1>
<p>We start by building the fluid mesh, using the files created by <a href="http://wias-berlin.de/software/tetgen//"><code>tetgen</code> </a>:</p>
<div class="fragment"><div class="line"><span class="comment">//==========start_constructor=============================================</span></div>
<div class="line"><span class="comment">/// Constructor for unstructured 3D fluid problem</span></div>
<div class="line"><span class="comment"></span><span class="comment">//========================================================================</span></div>
<div class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> ELEMENT&gt;</div>
<div class="line"><a class="code" href="classUnstructuredFluidProblem.html#a9751f4afac540e148b3d90ae43dd5187">UnstructuredFluidProblem&lt;ELEMENT&gt;::UnstructuredFluidProblem</a>()</div>
<div class="line">{ </div>
<div class="line"> </div>
<div class="line"> <span class="comment">//Create fluid bulk mesh, sub-dividing &quot;corner&quot; elements</span></div>
<div class="line"> <span class="keywordtype">string</span> node_file_name=<span class="stringliteral">&quot;fsi_bifurcation_fluid.1.node&quot;</span>;</div>
<div class="line"> <span class="keywordtype">string</span> element_file_name=<span class="stringliteral">&quot;fsi_bifurcation_fluid.1.ele&quot;</span>;</div>
<div class="line"> <span class="keywordtype">string</span> face_file_name=<span class="stringliteral">&quot;fsi_bifurcation_fluid.1.face&quot;</span>;</div>
<div class="line"> <span class="keywordtype">bool</span> split_corner_elements=<span class="keyword">true</span>;</div>
<div class="line"> Fluid_mesh_pt =  <span class="keyword">new</span> TetgenMesh&lt;ELEMENT&gt;(node_file_name,</div>
<div class="line">                                          element_file_name,</div>
<div class="line">                                          face_file_name,</div>
<div class="line">                                          split_corner_elements);</div>
</div><!-- fragment --><p> (We refer to the subsection <a class="el" href="index.html#split">Splitting corner elements in unstructured meshes to avoid locking</a> in the section <a class="el" href="index.html#comm_ex">Comments and Exercises</a> for a discussion of the <code>split_corner_elements</code> flag).</p>
<p>Next, we set up the boundary lookup schemes that determine which elements are located next to which domain boundaries, and specify the IDs of the mesh boundaries that coincide with the in- and outflow cross-sections. Note that this information reflects the specification of the boundary IDs in the <code>tetgen</code> <code>*.poly</code> file.</p>
<div class="fragment"><div class="line"> </div>
<div class="line"> <span class="comment">// Find elements next to boundaries</span></div>
<div class="line"> <span class="comment">//Fluid_mesh_pt-&gt;setup_boundary_element_info();</span></div>
<div class="line"> </div>
<div class="line"> <span class="comment">// The following corresponds to the boundaries as specified by</span></div>
<div class="line"> <span class="comment">// facets in the tetgen input:</span></div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Fluid mesh has one inflow boundary: Boundary 0</span></div>
<div class="line"> Inflow_boundary_id.resize(1);</div>
<div class="line"> Inflow_boundary_id[0]=0;</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Fluid mesh has two outflow boundaries: Boundaries 1 and 2</span></div>
<div class="line"> Outflow_boundary_id.resize(2);</div>
<div class="line"> Outflow_boundary_id[0]=1;</div>
<div class="line"> Outflow_boundary_id[1]=2;</div>
</div><!-- fragment --><p> Next we apply the boundary conditions. We impose parallel in- and outflow by pinning the transverse velocities at all nodes that are located on the in- and outflow boundaries, identifying the nodes via the boundary IDs just set up. We use the boolean map <code>done</code> to indicate which boundaries we have visited already.</p>
<div class="fragment"><div class="line"> </div>
<div class="line"> <span class="comment">// Apply BCs</span></div>
<div class="line"> <span class="comment">//----------</span></div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Map to indicate which boundary has been done</span></div>
<div class="line"> std::map&lt;unsigned,bool&gt; done; </div>
<div class="line">  </div>
<div class="line"> <span class="comment">// Loop over inflow/outflow boundaries to impose parallel flow</span></div>
<div class="line"> <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> in_out=0;in_out&lt;2;in_out++)</div>
<div class="line">  {</div>
<div class="line">   <span class="comment">// Loop over in/outflow boundaries</span></div>
<div class="line">   <span class="keywordtype">unsigned</span> n=nfluid_inflow_traction_boundary();</div>
<div class="line">   <span class="keywordflow">if</span> (in_out==1) n=nfluid_outflow_traction_boundary();</div>
<div class="line">   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i=0;i&lt;n;i++)</div>
<div class="line">    {</div>
<div class="line">     <span class="comment">// Get boundary ID</span></div>
<div class="line">     <span class="keywordtype">unsigned</span> b=0;</div>
<div class="line">     <span class="keywordflow">if</span> (in_out==0)</div>
<div class="line">      {</div>
<div class="line">       b=Inflow_boundary_id[i];</div>
<div class="line">      }</div>
<div class="line">     <span class="keywordflow">else</span></div>
<div class="line">      {</div>
<div class="line">       b=Outflow_boundary_id[i];</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">     <span class="comment">// Number of nodes on that boundary</span></div>
<div class="line">     <span class="keywordtype">unsigned</span> num_nod=Fluid_mesh_pt-&gt;nboundary_node(b);</div>
<div class="line">     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> inod=0;inod&lt;num_nod;inod++)</div>
<div class="line">      {</div>
<div class="line">       <span class="comment">// Get the node</span></div>
<div class="line">       Node* nod_pt=Fluid_mesh_pt-&gt;boundary_node_pt(b,inod);</div>
<div class="line">       </div>
<div class="line">       <span class="comment">// Pin transverse velocities</span></div>
<div class="line">       nod_pt-&gt;pin(0);</div>
<div class="line">       nod_pt-&gt;pin(1);</div>
<div class="line">      }</div>
<div class="line">     </div>
<div class="line">     <span class="comment">// Done!</span></div>
<div class="line">     done[b]=<span class="keyword">true</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">  } <span class="comment">// done in and outflow</span></div>
</div><!-- fragment --><p> The nodes on all other boundaries (i.e. the ones for which <code>done</code>[b] is still <code>false</code>) are subjected to no-slip conditions by pinning all three velocity components. (This approach facilitates the "extension" of the mesh discussed in section <a class="el" href="index.html#finer_mesh">Creating a finer mesh and applying more appropriate outflow boundary conditions</a>, but we note that, in general, keeping track of the boundary IDs associated with each physical boundary must be done "by hand". )</p>
<div class="fragment"><div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Loop over all fluid mesh boundaries and pin velocities</span></div>
<div class="line"> <span class="comment">// of nodes that haven&#39;t been dealt with yet</span></div>
<div class="line"> <span class="keywordtype">unsigned</span> nbound=Fluid_mesh_pt-&gt;nboundary();</div>
<div class="line"> <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> b=0;b&lt;nbound;b++)</div>
<div class="line">  {</div>
<div class="line"> </div>
<div class="line">   <span class="comment">// Has the boundary been done yet?</span></div>
<div class="line">   <span class="keywordflow">if</span> (!done[b])</div>
<div class="line">    {</div>
<div class="line">     <span class="keywordtype">unsigned</span> num_nod=Fluid_mesh_pt-&gt;nboundary_node(b);</div>
<div class="line">     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> inod=0;inod&lt;num_nod;inod++)</div>
<div class="line">      {</div>
<div class="line">       <span class="comment">// Get node</span></div>
<div class="line">       Node* nod_pt= Fluid_mesh_pt-&gt;boundary_node_pt(b,inod);</div>
<div class="line">       </div>
<div class="line">       <span class="comment">// Pin all velocities</span></div>
<div class="line">       nod_pt-&gt;pin(0); </div>
<div class="line">       nod_pt-&gt;pin(1); </div>
<div class="line">       nod_pt-&gt;pin(2); </div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">  } <span class="comment">// done no slip elsewhere </span></div>
</div><!-- fragment --><p> We complete the build of the Navier-Stokes elements by specifying the pointer to the Reynolds number,</p>
<div class="fragment"><div class="line"> </div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Complete the build of the fluid elements so they are fully functional</span></div>
<div class="line"> <span class="comment">//----------------------------------------------------------------------</span></div>
<div class="line"> <span class="keywordtype">unsigned</span> n_element = Fluid_mesh_pt-&gt;nelement();</div>
<div class="line"> <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> e=0;e&lt;n_element;e++)</div>
<div class="line">  {</div>
<div class="line"> </div>
<div class="line">   <span class="comment">// Upcast from GeneralisedElement to the present element</span></div>
<div class="line">   ELEMENT* el_pt = <span class="keyword">dynamic_cast&lt;</span>ELEMENT*<span class="keyword">&gt;</span>(Fluid_mesh_pt-&gt;element_pt(e));</div>
<div class="line">   </div>
<div class="line">   <span class="comment">//Set the Reynolds number</span></div>
<div class="line">   el_pt-&gt;re_pt() = &amp;<a class="code" href="namespaceGlobal__Parameters.html#a9d72e94a9305c6a310940a6a427ebe06">Global_Parameters::Re</a>;   </div>
<div class="line"> </div>
<div class="line">  } </div>
</div><!-- fragment --><p> and attach the <code>FaceElements</code> that apply the imposed in- and outflow tractions to the appropriate faces of the elements on the in- and outflow boundaries:</p>
<div class="fragment"><div class="line"> </div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Create meshes of fluid traction elements at inflow/outflow</span></div>
<div class="line"> <span class="comment">//-----------------------------------------------------------</span></div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Create the meshes</span></div>
<div class="line"> <span class="keywordtype">unsigned</span> n=nfluid_traction_boundary();</div>
<div class="line"> Fluid_traction_mesh_pt.resize(n);</div>
<div class="line"> <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i=0;i&lt;n;i++)</div>
<div class="line">  {</div>
<div class="line">   Fluid_traction_mesh_pt[i]=<span class="keyword">new</span> Mesh;</div>
<div class="line">  } </div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Populate them with elements</span></div>
<div class="line"> create_fluid_traction_elements();</div>
</div><!-- fragment --><p> Finally, we combine the various sub-meshes to a combined global mesh and assign the equation numbers.</p>
<div class="fragment"><div class="line"> </div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Combine the lot</span></div>
<div class="line"> <span class="comment">//----------------</span></div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Add sub meshes:</span></div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Fluid bulk mesh</span></div>
<div class="line"> add_sub_mesh(Fluid_mesh_pt);</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// The fluid traction meshes</span></div>
<div class="line"> n=nfluid_traction_boundary();</div>
<div class="line"> <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i=0;i&lt;n;i++)</div>
<div class="line">  { </div>
<div class="line">   add_sub_mesh(Fluid_traction_mesh_pt[i]);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Build global mesh</span></div>
<div class="line"> build_global_mesh();</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Setup equation numbering scheme</span></div>
<div class="line"> std::cout &lt;&lt;<span class="stringliteral">&quot;Number of equations: &quot;</span> &lt;&lt; assign_eqn_numbers() &lt;&lt; std::endl; </div>
<div class="line"> </div>
<div class="line">} <span class="comment">// end constructor</span></div>
</div><!-- fragment --><hr  />
 <hr  />
<h1><a class="anchor" id="traction"></a>
Creating the fluid traction elements</h1>
<p>The helper function <code>create_fluid_traction_elements()</code> loops over the bulk elements that are adjacent to the in- and outflow cross-sections and attaches <code>NavierStokesTractionElements</code> to the relevant faces. We store pointers to the newly-created elements in the appropriate meshes, and pass pointers to the functions that specify the imposed traction to the elements.</p>
<div class="fragment"><div class="line"><span class="comment">//============start_of_fluid_traction_elements==============================</span></div>
<div class="line"><span class="comment">/// Create fluid traction elements </span></div>
<div class="line"><span class="comment"></span><span class="comment">//=======================================================================</span></div>
<div class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> ELEMENT&gt;</div>
<div class="line"><span class="keywordtype">void</span> <a class="code" href="classUnstructuredFluidProblem.html#ae95f1912572e8a5f0543eab9c0eb2634">UnstructuredFluidProblem&lt;ELEMENT&gt;::create_fluid_traction_elements</a>()</div>
<div class="line">{</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Counter for number of fluid traction meshes</span></div>
<div class="line"> <span class="keywordtype">unsigned</span> count=0;</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Loop over inflow/outflow boundaries</span></div>
<div class="line"> <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> in_out=0;in_out&lt;2;in_out++)</div>
<div class="line">  {</div>
<div class="line">   <span class="comment">// Loop over boundaries with fluid traction elements</span></div>
<div class="line">   <span class="keywordtype">unsigned</span> n=nfluid_inflow_traction_boundary();</div>
<div class="line">   <span class="keywordflow">if</span> (in_out==1) n=nfluid_outflow_traction_boundary();</div>
<div class="line">   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i=0;i&lt;n;i++)</div>
<div class="line">    {</div>
<div class="line">     <span class="comment">// Get boundary ID</span></div>
<div class="line">     <span class="keywordtype">unsigned</span> b=0;</div>
<div class="line">     <span class="keywordflow">if</span> (in_out==0)</div>
<div class="line">      {</div>
<div class="line">       b=Inflow_boundary_id[i];</div>
<div class="line">      }</div>
<div class="line">     <span class="keywordflow">else</span></div>
<div class="line">      {</div>
<div class="line">       b=Outflow_boundary_id[i];</div>
<div class="line">      }</div>
<div class="line">     </div>
<div class="line">     <span class="comment">// How many bulk elements are adjacent to boundary b?</span></div>
<div class="line">     <span class="keywordtype">unsigned</span> n_element = Fluid_mesh_pt-&gt;nboundary_element(b);</div>
<div class="line">     </div>
<div class="line">     <span class="comment">// Loop over the bulk elements adjacent to boundary b</span></div>
<div class="line">     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> e=0;e&lt;n_element;e++)</div>
<div class="line">      {</div>
<div class="line">       <span class="comment">// Get pointer to the bulk element that is adjacent to boundary b</span></div>
<div class="line">       ELEMENT* bulk_elem_pt = <span class="keyword">dynamic_cast&lt;</span>ELEMENT*<span class="keyword">&gt;</span>(</div>
<div class="line">        Fluid_mesh_pt-&gt;boundary_element_pt(b,e));</div>
<div class="line">       </div>
<div class="line">       <span class="comment">//What is the index of the face of the element e along boundary b</span></div>
<div class="line">       <span class="keywordtype">int</span> face_index = Fluid_mesh_pt-&gt;face_index_at_boundary(b,e);</div>
<div class="line">       </div>
<div class="line">       <span class="comment">// Create new element </span></div>
<div class="line">       NavierStokesTractionElement&lt;ELEMENT&gt;* el_pt=</div>
<div class="line">        <span class="keyword">new</span> NavierStokesTractionElement&lt;ELEMENT&gt;(bulk_elem_pt,</div>
<div class="line">                                                       face_index);</div>
<div class="line">       </div>
<div class="line">       <span class="comment">// Add it to the mesh</span></div>
<div class="line">       Fluid_traction_mesh_pt[count]-&gt;add_element_pt(el_pt);</div>
<div class="line">       </div>
<div class="line">       <span class="comment">// Set the pointer to the prescribed traction function</span></div>
<div class="line">       <span class="keywordflow">if</span> (in_out==0)</div>
<div class="line">        {</div>
<div class="line">         el_pt-&gt;traction_fct_pt() = </div>
<div class="line">          &amp;<a class="code" href="namespaceGlobal__Parameters.html#af7faf65214ed9ead637f7c208addb095">Global_Parameters::prescribed_inflow_traction</a>;</div>
<div class="line">        }</div>
<div class="line">       <span class="keywordflow">else</span></div>
<div class="line">        {</div>
<div class="line">         el_pt-&gt;traction_fct_pt() = </div>
<div class="line">          &amp;<a class="code" href="namespaceGlobal__Parameters.html#a83155358b144cff7e29ecb6b209a2d3e">Global_Parameters::prescribed_outflow_traction</a>;</div>
<div class="line">        }</div>
<div class="line">      }</div>
<div class="line">     <span class="comment">// Bump up counter</span></div>
<div class="line">     count++;</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> } <span class="comment">// end of create_traction_elements</span></div>
</div><!-- fragment --><hr  />
 <hr  />
<h1><a class="anchor" id="doc"></a>
Post-processing</h1>
<p>The post-processing routine outputs the flow field. </p><div class="fragment"><div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment">//========================================================================</span><span class="comment"></span></div>
<div class="line"><span class="comment">/// Doc the solution</span></div>
<div class="line"><span class="comment"></span><span class="comment">//========================================================================</span></div>
<div class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> ELEMENT&gt;</div>
<div class="line"><span class="keywordtype">void</span> <a class="code" href="classUnstructuredFluidProblem.html#abcc9f0065665ae5239988b1a812e3f78">UnstructuredFluidProblem&lt;ELEMENT&gt;::doc_solution</a>(DocInfo&amp; doc_info)</div>
<div class="line">{ </div>
<div class="line"> </div>
<div class="line"> ofstream some_file;</div>
<div class="line"> <span class="keywordtype">char</span> filename[100];</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Number of plot points</span></div>
<div class="line"> <span class="keywordtype">unsigned</span> npts;</div>
<div class="line"> npts=5;</div>
<div class="line">  </div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Output fluid solution</span></div>
<div class="line"> sprintf(filename,<span class="stringliteral">&quot;%s/fluid_soln%i.dat&quot;</span>,doc_info.directory().c_str(),</div>
<div class="line">         doc_info.number());</div>
<div class="line"> some_file.open(filename);</div>
<div class="line"> Fluid_mesh_pt-&gt;output(some_file,npts);</div>
<div class="line"> some_file.close();</div>
<div class="line">  </div>
<div class="line">}</div>
</div><!-- fragment --><hr  />
 <hr  />
<h1><a class="anchor" id="comm_ex"></a>
Comments and Exercises</h1>
<hr  />
<h2><a class="anchor" id="split"></a>
Splitting corner elements in unstructured meshes to avoid locking</h2>
<p>Meshes generated by <a href="http://wias-berlin.de/software/tetgen//"><code>tetgen</code> </a> tend to be of very high quality and can usually be used without further modification. However, in Navier-Stokes computations (or other problems in which the elements have to satisfy an LBB-type stability constraint) problems can arise if too many of an element's nodes are constrained by boundary conditions, causing the discretisation to "lock". This tends to happen when three of the element's four faces are located on domain boundaries, as in the case of the top-left and bottom-left elements in the inflow cross-section shown below.</p>
<div class="image">
<img src="mesh_without_split.gif" alt=""/>
<div class="caption">
Plot of the mesh generated by tetgen. </div></div>
 <p>Ten-noded tetrahedral elements have nodes at their vertices and on their edges only. Therefore all the nodes in these particular two elements are located on domain boundaries. Furthermore, only one of these (the node halfway along the edge that traverses the inflow cross-section) is unconstrained; the imposition of parallel flow at the inflow face only constrains the node's transverse velocities. Thus, both elements have a single velocity degree of freedom (the axial velocity at the node on the inflow face) but they retain their four pressure degrees of freedom (the pressures at their vertices). This does not <em>necessarily</em> over-constrain the problem (and in the present problem it does not) &ndash; "locking", due to the presence of too many pressure degrees of freedom, arises at the level of the global, fully-assembled problem, not on an element-by-element basis. However, the presence of such elements makes the occurrence of locking more likely and we have occasionally come across examples in which locking does occur. The remedy would be to pin exactly the required number of superfluous pressure degrees of freedom (no more and no fewer!) to "unlock" the problem. However, the diagnosis of the problem is as difficult as its practical resolution: How do we determine in advance if a problem will lock and, if so, which pressures should be pinned, etc.?</p>
<p>To avoid the problem altogether, <code>oomph-lib's</code> <code>TetgenMesh</code> constructor provides an optional boolean flag, <code>split_corner_elements</code>. If this flag is set to <code>true</code>, the mesh constructor identifies all elements in which at least three faces are located on mesh boundaries. These elements are then split into four smaller ones, using a localised refinement as shown in this plot:</p>
<div class="image">
<img src="mesh_with_split.gif" alt=""/>
<div class="caption">
Plot of the mesh after splitting corner elements. </div></div>
 <p>Note that the localised refinement leads to a small deterioration in the element quality but this is usually acceptable. If you are concerned about this aspect, allow the splitting of corner elements only if locking actually occurs (see below), or try to generate a different <code>tetgen</code> mesh that does not suffer from this problem, e.g. by imposing a different volume constraint.</p>
<center> <b>How to spot "locking":</b> </center><ul>
<li>If a solution can be computed (using a direct solver) the occurrence of "locking" is easy to spot: Typically the pressure in over-constrained elements becomes extremely large while the rest of the flow field looks fairly normal. Iterative solvers may fail to converge. If you suspect that locking may have occurred, try re-computing the solution on a mesh with the <code>split_corner_elements</code> flag set to <code>true</code>.</li>
</ul>
<hr  />
<h2><a class="anchor" id="finer_mesh"></a>
Creating a finer mesh and applying more appropriate outflow boundary conditions</h2>
<p>The flow field shown in the <a class="el" href="index.html#results">Results</a> section is clearly under-resolved and a much finer mesh would have to be used to fully resolve all flow features. The problem is particularly bad because we have imposed parallel outflow (i.e. flow in the <img class="formulaInl" alt="$ z $" src="form_8.png" width="6" height="6"/>-direction) at the ends of tubes whose axes are not aligned with the <img class="formulaInl" alt="$ z $" src="form_8.png" width="6" height="6"/>-axis. This creates thin outflow boundary layers within which the flow is forced to change direction as it exits the tubes. These observations motivate the following exercises that allow you to explore unstructured mesh generation.</p>
<ul>
<li><b>Exercise 1: Refining the mesh</b> <br  />
<br  />
 Create a finer mesh by specifying a smaller volume constraint for tetgen. For instance, using <br  />
 <br  />
<div class="fragment"><div class="line">tetgen -a0.02 fsi_bifurcation_fluid.poly</div>
</div><!-- fragment --> <br  />
 will generate a much finer mesh, containing 3345 tets. Note that the driver code can remain completely unchanged. <br  />
<br  />
</li>
<li><b>Exercise 2: Add straight outflow vessels</b> <br  />
<br  />
 The imposition of parallel flow at the outlet boundaries would be less problematic if at least the final part of the two outflow tubes was aligned with the <img class="formulaInl" alt="$ z $" src="form_8.png" width="6" height="6"/>-axis. Modify the file <code><a href="../../../../demo_drivers/navier_stokes/unstructured_three_d_fluid/fsi_bifurcation_fluid.poly">fsi_bifurcation_fluid.poly</a> </code> so that two straight vessel segments, parallel to the <img class="formulaInl" alt="$ z $" src="form_8.png" width="6" height="6"/>-axis, are added to the mesh. The modification to the <code>*.poly</code> file should be straightforward. You have to add eight additional vertices and faces, and re-define the two outflow faces. <br  />
<br  />
 Here is a sample plot of a modified mesh in which two additional straight segments of different lengths have been attached to the downstream tubes. Note that the enumeration of the in- and outflow boundaries was retained, allowing the mesh to be used with the same driver code. <br  />
<br  />
<div class="image">
<img src="mesh_boundaries_extended.gif" alt=""/>
<div class="caption">
Plot of the mesh, with two straight segments added to the outflow branches. </div></div>
  <br  />
 The modified mesh was created with the file <code><a href="../../../../demo_drivers/navier_stokes/unstructured_three_d_fluid/fsi_bifurcation_fluid_with_extended_tubes.poly">fsi_bifurcation_fluid_with_extended_tubes.poly</a> </code> which you may wish to consult. However, we do encourage you to do this exercise by yourself first, in order to familiarise yourself with <code>tetgen</code> &ndash; you will notice that <code>tetgen</code> is not very forgiving (or verbose) when it encounters errors in the <code>*.poly</code> file. <br  />
<br  />
</li>
<li><b>Exercise 3: Use Lagrange multipliers to allow parallel outflow in cross-sections that are not aligned with the coordinate axes.</b> <br  />
<br  />
 The main (only?) reason why we tend to impose parallel in- or outflow in cross-sections that are aligned with the Cartesian coordinate planes is, of course, that such boundary conditions are easiest to apply in a discretisation that is based on the Cartesian form of the Navier-Stokes equations. What if we wished to impose parallel outflow from cross-sections that are not aligned with such planes? The proper way to do this is to use Lagrange multipliers to enforce the two constraints <p class="formulaDsp">
<img class="formulaDsp" alt="\[ {\bf u} \cdot {\bf t}_\alpha = 0 \mbox{\ \ \ \ for $\alpha = 1,2$,} \]" src="form_9.png" width="134" height="13"/>
</p>
 where <img class="formulaInl" alt="$ {\bf t}_\alpha $" src="form_10.png" width="13" height="11"/> (for <img class="formulaInl" alt="$\alpha = 1,2$" src="form_11.png" width="43" height="11"/>) are the two tangent vectors spanning the in- or outflow cross-sections. The imposition of these constraints requires two Lagrange multiplier fields, defined in the in-/outflow cross-sections. Physically, these Lagrange multipliers act as tangential tractions that enforce the parallel in- or outflow. The Lagrange multipliers introduce additional degrees of freedom into the problem and an implementation can be based on an extension of the existing <code>NavierStokesTractionElements</code>, using a technique similar to that used to enforce prescribed boundary displacements in solid mechanics problems, discussed in <a href="../../../solid/prescribed_displ_lagr_mult/html/index.html">another tutorial.</a> Note that, compared to the previous two exercises, this one is not entirely trivial. An implementation is provided in <code>ImposeParallelOutflowElement</code>, but, as always, it is more instructive to try to write it yourself!</li>
</ul>
<hr  />
 <hr  />
<h1><a class="anchor" id="sources"></a>
Source files for this tutorial</h1>
<ul>
<li>The source files for this tutorial are located in the directory:<br  />
<br  />
<center> <a href="../../../../demo_drivers/navier_stokes/unstructured_three_d_fluid/">demo_drivers/navier_stokes/unstructured_three_d_fluid/ </a> </center><br  />
</li>
<li>The driver code is: <br  />
<br  />
<center> <a href="../../../../demo_drivers/navier_stokes/unstructured_three_d_fluid/unstructured_three_d_fluid.cc">demo_drivers/navier_stokes/unstructured_three_d_fluid/unstructured_three_d_fluid.cc </a> </center></li>
</ul>
<hr  />
 <hr  />
 <h1><a class="anchor" id="pdf"></a>
PDF file</h1>
<p>A <a href="../latex/refman.pdf">pdf version</a> of this document is available. </p>
</div></div><!-- PageDoc -->
</div><!-- contents -->

    <!-- jQuery for Bootstrap and Doxygen -->
    <script src="../../../js/jquery-1.12.0.min.js"></script>
    <!-- Minified boostrap plugins-->
    <script src="../../../js/bootstrap.js"></script>
    <!-- Doxygen dependency to add powertips to source code-->
    <script src="../../../js/jquery.powertip.min.js"></script>
    <!-- The  following script is generated by doxygen and hides/shows levels in 
         the data structure lists and adds powertips to source code-->
    <script src="../../../js/dynsections.js" ></script>
    <!-- add to Doxygen's class names so bootstrap css and js recognises them-->
    <script type="text/javascript">
    $(".contents").addClass("container");
    $(".header").addClass("container");
    $(".navpath").addClass("container");
    $("#navrow3").addClass("container");
    $("#navrow4").addClass("container");
    $(".mlabel").addClass("label");
    $(".mlabel").addClass("label-default");
    $(".memitem").addClass("panel");
    $(".memitem").addClass("panel-info");
    $(".memproto").addClass("panel-heading");
    $(".memdoc").addClass("panel-body");
    </script>
    <footer>
      <div class="container">
        <div class="text-muted" style="float:right;">Generated by <a href="http://www.doxygen.org/index.html">
          <img style="height:18px;" class="footer-img" src="doxygen.png" alt="doxygen"></a> on Thu Dec 19 2024 11:22:15
        </div>
      </div>
    </footer>
</body>
</html>

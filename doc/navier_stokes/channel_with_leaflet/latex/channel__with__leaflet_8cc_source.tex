\hypertarget{channel__with__leaflet_8cc_source}{}\doxysection{channel\+\_\+with\+\_\+leaflet.\+cc}
\label{channel__with__leaflet_8cc_source}\index{channel\_with\_leaflet.cc@{channel\_with\_leaflet.cc}}
\mbox{\hyperlink{channel__with__leaflet_8cc}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00001}00001 \textcolor{comment}{//LIC// ====================================================================}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00002}00002 \textcolor{comment}{//LIC// This file forms part of oomph-\/lib, the object-\/oriented, }}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00003}00003 \textcolor{comment}{//LIC// multi-\/physics finite-\/element library, available }}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00004}00004 \textcolor{comment}{//LIC// at http://www.oomph-\/lib.org.}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00005}00005 \textcolor{comment}{//LIC// }}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00006}00006 \textcolor{comment}{//LIC// Copyright (C) 2006-\/2021 Matthias Heil and Andrew Hazel}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00007}00007 \textcolor{comment}{//LIC// }}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00008}00008 \textcolor{comment}{//LIC// This library is free software; you can redistribute it and/or}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00009}00009 \textcolor{comment}{//LIC// modify it under the terms of the GNU Lesser General Public}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00010}00010 \textcolor{comment}{//LIC// License as published by the Free Software Foundation; either}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00011}00011 \textcolor{comment}{//LIC// version 2.1 of the License, or (at your option) any later version.}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00012}00012 \textcolor{comment}{//LIC// }}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00013}00013 \textcolor{comment}{//LIC// This library is distributed in the hope that it will be useful,}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00014}00014 \textcolor{comment}{//LIC// but WITHOUT ANY WARRANTY; without even the implied warranty of}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00015}00015 \textcolor{comment}{//LIC// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00016}00016 \textcolor{comment}{//LIC// Lesser General Public License for more details.}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00017}00017 \textcolor{comment}{//LIC// }}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00018}00018 \textcolor{comment}{//LIC// You should have received a copy of the GNU Lesser General Public}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00019}00019 \textcolor{comment}{//LIC// License along with this library; if not, write to the Free Software}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00020}00020 \textcolor{comment}{//LIC// Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00021}00021 \textcolor{comment}{//LIC// 02110-\/1301  USA.}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00022}00022 \textcolor{comment}{//LIC// }}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00023}00023 \textcolor{comment}{//LIC// The authors may be contacted at oomph-\/lib@maths.man.ac.uk.}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00024}00024 \textcolor{comment}{//LIC// }}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00025}00025 \textcolor{comment}{//LIC//====================================================================}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00026}00026 \textcolor{comment}{// Generic oomph-\/lib includes}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00027}00027 \textcolor{preprocessor}{\#include "{}generic.h"{}}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00028}00028 }
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00029}00029 \textcolor{comment}{// Generic oomph-\/lib includes}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00030}00030 \textcolor{preprocessor}{\#include "{}navier\_stokes.h"{}}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00031}00031 }
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00032}00032 \textcolor{comment}{//Include the mesh}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00033}00033 \textcolor{preprocessor}{\#include "{}meshes/channel\_with\_leaflet\_mesh.h"{}}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00034}00034 }
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00035}00035 \textcolor{keyword}{using namespace }std;}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00036}00036 \textcolor{keyword}{using namespace }oomph;}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00037}00037 }
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00038}00038 }
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00039}00039 \textcolor{comment}{//===start\_of\_leaflet\_class===========================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00040}00040 \textcolor{comment}{/// GeomObject representing a vertical leaflet that performs}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00041}00041 \textcolor{comment}{/// bending and stretching oscillations. }}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00042}00042 \textcolor{comment}{}\textcolor{comment}{//====================================================================}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00043}\mbox{\hyperlink{classLeaflet}{00043}} \textcolor{keyword}{class }\mbox{\hyperlink{classLeaflet}{Leaflet}} : \textcolor{keyword}{public} GeomObject}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00044}00044 \{}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00045}00045 }
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00046}00046 \textcolor{keyword}{public}:}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00047}00047 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00048}00048 \textcolor{comment}{ /// Constructor: Pass length (in Lagrangian coordinates),}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00049}00049 \textcolor{comment}{ /// the amplitude of the horizontal and vertical deflection of the tip,}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00050}00050 \textcolor{comment}{ /// the x-\/coordinate of the origin and the period of the oscillation.}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00051}00051 \textcolor{comment}{ /// Passes the number of Lagrangian and Eulerian coordinates to the}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00052}00052 \textcolor{comment}{ /// constructor of the GeomObject base class.}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00053}\mbox{\hyperlink{classLeaflet_acb53ccf4578a9981216cf0afd4b38453}{00053}} \textcolor{comment}{} \mbox{\hyperlink{classLeaflet_acb53ccf4578a9981216cf0afd4b38453}{Leaflet}}(\textcolor{keyword}{const} \textcolor{keywordtype}{double}\& \mbox{\hyperlink{classLeaflet_a7a28827b7081107ac9e33087598ca868}{length}}, \textcolor{keyword}{const} \textcolor{keywordtype}{double}\& \mbox{\hyperlink{classLeaflet_a48b7c945eca16ff01995cc70cbf54210}{d\_x}},\textcolor{keyword}{const} \textcolor{keywordtype}{double}\& \mbox{\hyperlink{classLeaflet_a8ff8044a3da540c7c9d7a89790b6ee58}{d\_y}},}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00054}00054          \textcolor{keyword}{const} \textcolor{keywordtype}{double}\& \mbox{\hyperlink{classLeaflet_af4a819a3ba64960f4b796dc5a0d3eb5b}{x\_0}}, \textcolor{keyword}{const} \textcolor{keywordtype}{double}\& period, Time* time\_pt)}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00055}00055   : GeomObject(1,2), \mbox{\hyperlink{classLeaflet_a64c27b796ceece358d09d137f15bbf20}{Length}}(\mbox{\hyperlink{classLeaflet_a7a28827b7081107ac9e33087598ca868}{length}}), \mbox{\hyperlink{classLeaflet_a473b6f4ef98bfba9e2c6974027ba4f4b}{D\_x}}(\mbox{\hyperlink{classLeaflet_a48b7c945eca16ff01995cc70cbf54210}{d\_x}}), \mbox{\hyperlink{classLeaflet_af9c75c7aeecae4b14f7ba0fb245eb8ee}{D\_y}}(\mbox{\hyperlink{classLeaflet_a8ff8044a3da540c7c9d7a89790b6ee58}{d\_y}}), \mbox{\hyperlink{classLeaflet_a29a25366a0cf97ad0dd36172fdfa3d0c}{X\_0}}(\mbox{\hyperlink{classLeaflet_af4a819a3ba64960f4b796dc5a0d3eb5b}{x\_0}}),}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00056}00056    \mbox{\hyperlink{classLeaflet_a0d78b5fb3ec71009d4a9bcc79f8a85a9}{T}}(period),\mbox{\hyperlink{classLeaflet_ac10f13ad45456dc714ab57042861de53}{Time\_pt}}(time\_pt) \{\}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00057}00057 }
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00058}00058 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00059}00059 \textcolor{comment}{ /// Destructor -\/-\/ emtpy}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00060}\mbox{\hyperlink{classLeaflet_a0bbfaeec2534389b203fd2a2316db859}{00060}} \textcolor{comment}{} \textcolor{keyword}{virtual} \mbox{\hyperlink{classLeaflet_a0bbfaeec2534389b203fd2a2316db859}{\string~Leaflet}}()\{\}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00061}00061 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00062}00062 \textcolor{comment}{ /// Position vector, r, to the point identified by  }}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00063}00063 \textcolor{comment}{ /// its 1D Lagrangian coordinate, xi (passed as a 1D Vector) at discrete time}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00064}00064 \textcolor{comment}{ /// level t (t=0: present; t>0: previous).}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00065}\mbox{\hyperlink{classLeaflet_a5b78c2735652b6a5c08c6aa9d38b6232}{00065}} \textcolor{comment}{} \textcolor{keywordtype}{void} \mbox{\hyperlink{classLeaflet_a5b78c2735652b6a5c08c6aa9d38b6232}{position}}(\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\& t, \textcolor{keyword}{const} Vector<double>\& xi, }
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00066}00066                Vector<double>\& r)\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00067}00067 \textcolor{keyword}{  }\{}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00068}00068     \textcolor{keyword}{using namespace }MathematicalConstants;}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00069}00069 }
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00070}00070    \textcolor{comment}{//Position}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00071}00071     r[0] =  \mbox{\hyperlink{classLeaflet_a29a25366a0cf97ad0dd36172fdfa3d0c}{X\_0}} + \mbox{\hyperlink{classLeaflet_a473b6f4ef98bfba9e2c6974027ba4f4b}{D\_x}}*xi[0]*xi[0]/\mbox{\hyperlink{classLeaflet_a64c27b796ceece358d09d137f15bbf20}{Length}}/\mbox{\hyperlink{classLeaflet_a64c27b796ceece358d09d137f15bbf20}{Length}}*sin(2.0*Pi*\mbox{\hyperlink{classLeaflet_ac10f13ad45456dc714ab57042861de53}{Time\_pt}}-\/>time(t)/\mbox{\hyperlink{classLeaflet_a0d78b5fb3ec71009d4a9bcc79f8a85a9}{T}});}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00072}00072     r[1] = xi[0]*(1.0+\mbox{\hyperlink{classLeaflet_af9c75c7aeecae4b14f7ba0fb245eb8ee}{D\_y}}/\mbox{\hyperlink{classLeaflet_a64c27b796ceece358d09d137f15bbf20}{Length}}*0.5*(1.0-\/cos(4.0*Pi*\mbox{\hyperlink{classLeaflet_ac10f13ad45456dc714ab57042861de53}{Time\_pt}}-\/>time(t)/\mbox{\hyperlink{classLeaflet_a0d78b5fb3ec71009d4a9bcc79f8a85a9}{T}})));}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00073}00073   \}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00074}00074  \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00075}00075 \textcolor{comment}{ /// Steady version: Get current shape}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00076}\mbox{\hyperlink{classLeaflet_a01daf4944eaaf7e9697eac53d78965f5}{00076}} \textcolor{comment}{} \textcolor{keywordtype}{void} \mbox{\hyperlink{classLeaflet_a01daf4944eaaf7e9697eac53d78965f5}{position}}(\textcolor{keyword}{const} Vector<double>\& xi, Vector<double>\& r)\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00077}00077 \textcolor{keyword}{  }\{}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00078}00078    \mbox{\hyperlink{classLeaflet_a5b78c2735652b6a5c08c6aa9d38b6232}{position}}(0,xi,r); }
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00079}00079   \}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00080}00080 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00081}00081 \textcolor{comment}{ /// Number of geometric Data in GeomObject: None.}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00082}\mbox{\hyperlink{classLeaflet_a91f2460718ec5a4ef32e302b8b14cdca}{00082}} \textcolor{comment}{} \textcolor{keywordtype}{unsigned} \mbox{\hyperlink{classLeaflet_a91f2460718ec5a4ef32e302b8b14cdca}{ngeom\_data}}()\textcolor{keyword}{ const }\{\textcolor{keywordflow}{return} 0;\}  }
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00083}00083 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00084}00084 \textcolor{comment}{ /// Length of the leaflet}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00085}\mbox{\hyperlink{classLeaflet_a7a28827b7081107ac9e33087598ca868}{00085}} \textcolor{comment}{} \textcolor{keywordtype}{double} \mbox{\hyperlink{classLeaflet_a7a28827b7081107ac9e33087598ca868}{length}}() \{ \textcolor{keywordflow}{return} \mbox{\hyperlink{classLeaflet_a64c27b796ceece358d09d137f15bbf20}{Length}}; \}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00086}00086 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00087}00087 \textcolor{comment}{ /// Amplitude of horizontal tip displacement}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00088}\mbox{\hyperlink{classLeaflet_a48b7c945eca16ff01995cc70cbf54210}{00088}} \textcolor{comment}{} \textcolor{keywordtype}{double}\& \mbox{\hyperlink{classLeaflet_a48b7c945eca16ff01995cc70cbf54210}{d\_x}}() \{\textcolor{keywordflow}{return} \mbox{\hyperlink{classLeaflet_a473b6f4ef98bfba9e2c6974027ba4f4b}{D\_x}};\}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00089}00089 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00090}00090 \textcolor{comment}{ /// Amplitude of vertical tip displacement}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00091}\mbox{\hyperlink{classLeaflet_a8ff8044a3da540c7c9d7a89790b6ee58}{00091}} \textcolor{comment}{} \textcolor{keywordtype}{double} \mbox{\hyperlink{classLeaflet_a8ff8044a3da540c7c9d7a89790b6ee58}{d\_y}}() \{\textcolor{keywordflow}{return} \mbox{\hyperlink{classLeaflet_af9c75c7aeecae4b14f7ba0fb245eb8ee}{D\_y}};\}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00092}00092 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00093}00093 \textcolor{comment}{ /// x-\/coordinate of leaflet origin}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00094}\mbox{\hyperlink{classLeaflet_af4a819a3ba64960f4b796dc5a0d3eb5b}{00094}} \textcolor{comment}{} \textcolor{keywordtype}{double} \mbox{\hyperlink{classLeaflet_af4a819a3ba64960f4b796dc5a0d3eb5b}{x\_0}}() \{\textcolor{keywordflow}{return} \mbox{\hyperlink{classLeaflet_a29a25366a0cf97ad0dd36172fdfa3d0c}{X\_0}};\}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00095}00095  }
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00096}00096 private :}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00097}00097  \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00098}00098 \textcolor{comment}{ /// Length in terms of Lagrangian coordinates}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00099}\mbox{\hyperlink{classLeaflet_a64c27b796ceece358d09d137f15bbf20}{00099}} \textcolor{comment}{} \textcolor{keywordtype}{double} \mbox{\hyperlink{classLeaflet_a64c27b796ceece358d09d137f15bbf20}{Length}};}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00100}00100  \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00101}00101 \textcolor{comment}{ /// Horizontal displacement of tip}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00102}\mbox{\hyperlink{classLeaflet_a473b6f4ef98bfba9e2c6974027ba4f4b}{00102}} \textcolor{comment}{} \textcolor{keywordtype}{double} \mbox{\hyperlink{classLeaflet_a473b6f4ef98bfba9e2c6974027ba4f4b}{D\_x}};}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00103}00103  \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00104}00104 \textcolor{comment}{ /// Vertical displacement of tip}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00105}\mbox{\hyperlink{classLeaflet_af9c75c7aeecae4b14f7ba0fb245eb8ee}{00105}} \textcolor{comment}{} \textcolor{keywordtype}{double} \mbox{\hyperlink{classLeaflet_af9c75c7aeecae4b14f7ba0fb245eb8ee}{D\_y}};}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00106}00106  \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00107}00107 \textcolor{comment}{/// Origin}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00108}\mbox{\hyperlink{classLeaflet_a29a25366a0cf97ad0dd36172fdfa3d0c}{00108}} \textcolor{comment}{} \textcolor{keywordtype}{double} \mbox{\hyperlink{classLeaflet_a29a25366a0cf97ad0dd36172fdfa3d0c}{X\_0}};}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00109}00109  \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00110}00110 \textcolor{comment}{ /// Period of the oscillations}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00111}\mbox{\hyperlink{classLeaflet_a0d78b5fb3ec71009d4a9bcc79f8a85a9}{00111}} \textcolor{comment}{} \textcolor{keywordtype}{double} \mbox{\hyperlink{classLeaflet_a0d78b5fb3ec71009d4a9bcc79f8a85a9}{T}};}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00112}00112 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00113}00113 \textcolor{comment}{ /// Pointer to the global time object}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00114}\mbox{\hyperlink{classLeaflet_ac10f13ad45456dc714ab57042861de53}{00114}} \textcolor{comment}{} Time* \mbox{\hyperlink{classLeaflet_ac10f13ad45456dc714ab57042861de53}{Time\_pt}};}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00115}00115 }
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00116}00116 \}; \textcolor{comment}{//end\_of\_the\_GeomObject}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00117}00117 }
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00118}00118 }
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00119}00119 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00120}00120 \textcolor{comment}{/// ////////////////////////////////////////////////////////////////////}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00121}00121 \textcolor{comment}{/// ///////////////////////////////////////////////////////////////////}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00122}00122 \textcolor{comment}{/// ////////////////////////////////////////////////////////////////////}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00123}00123 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00124}00124 }
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00125}00125 \textcolor{comment}{//==start\_of\_global\_parameters=======================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00126}00126 \textcolor{comment}{/// Global parameters}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00127}00127 \textcolor{comment}{}\textcolor{comment}{//===================================================================}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00128}\mbox{\hyperlink{namespaceGlobal__Physical__Variables}{00128}} \textcolor{keyword}{namespace }\mbox{\hyperlink{namespaceGlobal__Physical__Variables}{Global\_Physical\_Variables}}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00129}00129 \{}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00130}00130 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00131}00131 \textcolor{comment}{ /// Reynolds number}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00132}\mbox{\hyperlink{namespaceGlobal__Physical__Variables_ab814e627d2eb5bc50318879d19ab16b9}{00132}} \textcolor{comment}{} \textcolor{keywordtype}{double} \mbox{\hyperlink{namespaceGlobal__Physical__Variables_ab814e627d2eb5bc50318879d19ab16b9}{Re}}=20.0;}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00133}00133 }
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00134}00134 \} \textcolor{comment}{// end\_of\_namespace}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00135}00135 }
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00136}00136 }
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00137}00137 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00138}00138 \textcolor{comment}{/// ////////////////////////////////////////////////////////////////////}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00139}00139 \textcolor{comment}{/// ///////////////////////////////////////////////////////////////////}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00140}00140 \textcolor{comment}{/// ////////////////////////////////////////////////////////////////////}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00141}00141 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00142}00142 }
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00143}00143 \textcolor{comment}{//==start\_of\_problem\_class===========================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00144}00144 \textcolor{comment}{/// Problem class}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00145}00145 \textcolor{comment}{}\textcolor{comment}{//===================================================================}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00146}00146 \textcolor{keyword}{template}<\textcolor{keyword}{class} ELEMENT>}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00147}\mbox{\hyperlink{classChannelWithLeafletProblem}{00147}} \textcolor{keyword}{class }\mbox{\hyperlink{classChannelWithLeafletProblem}{ChannelWithLeafletProblem}} : \textcolor{keyword}{public} Problem}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00148}00148 \{}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00149}00149 }
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00150}00150 \textcolor{keyword}{public}:}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00151}00151 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00152}00152 \textcolor{comment}{ /// Constructor: Pass the length of the domain at the left}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00153}00153 \textcolor{comment}{ /// of the leaflet lleft,the length of the domain at the right of the}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00154}00154 \textcolor{comment}{ /// leaflet lright,the height of the leaflet hleaflet, the total height}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00155}00155 \textcolor{comment}{ /// of the domain htot, the number of macro-\/elements at the left of the}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00156}00156 \textcolor{comment}{ /// leaflet nleft, the number of macro-\/elements at the right of the}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00157}00157 \textcolor{comment}{ /// leaflet nright, the number of macro-\/elements under hleaflet ny1,}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00158}00158 \textcolor{comment}{ /// the number of macro-\/elements above hleaflet ny2,the x-\/displacement}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00159}00159 \textcolor{comment}{ /// of the leaflet d\_x,the y-\/displacement of the leaflet d\_y,the abscissa }}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00160}00160 \textcolor{comment}{ /// of the origin of the leaflet x\_0, the period of the moving leaflet.}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00161}00161 \textcolor{comment}{} \mbox{\hyperlink{classChannelWithLeafletProblem_a3c5a4c97ec66fe53bc130005c74a47b5}{ChannelWithLeafletProblem}}(\textcolor{keyword}{const} \textcolor{keywordtype}{double}\& l\_left,}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00162}00162                            \textcolor{keyword}{const} \textcolor{keywordtype}{double}\& l\_right, \textcolor{keyword}{const} \textcolor{keywordtype}{double}\& h\_leaflet,}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00163}00163                            \textcolor{keyword}{const} \textcolor{keywordtype}{double}\& h\_tot,}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00164}00164                            \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\& nleft, \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\& nright,}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00165}00165                            \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\& ny1, \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\&  ny2,}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00166}00166                            \textcolor{keyword}{const} \textcolor{keywordtype}{double}\& d\_x,\textcolor{keyword}{const} \textcolor{keywordtype}{double}\& d\_y,}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00167}00167                            \textcolor{keyword}{const} \textcolor{keywordtype}{double}\& x\_0, \textcolor{keyword}{const} \textcolor{keywordtype}{double}\& period);  }
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00168}00168 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00169}00169 \textcolor{comment}{ /// Destructor (empty)}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00170}\mbox{\hyperlink{classChannelWithLeafletProblem_a5dec8333d345e4bcaac7fcd5b463eafc}{00170}} \textcolor{comment}{} \mbox{\hyperlink{classChannelWithLeafletProblem_a5dec8333d345e4bcaac7fcd5b463eafc}{\string~ChannelWithLeafletProblem}}()\{\}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00171}00171 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00172}00172 \textcolor{comment}{ /// Overloaded access function to specific mesh}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00173}\mbox{\hyperlink{classChannelWithLeafletProblem_acfb056c1240242094b953a80bbc36c4e}{00173}} \textcolor{comment}{} RefineableAlgebraicChannelWithLeafletMesh<ELEMENT>* \mbox{\hyperlink{classChannelWithLeafletProblem_acfb056c1240242094b953a80bbc36c4e}{mesh\_pt}}() }
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00174}00174   \{}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00175}00175    \textcolor{comment}{// Upcast from pointer to the Mesh base class to the specific }}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00176}00176    \textcolor{comment}{// element type that we're using here.}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00177}00177    \textcolor{keywordflow}{return} \textcolor{keyword}{dynamic\_cast<}RefineableAlgebraicChannelWithLeafletMesh<ELEMENT>*\textcolor{keyword}{>}(}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00178}00178     Problem::mesh\_pt());}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00179}00179   \}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00180}00180  \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00181}00181 \textcolor{comment}{ /// Update after solve (empty)}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00182}\mbox{\hyperlink{classChannelWithLeafletProblem_a2fcba9dc98f40bbca1919a715fa087d7}{00182}} \textcolor{comment}{} \textcolor{keywordtype}{void} \mbox{\hyperlink{classChannelWithLeafletProblem_a2fcba9dc98f40bbca1919a715fa087d7}{actions\_after\_newton\_solve}}()\{\}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00183}00183 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00184}00184 \textcolor{comment}{ /// Update before solve (empty)}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00185}\mbox{\hyperlink{classChannelWithLeafletProblem_a5721dfad66d13a1ae60adce7801dcb12}{00185}} \textcolor{comment}{} \textcolor{keywordtype}{void} \mbox{\hyperlink{classChannelWithLeafletProblem_a5721dfad66d13a1ae60adce7801dcb12}{actions\_before\_newton\_solve}}()\{\}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00186}00186 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00187}00187 \textcolor{comment}{ /// Actions after adaptation: Pin redundant pressure dofs}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00188}00188 \textcolor{comment}{} \textcolor{keywordtype}{void} \mbox{\hyperlink{classChannelWithLeafletProblem_a7978755f073d950e5012951ced9e455e}{actions\_after\_adapt}}();}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00189}00189 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00190}00190 \textcolor{comment}{ /// Update the velocity boundary condition on the moving leaflet}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00191}00191 \textcolor{comment}{} \textcolor{keywordtype}{void} \mbox{\hyperlink{classChannelWithLeafletProblem_acef6ec771775162f77295a8f92d695ac}{actions\_before\_implicit\_timestep}}();}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00192}00192 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00193}00193 \textcolor{comment}{ /// Doc the solution}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00194}00194 \textcolor{comment}{} \textcolor{keywordtype}{void} \mbox{\hyperlink{classChannelWithLeafletProblem_adb8e1420844f7b40d71beae81111c4d0}{doc\_solution}}(DocInfo\& doc\_info);}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00195}00195 }
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00196}00196 \textcolor{keyword}{private}:}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00197}00197 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00198}00198 \textcolor{comment}{ /// Pointer to the GeomObject}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00199}\mbox{\hyperlink{classChannelWithLeafletProblem_ac32f0451749ec4e85d39246f5823a5f2}{00199}} \textcolor{comment}{} GeomObject* \mbox{\hyperlink{classChannelWithLeafletProblem_ac32f0451749ec4e85d39246f5823a5f2}{Leaflet\_pt}};}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00200}00200  }
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00201}00201 \};}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00202}00202 }
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00203}00203 }
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00204}00204 }
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00205}00205 }
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00206}00206 \textcolor{comment}{//==start\_of\_constructor=================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00207}00207 \textcolor{comment}{/// Constructor}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00208}00208 \textcolor{comment}{}\textcolor{comment}{//=======================================================================}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00209}00209 \textcolor{keyword}{template} <\textcolor{keyword}{class} ELEMENT>}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00210}\mbox{\hyperlink{classChannelWithLeafletProblem_a3c5a4c97ec66fe53bc130005c74a47b5}{00210}} \mbox{\hyperlink{classChannelWithLeafletProblem_a3c5a4c97ec66fe53bc130005c74a47b5}{ChannelWithLeafletProblem<ELEMENT>::ChannelWithLeafletProblem}}(}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00211}00211  \textcolor{keyword}{const} \textcolor{keywordtype}{double}\& l\_left,}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00212}00212  \textcolor{keyword}{const} \textcolor{keywordtype}{double}\& l\_right, \textcolor{keyword}{const} \textcolor{keywordtype}{double}\& h\_leaflet,}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00213}00213  \textcolor{keyword}{const} \textcolor{keywordtype}{double}\& h\_tot,}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00214}00214  \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\& nleft, \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\& nright,}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00215}00215  \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\& ny1, \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\&  ny2,}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00216}00216  \textcolor{keyword}{const} \textcolor{keywordtype}{double}\& d\_x,\textcolor{keyword}{const} \textcolor{keywordtype}{double}\& d\_y,}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00217}00217  \textcolor{keyword}{const} \textcolor{keywordtype}{double}\& x\_0, \textcolor{keyword}{const} \textcolor{keywordtype}{double}\& period)}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00218}00218 \{}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00219}00219  \textcolor{comment}{// Allocate the timestepper}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00220}00220  add\_time\_stepper\_pt(\textcolor{keyword}{new} BDF<2>);}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00221}00221  }
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00222}00222  \textcolor{comment}{//Create the geometric object that represents the leaflet}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00223}00223  Leaflet\_pt = \textcolor{keyword}{new} \mbox{\hyperlink{classLeaflet}{Leaflet}}(h\_leaflet, d\_x, d\_y, x\_0, period, time\_pt()) ;}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00224}00224 }
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00225}00225 \textcolor{comment}{//Build the mesh}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00226}00226 Problem::mesh\_pt()=\textcolor{keyword}{new} RefineableAlgebraicChannelWithLeafletMesh<ELEMENT>(}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00227}00227  Leaflet\_pt,}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00228}00228  l\_left, l\_right,}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00229}00229  h\_leaflet,}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00230}00230  h\_tot,nleft,}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00231}00231  nright,ny1,ny2,}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00232}00232  time\_stepper\_pt());     }
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00233}00233 }
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00234}00234 }
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00235}00235  \textcolor{comment}{// Set error estimator}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00236}00236  Z2ErrorEstimator* error\_estimator\_pt=\textcolor{keyword}{new} Z2ErrorEstimator;}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00237}00237  \textcolor{keyword}{dynamic\_cast<}RefineableAlgebraicChannelWithLeafletMesh<ELEMENT>*\textcolor{keyword}{>}(mesh\_pt())-\/>}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00238}00238   spatial\_error\_estimator\_pt()=error\_estimator\_pt;}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00239}00239 }
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00240}00240  }
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00241}00241  \textcolor{comment}{// Loop over the elements to set up element-\/specific }}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00242}00242  \textcolor{comment}{// things that cannot be handled by constructor}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00243}00243  \textcolor{keywordtype}{unsigned} n\_element = mesh\_pt()-\/>nelement();}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00244}00244  \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned} e=0;e<n\_element;e++)}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00245}00245   \{}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00246}00246    \textcolor{comment}{// Upcast from GeneralisedElement to the present element}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00247}00247    ELEMENT* el\_pt = \textcolor{keyword}{dynamic\_cast<}ELEMENT*\textcolor{keyword}{>}(mesh\_pt()-\/>element\_pt(e));}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00248}00248    }
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00249}00249    \textcolor{comment}{//Set the Reynolds number}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00250}00250    el\_pt-\/>re\_pt() = \&\mbox{\hyperlink{namespaceGlobal__Physical__Variables_ab814e627d2eb5bc50318879d19ab16b9}{Global\_Physical\_Variables::Re}};}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00251}00251   }
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00252}00252    \textcolor{comment}{// Set the Womersley number (product of Reynolds and Strouhal).}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00253}00253    \textcolor{comment}{// We're assuming a Strouhal number of one, corresponding to}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00254}00254    \textcolor{comment}{// a non-\/dimensionalisation of time on the flow's natural timescale.}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00255}00255    el\_pt-\/>re\_st\_pt() = \&\mbox{\hyperlink{namespaceGlobal__Physical__Variables_ab814e627d2eb5bc50318879d19ab16b9}{Global\_Physical\_Variables::Re}};}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00256}00256   }
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00257}00257   \} \textcolor{comment}{// end loop over elements}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00258}00258 }
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00259}00259 }
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00260}00260  \textcolor{comment}{//Pin the boundary nodes}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00261}00261  \textcolor{keywordtype}{unsigned} num\_bound = mesh\_pt()-\/>nboundary();}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00262}00262  \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned} ibound=0;ibound<num\_bound;ibound++)}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00263}00263   \{}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00264}00264    \textcolor{keywordtype}{unsigned} num\_nod= mesh\_pt()-\/>nboundary\_node(ibound);}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00265}00265    \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} inod=0;inod<num\_nod;inod++)}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00266}00266     \{}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00267}00267       mesh\_pt()-\/>boundary\_node\_pt(ibound,inod)-\/>pin(1);}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00268}00268       \textcolor{comment}{//do not pin the x velocity of the outflow}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00269}00269       \textcolor{keywordflow}{if}( ibound != 1)}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00270}00270       \{}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00271}00271        mesh\_pt()-\/>boundary\_node\_pt(ibound,inod)-\/>pin(0); }
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00272}00272       \}     }
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00273}00273     \}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00274}00274   \}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00275}00275  }
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00276}00276  \textcolor{comment}{// Setup parabolic flow along the inflow boundary 3}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00277}00277  \textcolor{keywordtype}{unsigned} ibound=3; }
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00278}00278  \textcolor{keywordtype}{unsigned} num\_nod= mesh\_pt()-\/>nboundary\_node(ibound);}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00279}00279  \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} inod=0;inod<num\_nod;inod++)}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00280}00280   \{}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00281}00281    \textcolor{keywordtype}{double} ycoord = mesh\_pt()-\/>boundary\_node\_pt(ibound,inod)-\/>x(1); }
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00282}00282    \textcolor{keywordtype}{double} uy = 6.0*(ycoord/h\_tot)*(1.0-\/(ycoord/h\_tot));}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00283}00283 }
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00284}00284    mesh\_pt()-\/>boundary\_node\_pt(ibound,inod)-\/>set\_value(0,uy);}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00285}00285    mesh\_pt()-\/>boundary\_node\_pt(ibound,inod)-\/>set\_value(1,0.0);    }
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00286}00286   \}\textcolor{comment}{// end of setup boundary condition}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00287}00287  }
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00288}00288  \textcolor{comment}{// Pin redudant pressure dofs}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00289}00289  RefineableNavierStokesEquations<2>::}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00290}00290   pin\_redundant\_nodal\_pressures(Problem::mesh\_pt()-\/>element\_pt());}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00291}00291  }
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00292}00292  \textcolor{comment}{// Setup equation numbering scheme}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00293}00293  cout << \textcolor{stringliteral}{"{}Number of equations: "{}} << assign\_eqn\_numbers() << std::endl; }
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00294}00294  }
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00295}00295 \}\textcolor{comment}{//end of constructor}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00296}00296 }
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00297}00297 }
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00298}00298 }
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00299}00299 }
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00300}00300 \textcolor{comment}{//=====start\_of\_actions\_before\_implicit\_timestep=========================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00301}00301 \textcolor{comment}{/// Actions before implicit timestep: Update domain shape and}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00302}00302 \textcolor{comment}{/// the velocity boundary conditions}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00303}00303 \textcolor{comment}{}\textcolor{comment}{//=======================================================================}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00304}00304 \textcolor{keyword}{template} <\textcolor{keyword}{class} ELEMENT> }
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00305}\mbox{\hyperlink{classChannelWithLeafletProblem_acef6ec771775162f77295a8f92d695ac}{00305}} \textcolor{keywordtype}{void} \mbox{\hyperlink{classChannelWithLeafletProblem_acef6ec771775162f77295a8f92d695ac}{ChannelWithLeafletProblem<ELEMENT>::actions\_before\_implicit\_timestep}}()}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00306}00306 \{}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00307}00307  \textcolor{comment}{// Update the domain shape}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00308}00308  mesh\_pt()-\/>node\_update();}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00309}00309 }
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00310}00310  \textcolor{comment}{// Moving leaflet: No slip; this implies that the velocity needs}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00311}00311  \textcolor{comment}{// to be updated in response to leaflet motion}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00312}00312  \textcolor{keywordflow}{for}( \textcolor{keywordtype}{unsigned} ibound=4;ibound<6;ibound++)}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00313}00313   \{}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00314}00314    \textcolor{keywordtype}{unsigned} num\_nod=mesh\_pt()-\/>nboundary\_node(ibound);}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00315}00315    \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} inod=0;inod<num\_nod;inod++)}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00316}00316     \{}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00317}00317      \textcolor{comment}{// Which node are we dealing with?}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00318}00318      Node* node\_pt=mesh\_pt()-\/>boundary\_node\_pt(ibound,inod);}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00319}00319      }
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00320}00320      \textcolor{comment}{// Apply no slip}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00321}00321      FSI\_functions::apply\_no\_slip\_on\_moving\_wall(node\_pt);}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00322}00322     \}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00323}00323   \}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00324}00324 \} \textcolor{comment}{//end\_of\_actions\_before\_implicit\_timestep}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00325}00325 }
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00326}00326 }
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00327}00327 }
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00328}00328 \textcolor{comment}{//==========start\_of\_actions\_after\_adaptation============================}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00329}00329 \textcolor{comment}{// Actions after adaptation: Pin redundant pressure dofs}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00330}00330 \textcolor{comment}{//=======================================================================}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00331}00331 \textcolor{keyword}{template}<\textcolor{keyword}{class} ELEMENT>}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00332}\mbox{\hyperlink{classChannelWithLeafletProblem_a7978755f073d950e5012951ced9e455e}{00332}} \textcolor{keywordtype}{void} \mbox{\hyperlink{classChannelWithLeafletProblem_a7978755f073d950e5012951ced9e455e}{ChannelWithLeafletProblem<ELEMENT>::actions\_after\_adapt}}()}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00333}00333 \{}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00334}00334  \textcolor{comment}{// Unpin all pressure dofs}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00335}00335  RefineableNavierStokesEquations<2>::}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00336}00336   unpin\_all\_pressure\_dofs(mesh\_pt()-\/>element\_pt());}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00337}00337  }
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00338}00338  \textcolor{comment}{// Pin redundant pressure dofs}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00339}00339  RefineableNavierStokesEquations<2>::}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00340}00340   pin\_redundant\_nodal\_pressures(mesh\_pt()-\/>element\_pt());}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00341}00341  }
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00342}00342 \} \textcolor{comment}{// end\_of\_actions\_after\_adapt}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00343}00343 }
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00344}00344 }
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00345}00345 }
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00346}00346 \textcolor{comment}{//==start\_of\_doc\_solution=================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00347}00347 \textcolor{comment}{/// Doc the solution}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00348}00348 \textcolor{comment}{}\textcolor{comment}{//========================================================================}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00349}00349 \textcolor{keyword}{template}<\textcolor{keyword}{class} ELEMENT>}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00350}\mbox{\hyperlink{classChannelWithLeafletProblem_adb8e1420844f7b40d71beae81111c4d0}{00350}} \textcolor{keywordtype}{void} \mbox{\hyperlink{classChannelWithLeafletProblem_adb8e1420844f7b40d71beae81111c4d0}{ChannelWithLeafletProblem<ELEMENT>::doc\_solution}}(DocInfo\& doc\_info)}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00351}00351 \{ }
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00352}00352 }
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00353}00353  ofstream some\_file;}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00354}00354  \textcolor{keywordtype}{char} filename[100];}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00355}00355 }
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00356}00356  \textcolor{comment}{// Number of plot points}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00357}00357  \textcolor{keywordtype}{unsigned} npts;}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00358}00358  npts=5; }
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00359}00359 }
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00360}00360  \textcolor{comment}{// Output solution }}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00361}00361  sprintf(filename,\textcolor{stringliteral}{"{}\%s/soln\%i.dat"{}},doc\_info.directory().c\_str(),}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00362}00362          doc\_info.number());}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00363}00363  some\_file.open(filename);}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00364}00364  mesh\_pt()-\/>output(some\_file,npts);}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00365}00365  some\_file.close();}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00366}00366 }
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00367}00367  \textcolor{comment}{// Output boundaries}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00368}00368  sprintf(filename,\textcolor{stringliteral}{"{}\%s/boundaries\%i.dat"{}},doc\_info.directory().c\_str(),}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00369}00369          doc\_info.number());}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00370}00370  some\_file.open(filename);}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00371}00371  mesh\_pt()-\/>output\_boundaries(some\_file);}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00372}00372  some\_file.close();}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00373}00373 }
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00374}00374 \} \textcolor{comment}{// end\_of\_doc\_solution}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00375}00375 }
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00376}00376 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00377}00377 \textcolor{comment}{/// ////////////////////////////////////////////////////////////////////}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00378}00378 \textcolor{comment}{/// ///////////////////////////////////////////////////////////////////}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00379}00379 \textcolor{comment}{/// ////////////////////////////////////////////////////////////////////}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00380}00380 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00381}00381 }
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00382}00382 \textcolor{comment}{//======start\_of\_main==================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00383}00383 \textcolor{comment}{/// Driver code -\/-\/ pass a command line argument if you want to run}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00384}00384 \textcolor{comment}{/// the code in validation mode where it only performs a few steps}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00385}00385 \textcolor{comment}{}\textcolor{comment}{//=====================================================================}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00386}\mbox{\hyperlink{channel__with__leaflet_8cc_a0ddf1224851353fc92bfbff6f499fa97}{00386}} \textcolor{keywordtype}{int} \mbox{\hyperlink{channel__with__leaflet_8cc_a0ddf1224851353fc92bfbff6f499fa97}{main}}(\textcolor{keywordtype}{int} argc, \textcolor{keywordtype}{char}* argv[])}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00387}00387 \{}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00388}00388 }
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00389}00389  \textcolor{comment}{// Store command line arguments}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00390}00390  CommandLineArgs::setup(argc,argv);}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00391}00391  }
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00392}00392  \textcolor{comment}{// Set up doc info}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00393}00393  DocInfo doc\_info; }
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00394}00394  doc\_info.set\_directory(\textcolor{stringliteral}{"{}RESLT"{}});}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00395}00395  doc\_info.number()=0;}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00396}00396  }
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00397}00397  \textcolor{comment}{// Parameters for the leaflet}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00398}00398  \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00399}00399  }
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00400}00400  \textcolor{comment}{// Height}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00401}00401  \textcolor{keywordtype}{double} h\_leaflet = 0.5;}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00402}00402 }
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00403}00403 }
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00404}00404  \textcolor{comment}{// Tip deflection}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00405}00405  \textcolor{keywordtype}{double} d\_x = 0.25;}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00406}00406  \textcolor{keywordtype}{double} d\_y = -\/0.05;}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00407}00407 }
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00408}00408  \textcolor{comment}{// x-\/positon of root}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00409}00409  \textcolor{keywordtype}{double} x\_0 = 3.0; }
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00410}00410 }
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00411}00411  \textcolor{comment}{// Period of the oscillation on the natural timescale of the flow}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00412}00412  \textcolor{keywordtype}{double} period = 20.0;}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00413}00413 }
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00414}00414 }
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00415}00415  \textcolor{comment}{//Parameters for the domain}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00416}00416  \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00417}00417 }
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00418}00418  \textcolor{comment}{// Length of the mesh to right and left of the leaflet}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00419}00419  \textcolor{keywordtype}{double} l\_left =2.0;}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00420}00420  \textcolor{keywordtype}{double} l\_right= 3.0;}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00421}00421 }
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00422}00422  \textcolor{comment}{// Total height of domain (unity because lengths have been scaled on it)}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00423}00423  \textcolor{keywordtype}{double} h\_tot=1.0;}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00424}00424 }
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00425}00425  \textcolor{comment}{// Initial number of element rows/columns in various mesh regions}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00426}00426  \textcolor{keywordtype}{unsigned} nleft=8;}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00427}00427  \textcolor{keywordtype}{unsigned} nright=12;}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00428}00428  \textcolor{keywordtype}{unsigned} ny1=2;}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00429}00429  \textcolor{keywordtype}{unsigned} ny2=2; }
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00430}00430  }
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00431}00431  \textcolor{comment}{//Build the problem}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00432}00432  \mbox{\hyperlink{classChannelWithLeafletProblem}{ChannelWithLeafletProblem<AlgebraicElement<RefineableQTaylorHoodElement<2>}} > >}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00433}00433   problem(l\_left, l\_right, h\_leaflet,}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00434}00434           h\_tot,nleft, nright,ny1,ny2,}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00435}00435           d\_x, d\_y, x\_0,}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00436}00436           period);}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00437}00437  }
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00438}00438  }
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00439}00439  \textcolor{comment}{// Number of timesteps per period}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00440}00440  \textcolor{keywordtype}{unsigned} nsteps\_per\_period=40;}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00441}00441 }
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00442}00442  \textcolor{comment}{// Number of periods}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00443}00443  \textcolor{keywordtype}{unsigned} nperiod=3; }
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00444}00444 }
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00445}00445  \textcolor{comment}{// Number of timesteps (reduced for validation)}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00446}00446  \textcolor{keywordtype}{unsigned} nstep=nsteps\_per\_period*nperiod;}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00447}00447  \textcolor{keywordflow}{if} (CommandLineArgs::Argc>1)}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00448}00448   \{}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00449}00449    nstep=3;}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00450}00450   \}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00451}00451 }
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00452}00452  \textcolor{comment}{//Timestep: }}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00453}00453  \textcolor{keywordtype}{double} dt=period/double(nsteps\_per\_period);}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00454}00454  \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00455}00455 \textcolor{comment}{ /// Initialise timestep }}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00456}00456 \textcolor{comment}{} problem.initialise\_dt(dt);}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00457}00457 }
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00458}00458 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00459}00459 \textcolor{comment}{ /// Set max. number of adaptations (reduced for validation)}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00460}00460 \textcolor{comment}{} \textcolor{keywordtype}{unsigned} max\_adapt=5;}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00461}00461  \textcolor{keywordflow}{if} (CommandLineArgs::Argc>1)}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00462}00462   \{}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00463}00463    max\_adapt=2;}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00464}00464   \}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00465}00465 }
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00466}00466  \textcolor{comment}{// Do steady solve first -\/-\/ this also sets the history values}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00467}00467  \textcolor{comment}{// to those corresponding to an impulsive start from the}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00468}00468  \textcolor{comment}{// steady solution}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00469}00469  problem.steady\_newton\_solve(max\_adapt);}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00470}00470  \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00471}00471 \textcolor{comment}{ /// Output steady solution}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00472}00472 \textcolor{comment}{} problem.\mbox{\hyperlink{classChannelWithLeafletProblem_adb8e1420844f7b40d71beae81111c4d0}{doc\_solution}}(doc\_info);}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00473}00473  doc\_info.number()++;}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00474}00474 }
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00475}00475 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00476}00476 \textcolor{comment}{ /// Reduce the max number of adaptations for time-\/dependent simulation}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00477}00477 \textcolor{comment}{} max\_adapt=1;}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00478}00478 }
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00479}00479  \textcolor{comment}{// We don't want to re-\/assign the initial condition }}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00480}00480  \textcolor{keywordtype}{bool} first=\textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00481}00481  }
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00482}00482 \textcolor{comment}{// Timestepping loop}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00483}00483  \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} istep=0;istep<nstep;istep++)}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00484}00484   \{ }
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00485}00485    \textcolor{comment}{// Solve the problem}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00486}00486    problem.unsteady\_newton\_solve(dt,max\_adapt,first);}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00487}00487    }
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00488}00488    \textcolor{comment}{// Output the solution}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00489}00489    problem.\mbox{\hyperlink{classChannelWithLeafletProblem_adb8e1420844f7b40d71beae81111c4d0}{doc\_solution}}(doc\_info);}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00490}00490    }
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00491}00491    \textcolor{comment}{// Step number}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00492}00492    doc\_info.number()++;}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00493}00493 }
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00494}00494   \}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00495}00495 }
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00496}00496 }
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00497}00497 \}\textcolor{comment}{//end of main}}
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00498}00498 }
\DoxyCodeLine{\Hypertarget{channel__with__leaflet_8cc_source_l00499}00499 }

\end{DoxyCode}

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
<title>oomph-lib: circular_driven_cavity.txt_doxygenified.h Source File</title>
<link rel="apple-touch-icon" sizes="57x57" href="../../../figures/apple-touch-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="../../../figures/apple-touch-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="../../../figures/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="../../../figures/apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="../../../figures/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="../../../figures/apple-touch-icon-120x120.png">
<link rel="icon" type="image/png" href="../../../figures/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="../../../figures/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="../../../figures/favicon-16x16.png" sizes="16x16">
<link rel="manifest" href="../../../figures/manifest.json">
<link rel="mask-icon" href="../../../figures/safari-pinned-tab.svg" color="#008000">
<link rel="shortcut icon" href="../../../figures/favicon.ico">
<meta name="msapplication-TileColor" content="#00a300">
<meta name="msapplication-config" content="../../../figures/browserconfig.xml">
<meta name="theme-color" content="#008000">
<link href="http://fonts.googleapis.com/css?family=Open+Sans:400,300,600" rel="stylesheet" type="text/css">
<!-- Doxygen css-->
<!-- <link rel="stylesheet" type="text/css" href="doxygen.css"> -->
<!-- Bootstrap -->
<link href="../../../css/bootstrap.css" rel="stylesheet">
<!-- oomph-lib specific overrides -->
<link rel="stylesheet" type="text/css" href="../../../css/oomph_header.css">
</head>
<body>
<nav class="navbar navbar-default">
<div class="container">
<div class="container-fluid">
  <!-- Brand and toggle get grouped for better mobile display -->
  <div class="navbar-header">
    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
      <span class="sr-only">Toggle navigation</span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="../../../html/index.html"><img alt="oomph-lib" src="../../../figures/oomph_logo.png"></a>
  </div>
  <!-- Collect the nav links, forms, and other content for toggling -->
  <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
    <ul class="nav navbar-nav">          
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Documentation <span class="caret"></span></a>
        <ul class="dropdown-menu">
          <li class="dropdown-header">Big picture</li>
          <li><a href="../../../../doc/intro/html/index.html">The finite element method</a></li>
          <li><a href="../../../../doc/the_data_structure/html/index.html">The data structure</a></li>
          <li><a href="../../../../doc/quick_guide/html/index.html">Not-so-quick guide</a></li>
          <li><a href="../../../../doc/optimisation/html/index.html">Optimisation</a></li>
          <li><a href="../../../../doc/order_of_action_functions/html/index.html">Order of action functions</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Example codes and tutorials</li>
          <li><a href="../../../../doc/example_code_list/html/index.html">List of example codes and tutorials</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#meshes">Meshing</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#solvers">Solvers</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#parallel">MPI parallel processing</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#visualisation">Post-processing/visualisation</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Other</li>
          <li><a href="../../../../doc/change_log/html/index.html">Change log</a></li>
          <li><a href="../../../../doc/creating_doc/html/index.html">Creating documentation</a></li>
          <li><a href="../../../../doc/coding_conventions/html/index.html">Coding conventions</a></li>
          <li><a href="../../../../doc/index/html/index.html">Index</a></li>
          <li><a href="../../../../doc/FAQ/html/index.html">FAQ</a></li>
        </ul>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Get it <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../../doc/the_distribution/html/index.html">Installation guide</a></li>
            <li><a href="../../../../doc/subversion/html/index.html">Get code from subversion repository</a></li>
            <li><a href="../../../../doc/download/html/index.html">Get code as tar file</a></li>
            <li><a href="../../../../doc/copyright/html/index.html">Copyright</a></li>
          </ul>
        </li>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">About <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../../doc/people/html/index.html">People</a></li>            
            <li><a href="../../../../doc/contact/html/index.html">Contact/Get involved</a></li>
            <li><a href="../../../../doc/publications/html/index.html">Publications</a></li>
            <li><a href="../../../../doc/acknowledgements/html/index.html">Acknowledgements</a></li>
            <li><a href="../../../../doc/picture_show/index.html">Picture show</a></li>
          </ul>
        </li>
      </li>
    </ul>
    <ul class="nav navbar-nav navbar-right navbar-search">
      <form class="navbar-form" role="search" action="../../../../doc/search_results/html/index.html">
        <div class="input-group">
          <input type="text" class="form-control" placeholder="Search" name="q">
          <span class="input-group-btn">
            <button class="btn btn-default" type="submit">Go</button>
          </span>
        </div><!-- /input-group -->
       <!--<div class="form-group">
          <input type="text" class="form-control" placeholder="Search">
        </div>
        <button type="submit" class="btn btn-default">Submit</button>-->
      </form>
    </ul>
  </div><!-- /.navbar-collapse -->
</div><!-- /.container-fluid -->
</div>
</nav>
<!-- Generated by Doxygen 1.8.17 -->
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">circular_driven_cavity.txt_doxygenified.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="circular__driven__cavity_8txt__doxygenified_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">\mainpage Example problem: 2D driven cavity flow in a quarter-circle domain with spatial adaptation.</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">In this example we shall demonstrate</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">- how easy it is to adapt the code for the solution of the driven </span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">  cavity problem in a square domain, discussed in a</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">  &lt;A HREF=&quot;../../adaptive_driven_cavity/html/index.html&quot;&gt; previous</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">  example &lt;/A&gt;, to a different domain shape,</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">- how to apply body forces (e.g. gravity) in a Navier-Stokes problem,</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">- how to switch between the stress-divergence and the simplified forms</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">  of the incompressible Navier-Stokes equations.</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">.</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">\section example The example problem</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">In this example we shall illustrate the solution of the steady 2D Navier-Stokes</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">equations in a modified driven cavity problem: The fluid is contained</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">in a quarter-circle domain and is subject to gravity which acts </span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">in the vertical direction. We solve the problem in two different</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">formulations, using the stress-divergence and the simplified form of</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">the Navier-Stokes equations, respectively, and by applying the </span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">gravitational body  force via the gravity vector, \f$ {\bf G} \f$, and via the</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">body force  function, \f$ {\bf B}\f$, respectively.</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">&lt;CENTER&gt;</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment">&lt;TABLE&gt;</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment">&lt;TR&gt;</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">&lt;TD&gt;</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment">&lt;CENTER&gt;</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment">&lt;B&gt;Problem 1:&lt;/B&gt;</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment">&lt;B&gt;The 2D driven cavity problem in a quarter circle domain with</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment">gravity, &lt;BR&gt;</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment">using the stress-divergence form of the Navier-Stokes equations&lt;/B&gt;</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment">&lt;/CENTER&gt; </span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment">Solve</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment">Re\phantom{i}u_j\frac{\partial u_i}{\partial x_j} =</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment">- \frac{\partial p}{\partial x_i} +</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment">\frac{Re}{Fr} \, G_i +</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment">\frac{\partial }{\partial x_j} \left(</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment">\frac{\partial u_i}{\partial x_j} +  </span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment">\frac{\partial u_j}{\partial x_i} \right),</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment"> \ \ \ \ \ \ \ \ \ \ (1)</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment">and</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment">\frac{\partial u_i}{\partial x_i} = 0,</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment">in the quarter-circle domain \f$ D = \{x_1 \geq 0 \f$, \f$ x_2 \geq 0</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment">\f$ and \f$ x_1^2+x_2^2 \leq 1 \} \f$,</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment">subject to the Dirichlet boundary conditions</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="comment">\left. \mathbf{u}\right|_{\partial D}=(0,0),</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment">\ \ \ \ \ \ \ \ \ \ (2)</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment">on the curved and left boundaries; and </span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment">\left. \mathbf{u}\right|_{\partial D}=(1,0),</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment">\ \ \ \ \ \ \ \ \ \ (3)</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment">on the bottom boundary, \f$ x_2 = 0 \f$. </span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment">Gravity acts vertically downwards so that \f$ (G_1, G_2) = (0,-1) \f$.</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment">&lt;/TD&gt;</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="comment">&lt;/TR&gt;</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="comment">&lt;/TABLE&gt;  </span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="comment">&lt;/CENTER&gt;</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="comment">When discussing the implementation of the Navier-Stokes equations in</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="comment">an &lt;A HREF=&quot;../../driven_cavity/html/index.html#stress_divergence&quot;&gt; </span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="comment">earlier example &lt;/A&gt;, we mentioned that \c oomph-lib allows the incompressible</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="comment">Navier-Stokes equations to be solved in the simplified, rather than</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="comment">the (default) stress-divergence form. We will demonstrate the use of </span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="comment">this feature by solving the following problem:</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="comment">&lt;CENTER&gt;</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="comment">&lt;TABLE&gt;</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment">&lt;TR&gt; </span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="comment">&lt;TD&gt;</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="comment">&lt;CENTER&gt;</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="comment">&lt;B&gt;Problem 2:&lt;/B&gt;</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="comment">&lt;B&gt;The 2D driven cavity problem in a quarter circle domain with</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="comment">gravity, &lt;BR&gt;</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="comment">using the simplified form of the Navier-Stokes equations&lt;/B&gt;</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="comment">&lt;/CENTER&gt; </span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="comment">Solve</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="comment">Re\phantom{i}u_j\frac{\partial u_i}{\partial x_j} =</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment">- \frac{\partial p}{\partial x_i} +</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="comment">B_i + </span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="comment">\frac{\partial^2 u_i}{\partial x_j^2},</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="comment"> \ \ \ \ \ \ \ \ \ \ (1)</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="comment">and</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="comment">\frac{\partial u_i}{\partial x_i} = 0,</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="comment">in the quarter-circle domain \f$ D = \{x_1 \geq 0 \f$, \f$ x_2 \geq 0</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="comment">\f$ and \f$ x_1^2+x_2^2 \leq 1 \} \f$,</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="comment">subject to the Dirichlet boundary conditions</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="comment">\left. \mathbf{u}\right|_{\partial D}=(0,0),</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="comment">\ \ \ \ \ \ \ \ \ \ (2)</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="comment">on the curved and left boundaries; and </span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="comment">\left. \mathbf{u}\right|_{\partial D}=(1,0),</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="comment">\ \ \ \ \ \ \ \ \ \ (3)</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="comment">on the bottom boundary, \f$ x_2 = 0 \f$. To make this consistent</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="comment">with Problem 1, we define the body force function as</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="comment">\f$ (B_1, B_2) = (0,-Re/Fr) \f$.</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="comment">&lt;/TD&gt;</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="comment">&lt;/TR&gt;</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="comment">&lt;/TABLE&gt;  </span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="comment">&lt;/CENTER&gt;</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="comment">Note that in Problem 2, the gravitational body force is </span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="comment">represented by the body force rather than the gravity vector.</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="comment">\subsection stress_divergence Switching between the stress-divergence and the simplified forms of the Navier-Stokes equations </span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="comment">The two forms of the Navier-Stokes equations differ in the</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="comment">implementation of the viscous terms, which may be represented as</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="comment">\frac{\partial^2 u_i}{\partial x_j^2} \mbox{ \ \ \ or \ \ \ }</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="comment">\frac{\partial }{\partial x_j} \left(</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="comment">\frac{\partial u_i}{\partial x_j} +  </span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="comment">\frac{\partial u_j}{\partial x_i} \right).</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="comment">For an incompressible flow, \f$ \partial u_i/\partial x_i = 0\f$, both</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="comment">forms are mathematically equivalent but the stress-divergence form</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="comment">is required for </span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="comment">&lt;A HREF=&quot;../../single_layer_free_surface/html/index.html&quot;&gt;problems with free surfaces</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="comment">&lt;/A&gt;, or for</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="comment">&lt;A HREF=&quot;../../rayleigh_traction_channel//html/index.html&quot;&gt;problems in which </span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="comment">traction boundary conditions are to be applied.&lt;/A&gt;</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="comment">In order to be able do deal with both cases, \c oomph-lib&#39;s Navier-Stokes </span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="comment">elements actually implement the viscous term as</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="comment">\frac{\partial }{\partial x_j} \left(</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="comment">\frac{\partial u_i}{\partial x_j} +</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="comment">\Gamma_i \, \frac{\partial u_j}{\partial x_i} \right).</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="comment">By default the components of the vector \f$ \Gamma_i \f$,</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="comment">are set to 1.0, so that the stress-divergence form is used.</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="comment">The components \f$ \Gamma_i \f$ are stored in the </span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="comment">static data member</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="comment">\code</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="comment">static Vector&lt;double&gt; NavierStokesEquations&lt;DIM&gt;::Gamma</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="comment">\endcode</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="comment">of the \c NavierStokesEquations&lt;DIM&gt; class which forms the basis</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="comment">for all Navier-Stokes elements in \c oomph-lib.</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="comment">Its entries are initialised to 1.0. The user may over-write these</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="comment">assignments and thus re-define the values of \f$ \Gamma \f$ being used</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="comment">for a specific problem. [In principle, it is possible to use</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="comment">stress-divergence form for the first component of the momentum</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="comment">equations, and the simplified form for the second one, say. However,</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="comment">we do not believe that this is  a particularly useful/desirable option</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="comment">and have certainly never used such (slightly bizarre) assignments in</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="comment">any of our own computations.] </span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;<span class="comment">\subsection sol1 Solution to problem 1</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="comment">The figure below shows &quot;carpet plots&quot; of the velocity and pressure</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="comment">fields as well as a contour plot of the pressure distribution with</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="comment">superimposed streamlines for Problem 1 at a Reynolds number of </span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="comment">\f$ Re=100\f$</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="comment">and a ratio of Reynolds and Froude numbers (a measure of gravity on </span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="comment">the viscous scale) of \f$ Re/Fr = 100\f$. The velocity vanishes </span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="comment">along the entire</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;<span class="comment">domain boundary, apart from the bottom boundary \f$ (x_2 = 0) \f$</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="comment">where the moving &quot;lid&quot; imposes a unit tangential velocity which drives</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<span class="comment">a large vortex, centred at \f$ (x_1,x_2) \approx (0.59,0.22) \f$. The</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<span class="comment">pressure singularities created by the velocity discontinuities at </span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<span class="comment">\f$ (x_1,x_2)=(0,0) \f$ and \f$ (x_1, x_2)=(1,0) \f$ are well</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="comment">resolved. The pressure plot shows that away from the singularities,</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="comment">the pressure decreases linearly with \f$ x_2 \f$, reflecting the</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="comment">effect of the gravitational body forces which acts in the</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="comment">negative \f$ x_2-\f$ direction.</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="comment">\image html sol1.gif &quot;Plot of the velocity and pressure fields for problem 1 with Re=100 and Re/Fr=100, computed with adaptive Taylor-Hood elements. &quot; </span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="comment">\image latex sol1.eps &quot;Plot of the velocity and pressure fields for problem 1 with Re=100 and Re/Fr=100, computed with adaptive Taylor-Hood elements. &quot; width=0.75\textwidth</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="comment">\subsection sol2 Solution to problem 2</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="comment">The next figure shows the computational results for Problem 2, obtained from</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="comment">a computation with adaptive Crouzeix-Raviart elements. </span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="comment">\image html sol2.gif &quot;Plot of the velocity and pressure fields for problem 2 with Re=100 and Re/Fr=100, computed with adaptive Crouzeix-Raviart elements. &quot; </span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="comment">\image latex sol2.eps &quot;Plot of the velocity and pressure fields for problem 2 with Re=100 and Re/Fr=100, computed with adaptive Crouzeix-Raviart elements. &quot; width=0.75\textwidth</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="comment">\section code The code</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="comment">We use a namespace \c Global_Physical_Variables to define the</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="comment">various parameters: The Reynolds number,</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="comment">\dontinclude circular_driven_cavity.cc</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="comment">\skipline start_of_namespace</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;<span class="comment">\until Re=100</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="comment"> </span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="comment">the gravity vector \f$ {\bf G}\f$, and the ratio of Reynolds and Froude number,</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="comment">\f$ Re/Fr \f$, which represents the ratio of gravitational and viscous forces,</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="comment">\until Vector</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="comment">In Problem 2, gravity is introduced via the body force function</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="comment">\f$ {\bf B}\f$ which we define such that Problems 1 and 2 are</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="comment">equivalent. (We use the gravity vector \f$ {\bf G} = (0,-1)\f$ </span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<span class="comment">to specify the direction of gravity, while indicating it magnitude</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;<span class="comment">by \f$ Re/Fr.\f$)</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="comment">\until }</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;<span class="comment">Finally we define a body force function, which returns zero values,</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="comment">for use when solving Problem 1.</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="comment">\until end_of_namespace</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;<span class="comment">\section main The driver code</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="comment">First we create a \c DocInfo object to control the output, and set the maximum</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="comment">number of spatial adaptations to three.</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="comment">\skipline start_of_main</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;<span class="comment">\until max_adapt=3</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;<span class="comment">To solve problem 1 we define the direction of gravity, \f$ {\bf G} = </span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;<span class="comment">(0,-1)\f$, and set the entries in the \c NavierStokesEquations&lt;2&gt;::Gamma</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;<span class="comment">vector to \f$ (1,1)\f$, so that the stress-divergence form of</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;<span class="comment">the equation is used [In fact, this step is not strictly necessary</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;<span class="comment">as it simply re-assigns the default values.] </span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;<span class="comment">\until Gamma[1]</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;<span class="comment">Next we build problem 1 using Taylor-Hood elements and passing a</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;<span class="comment">function pointer to the \c zero_body_force(...) function (defined </span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;<span class="comment">in the namespace \c Global_Physical_Variables) as the argument.</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="comment">\until problem(&amp;</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="comment">Now problem 1 can be solved as in </span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="comment">&lt;A HREF=&quot;../../adaptive_driven_cavity/html/index.html#main&quot;&gt;the previous</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="comment">example&lt;/A&gt;.</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="comment">\until end of problem 1</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;<span class="comment">To solve problem 2 we set the entries in the \c</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;<span class="comment">NavierStokesEquations&lt;2&gt;::Gamma  vector to zero (thus choosing the</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;<span class="comment">simplified version of the Navier-Stokes equations), define \f$ {\bf G} = </span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;<span class="comment">(0,0)\f$, and pass a function pointer to the \c body_force(...)</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;<span class="comment">function to the problem constructor.</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;<span class="comment">\until problem(&amp;</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;<span class="comment">Problem 2 may then be solved as before.</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;<span class="comment">\until end_of_main</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;<span class="comment">\section problem The problem class </span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;<span class="comment">The problem class is very similar to that used in the </span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;<span class="comment">&lt;A HREF=&quot;../../adaptive_driven_cavity/html/index.html#problem&quot;&gt; previous</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;<span class="comment">example &lt;/A&gt;, with two exceptions:</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;<span class="comment">- We pass a function pointer to the body force function \f$ {\bf B}\f$</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;<span class="comment">  to the constructor and</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;<span class="comment">- store the function pointer to the body force function in the</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<span class="comment">  problem&#39;s private member data.</span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;<span class="comment">\dontinclude circular_driven_cavity.cc</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;<span class="comment">\skipline start_of_problem_class</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="comment">\until end_of_problem_class </span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="comment">\section constructor The problem constructor</span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;<span class="comment">We store the function pointer to the body force function in the</span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;<span class="comment">private data member \c Body_force_fct_pt.</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;<span class="comment">\skipline start_of_constructor</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;<span class="comment">\until Body_force_fct_pt</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;<span class="comment">As usual the first task is to create the mesh. We now use the \c</span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;<span class="comment">RefineableQuarterCircleSectorMesh&lt;ELEMENT&gt;, which requires the</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;<span class="comment">creation of a \c GeomObject to describe geometry of the curved wall:</span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;<span class="comment">We choose an ellipse with unit half axes (i.e. a unit circle).</span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="comment">\until Wall_pt,xi_lo,</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<span class="comment">Next the error estimator is set, the boundary nodes are pinned and the</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="comment">Reynolds number is assigned, as </span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="comment">&lt;A HREF=&quot;../../adaptive_driven_cavity/html/index.html#constructor&quot;&gt;</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;<span class="comment">before &lt;/A&gt;.</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;<span class="comment">\until re_pt()</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;<span class="comment">Within this loop we also pass the pointers to \f$ Re/Fr \f$, the</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;<span class="comment">gravity vector and the body-force function to the elements.</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;<span class="comment">\until end loop over elements</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;<span class="comment">The \c RefineableQuarterCircleSectorMesh&lt;ELEMENT&gt; contains only </span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;<span class="comment">three elements and therefore provides a very coarse discretisation of</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;<span class="comment">the domain. We refine the mesh uniformly twice</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;<span class="comment">before pinning the redundant pressure degrees of freedom, pinning</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;<span class="comment">a single pressure degree of freedom, and assigning the equation</span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;<span class="comment">numbers, as &lt;A HREF=&quot;../../adaptive_driven_cavity/html/index.html#doc&quot;&gt;</span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;<span class="comment">before&lt;/A&gt;.</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;<span class="comment">\until end_of_constructor</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;<span class="comment">\section doc Post processing</span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;<span class="comment">The post processing function remains the same as in the </span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;<span class="comment">&lt;A HREF=&quot;../../driven_cavity/html/index.html#doc&quot;&gt; previous</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;<span class="comment">examples &lt;/A&gt;.</span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;<span class="comment">\skipline start_of_doc_solution</span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;<span class="comment">\until end_of_doc_solution</span></div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;<span class="comment">\section comments Comments and Exercises</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;<span class="comment">-# Try making the curved boundary the driving wall [Hint: this</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;<span class="comment">   requires a change in the wall velocities prescribed in \c</span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;<span class="comment">   Problem::actions_before_newton_solve(). The figure below shows what you</span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;<span class="comment">   should expect.]</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;<span class="comment">\image html curved_driving_wall.gif &quot;Plot of the velocity and pressure distribution for a circular driven cavity in which the flow is driven by the tangential motion of the curvilinear boundary. &quot; </span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;<span class="comment">\image latex curved_driving_wall.eps &quot;Plot of the velocity and pressure distribution for a circular driven cavity in which the flow is driven by the tangential motion of the curvilinear boundary. &quot; width=0.75\textwidth</span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;<span class="comment">\section sources Source files for this tutorial</span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;<span class="comment">- The source files for this tutorial are located in the directory:</span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;<span class="comment">&lt;CENTER&gt;</span></div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;<span class="comment">&lt;A HREF=&quot;../../../../demo_drivers/navier_stokes/circular_driven_cavity/&quot;&gt;</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;<span class="comment">demo_drivers/navier_stokes/circular_driven_cavity/</span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;<span class="comment">&lt;/A&gt;</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;<span class="comment">&lt;/CENTER&gt;</span></div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;<span class="comment">- The driver code is:</span></div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;<span class="comment">&lt;CENTER&gt;</span></div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;<span class="comment">&lt;A HREF=&quot;../../../../demo_drivers/navier_stokes/circular_driven_cavity/circular_driven_cavity.cc&quot;&gt;</span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;<span class="comment">demo_drivers/navier_stokes/circular_driven_cavity/circular_driven_cavity.cc</span></div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;<span class="comment">&lt;/A&gt;</span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;<span class="comment">&lt;/CENTER&gt;</span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;<span class="comment">.</span></div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;<span class="comment">&lt;hr&gt;</span></div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;<span class="comment">&lt;hr&gt;</span></div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;<span class="comment">\section pdf PDF file</span></div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;<span class="comment">A &lt;a href=&quot;../latex/refman.pdf&quot;&gt;pdf version&lt;/a&gt; of this document is available.</span></div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;<span class="comment">**/</span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160; </div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="acircular__driven__cavity_8txt_html_abab4df8de246ad2273260eeae02ccf44"><div class="ttname"><a href="circular__driven__cavity_8txt.html#abab4df8de246ad2273260eeae02ccf44">boundaries</a></div><div class="ttdeci">E[2DNavierStokes] f and f[\frac{\partial u_i}{\partial x_i}=0,\f] in the quarter circle domain f subject to the Dirichlet boundary conditions f[\left. \mathbf{u}\right|_{\partial D}=(0, 0),\ \ \ \ \ \ \ \ \ \ @E[2DNavierStokes_BC1]@\f] on the curved and left boundaries</div><div class="ttdef"><b>Definition:</b> <a href="circular__driven__cavity_8txt_source.html#l00110">circular_driven_cavity.txt:110</a></div></div>
<div class="ttc" id="anamespaceGlobal__Physical__Variables_html_afae321364975eb56688ad13abc8ed6b7"><div class="ttname"><a href="namespaceGlobal__Physical__Variables.html#afae321364975eb56688ad13abc8ed6b7">Global_Physical_Variables::Gravity</a></div><div class="ttdeci">Vector&lt; double &gt; Gravity(2)</div><div class="ttdoc">Gravity vector.</div></div>
<div class="ttc" id="acircular__driven__cavity_8txt_html_a7a4c92cd6581ca112498fbc1081adce1"><div class="ttname"><a href="circular__driven__cavity_8txt.html#a7a4c92cd6581ca112498fbc1081adce1">x_j</a></div><div class="ttdeci">- \frac{\partial p}{\partial x_i}+\frac{Re}{Fr} \, G_i+\frac{\partial }{\partial x_j} \left(\frac{\partial u_i}{\partial x_j}+\frac{\partial u_j}{\partial x_i} \right), \ \ \ \ \ \ \ \ \ \ @E[2DNavierStokes]@ \f] and \f[\frac{\partial u_i}{\partial x_i}=0, \f] in the quarter-circle domain \f$ D=\{x_1 \geq 0 \f$, \f$ x_2 \geq 0 \f$ and \f$ x_1^2+x_2^2 \leq 1 \} \f$, subject to the Dirichlet boundary conditions \f[\left. \mathbf{u}\right|_{\partial D}=(0, 0), \ \ \ \ \ \ \ \ \ \ @E[2DNavierStokes_BC1]@ \f] on the curved and left boundaries x_j</div><div class="ttdef"><b>Definition:</b> <a href="circular__driven__cavity_8txt_source.html#l00058">circular_driven_cavity.txt:58</a></div></div>
<div class="ttc" id="acircular__driven__cavity_8txt_html_ad89aee300c3e56a067be94f9542859d2"><div class="ttname"><a href="circular__driven__cavity_8txt.html#ad89aee300c3e56a067be94f9542859d2">f</a></div><div class="ttdeci">and f[\left. \mathbf{u}\right|_{\partial D}=(1, 0),\ \ \ \ \ \ \ \ \ \ @E[2DNavierStokes_BC2]@\f] on the bottom f we define the body force function as f(B_1, B_2)</div></div>
<div class="ttc" id="acircular__driven__cavity_8txt_html_ade99796c665d7c7e2afc0245f71e2431"><div class="ttname"><a href="circular__driven__cavity_8txt.html#ade99796c665d7c7e2afc0245f71e2431">simplified</a></div><div class="ttdeci">and f[\left. \mathbf{u}\right|_{\partial D}=(1, 0),\ \ \ \ \ \ \ \ \ \ @E[2DNavierStokes_BC2]@\f] on the bottom f we mentioned that c oomph lib allows the incompressible Navier Stokes equations to be solved in the simplified</div><div class="ttdef"><b>Definition:</b> <a href="circular__driven__cavity_8txt_source.html#l00075">circular_driven_cavity.txt:75</a></div></div>
<div class="ttc" id="acircular__driven__cavity_8txt_html_a0a81477f2c546578a9ee5be743e9c5ad"><div class="ttname"><a href="circular__driven__cavity_8txt.html#a0a81477f2c546578a9ee5be743e9c5ad">forces</a></div><div class="ttdeci">mainpage Example discussed in a&lt; A HREF=&quot;../../adaptive_driven_cavity/html/index.html&quot;&gt; previous to a different domain how to apply body forces(e.g. gravity) in a Navier-Stokes problem</div></div>
<div class="ttc" id="acircular__driven__cavity_8txt_html_a9ff14801f1d652fc8f5d045e732fe1b1"><div class="ttname"><a href="circular__driven__cavity_8txt.html#a9ff14801f1d652fc8f5d045e732fe1b1">the</a></div><div class="ttdeci">and f[\left. \mathbf{u}\right|_{\partial D}=(1, 0),\ \ \ \ \ \ \ \ \ \ @E[2DNavierStokes_BC2]@\f] on the bottom f we mentioned that c oomph lib allows the incompressible Navier Stokes equations to be solved in the rather than the(default) stress-divergence form. We will demonstrate the use of this feature by solving the following problem</div><div class="ttdef"><b>Definition:</b> <a href="circular__driven__cavity_8txt_source.html#l00076">circular_driven_cavity.txt:76</a></div></div>
<div class="ttc" id="acircular__driven__cavity_8txt_html_ae5347bfddc623c3452d91a4c0022f6f9"><div class="ttname"><a href="circular__driven__cavity_8txt.html#ae5347bfddc623c3452d91a4c0022f6f9">example&lt;/A &gt;</a></div><div class="ttdeci">mainpage Example discussed in a&lt; A HREF=&quot;../../adaptive_driven_cavity/html/index.html&quot;&gt; previous example&lt;/A &gt;</div><div class="ttdef"><b>Definition:</b> <a href="circular__driven__cavity_8txt_source.html#l00007">circular_driven_cavity.txt:7</a></div></div>
<div class="ttc" id="acircular__driven__cavity_8txt_html_a3c9d56cb633330ee19430123cef136a9"><div class="ttname"><a href="circular__driven__cavity_8txt.html#a3c9d56cb633330ee19430123cef136a9">x_2</a></div><div class="ttdeci">and f[\left. \mathbf{u}\right|_{\partial D}=(1, 0),\ \ \ \ \ \ \ \ \ \ @E[2DNavierStokes_BC2]@\f] on the bottom f x_2</div><div class="ttdef"><b>Definition:</b> <a href="circular__driven__cavity_8txt_source.html#l00063">circular_driven_cavity.txt:63</a></div></div>
<div class="ttc" id="acircular__driven__cavity_8txt_html_ab93703c824c0df76b92105f16a25e04b"><div class="ttname"><a href="circular__driven__cavity_8txt.html#ab93703c824c0df76b92105f16a25e04b">shape</a></div><div class="ttdeci">mainpage Example discussed in a&lt; A HREF=&quot;../../adaptive_driven_cavity/html/index.html&quot;&gt; previous to a different domain shape</div><div class="ttdef"><b>Definition:</b> <a href="circular__driven__cavity_8txt_source.html#l00007">circular_driven_cavity.txt:7</a></div></div>
<div class="ttc" id="acircular__driven__cavity_8txt_html_a164b66decba600ecb8d831ccc101a62a"><div class="ttname"><a href="circular__driven__cavity_8txt.html#a164b66decba600ecb8d831ccc101a62a">flow</a></div><div class="ttdeci">and f[\left. \mathbf{u}\right|_{\partial D}=(1, 0),\ \ \ \ \ \ \ \ \ \ @E[2DNavierStokes_BC2]@\f] on the bottom f we define the body force function as the gravitational body force is represented by the body force rather than the gravity vector&lt; HR &gt; subsection stress_divergence Switching between the stress divergence and the simplified forms of the Navier Stokes equations The two forms of the Navier Stokes equations differ in the implementation of the viscous which may be represented as f[\frac{\partial^2 u_i}{\partial x_j^2} \mbox{ \ \ \ or \ \ \ }\frac{\partial }{\partial x_j} \left(\frac{\partial u_i}{\partial x_j}+\frac{\partial u_j}{\partial x_i} \right).\f] For an incompressible flow</div><div class="ttdef"><b>Definition:</b> <a href="circular__driven__cavity_8txt_source.html#l00138">circular_driven_cavity.txt:138</a></div></div>
<div class="ttc" id="acircular__driven__cavity_8txt_html_ac276d60640e4e66dd44c0838f13158c1"><div class="ttname"><a href="circular__driven__cavity_8txt.html#ac276d60640e4e66dd44c0838f13158c1">terms</a></div><div class="ttdeci">and f[\left. \mathbf{u}\right|_{\partial D}=(1, 0),\ \ \ \ \ \ \ \ \ \ @E[2DNavierStokes_BC2]@\f] on the bottom f we define the body force function as the gravitational body force is represented by the body force rather than the gravity vector&lt; HR &gt; subsection stress_divergence Switching between the stress divergence and the simplified forms of the Navier Stokes equations The two forms of the Navier Stokes equations differ in the implementation of the viscous terms</div><div class="ttdef"><b>Definition:</b> <a href="circular__driven__cavity_8txt_source.html#l00131">circular_driven_cavity.txt:131</a></div></div>
<div class="ttc" id="acircular__driven__cavity_8txt_html_a348df10ceb166438572787caf3f166fa"><div class="ttname"><a href="circular__driven__cavity_8txt.html#a348df10ceb166438572787caf3f166fa">x_i</a></div><div class="ttdeci">and f[\left. \mathbf{u}\right|_{\partial D}=(1, 0),\ \ \ \ \ \ \ \ \ \ @E[2DNavierStokes_BC2]@\f] on the bottom f we define the body force function as the gravitational body force is represented by the body force rather than the gravity vector&lt; HR &gt; subsection stress_divergence Switching between the stress divergence and the simplified forms of the Navier Stokes equations The two forms of the Navier Stokes equations differ in the implementation of the viscous which may be represented as f[\frac{\partial^2 u_i}{\partial x_j^2} \mbox{ \ \ \ or \ \ \ }\frac{\partial }{\partial x_j} \left(\frac{\partial u_i}{\partial x_j}+\frac{\partial u_j}{\partial x_i} \right).\f] For an incompressible f partial u_i partial x_i</div><div class="ttdef"><b>Definition:</b> <a href="circular__driven__cavity_8txt_source.html#l00138">circular_driven_cavity.txt:138</a></div></div>
<div class="ttc" id="acircular__driven__cavity_8txt_html_ab25cf81b904d8f15ea5e89ad094e32c2"><div class="ttname"><a href="circular__driven__cavity_8txt.html#ab25cf81b904d8f15ea5e89ad094e32c2">boundary</a></div><div class="ttdeci">and f[\left. \mathbf{u}\right|_{\partial D}=(1, 0),\ \ \ \ \ \ \ \ \ \ @E[2DNavierStokes_BC2]@\f] on the bottom boundary</div><div class="ttdef"><b>Definition:</b> <a href="circular__driven__cavity_8txt_source.html#l00063">circular_driven_cavity.txt:63</a></div></div>
<div class="ttc" id="acircular__driven__cavity_8txt_html_aa6e43c1ccedb07b3ac0c773c5194aa00"><div class="ttname"><a href="circular__driven__cavity_8txt.html#aa6e43c1ccedb07b3ac0c773c5194aa00">problem</a></div><div class="ttdeci">mainpage Example problem</div><div class="ttdef"><b>Definition:</b> <a href="circular__driven__cavity_8txt_source.html#l00005">circular_driven_cavity.txt:5</a></div></div>
<div class="ttc" id="acircular__driven__cavity_8txt_html_ad1e7739be577c22e1e6b40ce4eceda3c"><div class="ttname"><a href="circular__driven__cavity_8txt.html#ad1e7739be577c22e1e6b40ce4eceda3c">D</a></div><div class="ttdeci">E[2DNavierStokes] f and f[\frac{\partial u_i}{\partial x_i}=0,\f] in the quarter circle domain f D</div><div class="ttdef"><b>Definition:</b> <a href="circular__driven__cavity_8txt_source.html#l00103">circular_driven_cavity.txt:103</a></div></div>
<div class="ttc" id="anamespaceGlobal__Physical__Variables_html_ab814e627d2eb5bc50318879d19ab16b9"><div class="ttname"><a href="namespaceGlobal__Physical__Variables.html#ab814e627d2eb5bc50318879d19ab16b9">Global_Physical_Variables::Re</a></div><div class="ttdeci">double Re</div><div class="ttdoc">Reynolds number.</div><div class="ttdef"><b>Definition:</b> <a href="circular__driven__cavity_8cc_source.html#l00049">circular_driven_cavity.cc:49</a></div></div>

    <!-- jQuery for Bootstrap and Doxygen -->
    <script src="../../../js/jquery-1.12.0.min.js"></script>
    <!-- Minified boostrap plugins-->
    <script src="../../../js/bootstrap.js"></script>
    <!-- Doxygen dependency to add powertips to source code-->
    <script src="../../../js/jquery.powertip.min.js"></script>
    <!-- The  following script is generated by doxygen and hides/shows levels in 
         the data structure lists and adds powertips to source code-->
    <script src="../../../js/dynsections.js" ></script>
    <!-- add to Doxygen's class names so bootstrap css and js recognises them-->
    <script type="text/javascript">
    $(".contents").addClass("container");
    $(".header").addClass("container");
    $(".navpath").addClass("container");
    $("#navrow3").addClass("container");
    $("#navrow4").addClass("container");
    $(".mlabel").addClass("label");
    $(".mlabel").addClass("label-default");
    $(".memitem").addClass("panel");
    $(".memitem").addClass("panel-info");
    $(".memproto").addClass("panel-heading");
    $(".memdoc").addClass("panel-body");
    </script>
    <footer>
      <div class="container">
        <div class="text-muted" style="float:right;">Generated by <a href="http://www.doxygen.org/index.html">
          <img style="height:18px;" class="footer-img" src="doxygen.png" alt="doxygen"></a> on Fri Aug 6 2021 14:56:50
        </div>
      </div>
    </footer>
</body>
</html>

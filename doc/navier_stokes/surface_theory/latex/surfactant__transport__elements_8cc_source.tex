\hypertarget{surfactant__transport__elements_8cc_source}{}\doxysection{surfactant\+\_\+transport\+\_\+elements.\+cc}
\label{surfactant__transport__elements_8cc_source}\index{surfactant\_transport\_elements.cc@{surfactant\_transport\_elements.cc}}
\mbox{\hyperlink{surfactant__transport__elements_8cc}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00001}00001 \textcolor{comment}{// LIC// ====================================================================}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00002}00002 \textcolor{comment}{// LIC// This file forms part of oomph-\/lib, the object-\/oriented,}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00003}00003 \textcolor{comment}{// LIC// multi-\/physics finite-\/element library, available}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00004}00004 \textcolor{comment}{// LIC// at http://www.oomph-\/lib.org.}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00005}00005 \textcolor{comment}{// LIC//}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00006}00006 \textcolor{comment}{// LIC// Copyright (C) 2006-\/2021 Matthias Heil and Andrew Hazel}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00007}00007 \textcolor{comment}{// LIC//}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00008}00008 \textcolor{comment}{// LIC// This library is free software; you can redistribute it and/or}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00009}00009 \textcolor{comment}{// LIC// modify it under the terms of the GNU Lesser General Public}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00010}00010 \textcolor{comment}{// LIC// License as published by the Free Software Foundation; either}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00011}00011 \textcolor{comment}{// LIC// version 2.1 of the License, or (at your option) any later version.}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00012}00012 \textcolor{comment}{// LIC//}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00013}00013 \textcolor{comment}{// LIC// This library is distributed in the hope that it will be useful,}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00014}00014 \textcolor{comment}{// LIC// but WITHOUT ANY WARRANTY; without even the implied warranty of}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00015}00015 \textcolor{comment}{// LIC// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00016}00016 \textcolor{comment}{// LIC// Lesser General Public License for more details.}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00017}00017 \textcolor{comment}{// LIC//}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00018}00018 \textcolor{comment}{// LIC// You should have received a copy of the GNU Lesser General Public}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00019}00019 \textcolor{comment}{// LIC// License along with this library; if not, write to the Free Software}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00020}00020 \textcolor{comment}{// LIC// Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00021}00021 \textcolor{comment}{// LIC// 02110-\/1301  USA.}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00022}00022 \textcolor{comment}{// LIC//}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00023}00023 \textcolor{comment}{// LIC// The authors may be contacted at oomph-\/lib@maths.man.ac.uk.}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00024}00024 \textcolor{comment}{// LIC//}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00025}00025 \textcolor{comment}{// LIC//====================================================================}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00026}00026 \textcolor{comment}{// Non-\/inline functions for fluid free surface elements}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00027}00027 }
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00028}00028 \textcolor{comment}{// OOMPH-\/LIB headers}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00029}00029 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{surfactant__transport__elements_8h}{surfactant\_transport\_elements.h}}"{}}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00030}00030 }
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00031}00031 \textcolor{keyword}{namespace }\mbox{\hyperlink{namespaceoomph}{oomph}}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00032}00032 \{}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00033}00033   \textcolor{comment}{// Define the default physical value to be one}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00034}00034   \textcolor{keywordtype}{double} \mbox{\hyperlink{classoomph_1_1SurfactantTransportInterfaceElement_ae2c6f40fd7bc427636ac25c23d816e74}{SurfactantTransportInterfaceElement::Default\_Physical\_Constant\_Value}} =}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00035}00035     1.0;}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00036}00036 }
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00037}00037   \textcolor{comment}{//=====================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00038}00038 \textcolor{comment}{  /// Get the surfactant concentration}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00039}00039 \textcolor{comment}{}  \textcolor{comment}{//=====================================================================}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00040}\mbox{\hyperlink{classoomph_1_1SurfactantTransportInterfaceElement_a9da12df06b20e5f1ce0736acfc7e8d83}{00040}}   \textcolor{keywordtype}{double} \mbox{\hyperlink{classoomph_1_1SurfactantTransportInterfaceElement_a9da12df06b20e5f1ce0736acfc7e8d83}{SurfactantTransportInterfaceElement::interpolated\_C}}(}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00041}00041     \textcolor{keyword}{const} Vector<double>\& s)}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00042}00042   \{}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00043}00043     \textcolor{comment}{// Find number of nodes}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00044}00044     \textcolor{keywordtype}{unsigned} n\_node = this-\/>nnode();}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00045}00045 }
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00046}00046     \textcolor{comment}{// Local shape function}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00047}00047     Shape psi(n\_node);}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00048}00048 }
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00049}00049     \textcolor{comment}{// Find values of shape function}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00050}00050     this-\/>shape(s, psi);}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00051}00051 }
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00052}00052     \textcolor{comment}{// Initialise value of C}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00053}00053     \textcolor{keywordtype}{double} C = 0.0;}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00054}00054 }
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00055}00055     \textcolor{comment}{// Loop over the local nodes and sum}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00056}00056     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} l = 0; l < n\_node; l++)}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00057}00057     \{}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00058}00058       C += this-\/>nodal\_value(l, this-\/>\mbox{\hyperlink{classoomph_1_1SurfactantTransportInterfaceElement_a26727fb7b57f88d3e1bdf4f2dd9f3b02}{C\_index}}[l]) * psi(l);}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00059}00059     \}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00060}00060 }
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00061}00061     \textcolor{keywordflow}{return} (C);}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00062}00062   \}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00063}00063 }
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00064}00064   \textcolor{comment}{//=====================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00065}00065 \textcolor{comment}{  /// The time derivative of the surface concentration}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00066}00066 \textcolor{comment}{}  \textcolor{comment}{//=====================================================================}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00067}\mbox{\hyperlink{classoomph_1_1SurfactantTransportInterfaceElement_a7b5cc851b94d836a3caa2130cbf45bec}{00067}}   \textcolor{keywordtype}{double} \mbox{\hyperlink{classoomph_1_1SurfactantTransportInterfaceElement_a7b5cc851b94d836a3caa2130cbf45bec}{SurfactantTransportInterfaceElement::dcdt\_surface}}(}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00068}00068     \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\& l)\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00069}00069 \textcolor{keyword}{  }\{}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00070}00070     \textcolor{comment}{// Get the data's timestepper}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00071}00071     TimeStepper* time\_stepper\_pt = this-\/>node\_pt(l)-\/>time\_stepper\_pt();}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00072}00072 }
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00073}00073     \textcolor{comment}{// Initialise dudt}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00074}00074     \textcolor{keywordtype}{double} dcdt = 0.0;}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00075}00075     \textcolor{comment}{// Loop over the timesteps, if there is a non Steady timestepper}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00076}00076     \textcolor{keywordflow}{if} (time\_stepper\_pt-\/>type() != \textcolor{stringliteral}{"{}Steady"{}})}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00077}00077     \{}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00078}00078       \textcolor{comment}{// Number of timsteps (past \& present)}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00079}00079       \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} n\_time = time\_stepper\_pt-\/>ntstorage();}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00080}00080 }
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00081}00081       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} t = 0; t < n\_time; t++)}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00082}00082       \{}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00083}00083         dcdt += time\_stepper\_pt-\/>weight(1, t) *}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00084}00084                 this-\/>nodal\_value(t, l, this-\/>\mbox{\hyperlink{classoomph_1_1SurfactantTransportInterfaceElement_a26727fb7b57f88d3e1bdf4f2dd9f3b02}{C\_index}}[l]);}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00085}00085       \}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00086}00086     \}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00087}00087     \textcolor{keywordflow}{return} dcdt;}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00088}00088   \}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00089}00089 }
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00090}00090   \textcolor{comment}{//=====================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00091}00091 \textcolor{comment}{  /// The surface tension function is linear in the}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00092}00092 \textcolor{comment}{  /// concentration with constant of proportionality equal}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00093}00093 \textcolor{comment}{  /// to the elasticity  number.}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00094}00094 \textcolor{comment}{}  \textcolor{comment}{//=====================================================================}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00095}\mbox{\hyperlink{classoomph_1_1SurfactantTransportInterfaceElement_a1710057c610ccccc06ef41f34f086aae}{00095}}   \textcolor{keywordtype}{double} \mbox{\hyperlink{classoomph_1_1SurfactantTransportInterfaceElement_a1710057c610ccccc06ef41f34f086aae}{SurfactantTransportInterfaceElement::sigma}}(\textcolor{keyword}{const} Vector<double>\& s)}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00096}00096   \{}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00097}00097     \textcolor{comment}{// Find the number of shape functions}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00098}00098     \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} n\_node = this-\/>nnode();}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00099}00099     \textcolor{comment}{// Now get the shape fuctions at the local coordinate}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00100}00100     Shape psi(n\_node);}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00101}00101     this-\/>shape(s, psi);}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00102}00102 }
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00103}00103     \textcolor{comment}{// Now interpolate the temperature and surfactant concentration}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00104}00104     \textcolor{keywordtype}{double} C = 0.0;}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00105}00105     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} l = 0; l < n\_node; l++)}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00106}00106     \{}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00107}00107       C += this-\/>nodal\_value(l, this-\/>\mbox{\hyperlink{classoomph_1_1SurfactantTransportInterfaceElement_a26727fb7b57f88d3e1bdf4f2dd9f3b02}{C\_index}}[l]) * psi(l);}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00108}00108     \}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00109}00109 }
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00110}00110     \textcolor{comment}{// Get the Elasticity numbers}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00111}00111     \textcolor{keywordtype}{double} Beta = this-\/>\mbox{\hyperlink{classoomph_1_1SurfactantTransportInterfaceElement_a79003d87401ad6106b8d10373ff12e73}{beta}}();}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00112}00112     \textcolor{comment}{// Return the variable surface tension}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00113}00113     \textcolor{keywordflow}{return} (1.0 -\/ Beta * (C -\/ 1.0));}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00114}00114   \}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00115}00115 }
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00116}00116   \textcolor{comment}{//=======================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00117}00117 \textcolor{comment}{  /// Overload the Helper function to calculate the residuals and}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00118}00118 \textcolor{comment}{  /// jacobian entries. This particular function ensures that the}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00119}00119 \textcolor{comment}{  /// additional entries are calculated inside the integration loop}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00120}\mbox{\hyperlink{classoomph_1_1SurfactantTransportInterfaceElement_adedf33390efdf652e169f8bd38eb2350}{00120}} \textcolor{comment}{}  \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1SurfactantTransportInterfaceElement_adedf33390efdf652e169f8bd38eb2350}{SurfactantTransportInterfaceElement::}}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00121}00121 \mbox{\hyperlink{classoomph_1_1SurfactantTransportInterfaceElement_adedf33390efdf652e169f8bd38eb2350}{    add\_additional\_residual\_contributions\_interface}}(}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00122}00122       Vector<double>\& residuals,}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00123}00123       DenseMatrix<double>\& jacobian,}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00124}00124       \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\& flag,}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00125}00125       \textcolor{keyword}{const} Shape\& psif,}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00126}00126       \textcolor{keyword}{const} DShape\& dpsifds,}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00127}00127       \textcolor{keyword}{const} DShape\& dpsifdS,}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00128}00128       \textcolor{keyword}{const} DShape\& dpsifdS\_div,}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00129}00129       \textcolor{keyword}{const} Vector<double>\& s,}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00130}00130       \textcolor{keyword}{const} Vector<double>\& interpolated\_x,}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00131}00131       \textcolor{keyword}{const} Vector<double>\& interpolated\_n,}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00132}00132       \textcolor{keyword}{const} \textcolor{keywordtype}{double}\& W,}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00133}00133       \textcolor{keyword}{const} \textcolor{keywordtype}{double}\& J)}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00134}00134   \{}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00135}00135     \textcolor{comment}{// Find out how many nodes there are}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00136}00136     \textcolor{keywordtype}{unsigned} n\_node = this-\/>nnode();}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00137}00137 }
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00138}00138     \textcolor{comment}{// Storage for the local equation numbers and unknowns}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00139}00139     \textcolor{keywordtype}{int} local\_eqn = 0, local\_unknown = 0;}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00140}00140 }
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00141}00141     \textcolor{comment}{// Surface advection-\/diffusion equation}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00142}00142 }
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00143}00143     \textcolor{comment}{// Find the index at which the concentration is stored}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00144}00144     Vector<unsigned> u\_index = this-\/>\mbox{\hyperlink{classoomph_1_1FluidInterfaceElement_a6a818d9999c68641223edcad217a8c3f}{U\_index\_interface}};}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00145}00145 }
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00146}00146     \textcolor{comment}{// Read out the surface peclect number}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00147}00147     \textcolor{keyword}{const} \textcolor{keywordtype}{double} Pe\_s = this-\/>\mbox{\hyperlink{classoomph_1_1SurfactantTransportInterfaceElement_ac945c28401b92a061e3e245e83541c55}{peclet\_s}}();}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00148}00148     \textcolor{comment}{// const double PeSt\_s = this-\/>peclet\_strouhal\_s();}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00149}00149 }
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00150}00150     \textcolor{comment}{// Now calculate the concentration and derivatives at this point}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00151}00151     \textcolor{comment}{// Assuming the same shape functions are used (which they are)}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00152}00152     \textcolor{keywordtype}{double} \mbox{\hyperlink{classoomph_1_1SurfactantTransportInterfaceElement_a9da12df06b20e5f1ce0736acfc7e8d83}{interpolated\_C}} = 0.0;}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00153}00153     \textcolor{keywordtype}{double} dCdt = 0.0;}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00154}00154     \textcolor{comment}{// The tangent vectors and velocity}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00155}00155     \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} n\_dim = this-\/>node\_pt(0)-\/>ndim();}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00156}00156     Vector<double> \mbox{\hyperlink{classoomph_1_1FluidInterfaceElement_a8f807a6456da7785b12e45a4c17fb969}{interpolated\_u}}(n\_dim, 0.0);}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00157}00157     Vector<double> mesh\_velocity(n\_dim, 0.0);}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00158}00158     Vector<double> interpolated\_grad\_C(n\_dim, 0.0);}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00159}00159     \textcolor{keywordtype}{double} interpolated\_div\_u = 0.0;}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00160}00160 }
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00161}00161     \textcolor{comment}{// Loop over the shape functions}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00162}00162     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} l = 0; l < n\_node; l++)}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00163}00163     \{}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00164}00164       \textcolor{keyword}{const} \textcolor{keywordtype}{double} psi = psif(l);}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00165}00165       \textcolor{keyword}{const} \textcolor{keywordtype}{double} C\_ = this-\/>nodal\_value(l, this-\/>\mbox{\hyperlink{classoomph_1_1SurfactantTransportInterfaceElement_a26727fb7b57f88d3e1bdf4f2dd9f3b02}{C\_index}}[l]);}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00166}00166 }
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00167}00167       \mbox{\hyperlink{classoomph_1_1SurfactantTransportInterfaceElement_a9da12df06b20e5f1ce0736acfc7e8d83}{interpolated\_C}} += C\_ * psi;}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00168}00168       dCdt += \mbox{\hyperlink{classoomph_1_1SurfactantTransportInterfaceElement_a7b5cc851b94d836a3caa2130cbf45bec}{dcdt\_surface}}(l) * psi;}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00169}00169       \textcolor{comment}{// Velocity and Mesh Velocity}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00170}00170       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < n\_dim; j++)}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00171}00171       \{}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00172}00172         \textcolor{keyword}{const} \textcolor{keywordtype}{double} u\_ = this-\/>nodal\_value(l, u\_index[j]);}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00173}00173         \mbox{\hyperlink{classoomph_1_1FluidInterfaceElement_a8f807a6456da7785b12e45a4c17fb969}{interpolated\_u}}[j] += u\_ * psi;}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00174}00174         mesh\_velocity[j] += this-\/>dnodal\_position\_dt(l, j) * psi;}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00175}00175         interpolated\_grad\_C[j] += C\_ * dpsifdS(l, j);}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00176}00176         interpolated\_div\_u += u\_ * dpsifdS\_div(l, j);}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00177}00177       \}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00178}00178     \}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00179}00179 }
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00180}00180     \textcolor{comment}{// Pre-\/compute advection term}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00181}00181     \textcolor{keywordtype}{double} interpolated\_advection\_term = \mbox{\hyperlink{classoomph_1_1SurfactantTransportInterfaceElement_a9da12df06b20e5f1ce0736acfc7e8d83}{interpolated\_C}} * interpolated\_div\_u;}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00182}00182     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} i = 0; i < n\_dim; i++)}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00183}00183     \{}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00184}00184       interpolated\_advection\_term +=}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00185}00185         (\mbox{\hyperlink{classoomph_1_1FluidInterfaceElement_a8f807a6456da7785b12e45a4c17fb969}{interpolated\_u}}[i] -\/ mesh\_velocity[i]) * interpolated\_grad\_C[i];}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00186}00186     \}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00187}00187 }
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00188}00188 }
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00189}00189     \textcolor{comment}{// Now we add the flux term to the appropriate residuals}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00190}00190     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} l = 0; l < n\_node; l++)}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00191}00191     \{}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00192}00192       \textcolor{comment}{// Read out the apprporiate local equation}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00193}00193       local\_eqn = this-\/>nodal\_local\_eqn(l, this-\/>\mbox{\hyperlink{classoomph_1_1SurfactantTransportInterfaceElement_a26727fb7b57f88d3e1bdf4f2dd9f3b02}{C\_index}}[l]);}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00194}00194 }
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00195}00195       \textcolor{comment}{// If not a boundary condition}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00196}00196       \textcolor{keywordflow}{if} (local\_eqn >= 0)}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00197}00197       \{}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00198}00198         \textcolor{comment}{// Time derivative term}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00199}00199         residuals[local\_eqn] += dCdt * psif(l) * W * J;}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00200}00200 }
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00201}00201         \textcolor{comment}{// First Advection term}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00202}00202         residuals[local\_eqn] += interpolated\_advection\_term * psif(l) * W * J;}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00203}00203 }
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00204}00204         \textcolor{comment}{// Diffusion term}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00205}00205         \textcolor{keywordtype}{double} diffusion\_term = 0.0;}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00206}00206         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} i = 0; i < n\_dim; i++)}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00207}00207         \{}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00208}00208           diffusion\_term += interpolated\_grad\_C[i] * dpsifdS(l, i);}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00209}00209         \}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00210}00210         residuals[local\_eqn] += (1.0 / Pe\_s) * diffusion\_term * W * J;}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00211}00211 }
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00212}00212         \textcolor{comment}{// We also need to worry about the jacobian terms}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00213}00213         \textcolor{keywordflow}{if} (flag)}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00214}00214         \{}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00215}00215           \textcolor{comment}{// Loop over the nodes again}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00216}00216           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} l2 = 0; l2 < n\_node; l2++)}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00217}00217           \{}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00218}00218             \textcolor{comment}{// Get the time stepper}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00219}00219             TimeStepper* time\_stepper\_pt = this-\/>node\_pt(l2)-\/>time\_stepper\_pt();}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00220}00220 }
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00221}00221             \textcolor{comment}{// Get the unknown c\_index}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00222}00222             local\_unknown = this-\/>nodal\_local\_eqn(l2, this-\/>\mbox{\hyperlink{classoomph_1_1SurfactantTransportInterfaceElement_a26727fb7b57f88d3e1bdf4f2dd9f3b02}{C\_index}}[l2]);}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00223}00223 }
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00224}00224             \textcolor{keywordflow}{if} (local\_unknown >= 0)}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00225}00225             \{}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00226}00226               jacobian(local\_eqn, local\_unknown) +=}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00227}00227                 time\_stepper\_pt-\/>weight(1, 0) * psif(l2) * psif(l) * W * J;}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00228}00228 }
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00229}00229               jacobian(local\_eqn, local\_unknown) +=}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00230}00230                 psif(l2) * interpolated\_div\_u * psif(l) * W * J;}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00231}00231 }
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00232}00232               \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} i = 0; i < n\_dim; i++)}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00233}00233               \{}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00234}00234                 jacobian(local\_eqn, local\_unknown) +=}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00235}00235                   (\mbox{\hyperlink{classoomph_1_1FluidInterfaceElement_a8f807a6456da7785b12e45a4c17fb969}{interpolated\_u}}[i] -\/ mesh\_velocity[i]) * dpsifdS(l2, i) *}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00236}00236                   psif(l) * W * J;}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00237}00237               \}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00238}00238 }
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00239}00239               \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} i = 0; i < n\_dim; i++)}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00240}00240               \{}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00241}00241                 jacobian(local\_eqn, local\_unknown) +=}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00242}00242                   (1.0 / Pe\_s) * dpsifdS(l2, i) * dpsifdS(l, i) * W * J;}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00243}00243               \}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00244}00244             \}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00245}00245 }
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00246}00246 }
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00247}00247             \textcolor{comment}{// Loop over the velocity components}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00248}00248             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} i2 = 0; i2 < n\_dim; i2++)}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00249}00249             \{}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00250}00250               \textcolor{comment}{// Get the unknown}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00251}00251               local\_unknown = this-\/>nodal\_local\_eqn(l2, u\_index[i2]);}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00252}00252 }
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00253}00253 }
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00254}00254               \textcolor{comment}{// If not a boundary condition}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00255}00255               \textcolor{keywordflow}{if} (local\_unknown >= 0)}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00256}00256               \{}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00257}00257                 \textcolor{comment}{// Bits from the advection term}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00258}00258                 jacobian(local\_eqn, local\_unknown) +=}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00259}00259                   (\mbox{\hyperlink{classoomph_1_1SurfactantTransportInterfaceElement_a9da12df06b20e5f1ce0736acfc7e8d83}{interpolated\_C}} * dpsifdS\_div(l2, i2) +}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00260}00260                    psif(l2) * interpolated\_grad\_C[i2]) *}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00261}00261                   psif(l) * W * J;}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00262}00262               \}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00263}00263             \}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00264}00264           \}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00265}00265         \}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00266}00266       \}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00267}00267 }
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00268}00268       \textcolor{keywordflow}{if} (flag)}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00269}00269       \{}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00270}00270         \textcolor{keyword}{const} \textcolor{keywordtype}{double} dsigma = this-\/>\mbox{\hyperlink{classoomph_1_1SurfactantTransportInterfaceElement_a36422cf9aa94de6f0bfa668e5d4fa900}{dsigma\_dC}}(s);}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00271}00271         \textcolor{keyword}{const} \textcolor{keywordtype}{double} Ca = this-\/>\mbox{\hyperlink{classoomph_1_1FluidInterfaceElement_a33879379e89157fe00e733488f47f97a}{ca}}();}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00272}00272         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} l2 = 0; l2 < n\_node; l2++)}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00273}00273         \{}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00274}00274           local\_unknown = this-\/>nodal\_local\_eqn(l2, this-\/>\mbox{\hyperlink{classoomph_1_1SurfactantTransportInterfaceElement_a26727fb7b57f88d3e1bdf4f2dd9f3b02}{C\_index}}[l2]);}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00275}00275           \textcolor{keywordflow}{if} (local\_unknown >= 0)}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00276}00276           \{}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00277}00277             \textcolor{keyword}{const} \textcolor{keywordtype}{double} psi\_ = psif(l2);}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00278}00278             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} i = 0; i < n\_dim; i++)}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00279}00279             \{}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00280}00280               \textcolor{comment}{// Add the Jacobian contribution from the surface tension}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00281}00281               local\_eqn = this-\/>nodal\_local\_eqn(l, u\_index[i]);}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00282}00282               \textcolor{keywordflow}{if} (local\_eqn >= 0)}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00283}00283               \{}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00284}00284                 jacobian(local\_eqn, local\_unknown) -\/=}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00285}00285                   (dsigma / Ca) * psi\_ * dpsifdS\_div(l, i) * J * W;}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00286}00286               \}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00287}00287             \}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00288}00288           \}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00289}00289         \}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00290}00290       \}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00291}00291 }
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00292}00292     \} \textcolor{comment}{// End of loop over the nodes}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00293}00293   \}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00294}00294 }
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00295}00295   \textcolor{comment}{//=======================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00296}00296 \textcolor{comment}{  /// Overload the output function}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00297}00297 \textcolor{comment}{}  \textcolor{comment}{//=======================================================}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00298}\mbox{\hyperlink{classoomph_1_1SurfactantTransportInterfaceElement_aebc3ed4954b636f4992a212c7973c670}{00298}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1SurfactantTransportInterfaceElement_a280f065d9cb85438c0fe4f7cd95d14b3}{SurfactantTransportInterfaceElement::output}}(std::ostream\& outfile,}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00299}00299                                                    \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\& n\_plot)}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00300}00300   \{}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00301}00301     outfile.precision(16);}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00302}00302 }
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00303}00303     \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} el\_dim = this-\/>dim();}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00304}00304     \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} n\_dim = this-\/>nodal\_dimension();}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00305}00305     \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} n\_velocity = this-\/>\mbox{\hyperlink{classoomph_1_1FluidInterfaceElement_a6a818d9999c68641223edcad217a8c3f}{U\_index\_interface}}.size();}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00306}00306 }
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00307}00307     \textcolor{comment}{// Set output Vector}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00308}00308     Vector<double> s(el\_dim);}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00309}00309     Vector<double> n(n\_dim);}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00310}00310     Vector<double> \mbox{\hyperlink{classoomph_1_1FluidInterfaceElement_a50a509413ea7f2a481678837846dd476}{u}}(n\_velocity);}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00311}00311 }
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00312}00312 }
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00313}00313     outfile << this-\/>tecplot\_zone\_string(n\_plot);}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00314}00314 }
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00315}00315     \textcolor{comment}{// Loop over plot points}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00316}00316     \textcolor{keywordtype}{unsigned} num\_plot\_points = this-\/>nplot\_points(n\_plot);}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00317}00317     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} iplot = 0; iplot < num\_plot\_points; iplot++)}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00318}00318     \{}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00319}00319       \textcolor{comment}{// Get local coordinates of plot point}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00320}00320       this-\/>get\_s\_plot(iplot, n\_plot, s);}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00321}00321       \textcolor{comment}{// Get the outer unit normal}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00322}00322       this-\/>outer\_unit\_normal(s, n);}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00323}00323 }
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00324}00324       \textcolor{keywordtype}{double} u\_n = 0.0;}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00325}00325       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} i = 0; i < n\_velocity; i++)}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00326}00326       \{}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00327}00327         \mbox{\hyperlink{classoomph_1_1FluidInterfaceElement_a50a509413ea7f2a481678837846dd476}{u}}[i] = this-\/>\mbox{\hyperlink{classoomph_1_1FluidInterfaceElement_a8f807a6456da7785b12e45a4c17fb969}{interpolated\_u}}(s, i);}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00328}00328       \}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00329}00329 }
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00330}00330       \textcolor{comment}{// Not the same as above for axisymmetric case}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00331}00331       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} i = 0; i < n\_dim; i++)}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00332}00332       \{}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00333}00333         u\_n += \mbox{\hyperlink{classoomph_1_1FluidInterfaceElement_a50a509413ea7f2a481678837846dd476}{u}}[i] * n[i];}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00334}00334       \}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00335}00335 }
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00336}00336       \textcolor{comment}{// Output the x,y,u,v}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00337}00337       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} i = 0; i < n\_dim; i++)}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00338}00338         outfile << this-\/>interpolated\_x(s, i) << \textcolor{stringliteral}{"{} "{}};}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00339}00339       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} i = 0; i < n\_dim; i++) outfile << \mbox{\hyperlink{classoomph_1_1FluidInterfaceElement_a50a509413ea7f2a481678837846dd476}{u}}[i] << \textcolor{stringliteral}{"{} "{}};}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00340}00340       \textcolor{comment}{// Output a dummy pressure}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00341}00341       outfile << 0.0 << \textcolor{stringliteral}{"{} "{}};}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00342}00342       \textcolor{comment}{// Output the concentration}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00343}00343       outfile << \mbox{\hyperlink{classoomph_1_1SurfactantTransportInterfaceElement_a9da12df06b20e5f1ce0736acfc7e8d83}{interpolated\_C}}(s) << \textcolor{stringliteral}{"{} "{}};}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00344}00344       \textcolor{comment}{// Output the interfacial tension}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00345}00345       outfile << \mbox{\hyperlink{classoomph_1_1SurfactantTransportInterfaceElement_a1710057c610ccccc06ef41f34f086aae}{sigma}}(s) << \textcolor{stringliteral}{"{} "{}};}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00346}00346       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} i = 0; i < n\_dim; i++)}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00347}00347       \{}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00348}00348         outfile << \mbox{\hyperlink{classoomph_1_1FluidInterfaceElement_a50a509413ea7f2a481678837846dd476}{u}}[i] -\/ u\_n * n[i] << \textcolor{stringliteral}{"{} "{}};}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00349}00349       \}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00350}00350       outfile << std::endl;}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00351}00351     \}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00352}00352     outfile << std::endl;}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00353}00353   \}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00354}00354 }
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00355}00355   \textcolor{comment}{//=======================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00356}00356 \textcolor{comment}{  /// Compute the concentration intergated over the surface area}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00357}00357 \textcolor{comment}{}  \textcolor{comment}{//=======================================================================}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00358}\mbox{\hyperlink{classoomph_1_1SurfactantTransportInterfaceElement_a703c35a6da2925926c976957f2da77c4}{00358}}   \textcolor{keywordtype}{double} \mbox{\hyperlink{classoomph_1_1SurfactantTransportInterfaceElement_a703c35a6da2925926c976957f2da77c4}{SurfactantTransportInterfaceElement::integrate\_c}}()}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00359}00359   \{}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00360}00360     \textcolor{comment}{// Find out how many nodes there are}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00361}00361     \textcolor{keywordtype}{unsigned} n\_node = this-\/>nnode();}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00362}00362 }
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00363}00363     \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} el\_dim = this-\/>dim();}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00364}00364     \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} n\_dim = this-\/>nodal\_dimension();}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00365}00365 }
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00366}00366     \textcolor{comment}{// Set up memeory for the shape functions}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00367}00367     Shape psif(n\_node);}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00368}00368     DShape dpsifds(n\_node, el\_dim);}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00369}00369     DShape dpsifdS(n\_node, n\_dim);}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00370}00370     DShape dpsifdS\_div(n\_node, n\_dim);}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00371}00371 }
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00372}00372     \textcolor{comment}{// Set the value of n\_intpt}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00373}00373     \textcolor{keywordtype}{unsigned} n\_intpt = this-\/>integral\_pt()-\/>nweight();}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00374}00374 }
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00375}00375     \textcolor{comment}{// Storage for the local coordinate}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00376}00376     Vector<double> s(el\_dim);}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00377}00377 }
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00378}00378     \textcolor{comment}{// Storage for the total mass}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00379}00379     \textcolor{keywordtype}{double} mass = 0.0;}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00380}00380 }
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00381}00381     \textcolor{comment}{// Loop over the integration points}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00382}00382     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} ipt = 0; ipt < n\_intpt; ipt++)}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00383}00383     \{}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00384}00384       \textcolor{comment}{// Get the local coordinate at the integration point}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00385}00385       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} i = 0; i < el\_dim; i++)}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00386}00386       \{}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00387}00387         s[i] = this-\/>integral\_pt()-\/>knot(ipt, i);}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00388}00388       \}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00389}00389 }
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00390}00390       \textcolor{comment}{// Get the integral weight}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00391}00391       \textcolor{keywordtype}{double} W = this-\/>integral\_pt()-\/>weight(ipt);}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00392}00392 }
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00393}00393       \textcolor{comment}{// Call the derivatives of the shape function}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00394}00394       this-\/>dshape\_local\_at\_knot(ipt, psif, dpsifds);}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00395}00395 }
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00396}00396       Vector<double> interpolated\_x(n\_dim, 0.0);}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00397}00397       DenseMatrix<double> interpolated\_t(el\_dim, n\_dim, 0.0);}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00398}00398       \textcolor{keywordtype}{double} interpolated\_c = 0.0;}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00399}00399 }
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00400}00400       \textcolor{comment}{// Loop over the shape functions}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00401}00401       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} l = 0; l < n\_node; l++)}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00402}00402       \{}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00403}00403         \textcolor{keyword}{const} \textcolor{keywordtype}{double} psi\_ = psif(l);}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00404}00404         interpolated\_c += this-\/>nodal\_value(l, this-\/>\mbox{\hyperlink{classoomph_1_1SurfactantTransportInterfaceElement_a26727fb7b57f88d3e1bdf4f2dd9f3b02}{C\_index}}[l]) * psi\_;}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00405}00405         \textcolor{comment}{// Loop over directional components}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00406}00406         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} i = 0; i < n\_dim; i++)}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00407}00407         \{}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00408}00408           \textcolor{comment}{// Coordinate}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00409}00409           interpolated\_x[i] += this-\/>nodal\_position(l, i) * psi\_;}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00410}00410 }
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00411}00411           \textcolor{comment}{// Calculate the tangent vectors}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00412}00412           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < el\_dim; j++)}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00413}00413           \{}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00414}00414             interpolated\_t(j, i) += this-\/>nodal\_position(l, i) * dpsifds(l, j);}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00415}00415           \}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00416}00416         \}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00417}00417       \}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00418}00418 }
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00419}00419       \textcolor{comment}{// Calculate the surface gradient and divergence}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00420}00420       \textcolor{keywordtype}{double} J = this-\/>\mbox{\hyperlink{classoomph_1_1FluidInterfaceElement_a0180a8e36fadbbe6984f9b3c5edffc81}{compute\_surface\_derivatives}}(}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00421}00421         psif, dpsifds, interpolated\_t, interpolated\_x, dpsifdS, dpsifdS\_div);}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00422}00422 }
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00423}00423       mass += interpolated\_c * W * J;}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00424}00424     \}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00425}00425     \textcolor{keywordflow}{return} mass;}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00426}00426   \}}
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00427}00427 }
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00428}00428 }
\DoxyCodeLine{\Hypertarget{surfactant__transport__elements_8cc_source_l00429}00429 \} \textcolor{comment}{// namespace oomph}}

\end{DoxyCode}

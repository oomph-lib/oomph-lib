<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
<title>oomph-lib: adaptive_bubble_in_channel.txt_doxygenified.h Source File</title>
<link rel="apple-touch-icon" sizes="57x57" href="../../../figures/apple-touch-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="../../../figures/apple-touch-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="../../../figures/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="../../../figures/apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="../../../figures/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="../../../figures/apple-touch-icon-120x120.png">
<link rel="icon" type="image/png" href="../../../figures/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="../../../figures/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="../../../figures/favicon-16x16.png" sizes="16x16">
<link rel="manifest" href="../../../figures/manifest.json">
<link rel="mask-icon" href="../../../figures/safari-pinned-tab.svg" color="#008000">
<link rel="shortcut icon" href="../../../figures/favicon.ico">
<meta name="msapplication-TileColor" content="#00a300">
<meta name="msapplication-config" content="../../../figures/browserconfig.xml">
<meta name="theme-color" content="#008000">
<link href="http://fonts.googleapis.com/css?family=Open+Sans:400,300,600" rel="stylesheet" type="text/css">
<!-- Doxygen css-->
<!-- <link rel="stylesheet" type="text/css" href="doxygen.css"> -->
<!-- Bootstrap -->
<link href="../../../css/bootstrap.css" rel="stylesheet">
<!-- oomph-lib specific overrides -->
<link rel="stylesheet" type="text/css" href="../../../css/oomph_header.css">
</head>
<body>
<nav class="navbar navbar-default">
<div class="container">
<div class="container-fluid">
  <!-- Brand and toggle get grouped for better mobile display -->
  <div class="navbar-header">
    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
      <span class="sr-only">Toggle navigation</span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="../../../html/index.html"><img alt="oomph-lib" src="../../../figures/oomph_logo.png"></a>
  </div>
  <!-- Collect the nav links, forms, and other content for toggling -->
  <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
    <ul class="nav navbar-nav">          
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Documentation <span class="caret"></span></a>
        <ul class="dropdown-menu">
          <li class="dropdown-header">Big picture</li>
          <li><a href="../../../../doc/intro/html/index.html">The finite element method</a></li>
          <li><a href="../../../../doc/the_data_structure/html/index.html">The data structure</a></li>
          <li><a href="../../../../doc/quick_guide/html/index.html">Not-so-quick guide</a></li>
          <li><a href="../../../../doc/optimisation/html/index.html">Optimisation</a></li>
          <li><a href="../../../../doc/order_of_action_functions/html/index.html">Order of action functions</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Example codes and tutorials</li>
          <li><a href="../../../../doc/example_code_list/html/index.html">List of example codes and tutorials</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#meshes">Meshing</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#solvers">Solvers</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#parallel">MPI parallel processing</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#visualisation">Post-processing/visualisation</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Other</li>
          <li><a href="../../../../doc/change_log/html/index.html">Change log</a></li>
          <li><a href="../../../../doc/creating_doc/html/index.html">Creating documentation</a></li>
          <li><a href="../../../../doc/coding_conventions/html/index.html">Coding conventions</a></li>
          <li><a href="../../../../doc/index/html/index.html">Index</a></li>
          <li><a href="../../../../doc/FAQ/html/index.html">FAQ</a></li>
        </ul>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Get it <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../../doc/the_distribution/html/index.html">Installation guide</a></li>
            <li><a href="../../../../doc/subversion/html/index.html">Get code from subversion repository</a></li>
            <li><a href="../../../../doc/download/html/index.html">Get code as tar file</a></li>
            <li><a href="../../../../doc/copyright/html/index.html">Copyright</a></li>
          </ul>
        </li>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">About <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../../doc/people/html/index.html">People</a></li>            
            <li><a href="../../../../doc/contact/html/index.html">Contact/Get involved</a></li>
            <li><a href="../../../../doc/publications/html/index.html">Publications</a></li>
            <li><a href="../../../../doc/acknowledgements/html/index.html">Acknowledgements</a></li>
            <li><a href="../../../../doc/picture_show/index.html">Picture show</a></li>
          </ul>
        </li>
      </li>
    </ul>
    <ul class="nav navbar-nav navbar-right navbar-search">
      <form class="navbar-form" role="search" action="../../../../doc/search_results/html/index.html">
        <div class="input-group">
          <input type="text" class="form-control" placeholder="Search" name="q">
          <span class="input-group-btn">
            <button class="btn btn-default" type="submit">Go</button>
          </span>
        </div><!-- /input-group -->
       <!--<div class="form-group">
          <input type="text" class="form-control" placeholder="Search">
        </div>
        <button type="submit" class="btn btn-default">Submit</button>-->
      </form>
    </ul>
  </div><!-- /.navbar-collapse -->
</div><!-- /.container-fluid -->
</div>
</nav>
<!-- Generated by Doxygen 1.8.17 -->
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">adaptive_bubble_in_channel.txt_doxygenified.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="adaptive__bubble__in__channel_8txt__doxygenified_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">\mainpage Propagation of a bubble in a channel - mesh generation and adaptation for free surface problems</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">In this tutorial we demonstrate the adaptive solution of free surface</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">problems on unstructured meshes, using the example of a bubble</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">propagating along a straight channel. We also demonstrate how to</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">impose volume constraints on enclosed regions within the fluid.</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">  </span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">&lt;HR&gt; &lt;HR&gt; </span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">\section example The example problem </span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">We illustrate the solution</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">of the unsteady 2D Navier-Stokes equations by considering the</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">propagation of a single bubble along a straight channel as shown in</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">the sketch below. We non-dimensionalise all lengths on the channel</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">width, \f$ \mathcal{L}=H \f$, velocities on the maximum (prescribed) </span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">inflow velocity, \f$ \mathcal{U} \f$, and time on the intrinsic timescale, </span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">\f$ \mathcal{T}=\mathcal{L}/\mathcal{U} \f$ , which corresponds to a</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">Strouhal number \f$ St=1.0 \f$ .</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">\image html problem.gif &quot;The problem setup. &quot; </span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">\image latex problem.eps &quot;The problem setup. &quot; width=0.9\textwidth</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">The problem is then governed by the following equations.</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment"> </span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment">Solve </span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">\f[ </span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment">Re\Big(St\frac{\partial u_i}{\partial t}+u_j\frac{\partial</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment">u_i}{\partial x_j} \Big) = - \frac{\partial p}{\partial x_i} +</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment">\frac{\partial }{\partial x_j} \left( \frac{\partial u_i}{\partial</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment">x_j} + \frac{\partial u_j}{\partial x_i} \right), \ \ \ \ \ \ \ \ \ \</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment">(1) </span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment">and </span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment">\f[ </span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment">\frac{\partial u_i}{\partial x_i} = 0, </span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment">\f] </span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment">in the rectangular</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment">domain \f$ D = \left\{x_1 \in [0,1]; x_2 \in [0,L] \right\} \f$ ,</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment">subject to the Dirichlet boundary conditions </span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment">\f[ </span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment">u_1=0, \ \ \ \ \ \ \ \ \ \ (2) </span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment">\f] </span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment">on the top and bottom boundaries and</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment">\f[ </span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment">u_2=0, \ \ \ \ \ \ \ \ \ \ (3) </span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment">\f] </span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment">on all boundaries.  The inflow on the left boundary is described by a</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment">Poiseuille flow profile </span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment">\f[ </span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment">u_1(x_2)=4 x_2 (1-x_2).  \ \ \ \ \ \ \ \ \ \ (4) </span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment">\f] </span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment">The free surface is defined by the position</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment">vector \f$ \mathbf{R} \f$, which is subject to the kinematic condition</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment">\f[ </span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="comment">\Big(u_i-St \frac{\partial R_i}{\partial t} \Big) n_i =0, \ \ \ \</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="comment">\ \ \ \ \ \ (5) </span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="comment">\f] </span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment">and the dynamic condition </span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="comment">\tau_{ij} n_j=- \Big( \frac{1}{Ca} \kappa+p_{bubble} \Big) n_i, \ \ \</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="comment">\ \ \ \ \ \ \ (6) </span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="comment">\f] </span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="comment">where the stress tensor is defined</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="comment">as </span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="comment">\f[ </span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="comment">\tau_{ij}=-p \delta_{ij}+\Big( \frac{\partial u_i}{\partial</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="comment">x_j} + \frac{\partial u_j}{\partial x_i} \Big).  \ \ \ \ \ \ \ \ \ \</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="comment">(7) </span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="comment">\f] </span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="comment">The initial position of the interface, for a</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="comment">bubble initially located in the centre of the channel, is given by </span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="comment">\mathbf{R}(\zeta)=\Big( \frac{L}{2}+ a \frac{1-\zeta^2}{1+\zeta^2},</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="comment">\frac{1}{2} + a \frac{2\zeta}{1+\zeta^2} \Big), \ \ \ \ \ \ \ \ \ \</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="comment">(8) </span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment">\f] </span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="comment">where \f$ a \f$ is the initial</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="comment">non-dimensional bubble radius and \f$ \zeta=[0,2\pi] \f$.</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="comment">The problem is subject to the constraint that the bubble volume, </span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="comment">\f$ V_{bubble} \f$, remains constant which is achieved by adjusting, </span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="comment">the bubble pressure, \f$ p_{bubble} \f$ . We formulate the </span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="comment">volume constraint by making use</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="comment">of Gauss` theorem, which states that for any vector \f$ \mathbf{b} \f$</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="comment">\f[ </span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="comment">\int \nabla . \mathbf{b} dV = \oint \mathbf{b}. \mathbf{n} dS.  \</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="comment"> \ \ \ \ \ \ \ \ \ (9) </span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="comment">Choosing \f$ \mathbf{b}=\mathbf{x} \f$ we note that the divergence of</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="comment">\f$\mathbf{x}\f$ gives the spatial dimension \f$ D \f$ and the</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="comment">integral \f$\int dV\f$ is the enclosed volume \f$V_{bubble}\f$. Hence,</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="comment">the volume constraint can be written as</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="comment">\f[ </span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="comment">V_{bubble}-\frac{1}{D} \oint \mathbf{R}.\mathbf{n} dS=0.  \ \ \ \</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="comment"> \ \ \ \ \ \ (10) </span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="comment">\f] </span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="comment">This is the equation that determines the unknown bubble pressure </span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="comment">\f$ p_{bubble} \f$ .</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="comment">&lt;HR&gt; &lt;HR&gt;</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="comment">\section implementation Implementation</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="comment">We solve the governing equations using an ALE-based finite-element</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="comment">method, discretising the fluid domain with triangular Taylor-Hood </span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="comment">elements, and updating the mesh with </span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="comment">&lt;a href=&quot;../../single_layer_free_surface/html/index.html#kinematic_condition_implementation&quot;&gt;a pseudo-elastic</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="comment">node-update procedure&lt;/a&gt;.  </span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="comment">As usual, we impose the kinematic and dynamic boundary conditions</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="comment">with \c FaceElements. The volume constraint is imposed in a similar</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="comment">way: We attach \c LineVolumeConstraintBoundingSolidElements to the </span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="comment">bubble surface to compute the line integrals in equation</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="comment">(10), and create an additional \c VolumeConstraintElement</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="comment">which adds \f$ V_{bubble} \f$ to this equation and is also &quot;in</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="comment">charge&quot; of the unknown bubble pressure. </span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="comment">&lt;HR&gt; &lt;HR&gt;</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="comment">\section results Results</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="comment">We perform the simulation in a two-stage procedure. We start by </span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="comment">performing a steady solve with the inflow switched off. This</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="comment">deforms the bubble into its steady state (approximately) circular</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="comment">configuration with the required volume. The actual time-dependent </span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="comment">simulation is then performed with an impulsive</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="comment">start from this configuration. </span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="comment">The figure below shows a contour plot of the pressure</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="comment">distribution with overlaid streamlines. This is a snapshot of </span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="comment">&lt;A HREF=&quot;../figures/bubble.avi&quot;&gt;an animation of the flow field&lt;/A&gt;, </span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="comment">for the parameters \f$ Re=ReSt=0.0 \f$ and \f$ Ca=0.05 \f$ .</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="comment">\image html tutorial.gif &quot;Snapshot of the flow field (streamlines and pressure contours) for a propagating bubble. &quot; </span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="comment">\image latex tutorial.eps &quot;Snapshot of the flow field (streamlines and pressure contours) for a propagating bubble. &quot; width=0.7\textwidth</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="comment">&lt;HR&gt; &lt;HR&gt;</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="comment">\section parameters Global parameters</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="comment">As usual, we create a namespace where we define the dimensionless </span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;<span class="comment">parameters \f$ Re \f$, \f$ Ca \f$ and the non-dimensional channel </span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="comment">length \f$ L \f$. As discussed in </span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="comment">&lt;a href=&quot;../../driven_cavity/html/index.html#params&quot;&gt;another tutorial&lt;/A&gt;, the</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="comment">Strouhal number defaults to one, so that we do not have to set it in</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="comment">this case. We also store the initial bubble radius and the bubble</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="comment">volume, as well as a scaling factor for the inflow</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="comment">velocity (this allows us to &quot;switch off&quot; the inflow when</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="comment">computing the initial steady solution). Finally we define </span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;<span class="comment">the Poisson ratio for the generalised</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="comment">Hookean constitutive law that is used by pseudo-elastic mesh update.</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<span class="comment">\dontinclude adaptive_bubble_in_channel.cc</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="comment">\skipline start_of_namespace</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="comment">\until end_of_namespace</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="comment">&lt;HR&gt; &lt;HR&gt;</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="comment">\section main The driver code </span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="comment">We start by processing the command line</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="comment">arguments and create the generalised Hookean constitutive equations</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="comment">for the pseudo-elastic node-update. We then open various output files</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="comment">and build the problem.</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="comment">\skipline start_of_main</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="comment">\until BubbleInChannelProblem</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="comment">We start by performing a steady solve (with the inflow switched off)</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="comment">to compute the initial configuration, a circular bubble in stationary</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="comment">fluid.</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="comment">\skipline Before starting</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="comment">\until problem.doc_solution()</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="comment">Next, the timestepper is initialised and an impulsive start</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="comment">performed. The inflow is switched on and the first few unsteady Newton</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="comment">solves are performed without adaptation. </span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;<span class="comment">\skipline Initialise timestepper</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="comment">\until // done solution on fixed mesh</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="comment"> </span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="comment">To limit the distortion of the elements we allow then mesh adaptation </span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="comment">(which involves the re-generation of the entire mesh) every few timesteps. </span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="comment">\skipline // Now do a proper</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="comment">\until End of main</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<span class="comment">&lt;HR&gt; &lt;HR&gt;</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="comment">\section problem The problem class</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;<span class="comment">As usual, we template the Problem class by the element type</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="comment">\dontinclude adaptive_bubble_in_channel.cc</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="comment">\skipline start_of_problem_class</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="comment">\until ~BubbleInChannelProblem()</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;<span class="comment">The \c FaceElements are deleted and re-attached before and after</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="comment">each adaptation. Also, as discussed in </span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="comment">&lt;A HREF=&quot;../../../meshes/mesh_from_inline_triangle/html/index.html#overview&quot;&gt;</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;<span class="comment">another tutorial&lt;/A&gt;, we re-apply the boundary conditions and complete the</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="comment">build of all elements after each adaptation, using the helper function</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="comment">\c complete_problem_setup() (discussed below).</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="comment"> </span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="comment">\skipline /// Actions before adapt</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="comment">\until void complete_problem_setup()</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;<span class="comment">We define the post-processing functions to document the solution and</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;<span class="comment">to compute the error estimates.</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;<span class="comment">\skipline Doc the solution</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;<span class="comment">\until compute_error_estimate(double&amp; max_err</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;<span class="comment">We also provide helper functions to delete and create face elements</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;<span class="comment">adjacent to the bubble boundary.</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;<span class="comment"> </span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;<span class="comment">\skipline private</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;<span class="comment">\until end of delete_volume_constraint_elements</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="comment">The private data includes pointers to the fluid mesh, and </span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="comment">the two face meshes which impose the kinematic and dynamic </span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="comment">boundary conditions, and the volume constraint, respectively.</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="comment">We also store pointers to the Data that stores the unknown bubble</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="comment">pressure and to the \c VolumeConstraintElement that imposes the </span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="comment">volume constraint and is &quot;in charge of&quot; the bubble pressure.</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="comment">\skipline Pointers to mesh of free surface elements</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="comment">\until end_of_problem_class</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;<span class="comment">&lt;HR&gt; &lt;HR&gt;</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;<span class="comment">\section constructor The problem constructor </span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;<span class="comment">We allocate the timestepper and build the \c VolumeConstraintElement that </span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;<span class="comment">imposes the volume constraint. The element stores the volume that is to be</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;<span class="comment">conserved as well as the bubble pressure, which is determined from the</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;<span class="comment">volume constraint. The initial guess for the bubble pressure, \f$</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;<span class="comment">p_{bubble}=Ca/a \f$, is appropriate for a static bubble in stationary</span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;<span class="comment">fluid.</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;<span class="comment">\skipline start_constructor</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;<span class="comment">\until // and the index</span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;<span class="comment"> </span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;<span class="comment">\skipline // Build element and create</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;<span class="comment">\until set_value(index</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;<span class="comment">Next the outer boundary, consisting of four separate polylines, is</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;<span class="comment">built. Each polyline is defined by a start and an end point and is</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;<span class="comment">stored in a vector. This vector is then used to create the closed</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;<span class="comment">polygon required by \c Triangle.</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<span class="comment">\skipline Build the boundary segments</span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<span class="comment">\until Outer_boundary_polyline_pt</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;<span class="comment">Next the polygon representing the bubble in the initial setup is</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="comment">generated. </span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="comment">(&lt;A HREF=&quot;../../../meshes/mesh_from_inline_triangle/html/index.html#polygonal&quot;&gt;</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;<span class="comment">Recall&lt;/A&gt; that closed polygons must be subdivided into at least two </span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="comment">distinct polylines.)</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="comment">\skipline Now define initial shape</span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;<span class="comment">\until bubble_center)</span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;<span class="comment">Once the boundary representation in form of polygons is completed the</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;<span class="comment">mesh is generated using \c Triangle. We specify the error estimator</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;<span class="comment">and set targets for the spatial adaptivity, and output the initial mesh.</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;<span class="comment">\skipline Now build the mesh,</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;<span class="comment">\until output(&quot;mesh.dat&quot;)</span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<span class="comment">We complete the problem setup, create the various surface meshes that</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="comment">impose the dynamic and kinematic boundary conditions and the volume</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="comment">constraint. We then combine the submeshes into a global mesh.</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="comment">\skipline Set boundary condition</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="comment">\until end_of_constructor</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;<span class="comment"> </span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;<span class="comment">&lt;HR&gt; &lt;HR&gt;</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;<span class="comment">\section problem_setup Problem setup </span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;<span class="comment">During the problem setup the position of all boundary nodes in the </span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;<span class="comment">pseudo-elastic fluid mesh, apart from those on the bubble boundary, are pinned.</span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;<span class="comment">\dontinclude adaptive_bubble_in_channel.cc</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;<span class="comment">\skipline start_of_complete_problem_setup</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;<span class="comment">\until // points on bubble </span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;<span class="comment">We pin both velocity components on the inflow, top and bottom</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;<span class="comment">boundaries and the vertical velocity component at the outflow.</span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;<span class="comment"> </span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;<span class="comment">\skipline Re-set the boundary conditions</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="comment">\until end loop over boundaries</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;<span class="comment">Next, the bulk elements are made fully functional. For every element</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;<span class="comment">the pointers to the time, Reynolds number, Womersley number and the</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;<span class="comment">constitutive law for the mesh deformation are set.</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;<span class="comment">\skipline Complete the build of all elements </span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;<span class="comment">\until } </span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;<span class="comment">Finally, we (re-)assign the velocity boundary values by imposing no</span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;<span class="comment">slip on the channel walls, parallel outflow, and a Poiseuille profile</span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;<span class="comment">at the inlet.</span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;<span class="comment">\skipline Re-apply boundary values on Dirichlet</span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;<span class="comment">\until end of complete_problem_setup</span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;<span class="comment">&lt;HR&gt; &lt;HR&gt;</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;<span class="comment">\section face_elements Generation of face elements </span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;<span class="comment">As usual we impose</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;<span class="comment">the kinematic and dynamic boundary condition at the free surface by</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;<span class="comment">attaching \c FaceElements to the relevant boundaries of the bulk</span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;<span class="comment">elements. We specify pointers to the Capillary number \f$ Ca \f$ and</span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;<span class="comment">the bubble pressure \f$ p_{bubble} \f$. The pointer to the Strouhal</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;<span class="comment">number \f$ St \f$ does not need to be set, since it already defaults</span></div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="comment">to a value of 1.0.</span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;<span class="comment"> </span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;<span class="comment">\dontinclude adaptive_bubble_in_channel.cc</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;<span class="comment">\skipline start_of_create_free_surface_elements </span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;<span class="comment">\until end of create_free_surface_elements</span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;<span class="comment"> </span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;<span class="comment">The volume constraint elements are created in a similar way. Recall</span></div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;<span class="comment">that the \c LineVolumeConstraintBoundingSolidElements compute the </span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;<span class="comment">line integrals</span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;<span class="comment">in equation (10) while the \c VolumeConstraintElement</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;<span class="comment">adds \f$ V_{bubble} \f$ to this equation.</span></div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;<span class="comment"> </span></div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;<span class="comment">\skipline start_of_create_volume_constraint_elements</span></div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;<span class="comment">\until end of create_volume_constraint_elements</span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;<span class="comment">&lt;HR&gt; &lt;HR&gt;</span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;<span class="comment">\section doc Post-processing </span></div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;<span class="comment">This member function documents the</span></div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;<span class="comment">computed solution after every Newton solve.</span></div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;<span class="comment">\skipline start_of_doc_solution</span></div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;<span class="comment">\until end_of_doc_solution</span></div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;<span class="comment">&lt;HR&gt; &lt;HR&gt;</span></div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;<span class="comment">\section comments Comments and Exercises</span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;<span class="comment"> </span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;<span class="comment">\subsection adapt Mesh adaptation for problems with &#39;closed&#39; free boundaries</span></div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;<span class="comment">We described </span></div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;<span class="comment">&lt;A HREF=&quot;../../../meshes/mesh_from_inline_triangle/html/index.html&quot;&gt;in </span></div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;<span class="comment">another tutorial&lt;/A&gt; how \c oomph-lib</span></div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;<span class="comment">employs a two-stage process for the (re-)generation of unstructured</span></div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;<span class="comment">meshes in domains whose curvilinear boundaries are represented by \c</span></div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;<span class="comment">GeomObjects: we initially sample the \c GeomObject at a user-specified</span></div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;<span class="comment">number of points (equally spaced along the relevant section of the </span></div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;<span class="comment">\c GeomObject) to create the vertices for an initial polygonal</span></div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;<span class="comment">representation of the curvilinear boundary. This polygonal boundary</span></div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;<span class="comment">representation is used to generate a new mesh with \c Triangle. The</span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;<span class="comment">nodes on the domain boundaries are then &quot;snapped&quot; onto the curvilinear</span></div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;<span class="comment">boundaries where required.</span></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;<span class="comment"> </span></div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;<span class="comment">In principle, the same methodology can be (and is) employed for the</span></div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;<span class="comment">mesh regeneration in free-surface problems. However, in a free-surface</span></div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;<span class="comment">problem the curvilinear boundary evolves freely as part of the</span></div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;<span class="comment">solution and is therefore not described by a user-specified </span></div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;<span class="comment">\c GeomObject. When re-generating the mesh we therefore create a</span></div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;<span class="comment">temporary \c GeomObject by attaching \c FaceElements to the relevant</span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;<span class="comment">mesh boundaries of the existing mesh. We</span></div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;<span class="comment">then use the vertices of the face elements to create a polyline</span></div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;<span class="comment">representation of the boundary. This is illustrated in the figure below</span></div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;<span class="comment">which shows part of the original mesh (the nodes and triangular elements </span></div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;<span class="comment">adjacent to the boundary) in black. The blue lines represent the </span></div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;<span class="comment">\c FaceElements that are erected on the current curvilinear domain boundary</span></div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;<span class="comment">(as defined by the boundaries of the &quot;bulk&quot; elements). The vertices </span></div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;<span class="comment">of these \c FaceElements (red hollow circles) provide the vertices </span></div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;<span class="comment">for the polyline representation of the boundary (red line).</span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;<span class="comment">\image html remesh_1.gif &quot;Sketch illustrating the generation of a polyline along the curvilinear domain boundary. &quot; </span></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;<span class="comment">\image latex remesh_1.eps &quot;Sketch illustrating the generation of a polyline along the curvilinear domain boundary. &quot; width=0.8\textwidth</span></div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;<span class="comment">Using this polyline representation of the boundary, a new mesh is built using </span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;<span class="comment">\c Triangle. Depending on the target areas specified by the spatial error</span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;<span class="comment">estimator, \c Triangle may erect multiple elements along each polyline</span></div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;<span class="comment">segment. For instance in the figure below three elements have been</span></div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;<span class="comment">created along the polyline segment created from \c FaceElement 3 in</span></div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;<span class="comment">the original mesh.</span></div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;<span class="comment">\image html remesh_2.gif &quot;Sketch showing the new mesh generated by Triangle, using (i) the polygonal representation of the boundary and (ii) the area targets provided by the spatial error estimator. &quot; </span></div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;<span class="comment">\image latex remesh_2.eps &quot;Sketch showing the new mesh generated by Triangle, using (i) the polygonal representation of the boundary and (ii) the area targets provided by the spatial error estimator. &quot; width=0.6\textwidth</span></div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;<span class="comment">Next, the boundary coordinates are set up and the nodes are snapped</span></div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;<span class="comment">onto the curvilinear boundary that is still defined by the </span></div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;<span class="comment">\c FaceElements that were attached to the original mesh, as shown below.</span></div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;<span class="comment">\image html remesh_3.gif &quot;Sketch showing the mesh following the snapping of nodes to the curvilinear boundary. &quot; </span></div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;<span class="comment">\image latex remesh_3.eps &quot;Sketch showing the mesh following the snapping of nodes to the curvilinear boundary. &quot; width=0.6\textwidth</span></div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;<span class="comment">&lt;BR&gt;</span></div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;<span class="comment">&lt;BR&gt;</span></div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;<span class="comment">&lt;BR&gt;</span></div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;<span class="comment">&lt;CENTER&gt;</span></div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;<span class="comment">&lt;TABLE BORDER=1, WIDTH=500px&gt;</span></div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;<span class="comment">&lt;TR&gt;</span></div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;<span class="comment">&lt;TD bgcolor=&quot;cornsilk&quot;&gt;</span></div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;<span class="comment">&lt;CENTER&gt;</span></div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;<span class="comment">\b IMPORTANT: </span></div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;<span class="comment">\n</span></div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;<span class="comment">Note that the initial shape of moving free boundaries </span></div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;<span class="comment">\b must \b not be described by \c TriangleMeshCurviLines. While the</span></div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;<span class="comment">use of  \c TriangleMeshCurviLines would ensure that the nodes are </span></div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;<span class="comment">initially located exactly on the curvilinear boundary described by </span></div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;<span class="comment">the associated \c GeomObject without having to &quot;snap&quot; them to their desired</span></div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;<span class="comment">position, a problem arises when the mesh is adapted. When</span></div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;<span class="comment">this happens, nodes on curvilinear boundaries that are described by</span></div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;<span class="comment">\c TriangleMeshCurviLines are placed</span></div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;<span class="comment">on the (presumably unchanged) geometry defined by the associated</span></div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;<span class="comment">\c GeomObject rather than being placed on the deformed boundary</span></div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;<span class="comment">as described above -- the free surface therefore keeps jumping</span></div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;<span class="comment">back to its initial position whenever the mesh is adapted </span></div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;<span class="comment">which is unlikely to be desired!</span></div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;<span class="comment">&lt;/CENTER&gt;</span></div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;<span class="comment">&lt;/TD&gt;</span></div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;<span class="comment">&lt;/TR&gt;</span></div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;<span class="comment">&lt;/TABLE&gt;</span></div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;<span class="comment">&lt;/CENTER&gt;</span></div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;<span class="comment">\subsection issues Modifications to the basic mesh re-generation procedure</span></div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;<span class="comment">The procedure described above is very robust and works satisfactorily </span></div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;<span class="comment">in the example problem discussed in this tutorial. Below we discuss a</span></div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;<span class="comment">a few optional modifications to the mesh regeneration procedure that</span></div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;<span class="comment">are helpful to deal with complications that can arise in certain </span></div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;<span class="comment">circumstances:</span></div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;<span class="comment">\subsubsection unrefinement Unrefinement of polylines </span></div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;<span class="comment">As discussed above, \c Triangle generates a new mesh, based on (i) the</span></div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;<span class="comment">polygonal representation of the boundary and (ii) the area targets</span></div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;<span class="comment">provided by the spatial error estimator for the bulk elements.</span></div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;<span class="comment">The polygonal boundary representation defines the minimum </span></div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;<span class="comment">number of bulk elements that are generated next to the boundary --</span></div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;<span class="comment">we showed above how multiple elements can be erected on a given</span></div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;<span class="comment">boundary segment. However, since \c Triangle  never merges any</span></div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;<span class="comment">boundary segments this procedure can result in unnecessarily fine meshes</span></div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;<span class="comment">near the boundary: once the bulk mesh has been refined to a certain</span></div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;<span class="comment">level, the polygonal boundary representation cannot be coarsened,</span></div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;<span class="comment">even if the spatial error estimator would allow much larger </span></div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;<span class="comment">elements to be created at a later stage of the simulation.</span></div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;<span class="comment">We therefore provide the option to coarsen the polygonal boundary</span></div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;<span class="comment">representation following its creation from the \c FaceElements</span></div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;<span class="comment">that are attached to the current mesh. This is done by</span></div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;<span class="comment">assessing if the (geometrical) boundary representation is unnecessarily</span></div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;<span class="comment">fine, judged by how close any three adjacent vertices</span></div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;<span class="comment">are to a straight line. This is illustrated in the sketch below:</span></div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;<span class="comment">To assess if the middle vertex can be deleted, we determine the height </span></div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;<span class="comment">of a circular segment connecting the three vertices. If the ratio of</span></div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;<span class="comment">this height, \f$ d \f$ , to the distance \f$ l \f$ between the two </span></div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;<span class="comment">outer vertices is less than a user-defined tolerance (i.e. if the</span></div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;<span class="comment">local  curvature is so small that the middle vertex is not required to </span></div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;<span class="comment">represent the boundary sufficiently accurately), the middle vertex</span></div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;<span class="comment">is deleted. </span></div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;<span class="comment">\image html unrefinement.gif &quot;Sketch illustrating the criterion for the unrefinement of polylines. &quot; </span></div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;<span class="comment">\image latex unrefinement.eps &quot;Sketch illustrating the criterion for the unrefinement of polylines. &quot; width=0.7\textwidth</span></div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;<span class="comment">The tolerance for the unrefinement of polygons is set by the function </span></div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;<span class="comment">\code</span></div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;<span class="comment">TriangleMesh::set_polyline_unrefinement_tolerance(...)</span></div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;<span class="comment">\endcode</span></div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;<span class="comment">By default we allow polyline unrefinement (with a default tolerance of 0.04).</span></div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;<span class="comment">Polyline unrefinement can be disabled by calling</span></div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;<span class="comment">\code</span></div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;<span class="comment">TriangleMesh::disable_polyline_unrefinement()</span></div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;<span class="comment">\endcode</span></div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;<span class="comment">where \c TriangleMesh is a base for the \c TriangleMeshClosedCurve</span></div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;<span class="comment">class.</span></div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;<span class="comment">\subsubsection refinement Refinement of polylines </span></div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;<span class="comment">It is also possible that the free surface deforms in such a way</span></div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;<span class="comment">that the polyline representation of the domain boundary</span></div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;<span class="comment">becomes too inaccurate, e.g. because the representation of the</span></div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;<span class="comment">solution only requires fairly large elements. Even though large</span></div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;<span class="comment">elements may be sufficient to represent the solution, the mesh-regeneration</span></div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;<span class="comment">tends to fail when &quot;snapping&quot; the nodes onto the highly-curved </span></div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;<span class="comment">curvilinear boundary (typically because elements near the boundary </span></div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;<span class="comment">become highly distorted or even inverted).</span></div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;<span class="comment">We therefore provide the option to refine the polygonal representation</span></div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;<span class="comment">of the boundary employing a criterion similar to the one used for</span></div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;<span class="comment">unrefinement discussed above. To assess the need for a boundary</span></div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;<span class="comment">refinement we consider each boundary segment and compute the</span></div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;<span class="comment">distance  from segment&#39;s mid-point to its counterpart on the</span></div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;<span class="comment">curvilinear boundary. If the ratio of the distance between these </span></div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;<span class="comment">points, \f$ d \f$,  to the length of the segment connecting</span></div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;<span class="comment">the vertices, \f$ l \f$, is larger than a user-specifiable tolerance,</span></div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;<span class="comment">the  point on the curvilinear boundary becomes an additional </span></div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;<span class="comment">vertex of the polyline and the original segment is split into</span></div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;<span class="comment">two as illustrated in the figure below:</span></div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;<span class="comment">\image html refinement.gif &quot;Sketch illustrating the criterion for the refinement of polylines. &quot; </span></div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;<span class="comment">\image latex refinement.eps &quot;Sketch illustrating the criterion for the refinement of polylines. &quot; width=0.7\textwidth</span></div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;<span class="comment">The tolerance for the refinement of polygons is set by the function </span></div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;<span class="comment">\code</span></div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;<span class="comment">TriangleMesh::set_polyline_refinement_tolerance(...)</span></div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;<span class="comment">\endcode</span></div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;<span class="comment">By default we allow polyline refinement (with a default tolerance of 0.08).</span></div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;<span class="comment">Polyline refinement can be disabled by calling</span></div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;<span class="comment">\code</span></div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;<span class="comment">TriangleMesh::disable_polyline_refinement()</span></div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;<span class="comment">\endcode</span></div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;<span class="comment">\subsubsection redistribution Redistribution of segments between polylines </span></div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;<span class="comment">The kinematic boundary condition (5) determines only the normal</span></div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;<span class="comment">displacement of the boundary, hence the tangential displacement of </span></div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;<span class="comment">nodes on the boundary is not controlled directly. It is therefore</span></div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;<span class="comment">possible that nodes move along the perimeter of the curvilinear </span></div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;<span class="comment">boundary and, as a result, one polyline may become much</span></div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;<span class="comment">shorter than the others, as illustrated in the transition from a) to b) </span></div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;<span class="comment">in the figure below. This is clearly undesirable and can be</span></div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;<span class="comment">avoided by redistributing the vertices/segment between the</span></div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;<span class="comment">polygon&#39;s constituent polylines such that each polyline spans</span></div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;<span class="comment">an approximately equal fraction of the polygon&#39;s overall perimeter.</span></div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;<span class="comment">This process is illustrated in b) and c) in the figure below.</span></div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;<span class="comment">Note that the redistribution of segments does not change the </span></div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;<span class="comment">shape of the polygonal boundary but merely the way in which it</span></div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;<span class="comment">is represented in terms of polylines.</span></div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;<span class="comment">\image html redistribution.gif &quot;Sketch illustrating the optional redistribution of polyline segments. &quot; </span></div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;<span class="comment">\image latex redistribution.eps &quot;Sketch illustrating the optional redistribution of polyline segments. &quot; width=0.7\textwidth</span></div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;<span class="comment">We provide the option to perform this step immediately after the generation </span></div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;<span class="comment">of the updated polyline representation for the curvilinear boundary</span></div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;<span class="comment">(and before the boundary refinement/unrefinement discussed above).</span></div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;<span class="comment">Given that each polyline represents a distinct mesh boundary, the</span></div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;<span class="comment">redistribution of segments between different polylines moves nodes</span></div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;<span class="comment">from one boundary to another and, in general, this is clearly</span></div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;<span class="comment">undesirable. Therefore, the redistribution of segments is</span></div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;<span class="comment">is deactivated by default and must be activated by calling the function </span></div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;<span class="comment">\code</span></div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;<span class="comment">TriangleMeshPolygon::enable_redistribution_of_segments_between_polylines()</span></div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;<span class="comment">\endcode</span></div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;<span class="comment">Note that the redistribution of segments is not possible/sensible for</span></div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;<span class="comment">\c TriangleMeshClosedCurve formed by \c TriangleMeshCurviLines since </span></div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;<span class="comment">such boundaries are associated with a specific, continuous </span></div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;<span class="comment">\c GeomObject with specific start/end coordinates. </span></div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;<span class="comment">\subsection exercises Exercises</span></div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;<span class="comment">-# As discussed above, we start the simulation by performing an</span></div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;<span class="comment">   initial steady Newton solve during which we deform the </span></div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;<span class="comment">   polygonal boundary that represents the air-liquid interface</span></div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;<span class="comment">   into its static equilibrium shape -- a circle enclosing the</span></div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;<span class="comment">   required volume. This may seem like a rather costly way of</span></div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;<span class="comment">   creating a circular interface. Why not simply move the</span></div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;<span class="comment">   nodes on that boundary manually to their &quot;correct&quot; positions</span></div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;<span class="comment">   by adjusting their radial positions after returning from the</span></div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;<span class="comment">   mesh constructor? To explore this question, snap the required nodes</span></div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;<span class="comment">   manually onto the circular boundary and call the steady Newton</span></div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;<span class="comment">   solver.  Why is the initial residual not equal to zero, even though</span></div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;<span class="comment">   we have manually assigned the correct solution as an initial guess?  </span></div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;<span class="comment">-# Comment out \c create_volume_constraint_elements()</span></div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;<span class="comment">   and \c delete_volume_constraint_elements() throughout the code and</span></div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;<span class="comment">   explain what happens. </span></div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;<span class="comment">-# Experiment with the refinement/unrefinement of polylines and explore</span></div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;<span class="comment">   the option to re-distribute segments between the polylines</span></div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;<span class="comment">   that define the boundaries of the bubble. Specifically, change</span></div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;<span class="comment">   the initial polygonal representation the bubble surface such that</span></div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;<span class="comment">   the first \c TriangleMeshPolyLine only represents 1/4 of the</span></div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;<span class="comment">   perimeter while the second one represents the remaining 3/4. </span></div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;<span class="comment">   Confirm that, following the mesh adaptation, the bubble boundaries</span></div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;<span class="comment">   are adjusted such that each boundary occupies approximately 1/2 of</span></div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;<span class="comment">   the bubble surface when the redistribution of polylines is enabled.</span></div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;<span class="comment">.</span></div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;<span class="comment">&lt;HR&gt; &lt;HR&gt;</span></div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;<span class="comment">\section sources Source files for this tutorial </span></div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;<span class="comment">- The source files for</span></div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;<span class="comment">  this tutorial are located in the directory:</span></div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;<span class="comment">  &lt;CENTER&gt; </span></div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;<span class="comment">  &lt;A HREF=&quot;../../../../demo_drivers/navier_stokes/unstructured_adaptive_fs/&quot;&gt;</span></div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;<span class="comment">  demo_drivers/navier_stokes/unstructured_adaptive_fs/ &lt;/A&gt; </span></div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;<span class="comment">  &lt;/CENTER&gt;</span></div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;<span class="comment">- The driver code is:</span></div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;<span class="comment">  &lt;CENTER&gt; </span></div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;<span class="comment">  &lt;A HREF=&quot;../../../../demo_drivers/navier_stokes/unstructured_adaptive_fs/adaptive_bubble_in_channel.cc&quot;&gt;</span></div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;<span class="comment">   demo_drivers/navier_stokes/unstructured_adaptive_fs/adaptive_bubble_in_channel.cc&lt;/A&gt; </span></div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;<span class="comment">  &lt;/CENTER&gt; .</span></div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;<span class="comment">&lt;hr&gt;</span></div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;<span class="comment">&lt;hr&gt;</span></div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;<span class="comment">\section pdf PDF file</span></div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;<span class="comment">A &lt;a href=&quot;../latex/refman.pdf&quot;&gt;pdf version&lt;/a&gt; of this document is available.</span></div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;<span class="comment">**/</span></div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160; </div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="aadaptive__bubble__in__channel_8txt_html_a1e447c53a88c41189e5a11a6d585ba54"><div class="ttname"><a href="adaptive__bubble__in__channel_8txt.html#a1e447c53a88c41189e5a11a6d585ba54">usual</a></div><div class="ttdeci">x_2 in[0, L] right subject to the Dirichlet boundary conditions f[u_1=0, \ \ \ \ \ \ \ \ \ \ @E[2DNavierStokes_BC1]@ \f] on the top and bottom boundaries and f[u_2=0, \ \ \ \ \ \ \ \ \ \ @E[2DNavierStokes_BC2]@ \f] on all boundaries The inflow on the left boundary is described by a Poiseuille flow profile f[u_1(x_2)=4 x_2(1-x_2). \ \ \ \ \ \ \ \ \ \ @E[Inflow_BC]@ \f] The free surface is defined by the position vector f which is subject to the kinematic condition f[\Big(u_i-St \frac{\partial R_i}{\partial t} \Big) n_i=0, \ \ \ \\ \ \ \ \ \ @E[kinematic_BC]@ \f] and the dynamic condition f[\tau_{ij} n_j=- \Big(\frac{1}{Ca} \kappa+p_{bubble} \Big) n_i, \ \ \\ \ \ \ \ \ \ @E[dynamic_BC]@ \f] where the stress tensor is defined as f[\tau_{ij}=-p \delta_{ij}+\Big(\frac{\partial u_i}{\partialx_j}+\frac{\partial u_j}{\partial x_i} \Big). \ \ \ \ \ \ \ \ \ \ @E[stress_tensor]@ \f] The initial position of the for a bubble initially located in the centre of the is given by f[\mathbf{R}(\zeta)=\Big(\frac{L}{2}+a \frac{1-\zeta^2}{1+\zeta^2},\frac{1}{2}+a \frac{2\zeta}{1+\zeta^2} \Big), \ \ \ \ \ \ \ \ \ \ @E usual[initial_interface]@ \f] where f a f is the initial non dimensional bubble radius and f f remains constant which is achieved by the bubble f which states that for any vector f the volume constraint can be written as f[V_{bubble}-\frac{1}{D} \oint \mathbf{R}.\mathbf{n} dS=0. \ \ \ \ \ \ \ \ \ \ @E[residuals]@ \f] This is the equation that determines the unknown bubble pressure f discretising the fluid domain with triangular Taylor Hood and updating the mesh with&lt; a href=&quot;../../single_layer_free_surface/html/index.html#kinematic_condition_implementation&quot;&gt; a pseudo elastic node update procedure&lt;/a &gt; As</div><div class="ttdef"><b>Definition:</b> <a href="adaptive__bubble__in__channel_8txt_source.html#l00137">adaptive_bubble_in_channel.txt:137</a></div></div>
<div class="ttc" id="aadaptive__bubble__in__channel_8txt_html_a68cbd6e5594834d316f25e485b93d760"><div class="ttname"><a href="adaptive__bubble__in__channel_8txt.html#a68cbd6e5594834d316f25e485b93d760">velocity</a></div><div class="ttdeci">namespace where we define the dimensionless parameters f Re f f Ca f and the non dimensional channel length f L f As discussed in&lt; a href=&quot;../../driven_cavity/html/index.html#params&quot;&gt; another tutorial&lt;/A &gt; the Strouhal number defaults to one so that we do not have to set it in this case We also store the initial bubble radius and the bubble volume as well as a scaling factor for the inflow velocity(this allows us to &quot;switch off&quot; the inflow when computing the initial steady solution). Finally we define the Poisson ratio for the generalised Hookean const itutive law that is used by pseudo-elastic mesh update. \dontinclude adaptive_bubble_in_channel.cc \skipline start_of_namespace \until end_of_namespace&lt; HR &gt;&lt; HR &gt; \section main The driver code We start by processing the command line arguments and create the generalised Hookean const itutive equations for the pseudo-elastic node-update. We then open various output files and build the problem. \skipline start_of_main \until BubbleInChannelProblem We start by performing a steady solve(with the inflow switched off) to compute the initial configuration</div></div>
<div class="ttc" id="aadaptive__bubble__in__channel_8txt_html_a8a1672f3dfb1f46620c12fd1c4710558"><div class="ttname"><a href="adaptive__bubble__in__channel_8txt.html#a8a1672f3dfb1f46620c12fd1c4710558">pressure</a></div><div class="ttdeci">x_2 in[0, L] right subject to the Dirichlet boundary conditions f[u_1=0, \ \ \ \ \ \ \ \ \ \ @E[2DNavierStokes_BC1]@ \f] on the top and bottom boundaries and f[u_2=0, \ \ \ \ \ \ \ \ \ \ @E[2DNavierStokes_BC2]@ \f] on all boundaries The inflow on the left boundary is described by a Poiseuille flow profile f[u_1(x_2)=4 x_2(1-x_2). \ \ \ \ \ \ \ \ \ \ @E[Inflow_BC]@ \f] The free surface is defined by the position vector f which is subject to the kinematic condition f[\Big(u_i-St \frac{\partial R_i}{\partial t} \Big) n_i=0, \ \ \ \\ \ \ \ \ \ @E[kinematic_BC]@ \f] and the dynamic condition f[\tau_{ij} n_j=- \Big(\frac{1}{Ca} \kappa+p_{bubble} \Big) n_i, \ \ \\ \ \ \ \ \ \ @E[dynamic_BC]@ \f] where the stress tensor is defined as f[\tau_{ij}=-p \delta_{ij}+\Big(\frac{\partial u_i}{\partialx_j}+\frac{\partial u_j}{\partial x_i} \Big). \ \ \ \ \ \ \ \ \ \ @E[stress_tensor]@ \f] The initial position of the for a bubble initially located in the centre of the is given by f[\mathbf{R}(\zeta)=\Big(\frac{L}{2}+a \frac{1-\zeta^2}{1+\zeta^2},\frac{1}{2}+a \frac{2\zeta}{1+\zeta^2} \Big), \ \ \ \ \ \ \ \ \ \ @E pressure[initial_interface]@ \f] where f a f is the initial non dimensional bubble radius and f f remains constant which is achieved by the bubble</div><div class="ttdef"><b>Definition:</b> <a href="adaptive__bubble__in__channel_8txt_source.html#l00104">adaptive_bubble_in_channel.txt:104</a></div></div>
<div class="ttc" id="aadaptive__bubble__in__channel_8txt_html_add84791f5830e8f582bf5a369721a6bd"><div class="ttname"><a href="adaptive__bubble__in__channel_8txt.html#add84791f5830e8f582bf5a369721a6bd">~BubbleInChannelProblem</a></div><div class="ttdeci">namespace where we define the dimensionless parameters f Re f f Ca f and the non dimensional channel length f L f As discussed in&lt; a href=&quot;../../driven_cavity/html/index.html#params&quot;&gt; another tutorial&lt;/A &gt; the Strouhal number defaults to one so that we do not have to set it in this case We also store the initial bubble radius and the bubble volume as well as a scaling factor for the inflow a circular bubble in stationary fluid skipline Before starting until problem the timestepper is initialised and an impulsive start performed The inflow is switched on and the first few unsteady Newton solves are performed without adaptation skipline Initialise timestepper until To limit the distortion of the elements we allow then mesh we template the Problem class by the element type dontinclude adaptive_bubble_in_channel cc skipline start_of_problem_class until ~BubbleInChannelProblem() The \c FaceElements are deleted and re-attached before and after each adaptation. Also</div></div>
<div class="ttc" id="aadaptive__bubble__in__channel_8txt_html_aaa377e8f49e4ffddfbebd349d6fed8ac"><div class="ttname"><a href="adaptive__bubble__in__channel_8txt.html#aaa377e8f49e4ffddfbebd349d6fed8ac">mathbf</a></div><div class="ttdeci">x_2 in[0, L] right subject to the Dirichlet boundary conditions f[u_1=0, \ \ \ \ \ \ \ \ \ \ @E[2DNavierStokes_BC1]@ \f] on the top and bottom boundaries and f[u_2=0, \ \ \ \ \ \ \ \ \ \ @E[2DNavierStokes_BC2]@ \f] on all boundaries The inflow on the left boundary is described by a Poiseuille flow profile f[u_1(x_2)=4 x_2(1-x_2). \ \ \ \ \ \ \ \ \ \ @E[Inflow_BC]@ \f] The free surface is defined by the position vector f mathbf</div><div class="ttdef"><b>Definition:</b> <a href="adaptive__bubble__in__channel_8txt_source.html#l00063">adaptive_bubble_in_channel.txt:63</a></div></div>
<div class="ttc" id="aadaptive__bubble__in__channel_8txt_html_aee432507f3bfe4dcb07d8419258226cc"><div class="ttname"><a href="adaptive__bubble__in__channel_8txt.html#aee432507f3bfe4dcb07d8419258226cc">zeta</a></div><div class="ttdeci">x_2 in[0, L] right subject to the Dirichlet boundary conditions f[u_1=0, \ \ \ \ \ \ \ \ \ \ @E[2DNavierStokes_BC1]@ \f] on the top and bottom boundaries and f[u_2=0, \ \ \ \ \ \ \ \ \ \ @E[2DNavierStokes_BC2]@ \f] on all boundaries The inflow on the left boundary is described by a Poiseuille flow profile f[u_1(x_2)=4 x_2(1-x_2). \ \ \ \ \ \ \ \ \ \ @E[Inflow_BC]@ \f] The free surface is defined by the position vector f which is subject to the kinematic condition f[\Big(u_i-St \frac{\partial R_i}{\partial t} \Big) n_i=0, \ \ \ \\ \ \ \ \ \ @E[kinematic_BC]@ \f] and the dynamic condition f[\tau_{ij} n_j=- \Big(\frac{1}{Ca} \kappa+p_{bubble} \Big) n_i, \ \ \\ \ \ \ \ \ \ @E[dynamic_BC]@ \f] where the stress tensor is defined as f[\tau_{ij}=-p \delta_{ij}+\Big(\frac{\partial u_i}{\partialx_j}+\frac{\partial u_j}{\partial x_i} \Big). \ \ \ \ \ \ \ \ \ \ @E[stress_tensor]@ \f] The initial position of the for a bubble initially located in the centre of the is given by f[\mathbf{R}(\zeta)=\Big(\frac{L}{2}+a \frac{1-\zeta^2}{1+\zeta^2},\frac{1}{2}+a \frac{2\zeta}{1+\zeta^2} \Big), \ \ \ \ \ \ \ \ \ \ @E zeta[initial_interface]@ \f] where f a f is the initial non dimensional bubble radius and f</div><div class="ttdef"><b>Definition:</b> <a href="adaptive__bubble__in__channel_8txt_source.html#l00096">adaptive_bubble_in_channel.txt:96</a></div></div>
<div class="ttc" id="aadaptive__bubble__in__channel_8cc_html_a3c04138a5bfe5d72780bb7e82a18e627"><div class="ttname"><a href="adaptive__bubble__in__channel_8cc.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a></div><div class="ttdeci">int main(int argc, char **argv)</div><div class="ttdoc">Driver code for moving bubble problem.</div><div class="ttdef"><b>Definition:</b> <a href="adaptive__bubble__in__channel_8cc_source.html#l01272">adaptive_bubble_in_channel.cc:1272</a></div></div>
<div class="ttc" id="aadaptive__bubble__in__channel_8txt_html_a209c6981527baee25f2ef2216c2932cb"><div class="ttname"><a href="adaptive__bubble__in__channel_8txt.html#a209c6981527baee25f2ef2216c2932cb">meshes</a></div><div class="ttdeci">mainpage Propagation of a bubble in a channel mesh generation and adaptation for free surface problems In this tutorial we demonstrate the adaptive solution of free surface problems on unstructured meshes</div><div class="ttdef"><b>Definition:</b> <a href="adaptive__bubble__in__channel_8txt_source.html#l00004">adaptive_bubble_in_channel.txt:4</a></div></div>
<div class="ttc" id="aadaptive__bubble__in__channel_8txt_html_a2559758af500f2d6cd15c5261cfba903"><div class="ttname"><a href="adaptive__bubble__in__channel_8txt.html#a2559758af500f2d6cd15c5261cfba903">V_</a></div><div class="ttdeci">x_2 in[0, L] right subject to the Dirichlet boundary conditions f[u_1=0, \ \ \ \ \ \ \ \ \ \ @E[2DNavierStokes_BC1]@ \f] on the top and bottom boundaries and f[u_2=0, \ \ \ \ \ \ \ \ \ \ @E[2DNavierStokes_BC2]@ \f] on all boundaries The inflow on the left boundary is described by a Poiseuille flow profile f[u_1(x_2)=4 x_2(1-x_2). \ \ \ \ \ \ \ \ \ \ @E[Inflow_BC]@ \f] The free surface is defined by the position vector f which is subject to the kinematic condition f[\Big(u_i-St \frac{\partial R_i}{\partial t} \Big) n_i=0, \ \ \ \\ \ \ \ \ \ @E[kinematic_BC]@ \f] and the dynamic condition f[\tau_{ij} n_j=- \Big(\frac{1}{Ca} \kappa+p_{bubble} \Big) n_i, \ \ \\ \ \ \ \ \ \ @E[dynamic_BC]@ \f] where the stress tensor is defined as f[\tau_{ij}=-p \delta_{ij}+\Big(\frac{\partial u_i}{\partialx_j}+\frac{\partial u_j}{\partial x_i} \Big). \ \ \ \ \ \ \ \ \ \ @E[stress_tensor]@ \f] The initial position of the for a bubble initially located in the centre of the is given by f[\mathbf{R}(\zeta)=\Big(\frac{L}{2}+a \frac{1-\zeta^2}{1+\zeta^2},\frac{1}{2}+a \frac{2\zeta}{1+\zeta^2} \Big), \ \ \ \ \ \ \ \ \ \ @E V_[initial_interface]@ \f] where f a f is the initial non dimensional bubble radius and f f</div><div class="ttdef"><b>Definition:</b> <a href="adaptive__bubble__in__channel_8txt_source.html#l00103">adaptive_bubble_in_channel.txt:103</a></div></div>
<div class="ttc" id="aadaptive__bubble__in__channel_8txt_html_a4ef673e51c66b4ffd39d328e95c6de7e"><div class="ttname"><a href="adaptive__bubble__in__channel_8txt.html#a4ef673e51c66b4ffd39d328e95c6de7e">interface</a></div><div class="ttdeci">x_2 in[0, L] right subject to the Dirichlet boundary conditions f[u_1=0, \ \ \ \ \ \ \ \ \ \ @E[2DNavierStokes_BC1]@ \f] on the top and bottom boundaries and f[u_2=0, \ \ \ \ \ \ \ \ \ \ @E[2DNavierStokes_BC2]@ \f] on all boundaries The inflow on the left boundary is described by a Poiseuille flow profile f[u_1(x_2)=4 x_2(1-x_2). \ \ \ \ \ \ \ \ \ \ @E[Inflow_BC]@ \f] The free surface is defined by the position vector f which is subject to the kinematic condition f[\Big(u_i-St \frac{\partial R_i}{\partial t} \Big) n_i=0, \ \ \ \\ \ \ \ \ \ @E[kinematic_BC]@ \f] and the dynamic condition f[\tau_{ij} n_j=- \Big(\frac{1}{Ca} \kappa+p_{bubble} \Big) n_i, \ \ \\ \ \ \ \ \ \ @E[dynamic_BC]@ \f] where the stress tensor is defined as f[\tau_{ij}=-p \delta_{ij}+\Big(\frac{\partial u_i}{\partialx_j}+\frac{\partial u_j}{\partial x_i} \Big). \ \ \ \ \ \ \ \ \ \ @E[stress_tensor]@ \f] The initial position of the interface</div><div class="ttdef"><b>Definition:</b> <a href="adaptive__bubble__in__channel_8txt_source.html#l00086">adaptive_bubble_in_channel.txt:86</a></div></div>
<div class="ttc" id="aclassBubbleInChannelProblem_html"><div class="ttname"><a href="classBubbleInChannelProblem.html">BubbleInChannelProblem</a></div><div class="ttdoc">Problem class to simulate inviscid bubble propagating along 2D channel.</div><div class="ttdef"><b>Definition:</b> <a href="adaptive__bubble__in__channel_8cc_source.html#l00424">adaptive_bubble_in_channel.cc:424</a></div></div>
<div class="ttc" id="aadaptive__bubble__in__channel_8txt_html_a290a29799a100de6c17ebe8f21b2bbf1"><div class="ttname"><a href="adaptive__bubble__in__channel_8txt.html#a290a29799a100de6c17ebe8f21b2bbf1">f</a></div><div class="ttdeci">x_2 in[0, L] right f</div><div class="ttdef"><b>Definition:</b> <a href="adaptive__bubble__in__channel_8txt_source.html#l00042">adaptive_bubble_in_channel.txt:42</a></div></div>
<div class="ttc" id="aadaptive__bubble__in__channel_8txt_html_ab29efe3f8fd2abe8331f326f6e1f7654"><div class="ttname"><a href="adaptive__bubble__in__channel_8txt.html#ab29efe3f8fd2abe8331f326f6e1f7654">Re</a></div><div class="ttdeci">x_2 in[0, L] right subject to the Dirichlet boundary conditions f[u_1=0, \ \ \ \ \ \ \ \ \ \ @E[2DNavierStokes_BC1]@ \f] on the top and bottom boundaries and f[u_2=0, \ \ \ \ \ \ \ \ \ \ @E[2DNavierStokes_BC2]@ \f] on all boundaries The inflow on the left boundary is described by a Poiseuille flow profile f[u_1(x_2)=4 x_2(1-x_2). \ \ \ \ \ \ \ \ \ \ @E[Inflow_BC]@ \f] The free surface is defined by the position vector f which is subject to the kinematic condition f[\Big(u_i-St \frac{\partial R_i}{\partial t} \Big) n_i=0, \ \ \ \\ \ \ \ \ \ @E[kinematic_BC]@ \f] and the dynamic condition f[\tau_{ij} n_j=- \Big(\frac{1}{Ca} \kappa+p_{bubble} \Big) n_i, \ \ \\ \ \ \ \ \ \ @E[dynamic_BC]@ \f] where the stress tensor is defined as f[\tau_{ij}=-p \delta_{ij}+\Big(\frac{\partial u_i}{\partialx_j}+\frac{\partial u_j}{\partial x_i} \Big). \ \ \ \ \ \ \ \ \ \ @E[stress_tensor]@ \f] The initial position of the for a bubble initially located in the centre of the is given by f[\mathbf{R}(\zeta)=\Big(\frac{L}{2}+a \frac{1-\zeta^2}{1+\zeta^2},\frac{1}{2}+a \frac{2\zeta}{1+\zeta^2} \Big), \ \ \ \ \ \ \ \ \ \ @E Re[initial_interface]@ \f] where f a f is the initial non dimensional bubble radius and f f remains constant which is achieved by the bubble f which states that for any vector f the volume constraint can be written as f[V_{bubble}-\frac{1}{D} \oint \mathbf{R}.\mathbf{n} dS=0. \ \ \ \ \ \ \ \ \ \ @E[residuals]@ \f] This is the equation that determines the unknown bubble pressure f discretising the fluid domain with triangular Taylor Hood and updating the mesh with&lt; a href=&quot;../../single_layer_free_surface/html/index.html#kinematic_condition_implementation&quot;&gt; a pseudo elastic node update procedure&lt;/a &gt; As we impose the kinematic and dynamic boundary conditions with c FaceElements The volume constraint is imposed in a similar and create an additional c VolumeConstraintElement which adds f for the parameters f</div><div class="ttdef"><b>Definition:</b> <a href="adaptive__bubble__in__channel_8txt_source.html#l00160">adaptive_bubble_in_channel.txt:160</a></div></div>
<div class="ttc" id="anamespaceoomph_html"><div class="ttname"><a href="namespaceoomph.html">oomph</a></div><div class="ttdef"><b>Definition:</b> <a href="adaptive__bubble__in__channel_8cc_source.html#l00044">adaptive_bubble_in_channel.cc:44</a></div></div>
<div class="ttc" id="aadaptive__bubble__in__channel_8txt_html_a23abf9ae95bbe02b7408feb50588d2e5"><div class="ttname"><a href="adaptive__bubble__in__channel_8txt.html#a23abf9ae95bbe02b7408feb50588d2e5">adaptation</a></div><div class="ttdeci">namespace where we define the dimensionless parameters f Re f f Ca f and the non dimensional channel length f L f As discussed in&lt; a href=&quot;../../driven_cavity/html/index.html#params&quot;&gt; another tutorial&lt;/A &gt; the Strouhal number defaults to one so that we do not have to set it in this case We also store the initial bubble radius and the bubble volume as well as a scaling factor for the inflow a circular bubble in stationary fluid skipline Before starting until problem the timestepper is initialised and an impulsive start performed The inflow is switched on and the first few unsteady Newton solves are performed without adaptation skipline Initialise timestepper until To limit the distortion of the elements we allow then mesh we template the Problem class by the element type dontinclude adaptive_bubble_in_channel cc skipline start_of_problem_class until as discussed in&lt; A HREF=&quot;../../../meshes/mesh_from_inline_triangle/html/index.html#overview&quot;&gt; another we re apply the boundary conditions and complete the build of all elements after each adaptation</div><div class="ttdef"><b>Definition:</b> <a href="adaptive__bubble__in__channel_8txt_source.html#l00236">adaptive_bubble_in_channel.txt:236</a></div></div>
<div class="ttc" id="aadaptive__bubble__in__channel_8txt_html_a115cc6a398ca50c29d304c26927c5e8b"><div class="ttname"><a href="adaptive__bubble__in__channel_8txt.html#a115cc6a398ca50c29d304c26927c5e8b">L</a></div><div class="ttdeci">H \f$, velocities on the maximum(prescribed) inflow velocity, \f$ \mathcal{U} \f$, and time on the intrinsic timescale, \f$ \mathcal{T}=\mathcal{L}/\mathcal{U} \f$, which corresponds to a Strouhal number \f$ St=1.0 \f$ . @I w 0.9\textwidth problem &quot;The problem setup. &quot; The problem is then governed by the following equations. Solve \f[Re\Big(St\frac{\partial u_i}{\partial t}+u_j\frac{\partial u_i}{\partial x_j} \Big)=- \frac{\partial p}{\partial x_i}+\frac{\partial }{\partial x_j} \left(\frac{\partial u_i}{\partial x_j}+\frac{\partial u_j}{\partial x_i} \right), \ \ \ \ \ \ \ \ \ \ @E[2DNavierStokes]@ \f] and \f[\frac{\partial u_i}{\partial x_i}=0, \f] in the rectangular domain \f$ D=\left\{x_1 \in[0, 1] L</div><div class="ttdef"><b>Definition:</b> <a href="adaptive__bubble__in__channel_8txt_source.html#l00042">adaptive_bubble_in_channel.txt:42</a></div></div>
<div class="ttc" id="aadaptive__bubble__in__channel_8txt_html_a7b90115865727814d807ba13d9a700e1"><div class="ttname"><a href="adaptive__bubble__in__channel_8txt.html#a7b90115865727814d807ba13d9a700e1">elements</a></div><div class="ttdeci">x_2 in[0, L] right subject to the Dirichlet boundary conditions f[u_1=0, \ \ \ \ \ \ \ \ \ \ @E[2DNavierStokes_BC1]@ \f] on the top and bottom boundaries and f[u_2=0, \ \ \ \ \ \ \ \ \ \ @E[2DNavierStokes_BC2]@ \f] on all boundaries The inflow on the left boundary is described by a Poiseuille flow profile f[u_1(x_2)=4 x_2(1-x_2). \ \ \ \ \ \ \ \ \ \ @E[Inflow_BC]@ \f] The free surface is defined by the position vector f which is subject to the kinematic condition f[\Big(u_i-St \frac{\partial R_i}{\partial t} \Big) n_i=0, \ \ \ \\ \ \ \ \ \ @E[kinematic_BC]@ \f] and the dynamic condition f[\tau_{ij} n_j=- \Big(\frac{1}{Ca} \kappa+p_{bubble} \Big) n_i, \ \ \\ \ \ \ \ \ \ @E[dynamic_BC]@ \f] where the stress tensor is defined as f[\tau_{ij}=-p \delta_{ij}+\Big(\frac{\partial u_i}{\partialx_j}+\frac{\partial u_j}{\partial x_i} \Big). \ \ \ \ \ \ \ \ \ \ @E[stress_tensor]@ \f] The initial position of the for a bubble initially located in the centre of the is given by f[\mathbf{R}(\zeta)=\Big(\frac{L}{2}+a \frac{1-\zeta^2}{1+\zeta^2},\frac{1}{2}+a \frac{2\zeta}{1+\zeta^2} \Big), \ \ \ \ \ \ \ \ \ \ @E elements[initial_interface]@ \f] where f a f is the initial non dimensional bubble radius and f f remains constant which is achieved by the bubble f which states that for any vector f the volume constraint can be written as f[V_{bubble}-\frac{1}{D} \oint \mathbf{R}.\mathbf{n} dS=0. \ \ \ \ \ \ \ \ \ \ @E[residuals]@ \f] This is the equation that determines the unknown bubble pressure f discretising the fluid domain with triangular Taylor Hood</div><div class="ttdef"><b>Definition:</b> <a href="adaptive__bubble__in__channel_8txt_source.html#l00134">adaptive_bubble_in_channel.txt:134</a></div></div>
<div class="ttc" id="anamespaceProblem__Parameter_html_af6194d2571881779c678fbabc1503d47"><div class="ttname"><a href="namespaceProblem__Parameter.html#af6194d2571881779c678fbabc1503d47">Problem_Parameter::Ca</a></div><div class="ttdeci">double Ca</div><div class="ttdoc">Capillary number.</div><div class="ttdef"><b>Definition:</b> <a href="adaptive__bubble__in__channel_8cc_source.html#l00378">adaptive_bubble_in_channel.cc:378</a></div></div>
<div class="ttc" id="aadaptive__bubble__in__channel_8txt_html_aa9ed8066f1025dcb5d1e4b27d667b810"><div class="ttname"><a href="adaptive__bubble__in__channel_8txt.html#aa9ed8066f1025dcb5d1e4b27d667b810">p_</a></div><div class="ttdeci">x_2 in[0, L] right subject to the Dirichlet boundary conditions f[u_1=0, \ \ \ \ \ \ \ \ \ \ @E[2DNavierStokes_BC1]@ \f] on the top and bottom boundaries and f[u_2=0, \ \ \ \ \ \ \ \ \ \ @E[2DNavierStokes_BC2]@ \f] on all boundaries The inflow on the left boundary is described by a Poiseuille flow profile f[u_1(x_2)=4 x_2(1-x_2). \ \ \ \ \ \ \ \ \ \ @E[Inflow_BC]@ \f] The free surface is defined by the position vector f which is subject to the kinematic condition f[\Big(u_i-St \frac{\partial R_i}{\partial t} \Big) n_i=0, \ \ \ \\ \ \ \ \ \ @E[kinematic_BC]@ \f] and the dynamic condition f[\tau_{ij} n_j=- \Big(\frac{1}{Ca} \kappa+p_{bubble} \Big) n_i, \ \ \\ \ \ \ \ \ \ @E[dynamic_BC]@ \f] where the stress tensor is defined as f[\tau_{ij}=-p \delta_{ij}+\Big(\frac{\partial u_i}{\partialx_j}+\frac{\partial u_j}{\partial x_i} \Big). \ \ \ \ \ \ \ \ \ \ @E[stress_tensor]@ \f] The initial position of the for a bubble initially located in the centre of the is given by f[\mathbf{R}(\zeta)=\Big(\frac{L}{2}+a \frac{1-\zeta^2}{1+\zeta^2},\frac{1}{2}+a \frac{2\zeta}{1+\zeta^2} \Big), \ \ \ \ \ \ \ \ \ \ @E p_[initial_interface]@ \f] where f a f is the initial non dimensional bubble radius and f f remains constant which is achieved by the bubble f</div><div class="ttdef"><b>Definition:</b> <a href="adaptive__bubble__in__channel_8txt_source.html#l00104">adaptive_bubble_in_channel.txt:104</a></div></div>
<div class="ttc" id="aadaptive__bubble__in__channel_8txt_html_a239512d00ee573bca93dd7ce996785f4"><div class="ttname"><a href="adaptive__bubble__in__channel_8txt.html#a239512d00ee573bca93dd7ce996785f4">way</a></div><div class="ttdeci">x_2 in[0, L] right subject to the Dirichlet boundary conditions f[u_1=0, \ \ \ \ \ \ \ \ \ \ @E[2DNavierStokes_BC1]@ \f] on the top and bottom boundaries and f[u_2=0, \ \ \ \ \ \ \ \ \ \ @E[2DNavierStokes_BC2]@ \f] on all boundaries The inflow on the left boundary is described by a Poiseuille flow profile f[u_1(x_2)=4 x_2(1-x_2). \ \ \ \ \ \ \ \ \ \ @E[Inflow_BC]@ \f] The free surface is defined by the position vector f which is subject to the kinematic condition f[\Big(u_i-St \frac{\partial R_i}{\partial t} \Big) n_i=0, \ \ \ \\ \ \ \ \ \ @E[kinematic_BC]@ \f] and the dynamic condition f[\tau_{ij} n_j=- \Big(\frac{1}{Ca} \kappa+p_{bubble} \Big) n_i, \ \ \\ \ \ \ \ \ \ @E[dynamic_BC]@ \f] where the stress tensor is defined as f[\tau_{ij}=-p \delta_{ij}+\Big(\frac{\partial u_i}{\partialx_j}+\frac{\partial u_j}{\partial x_i} \Big). \ \ \ \ \ \ \ \ \ \ @E[stress_tensor]@ \f] The initial position of the for a bubble initially located in the centre of the is given by f[\mathbf{R}(\zeta)=\Big(\frac{L}{2}+a \frac{1-\zeta^2}{1+\zeta^2},\frac{1}{2}+a \frac{2\zeta}{1+\zeta^2} \Big), \ \ \ \ \ \ \ \ \ \ @E way[initial_interface]@ \f] where f a f is the initial non dimensional bubble radius and f f remains constant which is achieved by the bubble f which states that for any vector f the volume constraint can be written as f[V_{bubble}-\frac{1}{D} \oint \mathbf{R}.\mathbf{n} dS=0. \ \ \ \ \ \ \ \ \ \ @E[residuals]@ \f] This is the equation that determines the unknown bubble pressure f discretising the fluid domain with triangular Taylor Hood and updating the mesh with&lt; a href=&quot;../../single_layer_free_surface/html/index.html#kinematic_condition_implementation&quot;&gt; a pseudo elastic node update procedure&lt;/a &gt; As we impose the kinematic and dynamic boundary conditions with c FaceElements The volume constraint is imposed in a similar</div><div class="ttdef"><b>Definition:</b> <a href="adaptive__bubble__in__channel_8txt_source.html#l00141">adaptive_bubble_in_channel.txt:141</a></div></div>
<div class="ttc" id="aclassBubbleInChannelProblem_html_a6a68ee06024107d7b3f92059365a06d1"><div class="ttname"><a href="classBubbleInChannelProblem.html#a6a68ee06024107d7b3f92059365a06d1">BubbleInChannelProblem::doc_solution</a></div><div class="ttdeci">void doc_solution(const std::string &amp;comment=&quot;&quot;)</div><div class="ttdoc">Doc the solution.</div><div class="ttdef"><b>Definition:</b> <a href="adaptive__bubble__in__channel_8cc_source.html#l01156">adaptive_bubble_in_channel.cc:1156</a></div></div>
<div class="ttc" id="aadaptive__bubble__in__channel_8txt_html_abd6d3b286fdf9b6b2df4b2fb496330e6"><div class="ttname"><a href="adaptive__bubble__in__channel_8txt.html#abd6d3b286fdf9b6b2df4b2fb496330e6">adjusting</a></div><div class="ttdeci">x_2 in[0, L] right subject to the Dirichlet boundary conditions f[u_1=0, \ \ \ \ \ \ \ \ \ \ @E[2DNavierStokes_BC1]@ \f] on the top and bottom boundaries and f[u_2=0, \ \ \ \ \ \ \ \ \ \ @E[2DNavierStokes_BC2]@ \f] on all boundaries The inflow on the left boundary is described by a Poiseuille flow profile f[u_1(x_2)=4 x_2(1-x_2). \ \ \ \ \ \ \ \ \ \ @E[Inflow_BC]@ \f] The free surface is defined by the position vector f which is subject to the kinematic condition f[\Big(u_i-St \frac{\partial R_i}{\partial t} \Big) n_i=0, \ \ \ \\ \ \ \ \ \ @E[kinematic_BC]@ \f] and the dynamic condition f[\tau_{ij} n_j=- \Big(\frac{1}{Ca} \kappa+p_{bubble} \Big) n_i, \ \ \\ \ \ \ \ \ \ @E[dynamic_BC]@ \f] where the stress tensor is defined as f[\tau_{ij}=-p \delta_{ij}+\Big(\frac{\partial u_i}{\partialx_j}+\frac{\partial u_j}{\partial x_i} \Big). \ \ \ \ \ \ \ \ \ \ @E[stress_tensor]@ \f] The initial position of the for a bubble initially located in the centre of the is given by f[\mathbf{R}(\zeta)=\Big(\frac{L}{2}+a \frac{1-\zeta^2}{1+\zeta^2},\frac{1}{2}+a \frac{2\zeta}{1+\zeta^2} \Big), \ \ \ \ \ \ \ \ \ \ @E adjusting[initial_interface]@ \f] where f a f is the initial non dimensional bubble radius and f f remains constant which is achieved by</div><div class="ttdef"><b>Definition:</b> <a href="adaptive__bubble__in__channel_8txt_source.html#l00103">adaptive_bubble_in_channel.txt:103</a></div></div>
<div class="ttc" id="aadaptive__bubble__in__channel_8txt_html_a7a44e50284d20970127f420cd412368d"><div class="ttname"><a href="adaptive__bubble__in__channel_8txt.html#a7a44e50284d20970127f420cd412368d">channel</a></div><div class="ttdeci">x_2 in[0, L] right subject to the Dirichlet boundary conditions f[u_1=0, \ \ \ \ \ \ \ \ \ \ @E[2DNavierStokes_BC1]@ \f] on the top and bottom boundaries and f[u_2=0, \ \ \ \ \ \ \ \ \ \ @E[2DNavierStokes_BC2]@ \f] on all boundaries The inflow on the left boundary is described by a Poiseuille flow profile f[u_1(x_2)=4 x_2(1-x_2). \ \ \ \ \ \ \ \ \ \ @E[Inflow_BC]@ \f] The free surface is defined by the position vector f which is subject to the kinematic condition f[\Big(u_i-St \frac{\partial R_i}{\partial t} \Big) n_i=0, \ \ \ \\ \ \ \ \ \ @E[kinematic_BC]@ \f] and the dynamic condition f[\tau_{ij} n_j=- \Big(\frac{1}{Ca} \kappa+p_{bubble} \Big) n_i, \ \ \\ \ \ \ \ \ \ @E[dynamic_BC]@ \f] where the stress tensor is defined as f[\tau_{ij}=-p \delta_{ij}+\Big(\frac{\partial u_i}{\partialx_j}+\frac{\partial u_j}{\partial x_i} \Big). \ \ \ \ \ \ \ \ \ \ @E[stress_tensor]@ \f] The initial position of the for a bubble initially located in the centre of the channel</div><div class="ttdef"><b>Definition:</b> <a href="adaptive__bubble__in__channel_8txt_source.html#l00087">adaptive_bubble_in_channel.txt:87</a></div></div>

    <!-- jQuery for Bootstrap and Doxygen -->
    <script src="../../../js/jquery-1.12.0.min.js"></script>
    <!-- Minified boostrap plugins-->
    <script src="../../../js/bootstrap.js"></script>
    <!-- Doxygen dependency to add powertips to source code-->
    <script src="../../../js/jquery.powertip.min.js"></script>
    <!-- The  following script is generated by doxygen and hides/shows levels in 
         the data structure lists and adds powertips to source code-->
    <script src="../../../js/dynsections.js" ></script>
    <!-- add to Doxygen's class names so bootstrap css and js recognises them-->
    <script type="text/javascript">
    $(".contents").addClass("container");
    $(".header").addClass("container");
    $(".navpath").addClass("container");
    $("#navrow3").addClass("container");
    $("#navrow4").addClass("container");
    $(".mlabel").addClass("label");
    $(".mlabel").addClass("label-default");
    $(".memitem").addClass("panel");
    $(".memitem").addClass("panel-info");
    $(".memproto").addClass("panel-heading");
    $(".memdoc").addClass("panel-body");
    </script>
    <footer>
      <div class="container">
        <div class="text-muted" style="float:right;">Generated by <a href="http://www.doxygen.org/index.html">
          <img style="height:18px;" class="footer-img" src="doxygen.png" alt="doxygen"></a> on Wed Jul 21 2021 16:16:27
        </div>
      </div>
    </footer>
</body>
</html>

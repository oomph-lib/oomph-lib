<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
<title>oomph-lib: leftovers.txt_doxygenified.h Source File</title>
<link rel="apple-touch-icon" sizes="57x57" href="../../figures/apple-touch-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="../../figures/apple-touch-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="../../figures/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="../../figures/apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="../../figures/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="../../figures/apple-touch-icon-120x120.png">
<link rel="icon" type="image/png" href="../../figures/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="../../figures/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="../../figures/favicon-16x16.png" sizes="16x16">
<link rel="manifest" href="../../figures/manifest.json">
<link rel="mask-icon" href="../../figures/safari-pinned-tab.svg" color="#008000">
<link rel="shortcut icon" href="../../figures/favicon.ico">
<meta name="msapplication-TileColor" content="#00a300">
<meta name="msapplication-config" content="../../figures/browserconfig.xml">
<meta name="theme-color" content="#008000">
<link href="http://fonts.googleapis.com/css?family=Open+Sans:400,300,600" rel="stylesheet" type="text/css">
<!-- Doxygen css-->
<!-- <link rel="stylesheet" type="text/css" href="doxygen.css"> -->
<!-- Bootstrap -->
<link href="../../css/bootstrap.css" rel="stylesheet">
<!-- oomph-lib specific overrides -->
<link rel="stylesheet" type="text/css" href="../../css/oomph_header.css">
</head>
<body>
<nav class="navbar navbar-default">
<div class="container">
<div class="container-fluid">
  <!-- Brand and toggle get grouped for better mobile display -->
  <div class="navbar-header">
    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
      <span class="sr-only">Toggle navigation</span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="../../html/index.html"><img alt="oomph-lib" src="../../figures/oomph_logo.png"></a>
  </div>
  <!-- Collect the nav links, forms, and other content for toggling -->
  <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
    <ul class="nav navbar-nav">          
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Documentation <span class="caret"></span></a>
        <ul class="dropdown-menu">
          <li class="dropdown-header">Big picture</li>
          <li><a href="../../../doc/intro/html/index.html">The finite element method</a></li>
          <li><a href="../../../doc/the_data_structure/html/index.html">The data structure</a></li>
          <li><a href="../../../doc/quick_guide/html/index.html">Not-so-quick guide</a></li>
          <li><a href="../../../doc/optimisation/html/index.html">Optimisation</a></li>
          <li><a href="../../../doc/order_of_action_functions/html/index.html">Order of action functions</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Example codes and tutorials</li>
          <li><a href="../../../doc/example_code_list/html/index.html">List of example codes and tutorials</a></li>
          <li><a href="../../../doc/example_code_list/html/index.html#meshes">Meshing</a></li>
          <li><a href="../../../doc/example_code_list/html/index.html#solvers">Solvers</a></li>
          <li><a href="../../../doc/example_code_list/html/index.html#parallel">MPI parallel processing</a></li>
          <li><a href="../../../doc/example_code_list/html/index.html#visualisation">Post-processing/visualisation</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Other</li>
          <li><a href="../../../doc/change_log/html/index.html">Change log</a></li>
          <li><a href="../../../doc/creating_doc/html/index.html">Creating documentation</a></li>
          <li><a href="../../../doc/coding_conventions/html/index.html">Coding conventions</a></li>
          <li><a href="../../../doc/index/html/index.html">Index</a></li>
          <li><a href="../../../doc/FAQ/html/index.html">FAQ</a></li>
        </ul>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Installation<span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../doc/the_distribution/html/index.html">Installation guide</a></li>
            <li><a href="../../../doc/copyright/html/index.html">Copyright</a></li>
          </ul>
        </li>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">About <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../doc/people/html/index.html">People</a></li>            
            <li><a href="../../../doc/contact/html/index.html">Contact/Get involved</a></li>
            <li><a href="../../../doc/publications/html/index.html">Publications</a></li>
            <li><a href="../../../doc/acknowledgements/html/index.html">Acknowledgements</a></li>
            <li><a href="../../../doc/picture_show/index.html">Picture show</a></li>
          </ul>
        </li>
      </li>
    </ul>
    <ul class="nav navbar-nav navbar-right navbar-search">
      <form class="navbar-form" role="search" action="../../../doc/search_results/html/index.html">
        <div class="input-group">
          <input type="text" class="form-control" placeholder="Search" name="q">
          <span class="input-group-btn">
            <button class="btn btn-default" type="submit">Go</button>
          </span>
        </div><!-- /input-group -->
       <!--<div class="form-group">
          <input type="text" class="form-control" placeholder="Search">
        </div>
        <button type="submit" class="btn btn-default">Submit</button>-->
      </form>
    </ul>
  </div><!-- /.navbar-collapse -->
</div><!-- /.container-fluid -->
</div>
</nav>
<!-- Generated by Doxygen 1.9.1 -->
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">leftovers.txt_doxygenified.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="leftovers_8txt__doxygenified_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">\mainpage Leftovers</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">\htmlonly</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">The following table provides a detailed side-by-side comparison </span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">between the procedural and object-oriented </span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">implementation of finite-element solution of problem P2.</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">\anchor table</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment"> &lt;CENTER&gt; &lt;B&gt; Algorithm 1 &lt;/B&gt; &lt;/CENTER&gt;</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment"> &lt;B&gt; Phase 1: Set up the problem &lt;/B&gt; </span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment"> &lt;B&gt; Phase 1a: Problem specification&lt;/B&gt; </span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">&lt;TABLE BORDER=&quot;1&quot;&gt;</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">&lt;TR&gt;</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">&lt;TD WIDTH=&quot;50%&quot; VALIGN=&quot;TOP&quot;&gt;</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">- Choose the number of elements, \f$ N_E \f$, and the number of </span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">  nodes per element, \f$ n. \f$ This defines the total number of </span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">  nodes, \f$N\f$, and the local shape functions  </span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">  \f$ \psi_j(s) \ \ (j=1,...,n)\f$  for all elements. </span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">&lt;/TD&gt;</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">&lt;TD WIDTH=&quot;50%&quot; VALIGN=&quot;TOP&quot;&gt;</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment">- Choose the  Element type, e.g. \c QPoissonElement&lt;3,2&gt;, a</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment">  nine-node quadrilateral Poisson element. </span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">- Choose a suitable  Mesh, e.g. \c FishMesh.</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment">&lt;/TD&gt;</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment">&lt;/TR&gt;</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment">&lt;/TABLE&gt;</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment">&lt;B&gt; Phase 1b: Mesh generation&lt;/B&gt; </span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment">&lt;TABLE BORDER=&quot;1&quot;&gt;</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment">&lt;TR&gt;</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment">&lt;TD WIDTH=&quot;50%&quot; VALIGN=&quot;TOP&quot;&gt;</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment">- Discretise the domain by specifying the positions </span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment">  \f$ X_{ij} \ (j=1,..,N; i=1,2)\f$,</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment">  of the \f$ N \f$ nodes. </span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment">- Generate the lookup scheme \f$ {\cal J}(j,e)\f$ that </span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment">   establishes the relation</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment">   between global and local node numbers. </span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment">- Identify which nodes are located on which domain boundaries. </span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment">&lt;/TD&gt;</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment">&lt;TD WIDTH=&quot;50%&quot;  VALIGN=&quot;TOP&quot;&gt;</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment">- The  Mesh is typically built in the  Problem constructor; </span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment">  the  Problem stores a pointer to the  Mesh:</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment">\code </span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment">Problem::mesh_pt()=new FishMesh&lt;QPoissonElement&lt;3,2&gt; &gt;; </span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment">\endcode</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment">[Note how the  Element type is passed to the  Mesh constructor as</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment">a template parameter. The \c FishMesh has a fixed number of</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="comment"> Elements; for many other  Meshes, the number of  Elements can</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment">be passed as an argument to the  Mesh constructor.]</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment">- Once the  Mesh is built, we can find out how many distinct boundaries</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment">  it has by calling</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment">\code </span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment">unsigned n_bound=Problem::mesh_pt()-&gt;nboundaries();</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment">\endcode</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment">- The \f$i\f$-th node on boundary \f$i_{bound}\f$ is </span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment">accessible via</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment">\code </span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment">unsigned i;</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment">unsigned i_bound;</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="comment">Node* node_pt=Problem::mesh_pt()-&gt;boundary_node_pt(i_bound,i);</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="comment">\endcode</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="comment">&lt;/TD&gt;</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="comment">&lt;/TR&gt;</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment">&lt;/TABLE&gt;</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="comment">&lt;B&gt; Phase 1c: &quot;Pin&quot; nodes with essential (Dirichlet) </span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="comment">     boundary conditions &lt;/B&gt;  </span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="comment">&lt;TABLE BORDER=&quot;1&quot;&gt;</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="comment">&lt;TR&gt;</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="comment">&lt;TD WIDTH=&quot;50%&quot; VALIGN=&quot;TOP&quot;&gt;</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment">  - Loop over all global nodes j that are located on Dirichlet boundaries:</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="comment">    - Assign a negative equation number to reflect the node&#39;s &quot;pinned&quot; </span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="comment">      status:</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="comment">      \f[ {\cal E}(j) = -1 \f]</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="comment">&lt;/TD&gt;</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="comment">&lt;TD WIDTH=&quot;50%&quot; VALIGN=&quot;TOP&quot;&gt;</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="comment">  - Pinning of  Nodes on (Dirichlet) boundaries is typically done</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="comment">    in the  Problem constructor, using the  Mesh&#39;s access </span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="comment">    functions to the boundary  Nodes.</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="comment">  - As an example, the following code fragment pins the  Nodes</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="comment">    on all boundaries</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="comment">    \code </span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="comment">    // How many boundaries are there in the mesh?</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="comment">    unsigned num_bound = Problem::mesh_pt()-&gt;nboundary();</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="comment">    // Loop over the boundaries</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="comment">    for(unsigned ibound=0;ibound&lt;num_bound;ibound++)</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="comment">     {</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="comment">      // How many nodes are there on this boundary?</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="comment">      unsigned num_nod= Problem::mesh_pt()-&gt;nboundary_node(ibound);</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="comment">      // Loop over nodes on the boundary</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="comment">      for (unsigned inod=0;inod&lt;num_nod;inod++)</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="comment">       {</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="comment">        // Pin the node</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="comment">        Problem::mesh_pt()-&gt;boundary_node_pt(ibound,inod)-&gt;pin(0); </span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="comment">       }</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="comment">     }</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="comment">    \endcode </span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="comment">    [See \ref systems_of_PDEs for an explanation of the argument</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="comment">     to the \c pin() function.]</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="comment">&lt;/TD&gt;</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="comment">&lt;/TR&gt;</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="comment">&lt;/TABLE&gt;</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="comment"> &lt;B&gt; Phase 1d: Apply boundary conditions and provide initial guesses </span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="comment">     for all unknowns&lt;/B&gt; </span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="comment"> &lt;TABLE BORDER=&quot;1&quot;&gt;</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="comment"> &lt;TR&gt;</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="comment"> &lt;TD WIDTH=&quot;50%&quot; VALIGN=&quot;TOP&quot;&gt;</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="comment">  - Loop over all global nodes \f$j=1,...,N\f$:</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="comment">    - Provide an initial guess for the unknown nodal value (e.g.</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="comment">      \f$ U_j=0 \f$) and set the nodal value to the (known)</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="comment">      boundary value for nodes on the boundary, \f$ U_j = g(X_{ij}). \f$</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="comment">&lt;/TD&gt;</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="comment">&lt;TD WIDTH=&quot;50%&quot; VALIGN=&quot;TOP&quot;&gt;</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="comment">- The  Node constructor initialises all nodal values to zero. </span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="comment">  These default values must be overwritten for nodes on the</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="comment">  boundary. The nodal values in the interior of the domain </span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="comment">  can be over-written, if a &quot;better&quot; initial guess for the solution </span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="comment">  is available. Typically both steps are performed in the Problem</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="comment">  constructor.</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="comment">&lt;/TD&gt;</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="comment">&lt;/TR&gt;</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="comment">&lt;/TABLE&gt;</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="comment"> &lt;B&gt; Phase 1e: Set up the global equation numbering scheme&lt;/B&gt; </span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="comment"> &lt;TABLE BORDER=&quot;1&quot;&gt;</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="comment"> &lt;TR&gt;</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="comment"> &lt;TD WIDTH=&quot;50%&quot; VALIGN=&quot;TOP&quot;&gt;</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="comment">- Initialise the total number of unknowns, \f$M=0.\f$</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="comment">- Loop over all global nodes \f$j=1,...,N\f$:</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="comment">  - If global node j is not pinned</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="comment">    (i.e. if \f$ {\cal E}(j) \ne -1 \f$) </span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="comment">     - Increment the number of unknowns</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="comment">        \f[ M=M+1 \f]</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="comment">     - Assign the global equation number</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="comment">        \f[ {\cal E}(j) = M \f]</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="comment">&lt;/TD&gt;</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="comment">&lt;TD WIDTH=&quot;50%&quot; VALIGN=&quot;TOP&quot;&gt;</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="comment">&lt;/TD&gt;</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="comment">- The equation numbering procedure is generic and fully </span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="comment">  implemented. The equation numbering </span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="comment">  is usually performed in the  Problem constructor by calling</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="comment">  \code</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="comment">  Problem::assign_eqn_numbers();</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="comment">  \endcode </span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="comment">&lt;/TR&gt;</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="comment">&lt;/TABLE&gt;</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="comment"> &lt;B&gt; Phase 1f: Set up the local equation numbering scheme&lt;/B&gt; </span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="comment"> &lt;TABLE BORDER=&quot;1&quot;&gt;</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="comment"> &lt;TR&gt;</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="comment"> &lt;TD WIDTH=&quot;50%&quot; VALIGN=&quot;TOP&quot;&gt;</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="comment">- Loop over the elements  \f$ e=1,...,N_e \f$</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="comment">  &lt;TABLE BORDER=&quot;0&quot;&gt;</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="comment">  &lt;TR&gt;</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="comment">  &lt;TD bgcolor=&quot;cornsilk&quot;&gt;</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="comment">  - Initialise the counter for the number of degrees of </span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;<span class="comment">    freedom in this element, \f$ j_{dof}=0 \f$.</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="comment">  - Loop over the element&#39;s local nodes \f$ j_{local}=1,...,n\f$</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="comment">    - Determine the global node number </span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="comment">      \f$ j_{global} = {\cal J}(j_{local},e) \f$</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="comment">    - Determine the global equation number \f${\cal E}(j_{global})\f$</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="comment">    - If  \f${\cal E}(j_{global}) \ne -1\f$:</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="comment">      - Increment the number of degrees of </span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="comment">        freedom in this element \f$ j_{dof}=j_{dof}+1\f$</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;<span class="comment">      - Add the entry to the lookup scheme that relates local </span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="comment">        and global equation numbers</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<span class="comment">        \f$ \widehat{\cal E}(j_{dof},e) = {\cal E}(j_{global})\f$</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<span class="comment">      - Store the local equation number associated with the</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<span class="comment">        current local node: \f$ {\cal L}(j_{local},e)=j_{dof}.\f$</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="comment">      .</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="comment">    - Else:</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="comment">      - Set the local equation number associated with the</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="comment">        current local node to -1 to indicate that it is pinned:</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="comment">        \f$ {\cal L}(j_{local},e)=-1\f$</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="comment">    .</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="comment">  - Assign the number of degrees of freedom in the element</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="comment">    \f$ {\cal N}_{dof}(e)=j_{dof} \f$</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="comment">  &lt;/TD&gt;</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="comment">  &lt;/TR&gt;</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="comment">  &lt;/TABLE&gt;</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="comment">&lt;/TD&gt;</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="comment">&lt;TD WIDTH=&quot;50%&quot; VALIGN=&quot;TOP&quot;&gt;</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="comment">- The local  equation numbering is performed automatically by</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="comment">  \c Problem::assign_eqn_numbers() which executes the</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="comment">   Elements&#39; member function </span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="comment">   \c GeneralisedElement::assign_local_eqn_numbers().</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="comment">  \n \n</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="comment">  This (virtual) function is defined in \c GeneralisedElement </span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="comment">  and must be implemented for every specific  Element. For instance,</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="comment">  &lt;TABLE BORDER=&quot;0&quot;&gt;</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="comment">  &lt;TR&gt;</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="comment">  &lt;TD bgcolor=&quot;cornsilk&quot;&gt;</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="comment">  \c</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="comment">  QPoissonElement&lt;3,2&gt;::assign_local_eqn_numbers()</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="comment">  &lt;/TD&gt;</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;<span class="comment">  &lt;/TR&gt;</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="comment">  &lt;/TABLE&gt;</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="comment">  implements the equation numbering procedure, highlighted in the</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="comment">  left column, for nine-node quadrilateral Poisson elements. </span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="comment">  [See \ref systems_of_PDEs for a more detailed discussion of this</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="comment">   aspect.]</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="comment">&lt;/TD&gt;</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="comment">&lt;/TR&gt;</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="comment">&lt;/TABLE&gt;</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;<span class="comment"> &lt;B&gt; End of setup:&lt;/B&gt; </span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="comment">&lt;TABLE BORDER=&quot;1&quot;&gt;</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;<span class="comment">&lt;TR&gt;</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;<span class="comment">&lt;TD WIDTH=&quot;50%&quot; VALIGN=&quot;TOP&quot;&gt;</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="comment">- The setup phase is now complete and we can determine the </span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="comment">  (current) FE representation of all quantities in element \f$ e\f$:\n\n</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="comment">  - The global coordinates \f$ x_i \f$ are given by</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="comment">    \f[</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;<span class="comment">    x_i = \sum_{j=1}^{n}  X_{i{\cal J}(j,e)} \ \psi_j(s)</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="comment">    \f]</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="comment">  - Their derivatives with respect to the local coordinates are</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;<span class="comment">    \f[</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="comment">     \widehat{\cal J}_{ik} =  \frac{\partial x_i}{\partial s_j} =</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="comment">     \sum_{k=1}^n X_{i{\cal J}(k,e)}</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="comment">     \ \frac{\partial \psi_k(s)}{\partial s_j}</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="comment">    \f]</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="comment">  - The Jacobian of the mapping between the local and global coordinates</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;<span class="comment">    is given by</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;<span class="comment">    \f[</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;<span class="comment">      \widehat{\cal J} =  \det \widehat{\cal J}_{ik}</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;<span class="comment">    \f]</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;<span class="comment">  - The function \f$ u\f$ is obtained by interpolation between the</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;<span class="comment">    the nodal values:</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;<span class="comment">    \f[</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;<span class="comment">    u = \sum_{j=1}^{n}  U_{{\cal J}(j,e)} \ \psi_j(s_1,s_2) </span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;<span class="comment">    \f]</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;<span class="comment">  - Its derivatives with respect to the global coordinates are</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;<span class="comment">    \f[ u = \frac{\partial u}{\partial x_i} =</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;<span class="comment">    {\widehat J}^{-1}_{ij}</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;<span class="comment">    \left(\sum_{k=1}^n U_{{\cal J}(k,e)}</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="comment">    \ \frac{\partial \psi_k(s_1,s_2)}{\partial s_j}</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="comment">    \right) </span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="comment">    \f]</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="comment">  - Finally, the derivatives of the local shape functions, </span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="comment">    \f$ \psi_i \f$, with respect to the global coordinates </span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="comment">    \f$ x_j \f$ are given by</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="comment">    \f[  \frac{\partial \psi_i}{\partial x_j} = {\widehat J}^{-1}_{ik} \ </span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="comment">         \frac{\partial \psi_i(s_1,s_2)}{\partial s_k}</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="comment">          \mbox{\ \ \ for $j=1,..,n$} </span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="comment">    \f]</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="comment">&lt;/TD&gt;</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;<span class="comment">&lt;TD WIDTH=&quot;50%&quot; VALIGN=&quot;TOP&quot;&gt;</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;<span class="comment">- The FE representation of the unknown function, the global coordinates, </span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;<span class="comment">  and their derivatives are available from  Element</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;<span class="comment">  member functions. Here are a few representative member functions for our </span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;<span class="comment">  nine-node quadrilateral Poisson element:\n\n</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;<span class="comment">  - The FE representation of the global (Eulerian) coordinate \f$x_i\f$ at </span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;<span class="comment">    the local coordinate</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;<span class="comment">    \f$ (s_1,s_2)\f$:</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;<span class="comment">    \code</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;<span class="comment">    Vector&lt;double&gt; s(2);</span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;<span class="comment">    double x=QPoissonElement&lt;3,2&gt;::interpolated_x(s,0);</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<span class="comment">    double y=QPoissonElement&lt;3,2&gt;::interpolated_x(s,1);</span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;<span class="comment">    \endcode</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;<span class="comment">    [\b Note: In the C++ implementation, all indices start at 0, so the</span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;<span class="comment">    global coordinates are \f$(x_0,x_1)\f$.]</span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;<span class="comment">  - The Jacobian of the mapping between the global (Eulerian) and</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;<span class="comment">    local coordinates, \f$x_i(s_j)\f$, at the local coordinate</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;<span class="comment">    \f$ (s_0,s_`)\f$:</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;<span class="comment">    \code</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;<span class="comment">    Vector&lt;double&gt; s(2);</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;<span class="comment">    double jacobian=QPoissonElement&lt;3,2&gt;::J_eulerian(s);</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;<span class="comment">    \endcode</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;<span class="comment">  - The FE representation of the solution at the local coordinate</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<span class="comment">    \f$ (s_1,s_2)\f$:</span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<span class="comment">    \code</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;<span class="comment">    Vector&lt;double&gt; s(2);</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;<span class="comment">    double u=QPoissonElement&lt;3,2&gt;::interpolated_u(s);</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="comment">    \endcode</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="comment">  - The shape functions and their first derivatives with respect to</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;<span class="comment">    the local coordinates at the local coordinate</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="comment">   \f$ (s_0,s_1)\f$:</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;<span class="comment">   \code</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="comment">    Shape psi(9);     // We have 9 shape functions </span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;<span class="comment">    DShape dpsi(9,2); // The 9 shape functions </span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;<span class="comment">                      // have 2 derivatives each</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;<span class="comment">                      // (w.r.t to s_0 and s_1)</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;<span class="comment">    Vector&lt;double&gt; s(2);</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;<span class="comment">    QPoissonElement&lt;3,2&gt;::dshape_local(s,psi,dpsi);</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;<span class="comment">    \endcode</span></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;<span class="comment">  - The shape functions and their first derivatives with respect to</span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;<span class="comment">    the global (Eulerian) coordinates at the local coordinate</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;<span class="comment">    \f$ (s_0,s_1)\f$:</span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;<span class="comment">    \code</span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<span class="comment">    Shape psi(9);       // We have 9 shape functions </span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="comment">    DShape dpsidx(9,2); // The 9 shape functions </span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="comment">                        // have 2 derivatives each </span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<span class="comment">                        // (w.r.t to x_0 and x_1)</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="comment">    Vector&lt;double&gt; s(2);</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="comment">    QPoissonElement&lt;3,2&gt;::dshape_eulerian(s,psi,dpsidx);</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;<span class="comment">   \endcode</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;<span class="comment"> &lt;/TD&gt;</span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;<span class="comment"> &lt;/TR&gt;</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;<span class="comment"> &lt;/TABLE&gt;</span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;<span class="comment"> &lt;B&gt; Phase 2: Solution  &lt;/B&gt; </span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;<span class="comment"> </span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;<span class="comment"> &lt;TABLE BORDER=&quot;1&quot; &gt;</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;<span class="comment"> &lt;TR&gt;</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;<span class="comment"> &lt;TD WIDTH=&quot;50%&quot; VALIGN=&quot;TOP&quot;&gt;</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;<span class="comment"> - The solution process has three phases:</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;<span class="comment">   - Phase 2a: Setup the linear system</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;<span class="comment">   - Phase 2b: Solve the linear system</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;<span class="comment">   - Phase 2c: Update the solution.</span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;<span class="comment">   These phases are detailed below.</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="comment"> &lt;/TD&gt;</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;<span class="comment"> &lt;TD WIDTH=&quot;50%&quot; VALIGN=&quot;TOP&quot;&gt;</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;<span class="comment"> - The three phases listed on the left, </span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;<span class="comment">   represent the central steps in the \ref Newton iteration.</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;<span class="comment">   \c Problem::newton_solve() provides a &quot;black box&quot; implementation </span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;<span class="comment">   of Newton&#39;s method and represents \c oomph-lib&#39;s default nonlinear solver. </span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;<span class="comment">   Once a Problem has been set up </span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;<span class="comment">   as discussed above, the solution only requires the specification</span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;<span class="comment">   of a linear solver for the Newton iteration.</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;<span class="comment">   It&#39;s as easy as this:</span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;<span class="comment">   \code </span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;<span class="comment">   // Build/set a linear solver</span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;<span class="comment">   Problem::linear_solver_pt() = new SomeSolver();</span></div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;<span class="comment">   // Solve the Problem</span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;<span class="comment">   Problem::newton_solve();</span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;<span class="comment">   // Done -- go away and document your solution...</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;<span class="comment">         :</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;<span class="comment">         :</span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;<span class="comment">   \endcode</span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;<span class="comment">   The Newton solver uses a default tolerance of \f$10^{-8} \f$.</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;<span class="comment">   This default value (stored as a protected data member of the</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;<span class="comment">   Problem class) can be over-written in any of the Problem&#39;s</span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;<span class="comment">   member functions:</span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;<span class="comment">   \code</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;<span class="comment">   Problem::Newton_solver_tolerance=1.0e-14;</span></div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="comment">   \endcode</span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;<span class="comment">   Details of the implementation are given below:</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;<span class="comment"> &lt;/TD&gt;</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;<span class="comment"> &lt;/TR&gt;</span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;<span class="comment"> &lt;/TABLE&gt;</span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;<span class="comment"> &lt;B&gt; Phase 2a: Setup the linear system &lt;/B&gt; </span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;<span class="comment"> &lt;TABLE BORDER=&quot;1&quot; &gt;</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;<span class="comment"> &lt;TR&gt;</span></div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;<span class="comment"> &lt;TD WIDTH=&quot;50%&quot; VALIGN=&quot;TOP&quot;&gt;</span></div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;<span class="comment">- Initialise the global residual vector, \f$ r_j=0 \f$ for \f$j=1,...,M \f$</span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;<span class="comment">  and the global Jacobian matrix \f$ J_{jk}=0 \f$ for \f$j,k=1,...,M \f$</span></div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;<span class="comment">- Loop over the elements  \f$ e=1,...,N_E\f$</span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;<span class="comment">  \n  \n   </span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;<span class="comment">  &lt;TABLE BORDER=&quot;0&quot;&gt;</span></div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;<span class="comment">  &lt;TR&gt;</span></div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;<span class="comment">  &lt;TD bgcolor=&quot;cornsilk&quot;&gt;</span></div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;<span class="comment">  &lt;CENTER&gt; &lt;B&gt; Compute the element&#39;s residual vector and </span></div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;<span class="comment">  Jacobian matrix &lt;/B&gt;  &lt;/CENTER&gt;</span></div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;<span class="comment">  \n</span></div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;<span class="comment">  - Determine the number of degrees of freedom in this element,</span></div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;<span class="comment">    \f$ n_{dof}={\cal N}_{dof}(e) \f$.</span></div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;<span class="comment">  - Initialise the element residual vector, </span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;<span class="comment">     \f$ r_{j}^{(e)}=0 \f$ for \f$j=1,...,n_{dof} \f$</span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;<span class="comment">     and the element Jacobian matrix \f$ J_{jk}^{(e)}=0 \f$ </span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;<span class="comment">     for \f$j,k=1,...,n_{dof} \f$</span></div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;<span class="comment">  - Loop over the Gauss points \f$ i_{int}=1,...,N_{int}\f$</span></div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;<span class="comment">    - Determine the local coordinate of the integration point</span></div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;<span class="comment">      \f$ s_j = S_{j\, i_{int}} \mbox{\ \ \ for $j=1,2$.} \f$</span></div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;<span class="comment">    - Compute</span></div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;<span class="comment">      - the global coordinates  \f$ x_i = x_i(s_j) \f$</span></div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;<span class="comment">      - the source function    \f$ f = f(x_i) =f(x_i(s_j)) \f$</span></div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;<span class="comment">      - the derivative \f$ \partial u/\partial x_i \f$ and </span></div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;<span class="comment">      - the shape functions  \f$ \psi_j \f$ and their derivatives</span></div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;<span class="comment">        \f$ \partial \psi_j/\partial x_k \f$</span></div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;<span class="comment">      - the Jacobian of the mapping between local and global</span></div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;<span class="comment">        coordinates, \f$ \widehat{\cal J} = </span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;<span class="comment">        \det \partial x_i/\partial s_j\f$</span></div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;<span class="comment">      .</span></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;<span class="comment">    - Loop over the local nodes \f$ j_{local}=1,...,n \f$</span></div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;<span class="comment">      - Determine the global node number </span></div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;<span class="comment">        \f$ j_{global}={\cal J}(j_{local},e)\f$</span></div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;<span class="comment">      - Determine the global equation number </span></div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;<span class="comment">        \f$ {\cal E}( j_{global}) \f$</span></div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;<span class="comment">      - If  \f$ {\cal E}( j_{global}) \ne -1 \f$</span></div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;<span class="comment">        - Determine the local equation number from the element&#39;s </span></div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;<span class="comment">          lookup scheme \f$ i_{dof}= {\cal L}(j_{local},e)\f$.</span></div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;<span class="comment">        -  Add the contribution to the element&#39;s residual vector</span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;<span class="comment">             \f[ r_{i_{dof}}^{(e)} = r_{i_{dof}}^{(e)} +</span></div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;<span class="comment">             \left( \sum_{l=1}^2 \frac{\partial </span></div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;<span class="comment">             u}{\partial x_l} \ </span></div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;<span class="comment">             \frac{\partial \psi_{j_{local}}}{\partial x_l} + </span></div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;<span class="comment">             f \  \psi_{j_{local}} \right) </span></div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;<span class="comment">             \widehat{\cal J} \ W_{i_{int}} \f]</span></div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;<span class="comment">          - Loop over the local nodes \f$ k_{local}=1,...,n \f$</span></div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;<span class="comment">            - Determine the global node number </span></div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;<span class="comment">              \f$ k_{global}={\cal J}(k_{local},e)\f$</span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;<span class="comment">            - Determine the global equation number </span></div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;<span class="comment">              \f$ {\cal E}( k_{global}) \f$</span></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;<span class="comment">            - If  \f$ {\cal E}( k_{global}) \ne -1 \f$</span></div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;<span class="comment">              - Determine the local equation number from the element&#39;s </span></div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;<span class="comment">                lookup scheme \f$ j_{dof}= {\cal L}(j_{local},e)\f$.</span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;<span class="comment">              - Add the contribution to the element&#39;s Jacobian matrix</span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;<span class="comment">                \f[ J_{i_{dof}j_{dof}}^{(e)} = J_{i_{dof}j_{dof}}^{(e)} + </span></div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;<span class="comment">                \left( \sum_{l=1}^2  </span></div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;<span class="comment">                \frac{\partial \psi_{k_{local}}}{\partial x_l} \ </span></div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;<span class="comment">                \frac{\partial \psi_{j_{local}}}{\partial x_l}</span></div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;<span class="comment">                \right)</span></div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;<span class="comment">                \widehat{\cal J} \ W_{i_{int}}  \f]</span></div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;<span class="comment">  &lt;/TD&gt;</span></div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;<span class="comment">  &lt;/TR&gt;</span></div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;<span class="comment">  &lt;/TABLE&gt;</span></div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;<span class="comment">  \n  \n  \n \n \n</span></div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;<span class="comment">  &lt;CENTER&gt; &lt;B&gt; Add the element&#39;s contribution to the global residual</span></div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;<span class="comment">  vector and Jacobian matrix &lt;/B&gt;  &lt;/CENTER&gt;</span></div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;<span class="comment">  \n</span></div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;<span class="comment">  - Loop over the local degrees of freedom \f$ i_{dof}=1,...,n_{dof} \f$</span></div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;<span class="comment">    - Add the element&#39;s contribution to the global residual vector</span></div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;<span class="comment">      \f[ r_{\widehat{\cal E}(i_{dof},e)} = </span></div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;<span class="comment">      r_{\widehat{\cal E}(i_{dof},e)} + r_{i_{dof}}^{(e)} </span></div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;<span class="comment">      \f]</span></div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;<span class="comment">      - Loop over the local degrees of freedom \f$ j_{dof}=1,...,n_{dof}\f$</span></div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;<span class="comment">        - Add the element&#39;s contribution to the global Jacobian matrix</span></div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;<span class="comment">          \f[ J_{\widehat{\cal E}(i_{dof},e)\widehat{\cal E}(j_{dof},e)}=  </span></div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;<span class="comment">          J_{\widehat{\cal E}(i_{dof},e)\widehat{\cal E}(j_{dof},e)}+ </span></div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;<span class="comment">          J_{i_{dof} j_{dof}}^{(e)} \f]</span></div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;<span class="comment">        .</span></div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;<span class="comment">      .</span></div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;<span class="comment">    .</span></div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;<span class="comment">  .</span></div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;<span class="comment">  &lt;/TD&gt;</span></div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;<span class="comment">  &lt;TD WIDTH=&quot;50%&quot; VALIGN=&quot;TOP&quot;&gt;</span></div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;<span class="comment">   - The assembly process is completely generic:</span></div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;<span class="comment">     - Find out how many degrees of freedom we have from</span></div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;<span class="comment">       \code</span></div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;<span class="comment">       unsigned ndof_global=Problem::ndofs();</span></div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;<span class="comment">       \endcode</span></div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;<span class="comment">       This allows us to create and initialise the global Jacobian matrix</span></div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;<span class="comment">       and the global residual vector.</span></div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;<span class="comment">       \code</span></div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;<span class="comment">       Vector&lt;double&gt; residual(ndof_global);</span></div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;<span class="comment">       DenseDoubleMatrix jacobian(ndof_global,ndof_global);</span></div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;<span class="comment">       \endcode</span></div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;<span class="comment">       [\b Note: This is just an illustration! Do \b not store</span></div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;<span class="comment">       the global Jacobian matrix as a \c DenseMatrix --</span></div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;<span class="comment">       the \c oomph-lib implementation of a dense matrix!]. </span></div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;<span class="comment">     - Find out how many elements there are (in the  Mesh)</span></div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;<span class="comment">       from</span></div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;<span class="comment">       \code</span></div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;<span class="comment">       Problem::mesh_pt()-&gt;nelement();</span></div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;<span class="comment">       \endcode</span></div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;<span class="comment">     - Now we can loop over all  Elements.  Elements are accessed</span></div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;<span class="comment">       via the  Mesh&#39;s access function \c Mesh::element_pt(), so</span></div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;<span class="comment">       we obtain a pointer to the \f$ e \f$-th element in the</span></div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;<span class="comment">        Problem&#39;s  Mesh, by calling</span></div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;<span class="comment">       \code</span></div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;<span class="comment">       FiniteElement* element_pt=Problem::mesh_pt()-&gt;element_pt(e);</span></div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;<span class="comment">       \endcode</span></div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;<span class="comment">     - How many degrees of freedom does this  Element have?</span></div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;<span class="comment">       \code</span></div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;<span class="comment">       unsigned ndof=element_pt-&gt;ndof();</span></div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;<span class="comment">       \endcode</span></div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;<span class="comment">     - We can now allocate the  Element&#39;s Jacobian matrix, </span></div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;<span class="comment">       \c el_jacobian, and its residual vector, \c el_residual.</span></div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;<span class="comment">       \code</span></div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;<span class="comment">       Vector&lt;double&gt; el_residual(ndof);</span></div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;<span class="comment">       DenseDoubleMatrix el_jacobian(ndof);</span></div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;<span class="comment">       \endcode</span></div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;<span class="comment">     - Get their entries from the  Element by calling</span></div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;<span class="comment">       \code</span></div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;<span class="comment">       element_pt-&gt;get_jacobian(el_jacobian,el_residual);</span></div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;<span class="comment">       \endcode</span></div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;<span class="comment">       Note that the implementation of this function</span></div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;<span class="comment">       depends on the (mathematical) problem to be solved but its interface</span></div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;<span class="comment">       is completely generic. The function is therefore defined as</span></div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;<span class="comment">       a virtual function in the abstract base class \c GeneralisedElement,</span></div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;<span class="comment">       and needs to be implemented in a derived class. </span></div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;<span class="comment">       For instance, </span></div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;<span class="comment">       &lt;TABLE BORDER=&quot;0&quot;&gt;</span></div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;<span class="comment">       &lt;TR&gt;</span></div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;<span class="comment">       &lt;TD bgcolor=&quot;cornsilk&quot;&gt;</span></div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;<span class="comment">       \n</span></div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;<span class="comment">       \c QPoissonElement&lt;NNODE_1D,DIM&gt;::get_jacobian(el_jacobian,el_residual);</span></div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;<span class="comment">       \n \n</span></div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;<span class="comment">       &lt;/TD&gt;</span></div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;<span class="comment">       &lt;/TR&gt;</span></div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;<span class="comment">       &lt;/TABLE&gt;</span></div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;<span class="comment">       implements the computation of the element residual and </span></div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;<span class="comment">       Jacobian matrix</span></div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;<span class="comment">       for the \c DIM -dimensional Poisson equation, discretised with </span></div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;<span class="comment">       isoparametric elements from the \c QElement family, so that</span></div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;<span class="comment">       - \c DIM=1 corresponds to 1D line elements</span></div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;<span class="comment">       - \c DIM=2 corresponds to 2D quadrilateral elements</span></div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;<span class="comment">       - \c DIM=3 corresponds to 3D brick  elements.</span></div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;<span class="comment">       .</span></div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;<span class="comment">       The second template parameter, \c NNODE_1D indicates the</span></div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;<span class="comment">       number of nodes along the element edges so that</span></div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;<span class="comment">       - \c NNODE_1D=2 corresponds to elements with linear </span></div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;<span class="comment">       (or {bi/tri}linear) shape functions</span></div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;<span class="comment">       - \c NNODE_1D=3 corresponds to elements with quadratic </span></div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;<span class="comment">       (or {bi/tri}quadratic) shape functions</span></div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;<span class="comment">       - etc.</span></div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;<span class="comment">       .</span></div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;<span class="comment">     \n \n </span></div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;<span class="comment">     - Copying of the  Element&#39;s Jacobian matrix and residual vector </span></div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;<span class="comment">       into their global counterparts is again completely generic</span></div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;<span class="comment">       and involves calls to the  Element&#39;s \c eqn_number() function</span></div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;<span class="comment">       which returns the global equation number corresponding</span></div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;<span class="comment">       to a local equation number. For instance, the assembly</span></div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;<span class="comment">       loop for the global residual vector \c residual can be</span></div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;<span class="comment">       implemented as follows</span></div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;<span class="comment">       \code</span></div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;<span class="comment">       // Loop over the number of dofs in the element</span></div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;<span class="comment">       for (unsigned i_local=0;i_local&lt;ndof;i_local++)</span></div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;<span class="comment">        {</span></div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;<span class="comment">         // Get the corresponding global equation number</span></div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;<span class="comment">         unsigned i_global=element_pt-&gt;eqn_number(i_local);</span></div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;<span class="comment">         // Add the entry to the global residual vector</span></div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;<span class="comment">         residual[i_global]+=el_residual[i_local];</span></div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;<span class="comment">        }</span></div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;<span class="comment">        \endcode</span></div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;<span class="comment">   &lt;/TD&gt;</span></div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;<span class="comment">   &lt;/TR&gt;</span></div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;<span class="comment">   &lt;/TABLE&gt;</span></div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;<span class="comment"> &lt;B&gt; Phase 2b: Solve the linear system &lt;/B&gt; </span></div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;<span class="comment"> &lt;TABLE BORDER=&quot;1&quot;&gt;</span></div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;<span class="comment"> &lt;TR&gt;</span></div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;<span class="comment"> &lt;TD WIDTH=&quot;50%&quot; VALIGN=&quot;TOP&quot;&gt;</span></div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;<span class="comment">- Solve the \f$ M \times M\f$ linear system</span></div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;<span class="comment">  \f[ \sum_{j=1}^{M}  J_{jk} \ y_k = - r_j</span></div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;<span class="comment">        \mbox{\ \  \ for $j=1,...,M.$} \f]</span></div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;<span class="comment">  for \f$ y_k \ \ (k=1,...,M).\f$ </span></div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;<span class="comment"> &lt;/TD&gt;</span></div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;<span class="comment"> &lt;TD WIDTH=&quot;50%&quot; VALIGN=&quot;TOP&quot;&gt;</span></div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;<span class="comment"> - The solution of the fully-assembled linear system</span></div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;<span class="comment">   can now be obtained, using the linear solver specified.</span></div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;<span class="comment">   \n \n</span></div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;<span class="comment">   [\b Note: Frontal solvers such as HSL_MA42 and HSL_MP42</span></div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;<span class="comment">   interlace the assembly and LU decomposition of the linear system;</span></div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;<span class="comment">   in such cases there is no clear distinction between phases</span></div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;<span class="comment">   2a and 2b.]</span></div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;<span class="comment"> &lt;/TD&gt;</span></div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;<span class="comment"> &lt;/TR&gt;</span></div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;<span class="comment"> &lt;/TABLE&gt;</span></div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;<span class="comment"> &lt;B&gt; Phase 2c: Update the initial guess &lt;/B&gt; </span></div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;<span class="comment"> &lt;TABLE BORDER=&quot;1&quot;&gt;</span></div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;<span class="comment"> &lt;TR&gt;</span></div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;<span class="comment"> &lt;TD WIDTH=&quot;50%&quot; VALIGN=&quot;TOP&quot;&gt;</span></div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;<span class="comment">-  Loop over all global nodes \f$ j\f$:</span></div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;<span class="comment">        - Determine the equation number: \f$ {\cal E}(j) \f$</span></div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;<span class="comment">        - If \f$ {\cal E}(j) \ne -1 \f$:</span></div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;<span class="comment">   \f[ U_{{\cal E}(j)} = U_{{\cal E}(j)}  +  y_{{\cal E}(j)} \f] </span></div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;<span class="comment"> &lt;/TD&gt;</span></div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;<span class="comment"> &lt;TD WIDTH=&quot;50%&quot; VALIGN=&quot;TOP&quot;&gt;</span></div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;<span class="comment"> - The Newton solver \c Problem::newton_solve(...) updates the nodal </span></div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;<span class="comment">   values directly via pointer-based access to the unknowns.</span></div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;<span class="comment"> &lt;/TD&gt;</span></div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;<span class="comment"> &lt;/TR&gt;</span></div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;<span class="comment"> &lt;/TABLE&gt;</span></div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;<span class="comment"> &lt;B&gt; Phase 3: Postprocessing (document the solution)&lt;/B&gt; </span></div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;<span class="comment"> &lt;TABLE BORDER=&quot;1&quot;&gt;</span></div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;<span class="comment"> &lt;TR&gt;</span></div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;<span class="comment"> &lt;TD WIDTH=&quot;50%&quot; VALIGN=&quot;TOP&quot;&gt;</span></div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;<span class="comment">- The finite-element solution in element \f$e\f$ is </span></div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;<span class="comment">  given by </span></div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;<span class="comment">  \f[ u = \sum_{j=1}^{n}  U_{{\cal J}(j,e)} \ \psi_j(s) \f]</span></div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;<span class="comment"> &lt;/TD&gt;</span></div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;<span class="comment"> &lt;TD WIDTH=&quot;50%&quot; VALIGN=&quot;TOP&quot;&gt;</span></div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;<span class="comment"> - All finite elements and meshes have an \c output() function,</span></div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;<span class="comment">   so the postprocessing merely requires a call to the  Mesh&#39;s</span></div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;<span class="comment">   \c output function:</span></div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;<span class="comment">   \code</span></div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;<span class="comment">   // Write the solution in all elements to file</span></div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;<span class="comment">   ostream output_file;</span></div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;<span class="comment">   Problem::mesh_pt()-&gt;output(output_file);</span></div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;<span class="comment">   \endcode</span></div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;<span class="comment"> &lt;/TD&gt;</span></div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;<span class="comment"> &lt;/TR&gt;</span></div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;<span class="comment"> &lt;/TABLE&gt;</span></div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;<span class="comment">\section extensions Extensions to more complicated problems</span></div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;<span class="comment">We will now briefly discuss further extensions of</span></div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;<span class="comment">the method. ***expand***</span></div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;<span class="comment">\subsection non_dirichlet_bc Non-Dirichlet boundary conditions</span></div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;<span class="comment">The examples considered so far have all been problems with</span></div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;<span class="comment">Dirichlet boundary conditions, i.e. problems in which the</span></div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;<span class="comment">value of the unknown function was prescribed on the entire</span></div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;<span class="comment">domain boundary. To illustrate how non-Dirichlet</span></div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;<span class="comment">boundary conditions are incorporated into a finite element discretisation,</span></div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;<span class="comment">we consider the following variant of problem P2:</span></div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;<span class="comment">&lt;CENTER&gt;</span></div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;<span class="comment">&lt;TABLE&gt; </span></div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;<span class="comment">&lt;TR&gt;</span></div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;<span class="comment">&lt;TD&gt;</span></div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;<span class="comment">&lt;CENTER&gt;</span></div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;<span class="comment">&lt;B&gt; Problem P4 &lt;/B&gt;</span></div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;<span class="comment">&lt;/CENTER&gt;</span></div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;<span class="comment">Solve</span></div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;<span class="comment">\f[ {\cal R}(x_i; u(x_i)) = \sum_{k=1}^2</span></div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;<span class="comment">\frac{\partial^2 u(x_i)}{\partial x_k^2} -</span></div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;<span class="comment">f(x_i) =0  \mbox{ \ \ \ \ for $x_i\in D$} \f]</span></div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;<span class="comment">subject to </span></div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;<span class="comment">\f[ u|_{\partial D_{Dirichlet}} = g(\zeta)</span></div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;<span class="comment">\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (1)\f]</span></div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;<span class="comment">and </span></div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;<span class="comment">\f[ \left. \frac{\partial u}{\partial n}\right|_{\partial</span></div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;<span class="comment">D_{Neuman}} = h(\zeta),</span></div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;<span class="comment">\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \   (2) \f]</span></div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;<span class="comment">where \f$ f(x_i), g(\zeta)\f$ and \f$ h(\zeta)\f$ are given.</span></div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;<span class="comment">The domain boundary \f$ \partial D\f$ is parametrised by</span></div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;<span class="comment">the arclength \f$ \zeta \f$, so that the position vector</span></div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;<span class="comment">to the boundary is given by</span></div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;<span class="comment">{\bf r}^{\partial D}(\zeta) = \left( x_1^{\partial D}(\zeta),</span></div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;<span class="comment">                                     x_2^{\partial D}(\zeta) \right)^T</span></div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;<span class="comment">The boundary consists of two parts so that</span></div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;<span class="comment">\f$\partial D = \partial D_{Dirichlet} \cup \partial D_{Neuman} \f$</span></div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;<span class="comment">and \f$ \partial D_{Dirichlet} \cap \partial D_{Neuman} = 0. \f$ \n</span></div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;<span class="comment">\f$ \partial/\partial n \f$ denotes the derivative in</span></div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;<span class="comment">direction of the outer unit normal to the domain.</span></div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;<span class="comment">\image html dirichlet_and_neumann_bc.gif &quot;Sketch of the domain and its &quot; </span></div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;<span class="comment">\image latex dirichlet_and_neumann_bc.eps &quot;Sketch of the domain and its &quot; width=0.55\textwidth</span></div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;<span class="comment">&lt;/TD&gt; </span></div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;<span class="comment">&lt;/TR&gt;</span></div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;<span class="comment">&lt;/TABLE&gt;</span></div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;<span class="comment">&lt;/CENTER&gt;</span></div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;<span class="comment">In the context of the physical problem of steady heat conduction,</span></div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;<span class="comment">where \f$ u(x_i) \f$ represents the temperature, </span></div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;<span class="comment">the Dirichlet boundary condition \f$ u|_{\partial D_{Dirichlet}} =</span></div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;<span class="comment">g\f$ prescribes the temperature along a certain part of the</span></div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;<span class="comment">boundary, while the Neumann condition </span></div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;<span class="comment">\f$\partial u/\partial n|_{\partial D_{Neuman}} = h\f$ prescribes</span></div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;<span class="comment">the heat flux into the body along the remainder of its</span></div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;<span class="comment">surface.</span></div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;<span class="comment">As before, we define a weak solution of this problem </span></div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;<span class="comment">as a(ny) function \f$ u_w(x_i) \f$ that satisfies the</span></div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;<span class="comment">Dirichlet boundary conditions  (1), </span></div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;<span class="comment">\f[ u_w|_{\partial D_{Dirichlet}} = g(\zeta),\f]</span></div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;<span class="comment">and for which the weighted residual</span></div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;<span class="comment">\f[ r = \int_{D}  {\cal R}(x_i; u_w(x_i)) \ \phi^{(test)}(x_i) </span></div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;<span class="comment">\ \mbox{d}x_1 \mbox{d}x_2 \ \ \ \ \ \ \ \ (3) \f]</span></div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;<span class="comment">vanishes for \e any  &quot;test function&quot; </span></div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;<span class="comment">\f$ \phi^{(test)}(x_i) \f$ that satisfies homogeneous</span></div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;<span class="comment">boundary conditions on the \f$\partial D_{Dirichlet}\f$,</span></div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;<span class="comment">\f[ \phi^{(test)}|_{\partial D_{Dirichlet}} = 0. \f]</span></div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;<span class="comment">The definition is consistent with </span></div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;<span class="comment">P2&lt;SUB&gt;weak&lt;/SUB&gt;: the two are identical if</span></div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;<span class="comment">\f$ \partial D = \partial D_{Dirichlet} \f$,</span></div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;<span class="comment">or, equivalently, if \f$ \partial D_{Neumann}=0 \f$. </span></div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;<span class="comment">The role of the test function in the weak</span></div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;<span class="comment">formulation of our</span></div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;<span class="comment">problem is to test whether the candidate solution violates any of the</span></div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;<span class="comment">conditions imposed on it. There are two types of test: </span></div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;<span class="comment">-# Does the candidate solution satisfy the PDE in the interior of </span></div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;<span class="comment">   the domain? </span></div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;<span class="comment">-# Does the candidate solution satisfy the boundary conditions?</span></div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;<span class="comment">.</span></div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;<span class="comment">We assume the Dirichlet conditions to be satisfied a priori, so </span></div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;<span class="comment">it is not necessary to perform any tests on  </span></div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;<span class="comment">\f$ \partial D_{Dirichlet} \f$. The easiest way to exclude</span></div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;<span class="comment">\f$ \partial D_{Dirichlet} \f$ from the &quot;test&quot; is to set</span></div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;<span class="comment">\f$ \phi^{(test)}|_{\partial D_{Dirichlet}} = 0 \f$ as we have</span></div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;<span class="comment">done. If \f$ \partial D_{Neumann} \ne 0 \f$, we need to </span></div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;<span class="comment">test whether our candidate solution satisfies </span></div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;<span class="comment">the Neumann boundary condition (2). </span></div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;<span class="comment">Certain types of Neumann boundary conditions can be</span></div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;<span class="comment">naturally incorporated into the weighted residual.</span></div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;<span class="comment">Performing the integration by parts in our present problem</span></div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;<span class="comment">converts  (3) into</span></div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;<span class="comment">\f[ \int_D \left[ \sum_{k=1}^2 \frac{\partial u(x_i)}{\partial x_k} \ </span></div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;<span class="comment"> \frac{\partial \phi^{(test)}(x_i)}{\partial x_k}  +</span></div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;<span class="comment"> f(x_i) \  \phi^{(test)}(x_i) \right]  \mbox{d}x_1 \mbox{d}x_2 = \f]</span></div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;<span class="comment">= \int_{\partial D_{Dirichlet}}  \phi^{(test)} \</span></div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;<span class="comment"> \frac{\partial u}{\partial n}  \ \mbox{d}\zeta \ + \</span></div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;<span class="comment"> \int_{\partial D_{Neumann}}  </span></div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;<span class="comment"> \ \phi^{(test)} \ \frac{\partial u}{\partial n} \ \mbox{d}\zeta, \ \ \ \ \ </span></div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;<span class="comment">(4) \f]</span></div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;<span class="comment">where \f$\zeta\f$ is the arclength along the domain boundary </span></div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;<span class="comment">\f$ \partial D\f$. We have split the integral along \f$ \partial D\f$</span></div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;<span class="comment">into two separate integrals over </span></div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;<span class="comment">\f$ \partial D_{Dirichlet}\f$ and \f$ \partial D_{Neumann}\f$.</span></div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;<span class="comment">Since \f$ \phi^{(test)}|_{\partial D_{Dirichlet}} = 0, \f$</span></div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;<span class="comment">the integral over \f$\partial D_{Dirichlet}\f$ vanishes</span></div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;<span class="comment">automatically. The second integral has to be retained because</span></div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;<span class="comment">\f$ \phi^{(test)} \f$ can take any value on  </span></div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;<span class="comment">\f$\partial D_{Neumann}\f$. However, \f$ \partial u/\partial n \f$</span></div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;<span class="comment">in its integrand is specified by the Neumann boundary </span></div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;<span class="comment">condition (2). We can, therefore, incorporate</span></div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;<span class="comment">(2) into the weighted residual by writing</span></div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;<span class="comment">\f[ \int_D \left[ \sum_{k=1}^2 \frac{\partial u(x_i)}{\partial x_k} \ </span></div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;<span class="comment"> \frac{\partial \phi^{(test)}(x_i)}{\partial x_k}  +</span></div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;<span class="comment"> f(x_i) \  \phi^{(test)}(x_i) \right]  \mbox{d}x_1 \mbox{d}x_2 =</span></div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;<span class="comment"> \int_{\partial D_{Neumann}}  </span></div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;<span class="comment"> \phi^{(test)}(\zeta) \ h(\zeta) \ d\zeta. \ \ \ \ \ </span></div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;<span class="comment">(5) \f]</span></div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;<span class="comment">We now introduce the usual finite-element expansion for \f$ u(x_i)\f$</span></div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;<span class="comment">in terms of the \f$ N \f$ nodal values and the global</span></div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;<span class="comment">shape functions \f$ \psi_j(x_i) \f$, </span></div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;<span class="comment">\f[ u(x_i) = \sum_{j=1}^{N} \ U_j \ \psi_j(x_i), \f]</span></div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;<span class="comment">where the Dirichlet</span></div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;<span class="comment">boundary conditions determine the nodal values of all nodes</span></div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;<span class="comment">that are located on \f$\partial</span></div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;<span class="comment">D_{Dirichlet}\f$. The nodal values of</span></div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;<span class="comment">the nodes in the interior of the domain and on </span></div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;<span class="comment">\f$\partial D_{Neumann}\f$ are unknown and must</span></div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;<span class="comment">be determined from the solution of the discrete equations</span></div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;<span class="comment">\f[ f_{{\cal E}(l)} = \int_D \left[ \sum_{j=1}^N U_j \sum_{k=1}^2 </span></div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;<span class="comment">             \frac{\partial \psi_j(x_i)}{\partial x_k} \ </span></div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;<span class="comment"> \frac{\partial \psi_l(x_i)}{\partial x_k}  +</span></div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;<span class="comment"> f(x_i) \  \psi_l(x_i) \right]  \mbox{d}x_1 \mbox{d}x_2\ \f]</span></div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;<span class="comment"> \f[ - \</span></div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;<span class="comment"> \int_{\partial D_{Neumann}}  </span></div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;<span class="comment"> \psi_l(\zeta) \ h(\zeta) \ \mbox{d}\zeta =0 \\ \mbox{\ \ \ for all $l$ for</span></div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;<span class="comment">  which ${\cal E}(l)&gt;0$,}</span></div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;<span class="comment">\ \ \ \ \ \ </span></div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;<span class="comment">(6)  \f]</span></div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;<span class="comment">where we have used the global equation number \f${\cal E}(l)\f$ </span></div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;<span class="comment">to identify nodes whose values are not pinned.</span></div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;<span class="comment">Let us now assume that we have discretised the domain by using</span></div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;<span class="comment">isoparametric elements, so that</span></div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;<span class="comment">within element \f$ e \f$ the solution is represented as</span></div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;<span class="comment">\f[ u(s_1,s_2) = \sum_{j_{local}=1}^n U_{{\cal J}(j_{local},e)} </span></div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;<span class="comment">\ \psi_{j_{local}}(s_1,s_2) \f]</span></div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;<span class="comment">and </span></div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;<span class="comment">\f[ x_i(s_1,s_2) = \sum_{j_{local}=1}^n X_{i{\cal J}(j_{local},e)} </span></div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;<span class="comment">\ \psi_{j_{local}}(s_1,s_2), \ \ \ \ \ \ \</span></div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;<span class="comment">(7) \f]</span></div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;<span class="comment">where \f$ n \f$ is the number of nodes in the element. </span></div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;<span class="comment">We employ the element-by-element assembly procedure described </span></div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;<span class="comment">in Algorithm 1 to evaluate the domain integral</span></div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;<span class="comment">in (6).</span></div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;<span class="comment">During this procedure, we visit each element in the mesh, loop over </span></div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;<span class="comment">the element&#39;s \f$ n \f$ nodes </span></div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;<span class="comment">\f$ l_{local}=1,...,n \f$, check whether the node&#39;s global equation number</span></div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;<span class="comment">\f$ i_{global} = {{\cal E}({\cal J}(l_{local},e))}\f$ is positive, and, if so,</span></div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;<span class="comment">add the &quot;bulk&quot; contribution</span></div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;<span class="comment">\int_{-1}^{1}   \int_{-1}^{1} </span></div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;<span class="comment">\left[ \sum_{j_{local}=1}^n U_{{\cal J}(j_{local},e)} \sum_{k=1}^2 </span></div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;<span class="comment">\frac{\partial \psi_{j_{local}}}{\partial x_k} \ </span></div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;<span class="comment">\frac{\partial \psi_{l_{local}}}{\partial x_k}  +</span></div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;<span class="comment">f \  \psi_{l_{local}} \right]  \widehat{\cal J} \ \mbox{d}s_1 \mbox{d}s_2 </span></div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;<span class="comment">to the \f$ i_{global}\f$-th entry of the global residual vector. </span></div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;<span class="comment">It remains to assemble the contributions from the line integral around</span></div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;<span class="comment">the boundary of the domain, which can also be done element-by-element.</span></div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;<span class="comment">To illustrate the</span></div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;<span class="comment">procedure, we consider the example shown below: A (topologically </span></div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;<span class="comment">rectangular) domain has been </span></div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;<span class="comment">decomposed into 12 four-node elements. Neumann boundary </span></div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;<span class="comment">conditions are to be applied along the domain&#39;s &quot;southern &quot; and </span></div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;<span class="comment">&quot;eastern&quot; boundaries. The &quot;northern&quot; and &quot;western&quot; boundaries</span></div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;<span class="comment">are subject to Dirichlet boundary conditions.</span></div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;<span class="comment">\image html dirichlet_and_neumann_mesh.gif &quot;Sketch of a discretised domain with Dirichlet and Neumann boundary &quot; </span></div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;<span class="comment">\image latex dirichlet_and_neumann_mesh.eps &quot;Sketch of a discretised domain with Dirichlet and Neumann boundary &quot; width=0.75\textwidth</span></div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;<span class="comment">A discrete representation of the domain&#39;s southern boundary </span></div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;<span class="comment">is given by the southern edges of elements 1,2 and 3. </span></div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;<span class="comment">Along these edges the local coordinate \f$ s_1\f$ varies </span></div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;<span class="comment">from -1 to +1 while \f$ s_2 \equiv -1\f$. We obtain</span></div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;<span class="comment">a piecewise linear approximation for the continuous</span></div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;<span class="comment">domain boundary \f$ {\bf r}^{\partial D}\f$ by substituting</span></div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;<span class="comment">\f$ s_1 =  S \in [-1,1]\f$ and  \f$ s_2 = -1 \f$ into the</span></div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;<span class="comment">mapping (7) between</span></div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;<span class="comment">the local and global coordinates,</span></div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;<span class="comment">x_i^{\partial D} \approx x_i(s_1=S,s_2=-1) </span></div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;<span class="comment">The integral</span></div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;<span class="comment">of any function  \f$ {\cal F}\big(x_1,x_2\big) \f$</span></div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;<span class="comment">along the elements&#39; southern edges can be performed</span></div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;<span class="comment">in terms of element&#39;s local coordinates by writing</span></div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;<span class="comment">\int_{\mbox{Southern edge of element $e$}} {\cal F}\big(x_1(\zeta) ,x_2(\zeta)\big) \ d\zeta = </span></div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;<span class="comment">\int_{-1}^{1} \left. {\cal F}\big(x_1(s_1,s_2),x_2(s_1,s_2)\big) \right|_{</span></div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;<span class="comment">s_2=-1}</span></div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;<span class="comment">\ \widehat{\cal J}^{(1D)}(s_1) \ ds_1,</span></div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;<span class="comment">\f] </span></div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;<span class="comment">where</span></div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;<span class="comment">\f[  \widehat{\cal J}^{(1D)}(s_1) = \left. \sqrt{</span></div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;<span class="comment">\left( \frac{\partial x_1(s_1,s_2)}{\partial s_1} \right)^2 + </span></div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;<span class="comment">\left( \frac{\partial x_2(s_1,s_2)}{\partial s_1} \right)^2 }</span></div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;<span class="comment">\right|_{s_2=-1} </span></div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;<span class="comment">is the Jacobian of the mapping between the local coordinate</span></div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;<span class="comment">that parametrises the edge of the element, \f$s_1\f$,  and the arclength,</span></div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;<span class="comment">\f$ \zeta\f$.</span></div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;<span class="comment">Similarly, the domain&#39;s eastern boundary is represented</span></div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;<span class="comment">by the eastern edges of elements 3, 6, 9 and 12 whose position</span></div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;<span class="comment">is given by \f$ x_i(s_1=1,s_2=S) \f$ where  \f$ S \in [-1,1]\f$,</span></div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;<span class="comment">and</span></div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;<span class="comment">\int_{\mbox{Eastern edge of element $e$}} {\cal</span></div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;<span class="comment">F}\big(x_1(\zeta) ,x_2(\zeta)\big) \ d\zeta = </span></div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;<span class="comment">\int_{-1}^{1} \left. {\cal F}\big(x_1(s_1,s_2),x_2(s_1,s_2)\big) \right|_{</span></div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;<span class="comment">s_1=1}</span></div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;<span class="comment">\ \widehat{\cal J}^{(1D)}(s_2) \ ds_2,</span></div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;<span class="comment">where</span></div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;<span class="comment">\f[  \widehat{\cal J}^{(1D)}(s_2) = \left. \sqrt{</span></div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;<span class="comment">\left( \frac{\partial x_1(s_1,s_2)}{\partial s_2} \right)^2 + </span></div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;<span class="comment">\left( \frac{\partial x_2(s_1,s_2)}{\partial s_2} \right)^2 }</span></div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;<span class="comment">\right|_{s_1=1} </span></div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;<span class="comment">In general, the line integrals are evaluated</span></div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;<span class="comment">numerically, e.g. using the 1D Gauss rules discussed in </span></div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;<span class="comment">section \ref local_coords.</span></div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;<span class="comment">Inspection of equation</span></div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;<span class="comment">(6) shows that the line </span></div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;<span class="comment">integral only makes a contribution to the discrete residuals whose</span></div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;<span class="comment">nodes are located on the Neumann boundaries. [Recall that the </span></div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;<span class="comment">global shape function \f$ \psi_l \f$ </span></div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;<span class="comment">is equal to one at global node \f$ l \f$ and vanishes at all</span></div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;<span class="comment">other nodes. Furthermore,  \f$ \psi_l \f$ is nonzero</span></div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;<span class="comment">only in the patch of elements adjacent to node \f$ l \f$ and</span></div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;<span class="comment">vanishes on the boundary of that patch.]</span></div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;<span class="comment">The line integral in (6)</span></div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;<span class="comment">can, therefore, be evaluated by augmenting the assembly </span></div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;<span class="comment">of the elemental&#39; residual vector as follows:</span></div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;<span class="comment">- Compute the &quot;standard&quot; element residual vector that arises</span></div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;<span class="comment">  from the area integral, as discussed in algorithm 1.</span></div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;<span class="comment">- If the element&#39;s southern edge is located on a Neumann boundary:</span></div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;<span class="comment">  - Set \f$s_2=-1\f$.</span></div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;<span class="comment">  - Loop over the 1D Gauss points \f$ i_{int}=1,...,N_{int} \f$.</span></div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;<span class="comment">    - Determine the local coordinate of the integration point</span></div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;<span class="comment">      \f$ s_1 = S_{i_{int}} \f$ and the associated </span></div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;<span class="comment">      weight \f$W_{i_{int}}.\f$</span></div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;<span class="comment">    - Compute</span></div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;<span class="comment">      - the global coordinates  \f$ x_i = x_i(s_1,s_2) \f$</span></div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;<span class="comment">      - the prescribed-flux function \f$ h=h(x_1,x_2)\f$</span></div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;<span class="comment">      - the shape functions  \f$ \psi_j(s_1,s_2) \f$</span></div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;<span class="comment">      - the Jacobian of the 1D mapping</span></div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;<span class="comment">        \f[</span></div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;<span class="comment">        \widehat{\cal J}^{(1D)} = \left. \sqrt{</span></div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;<span class="comment">        \left( \frac{\partial x_1(s_1,s_2)}{\partial s_1} \right)^2 + </span></div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;<span class="comment">        \left( \frac{\partial x_2(s_1,s_2)}{\partial s_1} \right)^2 }</span></div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;<span class="comment">        \right|_{s_2=-1} </span></div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;<span class="comment">        \f]</span></div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;<span class="comment">      .</span></div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;<span class="comment">    - Loop over those local nodes that are located on the</span></div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;<span class="comment">      element&#39;s southern edge (e.g. \f$ j_{local}=1,2\f$ for a four-node </span></div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;<span class="comment">      quadrilateral element).</span></div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;<span class="comment">      - Determine the global node number </span></div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;<span class="comment">        \f$ j_{global} = {\cal J}(j_{local},e)\f$.</span></div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;<span class="comment">      - Determine the global equation number \f${\cal E}(j_{global})\f$.</span></div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;<span class="comment">      - If \f${\cal E}(j_{global})\ne -1\f$:</span></div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;<span class="comment">        - Determine the local equation number </span></div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;<span class="comment">        \f$i_{dof}={\cal L}(j_{local},e)\f$.</span></div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;<span class="comment">        - Add the contribution to the element&#39;s residual vector</span></div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;<span class="comment">          \f[</span></div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;<span class="comment">          r^{(e)}_{i_{dof}} = r^{(e)}_{i_{dof}} + </span></div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;<span class="comment">          h \ \psi_{j_{local}} \ \widehat{\cal J}^{(1D)} \ W_{i_{int}}</span></div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;<span class="comment">          \f]</span></div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;<span class="comment">        .</span></div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;<span class="comment">      .</span></div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;<span class="comment">    .</span></div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;<span class="comment">  .</span></div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;<span class="comment">- Perform equivalent operations for the eastern, northern</span></div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;<span class="comment">  and western edges, if required.</span></div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;<span class="comment">Note that it is not necessary to change the setup of the Jacobian matrix</span></div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;<span class="comment">because the boundary terms are independent of the unknown variables. </span></div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;<span class="comment">This procedure can easily be generalised to higher-dimensional</span></div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;<span class="comment">elements such as 3D Poisson elements for which </span></div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;<span class="comment">Neumann boundary conditions are applied on the elements&#39;</span></div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;<span class="comment">2D faces.</span></div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;<span class="comment">\subsubsection neumann_implementation Implementation</span></div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;<span class="comment">The procedure outlined in the previous section could easily</span></div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;<span class="comment">be implemented within the general framework of \c oomph-lib. </span></div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;<span class="comment">One possible implementation would be the following:</span></div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;<span class="comment">- Add a vector of bools, \c Vector&lt;bool&gt; \c Neumann_bc, say,</span></div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;<span class="comment">  to the private data of \c PoissonEquations and use</span></div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;<span class="comment">  the value of \c Neumann_bc[i] to indicate whether</span></div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;<span class="comment">  the element&#39;s \c i-th face is subject to </span></div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;<span class="comment">  a Neumann boundary condition (assuming that \c</span></div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;<span class="comment">  Neumann_bc[i]=false by default.)</span></div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;<span class="comment">- Provide storage for function pointers to the (global) functions</span></div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;<span class="comment">  that specify the prescribed fluxes on the element&#39;s</span></div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;<span class="comment">  faces. </span></div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;<span class="comment">- When assembling the element&#39;s residual vector</span></div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;<span class="comment">  in \c PoissonEquations::get_residuals(), execute the </span></div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;<span class="comment">  assembly loop for the boundary integrals only for those edges</span></div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;<span class="comment">  for which  \c Neumann_bc[i]=true.</span></div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;<span class="comment">- To solve a problem with Neumann boundary conditions we would</span></div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;<span class="comment">  discretise the domain as before, loop over</span></div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;<span class="comment">  all elements that have nodes on \f$ \partial D_{Neumann}\f$, </span></div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;<span class="comment"> setting the appropriate </span></div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;<span class="comment">  \c Neumann_bc flag to \c true and specifying</span></div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;<span class="comment">  a function pointer to the prescribed-flux function.</span></div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;<span class="comment">.</span></div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;<span class="comment">The implementation is straightforward and actually</span></div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;<span class="comment">presents an instructive exercise. [Suggestion: Rather than </span></div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;<span class="comment">incorporating the additional functionality directly</span></div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;<span class="comment">into the existing Poisson elements, use inheritance to create a new</span></div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;<span class="comment">class, \c PoissonEquationsWithFluxBC, say, which contains</span></div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;<span class="comment">the additional data and provides the necessary access functions. </span></div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;<span class="comment">The derived class must</span></div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;<span class="comment">overload \c get_residuals(...) with a function that initially calls \c</span></div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;<span class="comment">PoissonEquations:get_residuals(...) and then adds the </span></div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;<span class="comment">contribution from the line integrals]. </span></div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;<span class="comment">Unfortunately, the implementation suggested above has</span></div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;<span class="comment">several serious disadvantages</span></div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;<span class="comment">-# The test of \c Neumann_bc[i] must be performed </span></div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;<span class="comment">   in every element, even though only a relatively small number of</span></div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;<span class="comment">   elements are likely to be located on the domain boundaries.</span></div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;<span class="comment">-# The code that implements the computation of the integrals</span></div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;<span class="comment">   along the four possible element edges is very similar</span></div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;<span class="comment">   (the main difference being which local coordinate is held</span></div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;<span class="comment">   constant along the appropriate element edge, and which </span></div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;<span class="comment">   local nodes make a contribution to the element residual vector)</span></div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;<span class="comment">   but this similarly is not exploited.</span></div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;<span class="comment">-# Finally, and most significantly, many steps in the above</span></div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;<span class="comment">   procedure, such as the identification</span></div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;<span class="comment">   of the nodes that are located on specific element edges, are </span></div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;<span class="comment">   completely generic and will also occur in the application of</span></div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;<span class="comment">   Neumann-type boundary conditions in other equations (see</span></div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;<span class="comment">   section ***). Incorporating the procedure directly into </span></div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;<span class="comment">   the Poisson elements makes it impossible to &quot;reuse&quot; the</span></div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;<span class="comment">   relevant algorithms elsewhere.</span></div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;<span class="comment">Our implementation employs a slightly different</span></div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;<span class="comment">approach: rather than incorporating the assembly of the</span></div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;<span class="comment">boundary integral into the Poisson element itself, we treat</span></div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;<span class="comment">the boundary integral over the element&#39;s face as a distinct</span></div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;<span class="comment">lower-dimensional \c FiniteElement. We separate</span></div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;<span class="comment">the specification of the element geometry from the implementation</span></div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;<span class="comment">of the specific boundary conditions, and use templating and inheritance</span></div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;<span class="comment">to create Neumann-type elements for entire families </span></div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;<span class="comment">of elements. Here will discuss the \c PoissonFluxElement class,</span></div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;<span class="comment">a class of \c FiniteElements that impose flux boundary conditions</span></div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;<span class="comment">on the &quot;faces&quot; of associated &quot;bulk&quot; Poisson elements. The</span></div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;<span class="comment">\c PoissonFluxElement class is</span></div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;<span class="comment">templated by the element type of the associated &quot;bulk&quot; element</span></div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;<span class="comment">so that a \c PoissonFluxElement&lt;QPoissonElement&lt;2,3&gt; &gt; </span></div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;<span class="comment">is the three-node line element (from the \c QElement family) that </span></div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;<span class="comment">imposes a prescribed-flux boundary condition along one of the</span></div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;<span class="comment">1D edges of a nine-node quadrilateral Poisson element. </span></div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;<span class="comment">Similarly, a \c PoissonFluxElement&lt;QPoissonElement&lt;3,2&gt; &gt; </span></div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;<span class="comment">is the four-node quadrilateral element that </span></div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;<span class="comment">imposes a prescribed-flux boundary condition on a</span></div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;<span class="comment">2D face of an eight-node brick-shaped Poisson element. </span></div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;<span class="comment">Our implementation involves two new classes:</span></div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;<span class="comment">- The \c FaceElement class implements all the functionality that could </span></div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;<span class="comment">  conceivably be required by any \c FiniteElement that imposes</span></div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;<span class="comment">  Neumann-type boundary conditions on the faces of higher-dimensional </span></div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;<span class="comment">  &quot;bulk&quot; elements. (The \c PoissonFluxElements requires none</span></div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;<span class="comment">  of this functionality; and we defer a complete explanation of </span></div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;<span class="comment">   the structure of this class.)</span></div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;<span class="comment">- The \c FaceGeometry class, a policy class that defines</span></div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;<span class="comment">  the geometry of the lower-dimensional \c FiniteElements</span></div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;<span class="comment">  that form the faces for a given &quot;bulk&quot; element. </span></div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;<span class="comment">.</span></div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;<span class="comment">We shall illustrate the use of these classes in a &quot;top-down&quot;</span></div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;<span class="comment">example in which we solve Poisson&#39;s equation in a rectangular</span></div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;<span class="comment">domain, with Neumann boundary conditions </span></div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;<span class="comment">along the domain&#39;s southern boundary. The full driver code</span></div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;<span class="comment">for this example</span></div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;<span class="comment">(&lt;A HREF=&quot;../../to_be_written/html/index.html&quot;&gt;prescribed_flux_poisson_driver.cc&lt;/A&gt;)</span></div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;<span class="comment">can be found in the </span></div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;<span class="comment">&lt;A HREF=&quot;../../to_be_written/html/index.html&quot;&gt;demo directory&lt;/A&gt;.</span></div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;<span class="comment">The code fragment below illustrates the application of Neumann </span></div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;<span class="comment">boundary conditions for this problem and presents the only</span></div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;<span class="comment">change to &lt;A HREF=&quot;../../to_be_written/html/index.html&quot;&gt;toy_poisson_driver.cc&lt;/A&gt;, </span></div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;<span class="comment">in which the problem is solved with Dirichlet</span></div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;<span class="comment">boundary conditions everywhere.</span></div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;<span class="comment">The code implements the problem by defining a suitable </span></div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;<span class="comment">problem class, \c FluxPoissonProblem, which we template </span></div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;<span class="comment">by the element type so that the problem</span></div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;<span class="comment">can be solved with a variety of quadrilateral Poisson elements,</span></div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;<span class="comment">\e e.g. the four-node quad element \c QPoissonElement&lt;2,2&gt;, </span></div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;<span class="comment">the nine-node quad element  \c QPoissonElement&lt;2,3&gt;, etc.</span></div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;<span class="comment">Here is the constructor for the \c FluxPoissonProblem class:</span></div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;<span class="comment">\code</span></div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;<span class="comment">//========================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;<span class="comment">/// \short Constructor for Poisson problem with prescribed flux boundary</span></div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;<span class="comment">/// conditions. </span></div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;<span class="comment"></span>//========================================================================</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;template&lt;class ELEMENT&gt;</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;FluxPoissonProblem&lt;ELEMENT&gt;::FluxPoissonProblem()</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;{ </div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160; </div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160; // Build and assign mesh (3 x 4 elements in unit square)</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160; Problem::mesh_pt()=new SimpleRectangularQuadMesh&lt;ELEMENT&gt;(3,4,1.0,1.0);</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160; </div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;\endcode</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160; </div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;As always, we start by creating a mesh, specifying the type of the</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;&quot;bulk&quot; element as the template argument in the mesh constructor. </div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;When the mesh generation process is complete, the &quot;bulk&quot; elements</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;have been created and are accessible via the various pointer-based </div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;access functions defined in the \c Mesh class. Now we must</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;create the prescribed-flux elements and</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;attach them to those &quot;bulk&quot; elements that have edges which coincide</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;with the southern domain boundary (mesh boundary 1 in this example).</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;We use \c Mesh member functions to determine</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;- the &quot;bulk&quot; elements that are located on that boundary,</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;- the local coordinate of these elements that remains fixed along the</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;boundary, and</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;- the value of the &quot;fixed&quot; local coordinate; in fact, this can only be</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;the maximum or minimum possible value.</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;.</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;\code </div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160; </div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;// How many elements are adjacent to boundary 1?</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;unsigned b=1;</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;unsigned n_element=mesh_pt()-&gt;nboundary_element(b);</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160; </div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;// Loop over the bulk elements on mesh boundary b:</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;for(unsigned e=0;e&lt;n_element;e++)</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160; {</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160; </div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;  // Get pointer to the e-th bulk element on mesh boundary b. (Need to </div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;  // recast to the specific bulk element type, because </div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;  // boundary_element_pt() returns a pointer to a FiniteElement. </div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;  ELEMENT* bulk_elem_pt=dynamic_cast&lt;ELEMENT*&gt;(</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;   mesh_pt()-&gt;boundary_element_pt(b,e));</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;  </div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;  // Which local coordinate (in the bulk element) is constant</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;  // along the boundary?</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;  unsigned s_fixed_index=mesh_pt()-&gt;s_fixed_index_at_boundary(b,e);</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160; </div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;  // Is the constant coordinate fixed at its max. or min. value?</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;  int s_limit=mesh_pt()-&gt;s_limit_at_boundary(b,e);</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160; </div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;  \endcode</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160; </div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160; Now we construct the \c PoissonFluxElements (templated by</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160; the type of the bulk element). Their constructor takes a pointer to</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160; the bulk element, and the information about the fixed local </div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160; coordinate that we have just obtained from the \c Mesh:</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160; </div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160; \code</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160; </div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;  // Build the corresponding prescribed-flux element</div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;  PoissonFluxElement&lt;ELEMENT&gt;* flux_element_pt = new </div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;  PoissonFluxElement&lt;ELEMENT&gt;(bulk_elem_pt,s_fixed_index,s_limit);</div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160; </div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;  \endcode</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160; </div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;  The constructor creates a prescribed-flux element with the</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;  appropriate element geometry and sets its node pointers</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;  to the nodes on the appropriate face of the</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;  &quot;bulk&quot; element. We set the function pointer to the prescribed flux</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;  function -- here assumed to be the function \c get_flux(...) </div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;  in the namespace \c GlobalFunctions.</div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160; </div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;  \code</div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160; </div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;  // Set the pointer to the prescribed-flux function</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;  flux_element_pt-&gt;flux_fct_pt()=&amp;GlobalFunctions::get_flux;</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160; </div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;  \endcode</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160; </div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;  Finally, we add the newly created element to the mesh:</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160; </div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;  \code</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160; </div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;  //Add the prescribed-flux element to the mesh</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;   mesh_pt()-&gt;add_element_pt(flux_element_pt);</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160; </div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160; }</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;\endcode</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160; </div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;We still need to apply the Dirichlet boundary conditions on the</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;the remaining boundary nodes. This follows the usual pattern</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;of looping over the boundary nodes and pinning their values, though</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;we omit the nodes on boundary 1, because their values</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;are unknown.</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160; </div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;\code </div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;// Set the boundary conditions for this problem: All nodes are</div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;// free by default -- just pin the ones that have Dirichlet conditions</div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;// here. </div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;unsigned num_bound = mesh_pt()-&gt;nboundary();</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;for (unsigned b=0;b&lt;num_bound;b++)</div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160; {</div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;  //Leave nodes on boundary 1 free</div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;  if (b!=1)</div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;   {</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;    unsigned num_nod= mesh_pt()-&gt;nboundary_node(b);</div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;    for (unsigned inod=0;inod&lt;num_nod;inod++)</div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;     {</div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;      mesh_pt()-&gt;boundary_node_pt(b,inod)-&gt;pin(0); </div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;     }</div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;   }</div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160; }</div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160; </div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160; [...]</div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160; </div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160; </div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;} // End of constructor</div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;\endcode</div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160; </div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;[We have omitted the (standard) code for the assignment of the </div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;linear solver, the assignment of equation numbers, etc.]</div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160; </div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;The fine details of the procedure are embodied in</div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;class definition of the \c PoissonFluxElements:</div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160; </div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;\code</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160; </div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;//======================================================================<span class="comment"></span></div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;<span class="comment">/// \short A class for elements that allow the imposition of a </span></div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;<span class="comment">/// prescribed flux on the boundaries of Poisson elements.</span></div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;<span class="comment">/// The element geometry is obtained from the  FaceGeometry&lt;ELEMENT&gt; </span></div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;<span class="comment">/// policy class.</span></div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;<span class="comment"></span>//======================================================================</div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;template &lt;class ELEMENT&gt;</div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;class PoissonFluxElement : public virtual FaceGeometry&lt;ELEMENT&gt;, </div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;public virtual FaceElement</div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;{</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160; </div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;public:</div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160; </div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;<span class="comment"> /// \short Constructor, takes the pointer to the &quot;bulk&quot; element, the </span></div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;<span class="comment"> /// index of the fixed local coordinate and its value, represented</span></div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;<span class="comment"> /// by an integer (+/- 1), indicating that the face is located</span></div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;<span class="comment"> /// at the max. or min. value of the &quot;fixed&quot; local coordinate</span></div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;<span class="comment"> /// in the bulk element.</span></div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;<span class="comment"></span> PoissonFluxElement(FiniteElement* bulk_el_pt, </div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;                    const unsigned&amp; fixed_local_coord_index, </div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;                    const int&amp; s_limit);</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160; </div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160; </div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;[...]</div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160; </div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160; </div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;}; // End of class definition for PoissonFluxElement</div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160; </div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;\endcode</div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160; </div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;\c PoissonFluxElements are </div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;derived from the \c FaceGeometry class, </div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;a policy class used to establish the geometry</div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;of the face element as a function of the &quot;bulk&quot; element </div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;specified by the template parameter. This inheritance structure</div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;is, in fact,  equivalent to the way in which \c QPoissonElements</div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;are derived from geometric elements of the \c QElement family.</div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;The \c FaceGeometry class should be </div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;defined for every conceivable type of &quot;bulk&quot; element but this</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;is usually a straightforward process. For</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;&quot;bulk&quot; elements from the \c QPoissonElement family, the</div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;prescribed-flux elements have the same number of nodes along</div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;their 1D edges as their &quot;bulk&quot; elements but their spatial</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;dimension is reduced by one. Hence, the complete class definition is:</div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160; </div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;\code</div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;//=======================================================================<span class="comment"></span></div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;<span class="comment">/// Face geometry for the QPoissonElement elements: The spatial </span></div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;<span class="comment">/// dimension of the face elements is one lower than that of the</span></div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;<span class="comment">/// bulk element but they have the same number of points</span></div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;<span class="comment">/// along their 1D edges.</span></div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;<span class="comment"></span>//=======================================================================</div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;template&lt;unsigned DIM, unsigned NNODE_1D&gt;</div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;class FaceGeometry&lt;QPoissonElement&lt;DIM,NNODE_1D&gt; &gt;: </div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160; public virtual QElement&lt;DIM-1,NNODE_1D&gt;</div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;{</div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160; </div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;  public:</div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;<span class="comment"> /// \short Constructor: Call the constructor for the</span></div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;<span class="comment"> /// appropriate lower-dimensional QElement</span></div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;<span class="comment"></span> FaceGeometry() : QElement&lt;DIM-1,NNODE_1D&gt;() {}</div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160; </div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160; </div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;}; // End of FaceGeometry definition for QPoissonElements</div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160; </div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;\endcode</div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160; </div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;hierher: probably need to handle the 0D case separately.</div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160; </div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;This construction ensures that the number of nodes, etc., of</div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;\c PoissonFluxElements is consistent with that of their</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;higher-dimensional &quot;bulk&quot; elements. We now need to ensure that the </div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;\c PoissonFluxElement&#39;s node pointers refer to the (already existing)</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;nodes on the appropriate face of the &quot;bulk&quot; element. </div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;The process is purely geometric, and</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;is performed by \c FiniteElement::build_face_element(...) function</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;of the specific &quot;bulk&quot; geometric elements.</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160; </div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;\code</div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160; </div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;//======================================================================<span class="comment"></span></div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;<span class="comment">/// Constructor, takes the pointer to the &quot;bulk&quot; element, the </span></div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;<span class="comment">/// index of the fixed local coordinate and its value represented</span></div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;<span class="comment">/// by an integer (+/- 1), indicating that the face is located</span></div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;<span class="comment">/// at the max. or min. value of the &quot;fixed&quot; local coordinate</span></div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;<span class="comment">/// in the bulk element.</span></div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;<span class="comment"></span>//======================================================================</div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;template&lt;class ELEMENT&gt;</div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;PoissonFluxElement&lt;ELEMENT&gt;::PoissonFluxElement(</div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;                                  FiniteElement *bulk_el_pt, </div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;                                  const unsigned&amp; fixed_local_coord_index, </div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;                                  const int&amp; s_limit) : </div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;  FaceGeometry&lt;ELEMENT&gt;(), FaceElement()</div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;  { </div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160; </div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;   // Let the bulk element build the FaceElement, </div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;   // i.e. setup the pointers </div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;   // to its nodes (by referring to the appropriate nodes in the bulk </div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;   // element), etc.</div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;   bulk_el_pt-&gt;build_face_element(fixed_local_coord_index,s_limit,this);</div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160; </div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;   [...]</div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160; </div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160; }</div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160; </div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;\endcode</div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160; </div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;The constructor initially calls the constructor of the appropriate</div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;\c FaceGeometry and thus establishes the element geometry. This is </div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;followed by a call to the \c FaceElement constructor</div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;which allocates storage for any additional data that needs to be</div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;stored on (generic) face elements. Finally, we call the</div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;&quot;bulk&quot; element&#39;s \c build_face_element() function to setup the</div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;node pointers for the present (\c this) element.</div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;[\b Note: \c build_face_element() also assigns the additional data that is</div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;stored in the \c FaceElement base class. As mentioned above,</div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;none of this information is required in the present context,</div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;so we postpone the detailed discussion of this data to </div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;section ***FREE SURFACE NAVIER-STOKES ELEMENTS***.]</div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160; </div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;&lt;HR&gt;</div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160; </div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160; </div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160; </div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;\subsection systems_of_PDEs Systems of PDEs: Multiple nodal values</div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160; </div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;So far, we have only considered scalar ODEs and PDEs but the finite</div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;element method can easily be extended to problems with </div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;vector-valued unknowns. As a simple example, we first consider a</div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;system of 1D  Poisson equations</div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;\f[ </div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;\frac{\mbox{d}^2 u_k(x)}{\mbox{d} x} =</div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;f_k(x)  \mbox{ \ \ \ \ for $x\in [0,1]$  </div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;\ \ \ subject to \ \ \ $u_k(0) = g_{0k}$ \ \ \ </div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;and \ \ \ $u_k(1) = g_{1k}$, }</div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;\mbox{\hspace{5cm}} \f]</div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;where the coefficients \f$g_{0k} \f$ and</div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;\f$g_{1k}\f$ and the functions \f$ f_k(x) \f$ are given, and </div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;\f$ k=1,...,K\f$.</div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;Since the \f$ K \f$ ODEs have exactly the same form, we obtain</div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;\f$ K \f$ (identical) weak problems</div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;&lt;CENTER&gt;</div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;&lt;TABLE&gt;</div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;&lt;TR&gt;</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;&lt;TD&gt;</div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;&lt;CENTER&gt;</div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;&lt;B&gt; Problem P3 &lt;/B&gt;\n\n</div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;Find the functions  \f$ u_k(x) \in H(D) \f$ (where </div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;\f$ k=1,...,K\f$) that satisfy the essential boundary conditions</div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;\f[ u_k(0) = g_{0k} \ \ \ \mbox{and} \ \ \   u_k(1) = g_{1k}</div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;\mbox{ \ \ \ \ for $k=1,...,K$,} \f]</div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;and for which</div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;\f[ \int_0^1 \left( \frac{\mbox{d} u_k(x)}{\mbox{d} x} \ </div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;\frac{\mbox{d} \phi^{(test)}(x)}{\mbox{d} x} \</div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;+ f_k(x) \  \phi^{(test)}(x) \right)\  dx = 0 </div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;\mbox{ \ \ \ \ for $k=1,...,K$,}</div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;\f]</div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;for \e all test functions  \f$ \phi^{(test)}(x) \in H_0(D). \f$</div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;&lt;/CENTER&gt;</div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;&lt;/TD&gt;</div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;&lt;/TR&gt;</div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;&lt;/TABLE&gt;</div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;&lt;/CENTER&gt;</div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;\n\n</div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;We expand all unknown functions in terms of the same (global) </div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;shape functions</div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;\f[</div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;u^{(FE)}_k(x) = \sum_{j=1}^{N} U_{kj} \ \psi_j(x).</div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;\f]</div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;Galerkin&#39;s method then yields the discrete residuals</div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;  \f[ r_{kj} =  \int_0^1 \left\{</div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;  \sum_{l=1}^{N} U_{kl} \frac{\mbox{d} </div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;  \psi_l(x)}{\mbox{d} x}</div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;  \frac{\mbox{d} \psi_j(x)}{\mbox{d} x}\ </div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;  + f_k(x) \  \psi_j(x) \right\} dx \mbox{\ \ \ \ \ </div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;  \ for $i=2,...,N-1,$ \ \ and $k=1,...,K,$  } \f]</div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;and, as before, we obtain one algebraic equation \f$r_{kj} \f$</div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;for each of the \f$ (N-2)\times K \f$ unknown coefficients</div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;\f$U_{kj}\f$ whose values are not fixed by the boundary conditions.</div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;The finite element solution of these equations can easily be</div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;derived by modifying algorithm @RA[P1_Newton6]@ so that</div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;- every Node stores \f$ K \f$ values (rather than a single scalar).</div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;- the local and global equation numbering schemes are</div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;  modified to generate a linear numbering scheme for the </div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;  the doubly-indexed unknowns and equations.</div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;.</div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;For this purpose we represent the (global) equation number </div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;of nodal value \f$ k \f$ at node \f$ j \f$ by \f$ {\cal E}(j,k)\f$</div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;and denote the number of nodal values that are stored at node \f$ j \f$ by </div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;\f$ {\cal N}(j)\f$.  As before, we reflect the fact that nodal </div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;values are pinned by setting their global equation number to -1. </div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;The implementation only requires a few straightforward</div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;changes to Algorithm @RA[P1_Newton6]@ </div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;\n \n</div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;&lt;TABLE BORDER=&quot;1&quot;&gt;</div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;&lt;TR&gt;</div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;&lt;TD WIDTH=&quot;50%&quot; VALIGN=&quot;TOP&quot;&gt;</div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;&lt;CENTER&gt; &lt;B&gt; Revised Phase 1c: &quot;Pin&quot; nodal values with essential (Dirichlet) </div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;     boundary conditions&lt;/B&gt;&lt;/CENTER&gt;  \n</div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;- Loop over all global nodes \f$ j \f$ that are located </div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;  on Dirichlet boundaries:</div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;  - &lt;TABLE BORDER=0&gt;</div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;    &lt;TR&gt;</div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;    &lt;TD bgcolor=&quot;cornsilk&quot;&gt;</div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;    Determine the number of values stored at this node, </div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;    \f$ {\cal N}(j) \f$.</div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;    &lt;/TD&gt;</div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;    &lt;/TR&gt;</div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;    &lt;/TABLE&gt;</div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;    - &lt;TABLE BORDER=0&gt;</div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;      &lt;TR&gt;</div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;      &lt;TD bgcolor=&quot;cornsilk&quot;&gt;</div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;      Loop over the nodal values, \f$k=1,...,{\cal N}(j)\f$: </div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;      &lt;/TD&gt;</div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;      &lt;/TR&gt;</div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;      &lt;/TABLE&gt;</div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;    - Assign a negative equation number to reflect the node&#39;s &quot;pinned&quot; </div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;      status:</div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;      \f[ {\cal E}(j,k) = -1 \f]</div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;&lt;/TD&gt;</div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;&lt;/TR&gt;</div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;&lt;/TABLE&gt;</div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;\n</div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;and the  modifications (relative to the original version in Algorithm </div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;@RA[P1_Newton6]@) have been highlighted. </div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;The changes to Phase 1d (the provision of an initial guess for</div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;the unknowns and the application of the boundary conditions)</div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;should be obvious. The implementation of </div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;the global equation numbering scheme requires only one additional </div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;loop over the nodal values: </div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;&lt;TABLE BORDER=&quot;1&quot;&gt;</div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;&lt;TR&gt;</div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;&lt;TD WIDTH=&quot;50%&quot; VALIGN=&quot;TOP&quot;&gt;</div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;&lt;CENTER&gt; &lt;B&gt; Revised Phase 1e: Set up the global equation numbers</div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;with multiple nodal values&lt;/B&gt;&lt;/CENTER&gt;  \n</div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;- Initialise the total number of unknowns, \f$M=0.\f$</div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;- Loop over all global nodes \f$j=1,...,N\f$:</div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;  - &lt;TABLE BORDER=0&gt;</div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;    &lt;TR&gt;</div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;    &lt;TD bgcolor=&quot;cornsilk&quot;&gt;</div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;    Determine the number of values stored at this node, </div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;    \f$ {\cal N}(j) \f$.</div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;    &lt;/TD&gt;</div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;    &lt;/TR&gt;</div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;    &lt;/TABLE&gt;</div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;    - &lt;TABLE BORDER=0&gt;</div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;      &lt;TR&gt;</div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;      &lt;TD bgcolor=&quot;cornsilk&quot;&gt;</div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;      Loop over the nodal values, \f$k=1,...,{\cal N}(j)\f$: </div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;      &lt;/TD&gt;</div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;      &lt;/TR&gt;</div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;      &lt;/TABLE&gt;</div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;      - If nodal value k is not pinned</div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;        (i.e. if \f$ {\cal E}(j,k) \ne -1 \f$) </div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;        - Increment the number of unknowns</div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;          \f[ M=M+1 \f]</div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;        - Assign the global equation number</div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;          \f[ {\cal E}(j,k) = M \f]</div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;&lt;/TD&gt;</div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;&lt;/TR&gt;</div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;&lt;/TABLE&gt;</div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;\n</div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;This is the form in </div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;which the global equation numbering procedure is  </div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;implemented in \c Problem::assign_eqn_numbers(); [Actually, </div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;this function implements a few additional extensions that we will</div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;discuss in sections \ref discontinuous_interpolations and \ref</div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;solids_lagrange.]</div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160; </div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;While the global equation numbering scheme is generic and</div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;therefore fully implemented in \c oomph-lib, the </div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;local equation numbering scheme</div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;and the corresponding assembly of the elements&#39; </div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;residual vectors and Jacobians needs to implemented differently</div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;for each specific element. Here is an illustration of the</div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;revisions to the relevant phases of Algorithm  @RA[P1_Newton6]@:</div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160; </div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160; &lt;TABLE BORDER=&quot;1&quot;&gt;</div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160; &lt;TR&gt;</div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160; &lt;TD&gt;</div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160; &lt;B&gt; Revised Phase 1f: Set up the local equation numbering scheme&lt;/B&gt; </div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;- Loop over the elements  \f$ e=1,...,N_e \f$</div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;  - Initialise the counter for the number of degrees of </div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;    freedom in this element, \f$ j_{dof}=0 \f$.</div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;  - Loop over the element&#39;s local nodes \f$ j_{local}=1,...,n\f$</div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;    - Determine the global node number </div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;      \f$ j_{global} = {\cal J}(j_{local},e) \f$</div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;    - &lt;TABLE BORDER=0&gt;</div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;      &lt;TR&gt;</div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;      &lt;TD bgcolor=&quot;cornsilk&quot;&gt;</div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;      Determine the number of values stored at this node, </div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;      \f$ {\cal N}(j_{local}) \f$.</div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;      &lt;/TD&gt;</div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;      &lt;/TR&gt;</div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;      &lt;/TABLE&gt;</div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;      - &lt;TABLE BORDER=0&gt;</div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;        &lt;TR&gt;</div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;        &lt;TD bgcolor=&quot;cornsilk&quot;&gt;</div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;        Loop over the nodal values, \f$k=1,...,{\cal N}(j_{local})\f$: </div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;        &lt;/TD&gt;</div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;        &lt;/TR&gt;</div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;        &lt;/TABLE&gt;</div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;        - Determine the global equation number \f${\cal E}(j_{global},k)\f$</div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;        - If  \f${\cal E}(j_{global},k) \ne -1\f$:</div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;          - Increment the number of degrees of </div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;            freedom in this element \f$ j_{dof}=j_{dof}+1\f$</div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;          - Add the entry to the lookup scheme that relates</div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;            local and global equation numbers, </div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;            \f$ \widehat{\cal E}(j_{dof},e) = {\cal E}(j_{global})\f$</div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;          - Store the local equation number associated with the</div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;            current nodal value at the current local node</div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;            \f$ {\cal L}(j_{local},k,e) = j_{dof}\f$</div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;          .</div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;        - Else</div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;          - Set the local equation number associated with the</div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;            current nodal value at the current node to -1 to</div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;            indicate that it is pinned</div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;            \f$ {\cal L}(j_{local},k,e) = -1 \f$</div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;          .</div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;        .</div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;      .</div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;    .</div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;  - Assign the number of degrees of freedom in the element</div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;    \f$ {\cal N}_{dof}(e)=j_{dof} \f$</div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;&lt;/TD&gt;</div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;&lt;/TR&gt;</div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;&lt;/TABLE&gt;</div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160; </div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160; &lt;TABLE BORDER=&quot;1&quot;&gt;</div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160; &lt;TR&gt;</div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160; &lt;TD&gt;</div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;     &lt;CENTER&gt; &lt;B&gt; Revision of Phase 2a: Computation of the </div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;     element&#39;s residual vector and Jacobian matrix &lt;/B&gt;  &lt;/CENTER&gt;</div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;    \n</div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;  - Determine the number of degrees of freedom in this element,</div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;    \f$ n_{dof}={\cal N}_{dof}(e) \f$.</div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;  - Initialise the element residual vector, </div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;     \f$ r_{j}^{(e)}=0 \f$ for \f$j=1,...,n_{dof} \f$</div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;     and the element Jacobian matrix \f$ J_{jk}^{(e)}=0 \f$ </div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;     for \f$j,k=1,...,n_{dof} \f$</div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;  - Loop over the Gauss points \f$ i_{int}=1,...,N_{int}\f$</div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;    - Determine the local coordinate of the integration point</div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;      \f$ s = S_{i_{int}} \f$ and the associated weight \f$W_{i_{int}}.\f$</div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;    - Compute</div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;      - the global coordinate  \f$ x = x(s) \f$</div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;      - the source functions   \f$ f_k = f_k(x) =f_k(x(s))</div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;                               \mbox{\ \ \ $(k=1,...,K)$} \f$</div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;      - the derivatives \f$ \mbox{d} u_k/\mbox{d} x </div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;        \mbox{\ \ \ $(k=1,...,K)$}\f$ and </div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;      - the shape functions  \f$ \psi_j \f$ and their derivatives</div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;        \f$ \mbox{d} \psi_j/\mbox{d} x \f$</div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;      - the Jacobian of the mapping between local and global</div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;        coordinates, \f$ \widehat{\cal J} = \mbox{d} x/\mbox{d} s\f$</div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;      .</div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;    - Loop over the local nodes \f$ j_{local}=1,...,n \f$</div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;      - Determine the global node number </div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;        \f$ j_{global}={\cal J}(j_{local},e)\f$</div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;      - &lt;TABLE BORDER=0&gt;</div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;        &lt;TR&gt;</div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;        &lt;TD bgcolor=&quot;cornsilk&quot;&gt;</div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;        Determine the number of values stored at this node, </div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;        \f$ {\cal N}(j_{local}) \f$.</div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;        &lt;/TD&gt;</div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;        &lt;/TR&gt;</div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;        &lt;/TABLE&gt;</div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;      - &lt;TABLE BORDER=0&gt;</div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;        &lt;TR&gt;</div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;        &lt;TD bgcolor=&quot;cornsilk&quot;&gt;</div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;        Loop over the nodal values, \f$k=1,...,{\cal N}(j_{local})\f$: </div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;        &lt;/TD&gt;</div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;        &lt;/TR&gt;</div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;        &lt;/TABLE&gt;</div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;        - Determine the global equation number </div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;          \f$ {\cal E}( j_{global},k) \f$</div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;        - If  \f$ {\cal E}( j_{global},k) \ne -1 \f$</div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;          - Determine the local equation number from the element&#39;s</div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;            lookup scheme, \f$ i_{dof} = {\cal L}(j_{local},k,e) \f$.</div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;          - Add the contribution to the element&#39;s residual vector</div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;            \f[ r_{i_{dof}}^{(e)} = r_{i_{dof}}^{(e)} +</div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;            \left( \frac{\mbox{d} </div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;            u_k}{\mbox{d} x} \ </div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;            \frac{\mbox{d} \psi_{j_{local}}}{\mbox{d} x} + </div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;            f_k \  \psi_{j_{local}} \right) </div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;            \widehat{\cal J}\  W_{i_{int}} \f]</div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;            - Loop over the local nodes \f$ k_{local}=1,...,n \f$</div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;              - Determine the global node number </div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;                \f$ k_{global}={\cal J}(k_{local},e)\f$</div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;              - &lt;TABLE BORDER=0&gt;</div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;                &lt;TR&gt;</div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;                &lt;TD bgcolor=&quot;cornsilk&quot;&gt;</div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;                Determine the number of values stored at this node, </div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;                \f$ {\cal N}(k_{local}) \f$.</div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;                &lt;/TD&gt;</div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;                &lt;/TR&gt;</div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;                &lt;/TABLE&gt;</div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;              - &lt;TABLE BORDER=0&gt;</div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;                &lt;TR&gt;</div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;                &lt;TD bgcolor=&quot;cornsilk&quot;&gt;</div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;                Loop over the nodal values, </div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;                \f$m=1,...,{\cal N}(k_{local})\f$: </div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;                &lt;/TD&gt;</div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;                &lt;/TR&gt;</div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;                &lt;/TABLE&gt;</div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;                - Determine the global equation number </div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;                \f$ {\cal E}( k_{global},m) \f$</div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;                 - If  \f$ {\cal E}( k_{global},m) \ne -1 \f$</div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;                   - Determine the local equation number from the element&#39;s</div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;                     lookup scheme, \f$ j_{dof} = {\cal L}(k_{local},m,e) \f$.</div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;                   - Add the contribution to the element&#39;s Jacobian matrix</div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;                     \f[ J_{i_{dof}j_{dof}}^{(e)} = </div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;                         J_{i_{dof}j_{dof}}^{(e)} + </div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;                         \left( </div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;                         \frac{\mbox{d} \psi_{k_{local}}}{\mbox{d} x} \ </div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;                         \frac{\mbox{d} \psi_{j_{local}}}{\mbox{d} x}</div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;                         \right)</div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;                         \widehat{\cal J} \ W_{i_{int}}  \f]</div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;                  .</div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;                .</div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;              .</div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;            .</div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;          .</div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;        .</div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;      .</div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;    .</div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;    \n  \n   </div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;&lt;/TD&gt;</div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;&lt;/TR&gt;</div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;&lt;/TABLE&gt;</div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;\n</div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;Again, the modifications are straightforward. At each node</div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;we loop over the multiple nodal values; furthermore, we have added an</div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;additional index to the local equation numbering scheme, so that</div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;\f$ {\cal L}(j_{local},k,e)\f$ stores the local equation number</div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;of the \f$k\f$-th value at local node  \f$j_{local}\f$ in element \f$e\f$.</div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160; </div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;The example considered here is, of course, very simple. In fact, the</div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;\f$ K \f$ ODEs in Problem P3 are uncoupled and could (should!) </div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;have been solved independently. However, the </div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;algorithms developed above can be applied to any systems </div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;of PDEs in which the \f$ K \f$ differential operators have the same form. </div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;A more practically relevant example is given by the 3D Navier-Lame </div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;equations of linear elasticity:</div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;\f[</div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;\sum_{k=1}^3  \left[ (\lambda+\mu) </div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;\frac{\partial^2 u_k}{\partial x_k\partial x_i} + </div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;\mu \frac{\partial^2 u_i}{\partial x_k^2} \right]</div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;+ F_i =0 \mbox{\ \ \ \ $(i=1,...,3)$}</div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;\f]</div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;The local equation numbering scheme for these equations is </div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;identical to that for Problem P3 shown above. Only the computation</div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;of the element&#39;s residual vector and Jacobian matrix must  be</div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;changed. This is left as an exercise. </div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160; </div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160; </div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;&lt;B&gt;Implementation&lt;/B&gt; \n\n</div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160; </div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;To allow the object-oriented implementation of the above</div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;algorithms, each Node stores its nodal values in a vector. </div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;The number of values that need to be stored at the Node</div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;is provided as an argument to its constructor.</div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;The argument to the</div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;\c Node::value_pt(...) function identifies</div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;individual nodal values:</div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;\code</div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;unsigned i_value;</div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;double nodal_value = *(Node::value_pt(i_value));</div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;\endcode</div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;The Node object has a member function that returns the number</div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;of values stored,</div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;\code</div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;unsigned nvalues = Node::nvalue();</div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;\endcode</div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;and the global equation numbers of the individual nodal values </div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;are accessible via a Node member function</div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;\code</div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;unsigned i_value;</div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;unsigned i_eqn = Node::eqn_number(i_value);</div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;\endcode</div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;Finally, the nodal values&#39; pinned status can be obtained from</div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;\code</div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;unsigned i_value;</div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;bool pinned = Node::is_pinned(i_value);</div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;\endcode</div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;and nodal values are pinned/unpinned with</div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;\code</div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;unsigned i_value,j_value;</div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;Node::pin(i_value);</div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;Node::unpin(j_value);</div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;\endcode</div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;This finally provides the explanation for the mysterious argument</div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;that we had to provide to these functions in all previous</div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;examples: In a scalar problem, each Node only stores a single</div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;value whose index is &quot;0&quot;.</div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160; </div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;  One question still needs to be addressed, however. Nodes are</div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;usually created during the Mesh generation process. How does the</div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;Mesh constructor &quot;know&quot; how many values a given Node should store? </div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;Also, what should the spatial dimension of the newly created Node be?</div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;(Note that the spatial dimension of a Node is not necessarily the same</div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;as that of the Mesh: For instance, a 1D Mesh can be used to </div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;discretise a spatially one-dimensional Poisson equation, in which</div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;case each node must store a single (Eulerian) coordinate.</div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;However, the same Mesh could also be used to discretise a </div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;one-dimensional structural object, such as a beam, in a 3D Eulerian </div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;space, in which case each Node needs to store three (Eulerian)</div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;coordinates. </div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160; </div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;The example considered above shows that the number of </div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;values that are &quot;required&quot; at a given Node is determined by the </div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;system of equations that is being solved. This information becomes </div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;available when a specific system of equations is implemented in a specific</div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;FiniteElement. </div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;The FiniteElement class therefore provides the pure virtual member function</div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;\code</div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;FiniteElement::required_nvalue(...)</div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;\endcode</div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160; </div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;which returns the number of values required at a given local Node</div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;in the element. This function should be implemented for every specific</div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;FiniteElement. For a Poisson element (or any other element that implements</div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;the discretisation of a scalar PDE), the function should return 1; for an </div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;element that discretises the 3D Navier-Lame equations, the function</div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;should return 3; etc. Note that our implementation allows the possibility</div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;that different Nodes in an element require storage for different</div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;numbers of values, see \ref mixed_interpolation.</div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160; </div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;The required spatial dimension of the Node is, again, determined by each</div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;specific element and should be specified by calling the</div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;protected member function</div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;\code</div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;FiniteElement::set_nodal_dimension(...)</div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;\endcode</div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160; </div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;For instance, for an element that solves the 2D Poisson equation, this</div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;function must be called in the constructor with argument 2. </div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160; </div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;Using the element-specific information provided by these </div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;virtual FiniteElement member functions, the construction of a Node </div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;of the appropriate type can be performed by the function</div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;\code</div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;FiniteElement::construct_node(...)</div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;\endcode</div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160; </div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;This function performs the following tasks:</div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;- it creates a new Node, determining the arguments to the Node</div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;  constructor (spatial dimension, number of values, etc) </div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;  from the FiniteElement member functions just discussed.</div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;- it stores a pointer to the newly created Node in the element&#39;s</div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;  own lookup scheme.</div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;- it returns a pointer to the newly created Node so that it can be</div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;  added to the Mesh&#39;s storage scheme for Nodes. </div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;.</div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160; </div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;Here is a code fragment that illustrates the creation of Nodes during</div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;the mesh generation process. (Recall that specific Meshes are usually </div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;templated by the element type, so that a Mesh that was originally </div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;developed for the solution of a Poisson equation can also be used to </div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;solve the Navier-Stokes equations, say).</div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160; </div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;\code</div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;template&lt;class ELEMENT&gt;</div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;class SomeMesh : public Mesh</div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;{</div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160; </div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160; public:</div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;<span class="comment">  /// Mesh constructor</span></div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;<span class="comment"></span>  SomeMesh()</div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;   {</div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160; </div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;     // Create the first element (Note that element constructors </div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;     // never have any arguments, therefore this works</div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;     // for any type of element!)</div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;     ELEMENT* el_pt=new ELEMENT;</div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160; </div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;     // Add the (pointer to the) element to the Mesh&#39;s Element_pt</div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;     // vector</div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;     Element_pt.push_back(new ELEMENT);</div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160; </div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;     // How many nodes does the element have?</div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;     unsigned nnod=element_pt-&gt;nnode();</div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160; </div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;     // Loop over the nodes (we&#39;re creating the first element</div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;     // so all nodes are new)</div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;     for (unsigned j=0;j&lt;nnod;j++)</div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;       {</div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;        // Create the element&#39;s j-th local node,</div>
<div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;        // using the parameters (spatial dimension, number</div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;        // of values, etc) specified by  FiniteElement::required_ndim(...),</div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;        // FiniteElement::required_nvalue(...), etc.</div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;        // Also store a pointer to the newly created Node</div>
<div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;        // in the element&#39;s own lookup scheme for nodes</div>
<div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;        Node* nod_pt=element_pt-&gt;construct_node(j);</div>
<div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160; </div>
<div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;        // Add the newly created node to the Mesh&#39;s own storage scheme</div>
<div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;        Node_pt.push_back(nod_pt);</div>
<div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;       }</div>
<div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160; </div>
<div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160; </div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;      // Now do the subsequent elements</div>
<div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160; </div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;      [...]</div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160; </div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160; </div>
<div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;      // Assign the nodal coordinates</div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160; </div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;      [...]</div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160; </div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;   }</div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160; </div>
<div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;};</div>
<div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;\endcode</div>
<div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160; </div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160; </div>
<div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160; </div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;&lt;HR&gt;</div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160; </div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;\subsection mixed_interpolation Mixed interpolation</div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160; </div>
<div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;In the examples considered so far, each equation in the system of</div>
<div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;PDEs had the same structure and it was </div>
<div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;natural to use the same interpolation for all unknowns</div>
<div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;and the same test functions for each PDE in the system. However, </div>
<div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;there are many systems of PDEs whose constituent equations </div>
<div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;have different structures. As an example, we consider the </div>
<div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;steady 2D Navier-Stokes equations, which comprise the two momentum equations</div>
<div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;\f[</div>
<div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;Re \sum_{k=1}^2  u_k  \frac{\partial u_i}{\partial x_k} +</div>
<div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;\frac{\partial p}{\partial x_i} -  </div>
<div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;\sum_{k=1}^2 \frac{\partial^2 u_i}{\partial x_k^2} </div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160; =0 \mbox{\ \ \ \ $(i=1,...,2)$}</div>
<div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;\f]</div>
<div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;and the continuity equation</div>
<div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;\f[</div>
<div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;\sum_{k=1}^2  \frac{\partial u_k}{\partial x_k} =0.</div>
<div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;\f]</div>
<div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;The structure of the momentum equations differs from </div>
<div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;that of the continuity equation. Furthermore, the equations contain </div>
<div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;second derivatives of the two velocity components, </div>
<div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;\f$ u_i \ (i=1,...2),\f$ but only first derivatives of the </div>
<div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;pressure, \f$p\f$. </div>
<div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;This raises two important questions:</div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;- How should we define the weak form for this coupled problem? Should</div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;  we use the same class of test functions for both types of equations</div>
<div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;  or should we use a different class for each one?</div>
<div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;- How should we represent the two types of unknowns? Should we use</div>
<div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;  the same basis functions for the pressure and the velocity or should</div>
<div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;  we use a different type of interpolation for each one?</div>
<div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;. </div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;For a general system of PDEs, these are difficult questions which can only</div>
<div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;be answered by careful analysis of the governing</div>
<div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;equations. Luckily, in the case of the Navier-Stokes equations,</div>
<div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;the analysis is well-established and we refer</div>
<div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;to the standard literature [e.g. P.M. Gresho and R.L. Sani:</div>
<div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;&quot;Incompressible Flow and the Finite Element Method&quot; Vol. 1 and 2.</div>
<div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;Wiley (2000)] which provides several possible answers to these</div>
<div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;questions. &quot;Equal-order interpolations&quot;, in which the</div>
<div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;same shape functions are used to represent the pressure</div>
<div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;and the velocity components, are generally found to result</div>
<div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;in unstable elements. Most stable discretisations are</div>
<div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;based on &quot;mixed interpolations&quot; in which the velocity components are</div>
<div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;represented by one set of basis functions,</div>
<div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;\f[ </div>
<div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;u_i(x_k) = \sum_{j=1}^N U_{ij} \ \psi_j(x_k),\ \ \ \ \ \  (8)</div>
<div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;\f]</div>
<div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;and another set of basis functions, \f$ \psi^{(P)}_j(x_k) \ </div>
<div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;(j=1,...,N_P)\f$,  is employed to approximate the pressure</div>
<div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;\f[ </div>
<div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;p(x_k) = \sum_{j=1}^{N_P} P_j \ \psi^{(P)}_j(x_k). \ \ \ \ \  (9)</div>
<div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;\f]</div>
<div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;The number of nodes involved in the representation of</div>
<div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;the velocity, \f$N\f$, can (and usually does) differ from the</div>
<div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;number of nodes involved in the representation of the pressure,</div>
<div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;\f$N_P\f$.</div>
<div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160; </div>
<div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;Stability constraints (the infamous LBB *REFERENCE*condition) impose</div>
<div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;certain restrictions on the choice of basis functions. </div>
<div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;One well-known stable discretisation employs piecewise quadratic interpolations</div>
<div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;for the velocities and a piecewise linear interpolation for the</div>
<div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;pressure. The resulting elements are known as &quot;Taylor-Hood&quot; elements. </div>
<div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;When implemented as an isoparametric, 2D quadrilateral element, the </div>
<div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;element geometry and the velocity components are represented </div>
<div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;by the bi-quadratic local shape functions \f$ \psi_j(x_k)</div>
<div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;\ \ (j=1,...,9)\f$ which interpolate between the nodal values</div>
<div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;and coordinates of the element&#39;s \f$ n=9 \f$ local nodes. </div>
<div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;The pressure is represented in terms of the bilinear local shape functions, </div>
<div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;\f$ \psi^{(P)}_j(x_k) \ \ (j=1,...,4)\f$, which interpolate between </div>
<div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;pressure values at the element&#39;s  \f$ n_p=4 \f$ corner nodes, as </div>
<div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;shown in this sketch:</div>
<div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160; </div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;\image html taylor_hood.gif &quot;Velocity (blue) and pressure (red) nodes in a quadrilateral Taylor-Hood &quot; </div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;\image latex taylor_hood.eps &quot;Velocity (blue) and pressure (red) nodes in a quadrilateral Taylor-Hood &quot; width=0.35\textwidth</div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160; </div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;In this case, the number of nodal values is not the same for each</div>
<div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;node: the corner nodes store two velocity components and one pressure;</div>
<div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;all other nodes only store the two velocity components.</div>
<div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160; </div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160; The weak form of the Navier-Stokes equations is obtained by</div>
<div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;using the pressure shape functions \f$ \psi^{(P)}_j(s_k)\f$ as the</div>
<div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;test functions for the continuity equation and the velocity shape</div>
<div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;functions to test the momentum equations. Upon performing the</div>
<div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;usual integration by parts and using the divergence</div>
<div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;theorem (Exercise!), the (global) residuals</div>
<div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;are then given by</div>
<div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;\f[</div>
<div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;f_{il} = \int_D  \left[</div>
<div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;\left( Re \sum_{k=1}^2  u_k  \frac{\partial u_i}{\partial x_k} \right)</div>
<div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;\psi_l - p \frac{\partial \psi_l}{\partial x_i} +  </div>
<div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;\sum_{k=1}^2 \frac{\partial u_i}{\partial x_k} </div>
<div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;             \frac{\partial \psi_l}{\partial x_k} \right] dV = 0,</div>
<div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;\ \ \ \ \ (10)</div>
<div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;\f]</div>
<div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;where we have ignored any boundary terms (hence, implying </div>
<div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;the velocity is prescribed along the entire domain boundary), </div>
<div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;and </div>
<div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;\f[</div>
<div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;f_{l}^{(P)} = \int_D  \left( \sum_{k=1}^2</div>
<div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160; \frac{\partial u_k}{\partial x_k} \right) \psi^{(P)}_l  dV = 0.</div>
<div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;\ \ \ \ \ (11)</div>
<div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;\f]</div>
<div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;The system of nonlinear algebraic equations (10)</div>
<div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;provides one equation, \f$ f_{il} \f$, for each velocity</div>
<div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;component \f$ (i=1,2) \f$ at those nodes \f$(l=1,...,N)\f$ where</div>
<div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;the velocity is not prescribed by a Dirichlet boundary condition.</div>
<div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;The weak continuity equations (11) provides </div>
<div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;the remaining  equations \f$ f_{l}^{(P)} =0 \f$ for the</div>
<div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;pressure values  \f$ P_j \ (j=1,...,N_p)\f$ that are not prescribed.</div>
<div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;[Usually there are no boundary conditions for the pressure -- the</div>
<div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;pressure can only be set indirectly through applied-traction boundary </div>
<div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;conditions in which the normal component of the applied traction</div>
<div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;contains a contribution from the pressure and the viscous normal stresses; only</div>
<div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;if the velocity is prescribed along the entire boundary is it legal,</div>
<div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;and, in fact, necessary,  to pin a single pressure value.]</div>
<div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160; </div>
<div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;&lt;B&gt;Implementation&lt;/B&gt; \n\n</div>
<div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160; </div>
<div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;The implementation of an element with continuous </div>
<div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;mixed interpolation is straightforward:</div>
<div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;- The function \c FiniteElement:required_nvalue(...) needs to specify</div>
<div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;  the required number of values for each node.</div>
<div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;- The element can &quot;recycle&quot; the geometric shape functions to implement</div>
<div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;  the isoparametric representation of the velocity components. </div>
<div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;- The element needs to define another set of basis functions </div>
<div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;  which is used to represent the pressure.  </div>
<div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;- The local equation numbering scheme needs to be augmented to </div>
<div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;  include the pressure degrees of freedom. </div>
<div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;.</div>
<div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160; </div>
<div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;&lt;HR&gt;</div>
<div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160; </div>
<div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160; </div>
<div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;\subsection discontinuous_interpolation Discontinuous interpolation -- &quot;Internal Data&quot;</div>
<div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160; </div>
<div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;The choice of basis functions in Taylor-Hood-type Navier-Stokes elements</div>
<div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;appears to be perfectly natural. The bi-quadratic interpolation of the velocity</div>
<div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;components between the element&#39;s nodal values enforces the inter-element </div>
<div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;continuity of the velocity, which ensures that the integrals in</div>
<div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;(10) &quot;make sense&quot;. The LBB constraint requires the </div>
<div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;use of a lower-order representation for the pressure; the &quot;obvious&quot;</div>
<div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;choice is bilinear </div>
<div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;interpolation between the pressure values at the four corner nodes,</div>
<div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;which also ensures inter-element continuity of the</div>
<div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;pressure. An</div>
<div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;inspection of the weak form of the Navier-Stokes equations, </div>
<div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;(10) and (11),</div>
<div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;shows that this is not strictly required because the integration by parts has</div>
<div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;removed the derivatives on the pressure. Hence the weak form &quot;makes</div>
<div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;sense&quot; even if the pressure is globally discontinuous. This suggests the</div>
<div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;use of different types of basis functions for the representation of</div>
<div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;the pressure. An example is given by the Crouzeix-Raviart Navier-Stokes </div>
<div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;elements in which the pressure within each element is represented </div>
<div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;by the three basis functions</div>
<div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;\f[</div>
<div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;\psi_1^{(P)}(s_1,s_2) = 1,\ \ \ \ \ \  </div>
<div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;\psi_2^{(P)}(s_1,s_2) = s_1,\ \ \ \ \ \  </div>
<div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;\psi_3^{(P)}(s_1,s_2) = s_2,</div>
<div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;\f]</div>
<div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;so that the pressure in element \f$ e \f$ is given by the complete</div>
<div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;linear polynomial,</div>
<div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;\f[</div>
<div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;p(s_1,s_2) = \sum_{j_p=1}^3 P_{j_p e}  \ \psi_j^{(P)}(s_1,s_2).</div>
<div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;\f]</div>
<div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;In this representation, the discrete pressure values,</div>
<div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;\f$P_{j_p e}\f$, are not associated with any Nodes -- instead,</div>
<div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;they represent &quot;internal&quot; data for each individual element.</div>
<div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160; </div>
<div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;&lt;B&gt;Implementation&lt;/B&gt; \n\n</div>
<div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160; </div>
<div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;To facilitate the implementation of discontinuous interpolations</div>
<div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;we introduce two modifications to our data structure:</div>
<div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;-# We split the \c Node class into two separate classes:</div>
<div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;   - The base class \c Data which contains only the &quot;values&quot;</div>
<div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;     and their global equation numbers.</div>
<div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;   - The derived class \c Node which inherits from \c Data and</div>
<div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;     adds the additional functionality that is required by actual Nodes</div>
<div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;     (storage for the Eulerian coordinates and the associated </div>
<div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;     access functions).</div>
<div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;-# Each FiniteElement provides storage for &quot;Internal Data&quot; in</div>
<div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;   a vector of (pointers to) \c Data objects. By default, the </div>
<div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;   vector of &quot;Internal</div>
<div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;   Data&quot; is a vector of zero length. Specific FiniteElements</div>
<div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;   can resize this vector in their constructor to provide a sufficient</div>
<div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;   amount of storage for their Internal Data (if they require any).</div>
<div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;   Internal Data is included in the</div>
<div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;   global equation numbering procedure by providing </div>
<div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;   the function \c FiniteElement::assign_internal_eqn_numbers()</div>
<div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;   which allocates distinct global equation numbers to all values</div>
<div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;   that are stored in the element&#39;s &quot;Internal Data&quot;. the</div>
<div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;   function is executed for each element when the global equation </div>
<div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;   numbers are assigned by \c Problem::assign_eqn_numbers(). </div>
<div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;.</div>
<div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160; </div>
<div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;&lt;HR&gt;</div>
<div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160; </div>
<div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;\subsection higher_order_pdes Higher-order PDEs -- Hermite interpolants</div>
<div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160; </div>
<div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;All the examples considered so far involved second-order PDEs</div>
<div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;whose weak form could be integrated by parts. Therefore we only needed</div>
<div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;to evaluate integrals that involve first derivatives</div>
<div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;of the basis functions. Such integrals can be evaluated</div>
<div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;for basis functions that are globally continuous but have</div>
<div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;e.g. discontinuous first derivatives at isolated points (at the</div>
<div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;element boundaries). The piecewise</div>
<div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;linear/quadratic/... (global) finite-element shape functions </div>
<div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;introduced in section \ref fe_basis_fct</div>
<div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;satisfied these criteria. Since these representation of the function</div>
<div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;with these shape functions implements a (Lagrange) interpolation </div>
<div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;between the nodal values, such finite elements are often referred</div>
<div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;to as Lagrange finite elements. </div>
<div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160; </div>
<div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;Let us now consider the fourth-order problem </div>
<div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;\f[ \frac{\mbox{d}^4 u(x)}{\mbox{d} x^4} = f(x)  \mbox{ \ \ \</div>
<div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;for $x\in[0,1]$\ \ \ \ \ \ \ \ \ (1)}  \f]</div>
<div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;subject to the essential boundary conditions</div>
<div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;\f[ u(0)=g_0, \ \  u(1)=g_1, \ \ </div>
<div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;\left. \frac{\mbox{d}u}{\mbox{d}x}\right|_{x=0}=h_0, \ \  </div>
<div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;\left.\frac{\mbox{d}u}{\mbox{d}x}\right|_{x=1}=h_1,\f]</div>
<div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;where \f$f(x)\f$ and the constants \f$g_0,g_1,h_0\f$ and \f$h_1\f$ are</div>
<div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;given. </div>
<div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160; </div>
<div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;We define the weak form of (1) by requiring that the (weak) solution</div>
<div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;satisfies the essential boundary conditions and that the</div>
<div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;weighted residual</div>
<div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;\f[</div>
<div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;r = \int_0^1  \left( \frac{\mbox{d}^4 u(x)}{\mbox{d} x^4} - f(x) \right)</div>
<div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160; \phi^{(test)}(x) \ \mbox{d}x \ \ \ \ \ \ \ \ \ (2)</div>
<div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;\f]</div>
<div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;vanishes for all test functions  \f$ \phi^{(test)}(x) \f$ which satisfy</div>
<div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;the homogeneous boundary conditions</div>
<div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;\f[ \phi^{(test)}(0)=0, \ \  \phi^{(test)}(1)=0, \ \ </div>
<div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;\left. \frac{d\phi^{(test)}}{dx}\right|_{x=0}=0, \ \  </div>
<div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;\left.\frac{d\phi^{(test)}}{dx}\right|_{x=1}=0.</div>
<div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;\ \ \ \ \ \ \ \ \ (3) \f]</div>
<div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;We can integrate the weak form (2) twice by parts to obtain</div>
<div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;\f[</div>
<div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;r = \int_0^1  \left(</div>
<div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;    \frac{\mbox{d}^2 u(x)}{\mbox{d} x^2} </div>
<div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;    \frac{\mbox{d}^2 \phi^{(test)}(x)}{\mbox{d} x^2}</div>
<div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;     - f(x) \phi^{(test)}(x) \right) \ dx</div>
<div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;   \ \  + \ \ \left[ \left. \frac{\mbox{d}^3 u(x)}{\mbox{d} x^3} </div>
<div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;              \phi^{(test)}(x) \right] \right|_{0}^1</div>
<div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;   \ \  - \ \ \left[ \left. \frac{\mbox{d}^2 u(x)}{\mbox{d} x^2}</div>
<div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;       \frac{\mbox{d} \phi^{(test)}(x)}{\mbox{d} x} \right]</div>
<div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;      \right|_{0}^1.</div>
<div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;\f]</div>
<div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;As before, the boundary terms vanish because \f$ \phi^{(test)}(x)\f$  </div>
<div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;satisfies the homogeneous boundary conditions (3), and we obtain</div>
<div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;\f[</div>
<div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;r = \int_0^1  \left(</div>
<div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;    \frac{\mbox{d}^2 u(x)}{\mbox{d} x^2} </div>
<div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;    \frac{\mbox{d}^2 \phi^{(test)}(x)}{\mbox{d} x^2}</div>
<div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;     - f(x) \phi^{(test)}(x) \right) \ \mbox{d}x \ \ \ \ \ \ \ \ \ (4).</div>
<div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;\f]</div>
<div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;We now follow the usual (Galerkin) procedure of</div>
<div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;expanding the solution \f$ u(x) \f$ and the test function </div>
<div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;\f$ \phi^{(test)}(x)\f$ in terms of</div>
<div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;the same set of basis functions \f$ \psi_j(x)\f$. The integral (4) shows</div>
<div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;that the basis functions now</div>
<div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;need to have square-integrable second derivatives, i.e. </div>
<div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;we have to require that \f$ \psi_j(x) \in H^2_0(D)\f$ rather</div>
<div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;than  \f$ \psi_j(x) \in H^1_0(D)\f$ as in the case of the</div>
<div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;second-order problem P1. </div>
<div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;The Lagrange interpolants that are generated by piecewise</div>
<div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;linear or quadratic finite element shape functions are not members</div>
<div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;of  \f$ H^2_0(D)\f$ because their first derivatives are discontinuous between</div>
<div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;elements. </div>
<div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160; </div>
<div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;Basis functions of sufficient differentiability can be</div>
<div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;constructed by Hermite interpolation. For this  purpose we introduce</div>
<div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;two different types of basis functions:</div>
<div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;- Basis functions of type 1 provide an interpolation between the</div>
<div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;  nodal values and thus satisfy the conditions</div>
<div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;  \f[ \psi_{j1}(X_k) = \delta_{jk}, \f]</div>
<div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;  implying that they are equal to one at exactly \e one node while they </div>
<div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;  vanish at all others. Furthermore, these basis functions satisfy</div>
<div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;  \f[ \left. \frac{\mbox{d}\psi_{j1}}{\mbox{d}x} \right|_{X_k} = 0 </div>
<div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;  \mbox{\ \ for $j,k=1,...,N$}, \f]</div>
<div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;  so that their derivatives vanish at \e all nodal points.</div>
<div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;- Basis functions of type 2 provide an independent interpolation</div>
<div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;  for the derivatives of the function and thus satisfy the conditions</div>
<div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;  \f[ \left. \frac{\mbox{d}\psi_{j2}}{\mbox{d}x} \right|_{X_k} = \delta_{jk} , \f]</div>
<div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;  implying that their derivative is equal to one at exactly </div>
<div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;  \e one nodal point and zero at all others. Furthermore, these</div>
<div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;  basis functions satisfy</div>
<div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;  \f[ \psi_{j2}(X_k) = 0 \mbox{\ \ for $j,k=1,...,N$}, \f]</div>
<div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;  so that they vanish at \e all nodal points.</div>
<div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160; </div>
<div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;The global Hermite shape functions are illustrated in this sketch:</div>
<div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160; </div>
<div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;\image html 1Dmesh_with_hermite_shape_fcts.gif &quot;1D Hermite shape &quot; </div>
<div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;\image latex 1Dmesh_with_hermite_shape_fcts.eps &quot;1D Hermite shape &quot; width=0.75\textwidth</div>
<div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160; </div>
<div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;The global Hermite shape functions have local equivalents which are</div>
<div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;again expressed in terms of a local coordinate \f$s \in [0,1]\f$</div>
<div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;(note that the coordinate range differs from that for the Lagrange </div>
<div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;elements) as</div>
<div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160; </div>
<div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;\todo ***ANDREW SHOULD WE CHANGE THE RANGE TO [-1,1] ?? ***</div>
<div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160; </div>
<div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;\f[ \psi_{11}(s) =  2s^3 - 3s^2 + 1 \f]</div>
<div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;\f[ \psi_{12}(s) = s^3 - 2s^2 + s \f]</div>
<div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;\f[ \psi_{21}(s) = 3s^2 - 2s^3 \f]</div>
<div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;\f[ \psi_{22}(s) = s^3 - s^2. \f]</div>
<div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160; </div>
<div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;The shape functions for [-1,1] are</div>
<div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;\f[ \psi_{11}(s) =  \frac{1}{4}\left(s^3 - 3s + 2\right) \f]</div>
<div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;\f[ \psi_{12}(s) = \frac{1}{4}\left(s^3 - s^2 - s + 1 \right) \f]</div>
<div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;\f[ \psi_{21}(s) = \frac{1}{4}\left(2 + 3s - s^3\right) \f]</div>
<div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;\f[ \psi_{22}(s) = \frac{1}{4}\left(s^3 + s^2 - s - 1\right). \f]</div>
<div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160; </div>
<div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;Using these shape functions we can represent the unknown function \f$ u \f$ </div>
<div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;in element \f$e\f$ as</div>
<div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;\f[ u = \sum_{j=1}^2  \sum_{k=1}^2 U_{{\cal J}(j,e)k}\ \psi_{jk}(s), \f]</div>
<div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;where each node now stores two &quot;types&quot; of degree of freedom: \f$U_{j1} \f$</div>
<div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;represents the nodal value at node \f$ j \f$ and  \f$U_{j2} \f$ represents</div>
<div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;(a measure of) the derivative of the function at that node.  </div>
<div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;In isoparametric elements, </div>
<div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;the same shape functions are used to represent the mapping </div>
<div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;between \f$x\f$ and \f$ s\f$ so we have</div>
<div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;\f[ x(s) = \sum_{j=1}^2  \sum_{k=1}^2 X_{{\cal J}(j,e)k}\ \psi_{jk}(s). \f]</div>
<div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;Here  \f$X_{j1} \f$ represents the \f$x\f$ coordinate of nodal point</div>
<div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;\f$j\f$. We refer to the coefficients \f$X_{j2} \f$ as &quot;generalised</div>
<div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;coordinates&quot;. During the mesh-generation process the values of</div>
<div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;these generalised coordinates must be chosen such that the</div>
<div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;mapping \f$ x(s)\f$ is one-to-one over the entire element.</div>
<div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160; </div>
<div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;&lt;HR&gt;</div>
<div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160; </div>
<div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160; </div>
<div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;\subsection hyperbol_parabol_timestep Parabolic and hyperbolic problems -- timestepping</div>
<div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160; </div>
<div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;The PDEs discussed so far were all of elliptic type. However,</div>
<div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;the finite element method can also be used for the (semi-)discretisation</div>
<div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;of parabolic and hyperbolic problems. We will demonstrate</div>
<div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;this by considering the two classical examples of</div>
<div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;these equations: i) the unsteady heat equation and ii) the wave equation.</div>
<div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;\subsubsection unsteady_heat The unsteady heat equation</div>
<div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;The 2D unsteady heat equation is given by </div>
<div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;\f[</div>
<div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;\sum_{k=1}^2 \frac{\partial^2 u(x_i,t)}{\partial x_k^2} </div>
<div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;= \frac{\partial u(x_i,t)}{\partial t} + f(x_i,t)</div>
<div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;\mbox{\ \ \ \ \ in $D$}</div>
<div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;\f]</div>
<div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;subject to the boundary condition</div>
<div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;\f[</div>
<div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;u\left(x_i^{\partial D}(\zeta),t\right) = g(\zeta,t) </div>
<div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;\ \ \ \ \ \ \ \ (12)</div>
<div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;\f]</div>
<div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;and the initial condition</div>
<div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;\f[</div>
<div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;u(x_i,t=t_0) = u^{(IC)}(x_i), \ \ \ \ \ \ \ \ (13)</div>
<div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;\f]</div>
<div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;for the given functions \f$ f(x_i,t), \ g(\zeta,t) \f$</div>
<div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;and \f$ u^{(IC)}(x_i)\f$.</div>
<div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;Superficially, the only difference between this parabolic problem</div>
<div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;and the elliptic Poisson problem P2 is the presence of the </div>
<div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;time-derivative on the RHS of the PDE and the fact that the</div>
<div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;boundary conditions and the source function are time-dependent. </div>
<div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;Motivated by this observation, we employ the same spatial discretisation</div>
<div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;as in the Poisson problem by writing</div>
<div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;\f[</div>
<div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;u(x_i,t) = \sum_{j=1}^N U_j(t) \ \psi_j(x_i)</div>
<div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;\f]</div>
<div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;where the coefficients  \f$ U_j(t) \f$ are now</div>
<div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;(continuous) functions of time \f$ t \f$. Following the</div>
<div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;usual procedures, we obtain the residuals</div>
<div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;\f[</div>
<div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;r_l(t) = \int_D \left[ \sum_{j=1}^N \left( U_j(t) </div>
<div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;\sum_{k=1}^2</div>
<div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;\frac{\partial \psi_j(x_i)}{\partial x_k} </div>
<div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;\frac{\partial \psi_l(x_i)}{\partial x_k} +</div>
<div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;\frac{\mbox{d} U_j(t)}{\mbox{d} t} \psi_j(x_i) \ \psi_l(x_i) \right) +</div>
<div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;f(x_i,t) \ \psi_l(x_i) \right] \mbox{d}x_1 \mbox{d}x_2 = 0 </div>
<div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;\ \ \ \ \ \ (14)</div>
<div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;\f]</div>
<div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;for all coefficients \f$ U_l(t) \f$ whose values are not determined</div>
<div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;by the boundary conditions. The residuals now form</div>
<div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;a system of ODEs, rather than a system of algebraic equations --</div>
<div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;the spatial discretisation has only achieved a semi-discretisation.</div>
<div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;We obtain the initial conditions for the unknown coefficients </div>
<div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;\f$ U_l(t) \f$ by evaluating (13) at the nodal</div>
<div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;positions</div>
<div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;\f[</div>
<div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;U_j(t=t_0) = u^{(IC)}(X_{ij})</div>
<div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;\ \ \ \ \ \ (15)</div>
<div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;\f]</div>
<div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;The solution of the initial-value problem defined by</div>
<div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;the system of first-order ODEs (14) and the </div>
<div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;initial conditions (15) can now be obtained by</div>
<div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;any ODE solver. Within \c oomph-lib we provide the implicit </div>
<div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;timesteppers from the BDF family as the default</div>
<div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;timesteppers for parabolic problems. In these schemes,</div>
<div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;the time-derivatives are approximated by</div>
<div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;\f[</div>
<div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;\frac{\mbox{d} U_j}{\mbox{d} t} \approx </div>
<div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;\sum_{\tau=0}^{N_{history}}  \left.^\tau U_j\right.  \left.^\tau W\right.</div>
<div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;\ \ \ \ \ \ \  (16)</div>
<div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;\f]</div>
<div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;where the values \f$ \left.^\tau U_j\right. \f$  represent</div>
<div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;the history of the nodal value \f$  U_j \f$, i.e. its values</div>
<div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;at current and previous (discrete) timesteps. </div>
<div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;If the time-integration is performed with a constant timestep</div>
<div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160; \f$ \Delta t \f$, we have</div>
<div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;\f[</div>
<div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160; \left.^\tau U_j\right. =  U_j(t-\tau \Delta t)</div>
<div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;\f]</div>
<div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;so \f$ \left.^0 U_j\right. \f$</div>
<div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;represents the (unknown) nodal value at the present time.</div>
<div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;The weights \f$ \left.^\tau W\right. \f$ are constants that depend</div>
<div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;only on the timestep \f$ \Delta t\f$.  And, yes, </div>
<div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;the \f$ \tau \f$ is a left superscript.</div>
<div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160; </div>
<div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;The different members of the BDF family are distinguished by the</div>
<div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;number of previous values used in the approximation (16).</div>
<div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;For the BDF1 scheme we have \f$ N_{history}=1\f$ with the</div>
<div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;weights</div>
<div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;\f[  </div>
<div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;\left.^0 W\right. = \frac{1}{\Delta t} \mbox{\ \ \ \ and \ \ \ }</div>
<div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;\left.^1 W\right. = - \frac{1}{\Delta t}</div>
<div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;\f]</div>
<div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;Inserting the weights into (16), we recover the </div>
<div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;classical first-order-accurate backward Euler scheme:</div>
<div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;\f[</div>
<div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;\frac{\mbox{d} U_j}{\mbox{d} t} \approx </div>
<div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;\frac{ \left.^0 U_j\right. -  \left.^1 U_j\right. }{\Delta t}</div>
<div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;\f]</div>
<div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;Similarly, in the BDF2 scheme we have \f$ N_{history}=2\f$ with the</div>
<div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;weights</div>
<div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;\f[  </div>
<div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;\left.^0 W\right. = \frac{3}{2\Delta t}, \ </div>
<div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;\left.^1 W\right. = - \frac{2}{\Delta t}\mbox{\ \ \ \ and \ \ \ }</div>
<div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;\left.^2 W\right. = \frac{1}{2\Delta t}</div>
<div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;\f]</div>
<div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;which yields the second-order backward Euler scheme:</div>
<div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;\f[</div>
<div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;\frac{\mbox{d} U_j}{\mbox{d} t} \approx </div>
<div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;\frac{ 3\left.^0 U_j\right. -  4 \left.^1 U_j\right.  +  </div>
<div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;1\left.^2 U_j\right. }{2\Delta t}</div>
<div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;\f]</div>
<div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;Inserting the approximations (16) for the time-derivatives</div>
<div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;into  (14) gives a system of algebraic </div>
<div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;equations </div>
<div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160; \f[</div>
<div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160; r_l = \int_D \left\{ \sum_{j=1}^N \left.^{0}U_j \right.  \left[</div>
<div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160; \sum_{k=1}^2 \left(</div>
<div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160; \frac{\partial \psi_j(x_i)}{\partial x_k} </div>
<div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160; \frac{\partial \psi_l(x_i)}{\partial x_k} \right) +</div>
<div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160; \left.^{0} W \right. </div>
<div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160; \psi_j(x_i) \ \psi_l(x_i) \right] +</div>
<div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160; \sum_{\tau=1}^{N_{history}} </div>
<div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160; \left.^{\tau} W \right.  \left.^{\tau} U_j\right. </div>
<div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160; f(x_i,t) \ \psi_l(x_i) \right\} dx_1 dx_2 = 0 </div>
<div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160; \ \ \ \ \ \ (17)</div>
<div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160; \f]</div>
<div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;that can be solved to determine the unknown values of the coefficients </div>
<div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;\f$ \left.^{0} U_j\right. =  U_j \f$ at the present time.</div>
<div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160; </div>
<div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;&lt;CENTER&gt; &lt;B&gt;Algorithm *** Timestepping&lt;/B&gt;&lt;/CENTER&gt;</div>
<div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;-# Set time \f$ t \f$ to its initial value, \f$ t=t_0. \f$</div>
<div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;-# Choose a timestep \f$\Delta t \f$.</div>
<div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;-# Compute the weights \f$ \left.^{\tau} W \right. \f$</div>
<div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;   for \f$ \tau=0,...,N_{history}\f$.</div>
<div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;-# Assign initial values for all history </div>
<div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;   values so that the initial conditions are satisfied</div>
<div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;   at  \f$ t=t_0 \f$.</div>
<div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;-# Move to the next timestep:</div>
<div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;   - Increase the value of the continuous time: </div>
<div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;     \f[</div>
<div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;     t=t+\Delta t</div>
<div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;     \f]</div>
<div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;   - Update the history values. For a BDF scheme, this</div>
<div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;     involves shifting the history values back by one</div>
<div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;     time level:</div>
<div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;     - Loop over the time levels backwards, \f$ \tau=N_{history},...,1 \f$</div>
<div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160;       \f[</div>
<div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160;       \left.^{\tau} U_j\right. = \left.^{\tau-1} U_j\right.</div>
<div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160;       \f]</div>
<div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160;     .</div>
<div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160;   - Update the nodal values of all nodes on the boundary according to the</div>
<div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160;     time-dependent boundary conditions (12).</div>
<div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160;   - Solve ((17)) (evaluating the</div>
<div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160;     source function at the present time \f$ t \f$) for the</div>
<div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160;     unknown nodal values \f$ \left.^{0} U_j\right. =  U_j \f$.</div>
<div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160;   - Document the solution.</div>
<div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;-# Go to *** for the next timestep.</div>
<div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160; </div>
<div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;A key step in this algorithm is the provision of</div>
<div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160;history values for the nodal values at \f$ t=t_0 \f$. Recall that the</div>
<div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;state of the system at this time is determined</div>
<div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160;by the initial condition (13) which determines</div>
<div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160;the values of \f$ \left.^{0} U_j\right. \f$. </div>
<div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160;The value of \f$ \left.^{1} U_j\right. \f$ is</div>
<div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;not determined by  (13) but could be obtained</div>
<div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;by solving (***) </div>
<div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160; </div>
<div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160;Before advancing to the next (=first) timestep, we shift</div>
<div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;this history values back therefore the initial value for</div>
<div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160; \f$ \left.^{0} U_j\right. \f$ is copied into </div>
<div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160;\f$ \left.^{1} U_j\right. \f$ and  \f$ \left.^{0} U_j\right. \f$</div>
<div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160;is regarded as an unknown -- we can (and usually do) retain its initial</div>
<div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160;value as the initial guess for the solution at \f$ t = t_0+\Delta t\f$.</div>
<div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160;If we timestepping is performed with a BDF1 scheme in which</div>
<div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;\f$ \left.^{1} U_j\right. \f$ is the only history value,</div>
<div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160;the scheme is therefore &quot;self-starting&quot; in the sense that</div>
<div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160;the provision of the initial conditions (13)</div>
<div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160;completely specify initial values for all required history</div>
<div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160;values. </div>
<div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160; </div>
<div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160;\subsubsection timestep_implementation Implementation</div>
<div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160;The implementation of timestepping procedures in \c oomph-lib</div>
<div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;is fairly straightforward</div>
<div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160; </div>
<div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;&lt;HR&gt;</div>
<div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160; </div>
<div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160;\subsection solids_lagrange Solid mechanics problems -- Lagrangian coordinates</div>
<div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;All problems discussed so far were formulated in an Eulerian frame,</div>
<div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;i.e. we assumed all unknowns to be functions of the spatially-fixed,</div>
<div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;Eulerian coordinates, \f$x_i \ (i=1,...,3)\f$, and of time, </div>
<div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160;\f$ t \f$. Many problems </div>
<div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;in solid mechanics are formulated more conveniently in terms of </div>
<div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160;body-attached, Lagrangian coordinates. In this section we will</div>
<div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;briefly review the essential concepts of nonlinear continuum mechanics</div>
<div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160;and present the principle of virtual displacements which forms the</div>
<div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160;basis for all large-displacement solid mechanics computations in \c oomph-lib.</div>
<div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160; </div>
<div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160;Throughout this section we will use the summation convention </div>
<div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160;so that repeated indices are assumed to be summed over the range</div>
<div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160;of the three spatial coordinates and all free indices range </div>
<div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160;from 1 to 3. We will retain the summation signs</div>
<div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160;for all other sums, such as sums over the nodes etc.</div>
<div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160; </div>
<div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160;\subsubsection geometry The geometry</div>
<div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160;The figure below introduces the essential geometrical concepts: </div>
<div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160;We employ a set of Lagrangian coordinates, \f$ \xi^i\f$, to</div>
<div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160;parametrise the (Eulerian) position vector to material points in the</div>
<div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160; body&#39;s undeformed position:</div>
<div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160;\f[</div>
<div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160;{\bf r} = {\bf r}(\xi^i).</div>
<div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;\f]</div>
<div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;The specific choice of the Lagrangian coordinates is </div>
<div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160;irrelevant for the subsequent development. For analytical studies, it is</div>
<div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160;advantageous to choose a body-fitted Lagrangian coordinate</div>
<div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160;system (as shown in the sketch) because this allows boundary</div>
<div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;conditions to be applied on iso-levels of the coordinates;</div>
<div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160;in computational studies, it is usually preferable to use a </div>
<div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160;coordinate system in which the governing equations are as compact</div>
<div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160;as possible. A cartesian coordinate system is best suited for this </div>
<div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160;purpose.</div>
<div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160; </div>
<div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160;We denote the tangent vectors to the coordinate lines \f$ \xi^i = const.\f$</div>
<div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160;in the undeformed configuration by</div>
<div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;\f[</div>
<div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160;{\bf g}_i = \frac{\partial {\bf r}}{\partial \xi^i}</div>
<div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160;\f]</div>
<div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160;and define the components of the covariant metric tensor via </div>
<div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160;the inner products</div>
<div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160;\f[</div>
<div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160;g_{ij} = {\bf g}_i \cdot {\bf g}_j.</div>
<div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160;\f]</div>
<div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160;This tensor defines the &quot;metric&quot; because the (square of the) infinitesimal </div>
<div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160;length, \f$ ds \f$, of a line element with coordinate increments </div>
<div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160;\f$ d\xi^i\f$ is given by</div>
<div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160;\f[</div>
<div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160;(ds)^2 = g_{ij} \  d\xi^i d\xi^j.</div>
<div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160;\f]</div>
<div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160;The volume of the infinitesimal parallelepiped formed by</div>
<div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160;the coordinate increments  \f$ d\xi^i\f$ is given by</div>
<div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160;\f[</div>
<div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160;dv = \sqrt{g} \ d\xi^1 d\xi^2 d\xi^3,</div>
<div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;\f]</div>
<div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;where </div>
<div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160;\f[</div>
<div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160;g = \det g_{ij}. </div>
<div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160;\f]</div>
<div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160; </div>
<div class="line"><a name="l02362"></a><span class="lineno"> 2362</span>&#160;\image html Lagrangian_coord.gif &quot;2D sketch of the Lagrangian coordinates. The Lagrangian coordinates parametrise the position vector to material points in the body. As the body deforms, the Lagrangian coordinates remain attached to the same material points and the coordinate lines become distorted. The change in the length of infinitesimal material line elements provides an objective measure of the body&#39;s &quot; </div>
<div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160;\image latex Lagrangian_coord.eps &quot;2D sketch of the Lagrangian coordinates. The Lagrangian coordinates parametrise the position vector to material points in the body. As the body deforms, the Lagrangian coordinates remain attached to the same material points and the coordinate lines become distorted. The change in the length of infinitesimal material line elements provides an objective measure of the body&#39;s &quot; width=0.75\textwidth</div>
<div class="line"><a name="l02364"></a><span class="lineno"> 2364</span>&#160;As the body deforms, the Lagrangian coordinates remain &quot;attached&quot; to the</div>
<div class="line"><a name="l02365"></a><span class="lineno"> 2365</span>&#160;same material points. The body&#39;s deformation can therefore be</div>
<div class="line"><a name="l02366"></a><span class="lineno"> 2366</span>&#160;described bt the vector field that specifies the position vectors </div>
<div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160;to material particles in the deformed configuration,</div>
<div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160;\f[</div>
<div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160;{\bf R} = {\bf R}(\xi^i).</div>
<div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160;\f]</div>
<div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160;As in the undeformed coordinate system, we  form the </div>
<div class="line"><a name="l02372"></a><span class="lineno"> 2372</span>&#160;tangent vectors to the deformed coordinate lines \f$ \xi^i = const.\f$</div>
<div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160;and denote them by</div>
<div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160;\f[</div>
<div class="line"><a name="l02375"></a><span class="lineno"> 2375</span>&#160;{\bf G}_i = \frac{\partial {\bf R}}{\partial \xi^i}.</div>
<div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160;\f]</div>
<div class="line"><a name="l02377"></a><span class="lineno"> 2377</span>&#160;The inner product of these vectors defines the metric tensor in </div>
<div class="line"><a name="l02378"></a><span class="lineno"> 2378</span>&#160;the deformed configuration</div>
<div class="line"><a name="l02379"></a><span class="lineno"> 2379</span>&#160;\f[</div>
<div class="line"><a name="l02380"></a><span class="lineno"> 2380</span>&#160;G_{ij} = {\bf G}_i \cdot {\bf G}_j</div>
<div class="line"><a name="l02381"></a><span class="lineno"> 2381</span>&#160;        = \frac{\partial {\bf R}}{\partial \xi^i} \cdot  </div>
<div class="line"><a name="l02382"></a><span class="lineno"> 2382</span>&#160;          \frac{\partial {\bf R}}{\partial \xi^j},</div>
<div class="line"><a name="l02383"></a><span class="lineno"> 2383</span>&#160;\f]</div>
<div class="line"><a name="l02384"></a><span class="lineno"> 2384</span>&#160;and we have equivalent relations for the lengths of line elements,</div>
<div class="line"><a name="l02385"></a><span class="lineno"> 2385</span>&#160;\f[</div>
<div class="line"><a name="l02386"></a><span class="lineno"> 2386</span>&#160;(dS)^2 = G_{ij} \  d\xi^i d\xi^j</div>
<div class="line"><a name="l02387"></a><span class="lineno"> 2387</span>&#160;\f]</div>
<div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160;and the volume of infinitesimal parallelepipeds,</div>
<div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160;\f[</div>
<div class="line"><a name="l02390"></a><span class="lineno"> 2390</span>&#160;dV = \sqrt{G} \ d\xi^1 d\xi^2 d\xi^3,</div>
<div class="line"><a name="l02391"></a><span class="lineno"> 2391</span>&#160;\f]</div>
<div class="line"><a name="l02392"></a><span class="lineno"> 2392</span>&#160;where</div>
<div class="line"><a name="l02393"></a><span class="lineno"> 2393</span>&#160;\f[</div>
<div class="line"><a name="l02394"></a><span class="lineno"> 2394</span>&#160;G = \det G_{ij}. </div>
<div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160;\f] </div>
<div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160;Since the metric tensors \f$ G_{ij }\f$ and \f$ g_{ij }\f$ provide </div>
<div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160;a measure of the length of </div>
<div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160;material line elements in the deformed and undeformed configurations,</div>
<div class="line"><a name="l02399"></a><span class="lineno"> 2399</span>&#160;respectively, their difference</div>
<div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160;\f[</div>
<div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160;\gamma_{ij} =  \frac{1}{2} (G_{ij} - g_{ij})  </div>
<div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160;\f]</div>
<div class="line"><a name="l02403"></a><span class="lineno"> 2403</span>&#160;provides an objective measure of the strain and is known as </div>
<div class="line"><a name="l02404"></a><span class="lineno"> 2404</span>&#160;the Green strain tensor. </div>
<div class="line"><a name="l02405"></a><span class="lineno"> 2405</span>&#160; </div>
<div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160;\subsubsection equilibrium Equilibrium and the Principle of Virtual Displacements</div>
<div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160; </div>
<div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160;Let us now assume that the body is subjected to</div>
<div class="line"><a name="l02409"></a><span class="lineno"> 2409</span>&#160;- an applied surface traction  \f$ {\bf t}   \f$ --</div>
<div class="line"><a name="l02410"></a><span class="lineno"> 2410</span>&#160;  a force per unit deformed surface area, applied on (part of) the</div>
<div class="line"><a name="l02411"></a><span class="lineno"> 2411</span>&#160;  body&#39;s deformed surface area \f$ A_{tract} \subset \partial V\f$,</div>
<div class="line"><a name="l02412"></a><span class="lineno"> 2412</span>&#160;- a body force \f$ {\bf f} \f$ --</div>
<div class="line"><a name="l02413"></a><span class="lineno"> 2413</span>&#160;  a force per unit volume of the undeformed (!) body [This can</div>
<div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160;  easily be expressed in terms of a force per unit deformed volume, </div>
<div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160; \f$ {\bf F }\f$, by invoking conservation of mass, which shows that</div>
<div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160; \f$ {\bf f } = \sqrt{G/g} \ {\bf F }\f$.],</div>
<div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160;. </div>
<div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160;while its displacements are prescribed on the remaining part of</div>
<div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160;the boundary, \f$ A_{displ}  \subset \partial V \f$ (where </div>
<div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160;\f$ A_{tract} \cap A_{displ}=0 \f$ and  \f$A_{tract} \cup A_{displ}</div>
<div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160;= \partial V\f$ ), so that</div>
<div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160;\f[</div>
<div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160;{\bf R}(\xi^k) = {\bf R}^{(BC)}(\xi^k) </div>
<div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160;\mbox{ \ \ \ \ on \ \ \ $ A_{displ},$ }</div>
<div class="line"><a name="l02425"></a><span class="lineno"> 2425</span>&#160;  \ \ \ \ \ \ \ \ (19)</div>
<div class="line"><a name="l02426"></a><span class="lineno"> 2426</span>&#160;\f]</div>
<div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160;where \f$ {\bf R}^{(BC)}(\xi^k) \f$ is given.</div>
<div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160;\image html Solid_boundary_conds.gif &quot;Sketch of the boundary conditions: The surface of the body is either subject to a prescribed traction or its displacement is &quot; </div>
<div class="line"><a name="l02429"></a><span class="lineno"> 2429</span>&#160;\image latex Solid_boundary_conds.eps &quot;Sketch of the boundary conditions: The surface of the body is either subject to a prescribed traction or its displacement is &quot; width=0.75\textwidth</div>
<div class="line"><a name="l02430"></a><span class="lineno"> 2430</span>&#160;The deformation is governed by the principle of virtual displacements</div>
<div class="line"><a name="l02431"></a><span class="lineno"> 2431</span>&#160;\f[</div>
<div class="line"><a name="l02432"></a><span class="lineno"> 2432</span>&#160;\int \left\{ \sigma^{ij}  \ \delta \gamma_{ij} -  \left( {\bf f} - </div>
<div class="line"><a name="l02433"></a><span class="lineno"> 2433</span>&#160; \rho \frac{\partial^2 {\bf R}}{\partial t^2} \right) \cdot </div>
<div class="line"><a name="l02434"></a><span class="lineno"> 2434</span>&#160; \delta {\bf R} \right\} \ dv -</div>
<div class="line"><a name="l02435"></a><span class="lineno"> 2435</span>&#160;  \oint_{A_{tract}} {\bf t} \cdot \delta {\bf R} \ dA =0,</div>
<div class="line"><a name="l02436"></a><span class="lineno"> 2436</span>&#160;  \ \ \ \ \ \ \ \ (20)</div>
<div class="line"><a name="l02437"></a><span class="lineno"> 2437</span>&#160; \f]</div>
<div class="line"><a name="l02438"></a><span class="lineno"> 2438</span>&#160; where \f$ \sigma^{ij} = \sigma^{ji}\f$ is the (symmetric) </div>
<div class="line"><a name="l02439"></a><span class="lineno"> 2439</span>&#160; second Piola-Kirchhoff stress tensor, \f$ \rho \f$ is the density, and</div>
<div class="line"><a name="l02440"></a><span class="lineno"> 2440</span>&#160; \f$ \delta (.) \f$ represents the variation of \f$ (.)\f$.</div>
<div class="line"><a name="l02441"></a><span class="lineno"> 2441</span>&#160; See, e.g., Green, A.E. \&amp; Zerna, W. &quot;Theoretical Elasticity&quot;, </div>
<div class="line"><a name="l02442"></a><span class="lineno"> 2442</span>&#160; Dover (1992); or Wempner, G. &quot;Mechanics of Solids with Applications </div>
<div class="line"><a name="l02443"></a><span class="lineno"> 2443</span>&#160; to Thin Bodies&quot;, Kluwer (1982) for more details.</div>
<div class="line"><a name="l02444"></a><span class="lineno"> 2444</span>&#160; </div>
<div class="line"><a name="l02445"></a><span class="lineno"> 2445</span>&#160; Upon choosing the particles&#39; position vector in the deformed </div>
<div class="line"><a name="l02446"></a><span class="lineno"> 2446</span>&#160; configuration, \f${\bf R}(\xi^j)\f$, as the unknown, the variation </div>
<div class="line"><a name="l02447"></a><span class="lineno"> 2447</span>&#160; of the strain tensor becomes</div>
<div class="line"><a name="l02448"></a><span class="lineno"> 2448</span>&#160; \f[</div>
<div class="line"><a name="l02449"></a><span class="lineno"> 2449</span>&#160; \delta \gamma_{ij} = \frac{1}{2} \left( </div>
<div class="line"><a name="l02450"></a><span class="lineno"> 2450</span>&#160;         \frac{\partial {\bf R}}{\partial \xi^i} \cdot  </div>
<div class="line"><a name="l02451"></a><span class="lineno"> 2451</span>&#160;         \delta \ \frac{\partial {\bf R}}{\partial \xi^j} +</div>
<div class="line"><a name="l02452"></a><span class="lineno"> 2452</span>&#160;         \frac{\partial {\bf R}}{\partial \xi^j} \cdot  </div>
<div class="line"><a name="l02453"></a><span class="lineno"> 2453</span>&#160;         \delta \ \frac{\partial {\bf R}}{\partial \xi^i}</div>
<div class="line"><a name="l02454"></a><span class="lineno"> 2454</span>&#160;       \right)</div>
<div class="line"><a name="l02455"></a><span class="lineno"> 2455</span>&#160; \f]</div>
<div class="line"><a name="l02456"></a><span class="lineno"> 2456</span>&#160; and we have</div>
<div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160; \f[</div>
<div class="line"><a name="l02458"></a><span class="lineno"> 2458</span>&#160;  \delta {\bf R}  = {\bf 0} \mbox{ \ \ \ \ on \ \ \ $ A_{displ}.$ }</div>
<div class="line"><a name="l02459"></a><span class="lineno"> 2459</span>&#160;  \ \ \ \ \ \ \ \ (21)</div>
<div class="line"><a name="l02460"></a><span class="lineno"> 2460</span>&#160; \f]</div>
<div class="line"><a name="l02461"></a><span class="lineno"> 2461</span>&#160; The 2nd Piola Kirchhoff stress tensor is symmetric, therefore</div>
<div class="line"><a name="l02462"></a><span class="lineno"> 2462</span>&#160; we can write the variation of the strain energy in</div>
<div class="line"><a name="l02463"></a><span class="lineno"> 2463</span>&#160; (20) as</div>
<div class="line"><a name="l02464"></a><span class="lineno"> 2464</span>&#160; \f[</div>
<div class="line"><a name="l02465"></a><span class="lineno"> 2465</span>&#160; \int  \sigma^{ij}  \ \delta \gamma_{ij} \ dv = </div>
<div class="line"><a name="l02466"></a><span class="lineno"> 2466</span>&#160; \int \sigma^{ij}  \ \frac{\partial {\bf R}}{\partial \xi^i} \cdot  </div>
<div class="line"><a name="l02467"></a><span class="lineno"> 2467</span>&#160;          \delta \ \frac{\partial {\bf R}}{\partial \xi^j} \ dv</div>
<div class="line"><a name="l02468"></a><span class="lineno"> 2468</span>&#160;  \f]</div>
<div class="line"><a name="l02469"></a><span class="lineno"> 2469</span>&#160; and obtain the displacement form of the principle of </div>
<div class="line"><a name="l02470"></a><span class="lineno"> 2470</span>&#160; virtual displacements:</div>
<div class="line"><a name="l02471"></a><span class="lineno"> 2471</span>&#160; \f[</div>
<div class="line"><a name="l02472"></a><span class="lineno"> 2472</span>&#160; \int \left\{ \sigma^{ij} \ \frac{\partial {\bf R}}{\partial \xi^i} \cdot  </div>
<div class="line"><a name="l02473"></a><span class="lineno"> 2473</span>&#160;          \delta \ \frac{\partial {\bf R}}{\partial \xi^j} </div>
<div class="line"><a name="l02474"></a><span class="lineno"> 2474</span>&#160;      - \left( {\bf f} - </div>
<div class="line"><a name="l02475"></a><span class="lineno"> 2475</span>&#160;  \rho \frac{\partial^2 {\bf R}}{\partial t^2} \right) \cdot </div>
<div class="line"><a name="l02476"></a><span class="lineno"> 2476</span>&#160; \delta {\bf R} \right\} \ dv </div>
<div class="line"><a name="l02477"></a><span class="lineno"> 2477</span>&#160; - \oint_{A_{tract}} {\bf t} \cdot \delta {\bf R} \ dA =0.</div>
<div class="line"><a name="l02478"></a><span class="lineno"> 2478</span>&#160; \f]</div>
<div class="line"><a name="l02479"></a><span class="lineno"> 2479</span>&#160;This needs to be augmented by a constitutive equation which</div>
<div class="line"><a name="l02480"></a><span class="lineno"> 2480</span>&#160;determines the stress as a function of the body&#39;s deformation,</div>
<div class="line"><a name="l02481"></a><span class="lineno"> 2481</span>&#160;(and possibly the history of its deformation). Here we will only</div>
<div class="line"><a name="l02482"></a><span class="lineno"> 2482</span>&#160;consider elastic behaviour, where the stress is only a function of the</div>
<div class="line"><a name="l02483"></a><span class="lineno"> 2483</span>&#160;strain.</div>
<div class="line"><a name="l02484"></a><span class="lineno"> 2484</span>&#160; </div>
<div class="line"><a name="l02485"></a><span class="lineno"> 2485</span>&#160;\subsubsection elastic_constitutive Constitutive Equations for Purely Elastic Behaviour</div>
<div class="line"><a name="l02486"></a><span class="lineno"> 2486</span>&#160;For purely</div>
<div class="line"><a name="l02487"></a><span class="lineno"> 2487</span>&#160;elastic behaviour, the stress is only a function of the</div>
<div class="line"><a name="l02488"></a><span class="lineno"> 2488</span>&#160;instantaneous, local strain and the constitutive equation</div>
<div class="line"><a name="l02489"></a><span class="lineno"> 2489</span>&#160;has the form</div>
<div class="line"><a name="l02490"></a><span class="lineno"> 2490</span>&#160;\f[</div>
<div class="line"><a name="l02491"></a><span class="lineno"> 2491</span>&#160;\sigma^{ij} =  \sigma^{ij} (\gamma_{kl}).</div>
<div class="line"><a name="l02492"></a><span class="lineno"> 2492</span>&#160;\f]</div>
<div class="line"><a name="l02493"></a><span class="lineno"> 2493</span>&#160; </div>
<div class="line"><a name="l02494"></a><span class="lineno"> 2494</span>&#160;The functional form of the constitutive equation is different</div>
<div class="line"><a name="l02495"></a><span class="lineno"> 2495</span>&#160;for compressible/incompressible/near-incompressible behaviour:</div>
<div class="line"><a name="l02496"></a><span class="lineno"> 2496</span>&#160;-# \b Compressible \b Behaviour: \n If the material is compressible,</div>
<div class="line"><a name="l02497"></a><span class="lineno"> 2497</span>&#160;   the stress can be computed directly from the deformed and undeformed</div>
<div class="line"><a name="l02498"></a><span class="lineno"> 2498</span>&#160;   metric tensors,</div>
<div class="line"><a name="l02499"></a><span class="lineno"> 2499</span>&#160;   \f[</div>
<div class="line"><a name="l02500"></a><span class="lineno"> 2500</span>&#160;  \sigma^{ij} = \sigma^{ij}(\gamma_{kl}) =  </div>
<div class="line"><a name="l02501"></a><span class="lineno"> 2501</span>&#160;  \sigma^{ij}\bigg( \frac{1}{2} (G_{kl} - g_{kl})\bigg).</div>
<div class="line"><a name="l02502"></a><span class="lineno"> 2502</span>&#160;  \f]</div>
<div class="line"><a name="l02503"></a><span class="lineno"> 2503</span>&#160;-# \b Incompressible \b Behaviour: \n If the material is incompressible,</div>
<div class="line"><a name="l02504"></a><span class="lineno"> 2504</span>&#160;   its deformation is constrained by the condition that</div>
<div class="line"><a name="l02505"></a><span class="lineno"> 2505</span>&#160;   \f[</div>
<div class="line"><a name="l02506"></a><span class="lineno"> 2506</span>&#160;   \det G_{ij} - \det g_{ij}= 0 </div>
<div class="line"><a name="l02507"></a><span class="lineno"> 2507</span>&#160;   \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (22) </div>
<div class="line"><a name="l02508"></a><span class="lineno"> 2508</span>&#160;   \f]</div>
<div class="line"><a name="l02509"></a><span class="lineno"> 2509</span>&#160;   which ensures that the volume of infinitesimal material</div>
<div class="line"><a name="l02510"></a><span class="lineno"> 2510</span>&#160;   elements remains constant during the deformation. This</div>
<div class="line"><a name="l02511"></a><span class="lineno"> 2511</span>&#160;   condition is typically enforced by a Lagrange multiplier which</div>
<div class="line"><a name="l02512"></a><span class="lineno"> 2512</span>&#160;   plays the role of a pressure. In such cases, the </div>
<div class="line"><a name="l02513"></a><span class="lineno"> 2513</span>&#160;   stress tensor has the form</div>
<div class="line"><a name="l02514"></a><span class="lineno"> 2514</span>&#160;   \f[</div>
<div class="line"><a name="l02515"></a><span class="lineno"> 2515</span>&#160;   \sigma^{ij} = -p G^{ij} + </div>
<div class="line"><a name="l02516"></a><span class="lineno"> 2516</span>&#160;   \overline{\sigma}^{ij}\big(\gamma_{kl}\big),</div>
<div class="line"><a name="l02517"></a><span class="lineno"> 2517</span>&#160;   \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (23)  </div>
<div class="line"><a name="l02518"></a><span class="lineno"> 2518</span>&#160;   \f]</div>
<div class="line"><a name="l02519"></a><span class="lineno"> 2519</span>&#160;   where only the deviatoric part of the stress tensor, </div>
<div class="line"><a name="l02520"></a><span class="lineno"> 2520</span>&#160;   \f$ \overline{\sigma}^{ij}, \f$ depends directly on the</div>
<div class="line"><a name="l02521"></a><span class="lineno"> 2521</span>&#160;   strain. The pressure \f$ p \f$ needs to be determined</div>
<div class="line"><a name="l02522"></a><span class="lineno"> 2522</span>&#160;   independently by enforcing the incompressibility constraint</div>
<div class="line"><a name="l02523"></a><span class="lineno"> 2523</span>&#160;   (22).</div>
<div class="line"><a name="l02524"></a><span class="lineno"> 2524</span>&#160;   Given the deformed and undeformed metric tensors,</div>
<div class="line"><a name="l02525"></a><span class="lineno"> 2525</span>&#160;   the computation of the stress tensor \f$ \sigma^{ij} \f$ </div>
<div class="line"><a name="l02526"></a><span class="lineno"> 2526</span>&#160;   for an incompressible</div>
<div class="line"><a name="l02527"></a><span class="lineno"> 2527</span>&#160;   material therefore requires the computation of the following quantities:</div>
<div class="line"><a name="l02528"></a><span class="lineno"> 2528</span>&#160;   - The deviatoric stress \f$ \overline{\sigma}^{ij} \f$</div>
<div class="line"><a name="l02529"></a><span class="lineno"> 2529</span>&#160;   - The contravariant deformed metric tensor  \f$ G^{ij} \f$</div>
<div class="line"><a name="l02530"></a><span class="lineno"> 2530</span>&#160;   - The determinant of the deformed </div>
<div class="line"><a name="l02531"></a><span class="lineno"> 2531</span>&#160;     metric tensor \f$ \det G_{ij} \f$ which </div>
<div class="line"><a name="l02532"></a><span class="lineno"> 2532</span>&#160;     is required in equation (22)</div>
<div class="line"><a name="l02533"></a><span class="lineno"> 2533</span>&#160;     whose solution determines the pressure.</div>
<div class="line"><a name="l02534"></a><span class="lineno"> 2534</span>&#160;   .</div>
<div class="line"><a name="l02535"></a><span class="lineno"> 2535</span>&#160;  \n</div>
<div class="line"><a name="l02536"></a><span class="lineno"> 2536</span>&#160;-# \b Nearly \b Incompressible \b Behaviour: \n If the material is nearly</div>
<div class="line"><a name="l02537"></a><span class="lineno"> 2537</span>&#160;   incompressible, it is advantageous to split the stress into</div>
<div class="line"><a name="l02538"></a><span class="lineno"> 2538</span>&#160;   its deviatoric and hydrostatic parts by writing the</div>
<div class="line"><a name="l02539"></a><span class="lineno"> 2539</span>&#160;   constitutive law in the form</div>
<div class="line"><a name="l02540"></a><span class="lineno"> 2540</span>&#160;   \f[</div>
<div class="line"><a name="l02541"></a><span class="lineno"> 2541</span>&#160;   \sigma^{ij} = -p G^{ij} + </div>
<div class="line"><a name="l02542"></a><span class="lineno"> 2542</span>&#160;   \overline{\sigma}^{ij}\big(\gamma_{kl}\big),</div>
<div class="line"><a name="l02543"></a><span class="lineno"> 2543</span>&#160;   \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (24)</div>
<div class="line"><a name="l02544"></a><span class="lineno"> 2544</span>&#160;   \f]</div>
<div class="line"><a name="l02545"></a><span class="lineno"> 2545</span>&#160;   where the deviatoric part of the stress tensor, </div>
<div class="line"><a name="l02546"></a><span class="lineno"> 2546</span>&#160;   \f$ \overline{\sigma}^{ij}, \f$ depends on the</div>
<div class="line"><a name="l02547"></a><span class="lineno"> 2547</span>&#160;   strain. This form of the constitutive</div>
<div class="line"><a name="l02548"></a><span class="lineno"> 2548</span>&#160;   law is identical to that of the incompressible</div>
<div class="line"><a name="l02549"></a><span class="lineno"> 2549</span>&#160;   case and it involves a pressure \f$ p \f$ which needs to be</div>
<div class="line"><a name="l02550"></a><span class="lineno"> 2550</span>&#160;   determined from an additional equation. In the </div>
<div class="line"><a name="l02551"></a><span class="lineno"> 2551</span>&#160;   incompressible case, this equation was given by the incompressibility</div>
<div class="line"><a name="l02552"></a><span class="lineno"> 2552</span>&#160;   constraint (22). Here, we need to augment </div>
<div class="line"><a name="l02553"></a><span class="lineno"> 2553</span>&#160;   the constitutive law for the deviatoric stress by</div>
<div class="line"><a name="l02554"></a><span class="lineno"> 2554</span>&#160;   an additional equation for the pressure. Generally this takes the</div>
<div class="line"><a name="l02555"></a><span class="lineno"> 2555</span>&#160;   form</div>
<div class="line"><a name="l02556"></a><span class="lineno"> 2556</span>&#160;   \f[</div>
<div class="line"><a name="l02557"></a><span class="lineno"> 2557</span>&#160;   p = \kappa \ d</div>
<div class="line"><a name="l02558"></a><span class="lineno"> 2558</span>&#160;   \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (25)</div>
<div class="line"><a name="l02559"></a><span class="lineno"> 2559</span>&#160;   \f]</div>
<div class="line"><a name="l02560"></a><span class="lineno"> 2560</span>&#160;   where \f$ \kappa \f$ is the &quot;bulk modulus&quot;, a material property</div>
<div class="line"><a name="l02561"></a><span class="lineno"> 2561</span>&#160;   that needs to be specified by the constitutive law.   </div>
<div class="line"><a name="l02562"></a><span class="lineno"> 2562</span>&#160;   \f$ d \f$ is the (generalised) dilatation, i.e. the relative change</div>
<div class="line"><a name="l02563"></a><span class="lineno"> 2563</span>&#160;   in the volume of an infinitesimal material element (or some</div>
<div class="line"><a name="l02564"></a><span class="lineno"> 2564</span>&#160;   suitable generalised quantity that is related to it). As the </div>
<div class="line"><a name="l02565"></a><span class="lineno"> 2565</span>&#160;   material approaches incompressibility, \f$ \kappa \to \infty\f$, so that</div>
<div class="line"><a name="l02566"></a><span class="lineno"> 2566</span>&#160;   infinitely large pressures would be required to achieve</div>
<div class="line"><a name="l02567"></a><span class="lineno"> 2567</span>&#160;   any change in volume. To facilitate the implementation of</div>
<div class="line"><a name="l02568"></a><span class="lineno"> 2568</span>&#160;   (25) as the equation for the pressure, we re-write </div>
<div class="line"><a name="l02569"></a><span class="lineno"> 2569</span>&#160;   it in the form</div>
<div class="line"><a name="l02570"></a><span class="lineno"> 2570</span>&#160;   \f[</div>
<div class="line"><a name="l02571"></a><span class="lineno"> 2571</span>&#160;   p \ \frac{1}{\kappa} -  d\big(g_{ij},G_{ij}\big) = 0</div>
<div class="line"><a name="l02572"></a><span class="lineno"> 2572</span>&#160;   \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (26) </div>
<div class="line"><a name="l02573"></a><span class="lineno"> 2573</span>&#160;   \f]</div>
<div class="line"><a name="l02574"></a><span class="lineno"> 2574</span>&#160;   which only involves quantities that remain finite </div>
<div class="line"><a name="l02575"></a><span class="lineno"> 2575</span>&#160;   as we approach true incompressibility.</div>
<div class="line"><a name="l02576"></a><span class="lineno"> 2576</span>&#160;   \n </div>
<div class="line"><a name="l02577"></a><span class="lineno"> 2577</span>&#160;   Given the deformed and undeformed metric tensors,</div>
<div class="line"><a name="l02578"></a><span class="lineno"> 2578</span>&#160;   the computation of the stress tensor \f$ \sigma^{ij} \f$ </div>
<div class="line"><a name="l02579"></a><span class="lineno"> 2579</span>&#160;   for a nearly incompressible</div>
<div class="line"><a name="l02580"></a><span class="lineno"> 2580</span>&#160;   material therefore requires the computation of the following quantities:</div>
<div class="line"><a name="l02581"></a><span class="lineno"> 2581</span>&#160;   - The deviatoric stress \f$ \overline{\sigma}^{ij} \f$</div>
<div class="line"><a name="l02582"></a><span class="lineno"> 2582</span>&#160;   - The contravariant deformed metric tensor  \f$ G^{ij} \f$</div>
<div class="line"><a name="l02583"></a><span class="lineno"> 2583</span>&#160;   - The generalised dilatation \f$ d \f$</div>
<div class="line"><a name="l02584"></a><span class="lineno"> 2584</span>&#160;   - The inverse of the bulk modulus \f$ \kappa \f$</div>
<div class="line"><a name="l02585"></a><span class="lineno"> 2585</span>&#160;   .</div>
<div class="line"><a name="l02586"></a><span class="lineno"> 2586</span>&#160;  \n</div>
<div class="line"><a name="l02587"></a><span class="lineno"> 2587</span>&#160; </div>
<div class="line"><a name="l02588"></a><span class="lineno"> 2588</span>&#160;The abstract base class \c ConstitutiveLaw provides</div>
<div class="line"><a name="l02589"></a><span class="lineno"> 2589</span>&#160;interfaces for the computation of the stress in all three forms.</div>
<div class="line"><a name="l02590"></a><span class="lineno"> 2590</span>&#160; </div>
<div class="line"><a name="l02591"></a><span class="lineno"> 2591</span>&#160;\subsubsection non-dim_solid Non-dimensionalisation</div>
<div class="line"><a name="l02592"></a><span class="lineno"> 2592</span>&#160;The principle of virtual displacements (20)</div>
<div class="line"><a name="l02593"></a><span class="lineno"> 2593</span>&#160;is written in dimensional form.</div>
<div class="line"><a name="l02594"></a><span class="lineno"> 2594</span>&#160;We generally prefer to work with non-dimensional quantities and</div>
<div class="line"><a name="l02595"></a><span class="lineno"> 2595</span>&#160;will now discuss the non-dimensionalisation used in the</div>
<div class="line"><a name="l02596"></a><span class="lineno"> 2596</span>&#160;actual implementation of the equations in \c oomph-lib. For this purpose we </div>
<div class="line"><a name="l02597"></a><span class="lineno"> 2597</span>&#160;first re-write equation (20) as</div>
<div class="line"><a name="l02598"></a><span class="lineno"> 2598</span>&#160;\f[</div>
<div class="line"><a name="l02599"></a><span class="lineno"> 2599</span>&#160;\int_{v} \left\{ \sigma^{*ij} \ \delta \gamma_{ij} -  \left( {\bf f}^* - </div>
<div class="line"><a name="l02600"></a><span class="lineno"> 2600</span>&#160; \rho \frac{\partial^2 {\bf R}^*}{\partial t^{*2}} \right) \cdot </div>
<div class="line"><a name="l02601"></a><span class="lineno"> 2601</span>&#160; \delta {\bf R}^* \right\} \ dv^* </div>
<div class="line"><a name="l02602"></a><span class="lineno"> 2602</span>&#160; - \oint_{A_{tract}} {\bf t}^* \cdot \delta {\bf R}^* \ dA^* =0,</div>
<div class="line"><a name="l02603"></a><span class="lineno"> 2603</span>&#160;  \ \ \ \ \ \ \ \ (27)</div>
<div class="line"><a name="l02604"></a><span class="lineno"> 2604</span>&#160; \f]</div>
<div class="line"><a name="l02605"></a><span class="lineno"> 2605</span>&#160;where have used asterisks to label those</div>
<div class="line"><a name="l02606"></a><span class="lineno"> 2606</span>&#160;dimensional quantities that will have non-dimensional equivalents.</div>
<div class="line"><a name="l02607"></a><span class="lineno"> 2607</span>&#160;(Some quantities, such as the strain, are already</div>
<div class="line"><a name="l02608"></a><span class="lineno"> 2608</span>&#160;dimensionless, while others, such as the density will not have</div>
<div class="line"><a name="l02609"></a><span class="lineno"> 2609</span>&#160;any non-dimensional counterparts. We do not introduce modifiers</div>
<div class="line"><a name="l02610"></a><span class="lineno"> 2610</span>&#160;for these).</div>
<div class="line"><a name="l02611"></a><span class="lineno"> 2611</span>&#160; </div>
<div class="line"><a name="l02612"></a><span class="lineno"> 2612</span>&#160;We now non-dimensionalise all lengths with a problem-specific</div>
<div class="line"><a name="l02613"></a><span class="lineno"> 2613</span>&#160;length-scale, \f$ {\cal L}\f$, given e.g. the length of the solid</div>
<div class="line"><a name="l02614"></a><span class="lineno"> 2614</span>&#160;body, so that</div>
<div class="line"><a name="l02615"></a><span class="lineno"> 2615</span>&#160;\f[</div>
<div class="line"><a name="l02616"></a><span class="lineno"> 2616</span>&#160;\xi^{*i} = {\cal L} \ \xi^{i}, \ \ \  {\bf R}^* = {\cal L} \ {\bf R}, </div>
<div class="line"><a name="l02617"></a><span class="lineno"> 2617</span>&#160;\ \ \ dA^* = {\cal L}^2 \ dA, \mbox{ \ \ and \ \ } </div>
<div class="line"><a name="l02618"></a><span class="lineno"> 2618</span>&#160;dv^* = {\cal L}^3 \ dv.\ \ \ </div>
<div class="line"><a name="l02619"></a><span class="lineno"> 2619</span>&#160;\f]</div>
<div class="line"><a name="l02620"></a><span class="lineno"> 2620</span>&#160;We use a characteristic stiffness, \f$ {\cal S}\f$, (e.g. the</div>
<div class="line"><a name="l02621"></a><span class="lineno"> 2621</span>&#160;material&#39;s Young&#39;s modulus \f$ E \f$) to non-dimensionalise</div>
<div class="line"><a name="l02622"></a><span class="lineno"> 2622</span>&#160;the stress and the loads as</div>
<div class="line"><a name="l02623"></a><span class="lineno"> 2623</span>&#160;\f[</div>
<div class="line"><a name="l02624"></a><span class="lineno"> 2624</span>&#160;\sigma^{*ij} = {\cal S} \ \sigma^{ij}, \ \ \  {\bf t}^* = {\cal S}\</div>
<div class="line"><a name="l02625"></a><span class="lineno"> 2625</span>&#160;{\bf t}, \mbox{ \ \ and \ \ } {\bf f}^* = {\cal S} / {\cal L} \</div>
<div class="line"><a name="l02626"></a><span class="lineno"> 2626</span>&#160;{\bf f},</div>
<div class="line"><a name="l02627"></a><span class="lineno"> 2627</span>&#160;\f]</div>
<div class="line"><a name="l02628"></a><span class="lineno"> 2628</span>&#160;and we non-dimensionalise time with a problem-specific</div>
<div class="line"><a name="l02629"></a><span class="lineno"> 2629</span>&#160;timescale \f$ {\cal T}\f$ (e.g. the period of some external forcing),</div>
<div class="line"><a name="l02630"></a><span class="lineno"> 2630</span>&#160;so that</div>
<div class="line"><a name="l02631"></a><span class="lineno"> 2631</span>&#160;\f[</div>
<div class="line"><a name="l02632"></a><span class="lineno"> 2632</span>&#160;t^* = {\cal T} t.</div>
<div class="line"><a name="l02633"></a><span class="lineno"> 2633</span>&#160;\f]</div>
<div class="line"><a name="l02634"></a><span class="lineno"> 2634</span>&#160;This transforms (27) into</div>
<div class="line"><a name="l02635"></a><span class="lineno"> 2635</span>&#160;\f[</div>
<div class="line"><a name="l02636"></a><span class="lineno"> 2636</span>&#160;\int_{v} \left\{ \sigma^{ij} \ \delta \gamma_{ij} - \left( {\bf f} - </div>
<div class="line"><a name="l02637"></a><span class="lineno"> 2637</span>&#160; \Lambda^2 \frac{\partial^2 {\bf R}}{\partial t^{2}} \right) \cdot </div>
<div class="line"><a name="l02638"></a><span class="lineno"> 2638</span>&#160; \delta {\bf R} \right\} \ dv </div>
<div class="line"><a name="l02639"></a><span class="lineno"> 2639</span>&#160; -\oint_{A_{tract}} {\bf t} \cdot \delta {\bf R} \ dA =0,</div>
<div class="line"><a name="l02640"></a><span class="lineno"> 2640</span>&#160;  \ \ \ \ \ \ \ \ (28)</div>
<div class="line"><a name="l02641"></a><span class="lineno"> 2641</span>&#160; \f]</div>
<div class="line"><a name="l02642"></a><span class="lineno"> 2642</span>&#160; where </div>
<div class="line"><a name="l02643"></a><span class="lineno"> 2643</span>&#160;\f[</div>
<div class="line"><a name="l02644"></a><span class="lineno"> 2644</span>&#160;\Lambda = \frac{1}{\cal T} \sqrt{\frac{\rho {\cal L}}{\cal S}}</div>
<div class="line"><a name="l02645"></a><span class="lineno"> 2645</span>&#160;\f]</div>
<div class="line"><a name="l02646"></a><span class="lineno"> 2646</span>&#160;is the ratio of system&#39;s &quot;intrinsic&quot; timescale, </div>
<div class="line"><a name="l02647"></a><span class="lineno"> 2647</span>&#160;\f$T_{intrinsic} = \sqrt{\rho {\cal L}/{\cal S}},\f$ to the</div>
<div class="line"><a name="l02648"></a><span class="lineno"> 2648</span>&#160;time, \f${\cal T}\f$, used in the non-dimensionalisation of the</div>
<div class="line"><a name="l02649"></a><span class="lineno"> 2649</span>&#160;equations. If a given problem has no externally imposed timescale</div>
<div class="line"><a name="l02650"></a><span class="lineno"> 2650</span>&#160;(e.g. in the free vibrations of an elastic body) \f$T_{intrinsic}\f$</div>
<div class="line"><a name="l02651"></a><span class="lineno"> 2651</span>&#160;(or some suitable problem-dependent multiple thereof) provides a natural </div>
<div class="line"><a name="l02652"></a><span class="lineno"> 2652</span>&#160;timescale for the non-dimensionalisation. Therefore we use </div>
<div class="line"><a name="l02653"></a><span class="lineno"> 2653</span>&#160;\f$ \Lambda=1 \f$ as the default value in all solid mechanics</div>
<div class="line"><a name="l02654"></a><span class="lineno"> 2654</span>&#160;equations. If preferred, computations can, of course, be</div>
<div class="line"><a name="l02655"></a><span class="lineno"> 2655</span>&#160;be performed with dimensional units, provided all quantities</div>
<div class="line"><a name="l02656"></a><span class="lineno"> 2656</span>&#160;are expressed in consistent units (e.g. from the SI system).</div>
<div class="line"><a name="l02657"></a><span class="lineno"> 2657</span>&#160;In this case \f$ \Lambda^2 \f$ represents the dimensional</div>
<div class="line"><a name="l02658"></a><span class="lineno"> 2658</span>&#160;density of the material.</div>
<div class="line"><a name="l02659"></a><span class="lineno"> 2659</span>&#160; </div>
<div class="line"><a name="l02660"></a><span class="lineno"> 2660</span>&#160;We adopt a similar approach for non-dimensionalisation of the </div>
<div class="line"><a name="l02661"></a><span class="lineno"> 2661</span>&#160;constitutive equations. Typically, the constitutive parameters</div>
<div class="line"><a name="l02662"></a><span class="lineno"> 2662</span>&#160;(e.g. Young&#39;s modulus and Poisson&#39;s ratio for a Hookean</div>
<div class="line"><a name="l02663"></a><span class="lineno"> 2663</span>&#160;constitutive equation) are passed to the \c ConstitutiveLaw</div>
<div class="line"><a name="l02664"></a><span class="lineno"> 2664</span>&#160;as arguments to its constructor. Where possible, we select one of these</div>
<div class="line"><a name="l02665"></a><span class="lineno"> 2665</span>&#160;parameters as the reference stress \f$ {\cal S} \f$ and give it</div>
<div class="line"><a name="l02666"></a><span class="lineno"> 2666</span>&#160;a default value of 1.0. Hence, if a Hookean constitutive</div>
<div class="line"><a name="l02667"></a><span class="lineno"> 2667</span>&#160;law is instantiated with just one argument (the Poisson ratio \f$</div>
<div class="line"><a name="l02668"></a><span class="lineno"> 2668</span>&#160;\nu \f$), the stress is assumed to have been scaled on Young&#39;s</div>
<div class="line"><a name="l02669"></a><span class="lineno"> 2669</span>&#160;modulus. If two arguments are provided, the second argument</div>
<div class="line"><a name="l02670"></a><span class="lineno"> 2670</span>&#160;should be interpreted as the ratio of</div>
<div class="line"><a name="l02671"></a><span class="lineno"> 2671</span>&#160;the material&#39;s Young&#39;s modulus to the reference stress </div>
<div class="line"><a name="l02672"></a><span class="lineno"> 2672</span>&#160;\f$ {\cal S} \f$ used in the non-dimensionalisation of the equations.</div>
<div class="line"><a name="l02673"></a><span class="lineno"> 2673</span>&#160; </div>
<div class="line"><a name="l02674"></a><span class="lineno"> 2674</span>&#160;\subsubsection 2D_solid 2D problems: Plane strain.</div>
<div class="line"><a name="l02675"></a><span class="lineno"> 2675</span>&#160;Many solid mechanics problems can be regarded as two-dimensional</div>
<div class="line"><a name="l02676"></a><span class="lineno"> 2676</span>&#160;in the sense that the quantities of interest only depend on two</div>
<div class="line"><a name="l02677"></a><span class="lineno"> 2677</span>&#160;spatial coordinates. In such problems it is important to consider what</div>
<div class="line"><a name="l02678"></a><span class="lineno"> 2678</span>&#160;constraints the system is subjected to in the third direction -- clearly</div>
<div class="line"><a name="l02679"></a><span class="lineno"> 2679</span>&#160;all real solid bodies are three-dimensional!</div>
<div class="line"><a name="l02680"></a><span class="lineno"> 2680</span>&#160;In plane strain problems, the displacements of material points are assumed</div>
<div class="line"><a name="l02681"></a><span class="lineno"> 2681</span>&#160;to be parallel to the 2D plane spanned by the coordinates \f$x_1</div>
<div class="line"><a name="l02682"></a><span class="lineno"> 2682</span>&#160;\f$ and \f$ x_2\f$, so that any displacements </div>
<div class="line"><a name="l02683"></a><span class="lineno"> 2683</span>&#160;normal to this plane are suppressed. In this case, significant </div>
<div class="line"><a name="l02684"></a><span class="lineno"> 2684</span>&#160;transverse stresses can develop.</div>
<div class="line"><a name="l02685"></a><span class="lineno"> 2685</span>&#160;Conversely, in plane stress problems, it is assumed that no stresses</div>
<div class="line"><a name="l02686"></a><span class="lineno"> 2686</span>&#160;develop in the transverse direction; in this case we need</div>
<div class="line"><a name="l02687"></a><span class="lineno"> 2687</span>&#160;to allow material particles to be displaced transversely.</div>
<div class="line"><a name="l02688"></a><span class="lineno"> 2688</span>&#160;Since we have formulated our problem in terms of positions </div>
<div class="line"><a name="l02689"></a><span class="lineno"> 2689</span>&#160;(i.e. in terms of the displacement of material points), our formulation</div>
<div class="line"><a name="l02690"></a><span class="lineno"> 2690</span>&#160;naturally produces a &lt;B&gt;plane strain&lt;/B&gt; problem if we reduce</div>
<div class="line"><a name="l02691"></a><span class="lineno"> 2691</span>&#160;the equations to two dimensions:</div>
<div class="line"><a name="l02692"></a><span class="lineno"> 2692</span>&#160;We assume that the transverse displacement vanishes, </div>
<div class="line"><a name="l02693"></a><span class="lineno"> 2693</span>&#160;while the remaining (in-plane) displacements are only </div>
<div class="line"><a name="l02694"></a><span class="lineno"> 2694</span>&#160;functions of the in-plane coordinates, \f$ x_1\f$ and \f$ x_2\f$.</div>
<div class="line"><a name="l02695"></a><span class="lineno"> 2695</span>&#160; </div>
<div class="line"><a name="l02696"></a><span class="lineno"> 2696</span>&#160;It is important to remember that the 2D version of all equations needs to </div>
<div class="line"><a name="l02697"></a><span class="lineno"> 2697</span>&#160;produce plane-strain behaviour when new, strain-energy-based </div>
<div class="line"><a name="l02698"></a><span class="lineno"> 2698</span>&#160;constitutive equation classes are formulated:</div>
<div class="line"><a name="l02699"></a><span class="lineno"> 2699</span>&#160;When implementing such strain-energy functions, recall that any</div>
<div class="line"><a name="l02700"></a><span class="lineno"> 2700</span>&#160;invariants of metric tensors etc. are the invariants of the full</div>
<div class="line"><a name="l02701"></a><span class="lineno"> 2701</span>&#160;3D quantities which are not necessarily the same as those</div>
<div class="line"><a name="l02702"></a><span class="lineno"> 2702</span>&#160;of the corresponding 2D quantities.</div>
<div class="line"><a name="l02703"></a><span class="lineno"> 2703</span>&#160; </div>
<div class="line"><a name="l02704"></a><span class="lineno"> 2704</span>&#160; </div>
<div class="line"><a name="l02705"></a><span class="lineno"> 2705</span>&#160; </div>
<div class="line"><a name="l02706"></a><span class="lineno"> 2706</span>&#160;\subsubsection isotropic_growth Isotropic growth.</div>
<div class="line"><a name="l02707"></a><span class="lineno"> 2707</span>&#160;Many biological tissues undergo growth processes. For instance, the cells </div>
<div class="line"><a name="l02708"></a><span class="lineno"> 2708</span>&#160;that make up a solid tumour divide regularly and as a result the</div>
<div class="line"><a name="l02709"></a><span class="lineno"> 2709</span>&#160;total mass of the tumour increases. If the growth </div>
<div class="line"><a name="l02710"></a><span class="lineno"> 2710</span>&#160;occurs non-uniformly so that certain parts of the tumour grow faster</div>
<div class="line"><a name="l02711"></a><span class="lineno"> 2711</span>&#160;than others, regions that grow more slowly restrain the expansion</div>
<div class="line"><a name="l02712"></a><span class="lineno"> 2712</span>&#160;of their neighbours. This process can induce significant growth stresses.</div>
<div class="line"><a name="l02713"></a><span class="lineno"> 2713</span>&#160;The scenario is similar (but not identical) to that of thermal </div>
<div class="line"><a name="l02714"></a><span class="lineno"> 2714</span>&#160;growth in which a non-uniform temperature distribution in </div>
<div class="line"><a name="l02715"></a><span class="lineno"> 2715</span>&#160;a body creates thermal stresses. (The important difference between</div>
<div class="line"><a name="l02716"></a><span class="lineno"> 2716</span>&#160;these two cases is that in the latter process mass is conserved --</div>
<div class="line"><a name="l02717"></a><span class="lineno"> 2717</span>&#160;thermal expansion only leads to an increase in the volume occupied</div>
<div class="line"><a name="l02718"></a><span class="lineno"> 2718</span>&#160;by the material, whereas biological growth via cell division </div>
<div class="line"><a name="l02719"></a><span class="lineno"> 2719</span>&#160;increases the mass of the tumour). </div>
<div class="line"><a name="l02720"></a><span class="lineno"> 2720</span>&#160; </div>
<div class="line"><a name="l02721"></a><span class="lineno"> 2721</span>&#160;It is easy to incorporate such growth processes into our </div>
<div class="line"><a name="l02722"></a><span class="lineno"> 2722</span>&#160;theoretical framework. The general idea is sketched in the </div>
<div class="line"><a name="l02723"></a><span class="lineno"> 2723</span>&#160;following figure:</div>
<div class="line"><a name="l02724"></a><span class="lineno"> 2724</span>&#160; </div>
<div class="line"><a name="l02725"></a><span class="lineno"> 2725</span>&#160; </div>
<div class="line"><a name="l02726"></a><span class="lineno"> 2726</span>&#160; </div>
<div class="line"><a name="l02727"></a><span class="lineno"> 2727</span>&#160; </div>
<div class="line"><a name="l02728"></a><span class="lineno"> 2728</span>&#160;&lt;TABLE&gt;</div>
<div class="line"><a name="l02729"></a><span class="lineno"> 2729</span>&#160;&lt;TR&gt;</div>
<div class="line"><a name="l02730"></a><span class="lineno"> 2730</span>&#160;&lt;TD COLSPAN=2&gt;</div>
<div class="line"><a name="l02731"></a><span class="lineno"> 2731</span>&#160;&lt;CENTER&gt;</div>
<div class="line"><a name="l02732"></a><span class="lineno"> 2732</span>&#160;\image html Isotropic_growth_0.gif &quot; &quot; </div>
<div class="line"><a name="l02733"></a><span class="lineno"> 2733</span>&#160;\image latex Isotropic_growth_0.eps &quot; &quot; width=0.35\textwidth</div>
<div class="line"><a name="l02734"></a><span class="lineno"> 2734</span>&#160;\n &lt;B&gt; State 0:&lt;/B&gt; Undeformed, ungrown and </div>
<div class="line"><a name="l02735"></a><span class="lineno"> 2735</span>&#160;stress-free reference configuration.</div>
<div class="line"><a name="l02736"></a><span class="lineno"> 2736</span>&#160;&lt;/CENTER&gt;</div>
<div class="line"><a name="l02737"></a><span class="lineno"> 2737</span>&#160;&lt;/TD&gt;</div>
<div class="line"><a name="l02738"></a><span class="lineno"> 2738</span>&#160;&lt;/TR&gt;</div>
<div class="line"><a name="l02739"></a><span class="lineno"> 2739</span>&#160;&lt;/TABLE&gt;</div>
<div class="line"><a name="l02740"></a><span class="lineno"> 2740</span>&#160; </div>
<div class="line"><a name="l02741"></a><span class="lineno"> 2741</span>&#160;&lt;TABLE&gt;</div>
<div class="line"><a name="l02742"></a><span class="lineno"> 2742</span>&#160;&lt;TR&gt;</div>
<div class="line"><a name="l02743"></a><span class="lineno"> 2743</span>&#160;&lt;TD&gt;</div>
<div class="line"><a name="l02744"></a><span class="lineno"> 2744</span>&#160;\image html Isotropic_growth_U1.gif &quot; &quot; </div>
<div class="line"><a name="l02745"></a><span class="lineno"> 2745</span>&#160;\image latex Isotropic_growth_U1.eps &quot; &quot; width=0.35\textwidth</div>
<div class="line"><a name="l02746"></a><span class="lineno"> 2746</span>&#160;\n &lt;B&gt; (Hypothetical) state U1:&lt;/B&gt; The individual infinitesimal </div>
<div class="line"><a name="l02747"></a><span class="lineno"> 2747</span>&#160;material elements</div>
<div class="line"><a name="l02748"></a><span class="lineno"> 2748</span>&#160;have expanded isotropically and the elements are in </div>
<div class="line"><a name="l02749"></a><span class="lineno"> 2749</span>&#160;a stress-free state. The isotropic growth</div>
<div class="line"><a name="l02750"></a><span class="lineno"> 2750</span>&#160;is spatially uniform -- all elements have expanded by the same amount.</div>
<div class="line"><a name="l02751"></a><span class="lineno"> 2751</span>&#160;&lt;/TD&gt;</div>
<div class="line"><a name="l02752"></a><span class="lineno"> 2752</span>&#160;&lt;TD&gt;</div>
<div class="line"><a name="l02753"></a><span class="lineno"> 2753</span>&#160;\image html Isotropic_growth_N1.gif &quot; &quot; </div>
<div class="line"><a name="l02754"></a><span class="lineno"> 2754</span>&#160;\image latex Isotropic_growth_N1.eps &quot; &quot; width=0.35\textwidth</div>
<div class="line"><a name="l02755"></a><span class="lineno"> 2755</span>&#160;\n&lt;B&gt; (Hypothetical) state N1:&lt;/B&gt;  All infinitesimal material elements</div>
<div class="line"><a name="l02756"></a><span class="lineno"> 2756</span>&#160;have expanded isotropically and the elements are in </div>
<div class="line"><a name="l02757"></a><span class="lineno"> 2757</span>&#160;a stress-free state. The isotropic growth</div>
<div class="line"><a name="l02758"></a><span class="lineno"> 2758</span>&#160;is spatially non-uniform, so individual elements</div>
<div class="line"><a name="l02759"></a><span class="lineno"> 2759</span>&#160;have grown by different amounts.</div>
<div class="line"><a name="l02760"></a><span class="lineno"> 2760</span>&#160;&lt;/TD&gt;</div>
<div class="line"><a name="l02761"></a><span class="lineno"> 2761</span>&#160;&lt;/TR&gt;</div>
<div class="line"><a name="l02762"></a><span class="lineno"> 2762</span>&#160;&lt;/TABLE&gt;</div>
<div class="line"><a name="l02763"></a><span class="lineno"> 2763</span>&#160;&lt;TABLE&gt;</div>
<div class="line"><a name="l02764"></a><span class="lineno"> 2764</span>&#160;&lt;TR&gt;</div>
<div class="line"><a name="l02765"></a><span class="lineno"> 2765</span>&#160;&lt;TD&gt;</div>
<div class="line"><a name="l02766"></a><span class="lineno"> 2766</span>&#160;\image html Isotropic_growth_U2.gif &quot; &quot; </div>
<div class="line"><a name="l02767"></a><span class="lineno"> 2767</span>&#160;\image latex Isotropic_growth_U2.eps &quot; &quot; width=0.35\textwidth</div>
<div class="line"><a name="l02768"></a><span class="lineno"> 2768</span>&#160;\n&lt;B&gt; State U2:&lt;/B&gt; Since the isotropically-grown infinitesimal</div>
<div class="line"><a name="l02769"></a><span class="lineno"> 2769</span>&#160; material elements have grown by the same amount, they can</div>
<div class="line"><a name="l02770"></a><span class="lineno"> 2770</span>&#160; be (re-)assembled to form a continuous, stress-free body. </div>
<div class="line"><a name="l02771"></a><span class="lineno"> 2771</span>&#160;&lt;/TD&gt;</div>
<div class="line"><a name="l02772"></a><span class="lineno"> 2772</span>&#160;&lt;TD&gt;</div>
<div class="line"><a name="l02773"></a><span class="lineno"> 2773</span>&#160;\image html Isotropic_growth_N2.gif &quot; &quot; </div>
<div class="line"><a name="l02774"></a><span class="lineno"> 2774</span>&#160;\image latex Isotropic_growth_N2.eps &quot; &quot; width=0.35\textwidth</div>
<div class="line"><a name="l02775"></a><span class="lineno"> 2775</span>&#160;\n&lt;B&gt; State N2:&lt;/B&gt; Since the individual material elements have</div>
<div class="line"><a name="l02776"></a><span class="lineno"> 2776</span>&#160;grown by different amounts they can (in general) not be (re-)assembled</div>
<div class="line"><a name="l02777"></a><span class="lineno"> 2777</span>&#160;to form a continuous body without undergoing some deformation.</div>
<div class="line"><a name="l02778"></a><span class="lineno"> 2778</span>&#160;The deformation of the material elements (relative to their</div>
<div class="line"><a name="l02779"></a><span class="lineno"> 2779</span>&#160;stress-free shape in the hypothetical, stress-free state N1) </div>
<div class="line"><a name="l02780"></a><span class="lineno"> 2780</span>&#160;induces internal stresses -- the so-called growth-stresses.</div>
<div class="line"><a name="l02781"></a><span class="lineno"> 2781</span>&#160;&lt;/TD&gt;</div>
<div class="line"><a name="l02782"></a><span class="lineno"> 2782</span>&#160;&lt;/TR&gt;</div>
<div class="line"><a name="l02783"></a><span class="lineno"> 2783</span>&#160;&lt;/TABLE&gt;</div>
<div class="line"><a name="l02784"></a><span class="lineno"> 2784</span>&#160;&lt;TABLE&gt;</div>
<div class="line"><a name="l02785"></a><span class="lineno"> 2785</span>&#160;&lt;TR&gt;</div>
<div class="line"><a name="l02786"></a><span class="lineno"> 2786</span>&#160;&lt;TD&gt;</div>
<div class="line"><a name="l02787"></a><span class="lineno"> 2787</span>&#160;\image html Isotropic_growth_UE.gif &quot; &quot; </div>
<div class="line"><a name="l02788"></a><span class="lineno"> 2788</span>&#160;\image latex Isotropic_growth_UE.eps &quot; &quot; width=0.35\textwidth</div>
<div class="line"><a name="l02789"></a><span class="lineno"> 2789</span>&#160;\n&lt;B&gt; State UE:&lt;/B&gt; When subjected to external tractions </div>
<div class="line"><a name="l02790"></a><span class="lineno"> 2790</span>&#160;and to body forces, the uniformly-grown material elements deform. Their</div>
<div class="line"><a name="l02791"></a><span class="lineno"> 2791</span>&#160;deformation (relative to their stress-free shape in state</div>
<div class="line"><a name="l02792"></a><span class="lineno"> 2792</span>&#160;U1 (or, equivalently, U2), generates internal stresses which</div>
<div class="line"><a name="l02793"></a><span class="lineno"> 2793</span>&#160;- balance the applied loads,</div>
<div class="line"><a name="l02794"></a><span class="lineno"> 2794</span>&#160;- keep all infinitesimal material elements in local equilibrium.</div>
<div class="line"><a name="l02795"></a><span class="lineno"> 2795</span>&#160;&lt;/TD&gt;</div>
<div class="line"><a name="l02796"></a><span class="lineno"> 2796</span>&#160;&lt;TD&gt;</div>
<div class="line"><a name="l02797"></a><span class="lineno"> 2797</span>&#160;\image html Isotropic_growth_NE.gif &quot; &quot; </div>
<div class="line"><a name="l02798"></a><span class="lineno"> 2798</span>&#160;\image latex Isotropic_growth_NE.eps &quot; &quot; width=0.35\textwidth</div>
<div class="line"><a name="l02799"></a><span class="lineno"> 2799</span>&#160;\n&lt;B&gt; State NE:&lt;/B&gt;  When subjected to external tractions </div>
<div class="line"><a name="l02800"></a><span class="lineno"> 2800</span>&#160;and to body forces, the material elements deform further. Their</div>
<div class="line"><a name="l02801"></a><span class="lineno"> 2801</span>&#160;deformation (relative to their stress-free shape in state</div>
<div class="line"><a name="l02802"></a><span class="lineno"> 2802</span>&#160;N1), generates internal stresses which</div>
<div class="line"><a name="l02803"></a><span class="lineno"> 2803</span>&#160;- balance the applied loads,</div>
<div class="line"><a name="l02804"></a><span class="lineno"> 2804</span>&#160;- keep the material elements in local equilibrium.</div>
<div class="line"><a name="l02805"></a><span class="lineno"> 2805</span>&#160;&lt;/TD&gt;</div>
<div class="line"><a name="l02806"></a><span class="lineno"> 2806</span>&#160;&lt;/TR&gt;</div>
<div class="line"><a name="l02807"></a><span class="lineno"> 2807</span>&#160;&lt;/TABLE&gt;</div>
<div class="line"><a name="l02808"></a><span class="lineno"> 2808</span>&#160; </div>
<div class="line"><a name="l02809"></a><span class="lineno"> 2809</span>&#160; </div>
<div class="line"><a name="l02810"></a><span class="lineno"> 2810</span>&#160; </div>
<div class="line"><a name="l02811"></a><span class="lineno"> 2811</span>&#160; </div>
<div class="line"><a name="l02812"></a><span class="lineno"> 2812</span>&#160;We start our analysis with the stress-free (and </div>
<div class="line"><a name="l02813"></a><span class="lineno"> 2813</span>&#160;&quot;ungrown&quot;) reference configuration &quot;0&quot; at the top of the diagram,</div>
<div class="line"><a name="l02814"></a><span class="lineno"> 2814</span>&#160;and initially follow the deformation shown in the left half</div>
<div class="line"><a name="l02815"></a><span class="lineno"> 2815</span>&#160;of the sketch. In a first step, each infinitesimal material</div>
<div class="line"><a name="l02816"></a><span class="lineno"> 2816</span>&#160;element in  the body is subjected to the same isotropic growth</div>
<div class="line"><a name="l02817"></a><span class="lineno"> 2817</span>&#160;which changes its mass from  \f$\mbox{d}M\f$ to</div>
<div class="line"><a name="l02818"></a><span class="lineno"> 2818</span>&#160;\f$ \Gamma \ \mbox{d}M \f$. Assuming that the growth process does not</div>
<div class="line"><a name="l02819"></a><span class="lineno"> 2819</span>&#160;change the density of the material, \f$ \Gamma\f$ also specifies</div>
<div class="line"><a name="l02820"></a><span class="lineno"> 2820</span>&#160;the volumetric growth of the material. All material</div>
<div class="line"><a name="l02821"></a><span class="lineno"> 2821</span>&#160;elements grow by the same amount, therefore the individual elements</div>
<div class="line"><a name="l02822"></a><span class="lineno"> 2822</span>&#160;can be (re-)assembled to form a continuous body (state</div>
<div class="line"><a name="l02823"></a><span class="lineno"> 2823</span>&#160;U2). In this state, the body is </div>
<div class="line"><a name="l02824"></a><span class="lineno"> 2824</span>&#160;stress-free and, compared to the reference configuration &quot;0&quot;,</div>
<div class="line"><a name="l02825"></a><span class="lineno"> 2825</span>&#160;all lengths have increased by a factor of \f$\Gamma^{1/d}\f$ </div>
<div class="line"><a name="l02826"></a><span class="lineno"> 2826</span>&#160;where \f$ d \f$ is the body&#39;s spatial dimension (i.e. \f$d=2\f$ in </div>
<div class="line"><a name="l02827"></a><span class="lineno"> 2827</span>&#160;the sketch above). The covariant basis vectors in this </div>
<div class="line"><a name="l02828"></a><span class="lineno"> 2828</span>&#160;uniformly-grown, stress-free configuration are therefore given by</div>
<div class="line"><a name="l02829"></a><span class="lineno"> 2829</span>&#160;\f[</div>
<div class="line"><a name="l02830"></a><span class="lineno"> 2830</span>&#160;\widetilde{\bf g}_i = \Gamma^{1/d} \ {\bf g}_i,</div>
<div class="line"><a name="l02831"></a><span class="lineno"> 2831</span>&#160;\f] </div>
<div class="line"><a name="l02832"></a><span class="lineno"> 2832</span>&#160;the metric tensor is given by</div>
<div class="line"><a name="l02833"></a><span class="lineno"> 2833</span>&#160;\f[</div>
<div class="line"><a name="l02834"></a><span class="lineno"> 2834</span>&#160;\widetilde{g_{ij}} = \Gamma^{2/d} \ g_{ij},</div>
<div class="line"><a name="l02835"></a><span class="lineno"> 2835</span>&#160;\f] </div>
<div class="line"><a name="l02836"></a><span class="lineno"> 2836</span>&#160;and the volume of an infinitesimal material element</div>
<div class="line"><a name="l02837"></a><span class="lineno"> 2837</span>&#160;has increased from </div>
<div class="line"><a name="l02838"></a><span class="lineno"> 2838</span>&#160;\f[</div>
<div class="line"><a name="l02839"></a><span class="lineno"> 2839</span>&#160;dv = \sqrt{g}  \ d\xi^1 ... \ d\xi^D</div>
<div class="line"><a name="l02840"></a><span class="lineno"> 2840</span>&#160;\f]</div>
<div class="line"><a name="l02841"></a><span class="lineno"> 2841</span>&#160;to </div>
<div class="line"><a name="l02842"></a><span class="lineno"> 2842</span>&#160;\f[</div>
<div class="line"><a name="l02843"></a><span class="lineno"> 2843</span>&#160;\widetilde{dv} = \Gamma \sqrt{g} \ d\xi^1 ... \ d\xi^D </div>
<div class="line"><a name="l02844"></a><span class="lineno"> 2844</span>&#160;\ \ \ \ \ \ \ \ \ \ \ \ (29)</div>
<div class="line"><a name="l02845"></a><span class="lineno"> 2845</span>&#160;\f]</div>
<div class="line"><a name="l02846"></a><span class="lineno"> 2846</span>&#160;We now subject the stress-free, uniformly-grown body to</div>
<div class="line"><a name="l02847"></a><span class="lineno"> 2847</span>&#160;external loads and determine its deformation, using the principle</div>
<div class="line"><a name="l02848"></a><span class="lineno"> 2848</span>&#160;of virtual displacements. Since the uniformly grown state &quot;U2&quot;</div>
<div class="line"><a name="l02849"></a><span class="lineno"> 2849</span>&#160;is stress-free, we may regard it as the reference state for</div>
<div class="line"><a name="l02850"></a><span class="lineno"> 2850</span>&#160;the subsequent deformation. The strain tensor that describes</div>
<div class="line"><a name="l02851"></a><span class="lineno"> 2851</span>&#160;the deformation from the stress-free (and uniformly-grown) state &quot;U2&quot;</div>
<div class="line"><a name="l02852"></a><span class="lineno"> 2852</span>&#160;to the final equilibrium configuration &quot;UE&quot; must therefore</div>
<div class="line"><a name="l02853"></a><span class="lineno"> 2853</span>&#160;be defined as</div>
<div class="line"><a name="l02854"></a><span class="lineno"> 2854</span>&#160;\f[</div>
<div class="line"><a name="l02855"></a><span class="lineno"> 2855</span>&#160;\gamma_{ij} = \frac{1}{2} \left(G_{ij} - \widetilde{g_{ij}}\right)</div>
<div class="line"><a name="l02856"></a><span class="lineno"> 2856</span>&#160; = \frac{1}{2} \left(G_{ij} - \Gamma^{2/D} \ g_{ij} \right)</div>
<div class="line"><a name="l02857"></a><span class="lineno"> 2857</span>&#160;\ \ \ \ \ \ \ \ \ \ \ \ (30)</div>
<div class="line"><a name="l02858"></a><span class="lineno"> 2858</span>&#160;\f]</div>
<div class="line"><a name="l02859"></a><span class="lineno"> 2859</span>&#160;Equations (29) and (30) allow</div>
<div class="line"><a name="l02860"></a><span class="lineno"> 2860</span>&#160;us to express the principle of virtual displacements</div>
<div class="line"><a name="l02861"></a><span class="lineno"> 2861</span>&#160;in terms of</div>
<div class="line"><a name="l02862"></a><span class="lineno"> 2862</span>&#160;- the metric of the undeformed (and un-grown) reference</div>
<div class="line"><a name="l02863"></a><span class="lineno"> 2863</span>&#160;  state &quot;0&quot;, </div>
<div class="line"><a name="l02864"></a><span class="lineno"> 2864</span>&#160;- the volumetric growth \f$ \Gamma \f$, and</div>
<div class="line"><a name="l02865"></a><span class="lineno"> 2865</span>&#160;- quantities associated with the final deformed configuration</div>
<div class="line"><a name="l02866"></a><span class="lineno"> 2866</span>&#160;  &quot;UE&quot;:</div>
<div class="line"><a name="l02867"></a><span class="lineno"> 2867</span>&#160;.</div>
<div class="line"><a name="l02868"></a><span class="lineno"> 2868</span>&#160;\f[</div>
<div class="line"><a name="l02869"></a><span class="lineno"> 2869</span>&#160;\int_{v} \left\{ \sigma^{ij} \ \delta \gamma_{ij} - \left( {\bf f} - </div>
<div class="line"><a name="l02870"></a><span class="lineno"> 2870</span>&#160; \Lambda^2 \frac{\partial^2 {\bf R}}{\partial t^{2}} \right) \cdot </div>
<div class="line"><a name="l02871"></a><span class="lineno"> 2871</span>&#160; \delta {\bf R} \right\} \ \Gamma \ dv </div>
<div class="line"><a name="l02872"></a><span class="lineno"> 2872</span>&#160; -\oint_{A_{tract}} {\bf t} \cdot \delta {\bf R} \ dA =0,</div>
<div class="line"><a name="l02873"></a><span class="lineno"> 2873</span>&#160;  \ \ \ \ \ \ \ \ (31)</div>
<div class="line"><a name="l02874"></a><span class="lineno"> 2874</span>&#160;\f]</div>
<div class="line"><a name="l02875"></a><span class="lineno"> 2875</span>&#160;Note that this equation does not contain any references to quantities</div>
<div class="line"><a name="l02876"></a><span class="lineno"> 2876</span>&#160;in the intermediate states &quot;U1&quot; and &quot;U2&quot;. </div>
<div class="line"><a name="l02877"></a><span class="lineno"> 2877</span>&#160; </div>
<div class="line"><a name="l02878"></a><span class="lineno"> 2878</span>&#160;We will now consider the case of spatially non-uniform growth,</div>
<div class="line"><a name="l02879"></a><span class="lineno"> 2879</span>&#160;illustrated in the right half of the sketch. If the isotropic</div>
<div class="line"><a name="l02880"></a><span class="lineno"> 2880</span>&#160;growth is spatially non-uniform, \f$ \Gamma = \Gamma(\xi^i)\f$,</div>
<div class="line"><a name="l02881"></a><span class="lineno"> 2881</span>&#160;the growth will try to expand all infinitesimal material </div>
<div class="line"><a name="l02882"></a><span class="lineno"> 2882</span>&#160;elements isotropically -- but each one by a different amount as</div>
<div class="line"><a name="l02883"></a><span class="lineno"> 2883</span>&#160;illustrated by the hypothetical state N1 in which each material</div>
<div class="line"><a name="l02884"></a><span class="lineno"> 2884</span>&#160;element has expanded to its stress-free state in which its</div>
<div class="line"><a name="l02885"></a><span class="lineno"> 2885</span>&#160;metric tensor is given by</div>
<div class="line"><a name="l02886"></a><span class="lineno"> 2886</span>&#160;\f[</div>
<div class="line"><a name="l02887"></a><span class="lineno"> 2887</span>&#160;\widetilde{g_{ij}} = \Gamma(\xi^k) \ g_{ij}.</div>
<div class="line"><a name="l02888"></a><span class="lineno"> 2888</span>&#160;\f] </div>
<div class="line"><a name="l02889"></a><span class="lineno"> 2889</span>&#160;Material elements will only be stress-free if the strain </div>
<div class="line"><a name="l02890"></a><span class="lineno"> 2890</span>&#160;\f[</div>
<div class="line"><a name="l02891"></a><span class="lineno"> 2891</span>&#160;\gamma_{ij} = \frac{1}{2} \left(G_{ij} - \widetilde{g_{ij}}\right)</div>
<div class="line"><a name="l02892"></a><span class="lineno"> 2892</span>&#160; = \frac{1}{2} \left(G_{ij} - \Gamma^{2/D}(\xi^k) \ g_{ij} \right)</div>
<div class="line"><a name="l02893"></a><span class="lineno"> 2893</span>&#160;\ \ \ \ \ \ \ \ \ \ \ \ (32)</div>
<div class="line"><a name="l02894"></a><span class="lineno"> 2894</span>&#160;\f]</div>
<div class="line"><a name="l02895"></a><span class="lineno"> 2895</span>&#160;relative to their isotropically grown shape in state N1 is zero.</div>
<div class="line"><a name="l02896"></a><span class="lineno"> 2896</span>&#160;In general, the displacements induced by such an isotropic</div>
<div class="line"><a name="l02897"></a><span class="lineno"> 2897</span>&#160;expansion will be</div>
<div class="line"><a name="l02898"></a><span class="lineno"> 2898</span>&#160;incompatible and it would be impossible to (re-)assemble the </div>
<div class="line"><a name="l02899"></a><span class="lineno"> 2899</span>&#160;individually grown material elements to a continuous body</div>
<div class="line"><a name="l02900"></a><span class="lineno"> 2900</span>&#160;unless the material elements undergo some deformation. </div>
<div class="line"><a name="l02901"></a><span class="lineno"> 2901</span>&#160;The elements&#39; deformation relative to their</div>
<div class="line"><a name="l02902"></a><span class="lineno"> 2902</span>&#160;stress-free shape in N1 will generate internal &quot;growth-stresses&quot;</div>
<div class="line"><a name="l02903"></a><span class="lineno"> 2903</span>&#160;(stage N2). When subjected to external loads and body forces</div>
<div class="line"><a name="l02904"></a><span class="lineno"> 2904</span>&#160;the body will undergo further deformations until the</div>
<div class="line"><a name="l02905"></a><span class="lineno"> 2905</span>&#160;the stress (generated by the particles&#39; total deformation relative to</div>
<div class="line"><a name="l02906"></a><span class="lineno"> 2906</span>&#160;their stress-free state N1) balances the applied loads.</div>
<div class="line"><a name="l02907"></a><span class="lineno"> 2907</span>&#160; </div>
<div class="line"><a name="l02908"></a><span class="lineno"> 2908</span>&#160;It is important to realise that, as in the case of spatially</div>
<div class="line"><a name="l02909"></a><span class="lineno"> 2909</span>&#160;uniform growth, the strain defined by (30) is </div>
<div class="line"><a name="l02910"></a><span class="lineno"> 2910</span>&#160;an intrinsic quantity that provides a measure of each particles&#39; </div>
<div class="line"><a name="l02911"></a><span class="lineno"> 2911</span>&#160;\e local deformation relative to its stress-free shape in N1. </div>
<div class="line"><a name="l02912"></a><span class="lineno"> 2912</span>&#160;The intermediate (and in the current case hypothetical), isotropically </div>
<div class="line"><a name="l02913"></a><span class="lineno"> 2913</span>&#160;grown state N1 does not appear in the analysis -- it only serves</div>
<div class="line"><a name="l02914"></a><span class="lineno"> 2914</span>&#160;to define the stress-free shape for each infinitesimal</div>
<div class="line"><a name="l02915"></a><span class="lineno"> 2915</span>&#160;material element. Equation (31) therefore</div>
<div class="line"><a name="l02916"></a><span class="lineno"> 2916</span>&#160;remains valid.</div>
<div class="line"><a name="l02917"></a><span class="lineno"> 2917</span>&#160; </div>
<div class="line"><a name="l02918"></a><span class="lineno"> 2918</span>&#160; </div>
<div class="line"><a name="l02919"></a><span class="lineno"> 2919</span>&#160;\subsubsection CartesianLagrangian Specialisation to a cartesian basis and finite element discretisation</div>
<div class="line"><a name="l02920"></a><span class="lineno"> 2920</span>&#160;If the problem does not have any</div>
<div class="line"><a name="l02921"></a><span class="lineno"> 2921</span>&#160;symmetries (e.g. axisymmetry) whose exploitation would reduce</div>
<div class="line"><a name="l02922"></a><span class="lineno"> 2922</span>&#160;the spatial dimension of the problem, the most compact form</div>
<div class="line"><a name="l02923"></a><span class="lineno"> 2923</span>&#160;of the equations is obtained by resolving all vectors into</div>
<div class="line"><a name="l02924"></a><span class="lineno"> 2924</span>&#160;a fixed cartesian basis so that the undeformed position vector</div>
<div class="line"><a name="l02925"></a><span class="lineno"> 2925</span>&#160;is given by</div>
<div class="line"><a name="l02926"></a><span class="lineno"> 2926</span>&#160;\f[</div>
<div class="line"><a name="l02927"></a><span class="lineno"> 2927</span>&#160;{\bf r}(\xi^j) = r_i(\xi^j) \ {\bf e}_i,</div>
<div class="line"><a name="l02928"></a><span class="lineno"> 2928</span>&#160; \ \ \ \ \ \ \ \ (33)</div>
<div class="line"><a name="l02929"></a><span class="lineno"> 2929</span>&#160;\f]</div>
<div class="line"><a name="l02930"></a><span class="lineno"> 2930</span>&#160;Similarly, we write </div>
<div class="line"><a name="l02931"></a><span class="lineno"> 2931</span>&#160;\f[</div>
<div class="line"><a name="l02932"></a><span class="lineno"> 2932</span>&#160;{\bf f} = f_i \ {\bf e}_i,</div>
<div class="line"><a name="l02933"></a><span class="lineno"> 2933</span>&#160;\f]</div>
<div class="line"><a name="l02934"></a><span class="lineno"> 2934</span>&#160;\f[</div>
<div class="line"><a name="l02935"></a><span class="lineno"> 2935</span>&#160;{\bf t} = t_i \ {\bf e}_i,</div>
<div class="line"><a name="l02936"></a><span class="lineno"> 2936</span>&#160;\f]</div>
<div class="line"><a name="l02937"></a><span class="lineno"> 2937</span>&#160;and </div>
<div class="line"><a name="l02938"></a><span class="lineno"> 2938</span>&#160;\f[</div>
<div class="line"><a name="l02939"></a><span class="lineno"> 2939</span>&#160;{\bf R}^{(BC)} = R^{(BC)}_i \ {\bf e}_i.</div>
<div class="line"><a name="l02940"></a><span class="lineno"> 2940</span>&#160;\f]</div>
<div class="line"><a name="l02941"></a><span class="lineno"> 2941</span>&#160; </div>
<div class="line"><a name="l02942"></a><span class="lineno"> 2942</span>&#160;We use the Eulerian coordinates in the undeformed </div>
<div class="line"><a name="l02943"></a><span class="lineno"> 2943</span>&#160;configuration as the Lagrangian coordinates so that</div>
<div class="line"><a name="l02944"></a><span class="lineno"> 2944</span>&#160;\f[</div>
<div class="line"><a name="l02945"></a><span class="lineno"> 2945</span>&#160;r_i(\xi^j) = \xi^i. \ \ \ \ \ \ \ \ (34)</div>
<div class="line"><a name="l02946"></a><span class="lineno"> 2946</span>&#160;\f]</div>
<div class="line"><a name="l02947"></a><span class="lineno"> 2947</span>&#160;With this choice, the tangent vectors to the undeformed coordinate lines</div>
<div class="line"><a name="l02948"></a><span class="lineno"> 2948</span>&#160;are the cartesian basis vectors</div>
<div class="line"><a name="l02949"></a><span class="lineno"> 2949</span>&#160;\f[</div>
<div class="line"><a name="l02950"></a><span class="lineno"> 2950</span>&#160;{\bf g}_i =  {\bf e}_i, </div>
<div class="line"><a name="l02951"></a><span class="lineno"> 2951</span>&#160;\f]</div>
<div class="line"><a name="l02952"></a><span class="lineno"> 2952</span>&#160;and the undeformed metric tensor is the Kronecker delta</div>
<div class="line"><a name="l02953"></a><span class="lineno"> 2953</span>&#160;(the unit matrix)</div>
<div class="line"><a name="l02954"></a><span class="lineno"> 2954</span>&#160;\f[</div>
<div class="line"><a name="l02955"></a><span class="lineno"> 2955</span>&#160;g_{ij} = \delta_{ij}.</div>
<div class="line"><a name="l02956"></a><span class="lineno"> 2956</span>&#160;\f]</div>
<div class="line"><a name="l02957"></a><span class="lineno"> 2957</span>&#160;We now expand the (unknown) deformed position vector in the same basis,</div>
<div class="line"><a name="l02958"></a><span class="lineno"> 2958</span>&#160;\f[</div>
<div class="line"><a name="l02959"></a><span class="lineno"> 2959</span>&#160;{\bf R}(\xi^j) = R_i(\xi^j) \ {\bf e}_i,</div>
<div class="line"><a name="l02960"></a><span class="lineno"> 2960</span>&#160;\f]</div>
<div class="line"><a name="l02961"></a><span class="lineno"> 2961</span>&#160;and derive a finite element approximation for this vector field</div>
<div class="line"><a name="l02962"></a><span class="lineno"> 2962</span>&#160;from the principle of virtual displacements. For this purpose we decompose</div>
<div class="line"><a name="l02963"></a><span class="lineno"> 2963</span>&#160;the undeformed body into a number of finite elements, using the</div>
<div class="line"><a name="l02964"></a><span class="lineno"> 2964</span>&#160;standard mesh generation process described previously.</div>
<div class="line"><a name="l02965"></a><span class="lineno"> 2965</span>&#160;This establishes the Eulerian position \f$ X_{ij}^{(0)} \</div>
<div class="line"><a name="l02966"></a><span class="lineno"> 2966</span>&#160;(j=1,...,N) \f$ of the \f$ N \f$</div>
<div class="line"><a name="l02967"></a><span class="lineno"> 2967</span>&#160;nodes in the body&#39;s undeformed configuration.</div>
<div class="line"><a name="l02968"></a><span class="lineno"> 2968</span>&#160;Since the Eulerian coordinates of material points in the undeformed </div>
<div class="line"><a name="l02969"></a><span class="lineno"> 2969</span>&#160;configuration coincide with their Lagrangian coordinates (see </div>
<div class="line"><a name="l02970"></a><span class="lineno"> 2970</span>&#160;(34)), a finite-element representation of the </div>
<div class="line"><a name="l02971"></a><span class="lineno"> 2971</span>&#160;Lagrangian coordinates is established by writing</div>
<div class="line"><a name="l02972"></a><span class="lineno"> 2972</span>&#160;\f[</div>
<div class="line"><a name="l02973"></a><span class="lineno"> 2973</span>&#160;\xi^i = \sum_{j=1}^{N} \Xi_{ij} \ \psi_j,</div>
<div class="line"><a name="l02974"></a><span class="lineno"> 2974</span>&#160;\f]</div>
<div class="line"><a name="l02975"></a><span class="lineno"> 2975</span>&#160;where \f$ \Xi_{ij} = X_{ij}^{(0)} \f$ is the \f$i\f$-th </div>
<div class="line"><a name="l02976"></a><span class="lineno"> 2976</span>&#160;Lagrangian coordinate of global node \f$j\f$, and the \f$\psi_j\f$</div>
<div class="line"><a name="l02977"></a><span class="lineno"> 2977</span>&#160;are the global finite-element shape functions. In practice, the</div>
<div class="line"><a name="l02978"></a><span class="lineno"> 2978</span>&#160;\f$\psi_j\f$ are, of course, represented by local shape functions, </div>
<div class="line"><a name="l02979"></a><span class="lineno"> 2979</span>&#160;\f$\psi_j(s_k)\f$, so that the Lagrangian coordinate at local </div>
<div class="line"><a name="l02980"></a><span class="lineno"> 2980</span>&#160;coordinate \f$ s_k \f$ in element \f$ e \f$ is given by</div>
<div class="line"><a name="l02981"></a><span class="lineno"> 2981</span>&#160;\f[</div>
<div class="line"><a name="l02982"></a><span class="lineno"> 2982</span>&#160;\xi^i(s_k) = \sum_{j=1}^{n} \Xi_{i{\cal J}(j,e)} \ \psi_j(s_k).</div>
<div class="line"><a name="l02983"></a><span class="lineno"> 2983</span>&#160;\f]</div>
<div class="line"><a name="l02984"></a><span class="lineno"> 2984</span>&#160;We employ the same basis functions to represent the components of </div>
<div class="line"><a name="l02985"></a><span class="lineno"> 2985</span>&#160;the unknown vector field \f$ {\bf R}(\xi^j)\f$, by writing</div>
<div class="line"><a name="l02986"></a><span class="lineno"> 2986</span>&#160;\f[</div>
<div class="line"><a name="l02987"></a><span class="lineno"> 2987</span>&#160;R_i(\xi^k) = \sum_{j=1}^{n} X_{ij} \ \psi_j(\xi^k),</div>
<div class="line"><a name="l02988"></a><span class="lineno"> 2988</span>&#160;\ \ \ \ \ \ \ \   (35)</div>
<div class="line"><a name="l02989"></a><span class="lineno"> 2989</span>&#160;\f]</div>
<div class="line"><a name="l02990"></a><span class="lineno"> 2990</span>&#160;and treat the (Eulerian) nodal positions \f$ X_{ij} \f$ as </div>
<div class="line"><a name="l02991"></a><span class="lineno"> 2991</span>&#160;the unknowns. With this discretisation, the </div>
<div class="line"><a name="l02992"></a><span class="lineno"> 2992</span>&#160;variations in  \f$ {\bf R}(\xi^j) \f$ correspond to variations</div>
<div class="line"><a name="l02993"></a><span class="lineno"> 2993</span>&#160;in the nodal positions \f$ X_{ij} \f$ so that</div>
<div class="line"><a name="l02994"></a><span class="lineno"> 2994</span>&#160;\f[</div>
<div class="line"><a name="l02995"></a><span class="lineno"> 2995</span>&#160;\delta {\bf R} =   \sum_{j=1}^{N} \delta X_{ij} \ \psi_j \ {\bf e}_i</div>
<div class="line"><a name="l02996"></a><span class="lineno"> 2996</span>&#160;\f]</div>
<div class="line"><a name="l02997"></a><span class="lineno"> 2997</span>&#160;\f[</div>
<div class="line"><a name="l02998"></a><span class="lineno"> 2998</span>&#160;\delta \frac{\partial {\bf R}}{\partial \xi^k} = </div>
<div class="line"><a name="l02999"></a><span class="lineno"> 2999</span>&#160;\sum_{j=1}^{N} \delta X_{ij} \ </div>
<div class="line"><a name="l03000"></a><span class="lineno"> 3000</span>&#160;\frac{\partial \psi_j}{\partial \xi^k} \ {\bf e}_i,</div>
<div class="line"><a name="l03001"></a><span class="lineno"> 3001</span>&#160;\f]</div>
<div class="line"><a name="l03002"></a><span class="lineno"> 3002</span>&#160;\f[</div>
<div class="line"><a name="l03003"></a><span class="lineno"> 3003</span>&#160;\mbox{ etc. }</div>
<div class="line"><a name="l03004"></a><span class="lineno"> 3004</span>&#160;\f]</div>
<div class="line"><a name="l03005"></a><span class="lineno"> 3005</span>&#160;The principle of virtual displacement  (31) </div>
<div class="line"><a name="l03006"></a><span class="lineno"> 3006</span>&#160;therefore becomes</div>
<div class="line"><a name="l03007"></a><span class="lineno"> 3007</span>&#160; \f[\sum_{m=1}^{N}</div>
<div class="line"><a name="l03008"></a><span class="lineno"> 3008</span>&#160; \left\{</div>
<div class="line"><a name="l03009"></a><span class="lineno"> 3009</span>&#160;  \int \left[ \sigma^{ij} \ </div>
<div class="line"><a name="l03010"></a><span class="lineno"> 3010</span>&#160;  \left(\sum_{l=1}^N X_{kl} \frac{\partial \psi_l}{\partial \xi^i} \right)</div>
<div class="line"><a name="l03011"></a><span class="lineno"> 3011</span>&#160;       \frac{\partial \psi_m}{\partial \xi^j} \</div>
<div class="line"><a name="l03012"></a><span class="lineno"> 3012</span>&#160;      - \left( f_k - </div>
<div class="line"><a name="l03013"></a><span class="lineno"> 3013</span>&#160;  \Lambda^2 \left(\sum_{l=1}^N</div>
<div class="line"><a name="l03014"></a><span class="lineno"> 3014</span>&#160;    \frac{\partial^2 X_{kl}}{\partial t^2} \psi_l \right) \right) </div>
<div class="line"><a name="l03015"></a><span class="lineno"> 3015</span>&#160; \psi_m \right] \ \Gamma \ dv </div>
<div class="line"><a name="l03016"></a><span class="lineno"> 3016</span>&#160; - \oint_{A_{tract}} t_k \ \psi_m \ dA \right\} </div>
<div class="line"><a name="l03017"></a><span class="lineno"> 3017</span>&#160; \delta X_{km}  =0. \ \ \ \  (36)</div>
<div class="line"><a name="l03018"></a><span class="lineno"> 3018</span>&#160; \f]</div>
<div class="line"><a name="l03019"></a><span class="lineno"> 3019</span>&#160;[Note that summation convention enforces the summation over the index </div>
<div class="line"><a name="l03020"></a><span class="lineno"> 3020</span>&#160;\f$ k \f$.]</div>
<div class="line"><a name="l03021"></a><span class="lineno"> 3021</span>&#160;The displacement boundary condition (19)</div>
<div class="line"><a name="l03022"></a><span class="lineno"> 3022</span>&#160;determines the positions of all nodes that are located on the</div>
<div class="line"><a name="l03023"></a><span class="lineno"> 3023</span>&#160;boundary \f$A_{displ}\f$, </div>
<div class="line"><a name="l03024"></a><span class="lineno"> 3024</span>&#160;\f[</div>
<div class="line"><a name="l03025"></a><span class="lineno"> 3025</span>&#160; X_{ij} = R^{(BC)}_i(\Xi_{lj}) \mbox{ \ \ \ if node $j$ is </div>
<div class="line"><a name="l03026"></a><span class="lineno"> 3026</span>&#160; located on $A_{displ},$}</div>
<div class="line"><a name="l03027"></a><span class="lineno"> 3027</span>&#160;\f]</div>
<div class="line"><a name="l03028"></a><span class="lineno"> 3028</span>&#160;and equation (21) </div>
<div class="line"><a name="l03029"></a><span class="lineno"> 3029</span>&#160;requires their variations to vanish,</div>
<div class="line"><a name="l03030"></a><span class="lineno"> 3030</span>&#160;\f[</div>
<div class="line"><a name="l03031"></a><span class="lineno"> 3031</span>&#160; \delta X_{ij} = 0 \mbox{ \ \ \ if node $j$ is located on $A_{displ}.$}</div>
<div class="line"><a name="l03032"></a><span class="lineno"> 3032</span>&#160;\f]</div>
<div class="line"><a name="l03033"></a><span class="lineno"> 3033</span>&#160;The variations of all other nodal positions are arbitrary (and independent</div>
<div class="line"><a name="l03034"></a><span class="lineno"> 3034</span>&#160;of each other), therefore the terms in the curly brackets in </div>
<div class="line"><a name="l03035"></a><span class="lineno"> 3035</span>&#160;(36) need to vanish individually. This provides one </div>
<div class="line"><a name="l03036"></a><span class="lineno"> 3036</span>&#160;(discrete) equation for each unknown \f$X_{km}\f$</div>
<div class="line"><a name="l03037"></a><span class="lineno"> 3037</span>&#160; \f[ f_{km} = </div>
<div class="line"><a name="l03038"></a><span class="lineno"> 3038</span>&#160;  \int \left[ \sigma^{ij} \ </div>
<div class="line"><a name="l03039"></a><span class="lineno"> 3039</span>&#160;  \left(\sum_{k=1}^N X_{kl} \frac{\partial \psi_l}{\partial \xi^i} \right)</div>
<div class="line"><a name="l03040"></a><span class="lineno"> 3040</span>&#160;       \frac{\partial \psi_m}{\partial \xi^j} \</div>
<div class="line"><a name="l03041"></a><span class="lineno"> 3041</span>&#160;      - \left( f_k - </div>
<div class="line"><a name="l03042"></a><span class="lineno"> 3042</span>&#160;  \Lambda^2 \left(\sum_{k=1}^N</div>
<div class="line"><a name="l03043"></a><span class="lineno"> 3043</span>&#160;    \frac{\partial^2 X_{kl}}{\partial t^2} \psi_l \right) \right) </div>
<div class="line"><a name="l03044"></a><span class="lineno"> 3044</span>&#160; \psi_m \right] \ \Gamma \ dv \</div>
<div class="line"><a name="l03045"></a><span class="lineno"> 3045</span>&#160; - \oint_{A_{tract}} t_k \ \psi_m \ dA </div>
<div class="line"><a name="l03046"></a><span class="lineno"> 3046</span>&#160;  =0. \ \ \ \ \  \ \ \ \ (37)</div>
<div class="line"><a name="l03047"></a><span class="lineno"> 3047</span>&#160; \f]</div>
<div class="line"><a name="l03048"></a><span class="lineno"> 3048</span>&#160;These equations can again be assembled in an element-by-element</div>
<div class="line"><a name="l03049"></a><span class="lineno"> 3049</span>&#160;fashion.</div>
<div class="line"><a name="l03050"></a><span class="lineno"> 3050</span>&#160; </div>
<div class="line"><a name="l03051"></a><span class="lineno"> 3051</span>&#160;\subsubsection solid_implementation Implementation</div>
<div class="line"><a name="l03052"></a><span class="lineno"> 3052</span>&#160;We will now discuss how the discrete equations (37) are</div>
<div class="line"><a name="l03053"></a><span class="lineno"> 3053</span>&#160;implemented in \c oomph-lib. To facilitate the analysis</div>
<div class="line"><a name="l03054"></a><span class="lineno"> 3054</span>&#160;of multi-physics problems, we introduce generalisations of the \c Node, </div>
<div class="line"><a name="l03055"></a><span class="lineno"> 3055</span>&#160;\c FiniteElement and \c Mesh classes which provide</div>
<div class="line"><a name="l03056"></a><span class="lineno"> 3056</span>&#160;separate storage (and access functions) for all solid mechanics</div>
<div class="line"><a name="l03057"></a><span class="lineno"> 3057</span>&#160;Data. The resulting \c SolidFiniteElements can </div>
<div class="line"><a name="l03058"></a><span class="lineno"> 3058</span>&#160;be used as stand-alone elements for the simulation of </div>
<div class="line"><a name="l03059"></a><span class="lineno"> 3059</span>&#160;pure solid mechanics problems. More importantly, however, the design</div>
<div class="line"><a name="l03060"></a><span class="lineno"> 3060</span>&#160;makes it easy to employ multiple inheritance to create </div>
<div class="line"><a name="l03061"></a><span class="lineno"> 3061</span>&#160;more complex elements that solve the equations of solid mechanics</div>
<div class="line"><a name="l03062"></a><span class="lineno"> 3062</span>&#160;together with </div>
<div class="line"><a name="l03063"></a><span class="lineno"> 3063</span>&#160;any other field equations. For instance, if we combine</div>
<div class="line"><a name="l03064"></a><span class="lineno"> 3064</span>&#160;a \c FiniteElement that solves the unsteady heat equation</div>
<div class="line"><a name="l03065"></a><span class="lineno"> 3065</span>&#160;with an \c SolidFiniteElement that describes the elastic </div>
<div class="line"><a name="l03066"></a><span class="lineno"> 3066</span>&#160;deformations, we obtain an element that can be used to simulate </div>
<div class="line"><a name="l03067"></a><span class="lineno"> 3067</span>&#160;unsteady heat conduction in an elastic body that performs </div>
<div class="line"><a name="l03068"></a><span class="lineno"> 3068</span>&#160;large-amplitude oscillations, say.</div>
<div class="line"><a name="l03069"></a><span class="lineno"> 3069</span>&#160; </div>
<div class="line"><a name="l03070"></a><span class="lineno"> 3070</span>&#160;&lt;CENTER&gt; &lt;B&gt;The SolidNode class:&lt;/B&gt;&lt;/CENTER&gt; </div>
<div class="line"><a name="l03071"></a><span class="lineno"> 3071</span>&#160;The class \c SolidNode is derived from \c Node and </div>
<div class="line"><a name="l03072"></a><span class="lineno"> 3072</span>&#160;implements the additional functionality required for solid</div>
<div class="line"><a name="l03073"></a><span class="lineno"> 3073</span>&#160;mechanics problems. The key new feature is that each Node</div>
<div class="line"><a name="l03074"></a><span class="lineno"> 3074</span>&#160;needs to store its (fixed) Lagrangian coordinate \f$ \Xi_{ij}\f$,</div>
<div class="line"><a name="l03075"></a><span class="lineno"> 3075</span>&#160;while its Eulerian position  \f$ X_{ij}\f$ needs to be regarded</div>
<div class="line"><a name="l03076"></a><span class="lineno"> 3076</span>&#160;as an unknown. This requires the following changes to</div>
<div class="line"><a name="l03077"></a><span class="lineno"> 3077</span>&#160;member functions of the \c Node class:</div>
<div class="line"><a name="l03078"></a><span class="lineno"> 3078</span>&#160; </div>
<div class="line"><a name="l03079"></a><span class="lineno"> 3079</span>&#160;- The function \c Node::x(...) returns the</div>
<div class="line"><a name="l03080"></a><span class="lineno"> 3080</span>&#160;  Eulerian coordinates of the \c Node. Internally, this function</div>
<div class="line"><a name="l03081"></a><span class="lineno"> 3081</span>&#160;  accesses the nodal coordinates via pointers to double</div>
<div class="line"><a name="l03082"></a><span class="lineno"> 3082</span>&#160;  precision numbers. This data structure is adequate for</div>
<div class="line"><a name="l03083"></a><span class="lineno"> 3083</span>&#160;  problems in which the nodal positions are either known a priori </div>
<div class="line"><a name="l03084"></a><span class="lineno"> 3084</span>&#160;  or determined by an algebraic node update function. However, the</div>
<div class="line"><a name="l03085"></a><span class="lineno"> 3085</span>&#160;  scheme does not allow us to regard the nodal positions as</div>
<div class="line"><a name="l03086"></a><span class="lineno"> 3086</span>&#160;  unknowns -- as required by our expansion</div>
<div class="line"><a name="l03087"></a><span class="lineno"> 3087</span>&#160;  (35). In \c SolidNodes</div>
<div class="line"><a name="l03088"></a><span class="lineno"> 3088</span>&#160;  the nodal positions are therefore stored as \c Data (whose </div>
<div class="line"><a name="l03089"></a><span class="lineno"> 3089</span>&#160;  values can either be unknowns or pinned values, and which can have a time</div>
<div class="line"><a name="l03090"></a><span class="lineno"> 3090</span>&#160;  history). We overload the \c Node::x(...) function by </div>
<div class="line"><a name="l03091"></a><span class="lineno"> 3091</span>&#160;  \code</div>
<div class="line"><a name="l03092"></a><span class="lineno"> 3092</span>&#160;  SolidNode::x(...)</div>
<div class="line"><a name="l03093"></a><span class="lineno"> 3093</span>&#160;  \endcode</div>
<div class="line"><a name="l03094"></a><span class="lineno"> 3094</span>&#160;  which returns the (now variable) Eulerian nodal position of the node.</div>
<div class="line"><a name="l03095"></a><span class="lineno"> 3095</span>&#160;  The function</div>
<div class="line"><a name="l03096"></a><span class="lineno"> 3096</span>&#160;  \code</div>
<div class="line"><a name="l03097"></a><span class="lineno"> 3097</span>&#160;  SolidNode::position_eqn_number(...)</div>
<div class="line"><a name="l03098"></a><span class="lineno"> 3098</span>&#160;  \endcode</div>
<div class="line"><a name="l03099"></a><span class="lineno"> 3099</span>&#160;  gives access to the global equation number for each</div>
<div class="line"><a name="l03100"></a><span class="lineno"> 3100</span>&#160;  nodal coordinate and, following our usual convention, the function</div>
<div class="line"><a name="l03101"></a><span class="lineno"> 3101</span>&#160;  returns -1 if a coordinate is pinned.</div>
<div class="line"><a name="l03102"></a><span class="lineno"> 3102</span>&#160;- We introduce a new member function </div>
<div class="line"><a name="l03103"></a><span class="lineno"> 3103</span>&#160;  \code</div>
<div class="line"><a name="l03104"></a><span class="lineno"> 3104</span>&#160;  SolidNode::xi(...)</div>
<div class="line"><a name="l03105"></a><span class="lineno"> 3105</span>&#160;  \endcode</div>
<div class="line"><a name="l03106"></a><span class="lineno"> 3106</span>&#160;  which returns the (fixed) Lagrangian coordinates of the node.</div>
<div class="line"><a name="l03107"></a><span class="lineno"> 3107</span>&#160;- Both functions have the usual extensions to generalised</div>
<div class="line"><a name="l03108"></a><span class="lineno"> 3108</span>&#160;  coordinates</div>
<div class="line"><a name="l03109"></a><span class="lineno"> 3109</span>&#160;  \code</div>
<div class="line"><a name="l03110"></a><span class="lineno"> 3110</span>&#160;  SolidNode::x_gen(...)</div>
<div class="line"><a name="l03111"></a><span class="lineno"> 3111</span>&#160;  \endcode</div>
<div class="line"><a name="l03112"></a><span class="lineno"> 3112</span>&#160;  and </div>
<div class="line"><a name="l03113"></a><span class="lineno"> 3113</span>&#160;  \code</div>
<div class="line"><a name="l03114"></a><span class="lineno"> 3114</span>&#160;  SolidNode::xi_gen(...)</div>
<div class="line"><a name="l03115"></a><span class="lineno"> 3115</span>&#160;  \endcode</div>
<div class="line"><a name="l03116"></a><span class="lineno"> 3116</span>&#160;  which are required for Hermite elements and any other elements</div>
<div class="line"><a name="l03117"></a><span class="lineno"> 3117</span>&#160;  that use generalised nodal coordinates to interpolate the</div>
<div class="line"><a name="l03118"></a><span class="lineno"> 3118</span>&#160;  element&#39;s geometry.</div>
<div class="line"><a name="l03119"></a><span class="lineno"> 3119</span>&#160;- Similar to the \c Data member function \c Data::pin(...) which can</div>
<div class="line"><a name="l03120"></a><span class="lineno"> 3120</span>&#160;  be used to pin specific nodal values, we provide the function</div>
<div class="line"><a name="l03121"></a><span class="lineno"> 3121</span>&#160;  \code</div>
<div class="line"><a name="l03122"></a><span class="lineno"> 3122</span>&#160;  SolidNode::position_pin(...)</div>
<div class="line"><a name="l03123"></a><span class="lineno"> 3123</span>&#160;  \endcode</div>
<div class="line"><a name="l03124"></a><span class="lineno"> 3124</span>&#160;  which allows pinning of selected nodal coordinates.</div>
<div class="line"><a name="l03125"></a><span class="lineno"> 3125</span>&#160;- Dynamic problems require the evaluation of time-derivatives</div>
<div class="line"><a name="l03126"></a><span class="lineno"> 3126</span>&#160;  of the nodal positions, such as \f$ \partial^2 X_{ij}/\partial t^2\f$,</div>
<div class="line"><a name="l03127"></a><span class="lineno"> 3127</span>&#160;  see (37). These time-derivatives are evaluated by the</div>
<div class="line"><a name="l03128"></a><span class="lineno"> 3128</span>&#160;  \c TimeStepper of the positional \c Data.  By default,</div>
<div class="line"><a name="l03129"></a><span class="lineno"> 3129</span>&#160;  we use the same \c TimeStepper for the nodal \c Data and for the nodal </div>
<div class="line"><a name="l03130"></a><span class="lineno"> 3130</span>&#160;  positions. In multi-physics problems this might not be </div>
<div class="line"><a name="l03131"></a><span class="lineno"> 3131</span>&#160;  appropriate. Consider, for instance, solving an unsteady </div>
<div class="line"><a name="l03132"></a><span class="lineno"> 3132</span>&#160;  heat equation in a dynamically deforming, elastic body. In this problem</div>
<div class="line"><a name="l03133"></a><span class="lineno"> 3133</span>&#160;  the 2nd time-derivatives of the nodal position might be evaluated</div>
<div class="line"><a name="l03134"></a><span class="lineno"> 3134</span>&#160;  by a \c Newmark scheme, acting on the history values of the nodal</div>
<div class="line"><a name="l03135"></a><span class="lineno"> 3135</span>&#160;  positions, whereas the time-derivatives of the temperature</div>
<div class="line"><a name="l03136"></a><span class="lineno"> 3136</span>&#160;  might be determined by a \c BDF scheme, operating on the </div>
<div class="line"><a name="l03137"></a><span class="lineno"> 3137</span>&#160;  history values of the nodal \c Data.</div>
<div class="line"><a name="l03138"></a><span class="lineno"> 3138</span>&#160;  In such cases, the default assignment for the two timesteppers </div>
<div class="line"><a name="l03139"></a><span class="lineno"> 3139</span>&#160;  can be overwritten with the access functions</div>
<div class="line"><a name="l03140"></a><span class="lineno"> 3140</span>&#160;  \code</div>
<div class="line"><a name="l03141"></a><span class="lineno"> 3141</span>&#160;  SolidNode::position_time_stepper_pt()</div>
<div class="line"><a name="l03142"></a><span class="lineno"> 3142</span>&#160;  \endcode</div>
<div class="line"><a name="l03143"></a><span class="lineno"> 3143</span>&#160;  and </div>
<div class="line"><a name="l03144"></a><span class="lineno"> 3144</span>&#160;  \code</div>
<div class="line"><a name="l03145"></a><span class="lineno"> 3145</span>&#160;  SolidNode::time_stepper_pt()</div>
<div class="line"><a name="l03146"></a><span class="lineno"> 3146</span>&#160;  \endcode</div>
<div class="line"><a name="l03147"></a><span class="lineno"> 3147</span>&#160;  where the latter is inherited from \c Data::time_stepper_pt().</div>
<div class="line"><a name="l03148"></a><span class="lineno"> 3148</span>&#160;- Our implementation is based on the displacement form of the</div>
<div class="line"><a name="l03149"></a><span class="lineno"> 3149</span>&#160;  principle of virtual displacements in which the position vector </div>
<div class="line"><a name="l03150"></a><span class="lineno"> 3150</span>&#160;  \f$ {\bf R}(\xi^i) \f$ in the deformed configuration is regarded</div>
<div class="line"><a name="l03151"></a><span class="lineno"> 3151</span>&#160;  as the unknown vector field. Equation  (35)</div>
<div class="line"><a name="l03152"></a><span class="lineno"> 3152</span>&#160;  defines the representation of this vector</div>
<div class="line"><a name="l03153"></a><span class="lineno"> 3153</span>&#160;  field within each finite element in terms of the nodal coordinates.</div>
<div class="line"><a name="l03154"></a><span class="lineno"> 3154</span>&#160;  Some constitutive equations require the representation</div>
<div class="line"><a name="l03155"></a><span class="lineno"> 3155</span>&#160;  of additional (non-positional) variables.</div>
<div class="line"><a name="l03156"></a><span class="lineno"> 3156</span>&#160;  For instance, for incompressible (or nearly incompressible) materials,</div>
<div class="line"><a name="l03157"></a><span class="lineno"> 3157</span>&#160;  the stress \f$ \sigma^{ij} \f$ contains a contribution from the</div>
<div class="line"><a name="l03158"></a><span class="lineno"> 3158</span>&#160;  (scalar) pressure field \f$ p \f$; see the discussion of the</div>
<div class="line"><a name="l03159"></a><span class="lineno"> 3159</span>&#160;  constitutive equations above. If we choose a continuous</div>
<div class="line"><a name="l03160"></a><span class="lineno"> 3160</span>&#160;  representation for the pressure in which its value is</div>
<div class="line"><a name="l03161"></a><span class="lineno"> 3161</span>&#160;  interpolated between nodal values (as in Taylor-Hood-type</div>
<div class="line"><a name="l03162"></a><span class="lineno"> 3162</span>&#160;  elements), the nodal pressure values could in principle be stored</div>
<div class="line"><a name="l03163"></a><span class="lineno"> 3163</span>&#160;  in the &quot;normal&quot; nodal Data. However, to retain a clear </div>
<div class="line"><a name="l03164"></a><span class="lineno"> 3164</span>&#160;  distinction between</div>
<div class="line"><a name="l03165"></a><span class="lineno"> 3165</span>&#160;  solid-mechanics and non-solid-mechanics quantities we store</div>
<div class="line"><a name="l03166"></a><span class="lineno"> 3166</span>&#160;  such &quot;additional nodal solid values&quot; in their own \c Data object </div>
<div class="line"><a name="l03167"></a><span class="lineno"> 3167</span>&#160;  to which we provide access with the function</div>
<div class="line"><a name="l03168"></a><span class="lineno"> 3168</span>&#160;  \code</div>
<div class="line"><a name="l03169"></a><span class="lineno"> 3169</span>&#160;  SolidNode::additional_solid_data_pt()</div>
<div class="line"><a name="l03170"></a><span class="lineno"> 3170</span>&#160;  \endcode</div>
<div class="line"><a name="l03171"></a><span class="lineno"> 3171</span>&#160;  As with all other nodal quantities, the number of additional </div>
<div class="line"><a name="l03172"></a><span class="lineno"> 3172</span>&#160;  solid data values, needs to be specified as an argument to the</div>
<div class="line"><a name="l03173"></a><span class="lineno"> 3173</span>&#160;  \c SolidNode constructor when the \c SolidNode is created.</div>
<div class="line"><a name="l03174"></a><span class="lineno"> 3174</span>&#160;  The access function</div>
<div class="line"><a name="l03175"></a><span class="lineno"> 3175</span>&#160;  \code</div>
<div class="line"><a name="l03176"></a><span class="lineno"> 3176</span>&#160;  SolidNode::nadditional_solid_value()</div>
<div class="line"><a name="l03177"></a><span class="lineno"> 3177</span>&#160;  \endcode</div>
<div class="line"><a name="l03178"></a><span class="lineno"> 3178</span>&#160;  returns the number of additional solid values that are stored</div>
<div class="line"><a name="l03179"></a><span class="lineno"> 3179</span>&#160;  at an \c SolidNode; the function</div>
<div class="line"><a name="l03180"></a><span class="lineno"> 3180</span>&#160;  \code</div>
<div class="line"><a name="l03181"></a><span class="lineno"> 3181</span>&#160;  SolidNode::additional_solid_eqn_number(...)</div>
<div class="line"><a name="l03182"></a><span class="lineno"> 3182</span>&#160;  \endcode</div>
<div class="line"><a name="l03183"></a><span class="lineno"> 3183</span>&#160;  returns the global equation number of the SolidNode&#39;s </div>
<div class="line"><a name="l03184"></a><span class="lineno"> 3184</span>&#160;  additional solid values, and there are further member functions</div>
<div class="line"><a name="l03185"></a><span class="lineno"> 3185</span>&#160;  that allow pinning/unpinning of these values, etc.</div>
<div class="line"><a name="l03186"></a><span class="lineno"> 3186</span>&#160;- Finally, \c SolidNodes overload the function </div>
<div class="line"><a name="l03187"></a><span class="lineno"> 3187</span>&#160;  \c Data::assign_eqn_numbers()</div>
<div class="line"><a name="l03188"></a><span class="lineno"> 3188</span>&#160;  with </div>
<div class="line"><a name="l03189"></a><span class="lineno"> 3189</span>&#160;  \code</div>
<div class="line"><a name="l03190"></a><span class="lineno"> 3190</span>&#160;  SolidNode::assign_eqn_numbers()</div>
<div class="line"><a name="l03191"></a><span class="lineno"> 3191</span>&#160;  \endcode</div>
<div class="line"><a name="l03192"></a><span class="lineno"> 3192</span>&#160;  which creates global equation numbers for all (non-pinned) </div>
<div class="line"><a name="l03193"></a><span class="lineno"> 3193</span>&#160;  positional values and any additional (nodal) solid values, and</div>
<div class="line"><a name="l03194"></a><span class="lineno"> 3194</span>&#160;  then deals with the &quot;normal&quot; nodal Data by calling</div>
<div class="line"><a name="l03195"></a><span class="lineno"> 3195</span>&#160;  \c Data::assign_eqn_numbers().</div>
<div class="line"><a name="l03196"></a><span class="lineno"> 3196</span>&#160; </div>
<div class="line"><a name="l03197"></a><span class="lineno"> 3197</span>&#160;&lt;CENTER&gt;&lt;B&gt;The SolidFiniteElement class:&lt;/B&gt;&lt;/CENTER&gt;</div>
<div class="line"><a name="l03198"></a><span class="lineno"> 3198</span>&#160;The class \c SolidFiniteElement is derived from \c FiniteElement and </div>
<div class="line"><a name="l03199"></a><span class="lineno"> 3199</span>&#160;implements the additional functionality required for solid</div>
<div class="line"><a name="l03200"></a><span class="lineno"> 3200</span>&#160;mechanics problems. Again, most of the additional (or revised)</div>
<div class="line"><a name="l03201"></a><span class="lineno"> 3201</span>&#160;functionality is related to the presence of the two coordinate</div>
<div class="line"><a name="l03202"></a><span class="lineno"> 3202</span>&#160;systems which requires the following changes to \c FiniteElement</div>
<div class="line"><a name="l03203"></a><span class="lineno"> 3203</span>&#160;member functions:</div>
<div class="line"><a name="l03204"></a><span class="lineno"> 3204</span>&#160;- The nodes of \c SolidFiniteElements are \c SolidNodes, therefore</div>
<div class="line"><a name="l03205"></a><span class="lineno"> 3205</span>&#160;  we overload the function \c FiniteElements::construct_node(...)</div>
<div class="line"><a name="l03206"></a><span class="lineno"> 3206</span>&#160;  to ensure that an \c SolidNode with the appropriate </div>
<div class="line"><a name="l03207"></a><span class="lineno"> 3207</span>&#160;  amount of storage is built. As in the case of \c FiniteElements, </div>
<div class="line"><a name="l03208"></a><span class="lineno"> 3208</span>&#160;  the required spatial dimension of the elements&#39; constituent </div>
<div class="line"><a name="l03209"></a><span class="lineno"> 3209</span>&#160;  nodes, their number of nodal values etc. are specified via</div>
<div class="line"><a name="l03210"></a><span class="lineno"> 3210</span>&#160;  the \c FiniteElement&#39;s (pure) virtual member functions </div>
<div class="line"><a name="l03211"></a><span class="lineno"> 3211</span>&#160;  \c FiniteElement::required_ndim(...),</div>
<div class="line"><a name="l03212"></a><span class="lineno"> 3212</span>&#160;  \c FiniteElement::required_nvalue(...), etc, which need to be</div>
<div class="line"><a name="l03213"></a><span class="lineno"> 3213</span>&#160;  implemented for all specific elements that are derived from</div>
<div class="line"><a name="l03214"></a><span class="lineno"> 3214</span>&#160;  the \c SolidFiniteElement base class.  As discussed above, the </div>
<div class="line"><a name="l03215"></a><span class="lineno"> 3215</span>&#160;  constructor of the \c SolidNodes requires additional parameters, such</div>
<div class="line"><a name="l03216"></a><span class="lineno"> 3216</span>&#160;  as the number of Lagrangian coordinates. These need to be specified </div>
<div class="line"><a name="l03217"></a><span class="lineno"> 3217</span>&#160;  by implementing \c SolidFiniteElement::required_nlagrangian(...) </div>
<div class="line"><a name="l03218"></a><span class="lineno"> 3218</span>&#160;  and similar other functions. As in the </div>
<div class="line"><a name="l03219"></a><span class="lineno"> 3219</span>&#160;  case of \c FiniteElements, many of these functions are already</div>
<div class="line"><a name="l03220"></a><span class="lineno"> 3220</span>&#160;  implemented as virtual (rather than pure virtual) functions which provide</div>
<div class="line"><a name="l03221"></a><span class="lineno"> 3221</span>&#160;  sensible default values. For instance, by default, the number</div>
<div class="line"><a name="l03222"></a><span class="lineno"> 3222</span>&#160;  of additional nodal solid values is set to zero, etc. Such</div>
<div class="line"><a name="l03223"></a><span class="lineno"> 3223</span>&#160;  functions need to be overloaded in specific derived elements</div>
<div class="line"><a name="l03224"></a><span class="lineno"> 3224</span>&#160;  if the default values are not appropriate.</div>
<div class="line"><a name="l03225"></a><span class="lineno"> 3225</span>&#160;- The interpolation of the Eulerian coordinates, implemented</div>
<div class="line"><a name="l03226"></a><span class="lineno"> 3226</span>&#160;  in \c FiniteElement::interpolated_x(...), can remain unchanged</div>
<div class="line"><a name="l03227"></a><span class="lineno"> 3227</span>&#160;  because of the way in which we have overloaded \c Node::x(...) with</div>
<div class="line"><a name="l03228"></a><span class="lineno"> 3228</span>&#160;  SolidNode::x(...). \c SolidFiniteElements provide additional</div>
<div class="line"><a name="l03229"></a><span class="lineno"> 3229</span>&#160;  functions, such as </div>
<div class="line"><a name="l03230"></a><span class="lineno"> 3230</span>&#160;  \code</div>
<div class="line"><a name="l03231"></a><span class="lineno"> 3231</span>&#160;  SolidFiniteElement::interpolated_xi(...)</div>
<div class="line"><a name="l03232"></a><span class="lineno"> 3232</span>&#160;  \endcode</div>
<div class="line"><a name="l03233"></a><span class="lineno"> 3233</span>&#160;  which determines the interpolated Lagrangian coordinates at</div>
<div class="line"><a name="l03234"></a><span class="lineno"> 3234</span>&#160;  a specified local coordinate within the element, or</div>
<div class="line"><a name="l03235"></a><span class="lineno"> 3235</span>&#160;  \code</div>
<div class="line"><a name="l03236"></a><span class="lineno"> 3236</span>&#160;  SolidFiniteElement::xi(...)</div>
<div class="line"><a name="l03237"></a><span class="lineno"> 3237</span>&#160;  \endcode</div>
<div class="line"><a name="l03238"></a><span class="lineno"> 3238</span>&#160;  which provides a wrapper for the nodal values of the</div>
<div class="line"><a name="l03239"></a><span class="lineno"> 3239</span>&#160;  Lagrangian coordinates. </div>
<div class="line"><a name="l03240"></a><span class="lineno"> 3240</span>&#160;- The displacement form of the principle of virtual displacements </div>
<div class="line"><a name="l03241"></a><span class="lineno"> 3241</span>&#160;  (37) contains derivatives of the shape functions</div>
<div class="line"><a name="l03242"></a><span class="lineno"> 3242</span>&#160;  with respect to the Lagrangian (rather than the Eulerian)</div>
<div class="line"><a name="l03243"></a><span class="lineno"> 3243</span>&#160;  coordinates. Their computation is implemented in</div>
<div class="line"><a name="l03244"></a><span class="lineno"> 3244</span>&#160;  \code</div>
<div class="line"><a name="l03245"></a><span class="lineno"> 3245</span>&#160;  SolidFiniteElement::dshape_lagrangian(...)</div>
<div class="line"><a name="l03246"></a><span class="lineno"> 3246</span>&#160;  \endcode</div>
<div class="line"><a name="l03247"></a><span class="lineno"> 3247</span>&#160;- We have already discussed the need to represent</div>
<div class="line"><a name="l03248"></a><span class="lineno"> 3248</span>&#160;  additional, non-positional solid variables (such as pressures)</div>
<div class="line"><a name="l03249"></a><span class="lineno"> 3249</span>&#160;  within an \c SolidFiniteElement. The storage </div>
<div class="line"><a name="l03250"></a><span class="lineno"> 3250</span>&#160;  of the &quot;additional solid values&quot; at the \c SolidNodes</div>
<div class="line"><a name="l03251"></a><span class="lineno"> 3251</span>&#160;  allows a globally continuous representation of such variables</div>
<div class="line"><a name="l03252"></a><span class="lineno"> 3252</span>&#160;  (similar to the continuous pressure representation in Taylor-Hood</div>
<div class="line"><a name="l03253"></a><span class="lineno"> 3253</span>&#160;  elements). Discontinuous representations</div>
<div class="line"><a name="l03254"></a><span class="lineno"> 3254</span>&#160;  (as in Crouzeix-Raviart elements) require the </div>
<div class="line"><a name="l03255"></a><span class="lineno"> 3255</span>&#160;  storage of additional internal solid variables. In principle, these</div>
<div class="line"><a name="l03256"></a><span class="lineno"> 3256</span>&#160;  could again be stored in the \c FiniteElement&#39;s internal Data</div>
<div class="line"><a name="l03257"></a><span class="lineno"> 3257</span>&#160;  but for the reasons outlined at the beginning of this section, </div>
<div class="line"><a name="l03258"></a><span class="lineno"> 3258</span>&#160;  we store \e all solid variables in separate Data items.</div>
<div class="line"><a name="l03259"></a><span class="lineno"> 3259</span>&#160;  The function </div>
<div class="line"><a name="l03260"></a><span class="lineno"> 3260</span>&#160;  \code</div>
<div class="line"><a name="l03261"></a><span class="lineno"> 3261</span>&#160;  SolidFiniteElement::internal_solid_data_pt(...)</div>
<div class="line"><a name="l03262"></a><span class="lineno"> 3262</span>&#160;  \endcode</div>
<div class="line"><a name="l03263"></a><span class="lineno"> 3263</span>&#160;  provides access to the additional internal solid \c Data.</div>
<div class="line"><a name="l03264"></a><span class="lineno"> 3264</span>&#160;  The total number of \c Data items stored as </div>
<div class="line"><a name="l03265"></a><span class="lineno"> 3265</span>&#160;  internal solid \c Data  can be obtained from </div>
<div class="line"><a name="l03266"></a><span class="lineno"> 3266</span>&#160;  \code</div>
<div class="line"><a name="l03267"></a><span class="lineno"> 3267</span>&#160;  SolidFiniteElement::ninternal_solid_data() </div>
<div class="line"><a name="l03268"></a><span class="lineno"> 3268</span>&#160;  \endcode</div>
<div class="line"><a name="l03269"></a><span class="lineno"> 3269</span>&#160;- We have now created storage and access functions for all the </div>
<div class="line"><a name="l03270"></a><span class="lineno"> 3270</span>&#160;  additional \c Data that is required for solid mechanics problems: </div>
<div class="line"><a name="l03271"></a><span class="lineno"> 3271</span>&#160;  - Data that represents the nodal positions,</div>
<div class="line"><a name="l03272"></a><span class="lineno"> 3272</span>&#160;  - Data that represents additional, non-positional nodal Data</div>
<div class="line"><a name="l03273"></a><span class="lineno"> 3273</span>&#160;    such as continuously interpolated pressures, and</div>
<div class="line"><a name="l03274"></a><span class="lineno"> 3274</span>&#160;  - Data that represents additional internal Data, used, e.g.,</div>
<div class="line"><a name="l03275"></a><span class="lineno"> 3275</span>&#160;    to represent discontinuously interpolated pressures.</div>
<div class="line"><a name="l03276"></a><span class="lineno"> 3276</span>&#160;  .</div>
<div class="line"><a name="l03277"></a><span class="lineno"> 3277</span>&#160;  We need to ensure that</div>
<div class="line"><a name="l03278"></a><span class="lineno"> 3278</span>&#160;  these Data items are included in the various equation numbering</div>
<div class="line"><a name="l03279"></a><span class="lineno"> 3279</span>&#160;  schemes. This only requires overloading of </div>
<div class="line"><a name="l03280"></a><span class="lineno"> 3280</span>&#160;  \c FiniteElement::assign_internal_eqn_numbers(...)</div>
<div class="line"><a name="l03281"></a><span class="lineno"> 3281</span>&#160;  with a version that also sets up the global equation numbers</div>
<div class="line"><a name="l03282"></a><span class="lineno"> 3282</span>&#160;  for the additional internal solid values. </div>
<div class="line"><a name="l03283"></a><span class="lineno"> 3283</span>&#160;  Furthermore, we provide the function</div>
<div class="line"><a name="l03284"></a><span class="lineno"> 3284</span>&#160;  \c SolidFiniteElement::assign_solid_local_eqn_numbers() </div>
<div class="line"><a name="l03285"></a><span class="lineno"> 3285</span>&#160;  which sets up the local equation numbering scheme for all</div>
<div class="line"><a name="l03286"></a><span class="lineno"> 3286</span>&#160;  solid Data associated with an element. This function will be</div>
<div class="line"><a name="l03287"></a><span class="lineno"> 3287</span>&#160;  called from the overloaded </div>
<div class="line"><a name="l03288"></a><span class="lineno"> 3288</span>&#160;  \c SolidMesh::assign_local_eqn_numbers()</div>
<div class="line"><a name="l03289"></a><span class="lineno"> 3289</span>&#160;  function to be discussed in the next section.</div>
<div class="line"><a name="l03290"></a><span class="lineno"> 3290</span>&#160;- We&#39;re done! \c SolidFiniteElements now form a suitable basis for</div>
<div class="line"><a name="l03291"></a><span class="lineno"> 3291</span>&#160;  all elements whose deformation is determined</div>
<div class="line"><a name="l03292"></a><span class="lineno"> 3292</span>&#160;  by the equations of solid mechanics (or some variant thereof). </div>
<div class="line"><a name="l03293"></a><span class="lineno"> 3293</span>&#160;  To implement a specific</div>
<div class="line"><a name="l03294"></a><span class="lineno"> 3294</span>&#160;  solid mechanics element, we need to represent its geometry,</div>
<div class="line"><a name="l03295"></a><span class="lineno"> 3295</span>&#160;  its state of stress, etc., in terms of the \c</div>
<div class="line"><a name="l03296"></a><span class="lineno"> 3296</span>&#160;  SolidFiniteElement&#39;s nodal and additional internal solid</div>
<div class="line"><a name="l03297"></a><span class="lineno"> 3297</span>&#160;  \c Data. This requires the specification of the shape functions</div>
<div class="line"><a name="l03298"></a><span class="lineno"> 3298</span>&#160;  and the functions that compute the element&#39;s Jacobian matrix</div>
<div class="line"><a name="l03299"></a><span class="lineno"> 3299</span>&#160;  and its residual vector -- the latter implementing the </div>
<div class="line"><a name="l03300"></a><span class="lineno"> 3300</span>&#160;  element&#39;s contribution to the global residual vector defined by the </div>
<div class="line"><a name="l03301"></a><span class="lineno"> 3301</span>&#160;  discretised principle of virtual displacements, (37).</div>
<div class="line"><a name="l03302"></a><span class="lineno"> 3302</span>&#160;  As for &quot;normal&quot; \c</div>
<div class="line"><a name="l03303"></a><span class="lineno"> 3303</span>&#160;  FiniteElements it is sensible to construct specific \c</div>
<div class="line"><a name="l03304"></a><span class="lineno"> 3304</span>&#160;  SolidFiniteElements in a hierarchy which separates between</div>
<div class="line"><a name="l03305"></a><span class="lineno"> 3305</span>&#160;  the implementation of the governing equations and the </div>
<div class="line"><a name="l03306"></a><span class="lineno"> 3306</span>&#160;  representation of the element geometry. For instance,</div>
<div class="line"><a name="l03307"></a><span class="lineno"> 3307</span>&#160;  the \c SolidQElement family represents the generalisation of the </div>
<div class="line"><a name="l03308"></a><span class="lineno"> 3308</span>&#160;  \c QElement family to \c SolidFiniteElements, while \c</div>
<div class="line"><a name="l03309"></a><span class="lineno"> 3309</span>&#160;  PVDEquations implement the principle of virtual</div>
<div class="line"><a name="l03310"></a><span class="lineno"> 3310</span>&#160;  displacements (37). The two are combined</div>
<div class="line"><a name="l03311"></a><span class="lineno"> 3311</span>&#160;  by multiple inheritance to form the \c QPVDElement class.</div>
<div class="line"><a name="l03312"></a><span class="lineno"> 3312</span>&#160;- The computation of the</div>
<div class="line"><a name="l03313"></a><span class="lineno"> 3313</span>&#160;  element&#39;s Jacobian matrix requires the evaluation of</div>
<div class="line"><a name="l03314"></a><span class="lineno"> 3314</span>&#160;  the derivatives of the discrete residuals (37) with respect</div>
<div class="line"><a name="l03315"></a><span class="lineno"> 3315</span>&#160;  to the unknown nodal positions, and with respect to any</div>
<div class="line"><a name="l03316"></a><span class="lineno"> 3316</span>&#160;  additional unknown solid mechanics variables (e.g. pressures). The</div>
<div class="line"><a name="l03317"></a><span class="lineno"> 3317</span>&#160;  derivatives with respect to the nodal positions result in </div>
<div class="line"><a name="l03318"></a><span class="lineno"> 3318</span>&#160;  fairly complex algebraic expressions and in our experience it</div>
<div class="line"><a name="l03319"></a><span class="lineno"> 3319</span>&#160;  is more efficient to evaluate these entries by finite</div>
<div class="line"><a name="l03320"></a><span class="lineno"> 3320</span>&#160;  differencing. This operation is completely generic</div>
<div class="line"><a name="l03321"></a><span class="lineno"> 3321</span>&#160;  and is implemented in </div>
<div class="line"><a name="l03322"></a><span class="lineno"> 3322</span>&#160;  \code</div>
<div class="line"><a name="l03323"></a><span class="lineno"> 3323</span>&#160;  SolidFiniteElement::get_jacobian(...)</div>
<div class="line"><a name="l03324"></a><span class="lineno"> 3324</span>&#160;  \endcode </div>
<div class="line"><a name="l03325"></a><span class="lineno"> 3325</span>&#160;  It is therefore not necessary to implement this function for</div>
<div class="line"><a name="l03326"></a><span class="lineno"> 3326</span>&#160;  \c SolidFiniteElements that only involve positional degrees of</div>
<div class="line"><a name="l03327"></a><span class="lineno"> 3327</span>&#160;  freedom (unless the setup of the element&#39;s Jacobian matrix </div>
<div class="line"><a name="l03328"></a><span class="lineno"> 3328</span>&#160;  by finite differencing</div>
<div class="line"><a name="l03329"></a><span class="lineno"> 3329</span>&#160;  is deemed to be too inefficient -- however, as stated above, we very much</div>
<div class="line"><a name="l03330"></a><span class="lineno"> 3330</span>&#160;  doubt that its analytical computation would be faster). </div>
<div class="line"><a name="l03331"></a><span class="lineno"> 3331</span>&#160;  An example is given by the \c SolidEquations class in which</div>
<div class="line"><a name="l03332"></a><span class="lineno"> 3332</span>&#160;  only the function \c SolidFiniteElement::get_residual(...)</div>
<div class="line"><a name="l03333"></a><span class="lineno"> 3333</span>&#160;  is implemented -- the element&#39;s Jacobian matrix for </div>
<div class="line"><a name="l03334"></a><span class="lineno"> 3334</span>&#160;  \c SolidFiniteElements that are derived from these equations</div>
<div class="line"><a name="l03335"></a><span class="lineno"> 3335</span>&#160;  is computed automatically by the finite differencing operations</div>
<div class="line"><a name="l03336"></a><span class="lineno"> 3336</span>&#160;  implemented in \c SolidFiniteElement::get_jacobian(...)</div>
<div class="line"><a name="l03337"></a><span class="lineno"> 3337</span>&#160;  \n \n</div>
<div class="line"><a name="l03338"></a><span class="lineno"> 3338</span>&#160;  \c SolidFiniteElements that involve non-positional degrees</div>
<div class="line"><a name="l03339"></a><span class="lineno"> 3339</span>&#160;  of freedom can still call this function to compute the</div>
<div class="line"><a name="l03340"></a><span class="lineno"> 3340</span>&#160;  entries that correspond to derivatives with respect to</div>
<div class="line"><a name="l03341"></a><span class="lineno"> 3341</span>&#160;  the nodal positions. Any other entries (such as the derivatives</div>
<div class="line"><a name="l03342"></a><span class="lineno"> 3342</span>&#160;  of the residuals with respect to the solid pressure degrees</div>
<div class="line"><a name="l03343"></a><span class="lineno"> 3343</span>&#160;  of freedom) need to be computed separately. The</div>
<div class="line"><a name="l03344"></a><span class="lineno"> 3344</span>&#160;  \c SolidEquationsWithPressure class provides an example for</div>
<div class="line"><a name="l03345"></a><span class="lineno"> 3345</span>&#160;  this approach.</div>
<div class="line"><a name="l03346"></a><span class="lineno"> 3346</span>&#160; </div>
<div class="line"><a name="l03347"></a><span class="lineno"> 3347</span>&#160; </div>
<div class="line"><a name="l03348"></a><span class="lineno"> 3348</span>&#160;&lt;CENTER&gt;&lt;B&gt; The SolidMesh class: &lt;/B&gt;&lt;/CENTER&gt;</div>
<div class="line"><a name="l03349"></a><span class="lineno"> 3349</span>&#160;Finally, we introduce the \c SolidMesh class as a generalisation</div>
<div class="line"><a name="l03350"></a><span class="lineno"> 3350</span>&#160;of the \c Mesh class. The key features of this class are:</div>
<div class="line"><a name="l03351"></a><span class="lineno"> 3351</span>&#160;- It overloads the \c Mesh::node_pt(...) function with</div>
<div class="line"><a name="l03352"></a><span class="lineno"> 3352</span>&#160;  \code</div>
<div class="line"><a name="l03353"></a><span class="lineno"> 3353</span>&#160;  SolidMesh::node_pt(...)</div>
<div class="line"><a name="l03354"></a><span class="lineno"> 3354</span>&#160;  \endcode</div>
<div class="line"><a name="l03355"></a><span class="lineno"> 3355</span>&#160;  which returns a pointer to an \c SolidNode, rather than a</div>
<div class="line"><a name="l03356"></a><span class="lineno"> 3356</span>&#160;  &quot;normal&quot; \c Node. Equivalent access functions are implemented for</div>
<div class="line"><a name="l03357"></a><span class="lineno"> 3357</span>&#160;  all other \c Mesh member functions that return pointers to</div>
<div class="line"><a name="l03358"></a><span class="lineno"> 3358</span>&#160;  \c Nodes.</div>
<div class="line"><a name="l03359"></a><span class="lineno"> 3359</span>&#160;- It overloads the \c Mesh::assign_local_eqn_numbers()</div>
<div class="line"><a name="l03360"></a><span class="lineno"> 3360</span>&#160;  function with</div>
<div class="line"><a name="l03361"></a><span class="lineno"> 3361</span>&#160;  \code</div>
<div class="line"><a name="l03362"></a><span class="lineno"> 3362</span>&#160;  SolidMesh::assign_local_eqn_numbers(...)</div>
<div class="line"><a name="l03363"></a><span class="lineno"> 3363</span>&#160;  \endcode</div>
<div class="line"><a name="l03364"></a><span class="lineno"> 3364</span>&#160;  This function calls the elements&#39; &quot;normal&quot; </div>
<div class="line"><a name="l03365"></a><span class="lineno"> 3365</span>&#160;  \c GeneralisedElement::assign_local_eqn_numbers() function,</div>
<div class="line"><a name="l03366"></a><span class="lineno"> 3366</span>&#160;  followed by a call to  </div>
<div class="line"><a name="l03367"></a><span class="lineno"> 3367</span>&#160;  \c SolidFiniteElement::assign_solid_local_eqn_numbers(),</div>
<div class="line"><a name="l03368"></a><span class="lineno"> 3368</span>&#160;  which implements the local equation numbering for the </div>
<div class="line"><a name="l03369"></a><span class="lineno"> 3369</span>&#160;  solid mechanics degrees of freedom. </div>
<div class="line"><a name="l03370"></a><span class="lineno"> 3370</span>&#160;- Finally, we provide the function</div>
<div class="line"><a name="l03371"></a><span class="lineno"> 3371</span>&#160;  \code</div>
<div class="line"><a name="l03372"></a><span class="lineno"> 3372</span>&#160;  SolidMesh::set_lagrangian_nodal_coordinates()</div>
<div class="line"><a name="l03373"></a><span class="lineno"> 3373</span>&#160;  \endcode</div>
<div class="line"><a name="l03374"></a><span class="lineno"> 3374</span>&#160;  which assigns the current Eulerian coordinates of all \c Nodes</div>
<div class="line"><a name="l03375"></a><span class="lineno"> 3375</span>&#160;  to their Lagrangian coordinates, thus turning the current</div>
<div class="line"><a name="l03376"></a><span class="lineno"> 3376</span>&#160;  configuration into the reference configuration). This function</div>
<div class="line"><a name="l03377"></a><span class="lineno"> 3377</span>&#160;  greatly facilitates the construction of \c SolidMeshes via</div>
<div class="line"><a name="l03378"></a><span class="lineno"> 3378</span>&#160;  inheritance from existing \c Meshes. If, for instance, \c SomeMesh</div>
<div class="line"><a name="l03379"></a><span class="lineno"> 3379</span>&#160;  is an existing, fully functional \c Mesh, the corresponding</div>
<div class="line"><a name="l03380"></a><span class="lineno"> 3380</span>&#160;  \c SolidMesh can be constructed with a few lines</div>
<div class="line"><a name="l03381"></a><span class="lineno"> 3381</span>&#160;  of code, as in this example:</div>
<div class="line"><a name="l03382"></a><span class="lineno"> 3382</span>&#160;  \code</div>
<div class="line"><a name="l03383"></a><span class="lineno"> 3383</span>&#160;  //=================================================================</div>
<div class="line"><a name="l03384"></a><span class="lineno"> 3384</span>&#160;  // SolidMesh version of SomeMesh</div>
<div class="line"><a name="l03385"></a><span class="lineno"> 3385</span>&#160;  //=================================================================</div>
<div class="line"><a name="l03386"></a><span class="lineno"> 3386</span>&#160;  template&lt;class ELEMENT&gt;</div>
<div class="line"><a name="l03387"></a><span class="lineno"> 3387</span>&#160;  class SomeSolidMesh : public virtual SomeMesh&lt;ELEMENT&gt;,</div>
<div class="line"><a name="l03388"></a><span class="lineno"> 3388</span>&#160;                          public virtual SolidMesh</div>
<div class="line"><a name="l03389"></a><span class="lineno"> 3389</span>&#160;   {</div>
<div class="line"><a name="l03390"></a><span class="lineno"> 3390</span>&#160;     public:</div>
<div class="line"><a name="l03391"></a><span class="lineno"> 3391</span>&#160; </div>
<div class="line"><a name="l03392"></a><span class="lineno"> 3392</span>&#160;     // Constructor: Call the constructor to the underlying Mesh</div>
<div class="line"><a name="l03393"></a><span class="lineno"> 3393</span>&#160;     // then assign the Lagrangian coordinates -- for the</div>
<div class="line"><a name="l03394"></a><span class="lineno"> 3394</span>&#160;     // PARANOID user, check that the element specified</div>
<div class="line"><a name="l03395"></a><span class="lineno"> 3395</span>&#160;     // in the template argument is derived from an </div>
<div class="line"><a name="l03396"></a><span class="lineno"> 3396</span>&#160;     // SolidFiniteElement</div>
<div class="line"><a name="l03397"></a><span class="lineno"> 3397</span>&#160;     SomeSolidMesh() : SomeMesh()</div>
<div class="line"><a name="l03398"></a><span class="lineno"> 3398</span>&#160;      {</div>
<div class="line"><a name="l03399"></a><span class="lineno"> 3399</span>&#160;  #ifdef PARANOID</div>
<div class="line"><a name="l03400"></a><span class="lineno"> 3400</span>&#160;     // Check that the element type is derived from</div>
<div class="line"><a name="l03401"></a><span class="lineno"> 3401</span>&#160;     // the SolidFiniteElement class</div>
<div class="line"><a name="l03402"></a><span class="lineno"> 3402</span>&#160;     SolidFiniteElement* el_pt=dynamic_cast&lt;SolidFiniteElement*&gt;</div>
<div class="line"><a name="l03403"></a><span class="lineno"> 3403</span>&#160;      (finite_element_pt(0));</div>
<div class="line"><a name="l03404"></a><span class="lineno"> 3404</span>&#160;     if (el_pt==0)</div>
<div class="line"><a name="l03405"></a><span class="lineno"> 3405</span>&#160;      {</div>
<div class="line"><a name="l03406"></a><span class="lineno"> 3406</span>&#160;       cout &lt;&lt; &quot;Element needs to be derived from SolidFiniteElement &quot; &lt;&lt; endl;</div>
<div class="line"><a name="l03407"></a><span class="lineno"> 3407</span>&#160;       assert(false);</div>
<div class="line"><a name="l03408"></a><span class="lineno"> 3408</span>&#160;      }</div>
<div class="line"><a name="l03409"></a><span class="lineno"> 3409</span>&#160;  #endif</div>
<div class="line"><a name="l03410"></a><span class="lineno"> 3410</span>&#160;  </div>
<div class="line"><a name="l03411"></a><span class="lineno"> 3411</span>&#160;     // Make the current configuration the undeformed one by</div>
<div class="line"><a name="l03412"></a><span class="lineno"> 3412</span>&#160;     // setting the nodal Lagrangian coordinates to their current</div>
<div class="line"><a name="l03413"></a><span class="lineno"> 3413</span>&#160;     // Eulerian ones</div>
<div class="line"><a name="l03414"></a><span class="lineno"> 3414</span>&#160;     set_lagrangian_nodal_coordinates();</div>
<div class="line"><a name="l03415"></a><span class="lineno"> 3415</span>&#160;    }</div>
<div class="line"><a name="l03416"></a><span class="lineno"> 3416</span>&#160; };</div>
<div class="line"><a name="l03417"></a><span class="lineno"> 3417</span>&#160;\endcode</div>
<div class="line"><a name="l03418"></a><span class="lineno"> 3418</span>&#160; </div>
<div class="line"><a name="l03419"></a><span class="lineno"> 3419</span>&#160; </div>
<div class="line"><a name="l03420"></a><span class="lineno"> 3420</span>&#160; </div>
<div class="line"><a name="l03421"></a><span class="lineno"> 3421</span>&#160;\subsubsection Solid_IC Timestepping and the generation of initial conditions</div>
<div class="line"><a name="l03422"></a><span class="lineno"> 3422</span>&#160;In time-dependent problems, the boundary value problem defined by</div>
<div class="line"><a name="l03423"></a><span class="lineno"> 3423</span>&#160;the variational principle (28) needs to be</div>
<div class="line"><a name="l03424"></a><span class="lineno"> 3424</span>&#160;augmented by suitable initial conditions which specify the</div>
<div class="line"><a name="l03425"></a><span class="lineno"> 3425</span>&#160;state of the system at time \f$ t=t_0. \f$ The initial</div>
<div class="line"><a name="l03426"></a><span class="lineno"> 3426</span>&#160;conditions specify the initial shape of the solid body,</div>
<div class="line"><a name="l03427"></a><span class="lineno"> 3427</span>&#160;\f[</div>
<div class="line"><a name="l03428"></a><span class="lineno"> 3428</span>&#160;{\bf R}(\xi^i,t=t_0) =  {\bf R}^{(IC)}(\xi^i),</div>
<div class="line"><a name="l03429"></a><span class="lineno"> 3429</span>&#160;\ \ \ \ \ \ \ \ \ \ \ \ \ (38)</div>
<div class="line"><a name="l03430"></a><span class="lineno"> 3430</span>&#160;\f]</div>
<div class="line"><a name="l03431"></a><span class="lineno"> 3431</span>&#160;and its initial velocity,</div>
<div class="line"><a name="l03432"></a><span class="lineno"> 3432</span>&#160;\f[</div>
<div class="line"><a name="l03433"></a><span class="lineno"> 3433</span>&#160;\left. \frac{\partial {\bf R}(\xi^i,t)}{\partial t} \right|_{t=t_0} = </div>
<div class="line"><a name="l03434"></a><span class="lineno"> 3434</span>&#160;{\bf V}^{(IC)}(\xi^i),</div>
<div class="line"><a name="l03435"></a><span class="lineno"> 3435</span>&#160;\ \ \ \ \ \ \ \ \ \ \ \ (39)</div>
<div class="line"><a name="l03436"></a><span class="lineno"> 3436</span>&#160;\f]</div>
<div class="line"><a name="l03437"></a><span class="lineno"> 3437</span>&#160;where \f$ {\bf R}^{(IC)}(\xi^i) \f$ and \f$ {\bf V}^{(IC)}(\xi^i) \f$</div>
<div class="line"><a name="l03438"></a><span class="lineno"> 3438</span>&#160;are given. The accelerations \f$ \partial^2 {\bf R}/\partial t^2</div>
<div class="line"><a name="l03439"></a><span class="lineno"> 3439</span>&#160;\f$ at \f$t=t_0\f$ follow from the solution of</div>
<div class="line"><a name="l03440"></a><span class="lineno"> 3440</span>&#160;(28) and can therefore not be enforced,</div>
<div class="line"><a name="l03441"></a><span class="lineno"> 3441</span>&#160;unless we wish to initialise the time-stepping procedure with a known</div>
<div class="line"><a name="l03442"></a><span class="lineno"> 3442</span>&#160;exact solution \f$ {\bf R}^{(exact)}(\xi^i,t) \f$. (Only!) in this case</div>
<div class="line"><a name="l03443"></a><span class="lineno"> 3443</span>&#160;are we allowed to assign an initial value for the acceleration via</div>
<div class="line"><a name="l03444"></a><span class="lineno"> 3444</span>&#160;\f[</div>
<div class="line"><a name="l03445"></a><span class="lineno"> 3445</span>&#160;\left. \frac{\partial^2 {\bf R}(\xi^i,t)}{\partial t^2} \right|_{t=t_0} = </div>
<div class="line"><a name="l03446"></a><span class="lineno"> 3446</span>&#160;{\bf A}^{(IC)}(\xi^i) \equiv</div>
<div class="line"><a name="l03447"></a><span class="lineno"> 3447</span>&#160;\left. \frac{\partial^2 {\bf R}^{(exact)}(\xi^i,t)}{\partial t^2} </div>
<div class="line"><a name="l03448"></a><span class="lineno"> 3448</span>&#160;\right|_{t=t_0}.</div>
<div class="line"><a name="l03449"></a><span class="lineno"> 3449</span>&#160;\ \ \ \ \ \ \ \ \ \ \ \ (40)</div>
<div class="line"><a name="l03450"></a><span class="lineno"> 3450</span>&#160;\f]</div>
<div class="line"><a name="l03451"></a><span class="lineno"> 3451</span>&#160;We will assume that time-stepping is performed with the \c Newmark </div>
<div class="line"><a name="l03452"></a><span class="lineno"> 3452</span>&#160;method which is our default timestepper for hyperbolic</div>
<div class="line"><a name="l03453"></a><span class="lineno"> 3453</span>&#160;problems. In this case the time-derivatives of the nodal positions in</div>
<div class="line"><a name="l03454"></a><span class="lineno"> 3454</span>&#160;(28) are replaced by an approximation</div>
<div class="line"><a name="l03455"></a><span class="lineno"> 3455</span>&#160;which involves the current and three &quot;history values&quot; of the nodal </div>
<div class="line"><a name="l03456"></a><span class="lineno"> 3456</span>&#160;positions. To start the time-integration, we need to assign </div>
<div class="line"><a name="l03457"></a><span class="lineno"> 3457</span>&#160;suitable values to these quantities to ensure that the intial </div>
<div class="line"><a name="l03458"></a><span class="lineno"> 3458</span>&#160;state of the system is represented correctly.</div>
<div class="line"><a name="l03459"></a><span class="lineno"> 3459</span>&#160; </div>
<div class="line"><a name="l03460"></a><span class="lineno"> 3460</span>&#160;To assign the intial values for the nodal positions, we</div>
<div class="line"><a name="l03461"></a><span class="lineno"> 3461</span>&#160;(temporarily) remove all boundary conditions for the nodal </div>
<div class="line"><a name="l03462"></a><span class="lineno"> 3462</span>&#160;positions and determine their initial values by solving equation</div>
<div class="line"><a name="l03463"></a><span class="lineno"> 3463</span>&#160;(38) in its weak form,</div>
<div class="line"><a name="l03464"></a><span class="lineno"> 3464</span>&#160;\f[</div>
<div class="line"><a name="l03465"></a><span class="lineno"> 3465</span>&#160;f_{il}^{(0)} = \int \left( \sum_{j=1}^N X_{ij}^{(0)} \psi_j(\xi^k) </div>
<div class="line"><a name="l03466"></a><span class="lineno"> 3466</span>&#160;- R^{(IC)}_i(\xi^k)</div>
<div class="line"><a name="l03467"></a><span class="lineno"> 3467</span>&#160;\right) \psi_l(\xi^k) \ dv = 0</div>
<div class="line"><a name="l03468"></a><span class="lineno"> 3468</span>&#160;\mbox{ \ \ \ \ for \ \ \ $l=1,...,N; \ \ i=1,..,3$}</div>
<div class="line"><a name="l03469"></a><span class="lineno"> 3469</span>&#160;\ \ \ \ \ \ \ \ \ \ \ \ \ (41)</div>
<div class="line"><a name="l03470"></a><span class="lineno"> 3470</span>&#160;\f]</div>
<div class="line"><a name="l03471"></a><span class="lineno"> 3471</span>&#160;where  \f$ R^{(IC)}_i \f$ is the \f$i\f$-th component of </div>
<div class="line"><a name="l03472"></a><span class="lineno"> 3472</span>&#160;\f${\bf R}^{(IC)}.\f$ Equation (41) provides</div>
<div class="line"><a name="l03473"></a><span class="lineno"> 3473</span>&#160;\f$ 3 \times N\f$ equations for the \f$ 3 \times N \f$ components</div>
<div class="line"><a name="l03474"></a><span class="lineno"> 3474</span>&#160;of the initial nodal positions, \f$ X_{ij}^{(0)} \f$ (where</div>
<div class="line"><a name="l03475"></a><span class="lineno"> 3475</span>&#160;\f$i=1,...3; \ j=1,...,N)\f$. To determine the initial nodal</div>
<div class="line"><a name="l03476"></a><span class="lineno"> 3476</span>&#160;velocities, we repeat the same procedure with the prescribed</div>
<div class="line"><a name="l03477"></a><span class="lineno"> 3477</span>&#160;velocities and solve</div>
<div class="line"><a name="l03478"></a><span class="lineno"> 3478</span>&#160;\f[</div>
<div class="line"><a name="l03479"></a><span class="lineno"> 3479</span>&#160;f_{il}^{(1)} = \int \left( \sum_{j=1}^N X_{ij}^{(1)} \psi_j(\xi^k) </div>
<div class="line"><a name="l03480"></a><span class="lineno"> 3480</span>&#160;- V^{(IC)}_i(\xi^k)</div>
<div class="line"><a name="l03481"></a><span class="lineno"> 3481</span>&#160;\right) \psi_l(\xi^k) \ dv = 0</div>
<div class="line"><a name="l03482"></a><span class="lineno"> 3482</span>&#160;\mbox{ \ \ \ \ for \ \ \ $l=1,...,N;  \ \ i=1,..,3$}</div>
<div class="line"><a name="l03483"></a><span class="lineno"> 3483</span>&#160;\ \ \ \ \ \ \ \ \ \ \ \ \ (42)</div>
<div class="line"><a name="l03484"></a><span class="lineno"> 3484</span>&#160;\f]</div>
<div class="line"><a name="l03485"></a><span class="lineno"> 3485</span>&#160;for the initial nodal velocities, \f$ X_{ij}^{(1)} \f$ (where</div>
<div class="line"><a name="l03486"></a><span class="lineno"> 3486</span>&#160;\f$i=1,...3; \ j=1,...,N)\f$. Finally, assuminig that we have </div>
<div class="line"><a name="l03487"></a><span class="lineno"> 3487</span>&#160;an exact solution for the accelerations, we solve</div>
<div class="line"><a name="l03488"></a><span class="lineno"> 3488</span>&#160;\f[</div>
<div class="line"><a name="l03489"></a><span class="lineno"> 3489</span>&#160;f_{il}^{(2)} = \int \left( \sum_{j=1}^N X_{ij}^{(2)} \psi_j(\xi^k) </div>
<div class="line"><a name="l03490"></a><span class="lineno"> 3490</span>&#160;- A^{(IC)}_i(\xi^k)</div>
<div class="line"><a name="l03491"></a><span class="lineno"> 3491</span>&#160;\right) \psi_l(\xi^k) \ dv = 0</div>
<div class="line"><a name="l03492"></a><span class="lineno"> 3492</span>&#160;\mbox{ \ \ \ \ for \ \ \ $l=1,...,N; \ \ i=1,..,3$}</div>
<div class="line"><a name="l03493"></a><span class="lineno"> 3493</span>&#160;\ \ \ \ \ \ \ \ \ \ \ \ \ (43)</div>
<div class="line"><a name="l03494"></a><span class="lineno"> 3494</span>&#160;\f]</div>
<div class="line"><a name="l03495"></a><span class="lineno"> 3495</span>&#160;for the initial nodal accelerations, \f$ X_{ij}^{(2)} \f$ (where</div>
<div class="line"><a name="l03496"></a><span class="lineno"> 3496</span>&#160;\f$i=1,...3; \ j=1,...,N)\f$. Having determined the </div>
<div class="line"><a name="l03497"></a><span class="lineno"> 3497</span>&#160;nodal positions and their first and second time-derivatives</div>
<div class="line"><a name="l03498"></a><span class="lineno"> 3498</span>&#160;at \f$ t=t_0 \f$, we can use the functions</div>
<div class="line"><a name="l03499"></a><span class="lineno"> 3499</span>&#160;\c Newmark::assign_initial_data_values_stage1(...) and</div>
<div class="line"><a name="l03500"></a><span class="lineno"> 3500</span>&#160;\c Newmark::assign_initial_data_values_stage2(...) to compute the </div>
<div class="line"><a name="l03501"></a><span class="lineno"> 3501</span>&#160;positional history values which ensure that the Newmark </div>
<div class="line"><a name="l03502"></a><span class="lineno"> 3502</span>&#160;approximations for the</div>
<div class="line"><a name="l03503"></a><span class="lineno"> 3503</span>&#160;initial velocity and acceleration are correct.</div>
<div class="line"><a name="l03504"></a><span class="lineno"> 3504</span>&#160;This procedure is fully implemented in the function</div>
<div class="line"><a name="l03505"></a><span class="lineno"> 3505</span>&#160;\code</div>
<div class="line"><a name="l03506"></a><span class="lineno"> 3506</span>&#160;SolidMesh::Solid_IC_problem.set_newmark_initial_condition_directly(...)</div>
<div class="line"><a name="l03507"></a><span class="lineno"> 3507</span>&#160;\endcode</div>
<div class="line"><a name="l03508"></a><span class="lineno"> 3508</span>&#160;whose arguments are:</div>
<div class="line"><a name="l03509"></a><span class="lineno"> 3509</span>&#160;- The pointer to the problem being solved. This is needed because</div>
<div class="line"><a name="l03510"></a><span class="lineno"> 3510</span>&#160;  the solution of equations (41) -</div>
<div class="line"><a name="l03511"></a><span class="lineno"> 3511</span>&#160;  (43) requires a temporary change to the</div>
<div class="line"><a name="l03512"></a><span class="lineno"> 3512</span>&#160;  boundary conditions and to the equation numbering scheme. Once</div>
<div class="line"><a name="l03513"></a><span class="lineno"> 3513</span>&#160;  the history values are assigned, the original</div>
<div class="line"><a name="l03514"></a><span class="lineno"> 3514</span>&#160;  boundary conditions are restored and the original equation numbers </div>
<div class="line"><a name="l03515"></a><span class="lineno"> 3515</span>&#160;  are re-generated by executing</div>
<div class="line"><a name="l03516"></a><span class="lineno"> 3516</span>&#160;  the Problem&#39;s \c Problem::assign_eqn_numbers().</div>
<div class="line"><a name="l03517"></a><span class="lineno"> 3517</span>&#160;- A pointer to the \c SolidMesh on which the initial conditions</div>
<div class="line"><a name="l03518"></a><span class="lineno"> 3518</span>&#160;  are assigned.</div>
<div class="line"><a name="l03519"></a><span class="lineno"> 3519</span>&#160;- A pointer to the \c TimeStepper (which has to be of the \c Newmark</div>
<div class="line"><a name="l03520"></a><span class="lineno"> 3520</span>&#160;  family).</div>
<div class="line"><a name="l03521"></a><span class="lineno"> 3521</span>&#160;- A pointer to the &quot;Elasic initial condition&quot; object (discussed below).</div>
<div class="line"><a name="l03522"></a><span class="lineno"> 3522</span>&#160;- The initial timestep. </div>
<div class="line"><a name="l03523"></a><span class="lineno"> 3523</span>&#160; </div>
<div class="line"><a name="l03524"></a><span class="lineno"> 3524</span>&#160;Here is a brief outline of the implementation:</div>
<div class="line"><a name="l03525"></a><span class="lineno"> 3525</span>&#160;All \c SolidFiniteElements store a pointer to an</div>
<div class="line"><a name="l03526"></a><span class="lineno"> 3526</span>&#160;\c SolidInitialCondition object (hierher: change Cond to</div>
<div class="line"><a name="l03527"></a><span class="lineno"> 3527</span>&#160;Condition in code). By default this pointer is set to NULL,</div>
<div class="line"><a name="l03528"></a><span class="lineno"> 3528</span>&#160;indicating that \c FiniteElement::get_residual(...)</div>
<div class="line"><a name="l03529"></a><span class="lineno"> 3529</span>&#160;should compute the residuals of the &quot;normal&quot; governing equations.</div>
<div class="line"><a name="l03530"></a><span class="lineno"> 3530</span>&#160;\c SolidFiniteElements whose initial conditions are to be set with </div>
<div class="line"><a name="l03531"></a><span class="lineno"> 3531</span>&#160;the above function, need re-direct the computation of the residual to</div>
<div class="line"><a name="l03532"></a><span class="lineno"> 3532</span>&#160;\code </div>
<div class="line"><a name="l03533"></a><span class="lineno"> 3533</span>&#160;SolidFiniteElement::get_residuals_for_ic(...)</div>
<div class="line"><a name="l03534"></a><span class="lineno"> 3534</span>&#160;\endcode</div>
<div class="line"><a name="l03535"></a><span class="lineno"> 3535</span>&#160;\n</div>
<div class="line"><a name="l03536"></a><span class="lineno"> 3536</span>&#160;whenever the pointer to the \c SolidInitialCondition is non-NULL, as </div>
<div class="line"><a name="l03537"></a><span class="lineno"> 3537</span>&#160;illustrated in this code fragment:</div>
<div class="line"><a name="l03538"></a><span class="lineno"> 3538</span>&#160;\n \n</div>
<div class="line"><a name="l03539"></a><span class="lineno"> 3539</span>&#160;\code</div>
<div class="line"><a name="l03540"></a><span class="lineno"> 3540</span>&#160;//=======================================================================</div>
<div class="line"><a name="l03541"></a><span class="lineno"> 3541</span>&#160;// Compute the residuals for the elasticity equations.</div>
<div class="line"><a name="l03542"></a><span class="lineno"> 3542</span>&#160;//=======================================================================</div>
<div class="line"><a name="l03543"></a><span class="lineno"> 3543</span>&#160;template &lt;unsigned DIM&gt;</div>
<div class="line"><a name="l03544"></a><span class="lineno"> 3544</span>&#160; void SolidEquations&lt;DIM&gt;::get_residuals(Vector&lt;double&gt; &amp;residuals)</div>
<div class="line"><a name="l03545"></a><span class="lineno"> 3545</span>&#160; {</div>
<div class="line"><a name="l03546"></a><span class="lineno"> 3546</span>&#160; </div>
<div class="line"><a name="l03547"></a><span class="lineno"> 3547</span>&#160;  // Simply set up initial condition?</div>
<div class="line"><a name="l03548"></a><span class="lineno"> 3548</span>&#160;  if (Solid_ic_pt!=0)</div>
<div class="line"><a name="l03549"></a><span class="lineno"> 3549</span>&#160;   {</div>
<div class="line"><a name="l03550"></a><span class="lineno"> 3550</span>&#160;    get_residuals_for_ic(residuals);</div>
<div class="line"><a name="l03551"></a><span class="lineno"> 3551</span>&#160;    return;</div>
<div class="line"><a name="l03552"></a><span class="lineno"> 3552</span>&#160;   }</div>
<div class="line"><a name="l03553"></a><span class="lineno"> 3553</span>&#160; </div>
<div class="line"><a name="l03554"></a><span class="lineno"> 3554</span>&#160;  // Set up residuals for principle of virtual displacements</div>
<div class="line"><a name="l03555"></a><span class="lineno"> 3555</span>&#160; </div>
<div class="line"><a name="l03556"></a><span class="lineno"> 3556</span>&#160;  [...]</div>
<div class="line"><a name="l03557"></a><span class="lineno"> 3557</span>&#160; </div>
<div class="line"><a name="l03558"></a><span class="lineno"> 3558</span>&#160; </div>
<div class="line"><a name="l03559"></a><span class="lineno"> 3559</span>&#160;  }</div>
<div class="line"><a name="l03560"></a><span class="lineno"> 3560</span>&#160; \endcode</div>
<div class="line"><a name="l03561"></a><span class="lineno"> 3561</span>&#160; </div>
<div class="line"><a name="l03562"></a><span class="lineno"> 3562</span>&#160;The \c SolidInitialCondition object stores a (pointer to a) \c GeomObject</div>
<div class="line"><a name="l03563"></a><span class="lineno"> 3563</span>&#160;and a flag that indicates which time-derivative (0th, 1st</div>
<div class="line"><a name="l03564"></a><span class="lineno"> 3564</span>&#160;or 2nd) of the \c GeomObject&#39;s position vector is to be assigned to</div>
<div class="line"><a name="l03565"></a><span class="lineno"> 3565</span>&#160;the nodal coordinates. Based on the value of this flag,</div>
<div class="line"><a name="l03566"></a><span class="lineno"> 3566</span>&#160;the function \c SolidFiniteElement::get_residuals_for_ic(...),</div>
<div class="line"><a name="l03567"></a><span class="lineno"> 3567</span>&#160;is able to compute the residuals corresponding to equations</div>
<div class="line"><a name="l03568"></a><span class="lineno"> 3568</span>&#160;(41), (42) or </div>
<div class="line"><a name="l03569"></a><span class="lineno"> 3569</span>&#160;(43). </div>
<div class="line"><a name="l03570"></a><span class="lineno"> 3570</span>&#160; </div>
<div class="line"><a name="l03571"></a><span class="lineno"> 3571</span>&#160;This all sounds very complicated (and it is!) but luckily</div>
<div class="line"><a name="l03572"></a><span class="lineno"> 3572</span>&#160;all the hard work has already been done and the relevant</div>
<div class="line"><a name="l03573"></a><span class="lineno"> 3573</span>&#160;procedures are fully implemented. Hence,</div>
<div class="line"><a name="l03574"></a><span class="lineno"> 3574</span>&#160;the actual assignment of the initial conditions is as simple as</div>
<div class="line"><a name="l03575"></a><span class="lineno"> 3575</span>&#160;this:</div>
<div class="line"><a name="l03576"></a><span class="lineno"> 3576</span>&#160; </div>
<div class="line"><a name="l03577"></a><span class="lineno"> 3577</span>&#160;\code</div>
<div class="line"><a name="l03578"></a><span class="lineno"> 3578</span>&#160; </div>
<div class="line"><a name="l03579"></a><span class="lineno"> 3579</span>&#160;// Somebody has created a Problem somewhere</div>
<div class="line"><a name="l03580"></a><span class="lineno"> 3580</span>&#160;Problem* problem_pt = new SomeProblem;</div>
<div class="line"><a name="l03581"></a><span class="lineno"> 3581</span>&#160; </div>
<div class="line"><a name="l03582"></a><span class="lineno"> 3582</span>&#160;// Somebody has created an SolidMesh somewhere</div>
<div class="line"><a name="l03583"></a><span class="lineno"> 3583</span>&#160;SolidMesh* solid_mesh_pt = new SomeSolidMesh;</div>
<div class="line"><a name="l03584"></a><span class="lineno"> 3584</span>&#160; </div>
<div class="line"><a name="l03585"></a><span class="lineno"> 3585</span>&#160;// Somebody has created a Newmark timestepper somewhere</div>
<div class="line"><a name="l03586"></a><span class="lineno"> 3586</span>&#160;TimeStepper* time_stepper_pt=new Newmark&lt;1&gt;; </div>
<div class="line"><a name="l03587"></a><span class="lineno"> 3587</span>&#160; </div>
<div class="line"><a name="l03588"></a><span class="lineno"> 3588</span>&#160;[...]</div>
<div class="line"><a name="l03589"></a><span class="lineno"> 3589</span>&#160; </div>
<div class="line"><a name="l03590"></a><span class="lineno"> 3590</span>&#160;// Create the GeomObject whose time-dependent deformation </div>
<div class="line"><a name="l03591"></a><span class="lineno"> 3591</span>&#160;// specifies the initial conditions for our solid body:</div>
<div class="line"><a name="l03592"></a><span class="lineno"> 3592</span>&#160;// The position vector and its time-derivatives</div>
<div class="line"><a name="l03593"></a><span class="lineno"> 3593</span>&#160;// are available from GeomObject::dpositiondt(...).</div>
<div class="line"><a name="l03594"></a><span class="lineno"> 3594</span>&#160;GeomObject* geom_obj_pt=new SomeGeomObject;</div>
<div class="line"><a name="l03595"></a><span class="lineno"> 3595</span>&#160; </div>
<div class="line"><a name="l03596"></a><span class="lineno"> 3596</span>&#160;//Setup object that specifies the initial conditions:</div>
<div class="line"><a name="l03597"></a><span class="lineno"> 3597</span>&#160;SolidInitialCondition* ic_pt = new SolidInitialCondition(geom_obj_pt);</div>
<div class="line"><a name="l03598"></a><span class="lineno"> 3598</span>&#160; </div>
<div class="line"><a name="l03599"></a><span class="lineno"> 3599</span>&#160;// Choose the initial timestep</div>
<div class="line"><a name="l03600"></a><span class="lineno"> 3600</span>&#160;double dt=0.01; </div>
<div class="line"><a name="l03601"></a><span class="lineno"> 3601</span>&#160; </div>
<div class="line"><a name="l03602"></a><span class="lineno"> 3602</span>&#160;// Assign the initial conditions:</div>
<div class="line"><a name="l03603"></a><span class="lineno"> 3603</span>&#160;SolidMesh::Solid_IC_problem.set_newmark_initial_condition_directly(</div>
<div class="line"><a name="l03604"></a><span class="lineno"> 3604</span>&#160;             problem_pt,solid_mesh_pt,time_stepper_pt,IC_pt,dt);</div>
<div class="line"><a name="l03605"></a><span class="lineno"> 3605</span>&#160; </div>
<div class="line"><a name="l03606"></a><span class="lineno"> 3606</span>&#160;// Done!</div>
<div class="line"><a name="l03607"></a><span class="lineno"> 3607</span>&#160; </div>
<div class="line"><a name="l03608"></a><span class="lineno"> 3608</span>&#160;[...]</div>
<div class="line"><a name="l03609"></a><span class="lineno"> 3609</span>&#160; </div>
<div class="line"><a name="l03610"></a><span class="lineno"> 3610</span>&#160; \endcode</div>
<div class="line"><a name="l03611"></a><span class="lineno"> 3611</span>&#160; </div>
<div class="line"><a name="l03612"></a><span class="lineno"> 3612</span>&#160;If we do not know an exact solution to our problem (and in most</div>
<div class="line"><a name="l03613"></a><span class="lineno"> 3613</span>&#160;cases we obviously won&#39;t...), we can only use the procedure described above</div>
<div class="line"><a name="l03614"></a><span class="lineno"> 3614</span>&#160;to determine the initial nodal positions and velocities. </div>
<div class="line"><a name="l03615"></a><span class="lineno"> 3615</span>&#160;We then need to solve the equations (37) for the</div>
<div class="line"><a name="l03616"></a><span class="lineno"> 3616</span>&#160;remaining &quot;history value&quot;. Since the equations (37)</div>
<div class="line"><a name="l03617"></a><span class="lineno"> 3617</span>&#160;are linear in the accelerations, this is a linear problem</div>
<div class="line"><a name="l03618"></a><span class="lineno"> 3618</span>&#160;whose Jacobian matrix is proportional to the mass matrix</div>
<div class="line"><a name="l03619"></a><span class="lineno"> 3619</span>&#160;\f[</div>
<div class="line"><a name="l03620"></a><span class="lineno"> 3620</span>&#160;M_{ij} = \int {\cal M} \ \psi_i \ \psi_j \ dv. </div>
<div class="line"><a name="l03621"></a><span class="lineno"> 3621</span>&#160;\ \ \ \ \ \ \ (44)</div>
<div class="line"><a name="l03622"></a><span class="lineno"> 3622</span>&#160;\f]</div>
<div class="line"><a name="l03623"></a><span class="lineno"> 3623</span>&#160;The procedure which determines the initial &quot;history values&quot; </div>
<div class="line"><a name="l03624"></a><span class="lineno"> 3624</span>&#160;from the given initial positions and velocities while ensuring</div>
<div class="line"><a name="l03625"></a><span class="lineno"> 3625</span>&#160;consistency with the governing equation at \f$ t = t_0\f$</div>
<div class="line"><a name="l03626"></a><span class="lineno"> 3626</span>&#160;is implemented in </div>
<div class="line"><a name="l03627"></a><span class="lineno"> 3627</span>&#160;\c SolidMesh::Solid_IC_problem.set_newmark_initial_condition_consistently(...)</div>
<div class="line"><a name="l03628"></a><span class="lineno"> 3628</span>&#160;which takes the same arguments as the function that assigns </div>
<div class="line"><a name="l03629"></a><span class="lineno"> 3629</span>&#160;the acceleration directly, but also requires a function pointer</div>
<div class="line"><a name="l03630"></a><span class="lineno"> 3630</span>&#160;to the &quot;multiplier&quot; \f$  {\cal M} \f$.  If there</div>
<div class="line"><a name="l03631"></a><span class="lineno"> 3631</span>&#160;is no growth, the multiplier is given by the timescale ratio</div>
<div class="line"><a name="l03632"></a><span class="lineno"> 3632</span>&#160;\f$\Lambda^2\f$; if the body is subjected to uniform isotropic</div>
<div class="line"><a name="l03633"></a><span class="lineno"> 3633</span>&#160;growth, \f$\Gamma \ne 1\f$, the multiplier is equal to </div>
<div class="line"><a name="l03634"></a><span class="lineno"> 3634</span>&#160;\f$\Gamma \Lambda^2\f$. </div>
<div class="line"><a name="l03635"></a><span class="lineno"> 3635</span>&#160;If the wrong multiplier is specified (or if it is omitted, in</div>
<div class="line"><a name="l03636"></a><span class="lineno"> 3636</span>&#160;which the default value of 1.0 is used) the residuals (37)</div>
<div class="line"><a name="l03637"></a><span class="lineno"> 3637</span>&#160;will be nonzero (or at least larger than the tolerance specified in \c</div>
<div class="line"><a name="l03638"></a><span class="lineno"> 3638</span>&#160;SolidICProblem). In this case a warning is issued and the</div>
<div class="line"><a name="l03639"></a><span class="lineno"> 3639</span>&#160;code execution terminates. This behaviour can be suppressed</div>
<div class="line"><a name="l03640"></a><span class="lineno"> 3640</span>&#160;by increasing the tolerance suitably, but you do this at your own risk!</div>
<div class="line"><a name="l03641"></a><span class="lineno"> 3641</span>&#160; </div>
<div class="line"><a name="l03642"></a><span class="lineno"> 3642</span>&#160; </div>
<div class="line"><a name="l03643"></a><span class="lineno"> 3643</span>&#160;&lt;B&gt;Important:&lt;/B&gt; </div>
<div class="line"><a name="l03644"></a><span class="lineno"> 3644</span>&#160;The above procedures can only handle the assignment of </div>
<div class="line"><a name="l03645"></a><span class="lineno"> 3645</span>&#160;initial conditions in problems that are formulated in</div>
<div class="line"><a name="l03646"></a><span class="lineno"> 3646</span>&#160;terms of displacements and do \b not involve any additional variables</div>
<div class="line"><a name="l03647"></a><span class="lineno"> 3647</span>&#160;such as solid pressures. We do not believe that</div>
<div class="line"><a name="l03648"></a><span class="lineno"> 3648</span>&#160;it is possible to implement the assignment of initial conditions</div>
<div class="line"><a name="l03649"></a><span class="lineno"> 3649</span>&#160;for such problems without additional knowledge about the precise </div>
<div class="line"><a name="l03650"></a><span class="lineno"> 3650</span>&#160;form of the constitutive equations. If the presence of &quot;internal</div>
<div class="line"><a name="l03651"></a><span class="lineno"> 3651</span>&#160;solid Data&quot; is detected during the assignment of the initial</div>
<div class="line"><a name="l03652"></a><span class="lineno"> 3652</span>&#160;guess, code execution terminates with an appropriate warning message.</div>
<div class="line"><a name="l03653"></a><span class="lineno"> 3653</span>&#160; </div>
<div class="line"><a name="l03654"></a><span class="lineno"> 3654</span>&#160; </div>
<div class="line"><a name="l03655"></a><span class="lineno"> 3655</span>&#160; </div>
<div class="line"><a name="l03656"></a><span class="lineno"> 3656</span>&#160; </div>
<div class="line"><a name="l03657"></a><span class="lineno"> 3657</span>&#160;\subsubsection solid_traction Solid traction elements</div>
<div class="line"><a name="l03658"></a><span class="lineno"> 3658</span>&#160; write after Poisson flux elements...</div>
<div class="line"><a name="l03659"></a><span class="lineno"> 3659</span>&#160; </div>
<div class="line"><a name="l03660"></a><span class="lineno"> 3660</span>&#160;\subsubsection beam_and_shell_elements Beam and shell elements</div>
<div class="line"><a name="l03661"></a><span class="lineno"> 3661</span>&#160; </div>
<div class="line"><a name="l03662"></a><span class="lineno"> 3662</span>&#160; </div>
<div class="line"><a name="l03663"></a><span class="lineno"> 3663</span>&#160; </div>
<div class="line"><a name="l03664"></a><span class="lineno"> 3664</span>&#160; </div>
<div class="line"><a name="l03665"></a><span class="lineno"> 3665</span>&#160; </div>
<div class="line"><a name="l03666"></a><span class="lineno"> 3666</span>&#160; </div>
<div class="line"><a name="l03667"></a><span class="lineno"> 3667</span>&#160; </div>
<div class="line"><a name="l03668"></a><span class="lineno"> 3668</span>&#160; </div>
<div class="line"><a name="l03669"></a><span class="lineno"> 3669</span>&#160; </div>
<div class="line"><a name="l03670"></a><span class="lineno"> 3670</span>&#160; </div>
<div class="line"><a name="l03671"></a><span class="lineno"> 3671</span>&#160; </div>
<div class="line"><a name="l03672"></a><span class="lineno"> 3672</span>&#160; </div>
<div class="line"><a name="l03673"></a><span class="lineno"> 3673</span>&#160; </div>
<div class="line"><a name="l03674"></a><span class="lineno"> 3674</span>&#160; </div>
<div class="line"><a name="l03675"></a><span class="lineno"> 3675</span>&#160;Here is another table that contrasts the various objects with their</div>
<div class="line"><a name="l03676"></a><span class="lineno"> 3676</span>&#160;procedural representation: </div>
<div class="line"><a name="l03677"></a><span class="lineno"> 3677</span>&#160; </div>
<div class="line"><a name="l03678"></a><span class="lineno"> 3678</span>&#160;&lt;TABLE BORDER=&quot;1&quot; &gt;</div>
<div class="line"><a name="l03679"></a><span class="lineno"> 3679</span>&#160;&lt;TR&gt;</div>
<div class="line"><a name="l03680"></a><span class="lineno"> 3680</span>&#160;&lt;TD WIDTH=&quot;50%&quot; VALIGN=&quot;TOP&quot;&gt;</div>
<div class="line"><a name="l03681"></a><span class="lineno"> 3681</span>&#160;- &quot;The Problem&quot; and &quot;The Mesh&quot;.</div>
<div class="line"><a name="l03682"></a><span class="lineno"> 3682</span>&#160;&lt;/TD&gt;</div>
<div class="line"><a name="l03683"></a><span class="lineno"> 3683</span>&#160;&lt;TD WIDTH=&quot;50%&quot; VALIGN=&quot;TOP&quot;&gt;</div>
<div class="line"><a name="l03684"></a><span class="lineno"> 3684</span>&#160;- The  Problem stores a pointer to a  Mesh object which is accessible</div>
<div class="line"><a name="l03685"></a><span class="lineno"> 3685</span>&#160;  via a pointer-based access function,</div>
<div class="line"><a name="l03686"></a><span class="lineno"> 3686</span>&#160;  \code</div>
<div class="line"><a name="l03687"></a><span class="lineno"> 3687</span>&#160;  Mesh* mesh_pt=Problem::mesh_pt();</div>
<div class="line"><a name="l03688"></a><span class="lineno"> 3688</span>&#160;  \endcode</div>
<div class="line"><a name="l03689"></a><span class="lineno"> 3689</span>&#160;- The  Mesh provides pointer-based access</div>
<div class="line"><a name="l03690"></a><span class="lineno"> 3690</span>&#160;  to its constituent  Elements and  Nodes,</div>
<div class="line"><a name="l03691"></a><span class="lineno"> 3691</span>&#160;  \code</div>
<div class="line"><a name="l03692"></a><span class="lineno"> 3692</span>&#160;  unsigned j;</div>
<div class="line"><a name="l03693"></a><span class="lineno"> 3693</span>&#160;  Node* node_pt=Mesh::node_pt(j);</div>
<div class="line"><a name="l03694"></a><span class="lineno"> 3694</span>&#160;  \endcode</div>
<div class="line"><a name="l03695"></a><span class="lineno"> 3695</span>&#160;  and</div>
<div class="line"><a name="l03696"></a><span class="lineno"> 3696</span>&#160;  \code</div>
<div class="line"><a name="l03697"></a><span class="lineno"> 3697</span>&#160;  unsigned e;</div>
<div class="line"><a name="l03698"></a><span class="lineno"> 3698</span>&#160;  FiniteElement* element_pt=Mesh::finite_element_pt(e);</div>
<div class="line"><a name="l03699"></a><span class="lineno"> 3699</span>&#160;  \endcode</div>
<div class="line"><a name="l03700"></a><span class="lineno"> 3700</span>&#160;  or</div>
<div class="line"><a name="l03701"></a><span class="lineno"> 3701</span>&#160;  \code</div>
<div class="line"><a name="l03702"></a><span class="lineno"> 3702</span>&#160;  unsigned e;</div>
<div class="line"><a name="l03703"></a><span class="lineno"> 3703</span>&#160;  GeneralisedElement* element_pt=Mesh::element_pt(e);</div>
<div class="line"><a name="l03704"></a><span class="lineno"> 3704</span>&#160;  \endcode</div>
<div class="line"><a name="l03705"></a><span class="lineno"> 3705</span>&#160;- The Mesh provides pointer-based access</div>
<div class="line"><a name="l03706"></a><span class="lineno"> 3706</span>&#160;  to Nodes that are located on its boundaries:</div>
<div class="line"><a name="l03707"></a><span class="lineno"> 3707</span>&#160;  \code</div>
<div class="line"><a name="l03708"></a><span class="lineno"> 3708</span>&#160;  unsigned i_boundary;</div>
<div class="line"><a name="l03709"></a><span class="lineno"> 3709</span>&#160;  unsigned j;</div>
<div class="line"><a name="l03710"></a><span class="lineno"> 3710</span>&#160;  Node* boundary_node_pt=Mesh::boundary_node_pt(i_boundary,j);</div>
<div class="line"><a name="l03711"></a><span class="lineno"> 3711</span>&#160;  \endcode</div>
<div class="line"><a name="l03712"></a><span class="lineno"> 3712</span>&#160;&lt;/TD&gt;</div>
<div class="line"><a name="l03713"></a><span class="lineno"> 3713</span>&#160;&lt;/TR&gt;</div>
<div class="line"><a name="l03714"></a><span class="lineno"> 3714</span>&#160;&lt;/TABLE&gt;</div>
<div class="line"><a name="l03715"></a><span class="lineno"> 3715</span>&#160; </div>
<div class="line"><a name="l03716"></a><span class="lineno"> 3716</span>&#160; </div>
<div class="line"><a name="l03717"></a><span class="lineno"> 3717</span>&#160;&lt;TABLE BORDER=&quot;1&quot; &gt;</div>
<div class="line"><a name="l03718"></a><span class="lineno"> 3718</span>&#160;&lt;TR&gt;</div>
<div class="line"><a name="l03719"></a><span class="lineno"> 3719</span>&#160;&lt;TD WIDTH=&quot;50%&quot; VALIGN=&quot;TOP&quot;&gt;</div>
<div class="line"><a name="l03720"></a><span class="lineno"> 3720</span>&#160;  - Global node \f$j\f$</div>
<div class="line"><a name="l03721"></a><span class="lineno"> 3721</span>&#160;&lt;/TD&gt;</div>
<div class="line"><a name="l03722"></a><span class="lineno"> 3722</span>&#160;&lt;TD WIDTH=&quot;50%&quot; VALIGN=&quot;TOP&quot;&gt;</div>
<div class="line"><a name="l03723"></a><span class="lineno"> 3723</span>&#160;  - Global node numbers identify Nodes within the Mesh</div>
<div class="line"><a name="l03724"></a><span class="lineno"> 3724</span>&#160;    (Nodes themselves do not have numbers!). Access to the </div>
<div class="line"><a name="l03725"></a><span class="lineno"> 3725</span>&#160;    Nodes is via pointers:</div>
<div class="line"><a name="l03726"></a><span class="lineno"> 3726</span>&#160;    \code</div>
<div class="line"><a name="l03727"></a><span class="lineno"> 3727</span>&#160;    unsigned j;</div>
<div class="line"><a name="l03728"></a><span class="lineno"> 3728</span>&#160;    Node* node_pt=Problem::mesh_pt()-&gt;node_pt(j);</div>
<div class="line"><a name="l03729"></a><span class="lineno"> 3729</span>&#160;    \endcode</div>
<div class="line"><a name="l03730"></a><span class="lineno"> 3730</span>&#160;&lt;/TD&gt;</div>
<div class="line"><a name="l03731"></a><span class="lineno"> 3731</span>&#160;&lt;/TABLE&gt;</div>
<div class="line"><a name="l03732"></a><span class="lineno"> 3732</span>&#160; </div>
<div class="line"><a name="l03733"></a><span class="lineno"> 3733</span>&#160; </div>
<div class="line"><a name="l03734"></a><span class="lineno"> 3734</span>&#160;&lt;TABLE BORDER=&quot;1&quot; &gt;</div>
<div class="line"><a name="l03735"></a><span class="lineno"> 3735</span>&#160;&lt;TR&gt;</div>
<div class="line"><a name="l03736"></a><span class="lineno"> 3736</span>&#160;&lt;TD WIDTH=&quot;50%&quot; VALIGN=&quot;TOP&quot;&gt;</div>
<div class="line"><a name="l03737"></a><span class="lineno"> 3737</span>&#160;- Element \f$e\f$</div>
<div class="line"><a name="l03738"></a><span class="lineno"> 3738</span>&#160;&lt;/TD&gt;</div>
<div class="line"><a name="l03739"></a><span class="lineno"> 3739</span>&#160;&lt;TD WIDTH=&quot;50%&quot; VALIGN=&quot;TOP&quot;&gt;</div>
<div class="line"><a name="l03740"></a><span class="lineno"> 3740</span>&#160;-  Element numbers identify  Elements within the  Mesh</div>
<div class="line"><a name="l03741"></a><span class="lineno"> 3741</span>&#160;  ( Elements themselves do not have numbers!). Access to the </div>
<div class="line"><a name="l03742"></a><span class="lineno"> 3742</span>&#160;   Elements is via pointers:</div>
<div class="line"><a name="l03743"></a><span class="lineno"> 3743</span>&#160;\code</div>
<div class="line"><a name="l03744"></a><span class="lineno"> 3744</span>&#160;unsigned e;</div>
<div class="line"><a name="l03745"></a><span class="lineno"> 3745</span>&#160;GeneralisedElement el_pt=Problem::mesh_pt()-&gt;element_pt(e);</div>
<div class="line"><a name="l03746"></a><span class="lineno"> 3746</span>&#160;\endcode</div>
<div class="line"><a name="l03747"></a><span class="lineno"> 3747</span>&#160;or</div>
<div class="line"><a name="l03748"></a><span class="lineno"> 3748</span>&#160;\code</div>
<div class="line"><a name="l03749"></a><span class="lineno"> 3749</span>&#160;unsigned e;</div>
<div class="line"><a name="l03750"></a><span class="lineno"> 3750</span>&#160;FiniteElement el_pt=Problem::mesh_pt()-&gt;finite_element_pt(e);</div>
<div class="line"><a name="l03751"></a><span class="lineno"> 3751</span>&#160;\endcode</div>
<div class="line"><a name="l03752"></a><span class="lineno"> 3752</span>&#160;&lt;/TD&gt;</div>
<div class="line"><a name="l03753"></a><span class="lineno"> 3753</span>&#160;&lt;/TR&gt;</div>
<div class="line"><a name="l03754"></a><span class="lineno"> 3754</span>&#160;&lt;/TABLE&gt;</div>
<div class="line"><a name="l03755"></a><span class="lineno"> 3755</span>&#160; </div>
<div class="line"><a name="l03756"></a><span class="lineno"> 3756</span>&#160; </div>
<div class="line"><a name="l03757"></a><span class="lineno"> 3757</span>&#160;&lt;TABLE BORDER=&quot;1&quot; &gt;</div>
<div class="line"><a name="l03758"></a><span class="lineno"> 3758</span>&#160;&lt;TR&gt;</div>
<div class="line"><a name="l03759"></a><span class="lineno"> 3759</span>&#160;&lt;TD WIDTH=&quot;50%&quot; VALIGN=&quot;TOP&quot;&gt;</div>
<div class="line"><a name="l03760"></a><span class="lineno"> 3760</span>&#160;- The \f$ i\f$-th coordinate of node \f$j\f$</div>
<div class="line"><a name="l03761"></a><span class="lineno"> 3761</span>&#160;  \f[ X_{ij} \f]</div>
<div class="line"><a name="l03762"></a><span class="lineno"> 3762</span>&#160;&lt;/TD&gt;</div>
<div class="line"><a name="l03763"></a><span class="lineno"> 3763</span>&#160;&lt;TD WIDTH=&quot;50%&quot; VALIGN=&quot;TOP&quot;&gt;</div>
<div class="line"><a name="l03764"></a><span class="lineno"> 3764</span>&#160;- The nodal coordinates are member data of the  Node object and are</div>
<div class="line"><a name="l03765"></a><span class="lineno"> 3765</span>&#160;  accessed via member functions</div>
<div class="line"><a name="l03766"></a><span class="lineno"> 3766</span>&#160;\code</div>
<div class="line"><a name="l03767"></a><span class="lineno"> 3767</span>&#160;double x=Node::x(0);</div>
<div class="line"><a name="l03768"></a><span class="lineno"> 3768</span>&#160;double y=Node::x(1);</div>
<div class="line"><a name="l03769"></a><span class="lineno"> 3769</span>&#160;\endcode</div>
<div class="line"><a name="l03770"></a><span class="lineno"> 3770</span>&#160;&lt;/TD&gt;</div>
<div class="line"><a name="l03771"></a><span class="lineno"> 3771</span>&#160;&lt;/TR&gt;</div>
<div class="line"><a name="l03772"></a><span class="lineno"> 3772</span>&#160;&lt;/TABLE&gt;</div>
<div class="line"><a name="l03773"></a><span class="lineno"> 3773</span>&#160; </div>
<div class="line"><a name="l03774"></a><span class="lineno"> 3774</span>&#160; </div>
<div class="line"><a name="l03775"></a><span class="lineno"> 3775</span>&#160;&lt;TABLE BORDER=&quot;1&quot; &gt;</div>
<div class="line"><a name="l03776"></a><span class="lineno"> 3776</span>&#160;&lt;TR&gt;</div>
<div class="line"><a name="l03777"></a><span class="lineno"> 3777</span>&#160;&lt;TD WIDTH=&quot;50%&quot; VALIGN=&quot;TOP&quot;&gt;</div>
<div class="line"><a name="l03778"></a><span class="lineno"> 3778</span>&#160;- The total number of nodes</div>
<div class="line"><a name="l03779"></a><span class="lineno"> 3779</span>&#160;  \f[ N \f]</div>
<div class="line"><a name="l03780"></a><span class="lineno"> 3780</span>&#160;&lt;/TD&gt;</div>
<div class="line"><a name="l03781"></a><span class="lineno"> 3781</span>&#160;&lt;TD WIDTH=&quot;50%&quot; VALIGN=&quot;TOP&quot;&gt;</div>
<div class="line"><a name="l03782"></a><span class="lineno"> 3782</span>&#160;- The total number of  Nodes in the  Mesh are </div>
<div class="line"><a name="l03783"></a><span class="lineno"> 3783</span>&#160;  accessible via a  Mesh member function</div>
<div class="line"><a name="l03784"></a><span class="lineno"> 3784</span>&#160;\code</div>
<div class="line"><a name="l03785"></a><span class="lineno"> 3785</span>&#160;unsigned n_nodes=Mesh::nnode();</div>
<div class="line"><a name="l03786"></a><span class="lineno"> 3786</span>&#160;\endcode</div>
<div class="line"><a name="l03787"></a><span class="lineno"> 3787</span>&#160;&lt;/TD&gt;</div>
<div class="line"><a name="l03788"></a><span class="lineno"> 3788</span>&#160;&lt;/TR&gt;</div>
<div class="line"><a name="l03789"></a><span class="lineno"> 3789</span>&#160;&lt;/TABLE&gt;</div>
<div class="line"><a name="l03790"></a><span class="lineno"> 3790</span>&#160; </div>
<div class="line"><a name="l03791"></a><span class="lineno"> 3791</span>&#160; </div>
<div class="line"><a name="l03792"></a><span class="lineno"> 3792</span>&#160;&lt;TABLE BORDER=&quot;1&quot; &gt;</div>
<div class="line"><a name="l03793"></a><span class="lineno"> 3793</span>&#160;&lt;TR&gt;</div>
<div class="line"><a name="l03794"></a><span class="lineno"> 3794</span>&#160;&lt;TD WIDTH=&quot;50%&quot; VALIGN=&quot;TOP&quot;&gt;</div>
<div class="line"><a name="l03795"></a><span class="lineno"> 3795</span>&#160;- The total number of elements</div>
<div class="line"><a name="l03796"></a><span class="lineno"> 3796</span>&#160;  \f[ N_E \f]</div>
<div class="line"><a name="l03797"></a><span class="lineno"> 3797</span>&#160;&lt;/TD&gt;</div>
<div class="line"><a name="l03798"></a><span class="lineno"> 3798</span>&#160;&lt;TD WIDTH=&quot;50%&quot; VALIGN=&quot;TOP&quot;&gt;</div>
<div class="line"><a name="l03799"></a><span class="lineno"> 3799</span>&#160;- The total number of  Elements in the  Mesh are </div>
<div class="line"><a name="l03800"></a><span class="lineno"> 3800</span>&#160;  accessible via a  Mesh member function</div>
<div class="line"><a name="l03801"></a><span class="lineno"> 3801</span>&#160;\code</div>
<div class="line"><a name="l03802"></a><span class="lineno"> 3802</span>&#160;unsigned n_elem=Mesh::nelement();</div>
<div class="line"><a name="l03803"></a><span class="lineno"> 3803</span>&#160;\endcode</div>
<div class="line"><a name="l03804"></a><span class="lineno"> 3804</span>&#160;&lt;/TD&gt;</div>
<div class="line"><a name="l03805"></a><span class="lineno"> 3805</span>&#160;&lt;/TR&gt;</div>
<div class="line"><a name="l03806"></a><span class="lineno"> 3806</span>&#160;&lt;/TABLE&gt;</div>
<div class="line"><a name="l03807"></a><span class="lineno"> 3807</span>&#160; </div>
<div class="line"><a name="l03808"></a><span class="lineno"> 3808</span>&#160; </div>
<div class="line"><a name="l03809"></a><span class="lineno"> 3809</span>&#160;&lt;TABLE BORDER=&quot;1&quot; &gt;</div>
<div class="line"><a name="l03810"></a><span class="lineno"> 3810</span>&#160;&lt;TR&gt;</div>
<div class="line"><a name="l03811"></a><span class="lineno"> 3811</span>&#160;&lt;TD WIDTH=&quot;50%&quot; VALIGN=&quot;TOP&quot;&gt;</div>
<div class="line"><a name="l03812"></a><span class="lineno"> 3812</span>&#160;- The total number of unknowns in the problem</div>
<div class="line"><a name="l03813"></a><span class="lineno"> 3813</span>&#160;  \f[ M \f]</div>
<div class="line"><a name="l03814"></a><span class="lineno"> 3814</span>&#160;&lt;/TD&gt;</div>
<div class="line"><a name="l03815"></a><span class="lineno"> 3815</span>&#160;&lt;TD WIDTH=&quot;50%&quot; VALIGN=&quot;TOP&quot;&gt;</div>
<div class="line"><a name="l03816"></a><span class="lineno"> 3816</span>&#160;- The total number of unknowns (degrees of freedom)</div>
<div class="line"><a name="l03817"></a><span class="lineno"> 3817</span>&#160;  in the  Problem are accessible accessible via a</div>
<div class="line"><a name="l03818"></a><span class="lineno"> 3818</span>&#160;   Problem member function</div>
<div class="line"><a name="l03819"></a><span class="lineno"> 3819</span>&#160;\code</div>
<div class="line"><a name="l03820"></a><span class="lineno"> 3820</span>&#160;unsigned n_dof=Problem::ndof();</div>
<div class="line"><a name="l03821"></a><span class="lineno"> 3821</span>&#160;\endcode</div>
<div class="line"><a name="l03822"></a><span class="lineno"> 3822</span>&#160;&lt;/TD&gt;</div>
<div class="line"><a name="l03823"></a><span class="lineno"> 3823</span>&#160;&lt;/TR&gt;</div>
<div class="line"><a name="l03824"></a><span class="lineno"> 3824</span>&#160;&lt;/TABLE&gt;</div>
<div class="line"><a name="l03825"></a><span class="lineno"> 3825</span>&#160; </div>
<div class="line"><a name="l03826"></a><span class="lineno"> 3826</span>&#160; </div>
<div class="line"><a name="l03827"></a><span class="lineno"> 3827</span>&#160;&lt;TABLE BORDER=&quot;1&quot; &gt;</div>
<div class="line"><a name="l03828"></a><span class="lineno"> 3828</span>&#160;&lt;TR&gt;</div>
<div class="line"><a name="l03829"></a><span class="lineno"> 3829</span>&#160;&lt;TD WIDTH=&quot;50%&quot; VALIGN=&quot;TOP&quot;&gt;</div>
<div class="line"><a name="l03830"></a><span class="lineno"> 3830</span>&#160;- The total number of nodes in an element</div>
<div class="line"><a name="l03831"></a><span class="lineno"> 3831</span>&#160;  \f[ n \f]</div>
<div class="line"><a name="l03832"></a><span class="lineno"> 3832</span>&#160;&lt;/TD&gt;</div>
<div class="line"><a name="l03833"></a><span class="lineno"> 3833</span>&#160;&lt;TD WIDTH=&quot;50%&quot; VALIGN=&quot;TOP&quot;&gt;</div>
<div class="line"><a name="l03834"></a><span class="lineno"> 3834</span>&#160;- The total number of  Nodes in an  Element are</div>
<div class="line"><a name="l03835"></a><span class="lineno"> 3835</span>&#160;  accessible via a  FiniteElement member function</div>
<div class="line"><a name="l03836"></a><span class="lineno"> 3836</span>&#160;  \code</div>
<div class="line"><a name="l03837"></a><span class="lineno"> 3837</span>&#160;  unsigned n_node=FiniteElement::nnode();</div>
<div class="line"><a name="l03838"></a><span class="lineno"> 3838</span>&#160;  \endcode</div>
<div class="line"><a name="l03839"></a><span class="lineno"> 3839</span>&#160;&lt;/TD&gt;</div>
<div class="line"><a name="l03840"></a><span class="lineno"> 3840</span>&#160;&lt;/TR&gt;</div>
<div class="line"><a name="l03841"></a><span class="lineno"> 3841</span>&#160;&lt;/TABLE&gt;</div>
<div class="line"><a name="l03842"></a><span class="lineno"> 3842</span>&#160; </div>
<div class="line"><a name="l03843"></a><span class="lineno"> 3843</span>&#160; </div>
<div class="line"><a name="l03844"></a><span class="lineno"> 3844</span>&#160;&lt;TABLE BORDER=&quot;1&quot; &gt;</div>
<div class="line"><a name="l03845"></a><span class="lineno"> 3845</span>&#160;&lt;TR&gt;</div>
<div class="line"><a name="l03846"></a><span class="lineno"> 3846</span>&#160;&lt;TD WIDTH=&quot;50%&quot; VALIGN=&quot;TOP&quot;&gt;</div>
<div class="line"><a name="l03847"></a><span class="lineno"> 3847</span>&#160;- Global node number \f$i_{global}\f$ of local node </div>
<div class="line"><a name="l03848"></a><span class="lineno"> 3848</span>&#160;  \f$i_{local}\f$ in element \f$ e \f$</div>
<div class="line"><a name="l03849"></a><span class="lineno"> 3849</span>&#160;  \f[</div>
<div class="line"><a name="l03850"></a><span class="lineno"> 3850</span>&#160;  i_{global}= {\cal J}(i_{local},e)</div>
<div class="line"><a name="l03851"></a><span class="lineno"> 3851</span>&#160;  \f]</div>
<div class="line"><a name="l03852"></a><span class="lineno"> 3852</span>&#160;&lt;/TD&gt;</div>
<div class="line"><a name="l03853"></a><span class="lineno"> 3853</span>&#160;&lt;TD WIDTH=&quot;50%&quot; VALIGN=&quot;TOP&quot;&gt;</div>
<div class="line"><a name="l03854"></a><span class="lineno"> 3854</span>&#160;- \c FiniteElements provide pointer-based access to their  Nodes</div>
<div class="line"><a name="l03855"></a><span class="lineno"> 3855</span>&#160;   \code</div>
<div class="line"><a name="l03856"></a><span class="lineno"> 3856</span>&#160;   unsigned i_local;</div>
<div class="line"><a name="l03857"></a><span class="lineno"> 3857</span>&#160;   Node* node_pt=FiniteElement::node_pt(i_local);</div>
<div class="line"><a name="l03858"></a><span class="lineno"> 3858</span>&#160;   \endcode</div>
<div class="line"><a name="l03859"></a><span class="lineno"> 3859</span>&#160;&lt;/TD&gt;</div>
<div class="line"><a name="l03860"></a><span class="lineno"> 3860</span>&#160;&lt;/TR&gt;</div>
<div class="line"><a name="l03861"></a><span class="lineno"> 3861</span>&#160;&lt;/TABLE&gt;</div>
<div class="line"><a name="l03862"></a><span class="lineno"> 3862</span>&#160; </div>
<div class="line"><a name="l03863"></a><span class="lineno"> 3863</span>&#160; </div>
<div class="line"><a name="l03864"></a><span class="lineno"> 3864</span>&#160;&lt;TABLE BORDER=&quot;1&quot; &gt;</div>
<div class="line"><a name="l03865"></a><span class="lineno"> 3865</span>&#160;&lt;TR&gt;</div>
<div class="line"><a name="l03866"></a><span class="lineno"> 3866</span>&#160;&lt;TD WIDTH=&quot;50%&quot; VALIGN=&quot;TOP&quot;&gt;</div>
<div class="line"><a name="l03867"></a><span class="lineno"> 3867</span>&#160;- The equation number of node \f$j\f$</div>
<div class="line"><a name="l03868"></a><span class="lineno"> 3868</span>&#160;  \f[ {\cal E}(j) \f]</div>
<div class="line"><a name="l03869"></a><span class="lineno"> 3869</span>&#160;&lt;/TD&gt;</div>
<div class="line"><a name="l03870"></a><span class="lineno"> 3870</span>&#160;&lt;TD WIDTH=&quot;50%&quot; VALIGN=&quot;TOP&quot;&gt;</div>
<div class="line"><a name="l03871"></a><span class="lineno"> 3871</span>&#160;- The global equation number of a  Node is</div>
<div class="line"><a name="l03872"></a><span class="lineno"> 3872</span>&#160;  accessible via a  Node member function</div>
<div class="line"><a name="l03873"></a><span class="lineno"> 3873</span>&#160;\code</div>
<div class="line"><a name="l03874"></a><span class="lineno"> 3874</span>&#160;unsigned i_eqn=Node::eqn_number(0);</div>
<div class="line"><a name="l03875"></a><span class="lineno"> 3875</span>&#160;\endcode</div>
<div class="line"><a name="l03876"></a><span class="lineno"> 3876</span>&#160;[See \ref systems_of_PDEs for an explanation of the argument</div>
<div class="line"><a name="l03877"></a><span class="lineno"> 3877</span>&#160; to this function.]</div>
<div class="line"><a name="l03878"></a><span class="lineno"> 3878</span>&#160;&lt;/TD&gt;</div>
<div class="line"><a name="l03879"></a><span class="lineno"> 3879</span>&#160;&lt;/TR&gt;</div>
<div class="line"><a name="l03880"></a><span class="lineno"> 3880</span>&#160;&lt;/TABLE&gt;</div>
<div class="line"><a name="l03881"></a><span class="lineno"> 3881</span>&#160; </div>
<div class="line"><a name="l03882"></a><span class="lineno"> 3882</span>&#160; </div>
<div class="line"><a name="l03883"></a><span class="lineno"> 3883</span>&#160;&lt;TABLE BORDER=&quot;1&quot; &gt;</div>
<div class="line"><a name="l03884"></a><span class="lineno"> 3884</span>&#160;&lt;TR&gt;</div>
<div class="line"><a name="l03885"></a><span class="lineno"> 3885</span>&#160;&lt;TD WIDTH=&quot;50%&quot; VALIGN=&quot;TOP&quot;&gt;</div>
<div class="line"><a name="l03886"></a><span class="lineno"> 3886</span>&#160;- The fact that node \f$ j \f$ is pinned  </div>
<div class="line"><a name="l03887"></a><span class="lineno"> 3887</span>&#160;  is indicated by</div>
<div class="line"><a name="l03888"></a><span class="lineno"> 3888</span>&#160;  \f[ {\cal E}(j) = -1 \f]</div>
<div class="line"><a name="l03889"></a><span class="lineno"> 3889</span>&#160;&lt;/TD&gt;</div>
<div class="line"><a name="l03890"></a><span class="lineno"> 3890</span>&#160;&lt;TD WIDTH=&quot;50%&quot; VALIGN=&quot;TOP&quot;&gt;</div>
<div class="line"><a name="l03891"></a><span class="lineno"> 3891</span>&#160;- The fact that a  Node is pinned  </div>
<div class="line"><a name="l03892"></a><span class="lineno"> 3892</span>&#160;  is indicated by</div>
<div class="line"><a name="l03893"></a><span class="lineno"> 3893</span>&#160;  \code</div>
<div class="line"><a name="l03894"></a><span class="lineno"> 3894</span>&#160;  bool pinned=Node::is_pinned(0);</div>
<div class="line"><a name="l03895"></a><span class="lineno"> 3895</span>&#160;  \endcode</div>
<div class="line"><a name="l03896"></a><span class="lineno"> 3896</span>&#160;  or, equivalently,</div>
<div class="line"><a name="l03897"></a><span class="lineno"> 3897</span>&#160;  \code</div>
<div class="line"><a name="l03898"></a><span class="lineno"> 3898</span>&#160;  bool pinned=(Node::eqn_number(0)&lt;0);</div>
<div class="line"><a name="l03899"></a><span class="lineno"> 3899</span>&#160;  \endcode</div>
<div class="line"><a name="l03900"></a><span class="lineno"> 3900</span>&#160;  [See \ref systems_of_PDEs for an explanation of the argument</div>
<div class="line"><a name="l03901"></a><span class="lineno"> 3901</span>&#160;   to these functions.]</div>
<div class="line"><a name="l03902"></a><span class="lineno"> 3902</span>&#160;&lt;/TD&gt;</div>
<div class="line"><a name="l03903"></a><span class="lineno"> 3903</span>&#160;&lt;/TR&gt;</div>
<div class="line"><a name="l03904"></a><span class="lineno"> 3904</span>&#160;&lt;/TABLE&gt;</div>
<div class="line"><a name="l03905"></a><span class="lineno"> 3905</span>&#160; </div>
<div class="line"><a name="l03906"></a><span class="lineno"> 3906</span>&#160; </div>
<div class="line"><a name="l03907"></a><span class="lineno"> 3907</span>&#160;&lt;TABLE BORDER=&quot;1&quot; &gt;</div>
<div class="line"><a name="l03908"></a><span class="lineno"> 3908</span>&#160;&lt;TR&gt;</div>
<div class="line"><a name="l03909"></a><span class="lineno"> 3909</span>&#160;&lt;TD WIDTH=&quot;50%&quot; VALIGN=&quot;TOP&quot;&gt;</div>
<div class="line"><a name="l03910"></a><span class="lineno"> 3910</span>&#160;- Nodal value at node \f$ j \f$</div>
<div class="line"><a name="l03911"></a><span class="lineno"> 3911</span>&#160;  \f[ U_j \f]</div>
<div class="line"><a name="l03912"></a><span class="lineno"> 3912</span>&#160;&lt;/TD&gt;</div>
<div class="line"><a name="l03913"></a><span class="lineno"> 3913</span>&#160;&lt;TD WIDTH=&quot;50%&quot; VALIGN=&quot;TOP&quot;&gt;</div>
<div class="line"><a name="l03914"></a><span class="lineno"> 3914</span>&#160;- Access to nodal values is via pointers</div>
<div class="line"><a name="l03915"></a><span class="lineno"> 3915</span>&#160;  \code</div>
<div class="line"><a name="l03916"></a><span class="lineno"> 3916</span>&#160;  double u=*(Node::value_pt(0));</div>
<div class="line"><a name="l03917"></a><span class="lineno"> 3917</span>&#160;  \endcode</div>
<div class="line"><a name="l03918"></a><span class="lineno"> 3918</span>&#160;  [See \ref systems_of_PDEs for an explanation of the argument</div>
<div class="line"><a name="l03919"></a><span class="lineno"> 3919</span>&#160;   to this function.]</div>
<div class="line"><a name="l03920"></a><span class="lineno"> 3920</span>&#160;&lt;/TD&gt;</div>
<div class="line"><a name="l03921"></a><span class="lineno"> 3921</span>&#160;&lt;/TR&gt;</div>
<div class="line"><a name="l03922"></a><span class="lineno"> 3922</span>&#160;&lt;/TABLE&gt;</div>
<div class="line"><a name="l03923"></a><span class="lineno"> 3923</span>&#160; </div>
<div class="line"><a name="l03924"></a><span class="lineno"> 3924</span>&#160; </div>
<div class="line"><a name="l03925"></a><span class="lineno"> 3925</span>&#160;&lt;TABLE BORDER=&quot;1&quot; &gt;</div>
<div class="line"><a name="l03926"></a><span class="lineno"> 3926</span>&#160;&lt;TR&gt;</div>
<div class="line"><a name="l03927"></a><span class="lineno"> 3927</span>&#160;&lt;TD WIDTH=&quot;50%&quot; VALIGN=&quot;TOP&quot;&gt;</div>
<div class="line"><a name="l03928"></a><span class="lineno"> 3928</span>&#160;- The global equation number \f$ i_{global}\f$ </div>
<div class="line"><a name="l03929"></a><span class="lineno"> 3929</span>&#160;  of the local unknown \f$i_{local}\f$</div>
<div class="line"><a name="l03930"></a><span class="lineno"> 3930</span>&#160;  in element  \f$e\f$</div>
<div class="line"><a name="l03931"></a><span class="lineno"> 3931</span>&#160;  \f[  i_{global} = \widehat{\cal E}(i_{local},e) \f]</div>
<div class="line"><a name="l03932"></a><span class="lineno"> 3932</span>&#160;&lt;/TD&gt;</div>
<div class="line"><a name="l03933"></a><span class="lineno"> 3933</span>&#160;&lt;TD WIDTH=&quot;50%&quot; VALIGN=&quot;TOP&quot;&gt;</div>
<div class="line"><a name="l03934"></a><span class="lineno"> 3934</span>&#160;- The global equation number of local unknown \f$ i_{local} \f$ </div>
<div class="line"><a name="l03935"></a><span class="lineno"> 3935</span>&#160;  in an  Element is</div>
<div class="line"><a name="l03936"></a><span class="lineno"> 3936</span>&#160;  accessible via a \c GeneralisedElement member function</div>
<div class="line"><a name="l03937"></a><span class="lineno"> 3937</span>&#160;\code</div>
<div class="line"><a name="l03938"></a><span class="lineno"> 3938</span>&#160;unsigned i_local;</div>
<div class="line"><a name="l03939"></a><span class="lineno"> 3939</span>&#160;unsigned i_global=GeneralisedElement::eqn_number(i_local);</div>
<div class="line"><a name="l03940"></a><span class="lineno"> 3940</span>&#160;\endcode</div>
<div class="line"><a name="l03941"></a><span class="lineno"> 3941</span>&#160;&lt;/TD&gt;</div>
<div class="line"><a name="l03942"></a><span class="lineno"> 3942</span>&#160;&lt;/TR&gt;</div>
<div class="line"><a name="l03943"></a><span class="lineno"> 3943</span>&#160;&lt;/TABLE&gt;</div>
<div class="line"><a name="l03944"></a><span class="lineno"> 3944</span>&#160; </div>
<div class="line"><a name="l03945"></a><span class="lineno"> 3945</span>&#160; </div>
<div class="line"><a name="l03946"></a><span class="lineno"> 3946</span>&#160;&lt;TABLE BORDER=&quot;1&quot; &gt;</div>
<div class="line"><a name="l03947"></a><span class="lineno"> 3947</span>&#160;&lt;TR&gt;</div>
<div class="line"><a name="l03948"></a><span class="lineno"> 3948</span>&#160;&lt;TD WIDTH=&quot;50%&quot; VALIGN=&quot;TOP&quot;&gt;</div>
<div class="line"><a name="l03949"></a><span class="lineno"> 3949</span>&#160;- All shape functions in element \f$ e \f$</div>
<div class="line"><a name="l03950"></a><span class="lineno"> 3950</span>&#160;  \f[ \psi_i(s_1,s_2) \ \ (i=1,...,n) \f]</div>
<div class="line"><a name="l03951"></a><span class="lineno"> 3951</span>&#160;&lt;/TD&gt;</div>
<div class="line"><a name="l03952"></a><span class="lineno"> 3952</span>&#160;&lt;TD WIDTH=&quot;50%&quot; VALIGN=&quot;TOP&quot;&gt;</div>
<div class="line"><a name="l03953"></a><span class="lineno"> 3953</span>&#160;- Shape functions are </div>
<div class="line"><a name="l03954"></a><span class="lineno"> 3954</span>&#160;  implemented in concrete  Elements,</div>
<div class="line"><a name="l03955"></a><span class="lineno"> 3955</span>&#160;  \code</div>
<div class="line"><a name="l03956"></a><span class="lineno"> 3956</span>&#160;  Vector&lt;double&gt; s(2); // 2 local coordinates</div>
<div class="line"><a name="l03957"></a><span class="lineno"> 3957</span>&#160;  Shape psi(9);        // 9 shape functions</div>
<div class="line"><a name="l03958"></a><span class="lineno"> 3958</span>&#160;  QPoissonElement&lt;3,2&gt;::shape(s,psi);</div>
<div class="line"><a name="l03959"></a><span class="lineno"> 3959</span>&#160;  \endcode</div>
<div class="line"><a name="l03960"></a><span class="lineno"> 3960</span>&#160;  using the standard interfaces defined in the \c FiniteElement</div>
<div class="line"><a name="l03961"></a><span class="lineno"> 3961</span>&#160;  base class.</div>
<div class="line"><a name="l03962"></a><span class="lineno"> 3962</span>&#160;&lt;/TD&gt;</div>
<div class="line"><a name="l03963"></a><span class="lineno"> 3963</span>&#160;&lt;/TR&gt;</div>
<div class="line"><a name="l03964"></a><span class="lineno"> 3964</span>&#160;&lt;/TABLE&gt;</div>
<div class="line"><a name="l03965"></a><span class="lineno"> 3965</span>&#160; </div>
<div class="line"><a name="l03966"></a><span class="lineno"> 3966</span>&#160; </div>
<div class="line"><a name="l03967"></a><span class="lineno"> 3967</span>&#160;&lt;TABLE BORDER=&quot;1&quot; &gt;</div>
<div class="line"><a name="l03968"></a><span class="lineno"> 3968</span>&#160;&lt;TR&gt;</div>
<div class="line"><a name="l03969"></a><span class="lineno"> 3969</span>&#160;&lt;TD WIDTH=&quot;50%&quot; VALIGN=&quot;TOP&quot;&gt;</div>
<div class="line"><a name="l03970"></a><span class="lineno"> 3970</span>&#160;- Derivatives of all shape functions in element \f$ e \f$</div>
<div class="line"><a name="l03971"></a><span class="lineno"> 3971</span>&#160;  with respect to the local coordinates \f$ (s_1,s_2) \f$, </div>
<div class="line"><a name="l03972"></a><span class="lineno"> 3972</span>&#160;  \f[ \partial \psi_i/\partial s_j \ \ (i=1,...,n; \ j=1,2) \f]</div>
<div class="line"><a name="l03973"></a><span class="lineno"> 3973</span>&#160;&lt;/TD&gt;</div>
<div class="line"><a name="l03974"></a><span class="lineno"> 3974</span>&#160;&lt;TD WIDTH=&quot;50%&quot; VALIGN=&quot;TOP&quot;&gt;</div>
<div class="line"><a name="l03975"></a><span class="lineno"> 3975</span>&#160;- Shape functions and their derivatives are implemented in</div>
<div class="line"><a name="l03976"></a><span class="lineno"> 3976</span>&#160;  concrete  Elements,</div>
<div class="line"><a name="l03977"></a><span class="lineno"> 3977</span>&#160;  \code</div>
<div class="line"><a name="l03978"></a><span class="lineno"> 3978</span>&#160;  Vector&lt;double&gt; s(2); // 2 local coordinates</div>
<div class="line"><a name="l03979"></a><span class="lineno"> 3979</span>&#160;  Shape psi(9);        // 9 shape functions</div>
<div class="line"><a name="l03980"></a><span class="lineno"> 3980</span>&#160;  DShape dpsi(9,2);    // 9 shape functions have</div>
<div class="line"><a name="l03981"></a><span class="lineno"> 3981</span>&#160;                       // 2 derivatives each</div>
<div class="line"><a name="l03982"></a><span class="lineno"> 3982</span>&#160;  QPoissonElement&lt;3,2&gt;::dshape_local(s,psi,dpsi);</div>
<div class="line"><a name="l03983"></a><span class="lineno"> 3983</span>&#160;  \endcode</div>
<div class="line"><a name="l03984"></a><span class="lineno"> 3984</span>&#160;  using the standard interfaces defined in the \c FiniteElement</div>
<div class="line"><a name="l03985"></a><span class="lineno"> 3985</span>&#160;  base class.</div>
<div class="line"><a name="l03986"></a><span class="lineno"> 3986</span>&#160;&lt;/TD&gt;</div>
<div class="line"><a name="l03987"></a><span class="lineno"> 3987</span>&#160;&lt;/TR&gt;</div>
<div class="line"><a name="l03988"></a><span class="lineno"> 3988</span>&#160;&lt;/TABLE&gt;</div>
<div class="line"><a name="l03989"></a><span class="lineno"> 3989</span>&#160; </div>
<div class="line"><a name="l03990"></a><span class="lineno"> 3990</span>&#160; </div>
<div class="line"><a name="l03991"></a><span class="lineno"> 3991</span>&#160;&lt;TABLE BORDER=&quot;1&quot; &gt;</div>
<div class="line"><a name="l03992"></a><span class="lineno"> 3992</span>&#160;&lt;TR&gt;</div>
<div class="line"><a name="l03993"></a><span class="lineno"> 3993</span>&#160;&lt;TD WIDTH=&quot;50%&quot; VALIGN=&quot;TOP&quot;&gt;</div>
<div class="line"><a name="l03994"></a><span class="lineno"> 3994</span>&#160;- Derivatives of all shape functions in element \f$ e \f$</div>
<div class="line"><a name="l03995"></a><span class="lineno"> 3995</span>&#160;  with respect to the global (Eulerian) coordinates \f$ (x_1,x_2) \f$, </div>
<div class="line"><a name="l03996"></a><span class="lineno"> 3996</span>&#160;  \f[ \partial \psi_i/\partial x_j \ \ (i=1,...,n; \ j=1,2) \f]</div>
<div class="line"><a name="l03997"></a><span class="lineno"> 3997</span>&#160;&lt;/TD&gt;</div>
<div class="line"><a name="l03998"></a><span class="lineno"> 3998</span>&#160;&lt;TD WIDTH=&quot;50%&quot; VALIGN=&quot;TOP&quot;&gt;</div>
<div class="line"><a name="l03999"></a><span class="lineno"> 3999</span>&#160;- Shape functions and their derivatives are implemented in concrete</div>
<div class="line"><a name="l04000"></a><span class="lineno"> 4000</span>&#160;   Elements,</div>
<div class="line"><a name="l04001"></a><span class="lineno"> 4001</span>&#160;  \code</div>
<div class="line"><a name="l04002"></a><span class="lineno"> 4002</span>&#160;  Vector&lt;double&gt; s(2); // 2 local coordinates</div>
<div class="line"><a name="l04003"></a><span class="lineno"> 4003</span>&#160;  Shape psi(9);        // 9 shape functions</div>
<div class="line"><a name="l04004"></a><span class="lineno"> 4004</span>&#160;  DShape dpsidx(9,2);  // 9 shape functions have</div>
<div class="line"><a name="l04005"></a><span class="lineno"> 4005</span>&#160;                       // 2 derivatives each</div>
<div class="line"><a name="l04006"></a><span class="lineno"> 4006</span>&#160;  QPoissonElement&lt;3,2&gt;::dshape_eulerian(s,psi,dpsidx);</div>
<div class="line"><a name="l04007"></a><span class="lineno"> 4007</span>&#160;  \endcode</div>
<div class="line"><a name="l04008"></a><span class="lineno"> 4008</span>&#160;  using the standard interfaces defined in the \c FiniteElement</div>
<div class="line"><a name="l04009"></a><span class="lineno"> 4009</span>&#160;  base class.</div>
<div class="line"><a name="l04010"></a><span class="lineno"> 4010</span>&#160;&lt;/TD&gt;</div>
<div class="line"><a name="l04011"></a><span class="lineno"> 4011</span>&#160;&lt;/TR&gt;</div>
<div class="line"><a name="l04012"></a><span class="lineno"> 4012</span>&#160;&lt;/TABLE&gt;</div>
<div class="line"><a name="l04013"></a><span class="lineno"> 4013</span>&#160; </div>
<div class="line"><a name="l04014"></a><span class="lineno"> 4014</span>&#160; </div>
<div class="line"><a name="l04015"></a><span class="lineno"> 4015</span>&#160;&lt;TABLE BORDER=&quot;1&quot; &gt;</div>
<div class="line"><a name="l04016"></a><span class="lineno"> 4016</span>&#160;&lt;TR&gt;</div>
<div class="line"><a name="l04017"></a><span class="lineno"> 4017</span>&#160;&lt;TD WIDTH=&quot;50%&quot; VALIGN=&quot;TOP&quot;&gt;</div>
<div class="line"><a name="l04018"></a><span class="lineno"> 4018</span>&#160;- Number of degrees of freedom  in element \f$ e \f$</div>
<div class="line"><a name="l04019"></a><span class="lineno"> 4019</span>&#160;  \f[ {\cal N}_{dof}(e) \f]</div>
<div class="line"><a name="l04020"></a><span class="lineno"> 4020</span>&#160;&lt;/TD&gt;</div>
<div class="line"><a name="l04021"></a><span class="lineno"> 4021</span>&#160;&lt;TD WIDTH=&quot;50%&quot; VALIGN=&quot;TOP&quot;&gt;</div>
<div class="line"><a name="l04022"></a><span class="lineno"> 4022</span>&#160;- The number of degrees of freedom in an element are available  from a </div>
<div class="line"><a name="l04023"></a><span class="lineno"> 4023</span>&#160;  \c GeneralisedElement member function</div>
<div class="line"><a name="l04024"></a><span class="lineno"> 4024</span>&#160;  \code</div>
<div class="line"><a name="l04025"></a><span class="lineno"> 4025</span>&#160;  unsigned ndof=GeneralisedElement::ndof();</div>
<div class="line"><a name="l04026"></a><span class="lineno"> 4026</span>&#160;  \endcode</div>
<div class="line"><a name="l04027"></a><span class="lineno"> 4027</span>&#160;&lt;/TD&gt;</div>
<div class="line"><a name="l04028"></a><span class="lineno"> 4028</span>&#160;&lt;/TR&gt;</div>
<div class="line"><a name="l04029"></a><span class="lineno"> 4029</span>&#160;&lt;/TABLE&gt;</div>
<div class="line"><a name="l04030"></a><span class="lineno"> 4030</span>&#160; </div>
<div class="line"><a name="l04031"></a><span class="lineno"> 4031</span>&#160; </div>
<div class="line"><a name="l04032"></a><span class="lineno"> 4032</span>&#160;&lt;TABLE BORDER=&quot;1&quot; &gt;</div>
<div class="line"><a name="l04033"></a><span class="lineno"> 4033</span>&#160;&lt;TR&gt;</div>
<div class="line"><a name="l04034"></a><span class="lineno"> 4034</span>&#160;&lt;TD WIDTH=&quot;50%&quot; VALIGN=&quot;TOP&quot;&gt;</div>
<div class="line"><a name="l04035"></a><span class="lineno"> 4035</span>&#160;- The local residual vector and Jacobian matrix in element \f$ e \f$</div>
<div class="line"><a name="l04036"></a><span class="lineno"> 4036</span>&#160;  \f[ J^{(e)}_{ij} \mbox{ \ \ and \ \ }  r^{(e)}_{i} \ \ \ </div>
<div class="line"><a name="l04037"></a><span class="lineno"> 4037</span>&#160;     (i,j=1,...,{\cal N}_{dof}(e)) \f]</div>
<div class="line"><a name="l04038"></a><span class="lineno"> 4038</span>&#160;&lt;/TD&gt;</div>
<div class="line"><a name="l04039"></a><span class="lineno"> 4039</span>&#160;&lt;TD WIDTH=&quot;50%&quot; VALIGN=&quot;TOP&quot;&gt;</div>
<div class="line"><a name="l04040"></a><span class="lineno"> 4040</span>&#160;- The computation of the element Jacobian matrix and </div>
<div class="line"><a name="l04041"></a><span class="lineno"> 4041</span>&#160;  residual vector are implemented in concrete  Elements,</div>
<div class="line"><a name="l04042"></a><span class="lineno"> 4042</span>&#160;  using the standard interfaces defined in the \c GeneralisedElement</div>
<div class="line"><a name="l04043"></a><span class="lineno"> 4043</span>&#160;  base class:</div>
<div class="line"><a name="l04044"></a><span class="lineno"> 4044</span>&#160;  \code</div>
<div class="line"><a name="l04045"></a><span class="lineno"> 4045</span>&#160; </div>
<div class="line"><a name="l04046"></a><span class="lineno"> 4046</span>&#160;  // Which element are we dealing with?</div>
<div class="line"><a name="l04047"></a><span class="lineno"> 4047</span>&#160;  unsigned e;</div>
<div class="line"><a name="l04048"></a><span class="lineno"> 4048</span>&#160;  QPoissonElement&lt;3,2&gt; * el_pt=Problem::mesh_pt()-&gt;element_pt(e);</div>
<div class="line"><a name="l04049"></a><span class="lineno"> 4049</span>&#160; </div>
<div class="line"><a name="l04050"></a><span class="lineno"> 4050</span>&#160;  // How many dofs are there in the element?</div>
<div class="line"><a name="l04051"></a><span class="lineno"> 4051</span>&#160;  unsigned ndof=el_pt-&gt;ndof();</div>
<div class="line"><a name="l04052"></a><span class="lineno"> 4052</span>&#160; </div>
<div class="line"><a name="l04053"></a><span class="lineno"> 4053</span>&#160;  // Allocate residual vector and Jacobian matrix</div>
<div class="line"><a name="l04054"></a><span class="lineno"> 4054</span>&#160;  Vector&lt;double&gt; residual(ndof);</div>
<div class="line"><a name="l04055"></a><span class="lineno"> 4055</span>&#160;  DenseDoubleMatrix jacobian(ndof,ndof);</div>
<div class="line"><a name="l04056"></a><span class="lineno"> 4056</span>&#160; </div>
<div class="line"><a name="l04057"></a><span class="lineno"> 4057</span>&#160;  // Get the residual vector and Jacobian matrix from the element</div>
<div class="line"><a name="l04058"></a><span class="lineno"> 4058</span>&#160;  el_pt-&gt;get_jacobian(jacobian,residual);</div>
<div class="line"><a name="l04059"></a><span class="lineno"> 4059</span>&#160; </div>
<div class="line"><a name="l04060"></a><span class="lineno"> 4060</span>&#160;  \endcode</div>
<div class="line"><a name="l04061"></a><span class="lineno"> 4061</span>&#160;&lt;/TD&gt;</div>
<div class="line"><a name="l04062"></a><span class="lineno"> 4062</span>&#160;&lt;/TR&gt;</div>
<div class="line"><a name="l04063"></a><span class="lineno"> 4063</span>&#160;&lt;/TABLE&gt;</div>
<div class="line"><a name="l04064"></a><span class="lineno"> 4064</span>&#160;&lt;HR&gt;</div>
<div class="line"><a name="l04065"></a><span class="lineno"> 4065</span>&#160;&lt;HR&gt;</div>
<div class="line"><a name="l04066"></a><span class="lineno"> 4066</span>&#160; </div>
<div class="line"><a name="l04067"></a><span class="lineno"> 4067</span>&#160;\endhtmlonly</div>
<div class="line"><a name="l04068"></a><span class="lineno"> 4068</span>&#160; </div>
<div class="line"><a name="l04069"></a><span class="lineno"> 4069</span>&#160;\latexonly</div>
<div class="line"><a name="l04070"></a><span class="lineno"> 4070</span>&#160;{\bf</div>
<div class="line"><a name="l04071"></a><span class="lineno"> 4071</span>&#160;\begin{center}</div>
<div class="line"><a name="l04072"></a><span class="lineno"> 4072</span>&#160;Sorry -- latex version of this document is switched off. As the title</div>
<div class="line"><a name="l04073"></a><span class="lineno"> 4073</span>&#160;suggests, it contains only a collection of leftover bits of</div>
<div class="line"><a name="l04074"></a><span class="lineno"> 4074</span>&#160;documentation, is therefore incomplete, and tends to break</div>
<div class="line"><a name="l04075"></a><span class="lineno"> 4075</span>&#160;when the pdf version is made.</div>
<div class="line"><a name="l04076"></a><span class="lineno"> 4076</span>&#160;\end{center}</div>
<div class="line"><a name="l04077"></a><span class="lineno"> 4077</span>&#160;}</div>
<div class="line"><a name="l04078"></a><span class="lineno"> 4078</span>&#160;\endlatexonly</div>
<div class="line"><a name="l04079"></a><span class="lineno"> 4079</span>&#160; </div>
<div class="line"><a name="l04080"></a><span class="lineno"> 4080</span>&#160;&lt;hr&gt;</div>
<div class="line"><a name="l04081"></a><span class="lineno"> 4081</span>&#160;&lt;hr&gt;</div>
<div class="line"><a name="l04082"></a><span class="lineno"> 4082</span>&#160;\section pdf PDF file</div>
<div class="line"><a name="l04083"></a><span class="lineno"> 4083</span>&#160;A &lt;a href=&quot;../latex/refman.pdf&quot;&gt;pdf version&lt;/a&gt; of this document is available.</div>
<div class="line"><a name="l04084"></a><span class="lineno"> 4084</span>&#160;**/</div>
<div class="line"><a name="l04085"></a><span class="lineno"> 4085</span>&#160; </div>
</div><!-- fragment --></div><!-- contents -->

    <!-- jQuery for Bootstrap and Doxygen -->
    <script src="../../js/jquery-1.12.0.min.js"></script>
    <!-- Minified boostrap plugins-->
    <script src="../../js/bootstrap.js"></script>
    <!-- Doxygen dependency to add powertips to source code-->
    <script src="../../js/jquery.powertip.min.js"></script>
    <!-- The  following script is generated by doxygen and hides/shows levels in 
         the data structure lists and adds powertips to source code-->
    <script src="../../js/dynsections.js" ></script>
    <!-- add to Doxygen's class names so bootstrap css and js recognises them-->
    <script type="text/javascript">
    $(".contents").addClass("container");
    $(".header").addClass("container");
    $(".navpath").addClass("container");
    $("#navrow3").addClass("container");
    $("#navrow4").addClass("container");
    $(".mlabel").addClass("label");
    $(".mlabel").addClass("label-default");
    $(".memitem").addClass("panel");
    $(".memitem").addClass("panel-info");
    $(".memproto").addClass("panel-heading");
    $(".memdoc").addClass("panel-body");
    </script>
    <footer>
      <div class="container">
        <div class="text-muted" style="float:right;">Generated by <a href="http://www.doxygen.org/index.html">
          <img style="height:18px;" class="footer-img" src="doxygen.png" alt="doxygen"></a> on Fri Nov 24 2023 15:03:26
        </div>
      </div>
    </footer>
</body>
</html>

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
<title>oomph-lib: The equations of time-harmonic linear elasticity and use of PMLs</title>
<link rel="apple-touch-icon" sizes="57x57" href="../../figures/apple-touch-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="../../figures/apple-touch-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="../../figures/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="../../figures/apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="../../figures/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="../../figures/apple-touch-icon-120x120.png">
<link rel="icon" type="image/png" href="../../figures/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="../../figures/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="../../figures/favicon-16x16.png" sizes="16x16">
<link rel="manifest" href="../../figures/manifest.json">
<link rel="mask-icon" href="../../figures/safari-pinned-tab.svg" color="#008000">
<link rel="shortcut icon" href="../../figures/favicon.ico">
<meta name="msapplication-TileColor" content="#00a300">
<meta name="msapplication-config" content="../../figures/browserconfig.xml">
<meta name="theme-color" content="#008000">
<link href="http://fonts.googleapis.com/css?family=Open+Sans:400,300,600" rel="stylesheet" type="text/css">
<!-- Doxygen css-->
<!-- <link rel="stylesheet" type="text/css" href="doxygen.css"> -->
<!-- Bootstrap -->
<link href="../../css/bootstrap.css" rel="stylesheet">
<!-- oomph-lib specific overrides -->
<link rel="stylesheet" type="text/css" href="../../css/oomph_header.css">
</head>
<body>
<nav class="navbar navbar-default">
<div class="container">
<div class="container-fluid">
  <!-- Brand and toggle get grouped for better mobile display -->
  <div class="navbar-header">
    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
      <span class="sr-only">Toggle navigation</span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="../../html/index.html"><img alt="oomph-lib" src="../../figures/oomph_logo.png"></a>
  </div>
  <!-- Collect the nav links, forms, and other content for toggling -->
  <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
    <ul class="nav navbar-nav">          
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Documentation <span class="caret"></span></a>
        <ul class="dropdown-menu">
          <li class="dropdown-header">Big picture</li>
          <li><a href="../../../doc/intro/html/index.html">The finite element method</a></li>
          <li><a href="../../../doc/the_data_structure/html/index.html">The data structure</a></li>
          <li><a href="../../../doc/quick_guide/html/index.html">Not-so-quick guide</a></li>
          <li><a href="../../../doc/optimisation/html/index.html">Optimisation</a></li>
          <li><a href="../../../doc/order_of_action_functions/html/index.html">Order of action functions</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Example codes and tutorials</li>
          <li><a href="../../../doc/example_code_list/html/index.html">List of example codes and tutorials</a></li>
          <li><a href="../../../doc/example_code_list/html/index.html#meshes">Meshing</a></li>
          <li><a href="../../../doc/example_code_list/html/index.html#solvers">Solvers</a></li>
          <li><a href="../../../doc/example_code_list/html/index.html#parallel">MPI parallel processing</a></li>
          <li><a href="../../../doc/example_code_list/html/index.html#visualisation">Post-processing/visualisation</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Other</li>
          <li><a href="../../../doc/change_log/html/index.html">Change log</a></li>
          <li><a href="../../../doc/creating_doc/html/index.html">Creating documentation</a></li>
          <li><a href="../../../doc/coding_conventions/html/index.html">Coding conventions</a></li>
          <li><a href="../../../doc/index/html/index.html">Index</a></li>
          <li><a href="../../../doc/FAQ/html/index.html">FAQ</a></li>
        </ul>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Installation<span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../doc/the_distribution/html/index.html">Installation guide</a></li>
            <li><a href="../../../doc/copyright/html/index.html">Copyright</a></li>
          </ul>
        </li>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">About <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../doc/people/html/index.html">People</a></li>            
            <li><a href="../../../doc/contact/html/index.html">Contact/Get involved</a></li>
            <li><a href="../../../doc/publications/html/index.html">Publications</a></li>
            <li><a href="../../../doc/acknowledgements/html/index.html">Acknowledgements</a></li>
            <li><a href="../../../doc/picture_show/index.html">Picture show</a></li>
          </ul>
        </li>
      </li>
    </ul>
    <ul class="nav navbar-nav navbar-right navbar-search">
      <form class="navbar-form" role="search" action="../../../doc/search_results/html/index.html">
        <div class="input-group">
          <input type="text" class="form-control" placeholder="Search" name="q">
          <span class="input-group-btn">
            <button class="btn btn-default" type="submit">Go</button>
          </span>
        </div><!-- /input-group -->
       <!--<div class="form-group">
          <input type="text" class="form-control" placeholder="Search">
        </div>
        <button type="submit" class="btn btn-default">Submit</button>-->
      </form>
    </ul>
  </div><!-- /.navbar-collapse -->
</div><!-- /.container-fluid -->
</div>
</nav>
<!-- Generated by Doxygen 1.9.1 -->
</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">The equations of time-harmonic linear elasticity and use of PMLs </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>The aim of this tutorial is to demonstrate the solution of the time-harmonic equations of linear elasticity in Cartesian coordinates. These equations are useful to describe forced, time-harmonic oscillations of elastic bodies. The implementation extends the standard formulation discussed in <a href="../../time_harmonic_linear_elasticity/elastic_annulus/html/index.html">another tutorial,</a> which is modified to incorporate perfectly matched layers (PMLs) as an alternative to classical absorbing/approximate boundary conditions or DtN maps.</p>
<p>We first present details on the relevant theory and its extensions and proceed with an example problem of time-harmonic oscillations on an infinite domain with an interior circular boundary.</p>
<center> <table border="1," width="500px">
<tr>
<td bgcolor="cornsilk"><center> <b>Acknowledgement:</b> The implementation of the equations and the documentation were developed jointly with <a href="http://imperial.academia.edu/RaduCimpeanu">Radu Cimpeanu</a> (Imperial College London), with financial support from Thales Underwater. </center>   </td></tr>
</table>
</center><hr  />
 <hr  />
<h1><a class="anchor" id="theory"></a>
Theory</h1>
<p>Consider an infinite, linearly elastic body (of density <img class="formulaInl" alt="$ \rho $" src="form_0.png" width="8" height="9"/>, Young's modulus <img class="formulaInl" alt="$ E $" src="form_1.png" width="10" height="9"/> and Poisson's ratio <img class="formulaInl" alt="$ \nu $" src="form_2.png" width="6" height="6"/>), occupying the region <img class="formulaInl" alt="$ D $" src="form_3.png" width="10" height="10"/> whose inner boundary is <img class="formulaInl" alt="$ \partial D_d $" src="form_4.png" width="23" height="13"/>. Assuming that the body performs time-harmonic oscillations of frequency of <img class="formulaInl" alt="$ \omega $" src="form_5.png" width="9" height="6"/> its motion is governed by the equations of time-harmonic linear elasticity </p><center> <p class="formulaDsp">
<img class="formulaDsp" alt="\[ {\pmb{\nabla}^*}\cdot\pmb{\tau}^*+ \rho \pmb{F}^*={\rm -\rho\omega^2}\pmb{u}^*, \]" src="form_6.png" width="138" height="15"/>
</p>
 </center><p> where the <img class="formulaInl" alt="$ x_{i}^* $" src="form_7.png" width="13" height="14"/> are the Cartesian coordinates, and the time-periodic stresses, body force and displacements are given by <img class="formulaInl" alt="$ {\rm Re}\{\pmb{\tau^*}(x_{i}^*){\rm e}^{-{\rm i}\omega t^*}\} $" src="form_8.png" width="95" height="16"/>, <img class="formulaInl" alt="$ {\rm Re}\{\mathbf{F}^*(x_{i}^*){\rm e}^{-{\rm i}\omega t^*}\} $" src="form_9.png" width="98" height="16"/> and <img class="formulaInl" alt="$ {\rm Re}\{\mathbf{u}^*(x_{i}^*){\rm e}^{-{\rm i}\omega t^*}\} $" src="form_10.png" width="96" height="16"/> respectively. Note that, as usual, the superscript asterisk notation is used to distinguish dimensional quantities from their non-dimensional counterparts where required.</p>
<p>The body is subject to imposed time-harmonic displacements <img class="formulaInl" alt="$ {\rm Re}\{\mathbf{\hat{u}}^* {\rm e}^{-{\rm i}\omega t^*}\} $" src="form_11.png" width="74" height="16"/> along <img class="formulaInl" alt="$ \partial D_d $" src="form_4.png" width="23" height="13"/>. This requires that </p><center> <p class="formulaDsp">
<img class="formulaDsp" alt="\[ \mathbf{u}^*=\mathbf{\hat{u}}^*\,\,\textrm{on $ \partial D_d. $ } \]" src="form_12.png" width="93" height="13"/>
</p>
 </center><p>The stresses and displacements are related by the constitutive equations </p><center> <p class="formulaDsp">
<img class="formulaDsp" alt="\[ \pmb{\tau}^*=\frac{E}{1+\nu}\left( \frac{\nu}{1-2\nu}(\pmb{\nabla}^*\cdot\mathbf{u}^*)\textbf{I}+ \frac{1}{2}(\pmb{\nabla}^*\mathbf{u}^*+(\pmb{\nabla}^*\mathbf{u}^*){{\rm T}})\right), \]" src="form_13.png" width="306" height="31"/>
</p>
 </center><p> where <img class="formulaInl" alt="$ (\pmb{\nabla}^*\mathbf{u}^*)^{{\rm T}} $" src="form_14.png" width="46" height="15"/> represents the transpose of <img class="formulaInl" alt="$ \pmb{\nabla}^*\mathbf{u}^*. $" src="form_15.png" width="34" height="11"/></p>
<p>We non-dimensionalise the equations, using a problem specific reference length, <img class="formulaInl" alt="$ {\cal L} $" src="form_16.png" width="10" height="10"/>, and a timescale <img class="formulaInl" alt="$ \displaystyle {\cal T}=\frac{1}{\omega} $" src="form_17.png" width="38" height="26"/>, and use Young's modulus to non-dimensionalise the body force and the stress tensor: </p><center> <p class="formulaDsp">
<img class="formulaDsp" alt="\[ \pmb{\tau}^* = E \, \pmb{\tau}, \qquad x_{i}^* = {\cal L}\, x_{i} \]" src="form_18.png" width="130" height="14"/>
</p>
 <p class="formulaDsp">
<img class="formulaDsp" alt="\[ \mathbf{u}^* = {\cal L}\, \mathbf{u}, \qquad \mathbf{F}^* = \frac{E}{\rho \cal L} \, \mathbf{F}, \qquad t^* = {\cal T}\, t. \]" src="form_19.png" width="216" height="30"/>
</p>
 </center><p>The non-dimensional form of the equations is then given by </p><center> <p class="formulaDsp">
<img class="formulaDsp" alt="\[ \pmb{\nabla}\cdot\pmb{\tau}+\mathbf{F}=-\Omega^2\mathbf{u}, \ \ \ \ \ \ \ \ \ \ (1) \]" src="form_20.png" width="163" height="16"/>
</p>
 </center><p> with the non-dimensional constitutive relation, </p><center> <p class="formulaDsp">
<img class="formulaDsp" alt="\[ \pmb{\tau}=\frac{1}{1+\nu}\left( \frac{\nu}{1-2\nu}(\pmb{\nabla}\cdot\mathbf{u})\textbf{I}+ \frac{1}{2}(\pmb{\nabla}\mathbf{u}+(\pmb{\nabla}\mathbf{u})^{{\rm T}})\right). \ \ \ \ \ \ \ \ \ \ (2) \]" src="form_21.png" width="323" height="31"/>
</p>
 </center><p> The non-dimensional parameter </p><center> <p class="formulaDsp">
<img class="formulaDsp" alt="\[ \Omega = {\cal L}\omega \sqrt{\frac{\rho}{E}} \]" src="form_22.png" width="69" height="31"/>
</p>
 </center><p> is the ratio of the elastic body's intrinsic timescale, <img class="formulaInl" alt="$\displaystyle {\cal L} \sqrt{\frac{\rho}{E}}$" src="form_23.png" width="35" height="31"/>, to the problem-specific timescale, <img class="formulaInl" alt="$ \displaystyle {\cal T}=\frac{1}{\omega} $" src="form_17.png" width="38" height="26"/>, that we used to non-dimensionalise time. <img class="formulaInl" alt="$ \Omega $" src="form_24.png" width="9" height="10"/> can be interpreted as a non-dimensional version of the excitation frequency; alternatively/equivalently <img class="formulaInl" alt="$ \Omega^2 $" src="form_25.png" width="14" height="11"/> may be interpreted as a non-dimensional density. The boundary conditions are set as </p><center> <p class="formulaDsp">
<img class="formulaDsp" alt="\[ \mathbf{u}=\mathbf{\hat{u}}\,\,\textrm{on $ \partial D_d $. } \]" src="form_26.png" width="80" height="13"/>
</p>
 </center><hr  />
 <hr  />
<h1><a class="anchor" id="pml"></a>
Perfectly matched layers</h1>
<p>The idea behind perfectly matched layers is illustrated in the figure below. The actual physical/mathematical problem has to be solved in the infinite domain <img class="formulaInl" alt="$ D $" src="form_3.png" width="10" height="10"/> (shown on the left), with a boundary condition at a certain distance from the source of the waves ensuring the suitable decay of the solution at large distances from the region of interest.</p>
<p>If computations are performed in a finite computational domain, <img class="formulaInl" alt="$ D_c $" src="form_27.png" width="15" height="13"/> , (shown in the middle), spurious wave reflections are likely to be generated at the artificial boundary <img class="formulaInl" alt="$ \partial D_c $" src="form_28.png" width="23" height="13"/> of the computational domain.</p>
<p>The idea behind PML methods is to surround the actual computational domain <img class="formulaInl" alt="$ D_c $" src="form_27.png" width="15" height="13"/> with a layer of "absorbing" material whose properties are chosen such that the outgoing waves are absorbed within it, without creating any artificial reflected waves at the interface between the PML layer and the computational domain.</p>
<div class="image">
<img src="pml.gif" alt=""/>
<div class="caption">
Sketch illustrating the idea behind perfectly matched layers. </div></div>
 <p>Our implementation of the perfectly matched layers follows the development in <a href="http://www.sciencedirect.com/science/article/pii/S0021999106004487">A. Bermudez, L. Hervella-Nieto, A. Prieto, and R. Rodriguez "An optimal perfectly matched layer with unbounded 
absorbing function for time-harmonic acoustic scattering problems" Journal of Computational Physics <b>223</b> 469-488 (2007)</a> and we assume the boundaries of the computational domain to be aligned with the coordinate axes, as shown in the sketch above.</p>
<p>The method requires a slight generalisation of the equations, achieved by introducing the complex coordinate mapping </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \frac{\partial}{\partial x_j} \to \frac{1}{\gamma_j} \frac{\partial}{\partial x_j} \ \ \ \ \ \ \ \ \ \ \ \ (3) \]" src="form_29.png" width="144" height="31"/>
</p>
<p> within the perfectly matched layers.</p>
<p>The choice of <img class="formulaInl" alt="$ \gamma_j $" src="form_30.png" width="11" height="10"/> depends on the orientation of the PML layer. Since we are restricting ourselves to axis-aligned mesh boundaries we need to distinguish three different cases, as shown in the sketch below:</p>
<div class="image">
<img src="PMLDomain.gif" alt=""/>
<div class="caption">
Sketch illustrating the geometry of the perfectly matched layers. </div></div>
 <p>We follow the work of <a href="http://www.sciencedirect.com/science/article/pii/S0045782502006424">U. Basu and A. Chopra "Perfectly matched layers for time-harmonic elastodynamics of unbounded domains: theory and finite-element implementation", Computer Methods in Applied Mechanics and Engineering <b>192</b> 1337-1375(2003)</a> and choose:</p><ul>
<li>For layers that are aligned with the y axis (such as the left and right PML layers in the sketch, with vertical stripes) we set <p class="formulaDsp">
<img class="formulaDsp" alt="\[ \gamma_{x}(x) = 1 +i\frac{f_0}{a_0}\ \sigma_{x}(x) \ \ \ \ \ \ \ \mbox{ \ \ \ with \ \ \ } \sigma_{x}(x) = \frac{1}{|X_{PML_{out}}-x|}-\frac{1}{|X_{PML_{out}}-X_{PML_{in}}|}, \ \ \ \ \ (4) \]" src="form_31.png" width="485" height="30"/>
</p>
 where <img class="formulaInl" alt="$ a_0 = \sqrt{2.0(1.0+\nu)}\Omega$" src="form_32.png" width="114" height="16"/>, <img class="formulaInl" alt="$ f_0 $" src="form_33.png" width="11" height="13"/> is a constant to be tuned, <img class="formulaInl" alt="$ X_{PML_{in}} $" src="form_34.png" width="45" height="14"/> is the x-coordinate of the inner boundary of the PML layer (the coordinate of the interface with the physical domain), <img class="formulaInl" alt="$ X_{PML_{out}} $" src="form_35.png" width="49" height="14"/> is the x-coordinate of the outer boundary of the PML layer , and <p class="formulaDsp">
<img class="formulaDsp" alt="\[ \gamma_y = 1. \]" src="form_36.png" width="39" height="13"/>
</p>
</li>
<li>For layers that are aligned with the x axis (such as the top and bottom PML layers in the sketch, with horizontal stripes) we set <p class="formulaDsp">
<img class="formulaDsp" alt="\[ \gamma_x = 1, \]" src="form_37.png" width="39" height="11"/>
</p>
 and <p class="formulaDsp">
<img class="formulaDsp" alt="\[ \gamma_{y}(y) = 1+i\frac{f_0}{a_0} \ \sigma_{y}(y) \ \ \ \ \ \ \ \mbox{ \ \ \ with \ \ \ } \sigma_{y}(y) = \frac{1}{|Y_{PML_{out}}-y|}-\frac{1}{|Y_{PML_{out}}-Y_{PML_{in}}|}, \ \ \ \ \ (5) \]" src="form_38.png" width="473" height="30"/>
</p>
 where <img class="formulaInl" alt="$ Y_{PML} $" src="form_39.png" width="33" height="13"/> is the y-coordinate of the outer boundary of the PML layer.</li>
<li>In corner regions (diagonally striped) that are bounded by two axis-aligned PML layers (with outer coordinates <img class="formulaInl" alt="$ X_{PML} $" src="form_40.png" width="36" height="13"/> and <br  />
 <img class="formulaInl" alt="$ Y_{PML} $" src="form_39.png" width="33" height="13"/>) we set <p class="formulaDsp">
<img class="formulaDsp" alt="\[ \gamma_{x}(x) = 1 +i\frac{f_0}{a_0}\ \sigma_{x}(x) \ \ \ \ \ \ \ \mbox{ \ \ \ with \ \ \ } \sigma_{x}(x) = \frac{1}{|X_{PML_{out}}-x|}-\frac{1}{|X_{PML_{out}}-X_{PML_{in}}|} \ \ \ \ \ (6) \]" src="form_41.png" width="480" height="30"/>
</p>
 and <p class="formulaDsp">
<img class="formulaDsp" alt="\[ \gamma_{y}(y) = 1+i\frac{f_0}{a_0} \ \sigma_{y}(y) \ \ \ \ \ \ \ \mbox{ \ \ \ with \ \ \ } \sigma_{y}(y) = \frac{1}{|Y_{PML_{out}}-y|}-\frac{1}{|Y_{PML_{out}}-Y_{PML_{in}}|}. \ \ \ \ \ (7) \]" src="form_42.png" width="471" height="30"/>
</p>
</li>
<li>Finally, in the actual computational domain (outside the PML layers) we set <p class="formulaDsp">
<img class="formulaDsp" alt="\[ \gamma_{x}(x) = \gamma_{y}(y) = 1. \]" src="form_43.png" width="101" height="14"/>
</p>
</li>
</ul>
<p>In our numerical experiments <img class="formulaInl" alt="$ f_0 = 20.0 $" src="form_44.png" width="50" height="13"/> was found to be an appropriate value, which gives acceptable numerical behaviour. This is well aligned with the cited paper, where this parameter ranges from roughly <img class="formulaInl" alt="$ 10.0 $" src="form_45.png" width="23" height="9"/> to <img class="formulaInl" alt="$ 50.0 $" src="form_46.png" width="23" height="9"/>.</p>
<hr  />
<h2><a class="anchor" id="impl"></a>
Implementation of the perfectly matched layers within oomph-lib</h2>
<p>The finite-element-discretised equations (modified by the PML terms discussed above) are implemented in the <code>PMLTimeHarmonicLinearElasticityEquations&lt;DIM&gt;</code> class which is templated by the spatial dimension, <code>DIM</code>. As usual, we provide fully functional elements by combining these with geometric finite elements (from the Q and T families &ndash; corresponding (in 2D) to triangles and quad elements). By default, the PML modifications are disabled, i.e. <img class="formulaInl" alt="$ \gamma_{x}(x) $" src="form_47.png" width="30" height="14"/> and <img class="formulaInl" alt="$ \gamma_{y}(y) $" src="form_48.png" width="29" height="14"/> are both set to 1.</p>
<p>The generation of suitable 2D PML meshes along the axis-aligned boundaries of a given bulk mesh is facilitated by helper functions which automatically erect layers of (quadrilateral) PML elements. The layers are built from <code>QPMLTimeHarmonicLinearElasticityElement&lt;2,NNODE_1D&gt;</code> elements and the parameter <code>NNODE_1D</code> is automatically chosen to match that of the elements in the bulk mesh. The bulk mesh can contain quads or triangles (as shown in the specific example presented below).</p>
<p>For instance, to erect a PML layer (of width <code>width</code>, with <code>n_pml</code> elements across the width of the layer) on the "right" boundary (with boundary ID <code>b_bulk</code>) of the bulk mesh pointed to by <code>bulk_mesh_pt</code>, a call to </p><div class="fragment"><div class="line">TwoDimensionalPMLHelper::create_right_pml_mesh</div>
<div class="line">&lt;PMLLayerElement&lt;ELASTICITY_ELEMENT&gt; &gt;</div>
<div class="line">(Solid_mesh_pt, right_boundary_id, </div>
<div class="line">Global_Parameters::n_x_right_pml, </div>
<div class="line">Global_Parameters::width_x_right_pml);</div>
</div><!-- fragment --><p> returns a pointer to a newly-created mesh that contains the PML elements which are automatically attached to the boundary of the bulk mesh (i.e. the <code>Nodes</code> on the outer boundary of the bulk mesh are shared (pointed to), rather than duplicated, by the elements in the PML mesh). The PML-ness of the elements is automatically enabled, i.e. the functions <img class="formulaInl" alt="$ \gamma_x(x) $" src="form_49.png" width="30" height="14"/> and <img class="formulaInl" alt="$ \gamma_y(y) $" src="form_50.png" width="29" height="14"/> are set as described above. Finally, zero Dirichlet boundary conditions are applied to the real and imaginary parts of the solution on the outer boundary of the PML layer.</p>
<p>Similar helper functions exist for PML layers on other axis-aligned boundaries, and for corner PML meshes; see the code listings provided below. Currently, we only provide this functionality for convex 2D computational domains, but the generalisation to non-convex boundaries and 3D is straightforward (if tedious) to implement (Any volunteers?).</p>
<hr  />
 <hr  />
<h1><a class="anchor" id="element_types"></a>
Implementation</h1>
<p>Within <code>oomph-lib</code>, the non-dimensional version of equations (1) with the constitutive equations (2) are implemented in the <code>PMLTimeHarmonicLinearElasticityEquations&lt;DIM&gt;</code> equations class, where the template parameter <code>DIM</code> indicates the spatial dimension. Following our usual approach, discussed in the <a href="../../../doc/quick_guide/html/index.html">(Not-So-)Quick Guide,</a> this equation class is then combined with a geometric finite element to form a fully-functional finite element. For instance, the combination of the <code>PMLTimeHarmonicLinearElasticityEquations&lt;2&gt;</code> class with the geometric finite element <code>QElement&lt;2,3&gt;</code> yields a nine-node quadrilateral element. As usual, the mapping between local and global (Eulerian) coordinates within an element is given by, </p><center> <p class="formulaDsp">
<img class="formulaDsp" alt="\[ x_i = \sum_{j=1}^{N^{(E)}} X^{(E)}_{ij} \, \psi_j, \qquad i=1,2, \]" src="form_51.png" width="169" height="43"/>
</p>
 </center><p> where <img class="formulaInl" alt="$ N^{(E)} $" src="form_52.png" width="26" height="13"/> is the number of nodes in the element, <img class="formulaInl" alt="$ X^{(E)}_{ij} $" src="form_53.png" width="28" height="20"/> is the <img class="formulaInl" alt="$ i $" src="form_54.png" width="5" height="9"/>-th global (Eulerian) coordinate of the <img class="formulaInl" alt="$ j $" src="form_55.png" width="6" height="11"/>-th <code>Node</code> in the element, and the <img class="formulaInl" alt="$ \psi_j $" src="form_56.png" width="14" height="14"/> are the element's shape functions, defined in the geometric finite element.</p>
<p>All the constitutive parameters are real. The two components of the displacement field have a real and imaginary part. We store the four real-valued nodal unknowns in the order <img class="formulaInl" alt="$ {\rm Re}\{u_x\}, {\rm Re}\{u_y\}, {\rm Im}\{u_x\}, {\rm Im}\{u_y\} $" src="form_57.png" width="179" height="14"/> and use the shape functions to interpolate the displacements as </p><center> <p class="formulaDsp">
<img class="formulaDsp" alt="\[ u_i^{(n)} = \sum_{j=1}^{N^{(E)}} U^{(E)}_{ij} \, \psi_j, \qquad i=1,...4, \]" src="form_58.png" width="189" height="43"/>
</p>
 </center><p> where <img class="formulaInl" alt="$ U^{(E)}_{ij} $" src="form_59.png" width="25" height="20"/> is the <img class="formulaInl" alt="$ i $" src="form_54.png" width="5" height="9"/>-th displacement component (enumerated as described above) at the <img class="formulaInl" alt="$ j $" src="form_55.png" width="6" height="11"/>-th <code>Node</code> in the element.</p>
<hr  />
 <hr  />
<h1><a class="anchor" id="test"></a>
A specific example: outward propagation of elastic waves from the surface of a cylindrical object</h1>
<p>We consider the time-harmonic deformation of a 2D elastic body that occupies the region outside a circle whose diameter we use as the lengthscale <img class="formulaInl" alt="$ \cal L $" src="form_60.png" width="10" height="10"/>. We impose a displacement <img class="formulaInl" alt="$ {\mathbf{u}}(r,\theta)= u_0 {\mathbf{e}}_r + u_1 {\mathbf{e}}_{\theta} $" src="form_61.png" width="115" height="14"/> on the inner boundary (to generate a combination of pressure waves and shear waves) and allow for a formulation with perfectly matched layers on the outer boundary of the computational domain, which should allow for a smooth propagation of the elastic waves with no interference from the restriction of the problem to a finite computational domain. <img class="formulaInl" alt="$ {\mathbf{e}}_r $" src="form_62.png" width="13" height="9"/> is the unit vector in the radial direction, whereas <img class="formulaInl" alt="$ {\mathbf{e}}_{\theta} $" src="form_63.png" width="13" height="9"/> is the unit vector in azimuthal direction.</p>
<p>It is easy to find an analytical solution of this problem by working in polar coordinates and exploiting the axisymmetry of the solution by writing the displacements as <img class="formulaInl" alt="$ \displaystyle {\mathbf{u}} = U(r) {\mathbf{e}}_r $" src="form_64.png" width="61" height="14"/> or <img class="formulaInl" alt="$ \displaystyle {\mathbf{u}} = U(r) {\mathbf{e}}_{\theta} $" src="form_65.png" width="61" height="14"/>. The displacement <img class="formulaInl" alt="$ U(r) $" src="form_66.png" width="24" height="14"/> is then governed in both cases by an equation of type </p><center> <p class="formulaDsp">
<img class="formulaDsp" alt="\[ \frac{d}{d r}\left(\frac{U}{r}+\frac{dU}{dr}\right) + k^2 U=0, \]" src="form_67.png" width="145" height="31"/>
</p>
 </center><p> where <img class="formulaInl" alt="$ \displaystyle k^2 = k_{r}^2= \frac{\Omega^2}{\lambda+2\mu}$" src="form_68.png" width="96" height="31"/> for the radial component and <img class="formulaInl" alt="$ \displaystyle k^2 = k_{\theta}^2= \frac{\Omega^2}{\mu}$" src="form_69.png" width="75" height="31"/> for the azimuthal component. We also note that </p><center> <p class="formulaDsp">
<img class="formulaDsp" alt="\[ \lambda = \frac{\nu}{(1+\nu)(1-2\nu)} \qquad \textrm{and} \qquad \mu = \frac{1}{2(1+\nu)} \]" src="form_70.png" width="250" height="30"/>
</p>
 </center><p> are the non-dimensional Lame parameters. The solution of these equations is given in each case by: </p><center> <p class="formulaDsp">
<img class="formulaDsp" alt="\[ U(r) = H_1(kr). \]" src="form_71.png" width="84" height="14"/>
</p>
 </center><p> where <img class="formulaInl" alt="$ H_1 $" src="form_72.png" width="15" height="13"/> is the Hankel function of first kind. The two solutions can then be converted to Cartesian coordinates and added together in an appropriate manner. The details of the procedure can be found in the <code> <a class="el" href="namespaceGlobal__Parameters.html#a97162dba4bd29a15067b9c9bbe53c754" title="Exact solution as a Vector: {u_x_real, u_y_real, u_x_imag, u_y_imag}.">GlobalParameters::exact_u()</a> </code> function.</p>
<p>We note that even though a relatively simple analytical solution (in polar coordinates!) exists for this problem, it is a non-trivial test case for our code which solves the governing equations in Cartesian coordinates. It is also a highly relevant test case in the context of testing perfectly matched layers, since the solution contains both shear and compression waves.</p>
<hr  />
 <hr  />
 <h1><a class="anchor" id="results"></a>
Results</h1>
<p>The discretised geometry is shown below. We choose a circle of radius <img class="formulaInl" alt="$ r=0.5$" src="form_73.png" width="40" height="9"/> in a computational domain otherwise set to <img class="formulaInl" alt="$ -2 \le x \le 2, -2 \le y \le 2 $" src="form_74.png" width="130" height="11"/>, with a PML thickness of <img class="formulaInl" alt="$ 1.6 $" src="form_75.png" width="16" height="9"/> in each dimension, spanned by <img class="formulaInl" alt="$ 16 $" src="form_76.png" width="13" height="9"/> elements.</p>
<div class="image">
<img src="mesh.gif" alt=""/>
<div class="caption">
Mesh used to resolve the geometry. </div></div>
 <p>The figures below show "carpet plots" (on the left) of the real and imaginary parts of the exact (green) and computed (blue) horizontal displacement for <img class="formulaInl" alt="$ \Omega^2=30.0 $" src="form_77.png" width="54" height="11"/> and <img class="formulaInl" alt="$ \nu=0.3 $" src="form_78.png" width="39" height="9"/>. Comparing the two solutions shows good agreement and hence an efficient damping given by the perfectly matched layers. We can also observe this by taking a one-dimensional slice from point <img class="formulaInl" alt="$ (-2.0,0.0)$" src="form_79.png" width="56" height="14"/> to point <img class="formulaInl" alt="$ (2.0,0.0)$" src="form_80.png" width="46" height="14"/> and visualising the profiles of the exact and computed solutions, shown on the right. The green line represents the profile of the exact solution, whereas the blue dots are extracted from the profile of the computed solution.</p>
<div class="image">
<img src="result1.gif" alt=""/>
<div class="caption">
Real part of the horizontal displacement. Exact and computed solution carpet plot (left) and (-2.0,0.0) to (2.0,0.0) one-dimensional slice (right). Green: exact; dark blue: computed; light blue: perfectly matched layers. </div></div>
 <div class="image">
<img src="result2.gif" alt=""/>
<div class="caption">
Imaginary part of the horizontal displacement. Exact and computed solution carpet plot (left) and (-2.0,0.0) to (2.0,0.0) one-dimensional slice (right). Green: exact; dark blue: computed; light blue: perfectly matched layers. </div></div>
 <p>To demonstrate that the resulting displacement field is indeed axisymmetric, we present plots of the real and imaginary parts of the radial displacement, <img class="formulaInl" alt="$ (Re(u_1)^2 + Re(u_2)^2)^{1/2} $" src="form_81.png" width="126" height="16"/> and <img class="formulaInl" alt="$ (Im(u_1)^2 + Im(u_2)^2)^{1/2} $" src="form_82.png" width="130" height="16"/>.</p>
<div class="image">
<img src="result3.gif" alt=""/>
<div class="caption">
Real part of the computed radial displacement. </div></div>
 <div class="image">
<img src="result4.gif" alt=""/>
<div class="caption">
Imaginary part of the computed radial displacement. </div></div>
 <hr  />
 <hr  />
<h1><a class="anchor" id="namespace"></a>
Global parameters and functions</h1>
<p>As usual, we define all non-dimensional parameters in a namespace where we also define the exact solution which is imposed at the inner boundary. We omit the (lengthy) listing of the exact solution.</p>
 <div class="fragment"><div class="line"><span class="comment">//=======start_namespace==========================================</span></div>
<div class="line"><span class="comment">/// Global variables</span></div>
<div class="line"><span class="comment"></span><span class="comment">//================================================================</span></div>
<div class="line"><span class="keyword">namespace </span><a class="code" href="namespaceGlobal__Parameters.html">Global_Parameters</a></div>
<div class="line">{<span class="comment"></span></div>
<div class="line"><span class="comment"> /// helper to set target mesh element size</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="namespaceGlobal__Parameters.html#af365b0769e142cabdaed848057332858">Element_area</a> = 0.01; </div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// helpers to time the code</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="namespaceGlobal__Parameters.html#a6106a50c4a420f4040e2ccd7d443267c">T_start</a> = 0.0;</div>
<div class="line"> <span class="keywordtype">double</span> <a class="code" href="namespaceGlobal__Parameters.html#a42ef00f24f3bc5c16dae72557c736634">T_end</a> = 0.0;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// PML width in elements for the right layer</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">unsigned</span> <a class="code" href="namespaceGlobal__Parameters.html#a9af8f57814ac363b52f2a88d75864524">N_pml_multiplier</a> = 1;</div>
<div class="line"> <span class="keywordtype">double</span> <a class="code" href="namespaceGlobal__Parameters.html#a7a49a7bc4052082ccf10caf8ff7a52b6">L_pml_multiplier</a> = 1.0;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// PML width in elements for the right layer</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">unsigned</span> <a class="code" href="namespaceGlobal__Parameters.html#a401ab27b40efe725bc047909ae65b4b1">N_x_right_pml</a> = 8;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// PML width in elements for the top layer</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">unsigned</span> <a class="code" href="namespaceGlobal__Parameters.html#ade86fec7e40fc9a5330e6213482f09d6">N_y_top_pml</a> = 8;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// PML width in elements for the left layer</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">unsigned</span> <a class="code" href="namespaceGlobal__Parameters.html#accf11b5794502b15efd0aa37347f6994">N_x_left_pml</a> = 8; </div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// PML width in elements for the left layer</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">unsigned</span> <a class="code" href="namespaceGlobal__Parameters.html#a79bff9b8e3435255541b71c0e3cc30a1">N_y_bottom_pml</a> = 8; </div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Outer physical length of the PML layers</span></div>
<div class="line"> <span class="comment">// defaults to 0.2, so 10% of the size of the </span></div>
<div class="line"> <span class="comment">// physical domain</span></div>
<div class="line"> <span class="keywordtype">double</span> <a class="code" href="namespaceGlobal__Parameters.html#a140b1b8aaef0bf2b94acf75d681d4545">Width_x_right_pml</a>  = 2.0;</div>
<div class="line"> <span class="keywordtype">double</span> <a class="code" href="namespaceGlobal__Parameters.html#a175759402c54bb216b0599c6a031abea">Width_y_top_pml</a>    = 2.0;</div>
<div class="line"> <span class="keywordtype">double</span> <a class="code" href="namespaceGlobal__Parameters.html#a28925335dcc7b2bed01d744a543be9aa">Width_x_left_pml</a>   = 2.0;</div>
<div class="line"> <span class="keywordtype">double</span> <a class="code" href="namespaceGlobal__Parameters.html#a67848e80f63ec793108a4710a28cc3a9">Width_y_bottom_pml</a> = 2.0;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Function to compute dependent parameters</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="namespaceGlobal__Parameters.html#aafb6ae2e2642a42a7c8ce999837d18b1">compute_dependent_parameters</a>()</div>
<div class="line"> {<span class="comment"></span></div>
<div class="line"><span class="comment">  /// Adjust number of PML elements, set to be equal for all layers</span></div>
<div class="line"><span class="comment"></span>  <a class="code" href="namespaceGlobal__Parameters.html#a401ab27b40efe725bc047909ae65b4b1">N_x_right_pml</a>  = <a class="code" href="namespaceGlobal__Parameters.html#a401ab27b40efe725bc047909ae65b4b1">N_x_right_pml</a>  * <a class="code" href="namespaceGlobal__Parameters.html#a9af8f57814ac363b52f2a88d75864524">N_pml_multiplier</a>;</div>
<div class="line">  <a class="code" href="namespaceGlobal__Parameters.html#accf11b5794502b15efd0aa37347f6994">N_x_left_pml</a>   = <a class="code" href="namespaceGlobal__Parameters.html#accf11b5794502b15efd0aa37347f6994">N_x_left_pml</a>   * <a class="code" href="namespaceGlobal__Parameters.html#a9af8f57814ac363b52f2a88d75864524">N_pml_multiplier</a>;</div>
<div class="line">  <a class="code" href="namespaceGlobal__Parameters.html#ade86fec7e40fc9a5330e6213482f09d6">N_y_top_pml</a>    = <a class="code" href="namespaceGlobal__Parameters.html#ade86fec7e40fc9a5330e6213482f09d6">N_y_top_pml</a>    * <a class="code" href="namespaceGlobal__Parameters.html#a9af8f57814ac363b52f2a88d75864524">N_pml_multiplier</a>;</div>
<div class="line">  <a class="code" href="namespaceGlobal__Parameters.html#a79bff9b8e3435255541b71c0e3cc30a1">N_y_bottom_pml</a> = <a class="code" href="namespaceGlobal__Parameters.html#a79bff9b8e3435255541b71c0e3cc30a1">N_y_bottom_pml</a> * <a class="code" href="namespaceGlobal__Parameters.html#a9af8f57814ac363b52f2a88d75864524">N_pml_multiplier</a>;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">  /// Adjust physical size of PML layers, set to be equal for all layers</span></div>
<div class="line"><span class="comment"></span>  <a class="code" href="namespaceGlobal__Parameters.html#a140b1b8aaef0bf2b94acf75d681d4545">Width_x_right_pml</a>  = <a class="code" href="namespaceGlobal__Parameters.html#a140b1b8aaef0bf2b94acf75d681d4545">Width_x_right_pml</a>  * <a class="code" href="namespaceGlobal__Parameters.html#a7a49a7bc4052082ccf10caf8ff7a52b6">L_pml_multiplier</a>;</div>
<div class="line">  <a class="code" href="namespaceGlobal__Parameters.html#a28925335dcc7b2bed01d744a543be9aa">Width_x_left_pml</a>   = <a class="code" href="namespaceGlobal__Parameters.html#a28925335dcc7b2bed01d744a543be9aa">Width_x_left_pml</a>   * <a class="code" href="namespaceGlobal__Parameters.html#a7a49a7bc4052082ccf10caf8ff7a52b6">L_pml_multiplier</a>;</div>
<div class="line">  <a class="code" href="namespaceGlobal__Parameters.html#a175759402c54bb216b0599c6a031abea">Width_y_top_pml</a>    = <a class="code" href="namespaceGlobal__Parameters.html#a175759402c54bb216b0599c6a031abea">Width_y_top_pml</a>    * <a class="code" href="namespaceGlobal__Parameters.html#a7a49a7bc4052082ccf10caf8ff7a52b6">L_pml_multiplier</a>;</div>
<div class="line">  <a class="code" href="namespaceGlobal__Parameters.html#a67848e80f63ec793108a4710a28cc3a9">Width_y_bottom_pml</a> = <a class="code" href="namespaceGlobal__Parameters.html#a67848e80f63ec793108a4710a28cc3a9">Width_y_bottom_pml</a> * <a class="code" href="namespaceGlobal__Parameters.html#a7a49a7bc4052082ccf10caf8ff7a52b6">L_pml_multiplier</a>;</div>
<div class="line"> }</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Poisson&#39;s ratio</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="namespaceGlobal__Parameters.html#a20fccdcfa2c15ad8b951b9ada3bb1661">Nu</a>=0.3;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Square of non-dim frequency </span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="namespaceGlobal__Parameters.html#af9e1e178dfb7f5e35b452599bd4c4324">Omega_sq</a>=30.0; </div>
<div class="line">  <span class="comment"></span></div>
<div class="line"><span class="comment"> /// The elasticity tensor</span></div>
<div class="line"><span class="comment"></span> PMLTimeHarmonicIsotropicElasticityTensor* <a class="code" href="namespaceGlobal__Parameters.html#a9dc0631434879b47501f64851ad679b8">E_pt</a>;</div>
<div class="line"> <span class="comment"></span></div>
<div class="line"><span class="comment"> /// Thickness of annulus</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="namespaceGlobal__Parameters.html#a0b73c5ead1114ae88bbd4cb0eb54f078">H_annulus</a>=0.5;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Output directory</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">string</span> <a class="code" href="namespaceGlobal__Parameters.html#a301ab922df72030c660b21328d6caf76">Directory</a>=<span class="stringliteral">&quot;RESLT&quot;</span>;</div>
<div class="ttc" id="anamespaceGlobal__Parameters_html"><div class="ttname"><a href="namespaceGlobal__Parameters.html">Global_Parameters</a></div><div class="ttdoc">/////////////////////////////////////////////////////////////////// /////////////////////////////////...</div><div class="ttdef"><b>Definition:</b> <a href="time__harmonic__elasticity__driver_8cc_source.html#l00055">time_harmonic_elasticity_driver.cc:56</a></div></div>
<div class="ttc" id="anamespaceGlobal__Parameters_html_a0b73c5ead1114ae88bbd4cb0eb54f078"><div class="ttname"><a href="namespaceGlobal__Parameters.html#a0b73c5ead1114ae88bbd4cb0eb54f078">Global_Parameters::H_annulus</a></div><div class="ttdeci">double H_annulus</div><div class="ttdoc">Thickness of annulus.</div><div class="ttdef"><b>Definition:</b> <a href="time__harmonic__elasticity__driver_8cc_source.html#l00114">time_harmonic_elasticity_driver.cc:114</a></div></div>
<div class="ttc" id="anamespaceGlobal__Parameters_html_a140b1b8aaef0bf2b94acf75d681d4545"><div class="ttname"><a href="namespaceGlobal__Parameters.html#a140b1b8aaef0bf2b94acf75d681d4545">Global_Parameters::Width_x_right_pml</a></div><div class="ttdeci">double Width_x_right_pml</div><div class="ttdef"><b>Definition:</b> <a href="time__harmonic__elasticity__driver_8cc_source.html#l00083">time_harmonic_elasticity_driver.cc:83</a></div></div>
<div class="ttc" id="anamespaceGlobal__Parameters_html_a175759402c54bb216b0599c6a031abea"><div class="ttname"><a href="namespaceGlobal__Parameters.html#a175759402c54bb216b0599c6a031abea">Global_Parameters::Width_y_top_pml</a></div><div class="ttdeci">double Width_y_top_pml</div><div class="ttdef"><b>Definition:</b> <a href="time__harmonic__elasticity__driver_8cc_source.html#l00084">time_harmonic_elasticity_driver.cc:84</a></div></div>
<div class="ttc" id="anamespaceGlobal__Parameters_html_a20fccdcfa2c15ad8b951b9ada3bb1661"><div class="ttname"><a href="namespaceGlobal__Parameters.html#a20fccdcfa2c15ad8b951b9ada3bb1661">Global_Parameters::Nu</a></div><div class="ttdeci">double Nu</div><div class="ttdoc">Poisson's ratio.</div><div class="ttdef"><b>Definition:</b> <a href="time__harmonic__elasticity__driver_8cc_source.html#l00105">time_harmonic_elasticity_driver.cc:105</a></div></div>
<div class="ttc" id="anamespaceGlobal__Parameters_html_a28925335dcc7b2bed01d744a543be9aa"><div class="ttname"><a href="namespaceGlobal__Parameters.html#a28925335dcc7b2bed01d744a543be9aa">Global_Parameters::Width_x_left_pml</a></div><div class="ttdeci">double Width_x_left_pml</div><div class="ttdef"><b>Definition:</b> <a href="time__harmonic__elasticity__driver_8cc_source.html#l00085">time_harmonic_elasticity_driver.cc:85</a></div></div>
<div class="ttc" id="anamespaceGlobal__Parameters_html_a301ab922df72030c660b21328d6caf76"><div class="ttname"><a href="namespaceGlobal__Parameters.html#a301ab922df72030c660b21328d6caf76">Global_Parameters::Directory</a></div><div class="ttdeci">string Directory</div><div class="ttdoc">Output directory.</div><div class="ttdef"><b>Definition:</b> <a href="time__harmonic__elasticity__driver_8cc_source.html#l00117">time_harmonic_elasticity_driver.cc:117</a></div></div>
<div class="ttc" id="anamespaceGlobal__Parameters_html_a401ab27b40efe725bc047909ae65b4b1"><div class="ttname"><a href="namespaceGlobal__Parameters.html#a401ab27b40efe725bc047909ae65b4b1">Global_Parameters::N_x_right_pml</a></div><div class="ttdeci">unsigned N_x_right_pml</div><div class="ttdoc">PML width in elements for the right layer.</div><div class="ttdef"><b>Definition:</b> <a href="time__harmonic__elasticity__driver_8cc_source.html#l00069">time_harmonic_elasticity_driver.cc:69</a></div></div>
<div class="ttc" id="anamespaceGlobal__Parameters_html_a42ef00f24f3bc5c16dae72557c736634"><div class="ttname"><a href="namespaceGlobal__Parameters.html#a42ef00f24f3bc5c16dae72557c736634">Global_Parameters::T_end</a></div><div class="ttdeci">double T_end</div><div class="ttdef"><b>Definition:</b> <a href="time__harmonic__elasticity__driver_8cc_source.html#l00062">time_harmonic_elasticity_driver.cc:62</a></div></div>
<div class="ttc" id="anamespaceGlobal__Parameters_html_a6106a50c4a420f4040e2ccd7d443267c"><div class="ttname"><a href="namespaceGlobal__Parameters.html#a6106a50c4a420f4040e2ccd7d443267c">Global_Parameters::T_start</a></div><div class="ttdeci">double T_start</div><div class="ttdoc">helpers to time the code</div><div class="ttdef"><b>Definition:</b> <a href="time__harmonic__elasticity__driver_8cc_source.html#l00061">time_harmonic_elasticity_driver.cc:61</a></div></div>
<div class="ttc" id="anamespaceGlobal__Parameters_html_a67848e80f63ec793108a4710a28cc3a9"><div class="ttname"><a href="namespaceGlobal__Parameters.html#a67848e80f63ec793108a4710a28cc3a9">Global_Parameters::Width_y_bottom_pml</a></div><div class="ttdeci">double Width_y_bottom_pml</div><div class="ttdef"><b>Definition:</b> <a href="time__harmonic__elasticity__driver_8cc_source.html#l00086">time_harmonic_elasticity_driver.cc:86</a></div></div>
<div class="ttc" id="anamespaceGlobal__Parameters_html_a79bff9b8e3435255541b71c0e3cc30a1"><div class="ttname"><a href="namespaceGlobal__Parameters.html#a79bff9b8e3435255541b71c0e3cc30a1">Global_Parameters::N_y_bottom_pml</a></div><div class="ttdeci">unsigned N_y_bottom_pml</div><div class="ttdoc">PML width in elements for the left layer.</div><div class="ttdef"><b>Definition:</b> <a href="time__harmonic__elasticity__driver_8cc_source.html#l00078">time_harmonic_elasticity_driver.cc:78</a></div></div>
<div class="ttc" id="anamespaceGlobal__Parameters_html_a7a49a7bc4052082ccf10caf8ff7a52b6"><div class="ttname"><a href="namespaceGlobal__Parameters.html#a7a49a7bc4052082ccf10caf8ff7a52b6">Global_Parameters::L_pml_multiplier</a></div><div class="ttdeci">double L_pml_multiplier</div><div class="ttdef"><b>Definition:</b> <a href="time__harmonic__elasticity__driver_8cc_source.html#l00066">time_harmonic_elasticity_driver.cc:66</a></div></div>
<div class="ttc" id="anamespaceGlobal__Parameters_html_a9af8f57814ac363b52f2a88d75864524"><div class="ttname"><a href="namespaceGlobal__Parameters.html#a9af8f57814ac363b52f2a88d75864524">Global_Parameters::N_pml_multiplier</a></div><div class="ttdeci">unsigned N_pml_multiplier</div><div class="ttdoc">PML width in elements for the right layer.</div><div class="ttdef"><b>Definition:</b> <a href="time__harmonic__elasticity__driver_8cc_source.html#l00065">time_harmonic_elasticity_driver.cc:65</a></div></div>
<div class="ttc" id="anamespaceGlobal__Parameters_html_a9dc0631434879b47501f64851ad679b8"><div class="ttname"><a href="namespaceGlobal__Parameters.html#a9dc0631434879b47501f64851ad679b8">Global_Parameters::E_pt</a></div><div class="ttdeci">PMLTimeHarmonicIsotropicElasticityTensor * E_pt</div><div class="ttdoc">The elasticity tensor.</div><div class="ttdef"><b>Definition:</b> <a href="time__harmonic__elasticity__driver_8cc_source.html#l00111">time_harmonic_elasticity_driver.cc:111</a></div></div>
<div class="ttc" id="anamespaceGlobal__Parameters_html_aafb6ae2e2642a42a7c8ce999837d18b1"><div class="ttname"><a href="namespaceGlobal__Parameters.html#aafb6ae2e2642a42a7c8ce999837d18b1">Global_Parameters::compute_dependent_parameters</a></div><div class="ttdeci">void compute_dependent_parameters()</div><div class="ttdoc">Function to compute dependent parameters.</div><div class="ttdef"><b>Definition:</b> <a href="time__harmonic__elasticity__driver_8cc_source.html#l00089">time_harmonic_elasticity_driver.cc:89</a></div></div>
<div class="ttc" id="anamespaceGlobal__Parameters_html_accf11b5794502b15efd0aa37347f6994"><div class="ttname"><a href="namespaceGlobal__Parameters.html#accf11b5794502b15efd0aa37347f6994">Global_Parameters::N_x_left_pml</a></div><div class="ttdeci">unsigned N_x_left_pml</div><div class="ttdoc">PML width in elements for the left layer.</div><div class="ttdef"><b>Definition:</b> <a href="time__harmonic__elasticity__driver_8cc_source.html#l00075">time_harmonic_elasticity_driver.cc:75</a></div></div>
<div class="ttc" id="anamespaceGlobal__Parameters_html_ade86fec7e40fc9a5330e6213482f09d6"><div class="ttname"><a href="namespaceGlobal__Parameters.html#ade86fec7e40fc9a5330e6213482f09d6">Global_Parameters::N_y_top_pml</a></div><div class="ttdeci">unsigned N_y_top_pml</div><div class="ttdoc">PML width in elements for the top layer.</div><div class="ttdef"><b>Definition:</b> <a href="time__harmonic__elasticity__driver_8cc_source.html#l00072">time_harmonic_elasticity_driver.cc:72</a></div></div>
<div class="ttc" id="anamespaceGlobal__Parameters_html_af365b0769e142cabdaed848057332858"><div class="ttname"><a href="namespaceGlobal__Parameters.html#af365b0769e142cabdaed848057332858">Global_Parameters::Element_area</a></div><div class="ttdeci">double Element_area</div><div class="ttdoc">helper to set target mesh element size</div><div class="ttdef"><b>Definition:</b> <a href="time__harmonic__elasticity__driver_8cc_source.html#l00058">time_harmonic_elasticity_driver.cc:58</a></div></div>
<div class="ttc" id="anamespaceGlobal__Parameters_html_af9e1e178dfb7f5e35b452599bd4c4324"><div class="ttname"><a href="namespaceGlobal__Parameters.html#af9e1e178dfb7f5e35b452599bd4c4324">Global_Parameters::Omega_sq</a></div><div class="ttdeci">double Omega_sq</div><div class="ttdoc">Square of non-dim frequency.</div><div class="ttdef"><b>Definition:</b> <a href="time__harmonic__elasticity__driver_8cc_source.html#l00108">time_harmonic_elasticity_driver.cc:108</a></div></div>
</div><!-- fragment --><hr  />
 <hr  />
<h1><a class="anchor" id="main"></a>
The driver code</h1>
<p>We start by reading the command line arguments, which allow the specification of the perfectly matched layers in terms of number of elements and thickness.</p>
 <div class="fragment"><div class="line"><span class="comment">//=======start_of_main==================================================</span></div>
<div class="line"><span class="comment">/// Driver for annular disk loaded by pressure</span></div>
<div class="line"><span class="comment"></span><span class="comment">//======================================================================</span></div>
<div class="line"><span class="keywordtype">int</span> <a class="code" href="time__harmonic__elasticity__driver_8cc.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a>(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv)</div>
<div class="line">{</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Start timing of the code</span></div>
<div class="line"> <a class="code" href="namespaceGlobal__Parameters.html#a6106a50c4a420f4040e2ccd7d443267c">Global_Parameters::T_start</a>=TimingHelpers::timer();</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Store command line arguments</span></div>
<div class="line"> CommandLineArgs::setup(argc,argv);</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Define possible command line arguments and parse the ones that</span></div>
<div class="line"> <span class="comment">// were actually specified </span></div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Over-write PML layers element number in each dimension</span></div>
<div class="line"> CommandLineArgs::specify_command_line_flag(<span class="stringliteral">&quot;--n_pml&quot;</span>,</div>
<div class="line">                 &amp;<a class="code" href="namespaceGlobal__Parameters.html#a9af8f57814ac363b52f2a88d75864524">Global_Parameters::N_pml_multiplier</a>);</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Over-write PML layers physical length in each dimension</span></div>
<div class="line"> CommandLineArgs::specify_command_line_flag(<span class="stringliteral">&quot;--l_pml&quot;</span>,</div>
<div class="line">                 &amp;<a class="code" href="namespaceGlobal__Parameters.html#a7a49a7bc4052082ccf10caf8ff7a52b6">Global_Parameters::L_pml_multiplier</a>);</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Output directory</span></div>
<div class="line"> CommandLineArgs::specify_command_line_flag(</div>
<div class="line">  <span class="stringliteral">&quot;--dir&quot;</span>, &amp;<a class="code" href="namespaceGlobal__Parameters.html#a301ab922df72030c660b21328d6caf76">Global_Parameters::Directory</a>);</div>
<div class="ttc" id="atime__harmonic__elasticity__driver_8cc_html_a3c04138a5bfe5d72780bb7e82a18e627"><div class="ttname"><a href="time__harmonic__elasticity__driver_8cc.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a></div><div class="ttdeci">int main(int argc, char **argv)</div><div class="ttdoc">Driver for annular disk loaded by pressure.</div><div class="ttdef"><b>Definition:</b> <a href="time__harmonic__elasticity__driver_8cc_source.html#l00841">time_harmonic_elasticity_driver.cc:841</a></div></div>
</div><!-- fragment --><p> After extracting the relevant information from the command line we continue by computing the dependent parameters.</p>
<div class="fragment"><div class="line"> <span class="comment">// Validation run?</span></div>
<div class="line"> CommandLineArgs::specify_command_line_flag(<span class="stringliteral">&quot;--validation&quot;</span>);</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Parse command line</span></div>
<div class="line"> CommandLineArgs::parse_and_assign(); </div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Doc what has actually been specified on the command line</span></div>
<div class="line"> CommandLineArgs::doc_specified_flags();</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Validation run?</span></div>
<div class="line"> <span class="keywordflow">if</span> (CommandLineArgs::command_line_flag_has_been_set(<span class="stringliteral">&quot;--validation&quot;</span>))</div>
<div class="line">  {</div>
<div class="line">   oomph_info &lt;&lt; <span class="stringliteral">&quot;Using coarser resolution for self-test\n&quot;</span>;</div>
<div class="line">   <span class="comment"></span></div>
<div class="line"><span class="comment">   /// Number of elements for each layer</span></div>
<div class="line"><span class="comment"></span>   <a class="code" href="namespaceGlobal__Parameters.html#a401ab27b40efe725bc047909ae65b4b1">Global_Parameters::N_x_right_pml</a>  = 2;</div>
<div class="line">   <a class="code" href="namespaceGlobal__Parameters.html#ade86fec7e40fc9a5330e6213482f09d6">Global_Parameters::N_y_top_pml</a>    = 2;</div>
<div class="line">   <a class="code" href="namespaceGlobal__Parameters.html#accf11b5794502b15efd0aa37347f6994">Global_Parameters::N_x_left_pml</a>   = 2; </div>
<div class="line">   <a class="code" href="namespaceGlobal__Parameters.html#a79bff9b8e3435255541b71c0e3cc30a1">Global_Parameters::N_y_bottom_pml</a> = 2; </div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">   /// Thickness of each layer</span></div>
<div class="line"><span class="comment"></span>   <a class="code" href="namespaceGlobal__Parameters.html#a140b1b8aaef0bf2b94acf75d681d4545">Global_Parameters::Width_x_right_pml</a>  = 1.0;</div>
<div class="line">   <a class="code" href="namespaceGlobal__Parameters.html#a175759402c54bb216b0599c6a031abea">Global_Parameters::Width_y_top_pml</a>    = 1.0;</div>
<div class="line">   <a class="code" href="namespaceGlobal__Parameters.html#a28925335dcc7b2bed01d744a543be9aa">Global_Parameters::Width_x_left_pml</a>   = 1.0;</div>
<div class="line">   <a class="code" href="namespaceGlobal__Parameters.html#a67848e80f63ec793108a4710a28cc3a9">Global_Parameters::Width_y_bottom_pml</a> = 1.0;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">   /// Target element size</span></div>
<div class="line"><span class="comment"></span>   <a class="code" href="namespaceGlobal__Parameters.html#af365b0769e142cabdaed848057332858">Global_Parameters::Element_area</a>  = 0.025;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">   /// Target element size</span></div>
<div class="line"><span class="comment"></span>   <a class="code" href="namespaceGlobal__Parameters.html#af9e1e178dfb7f5e35b452599bd4c4324">Global_Parameters::Omega_sq</a>  = 10.0;</div>
<div class="line">  }</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Update dependent parameters</span></div>
<div class="line"><span class="comment"></span> <a class="code" href="namespaceGlobal__Parameters.html#aafb6ae2e2642a42a7c8ce999837d18b1">Global_Parameters::compute_dependent_parameters</a>();</div>
<div class="line"> </div>
<div class="line"> DocInfo doc_info;</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Set output directory</span></div>
<div class="line"> doc_info.set_directory(<a class="code" href="namespaceGlobal__Parameters.html#a301ab922df72030c660b21328d6caf76">Global_Parameters::Directory</a>);</div>
</div><!-- fragment --><p> Next, we create the elasticity tensor and set up the problem (discretised with six-noded triangular elements). </p><div class="fragment"><div class="line"> <span class="comment">// Build elasticity tensor</span></div>
<div class="line"> <a class="code" href="namespaceGlobal__Parameters.html#a9dc0631434879b47501f64851ad679b8">Global_Parameters::E_pt</a>=<span class="keyword">new</span> PMLTimeHarmonicIsotropicElasticityTensor(</div>
<div class="line">    <a class="code" href="namespaceGlobal__Parameters.html#a20fccdcfa2c15ad8b951b9ada3bb1661">Global_Parameters::Nu</a>);</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#ifdef ADAPTIVE</span></div>
<div class="line"> </div>
<div class="line"> <span class="comment">//Set up the problem</span></div>
<div class="line"> <a class="code" href="classElasticAnnulusProblem.html">ElasticAnnulusProblem</a>&lt;</div>
<div class="line"> ProjectablePMLTimeHarmonicLinearElasticityElement</div>
<div class="line">  &lt;TPMLTimeHarmonicLinearElasticityElement&lt;2,3&gt; &gt; </div>
<div class="line"> &gt; problem;</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line"> </div>
<div class="line"> <span class="comment">//Set up the problem</span></div>
<div class="line"> <a class="code" href="classElasticAnnulusProblem.html">ElasticAnnulusProblem&lt;TPMLTimeHarmonicLinearElasticityElement&lt;2,3&gt;</a> &gt; </div>
<div class="line">  problem;</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="ttc" id="aclassElasticAnnulusProblem_html"><div class="ttname"><a href="classElasticAnnulusProblem.html">ElasticAnnulusProblem</a></div><div class="ttdoc">Annular disk.</div><div class="ttdef"><b>Definition:</b> <a href="time__harmonic__elasticity__driver_8cc_source.html#l00244">time_harmonic_elasticity_driver.cc:245</a></div></div>
</div><!-- fragment --><p> and perform the actual computation and the post-processing of the results:</p>
<div class="fragment"><div class="line"> <span class="comment">// Solve the problem using Newton&#39;s method</span></div>
<div class="line"> problem.newton_solve();</div>
<div class="line"> <span class="comment">// End timing of the code</span></div>
<div class="line"> <a class="code" href="namespaceGlobal__Parameters.html#a42ef00f24f3bc5c16dae72557c736634">Global_Parameters::T_end</a>=TimingHelpers::timer();</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Doc solution</span></div>
<div class="line"> problem.doc_solution(doc_info);</div>
<div class="line"> </div>
<div class="line">} <span class="comment">//end of main</span></div>
</div><!-- fragment --> <h1><a class="anchor" id="problem"></a>
The problem class</h1>
<p>The <code>Problem</code> class is very simple and is very similar to that employed for the <a href="../../time_harmonic_linear_elasticity/elastic_annulus/html/index.html">solution of the classical time harmonic linear elasticity problem with traction boundary conditions.</a> We provide helper functions to create the PML meshes and to apply the boundary conditions (mainly because these tasks have to be performed repeatedly in the spatially adaptive version this code which is not discussed explicitly here; but see <a class="el" href="index.html#comm_ex">Comments and Exercises</a> ).</p>
 <div class="fragment"><div class="line"><span class="comment">//=============begin_problem============================================ </span></div>
<div class="line"><span class="comment">/// Annular disk</span></div>
<div class="line"><span class="comment"></span><span class="comment">//====================================================================== </span></div>
<div class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> ELASTICITY_ELEMENT&gt;</div>
<div class="line"><span class="keyword">class </span><a class="code" href="classElasticAnnulusProblem.html">ElasticAnnulusProblem</a> : <span class="keyword">public</span> Problem</div>
<div class="line">{</div>
<div class="line"> </div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Constructor:</span></div>
<div class="line"><span class="comment"></span> <a class="code" href="classElasticAnnulusProblem.html#aedf3d30576ccc20e2d8aa809cf075228">ElasticAnnulusProblem</a>();</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Destructor (empty)</span></div>
<div class="line"><span class="comment"></span> <a class="code" href="classElasticAnnulusProblem.html#a7e791acd99dc0ae25ab9f2e2fd07c587">~ElasticAnnulusProblem</a>(){}</div>
<div class="line"> <span class="comment"></span></div>
<div class="line"><span class="comment"> /// Update function (empty)</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classElasticAnnulusProblem.html#adfb87876ac9981899c6c0b4caf0786f9">actions_after_newton_solve</a>() {}</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Update function (empty)</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classElasticAnnulusProblem.html#af50a0dc2601e1a5e884166941d2cb9ce">actions_before_newton_solve</a>() {}</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Create PML meshes</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classElasticAnnulusProblem.html#a0d2b0cc613caaca7c8f1a78c80b40bc7">create_pml_meshes</a>();</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Actions before adapt: Wipe the mesh of traction elements</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classElasticAnnulusProblem.html#abc8f38dd49a37b06212c168588301900">actions_before_adapt</a>();</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Actions after adapt: Rebuild the mesh of traction elements</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classElasticAnnulusProblem.html#aa47beeedeac662b19c0f992daf77ef25">actions_after_adapt</a>();</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Doc the solution</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classElasticAnnulusProblem.html#ab2952a8591047f62f9f66cfe29a533de">doc_solution</a>(DocInfo&amp; doc_info);</div>
<div class="ttc" id="aclassElasticAnnulusProblem_html_a0d2b0cc613caaca7c8f1a78c80b40bc7"><div class="ttname"><a href="classElasticAnnulusProblem.html#a0d2b0cc613caaca7c8f1a78c80b40bc7">ElasticAnnulusProblem::create_pml_meshes</a></div><div class="ttdeci">void create_pml_meshes()</div><div class="ttdoc">Create PML meshes.</div><div class="ttdef"><b>Definition:</b> <a href="time__harmonic__elasticity__driver_8cc_source.html#l00752">time_harmonic_elasticity_driver.cc:752</a></div></div>
<div class="ttc" id="aclassElasticAnnulusProblem_html_a7e791acd99dc0ae25ab9f2e2fd07c587"><div class="ttname"><a href="classElasticAnnulusProblem.html#a7e791acd99dc0ae25ab9f2e2fd07c587">ElasticAnnulusProblem::~ElasticAnnulusProblem</a></div><div class="ttdeci">~ElasticAnnulusProblem()</div><div class="ttdoc">Destructor (empty)</div><div class="ttdef"><b>Definition:</b> <a href="time__harmonic__elasticity__driver_8cc_source.html#l00253">time_harmonic_elasticity_driver.cc:253</a></div></div>
<div class="ttc" id="aclassElasticAnnulusProblem_html_aa47beeedeac662b19c0f992daf77ef25"><div class="ttname"><a href="classElasticAnnulusProblem.html#aa47beeedeac662b19c0f992daf77ef25">ElasticAnnulusProblem::actions_after_adapt</a></div><div class="ttdeci">void actions_after_adapt()</div><div class="ttdoc">Actions after adapt: Rebuild the mesh of traction elements.</div><div class="ttdef"><b>Definition:</b> <a href="time__harmonic__elasticity__driver_8cc_source.html#l00611">time_harmonic_elasticity_driver.cc:611</a></div></div>
<div class="ttc" id="aclassElasticAnnulusProblem_html_ab2952a8591047f62f9f66cfe29a533de"><div class="ttname"><a href="classElasticAnnulusProblem.html#ab2952a8591047f62f9f66cfe29a533de">ElasticAnnulusProblem::doc_solution</a></div><div class="ttdeci">void doc_solution(DocInfo &amp;doc_info)</div><div class="ttdoc">Doc the solution.</div><div class="ttdef"><b>Definition:</b> <a href="time__harmonic__elasticity__driver_8cc_source.html#l00629">time_harmonic_elasticity_driver.cc:629</a></div></div>
<div class="ttc" id="aclassElasticAnnulusProblem_html_abc8f38dd49a37b06212c168588301900"><div class="ttname"><a href="classElasticAnnulusProblem.html#abc8f38dd49a37b06212c168588301900">ElasticAnnulusProblem::actions_before_adapt</a></div><div class="ttdeci">void actions_before_adapt()</div><div class="ttdoc">Actions before adapt: Wipe the mesh of traction elements.</div><div class="ttdef"><b>Definition:</b> <a href="time__harmonic__elasticity__driver_8cc_source.html#l00571">time_harmonic_elasticity_driver.cc:571</a></div></div>
<div class="ttc" id="aclassElasticAnnulusProblem_html_adfb87876ac9981899c6c0b4caf0786f9"><div class="ttname"><a href="classElasticAnnulusProblem.html#adfb87876ac9981899c6c0b4caf0786f9">ElasticAnnulusProblem::actions_after_newton_solve</a></div><div class="ttdeci">void actions_after_newton_solve()</div><div class="ttdoc">Update function (empty)</div><div class="ttdef"><b>Definition:</b> <a href="time__harmonic__elasticity__driver_8cc_source.html#l00256">time_harmonic_elasticity_driver.cc:256</a></div></div>
<div class="ttc" id="aclassElasticAnnulusProblem_html_aedf3d30576ccc20e2d8aa809cf075228"><div class="ttname"><a href="classElasticAnnulusProblem.html#aedf3d30576ccc20e2d8aa809cf075228">ElasticAnnulusProblem::ElasticAnnulusProblem</a></div><div class="ttdeci">ElasticAnnulusProblem()</div><div class="ttdoc">Constructor:</div><div class="ttdef"><b>Definition:</b> <a href="time__harmonic__elasticity__driver_8cc_source.html#l00336">time_harmonic_elasticity_driver.cc:336</a></div></div>
<div class="ttc" id="aclassElasticAnnulusProblem_html_af50a0dc2601e1a5e884166941d2cb9ce"><div class="ttname"><a href="classElasticAnnulusProblem.html#af50a0dc2601e1a5e884166941d2cb9ce">ElasticAnnulusProblem::actions_before_newton_solve</a></div><div class="ttdeci">void actions_before_newton_solve()</div><div class="ttdoc">Update function (empty)</div><div class="ttdef"><b>Definition:</b> <a href="time__harmonic__elasticity__driver_8cc_source.html#l00259">time_harmonic_elasticity_driver.cc:259</a></div></div>
</div><!-- fragment --><p> The private member data includes pointers the bulk mesh</p>
<div class="fragment"><div class="line"> <span class="comment">/// Pointer to solid mesh</span></div>
<div class="line"> TriangleMesh&lt;ELASTICITY_ELEMENT&gt;* Solid_mesh_pt;</div>
</div><!-- fragment --><p> and to the various PML sub-meshes</p>
<div class="fragment"><div class="line"> <span class="comment">/// Pointer to the right PML mesh</span></div>
<div class="line"> Mesh* PML_right_mesh_pt;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Pointer to the top PML mesh</span></div>
<div class="line"><span class="comment"></span> Mesh* PML_top_mesh_pt;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Pointer to the left PML mesh</span></div>
<div class="line"><span class="comment"></span> Mesh* PML_left_mesh_pt;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Pointer to the bottom PML mesh</span></div>
<div class="line"><span class="comment"></span> Mesh* PML_bottom_mesh_pt;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Pointer to the top right corner PML mesh</span></div>
<div class="line"><span class="comment"></span> Mesh* PML_top_right_mesh_pt;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Pointer to the top left corner PML mesh</span></div>
<div class="line"><span class="comment"></span> Mesh* PML_top_left_mesh_pt;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Pointer to the bottom right corner PML mesh</span></div>
<div class="line"><span class="comment"></span> Mesh* PML_bottom_right_mesh_pt;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Pointer to the bottom left corner PML mesh</span></div>
<div class="line"><span class="comment"></span> Mesh* PML_bottom_left_mesh_pt;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// DocInfo object for output</span></div>
<div class="line"><span class="comment"></span> DocInfo Doc_info;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Boundary ID of upper inner boundary</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">unsigned</span> Upper_inner_boundary_id;</div>
<div class="line"> <span class="comment"></span></div>
<div class="line"><span class="comment"> /// Boundary ID of upper outer boundary</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">unsigned</span> Upper_outer_boundary_id;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Boundary ID of lower inner boundary</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">unsigned</span> Lower_inner_boundary_id;</div>
<div class="line"> <span class="comment"></span></div>
<div class="line"><span class="comment"> /// Boundary ID of lower outer boundary</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">unsigned</span> Lower_outer_boundary_id;</div>
<div class="line"> </div>
<div class="line">};</div>
</div><!-- fragment --> <hr  />
 <hr  />
<h1><a class="anchor" id="constructor"></a>
The problem constructor</h1>
<p>We start by creating the <code>Circle</code> object that defines the inner boundary of the domain. The radius has been defined as part of the <code><a class="el" href="namespaceGlobal__Parameters.html" title="/////////////////////////////////////////////////////////////////// /////////////////////////////////...">Global_Parameters</a></code> definition:</p>
 <div class="fragment"><div class="line"><span class="comment">//===========start_of_constructor======================================= </span></div>
<div class="line"><span class="comment">/// Constructor: </span></div>
<div class="line"><span class="comment"></span><span class="comment">//====================================================================== </span></div>
<div class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> ELASTICITY_ELEMENT&gt;</div>
<div class="line"><a class="code" href="classElasticAnnulusProblem.html#aedf3d30576ccc20e2d8aa809cf075228">ElasticAnnulusProblem&lt;ELASTICITY_ELEMENT&gt;::ElasticAnnulusProblem</a>() </div>
<div class="line">{</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Solid mesh</span></div>
<div class="line"> <span class="comment">//-----------</span></div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Create circle representing inner boundary</span></div>
<div class="line"> <span class="keywordtype">double</span> a=0.2;</div>
<div class="line"> <span class="keywordtype">double</span> x_c=0.0;</div>
<div class="line"> <span class="keywordtype">double</span> y_c=0.0;</div>
<div class="line"> Circle* inner_circle_pt=<span class="keyword">new</span> Circle(x_c,y_c,a);</div>
</div><!-- fragment --><p> and define the polygonal outer boundary of the computational domain. </p><div class="fragment"><div class="line"> </div>
<div class="line"> <span class="comment">// Outer boundary</span></div>
<div class="line"> <span class="comment">//---------------</span></div>
<div class="line"> TriangleMeshClosedCurve* outer_boundary_pt=0;</div>
<div class="line"> </div>
<div class="line"> <span class="keywordtype">unsigned</span> n_segments = 16;</div>
<div class="line"> Vector&lt;TriangleMeshCurveSection*&gt; outer_boundary_line_pt(4);</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Each polyline only has three vertices, provide storage for their</span></div>
<div class="line"> <span class="comment">// coordinates</span></div>
<div class="line"> Vector&lt;Vector&lt;double&gt; &gt; vertex_coord(2);</div>
<div class="line"> <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i=0;i&lt;2;i++)</div>
<div class="line">  {</div>
<div class="line">   vertex_coord[i].resize(2);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// First polyline</span></div>
<div class="line"> vertex_coord[0][0]=-2.0;</div>
<div class="line"> vertex_coord[0][1]=-2.0;</div>
<div class="line"> vertex_coord[1][0]=-2.0;</div>
<div class="line"> vertex_coord[1][1]=2.0;</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Build the 1st boundary polyline</span></div>
<div class="line"> <span class="keywordtype">unsigned</span> boundary_id=2;</div>
<div class="line"> outer_boundary_line_pt[0] = <span class="keyword">new</span> TriangleMeshPolyLine(vertex_coord,</div>
<div class="line">                                                      boundary_id);</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Second boundary polyline</span></div>
<div class="line"> vertex_coord[0][0]=-2.0;</div>
<div class="line"> vertex_coord[0][1]=2.0;</div>
<div class="line"> vertex_coord[1][0]=2.0;</div>
<div class="line"> vertex_coord[1][1]=2.0;</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Build the 2nd boundary polyline</span></div>
<div class="line"> boundary_id=3;</div>
<div class="line"> outer_boundary_line_pt[1] = <span class="keyword">new</span> TriangleMeshPolyLine(vertex_coord,</div>
<div class="line">                                                      boundary_id);</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Third boundary polyline</span></div>
<div class="line"> vertex_coord[0][0]=2.0;</div>
<div class="line"> vertex_coord[0][1]=2.0;</div>
<div class="line"> vertex_coord[1][0]=2.0;</div>
<div class="line"> vertex_coord[1][1]=-2.0;</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Build the 3rd boundary polyline</span></div>
<div class="line"> boundary_id=4;</div>
<div class="line"> outer_boundary_line_pt[2] = <span class="keyword">new</span> TriangleMeshPolyLine(vertex_coord,</div>
<div class="line">                                                      boundary_id);</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Fourth boundary polyline</span></div>
<div class="line"> vertex_coord[0][0]=2.0;</div>
<div class="line"> vertex_coord[0][1]=-2.0;</div>
<div class="line"> vertex_coord[1][0]=-2.0;</div>
<div class="line"> vertex_coord[1][1]=-2.0;</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Build the 4th boundary polyline</span></div>
<div class="line"> boundary_id=5;</div>
<div class="line"> outer_boundary_line_pt[3] = <span class="keyword">new</span> TriangleMeshPolyLine(vertex_coord,</div>
<div class="line">                                                      boundary_id);</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Create the triangle mesh polygon for outer boundary</span></div>
<div class="line"> outer_boundary_pt = <span class="keyword">new</span> TriangleMeshPolygon(outer_boundary_line_pt);</div>
</div><!-- fragment --><p> Next we define the curvilinear inner boundary in terms of two <code>TriangleMeshCurviLines</code> which define the hole in the domain:</p>
<div class="fragment"><div class="line"> </div>
<div class="line"> <span class="comment">// Inner circular boundary</span></div>
<div class="line"> <span class="comment">//------------------------</span></div>
<div class="line"> Vector&lt;TriangleMeshCurveSection*&gt; inner_boundary_line_pt(2);</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// The intrinsic coordinates for the beginning and end of the curve</span></div>
<div class="line"> <span class="keywordtype">double</span> s_start = 0.0;</div>
<div class="line"> <span class="keywordtype">double</span> s_end   = MathematicalConstants::Pi;</div>
<div class="line"> boundary_id = 0;</div>
<div class="line"> inner_boundary_line_pt[0]=</div>
<div class="line">  <span class="keyword">new</span> TriangleMeshCurviLine(inner_circle_pt,</div>
<div class="line">                            s_start,</div>
<div class="line">                            s_end,</div>
<div class="line">                            n_segments,</div>
<div class="line">                            boundary_id);</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// The intrinsic coordinates for the beginning and end of the curve</span></div>
<div class="line"> s_start = MathematicalConstants::Pi;</div>
<div class="line"> s_end   = 2.0*MathematicalConstants::Pi;</div>
<div class="line"> boundary_id = 1;</div>
<div class="line"> inner_boundary_line_pt[1]=</div>
<div class="line">  <span class="keyword">new</span> TriangleMeshCurviLine(inner_circle_pt,</div>
<div class="line">                            s_start,</div>
<div class="line">                            s_end,</div>
<div class="line">                            n_segments,</div>
<div class="line">                            boundary_id);</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Combine to hole</span></div>
<div class="line"> <span class="comment">//----------------</span></div>
<div class="line"> Vector&lt;TriangleMeshClosedCurve*&gt; hole_pt(1);</div>
<div class="line"> Vector&lt;double&gt; hole_coords(2);</div>
<div class="line"> hole_coords[0]=0.0;</div>
<div class="line"> hole_coords[1]=0.0;</div>
<div class="line"> hole_pt[0]=<span class="keyword">new</span> TriangleMeshClosedCurve(inner_boundary_line_pt,</div>
<div class="line">                                        hole_coords);</div>
</div><!-- fragment --><p> We specify the mesh parameters (including a target element size)</p>
<div class="fragment"><div class="line"> </div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Use the TriangleMeshParameters object for helping on the manage </span></div>
<div class="line"> <span class="comment">// of the TriangleMesh parameters. The only parameter that needs to take </span></div>
<div class="line"> <span class="comment">// is the outer boundary.</span></div>
<div class="line"> TriangleMeshParameters triangle_mesh_parameters(outer_boundary_pt);</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Specify the closed curve using the TriangleMeshParameters object</span></div>
<div class="line"> triangle_mesh_parameters.internal_closed_curve_pt() = hole_pt;</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Target element size in bulk mesh</span></div>
<div class="line"> triangle_mesh_parameters.element_area() = <a class="code" href="namespaceGlobal__Parameters.html#af365b0769e142cabdaed848057332858">Global_Parameters::Element_area</a>; </div>
</div><!-- fragment --><p> and build the bulk mesh</p>
<div class="fragment"><div class="line"> <span class="comment">// Build the mesh</span></div>
<div class="line"> Solid_mesh_pt=<span class="keyword">new</span> </div>
<div class="line">  RefineableTriangleMesh&lt;ELASTICITY_ELEMENT&gt;(triangle_mesh_parameters);</div>
</div><!-- fragment --><p> We create the PML meshes and add them (and the solid mesh) to the Problem's collection of sub-meshes and build the global mesh.</p>
<div class="fragment"><div class="line"> <span class="comment">// Create the main triangular mesh</span></div>
<div class="line"> add_sub_mesh(Solid_mesh_pt);</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Create PML meshes and add them to the global mesh</span></div>
<div class="line"> create_pml_meshes();</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Build the entire mesh from its submeshes</span></div>
<div class="line"> build_global_mesh();</div>
</div><!-- fragment --><p> Next we pass the problem parameters to all elements via calling <br  />
 <code> <a class="el" href="classElasticAnnulusProblem.html#a06d509ff3316e5f3072ad5f9144cc33f" title="Helper function to complete problem setup.">ElasticAnnulusProblem&lt;ELASTICITY_ELEMENT&gt;::complete_problem_setup()</a> </code> discussed below (remember that even the elements in the PML layers need to be told about these since they adjust the <img class="formulaInl" alt="$ \gamma_x $" src="form_83.png" width="13" height="9"/> and <img class="formulaInl" alt="$ \gamma_y $" src="form_84.png" width="13" height="10"/> functions in terms of these parameters), apply the boundary conditions and assign the equation numbers.</p>
<div class="fragment"><div class="line"> <span class="comment">// Complete problem setup</span></div>
<div class="line"> complete_problem_setup();</div>
<div class="line"> </div>
<div class="line"> <span class="comment">//Assign equation numbers</span></div>
<div class="line"> cout &lt;&lt; assign_eqn_numbers() &lt;&lt; std::endl; </div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Set output directory</span></div>
<div class="line"> Doc_info.set_directory(<a class="code" href="namespaceGlobal__Parameters.html#a301ab922df72030c660b21328d6caf76">Global_Parameters::Directory</a>);</div>
<div class="line"> </div>
<div class="line">} <span class="comment">//end_of_constructor</span></div>
</div><!-- fragment --><p> The setup of the problem is now complete.</p>
<hr  />
 <hr  />
<h2><a class="anchor" id="complete_setup"></a>
Completing the problem setup</h2>
<p>We pass the problem parameters to all elements, which are used in the equation construction and perfectly matched layer definition.</p>
 <div class="fragment"><div class="line"><span class="comment">//=====================start_of_complete_problem_setup====================</span></div>
<div class="line"><span class="comment">/// Complete problem setup</span></div>
<div class="line"><span class="comment"></span><span class="comment">//========================================================================</span></div>
<div class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> ELASTICITY_ELEMENT&gt;</div>
<div class="line"><span class="keywordtype">void</span> <a class="code" href="classElasticAnnulusProblem.html#a06d509ff3316e5f3072ad5f9144cc33f">ElasticAnnulusProblem&lt;ELASTICITY_ELEMENT&gt;::complete_problem_setup</a>()</div>
<div class="line">{</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#ifdef ADAPTIVE</span></div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Min element size allowed during adaptation</span></div>
<div class="line"> <span class="keywordflow">if</span> (!CommandLineArgs::command_line_flag_has_been_set(<span class="stringliteral">&quot;--validation&quot;</span>))</div>
<div class="line">  {   </div>
<div class="line">   Solid_mesh_pt-&gt;min_element_size()=1.0e-5; </div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"> </div>
<div class="line"> <span class="comment">//Assign the physical properties to the elements</span></div>
<div class="line"> <span class="comment">//----------------------------------------------</span></div>
<div class="line"> <span class="keywordtype">unsigned</span> nel=this-&gt;mesh_pt()-&gt;nelement();</div>
<div class="line"> <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> e=0;e&lt;nel;e++)</div>
<div class="line">  {     <span class="comment"></span></div>
<div class="line"><span class="comment">   /// Upcast from PMLElement to time harmonic </span></div>
<div class="line"><span class="comment">   /// linear elasticity bulk element</span></div>
<div class="line"><span class="comment"></span>   PMLTimeHarmonicLinearElasticityEquations&lt;2&gt; *el_pt = </div>
<div class="line">    <span class="keyword">dynamic_cast&lt;</span>PMLTimeHarmonicLinearElasticityEquations&lt;2&gt;*<span class="keyword">&gt;</span></div>
<div class="line">    (mesh_pt()-&gt;element_pt(e));</div>
<div class="line">   </div>
<div class="line">   <span class="comment">// Set the constitutive law</span></div>
<div class="line">   el_pt-&gt;elasticity_tensor_pt() = <a class="code" href="namespaceGlobal__Parameters.html#a9dc0631434879b47501f64851ad679b8">Global_Parameters::E_pt</a>;</div>
<div class="line">   </div>
<div class="line">   <span class="comment">// Square of non-dim frequency</span></div>
<div class="line">   el_pt-&gt;omega_sq_pt()= &amp;<a class="code" href="namespaceGlobal__Parameters.html#af9e1e178dfb7f5e35b452599bd4c4324">Global_Parameters::Omega_sq</a>;</div>
<div class="line">  } <span class="comment">// end_of_assignment                        </span></div>
<div class="ttc" id="aclassElasticAnnulusProblem_html_a06d509ff3316e5f3072ad5f9144cc33f"><div class="ttname"><a href="classElasticAnnulusProblem.html#a06d509ff3316e5f3072ad5f9144cc33f">ElasticAnnulusProblem::complete_problem_setup</a></div><div class="ttdeci">void complete_problem_setup()</div><div class="ttdoc">Helper function to complete problem setup.</div><div class="ttdef"><b>Definition:</b> <a href="time__harmonic__elasticity__driver_8cc_source.html#l00512">time_harmonic_elasticity_driver.cc:512</a></div></div>
</div><!-- fragment --><p> We pin all four nodal values (representing the real and imaginary part of the two displacement components) on the inner boundaries (boundaries 0 and 1; see enumeration of the boundaries in the constructor) and assign the desired boundary values.</p>
<div class="fragment"><div class="line"> <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> b=0;b&lt;2;b++)</div>
<div class="line">  {</div>
<div class="line">   <span class="keywordtype">unsigned</span> n_node = Solid_mesh_pt-&gt;nboundary_node(b);</div>
<div class="line">   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> n=0;n&lt;n_node;n++)</div>
<div class="line">    {</div>
<div class="line">       Node* nod_pt=Solid_mesh_pt-&gt;boundary_node_pt(b,n);</div>
<div class="line">       Vector&lt;double&gt; x_node(2);</div>
<div class="line">       x_node[0]=nod_pt-&gt;x(0);</div>
<div class="line">       x_node[1]=nod_pt-&gt;x(1);</div>
<div class="line">       Vector&lt;double&gt; u_exact(4);</div>
<div class="line">       <a class="code" href="namespaceGlobal__Parameters.html#a97162dba4bd29a15067b9c9bbe53c754">Global_Parameters::exact_u</a>(x_node,u_exact);</div>
<div class="line"> </div>
<div class="line">       <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> k=0;k&lt;4;k++)</div>
<div class="line">        {</div>
<div class="line">         nod_pt-&gt;pin(k);</div>
<div class="line">         nod_pt-&gt;set_value(k,u_exact[k]);</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line">} <span class="comment">// end_of_complete_setup</span></div>
<div class="ttc" id="anamespaceGlobal__Parameters_html_a97162dba4bd29a15067b9c9bbe53c754"><div class="ttname"><a href="namespaceGlobal__Parameters.html#a97162dba4bd29a15067b9c9bbe53c754">Global_Parameters::exact_u</a></div><div class="ttdeci">void exact_u(const Vector&lt; double &gt; &amp;x, Vector&lt; double &gt; &amp;u)</div><div class="ttdoc">Exact solution as a Vector: {u_x_real, u_y_real, u_x_imag, u_y_imag}.</div><div class="ttdef"><b>Definition:</b> <a href="time__harmonic__elasticity__driver_8cc_source.html#l00152">time_harmonic_elasticity_driver.cc:152</a></div></div>
</div><!-- fragment --> <hr  />
 <hr  />
<h1><a class="anchor" id="doc"></a>
Post-processing</h1>
<p>As expected, the <code>doc_solution(...)</code> member function documents the computed solution. We are particularly interested in the computed solution and the exact solution for comparison purposes</p>
 <div class="fragment"><div class="line"> <span class="comment">// Output displacement field</span></div>
<div class="line"> <span class="comment">//--------------------------</span></div>
<div class="line"> sprintf(filename,<span class="stringliteral">&quot;%s/soln_bulk%i.dat&quot;</span>,Doc_info.directory().c_str(),</div>
<div class="line">         Doc_info.number());</div>
<div class="line"> some_file.open(filename);</div>
<div class="line"> Solid_mesh_pt-&gt;output(some_file,n_plot);</div>
<div class="line"> some_file.close();</div>
<div class="line">  <span class="comment">// Output exact solution </span></div>
<div class="line"> <span class="comment">//----------------------</span></div>
<div class="line"> sprintf(filename,<span class="stringliteral">&quot;%s/exact_soln%i.dat&quot;</span>,Doc_info.directory().c_str(),</div>
<div class="line">         Doc_info.number());</div>
<div class="line"> some_file.open(filename);</div>
<div class="line"> Solid_mesh_pt-&gt;output_fct(some_file,n_plot,<a class="code" href="namespaceGlobal__Parameters.html#a97162dba4bd29a15067b9c9bbe53c754">Global_Parameters::exact_u</a>); </div>
<div class="line"> some_file.close();</div>
</div><!-- fragment --><p> We also output the solution in the perfectly matched layers themselves and document the norm of the solution, the wall clock time and number of degrees of freedom.</p>
<div class="fragment"><div class="line"> <span class="comment">// Output runtime (wall clock time) in s in a file</span></div>
<div class="line"> sprintf(filename,<span class="stringliteral">&quot;%s/wall_clock_time%i.dat&quot;</span>,Doc_info.directory().c_str(),</div>
<div class="line">         Doc_info.number()); </div>
<div class="line"> some_file.open(filename);</div>
<div class="line"> some_file &lt;&lt; <a class="code" href="namespaceGlobal__Parameters.html#a42ef00f24f3bc5c16dae72557c736634">Global_Parameters::T_end</a>-<a class="code" href="namespaceGlobal__Parameters.html#a6106a50c4a420f4040e2ccd7d443267c">Global_Parameters::T_start</a> &lt;&lt; std::endl;</div>
<div class="line"> some_file.close();</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Output number of degrees of freedom in a file</span></div>
<div class="line"> sprintf(filename,<span class="stringliteral">&quot;%s/ndof%i.dat&quot;</span>,Doc_info.directory().c_str(),</div>
<div class="line">         Doc_info.number()); </div>
<div class="line"> some_file.open(filename);</div>
<div class="line"> some_file &lt;&lt; this-&gt;ndof() &lt;&lt; std::endl;</div>
<div class="line"> some_file.close();</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Output norm of solution (to allow validation of solution even</span></div>
<div class="line"> <span class="comment">// if triangle generates a slightly different mesh)</span></div>
<div class="line"> sprintf(filename,<span class="stringliteral">&quot;%s/elast_soln_norm%i.dat&quot;</span>,Doc_info.directory().c_str(),</div>
<div class="line">         Doc_info.number());   </div>
<div class="line"> some_file.open(filename);   </div>
<div class="line"> <span class="keywordtype">double</span> norm_soln=0.0;</div>
<div class="line"> this-&gt;mesh_pt()-&gt;compute_norm(norm_soln);  </div>
<div class="line"> some_file &lt;&lt; sqrt(norm_soln) &lt;&lt; std::endl;</div>
<div class="line"> cout &lt;&lt; <span class="stringliteral">&quot;Norm of computed solution: &quot;</span>   &lt;&lt; sqrt(norm_soln)  &lt;&lt; endl;</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Increment label for output files</span></div>
<div class="line"> Doc_info.number()++;</div>
<div class="line"> </div>
<div class="line">} <span class="comment">//end doc</span></div>
</div><!-- fragment --> <hr  />
 <hr  />
<h1><a class="anchor" id="comm_ex"></a>
Comments and Exercises</h1>
<h2><a class="anchor" id="comments"></a>
Comments</h2>
<ul>
<li>If you inspect the <a href="../../../demo_drivers/pml_time_harmonic_linear_elasticity/time_harmonic_elasticity_driver.cc">driver code</a> you will notice that it also contains relevant code to perform spatially adaptive simulations of the problem &ndash; the adaptive version of the code is selected with <code>#ifdefs</code>.</li>
<li>The choice for the absorbing functions in our implementation of the PMLs is not unique. There are alternatives varying in both order and continuity properties. The current form is the result of several feasibility studies and comparisons found in <a href="http://www.sciencedirect.com/science/article/pii/S0021999106004487">Bermudez et al.</a> For Helmholtz equations these damping functions produce an acceptable result in most practical situations without further modifications. For very specific applications, alternatives may need to be used and can easily be implemented within the existing framework.</li>
</ul>
<hr  />
<h2><a class="anchor" id="ex"></a>
Exercises</h2>
<h3><a class="anchor" id="pmlsize"></a>
Changing perfectly matched layer parameters</h3>
<p>Confirm that only a relatively small number of PML elements (across the thickness of the PML layer) is required to effectively damp the outgoing waves. It is also interesting to explore the effect of increasing the number of elements of the mesh inside the perfectly matched layers.</p>
<p>Another parameter that can be adjusted is the geometrical thickness of the perfectly matched layers. In the case of linear elasticity (as opposed to for example the Helmholtz equation), the thickness of these layers must be relatively large to obtain the best results. Try to explain why and take note of the differences between the two mentioned problems.</p>
<h3><a class="anchor" id="adaptivity"></a>
Spatial adaptivity</h3>
<p>The driver code discussed above already contains the straightforward modifications required to enable spatial adaptivity. Explore this (by recompiling the code with -DADAPTIVE) and explain why spatial adaptivity is not particularly helpful for the test problem discussed above.</p>
<h3><a class="anchor" id="diff_order"></a>
Linear and cubic finite elements</h3>
<p>The driver code also contains (commented out) modifications that allow the simulation to be performed with three-node (linear) and ten-node (cubic) triangles. Explore the performance of these elements and confirm that the helper functions correctly create matching (four-node and sixteen-node) quad elements in the PML layers.</p>
<h3><a class="anchor" id="default"></a>
Default values for problem parameters</h3>
<p>Following our usual convention, we provide default values for problem parameters where this is sensible. Some parameters, such as the elasticity tensor, do need to be set since there are no obvious defaults. If <code>oomph-lib</code> is compiled in <code>PARANOID</code> mode, an error is thrown if the relevant pointers haven't been set. Without paranoia, you get a segmentation fault...</p>
<p>Confirm that this is the case by commenting out the relevant assignments.</p>
<h3><a class="anchor" id="non_convex"></a>
Non-convex PML boundaries</h3>
<p>As discussed above, we currently provide helper functions to attach PML layers to axis-aligned boundaries of 2D meshes with convex outer boundaries. Essentially, this restricts us to rectangular computational domains. Extend this capability by developing methodologies to</p><ul>
<li>deal with non-convex domain boundaries. We suggest you create PML meshes for the non-convex corners first, then create the axis-aligned meshes (note that these have to share nodes with the already-created elements that occupy the non-convex corners), and then create the corner meshes for the convex corners (as before). When you're done, let us know &ndash; this would be a really useful addition to oomph-lib's machinery. We're happy to help!</li>
<li>Repeat the same exercise in 3D &ndash; somewhat less trivial (so we're even keener for somebody to have a go!)</li>
</ul>
<hr  />
 <hr  />
<h1><a class="anchor" id="sources"></a>
Source files for this tutorial</h1>
<ul>
<li>The source files for this tutorial are located in the directory: <center> <a href="../../../demo_drivers/pml_time_harmonic_linear_elasticity/">demo_drivers/pml_time_harmonic_linear_elasticity/ </a> </center></li>
<li>The driver code is: <center> <a href="../../../demo_drivers/pml_time_harmonic_linear_elasticity/time_harmonic_elasticity_driver.cc">demo_drivers/pml_time_harmonic_linear_elasticity/time_harmonic_elasticity_driver.cc </a> </center></li>
</ul>
<hr  />
 <hr  />
 <h1><a class="anchor" id="pdf"></a>
PDF file</h1>
<p>A <a href="../latex/refman.pdf">pdf version</a> of this document is available. </p>
</div></div><!-- PageDoc -->
</div><!-- contents -->

    <!-- jQuery for Bootstrap and Doxygen -->
    <script src="../../js/jquery-1.12.0.min.js"></script>
    <!-- Minified boostrap plugins-->
    <script src="../../js/bootstrap.js"></script>
    <!-- Doxygen dependency to add powertips to source code-->
    <script src="../../js/jquery.powertip.min.js"></script>
    <!-- The  following script is generated by doxygen and hides/shows levels in 
         the data structure lists and adds powertips to source code-->
    <script src="../../js/dynsections.js" ></script>
    <!-- add to Doxygen's class names so bootstrap css and js recognises them-->
    <script type="text/javascript">
    $(".contents").addClass("container");
    $(".header").addClass("container");
    $(".navpath").addClass("container");
    $("#navrow3").addClass("container");
    $("#navrow4").addClass("container");
    $(".mlabel").addClass("label");
    $(".mlabel").addClass("label-default");
    $(".memitem").addClass("panel");
    $(".memitem").addClass("panel-info");
    $(".memproto").addClass("panel-heading");
    $(".memdoc").addClass("panel-body");
    </script>
    <footer>
      <div class="container">
        <div class="text-muted" style="float:right;">Generated by <a href="http://www.doxygen.org/index.html">
          <img style="height:18px;" class="footer-img" src="doxygen.png" alt="doxygen"></a> on Thu Dec 19 2024 11:45:20
        </div>
      </div>
    </footer>
</body>
</html>

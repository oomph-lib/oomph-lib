<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
<title>oomph-lib: tensioned_string.cc Source File</title>
<link rel="apple-touch-icon" sizes="57x57" href="../../../figures/apple-touch-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="../../../figures/apple-touch-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="../../../figures/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="../../../figures/apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="../../../figures/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="../../../figures/apple-touch-icon-120x120.png">
<link rel="icon" type="image/png" href="../../../figures/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="../../../figures/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="../../../figures/favicon-16x16.png" sizes="16x16">
<link rel="manifest" href="../../../figures/manifest.json">
<link rel="mask-icon" href="../../../figures/safari-pinned-tab.svg" color="#008000">
<link rel="shortcut icon" href="../../../figures/favicon.ico">
<meta name="msapplication-TileColor" content="#00a300">
<meta name="msapplication-config" content="../../../figures/browserconfig.xml">
<meta name="theme-color" content="#008000">
<link href="http://fonts.googleapis.com/css?family=Open+Sans:400,300,600" rel="stylesheet" type="text/css">
<!-- Doxygen css-->
<!-- <link rel="stylesheet" type="text/css" href="doxygen.css"> -->
<!-- Bootstrap -->
<link href="../../../css/bootstrap.css" rel="stylesheet">
<!-- oomph-lib specific overrides -->
<link rel="stylesheet" type="text/css" href="../../../css/oomph_header.css">
</head>
<body>
<nav class="navbar navbar-default">
<div class="container">
<div class="container-fluid">
  <!-- Brand and toggle get grouped for better mobile display -->
  <div class="navbar-header">
    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
      <span class="sr-only">Toggle navigation</span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="../../../html/index.html"><img alt="oomph-lib" src="../../../figures/oomph_logo.png"></a>
  </div>
  <!-- Collect the nav links, forms, and other content for toggling -->
  <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
    <ul class="nav navbar-nav">          
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Documentation <span class="caret"></span></a>
        <ul class="dropdown-menu">
          <li class="dropdown-header">Big picture</li>
          <li><a href="../../../../doc/intro/html/index.html">The finite element method</a></li>
          <li><a href="../../../../doc/the_data_structure/html/index.html">The data structure</a></li>
          <li><a href="../../../../doc/quick_guide/html/index.html">Not-so-quick guide</a></li>
          <li><a href="../../../../doc/optimisation/html/index.html">Optimisation</a></li>
          <li><a href="../../../../doc/order_of_action_functions/html/index.html">Order of action functions</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Example codes and tutorials</li>
          <li><a href="../../../../doc/example_code_list/html/index.html">List of example codes and tutorials</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#meshes">Meshing</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#solvers">Solvers</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#parallel">MPI parallel processing</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#visualisation">Post-processing/visualisation</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Other</li>
          <li><a href="../../../../doc/change_log/html/index.html">Change log</a></li>
          <li><a href="../../../../doc/creating_doc/html/index.html">Creating documentation</a></li>
          <li><a href="../../../../doc/coding_conventions/html/index.html">Coding conventions</a></li>
          <li><a href="../../../../doc/index/html/index.html">Index</a></li>
          <li><a href="../../../../doc/FAQ/html/index.html">FAQ</a></li>
        </ul>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Get it <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../../doc/the_distribution/html/index.html">Installation guide</a></li>
            <li><a href="../../../../doc/subversion/html/index.html">Get code from subversion repository</a></li>
            <li><a href="../../../../doc/download/html/index.html">Get code as tar file</a></li>
            <li><a href="../../../../doc/copyright/html/index.html">Copyright</a></li>
          </ul>
        </li>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">About <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../../doc/people/html/index.html">People</a></li>            
            <li><a href="../../../../doc/contact/html/index.html">Contact/Get involved</a></li>
            <li><a href="../../../../doc/publications/html/index.html">Publications</a></li>
            <li><a href="../../../../doc/acknowledgements/html/index.html">Acknowledgements</a></li>
            <li><a href="../../../../doc/picture_show/index.html">Picture show</a></li>
          </ul>
        </li>
      </li>
    </ul>
    <ul class="nav navbar-nav navbar-right navbar-search">
      <form class="navbar-form" role="search" action="../../../../doc/search_results/html/index.html">
        <div class="input-group">
          <input type="text" class="form-control" placeholder="Search" name="q">
          <span class="input-group-btn">
            <button class="btn btn-default" type="submit">Go</button>
          </span>
        </div><!-- /input-group -->
       <!--<div class="form-group">
          <input type="text" class="form-control" placeholder="Search">
        </div>
        <button type="submit" class="btn btn-default">Submit</button>-->
      </form>
    </ul>
  </div><!-- /.navbar-collapse -->
</div><!-- /.container-fluid -->
</div>
</nav>
<!-- Generated by Doxygen 1.8.17 -->
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_ddb094a380b94394dbbcf95a63b535e6.html">demo_drivers</a></li><li class="navelem"><a class="el" href="dir_74eb9d4bd38af196d0ea20e2b0c80a1e.html">beam</a></li><li class="navelem"><a class="el" href="dir_8eef3207e250aebbdad26d22c4950422.html">tensioned_string</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">tensioned_string.cc</div>  </div>
</div><!--header-->
<div class="contents">
<a href="tensioned__string_8cc.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">//LIC// ====================================================================</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">//LIC// This file forms part of oomph-lib, the object-oriented, </span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">//LIC// multi-physics finite-element library, available </span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">//LIC// at http://www.oomph-lib.org.</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">//LIC// Copyright (C) 2006-2021 Matthias Heil and Andrew Hazel</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">//LIC// This library is free software; you can redistribute it and/or</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">//LIC// modify it under the terms of the GNU Lesser General Public</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">//LIC// License as published by the Free Software Foundation; either</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">//LIC// version 2.1 of the License, or (at your option) any later version.</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">//LIC// This library is distributed in the hope that it will be useful,</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">//LIC// but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">//LIC// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">//LIC// Lesser General Public License for more details.</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">//LIC// You should have received a copy of the GNU Lesser General Public</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">//LIC// License along with this library; if not, write to the Free Software</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">//LIC// Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">//LIC// 02110-1301  USA.</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">//LIC// The authors may be contacted at oomph-lib@maths.man.ac.uk.</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">//LIC//====================================================================</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">//Driver function for a simple beam proble</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160; </div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment">//OOMPH-LIB includes</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#include &quot;generic.h&quot;</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#include &quot;beam.h&quot;</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#include &quot;meshes/one_d_lagrangian_mesh.h&quot;</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160; </div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="keyword">using namespace </span>std;</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160; </div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="keyword">using namespace </span>oomph;</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160; </div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment">//========start_of_namespace========================</span><span class="comment"></span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment">/// Namespace for physical parameters</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment"></span><span class="comment">//==================================================</span></div>
<div class="line"><a name="l00040"></a><span class="lineno"><a class="line" href="namespaceGlobal__Physical__Variables.html">   40</a></span>&#160;<span class="keyword">namespace </span><a class="code" href="namespaceGlobal__Physical__Variables.html">Global_Physical_Variables</a></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;{<span class="comment"></span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment"> /// Non-dimensional thickness</span></div>
<div class="line"><a name="l00043"></a><span class="lineno"><a class="line" href="namespaceGlobal__Physical__Variables.html#af6e07423e22c0991084d9a2f43727805">   43</a></span>&#160;<span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="namespaceGlobal__Physical__Variables.html#af6e07423e22c0991084d9a2f43727805">H</a>;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment"> /// 2nd Piola Kirchhoff pre-stress</span></div>
<div class="line"><a name="l00046"></a><span class="lineno"><a class="line" href="namespaceGlobal__Physical__Variables.html#a417dc688a70c4f06ef0faed047068ba2">   46</a></span>&#160;<span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="namespaceGlobal__Physical__Variables.html#a417dc688a70c4f06ef0faed047068ba2">Sigma0</a>;</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment"> /// Pressure load</span></div>
<div class="line"><a name="l00049"></a><span class="lineno"><a class="line" href="namespaceGlobal__Physical__Variables.html#a0406c0cbd463d1df2458fe5de98a00eb">   49</a></span>&#160;<span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="namespaceGlobal__Physical__Variables.html#a0406c0cbd463d1df2458fe5de98a00eb">P_ext</a>;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment"> /// Load function: Apply a constant external pressure to the beam</span></div>
<div class="line"><a name="l00052"></a><span class="lineno"><a class="line" href="namespaceGlobal__Physical__Variables.html#a321267e1efb30b5d586302509354fb07">   52</a></span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="namespaceGlobal__Physical__Variables.html#a321267e1efb30b5d586302509354fb07">load</a>(<span class="keyword">const</span> Vector&lt;double&gt;&amp; xi, <span class="keyword">const</span> Vector&lt;double&gt; &amp;x,</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;           <span class="keyword">const</span> Vector&lt;double&gt;&amp; N, Vector&lt;double&gt;&amp; <a class="code" href="namespaceGlobal__Physical__Variables.html#a321267e1efb30b5d586302509354fb07">load</a>)</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160; {</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i=0;i&lt;2;i++) {<a class="code" href="namespaceGlobal__Physical__Variables.html#a321267e1efb30b5d586302509354fb07">load</a>[i] = -<a class="code" href="namespaceGlobal__Physical__Variables.html#a0406c0cbd463d1df2458fe5de98a00eb">P_ext</a>*N[i];}</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160; }</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160; </div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;} <span class="comment">// end of namespace</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160; </div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment">//======start_of_problem_class==========================================</span><span class="comment"></span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment">/// Beam problem object</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment"></span><span class="comment">//======================================================================</span></div>
<div class="line"><a name="l00063"></a><span class="lineno"><a class="line" href="classElasticBeamProblem.html">   63</a></span>&#160;<span class="keyword">class </span><a class="code" href="classElasticBeamProblem.html">ElasticBeamProblem</a> : <span class="keyword">public</span> Problem</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;{</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment"> /// \short Constructor: The arguments are the number of elements, </span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment"> /// the length of domain</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="comment"></span> <a class="code" href="classElasticBeamProblem.html">ElasticBeamProblem</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;n_elem, <span class="keyword">const</span> <span class="keywordtype">double</span> &amp;length);</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="comment"> /// Conduct a parameter study</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> parameter_study();</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="comment"> /// Return pointer to the mesh</span></div>
<div class="line"><a name="l00075"></a><span class="lineno"><a class="line" href="classElasticBeamProblem.html#ae7d14ba8bec2325a82cbeed0c1b29910">   75</a></span>&#160;<span class="comment"></span> OneDLagrangianMesh&lt;HermiteBeamElement&gt;* <a class="code" href="classElasticBeamProblem.html#ae7d14ba8bec2325a82cbeed0c1b29910">mesh_pt</a>() </div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  {<span class="keywordflow">return</span> <span class="keyword">dynamic_cast&lt;</span>OneDLagrangianMesh&lt;HermiteBeamElement&gt;*<span class="keyword">&gt;</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    (<a class="code" href="tensioned__string_8txt.html#a0f5aaa7d7eab4fbec16d94c64db068d1">Problem::mesh_pt</a>());}</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="comment"> /// No actions need to be performed after a solve</span></div>
<div class="line"><a name="l00080"></a><span class="lineno"><a class="line" href="classElasticBeamProblem.html#a30dde8d0101a3d3994965d6e560cb585">   80</a></span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classElasticBeamProblem.html#a30dde8d0101a3d3994965d6e560cb585">actions_after_newton_solve</a>() {}</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment"> /// No actions need to be performed before a solve</span></div>
<div class="line"><a name="l00083"></a><span class="lineno"><a class="line" href="classElasticBeamProblem.html#a5b534c11d9b1d54123bf587aad5f98f6">   83</a></span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classElasticBeamProblem.html#a5b534c11d9b1d54123bf587aad5f98f6">actions_before_newton_solve</a>() {}</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160; </div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="comment"> /// Pointer to the node whose displacement is documented</span></div>
<div class="line"><a name="l00088"></a><span class="lineno"><a class="line" href="classElasticBeamProblem.html#a9c96cab7e71243e51f7c4040a84cdd5d">   88</a></span>&#160;<span class="comment"></span> Node* <a class="code" href="classElasticBeamProblem.html#a9c96cab7e71243e51f7c4040a84cdd5d">Doc_node_pt</a>;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="comment"> /// Length of domain (in terms of the Lagrangian coordinates)</span></div>
<div class="line"><a name="l00091"></a><span class="lineno"><a class="line" href="classElasticBeamProblem.html#aa68b1c77e0aa1571fe956d62bd8cf096">   91</a></span>&#160;<span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="classElasticBeamProblem.html#aa68b1c77e0aa1571fe956d62bd8cf096">Length</a>;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="comment"> /// Pointer to geometric object that represents the beam&#39;s undeformed shape</span></div>
<div class="line"><a name="l00094"></a><span class="lineno"><a class="line" href="classElasticBeamProblem.html#a134a789cae77ab61a3e32bd93b28e1fa">   94</a></span>&#160;<span class="comment"></span> GeomObject* <a class="code" href="classElasticBeamProblem.html#a134a789cae77ab61a3e32bd93b28e1fa">Undef_beam_pt</a>;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160; </div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;}; <span class="comment">// end of problem class</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160; </div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160; </div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="comment">//=============start_of_constructor=====================================</span><span class="comment"></span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="comment">/// Constructor for elastic beam problem</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="comment"></span><span class="comment">//======================================================================</span></div>
<div class="line"><a name="l00102"></a><span class="lineno"><a class="line" href="classElasticBeamProblem.html#a1c62c2a14c9a5528a649700d16dac2ea">  102</a></span>&#160;<a class="code" href="classElasticBeamProblem.html#a1c62c2a14c9a5528a649700d16dac2ea">ElasticBeamProblem::ElasticBeamProblem</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;n_elem,</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;                                       <span class="keyword">const</span> <span class="keywordtype">double</span> &amp;length) : Length(length)</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;{</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160; <span class="comment">// Set the undeformed beam to be a straight line at y=0</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160; <a class="code" href="classElasticBeamProblem.html#a134a789cae77ab61a3e32bd93b28e1fa">Undef_beam_pt</a>=<span class="keyword">new</span> StraightLine(0.0); </div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160; </div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160; <span class="comment">// Create the (Lagrangian!) mesh, using the geometric object</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160; <span class="comment">// Undef_beam_pt to specify the initial (Eulerian) position of the</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160; <span class="comment">// nodes.</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160; <a class="code" href="tensioned__string_8txt.html#a0f5aaa7d7eab4fbec16d94c64db068d1">Problem::mesh_pt</a>() = </div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  <span class="keyword">new</span> OneDLagrangianMesh&lt;HermiteBeamElement&gt;(n_elem,length,<a class="code" href="classElasticBeamProblem.html#a134a789cae77ab61a3e32bd93b28e1fa">Undef_beam_pt</a>);</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160; </div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160; <span class="comment">// Set the boundary conditions: Each end of the beam is fixed in space</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160; <span class="comment">// Loop over the boundaries (ends of the beam)</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160; <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> b=0;b&lt;2;b++)</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  {</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;   <span class="comment">// Pin displacements in both x and y directions</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;   <span class="comment">// [Note: The mesh_pt() function has been overloaded</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;   <span class="comment">//  to return a pointer to the actual mesh, rather than</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;   <span class="comment">//  a pointer to the Mesh base class. The current mesh is derived</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;   <span class="comment">//  from the SolidMesh class. In such meshes, all access functions</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;   <span class="comment">//  to the nodes, such as boundary_node_pt(...), are overloaded</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;   <span class="comment">//  to return pointers to SolidNodes (whose position can be</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;   <span class="comment">//  pinned) rather than &quot;normal&quot; Nodes.]</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;   <a class="code" href="classElasticBeamProblem.html#ae7d14ba8bec2325a82cbeed0c1b29910">mesh_pt</a>()-&gt;boundary_node_pt(b,0)-&gt;pin_position(0); </div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;   <a class="code" href="classElasticBeamProblem.html#ae7d14ba8bec2325a82cbeed0c1b29910">mesh_pt</a>()-&gt;boundary_node_pt(b,0)-&gt;pin_position(1); </div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  }</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160; </div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160; <span class="comment">//Find number of elements in the mesh</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160; <span class="keywordtype">unsigned</span> n_element = <a class="code" href="classElasticBeamProblem.html#ae7d14ba8bec2325a82cbeed0c1b29910">mesh_pt</a>()-&gt;nelement();</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160; </div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160; <span class="comment">//Loop over the elements to set physical parameters etc.</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160; <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> e=0;e&lt;n_element;e++)</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  {</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;   <span class="comment">// Upcast to the specific element type</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;   HermiteBeamElement *elem_pt = </div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <span class="keyword">dynamic_cast&lt;</span>HermiteBeamElement*<span class="keyword">&gt;</span>(<a class="code" href="classElasticBeamProblem.html#ae7d14ba8bec2325a82cbeed0c1b29910">mesh_pt</a>()-&gt;element_pt(e));</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;   </div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;   <span class="comment">// Set physical parameters for each element:</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;   elem_pt-&gt;sigma0_pt() = &amp;<a class="code" href="namespaceGlobal__Physical__Variables.html#a417dc688a70c4f06ef0faed047068ba2">Global_Physical_Variables::Sigma0</a>;</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;   elem_pt-&gt;h_pt() = &amp;<a class="code" href="namespaceGlobal__Physical__Variables.html#af6e07423e22c0991084d9a2f43727805">Global_Physical_Variables::H</a>;</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160; </div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;   <span class="comment">// Set the load Vector for each element</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;   elem_pt-&gt;load_vector_fct_pt() = &amp;<a class="code" href="namespaceGlobal__Physical__Variables.html#a321267e1efb30b5d586302509354fb07">Global_Physical_Variables::load</a>;</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160; </div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;   <span class="comment">// Set the undeformed shape for each element</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;   elem_pt-&gt;undeformed_beam_pt() = <a class="code" href="classElasticBeamProblem.html#a134a789cae77ab61a3e32bd93b28e1fa">Undef_beam_pt</a>;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;  } <span class="comment">// end of loop over elements</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160; </div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160; <span class="comment">// Choose node at which displacement is documented (halfway along -- provided</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160; <span class="comment">// we have an odd number of nodes; complain if this is not the</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160; <span class="comment">// case because the comparison with the exact solution will be wrong </span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160; <span class="comment">// otherwise!)</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160; <span class="keywordtype">unsigned</span> n_nod=<a class="code" href="classElasticBeamProblem.html#ae7d14ba8bec2325a82cbeed0c1b29910">mesh_pt</a>()-&gt;nnode();</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160; <span class="keywordflow">if</span> (n_nod%2!=1)</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  {</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;   cout &lt;&lt; <span class="stringliteral">&quot;Warning: Even number of nodes &quot;</span> &lt;&lt; n_nod &lt;&lt; std::endl;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;   cout &lt;&lt; <span class="stringliteral">&quot;Comparison with exact solution will be misleading...&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;  }</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160; <a class="code" href="classElasticBeamProblem.html#a9c96cab7e71243e51f7c4040a84cdd5d">Doc_node_pt</a>=<a class="code" href="classElasticBeamProblem.html#ae7d14ba8bec2325a82cbeed0c1b29910">mesh_pt</a>()-&gt;node_pt((n_nod+1)/2-1);</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160; </div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160; <span class="comment">// Assign the global and local equation numbers</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160; cout &lt;&lt; <span class="stringliteral">&quot;# of dofs &quot;</span> &lt;&lt; assign_eqn_numbers() &lt;&lt; std::endl;</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160; </div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;} <span class="comment">// end of constructor</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160; </div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160; </div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="comment">//=======start_of_parameter_study==========================================</span><span class="comment"></span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="comment">/// Solver loop to perform parameter study</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="comment"></span><span class="comment">//=========================================================================</span></div>
<div class="line"><a name="l00172"></a><span class="lineno"><a class="line" href="classElasticBeamProblem.html#a2da3cb02ce953da67fb27742e20774a5">  172</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classElasticBeamProblem.html#a2da3cb02ce953da67fb27742e20774a5">ElasticBeamProblem::parameter_study</a>()</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;{</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160; <span class="comment">// Over-ride the default maximum value for the residuals</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160; Problem::Max_residuals = 1.0e10;</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160; </div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160; <span class="comment">// Set the increments in control parameters</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160; <span class="keywordtype">double</span> <a class="code" href="tensioned__string_8txt.html#a7cf04bcca51c3cfd9e74200fb6c25b1d">pext_increment</a> = 0.001;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160; </div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160; <span class="comment">// Set initial values for control parameters </span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160; <a class="code" href="namespaceGlobal__Physical__Variables.html#a0406c0cbd463d1df2458fe5de98a00eb">Global_Physical_Variables::P_ext</a> = 0.0 - <a class="code" href="tensioned__string_8txt.html#a7cf04bcca51c3cfd9e74200fb6c25b1d">pext_increment</a>;</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160; </div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160; <span class="comment">// Create label for output</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160; DocInfo doc_info;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160; </div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160; <span class="comment">// Set output directory -- this function checks if the output</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160; <span class="comment">// directory exists and issues a warning if it doesn&#39;t.</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160; doc_info.set_directory(<span class="stringliteral">&quot;RESLT&quot;</span>);</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160; </div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160; <span class="comment">// Open a trace file</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160; ofstream trace(<span class="stringliteral">&quot;RESLT/trace_beam.dat&quot;</span>);</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160; </div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160; <span class="comment">// Write a header for the trace file</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160; trace &lt;&lt; </div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;  <span class="stringliteral">&quot;VARIABLES=\&quot;p_e_x_t\&quot;,\&quot;d\&quot;&quot;</span> &lt;&lt; </div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;  <span class="stringliteral">&quot;, \&quot;p_e_x_t_(_e_x_a_c_t_)\&quot;&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160; </div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160; <span class="comment">// Output file stream used for writing results</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160; ofstream file;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160; <span class="comment">// String used for the filename</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160; <span class="keywordtype">char</span> filename[100]; </div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160; </div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160; <span class="comment">// Loop over parameter increments</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160; <span class="keywordtype">unsigned</span> nstep=10;</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160; <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i=1;i&lt;=nstep;i++)</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;  {</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;   <span class="comment">// Increment pressure</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;   <a class="code" href="namespaceGlobal__Physical__Variables.html#a0406c0cbd463d1df2458fe5de98a00eb">Global_Physical_Variables::P_ext</a> += <a class="code" href="tensioned__string_8txt.html#a7cf04bcca51c3cfd9e74200fb6c25b1d">pext_increment</a>;</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;   </div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;   <span class="comment">// Solve the system</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;   newton_solve();</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    </div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;   <span class="comment">// Calculate exact solution for `string under tension&#39; (applicable for</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;   <span class="comment">// small wall thickness and pinned ends)</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160; </div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;   <span class="comment">// The tangent of the angle beta</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;   <span class="keywordtype">double</span> tanbeta =-2.0*<a class="code" href="classElasticBeamProblem.html#a9c96cab7e71243e51f7c4040a84cdd5d">Doc_node_pt</a>-&gt;x(1)/<a class="code" href="classElasticBeamProblem.html#aa68b1c77e0aa1571fe956d62bd8cf096">Length</a>;</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160; </div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;   <span class="keywordtype">double</span> exact_pressure = 0.0;</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;   <span class="comment">//If the beam has deformed, calculate the pressure required</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;   <span class="keywordflow">if</span>(tanbeta!=0)</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    {</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;      </div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;      <span class="comment">//Calculate the opening angle alpha</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;      <span class="keywordtype">double</span> alpha = 2.0*atan(2.0*tanbeta/(1.0-tanbeta*tanbeta));</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160; </div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;      <span class="comment">// Jump back onto the main branch if alpha&gt;180 degrees</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;      <span class="keywordflow">if</span> (alpha&lt;0) alpha+=2.0*MathematicalConstants::Pi;</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160; </div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;     <span class="comment">// Green strain:</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;     <span class="keywordtype">double</span> gamma=0.5*(0.25*alpha*alpha/(sin(0.5*alpha)*sin(0.5*alpha))-1.0);</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160; </div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;     <span class="comment">//Calculate the exact pressure</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;     exact_pressure=<a class="code" href="namespaceGlobal__Physical__Variables.html#af6e07423e22c0991084d9a2f43727805">Global_Physical_Variables::H</a>*</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;      (<a class="code" href="namespaceGlobal__Physical__Variables.html#a417dc688a70c4f06ef0faed047068ba2">Global_Physical_Variables::Sigma0</a>+gamma)*alpha/<a class="code" href="classElasticBeamProblem.html#aa68b1c77e0aa1571fe956d62bd8cf096">Length</a>;</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    } </div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;   </div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;   <span class="comment">// Document the solution</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;   sprintf(filename,<span class="stringliteral">&quot;RESLT/beam%i.dat&quot;</span>,i);</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;   file.open(filename);</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;   <a class="code" href="classElasticBeamProblem.html#ae7d14ba8bec2325a82cbeed0c1b29910">mesh_pt</a>()-&gt;output(file,5);</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;   file.close();</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;   </div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;   <span class="comment">// Write trace file: Pressure, displacement and exact solution</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;   <span class="comment">// (for string under tension)</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;   trace &lt;&lt; <a class="code" href="namespaceGlobal__Physical__Variables.html#a0406c0cbd463d1df2458fe5de98a00eb">Global_Physical_Variables::P_ext</a>  &lt;&lt; <span class="stringliteral">&quot; &quot;</span> </div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;         &lt;&lt; abs(<a class="code" href="classElasticBeamProblem.html#a9c96cab7e71243e51f7c4040a84cdd5d">Doc_node_pt</a>-&gt;x(1))</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;         &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; exact_pressure </div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;         &lt;&lt; std::endl;</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;  }</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160; </div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;} <span class="comment">// end of parameter study</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160; </div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;<span class="comment">//========start_of_main================================================</span><span class="comment"></span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;<span class="comment">/// Driver for beam (string under tension) test problem </span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;<span class="comment"></span><span class="comment">//=====================================================================</span></div>
<div class="line"><a name="l00257"></a><span class="lineno"><a class="line" href="tensioned__string_8cc.html#ae66f6b31b5ad750f1fe042a706a4e3d4">  257</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="tensioned__string_8cc.html#ae66f6b31b5ad750f1fe042a706a4e3d4">main</a>()</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;{</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160; </div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160; <span class="comment">// Set the non-dimensional thickness </span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160; <a class="code" href="namespaceGlobal__Physical__Variables.html#af6e07423e22c0991084d9a2f43727805">Global_Physical_Variables::H</a>=0.01; </div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160; </div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160; <span class="comment">// Set the 2nd Piola Kirchhoff prestress</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160; <a class="code" href="namespaceGlobal__Physical__Variables.html#a417dc688a70c4f06ef0faed047068ba2">Global_Physical_Variables::Sigma0</a>=0.1; </div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160; </div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160; <span class="comment">// Set the length of domain</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160; <span class="keywordtype">double</span> L = 10.0;</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160; </div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160; <span class="comment">// Number of elements (choose an even number if you want the control point </span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160; <span class="comment">// to be located at the centre of the beam)</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160; <span class="keywordtype">unsigned</span> n_element = 10;</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160; </div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160; <span class="comment">// Construst the problem</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160; <a class="code" href="classElasticBeamProblem.html">ElasticBeamProblem</a> <a class="code" href="tensioned__string_8txt.html#a1ce091cd301555b09a13f3432beaf2fd">problem</a>(n_element,L);</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160; </div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160; <span class="comment">// Check that we&#39;re ready to go:</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160; cout &lt;&lt; <span class="stringliteral">&quot;\n\n\nProblem self-test &quot;</span>;</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160; <span class="keywordflow">if</span> (<a class="code" href="tensioned__string_8txt.html#a1ce091cd301555b09a13f3432beaf2fd">problem</a>.self_test()==0) </div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;  {</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;   cout &lt;&lt; <span class="stringliteral">&quot;passed: Problem can be solved.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;  }</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160; <span class="keywordflow">else</span> </div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;  {</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;   <span class="keywordflow">throw</span> OomphLibError(<span class="stringliteral">&quot;Self test failed&quot;</span>,</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;                       OOMPH_CURRENT_FUNCTION,</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;                       OOMPH_EXCEPTION_LOCATION);</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;  }</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160; </div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160; <span class="comment">// Conduct parameter study</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160; <a class="code" href="tensioned__string_8txt.html#a1ce091cd301555b09a13f3432beaf2fd">problem</a>.parameter_study();</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160; </div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;} <span class="comment">// end of main</span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160; </div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="aclassElasticBeamProblem_html_a9c96cab7e71243e51f7c4040a84cdd5d"><div class="ttname"><a href="classElasticBeamProblem.html#a9c96cab7e71243e51f7c4040a84cdd5d">ElasticBeamProblem::Doc_node_pt</a></div><div class="ttdeci">Node * Doc_node_pt</div><div class="ttdoc">Pointer to the node whose displacement is documented.</div><div class="ttdef"><b>Definition:</b> <a href="tensioned__string_8cc_source.html#l00088">tensioned_string.cc:88</a></div></div>
<div class="ttc" id="anamespaceGlobal__Physical__Variables_html_a0406c0cbd463d1df2458fe5de98a00eb"><div class="ttname"><a href="namespaceGlobal__Physical__Variables.html#a0406c0cbd463d1df2458fe5de98a00eb">Global_Physical_Variables::P_ext</a></div><div class="ttdeci">double P_ext</div><div class="ttdoc">Pressure load.</div><div class="ttdef"><b>Definition:</b> <a href="tensioned__string_8cc_source.html#l00049">tensioned_string.cc:49</a></div></div>
<div class="ttc" id="aclassElasticBeamProblem_html_aa68b1c77e0aa1571fe956d62bd8cf096"><div class="ttname"><a href="classElasticBeamProblem.html#aa68b1c77e0aa1571fe956d62bd8cf096">ElasticBeamProblem::Length</a></div><div class="ttdeci">double Length</div><div class="ttdoc">Length of domain (in terms of the Lagrangian coordinates)</div><div class="ttdef"><b>Definition:</b> <a href="tensioned__string_8cc_source.html#l00091">tensioned_string.cc:91</a></div></div>
<div class="ttc" id="aclassElasticBeamProblem_html_a1c62c2a14c9a5528a649700d16dac2ea"><div class="ttname"><a href="classElasticBeamProblem.html#a1c62c2a14c9a5528a649700d16dac2ea">ElasticBeamProblem::ElasticBeamProblem</a></div><div class="ttdeci">ElasticBeamProblem(const unsigned &amp;n_elem, const double &amp;length)</div><div class="ttdoc">Constructor: The arguments are the number of elements, the length of domain.</div><div class="ttdef"><b>Definition:</b> <a href="tensioned__string_8cc_source.html#l00102">tensioned_string.cc:102</a></div></div>
<div class="ttc" id="anamespaceGlobal__Physical__Variables_html_a321267e1efb30b5d586302509354fb07"><div class="ttname"><a href="namespaceGlobal__Physical__Variables.html#a321267e1efb30b5d586302509354fb07">Global_Physical_Variables::load</a></div><div class="ttdeci">void load(const Vector&lt; double &gt; &amp;xi, const Vector&lt; double &gt; &amp;x, const Vector&lt; double &gt; &amp;N, Vector&lt; double &gt; &amp;load)</div><div class="ttdoc">Load function: Apply a constant external pressure to the beam.</div><div class="ttdef"><b>Definition:</b> <a href="tensioned__string_8cc_source.html#l00052">tensioned_string.cc:52</a></div></div>
<div class="ttc" id="aclassElasticBeamProblem_html_a30dde8d0101a3d3994965d6e560cb585"><div class="ttname"><a href="classElasticBeamProblem.html#a30dde8d0101a3d3994965d6e560cb585">ElasticBeamProblem::actions_after_newton_solve</a></div><div class="ttdeci">void actions_after_newton_solve()</div><div class="ttdoc">No actions need to be performed after a solve.</div><div class="ttdef"><b>Definition:</b> <a href="tensioned__string_8cc_source.html#l00080">tensioned_string.cc:80</a></div></div>
<div class="ttc" id="aclassElasticBeamProblem_html_ae7d14ba8bec2325a82cbeed0c1b29910"><div class="ttname"><a href="classElasticBeamProblem.html#ae7d14ba8bec2325a82cbeed0c1b29910">ElasticBeamProblem::mesh_pt</a></div><div class="ttdeci">OneDLagrangianMesh&lt; HermiteBeamElement &gt; * mesh_pt()</div><div class="ttdoc">Return pointer to the mesh.</div><div class="ttdef"><b>Definition:</b> <a href="tensioned__string_8cc_source.html#l00075">tensioned_string.cc:75</a></div></div>
<div class="ttc" id="aclassElasticBeamProblem_html"><div class="ttname"><a href="classElasticBeamProblem.html">ElasticBeamProblem</a></div><div class="ttdoc">Beam problem object.</div><div class="ttdef"><b>Definition:</b> <a href="tensioned__string_8cc_source.html#l00063">tensioned_string.cc:63</a></div></div>
<div class="ttc" id="aclassElasticBeamProblem_html_a2da3cb02ce953da67fb27742e20774a5"><div class="ttname"><a href="classElasticBeamProblem.html#a2da3cb02ce953da67fb27742e20774a5">ElasticBeamProblem::parameter_study</a></div><div class="ttdeci">void parameter_study()</div><div class="ttdoc">Conduct a parameter study.</div><div class="ttdef"><b>Definition:</b> <a href="tensioned__string_8cc_source.html#l00172">tensioned_string.cc:172</a></div></div>
<div class="ttc" id="anamespaceGlobal__Physical__Variables_html_a417dc688a70c4f06ef0faed047068ba2"><div class="ttname"><a href="namespaceGlobal__Physical__Variables.html#a417dc688a70c4f06ef0faed047068ba2">Global_Physical_Variables::Sigma0</a></div><div class="ttdeci">double Sigma0</div><div class="ttdoc">2nd Piola Kirchhoff pre-stress</div><div class="ttdef"><b>Definition:</b> <a href="tensioned__string_8cc_source.html#l00046">tensioned_string.cc:46</a></div></div>
<div class="ttc" id="atensioned__string_8cc_html_ae66f6b31b5ad750f1fe042a706a4e3d4"><div class="ttname"><a href="tensioned__string_8cc.html#ae66f6b31b5ad750f1fe042a706a4e3d4">main</a></div><div class="ttdeci">int main()</div><div class="ttdoc">Driver for beam (string under tension) test problem.</div><div class="ttdef"><b>Definition:</b> <a href="tensioned__string_8cc_source.html#l00257">tensioned_string.cc:257</a></div></div>
<div class="ttc" id="atensioned__string_8txt_html_a1ce091cd301555b09a13f3432beaf2fd"><div class="ttname"><a href="tensioned__string_8txt.html#a1ce091cd301555b09a13f3432beaf2fd">problem</a></div><div class="ttdeci">mainpage Demo problem</div><div class="ttdef"><b>Definition:</b> <a href="tensioned__string_8txt_source.html#l00001">tensioned_string.txt:1</a></div></div>
<div class="ttc" id="aclassElasticBeamProblem_html_a5b534c11d9b1d54123bf587aad5f98f6"><div class="ttname"><a href="classElasticBeamProblem.html#a5b534c11d9b1d54123bf587aad5f98f6">ElasticBeamProblem::actions_before_newton_solve</a></div><div class="ttdeci">void actions_before_newton_solve()</div><div class="ttdoc">No actions need to be performed before a solve.</div><div class="ttdef"><b>Definition:</b> <a href="tensioned__string_8cc_source.html#l00083">tensioned_string.cc:83</a></div></div>
<div class="ttc" id="aclassElasticBeamProblem_html_a134a789cae77ab61a3e32bd93b28e1fa"><div class="ttname"><a href="classElasticBeamProblem.html#a134a789cae77ab61a3e32bd93b28e1fa">ElasticBeamProblem::Undef_beam_pt</a></div><div class="ttdeci">GeomObject * Undef_beam_pt</div><div class="ttdoc">Pointer to geometric object that represents the beam's undeformed shape.</div><div class="ttdef"><b>Definition:</b> <a href="tensioned__string_8cc_source.html#l00094">tensioned_string.cc:94</a></div></div>
<div class="ttc" id="atensioned__string_8txt_html_a0f5aaa7d7eab4fbec16d94c64db068d1"><div class="ttname"><a href="tensioned__string_8txt.html#a0f5aaa7d7eab4fbec16d94c64db068d1">mesh_pt</a></div><div class="ttdeci">and the pressure f as well as the function c and the unit normal to the deformed L f The c GeomObject pointed to by c provides a parametrisation of the beam s undeformed shape in the form and this is used to determine the nodes s initial Eulerian position Next we pin the nodal positions on both boundaries skipline Set the until We then loop over the elements and set the pointers to the physical the function pointer to the load and the pointer to the geometric object that specifies the undeformed beam shape skipline Loop until end of loop over elements We choose a node near the centre of the beam to monitor the we assign the equation numbers skipline Assign until end of&lt; HR &gt;&lt; HR &gt; section param The Parameter Study The function computing the beam s deformation for a range of external pressures During the solution of this particular the maximum residual in the Newton iteration can be greater than the default maximum value of We increase the default value by assigning a(much) larger value to \c Problem this requires the insertion of the statement code mesh_pt() -&gt; boundary_node_pt(b, 0) -&gt;pin_position(1, 1)</div></div>
<div class="ttc" id="atensioned__string_8txt_html_a7cf04bcca51c3cfd9e74200fb6c25b1d"><div class="ttname"><a href="tensioned__string_8txt.html#a7cf04bcca51c3cfd9e74200fb6c25b1d">pext_increment</a></div><div class="ttdeci">endcode in the loop in the c Problem constructor You will have to adjust the number of elements to fully resolve the bending boundary layers provides an implementation of the Newton which has the attractive feature that it converges quadratically provided a good initial guess for the solution is available Good initial guesses can as in the above example where we started with a known f we used the computed solution as the initial guess for the solution at a slightly larger f etc If the increase in the the Newton method will diverge To avoid unnecessary the Newton iteration is terminated which has a default value of in the problem considered the undeformed beam provides a poor approximation of its equilibrium shape at the first pressure value The Newton method still even though the initial maximum residual has a relatively large value of Here are some exercises that explore the convergence characteristics of the Newton c pext_increment</div><div class="ttdef"><b>Definition:</b> <a href="tensioned__string_8txt_source.html#l00706">tensioned_string.txt:706</a></div></div>
<div class="ttc" id="anamespaceGlobal__Physical__Variables_html_af6e07423e22c0991084d9a2f43727805"><div class="ttname"><a href="namespaceGlobal__Physical__Variables.html#af6e07423e22c0991084d9a2f43727805">Global_Physical_Variables::H</a></div><div class="ttdeci">double H</div><div class="ttdoc">Non-dimensional thickness.</div><div class="ttdef"><b>Definition:</b> <a href="tensioned__string_8cc_source.html#l00043">tensioned_string.cc:43</a></div></div>
<div class="ttc" id="anamespaceGlobal__Physical__Variables_html"><div class="ttname"><a href="namespaceGlobal__Physical__Variables.html">Global_Physical_Variables</a></div><div class="ttdoc">Namespace for physical parameters.</div><div class="ttdef"><b>Definition:</b> <a href="tensioned__string_8cc_source.html#l00040">tensioned_string.cc:40</a></div></div>

    <!-- jQuery for Bootstrap and Doxygen -->
    <script src="../../../js/jquery-1.12.0.min.js"></script>
    <!-- Minified boostrap plugins-->
    <script src="../../../js/bootstrap.js"></script>
    <!-- Doxygen dependency to add powertips to source code-->
    <script src="../../../js/jquery.powertip.min.js"></script>
    <!-- The  following script is generated by doxygen and hides/shows levels in 
         the data structure lists and adds powertips to source code-->
    <script src="../../../js/dynsections.js" ></script>
    <!-- add to Doxygen's class names so bootstrap css and js recognises them-->
    <script type="text/javascript">
    $(".contents").addClass("container");
    $(".header").addClass("container");
    $(".navpath").addClass("container");
    $("#navrow3").addClass("container");
    $("#navrow4").addClass("container");
    $(".mlabel").addClass("label");
    $(".mlabel").addClass("label-default");
    $(".memitem").addClass("panel");
    $(".memitem").addClass("panel-info");
    $(".memproto").addClass("panel-heading");
    $(".memdoc").addClass("panel-body");
    </script>
    <footer>
      <div class="container">
        <div class="text-muted" style="float:right;">Generated by <a href="http://www.doxygen.org/index.html">
          <img style="height:18px;" class="footer-img" src="doxygen.png" alt="doxygen"></a> on Fri Jul 9 2021 15:20:38
        </div>
      </div>
    </footer>
</body>
</html>

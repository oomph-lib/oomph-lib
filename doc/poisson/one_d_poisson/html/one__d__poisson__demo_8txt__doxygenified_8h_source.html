<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
<title>oomph-lib: one_d_poisson_demo.txt_doxygenified.h Source File</title>
<link rel="apple-touch-icon" sizes="57x57" href="../../../figures/apple-touch-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="../../../figures/apple-touch-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="../../../figures/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="../../../figures/apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="../../../figures/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="../../../figures/apple-touch-icon-120x120.png">
<link rel="icon" type="image/png" href="../../../figures/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="../../../figures/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="../../../figures/favicon-16x16.png" sizes="16x16">
<link rel="manifest" href="../../../figures/manifest.json">
<link rel="mask-icon" href="../../../figures/safari-pinned-tab.svg" color="#008000">
<link rel="shortcut icon" href="../../../figures/favicon.ico">
<meta name="msapplication-TileColor" content="#00a300">
<meta name="msapplication-config" content="../../../figures/browserconfig.xml">
<meta name="theme-color" content="#008000">
<link href="http://fonts.googleapis.com/css?family=Open+Sans:400,300,600" rel="stylesheet" type="text/css">
<!-- Doxygen css-->
<!-- <link rel="stylesheet" type="text/css" href="doxygen.css"> -->
<!-- Bootstrap -->
<link href="../../../css/bootstrap.css" rel="stylesheet">
<!-- oomph-lib specific overrides -->
<link rel="stylesheet" type="text/css" href="../../../css/oomph_header.css">
</head>
<body>
<nav class="navbar navbar-default">
<div class="container">
<div class="container-fluid">
  <!-- Brand and toggle get grouped for better mobile display -->
  <div class="navbar-header">
    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
      <span class="sr-only">Toggle navigation</span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="../../../html/index.html"><img alt="oomph-lib" src="../../../figures/oomph_logo.png"></a>
  </div>
  <!-- Collect the nav links, forms, and other content for toggling -->
  <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
    <ul class="nav navbar-nav">          
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Documentation <span class="caret"></span></a>
        <ul class="dropdown-menu">
          <li class="dropdown-header">Big picture</li>
          <li><a href="../../../../doc/intro/html/index.html">The finite element method</a></li>
          <li><a href="../../../../doc/the_data_structure/html/index.html">The data structure</a></li>
          <li><a href="../../../../doc/quick_guide/html/index.html">Not-so-quick guide</a></li>
          <li><a href="../../../../doc/optimisation/html/index.html">Optimisation</a></li>
          <li><a href="../../../../doc/order_of_action_functions/html/index.html">Order of action functions</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Example codes and tutorials</li>
          <li><a href="../../../../doc/example_code_list/html/index.html">List of example codes and tutorials</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#meshes">Meshing</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#solvers">Solvers</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#parallel">MPI parallel processing</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#visualisation">Post-processing/visualisation</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Other</li>
          <li><a href="../../../../doc/change_log/html/index.html">Change log</a></li>
          <li><a href="../../../../doc/creating_doc/html/index.html">Creating documentation</a></li>
          <li><a href="../../../../doc/coding_conventions/html/index.html">Coding conventions</a></li>
          <li><a href="../../../../doc/index/html/index.html">Index</a></li>
          <li><a href="../../../../doc/FAQ/html/index.html">FAQ</a></li>
        </ul>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Get it <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../../doc/the_distribution/html/index.html">Installation guide</a></li>
            <li><a href="../../../../doc/subversion/html/index.html">Get code from subversion repository</a></li>
            <li><a href="../../../../doc/download/html/index.html">Get code as tar file</a></li>
            <li><a href="../../../../doc/copyright/html/index.html">Copyright</a></li>
          </ul>
        </li>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">About <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../../doc/people/html/index.html">People</a></li>            
            <li><a href="../../../../doc/contact/html/index.html">Contact/Get involved</a></li>
            <li><a href="../../../../doc/publications/html/index.html">Publications</a></li>
            <li><a href="../../../../doc/acknowledgements/html/index.html">Acknowledgements</a></li>
            <li><a href="../../../../doc/picture_show/index.html">Picture show</a></li>
          </ul>
        </li>
      </li>
    </ul>
    <ul class="nav navbar-nav navbar-right navbar-search">
      <form class="navbar-form" role="search" action="../../../../doc/search_results/html/index.html">
        <div class="input-group">
          <input type="text" class="form-control" placeholder="Search" name="q">
          <span class="input-group-btn">
            <button class="btn btn-default" type="submit">Go</button>
          </span>
        </div><!-- /input-group -->
       <!--<div class="form-group">
          <input type="text" class="form-control" placeholder="Search">
        </div>
        <button type="submit" class="btn btn-default">Submit</button>-->
      </form>
    </ul>
  </div><!-- /.navbar-collapse -->
</div><!-- /.container-fluid -->
</div>
</nav>
<!-- Generated by Doxygen 1.8.17 -->
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">one_d_poisson_demo.txt_doxygenified.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="one__d__poisson__demo_8txt__doxygenified_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">\mainpage Demo problem: A one-dimensional Poisson problem</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">In this document, we demonstrate how a solve the 1D Poisson problem</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">using existing objects from the \c oomph-lib library:</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">&lt;CENTER&gt;</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">&lt;TABLE&gt;  </span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">&lt;TR&gt; </span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">&lt;TD&gt;  </span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">&lt;CENTER&gt;</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">&lt;B&gt;One-dimensional model Poisson problem&lt;/B&gt;</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">&lt;/CENTER&gt; </span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">Solve</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">\frac{\mbox{d}^2u}{\mbox{d}x^2} = f(x),</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment"> \ \ \ \ \ \ \ \ \ \ (1)</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">in a one-dimensional domain \f$ x\in[0,1] \f$, with boundary conditions </span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">u(0)=u_0 \ \mbox{\ \ \ and \ \ \ } \ \ u(1)=u_1, </span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">\ \ \ \ \ \ \ \ \ \ (2)</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">where \f$ u_0 \f$ and \f$ u_1 \f$  are given.</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">&lt;/TD&gt;</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">&lt;/TR&gt;</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">&lt;/TABLE&gt;  </span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">&lt;/CENTER&gt;</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment">We provide a detailed discussion of the driver code </span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">&lt;A HREF=&quot;../../../../demo_drivers/poisson/one_d_poisson/one_d_poisson.cc&quot;&gt;</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment">one_d_poisson.cc&lt;/A&gt; which solves the </span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment">problem for the specific source function</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment">f(x) = \pm 30 \sin(\sqrt{30} x),  \ \ \ \  (3)</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment">and boundary conditions</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment">u_0= 0; \ \ \  u_1 = \mp 1.</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment">In this case, the problem has the (fish-shaped) exact solution</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment">u(x) = \pm \left[ \left(\sin(\sqrt{30})-1\right) x - \sin(\sqrt{30} x)\right].</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment">\ \ \ \ \  (4)\f]</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment">\image html one_d_fish.gif &quot;The fish-shaped solution u(x). &quot; </span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment">\image latex one_d_fish.eps &quot;The fish-shaped solution u(x). &quot; width=0.75\textwidth</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment">&lt;HR&gt;   </span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment">\section global Global parameters and functions</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment">Source functions and problem parameters generally need</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment">to be accessible to a variety of \c oomph-lib objects and we </span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment">tend to define such functions/quantities in C++ namespaces.</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment">Here we use the namespace \c FishSolnOneDPoisson to define</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="comment">the source function  (3) and the exact</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment">solution (4). Both functions use the integer value</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment">FishSolnOneDPoisson::Sign, which can be set by the &quot;user&quot; in </span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment">the driver code.</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment">\dontinclude one_d_poisson.cc</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment">\skipline start_of_namespace</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment">\until end of namespace</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="comment">\section main The driver code</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="comment">In order to solve the Poisson problem with \c oomph-lib, </span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="comment">we represent the mathematical</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment">problem defined by equations (1) and (2)</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="comment">in a specific \c Problem object, \c OneDPoissonProblem. </span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="comment">\c oomph-lib provides a variety </span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="comment">of 1D Poisson elements (1D elements with linear, quadratic and cubic</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="comment">representations for the unknown function) and we pass the</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="comment">specific element type as a template parameter to the \c Problem.</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="comment">In the driver code, listed below, we use the \c QPoissonElement&lt;1,4&gt;, </span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="comment">a four-node (cubic) 1D Poisson element. We pass the number of elements in the</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="comment">mesh as the first argument to the \c Problem constructor and the pointer</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment">to the source function, defined in the namespace </span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="comment">\c FishSolnOneDPoisson, as the second.</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="comment">Once the problem has been created, we execute \c Problem::self_test(),</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="comment">which checks that the \c Problem has been properly set up.</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="comment">If this test is passed, we proceed to solve the problem:</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="comment">Initially, we set the sign of the source function (defined in the</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="comment">variable \c FishSolnOneDPoisson::Sign)  to -1 and solve, </span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="comment">using \c oomph-lib&#39;s Newton solver. We write the</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="comment">solution to output files, using the \c OneDPoissonProblem&#39;s </span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="comment">member function \c doc_solution(), discussed below. We then repeat </span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="comment">the process, using a positive sign for the source function.</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="comment">\dontinclude one_d_poisson.cc</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment">\skipline start_of_main</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="comment">\until end of main</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="comment">\section problem The problem class</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="comment">\c oomph-lib driver codes tend to be </span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="comment">very compact and &quot;high-level&quot; because all the &quot;hard work&quot; is done </span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="comment">in the \c Problem specification. For our simple Poisson </span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="comment">problem, this step is completely straightforward:</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="comment">The \c OneDPoissonProblem is derived from \c oomph-lib&#39;s generic</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="comment">\c Problem class and, as discussed above, the specific element</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="comment">type is specified as a template parameter to make it easy for </span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="comment">the &quot;user&quot; to change the element type in the driver code.</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="comment">\dontinclude one_d_poisson.cc</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="comment">\skipline start_of_problem_class</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="comment">\until public Problem</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="comment">The \c OneDPoissonProblemclass has five member functions, only three of which</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="comment">are non-trivial:</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="comment">- the constructor \c OneDPoissonProblem(...)</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="comment">- the function \c actions_before_newton_solve()</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="comment">- the function \c doc_solution(...)</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="comment">.</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="comment">The function \c Problem::actions_after_newton_solve() is a pure</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="comment">virtual member function of the \c Problem base class and must </span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="comment">be provided. However, it is not required in the present problem so</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="comment">we leave it empty. Similarly, the problem destructor can remain</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="comment">empty as all memory de-allocation is handled in the destructor of the </span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="comment">\c Problem base class. The Problem only stores one private data</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="comment">member, the pointer to the source function.</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="comment">\skipline public:</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="comment">\until end of problem class</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="comment"> </span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="comment"> &lt;TABLE&gt;</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="comment"> &lt;TR&gt;</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="comment"> &lt;TD bgcolor=&quot;cornsilk&quot;&gt;</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="comment">&lt;CENTER&gt;&lt;B&gt;\anchor gen_conv A general convention&lt;/B&gt;&lt;/CENTER&gt;</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="comment">The type \c PoissonEquations&lt;1&gt;::PoissonSourceFctPt, used to </span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="comment">define the type of the source function pointer,</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="comment">is a public typedef, defined in \c oomph-lib&#39;s Poisson equation</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="comment">class, as follows:</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="comment">\code</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="comment">[...]</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="comment">public:</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="comment"></span><span class="comment"></span> </div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="comment"> /// \short Function pointer to source function has the form fct(x,f(x)). </span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="comment"> /// Note that x is a Vector! </span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="comment"></span> typedef void (*PoissonSourceFctPt)(const Vector&lt;double&gt;&amp; x, double&amp; f);</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160; </div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;[...]</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160; </div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;\endcode</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160; </div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;This reflects a \b general \b convention in \c oomph-lib: The function types </div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;of source functions etc. that are required by specific elements,</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;are always declared as public types in the element classes. </div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;The logic behind this is that only the element writer/maintainer knows </div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;what type of function (i.e. the type of its arguments and its return </div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;value) a specific element requires.  For instance, the source function </div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;for the Poisson equation requires the spatial coordinate \c x as </div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;input and computes the (scalar) value of the source function.</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;Since the syntax for C++ function pointers is somewhat &quot;non-obvious&quot; </div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;(that&#39;s according to Bjarne Stroustrup, the designer of C++,</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;himself!), we use typedefs to give the function pointers more</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;intuitive names. Since the typedefs are public, they can be used</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;anywhere in the &quot;user&#39;s&quot; code.</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160; </div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160; While we&#39;re at it, here&#39;s \b another</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;\b convention: If an \c oomph-lib function has input and output</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;arguments in its argument list, the input arguments appear first</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;(and are usually passed as constant references), while the output</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;arguments appear last (and are passed as references).</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;&lt;/TD&gt;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;&lt;/TR&gt;</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;&lt;/TABLE&gt;</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160; </div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;&lt;HR&gt;</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;&lt;HR&gt;</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160; </div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;\section constructor The Problem constructor</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;In the \c Problem constructor, we define the domain length and </div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;build a \c  Mesh, using \c oomph-lib&#39;s \c OneDMesh object</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;which is templated by the element type. The required number of elements and </div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;the domain length are passed as arguments to the \c OneDMesh</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;constructors. The subsequent lines of code </div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;pin the nodal values at the two boundary nodes. Next we pass the </div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;source function pointer to the elements. Finally, we call the generic \c</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;Problem::assign_eqn_numbers() routine which does precisely </div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;what it says...</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160; </div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;\skipline start_of_constructor</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;\until end of constructor</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160; </div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;The cast in the loop over the elements</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;is required because \c Mesh::element_pt(...) returns </div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;a pointer to the element base class \c GeneralisedElement, which does not </div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;have an access function to the Poisson element&#39;s source function pointer.</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160; </div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160; &lt;TABLE&gt;</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160; &lt;TR&gt;</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160; &lt;TD bgcolor=&quot;cornsilk&quot;&gt;</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;&lt;CENTER&gt;&lt;B&gt;\anchor const_conv A general convention&lt;/B&gt;&lt;/CENTER&gt; </div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160; It might seem more natural to pass</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;essential parameters (such as the Poisson element&#39;s source function </div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;pointer) to an element when the element is created. If we </div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;made the source function pointer an argument of the element constructor,</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;we would not have to execute this loop in the constructor.</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160; </div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;However, \c oomph-lib employs a general \b convention </div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;that element constructors should not have any arguments.</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;This is because  elements are usually created</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;by the \c Mesh constructor. To </div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;allow \c Meshes that were originally developed for one particular </div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;element type (e.g. a quadrilateral Poisson element) to be used with</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;other elements of same geometry (e.g. a quadrilateral Navier-Stokes </div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;element), \c Mesh objects are usually templated by the </div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;element type. The \c Mesh constructor creates elements </div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;by calling the element&#39;s default (argument-free!) </div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;constructor. If we were to set any element-specific arguments via arguments</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;to the element constructor it would be impossible to re-use the</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;\c Mesh with other element types -- Navier-Stokes elements, for instance, do</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;not have a source function pointer. The actions performed in</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;this loop are therefore</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;fairly typical as most non-trivial elements need to be passed</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;some additional information to become fully functional.</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160; </div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;&lt;/TD&gt; </div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;&lt;/TR&gt;</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;&lt;/TABLE&gt;</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160; </div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;&lt;HR&gt;</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;&lt;HR&gt;</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160; </div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;\section actions_before &quot;Actions before solve&quot; </div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;The pure virtual function \c Problem::actions_before_newton_solve() must</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;be implemented for all specific \c Problems and, as the name</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;suggests, should perform any actions that need to be performed</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;before the system of equations is solved. In the current problem,</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;we use \c Problem::actions_before_newton_solve() to update the boundary </div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;conditions in response to possible changes in the sign of the source function.</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;We use the exact solution (specified in the namespace \c FishSolnOneDPoisson)</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;to determine the boundary values that are appropriate for the sign </div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;specified in \c FishSolnOneDPoisson::Sign.</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160; </div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;\skipline start_of_actions_before_newton_solve</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;\until end of actions before solve</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160; </div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160; </div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160; </div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;&lt;HR&gt;</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;&lt;HR&gt;</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160; </div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160; </div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;\section doc Post-processing</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;The function \c doc_solution(...) writes the FE solution and the corresponding </div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;exact solution, defined in \c FishSolnOneDPoisson::get_exact_u(...)</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;to disk. The argument \c label is used to add identifiers </div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;to the output file names. Note that all output functions</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;are implemented in the generic \c Mesh class: </div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;- The function \c Mesh::output(...) executes the \c </div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;  FiniteElement::output(...) function for each</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;  element in a mesh. For 1D Poisson elements, this function</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;  writes the values of \f$ x \f$ and  \f$ u(x) \f$ at \c npts uniformly spaced</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;  points in the element to the specified file. </div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;- The function \c Mesh::output_fct(...) plots the function specified</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;  by the function pointer in its last argument at the specified</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;  number of points in each of the constituent elements. This allows</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;  point-by-point comparisons between exact and FE solutions. Here</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;  we plot the exact solution at a larger number of points to ensure</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;  that the exact solution looks smooth even if only a small number of</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;  elements are used for the discretisation of the ODE.</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;.</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;Finally, we call the function \c Mesh::compute_error(...)</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;which determines the square of the L2 error, based on the</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;difference between the exact solution (specified by a function</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;pointer) and the FE solution. We also plot the pointwise error</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;in the specified output file.</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160; </div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;\skipline start_of_doc</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;\until end of doc</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160; </div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160; </div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;&lt;HR&gt;</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;&lt;HR&gt;</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160; </div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160; </div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;\section exercises Exercises</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;-# Run the code with different numbers of elements. </div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;   How does the error between the exact and the analytical solution </div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;   change? </div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;-# Compare the error obtained with different element types --</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;   replace the four-node Poisson element, \c QPoissonElement&lt;1,4&gt;,</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;   by its lower-order counterparts   \c QPoissonElement&lt;1,3&gt; and</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;   \c QPoissonElement&lt;1,2&gt;.</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;-# The fish-shaped exact solution (4) is fairly smooth.</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;   Postulate a more rapidly varying &quot;exact&quot; solution, such as</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;   \f[</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;   u(x) = \tanh\left[\alpha \left(x-\frac{1}{2}\right)\right]</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;   \f]</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;   which produces a &quot;step&quot; at \f$ x=1/2 \f$ when \f$ \alpha \f$ becomes</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;   sufficiently large. Calculate the source function required for this</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;   function to be an exact solution and implement both functions in another</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;   namespace, \c TanhSolnOneDPoisson, say. Replace the reference</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;   to \c FishSolnOneDPoisson by \c TanhSolnOneDPoisson and repeat </div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;   the above exercises.</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;-# Remove the Dirichlet boundary condition at the left end of the</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;   domain. What do you observe? [We shall return to this question</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;   in &lt;A HREF=&quot;../../../poisson/two_d_poisson_flux_bc/html/index.html&quot;&gt;</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;   another example&lt;/A&gt;</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;   where we discuss the </div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;   &lt;A HREF=&quot;../../../poisson/two_d_poisson_flux_bc/html/index.html&quot;&gt;</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;   application of Neumann-type boundary conditions&lt;/A&gt;.]</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160; </div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160; </div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;&lt;HR&gt;</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;&lt;HR&gt;</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160; </div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;\section sources Source files for this tutorial</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;- The source files for this tutorial are located in the directory:</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;&lt;CENTER&gt;</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;&lt;A HREF=&quot;../../../../demo_drivers/poisson/one_d_poisson/&quot;&gt;</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;demo_drivers/poisson/one_d_poisson/</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;&lt;/A&gt;</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;&lt;/CENTER&gt;</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;- The driver code is: </div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;&lt;CENTER&gt;</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;&lt;A HREF=&quot;../../../../demo_drivers/poisson/one_d_poisson/one_d_poisson.cc&quot;&gt;</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;demo_drivers/poisson/one_d_poisson/one_d_poisson.cc</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;&lt;/A&gt;</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;&lt;/CENTER&gt;</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;.</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160; </div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;&lt;hr&gt;</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;&lt;hr&gt;</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;\section pdf PDF file</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;A &lt;a href=&quot;../latex/refman.pdf&quot;&gt;pdf version&lt;/a&gt; of this document is available.</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;**/</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160; </div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="aone__d__poisson__demo_8txt_html_ab20cc6258aa0030ac20063469028360c"><div class="ttname"><a href="one__d__poisson__demo_8txt.html#ab20cc6258aa0030ac20063469028360c">function</a></div><div class="ttdeci">namespace c FishSolnOneDPoisson as the second Once the problem has been created we execute c which checks that the c Problem has been properly set up If this test is we proceed to solve the we set the sign of the source function(defined in the variable \c FishSolnOneDPoisson::Sign) to -1 and solve</div></div>
<div class="ttc" id="aone__d__poisson__demo_8txt_html_afe62114ddddd2727a0008c5e431c10a0"><div class="ttname"><a href="one__d__poisson__demo_8txt.html#afe62114ddddd2727a0008c5e431c10a0">node</a></div><div class="ttdeci">a four node(cubic) 1D Poisson element. We pass the number of elements in the mesh as the first argument to the \c Problem const ructor and the pointer to the source function</div></div>
<div class="ttc" id="aclassOneDPoissonProblem_html"><div class="ttname"><a href="classOneDPoissonProblem.html">OneDPoissonProblem</a></div><div class="ttdoc">1D Poisson problem in unit interval.</div><div class="ttdef"><b>Definition:</b> <a href="one__d__poisson_8cc_source.html#l00078">one_d_poisson.cc:78</a></div></div>
<div class="ttc" id="anamespaceFishSolnOneDPoisson_html_a108e814ef887ffcc8caa7c65a7d30f06"><div class="ttname"><a href="namespaceFishSolnOneDPoisson.html#a108e814ef887ffcc8caa7c65a7d30f06">FishSolnOneDPoisson::Sign</a></div><div class="ttdeci">int Sign</div><div class="ttdoc">Sign of the source function (- gives the upper half of the fish, + the lower half)</div><div class="ttdef"><b>Definition:</b> <a href="one__d__poisson_8cc_source.html#l00050">one_d_poisson.cc:50</a></div></div>
<div class="ttc" id="aone__d__poisson__demo_8txt_html_a9b7b34b618514bcf94b25189eb9ff143"><div class="ttname"><a href="one__d__poisson__demo_8txt.html#a9b7b34b618514bcf94b25189eb9ff143">C</a></div><div class="ttdeci">endcode This reflects a b general b convention in c oomph are always declared as public types in the element classes The logic behind this is that only the element writer maintainer knows what type of the source function for the Poisson equation requires the spatial coordinate c x as input and computes the designer of C</div><div class="ttdef"><b>Definition:</b> <a href="one__d__poisson__demo_8txt_source.html#l00173">one_d_poisson_demo.txt:173</a></div></div>
<div class="ttc" id="aone__d__poisson__demo_8txt_html_a223fbca71ba57b0429b8ad060dcf1c2f"><div class="ttname"><a href="one__d__poisson__demo_8txt.html#a223fbca71ba57b0429b8ad060dcf1c2f">the</a></div><div class="ttdeci">endcode This reflects a b general b convention in c oomph are always declared as public types in the element classes The logic behind this is that only the element writer maintainer knows what type of the source function for the Poisson equation requires the spatial coordinate c x as input and computes the(scalar) value of the source function. Since the syntax for C++function pointers is somewhat &quot;non-obvious&quot;(that 's according to Bjarne Stroustrup</div></div>
<div class="ttc" id="aone__d__poisson__demo_8txt_html_a96ae0fa77d8fa4a3a6dfd3661a2e783c"><div class="ttname"><a href="one__d__poisson__demo_8txt.html#a96ae0fa77d8fa4a3a6dfd3661a2e783c">passed</a></div><div class="ttdeci">namespace c FishSolnOneDPoisson as the second Once the problem has been created we execute c which checks that the c Problem has been properly set up If this test is passed</div><div class="ttdef"><b>Definition:</b> <a href="one__d__poisson__demo_8txt_source.html#l00092">one_d_poisson_demo.txt:92</a></div></div>
<div class="ttc" id="aone__d__poisson__demo_8txt_html_a16b123f6b2de7d47334baa709f5ab494"><div class="ttname"><a href="one__d__poisson__demo_8txt.html#a16b123f6b2de7d47334baa709f5ab494">u_1</a></div><div class="ttdeci">u_1</div><div class="ttdef"><b>Definition:</b> <a href="one__d__poisson__demo_8txt_source.html#l00044">one_d_poisson_demo.txt:44</a></div></div>
<div class="ttc" id="aone__d__poisson__demo_8txt_html_aebc15a17426a6ca0a44b5e5587b75caa"><div class="ttname"><a href="one__d__poisson__demo_8txt.html#aebc15a17426a6ca0a44b5e5587b75caa">lib</a></div><div class="ttdeci">endcode This reflects a b general b convention in c oomph lib</div><div class="ttdef"><b>Definition:</b> <a href="one__d__poisson__demo_8txt_source.html#l00165">one_d_poisson_demo.txt:165</a></div></div>
<div class="ttc" id="aone__d__poisson__demo_8txt_html_a9bb38c90214a10b9132eecef76679a38"><div class="ttname"><a href="one__d__poisson__demo_8txt.html#a9bb38c90214a10b9132eecef76679a38">convention</a></div><div class="ttdeci">endcode This reflects a b general b convention in c oomph are always declared as public types in the element classes The logic behind this is that only the element writer maintainer knows what type of the source function for the Poisson equation requires the spatial coordinate c x as input and computes the designer of we use typedefs to give the function pointers more intuitive names Since the typedefs are they can be used anywhere in the user s code While we re at here s b another b convention</div><div class="ttdef"><b>Definition:</b> <a href="one__d__poisson__demo_8txt_source.html#l00180">one_d_poisson_demo.txt:180</a></div></div>
<div class="ttc" id="anamespaceFishSolnOneDPoisson_html"><div class="ttname"><a href="namespaceFishSolnOneDPoisson.html">FishSolnOneDPoisson</a></div><div class="ttdoc">Namespace for fish-shaped solution of 1D Poisson equation.</div><div class="ttdef"><b>Definition:</b> <a href="one__d__poisson_8cc_source.html#l00045">one_d_poisson.cc:45</a></div></div>
<div class="ttc" id="aone__d__poisson__demo_8txt_html_a835a3388f355c34c29ffea746d6661eb"><div class="ttname"><a href="one__d__poisson__demo_8txt.html#a835a3388f355c34c29ffea746d6661eb">problem</a></div><div class="ttdeci">mainpage Demo problem</div><div class="ttdef"><b>Definition:</b> <a href="one__d__poisson__demo_8txt_source.html#l00002">one_d_poisson_demo.txt:2</a></div></div>
<div class="ttc" id="aone__d__poisson__demo_8txt_html_a79f24544d7f8a34b1b28919a05c29315"><div class="ttname"><a href="one__d__poisson__demo_8txt.html#a79f24544d7f8a34b1b28919a05c29315">first</a></div><div class="ttdeci">endcode This reflects a b general b convention in c oomph are always declared as public types in the element classes The logic behind this is that only the element writer maintainer knows what type of the source function for the Poisson equation requires the spatial coordinate c x as input and computes the designer of we use typedefs to give the function pointers more intuitive names Since the typedefs are they can be used anywhere in the user s code While we re at here s b another b the input arguments appear first(and are usually passed as constant references)</div></div>
<div class="ttc" id="aone__d__poisson_8cc_html_ae66f6b31b5ad750f1fe042a706a4e3d4"><div class="ttname"><a href="one__d__poisson_8cc.html#ae66f6b31b5ad750f1fe042a706a4e3d4">main</a></div><div class="ttdeci">int main()</div><div class="ttdoc">Driver for 1D Poisson problem.</div><div class="ttdef"><b>Definition:</b> <a href="one__d__poisson_8cc_source.html#l00259">one_d_poisson.cc:259</a></div></div>
<div class="ttc" id="aone__d__poisson__demo_8txt_html_a3fb2847c17a7760a8305ca200f577062"><div class="ttname"><a href="one__d__poisson__demo_8txt.html#a3fb2847c17a7760a8305ca200f577062">x</a></div><div class="ttdeci">f(x), \ \ \ \ \ \ \ \ \ \ @E[1DPoisson]@ \f] in a one-dimensional domain \f$ x\in[0, 1] \f$, with boundary conditions \f[u(0)=u_0 \ \mbox{\ \ \ and \ \ \ } \ \ u(1)=u_1, \ \ \ \ \ \ \ \ \ \ @E[1DPoisson_BC]@ \f] where \f$ u_0 \f$ and \f$ u_1 \f$ are given.&lt;/TD &gt;&lt;/TR &gt;&lt;/TABLE &gt;&lt;/CENTER &gt; #&lt;/TD &gt; #&lt;/TR &gt; #&lt;/TABLE &gt; #&lt;/CENTER &gt; We provide a detailed discussion of the driver code&lt; A HREF=&quot;../../../../demo_drivers/poisson/one_d_poisson/one_d_poisson.cc&quot;&gt; one_d_poisson.cc&lt;/A &gt; which solves the problem for the specific source function \f[f(x)=\pm 30 \sin(\sqrt{30} x), \ \ \ \ @E[FishSource]@ \f] and boundary conditions \f[u_0=0 x</div><div class="ttdef"><b>Definition:</b> <a href="one__d__poisson__demo_8txt_source.html#l00044">one_d_poisson_demo.txt:44</a></div></div>

    <!-- jQuery for Bootstrap and Doxygen -->
    <script src="../../../js/jquery-1.12.0.min.js"></script>
    <!-- Minified boostrap plugins-->
    <script src="../../../js/bootstrap.js"></script>
    <!-- Doxygen dependency to add powertips to source code-->
    <script src="../../../js/jquery.powertip.min.js"></script>
    <!-- The  following script is generated by doxygen and hides/shows levels in 
         the data structure lists and adds powertips to source code-->
    <script src="../../../js/dynsections.js" ></script>
    <!-- add to Doxygen's class names so bootstrap css and js recognises them-->
    <script type="text/javascript">
    $(".contents").addClass("container");
    $(".header").addClass("container");
    $(".navpath").addClass("container");
    $("#navrow3").addClass("container");
    $("#navrow4").addClass("container");
    $(".mlabel").addClass("label");
    $(".mlabel").addClass("label-default");
    $(".memitem").addClass("panel");
    $(".memitem").addClass("panel-info");
    $(".memproto").addClass("panel-heading");
    $(".memdoc").addClass("panel-body");
    </script>
    <footer>
      <div class="container">
        <div class="text-muted" style="float:right;">Generated by <a href="http://www.doxygen.org/index.html">
          <img style="height:18px;" class="footer-img" src="doxygen.png" alt="doxygen"></a> on Wed Aug 4 2021 20:08:39
        </div>
      </div>
    </footer>
</body>
</html>

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
<title>oomph-lib: fish_poisson_simple_adapt.cc Source File</title>
<link rel="apple-touch-icon" sizes="57x57" href="../../../figures/apple-touch-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="../../../figures/apple-touch-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="../../../figures/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="../../../figures/apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="../../../figures/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="../../../figures/apple-touch-icon-120x120.png">
<link rel="icon" type="image/png" href="../../../figures/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="../../../figures/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="../../../figures/favicon-16x16.png" sizes="16x16">
<link rel="manifest" href="../../../figures/manifest.json">
<link rel="mask-icon" href="../../../figures/safari-pinned-tab.svg" color="#008000">
<link rel="shortcut icon" href="../../../figures/favicon.ico">
<meta name="msapplication-TileColor" content="#00a300">
<meta name="msapplication-config" content="../../../figures/browserconfig.xml">
<meta name="theme-color" content="#008000">
<link href="http://fonts.googleapis.com/css?family=Open+Sans:400,300,600" rel="stylesheet" type="text/css">
<!-- Doxygen css-->
<!-- <link rel="stylesheet" type="text/css" href="doxygen.css"> -->
<!-- Bootstrap -->
<link href="../../../css/bootstrap.css" rel="stylesheet">
<!-- oomph-lib specific overrides -->
<link rel="stylesheet" type="text/css" href="../../../css/oomph_header.css">
</head>
<body>
<nav class="navbar navbar-default">
<div class="container">
<div class="container-fluid">
  <!-- Brand and toggle get grouped for better mobile display -->
  <div class="navbar-header">
    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
      <span class="sr-only">Toggle navigation</span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="../../../html/index.html"><img alt="oomph-lib" src="../../../figures/oomph_logo.png"></a>
  </div>
  <!-- Collect the nav links, forms, and other content for toggling -->
  <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
    <ul class="nav navbar-nav">          
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Documentation <span class="caret"></span></a>
        <ul class="dropdown-menu">
          <li class="dropdown-header">Big picture</li>
          <li><a href="../../../../doc/intro/html/index.html">The finite element method</a></li>
          <li><a href="../../../../doc/the_data_structure/html/index.html">The data structure</a></li>
          <li><a href="../../../../doc/quick_guide/html/index.html">Not-so-quick guide</a></li>
          <li><a href="../../../../doc/optimisation/html/index.html">Optimisation</a></li>
          <li><a href="../../../../doc/order_of_action_functions/html/index.html">Order of action functions</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Example codes and tutorials</li>
          <li><a href="../../../../doc/example_code_list/html/index.html">List of example codes and tutorials</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#meshes">Meshing</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#solvers">Solvers</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#parallel">MPI parallel processing</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#visualisation">Post-processing/visualisation</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Other</li>
          <li><a href="../../../../doc/change_log/html/index.html">Change log</a></li>
          <li><a href="../../../../doc/creating_doc/html/index.html">Creating documentation</a></li>
          <li><a href="../../../../doc/coding_conventions/html/index.html">Coding conventions</a></li>
          <li><a href="../../../../doc/index/html/index.html">Index</a></li>
          <li><a href="../../../../doc/FAQ/html/index.html">FAQ</a></li>
        </ul>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Get it <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../../doc/the_distribution/html/index.html">Installation guide</a></li>
            <li><a href="../../../../doc/subversion/html/index.html">Get code from subversion repository</a></li>
            <li><a href="../../../../doc/download/html/index.html">Get code as tar file</a></li>
            <li><a href="../../../../doc/copyright/html/index.html">Copyright</a></li>
          </ul>
        </li>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">About <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../../doc/people/html/index.html">People</a></li>            
            <li><a href="../../../../doc/contact/html/index.html">Contact/Get involved</a></li>
            <li><a href="../../../../doc/publications/html/index.html">Publications</a></li>
            <li><a href="../../../../doc/acknowledgements/html/index.html">Acknowledgements</a></li>
            <li><a href="../../../../doc/picture_show/index.html">Picture show</a></li>
          </ul>
        </li>
      </li>
    </ul>
    <ul class="nav navbar-nav navbar-right navbar-search">
      <form class="navbar-form" role="search" action="../../../../doc/search_results/html/index.html">
        <div class="input-group">
          <input type="text" class="form-control" placeholder="Search" name="q">
          <span class="input-group-btn">
            <button class="btn btn-default" type="submit">Go</button>
          </span>
        </div><!-- /input-group -->
       <!--<div class="form-group">
          <input type="text" class="form-control" placeholder="Search">
        </div>
        <button type="submit" class="btn btn-default">Submit</button>-->
      </form>
    </ul>
  </div><!-- /.navbar-collapse -->
</div><!-- /.container-fluid -->
</div>
</nav>
<!-- Generated by Doxygen 1.8.17 -->
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_ddb094a380b94394dbbcf95a63b535e6.html">demo_drivers</a></li><li class="navelem"><a class="el" href="dir_5e95af49491505dfde4ba94a1a4cc2d9.html">poisson</a></li><li class="navelem"><a class="el" href="dir_2ef2a9972e253beb4df9cf4653ed8b55.html">fish_poisson2</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">fish_poisson_simple_adapt.cc</div>  </div>
</div><!--header-->
<div class="contents">
<a href="fish__poisson__simple__adapt_8cc.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">//LIC// ====================================================================</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">//LIC// This file forms part of oomph-lib, the object-oriented, </span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">//LIC// multi-physics finite-element library, available </span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">//LIC// at http://www.oomph-lib.org.</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">//LIC// Copyright (C) 2006-2021 Matthias Heil and Andrew Hazel</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">//LIC// This library is free software; you can redistribute it and/or</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">//LIC// modify it under the terms of the GNU Lesser General Public</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">//LIC// License as published by the Free Software Foundation; either</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">//LIC// version 2.1 of the License, or (at your option) any later version.</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">//LIC// This library is distributed in the hope that it will be useful,</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">//LIC// but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">//LIC// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">//LIC// Lesser General Public License for more details.</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">//LIC// You should have received a copy of the GNU Lesser General Public</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">//LIC// License along with this library; if not, write to the Free Software</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">//LIC// Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">//LIC// 02110-1301  USA.</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">//LIC// The authors may be contacted at oomph-lib@maths.man.ac.uk.</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">//LIC//====================================================================</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">// Driver for solution of 2D Poisson equation in fish-shaped domain with</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">// simple adaptivity (no macro elements)</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160; </div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment">// Generic oomph-lib headers</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#include &quot;generic.h&quot;</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160; </div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment">// The Poisson equations</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#include &quot;poisson.h&quot;</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160; </div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment">// The fish mesh </span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#include &quot;meshes/fish_mesh.h&quot;</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160; </div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="keyword">using namespace </span>std;</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160; </div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="keyword">using namespace </span>oomph;</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160; </div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment">//=================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment">/// Fish shaped mesh with simple adaptivity (no macro elements).</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment"></span><span class="comment">//=================================================================</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> ELEMENT&gt;</div>
<div class="line"><a name="l00046"></a><span class="lineno"><a class="line" href="classSimpleRefineableFishMesh.html">   46</a></span>&#160;<span class="keyword">class </span><a class="code" href="classSimpleRefineableFishMesh.html">SimpleRefineableFishMesh</a> : <span class="keyword">public</span> <span class="keyword">virtual</span> FishMesh&lt;ELEMENT&gt;,  </div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;                               <span class="keyword">public</span> RefineableQuadMesh&lt;ELEMENT&gt;</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;{ </div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160; </div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160; </div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="keyword">public</span>: </div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160; </div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment"> /// \short Constructor: Pass pointer to timestepper</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment"> /// (defaults to (Steady) default timestepper defined in Mesh)</span></div>
<div class="line"><a name="l00056"></a><span class="lineno"><a class="line" href="classSimpleRefineableFishMesh.html#acc2426825942faeef8842fc2c6cec5ad">   56</a></span>&#160;<span class="comment"></span> <a class="code" href="classSimpleRefineableFishMesh.html#acc2426825942faeef8842fc2c6cec5ad">SimpleRefineableFishMesh</a>(TimeStepper* time_stepper_pt=</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;                         &amp;Mesh::Default_TimeStepper) : </div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  FishMesh&lt;ELEMENT&gt;(time_stepper_pt) </div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  {</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160; </div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;   <span class="comment">// Setup quadtree forest</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;   this-&gt;setup_quadtree_forest();</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160; </div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;   <span class="comment">// Loop over all elements and null out macro element pointer</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;   <span class="keywordtype">unsigned</span> n_element=this-&gt;nelement();</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> e=0;e&lt;n_element;e++)</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    {</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;     <span class="comment">// Get pointer to element</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;     FiniteElement* el_pt=this-&gt;finite_element_pt(e);</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;     </div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;     <span class="comment">// Null out the pointer to macro elements to disable them</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;     el_pt-&gt;set_macro_elem_pt(0);</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    }</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  }</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160; </div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="comment"> /// Destructor: Empty</span></div>
<div class="line"><a name="l00078"></a><span class="lineno"><a class="line" href="classSimpleRefineableFishMesh.html#a5c9b22d3eb2d273b7fd1f44b8946b3b2">   78</a></span>&#160;<span class="comment"></span> <span class="keyword">virtual</span> <a class="code" href="classSimpleRefineableFishMesh.html#a5c9b22d3eb2d273b7fd1f44b8946b3b2">~SimpleRefineableFishMesh</a>() {}</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160; </div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;};</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160; </div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160; </div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160; </div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160; </div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="comment">//============ start_of_namespace=====================================</span><span class="comment"></span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="comment">/// Namespace for const source term in Poisson equation</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="comment"></span><span class="comment">//====================================================================</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespaceConstSourceForPoisson.html">ConstSourceForPoisson</a></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;{ </div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="comment"> /// Strength of source function: default value -1.0</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="namespaceConstSourceForPoisson.html#add351c5acab2561d68d1fc9ec3d5fc5e">Strength</a>=-1.0;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="comment">/// Const source function</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="namespaceConstSourceForPoisson.html#a40ef79083874b58ed42b4df2ca0f4c10">get_source</a>(<span class="keyword">const</span> Vector&lt;double&gt;&amp; x, <span class="keywordtype">double</span>&amp; source)</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160; {</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  source = <a class="code" href="namespaceConstSourceForPoisson.html#add351c5acab2561d68d1fc9ec3d5fc5e">Strength</a>;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160; }</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160; </div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;} <span class="comment">// end of namespace</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160; </div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160; </div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160; </div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160; </div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="comment">//======start_of_problem_class========================================</span><span class="comment"></span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="comment">///  Poisson problem in fish-shaped domain.</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="comment">/// Template parameter identifies the element type.</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="comment"></span><span class="comment">//====================================================================</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> ELEMENT&gt;</div>
<div class="line"><a name="l00110"></a><span class="lineno"><a class="line" href="classSimpleRefineableFishPoissonProblem.html">  110</a></span>&#160;<span class="keyword">class </span><a class="code" href="classSimpleRefineableFishPoissonProblem.html">SimpleRefineableFishPoissonProblem</a> : <span class="keyword">public</span> Problem</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;{</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160; </div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="comment"> /// Constructor</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="comment"></span> <a class="code" href="classSimpleRefineableFishPoissonProblem.html">SimpleRefineableFishPoissonProblem</a>();</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="comment"> /// Destructor: Empty</span></div>
<div class="line"><a name="l00119"></a><span class="lineno"><a class="line" href="classSimpleRefineableFishPoissonProblem.html#ab72c23e589ff55593d0a13e5ab57d070">  119</a></span>&#160;<span class="comment"></span> <span class="keyword">virtual</span> <a class="code" href="classSimpleRefineableFishPoissonProblem.html#ab72c23e589ff55593d0a13e5ab57d070">~SimpleRefineableFishPoissonProblem</a>(){}</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="comment"> /// Update the problem specs after solve (empty)</span></div>
<div class="line"><a name="l00122"></a><span class="lineno"><a class="line" href="classSimpleRefineableFishPoissonProblem.html#a68d717e7c5b403236fdce799599b8c29">  122</a></span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classSimpleRefineableFishPoissonProblem.html#a68d717e7c5b403236fdce799599b8c29">actions_after_newton_solve</a>() {}</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="comment"> /// Update the problem specs before solve (empty)</span></div>
<div class="line"><a name="l00125"></a><span class="lineno"><a class="line" href="classSimpleRefineableFishPoissonProblem.html#af1b13d49ace6c248a0a8021103f139a5">  125</a></span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classSimpleRefineableFishPoissonProblem.html#af1b13d49ace6c248a0a8021103f139a5">actions_before_newton_solve</a>() {}</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="comment"> /// \short Overloaded version of the problem&#39;s access function to </span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="comment"> /// the mesh. Recasts the pointer to the base Mesh object to </span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="comment"> /// the actual mesh type.</span></div>
<div class="line"><a name="l00130"></a><span class="lineno"><a class="line" href="classSimpleRefineableFishPoissonProblem.html#af7b30bf0ed7fed95b40bbdca9ce295a0">  130</a></span>&#160;<span class="comment"></span> <a class="code" href="classSimpleRefineableFishMesh.html">SimpleRefineableFishMesh&lt;ELEMENT&gt;</a>* <a class="code" href="classSimpleRefineableFishPoissonProblem.html#af7b30bf0ed7fed95b40bbdca9ce295a0">mesh_pt</a>() </div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;  {</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;   <span class="keywordflow">return</span> <span class="keyword">dynamic_cast&lt;</span><a class="code" href="classSimpleRefineableFishMesh.html">SimpleRefineableFishMesh&lt;ELEMENT&gt;</a>*<span class="keyword">&gt;</span>(Problem::mesh_pt());</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;  }</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="comment"> /// \short Doc the solution. Output directory and labels are specified </span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="comment"> /// by DocInfo object</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> doc_solution(DocInfo&amp; doc_info);</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160; </div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;}; <span class="comment">// end of problem class</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160; </div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160; </div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160; </div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160; </div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160; </div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="comment">//===========start_of_constructor=========================================</span><span class="comment"></span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="comment">/// Constructor for adaptive Poisson problem in fish-shaped</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="comment">/// domain.</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="comment"></span><span class="comment">//========================================================================</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> ELEMENT&gt;</div>
<div class="line"><a name="l00150"></a><span class="lineno"><a class="line" href="classSimpleRefineableFishPoissonProblem.html#a8ae306f40e7e2e0cf20c5377e190716d">  150</a></span>&#160;<a class="code" href="classSimpleRefineableFishPoissonProblem.html#a8ae306f40e7e2e0cf20c5377e190716d">SimpleRefineableFishPoissonProblem&lt;ELEMENT&gt;::SimpleRefineableFishPoissonProblem</a>()</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;{ </div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    </div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160; <span class="comment">// Build fish mesh -- this is a coarse base mesh consisting </span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160; <span class="comment">// of four elements.</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160; Problem::mesh_pt()=<span class="keyword">new</span> <a class="code" href="classSimpleRefineableFishMesh.html">SimpleRefineableFishMesh&lt;ELEMENT&gt;</a>;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160; </div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160; <span class="comment">// Create/set error estimator</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160; mesh_pt()-&gt;spatial_error_estimator_pt()=<span class="keyword">new</span> Z2ErrorEstimator;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;  </div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160; <span class="comment">// Set the boundary conditions for this problem: All nodes are</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160; <span class="comment">// free by default -- just pin the ones that have Dirichlet conditions</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160; <span class="comment">// here. Since the boundary values are never changed, we set</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160; <span class="comment">// them here rather than in actions_before_newton_solve(). </span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160; <span class="keywordtype">unsigned</span> num_bound = mesh_pt()-&gt;nboundary();</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160; <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> ibound=0;ibound&lt;num_bound;ibound++)</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;  {</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;   <span class="keywordtype">unsigned</span> num_nod= mesh_pt()-&gt;nboundary_node(ibound);</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> inod=0;inod&lt;num_nod;inod++)</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    {</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;     <span class="comment">// Pin the single scalar value at this node</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;     mesh_pt()-&gt;boundary_node_pt(ibound,inod)-&gt;pin(0); </div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160; </div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;     <span class="comment">// Assign the homogenous boundary condition to the one</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;     <span class="comment">// and only nodal value</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;     mesh_pt()-&gt;boundary_node_pt(ibound,inod)-&gt;set_value(0,0.0); </div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    }</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;  }</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160; </div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160; <span class="comment">// Loop over elements and set pointers to source function</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160; <span class="keywordtype">unsigned</span> n_element = mesh_pt()-&gt;nelement();</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160; <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="fish__poisson2_8txt.html#a04763e696f9abee872a515865c843251">i</a>=0;<a class="code" href="fish__poisson2_8txt.html#a04763e696f9abee872a515865c843251">i</a>&lt;n_element;<a class="code" href="fish__poisson2_8txt.html#a04763e696f9abee872a515865c843251">i</a>++)</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;  {</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;   <span class="comment">// Upcast from FiniteElement to the present element</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;   ELEMENT *el_pt = <span class="keyword">dynamic_cast&lt;</span>ELEMENT*<span class="keyword">&gt;</span>(mesh_pt()-&gt;element_pt(<a class="code" href="fish__poisson2_8txt.html#a04763e696f9abee872a515865c843251">i</a>));</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160; </div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;   <span class="comment">//Set the source function pointer</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;   el_pt-&gt;source_fct_pt() = &amp;<a class="code" href="namespaceConstSourceForPoisson.html#a40ef79083874b58ed42b4df2ca0f4c10">ConstSourceForPoisson::get_source</a>;</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;  }</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160; </div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160; <span class="comment">// Setup the equation numbering scheme</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160; cout &lt;&lt;<span class="stringliteral">&quot;Number of equations: &quot;</span> &lt;&lt; assign_eqn_numbers() &lt;&lt; std::endl; </div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160; </div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;} <span class="comment">// end of constructor</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160; </div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160; </div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160; </div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160; </div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="comment">//=======start_of_doc=====================================================</span><span class="comment"></span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="comment">/// Doc the solution in tecplot format.</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="comment"></span><span class="comment">//========================================================================</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> ELEMENT&gt;</div>
<div class="line"><a name="l00202"></a><span class="lineno"><a class="line" href="classSimpleRefineableFishPoissonProblem.html#a59e92fc454dea540b48a1a12751efc5b">  202</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classSimpleRefineableFishPoissonProblem.html#a59e92fc454dea540b48a1a12751efc5b">SimpleRefineableFishPoissonProblem&lt;ELEMENT&gt;::doc_solution</a>(DocInfo&amp; doc_info)</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;{ </div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160; </div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160; ofstream some_file;</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160; <span class="keywordtype">char</span> filename[100];</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160; </div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160; <span class="comment">// Number of plot points in each coordinate direction.</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160; <span class="keywordtype">unsigned</span> npts;</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160; npts=5; </div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160; </div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160; <span class="comment">// Output solution </span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160; sprintf(filename,<span class="stringliteral">&quot;%s/soln%i.dat&quot;</span>,doc_info.directory().c_str(),</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;         doc_info.number());</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160; some_file.open(filename);</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160; mesh_pt()-&gt;output(some_file,npts);</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160; some_file.close();</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160; </div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;} <span class="comment">// end of doc</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160; </div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160; </div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160; </div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160; </div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160; </div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160; </div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<span class="comment">//=====================start_of_main======================================</span><span class="comment"></span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;<span class="comment">/// Demonstrate how to solve 2D Poisson problem in </span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="comment">/// fish-shaped domain with mesh adaptation. First we solve on the original</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="comment">/// coarse mesh. Next we do a few uniform refinement steps and resolve.</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;<span class="comment">/// Finally, we enter into an automatic adapation loop.</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;<span class="comment"></span><span class="comment">//========================================================================</span></div>
<div class="line"><a name="l00232"></a><span class="lineno"><a class="line" href="fish__poisson__simple__adapt_8cc.html#ae66f6b31b5ad750f1fe042a706a4e3d4">  232</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="fish__poisson__simple__adapt_8cc.html#ae66f6b31b5ad750f1fe042a706a4e3d4">main</a>()</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;{</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160; </div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160; <span class="comment">//Set up the problem with 4 node Poisson elements</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160; <a class="code" href="classSimpleRefineableFishPoissonProblem.html">SimpleRefineableFishPoissonProblem&lt;RefineableQPoissonElement&lt;2,2&gt;</a> &gt; <a class="code" href="fish__poisson2_8txt.html#a4074baada03976c061d5672f4237cca5">problem</a>;</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160; </div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160; <span class="comment">// Setup labels for output</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160; <span class="comment">//------------------------</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160; DocInfo doc_info;</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160; </div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160; <span class="comment">// Set output directory</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160; doc_info.set_directory(<span class="stringliteral">&quot;RESLT&quot;</span>); </div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160; </div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160; <span class="comment">// Step number</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160; doc_info.number()=0;</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;  </div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160; </div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160; <span class="comment">// Doc adaptivity targets</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160; <span class="comment">//-----------------------</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160; <a class="code" href="fish__poisson2_8txt.html#a4074baada03976c061d5672f4237cca5">problem</a>.mesh_pt()-&gt;doc_adaptivity_targets(cout);</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160; </div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160; </div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160; <span class="comment">// Solve/doc the problem</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160; <span class="comment">//----------------------</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160; </div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160; <span class="comment">// Solve the problem</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160; <a class="code" href="fish__poisson2_8txt.html#a4074baada03976c061d5672f4237cca5">problem</a>.newton_solve();</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160; </div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160; <span class="comment">//Output solution</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160; <a class="code" href="fish__poisson2_8txt.html#a4074baada03976c061d5672f4237cca5">problem</a>.doc_solution(doc_info);</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160; </div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160; <span class="comment">//Increment counter for solutions </span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160; doc_info.number()++;</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160; </div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160; </div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160; <span class="comment">// Do two rounds of uniform mesh refinement and re-solve</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160; <span class="comment">//-------------------------------------------------------</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160; <a class="code" href="fish__poisson2_8txt.html#a4074baada03976c061d5672f4237cca5">problem</a>.refine_uniformly();</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160; <a class="code" href="fish__poisson2_8txt.html#a4074baada03976c061d5672f4237cca5">problem</a>.refine_uniformly();</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160; </div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160; <span class="comment">// Solve the problem </span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160; <a class="code" href="fish__poisson2_8txt.html#a4074baada03976c061d5672f4237cca5">problem</a>.newton_solve();</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160; </div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160; <span class="comment">//Output solution</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160; <a class="code" href="fish__poisson2_8txt.html#a4074baada03976c061d5672f4237cca5">problem</a>.doc_solution(doc_info);</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160; </div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160; <span class="comment">//Increment counter for solutions </span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160; doc_info.number()++;</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160; </div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160; </div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160; <span class="comment">// Now do (up to) four rounds of fully automatic adapation in response to </span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160; <span class="comment">//-----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160; <span class="comment">// error estimate</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160; <span class="comment">//---------------</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160; <span class="keywordtype">unsigned</span> max_solve=4;</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160; <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> isolve=0;isolve&lt;max_solve;isolve++)</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;  {</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;   <span class="comment">// Adapt problem/mesh</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;   <a class="code" href="fish__poisson2_8txt.html#a4074baada03976c061d5672f4237cca5">problem</a>.adapt(); </div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;         </div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;   <span class="comment">// Re-solve the problem if the adaptation has changed anything</span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;   <span class="keywordflow">if</span> ((<a class="code" href="fish__poisson2_8txt.html#a4074baada03976c061d5672f4237cca5">problem</a>.mesh_pt()-&gt;nrefined()  !=0)||</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;       (<a class="code" href="fish__poisson2_8txt.html#a4074baada03976c061d5672f4237cca5">problem</a>.mesh_pt()-&gt;nunrefined()!=0))</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    {</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;     <a class="code" href="fish__poisson2_8txt.html#a4074baada03976c061d5672f4237cca5">problem</a>.newton_solve();</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    }</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;   <span class="keywordflow">else</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    {</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;     cout &lt;&lt; <span class="stringliteral">&quot;Mesh wasn&#39;t adapted --&gt; we&#39;ll stop here&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;     <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    }</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;   </div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;   <span class="comment">//Output solution</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;   <a class="code" href="fish__poisson2_8txt.html#a4074baada03976c061d5672f4237cca5">problem</a>.doc_solution(doc_info);</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;   </div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;   <span class="comment">//Increment counter for solutions </span></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;   doc_info.number()++;</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;  }</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160; </div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160; </div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;} <span class="comment">// end of main</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160; </div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160; </div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160; </div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="anamespaceConstSourceForPoisson_html"><div class="ttname"><a href="namespaceConstSourceForPoisson.html">ConstSourceForPoisson</a></div><div class="ttdoc">Namespace for const source term in Poisson equation.</div><div class="ttdef"><b>Definition:</b> <a href="fish__poisson__adapt_8cc_source.html#l00045">fish_poisson_adapt.cc:45</a></div></div>
<div class="ttc" id="afish__poisson2_8txt_html_a4074baada03976c061d5672f4237cca5"><div class="ttname"><a href="fish__poisson2_8txt.html#a4074baada03976c061d5672f4237cca5">problem</a></div><div class="ttdeci">mainpage Demo problem</div><div class="ttdef"><b>Definition:</b> <a href="fish__poisson2_8txt_source.html#l00012">fish_poisson2.txt:12</a></div></div>
<div class="ttc" id="aclassSimpleRefineableFishMesh_html_a5c9b22d3eb2d273b7fd1f44b8946b3b2"><div class="ttname"><a href="classSimpleRefineableFishMesh.html#a5c9b22d3eb2d273b7fd1f44b8946b3b2">SimpleRefineableFishMesh::~SimpleRefineableFishMesh</a></div><div class="ttdeci">virtual ~SimpleRefineableFishMesh()</div><div class="ttdoc">Destructor: Empty.</div><div class="ttdef"><b>Definition:</b> <a href="fish__poisson__simple__adapt_8cc_source.html#l00078">fish_poisson_simple_adapt.cc:78</a></div></div>
<div class="ttc" id="aclassSimpleRefineableFishPoissonProblem_html"><div class="ttname"><a href="classSimpleRefineableFishPoissonProblem.html">SimpleRefineableFishPoissonProblem</a></div><div class="ttdef"><b>Definition:</b> <a href="fish__poisson__simple__adapt_8cc_source.html#l00110">fish_poisson_simple_adapt.cc:110</a></div></div>
<div class="ttc" id="aclassSimpleRefineableFishPoissonProblem_html_a68d717e7c5b403236fdce799599b8c29"><div class="ttname"><a href="classSimpleRefineableFishPoissonProblem.html#a68d717e7c5b403236fdce799599b8c29">SimpleRefineableFishPoissonProblem::actions_after_newton_solve</a></div><div class="ttdeci">void actions_after_newton_solve()</div><div class="ttdoc">Update the problem specs after solve (empty)</div><div class="ttdef"><b>Definition:</b> <a href="fish__poisson__simple__adapt_8cc_source.html#l00122">fish_poisson_simple_adapt.cc:122</a></div></div>
<div class="ttc" id="aclassSimpleRefineableFishPoissonProblem_html_a59e92fc454dea540b48a1a12751efc5b"><div class="ttname"><a href="classSimpleRefineableFishPoissonProblem.html#a59e92fc454dea540b48a1a12751efc5b">SimpleRefineableFishPoissonProblem::doc_solution</a></div><div class="ttdeci">void doc_solution(DocInfo &amp;doc_info)</div><div class="ttdoc">Doc the solution. Output directory and labels are specified by DocInfo object.</div><div class="ttdef"><b>Definition:</b> <a href="fish__poisson__simple__adapt_8cc_source.html#l00202">fish_poisson_simple_adapt.cc:202</a></div></div>
<div class="ttc" id="afish__poisson__simple__adapt_8cc_html_ae66f6b31b5ad750f1fe042a706a4e3d4"><div class="ttname"><a href="fish__poisson__simple__adapt_8cc.html#ae66f6b31b5ad750f1fe042a706a4e3d4">main</a></div><div class="ttdeci">int main()</div><div class="ttdef"><b>Definition:</b> <a href="fish__poisson__simple__adapt_8cc_source.html#l00232">fish_poisson_simple_adapt.cc:232</a></div></div>
<div class="ttc" id="aclassSimpleRefineableFishMesh_html_acc2426825942faeef8842fc2c6cec5ad"><div class="ttname"><a href="classSimpleRefineableFishMesh.html#acc2426825942faeef8842fc2c6cec5ad">SimpleRefineableFishMesh::SimpleRefineableFishMesh</a></div><div class="ttdeci">SimpleRefineableFishMesh(TimeStepper *time_stepper_pt=&amp;Mesh::Default_TimeStepper)</div><div class="ttdoc">Constructor: Pass pointer to timestepper (defaults to (Steady) default timestepper defined in Mesh)</div><div class="ttdef"><b>Definition:</b> <a href="fish__poisson__simple__adapt_8cc_source.html#l00056">fish_poisson_simple_adapt.cc:56</a></div></div>
<div class="ttc" id="anamespaceConstSourceForPoisson_html_add351c5acab2561d68d1fc9ec3d5fc5e"><div class="ttname"><a href="namespaceConstSourceForPoisson.html#add351c5acab2561d68d1fc9ec3d5fc5e">ConstSourceForPoisson::Strength</a></div><div class="ttdeci">double Strength</div><div class="ttdoc">Strength of source function: default value -1.0.</div><div class="ttdef"><b>Definition:</b> <a href="fish__poisson__adapt_8cc_source.html#l00049">fish_poisson_adapt.cc:49</a></div></div>
<div class="ttc" id="afish__poisson2_8txt_html_a04763e696f9abee872a515865c843251"><div class="ttname"><a href="fish__poisson2_8txt.html#a04763e696f9abee872a515865c843251">i</a></div><div class="ttdeci">1}^2 \frac{\partial^2u}{\partial x_i^2}=-1, \ \ \ \ \ \ \ \ \ \ @E[2DPoisson]@ \f] in the fish-shaped domain \f $D_{fish} \f$ with homogeneous Dirichlet boundary conditions \f[\left. u\right|_{\partial D_{fish}}=0. \ \ \ \ \ \ \ \ \ \ @E[2DPoisson_BC]@ \f]&lt;/TD &gt;&lt;/TR &gt;&lt;/TABLE &gt;&lt;/CENTER &gt; In Part 1 of this document we shall explain how \c oomph-lib 's mesh adaptation procedures employ the \c Domain and \c MacroElement objects to adapt meshes in domains with curvilinear boundaries. In Part 2, we demonstrate how to create new \c Domain objects.&lt; HR &gt; \section adapt Part 1:Mesh adaptation in domains with curvilinear boundaries, using Domain and MacroElement objects The plot below shows the domain \f $D_{fish} \f$, represented by the multi-coloured, shaded region and its(extremely coarse) discretisation with four four-node quad elements. The elements' edges and nodes are shown in black. @I w 0.75\textwidth coarse_fish_mesh_and_domain &quot;The fish-shaped domain and its discretisation with four four-node quad elements &quot; Obviously, the curvilinear boundaries of the fish-shaped domain(arcs of circles) are very poorly resolved by the elements' straight edges. Simple mesh adaptation, based on the techniques described in the&lt; A HREF=&quot;../../../../doc/poisson/two_d_poisson_adapt/html/index.html&quot;&gt; earlier example&lt;/A &gt; will not result in convergence to the exact solution since the refined mesh never approaches the exact domain geometry:@I w 0.75\textwidth fish_poisson_soln_no_macro &quot;Plot of the mesh adaptation without MacroElements &quot; To overcome this problem, the mesh adaptation routines must be given access to an exact, analytical representation of the actual domain. This is the purpose of \c oomph-lib 's \c Domain object. A \c Domain provides an analytical description of a mathematical domain, by decomposing it into a number of so-called \c MacroElements. Each \c MacroElement provides a mapping between a set of local and global coordinates \f$ {\bf r}_{macro}({\bf s})\f$ -- similar to the mapping between the local and global coordinates in a finite element. The key difference between the two types of element is that the \c MacroElement mapping resolves curvilinear domain boundaries exactly, whereas the finite element mapping interpolates the global coordinates between the coordinates of its nodes. The topology of \c MacroElements mirrors that of the associated(geometric) finite elements:For instance, the \c QMacroElement family is the counterpart of the \c QElement family of geometric finite elements. Both are templated by the spatial dimension, and the local coordinates(in their right-handed local coordinate systems) are in the range between -1 and+1. The different-coloured, shaded regions in the above sketch represent the four two-dimensional \c QMacroElements by which the \c FishDomain represents the fish-shaped domain \f$ D_{fish} \f$. For instance, \c MacroElement 0(shown in orange) represents the lower half of the fish 's body i</div><div class="ttdef"><b>Definition:</b> <a href="fish__poisson2_8txt_source.html#l00106">fish_poisson2.txt:106</a></div></div>
<div class="ttc" id="aclassSimpleRefineableFishMesh_html"><div class="ttname"><a href="classSimpleRefineableFishMesh.html">SimpleRefineableFishMesh</a></div><div class="ttdoc">Fish shaped mesh with simple adaptivity (no macro elements).</div><div class="ttdef"><b>Definition:</b> <a href="fish__poisson__simple__adapt_8cc_source.html#l00046">fish_poisson_simple_adapt.cc:46</a></div></div>
<div class="ttc" id="aclassSimpleRefineableFishPoissonProblem_html_af7b30bf0ed7fed95b40bbdca9ce295a0"><div class="ttname"><a href="classSimpleRefineableFishPoissonProblem.html#af7b30bf0ed7fed95b40bbdca9ce295a0">SimpleRefineableFishPoissonProblem::mesh_pt</a></div><div class="ttdeci">SimpleRefineableFishMesh&lt; ELEMENT &gt; * mesh_pt()</div><div class="ttdoc">Overloaded version of the problem's access function to the mesh. Recasts the pointer to the base Mesh...</div><div class="ttdef"><b>Definition:</b> <a href="fish__poisson__simple__adapt_8cc_source.html#l00130">fish_poisson_simple_adapt.cc:130</a></div></div>
<div class="ttc" id="aclassSimpleRefineableFishPoissonProblem_html_af1b13d49ace6c248a0a8021103f139a5"><div class="ttname"><a href="classSimpleRefineableFishPoissonProblem.html#af1b13d49ace6c248a0a8021103f139a5">SimpleRefineableFishPoissonProblem::actions_before_newton_solve</a></div><div class="ttdeci">void actions_before_newton_solve()</div><div class="ttdoc">Update the problem specs before solve (empty)</div><div class="ttdef"><b>Definition:</b> <a href="fish__poisson__simple__adapt_8cc_source.html#l00125">fish_poisson_simple_adapt.cc:125</a></div></div>
<div class="ttc" id="aclassSimpleRefineableFishPoissonProblem_html_ab72c23e589ff55593d0a13e5ab57d070"><div class="ttname"><a href="classSimpleRefineableFishPoissonProblem.html#ab72c23e589ff55593d0a13e5ab57d070">SimpleRefineableFishPoissonProblem::~SimpleRefineableFishPoissonProblem</a></div><div class="ttdeci">virtual ~SimpleRefineableFishPoissonProblem()</div><div class="ttdoc">Destructor: Empty.</div><div class="ttdef"><b>Definition:</b> <a href="fish__poisson__simple__adapt_8cc_source.html#l00119">fish_poisson_simple_adapt.cc:119</a></div></div>
<div class="ttc" id="aclassSimpleRefineableFishPoissonProblem_html_a8ae306f40e7e2e0cf20c5377e190716d"><div class="ttname"><a href="classSimpleRefineableFishPoissonProblem.html#a8ae306f40e7e2e0cf20c5377e190716d">SimpleRefineableFishPoissonProblem::SimpleRefineableFishPoissonProblem</a></div><div class="ttdeci">SimpleRefineableFishPoissonProblem()</div><div class="ttdoc">Constructor.</div><div class="ttdef"><b>Definition:</b> <a href="fish__poisson__simple__adapt_8cc_source.html#l00150">fish_poisson_simple_adapt.cc:150</a></div></div>
<div class="ttc" id="anamespaceConstSourceForPoisson_html_a40ef79083874b58ed42b4df2ca0f4c10"><div class="ttname"><a href="namespaceConstSourceForPoisson.html#a40ef79083874b58ed42b4df2ca0f4c10">ConstSourceForPoisson::get_source</a></div><div class="ttdeci">void get_source(const Vector&lt; double &gt; &amp;x, double &amp;source)</div><div class="ttdoc">Const source function.</div><div class="ttdef"><b>Definition:</b> <a href="fish__poisson__adapt_8cc_source.html#l00052">fish_poisson_adapt.cc:52</a></div></div>

    <!-- jQuery for Bootstrap and Doxygen -->
    <script src="../../../js/jquery-1.12.0.min.js"></script>
    <!-- Minified boostrap plugins-->
    <script src="../../../js/bootstrap.js"></script>
    <!-- Doxygen dependency to add powertips to source code-->
    <script src="../../../js/jquery.powertip.min.js"></script>
    <!-- The  following script is generated by doxygen and hides/shows levels in 
         the data structure lists and adds powertips to source code-->
    <script src="../../../js/dynsections.js" ></script>
    <!-- add to Doxygen's class names so bootstrap css and js recognises them-->
    <script type="text/javascript">
    $(".contents").addClass("container");
    $(".header").addClass("container");
    $(".navpath").addClass("container");
    $("#navrow3").addClass("container");
    $("#navrow4").addClass("container");
    $(".mlabel").addClass("label");
    $(".mlabel").addClass("label-default");
    $(".memitem").addClass("panel");
    $(".memitem").addClass("panel-info");
    $(".memproto").addClass("panel-heading");
    $(".memdoc").addClass("panel-body");
    </script>
    <footer>
      <div class="container">
        <div class="text-muted" style="float:right;">Generated by <a href="http://www.doxygen.org/index.html">
          <img style="height:18px;" class="footer-img" src="doxygen.png" alt="doxygen"></a> on Fri Jul 23 2021 08:38:38
        </div>
      </div>
    </footer>
</body>
</html>

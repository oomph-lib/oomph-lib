<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
<title>oomph-lib: fish_domain.cc Source File</title>
<link rel="apple-touch-icon" sizes="57x57" href="../../../figures/apple-touch-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="../../../figures/apple-touch-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="../../../figures/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="../../../figures/apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="../../../figures/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="../../../figures/apple-touch-icon-120x120.png">
<link rel="icon" type="image/png" href="../../../figures/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="../../../figures/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="../../../figures/favicon-16x16.png" sizes="16x16">
<link rel="manifest" href="../../../figures/manifest.json">
<link rel="mask-icon" href="../../../figures/safari-pinned-tab.svg" color="#008000">
<link rel="shortcut icon" href="../../../figures/favicon.ico">
<meta name="msapplication-TileColor" content="#00a300">
<meta name="msapplication-config" content="../../../figures/browserconfig.xml">
<meta name="theme-color" content="#008000">
<link href="http://fonts.googleapis.com/css?family=Open+Sans:400,300,600" rel="stylesheet" type="text/css">
<!-- Doxygen css-->
<!-- <link rel="stylesheet" type="text/css" href="doxygen.css"> -->
<!-- Bootstrap -->
<link href="../../../css/bootstrap.css" rel="stylesheet">
<!-- oomph-lib specific overrides -->
<link rel="stylesheet" type="text/css" href="../../../css/oomph_header.css">
</head>
<body>
<nav class="navbar navbar-default">
<div class="container">
<div class="container-fluid">
  <!-- Brand and toggle get grouped for better mobile display -->
  <div class="navbar-header">
    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
      <span class="sr-only">Toggle navigation</span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="../../../html/index.html"><img alt="oomph-lib" src="../../../figures/oomph_logo.png"></a>
  </div>
  <!-- Collect the nav links, forms, and other content for toggling -->
  <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
    <ul class="nav navbar-nav">          
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Documentation <span class="caret"></span></a>
        <ul class="dropdown-menu">
          <li class="dropdown-header">Big picture</li>
          <li><a href="../../../../doc/intro/html/index.html">The finite element method</a></li>
          <li><a href="../../../../doc/the_data_structure/html/index.html">The data structure</a></li>
          <li><a href="../../../../doc/quick_guide/html/index.html">Not-so-quick guide</a></li>
          <li><a href="../../../../doc/optimisation/html/index.html">Optimisation</a></li>
          <li><a href="../../../../doc/order_of_action_functions/html/index.html">Order of action functions</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Example codes and tutorials</li>
          <li><a href="../../../../doc/example_code_list/html/index.html">List of example codes and tutorials</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#meshes">Meshing</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#solvers">Solvers</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#parallel">MPI parallel processing</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#visualisation">Post-processing/visualisation</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Other</li>
          <li><a href="../../../../doc/change_log/html/index.html">Change log</a></li>
          <li><a href="../../../../doc/creating_doc/html/index.html">Creating documentation</a></li>
          <li><a href="../../../../doc/coding_conventions/html/index.html">Coding conventions</a></li>
          <li><a href="../../../../doc/index/html/index.html">Index</a></li>
          <li><a href="../../../../doc/FAQ/html/index.html">FAQ</a></li>
        </ul>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Get it <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../../doc/the_distribution/html/index.html">Installation guide</a></li>
            <li><a href="../../../../doc/subversion/html/index.html">Get code from subversion repository</a></li>
            <li><a href="../../../../doc/download/html/index.html">Get code as tar file</a></li>
            <li><a href="../../../../doc/copyright/html/index.html">Copyright</a></li>
          </ul>
        </li>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">About <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../../doc/people/html/index.html">People</a></li>            
            <li><a href="../../../../doc/contact/html/index.html">Contact/Get involved</a></li>
            <li><a href="../../../../doc/publications/html/index.html">Publications</a></li>
            <li><a href="../../../../doc/acknowledgements/html/index.html">Acknowledgements</a></li>
            <li><a href="../../../../doc/picture_show/index.html">Picture show</a></li>
          </ul>
        </li>
      </li>
    </ul>
    <ul class="nav navbar-nav navbar-right navbar-search">
      <form class="navbar-form" role="search" action="../../../../doc/search_results/html/index.html">
        <div class="input-group">
          <input type="text" class="form-control" placeholder="Search" name="q">
          <span class="input-group-btn">
            <button class="btn btn-default" type="submit">Go</button>
          </span>
        </div><!-- /input-group -->
       <!--<div class="form-group">
          <input type="text" class="form-control" placeholder="Search">
        </div>
        <button type="submit" class="btn btn-default">Submit</button>-->
      </form>
    </ul>
  </div><!-- /.navbar-collapse -->
</div><!-- /.container-fluid -->
</div>
</nav>
<!-- Generated by Doxygen 1.8.17 -->
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_ddb094a380b94394dbbcf95a63b535e6.html">demo_drivers</a></li><li class="navelem"><a class="el" href="dir_5e95af49491505dfde4ba94a1a4cc2d9.html">poisson</a></li><li class="navelem"><a class="el" href="dir_2ef2a9972e253beb4df9cf4653ed8b55.html">fish_poisson2</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">fish_domain.cc</div>  </div>
</div><!--header-->
<div class="contents">
<a href="fish__domain_8cc.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">//LIC// ====================================================================</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">//LIC// This file forms part of oomph-lib, the object-oriented, </span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">//LIC// multi-physics finite-element library, available </span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">//LIC// at http://www.oomph-lib.org.</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">//LIC// Copyright (C) 2006-2021 Matthias Heil and Andrew Hazel</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">//LIC// This library is free software; you can redistribute it and/or</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">//LIC// modify it under the terms of the GNU Lesser General Public</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">//LIC// License as published by the Free Software Foundation; either</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">//LIC// version 2.1 of the License, or (at your option) any later version.</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">//LIC// This library is distributed in the hope that it will be useful,</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">//LIC// but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">//LIC// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">//LIC// Lesser General Public License for more details.</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">//LIC// You should have received a copy of the GNU Lesser General Public</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">//LIC// License along with this library; if not, write to the Free Software</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">//LIC// Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">//LIC// 02110-1301  USA.</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">//LIC// The authors may be contacted at oomph-lib@maths.man.ac.uk.</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">//LIC//====================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">/// Driver code for mucking around with GeomObjects, MacroElements</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">/// and Domains</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment">// Generic oomph-lib headers</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#include &quot;generic.h&quot;</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160; </div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment">// The fish domain</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#include &quot;meshes/fish_domain.h&quot;</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160; </div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="keyword">using namespace </span>std;</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160; </div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="keyword">using namespace </span>oomph;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160; </div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment">//=======================start_of_unit_circle==============================</span><span class="comment"></span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment">/// Unit circle in 2D, centred at the origin, parametrised by a single</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment">/// Lagrangian coordinate, the polar angle.</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment"></span><span class="comment">//=========================================================================</span></div>
<div class="line"><a name="l00043"></a><span class="lineno"><a class="line" href="classUnitCircle.html">   43</a></span>&#160;<span class="keyword">class </span><a class="code" href="classUnitCircle.html">UnitCircle</a> : <span class="keyword">public</span> <a class="code" href="fish__poisson2_8txt.html#a21f866477909132765bd833a91c16259">GeomObject</a></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;{</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160; </div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160; <span class="keyword">public</span>:</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment">  /// \short Constructor: Pass the number of Lagrangian</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment">  /// and Eulerian coordinates to the constructor of the</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment">  ///  GeomObject base class.</span></div>
<div class="line"><a name="l00051"></a><span class="lineno"><a class="line" href="classUnitCircle.html#a494ddf1cb37b659c6f8c44ddde2b9b33">   51</a></span>&#160;<span class="comment"></span>  <a class="code" href="classUnitCircle.html#a494ddf1cb37b659c6f8c44ddde2b9b33">UnitCircle</a>() : <a class="code" href="fish__poisson2_8txt.html#a21f866477909132765bd833a91c16259">GeomObject</a>(1,2) {}</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment">  /// Destructor -- emtpy</span></div>
<div class="line"><a name="l00054"></a><span class="lineno"><a class="line" href="classUnitCircle.html#a9eb314d8152f5de298e1e155737a69b9">   54</a></span>&#160;<span class="comment"></span>  <span class="keyword">virtual</span> <a class="code" href="classUnitCircle.html#a9eb314d8152f5de298e1e155737a69b9">~UnitCircle</a>(){}</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment">  /// \short Position vector, r, to the point on the circle identified by  </span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="comment">  /// its 1D Lagrangian coordinate, xi (passed as a 1D Vector):</span></div>
<div class="line"><a name="l00058"></a><span class="lineno"><a class="line" href="classUnitCircle.html#adc7fc660ba1d2ecc5bcbe2312e2fb87b">   58</a></span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> <a class="code" href="classUnitCircle.html#adc7fc660ba1d2ecc5bcbe2312e2fb87b">position</a>(<span class="keyword">const</span> Vector&lt;double&gt;&amp; <a class="code" href="fish__poisson2_8txt.html#a296cf8991ee09d7e9a1beeb8ad3da837">xi</a>, Vector&lt;double&gt;&amp; r)<span class="keyword"> const</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;   <span class="comment">// Eulerian position vector</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;   r[0] = cos(<a class="code" href="fish__poisson2_8txt.html#a296cf8991ee09d7e9a1beeb8ad3da837">xi</a>[0]);</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;   r[1] = sin(<a class="code" href="fish__poisson2_8txt.html#a296cf8991ee09d7e9a1beeb8ad3da837">xi</a>[0]);</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  }</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160; </div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment">  /// \short Position vector, r, to the point on the circle identified by  </span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment">  /// its 1D Lagrangian coordinate, xi (passed as a 1D Vector) at discrete time</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment">  /// level t (t=0: present; t&gt;0: previous). The shape of the object </span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="comment">  /// is not time-dependent, therefore we forward this call to the </span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="comment">  /// steady version. </span></div>
<div class="line"><a name="l00071"></a><span class="lineno"><a class="line" href="classUnitCircle.html#aef5327f81f396de4ecbf8c0aa7de08d3">   71</a></span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> <a class="code" href="classUnitCircle.html#aef5327f81f396de4ecbf8c0aa7de08d3">position</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; t, <span class="keyword">const</span> Vector&lt;double&gt;&amp; <a class="code" href="fish__poisson2_8txt.html#a296cf8991ee09d7e9a1beeb8ad3da837">xi</a>, </div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;                Vector&lt;double&gt;&amp; r)<span class="keyword"> const</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;   position(<a class="code" href="fish__poisson2_8txt.html#a296cf8991ee09d7e9a1beeb8ad3da837">xi</a>,r);</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  }</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160; </div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;}; <span class="comment">// end of unit circle class</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160; </div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160; </div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160; </div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160; </div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160; </div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160; </div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="comment">//===================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="comment">/// Driver code for mucking around with GeomObjects, MacroElements</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="comment">/// and domains</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="comment"></span><span class="comment">//===================================================================</span></div>
<div class="line"><a name="l00088"></a><span class="lineno"><a class="line" href="fish__domain_8cc.html#ae66f6b31b5ad750f1fe042a706a4e3d4">   88</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="fish__domain_8cc.html#ae66f6b31b5ad750f1fe042a706a4e3d4">main</a>()</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;{</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160; </div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160; </div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160; <span class="comment">// Play around with a GeomObject</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160; <span class="comment">//------------------------------</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160; </div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160; <span class="comment">// Create a unit circle</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160; <a class="code" href="classUnitCircle.html">UnitCircle</a> unit_circle;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160; </div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160; <span class="comment">// Plot:</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160; ofstream circle_file(<span class="stringliteral">&quot;unit_circle.dat&quot;</span>);</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160; </div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160; <span class="comment">// Number of plot points</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160; <span class="keywordtype">unsigned</span> nplot=50;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160; </div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160; <span class="comment">// 1D vector for the Lagrangian coordinate</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160; Vector&lt;double&gt; s(1);</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160; </div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160; <span class="comment">// 2D vector for the Eulerian position</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160; Vector&lt;double&gt; r(2);</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160; </div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160; <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="fish__poisson2_8txt.html#a04763e696f9abee872a515865c843251">i</a>=0;<a class="code" href="fish__poisson2_8txt.html#a04763e696f9abee872a515865c843251">i</a>&lt;nplot;<a class="code" href="fish__poisson2_8txt.html#a04763e696f9abee872a515865c843251">i</a>++)</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  {</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;   <span class="comment">// Lagrangian coordinate at plot point</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;   s[0]=2.0*MathematicalConstants::Pi*double(<a class="code" href="fish__poisson2_8txt.html#a04763e696f9abee872a515865c843251">i</a>)/double(nplot-1);</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160; </div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;   <span class="comment">// Get Eulerian position vector from GeomObject:</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;   unit_circle.<a class="code" href="classUnitCircle.html#adc7fc660ba1d2ecc5bcbe2312e2fb87b">position</a>(s,r);</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160; </div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;   <span class="comment">// Plot</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;   circle_file &lt;&lt; r[0] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; r[1] &lt;&lt; std::endl;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  }</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;   </div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;   </div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160; <span class="comment">// Close output file</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160; circle_file.close();</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160; </div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160; </div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160; </div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160; </div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160; </div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160; <span class="comment">// Build a FishDomain and plot it</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160; <span class="comment">//-------------------------------</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160; </div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160; </div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160; <span class="comment">// Create the fish&#39;s back as a circle of radius 1, centred at (0.5,0.0)</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160; <span class="keywordtype">double</span> x_c=0.5;</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160; <span class="keywordtype">double</span> <a class="code" href="fish__poisson2_8txt.html#a824e389b6c88d0ae12c1e97b08712cd3">y_c</a>=0.0;</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160; <span class="keywordtype">double</span> <a class="code" href="fish__poisson2_8txt.html#a4f499ba251dff6813d20832f9f36834a">r_back</a>=1.0;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160; <a class="code" href="fish__poisson2_8txt.html#a21f866477909132765bd833a91c16259">GeomObject</a>* <a class="code" href="fish__poisson2_8txt.html#a68a3f92caf63697dc8a7fa23dcd50d53">back_pt</a>=<span class="keyword">new</span> Circle(x_c,<a class="code" href="fish__poisson2_8txt.html#a824e389b6c88d0ae12c1e97b08712cd3">y_c</a>,<a class="code" href="fish__poisson2_8txt.html#a4f499ba251dff6813d20832f9f36834a">r_back</a>);</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160; </div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160; </div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160; <span class="comment">// Start and end coordinates of the fish back</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160; <span class="keywordtype">double</span> s_nose=2.6; </div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160; <span class="keywordtype">double</span> s_tail=0.4; </div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160; </div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160; <span class="comment">// Create the domain</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160; <a class="code" href="fish__poisson2_8txt.html#a36182deccc274d25f67a270c999c54c3">Domain</a>* <a class="code" href="fish__poisson2_8txt.html#af5f8290ba6539fcd5dd8fb6357487caa">domain_pt</a>=<span class="keyword">new</span> <a class="code" href="fish__poisson2_8txt.html#a42536cd36f5f484d09e2343c570769c0">FishDomain</a>(<a class="code" href="fish__poisson2_8txt.html#a68a3f92caf63697dc8a7fa23dcd50d53">back_pt</a>,s_nose,s_tail);</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160; </div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160; </div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160; <span class="comment">// Plot the domain</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160; </div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160; <span class="comment">// Number of plot points in each coordinate direction.</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160; <span class="keywordtype">unsigned</span> npts=10;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160; </div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160; <span class="comment">// Output domain (= plot its macro elements) and the macro element boundaries</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160; ofstream domain_file(<span class="stringliteral">&quot;fish_domain.dat&quot;</span>);</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160; <a class="code" href="fish__poisson2_8txt.html#af5f8290ba6539fcd5dd8fb6357487caa">domain_pt</a>-&gt;output(domain_file,npts);</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160; <a class="code" href="fish__poisson2_8txt.html#af5f8290ba6539fcd5dd8fb6357487caa">domain_pt</a>-&gt;output_macro_element_boundaries(domain_file,npts);</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160; domain_file.close();</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160; </div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160; </div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;}</div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="aclassUnitCircle_html"><div class="ttname"><a href="classUnitCircle.html">UnitCircle</a></div><div class="ttdef"><b>Definition:</b> <a href="fish__domain_8cc_source.html#l00043">fish_domain.cc:43</a></div></div>
<div class="ttc" id="aclassUnitCircle_html_adc7fc660ba1d2ecc5bcbe2312e2fb87b"><div class="ttname"><a href="classUnitCircle.html#adc7fc660ba1d2ecc5bcbe2312e2fb87b">UnitCircle::position</a></div><div class="ttdeci">void position(const Vector&lt; double &gt; &amp;xi, Vector&lt; double &gt; &amp;r) const</div><div class="ttdoc">Position vector, r, to the point on the circle identified by   its 1D Lagrangian coordinate,...</div><div class="ttdef"><b>Definition:</b> <a href="fish__domain_8cc_source.html#l00058">fish_domain.cc:58</a></div></div>
<div class="ttc" id="afish__poisson2_8txt_html_a42536cd36f5f484d09e2343c570769c0"><div class="ttname"><a href="fish__poisson2_8txt.html#a42536cd36f5f484d09e2343c570769c0">FishDomain</a></div><div class="ttdeci">endcode To see how this works let us have a look at the c FishDomain constructor The constructor stores the pointer to the fish s and the start and end values of the Lagrangian coordinates in the private data members c c Xi_nose and c Xi_tail Next we set some additional that define the we allocate storage for the four c MacroElements and build them Note that the constructor of the c MacroElement takes a pointer to the and the c MacroElement s number within that c dontinclude fish_domain h skipline Destructor for FishDomain</div><div class="ttdef"><b>Definition:</b> <a href="fish__poisson2_8txt_source.html#l00318">fish_poisson2.txt:318</a></div></div>
<div class="ttc" id="afish__poisson2_8txt_html_a36182deccc274d25f67a270c999c54c3"><div class="ttname"><a href="fish__poisson2_8txt.html#a36182deccc274d25f67a270c999c54c3">Domain</a></div><div class="ttdeci">endcode To see how this works let us have a look at the c FishDomain constructor The constructor stores the pointer to the fish s and the start and end values of the Lagrangian coordinates in the private data members c c Xi_nose and c Xi_tail Next we set some additional that define the we allocate storage for the four c MacroElements and build them Note that the constructor of the c MacroElement takes a pointer to the Domain</div><div class="ttdef"><b>Definition:</b> <a href="fish__poisson2_8txt_source.html#l00302">fish_poisson2.txt:302</a></div></div>
<div class="ttc" id="afish__poisson2_8txt_html_a4f499ba251dff6813d20832f9f36834a"><div class="ttname"><a href="fish__poisson2_8txt.html#a4f499ba251dff6813d20832f9f36834a">r_back</a></div><div class="ttdeci">double r_back</div><div class="ttdef"><b>Definition:</b> <a href="fish__poisson2_8txt_source.html#l00274">fish_poisson2.txt:274</a></div></div>
<div class="ttc" id="afish__poisson2_8txt_html_a04763e696f9abee872a515865c843251"><div class="ttname"><a href="fish__poisson2_8txt.html#a04763e696f9abee872a515865c843251">i</a></div><div class="ttdeci">1}^2 \frac{\partial^2u}{\partial x_i^2}=-1, \ \ \ \ \ \ \ \ \ \ @E[2DPoisson]@ \f] in the fish-shaped domain \f $D_{fish} \f$ with homogeneous Dirichlet boundary conditions \f[\left. u\right|_{\partial D_{fish}}=0. \ \ \ \ \ \ \ \ \ \ @E[2DPoisson_BC]@ \f]&lt;/TD &gt;&lt;/TR &gt;&lt;/TABLE &gt;&lt;/CENTER &gt; In Part 1 of this document we shall explain how \c oomph-lib 's mesh adaptation procedures employ the \c Domain and \c MacroElement objects to adapt meshes in domains with curvilinear boundaries. In Part 2, we demonstrate how to create new \c Domain objects.&lt; HR &gt; \section adapt Part 1:Mesh adaptation in domains with curvilinear boundaries, using Domain and MacroElement objects The plot below shows the domain \f $D_{fish} \f$, represented by the multi-coloured, shaded region and its(extremely coarse) discretisation with four four-node quad elements. The elements' edges and nodes are shown in black. @I w 0.75\textwidth coarse_fish_mesh_and_domain &quot;The fish-shaped domain and its discretisation with four four-node quad elements &quot; Obviously, the curvilinear boundaries of the fish-shaped domain(arcs of circles) are very poorly resolved by the elements' straight edges. Simple mesh adaptation, based on the techniques described in the&lt; A HREF=&quot;../../../../doc/poisson/two_d_poisson_adapt/html/index.html&quot;&gt; earlier example&lt;/A &gt; will not result in convergence to the exact solution since the refined mesh never approaches the exact domain geometry:@I w 0.75\textwidth fish_poisson_soln_no_macro &quot;Plot of the mesh adaptation without MacroElements &quot; To overcome this problem, the mesh adaptation routines must be given access to an exact, analytical representation of the actual domain. This is the purpose of \c oomph-lib 's \c Domain object. A \c Domain provides an analytical description of a mathematical domain, by decomposing it into a number of so-called \c MacroElements. Each \c MacroElement provides a mapping between a set of local and global coordinates \f$ {\bf r}_{macro}({\bf s})\f$ -- similar to the mapping between the local and global coordinates in a finite element. The key difference between the two types of element is that the \c MacroElement mapping resolves curvilinear domain boundaries exactly, whereas the finite element mapping interpolates the global coordinates between the coordinates of its nodes. The topology of \c MacroElements mirrors that of the associated(geometric) finite elements:For instance, the \c QMacroElement family is the counterpart of the \c QElement family of geometric finite elements. Both are templated by the spatial dimension, and the local coordinates(in their right-handed local coordinate systems) are in the range between -1 and+1. The different-coloured, shaded regions in the above sketch represent the four two-dimensional \c QMacroElements by which the \c FishDomain represents the fish-shaped domain \f$ D_{fish} \f$. For instance, \c MacroElement 0(shown in orange) represents the lower half of the fish 's body i</div><div class="ttdef"><b>Definition:</b> <a href="fish__poisson2_8txt_source.html#l00106">fish_poisson2.txt:106</a></div></div>
<div class="ttc" id="aclassUnitCircle_html_a9eb314d8152f5de298e1e155737a69b9"><div class="ttname"><a href="classUnitCircle.html#a9eb314d8152f5de298e1e155737a69b9">UnitCircle::~UnitCircle</a></div><div class="ttdeci">virtual ~UnitCircle()</div><div class="ttdoc">Destructor â€“ emtpy.</div><div class="ttdef"><b>Definition:</b> <a href="fish__domain_8cc_source.html#l00054">fish_domain.cc:54</a></div></div>
<div class="ttc" id="afish__poisson2_8txt_html_af5f8290ba6539fcd5dd8fb6357487caa"><div class="ttname"><a href="fish__poisson2_8txt.html#af5f8290ba6539fcd5dd8fb6357487caa">domain_pt</a></div><div class="ttdeci">Domain * domain_pt</div><div class="ttdef"><b>Definition:</b> <a href="fish__poisson2_8txt_source.html#l00288">fish_poisson2.txt:288</a></div></div>
<div class="ttc" id="aclassUnitCircle_html_aef5327f81f396de4ecbf8c0aa7de08d3"><div class="ttname"><a href="classUnitCircle.html#aef5327f81f396de4ecbf8c0aa7de08d3">UnitCircle::position</a></div><div class="ttdeci">void position(const unsigned &amp;t, const Vector&lt; double &gt; &amp;xi, Vector&lt; double &gt; &amp;r) const</div><div class="ttdoc">Position vector, r, to the point on the circle identified by   its 1D Lagrangian coordinate,...</div><div class="ttdef"><b>Definition:</b> <a href="fish__domain_8cc_source.html#l00071">fish_domain.cc:71</a></div></div>
<div class="ttc" id="afish__poisson2_8txt_html_a68a3f92caf63697dc8a7fa23dcd50d53"><div class="ttname"><a href="fish__poisson2_8txt.html#a68a3f92caf63697dc8a7fa23dcd50d53">back_pt</a></div><div class="ttdeci">GeomObject * back_pt</div><div class="ttdef"><b>Definition:</b> <a href="fish__poisson2_8txt_source.html#l00275">fish_poisson2.txt:275</a></div></div>
<div class="ttc" id="afish__poisson2_8txt_html_a296cf8991ee09d7e9a1beeb8ad3da837"><div class="ttname"><a href="fish__poisson2_8txt.html#a296cf8991ee09d7e9a1beeb8ad3da837">xi</a></div><div class="ttdeci">endcode we pass locating the nose end of the fish s back at f xi</div><div class="ttdef"><b>Definition:</b> <a href="fish__poisson2_8txt_source.html#l00281">fish_poisson2.txt:281</a></div></div>
<div class="ttc" id="aclassUnitCircle_html_a494ddf1cb37b659c6f8c44ddde2b9b33"><div class="ttname"><a href="classUnitCircle.html#a494ddf1cb37b659c6f8c44ddde2b9b33">UnitCircle::UnitCircle</a></div><div class="ttdeci">UnitCircle()</div><div class="ttdoc">Constructor: Pass the number of Lagrangian and Eulerian coordinates to the constructor of the GeomObj...</div><div class="ttdef"><b>Definition:</b> <a href="fish__domain_8cc_source.html#l00051">fish_domain.cc:51</a></div></div>
<div class="ttc" id="afish__domain_8cc_html_ae66f6b31b5ad750f1fe042a706a4e3d4"><div class="ttname"><a href="fish__domain_8cc.html#ae66f6b31b5ad750f1fe042a706a4e3d4">main</a></div><div class="ttdeci">int main()</div><div class="ttdef"><b>Definition:</b> <a href="fish__domain_8cc_source.html#l00088">fish_domain.cc:88</a></div></div>
<div class="ttc" id="afish__poisson2_8txt_html_a21f866477909132765bd833a91c16259"><div class="ttname"><a href="fish__poisson2_8txt.html#a21f866477909132765bd833a91c16259">GeomObject</a></div><div class="ttdeci">see the&lt; A HREF=&quot;../../../../doc/poisson/two_d_poisson_flux_bc/html/index.html&quot;&gt; earlier example&lt;/A &gt; for a discussion of virtual broken functions Here is a complete example of a specific c GeomObject</div><div class="ttdef"><b>Definition:</b> <a href="fish__poisson2_8txt_source.html#l00249">fish_poisson2.txt:249</a></div></div>
<div class="ttc" id="afish__poisson2_8txt_html_a824e389b6c88d0ae12c1e97b08712cd3"><div class="ttname"><a href="fish__poisson2_8txt.html#a824e389b6c88d0ae12c1e97b08712cd3">y_c</a></div><div class="ttdeci">double y_c</div><div class="ttdef"><b>Definition:</b> <a href="fish__poisson2_8txt_source.html#l00273">fish_poisson2.txt:273</a></div></div>

    <!-- jQuery for Bootstrap and Doxygen -->
    <script src="../../../js/jquery-1.12.0.min.js"></script>
    <!-- Minified boostrap plugins-->
    <script src="../../../js/bootstrap.js"></script>
    <!-- Doxygen dependency to add powertips to source code-->
    <script src="../../../js/jquery.powertip.min.js"></script>
    <!-- The  following script is generated by doxygen and hides/shows levels in 
         the data structure lists and adds powertips to source code-->
    <script src="../../../js/dynsections.js" ></script>
    <!-- add to Doxygen's class names so bootstrap css and js recognises them-->
    <script type="text/javascript">
    $(".contents").addClass("container");
    $(".header").addClass("container");
    $(".navpath").addClass("container");
    $("#navrow3").addClass("container");
    $("#navrow4").addClass("container");
    $(".mlabel").addClass("label");
    $(".mlabel").addClass("label-default");
    $(".memitem").addClass("panel");
    $(".memitem").addClass("panel-info");
    $(".memproto").addClass("panel-heading");
    $(".memdoc").addClass("panel-body");
    </script>
    <footer>
      <div class="container">
        <div class="text-muted" style="float:right;">Generated by <a href="http://www.doxygen.org/index.html">
          <img style="height:18px;" class="footer-img" src="doxygen.png" alt="doxygen"></a> on Wed Jul 21 2021 17:58:03
        </div>
      </div>
    </footer>
</body>
</html>

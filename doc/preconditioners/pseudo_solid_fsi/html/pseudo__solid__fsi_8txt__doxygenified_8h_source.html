<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
<title>oomph-lib: pseudo_solid_fsi.txt_doxygenified.h Source File</title>
<link rel="apple-touch-icon" sizes="57x57" href="../../../figures/apple-touch-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="../../../figures/apple-touch-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="../../../figures/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="../../../figures/apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="../../../figures/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="../../../figures/apple-touch-icon-120x120.png">
<link rel="icon" type="image/png" href="../../../figures/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="../../../figures/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="../../../figures/favicon-16x16.png" sizes="16x16">
<link rel="manifest" href="../../../figures/manifest.json">
<link rel="mask-icon" href="../../../figures/safari-pinned-tab.svg" color="#008000">
<link rel="shortcut icon" href="../../../figures/favicon.ico">
<meta name="msapplication-TileColor" content="#00a300">
<meta name="msapplication-config" content="../../../figures/browserconfig.xml">
<meta name="theme-color" content="#008000">
<link href="http://fonts.googleapis.com/css?family=Open+Sans:400,300,600" rel="stylesheet" type="text/css">
<!-- Doxygen css-->
<!-- <link rel="stylesheet" type="text/css" href="doxygen.css"> -->
<!-- Bootstrap -->
<link href="../../../css/bootstrap.css" rel="stylesheet">
<!-- oomph-lib specific overrides -->
<link rel="stylesheet" type="text/css" href="../../../css/oomph_header.css">
</head>
<body>
<nav class="navbar navbar-default">
<div class="container">
<div class="container-fluid">
  <!-- Brand and toggle get grouped for better mobile display -->
  <div class="navbar-header">
    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
      <span class="sr-only">Toggle navigation</span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="../../../html/index.html"><img alt="oomph-lib" src="../../../figures/oomph_logo.png"></a>
  </div>
  <!-- Collect the nav links, forms, and other content for toggling -->
  <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
    <ul class="nav navbar-nav">          
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Documentation <span class="caret"></span></a>
        <ul class="dropdown-menu">
          <li class="dropdown-header">Big picture</li>
          <li><a href="../../../../doc/intro/html/index.html">The finite element method</a></li>
          <li><a href="../../../../doc/the_data_structure/html/index.html">The data structure</a></li>
          <li><a href="../../../../doc/quick_guide/html/index.html">Not-so-quick guide</a></li>
          <li><a href="../../../../doc/optimisation/html/index.html">Optimisation</a></li>
          <li><a href="../../../../doc/order_of_action_functions/html/index.html">Order of action functions</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Example codes and tutorials</li>
          <li><a href="../../../../doc/example_code_list/html/index.html">List of example codes and tutorials</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#meshes">Meshing</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#solvers">Solvers</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#parallel">MPI parallel processing</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#visualisation">Post-processing/visualisation</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Other</li>
          <li><a href="../../../../doc/change_log/html/index.html">Change log</a></li>
          <li><a href="../../../../doc/creating_doc/html/index.html">Creating documentation</a></li>
          <li><a href="../../../../doc/coding_conventions/html/index.html">Coding conventions</a></li>
          <li><a href="../../../../doc/index/html/index.html">Index</a></li>
          <li><a href="../../../../doc/FAQ/html/index.html">FAQ</a></li>
        </ul>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Get it <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../../doc/the_distribution/html/index.html">Installation guide</a></li>
            <li><a href="../../../../doc/subversion/html/index.html">Get code from subversion repository</a></li>
            <li><a href="../../../../doc/download/html/index.html">Get code as tar file</a></li>
            <li><a href="../../../../doc/copyright/html/index.html">Copyright</a></li>
          </ul>
        </li>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">About <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../../doc/people/html/index.html">People</a></li>            
            <li><a href="../../../../doc/contact/html/index.html">Contact/Get involved</a></li>
            <li><a href="../../../../doc/publications/html/index.html">Publications</a></li>
            <li><a href="../../../../doc/acknowledgements/html/index.html">Acknowledgements</a></li>
            <li><a href="../../../../doc/picture_show/index.html">Picture show</a></li>
          </ul>
        </li>
      </li>
    </ul>
    <ul class="nav navbar-nav navbar-right navbar-search">
      <form class="navbar-form" role="search" action="../../../../doc/search_results/html/index.html">
        <div class="input-group">
          <input type="text" class="form-control" placeholder="Search" name="q">
          <span class="input-group-btn">
            <button class="btn btn-default" type="submit">Go</button>
          </span>
        </div><!-- /input-group -->
       <!--<div class="form-group">
          <input type="text" class="form-control" placeholder="Search">
        </div>
        <button type="submit" class="btn btn-default">Submit</button>-->
      </form>
    </ul>
  </div><!-- /.navbar-collapse -->
</div><!-- /.container-fluid -->
</div>
</nav>
<!-- Generated by Doxygen 1.8.17 -->
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">pseudo_solid_fsi.txt_doxygenified.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="pseudo__solid__fsi_8txt__doxygenified_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">\mainpage Demo problem: A preconditioner for the solution of fluid-structure interaction problems with (pseudo-)solid fluid mesh updates</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">In this tutorial we re-visit the solution of fluid-structure </span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">interaction problems with (pseudo-)solid fluid mesh updates,</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">focusing on the efficient solution of the governing equations</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">by GMRES, using the problem-specific block-preconditioner developed</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">in </span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">&lt;center&gt;</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">Muddle, R.L., Mihajlovic, M. &amp; Heil, M. (2012)</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">An efficient preconditioner for monolithically-coupled </span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">large-displacement fluid-structure interaction problems </span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">with pseudo-solid mesh updates. &lt;em&gt;Journal of Computational Physics&lt;/em&gt;</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">&lt;b&gt;231&lt;/b&gt;, 7315-7334. DOI: </span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">&lt;a href=&quot;http://dx.doi.org/10.1016/j.jcp.2012.07.001&quot;&gt;</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">10.1016/j.jcp.2012.07.001&lt;/a&gt;</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">&lt;/center&gt;</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">where full details of the analysis and further results from a </span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">variety of other test problems can be found.</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment"> </span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">&lt;HR&gt; </span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">\section model Background: Problem formulation, the resulting linear system and the preconditioner</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment">We will demonstrate the development and application </span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment">of the preconditioner using the</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">problem of flow in a 2D channel with an elastic leaflet discussed in</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment">&lt;a href=&quot;../../../interaction/fsi_channel_with_leaflet/html/index.html&quot;&gt;</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment">another tutorial&lt;/a&gt; and illustrated in the sketch below:</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment">\image html fsi_channel_with_leaflet.gif &quot;Sketch of the problem. &quot; </span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment">\image latex fsi_channel_with_leaflet.eps &quot;Sketch of the problem. &quot; width=0.75\textwidth</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment">Flow is driven (via an imposed parabolic inflow profile) through a 2D channel </span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment">which is partially obstructed by a thin-walled elastic leaflet.</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment">The fluid leaves the domain at the far downstream end of the channel</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment">where we assume parallel, axially traction-free outflow. </span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment">We use the same discretisation (2D quadrilateral</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment">Taylor-Hood elements for the fluid; 1D Hermite beam elements for the</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment">leaflet) as in the </span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment">&lt;a href=&quot;../../../interaction/fsi_channel_with_leaflet/html/index.html&quot;&gt;</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment">original tutorial&lt;/a&gt;. However, here we perform the fluid mesh update </span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment">in response to the deformation of the elastic leaflet using a pseudo-elastic</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment">approach. This is done by &quot;wrapping&quot; the underlying  \c</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment">QTaylorHoodElement into a \c PseudoSolidNodeUpdateElement</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment">and employing \c ImposeDisplacementByLagrangeMultiplierElements </span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment">to impose the deformation of the elastic leaflet onto the (pseudo-solid)</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment">fluid mesh. The following tutorials discuss the</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment">relevant methodologies:</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment">- &lt;a href=&quot;../../../solid/prescribed_displ_lagr_mult/html/index.html&quot;&gt;</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment">  The use of Lagrange multipliers to impose displacement constraints</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment">  onto (pseudo-)solids.&lt;/a&gt;\n\n</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="comment">- &lt;a href=&quot;../../../interaction/unstructured_fsi/html/index.html&quot;&gt;</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment">  The use of pseudo-elasticity to deform the fluid mesh in FSI</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment">  problems.&lt;/a&gt; \n\n</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment">.</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment">The discretised problem contains the </span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment">following types of discrete unknowns:</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment">- The fluid degrees of freedom (velocities and pressures).\n\n</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment">- The nodal positions (real and generalised; the latter representing</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment">  derivative degrees of freedom in the Hermite elements used to</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment">  discretise the leaflet; see the </span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment">  &lt;a href=&quot;../../../beam/tensioned_string/html/index.html&quot;&gt;</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="comment">  beam theory tutorial&lt;/a&gt; for details) of the elastic leaflet.\n\n</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="comment">- The nodal positions in the fluid mesh. \n\n</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="comment">- The nodal values representing the components of the (vector-valued)</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="comment">  Lagrange multipliers which impose the motion of the elastic leaflet</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment">  on the pseudo-elastic fluid mesh. These unknowns only exist for the</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="comment">  fluid nodes on the FSI boundary.</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="comment">.</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="comment">Using this classification of the unknowns,</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="comment">the linear system to be solved in the course </span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="comment">of the Newton iteration can be re-ordered </span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="comment">into the following block structure:</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="comment">J_{\rm FSI} \ \Delta {\bf x} = </span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment"> \left[</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="comment">\begin{array}{c|c|cc}</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="comment">F&amp; &amp;C_{\rm fx}&amp;\\ \hline C_{\rm sf}&amp;S&amp;C_{\rm sx}&amp;\\ \hline</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="comment">&amp;&amp;E&amp;C_{\rm xl}\\ &amp;C_{\rm ls}&amp;C_{\rm lx}&amp;\\</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="comment">\end{array}</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="comment">\right] \left[</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="comment">\begin{array}{c}</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="comment"> \Delta {\bf F}\\ </span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="comment">\hline \Delta {\bf S}\\ </span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="comment">\hline \Delta {\bf X}\\ </span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="comment">\Delta {\bf L}\\</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="comment">\end{array}</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="comment">\right] =- \left[</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="comment">\begin{array}{c}</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment">{\bf r}_{\rm f}\\ </span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="comment">\hline {\bf r}_{\rm s}\\ </span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="comment">\hline {\bf r}_{\rm x}\\ </span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="comment">{\bf r}_{\rm l}\\</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="comment">\end{array}</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="comment">\right] </span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="comment">\ \ \ \ \ \ \ \ (1)</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="comment">where the vector \f${\bf F}\f$ contains the Navier-Stokes (fluid) unknowns </span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="comment">(velocities and pressure), \f${\bf S}\f$ represents unknowns describing the</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="comment">deformation of the fluid-loaded solid, \f${\bf X}\f$ represents </span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="comment">the nodal positions in the fluid mesh, and \f${\bf L}\f$ contains </span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="comment">the discrete Lagrange multipliers which impose</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="comment">the deformation of the FSI boundary in the fluid mesh.</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="comment">The three diagonal blocks in the Jacobian matrix, \f$J_{\rm FSI}\f$, are </span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="comment">the two ``single-physics&#39;&#39; </span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="comment">Jacobian matrices (\f$F\f$, the Navier-Stokes Jacobian; \f$S\f$, the </span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="comment">tangent stiffness matrix of the fluid-loaded solid) and </span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="comment">the Jacobian, </span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="comment">J_{\rm PS} = </span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="comment">\left[</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="comment">\begin{array}{cc}</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="comment">E&amp;C_{\rm xl}\\ </span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="comment">C_{\rm lx}&amp;\\</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="comment">\end{array}</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="comment">\right]</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="comment">associated with the Lagrange-multiplier-constrained pseudo-elasticity</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="comment">problem governing the fluid mesh update, discussed in more detail</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="comment">in &lt;a href=&quot;../../prescribed_displ_lagr_mult/html/index.html&quot;&gt;</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="comment">another tutorial&lt;/a&gt;.</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="comment">The non-zero off-diagonal blocks arise through the interactions between </span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="comment">the various single-physics</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="comment">problems: \f$C_{\rm fx}\f$ represents the effect of the pseudo-solid unknowns </span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="comment">(the nodal positions in the fluid mesh) on the discretised </span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="comment">Navier--Stokes equations -- this incorporates the so-called shape-derivatives</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="comment">and the time-discretised version of the no-slip condition on the FSI</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="comment">boundary which expresses the fluid velocities in </span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="comment">terms of the nodal velocities of the fluid mesh. </span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="comment">\f$C_{\rm sf}\f$ captures the effect of the fluid traction (pressure and shear </span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="comment">stresses) on the fluid-loaded solid. Since the shear stresses depend</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="comment">on gradients of the fluid velocity, the traction </span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="comment">is also affected by the nodal positions in the fluid mesh -- this</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="comment">dependency gives rise to the matrix \f$C_{\rm sx}\f$. Finally, \f$C_{\rm</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="comment">ls}\f$ arises because the prescribed boundary displacement of the fluid </span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="comment">mesh depends</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="comment">on the displacement field in the fluid-loaded solid. The zero \f$ &quot;fs&quot;</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="comment">\f$ block</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="comment">reflects the fact that the discretised Navier-Stokes equations do not</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="comment">depend directly on the displacement field of the actual solid. The</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="comment">zero \f$ &quot;xf&quot; \f$ block indicates that the </span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="comment">pseudo-solid equations are not affected by the fluid unknowns. The </span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="comment">\f$ &quot;xs&quot;\f$ block is zero</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="comment">because the real solid affects the pseudo-solid only indirectly</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="comment">via the Lagrange multiplier constraint (which gives rise to  \f$C_{\rm</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="comment">ls}\f$). Finally, the non-zero blocks in the last block column</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="comment">reflect the fact that the Lagrange multiplier is only used to </span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="comment">enforce the displacement constraint </span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="comment">in a one-way coupling in which the real solid affects the pseudo-solid </span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="comment">but not vice versa.</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="comment">See &lt;a href=&quot;http://dx.doi.org/10.1016/j.jcp.2012.07.001&quot;&gt;</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="comment">Muddle, Mihajlovic &amp; Heil (2012) &lt;/a&gt; for more detail.</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="comment">To construct a preconditioner for the linear system</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="comment">(1) we replace the</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="comment">bottom-right \f$2 \times 2\f$ block in the Jacobian with the pseudo-solid</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="comment">preconditioner, </span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="comment">{\cal P}_{\rm PS} = \left[</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="comment">\begin{array}{cc}</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="comment">E_{\rm aug}&amp;\\</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="comment">&amp;W</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="comment">\end{array}</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="comment">\right]</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="comment">\ \ \ \ \ \ \ \ \ \ \ \ \ \ (2)</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="comment">\f] </span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="comment">which we discussed in</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="comment">&lt;a href=&quot;../../prescribed_displ_lagr_mult/html/index.html&quot;&gt;</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="comment">another tutorial&lt;/a&gt;. This yields the pseudo-solid FSI preconditioner</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;<span class="comment">{\cal P}_{\rm FSI}=\left[</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="comment">\begin{array}{c|c|cc}</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="comment">F&amp; &amp;C_{\rm fx}&amp;\\ \hline</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="comment">C_{\rm sf}&amp;S&amp;C_{\rm sx}&amp;\\ \hline</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="comment">&amp;&amp;E_{\rm aug}&amp;\\</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="comment">&amp;C_{\rm ls}&amp;&amp;W</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="comment">\end{array}</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="comment">\right].</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;<span class="comment">\ \ \ \ \ \ (3)</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<span class="comment">The preconditioner can be shown to have a block triangular structure.</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<span class="comment">Its  application therefore</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="comment">requires the solution  of four subsidiary linear systems involving the</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="comment">matrices</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="comment">\f$F\f$, \f$S\f$, \f$E_{\rm aug}\f$ and \f$W\f$ and </span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="comment">four sparse matrix-vector products with the interaction </span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="comment">matrices \f$C_{\rm fx}\f$, \f$C_{\rm sx}\f$, \f$C_{\rm sf}\f$ and</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="comment">\f$C_{ls}\f$. </span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="comment">Numerical experiments in &lt;a href=&quot;http://dx.doi.org/10.1016/j.jcp.2012.07.001&quot;&gt;</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="comment">Muddle, Mihajlovic &amp; Heil (2012) &lt;/a&gt; show that an efficient </span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="comment">implementation of the preconditioner is obtained by</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="comment">- replacing the solution of the linear system involving </span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="comment">  \f${\cal P}_{\rm PS}\f$ by the approximation \f$\widetilde{\cal P}_{\rm PS}\f$</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="comment">  discussed in &lt;a href=&quot;../../prescribed_displ_lagr_mult/html/index.html&quot;&gt;</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="comment">  another tutorial,&lt;/a&gt; \n\n</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="comment">- replacing the solution of the linear system involving the</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="comment">  Navier-Stokes Jacobian \f$ F \f$ by an application of </span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="comment">  Elman, Silvester and Wathen&#39;s</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="comment">  &lt;a href=&quot;../../lsc_navier_stokes/html/index.html&quot;&gt;</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="comment">  Least-Squares Commutator (LSC)</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="comment">  preconditioner&lt;/a&gt;,</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="comment">.</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="comment">and by replacing the remaining block-solves within these preconditioners</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="comment">by a small number of AMG cycles or CG iterations. We retain</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="comment">SuperLU as the (exact) direct solver for the linear system involving</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="comment">the real solid&#39;s tangent stiffness matrix \f$ S \f$.</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;<span class="comment">With these approximations, the computational</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="comment">cost of one application of the preconditioner is linear</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="comment">in the number of unknowns (see \ref comm_and_ex</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="comment">for a more detailed discussion of this issue).</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="comment">The optimality of the preconditioner</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="comment">can therefore be assessed by demonstrating that </span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="comment">the number of GMRES iterations remains constant under </span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="comment">mesh refinement.</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="comment">\section implementation Implementation and use of the preconditioner</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;<span class="comment">The preconditioner described above is implemented within \c oomph-lib&#39;s</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="comment">(parallel) block preconditioning framework which is described in </span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="comment">&lt;a href=&quot;../../../mpi/block_preconditioners/html/index.html&quot;&gt;</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="comment">another tutorial&lt;/a&gt;. For the purpose of the implementation,</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="comment">we decompose the preconditioning matrix into the 3x3</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;<span class="comment">main blocks indicated by the vertical and horizontal lines</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="comment">in (1) and (3).</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;<span class="comment">The degrees of freedom within these sub-blocks are classified</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="comment">into &quot;dof-types&quot; on an element-by-element basis, using the functions</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="comment">- \c GeneralisedElement::ndof_types(...) which returns the number of</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="comment">  dof types classified by that element.</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="comment">- \c GeneralisedElement::get_block_numbers_for_unknowns(...) which</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="comment">  associates each degree of freedom (identified by its global equation</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;<span class="comment">  number) with the dof type within its block. </span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;<span class="comment">  \n\n</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;<span class="comment">.</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;<span class="comment">The default implementation of these functions within the</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;<span class="comment">Navier-Stokes elements (which differentiate between the </span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;<span class="comment">fluid velocity components and the pressure)</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;<span class="comment">and the beam elements (which do not distinguish between the different types</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;<span class="comment">of degree of freedom) is appropriate for the use with the</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;<span class="comment">(subsidiary) preconditioners employed here. The degrees of freedom</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;<span class="comment">representing the nodal positions in the (pseudo-solid) fluid mesh</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;<span class="comment">need to be sub-divided into those that are and are not constrained</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;<span class="comment">by the Lagrange multipliers that impose the deformation of the</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;<span class="comment">FSI boundary. This is most conveniently done by overloading the relevant</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="comment">functions in a templated wrapper element, \c PseudoElasticBulkElement&lt;...&gt;,  </span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="comment">as discussed in &lt;a href=&quot;../../prescribed_displ_lagr_mult/html/index.html&quot;&gt;</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="comment">another tutorial.&lt;/a&gt;</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="comment"> </span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;<span class="comment">\section results Results</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;<span class="comment">We examine the performance of the preconditioner in steady and</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;<span class="comment">unsteady test problems. First we perform a sequence of steady solves,</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;<span class="comment">incrementing the Reynolds number in steps of 25. The final steady</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;<span class="comment">solution is then used as the initial condition for an unsteady</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;<span class="comment">simulation in which the inflow is subjected to a time-periodic </span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;<span class="comment">oscillation. The tables below show the GMRES iteration counts (averaged </span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;<span class="comment">over all linear solves performed in the course of all Newton</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;<span class="comment">iterations) as a function of the mesh refinement (represented by the</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;<span class="comment">total number of unknowns) for different implementations of the</span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;<span class="comment">preconditioner.</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;<span class="comment">&lt;CENTER&gt;Average GMRES iteration counts (steady runs)&lt;TABLE BORDER=1&gt;</span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;<span class="comment">&lt;TR&gt; &lt;TD&gt; &lt;CODE&gt;n_dof&lt;/CODE&gt; &lt;/TD&gt; &lt;TD&gt; 9570 &lt;/TD&gt; &lt;TD&gt; 38724 &lt;/TD&gt; &lt;TD&gt; 87462 &lt;/TD&gt; &lt;TD&gt; 155784 &lt;/TD&gt;  &lt;/TR&gt;</span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;<span class="comment">&lt;TR&gt;&lt;TD&gt;GMRES (blocks solved by SuperLU)&lt;/TD&gt; &lt;TD&gt; 5.88889 &lt;/TD&gt; &lt;TD&gt; 5.88889 &lt;/TD&gt; &lt;TD&gt; 5.88889 &lt;/TD&gt; &lt;TD&gt; 6.11111 &lt;/TD&gt;  &lt;/TR&gt;</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;<span class="comment">&lt;TR&gt;&lt;TD&gt;GMRES (LSC; blocks solved by SuperLU)&lt;/TD&gt; &lt;TD&gt; 27.8889 &lt;/TD&gt; &lt;TD&gt; 36.1111 &lt;/TD&gt; &lt;TD&gt; 42.3333 &lt;/TD&gt; &lt;TD&gt; 47.2222 &lt;/TD&gt;  &lt;/TR&gt;</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;<span class="comment">&lt;TR&gt;&lt;TD&gt;GMRES (LSC; pseudo-solid; blocks solved by Hypre/CG)&lt;/TD&gt; &lt;TD&gt; 37.3333 &lt;/TD&gt; &lt;TD&gt; 43.2222 &lt;/TD&gt; &lt;TD&gt; 49.3333 &lt;/TD&gt; &lt;TD&gt; 55.3333 &lt;/TD&gt;  &lt;/TR&gt;</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;<span class="comment">&lt;/TABLE&gt;&lt;/CENTER&gt;</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;<span class="comment">&lt;CENTER&gt;&lt;BR&gt;&lt;BR&gt;Average GMRES iteration counts (unsteady runs)&lt;TABLE BORDER=1&gt;</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<span class="comment">&lt;TR&gt; &lt;TD&gt; &lt;CODE&gt;n_dof&lt;/CODE&gt; &lt;/TD&gt; &lt;TD&gt; 9570 &lt;/TD&gt; &lt;TD&gt; 38724 &lt;/TD&gt; &lt;TD&gt; 87462 &lt;/TD&gt; &lt;TD&gt; 155784 &lt;/TD&gt;  &lt;/TR&gt;</span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<span class="comment">&lt;TR&gt;&lt;TD&gt;GMRES (blocks solved by SuperLU)&lt;/TD&gt; &lt;TD&gt; 6.5124 &lt;/TD&gt; &lt;TD&gt; 6.95868 &lt;/TD&gt; &lt;TD&gt; 7.15323 &lt;/TD&gt; &lt;TD&gt; 7.2619 &lt;/TD&gt;  &lt;/TR&gt;</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;<span class="comment">&lt;TR&gt;&lt;TD&gt;GMRES (LSC; blocks solved by SuperLU)&lt;/TD&gt; &lt;TD&gt; 15 &lt;/TD&gt; &lt;TD&gt; 15.9256 &lt;/TD&gt; &lt;TD&gt; 16.2097 &lt;/TD&gt; &lt;TD&gt; 16.6429 &lt;/TD&gt;  &lt;/TR&gt;</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;<span class="comment">&lt;TR&gt;&lt;TD&gt;GMRES (LSC; pseudo-solid; blocks solved by Hypre/CG)&lt;/TD&gt; &lt;TD&gt; 22.2066 &lt;/TD&gt; &lt;TD&gt; 25.3967 &lt;/TD&gt; &lt;TD&gt; 27.0484 &lt;/TD&gt; &lt;TD&gt; 27.9921 &lt;/TD&gt;  &lt;/TR&gt;</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="comment">&lt;/TABLE&gt;&lt;/CENTER&gt;</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="comment">As expected from the theory (see </span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;<span class="comment">&lt;a href=&quot;http://dx.doi.org/10.1016/j.jcp.2012.07.001&quot;&gt;</span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;<span class="comment">  Muddle, Mihajlovic &amp; Heil (2012)&lt;/a&gt;), the GMRES iteration counts </span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;<span class="comment">are small and virtually mesh independent for the</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;<span class="comment">exact implementation of the preconditioner. Replacing the (costly) exact </span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;<span class="comment">solves by (faster) approximate solves leads to a modest</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;<span class="comment">increase in the (absolute) number of GMRES iterations. The most</span></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;<span class="comment">significant deterioration of the iteration counts results from the</span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;<span class="comment">use of the LSC Navier Stokes preconditioner as the inexact solver</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;<span class="comment">(subsidiary preconditioner) for the Navier-Stokes block. </span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;<span class="comment">The behaviour observed here (slight mesh dependence for </span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<span class="comment">steady solves; virtual mesh independence (once the mesh is</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="comment">sufficiently fine) for unsteady solves) mirrors that observed</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="comment">in single-physics Navier-Stokes problems.</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="comment">The benefit of switching to the approximate solves becomes apparent</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="comment">in the next two tables which shows the average cpu times required </span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;<span class="comment">for the solution of the linear systems by GMRES.</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;<span class="comment">(For comparison the times labelled as &lt;b&gt;&quot;SuperLU&quot;&lt;/b&gt; show the times </span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;<span class="comment">when the linear systems (1)</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;<span class="comment">are solved directly by SuperLU rather than by GMRES; they illustrate</span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;<span class="comment">how quickly direct solvers become uncompetitive.) For sufficiently </span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;<span class="comment">fine discretisations the larger number of GMRES iterations for the</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;<span class="comment">inexact solves is more than compensated for by the much lower cost</span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;<span class="comment">of the preconditioning operations. The final</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;<span class="comment">implementation yields cpu times that (at least for unsteady problems)</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;<span class="comment"> are proportional to the number of unknowns -- the hallmark of an optimal solver.</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;<span class="comment">&lt;CENTER&gt;Average linear solver times (steady runs; sec)&lt;TABLE BORDER=1&gt;</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;<span class="comment">&lt;TR&gt; &lt;TD&gt; &lt;CODE&gt;n_dof&lt;/CODE&gt; &lt;/TD&gt; &lt;TD&gt; 9570 &lt;/TD&gt; &lt;TD&gt; 38724 &lt;/TD&gt; &lt;TD&gt; 87462 &lt;/TD&gt; &lt;TD&gt; 155784 &lt;/TD&gt;  &lt;/TR&gt;</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;<span class="comment">&lt;TR&gt;&lt;TD&gt;SuperLU&lt;/TD&gt; &lt;TD&gt; 2.71863 &lt;/TD&gt; &lt;TD&gt; 33.7939 &lt;/TD&gt; &lt;TD&gt; 129.248 &lt;/TD&gt; &lt;TD&gt; 325.384 &lt;/TD&gt;  &lt;/TR&gt;</span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;<span class="comment">&lt;TR&gt;&lt;TD&gt;GMRES (blocks solved by SuperLU)&lt;/TD&gt; &lt;TD&gt; 2.31567 &lt;/TD&gt; &lt;TD&gt; 15.1042 &lt;/TD&gt; &lt;TD&gt; 58.5491 &lt;/TD&gt; &lt;TD&gt; 147.531 &lt;/TD&gt;  &lt;/TR&gt;</span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;<span class="comment">&lt;TR&gt;&lt;TD&gt;GMRES (LSC; blocks solved by SuperLU)&lt;/TD&gt; &lt;TD&gt; 2.8051 &lt;/TD&gt; &lt;TD&gt; 18.3197 &lt;/TD&gt; &lt;TD&gt; 58.7335 &lt;/TD&gt; &lt;TD&gt; 138.558 &lt;/TD&gt;  &lt;/TR&gt;</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="comment">&lt;TR&gt;&lt;TD&gt;GMRES (LSC; pseudo-solid; blocks solved by Hypre/CG)&lt;/TD&gt; &lt;TD&gt; 3.47733 &lt;/TD&gt; &lt;TD&gt; 15.1812 &lt;/TD&gt; &lt;TD&gt; 37.6856 &lt;/TD&gt; &lt;TD&gt; 73.0526 &lt;/TD&gt;  &lt;/TR&gt;</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;<span class="comment">&lt;/TABLE&gt;&lt;/CENTER&gt;</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;<span class="comment">&lt;CENTER&gt;&lt;BR&gt;&lt;BR&gt;Average linear solver times (unsteady runs; sec)&lt;TABLE BORDER=1&gt;</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;<span class="comment">&lt;TR&gt; &lt;TD&gt; &lt;CODE&gt;n_dof&lt;/CODE&gt; &lt;/TD&gt; &lt;TD&gt; 9570 &lt;/TD&gt; &lt;TD&gt; 38724 &lt;/TD&gt; &lt;TD&gt; 87462 &lt;/TD&gt; &lt;TD&gt; 155784 &lt;/TD&gt;  &lt;/TR&gt;</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;<span class="comment">&lt;TR&gt;&lt;TD&gt;SuperLU&lt;/TD&gt; &lt;TD&gt; 2.06807 &lt;/TD&gt; &lt;TD&gt; 25.7064 &lt;/TD&gt; &lt;TD&gt; 99.7166 &lt;/TD&gt; &lt;TD&gt; 248.082 &lt;/TD&gt;  &lt;/TR&gt;</span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;<span class="comment">&lt;TR&gt;&lt;TD&gt;GMRES (blocks solved by SuperLU)&lt;/TD&gt; &lt;TD&gt; 1.73668 &lt;/TD&gt; &lt;TD&gt; 11.1679 &lt;/TD&gt; &lt;TD&gt; 42.2051 &lt;/TD&gt; &lt;TD&gt; 105.97 &lt;/TD&gt;  &lt;/TR&gt;</span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;<span class="comment">&lt;TR&gt;&lt;TD&gt;GMRES (LSC; blocks solved by SuperLU)&lt;/TD&gt; &lt;TD&gt; 1.87403 &lt;/TD&gt; &lt;TD&gt; 11.0113 &lt;/TD&gt; &lt;TD&gt; 34.2697 &lt;/TD&gt; &lt;TD&gt; 81.4382 &lt;/TD&gt;  &lt;/TR&gt;</span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;<span class="comment">&lt;TR&gt;&lt;TD&gt;GMRES (LSC; pseudo-solid; blocks solved by Hypre/CG)&lt;/TD&gt; &lt;TD&gt; 2.26537 &lt;/TD&gt; &lt;TD&gt; 9.40194 &lt;/TD&gt; &lt;TD&gt; 22.5644 &lt;/TD&gt; &lt;TD&gt; 41.8251 &lt;/TD&gt;  &lt;/TR&gt;</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;<span class="comment">&lt;/TABLE&gt;&lt;/CENTER&gt;</span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;<span class="comment">\section modifications Modifications to the driver code</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;<span class="comment">Most of the driver code is unchanged from the implementation</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;<span class="comment">discussed in the  &lt;a href=&quot;../../../interaction/fsi_channel_with_leaflet/html/index.html&quot;&gt;original</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;<span class="comment">tutorial.&lt;/a&gt; We therefore only discuss the modifications required</span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;<span class="comment">- to perform the fluid mesh update using (pseudo-)elasticity,</span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;<span class="comment">.</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;<span class="comment">and</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;<span class="comment">- to employ preconditioned GMRES as the linear solver in the Newton method.</span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;<span class="comment">.</span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="comment">\subsection pseudo-solid Fluid-mesh udate by pseudo-elasticity</span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;<span class="comment">To perform the node update in the fluid mesh in response to the</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;<span class="comment">deformation of the leaflet using the equations of</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;<span class="comment">large-displacement elasticity we &quot;wrap&quot; the Navier-Stokes</span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;<span class="comment">element in the doubly-templated </span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;<span class="comment">\c PseudoSolidNodeUpdateElement&lt;WRAPPED_ELEMENT, SOLID_ELEMENT&gt; class.</span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;<span class="comment">The first template argument of this class, \c WRAPPED_ELEMENT,</span></div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;<span class="comment">specifies the type of the &quot;wrapped&quot;</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;<span class="comment">element -- here the nine-node, 2D quadrilateral \c</span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;<span class="comment">QTaylorHoodElement&lt;2&gt;. The second template argument, \c SOLID_ELEMENT,</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;<span class="comment">specifies the \c SolidElement used to perform the node update -- here </span></div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;<span class="comment">the nine-node, 2D quadrilateral \c QPVDElement&lt;2,3&gt;. Since the</span></div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;<span class="comment">preconditioner requires the (re-)classification of the pseudo-solid</span></div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;<span class="comment">degrees of freedom into constrained and unconstrained nodal positions,</span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;<span class="comment">we wrap this element too, using the</span></div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;<span class="comment">\c PseudoElasticBulkElement already discussed in</span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;<span class="comment">&lt;a href=&quot;../../prescribed_displ_lagr_mult/html/index.html&quot;&gt;</span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;<span class="comment">another tutorial&lt;/a&gt;. The full specification of the </span></div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;<span class="comment">fluid element is therefore given by</span></div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;<span class="comment">\code</span></div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;<span class="comment">PseudoSolidNodeUpdateElement&lt;QTaylorHoodElement&lt;2&gt;,</span></div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;<span class="comment">                             PseudoElasticBulkElement&lt;QPVDElement&lt;2,3&gt; &gt; &gt; </span></div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;<span class="comment">\endcode</span></div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;<span class="comment">&lt;HR&gt; </span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;<span class="comment">\subsection driver Modifications to the main code</span></div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;<span class="comment">The main code only requires minor changes, all associated with</span></div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;<span class="comment">the specification of different solver options. Since we provide the option to </span></div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;<span class="comment">use Hypre and Trilinos solvers, we need to activate MPI</span></div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;<span class="comment">if \c oomph-lib has been compiled with MPI support (even </span></div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;<span class="comment">if the code is run in serial):</span></div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;<span class="comment">\dontinclude fsi_channel_with_leaflet_precond.cc</span></div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;<span class="comment">\skipline start_of_main</span></div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;<span class="comment">\until #endif</span></div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;<span class="comment">Next we define and process the possible command line flags </span></div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;<span class="comment">which are used to select solver options and to specify the spatial </span></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;<span class="comment">resolution </span></div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;<span class="comment">\skipline Store command</span></div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;<span class="comment">\until validate</span></div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;<span class="comment">We then assign the command line flags that were specified</span></div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;<span class="comment">and document the ones that were recognised, before building the</span></div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;<span class="comment">problem, specifying the heavily wrapped version of the \c</span></div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;<span class="comment">Navier-Stokes element as the template parameter.</span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;<span class="comment">\skipline Parse command line</span></div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;<span class="comment">\until (mesh_multiplier);</span></div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;<span class="comment">The rest of the main code is very similar to the original version </span></div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;<span class="comment">discussed in </span></div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;<span class="comment">&lt;a href=&quot;../../../interaction/fsi_channel_with_leaflet/html/index.html&quot;&gt;</span></div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;<span class="comment">another tutorial&lt;/a&gt; and is therefore omitted here.</span></div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;<span class="comment">\subsection it_solve Choosing the iterative solver and preconditioner</span></div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;<span class="comment">We provide a new function, \c set_iterative_solver() to switch the</span></div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;<span class="comment">solver to GMRES and to instantiate the FSI preconditioner.</span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;<span class="comment">We start by creating the GMRES solver, using Trilinos&#39;</span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;<span class="comment">implementation if it is available:</span></div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;<span class="comment">\dontinclude fsi_channel_with_leaflet_precond.cc</span></div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;<span class="comment">\skipline start_iterative_solver</span></div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;<span class="comment">\until linear_solver_pt() = solver_pt;</span></div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;<span class="comment"> </span></div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;<span class="comment">Next, we create an instance of the FSI preconditioner for a 2D problem</span></div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;<span class="comment">and pass it to the solver:</span></div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;<span class="comment">\until  solver_pt-&gt;preconditioner_pt() = prec_pt;</span></div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;<span class="comment">The classification of the degrees of freedom within the block</span></div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;<span class="comment">preconditioning framework requires the specification of the</span></div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;<span class="comment">(pseudo-solid) fluid mesh, the &quot;real&quot; solid mesh and the</span></div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;<span class="comment">mesh containing the Lagrange multiplier elements that impose</span></div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;<span class="comment">the deformation of the FSI boundary in the fluid mesh:</span></div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;<span class="comment">\skipline Specify</span></div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;<span class="comment">\until Lagrange_multiplier_mesh_pt);</span></div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;<span class="comment">We provide the option to bypass the use of the LSC Schur complement</span></div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;<span class="comment">preconditioner as the subsidiary preconditioner (inexact solver)</span></div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;<span class="comment">for the Navier-Stokes block:</span></div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;<span class="comment">\skipline Use oomph-lib&#39;s</span></div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;<span class="comment">\until done disable lsc</span></div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;<span class="comment">By default the preconditioner performs the</span></div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;<span class="comment">preconditioning operations as described above, using SuperLU</span></div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;<span class="comment">for the block solves in (3). It is possible to specify </span></div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;<span class="comment">alternative (approximate) solvers for these. For instance, the behaviour</span></div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;<span class="comment">of the LSC preconditioner can be modified by following the pointer</span></div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;<span class="comment">to the Schur complement preconditioner</span></div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;<span class="comment">\until navier_stokes_schur_complement_preconditioner_pt();</span></div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;<span class="comment">whose behaviour can be modified as discussed in </span></div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;<span class="comment">&lt;a href=&quot;../../../preconditioners/lsc_navier_stokes/html/index.html&quot;&gt;</span></div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;<span class="comment">LSC preconditioner tutorial&lt;/a&gt;. For instance, to use a block-triangular</span></div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;<span class="comment">approximation for the Navier-Stokes momentum block we specify</span></div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;<span class="comment">\until set_f_preconditioner(f_prec_pt);</span></div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;<span class="comment">If Hypre is available, we can then (approximately) solve the diagonal blocks </span></div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;<span class="comment">using a small number of AMG V-cycles (with settings specified in the</span></div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;<span class="comment">helper function \c LSC_Preconditioner_Helper::set_hypre_preconditioner):</span></div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;<span class="comment">\until (LSC_Preconditioner_Helper::set_hypre_preconditioner);</span></div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;<span class="comment">Similarly, we can use Hypre (with settings appropriate for a 2D</span></div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;<span class="comment">Poisson problem) to approximately solve the pressure Poisson systems</span></div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;<span class="comment">in the computations of the Schur complement approximation:</span></div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;<span class="comment"> </span></div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;<span class="comment">\until #endif</span></div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;<span class="comment">Approximate solvers for the diagonal blocks in the preconditioner </span></div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;<span class="comment">(2) for the the Lagrange-multiplier</span></div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;<span class="comment">constrained pseudo-elastic equations can be</span></div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;<span class="comment">chosen as discussed in </span></div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;<span class="comment">&lt;a href=&quot;../../prescribed_displ_lagr_mult/html/index.html&quot;&gt;</span></div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;<span class="comment">another tutorial&lt;/a&gt;. </span></div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;<span class="comment">For instance, we can employ a block-upper triangular approximation</span></div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;<span class="comment">for the augmented pseudo-elastic block \f$E_{\rm aug}\f$:</span></div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;<span class="comment">\until PseudoElasticPreconditioner::Block_upper_triangular_preconditioner;</span></div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;<span class="comment">Its diagonal blocks can then again be solved by Hypre,</span></div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;<span class="comment">\until #endif</span></div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;<span class="comment">Similarly, the linear systems involving the mass matrices </span></div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;<span class="comment">in \f$ W \f$ can be solved using diagonally preconditioned CG:</span></div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;<span class="comment">\until end set_iterative_solver</span></div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;<span class="comment"> </span></div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;<span class="comment">\section comm_and_ex Comments and Exercises</span></div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;<span class="comment">\subsection comm Comments</span></div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;<span class="comment">- Further details of the theory, such as the proof of the optimality of</span></div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;<span class="comment">  the preconditioner, can be found in</span></div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;<span class="comment">  &lt;a href=&quot;http://dx.doi.org/10.1016/j.jcp.2012.07.001&quot;&gt;</span></div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;<span class="comment">  Muddle, Mihajlovic &amp; Heil (2012).&lt;/a&gt;\n\n</span></div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;<span class="comment">- Note that we retained SuperLU as the solver for the linear system</span></div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;<span class="comment">  involving the tangent stiffness matrix \f$ S \f$ of the actual,</span></div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;<span class="comment">  fluid-load solid. In the present example this still leads to an</span></div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;<span class="comment">  optimal solver since the leaflet is modelled as a 1D beam structure</span></div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;<span class="comment">  whose number of unknowns increases much more slowly than the number</span></div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;<span class="comment">  of unknowns in the fluid mesh when the meshes are refined uniformly.</span></div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;<span class="comment">  If the solid is modelled as a &quot;proper&quot; solid, the use of a direct</span></div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;<span class="comment">  solver for the solution of the linear systems involving \f$ S \f$</span></div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;<span class="comment">  becomes sub-optimal. The member function </span></div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;<span class="comment">  \code</span></div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;<span class="comment">  PseudoElasticFSIPreconditioner::set_solid_preconditioner(...)</span></div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;<span class="comment">  \endcode</span></div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;<span class="comment">  can then be used to specify a subsidiary preconditioner</span></div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;<span class="comment">  (inexact solver) for the linear systems involving \f$ S \f$.</span></div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;<span class="comment">  \n\n</span></div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;<span class="comment">.</span></div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;<span class="comment">      </span></div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;<span class="comment">\subsection ex Exercises</span></div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;<span class="comment">-# Experiment with different preconditioner settings and explore</span></div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;<span class="comment">   the performance of the preconditioner at different Reynolds</span></div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;<span class="comment">   numbers. The script </span></div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;<span class="comment">   &lt;A HREF=&quot;../../../../demo_drivers/interaction/pseudo_solid_fsi_channel_with_leaflet/run.sh&quot;&gt;&lt;CODE&gt;run.sh&lt;/CODE&gt;&lt;/a&gt;</span></div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;<span class="comment">   used to generate the data presented above, may be helpful.</span></div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;<span class="comment">.</span></div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;<span class="comment">\section sources Source files for this tutorial</span></div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;<span class="comment">- The source files for this tutorial are located in the directory:\n\n</span></div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;<span class="comment">&lt;CENTER&gt;</span></div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;<span class="comment">&lt;A HREF=&quot;../../../../demo_drivers/interaction/pseudo_solid_fsi_channel_with_leaflet&quot;&gt;</span></div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;<span class="comment">demo_drivers/interaction/pseudo_solid_fsi_channel_with_leaflet</span></div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;<span class="comment">&lt;/A&gt;</span></div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;<span class="comment">&lt;/CENTER&gt;\n</span></div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;<span class="comment">- The driver code is: \n\n</span></div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;<span class="comment">&lt;CENTER&gt;</span></div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;<span class="comment">&lt;A HREF=&quot;../../../../demo_drivers/interaction/pseudo_solid_fsi_channel_with_leaflet/fsi_channel_with_leaflet_precond.cc&quot;&gt;</span></div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;<span class="comment">demo_drivers/interaction/pseudo_solid_fsi_channel_with_leaflet/fsi_channel_with_leaflet_precond.cc&lt;/A&gt;</span></div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;<span class="comment">&lt;/CENTER&gt;</span></div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;<span class="comment">&lt;hr&gt;</span></div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;<span class="comment">&lt;hr&gt;</span></div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;<span class="comment">\section pdf PDF file</span></div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;<span class="comment">A &lt;a href=&quot;../latex/refman.pdf&quot;&gt;pdf version&lt;/a&gt; of this document is available.</span></div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;<span class="comment">**/</span></div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160; </div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="apseudo__solid__fsi_8txt_html_abe858238138d8f2595ba9bd74e43d999"><div class="ttname"><a href="pseudo__solid__fsi_8txt.html#abe858238138d8f2595ba9bd74e43d999">f</a></div><div class="ttdeci">see the&lt; a href=&quot;../../../beam/tensioned_string/html/index.html&quot;&gt; beam theory tutorial&lt;/a &gt; for details of the elastic leaflet n n The nodal positions in the fluid mesh n n The nodal values representing the components of the linear system to be solved in the course of the Newton iteration can be re ordered into the following block f</div><div class="ttdef"><b>Definition:</b> <a href="pseudo__solid__fsi_8txt_source.html#l00102">pseudo_solid_fsi.txt:102</a></div></div>
<div class="ttc" id="apseudo__solid__fsi_8txt_html_a03f9c6e7227317ca589d9b684ef57b1c"><div class="ttname"><a href="pseudo__solid__fsi_8txt.html#a03f9c6e7227317ca589d9b684ef57b1c">$J_</a></div><div class="ttdeci">see the&lt; a href=&quot;../../../beam/tensioned_string/html/index.html&quot;&gt; beam theory tutorial&lt;/a &gt; for details of the elastic leaflet n n The nodal positions in the fluid mesh n n The nodal values representing the components of the linear system to be solved in the course of the Newton iteration can be re ordered into the following block and f $J_</div><div class="ttdef"><b>Definition:</b> <a href="pseudo__solid__fsi_8txt_source.html#l00107">pseudo_solid_fsi.txt:107</a></div></div>
<div class="ttc" id="apseudo__solid__fsi_8txt_html_ac9fad54c159f390e90d7069daa9fb570"><div class="ttname"><a href="pseudo__solid__fsi_8txt.html#ac9fad54c159f390e90d7069daa9fb570">href</a></div><div class="ttdeci">&quot;http: 10.1016/j.jcp.2012.07.001&lt;/a&gt; &lt;/center&gt; where full details of the analysis and further results from a variety of other test problems can be found. &lt;HR&gt; &lt;HR&gt; \section model Background: Problem formulation, the resulting linear system and the preconditioner We will demonstrate the development and application of the preconditioner using the problem of flow in a 2D channel with an elastic leaflet discussed in &lt;a href=&quot;../../../interaction/fsi_channel_with_leaflet/html/index.html&quot;&gt; another tutorial&lt;/a&gt; and illustrated in the sketch below: @I w 0.75\textwidth fsi_channel_with_leaflet &quot;Sketch of the problem. &quot; Flow is driven (via an imposed parabolic inflow profile) through a 2D channel which is partially obstructed by a thin-walled elastic leaflet. The fluid leaves the domain at the far downstream end of the channel where we assume parallel, axially traction-free outflow. We use the same discretisation (2D quadrilateral Taylor-Hood elements for the fluid href</div><div class="ttdef"><b>Definition:</b> <a href="pseudo__solid__fsi_8txt_source.html#l00040">pseudo_solid_fsi.txt:40</a></div></div>
<div class="ttc" id="apseudo__solid__fsi_8txt_html_ab1b855424482d438c265a0647718f43a"><div class="ttname"><a href="pseudo__solid__fsi_8txt.html#ab1b855424482d438c265a0647718f43a">leaflet</a></div><div class="ttdeci">the latter representing derivative degrees of freedom in the Hermite elements used to discretise the leaflet</div><div class="ttdef"><b>Definition:</b> <a href="pseudo__solid__fsi_8txt_source.html#l00064">pseudo_solid_fsi.txt:64</a></div></div>
<div class="ttc" id="apseudo__solid__fsi_8txt_html_a6e3e132e85d63512b2f73fe1adac733f"><div class="ttname"><a href="pseudo__solid__fsi_8txt.html#a6e3e132e85d63512b2f73fe1adac733f">update</a></div><div class="ttdeci">see the&lt; a href=&quot;../../../beam/tensioned_string/html/index.html&quot;&gt; beam theory tutorial&lt;/a &gt; for details of the elastic leaflet n n The nodal positions in the fluid mesh n n The nodal values representing the components of the linear system to be solved in the course of the Newton iteration can be re ordered into the following block and f are the two single physics Jacobian f[J_{\rm PS}=\left[\begin{array}{cc}E &amp;C_{\rm xl}\\ C_{\rm lx}&amp;\\\end{array}\right]\f] associated with the Lagrange multiplier constrained pseudo elasticity problem governing the fluid mesh update</div><div class="ttdef"><b>Definition:</b> <a href="pseudo__solid__fsi_8txt_source.html#l00122">pseudo_solid_fsi.txt:122</a></div></div>
<div class="ttc" id="apseudo__solid__fsi_8txt_html_a3458e31560e6971ccfa1bdbaeb28689f"><div class="ttname"><a href="pseudo__solid__fsi_8txt.html#a3458e31560e6971ccfa1bdbaeb28689f">matrices</a></div><div class="ttdeci">see the&lt; a href=&quot;../../../beam/tensioned_string/html/index.html&quot;&gt; beam theory tutorial&lt;/a &gt; for details of the elastic leaflet n n The nodal positions in the fluid mesh n n The nodal values representing the components of the linear system to be solved in the course of the Newton iteration can be re ordered into the following block and f are the two single physics Jacobian matrices(\f $F\f$, the Navier-Stokes Jacobian;\f $S\f$, the tangent stiffness matrix of the fluid-loaded solid) and the Jacobian</div></div>
<div class="ttc" id="apseudo__solid__fsi_8txt_html_aad57db15a995cfc05da8f3007f2542f7"><div class="ttname"><a href="pseudo__solid__fsi_8txt.html#aad57db15a995cfc05da8f3007f2542f7">problems</a></div><div class="ttdeci">see the&lt; a href=&quot;../../../beam/tensioned_string/html/index.html&quot;&gt; beam theory tutorial&lt;/a &gt; for details of the elastic leaflet n n The nodal positions in the fluid mesh n n The nodal values representing the components of the linear system to be solved in the course of the Newton iteration can be re ordered into the following block and f are the two single physics Jacobian f[J_{\rm PS}=\left[\begin{array}{cc}E &amp;C_{\rm xl}\\ C_{\rm lx}&amp;\\\end{array}\right]\f] associated with the Lagrange multiplier constrained pseudo elasticity problem governing the fluid mesh discussed in more detail in&lt; a href=&quot;../../prescribed_displ_lagr_mult/html/index.html&quot;&gt; another tutorial&lt;/a &gt; The non zero off diagonal blocks arise through the interactions between the various single physics problems</div><div class="ttdef"><b>Definition:</b> <a href="pseudo__solid__fsi_8txt_source.html#l00135">pseudo_solid_fsi.txt:135</a></div></div>
<div class="ttc" id="apseudo__solid__fsi_8txt_html_afe149ff33821661abfd7c94eace29317"><div class="ttname"><a href="pseudo__solid__fsi_8txt.html#afe149ff33821661abfd7c94eace29317">the</a></div><div class="ttdeci">see the&lt; a href=&quot;../../../beam/tensioned_string/html/index.html&quot;&gt; beam theory tutorial&lt;/a &gt; for details of the elastic leaflet n n The nodal positions in the fluid mesh n n The nodal values representing the components of the(vector-valued) Lagrange multipliers which impose the motion of the elastic leaflet on the pseudo-elastic fluid mesh. These unknowns only exist for the fluid nodes on the FSI boundary. . Using this classification of the unknowns</div></div>
<div class="ttc" id="apseudo__solid__fsi_8txt_html_a4074baada03976c061d5672f4237cca5"><div class="ttname"><a href="pseudo__solid__fsi_8txt.html#a4074baada03976c061d5672f4237cca5">problem</a></div><div class="ttdeci">mainpage Demo problem</div><div class="ttdef"><b>Definition:</b> <a href="pseudo__solid__fsi_8txt_source.html#l00004">pseudo_solid_fsi.txt:4</a></div></div>
<div class="ttc" id="apseudo__solid__fsi_8txt_html_aa2151bde8e428e39589caa1d63643c9b"><div class="ttname"><a href="pseudo__solid__fsi_8txt.html#aa2151bde8e428e39589caa1d63643c9b">However</a></div><div class="ttdeci">Hermite beam elements for the leaflet as in the&lt; a href=&quot;../../../interaction/fsi_channel_with_leaflet/html/index.html&quot;&gt; original tutorial&lt;/a &gt; However</div><div class="ttdef"><b>Definition:</b> <a href="pseudo__solid__fsi_8txt_source.html#l00043">pseudo_solid_fsi.txt:43</a></div></div>
<div class="ttc" id="anamespaceoomph_html"><div class="ttname"><a href="namespaceoomph.html">oomph</a></div><div class="ttdef"><b>Definition:</b> <a href="fsi__channel__with__leaflet__precond_8cc_source.html#l00047">fsi_channel_with_leaflet_precond.cc:47</a></div></div>
<div class="ttc" id="apseudo__solid__fsi_8txt_html_a0eab98fcbf1e50efaf786b7a49f78578"><div class="ttname"><a href="pseudo__solid__fsi_8txt.html#a0eab98fcbf1e50efaf786b7a49f78578">$C_</a></div><div class="ttdeci">see the&lt; a href=&quot;../../../beam/tensioned_string/html/index.html&quot;&gt; beam theory tutorial&lt;/a &gt; for details of the elastic leaflet n n The nodal positions in the fluid mesh n n The nodal values representing the components of the linear system to be solved in the course of the Newton iteration can be re ordered into the following block and f are the two single physics Jacobian f[J_{\rm PS}=\left[\begin{array}{cc}E &amp;C_{\rm xl}\\ C_{\rm lx}&amp;\\\end{array}\right]\f] associated with the Lagrange multiplier constrained pseudo elasticity problem governing the fluid mesh discussed in more detail in&lt; a href=&quot;../../prescribed_displ_lagr_mult/html/index.html&quot;&gt; another tutorial&lt;/a &gt; The non zero off diagonal blocks arise through the interactions between the various single physics the traction is also affected by the nodal positions in the fluid mesh this dependency gives rise to the matrix f $C_</div><div class="ttdef"><b>Definition:</b> <a href="pseudo__solid__fsi_8txt_source.html#l00137">pseudo_solid_fsi.txt:137</a></div></div>
<div class="ttc" id="apseudo__solid__fsi_8txt_html_a3a6a09fa6420dbd0ea5e502d6452fea0"><div class="ttname"><a href="pseudo__solid__fsi_8txt.html#a3a6a09fa6420dbd0ea5e502d6452fea0">structure</a></div><div class="ttdeci">see the&lt; a href=&quot;../../../beam/tensioned_string/html/index.html&quot;&gt; beam theory tutorial&lt;/a &gt; for details of the elastic leaflet n n The nodal positions in the fluid mesh n n The nodal values representing the components of the linear system to be solved in the course of the Newton iteration can be re ordered into the following block structure</div><div class="ttdef"><b>Definition:</b> <a href="pseudo__solid__fsi_8txt_source.html#l00102">pseudo_solid_fsi.txt:102</a></div></div>
<div class="ttc" id="apseudo__solid__fsi_8txt_html_a30847fef302f7f86c29a0cc1d6aed94f"><div class="ttname"><a href="pseudo__solid__fsi_8txt.html#a30847fef302f7f86c29a0cc1d6aed94f">GMRES</a></div><div class="ttdeci">mainpage Demo focusing on the efficient solution of the governing equations by GMRES</div><div class="ttdef"><b>Definition:</b> <a href="pseudo__solid__fsi_8txt_source.html#l00006">pseudo_solid_fsi.txt:6</a></div></div>

    <!-- jQuery for Bootstrap and Doxygen -->
    <script src="../../../js/jquery-1.12.0.min.js"></script>
    <!-- Minified boostrap plugins-->
    <script src="../../../js/bootstrap.js"></script>
    <!-- Doxygen dependency to add powertips to source code-->
    <script src="../../../js/jquery.powertip.min.js"></script>
    <!-- The  following script is generated by doxygen and hides/shows levels in 
         the data structure lists and adds powertips to source code-->
    <script src="../../../js/dynsections.js" ></script>
    <!-- add to Doxygen's class names so bootstrap css and js recognises them-->
    <script type="text/javascript">
    $(".contents").addClass("container");
    $(".header").addClass("container");
    $(".navpath").addClass("container");
    $("#navrow3").addClass("container");
    $("#navrow4").addClass("container");
    $(".mlabel").addClass("label");
    $(".mlabel").addClass("label-default");
    $(".memitem").addClass("panel");
    $(".memitem").addClass("panel-info");
    $(".memproto").addClass("panel-heading");
    $(".memdoc").addClass("panel-body");
    </script>
    <footer>
      <div class="container">
        <div class="text-muted" style="float:right;">Generated by <a href="http://www.doxygen.org/index.html">
          <img style="height:18px;" class="footer-img" src="doxygen.png" alt="doxygen"></a> on Wed Jul 21 2021 16:41:06
        </div>
      </div>
    </footer>
</body>
</html>

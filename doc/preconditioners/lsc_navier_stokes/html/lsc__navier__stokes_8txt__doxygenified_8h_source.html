<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
<title>oomph-lib: lsc_navier_stokes.txt_doxygenified.h Source File</title>
<link rel="apple-touch-icon" sizes="57x57" href="../../../figures/apple-touch-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="../../../figures/apple-touch-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="../../../figures/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="../../../figures/apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="../../../figures/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="../../../figures/apple-touch-icon-120x120.png">
<link rel="icon" type="image/png" href="../../../figures/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="../../../figures/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="../../../figures/favicon-16x16.png" sizes="16x16">
<link rel="manifest" href="../../../figures/manifest.json">
<link rel="mask-icon" href="../../../figures/safari-pinned-tab.svg" color="#008000">
<link rel="shortcut icon" href="../../../figures/favicon.ico">
<meta name="msapplication-TileColor" content="#00a300">
<meta name="msapplication-config" content="../../../figures/browserconfig.xml">
<meta name="theme-color" content="#008000">
<link href="http://fonts.googleapis.com/css?family=Open+Sans:400,300,600" rel="stylesheet" type="text/css">
<!-- Doxygen css-->
<!-- <link rel="stylesheet" type="text/css" href="doxygen.css"> -->
<!-- Bootstrap -->
<link href="../../../css/bootstrap.css" rel="stylesheet">
<!-- oomph-lib specific overrides -->
<link rel="stylesheet" type="text/css" href="../../../css/oomph_header.css">
</head>
<body>
<nav class="navbar navbar-default">
<div class="container">
<div class="container-fluid">
  <!-- Brand and toggle get grouped for better mobile display -->
  <div class="navbar-header">
    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
      <span class="sr-only">Toggle navigation</span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="../../../html/index.html"><img alt="oomph-lib" src="../../../figures/oomph_logo.png"></a>
  </div>
  <!-- Collect the nav links, forms, and other content for toggling -->
  <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
    <ul class="nav navbar-nav">          
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Documentation <span class="caret"></span></a>
        <ul class="dropdown-menu">
          <li class="dropdown-header">Big picture</li>
          <li><a href="../../../../doc/intro/html/index.html">The finite element method</a></li>
          <li><a href="../../../../doc/the_data_structure/html/index.html">The data structure</a></li>
          <li><a href="../../../../doc/quick_guide/html/index.html">Not-so-quick guide</a></li>
          <li><a href="../../../../doc/optimisation/html/index.html">Optimisation</a></li>
          <li><a href="../../../../doc/order_of_action_functions/html/index.html">Order of action functions</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Example codes and tutorials</li>
          <li><a href="../../../../doc/example_code_list/html/index.html">List of example codes and tutorials</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#meshes">Meshing</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#solvers">Solvers</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#parallel">MPI parallel processing</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#visualisation">Post-processing/visualisation</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Other</li>
          <li><a href="../../../../doc/change_log/html/index.html">Change log</a></li>
          <li><a href="../../../../doc/creating_doc/html/index.html">Creating documentation</a></li>
          <li><a href="../../../../doc/coding_conventions/html/index.html">Coding conventions</a></li>
          <li><a href="../../../../doc/index/html/index.html">Index</a></li>
          <li><a href="../../../../doc/FAQ/html/index.html">FAQ</a></li>
        </ul>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Get it <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../../doc/the_distribution/html/index.html">Installation guide</a></li>
            <li><a href="../../../../doc/subversion/html/index.html">Get code from subversion repository</a></li>
            <li><a href="../../../../doc/download/html/index.html">Get code as tar file</a></li>
            <li><a href="../../../../doc/copyright/html/index.html">Copyright</a></li>
          </ul>
        </li>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">About <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../../doc/people/html/index.html">People</a></li>            
            <li><a href="../../../../doc/contact/html/index.html">Contact/Get involved</a></li>
            <li><a href="../../../../doc/publications/html/index.html">Publications</a></li>
            <li><a href="../../../../doc/acknowledgements/html/index.html">Acknowledgements</a></li>
            <li><a href="../../../../doc/picture_show/index.html">Picture show</a></li>
          </ul>
        </li>
      </li>
    </ul>
    <ul class="nav navbar-nav navbar-right navbar-search">
      <form class="navbar-form" role="search" action="../../../../doc/search_results/html/index.html">
        <div class="input-group">
          <input type="text" class="form-control" placeholder="Search" name="q">
          <span class="input-group-btn">
            <button class="btn btn-default" type="submit">Go</button>
          </span>
        </div><!-- /input-group -->
       <!--<div class="form-group">
          <input type="text" class="form-control" placeholder="Search">
        </div>
        <button type="submit" class="btn btn-default">Submit</button>-->
      </form>
    </ul>
  </div><!-- /.navbar-collapse -->
</div><!-- /.container-fluid -->
</div>
</nav>
<!-- Generated by Doxygen 1.8.17 -->
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">lsc_navier_stokes.txt_doxygenified.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="lsc__navier__stokes_8txt__doxygenified_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">\mainpage The Least-Squares Commutator (LSC) Navier-Stokes preconditioner</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">The purpose of this tutorial is to show how to use</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">\c oomph-lib&#39;s  Least Squares Commutator (LSC) Navier-Stokes</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">preconditioner.</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">\section theory Theory</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">\c oomph-lib currently provides two types of (LBB-stable)</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">Navier-Stokes elements: Taylor-Hood (Q2Q1) and Crouzeix-Raviart</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">(Q2Q-1) elements. These contain two distinct types of degrees of freedom,</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">namely the velocities and pressures. </span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">The least-squares commutator (LSC; formerly BFBT) Navier-Stokes </span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">preconditioner employs \c oomph-lib&#39;s &lt;a href=&quot;../../../mpi/block_preconditioners/html/index.html&quot;&gt;block-preconditioning framework&lt;/a&gt;</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">to (formally) re-order the linear system to be solved during the</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">Newton iteration into 2x2 blocks, corresponding to the velocity </span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">and pressure unknowns. We note that all velocity components are </span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">treated as a single block of unknowns. The linear system</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">therefore has the following block structure</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment">\left( </span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">\begin{array}{cc}</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment">{\bf F} &amp; {\bf G} \\ {\bf D} &amp; {\bf 0} </span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment">\end{array} </span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment">\right)</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment">\left( </span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment">\begin{array}{c}</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment">{\bf z}_u \\ {\bf z}_p</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment">\end{array} </span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment">\right) =</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment">\left( </span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment">\begin{array}{c}</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment">{\bf r}_u \\ {\bf r}_p</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment">\end{array} </span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment">\right).</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment">Here \f$ {\bf F}\f$ is the momentum block,  \f$ {\bf G} \f$ the</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment">discrete gradient operator, and \f$ {\bf D}\f$ the discrete</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment">divergence operator. (For unstabilised elements, we have </span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment">\f$ {\bf D} = {\bf G}^T \f$ and in much of the literature</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment">the divergence matrix is denoted by \f$ {\bf B} \f$ .)</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment">An &quot;exact&quot; preconditioner would solve this system exactly and thus</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment">ensure the convergence of any iterative linear solver in a single </span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment">iteration. However, the application of such a preconditioner</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment">would, of course, be exactly as expensive as a direct solve.</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment">The LSC/BFBT preconditioner replaces the exact Jacobian by </span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment">a block-triangular approximation</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment">\left( </span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment">\begin{array}{cc}</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment">{\bf F} &amp; {\bf G} \\ {\bf 0} &amp; -{\bf M}_s </span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment">\end{array} </span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment">\right) </span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment">\left( </span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment">\begin{array}{c}</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment">{\bf z}_u \\ {\bf z}_p</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment">\end{array} </span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment">\right) =</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment">\left( </span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="comment">\begin{array}{c}</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="comment">{\bf r}_u \\ {\bf r}_p</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="comment">\end{array} </span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="comment">\right),</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="comment">where \f${\bf M}_s\f$ is an approximation to the pressure </span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="comment">Schur-complement \f$ {\bf S} = {\bf D} {\bf F}^{-1}{\bf G}. \f$</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="comment">This system can be solved in two steps:</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="comment">-# Solve the second row for \f$ {\bf z}_p\f$ via</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="comment">   \f[ </span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="comment">   {\bf z}_p = - {\bf M}_s^{-1} {\bf r}_p</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="comment">   \f]</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="comment">-# Given \f$ {\bf z}_p \f$ , solve the first row for \f$ {\bf z}_u\f$ via</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment">   \f[ </span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="comment">   {\bf z}_u = {\bf F}^{-1} \big( {\bf r}_u - {\bf G} {\bf z}_p \big)</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="comment">   \f]</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="comment">.</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="comment">In the LSC/BFBT preconditioner, the action of the inverse pressure</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="comment">Schur complement </span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="comment">{\bf z}_p = - {\bf M}_s^{-1} {\bf r}_p</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="comment">is approximated by</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="comment">{\bf z}_p = - </span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="comment">\big({\bf D} \widehat{\bf Q}^{-1}{\bf G} \big)^{-1}</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="comment">\big({\bf D} \widehat{\bf Q}^{-1}{\bf F} \widehat{\bf Q}^{-1}{\bf G}\big) </span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment">\big({\bf D} \widehat{\bf Q}^{-1}{\bf G} \big)^{-1}</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="comment">{\bf r}_p,</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="comment">where  \f$ \widehat{\bf Q} \f$ is the diagonal of the velocity</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="comment">mass matrix. The evaluation of this expression involves</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="comment">two linear solves involving the matrix</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="comment">{\bf P} = \big({\bf D} \widehat{\bf Q}^{-1}{\bf G} \big)</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="comment">which has the character of a matrix arising from the discretisation </span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="comment">of a Poisson problem on the pressure space. We also have</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="comment">to evaluate matrix-vector products with the matrix </span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="comment">{\bf E}={\bf D}\widehat{\bf Q}^{-1}{\bf F}\widehat{\bf Q}^{-1}{\bf G}</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="comment">Details of the theory can be found in &quot;Finite Elements and </span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="comment">Fast Iterative Solvers with Applications in Incompressible Fluid </span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="comment">Dynamics&quot; by Howard C. Elman, David J. Silvester, and Andrew J. Wathen,</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="comment">published by Oxford University Press, 2006.</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="comment">\n\n</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="comment">In our implementation of the preconditioner, the linear systems</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="comment">can either be solved &quot;exactly&quot;, using \c SuperLU (in its incarnation</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="comment">as an exact preconditioner; this is the default) or by any </span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="comment">other \c Preconditioner (interpreted as an &quot;inexact solver&quot;) </span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="comment">specified via the access functions</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="comment">\code</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="comment">NavierStokesSchurComplementPreconditioner::set_f_preconditioner(...)</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="comment">\endcode</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="comment">or </span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="comment">\code</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="comment">NavierStokesSchurComplementPreconditioner::set_p_preconditioner(...)</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="comment">\endcode</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="comment">\section example An example</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="comment">To demonstrate how to use the preconditioner, here are</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="comment">the relevant extracts from the driver code</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="comment">&lt;A HREF=&quot;../../../../demo_drivers/linear_solvers/driven_cavity.cc&quot;&gt;</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="comment">driven_cavity.cc&lt;/A&gt; -- a straightforward</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="comment">modification of the code for</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="comment">&lt;a href=&quot;../../../navier_stokes/driven_cavity/html/index.html&quot;&gt;</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="comment">driven-cavity problem discussed elsewhere.&lt;/a&gt; </span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="comment">As explained in the </span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="comment">&lt;a href=&quot;../../../linear_solvers/html/index.html&quot;&gt;Linear</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="comment">Solvers Tutorial&lt;/A&gt; switching to an iterative linear solver</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="comment">is typically performed in the \c Problem constructor and involves</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="comment">a few straightforward steps:</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="comment">-# &lt;b&gt;Create an instance of the IterativeLinearSolver and pass it to the</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="comment">   Problem&lt;/b&gt; \n\n</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="comment">   In our problem, we choose \c GMRES as the linear solver: \n\n</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="comment">   \dontinclude driven_cavity.cc</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="comment">   \skipline Create oomph-lib</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="comment">   \until Solver_pt;</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="comment">   \n\n</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="comment">-# &lt;b&gt;Create an instance of the Preconditioner and pass it to the</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="comment">   IterativeLinearSolver&lt;/b&gt; \n\n</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="comment">   \skipline Set preconditioner</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="comment">   \until Solver_pt-&gt;preconditioner_pt()=Prec_pt;</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="comment">   \n\n</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="comment">-# &lt;b&gt;Customise the Preconditioner (if required)&lt;/b&gt; \n\n</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="comment">   The behaviour of many preconditioners can be fine-tuned</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="comment">   for specific applications. The \c NavierStokesLSCPreconditioner</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="comment">   provides the option to perform the linear solves involving</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="comment">   the \f$ {\bf P} \f$ and  \f$ {\bf F} \f$ matrices with</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="comment">   inexact solvers (i.e. other preconditioners), rather than</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="comment">   with the &quot;exact preconditioner&quot; \c SuperLUPreconditioner. </span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="comment">   Since the matrix \f$ {\bf P} \f$</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="comment">   has the character of a pressure Poisson matrix, it may be</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="comment">   solved efficiently with algebraic multigrid (AMG) -- at least</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="comment">   for elements that employ a continuous pressure approximation;</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="comment">   see \ref comm_ex. In these cases an efficient</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="comment">   inexact solver is obtained by performing just a single</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="comment">   multigrid cycle. </span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="comment">   \n\n</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="comment">   Assuming that </span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="comment">   &lt;a href=&quot;https://computation.llnl.gov/casc/linear_solvers/sls_hypre.html&quot;&gt;</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;<span class="comment">   &lt;code&gt;Hypre&lt;/code&gt;&lt;/a&gt; is available, we therefore provide the</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="comment">   option to use the \c Hypre</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="comment">   AMG solver to solve the linear systems involving the  \f$ {\bf P}</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="comment">   \f$ matrix. </span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="comment">   \n\n</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="comment">   \dontinclude driven_cavity.cc</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="comment">   \skipline OOMPH_HAS_HYPRE</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="comment">   \until new HyprePreconditioner;</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;<span class="comment">   \n </span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="comment">   We set the various solver flags to values that are appropriate</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<span class="comment">   for 2D Poisson problems. This is most easily done by calling a helper</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<span class="comment">   function, defined in the namespace \c Hypre_default_settings:</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<span class="comment">   \n\n</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="comment">   \skipline Set parameters</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="comment">   \until  static_cast&lt;HyprePreconditioner*&gt;(P_matrix_preconditioner_pt));</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="comment">   \n</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="comment">   Next we specify the \c Preconditioner as the inexact solver</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="comment">   for the  \f$ {\bf P}</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="comment">   \f$ matrix,</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="comment">   \n\n</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="comment">   \until set_p_preconditioner</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="comment">   \n</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="comment">   and suppress the on-screen output from Hypre.</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="comment">   \n\n</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="comment">   \until }</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="comment">   \n</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="comment">   For modest Reynolds numbers, performing a single multigrid cycle also</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="comment">   provides a good approximate solver for linear systems involving</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="comment">   the momentum block, \f$ {\bf F}, \f$ so we repeat the steps</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="comment">   just listed, using the solver flags assigned in another</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="comment">   helper function in the namespace  \c Hypre_default_settings:</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="comment">   \n\n</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="comment">   \skipline F_matrix_preconditioner_pt = new HyprePreconditioner;</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="comment">   \until Prec_pt-&gt;set_f_preconditioner</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="comment">   The driver code contains various other preconditioning options which you</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="comment">   should explore yourself.</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="comment">.</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="comment">&lt;HR&gt; </span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="comment">\section comm_ex Further comments and exercises</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="comment">Use the driver code </span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="comment">&lt;A HREF=&quot;../../../../demo_drivers/linear_solvers/driven_cavity.cc&quot;&gt;</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="comment">demo_drivers/linear_solvers/driven_cavity.cc&lt;/a&gt; to explore the</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="comment">behaviour of the preconditioner for the driven cavity problem.</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="comment">The driver code uses command line flags to specify various</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<span class="comment">solver/preconditioner combinations. </span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="comment">-# Show that for Taylor-Hood (Q2Q1) elements, the preconditioner</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="comment">   performs extremely well, i.e. the solve time increases</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;<span class="comment">   approximately linearly with the number of degrees of freedom.</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;<span class="comment">   \n\n</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="comment">-# Show that for Crouzeix-Raviart (Q2Q-1) elements, the use</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="comment">   of the AMG solver for the pressure Schur complement block</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="comment">   leads to a very poor performance. </span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="comment">   \n\n</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;<span class="comment">-# Examine iteration numbers and CPU times for various problem sizes</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="comment">   and show that for Taylor-Hood (Q2Q1) elements, the preconditioner</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="comment">   leads to near-optimal behaviour in the sense that the CPU times</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;<span class="comment">   increase approximately linearly with the number of unknowns.</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="comment">   Determine the &quot;break-even&quot; point in the CPU times for </span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="comment">   the solution by direct and iterative solvers. \b Hint: You may </span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="comment">   wish to use the shell script </span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="comment">   &lt;A HREF=&quot;../../../../demo_drivers/linear_solvers/time_driven_cavity.bash&quot;&gt;</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="comment">   time_driven_cavity.bash&lt;/a&gt; to perform the parameter studies.</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;<span class="comment">   \n\n</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;<span class="comment">&lt;/A&gt;</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;<span class="comment">.</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;<span class="comment">For your reference, here are a few timings (total time in seconds for</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;<span class="comment">the Newton solver) obtained from runs at a Reynolds number of</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;<span class="comment">\f$ Re=100 \f$ on various uniformly refined meshes. The first column in </span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;<span class="comment">the tables shows the total number of degrees of freedom; the</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;<span class="comment">subsequent columns show the solve times for different</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;<span class="comment">solver/preconditioner combinations. For instance, </span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;<span class="comment">GMRES [SuperLU,AMG] means that the linear systems were solved</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="comment">using the LSC preconditioner with an exact solve for the momentum</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="comment">block and an approximate AMG solve (a single multigrid cycle)</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="comment">for the pressure Schur complement block. All runs were performed </span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="comment">with full optimisation (-O6) on an Intel Xeon 3.6GHz processor.</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="comment">&lt;b&gt;&lt;center&gt;Taylor Hood&lt;/center&gt;&lt;/b&gt;</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="comment">&lt;table border=1&gt;</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="comment">&lt;tr&gt;&lt;th&gt;# of dofs&lt;/th&gt;&lt;th&gt;SuperLU&lt;/th&gt;&lt;th&gt;GMRES [SuperLU,SuperLU]&lt;/th&gt;&lt;th&gt;GMRES [SuperLU,AMG]&lt;/th&gt;&lt;th&gt;GMRES [AMG,SuperLU]&lt;/th&gt;&lt;th&gt;GMRES [AMG,AMG]&lt;/th&gt;&lt;/tr&gt;</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="comment">&lt;tr&gt;&lt;td&gt;842&lt;/td&gt;&lt;td&gt; 0.38 &lt;/td&gt;&lt;td&gt; 0.51 &lt;/td&gt;&lt;td&gt; 0.52 &lt;/td&gt;&lt;td&gt; 0.93 &lt;/td&gt;&lt;td&gt; 0.91&lt;/td&gt;&lt;/tr&gt;</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="comment">&lt;tr&gt;&lt;td&gt;3482&lt;/td&gt;&lt;td&gt; 2.32 &lt;/td&gt;&lt;td&gt; 2.56 &lt;/td&gt;&lt;td&gt; 2.28 &lt;/td&gt;&lt;td&gt; 3.15 &lt;/td&gt;&lt;td&gt; 3.04&lt;/td&gt;&lt;/tr&gt;</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;<span class="comment">&lt;tr&gt;&lt;td&gt;7922&lt;/td&gt;&lt;td&gt; 9.24 &lt;/td&gt;&lt;td&gt; 6.34 &lt;/td&gt;&lt;td&gt; 6.3 &lt;/td&gt;&lt;td&gt; 7.54 &lt;/td&gt;&lt;td&gt; 7.41&lt;/td&gt;&lt;/tr&gt;</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;<span class="comment">&lt;tr&gt;&lt;td&gt;14162&lt;/td&gt;&lt;td&gt; 15.71 &lt;/td&gt;&lt;td&gt; 18.06 &lt;/td&gt;&lt;td&gt; 17.84 &lt;/td&gt;&lt;td&gt; 13.8 &lt;/td&gt;&lt;td&gt; 13.46&lt;/td&gt;&lt;/tr&gt;</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;<span class="comment">&lt;tr&gt;&lt;td&gt;22202&lt;/td&gt;&lt;td&gt; 36.88 &lt;/td&gt;&lt;td&gt; 28.46 &lt;/td&gt;&lt;td&gt; 27.21 &lt;/td&gt;&lt;td&gt; 23.26 &lt;/td&gt;&lt;td&gt; 23.29&lt;/td&gt;&lt;/tr&gt;</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;<span class="comment">&lt;tr&gt;&lt;td&gt;32042&lt;/td&gt;&lt;td&gt; 62.29 &lt;/td&gt;&lt;td&gt; 37.27 &lt;/td&gt;&lt;td&gt; 36.26 &lt;/td&gt;&lt;td&gt; 29.38 &lt;/td&gt;&lt;td&gt; 25.84&lt;/td&gt;&lt;/tr&gt;</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;<span class="comment">&lt;tr&gt;&lt;td&gt;43682&lt;/td&gt;&lt;td&gt; 108.97 &lt;/td&gt;&lt;td&gt; 66.26 &lt;/td&gt;&lt;td&gt; 57.7 &lt;/td&gt;&lt;td&gt; 41.71 &lt;/td&gt;&lt;td&gt; 37.6&lt;/td&gt;&lt;/tr&gt;</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;<span class="comment">&lt;/table&gt;</span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;<span class="comment">&lt;b&gt;&lt;center&gt;Crouzeix Raviart&lt;/center&gt;&lt;/b&gt;</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<span class="comment">&lt;table border=1&gt;</span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;<span class="comment">&lt;tr&gt;&lt;th&gt;# of dofs&lt;/th&gt;&lt;th&gt;SuperLU&lt;/th&gt;&lt;th&gt;GMRES [SuperLU,SuperLU]&lt;/th&gt;&lt;th&gt;GMRES [SuperLU,AMG]&lt;/th&gt;&lt;th&gt;GMRES [AMG,SuperLU]&lt;/th&gt;&lt;th&gt;GMRES [AMG,AMG]&lt;/th&gt;&lt;/tr&gt;</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;<span class="comment">&lt;tr&gt;&lt;td&gt;1021 &lt;/td&gt;&lt;td&gt; 0.29 &lt;/td&gt;&lt;td&gt; 0.51 &lt;/td&gt;&lt;td&gt; 0.72 &lt;/td&gt;&lt;td&gt; 0.72 &lt;/td&gt;&lt;td&gt; 0.99&lt;/td&gt;&lt;/tr&gt;</span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;<span class="comment">&lt;tr&gt;&lt;td&gt;4241 &lt;/td&gt;&lt;td&gt; 1.82 &lt;/td&gt;&lt;td&gt; 2.79 &lt;/td&gt;&lt;td&gt; 4.83 &lt;/td&gt;&lt;td&gt; 3.62 &lt;/td&gt;&lt;td&gt; 7.03&lt;/td&gt;&lt;/tr&gt;</span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;<span class="comment">&lt;tr&gt;&lt;td&gt;9661 &lt;/td&gt;&lt;td&gt; 7.06 &lt;/td&gt;&lt;td&gt; 8.06 &lt;/td&gt;&lt;td&gt; 20.43 &lt;/td&gt;&lt;td&gt; 9.64 &lt;/td&gt;&lt;td&gt; 27.33&lt;/td&gt;&lt;/tr&gt;</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;<span class="comment">&lt;tr&gt;&lt;td&gt;17281 &lt;/td&gt;&lt;td&gt; 20.79 &lt;/td&gt;&lt;td&gt; 19.62 &lt;/td&gt;&lt;td&gt; 67.62 &lt;/td&gt;&lt;td&gt; 20.15 &lt;/td&gt;&lt;td&gt; 87.39&lt;/td&gt;&lt;/tr&gt;</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;<span class="comment">&lt;tr&gt;&lt;td&gt;27101 &lt;/td&gt;&lt;td&gt; 55.43 &lt;/td&gt;&lt;td&gt; 44.34 &lt;/td&gt;&lt;td&gt; 169.8 &lt;/td&gt;&lt;td&gt; 46.04 &lt;/td&gt;&lt;td&gt; 227.11&lt;/td&gt;&lt;/tr&gt;</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;<span class="comment">&lt;tr&gt;&lt;td&gt;39121 &lt;/td&gt;&lt;td&gt; 93.75 &lt;/td&gt;&lt;td&gt; 64.02 &lt;/td&gt;&lt;td&gt; 277.29 &lt;/td&gt;&lt;td&gt; 39.73 &lt;/td&gt;&lt;td&gt; 314.25&lt;/td&gt;&lt;/tr&gt;</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;<span class="comment">&lt;tr&gt;&lt;td&gt;53341 &lt;/td&gt;&lt;td&gt; 108.96 &lt;/td&gt;&lt;td&gt; 78.27 &lt;/td&gt;&lt;td&gt; 521.00 &lt;/td&gt;&lt;td&gt;60.02 &lt;/td&gt;&lt;td&gt; 596.27&lt;/td&gt;&lt;/tr&gt;</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;<span class="comment">&lt;/table&gt;</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;<span class="comment">\section sources Source files for this tutorial</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="comment">- The source files for this tutorial are located in the directory:\n\n</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;<span class="comment">&lt;CENTER&gt;</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="comment">&lt;A HREF=&quot;../../../../demo_drivers/linear_solvers/&quot;&gt;</span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;<span class="comment">demo_drivers/linear_solvers/</span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;<span class="comment">&lt;/A&gt;</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;<span class="comment">&lt;/CENTER&gt;\n</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;<span class="comment">- The driver code is: \n\n</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;<span class="comment">&lt;CENTER&gt;</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;<span class="comment">&lt;A HREF=&quot;../../../../demo_drivers/linear_solvers/driven_cavity.cc&quot;&gt;</span></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;<span class="comment">demo_drivers/linear_solvers/driven_cavity.cc</span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;<span class="comment">&lt;/A&gt;</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;<span class="comment">&lt;/CENTER&gt;</span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="comment">&lt;hr&gt;</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="comment">&lt;hr&gt;</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<span class="comment">\section pdf PDF file</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="comment">A &lt;a href=&quot;../latex/refman.pdf&quot;&gt;pdf version&lt;/a&gt; of this document is available.</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="comment">**/</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160; </div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="alsc__navier__stokes_8txt_html_a1613ff05ffdc4bc3059e0132140efeaf"><div class="ttname"><a href="lsc__navier__stokes_8txt.html#a1613ff05ffdc4bc3059e0132140efeaf">Hint</a></div><div class="ttdeci">see ref comm_ex In these cases an efficient inexact solver is obtained by performing just a single multigrid cycle n n Assuming that&lt; a href=&quot;https: &lt;code&gt;Hypre&lt;/code&gt;&lt;/a&gt; is available, we therefore provide the option to use the \c Hypre AMG solver to solve the linear systems involving the \f$ {\bf P} \f$ matrix. \n\n \dontinclude driven_cavity.cc \skipline OOMPH_HAS_HYPRE \until new HyprePreconditioner; \n We set the various solver flags to values that are appropriate for 2D Poisson problems. This is most easily done by calling a helper function, defined in the namespace \c Hypre_default_settings: \n\n \skipline Set parameters \until static_cast&lt;HyprePreconditioner*&gt;P_matrix_preconditioner_pt)); \n Next we specify the \c Preconditioner as the inexact solver for the \f$ {\bf P} \f$ matrix, \n\n \until set_p_preconditioner \n and suppress the on-screen output from Hypre. \n\n \until } \n For modest Reynolds numbers, performing a single multigrid cycle also provides a good approximate solver for linear systems involving the momentum block, \f$ {\bf F}, \f$ so we repeat the steps just listed, using the solver flags assigned in another helper function in the namespace \c Hypre_default_settings: \n\n \skipline F_matrix_preconditioner_pt = new HyprePreconditioner; \until Prec_pt-&gt; set_f_preconditioner The driver code contains various other preconditioning options which you should explore yourself&lt;HR&gt;&lt;HR&gt; section comm_ex Further comments and exercises Use the driver code&lt;A HREF=&quot;../../../../demo_drivers/linear_solvers/driven_cavity.cc&quot;&gt; demo_drivers linear_solvers driven_cavity cc&lt;/a&gt; to explore the behaviour of the preconditioner for the driven cavity problem The driver code uses command line flags to specify various solver preconditioner combinations performs extremely i e the solve time increases approximately linearly with the number of degrees of freedom n n of the AMG solver for the pressure Schur complement block leads to a very poor performance n n and show that for Taylor the preconditioner leads to near optimal behaviour in the sense that the CPU times increase approximately linearly with the number of unknowns Determine the break even point in the CPU times for the solution by direct and iterative solvers b Hint</div><div class="ttdef"><b>Definition:</b> <a href="lsc__navier__stokes_8txt_source.html#l00249">lsc_navier_stokes.txt:249</a></div></div>
<div class="ttc" id="alsc__navier__stokes_8txt_html_a0e1d577c5c113f62c8b5dc29b97cba27"><div class="ttname"><a href="lsc__navier__stokes_8txt.html#a0e1d577c5c113f62c8b5dc29b97cba27">Wathen</a></div><div class="ttdeci">f is the momentum and the application of such a preconditioner of be exactly as expensive as a direct solve The LSC BFBT preconditioner replaces the exact Jacobian by a block triangular approximation f[\left(\begin{array}{cc}{\bf F} &amp;{\bf G} \\ {\bf 0} &amp;-{\bf M}_s \end{array} \right) \left(\begin{array}{c}{\bf z}_u \\ {\bf z}_p\end{array} \right)=\left(\begin{array}{c}{\bf r}_u \\ {\bf r}_p\end{array} \right),\f] where solve the first row for the action of the inverse pressure Schur complement f[{\bf z}_p=- {\bf M}_s^{-1} {\bf r}_p\f] is approximated by f[{\bf z}_p=- \big({\bf D} \widehat{\bf Q}^{-1}{\bf G} \big)^{-1}\big({\bf D} \widehat{\bf Q}^{-1}{\bf F} \widehat{\bf Q}^{-1}{\bf G}\big) \big({\bf D} \widehat{\bf Q}^{-1}{\bf G} \big)^{-1}{\bf r}_p,\f] where f David J and Andrew Wathen)</div><div class="ttdef"><b>Definition:</b> <a href="lsc__navier__stokes_8txt_source.html#l00111">lsc_navier_stokes.txt:111</a></div></div>
<div class="ttc" id="alsc__navier__stokes_8txt_html_a168024df31711c6ac6fa53fe9183d7f3"><div class="ttname"><a href="lsc__navier__stokes_8txt.html#a168024df31711c6ac6fa53fe9183d7f3">Silvester</a></div><div class="ttdeci">f is the momentum and the application of such a preconditioner of be exactly as expensive as a direct solve The LSC BFBT preconditioner replaces the exact Jacobian by a block triangular approximation f[\left(\begin{array}{cc}{\bf F} &amp;{\bf G} \\ {\bf 0} &amp;-{\bf M}_s \end{array} \right) \left(\begin{array}{c}{\bf z}_u \\ {\bf z}_p\end{array} \right)=\left(\begin{array}{c}{\bf r}_u \\ {\bf r}_p\end{array} \right),\f] where solve the first row for the action of the inverse pressure Schur complement f[{\bf z}_p=- {\bf M}_s^{-1} {\bf r}_p\f] is approximated by f[{\bf z}_p=- \big({\bf D} \widehat{\bf Q}^{-1}{\bf G} \big)^{-1}\big({\bf D} \widehat{\bf Q}^{-1}{\bf F} \widehat{\bf Q}^{-1}{\bf G}\big) \big({\bf D} \widehat{\bf Q}^{-1}{\bf G} \big)^{-1}{\bf r}_p,\f] where f David Silvester)</div><div class="ttdef"><b>Definition:</b> <a href="lsc__navier__stokes_8txt_source.html#l00111">lsc_navier_stokes.txt:111</a></div></div>
<div class="ttc" id="alsc__navier__stokes_8txt_html_acf1021aac58de3324ec57f9713f60eb3"><div class="ttname"><a href="lsc__navier__stokes_8txt.html#acf1021aac58de3324ec57f9713f60eb3">Hood</a></div><div class="ttdeci">see ref comm_ex In these cases an efficient inexact solver is obtained by performing just a single multigrid cycle n n Assuming that&lt; a href=&quot;https: &lt;code&gt;Hypre&lt;/code&gt;&lt;/a&gt; is available, we therefore provide the option to use the \c Hypre AMG solver to solve the linear systems involving the \f$ {\bf P} \f$ matrix. \n\n \dontinclude driven_cavity.cc \skipline OOMPH_HAS_HYPRE \until new HyprePreconditioner; \n We set the various solver flags to values that are appropriate for 2D Poisson problems. This is most easily done by calling a helper function, defined in the namespace \c Hypre_default_settings: \n\n \skipline Set parameters \until static_cast&lt;HyprePreconditioner*&gt;P_matrix_preconditioner_pt)); \n Next we specify the \c Preconditioner as the inexact solver for the \f$ {\bf P} \f$ matrix, \n\n \until set_p_preconditioner \n and suppress the on-screen output from Hypre. \n\n \until } \n For modest Reynolds numbers, performing a single multigrid cycle also provides a good approximate solver for linear systems involving the momentum block, \f$ {\bf F}, \f$ so we repeat the steps just listed, using the solver flags assigned in another helper function in the namespace \c Hypre_default_settings: \n\n \skipline F_matrix_preconditioner_pt = new HyprePreconditioner; \until Prec_pt-&gt; set_f_preconditioner The driver code contains various other preconditioning options which you should explore yourself&lt;HR&gt;&lt;HR&gt; section comm_ex Further comments and exercises Use the driver code&lt;A HREF=&quot;../../../../demo_drivers/linear_solvers/driven_cavity.cc&quot;&gt; demo_drivers linear_solvers driven_cavity cc&lt;/a&gt; to explore the behaviour of the preconditioner for the driven cavity problem The driver code uses command line flags to specify various solver preconditioner combinations performs extremely i e the solve time increases approximately linearly with the number of degrees of freedom n n of the AMG solver for the pressure Schur complement block leads to a very poor performance n n and show that for Taylor Hood(Q2Q1) elements</div></div>
<div class="ttc" id="alsc__navier__stokes_8txt_html_a1d1c1b37c581dc4db58b24b5a2aa65bc"><div class="ttname"><a href="lsc__navier__stokes_8txt.html#a1d1c1b37c581dc4db58b24b5a2aa65bc">instance</a></div><div class="ttdeci">the subsequent columns show the solve times for different solver preconditioner combinations For instance</div><div class="ttdef"><b>Definition:</b> <a href="lsc__navier__stokes_8txt_source.html#l00254">lsc_navier_stokes.txt:254</a></div></div>
<div class="ttc" id="alsc__navier__stokes_8txt_html_aba08d0300caab87b63e321afcb2f9790"><div class="ttname"><a href="lsc__navier__stokes_8txt.html#aba08d0300caab87b63e321afcb2f9790">exactly</a></div><div class="ttdeci">f is the momentum and the application of such a preconditioner of be exactly as expensive as a direct solve The LSC BFBT preconditioner replaces the exact Jacobian by a block triangular approximation f[\left(\begin{array}{cc}{\bf F} &amp;{\bf G} \\ {\bf 0} &amp;-{\bf M}_s \end{array} \right) \left(\begin{array}{c}{\bf z}_u \\ {\bf z}_p\end{array} \right)=\left(\begin{array}{c}{\bf r}_u \\ {\bf r}_p\end{array} \right),\f] where solve the first row for the action of the inverse pressure Schur complement f[{\bf z}_p=- {\bf M}_s^{-1} {\bf r}_p\f] is approximated by f[{\bf z}_p=- \big({\bf D} \widehat{\bf Q}^{-1}{\bf G} \big)^{-1}\big({\bf D} \widehat{\bf Q}^{-1}{\bf F} \widehat{\bf Q}^{-1}{\bf G}\big) \big({\bf D} \widehat{\bf Q}^{-1}{\bf G} \big)^{-1}{\bf r}_p,\f] where f David J and Andrew J published by Oxford University n n In our implementation of the the linear systems can either be solve exactly)</div><div class="ttdef"><b>Definition:</b> <a href="lsc__navier__stokes_8txt_source.html#l00116">lsc_navier_stokes.txt:116</a></div></div>
<div class="ttc" id="alsc__navier__stokes_8txt_html_ac07cb3fe8e2084217afe1dbfd8fb277f"><div class="ttname"><a href="lsc__navier__stokes_8txt.html#ac07cb3fe8e2084217afe1dbfd8fb277f">widehat</a></div><div class="ttdeci">f is the momentum and the application of such a preconditioner of be exactly as expensive as a direct solve The LSC BFBT preconditioner replaces the exact Jacobian by a block triangular approximation f[\left(\begin{array}{cc}{\bf F} &amp;{\bf G} \\ {\bf 0} &amp;-{\bf M}_s \end{array} \right) \left(\begin{array}{c}{\bf z}_u \\ {\bf z}_p\end{array} \right)=\left(\begin{array}{c}{\bf r}_u \\ {\bf r}_p\end{array} \right),\f] where solve the first row for the action of the inverse pressure Schur complement f[{\bf z}_p=- {\bf M}_s^{-1} {\bf r}_p\f] is approximated by f[{\bf z}_p=- \big({\bf D} \widehat{\bf Q}^{-1}{\bf G} \big)^{-1}\big({\bf D} \widehat{\bf Q}^{-1}{\bf F} \widehat{\bf Q}^{-1}{\bf G}\big) \big({\bf D} \widehat{\bf Q}^{-1}{\bf G} \big)^{-1}{\bf r}_p,\f] where widehat)</div><div class="ttdef"><b>Definition:</b> <a href="lsc__navier__stokes_8txt_source.html#l00097">lsc_navier_stokes.txt:97</a></div></div>
<div class="ttc" id="alsc__navier__stokes_8txt_html_a5d36b587f2aea858300916def4397b9c"><div class="ttname"><a href="lsc__navier__stokes_8txt.html#a5d36b587f2aea858300916def4397b9c">Commutator</a></div><div class="ttdeci">mainpage The Least Squares Commutator(LSC) Navier-Stokes preconditioner The purpose of this tutorial is to show how to use \c oomph-lib 's Least Squares Commutator(LSC) Navier-Stokes preconditioner.&lt; HR &gt;&lt; HR &gt; \section theory Theory \c oomph-lib currently provides two types of(LBB-stable) Navier-Stokes elements</div><div class="ttdef"><b>Definition:</b> <a href="lsc__navier__stokes_8txt_source.html#l00001">lsc_navier_stokes.txt:1</a></div></div>
<div class="ttc" id="alsc__navier__stokes_8txt_html_a5a1cd221878fb9adfd9b694452e24988"><div class="ttname"><a href="lsc__navier__stokes_8txt.html#a5a1cd221878fb9adfd9b694452e24988">would</a></div><div class="ttdeci">f is the momentum and the application of such a preconditioner would</div><div class="ttdef"><b>Definition:</b> <a href="lsc__navier__stokes_8txt_source.html#l00052">lsc_navier_stokes.txt:52</a></div></div>
<div class="ttc" id="alsc__navier__stokes_8txt_html_a644ebc72073374f2bafb92cbdf504725"><div class="ttname"><a href="lsc__navier__stokes_8txt.html#a644ebc72073374f2bafb92cbdf504725">preconditioner</a></div><div class="ttdeci">f is the momentum and the application of such a preconditioner of be exactly as expensive as a direct solve The LSC BFBT preconditioner replaces the exact Jacobian by a block triangular approximation f[\left(\begin{array}{cc}{\bf F} &amp;{\bf G} \\ {\bf 0} &amp;-{\bf M}_s \end{array} \right) \left(\begin{array}{c}{\bf z}_u \\ {\bf z}_p\end{array} \right)=\left(\begin{array}{c}{\bf r}_u \\ {\bf r}_p\end{array} \right),\f] where solve the first row for the action of the inverse pressure Schur complement f[{\bf z}_p=- {\bf M}_s^{-1} {\bf r}_p\f] is approximated by f[{\bf z}_p=- \big({\bf D} \widehat{\bf Q}^{-1}{\bf G} \big)^{-1}\big({\bf D} \widehat{\bf Q}^{-1}{\bf F} \widehat{\bf Q}^{-1}{\bf G}\big) \big({\bf D} \widehat{\bf Q}^{-1}{\bf G} \big)^{-1}{\bf r}_p,\f] where f David J and Andrew J published by Oxford University n n In our implementation of th preconditioner)</div><div class="ttdef"><b>Definition:</b> <a href="lsc__navier__stokes_8txt_source.html#l00115">lsc_navier_stokes.txt:115</a></div></div>
<div class="ttc" id="alsc__navier__stokes_8txt_html_a529439aee3f3385c7fb637dbd4bcea5d"><div class="ttname"><a href="lsc__navier__stokes_8txt.html#a529439aee3f3385c7fb637dbd4bcea5d">course</a></div><div class="ttdeci">f is the momentum and the application of such a preconditioner of course</div><div class="ttdef"><b>Definition:</b> <a href="lsc__navier__stokes_8txt_source.html#l00052">lsc_navier_stokes.txt:52</a></div></div>
<div class="ttc" id="alsc__navier__stokes_8txt_html_ae70944f4910e5d3db6a8296313731cce"><div class="ttname"><a href="lsc__navier__stokes_8txt.html#ae70944f4910e5d3db6a8296313731cce">f</a></div><div class="ttdeci">f is the momentum f</div><div class="ttdef"><b>Definition:</b> <a href="lsc__navier__stokes_8txt_source.html#l00043">lsc_navier_stokes.txt:43</a></div></div>
<div class="ttc" id="alsc__navier__stokes_8txt_html_aa2f0c59a068fabe41979bec02f2bc917"><div class="ttname"><a href="lsc__navier__stokes_8txt.html#aa2f0c59a068fabe41979bec02f2bc917">timings</a></div><div class="ttdeci">see ref comm_ex In these cases an efficient inexact solver is obtained by performing just a single multigrid cycle n n Assuming that&lt; a href=&quot;https: &lt;code&gt;Hypre&lt;/code&gt;&lt;/a&gt; is available, we therefore provide the option to use the \c Hypre AMG solver to solve the linear systems involving the \f$ {\bf P} \f$ matrix. \n\n \dontinclude driven_cavity.cc \skipline OOMPH_HAS_HYPRE \until new HyprePreconditioner; \n We set the various solver flags to values that are appropriate for 2D Poisson problems. This is most easily done by calling a helper function, defined in the namespace \c Hypre_default_settings: \n\n \skipline Set parameters \until static_cast&lt;HyprePreconditioner*&gt;P_matrix_preconditioner_pt)); \n Next we specify the \c Preconditioner as the inexact solver for the \f$ {\bf P} \f$ matrix, \n\n \until set_p_preconditioner \n and suppress the on-screen output from Hypre. \n\n \until } \n For modest Reynolds numbers, performing a single multigrid cycle also provides a good approximate solver for linear systems involving the momentum block, \f$ {\bf F}, \f$ so we repeat the steps just listed, using the solver flags assigned in another helper function in the namespace \c Hypre_default_settings: \n\n \skipline F_matrix_preconditioner_pt = new HyprePreconditioner; \until Prec_pt-&gt; set_f_preconditioner The driver code contains various other preconditioning options which you should explore yourself&lt;HR&gt;&lt;HR&gt; section comm_ex Further comments and exercises Use the driver code&lt;A HREF=&quot;../../../../demo_drivers/linear_solvers/driven_cavity.cc&quot;&gt; demo_drivers linear_solvers driven_cavity cc&lt;/a&gt; to explore the behaviour of the preconditioner for the driven cavity problem The driver code uses command line flags to specify various solver preconditioner combinations performs extremely i e the solve time increases approximately linearly with the number of degrees of freedom n n of the AMG solver for the pressure Schur complement block leads to a very poor performance n n and show that for Taylor the preconditioner leads to near optimal behaviour in the sense that the CPU times increase approximately linearly with the number of unknowns Determine the break even point in the CPU times for the solution by direct and iterative solvers b here are a few timings(total time in seconds for the Newton solver) obtained from runs at a Reynolds number of \f$ Re</div></div>
<div class="ttc" id="alsc__navier__stokes_8txt_html_a99eb52766bf362bc3b530e315900b339"><div class="ttname"><a href="lsc__navier__stokes_8txt.html#a99eb52766bf362bc3b530e315900b339">multigrid</a></div><div class="ttdeci">n n The behaviour of many preconditioners can be fine tuned for specific applications The c NavierStokesLSCPreconditioner provides the option to perform the linear solves involving the rather than with the exact preconditioner c SuperLUPreconditioner Since the matrix it may be solved efficiently with algebraic multigrid(AMG) -- at least for elements that employ a continuous pressure approximation</div></div>
<div class="ttc" id="alsc__navier__stokes_8txt_html_adda4a50d416acd1476a2cc3d506ed8e3"><div class="ttname"><a href="lsc__navier__stokes_8txt.html#adda4a50d416acd1476a2cc3d506ed8e3">block</a></div><div class="ttdeci">f is the momentum block</div><div class="ttdef"><b>Definition:</b> <a href="lsc__navier__stokes_8txt_source.html#l00043">lsc_navier_stokes.txt:43</a></div></div>
<div class="ttc" id="alsc__navier__stokes_8txt_html_a8b808f9e3e9de4910e4a5d5626e79e57"><div class="ttname"><a href="lsc__navier__stokes_8txt.html#a8b808f9e3e9de4910e4a5d5626e79e57">well</a></div><div class="ttdeci">see ref comm_ex In these cases an efficient inexact solver is obtained by performing just a single multigrid cycle n n Assuming that&lt; a href=&quot;https: &lt;code&gt;Hypre&lt;/code&gt;&lt;/a&gt; is available, we therefore provide the option to use the \c Hypre AMG solver to solve the linear systems involving the \f$ {\bf P} \f$ matrix. \n\n \dontinclude driven_cavity.cc \skipline OOMPH_HAS_HYPRE \until new HyprePreconditioner; \n We set the various solver flags to values that are appropriate for 2D Poisson problems. This is most easily done by calling a helper function, defined in the namespace \c Hypre_default_settings: \n\n \skipline Set parameters \until static_cast&lt;HyprePreconditioner*&gt;P_matrix_preconditioner_pt)); \n Next we specify the \c Preconditioner as the inexact solver for the \f$ {\bf P} \f$ matrix, \n\n \until set_p_preconditioner \n and suppress the on-screen output from Hypre. \n\n \until } \n For modest Reynolds numbers, performing a single multigrid cycle also provides a good approximate solver for linear systems involving the momentum block, \f$ {\bf F}, \f$ so we repeat the steps just listed, using the solver flags assigned in another helper function in the namespace \c Hypre_default_settings: \n\n \skipline F_matrix_preconditioner_pt = new HyprePreconditioner; \until Prec_pt-&gt; set_f_preconditioner The driver code contains various other preconditioning options which you should explore yourself&lt;HR&gt;&lt;HR&gt; section comm_ex Further comments and exercises Use the driver code&lt;A HREF=&quot;../../../../demo_drivers/linear_solvers/driven_cavity.cc&quot;&gt; demo_drivers linear_solvers driven_cavity cc&lt;/a&gt; to explore the behaviour of the preconditioner for the driven cavity problem The driver code uses command line flags to specify various solver preconditioner combinations performs extremely well</div><div class="ttdef"><b>Definition:</b> <a href="lsc__navier__stokes_8txt_source.html#l00227">lsc_navier_stokes.txt:227</a></div></div>
<div class="ttc" id="alsc__navier__stokes_8txt_html_ac9b8200742371424ddc4592dbdae8327"><div class="ttname"><a href="lsc__navier__stokes_8txt.html#ac9b8200742371424ddc4592dbdae8327">Press</a></div><div class="ttdeci">f is the momentum and the application of such a preconditioner of be exactly as expensive as a direct solve The LSC BFBT preconditioner replaces the exact Jacobian by a block triangular approximation f[\left(\begin{array}{cc}{\bf F} &amp;{\bf G} \\ {\bf 0} &amp;-{\bf M}_s \end{array} \right) \left(\begin{array}{c}{\bf z}_u \\ {\bf z}_p\end{array} \right)=\left(\begin{array}{c}{\bf r}_u \\ {\bf r}_p\end{array} \right),\f] where solve the first row for the action of the inverse pressure Schur complement f[{\bf z}_p=- {\bf M}_s^{-1} {\bf r}_p\f] is approximated by f[{\bf z}_p=- \big({\bf D} \widehat{\bf Q}^{-1}{\bf G} \big)^{-1}\big({\bf D} \widehat{\bf Q}^{-1}{\bf F} \widehat{\bf Q}^{-1}{\bf G}\big) \big({\bf D} \widehat{\bf Q}^{-1}{\bf G} \big)^{-1}{\bf r}_p,\f] where f David J and Andrew J published by Oxford Universit Press)</div><div class="ttdef"><b>Definition:</b> <a href="lsc__navier__stokes_8txt_source.html#l00112">lsc_navier_stokes.txt:112</a></div></div>

    <!-- jQuery for Bootstrap and Doxygen -->
    <script src="../../../js/jquery-1.12.0.min.js"></script>
    <!-- Minified boostrap plugins-->
    <script src="../../../js/bootstrap.js"></script>
    <!-- Doxygen dependency to add powertips to source code-->
    <script src="../../../js/jquery.powertip.min.js"></script>
    <!-- The  following script is generated by doxygen and hides/shows levels in 
         the data structure lists and adds powertips to source code-->
    <script src="../../../js/dynsections.js" ></script>
    <!-- add to Doxygen's class names so bootstrap css and js recognises them-->
    <script type="text/javascript">
    $(".contents").addClass("container");
    $(".header").addClass("container");
    $(".navpath").addClass("container");
    $("#navrow3").addClass("container");
    $("#navrow4").addClass("container");
    $(".mlabel").addClass("label");
    $(".mlabel").addClass("label-default");
    $(".memitem").addClass("panel");
    $(".memitem").addClass("panel-info");
    $(".memproto").addClass("panel-heading");
    $(".memdoc").addClass("panel-body");
    </script>
    <footer>
      <div class="container">
        <div class="text-muted" style="float:right;">Generated by <a href="http://www.doxygen.org/index.html">
          <img style="height:18px;" class="footer-img" src="doxygen.png" alt="doxygen"></a> on Wed Aug 4 2021 20:34:45
        </div>
      </div>
    </footer>
</body>
</html>

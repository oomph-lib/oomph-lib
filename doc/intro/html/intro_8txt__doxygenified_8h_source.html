<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
<title>oomph-lib: intro.txt_doxygenified.h Source File</title>
<link rel="apple-touch-icon" sizes="57x57" href="../../figures/apple-touch-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="../../figures/apple-touch-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="../../figures/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="../../figures/apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="../../figures/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="../../figures/apple-touch-icon-120x120.png">
<link rel="icon" type="image/png" href="../../figures/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="../../figures/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="../../figures/favicon-16x16.png" sizes="16x16">
<link rel="manifest" href="../../figures/manifest.json">
<link rel="mask-icon" href="../../figures/safari-pinned-tab.svg" color="#008000">
<link rel="shortcut icon" href="../../figures/favicon.ico">
<meta name="msapplication-TileColor" content="#00a300">
<meta name="msapplication-config" content="../../figures/browserconfig.xml">
<meta name="theme-color" content="#008000">
<link href="http://fonts.googleapis.com/css?family=Open+Sans:400,300,600" rel="stylesheet" type="text/css">
<!-- Doxygen css-->
<!-- <link rel="stylesheet" type="text/css" href="doxygen.css"> -->
<!-- Bootstrap -->
<link href="../../css/bootstrap.css" rel="stylesheet">
<!-- oomph-lib specific overrides -->
<link rel="stylesheet" type="text/css" href="../../css/oomph_header.css">
</head>
<body>
<nav class="navbar navbar-default">
<div class="container">
<div class="container-fluid">
  <!-- Brand and toggle get grouped for better mobile display -->
  <div class="navbar-header">
    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
      <span class="sr-only">Toggle navigation</span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="../../html/index.html"><img alt="oomph-lib" src="../../figures/oomph_logo.png"></a>
  </div>
  <!-- Collect the nav links, forms, and other content for toggling -->
  <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
    <ul class="nav navbar-nav">          
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Documentation <span class="caret"></span></a>
        <ul class="dropdown-menu">
          <li class="dropdown-header">Big picture</li>
          <li><a href="../../../doc/intro/html/index.html">The finite element method</a></li>
          <li><a href="../../../doc/the_data_structure/html/index.html">The data structure</a></li>
          <li><a href="../../../doc/quick_guide/html/index.html">Not-so-quick guide</a></li>
          <li><a href="../../../doc/optimisation/html/index.html">Optimisation</a></li>
          <li><a href="../../../doc/order_of_action_functions/html/index.html">Order of action functions</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Example codes and tutorials</li>
          <li><a href="../../../doc/example_code_list/html/index.html">List of example codes and tutorials</a></li>
          <li><a href="../../../doc/example_code_list/html/index.html#meshes">Meshing</a></li>
          <li><a href="../../../doc/example_code_list/html/index.html#solvers">Solvers</a></li>
          <li><a href="../../../doc/example_code_list/html/index.html#parallel">MPI parallel processing</a></li>
          <li><a href="../../../doc/example_code_list/html/index.html#visualisation">Post-processing/visualisation</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Other</li>
          <li><a href="../../../doc/change_log/html/index.html">Change log</a></li>
          <li><a href="../../../doc/creating_doc/html/index.html">Creating documentation</a></li>
          <li><a href="../../../doc/coding_conventions/html/index.html">Coding conventions</a></li>
          <li><a href="../../../doc/index/html/index.html">Index</a></li>
          <li><a href="../../../doc/FAQ/html/index.html">FAQ</a></li>
        </ul>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Get it <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../doc/the_distribution/html/index.html">Installation guide</a></li>
            <li><a href="../../../doc/subversion/html/index.html">Get code from subversion repository</a></li>
            <li><a href="../../../doc/download/html/index.html">Get code as tar file</a></li>
            <li><a href="../../../doc/copyright/html/index.html">Copyright</a></li>
          </ul>
        </li>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">About <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../doc/people/html/index.html">People</a></li>            
            <li><a href="../../../doc/contact/html/index.html">Contact/Get involved</a></li>
            <li><a href="../../../doc/publications/html/index.html">Publications</a></li>
            <li><a href="../../../doc/acknowledgements/html/index.html">Acknowledgements</a></li>
            <li><a href="../../../doc/picture_show/index.html">Picture show</a></li>
          </ul>
        </li>
      </li>
    </ul>
    <ul class="nav navbar-nav navbar-right navbar-search">
      <form class="navbar-form" role="search" action="../../../doc/search_results/html/index.html">
        <div class="input-group">
          <input type="text" class="form-control" placeholder="Search" name="q">
          <span class="input-group-btn">
            <button class="btn btn-default" type="submit">Go</button>
          </span>
        </div><!-- /input-group -->
       <!--<div class="form-group">
          <input type="text" class="form-control" placeholder="Search">
        </div>
        <button type="submit" class="btn btn-default">Submit</button>-->
      </form>
    </ul>
  </div><!-- /.navbar-collapse -->
</div><!-- /.container-fluid -->
</div>
</nav>
<!-- Generated by Doxygen 1.8.17 -->
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">intro.txt_doxygenified.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="intro_8txt__doxygenified_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">\mainpage The Finite Element Method</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">\section intro Introduction</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">This document provides a brief introduction to the finite element</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">method and illustrates how the method is implemented in \c oomph-lib. </span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">The first few sections present a brief, self-contained </span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">derivation of the method. The exposition is</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">&quot;constructive&quot; and avoids a number of subtleties, </span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">which can be found in standard  textbooks [e.g. </span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">E.B. Becker, G.F. Carey, and J.T. Oden. </span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">Finite Elements: An Introduction. Prentice-Hall, Englewood </span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">Cliffs, New Jersey, (1981)] . We </span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">generally assume that all functions are sufficiently &quot;well behaved&quot; </span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">so that all mathematical manipulations &quot;make sense&quot;.</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">Function  spaces are only used where</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">they help to make the notation more compact. </span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">Readers who are </span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">familiar with the theory of finite elements may skip the</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">introductory sections, but should consult the section \ref towards_oo which </span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">explains the particular implementation used in \c oomph-lib.</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment">Initially, we develop the method for scalar </span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment">second-order (elliptic) PDEs with Dirichlet boundary </span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">conditions, using classical 1D and 2D Poisson problems</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment">as model problems. Specifically, we consider the 1D problem</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment">\f[  \frac{\mbox{d}^2 u(x)}{\mbox{d} x^2} =</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment">f(x) \mbox{ \ \ \ \ for $x\in[0,1]$ \ \ \ subject to \ \ \ }  u(x=0)= g_0 </span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment">\mbox{\ \ \ and \ \ \ }</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment">u(x=1)= g_1,</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment">\mbox{\hspace{3cm}} \f]</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment">where \f$ f(x)\f$ and the constants \f$g_0\f$ and \f$g_1\f$ are given.</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment">The 2D equivalent is given by</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment">\frac{\partial^2 u(x_1,x_2)}{\partial x_1^{2}}  </span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment"> + \frac{\partial^{2} u(x_1,x_2)}{\partial x_2^{2}} =</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment">f(x_1,x_2)  \mbox{ \ \ \ \ for $(x_1,x_2)\in D$  </span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment">\ \ \ subject to \ \ \ }  u|_{\partial D} = g,</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment">\mbox{\hspace{5cm}} \f]</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment">where \f$ f(x_1,x_2)\f$ and \f$ g(x_1,x_2)\f$ are given.</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment">&lt;CENTER&gt;</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment">&lt;TABLE class=&quot;oomph-table&quot;&gt;</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment">&lt;TR&gt;</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment">&lt;TD class=&quot;panel panel-default&quot;&gt;</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment">&lt;CENTER class=&quot;panel-heading&quot;&gt;</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment">&lt;B&gt; A note on notation&lt;/B&gt; </span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment">&lt;/CENTER&gt;</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment">&lt;div class=&quot;panel-body&quot;&gt;</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment">Throughout this document, we use index notation and write, e.g.,</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="comment">\f$ u(x_1,x_2) \f$ as \f$ u(x_i) \f$. We do not explicitly </span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment">state the range of free indices where it is clear from the </span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment">context -- in the above example it would be equal to the </span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment">spatial dimension of the problem. </span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment">All mathematical derivations are presented using</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment">the &quot;natural&quot; numbering of the indices: e.g., the components</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment">of the 3D vector \f${\bf f}\f$ are \f$ f_1, f_2 \f$ and \f$ f_3 \f$.</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment">Unfortunately, this notation is inconsistent with the </span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment">implementation of vectors (and most other standard &quot;containers&quot;)</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment">in C++ where the indices start from 0 and the components of </span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment">\c vector&lt;double&gt; \c f(3) are \c f[0], \c f[1] and \c f[2].</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="comment">There is no elegant way to resolve this conflict. Adopting C++-style</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="comment">numbering in the theoretical development would make the mathematics</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="comment">look very odd (try it!); conversely, adopting the &quot;natural&quot; </span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="comment">numbering when discussing the C++-implementation would make this </span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment">documentation inconsistent with the actual implementation.</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="comment">We therefore use both numbering systems, each within their</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="comment">appropriate context.</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="comment">&lt;/div&gt;</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="comment">&lt;/TD&gt;</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="comment">&lt;/TR&gt;</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="comment">&lt;/TABLE&gt;</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="comment">&lt;/CENTER&gt;</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="comment">Physically, the Poisson equation describes steady diffusion processes.</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="comment">For instance, the 2D Poisson problem describes the temperature</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="comment">distribution \f$u(x_i) \f$ within a 2D body, \f$D\f$, whose boundary</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="comment">\f$\partial D\f$ </span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="comment">is maintained at a prescribed temperature, \f$ g(x_i)\f$. The</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="comment">function \f$ f(x_i)\f$ describes the strength of (distributed) heat sources</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="comment">in the body. In practical applications, the strength</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="comment">of these heat sources is bounded because no physical process can</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="comment">release infinite amounts of energy in a finite domain. </span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="comment">Hence, we assume that </span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="comment">\int_D f(x_i) \ dx_1 dx_2 &lt; \infty.</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="comment">We usually write all PDEs in &quot;residual form&quot;, obtained</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="comment">by moving all terms to the left-hand-side of the equation, so that</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="comment">the general second-order scalar PDE problem is</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="comment">&lt;CENTER&gt;</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="comment">&lt;TABLE class=&quot;oomph-table&quot;&gt;</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="comment">&lt;TR&gt;</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="comment">&lt;TD class=&quot;panel panel-default&quot;&gt;</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="comment">&lt;CENTER class=&quot;panel-heading&quot;&gt;</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="comment">&lt;B&gt; Problem P &lt;/B&gt;</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="comment">&lt;/CENTER&gt;</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="comment">&lt;CENTER class=&quot;panel-body&quot;&gt;</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="comment">\f[ {\cal R}\left(x_i; u(x_i), \frac{\partial u}{\partial x_i},  </span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="comment">\frac{\partial^2 u}{\partial x_i \ \partial x_j}\right) = 0 \ </span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="comment">\mbox{ \ \ \ \ in \ \ \ } D,\f]</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="comment">with Dirichlet (essential) boundary conditions on </span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="comment">\f$ \partial D \f$</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="comment">\f[ \hfill u|_{\partial D} = g, \f]</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="comment">where the function \f$g\f$ is given</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="comment">&lt;/CENTER&gt;</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="comment">&lt;/TD&gt;</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="comment">&lt;/TR&gt;</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="comment">&lt;/TABLE&gt;</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="comment">&lt;/CENTER&gt;</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="comment">To keep the notation compact, we suppress the </span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="comment">explicit dependence of \f$ {\cal R} \f$</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="comment">on the derivatives and write the residual as  </span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="comment">\f$ {\cal R}(x_i; u(x_i))\f$. For example,</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="comment">the residual forms of the two Poisson problems are given by:</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="comment">&lt;CENTER&gt;</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="comment">&lt;TABLE class=&quot;oomph-table&quot;&gt;</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="comment">&lt;TR&gt;</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="comment">&lt;TD class=&quot;panel panel-default&quot;&gt;</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="comment">&lt;CENTER class=&quot;panel-heading&quot;&gt;</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="comment">&lt;B&gt; Problem P1&lt;/B&gt;</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="comment">&lt;/CENTER&gt;</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="comment">&lt;CENTER class=&quot;panel-body&quot;&gt;</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="comment">\f[ {\cal R}(x; u(x)) = \frac{\mbox{d}^2 u(x)}{\mbox{d} x^2} -</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="comment">f(x) =0 \mbox{\ \ \ \ for $x\in[0,1]$  \ \ \ </span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="comment">subject to \ \ \ }  u(x=0)= g_0 </span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="comment">\mbox{\ \ \ and \ \ \ }</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="comment">u(x=1)= g_1,</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="comment"> \f]</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="comment">where \f$ f(x)\f$ and the constants \f$g_0\f$ and \f$g_1\f$ are given.</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="comment">&lt;/CENTER&gt;</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="comment">&lt;/TD&gt;</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="comment">&lt;/TR&gt;</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="comment">&lt;/TABLE&gt;</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="comment">&lt;/CENTER&gt;</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="comment"> and</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="comment">&lt;CENTER&gt;</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="comment">&lt;TABLE class=&quot;oomph-table&quot;&gt;</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="comment">&lt;TR&gt;</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="comment">&lt;TD class=&quot;panel panel-default&quot;&gt;</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="comment">&lt;CENTER class=&quot;panel-heading&quot;&gt;</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="comment">&lt;B&gt; Problem P2&lt;/B&gt;</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="comment">&lt;/CENTER&gt;</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="comment">&lt;CENTER class=&quot;panel-body&quot;&gt;</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="comment">\f[ {\cal R}(x_i; u(x_i)) = \sum_{j=1}^2</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="comment">\frac{\partial^2 u(x_i)}{\partial x_j^2} -</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="comment">f(x_i) =0 \mbox{ \ \ \ \ for $x_i\in D$ \ \ \ </span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="comment">subject to \ \ \ }  u|_{\partial D} = g,</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="comment"> \f]</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="comment">where \f$ f(x_i)\f$ and \f$ g(x_i)\f$ are given, and \f$ i = 1,2\f$.</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="comment">&lt;/CENTER&gt;</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="comment">&lt;/TD&gt;</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="comment">&lt;/TR&gt;</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="comment">&lt;/TABLE&gt;</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="comment">&lt;/CENTER&gt;</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="comment">We stress that neither the finite element method, nor \c oomph-lib </span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="comment">are restricted</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="comment">to scalar second-order PDEs. Documentation for the example drivers discusses</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;<span class="comment">generalisations to:</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="comment">- non-Dirichlet boundary conditions</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="comment">- systems of PDEs</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="comment">- mixed interpolation</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="comment">- discontinuous interpolation</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="comment">- timestepping</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="comment">- higher-order PDEs</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="comment">- solid mechanics and Lagrangian coordinates.</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="comment">\section mathFE Mathematical background</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="comment">\subsection weaksoln The weak solution</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="comment">A classical (or strong) solution of the problem P is any function</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="comment">\f$ u(x_i) \f$ that satisfies the PDE and boundary condition</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="comment">at every point in \f$ D\f$,</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="comment">\f[ {\cal R}(x_i; u(x_i)) \equiv 0 \ \ \ \forall x_i \in D</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="comment">\mbox{\ \ \ \ and \ \ \ \ } </span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="comment">u|_{\partial D} = g. \f]</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="comment">The concept of a &quot;weak&quot; solution is based on a slight relaxation of</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="comment">this criterion. A weak solution, \f$u_w(x_i), \f$ of problem P</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="comment">is any function that satisfies the essential boundary condition,</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="comment">\f[ u_w|_{\partial D} = g, \f]</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="comment">and for which the so-called &quot;weighted residual&quot;</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="comment">\f[ r = \int_{D}  {\cal R}(x_i; u_w(x_i)) \ \phi^{(test)}(x_i) </span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="comment">\ \mbox{d}x_1 \mbox{d}x_2 \ \ \ \ \ \ \ \ (1) \f]</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="comment">vanishes for \e any  &quot;test function&quot; </span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="comment">\f$ \phi^{(test)}(x_i) \f$ which  satisfies homogeneous</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="comment">boundary conditions so that</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="comment">\f[ \phi^{(test)}|_{\partial D} = 0. \f]</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="comment">At this point it might appear that we have fatally weakened</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="comment">the concept of a solution. If we only require the PDE to be satisfied</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="comment">in an average sense, couldn&#39;t any function  </span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="comment">be a &quot;solution&quot;? In fact, this is not the case and we shall now</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="comment">demonstrate that, for all practical</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;<span class="comment">purposes [we refer to the standard literature for a </span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="comment">rigorous derivation], the statement </span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="comment">\f[ \mbox{ &quot;weak solutions are strong solutions&quot; } \f]</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="comment">is true. The crucial observation is that the weak solution </span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="comment">requires the weighted residual to vanish</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="comment">for \e any test function. To show that this is equivalent to</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="comment">demanding that \f$ {\cal R} \equiv 0 \ \ \forall x_i \in D  \f$</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="comment">(as in the definition of the strong solution), let us try to construct</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="comment">a counter-example for which \f$ {\cal R} \not\equiv 0 \f$ in </span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="comment">some part of the</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<span class="comment">domain (implying that the candidate solution is not a classical</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;<span class="comment">solution) while \f$r=0\f$ (so that it qualifies as a weak solution). </span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="comment">For simplicity we illustrate the </span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="comment">impossibility of this in a </span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;<span class="comment">1D example. First consider a candidate solution \f$ u_c(x)\f$ </span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;<span class="comment">which satisfies the essential boundary condition</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="comment">but does not satisfy the PDE anywhere, and that</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="comment">\f$ {\cal R}(x; u_c(x)) &gt; 0 \f$  throughout the domain, as</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="comment">indicated in this sketch:</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="comment">\image html weaksoln1.gif &quot;Residual (blue/solid) is nonzero (and positive) throughout the domain. A constant test function (red/dotted) is sufficient to show that the candidate solution is not a weak solution. &quot; </span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;<span class="comment">\image latex weaksoln1.eps &quot;Residual (blue/solid) is nonzero (and positive) throughout the domain. A constant test function (red/dotted) is sufficient to show that the candidate solution is not a weak solution. &quot; width=0.75\textwidth</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="comment">Could this</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="comment">candidate solution possibly qualify as a weak solution? No, using the</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;<span class="comment">trivial test function </span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="comment">\f$ \phi^{(test)} \equiv 1 \f$ gives a nonzero </span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="comment">weighted residual, and it follows </span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="comment">that  \f$ {\cal R}(x, u_c(x)) \f$ must have </span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="comment">zero average if \f$ u_c(x) \f$ is to qualify as a weak solution.</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="comment">   </span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;<span class="comment">The figure below shows the residual for a more sophisticated</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;<span class="comment">candidate solution which</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;<span class="comment">satisfies the PDE over most of the domain.</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;<span class="comment">\image html weaksoln2.gif &quot;Residual (blue/solid) is nonzero only in two small sub-domains. A suitably constructed test function with finite support (red/dotted) is sufficient to show that the candidate solution is not a weak solution. &quot; </span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;<span class="comment">\image latex weaksoln2.eps &quot;Residual (blue/solid) is nonzero only in two small sub-domains. A suitably constructed test function with finite support (red/dotted) is sufficient to show that the candidate solution is not a weak solution. &quot; width=0.75\textwidth</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;<span class="comment">The residual</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;<span class="comment">is nonzero only in two small subdomains, \f$ D_1\f$  and </span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;<span class="comment">\f$ D_2 \f$. The candidate</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;<span class="comment">solution is such that the residual has different signs in \f$ D_1\f$  and </span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;<span class="comment">\f$ D_2 \f$ so that its average over the domain is zero. Could this</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;<span class="comment">solution qualify as</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;<span class="comment">a weak solution? Again the answer is no because</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;<span class="comment">we can choose a test function  that is nonzero in only one </span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="comment">of the two subdomains (e.g. the function shown by the red/dotted</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="comment">line), which gives a nonzero weighted residual.</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="comment">It is clear that such a procedure may be used  to obtain a nonzero</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="comment">weighted residual whenever the residual \f$ {\cal R} \f$ is </span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="comment">nonzero \e anywhere</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="comment">in the domain. In other words, a weak solution is a strong</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="comment">solution, as claimed. [To make this argument </span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="comment">mathematically rigorous, </span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="comment">we would have to re-assess the argument for (pathological) </span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="comment">cases in which the residual is nonzero only at finite number of </span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;<span class="comment">points, etc.]. </span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;<span class="comment">\subsection int_by_parts_1 A useful trick: Integration by parts</span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;<span class="comment">Consider now the weak form of the 2D Poisson </span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;<span class="comment">problem P2,</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;<span class="comment">\f[ \int_D  \left( \sum_{j=1}^2 \frac{\partial^2 u(x_i)}{\partial x_j^2} -</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;<span class="comment">f(x_i) \right) \phi^{(test)}(x_i) \  \mbox{d}x_1 \mbox{d}x_2 =0</span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;<span class="comment">\mbox{\ \ \ \ subject to\ \ \ \ }  u|_{\partial D}=g. </span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<span class="comment">\ \ \ \ \ \ \ \  (2) \f]</span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;<span class="comment">After integration by parts and use of the divergence theorem, we obtain</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;<span class="comment">\f[ \int_D \sum_{j=1}^2 \frac{\partial u(x_i)}{\partial x_j} \ </span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;<span class="comment"> \frac{\partial \phi^{(test)}(x_i)}{\partial x_j} \  \mbox{d}x_1 \mbox{d}x_2 +</span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;<span class="comment"> \int_D f(x_i) \  \phi^{(test)}(x_i) \  \mbox{d}x_1 \mbox{d}x_2 =</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;<span class="comment"> \oint_{\partial D}  \frac{\partial u}{\partial n} </span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;<span class="comment"> \ \phi^{(test)} \ \mbox{d}s, \ \ \ \ \ (3) \f]</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;<span class="comment">where \f$s\f$ is the arclength along the domain boundary \f$ \partial D\f$</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;<span class="comment">and \f$ \partial/\partial n\f$ the outward normal derivative.</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;<span class="comment">Since the test functions satisfy homogeneous boundary</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;<span class="comment">conditions, \f$ \left. \phi^{(test)} \right|_{\partial D} = 0, \f$</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;<span class="comment">the line integral on the RHS of equation (3) vanishes.</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<span class="comment">Therefore, an alternative version of the weak form of problem P2</span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<span class="comment">is given by</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;<span class="comment">\f[ \int_D \sum_{j=1}^2 \frac{\partial u(x_i)}{\partial x_j} \ </span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;<span class="comment"> \frac{\partial \phi^{(test)}(x_i)}{\partial x_j} \  \mbox{d}x_1 \mbox{d}x_2 +</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="comment"> \int_D f(x_i) \  \phi^{(test)}(x_i) \  \mbox{d}x_1 \mbox{d}x_2 = 0.</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="comment"> \ \ \ \ \ \ (4) \f]</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;<span class="comment"> We note that (4) involves first derivatives of the unknown function </span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="comment"> \f$ u \f$</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;<span class="comment"> and the test function \f$ \phi^{(test)} \f$, whereas (2) </span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="comment"> involves second derivatives</span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;<span class="comment"> of \f$ u \f$ and the zero-th derivatives of \f$ \phi^{(test)} \f$.</span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;<span class="comment"> The advantages of using the &quot;symmetric&quot;, integrated-by-parts </span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;<span class="comment"> version of the weak form  will become apparent in the subsequent </span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;<span class="comment"> sections. </span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;<span class="comment"> </span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;<span class="comment">\subsection function_spaces [Nearly an aside:] Function spaces</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;<span class="comment">We stated in the introduction that all functions are assumed </span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;<span class="comment">to be &lt;EM&gt; sufficiently  &quot;well-behaved&quot; so  that all </span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<span class="comment">mathematical manipulations &quot;make sense&quot;&lt;/EM&gt;. It is important</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="comment">to realise that we have already (tacitly) used this assumption</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="comment">in the derivation of the weak form.</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<span class="comment">The weak form does not &quot;make sense&quot; if we allow </span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="comment">candidate solutions and test functions for which the</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="comment">integral in (1) does not exist. This imposes</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;<span class="comment">restrictions on the types of functions that are</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;<span class="comment">&quot;admissible&quot; in our problem. The precise form of these restrictions </span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;<span class="comment">depends on the form of the residual \f${\cal R}(x_i,u(x_i))\f$, and,</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;<span class="comment">typically, the restrictions are related to the functions&#39; </span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;<span class="comment">differentiability. </span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;<span class="comment">It is convenient to employ the concept of a &quot;function space&quot;</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;<span class="comment">to collectively refer to all functions that satisfy </span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;<span class="comment">the required restrictions. [In this introduction, none of the </span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;<span class="comment">additional (heavy) machinery from functional analysis is required].</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;<span class="comment">For instance, we can ensure that the integrated-by-parts version </span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;<span class="comment">of problem P2 in equation (4) </span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;<span class="comment">&quot;makes sense&quot; if we restrict </span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;<span class="comment">\f$u(x_i)\f$ and \f$\phi^{(test)}(x_i)\f$ to all functions </span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;<span class="comment">whose zeroth and first derivatives are square integrable over </span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;<span class="comment">the domain \f$D\f$. These functions are members of a (well-known)</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="comment">function space that is usually denoted by \f$H^{1}(D)\f$. </span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;<span class="comment">In fact, \f$H^{1}(D)\f$ is a particular instance of a</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;<span class="comment">family of function spaces -- the Sobolev spaces \f$H^{i}(D)\f$</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;<span class="comment">where \f$i=0,1,2,...\f$ which </span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;<span class="comment">contain all functions whose zeroth, first, ...,</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;<span class="comment">i-th derivatives are square-integrable over the domain \f$D\f$. </span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;<span class="comment">The members of these function spaces have the property that</span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;<span class="comment">\f[ </span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;<span class="comment">u(x_i) \in H^0(D) \ \ \  \iff \ \ \ \int_D u^2(x_i) \ dx_1 dx_2 &lt; \infty,</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;<span class="comment">\f[ </span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;<span class="comment">u(x_i) \in H^1(D) \ \ \  \iff \ \ \ \int_D </span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;<span class="comment">       \left( u^2(x_i) + </span></div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;<span class="comment">        \sum_{j=1}^2 \left(\frac{\partial u(x_i)}{\partial x_j}\right)^2</span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;<span class="comment">        \right) dx_1 dx_2 &lt; \infty,</span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;<span class="comment">etc. We use the subscript &quot;0&quot; to restrict a given function space </span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;<span class="comment">to the subset of its members which vanish on the domain</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;<span class="comment"> boundary \f$ \partial D,\f$</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;<span class="comment">\f[ </span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;<span class="comment">u(x_i) \in H^i_0(D) \ \ \  \iff \ \ \ \ u(x_i) \in H^i(D)</span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;<span class="comment">\mbox{\ \ \ and \ \ \ } u|{\partial D}=0. </span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;<span class="comment">Using these function spaces, we can provide a concise definition of the</span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;<span class="comment">weak form of problem P2: </span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;<span class="comment">&lt;CENTER&gt;</span></div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="comment">&lt;TABLE class=&quot;oomph-table&quot;&gt;</span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;<span class="comment">&lt;TR&gt;</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;<span class="comment">&lt;TD class=&quot;panel panel-default&quot;&gt;</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;<span class="comment">&lt;CENTER class=&quot;panel-heading&quot;&gt;</span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;<span class="comment">&lt;B&gt; Problem P2&lt;SUB&gt;weak&lt;/SUB&gt; &lt;/B&gt;</span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;<span class="comment">&lt;/CENTER&gt;</span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;<span class="comment">&lt;CENTER class=&quot;panel-body&quot;&gt;</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;<span class="comment">Find the function   \f$ u(x_i) \in H^1(D) \f$ that satisfies the</span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;<span class="comment">essential boundary conditions</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;<span class="comment">\f[ \hfill u|_{\partial D} = g, \f]</span></div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;<span class="comment">and for which</span></div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;<span class="comment">\f[ \int_D \sum_{j=1}^2 \frac{\partial u(x_i)}{\partial x_j} \ </span></div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;<span class="comment">\frac{\partial \phi^{(test)}(x_i)}{\partial x_j} \  \mbox{d}x_1 \mbox{d}x_2 +</span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;<span class="comment">\int_D f(x_i) \  \phi^{(test)}(x_i) \  \mbox{d}x_1 \mbox{d}x_2 = 0</span></div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;<span class="comment">for \e all test functions  \f$ \phi^{(test)}(x_i) \in H^1_0(D). \f$</span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;<span class="comment">&lt;/CENTER&gt;</span></div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;<span class="comment">&lt;/TD&gt;</span></div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;<span class="comment">&lt;/TR&gt;</span></div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;<span class="comment">&lt;/TABLE&gt;</span></div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;<span class="comment">&lt;/CENTER&gt;</span></div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;<span class="comment">It is important to realise that the choice of suitable function spaces for</span></div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;<span class="comment">\f$u(x_i)\f$ and \f$\phi^{(test)}(x_i)\f$ is problem-dependent,  </span></div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;<span class="comment">guided by the inspection of the weak form</span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;<span class="comment">for a specific problem. The (pragmatic) procedure is straightforward: </span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;<span class="comment">write down the weak form and </span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;<span class="comment">determine the (minimal) constraints that must be </span></div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;<span class="comment">imposed on  \f$u(x_i)\f$ and \f$\phi(x_i)\f$ for the weak form</span></div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;<span class="comment">to &quot;make sense&quot;. All functions that satisfy these constraints,</span></div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;<span class="comment">are &quot;admissible&quot; and, collectively, they form a function space</span></div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;<span class="comment">\f$ H(D) \f$, say.</span></div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;<span class="comment">The weak form of the general problem P can then be written as  \n \n</span></div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;<span class="comment">&lt;CENTER&gt;</span></div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;<span class="comment">&lt;TABLE class=&quot;oomph-table&quot;&gt;</span></div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;<span class="comment">&lt;TR&gt;</span></div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;<span class="comment">&lt;TD class=&quot;panel panel-default&quot;&gt;</span></div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;<span class="comment">&lt;CENTER class=&quot;panel-heading&quot;&gt;&lt;B&gt; Problem P&lt;SUB&gt;weak&lt;/SUB&gt; &lt;/B&gt;&lt;/CENTER&gt;</span></div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;<span class="comment">&lt;CENTER class=&quot;panel-body&quot;&gt;</span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;<span class="comment">Find the function   \f$ u(x_i) \in H(D) \f$ that satisfies the</span></div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;<span class="comment">essential boundary conditions</span></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;<span class="comment">\f[ \hfill u|_{\partial D} = g, \f]</span></div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;<span class="comment">and for which</span></div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;<span class="comment">\f[ \int_D {\cal R}(x_i,u(x_i)) \  \phi^{(test)}(x_i) \  \mbox{d}x_1 \mbox{d}x_2 = 0</span></div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;<span class="comment">for \e all test functions  \f$ \phi^{(test)}(x_i) \in H_0(D). \f$</span></div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;<span class="comment">&lt;/CENTER&gt;</span></div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;<span class="comment">&lt;/TD&gt;</span></div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;<span class="comment">&lt;/TR&gt;</span></div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;<span class="comment">&lt;/TABLE&gt;</span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;<span class="comment">&lt;/CENTER&gt;</span></div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;<span class="comment">\n</span></div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;<span class="comment"> [If you followed the above argument carefully you will have</span></div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;<span class="comment"> realised that our strategy for ensuring that the weak form</span></div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;<span class="comment"> &quot;makes sense&quot; uses a sufficient rather than a necessary condition.</span></div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;<span class="comment"> For instance, it is not necessary for \f$ u(x_i)\f$ and </span></div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;<span class="comment"> \f$ \phi^{(test)}(x_i)\f$ to be members of the same function space.</span></div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;<span class="comment"> Alternative formulations are possible but we shall not pursue such ideas any </span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;<span class="comment"> further in this introduction.]</span></div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;<span class="comment"> </span></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;<span class="comment">\subsection galerkin The Galerkin method</span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;<span class="comment">We now exploit the definition of the weak solution to</span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;<span class="comment">develop a numerical method that can be used to determine</span></div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;<span class="comment">approximate solutions to problem P&lt;SUB&gt;weak&lt;/SUB&gt;. We start by </span></div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;<span class="comment">splitting the solution into two parts, </span></div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;<span class="comment">\f[ u(x_i) = u_{h}(x_i) + u_{p}(x_i),  \f]</span></div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;<span class="comment">where \f$ u_{p}(x_i)\f$ is an (arbitrary) function that satisfies</span></div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;<span class="comment">the Dirichlet boundary conditions,</span></div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;<span class="comment">\f[ u_{p}|_{\partial D} = g. \f]</span></div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;<span class="comment">The unknown function \f$ u_{h}(x_i) \f$ then has to satisfy the</span></div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;<span class="comment">homogeneous boundary conditions</span></div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;<span class="comment">\f[ u_{h}|_{\partial D} = 0.\f]</span></div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;<span class="comment">We expand \f$ u_{h}(x_i) \f$ in terms of a</span></div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;<span class="comment">(given) infinite set of basis functions \f$ \psi_j(x_i) \in H_0(D) \ \ \ </span></div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;<span class="comment">(j=1,...,\infty) \f$, </span></div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;<span class="comment">\f[ u(x_i) = u_{p}(x_i) + \sum_{j=1}^{\infty} U_j \psi_j(x_i),</span></div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;<span class="comment">\ \ \ \ \ \  (5) \f]</span></div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;<span class="comment">which discretises the problem because the solution is now</span></div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;<span class="comment">determined by the (as yet unknown) discrete coefficients </span></div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;<span class="comment"> \f$ U_j \ \ \ (j=1,...,\infty). \f$</span></div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;<span class="comment">There are many possible sets </span></div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;<span class="comment">of basis functions: polynomials, trigonometric functions,</span></div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;<span class="comment">systems of eigenfunctions; mathematically speaking, the only requirement</span></div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;<span class="comment">is that the basis functions are sufficiently general that</span></div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;<span class="comment">the solution can be represented by the expansion  (5). </span></div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;<span class="comment">In other words,</span></div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;<span class="comment">the functions must be  a complete basis for \f$H_0(D)\f$.</span></div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;<span class="comment">How do we determine the discrete coefficients   \f$ U_j \f$?</span></div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;<span class="comment">Inserting the expansion for \f$u(x)\f$ into the definition</span></div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;<span class="comment">of the weighted residual yields</span></div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;<span class="comment">\f[ r = \int_{D}  {\cal R}\left(x_i; \  </span></div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;<span class="comment"> u_{p}(x_i)+\sum_{j=1}^{\infty} U_j </span></div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;<span class="comment">\psi_j(x_i)\right) \ \phi^{(test)}(x_i) </span></div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;<span class="comment">\ \mbox{d}x_1 \mbox{d}x_2 = 0,  \ \ \ \ \ \ (6) \f]</span></div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;<span class="comment">and we recall that this equation must be satisfied for \e any test</span></div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;<span class="comment">function \f$ \phi^{(test)} \in H_0(D) \f$. The</span></div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;<span class="comment">functions \f$\psi_j(x_i)\f$ form a complete basis for \f$ H_0(D)\f$,</span></div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;<span class="comment">and so all possible test functions \f$ \phi^{(test)}(x_i) \f$ may be</span></div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;<span class="comment">represented as</span></div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;<span class="comment">\f[  \phi^{(test)}(x_i) = \sum_{k=1}^{\infty} \Phi_k </span></div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;<span class="comment">\psi_k(x_i). \ \ \ \ \ \ \ (7) \f]</span></div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;<span class="comment">Thus, the </span></div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;<span class="comment">condition</span></div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;<span class="comment">\f[ \mbox{...for any basis function $ \phi^{(test)}(x_i) $...} \f]</span></div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;<span class="comment">becomes</span></div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;<span class="comment">\f[ \mbox{...for any values of the coefficients $ \Phi_k$...} \f]</span></div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;<span class="comment">Inserting the expansion  (7)  into </span></div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;<span class="comment">the definition of the weak solution (6) yields</span></div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;<span class="comment">\f[ r =   \sum_{k=1}^{\infty} \Phi_k \  r_k(U_1, U_2,...) = 0, </span></div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;<span class="comment">\ \ \ \ \  (8) \f] </span></div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;<span class="comment">where </span></div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;<span class="comment">\f[ r_k(U_1, U_2,...) = </span></div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;<span class="comment">\int_{D}  {\cal R}\left(x_i;  \  u_{p}(x_i)+\sum_{j=1}^{\infty} U_j </span></div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;<span class="comment">\psi_j(x_i)\right) \ \psi_k(x_i) </span></div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;<span class="comment">\ \mbox{d}x_1 \mbox{d}x_2.  \ \ \ \ \ \ \  (9) \f]</span></div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;<span class="comment">Equation (8) must hold for \e any value of the coefficients</span></div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;<span class="comment">\f$ \Phi_k \f$, so the coefficients \f$ U_j \f$ must satisfy</span></div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;<span class="comment">the equations</span></div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;<span class="comment">\f[  r_k(U_1, U_2,...) = 0, \mbox{ \ \ \ \ for } k=1,2,... \f]</span></div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;<span class="comment">In practice, we truncate the expansions  (5) and (7) </span></div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;<span class="comment">after a finite number of terms to obtain the approximations</span></div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;<span class="comment">(indicated by tildes)</span></div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;<span class="comment">\f[ \widetilde{u}(x_i) =  u_p(x_i) + \sum_{j=1}^{M} U_j \psi_j(x_i)</span></div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;<span class="comment">   \mbox{ \ \ and \ \ } \widetilde{\phi^{(test)}}(x_i) = </span></div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;<span class="comment">   \sum_{k=1}^{M} \Phi_k </span></div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;<span class="comment">   \psi_k(x_i), \ \ \ \ \ \ (10) \f]</span></div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;<span class="comment">and we determine the \f$M\f$ unknown coefficients, \f$U_1,...,U_M\f$,</span></div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;<span class="comment">from the  \f$M\f$ algebraic equations</span></div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;<span class="comment">\f[ r_k(U_1,...,U_M)=0, \mbox{\ \ where \ \ $k=1,...,M$}. </span></div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;<span class="comment">\ \ \ \ \ \ \ \   (11)  \f]</span></div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;<span class="comment"> The number of terms in each truncated expansion must be the same, so</span></div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;<span class="comment"> that we obtain \f$M\f$ equations for \f$M\f$ unknowns.</span></div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;<span class="comment">The truncation of the expansions (5)  and (7) </span></div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;<span class="comment">introduces two approximations:</span></div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;<span class="comment">- The approximate solution \f$ \widetilde{u}(x_i) \f$ </span></div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;<span class="comment">  is a member of the finite-dimensional function</span></div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;<span class="comment">  space \f$\widetilde{H}(D) \subset H(D)\f$ spanned by the</span></div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;<span class="comment">  basis functions included in the expansion  (10).</span></div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;<span class="comment">- We &quot;test&quot; the solution with functions from </span></div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;<span class="comment">  \f$ \widetilde{H_{0}}(D) \f$ rather than with &quot;all&quot; functions </span></div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;<span class="comment">  \f$ \phi^{(test)} \in H_0(D). \f$</span></div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;<span class="comment">.</span></div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;<span class="comment">\f$\widetilde{H}(D) \to H(D)\f$ as \f$M \to \infty\f$, however, so</span></div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;<span class="comment">the approximate solution \f$\widetilde{u}(x_i)\f$ </span></div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;<span class="comment">converges to the exact solution \f$u(x_i)\f$ as we include more and more</span></div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;<span class="comment">terms in the expansion. [The precise definition of &quot;convergence&quot;</span></div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;<span class="comment">requires the introduction of a norm, which allows us to measure </span></div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;<span class="comment">the &quot;difference&quot; between two functions. We refer to the</span></div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;<span class="comment">standard literature for a more detailed discussion of this issue.]</span></div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;<span class="comment">In general, the equations \f$r_k(U_1,...,U_M)\f$ are nonlinear </span></div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;<span class="comment">and must be solved by an iterative method such as Newton&#39;s</span></div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;<span class="comment">method. Consult your favourite numerical analysis textbook</span></div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;<span class="comment">(if you can&#39;t think of one, have a look through chapter 9 in Press, W. H.; </span></div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;<span class="comment">Flannery, B. P.; </span></div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;<span class="comment">Teukolsky, S. A.; and Vetterling, W. T. &quot;Numerical Recipes in C++.</span></div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;<span class="comment">The Art of Scientific Computing&quot;, Cambridge University Press) for</span></div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;<span class="comment">a reminder of how (and why) Newton&#39;s method works. The following</span></div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;<span class="comment">algorithm shows the method applied to our equations:</span></div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;<span class="comment">\anchor Newton</span></div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;<span class="comment"> &lt;CENTER&gt; &lt;B&gt; Algorithm 1: Newton&#39;s method &lt;/B&gt; &lt;/CENTER&gt;</span></div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;<span class="comment">-# Set the iteration counter \f$i=0\f$ and provide an initial</span></div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;<span class="comment">approximation for the unknowns, \f$ U^{(0)}_j\ \ (j=1,..,M)\f$.</span></div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;<span class="comment">-# Evaluate the residuals </span></div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;<span class="comment">   \f[  r_k^{(i)} = r_k\left( U^{(i)}_1,..., U^{(i)}_M\right)</span></div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;<span class="comment">   \mbox{\ \ \ for $k=1,...,M$}. \f]</span></div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;<span class="comment">-# Compute a suitable norm of the residual vector (e.g. the maximum norm).</span></div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;<span class="comment">   If the norm is less than some pre-assigned tolerance, stop and</span></div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;<span class="comment">   and accept \f$U_j^{(i)} (j=1,...,M) \f$ as the solution.</span></div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;<span class="comment">-# Compute the Jacobian matrix</span></div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;<span class="comment">  \f[  J_{kj} = \left. \frac{\partial r_k}{\partial U_j} </span></div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;<span class="comment">  \right|_{\left( U^{(i)}_1,..., U^{(i)}_M\right)}</span></div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;<span class="comment">  \mbox{\ \ \ for $j,k=1,...,M$}.\f]</span></div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;<span class="comment">-# Solve the linear system</span></div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;<span class="comment">   \f[  \sum_{j=1}^{M} J_{kj} \  \delta U_j =  - r_k^{(i)}</span></div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;<span class="comment">   \mbox{\ \ \ \ \ \ where  $k=1,...,M$} \f]</span></div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;<span class="comment">   for \f$ \delta U_{j} \ \ ($j=1,...,M$).\f$</span></div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;<span class="comment">-# Compute an improved approximation via</span></div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;<span class="comment">   \f[  U_j^{(i+1)} = U_j^{(i)} +  \delta U_j  </span></div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;<span class="comment">   \mbox{\ \ \ for $j=1,...,M$}. \f]</span></div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;<span class="comment">-# Set \f$ i=i+1\f$ and go to 2. </span></div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;<span class="comment">.</span></div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;<span class="comment">For a &quot;good&quot; initial approximation, </span></div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;<span class="comment">\f$ U^{(0)}_j\f$, </span></div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;<span class="comment">Newton&#39;s method converges quadratically towards the exact solution. </span></div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;<span class="comment">Furthermore, for linear</span></div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;<span class="comment">problems, Newton&#39;s method provides the exact solution (modulo any</span></div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;<span class="comment">roundoff errors that might be introduced during the solution of the </span></div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;<span class="comment">linear system) in a single iteration. Newton&#39;s method can, therefore,</span></div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;<span class="comment">be used as a robust, general-purpose solver, if (!)</span></div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;<span class="comment">a good initial guess for the solution can be provided. </span></div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;<span class="comment">In practice, this is not a serious restriction,</span></div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;<span class="comment">because good initial guesses can often be generated by</span></div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;<span class="comment">continuation methods. In \c oomph-lib, Newton&#39;s method is</span></div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;<span class="comment">the default nonlinear solver. </span></div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;<span class="comment">Let us, briefly, examine the cost of the non-trivial steps involved</span></div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;<span class="comment">in Newton&#39;s method: </span></div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;<span class="comment">- Step 2 requires the evaluation of \f$M\f$ integrals </span></div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;<span class="comment">  over the domain to determine</span></div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;<span class="comment">  the discrete residuals \f$  r_k^{(i)} \f$ from  (9).</span></div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;<span class="comment">  (We note that, in general,  the integrals must be evaluated numerically.)</span></div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;<span class="comment">- Step 3 requires the computation of \f$M^2\f$ entries</span></div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;<span class="comment">  in the Jacobian matrix, each an integral of the form </span></div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;<span class="comment">  \f[ J_{kj} =   \int_{D} \frac{\partial }{\partial U_j}</span></div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;<span class="comment">  {\cal R}\left(x_i;  \ \sum_{j=1}^{M} U_j </span></div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;<span class="comment">  \psi_j(x_i)\right) \ \psi_k(x_i) </span></div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;<span class="comment">  \ \mbox{d}x_1 \mbox{d}x_2 \mbox{\ \ \ for $j,k=1,...,M$.} \f]</span></div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;<span class="comment">- Step 4 requires the solution of a \f$M \times M\f$</span></div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;<span class="comment">  linear system.</span></div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;<span class="comment">.</span></div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;<span class="comment"> </span></div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;<span class="comment">In general, steps 3 and 4 will be very costly if \f$M\f$ is </span></div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;<span class="comment">large. However, if the domain has a simple shape and the differential </span></div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;<span class="comment">operator has a sufficiently simple structure, it is often possible</span></div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;<span class="comment">to choose basis functions with suitable orthogonality properties</span></div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;<span class="comment">that render the Jacobian matrix  \f$J_{kj}\f$ sparse.</span></div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;<span class="comment">As an example, we consider the application of Galerkin&#39;s method</span></div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;<span class="comment">in the 1D Poisson problem P1:</span></div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;<span class="comment">&lt;CENTER&gt; &lt;B&gt; Example: Galerkin method applied to the model problem P1  </span></div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;<span class="comment">&lt;/B&gt;&lt;/CENTER&gt;</span></div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;<span class="comment">We perform the usual integration by parts to </span></div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;<span class="comment">derive the symmetric weak form of the problem: \n \n</span></div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;<span class="comment">&lt;CENTER&gt;</span></div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;<span class="comment">&lt;TABLE class=&quot;oomph-table&quot;&gt;</span></div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;<span class="comment">&lt;TR&gt;</span></div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;<span class="comment">&lt;TD class=&quot;panel panel-default&quot;&gt;</span></div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;<span class="comment">&lt;CENTER class=&quot;panel-heading&quot;&gt;</span></div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;<span class="comment">&lt;B&gt; Problem P1&lt;SUB&gt;weak&lt;/SUB&gt; &lt;/B&gt;&lt;/CENTER&gt;</span></div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;<span class="comment">&lt;CENTER class=&quot;panel-body&quot;&gt;</span></div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;<span class="comment">Find the function   \f$ u(x) \in H(D) \f$ that satisfies the</span></div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;<span class="comment">essential boundary conditions</span></div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;<span class="comment">\f[ u(0) = g_0 \ \ \ \mbox{and} \ \ \   u(1) = g_1, \f]</span></div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;<span class="comment">and for which</span></div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;<span class="comment">\f[ \int_0^1 \left( \frac{\mbox{d} u(x)}{\mbox{d} x} \ </span></div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;<span class="comment">\frac{\mbox{d} \phi^{(test)}(x)}{\mbox{d} x} \</span></div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;<span class="comment">+ f(x) \  \phi^{(test)}(x) \right)\  \mbox{d}x = 0</span></div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;<span class="comment">for \e all test functions  \f$ \phi^{(test)}(x) \in H_0(D). \f$</span></div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;<span class="comment">&lt;/CENTER&gt;</span></div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;<span class="comment">&lt;/TD&gt;</span></div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;<span class="comment">&lt;/TR&gt;</span></div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;<span class="comment">&lt;/TABLE&gt;</span></div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;<span class="comment">&lt;/CENTER&gt; \n\n</span></div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;<span class="comment">Inspection of the weak form shows that the choice \f$H(D) = H^1(D) \f$</span></div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;<span class="comment">is sufficient to ensure the existence of the integral. Of course,</span></div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;<span class="comment">the &quot;higher&quot; Sobolev spaces \f$ H^2(D), H^3(D), ... \f$ would also</span></div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;<span class="comment">ensure the existence of the integral but would impose unnecessary</span></div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;<span class="comment">additional restrictions on our functions. </span></div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;<span class="comment"> Next, we need to construct a function</span></div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;<span class="comment"> \f$u_p(x)\f$ that satisfies the Dirichlet boundary conditions.</span></div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;<span class="comment">In 1D this is trivial, and the simplest option is the</span></div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;<span class="comment">function \f$ u_p(x)=g_0+ (g_1-g_0) x\f$, which interpolates linearly</span></div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;<span class="comment">between the two boundary values. Since \f$ \mbox{d}u_p(x)/</span></div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;<span class="comment">\mbox{d} x = g_1-g_0\f$, the discrete residuals are given by</span></div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;<span class="comment">\f[ r_k(U_1,U_2,...,U_M) = </span></div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;<span class="comment"> \int_0^1 \left[ \left( (g_1 - g_0) + \sum_{j=1}^{M} U_j</span></div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;<span class="comment"> \frac{\mbox{d} \psi_j(x)}{\mbox{d} x} \right)</span></div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;<span class="comment"> \frac{\mbox{d} \psi_k(x)}{\mbox{d} x} + f(x) \  \psi_k(x) \right] \ \mbox{d}x</span></div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;<span class="comment">  \mbox{\ \ for $k=1,..,M$}, \ \ \ \ \ \ \ \ (12) \f]</span></div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;<span class="comment">and the Jacobian matrix has the form</span></div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;<span class="comment">\f[ J_{kj} = </span></div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;<span class="comment"> \int_0^1 </span></div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;<span class="comment">  \frac{\mbox{d} \psi_j(x)}{\mbox{d} x}</span></div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;<span class="comment">  \frac{\mbox{d} \psi_k(x)}{\mbox{d} x}  \ \mbox{d}x</span></div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;<span class="comment">  \mbox{\ \ for $j,k=1,..,M$}. \ \ \ \ \ \ \ \ (13) \f]</span></div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;<span class="comment">The (Fourier) basis functions</span></div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;<span class="comment">\f[ \psi_j(x) = \sin\left(\pi j x \right)\f]</span></div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;<span class="comment">are a suitable basis because </span></div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;<span class="comment">- they satisfy the homogeneous boundary conditions,</span></div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;<span class="comment">- they and their derivatives are square</span></div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;<span class="comment">  integrable, allowing all integrals to be evaluated, and</span></div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;<span class="comment">- they are a complete basis for \f$ H^1_0(D)\f$.</span></div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;<span class="comment">.</span></div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;<span class="comment">Furthermore, the orthogonality relation</span></div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;<span class="comment">\f[ \int_0^1  \cos\left(\pi k x\right) </span></div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;<span class="comment">              \cos\left(\pi j x\right) dx </span></div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;<span class="comment">    = 0 \mbox{\ \ \ for \ } j\ne k \f]</span></div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;<span class="comment"> implies that the Jacobian matrix is a diagonal matrix, which is</span></div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;<span class="comment">cheap to assemble and invert. Indeed, the assembly of the Jacobian</span></div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;<span class="comment">matrix in step 4, and the solution of the linear system in step 5</span></div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;<span class="comment">have an &quot;optimal&quot;</span></div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;<span class="comment">computational complexity: their cost increases linearly with the</span></div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;<span class="comment">number of unknowns in the problem. </span></div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;<span class="comment">Unfortunately, the application of the method becomes difficult, if not</span></div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;<span class="comment">impossible, in cases where the differential operators</span></div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;<span class="comment">have a more complicated structure, and/or </span></div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;<span class="comment">the domain has a more complicated shape.</span></div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;<span class="comment">The task of finding a complete set of basis functions that vanish on</span></div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;<span class="comment">the domain boundary in an arbitrarily-shaped,</span></div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;<span class="comment">higher-dimensional domain is nontrivial. </span></div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;<span class="comment">Furthermore, for a complicated differential operator, it</span></div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;<span class="comment">will be extremely difficult to find a system of </span></div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;<span class="comment">basis functions for which the Jacobian matrix has a </span></div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;<span class="comment">sparse structure. If the matrix is dense, the assembly</span></div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;<span class="comment">and solution of the linear system in steps 4 and 5 of Newton&#39;s method</span></div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;<span class="comment">can become prohibitively expensive.</span></div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;<span class="comment">&lt;CENTER&gt;</span></div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;<span class="comment">&lt;TABLE class=&quot;oomph-table&quot;&gt;</span></div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;<span class="comment">&lt;TR&gt;</span></div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;<span class="comment">&lt;TD class=&quot;panel panel-default&quot;&gt;</span></div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;<span class="comment">&lt;CENTER class=&quot;panel-heading&quot;&gt;</span></div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;<span class="comment">&lt;B&gt; An aside: Integration by parts revisited &lt;/B&gt;&lt;/CENTER&gt;&lt;div class=&quot;panel-body&quot;&gt;</span></div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;<span class="comment">Let us briefly return to the two versions of the weak form and</span></div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;<span class="comment">examine the equations that we would have obtained had</span></div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;<span class="comment">we applied Galerkin&#39;s method to the original form of</span></div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;<span class="comment">the weak equations,</span></div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;<span class="comment">\f[ \int_0^1 \left( \frac{\mbox{d}^2 u(x)}{\mbox{d}x^2} \ </span></div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;<span class="comment">  -</span></div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;<span class="comment">f(x) \right)  \phi^{(test)}(x) \  \mbox{d}x = 0.</span></div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;<span class="comment">The discrete residuals are then given by </span></div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;<span class="comment">\f[ r_k = \int_0^1 \left( \sum_{j=1}^{M} U_{j}  \frac{\mbox{d}^2 </span></div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;<span class="comment"> \psi_j(x)}{\mbox{d} x^2} -</span></div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;<span class="comment"> f(x) \right)  \psi_k(x) \  \mbox{d}x = 0, \mbox{\ \ \ \ \ </span></div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;<span class="comment">\ for $k=1,...,M.$\ \ \ \ \ \ }  (14) \f]</span></div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;<span class="comment">and the Jacobian matrix has the form</span></div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;<span class="comment">\f[ J_{kj} =  \int_0^1\frac{\mbox{d}^2 </span></div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;<span class="comment">\psi_j(x)}{\mbox{d} x^2} \ </span></div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;<span class="comment">\psi_k(x)\  \mbox{d}x. \ \ \ \ \ \ \ (15) \f]</span></div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;<span class="comment">- The restrictions that must be imposed on the basis functions,</span></div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;<span class="comment">  \f$ \psi_j(x) \f$, if (14) is to </span></div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;<span class="comment">  &quot;make sense&quot; are much more </span></div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;<span class="comment">  awkward than  for</span></div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;<span class="comment">  the symmetric form for the problem; the product of their</span></div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;<span class="comment">  zeroth and second derivatives must be integrable over the domain.</span></div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;<span class="comment">- The Jacobian matrix (13) that arises from the symmetric </span></div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;<span class="comment">  form of the</span></div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;<span class="comment">  weak problem is symmetric for \e any choice of basis functions</span></div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;<span class="comment">  whereas the Jacobian matrix (15) that </span></div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;<span class="comment">  arises from the original form</span></div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;<span class="comment">  is symmetric only for certain types of basis functions.</span></div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;<span class="comment">  This is not only advantageous for the solution of the linear</span></div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;<span class="comment">  system (only a fraction of the entries in the matrix need to be computed,</span></div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;<span class="comment">  and (more efficient) linear solvers that exploit the symmetry </span></div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;<span class="comment">  of the matrix can be used), but also properly reflects </span></div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;<span class="comment">  the symmetry in the (self-adjoint!) ODE. </span></div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;<span class="comment">.</span></div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;<span class="comment">&lt;/div&gt;</span></div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;<span class="comment">&lt;/TD&gt;</span></div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;<span class="comment">&lt;/TR&gt;</span></div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;<span class="comment">&lt;/TABLE&gt;</span></div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;<span class="comment">&lt;/CENTER&gt;</span></div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;<span class="comment">\section fe The Finite Element Method</span></div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;<span class="comment">Galerkin&#39;s method is an efficient</span></div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;<span class="comment">method for finding the approximate solution to a given problem if </span></div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;<span class="comment">(and only if) we can:</span></div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;<span class="comment">-# Construct a  function \f$ u_p(x_i) \in H(D)\f$ </span></div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;<span class="comment">   that satisfies the essential boundary conditions.</span></div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;<span class="comment">-# Specify a set of basis functions that</span></div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;<span class="comment">   -# spans the function space \f$ H_0(D)\f$, </span></div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;<span class="comment">   -# vanishes on the domain boundary, and</span></div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;<span class="comment">   -# leads to a sparse Jacobian matrix.</span></div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;<span class="comment">   .</span></div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;<span class="comment">.  </span></div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;<span class="comment">We shall now develop the finite element method: an</span></div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;<span class="comment">implementation of Galerkin&#39;s method that automatically</span></div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;<span class="comment">satisfies all the above requirements.</span></div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;<span class="comment">\subsection fe_basis_fct Finite Element shape functions</span></div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;<span class="comment">The key feature of the finite element method is that the basis</span></div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;<span class="comment">functions have finite support, being zero over most of the domain, and</span></div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;<span class="comment">have the same functional form. We </span></div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;<span class="comment">illustrate the idea and its implementation for the 1D Poisson</span></div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;<span class="comment">problem P1 in its symmetric (integrated-by-parts) form: </span></div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;<span class="comment">\f[ r_k = \int_0^1 \left\{ \left( \frac{\mbox{d} </span></div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;<span class="comment"> u_p(x)}{\mbox{d} x}  +\sum_{j=1}^{M} U_{j} \frac{\mbox{d} </span></div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;<span class="comment"> \psi_j(x)}{\mbox{d} x} \right)</span></div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;<span class="comment"> \frac{\mbox{d} \psi_k(x)}{\mbox{d} x} +</span></div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;<span class="comment"> f(x) \  \psi_k(x) \right\}  \mbox{d}x  =0, \mbox{\ \ \ \ \ </span></div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;<span class="comment">\ for $k=1,...,M.$}\ \ \ \ \ \ \  (16) \f]</span></div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;<span class="comment">The integral (16) </span></div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;<span class="comment">exists for all basis </span></div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;<span class="comment">functions \f$ \psi_j(x)\f$ whose first derivatives</span></div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;<span class="comment">are square integrable; a class of functions that includes</span></div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;<span class="comment">piecewise linear functions.  </span></div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;<span class="comment">We shall now construct a particular set of piecewise linear</span></div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;<span class="comment">basis functions --- the (global) linear finite-element shape</span></div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;<span class="comment">functions, often known as &quot;hat functions&quot;. </span></div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;<span class="comment">For this purpose, we introduce \f$N\f$ equally-spaced &quot;nodes&quot; into the</span></div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;<span class="comment">domain \f$ x \in [0,1]\f$; node \f$j\f$ is </span></div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;<span class="comment">located at \f$X_j = (j-1) h \f$, where \f$h=1/(N-1)\f$</span></div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;<span class="comment">is the distance between the nodes.</span></div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;<span class="comment">The (global) linear finite-element shape functions are defined by</span></div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;<span class="comment">\psi_j(x) =  \left\{ \begin{array}{ll}</span></div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;<span class="comment">          0 &amp; \mbox{\ \ \ for $x &lt; X_{j-1}$} \\</span></div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;<span class="comment">  \frac{x-X_{j-1}}{X_j-X_{j-1}} &amp; \mbox{\ \ \ for $ X_{j-1} &lt;x &lt; X_j$} \\</span></div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;<span class="comment">  \frac{X_{j+1}-x}{X_{j+1}-X_j} &amp; \mbox{\ \ \ for $ X_{j} &lt;x &lt; X_{j+1}$} \\</span></div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;<span class="comment">          0 &amp; \mbox{\ \ \ for $x &gt; X_{j+1}$} \\</span></div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;<span class="comment">                     \end{array}</span></div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;<span class="comment">              \right. \ \ \ \ \ \ \ \ (17)</span></div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;<span class="comment">and are illustrated below:</span></div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;<span class="comment">\image html 1Dmesh_with_linear_shape_fcts.gif &quot;The (global) linear finite-element shape functions in 1D. &quot; </span></div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;<span class="comment">\image latex 1Dmesh_with_linear_shape_fcts.eps &quot;The (global) linear finite-element shape functions in 1D. &quot; width=0.75\textwidth</span></div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;<span class="comment">The finite-element shape functions have finite support; </span></div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;<span class="comment">in particular, the function</span></div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;<span class="comment">\f$ \psi_j(x) \f$ is nonzero only in the vicinity of node j</span></div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;<span class="comment">and varies linearly between one </span></div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;<span class="comment">(at node j) and zero (at nodes \f$ j-1 \f$ and \f$ j+1 \f$). </span></div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;<span class="comment">Furthermore, the shape functions satisfy the &quot;interpolation condition&quot;</span></div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;<span class="comment">\f[  \psi_j(X_i) = \delta_{ij} = </span></div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;<span class="comment">     \left\{\begin{array}{c} 1, \mbox{ if } i=j,\\</span></div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;<span class="comment">     0, \mbox{ if } i\neq j, \end{array}\right. \f]</span></div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;<span class="comment">where \f$ \delta_{ij}\f$ is the Kronecker delta.  </span></div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;<span class="comment">The coefficients \f$V_j\f$</span></div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;<span class="comment">in an expansion of the form</span></div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;<span class="comment">\f[ \tilde{v}(x) = \sum_{j=1}^{N} V_j \ \psi_j(x)\f]</span></div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;<span class="comment">have a straightforward interpretation: \f$V_j\f$ </span></div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;<span class="comment">is the value of the function \f$ v(x) \f$ at node \f$ j \f$.</span></div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;<span class="comment">The global shape functions vary linearly between the nodes, and so</span></div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;<span class="comment">\f$ \tilde{v}(x) \f$ provides piecewise linear interpolation</span></div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;<span class="comment">between the `nodal values&#39; \f$V_j\f$.</span></div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;<span class="comment">\image html fe_is_interpolant.gif &quot;The superposition of the (global) linear finite-element shape functions provides a piecewise linear interpolation between the `nodal values&#39;. &quot; </span></div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;<span class="comment">\image latex fe_is_interpolant.eps &quot;The superposition of the (global) linear finite-element shape functions provides a piecewise linear interpolation between the `nodal values&#39;. &quot; width=0.75\textwidth</span></div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;<span class="comment">Why are these shape functions useful in the Galerkin </span></div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;<span class="comment">method? Consider the requirements listed at the beginning</span></div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;<span class="comment">of this section:</span></div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;<span class="comment">-# It is easy to construct a function \f$ u_p(x) \f$ </span></div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;<span class="comment">   that satisfies the essential boundary conditions by choosing</span></div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;<span class="comment">   \f[ u_p(x) = g_0 \psi_1(x) +  g_1 \psi_N(x), \f]</span></div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;<span class="comment">   where \f$ \psi_1(x) \f$ and \f$ \psi_N(x) \f$ are the global </span></div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;<span class="comment">   finite-element shape functions associated with the </span></div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;<span class="comment">   two boundary nodes, \f$1\f$ and \f$N\f$. </span></div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;<span class="comment">-# Regarding the requirements on the basis functions:</span></div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;<span class="comment">   -# The global finite-element shape functions \f$ \psi_j(x) \f$ and </span></div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;<span class="comment">      their first derivatives</span></div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;<span class="comment">      are square integrable. Hence, the </span></div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;<span class="comment">      finite-dimensional function space \f$ H^1_{0,FEM}(D) \f$</span></div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;<span class="comment">      spanned by the basis functions  \f$ \psi_j(x) \ \ (j=2,...,N-1)\f$,</span></div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;<span class="comment">      associated with the internal nodes,  is a subset </span></div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;<span class="comment">      of \f$ H^1_0,\f$ as required. Furthermore, it is easy to show </span></div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;<span class="comment">      that</span></div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;<span class="comment">      \f[ \left| v(x) - \sum_{j=2}^{N-1} v(X_j) </span></div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;<span class="comment">      \psi_j(x) \right| \to 0 </span></div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;<span class="comment">      \mbox{\ \ \ as $N\to\infty$ and $h=\frac{1}{N-1}</span></div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;<span class="comment">      \to 0,$ \ \ \ \ \ \ \ </span></div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;<span class="comment">      (18) } \f]</span></div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;<span class="comment">      for any  \f$ v(x) \in H^1_0(D) \f$. In other words, \f$ H^1_{0,FEM}(D) </span></div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;<span class="comment">      \f$ approaches \f$ H^1_0(D) \f$  as  \f$ N \to \infty. \f$</span></div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;<span class="comment">   -# The global finite-element shape functions </span></div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;<span class="comment">      \f$ \psi_2(x), \psi_3(x),...,\psi_{N-1}(x) \f$</span></div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;<span class="comment">      vanish on the domain boundary.</span></div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;<span class="comment">   -# The Jacobian matrix is sparse because its entries</span></div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;<span class="comment">      \f[ J_{kj} = \frac{\partial r_k}{\partial U_j} = </span></div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;<span class="comment">      \int_0^1 \frac{\mbox{d} </span></div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;<span class="comment">      \psi_j(x)}{\mbox{d} x} \ </span></div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;<span class="comment">      \frac{\mbox{d} \psi_k(x)}{\mbox{d} x} \,  \mbox{d}x \f]</span></div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;<span class="comment">      are nonzero when the basis functions \f$ \psi_j(x) \f$</span></div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;<span class="comment">      and  \f$ \psi_k(x) \f$ are both non-zero. For these shape functions,</span></div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;<span class="comment">      \f[ J_{kj} \ne 0 \mbox{\ \ \ \ when \ \ $k=j-1,\ j, \ j+1,$} \f]</span></div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;<span class="comment">      indicating that the Jacobian matrix is tri-diagonal.</span></div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;<span class="comment">   .</span></div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;<span class="comment">.</span></div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;<span class="comment">We can now formulate the finite-element-based solution of problem P1</span></div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;<span class="comment">in the following algorithm:</span></div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;<span class="comment">&lt;CENTER&gt; &lt;B&gt; Algorithm 2: Finite Element solution of</span></div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;<span class="comment">problem P1 by Newton&#39;s method&lt;/B&gt; &lt;/CENTER&gt;</span></div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;<span class="comment">- Choose the number of nodal points, \f$ N \f$, and distribute</span></div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;<span class="comment">  them evenly through the domain so that \f$ X_j=(j-1)h\f$,</span></div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;<span class="comment">  where \f$h=1/(N-1)\f$. This defines the global shape </span></div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;<span class="comment">  functions \f$ \psi_j(x)\f$.</span></div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;<span class="comment">- Set  \f[ u_p(x) = g_0 \psi_1(x) +  g_1 \psi_N(x) \f]</span></div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;<span class="comment">  and</span></div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;<span class="comment">     \f[ u_h(x) = \sum_{j=2}^{N-1} U_{j}\ \psi_j(x). \f]</span></div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;<span class="comment">- Provide an initial guess for the unknowns \f$ U_2,U_3,...,U_{N-1}\f$.</span></div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;<span class="comment">  Since P1 is a linear problem, the quality of the initial guess is </span></div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;<span class="comment">  irrelevant </span></div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;<span class="comment">  and we can simply set \f$ U_i^{(0)}=0 \mbox{\ \ \ for $i=2,...,N-1$}. \f$</span></div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;<span class="comment">- Determine the residuals </span></div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;<span class="comment">  \f[ r_k^{(0)} =  \int_0^1 \left\{</span></div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;<span class="comment">  \left( g_0 \frac{\mbox{d} \psi_1(x)}{\mbox{d} x} + \ </span></div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;<span class="comment">         g_1 \frac{\mbox{d} \psi_N(x)}{\mbox{d} x} + \</span></div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;<span class="comment">  \sum_{j=2}^{N-1} U_{j}^{(0)}\frac{\mbox{d} </span></div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;<span class="comment">  \psi_j(x)}{\mbox{d} x} \right)</span></div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;<span class="comment">  \frac{\mbox{d} \psi_k(x)}{\mbox{d} x}\ </span></div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;<span class="comment">  + f(x) \  \psi_k(x) \right\} \mbox{d}x \mbox{\ \ \ \ \ </span></div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;<span class="comment">  \ for $k=2,...,N-1,$} \f]</span></div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;<span class="comment">  and the entries in the Jacobian matrix</span></div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;<span class="comment">     \f[ J_{kj} = \frac{\partial r_k}{\partial U_j} = </span></div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;<span class="comment">     \int_0^1 \frac{\mbox{d} </span></div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;<span class="comment">     \psi_j(x)}{\mbox{d} x} \ </span></div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;<span class="comment">     \frac{\mbox{d} \psi_k(x)}{\mbox{d} x} \  dx </span></div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;<span class="comment">      \mbox{\ \  \ for $j,k=2,...,N-1.$} \f]</span></div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;<span class="comment">- Solve the linear system</span></div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;<span class="comment">  \f[ \sum_{j=2}^{N-1}  J_{kj} \ \delta U_j = - r_k^{(0)} </span></div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;<span class="comment">  \mbox{\ \  \ for $k=2,...,N-1.$} \f]</span></div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;<span class="comment">  for \f$ \delta U_k \ (k=2,...,N-1) \f$ .</span></div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;<span class="comment">- Correct the  initial guess via </span></div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;<span class="comment">   \f[ U_j = U_j^{(0)} + \ \delta U_j \mbox{\ \  \ for $j=2,...,N-1.$} \f] </span></div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;<span class="comment">  P1 is a linear problem, so \f$ U_j  \ (j=2,...,N-1) \f$</span></div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;<span class="comment">  is the exact solution. For nonlinear problems, we would</span></div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;<span class="comment">  have to continue the \ref Newton iteration until the residuals</span></div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;<span class="comment">  \f$ r_k(U_2,...,U_{N-1})  \ (k=2,...,N-1) \f$ were sufficiently</span></div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;<span class="comment">  small.</span></div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;<span class="comment">- The finite-element solution is </span></div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;<span class="comment">  \f[ u^{(FE)}(x) = g_0 \psi_1(x)+ g_1 \psi_N(x) + \sum_{j=2}^{N-1}  </span></div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;<span class="comment">  U_j \psi_j(x)  \ \ \ \ \ (19)  \f]</span></div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;<span class="comment">.</span></div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;<span class="comment">\subsection non_uniform Improving the quality of the solution: non-uniformly spaced nodes and higher-order shape functions</span></div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;<span class="comment"> Algorithm 2 presents the simplest possible</span></div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;<span class="comment"> implementation of the finite element method for problem P1. </span></div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;<span class="comment"> We now discuss</span></div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;<span class="comment"> two straightforward extensions that can significantly improve</span></div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;<span class="comment"> the quality of the approximate solution.</span></div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;<span class="comment"> The finite-element approximation in the previous section is</span></div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;<span class="comment"> piecewise linear between the nodal values. </span></div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;<span class="comment"> The accuracy to which the exact solution can be</span></div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;<span class="comment"> represented by a piecewise linear interpolant is</span></div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;<span class="comment"> limited by the number of nodal points, which is</span></div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;<span class="comment"> the essence of the convergence statement (18). The </span></div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;<span class="comment"> number of nodes required to resolve the solution to a given</span></div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;<span class="comment"> accuracy depends on the nature of the </span></div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;<span class="comment"> solution --- more nodes</span></div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;<span class="comment"> are needed to interpolate rapidly varying functions.</span></div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;<span class="comment"> If the solution is rapidly varying in a small portion of the domain</span></div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;<span class="comment"> it would be wasteful to use the same (fine) nodal spacing throughout</span></div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;<span class="comment"> the domain. A non-uniform spacing, see below,</span></div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;<span class="comment">\image html fe_adaptive_interpolant.gif &quot;Adaptive 1D finite element mesh: Non-uniform spacing of nodes to achieve a high resolution only where it is required. &quot; </span></div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;<span class="comment">\image latex fe_adaptive_interpolant.eps &quot;Adaptive 1D finite element mesh: Non-uniform spacing of nodes to achieve a high resolution only where it is required. &quot; width=0.75\textwidth</span></div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;<span class="comment"> improves the accuracy of the solution without greatly increasing</span></div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;<span class="comment"> the total number of unknowns. Non-uniform spacing of the nodes </span></div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;<span class="comment"> is easy to implement and does not require any significant changes </span></div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;<span class="comment"> in Algorithm 2 -- we simply choose </span></div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;<span class="comment"> appropriate values for the nodal positions \f$ X_j \f$; an </span></div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;<span class="comment"> approach known as &quot;h-refinement&quot; because it alters the distance,</span></div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;<span class="comment"> \f$ h \f$, between nodes.</span></div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;<span class="comment">&lt;CENTER&gt;</span></div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;<span class="comment">&lt;TABLE class=&quot;oomph-table&quot;&gt;</span></div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;<span class="comment">&lt;TR&gt;</span></div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;<span class="comment">&lt;TD class=&quot;panel panel-default&quot;&gt;</span></div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;<span class="comment">&lt;CENTER class=&quot;panel-heading&quot;&gt;</span></div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;<span class="comment">&lt;B&gt; An aside: adaptive mesh refinement &lt;/B&gt;&lt;/CENTER&gt;</span></div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;<span class="comment">&lt;div class=&quot;panel-body&quot;&gt;</span></div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;<span class="comment">A non-uniform distribution of nodes requires a priori</span></div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;<span class="comment">knowledge of the regions in which we expect the solution to undergo</span></div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;<span class="comment">rapid variations. The alternative is to use adaptive mesh refinement: </span></div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;<span class="comment">start with a </span></div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;<span class="comment">relatively coarse, uniform mesh and compute the solution. If </span></div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;<span class="comment">the solution on the coarse mesh displays rapid variations in certain </span></div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;<span class="comment">parts of the domain (and is therefore likely to be poorly resolved), </span></div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;<span class="comment">refine the mesh in these regions and re-compute. Such adaptive</span></div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;<span class="comment">mesh refinement procedures can be automated and are </span></div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;<span class="comment">implemented in \c oomph-lib for a large number of problems; see the </span></div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;<span class="comment">section \ref example_P2</span></div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;<span class="comment">for an example.</span></div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;<span class="comment">&lt;/div&gt;</span></div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;<span class="comment">&lt;/TD&gt;</span></div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;<span class="comment">&lt;/TR&gt;</span></div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;<span class="comment">&lt;/TABLE&gt;</span></div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;<span class="comment">&lt;/CENTER&gt;</span></div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;<span class="comment"> The quality of the interpolation can also be improved by </span></div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;<span class="comment"> using higher-order interpolation, but maintaining</span></div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;<span class="comment">- the compact support for the global shape functions, so that</span></div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;<span class="comment">  \f$ \psi_j(x) \f$ is nonzero only in the vicinity of node</span></div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;<span class="comment">  \f$ j \f$, and</span></div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;<span class="comment">- the interpolation condition</span></div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;<span class="comment">  \f[  \psi_j(X_i) = \delta_{ij} \f]</span></div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;<span class="comment">  so that the shape function \f$ \psi_j \f$ is equal to one </span></div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;<span class="comment">  at node \f$ j \f$ and zero at all others.</span></div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;<span class="comment">. </span></div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;<span class="comment"> For instance, we can use the</span></div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;<span class="comment"> (global) quadratic finite-element shape functions shown below:</span></div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;<span class="comment">\image html 1Dmesh_with_quadratic_shape_fcts.gif &quot;(Global) quadratic finite-element basis functions in 1D. &quot; </span></div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;<span class="comment">\image latex 1Dmesh_with_quadratic_shape_fcts.eps &quot;(Global) quadratic finite-element basis functions in 1D. &quot; width=0.75\textwidth</span></div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;<span class="comment"> Note that we could also use shape functions with identical functional forms;</span></div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;<span class="comment"> instead, we have chosen two different forms for the shape functions</span></div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;<span class="comment"> so that the smooth sections of the different shape functions</span></div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;<span class="comment"> overlap within the elements. This is not necessary but facilitates</span></div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;<span class="comment"> the representation of the global shape functions in terms of</span></div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;<span class="comment"> their local counterparts within elements, see section \ref local_coords.</span></div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;<span class="comment"> The implementation of higher-order interpolation does not</span></div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;<span class="comment"> require any significant changes in Algorithm 2. We</span></div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;<span class="comment"> merely specify the functional form of the (global) quadratic</span></div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;<span class="comment"> finite-element shape functions sketched above.</span></div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;<span class="comment"> This approach is known as &quot;p-refinement&quot;, because it increases</span></div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;<span class="comment"> order of the &lt;B&gt;p&lt;/B&gt;olynomials that are used to represent the</span></div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;<span class="comment"> solution. </span></div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;<span class="comment">\section implementation An element-by-element implementation for 1D problems</span></div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;<span class="comment">From a mathematical point of view, the development of the</span></div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;<span class="comment">finite element method for the 1D model problem P1 is now complete, but </span></div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;<span class="comment">Algorithm 2 </span></div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;<span class="comment">has a number of features that would make it awkward to implement</span></div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;<span class="comment">in an actual computer program. Furthermore, having been derived</span></div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;<span class="comment">directly from Galerkin&#39;s method, the algorithm is based on </span></div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;<span class="comment">globally-defined shape functions and does not exploit the potential subdivision</span></div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;<span class="comment">of the domain into &quot;elements&quot;.</span></div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;<span class="comment">We shall now derive a mathematically equivalent scheme that </span></div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;<span class="comment">can be implemented more easily.</span></div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;<span class="comment">\subsection book_keeping Improved book-keeping: distinguishing between equations and nodes.</span></div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;<span class="comment">Since only a subset of the global finite-element shape functions act </span></div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;<span class="comment">as basis functions for the (homogeneous) functions </span></div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;<span class="comment">\f$ \phi^{(test)}(x)\f$ and  \f$ u_h(x)\f$, algorithm 2</span></div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;<span class="comment">resulted in a slightly</span></div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;<span class="comment">awkward numbering scheme for the equations and the unknown (nodal)</span></div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;<span class="comment">values. The equation numbers range from  2 to \f$N-1\f$, </span></div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;<span class="comment">rather than from 1 to \f$N-2\f$ because we identified the unknowns by</span></div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;<span class="comment">the node numbers. Although this is perfectly transparent in our</span></div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;<span class="comment">simple 1D example, the book-keeping quickly</span></div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;<span class="comment">becomes rather involved in more complicated problems. We therefore </span></div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;<span class="comment">treat node and equation numbers separately.</span></div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;<span class="comment">[\b Note: We shall use</span></div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;<span class="comment">the terms &quot;equation number&quot; and &quot;number of the unknown&quot; interchangeably;</span></div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;<span class="comment">this is possible because we must always have the same number of</span></div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;<span class="comment">equations and unknowns.] We can (re-)write the finite-element </span></div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;<span class="comment">solution (19) in more compact form as</span></div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;<span class="comment">\f[ u^{(FE)}(x) =\sum_{j=1}^{N}  U_j \ \psi_j(x). \f]</span></div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;<span class="comment">where the summation now includes \e all nodes in the finite element</span></div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;<span class="comment">mesh. To make this representation consistent with the boundary </span></div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;<span class="comment">conditions, the nodal values, \f$U_j\f$, </span></div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;<span class="comment">of nodes on the boundary are set to the prescribed </span></div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;<span class="comment">boundary values</span></div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;<span class="comment">\f[ U_j = g(X_j) \mbox{\ \ \ if $X_j\in \partial D$}.\f]</span></div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;<span class="comment">In the 1D problem P1,</span></div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;<span class="comment">\f$U_1=g_0\f$ and  \f$U_N=g_1\f$.</span></div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;<span class="comment">Furthermore, we associate each unknown nodal value, \f$ U_j \f$,</span></div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;<span class="comment">with a distinct equation number, \f${\cal E}(j)\f$, in the range</span></div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;<span class="comment">from 1 to \f$N-2\f$. In the above</span></div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;<span class="comment">example, the equation numbering scheme is given by</span></div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;<span class="comment">\f[ \mbox{</span></div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;<span class="comment">    \begin{tabular}{l c c c c c c}</span></div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;<span class="comment">    \hline \\</span></div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;<span class="comment">    \mbox{Node number $j$} &amp; 1 &amp; 2 &amp; 3 &amp; ... &amp; $N-1$ &amp; $N$  \\</span></div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;<span class="comment">    \hline \\</span></div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;<span class="comment">    \mbox{Equation number ${\cal E}(j)$} &amp; n/a &amp; 1 &amp; 2 &amp; ...</span></div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;<span class="comment">     &amp; $N-2$ &amp; n/a \\</span></div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;<span class="comment">    \hline \\</span></div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;<span class="comment">    \end{tabular}</span></div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;<span class="comment">    }</span></div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;<span class="comment"> \f]</span></div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;<span class="comment">where n/a indicates a node whose value is prescribed by the</span></div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;<span class="comment">boundary conditions. To facilitate the implementation in a computer</span></div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;<span class="comment">program, we indicate the fact that</span></div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;<span class="comment">a nodal value is determined by boundary conditions (i.e. that it</span></div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;<span class="comment">is &quot;pinned&quot;), by setting the equation number to a negative</span></div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;<span class="comment">value (-1, say), so that the equation numbering scheme becomes </span></div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;<span class="comment">\f[ \mbox{</span></div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;<span class="comment">    \begin{tabular}{l c c c c c c}</span></div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;<span class="comment">    \hline \\</span></div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;<span class="comment">    \mbox{Node number $j$} &amp; 1 &amp; 2 &amp; 3 &amp; ... &amp; $N-1$ &amp; $N$  \\</span></div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;<span class="comment">    \hline \\</span></div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;<span class="comment">    \mbox{Equation number ${\cal E}(j)$} &amp; -1 &amp; 1 &amp; 2 &amp; ...</span></div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;<span class="comment">     &amp; $N-2$ &amp; -1\\</span></div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;<span class="comment">    \hline \\</span></div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;<span class="comment">    \end{tabular}</span></div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;<span class="comment">    }</span></div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;<span class="comment"> \f]</span></div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;<span class="comment">We now re-formulate algorithm 2</span></div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;<span class="comment">as follows (the revised parts of the algorithm are enclosed</span></div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;<span class="comment">in boxes):</span></div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;<span class="comment"> &lt;CENTER&gt; &lt;B&gt; Algorithm 3: Finite Element solution of</span></div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;<span class="comment"> problem P1 &lt;/B&gt; &lt;/CENTER&gt; \n</span></div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;<span class="comment"> &lt;B&gt; Phase 1: Setup&lt;/B&gt; </span></div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;<span class="comment"> - Discretise the domain with \f$ N \f$ nodes which are located at</span></div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;<span class="comment">   \f$ X_j, \ j=1,...,N\f$, and choose the order of the global shape</span></div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;<span class="comment"> functions \f$ \psi_j(x).\f$</span></div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;<span class="comment"> &lt;TABLE BORDER=&quot;0&quot; &gt;</span></div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;<span class="comment"> &lt;TR&gt;</span></div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;<span class="comment"> &lt;TD bgcolor=&quot;cornsilk&quot;&gt;</span></div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;<span class="comment"> - Initialise the total number of unknowns, \f$M=0.\f$</span></div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;<span class="comment"> - Loop over all nodes \f$ j=1,...,N \f$:</span></div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;<span class="comment">   - If node j lies on the boundary: </span></div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;<span class="comment">      - Assign its value according to the (known) boundary condition</span></div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;<span class="comment">        \f[ U_j = g(X_j) \f]</span></div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;<span class="comment">      - Assign a negative equation number to reflect its &quot;pinned&quot; status:</span></div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;<span class="comment">        \f[ {\cal E}(j) = -1 \f]</span></div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;<span class="comment">      .</span></div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;<span class="comment">   - Else: </span></div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;<span class="comment">      - Increment the number of the unknowns</span></div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;<span class="comment">        \f[ M=M+1 \f]</span></div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;<span class="comment">      - Assign the equation number</span></div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;<span class="comment">        \f[ {\cal E}(j) = M \f]</span></div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;<span class="comment">      - Provide an initial guess for the unknown nodal value, e.g.</span></div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;<span class="comment">        \f[ U_j=0. \f]</span></div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;<span class="comment">      .</span></div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;<span class="comment">   .</span></div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;<span class="comment">.</span></div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;<span class="comment">&lt;/TD&gt;</span></div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;<span class="comment">&lt;/TR&gt;</span></div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;<span class="comment">&lt;/TABLE&gt;</span></div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;<span class="comment"> - Now that \f$ \psi_j(x) \f$ and  \f$ U_j \f$ have been defined and</span></div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;<span class="comment">   initialised, we can determine the current FE approximations for</span></div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;<span class="comment">   \f$ u(x)\f$ and \f$ \mbox{d} u(x)/\mbox{d} x\f$ from</span></div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;<span class="comment">   \f[ u^{(FE)}(x) = \sum_{k=1}^{N}  U_k \psi_k(x) </span></div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;<span class="comment">   \mbox{\ \ \ \ and \ \ \ \ }</span></div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;<span class="comment">   \frac{\mbox{d} u^{(FE)}(x)}{\mbox{d} x} = \sum_{k=1}^{N}  U_k </span></div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;<span class="comment">   \frac{\mbox{d} \psi_k(x)}{\mbox{d} x}. \f]</span></div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;<span class="comment"> &lt;B&gt; Phase 2: Solution     &lt;/B&gt; </span></div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;<span class="comment"> \n</span></div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;<span class="comment">&lt;TABLE  BORDER=&quot;0&quot;&gt;</span></div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;<span class="comment">&lt;TR&gt;</span></div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;<span class="comment">&lt;TD bgcolor=&quot;cornsilk&quot;&gt;</span></div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;<span class="comment">- Loop  over all  nodes \f$ k=1,...,N\f$:</span></div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;<span class="comment">  - Determine the equation number: \f$ {\cal E}(k) \f$</span></div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;<span class="comment">  - If \f$ {\cal E}(k) \ne -1 \f$:</span></div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;<span class="comment">    \f[ r_{{\cal E}(k)} =  \int_0^1 \frac{\mbox{d} </span></div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;<span class="comment">    u^{(FE)}(x)}{\mbox{d} x} \ </span></div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;<span class="comment">    \frac{\mbox{d} \psi_k(x)}{\mbox{d} x} \  dx + </span></div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;<span class="comment">    \int_0^1 f(x) \  \psi_k(x) \  dx. \f]</span></div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;<span class="comment">    -  Loop  over all  nodes \f$ j=1,...,N\f$:</span></div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;<span class="comment">    - Determine the equation number: \f$ {\cal E}(j) \f$</span></div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;<span class="comment">    - If \f$ {\cal E}(j) \ne -1 \f$:</span></div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;<span class="comment">      \f[ J_{{\cal E}(k){\cal E}(j)} = </span></div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;<span class="comment">      \frac{\partial r_{{\cal E}(k)}}{\partial U_j} = </span></div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;<span class="comment">      \int_0^1 \frac{\mbox{d} </span></div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;<span class="comment">      \psi_j(x)}{\mbox{d} x} \ </span></div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;<span class="comment">      \frac{\mbox{d} \psi_k(x)}{\mbox{d} x} \  dx </span></div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;<span class="comment">      \f]</span></div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;<span class="comment">    .</span></div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;<span class="comment">  .</span></div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;<span class="comment">.</span></div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;<span class="comment">&lt;/TD&gt;</span></div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;<span class="comment">&lt;/TR&gt;</span></div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;<span class="comment">&lt;/TABLE&gt;</span></div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;<span class="comment">- Solve the \f$ M \times M\f$ linear system</span></div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;<span class="comment">  \f[ \sum_{j=1}^{M}  J_{kj} \ y_j = - r_k </span></div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;<span class="comment">        \mbox{\ \  \ for $k=1,...,M.$} \f]</span></div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;<span class="comment">  for \f$ y_k \ (k=1,...,M)\f$.</span></div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;<span class="comment">.</span></div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;<span class="comment">&lt;TABLE  BORDER=&quot;0&quot;&gt;</span></div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;<span class="comment">&lt;TR&gt;</span></div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;<span class="comment">&lt;TD bgcolor=&quot;cornsilk&quot;&gt;</span></div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;<span class="comment">-  Loop over all  nodes \f$ j=1,...,N\f$:</span></div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;<span class="comment">  - Determine the equation number: \f$ {\cal E}(j) \f$</span></div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;<span class="comment">  - If \f$ {\cal E}(j) \ne -1 \f$: </span></div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;<span class="comment">  - Correct the initial guess via</span></div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;<span class="comment">    \f[ U_{{\cal E}(j)} =  U_{{\cal E}(j)} +  y_{{\cal E}(j)} \f] </span></div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;<span class="comment">  .</span></div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;<span class="comment">.  </span></div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;<span class="comment">&lt;/TD&gt;</span></div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;<span class="comment">&lt;/TR&gt;</span></div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;<span class="comment">&lt;/TABLE&gt;</span></div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;<span class="comment">- P1 is a linear problem, so \f$ U_j  \ (j=1,...,N) \f$</span></div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;<span class="comment">  is the exact solution. For nonlinear problems, we would</span></div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;<span class="comment">  have to continue the \ref Newton iteration until the residuals</span></div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;<span class="comment">  \f$r_k \ (k=1,...,M) \f$ were sufficiently small.</span></div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;<span class="comment">&lt;B&gt; Phase 3: Postprocessing (document the solution)&lt;/B&gt; </span></div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;<span class="comment">- The finite-element solution is given by </span></div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;<span class="comment">  \f[ u^{(FE)}(x) = \sum_{j=1}^{N}  U_j \psi_j(x). \f]  </span></div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;<span class="comment">.</span></div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;<span class="comment">\subsection element_by_element Element-by-element assembly</span></div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;<span class="comment">In its current form, our algorithm assembles the equations</span></div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;<span class="comment">and the Jacobian matrix equation-by-equation and does not</span></div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;<span class="comment">exploit the finite support of the global shape functions, which</span></div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;<span class="comment">permits decomposition of the domain into elements. Each element</span></div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;<span class="comment">consists of a given number of nodes that depends upon the order of</span></div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;<span class="comment">local approximation within the element. In the case of linear</span></div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;<span class="comment">interpolation each element consists of two nodes, as seen below:</span></div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;<span class="comment">\image html 1Dmesh.gif &quot;A 1D finite element mesh. &quot; </span></div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;<span class="comment">\image latex 1Dmesh.eps &quot;A 1D finite element mesh. &quot; width=0.75\textwidth</span></div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;<span class="comment"> </span></div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;<span class="comment">In the following three sections we shall develop an alternative, </span></div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;<span class="comment">element-based assembly procedure, which involves the introduction of</span></div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;<span class="comment">- local and global node numbers,</span></div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;<span class="comment">- local and global equation numbers,</span></div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;<span class="comment">- local coordinates.</span></div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;<span class="comment">.</span></div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;<span class="comment">\subsubsection local_global_nodes Local and global node numbers</span></div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;<span class="comment">Consider the discretisation of the 1D problem P1 with \f$N_E\f$</span></div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;<span class="comment">two-node (linear) finite elements. The residual associated with node k</span></div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;<span class="comment">is given by</span></div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;<span class="comment">\f[ r_{{\cal E}(k)} = \int_0^1 \left( \frac{\mbox{d} </span></div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;<span class="comment"> u^{(FE)}(x)}{\mbox{d} x} \ </span></div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;<span class="comment"> \frac{\mbox{d} \psi_k(x)}{\mbox{d} x} + </span></div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;<span class="comment"> f(x) \  \psi_k(x) \right)  dx. \ \ \ \ \ \ \ \  (20) \f]</span></div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;<span class="comment">The global finite-element shape functions have finite</span></div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;<span class="comment">support, so the integrand is non-zero only in</span></div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;<span class="comment">the two elements \f$k-1\f$ and \f$k\f$, </span></div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;<span class="comment">adjacent to node \f$k\f$. This allows us to write</span></div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;<span class="comment">\f[ r_{{\cal E}(k)} = \int_{\mbox{Element }k-1} \left( \frac{\mbox{d} </span></div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;<span class="comment"> u^{(FE)}(x)}{\mbox{d} x} \ </span></div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;<span class="comment"> \frac{\mbox{d} \psi_k(x)}{\mbox{d} x} \  dx + </span></div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;<span class="comment"> f(x) \  \psi_k(x) \right)  dx +  </span></div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;<span class="comment"> \int_{\mbox{Element }k} \left( \frac{\mbox{d} </span></div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;<span class="comment"> u^{(FE)}(x)}{\mbox{d} x} \ </span></div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;<span class="comment"> \frac{\mbox{d} \psi_k(x)}{\mbox{d} x} \  dx + </span></div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;<span class="comment"> f(x) \  \psi_k(x) \right)  dx. </span></div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;<span class="comment"> \ \ \ \ \ \ \  (21) \f]</span></div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;<span class="comment"> Typically (e.g. in the Newton method) </span></div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;<span class="comment"> we require \e all the residuals \f$ r_k \ (k=1,...,M) \f$ --- </span></div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;<span class="comment"> the entire residual vector. We could compute</span></div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;<span class="comment"> the entries in this vector by using the above equation to</span></div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;<span class="comment"> calculate each residual \f$ r_{{\cal E}(k)}\f$ individually</span></div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;<span class="comment"> for all (unpinned) nodes \f$k\f$.</span></div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;<span class="comment"> In the process, we would visit each element twice: once for </span></div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;<span class="comment"> each of the two residuals that are associated with its nodes.</span></div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;<span class="comment"> We can, instead, re-arrange this procedure to consist of a single</span></div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;<span class="comment"> loop over the elements, in which the appropriate contribution is</span></div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;<span class="comment"> added to the global residuals associated with each element&#39;s nodes.</span></div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;<span class="comment"> In order to achieve this, we must introduce the concept of local </span></div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;<span class="comment"> and global node numbers, illustrated in this sketch:</span></div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;<span class="comment">\image html 1Dmesh_local_and_global_node_numbers.gif &quot;Local and global node numbers in a 1D mesh. &quot; </span></div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;<span class="comment">\image latex 1Dmesh_local_and_global_node_numbers.eps &quot;Local and global node numbers in a 1D mesh. &quot; width=0.75\textwidth</span></div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;<span class="comment"> We label the nodes in each element \f$ e \f$ with local node numbers</span></div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;<span class="comment"> so that for two-node elements, the left (right) node has the</span></div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;<span class="comment"> local node number 1 (2). The relation</span></div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;<span class="comment"> between local and global node numbers can be represented </span></div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;<span class="comment"> in a simple lookup scheme </span></div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;<span class="comment"> \f[ j_{global} = {\cal J}(j_{local},e), \f]</span></div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;<span class="comment"> which determines the global node number \f$ j_{global}\f$ of</span></div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;<span class="comment"> local node \f$ j_{local}\f$ in element \f$ e \f$.</span></div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;<span class="comment"> The lookup scheme establishes how the nodes are connected by elements</span></div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;<span class="comment"> and is one of the main steps in the</span></div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;<span class="comment"> &quot;mesh generation&quot; process. For the 1D example above, the lookup scheme</span></div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;<span class="comment"> is given by</span></div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;<span class="comment">\f[ \mbox{</span></div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;<span class="comment">    \begin{tabular}{l l l l l l l l}</span></div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;<span class="comment">    \hline \\</span></div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;<span class="comment">    \mbox{Element $e$} &amp; 1 &amp;  &amp; 2 &amp; &amp; ... &amp; $N_E$ &amp;  \\</span></div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;<span class="comment">    \hline \\</span></div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;<span class="comment">    \mbox{Local node number $j$} &amp; 1 &amp; 2 &amp; 1 &amp; 2 &amp; ... &amp; 1 &amp; 2  \\</span></div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;<span class="comment">    \hline \\</span></div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;<span class="comment">    \mbox{Global node number </span></div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;<span class="comment">          ${\cal J}(j,e)$} &amp; 1 &amp; 2 &amp; 2 &amp; 3 &amp;...&amp; $N-1$ &amp; </span></div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;<span class="comment">      $N$ \\</span></div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;<span class="comment">    \hline \\</span></div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;<span class="comment">    \end{tabular}</span></div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;<span class="comment">    }</span></div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;<span class="comment"> \f]</span></div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;<span class="comment">where \f$N=N_E+1\f$.</span></div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;<span class="comment">If we discretise the domain with three-node (quadratic) elements, as in this</span></div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;<span class="comment">sketch, </span></div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;<span class="comment">\image html 1Dmesh_quadr_elements_local_and_global_eqn_numbers.gif &quot;Local and global node numbers in a 1D mesh with three-node elements. &quot; </span></div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;<span class="comment">\image latex 1Dmesh_quadr_elements_local_and_global_eqn_numbers.eps &quot;Local and global node numbers in a 1D mesh with three-node elements. &quot; width=0.75\textwidth</span></div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;<span class="comment">the lookup scheme becomes</span></div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;<span class="comment">\f[ \mbox{</span></div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;<span class="comment">    \begin{tabular}{l l l l l l  l l l l l}</span></div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;<span class="comment">    \hline \\</span></div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;<span class="comment">    \mbox{Element $e$} &amp; 1 &amp; &amp;  &amp; 2 &amp; &amp; &amp; ... &amp; $N_E$ &amp; &amp; \\</span></div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;<span class="comment">    \hline \\</span></div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;<span class="comment">    \mbox{Local node number $j$} &amp; 1 &amp; 2 &amp; 3 &amp; 1 &amp; 2 &amp; 3 &amp; ... &amp; 1 &amp; 2 &amp;3\\</span></div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;<span class="comment">    \hline \\</span></div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;<span class="comment">    \mbox{Global node number </span></div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;<span class="comment">          ${\cal J}(j,e)$} &amp; 1 &amp; 2 &amp; 3 &amp; 3 &amp; 4 &amp; 5 &amp; ...&amp; N-2  &amp; N-1 &amp;N\\ </span></div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;<span class="comment">     </span></div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;<span class="comment">    \hline \\</span></div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;<span class="comment">    \end{tabular}</span></div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;<span class="comment">    }</span></div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;<span class="comment"> \f]</span></div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;<span class="comment">where \f$N=2 N_E+1\f$.</span></div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;<span class="comment">Provided such a lookup scheme has been constructed, the global residual vector</span></div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;<span class="comment">and the global Jacobian matrix for \f$n\f$-node elements can be assembled with </span></div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;<span class="comment">the following algorithm </span></div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;<span class="comment">&lt;CENTER&gt; &lt;B&gt; Algorithm 4: Assembling the residual</span></div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;<span class="comment">vector and the Jacobian matrix using local and global node</span></div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;<span class="comment">numbers &lt;/B&gt; &lt;/CENTER&gt;</span></div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;<span class="comment">- Initialise the residual vector, \f$ r_k=0 \f$ for \f$k=1,...,M \f$</span></div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;<span class="comment">  and the Jacobian matrix \f$ J_{kj}=0 \f$ for \f$j,k=1,...,M. \f$</span></div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;<span class="comment">- Loop over the elements  \f$e = 1,...,N_E \f$</span></div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;<span class="comment">  - Loop over the local nodes \f$ k_{local}=1,...,n \f$</span></div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;<span class="comment">    - Determine the global node number </span></div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;<span class="comment">      \f$ k_{global}={\cal J}(k_{local},e) \f$.</span></div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;<span class="comment">    - Determine the global equation number \f${\cal E}(k_{global})\f$.</span></div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;<span class="comment">      - If  \f${\cal E}(k_{global})\ne -1\f$ \n\n</span></div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;<span class="comment">        \f$ \bullet \f$ Add the element&#39;s contribution to the residual</span></div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;<span class="comment">          \f[ r_{{\cal E}(k_{global})} =  r_{{\cal E}(k_{global})} + </span></div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;<span class="comment">          \int_{e} \left( \frac{\mbox{d} </span></div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;<span class="comment">          u^{(FE)}(x)}{\mbox{d} x} \ </span></div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;<span class="comment">          \frac{\mbox{d} \psi_{k_{global}}(x)}{\mbox{d} x} + </span></div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;<span class="comment">          f(x) \  \psi_{k_{global}}(x) \right)  dx \f]</span></div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;<span class="comment">          \f$ \bullet \f$  Loop over the local nodes \f$ j_{local}=1,...,n \f$</span></div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;<span class="comment">          \n\n \f$ \bullet \f$ Determine the global node number </span></div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;<span class="comment">          \f$ j_{global}={\cal J}(j_{local},e) \f$</span></div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;<span class="comment">          \n\n \f$ \bullet \f$ Determine the global equation number </span></div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;<span class="comment">          \f${\cal E}(j_{global})\f$</span></div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;<span class="comment">          \n\n \f$ \bullet \f$ If  \f${\cal E}(j_{global})\ne -1\f$: </span></div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;<span class="comment">          Add the element&#39;s contribution to the Jacobian matrix</span></div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;<span class="comment">           \f[ J_{{\cal E}(k_{global}) {\cal E}(j_{global})} =  </span></div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;<span class="comment">               J_{{\cal E}(k_{global}) {\cal E}(j_{global})} + </span></div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;<span class="comment">            \int_{e} \left( </span></div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;<span class="comment">            \frac{\mbox{d} \psi_{j_{global}}(x)}{\mbox{d} x} \ </span></div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;<span class="comment">            \frac{\mbox{d} \psi_{k_{global}}(x)}{\mbox{d} x}</span></div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;<span class="comment">            \right) dx \f]</span></div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;<span class="comment">\subsubsection local_eqn_numbers Local and global equation numbers</span></div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;<span class="comment">Each element makes a contribution to only a small number of entries in </span></div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;<span class="comment">the global residual vector and the Jacobian matrix; namely, those</span></div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;<span class="comment">entries associated with the unknowns stored at the nodes in the</span></div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;<span class="comment">element. In general, each element is associated</span></div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;<span class="comment">with \f$ {\cal N}_{dof}(e)\f$ unknowns, say.</span></div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;<span class="comment">Element \f$e\f$ contributes to \f$ {\cal N}_{dof}(e)\f$ entries</span></div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;<span class="comment">in the \e global residual vector and \f$ {\cal N}^2_{dof}(e)\f$</span></div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;<span class="comment">entries in the \e global Jacobian matrix. In fact, </span></div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;<span class="comment">the finite support of the shape functions leads to sparse \e global</span></div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;<span class="comment">Jacobian matrices and it would be extremely wasteful to allocate</span></div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;<span class="comment">storage for all its entries, and use Algorithm 4 to</span></div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;<span class="comment">calculate those that are non-zero. </span></div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;<span class="comment"> Instead, we combine each element&#39;s contributions into  </span></div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;<span class="comment">an \f$ {\cal N}_{dof}(e) \times  {\cal N}_{dof}(e) \f$</span></div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;<span class="comment">&quot;element Jacobian matrix&quot; </span></div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;<span class="comment">\f$ J_{ij}^{(e)}, \ i,j=1,...,{\cal N}_{dof}(e) \f$ </span></div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;<span class="comment">and &quot;element residual vector&quot; </span></div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;<span class="comment">\f$ r_{i}^{(e)}, \ i=1,..., {\cal N}_{dof}(e)</span></div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;<span class="comment">\f$. These (dense) matrices and vectors are then assembled into the</span></div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;<span class="comment">global matrix and residuals vector.</span></div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;<span class="comment"> The entries in the element&#39;s Jacobian matrix and its </span></div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;<span class="comment">residual vector are labelled by the &quot;local equation numbers&quot;, which range </span></div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;<span class="comment">from 1 to \f$ {\cal N}_{dof}(e)\f$ and are illustrated in this sketch:</span></div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;<span class="comment">\image html 1Dmesh_local_and_global_node_and_equation_numbers.gif &quot;Local and global node and equation numbers. &quot; </span></div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;<span class="comment">\image latex 1Dmesh_local_and_global_node_and_equation_numbers.eps &quot;Local and global node and equation numbers. &quot; width=0.75\textwidth</span></div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;<span class="comment">In order to add the elemental contributions to the correct \e global</span></div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;<span class="comment">entries in the residual vector and Jacobian matrix, it is necessary to</span></div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;<span class="comment">translate between the local and global equation numbers; and we introduce</span></div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;<span class="comment">another lookup scheme \f$ \widehat{\cal E}(i_{local},e)\f$ that stores</span></div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;<span class="comment">the global equation number corresponding to local equation \f$i_{local}\f$</span></div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;<span class="comment">in element \f$e\f$. The lookup scheme can be generated by the following</span></div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;<span class="comment">algorithm</span></div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;<span class="comment"> &lt;CENTER&gt; &lt;B&gt; Algorithm 5: Establishing the relation</span></div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;<span class="comment"> between local and global equation numbers &lt;/B&gt; &lt;/CENTER&gt;</span></div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;<span class="comment">- Construct the global equation numbering scheme, using the algorithm detailed</span></div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;<span class="comment">  in Phase 1 of Algorithm 3.</span></div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;<span class="comment">- Loop over the elements  \f$ e=1,...,N_e \f$</span></div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;<span class="comment">  - Initialise the counter for the number of degrees of </span></div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;<span class="comment">    freedom in the element, \f$ j_{dof}=0 \f$.</span></div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;<span class="comment">  - Loop over the element&#39;s local nodes \f$ j_{local}=1,...,n\f$</span></div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;<span class="comment">    - Determine the global node number </span></div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;<span class="comment">      \f$ j_{global} = {\cal J}(j_{local},e) \f$</span></div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;<span class="comment">    - Determine the global equation number \f${\cal E}(j_{global})\f$</span></div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;<span class="comment">    - If  \f${\cal E}(j_{global}) \ne -1\f$:</span></div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;<span class="comment">      &lt;TABLE  BORDER=&quot;0&quot;&gt;</span></div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;<span class="comment">      &lt;TR&gt;</span></div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;<span class="comment">      &lt;TD bgcolor=&quot;cornsilk&quot;&gt;</span></div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;<span class="comment">      - Increment the number of degrees of </span></div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;<span class="comment">        freedom  in the element, \f$ j_{dof}=j_{dof}+1\f$</span></div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;<span class="comment">      &lt;/TD&gt;</span></div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;<span class="comment">      &lt;/TR&gt;</span></div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;<span class="comment">      &lt;/TABLE&gt;</span></div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;<span class="comment">      - Add the entry to the lookup scheme that relates local and</span></div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;<span class="comment">        global equation numbers,</span></div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;<span class="comment">        \f$ \widehat{\cal E}(j_{dof},e) = {\cal E}(j_{global})\f$</span></div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;<span class="comment">      .</span></div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;<span class="comment">    .</span></div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;<span class="comment">  - Assign the number of degrees of freedom in the element,</span></div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;<span class="comment">    \f$ {\cal N}_{dof}(e)=j_{dof} \f$</span></div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;<span class="comment">  .</span></div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;<span class="comment">.</span></div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;<span class="comment">For the 1D problem P1 with two-node elements, the lookup scheme</span></div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;<span class="comment">has the following form:</span></div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;<span class="comment">\f[ \mbox{</span></div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;<span class="comment">    \begin{tabular}{l l  l  l  l  l  l  l l  l  l }</span></div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;<span class="comment">    \hline \\</span></div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;<span class="comment">    \mbox{Element $e$} &amp; 1 &amp; 2 &amp; &amp; 3 &amp; &amp; ... &amp; $N_E-1$ &amp; &amp; $N_E$  \\</span></div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;<span class="comment">    \hline \\</span></div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;<span class="comment">    \mbox{Number of degrees of freedom ${\cal N}_{dof}(e)$} &amp;</span></div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;<span class="comment">    1 &amp; 2 &amp; &amp; 2 &amp; &amp; ... &amp; 2 &amp; &amp; 1\\ </span></div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;<span class="comment">    \hline \\</span></div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;<span class="comment">    \mbox{Local equation number $i_{local}$} &amp; 1 &amp; 1 &amp; 2 &amp; 1 &amp; 2 &amp; ...</span></div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;<span class="comment">     &amp; 1 &amp; 2 &amp; 1\\</span></div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;<span class="comment">    \hline \\</span></div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;<span class="comment">    \mbox{Global equation number $\widehat{\cal E}(i_{local},e)$}   </span></div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;<span class="comment">     &amp; 1 &amp; 1 &amp; 2 &amp; 2 &amp; 3 &amp; ... &amp; $N-3$ &amp; $N-2$ &amp; $N-2$ \\</span></div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;<span class="comment">    \hline \\</span></div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;<span class="comment">    \end{tabular}</span></div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;<span class="comment">    }</span></div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;<span class="comment"> \f]</span></div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;<span class="comment">Using this lookup scheme, we can re-arrange the computation of the </span></div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;<span class="comment">residual vector and the Jacobian matrix as follows:</span></div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;<span class="comment">&lt;CENTER&gt; &lt;B&gt; Algorithm 6: Element-based assembly</span></div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;<span class="comment">of the residual vector and the Jacobian matrix &lt;/B&gt; &lt;/CENTER&gt;</span></div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;<span class="comment">- Initialise the global residual vector, \f$ r_j=0 \f$ for \f$j=1,...,M \f$</span></div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;<span class="comment">  and the global Jacobian matrix \f$ J_{jk}=0 \f$ for \f$j,k=1,...,M \f$</span></div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;<span class="comment">- Loop over the elements  \f$ e=1,...,N_E\f$</span></div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;<span class="comment">  \n\n   </span></div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;<span class="comment">  &lt;CENTER&gt; &lt;B&gt; Compute the element&#39;s residual vector and </span></div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;<span class="comment">  Jacobian matrix &lt;/B&gt;  &lt;/CENTER&gt;</span></div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;<span class="comment">  \n</span></div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;<span class="comment">  \f$ \bullet \f$ Determine the number of degrees of freedom in this element,</span></div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;<span class="comment">  \f$ n_{dof}={\cal N}_{dof}(e) \f$. \n</span></div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;<span class="comment">  \f$ \bullet \f$  Initialise the counter for the local degrees of freedom</span></div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;<span class="comment">  \f$ i_{dof}=0\f$ (counting the entries in the element&#39;s residual vector</span></div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;<span class="comment">  and the rows of the element&#39;s Jacobian matrix) \n</span></div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;<span class="comment">  - Loop over the local nodes \f$ j_{local}=1,...,n \f$ \n</span></div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;<span class="comment">    \f$ \bullet \f$ Determine the global node number </span></div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;<span class="comment">    \f$ j_{global}={\cal J}(j_{local},e)\f$ \n</span></div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;<span class="comment">    \f$ \bullet \f$ Determine the global equation number </span></div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;<span class="comment">    \f$ {\cal E}( j_{global})</span></div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;<span class="comment">    \f$ \n </span></div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;<span class="comment">    \f$ \bullet \f$  If  \f$ {\cal E}( j_{global}) \ne -1 \f$: </span></div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;<span class="comment">    &lt;TABLE BORDER=&quot;0&quot;&gt;</span></div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;<span class="comment">    &lt;TR&gt;</span></div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;<span class="comment">    &lt;TD bgcolor=&quot;cornsilk&quot;&gt;</span></div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;<span class="comment">    \f$ \bullet \f$ Increment the counter for the local degrees of freedom</span></div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;<span class="comment">    \f$ i_{dof}= i_{dof}+1\f$</span></div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;<span class="comment">    &lt;/TD&gt;</span></div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;<span class="comment">    &lt;/TR&gt;</span></div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;<span class="comment">    &lt;/TABLE&gt;</span></div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;<span class="comment">    \f$ \bullet \f$ Determine the entry in the element&#39;s residual vector</span></div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;<span class="comment">    \f[ r_{i_{dof}}^{(e)} =</span></div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;<span class="comment">    \int_{e} \left( \frac{\mbox{d} </span></div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;<span class="comment">    u^{(FE)}(x)}{\mbox{d} x} \ </span></div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;<span class="comment">    \frac{\mbox{d} \psi_{j_{global}}(x)}{\mbox{d} x} + </span></div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;<span class="comment">    f(x) \  \psi_{j_{global}}(x) \right)  dx \f] </span></div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;<span class="comment">    \f$ \bullet \f$ Initialise the second counter for the local </span></div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;<span class="comment">    degrees of freedom \f$ j_{dof}=0\f$ (counting the columns </span></div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;<span class="comment">    in the element&#39;s  Jacobian matrix) \n\n</span></div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;<span class="comment">    \f$ \bullet \f$ Loop over the local nodes \f$ k_{local}=1,...,n \f$</span></div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;<span class="comment">    - Determine the global node number </span></div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;<span class="comment">      \f$ k_{global}={\cal J}(k_{local},e)\f$</span></div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;<span class="comment">    - Determine the global equation number </span></div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;<span class="comment">      \f$ {\cal E}( k_{global}) \f$</span></div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;<span class="comment">    - If  \f$ {\cal E}( k_{global}) \ne -1 \f$:</span></div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;<span class="comment">      &lt;TABLE  BORDER=&quot;0&quot;&gt;</span></div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;<span class="comment">      &lt;TR&gt; </span></div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;<span class="comment">      &lt;TD bgcolor=&quot;cornsilk&quot;&gt;</span></div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;<span class="comment">      \f$ \bullet \f$ Increment the counter for the local </span></div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;<span class="comment">      degrees of freedom \f$ j_{dof}= j_{dof}+1\f$</span></div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;<span class="comment">      &lt;/TD&gt;</span></div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;<span class="comment">      &lt;/TR&gt;</span></div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;<span class="comment">      &lt;/TABLE&gt;</span></div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;<span class="comment">      \f$ \bullet \f$ Determine the entry in the element&#39;s </span></div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;<span class="comment">      Jacobian matrix</span></div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;<span class="comment">      \f[ J_{i_{dof}j_{dof}}^{(e)} =  </span></div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;<span class="comment">      \int_{e} \left( </span></div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;<span class="comment">      \frac{\mbox{d} \psi_{k_{global}}(x)}{\mbox{d} x} \ </span></div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;<span class="comment">      \frac{\mbox{d} \psi_{j_{global}}(x)}{\mbox{d} x}</span></div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;<span class="comment">      \right) dx \f]</span></div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;<span class="comment">    .</span></div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;<span class="comment">  . </span></div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;<span class="comment">  \n  \n    </span></div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;<span class="comment">  &lt;CENTER&gt; &lt;B&gt; Add the element&#39;s contribution to the global residual</span></div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;<span class="comment">  vector and Jacobian matrix &lt;/B&gt;  &lt;/CENTER&gt;</span></div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;<span class="comment">  \n</span></div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;<span class="comment">  - Loop over the local degrees of freedom \f$ i_{dof}=1,...,n_{dof} \f$</span></div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;<span class="comment">    - Add the element&#39;s contribution to the global residual vector</span></div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;<span class="comment">      \f[ r_{\widehat{\cal E}(i_{dof},e)} =  </span></div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;<span class="comment">      r_{\widehat{\cal E}(i_{dof},e)} + </span></div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;<span class="comment">      r_{i_{dof}}^{(e)} \f]</span></div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;<span class="comment">      - Loop over the local degrees of freedom \f$ j_{dof}=1,...,n_{dof}\f$</span></div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;<span class="comment">        \n\n  \f$ \bullet \f$ Add the element&#39;s contribution to the global </span></div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;<span class="comment">        Jacobian matrix</span></div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;<span class="comment">        \f[ J_{\widehat{\cal E}(i_{dof},e)\widehat{\cal E}(j_{dof},e) } =  </span></div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;<span class="comment">        J_{\widehat{\cal E}(i_{dof},e)\widehat{\cal E}(j_{dof},e) } + </span></div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;<span class="comment">        J_{i_{dof} j_{dof}}^{(e)} \f]</span></div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;<span class="comment">      .</span></div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;<span class="comment">    .</span></div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;<span class="comment">  .</span></div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;<span class="comment">.</span></div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;<span class="comment">Note that the order in which we loop over the local degrees of freedom</span></div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;<span class="comment">within each element \e must be the same as the order used when</span></div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;<span class="comment">constructing the local equation numbering scheme of Algorithm</span></div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;<span class="comment">5. [&lt;B&gt;Exercise:&lt;/B&gt; What would happen if we</span></div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;<span class="comment">reversed the order in which we loop over the element&#39;s nodes</span></div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;<span class="comment">in Algorithm 5 while retaining Algorithm </span></div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;<span class="comment">6 in its present form? Hint: Note that the local equation</span></div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;<span class="comment">numbers are computed &quot;on the fly&quot; by the highlighted sections</span></div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;<span class="comment">of the two algorithms.]</span></div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;<span class="comment">In an</span></div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;<span class="comment">actual implementation of the above procedure, Algorithms</span></div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;<span class="comment">5 and  6 are likely to be contained</span></div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;<span class="comment">in separate functions. When the functions are first implemented</span></div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;<span class="comment">(in the form described above), they will obviously be consistent</span></div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;<span class="comment">with each other. However, there is a danger that in subsequent</span></div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;<span class="comment">code revisions changes might only be introduced in one of the two </span></div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;<span class="comment">functions. To avoid the potential for such disasters, it </span></div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;<span class="comment">is preferable to create an explicit</span></div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;<span class="comment">storage scheme for the local equation numbers that is constructed</span></div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;<span class="comment">during the execution of Algorithm 5 and used in </span></div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;<span class="comment">Algorithm 6. For this purpose, we introduce</span></div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;<span class="comment">yet another lookup table, \f$ {\cal L}(j_{local},e)\f$,</span></div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;<span class="comment">which stores the local equation number associated with the</span></div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;<span class="comment">nodal value stored at local node \f$ j_{local}\f$ in element</span></div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;<span class="comment">\f$e\f$. Again we</span></div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;<span class="comment">set the equation number to -1 if the nodal value is pinned. </span></div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;<span class="comment">The revised form of Algorithm 5 is then given by</span></div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;<span class="comment">(as before, only the sections that are highlighted have been changed):</span></div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;<span class="comment"> &lt;CENTER&gt; &lt;B&gt; Algorithm 7: Establishing the relation</span></div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;<span class="comment"> between local and global equation numbers (revised) &lt;/B&gt; &lt;/CENTER&gt;</span></div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;<span class="comment">- Set up the global equation numbering scheme, using the algorithm detailed</span></div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;<span class="comment">  in Phase 1 of Algorithm 3.</span></div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;<span class="comment">- Loop over the elements  \f$ e=1,...,N_e \f$</span></div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;<span class="comment">  - Initialise the counter for the number of degrees of </span></div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;<span class="comment">    freedom in the element, \f$ j_{dof}=0 \f$.</span></div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;<span class="comment">  - Loop over the element&#39;s local nodes \f$ j_{local}=1,...,n\f$</span></div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;<span class="comment">    - Determine the global node number </span></div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;<span class="comment">      \f$ j_{global} = {\cal J}(j_{local},e) \f$</span></div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;<span class="comment">    - Determine the global equation number \f${\cal E}(j_{global})\f$</span></div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;<span class="comment">    - If  \f${\cal E}(j_{global}) \ne -1\f$:</span></div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;<span class="comment">      - Increment the number of degrees of </span></div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;<span class="comment">        freedom  in the element, \f$ j_{dof}=j_{dof}+1\f$</span></div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;<span class="comment">      - Add the entry to the lookup scheme that relates local and</span></div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;<span class="comment">        global equation numbers,</span></div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;<span class="comment">        \f$ \widehat{\cal E}(j_{dof},e) = {\cal E}(j_{global})\f$</span></div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;<span class="comment">      - &lt;TABLE  BORDER=&quot;0&quot;&gt;</span></div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;<span class="comment">        &lt;TR&gt;</span></div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;<span class="comment">        &lt;TD bgcolor=&quot;cornsilk&quot;&gt;</span></div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;<span class="comment">        Store the local equation number associated with the</span></div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;<span class="comment">        current local node: \f$ {\cal L}(j_{local},e)=j_{dof}.\f$</span></div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;<span class="comment">        &lt;/TD&gt;</span></div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;<span class="comment">        &lt;/TR&gt;</span></div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;<span class="comment">        &lt;/TABLE&gt;</span></div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;<span class="comment">    - Else:</span></div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;<span class="comment">      &lt;TABLE  BORDER=&quot;0&quot;&gt;</span></div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;<span class="comment">      &lt;TR&gt;</span></div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;<span class="comment">      &lt;TD bgcolor=&quot;cornsilk&quot;&gt;</span></div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;<span class="comment">      - Set the local equation number associated with the</span></div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;<span class="comment">        current local node to -1 to indicate that it is pinned:</span></div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;<span class="comment">        \f$ {\cal L}(j_{local},e)=-1\f$</span></div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;<span class="comment">      &lt;/TD&gt;</span></div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;<span class="comment">      &lt;/TR&gt;</span></div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;<span class="comment">      &lt;/TABLE&gt;</span></div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;<span class="comment">    .</span></div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;<span class="comment">  - Assign the number of degrees of freedom in the element,</span></div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;<span class="comment">    \f$ {\cal N}_{dof}(e)=j_{dof} \f$</span></div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;<span class="comment">For the 1D problem P1 with two-node elements the elements,</span></div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;<span class="comment">the lookup table \f$ {\cal L}(j_{local},e)\f$ has the following entries:</span></div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;<span class="comment">\f[ \mbox{</span></div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;<span class="comment">    \begin{tabular}{l   l l    l l  l l   l   l l    l l }</span></div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;<span class="comment">    \hline \\</span></div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;<span class="comment">    \mbox{Element $e$} &amp; 1 &amp; &amp; 2 &amp; &amp; 3 &amp; &amp; ... &amp; $N_E-1$ &amp; &amp; $N_E$ &amp; \\</span></div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;<span class="comment">    \hline \\</span></div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;<span class="comment">    \mbox{Local node number $j_{local}$} &amp;</span></div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;<span class="comment">    1 &amp; 2 &amp; 1 &amp; 2 &amp; 1 &amp; 2 &amp;  ... &amp; 1 &amp; 2 &amp; 1 &amp; 2 \\ </span></div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;<span class="comment">    \hline \\</span></div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;<span class="comment">    \mbox{Local equation number ${\cal L}(j_{local},e)$}</span></div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;<span class="comment">     &amp; -1 &amp; 1 &amp; 1 &amp; 2 &amp; 1 &amp; 2 &amp; ... &amp; 1 &amp; 2 &amp; 1 &amp; -1\\</span></div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;<span class="comment">    \hline \\</span></div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;<span class="comment">    \end{tabular}</span></div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;<span class="comment">    }</span></div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;<span class="comment"> \f]</span></div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;<span class="comment">Using this lookup scheme, we revise Algorithm 6 as</span></div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;<span class="comment">follows (only the highlighted regions have changed; we have removed</span></div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;<span class="comment">the initialisation of the &quot;counters&quot; for the equation numbers</span></div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;<span class="comment">since they are no longer computed &quot;on the fly&quot;):</span></div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;<span class="comment"> &lt;CENTER&gt; &lt;B&gt; Algorithm 9: Element-based assembly</span></div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;<span class="comment"> of the residual vector and the Jacobian matrix (revised) &lt;/B&gt; &lt;/CENTER&gt;</span></div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;<span class="comment">- Initialise the global residual vector, \f$ r_j=0 \f$ for \f$j=1,...,M \f$</span></div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;<span class="comment">  and the global Jacobian matrix \f$ J_{jk}=0 \f$ for \f$j,k=1,...,M \f$</span></div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;<span class="comment">- Loop over the elements  \f$ e=1,...,N_E\f$</span></div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;<span class="comment">  \n\n   </span></div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;<span class="comment">  &lt;CENTER&gt; &lt;B&gt; Compute the element&#39;s residual vector and </span></div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;<span class="comment">  Jacobian matrix &lt;/B&gt;  &lt;/CENTER&gt;</span></div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;<span class="comment">  \n</span></div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;<span class="comment">  \f$ \bullet \f$ Determine the number of degrees of freedom in this element,</span></div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;<span class="comment">    \f$ n_{dof}={\cal N}_{dof}(e) \f$. \n</span></div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;<span class="comment">  \f$ \bullet \f$ Loop over the local nodes \f$ j_{local}=1,...,n \f$ \n</span></div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;<span class="comment">  - Determine the global node number </span></div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;<span class="comment">    \f$ j_{global}={\cal J}(j_{local},e)\f$</span></div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;<span class="comment">  - Determine the global equation number \f$ {\cal E}( j_{global}) \f$ \n</span></div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;<span class="comment">    \f$ \bullet \f$ If  \f$ {\cal E}( j_{global}) \ne -1 \f$: \n</span></div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;<span class="comment">    &lt;TABLE  BORDER=&quot;0&quot;&gt;</span></div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;<span class="comment">    &lt;TR&gt;</span></div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;<span class="comment">    &lt;TD bgcolor=&quot;cornsilk&quot;&gt;</span></div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;<span class="comment">    \f$ \bullet \f$ Determine the local equation number from the element&#39;s </span></div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;<span class="comment">       lookup scheme \f$ i_{dof}= {\cal L}(j_{local},e)\f$.</span></div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;<span class="comment">    &lt;/TD&gt;</span></div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;<span class="comment">    &lt;/TR&gt;</span></div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;<span class="comment">    &lt;/TABLE&gt;</span></div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;<span class="comment">    \f$ \bullet \f$ Determine the entry in the element&#39;s residual vector</span></div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;<span class="comment">    \f[ r_{i_{dof}}^{(e)} =</span></div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;<span class="comment">    \int_{e} \left( \frac{\mbox{d} </span></div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;<span class="comment">    u^{(FE)}(x)}{\mbox{d} x} \ </span></div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;<span class="comment">    \frac{\mbox{d} \psi_{j_{global}}(x)}{\mbox{d} x} + </span></div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;<span class="comment">    f(x) \  \psi_{j_{global}}(x) \right)  dx \f]</span></div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;<span class="comment">    \f$ \bullet \f$ Loop over the local nodes \f$ k_{local}=1,...,n \f$</span></div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;<span class="comment">    - Determine the global node number </span></div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;<span class="comment">      \f$ k_{global}={\cal J}(k_{local},e)\f$</span></div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;<span class="comment">    - Determine the global equation number </span></div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;<span class="comment">      \f$ {\cal E}( k_{global}) \f$</span></div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;<span class="comment">    - If  \f$ {\cal E}( k_{global}) \ne -1 \f$:</span></div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;<span class="comment">      &lt;TABLE  BORDER=&quot;0&quot;&gt;</span></div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;<span class="comment">      &lt;TR&gt;</span></div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;<span class="comment">      &lt;TD bgcolor=&quot;cornsilk&quot;&gt;</span></div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;<span class="comment">      - Determine the local equation number from the element&#39;s </span></div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;<span class="comment">        lookup scheme \f$ j_{dof}= {\cal L}(k_{local},e)\f$.</span></div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;<span class="comment">        &lt;/TD&gt;</span></div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;<span class="comment">        &lt;/TR&gt;</span></div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;<span class="comment">        &lt;/TABLE&gt;</span></div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;<span class="comment">      - Determine the entry in the element&#39;s Jacobian matrix</span></div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;<span class="comment">        \f[ J_{i_{dof}j_{dof}}^{(e)} =  </span></div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;<span class="comment">        \int_{e} \left( </span></div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;<span class="comment">        \frac{\mbox{d} \psi_{k_{global}}(x)}{\mbox{d} x} \ </span></div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;<span class="comment">        \frac{\mbox{d} \psi_{j_{global}}(x)}{\mbox{d} x}</span></div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;<span class="comment">        \right) dx \f]</span></div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;<span class="comment">      .</span></div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;<span class="comment">    .</span></div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;<span class="comment">    \n  \n   </span></div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;<span class="comment">     &lt;CENTER&gt; &lt;B&gt; Add the element&#39;s contribution to the global residual</span></div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;<span class="comment">     vector and Jacobian matrix &lt;/B&gt;  &lt;/CENTER&gt;</span></div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;<span class="comment">    \n</span></div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;<span class="comment">  - Loop over the local degrees of freedom \f$ i_{dof}=1,...,n_{dof} \f$</span></div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;<span class="comment">    - Add the element&#39;s contribution to the global residual vector</span></div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;<span class="comment">      \f[ r_{\widehat{\cal E}(i_{dof},e)} =  r_{\widehat{\cal E}(i_{dof},e)} + </span></div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;<span class="comment">              r_{i_{dof}}^{(e)} \f]</span></div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;<span class="comment">    - Loop over the local degrees of freedom \f$ j_{dof}=1,...,n_{dof}\f$</span></div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;<span class="comment">      - Add the element&#39;s contribution to the global Jacobian matrix</span></div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;<span class="comment">        \f[ J_{\widehat{\cal E}(i_{dof},e)\widehat{\cal E}(j_{dof},e) } =  </span></div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;<span class="comment">        J_{\widehat{\cal E}(i_{dof},e)\widehat{\cal E}(j_{dof},e) } + </span></div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;<span class="comment">        J_{i_{dof} j_{dof}}^{(e)} \f]</span></div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;<span class="comment">      .</span></div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;<span class="comment">    .</span></div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;<span class="comment">  .</span></div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;<span class="comment">.</span></div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;<span class="comment">\subsubsection local_coords Local coordinates</span></div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;<span class="comment">Algorithm 9 computes the residual</span></div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;<span class="comment">vector and the Jacobian matrix using an</span></div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;<span class="comment">element-by-element assembly process. The basis functions are still </span></div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;<span class="comment">based on a global</span></div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;<span class="comment">definition (17) that involves </span></div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;<span class="comment">unnecessary references to quantities external to the element. </span></div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;<span class="comment">For example, in element \f$ j \f$</span></div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;<span class="comment">the tests for \f$ x &lt; X_j\f$ and \f$ x &gt; X_{j+1}\f$ in </span></div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;<span class="comment">(17) are</span></div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;<span class="comment">unnecessary because these coordinate ranges are always outside the </span></div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;<span class="comment">element. We shall now develop an alternative, local representation of</span></div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;<span class="comment">the shape functions that involves only quantities that</span></div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;<span class="comment">are intrinsic to each element.  </span></div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;<span class="comment">For this purpose, we introduce a local coordinate \f$s \in [-1,1] \f$ that</span></div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;<span class="comment">parametrises the position \f$ x(s) \f$ within an element so </span></div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;<span class="comment">that (for two-node elements) the local</span></div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;<span class="comment">coordinates \f$s=\pm 1\f$ correspond to local nodes 1 and 2, respectively.</span></div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;<span class="comment">The local linear shape functions</span></div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;<span class="comment">\f[ \psi_1(s) = \frac{1}{2}(1-s) \mbox{\ \ \ and \ \ \ } </span></div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;<span class="comment">    \psi_2(s) = \frac{1}{2}(1+s)\f] </span></div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;<span class="comment">are the natural generalisations of the global shape functions: </span></div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;<span class="comment">- \f$ \psi_j(s) \f$ is equal to 1 at local node j and zero at the </span></div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;<span class="comment">   element&#39;s other node,</span></div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;<span class="comment">- \f$ \psi_j(s) \f$ varies linearly between the nodes. </span></div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;<span class="comment">.</span></div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;<span class="comment">These local shape functions are easily generalised to </span></div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;<span class="comment">elements with a larger number of nodes.</span></div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;<span class="comment">For instance, the local shape functions for a three-node element</span></div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;<span class="comment">whose nodes are distributed uniformly along the element, </span></div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;<span class="comment">are given by</span></div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;<span class="comment">\f[ \psi_1(s) = \frac{1}{2} s (s-1), \ \ \ </span></div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;<span class="comment">    \psi_2(s) = (s+1)(1-s) \mbox{\ \ \ and \ \ \ } </span></div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;<span class="comment">    \psi_3(s) = \frac{1}{2} s (s+1). \f] </span></div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;<span class="comment">We represent the solution within element \f$ e \f$ as</span></div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;<span class="comment">\f[ u^{(FE)}(s) = \sum_{j=1}^n U_{{\cal J}(j,e)} \ \psi_j(s),  \f]</span></div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;<span class="comment">where \f$n\f$ is the number of nodes in the element.</span></div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;<span class="comment">\f$ u \f$ is now represented exclusively in terms of</span></div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;<span class="comment">quantities that are intrinsic to the element: the element&#39;s nodal</span></div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;<span class="comment">values and the local coordinate. The evaluation </span></div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;<span class="comment">of the integrals in algorithm 2 requires the evaluation of </span></div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;<span class="comment">\f$ {\mbox{d} u}/{\mbox{d} x}\f$, rather than </span></div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;<span class="comment">\f$ {\mbox{d} u}/{\mbox{d} s}\f$, and  \f$f(x)\f$ rather than \f$f(s).\f$</span></div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;<span class="comment">In order to evaluate these terms,  we must specify the mapping</span></div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;<span class="comment">\f$ x(s) \f$ between the local  and global coordinates. </span></div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;<span class="comment">The mapping \f$ x(s) \f$ should be one-to-one and </span></div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;<span class="comment">it must interpolate the nodal positions so that in a two-node </span></div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;<span class="comment">element \f$e\f$</span></div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;<span class="comment">\f[ x(s=-1) = X_{{\cal J}(1,e)} \mbox{\ \ \ and \ \ \ }</span></div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;<span class="comment">  x(s=1) = X_{{\cal J}(2,e)}.\f]</span></div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;<span class="comment">There are many mappings that satisfy these</span></div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;<span class="comment">conditions but, within the finite-element context, the simplest</span></div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;<span class="comment">choice is to use the local shape functions themselves by writing</span></div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;<span class="comment">\f[ x(s) = \sum_{j=1}^n X_{{\cal J}(j,e)} \ \psi_j(s).  \f]</span></div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;<span class="comment">This is known as an &quot;isoparametric mapping&quot; because the same (&quot;iso&quot;) </span></div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;<span class="comment">functions are used to interpolate the unknown function \e and the</span></div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;<span class="comment">global coordinates. Derivatives with respect to the global coordinates</span></div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;<span class="comment">can now be evaluated via the chain rule</span></div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;<span class="comment">\f[ \frac{\mbox{d} u}{\mbox{d} x} = \frac{\mbox{d} u}{\mbox{d} s} </span></div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;<span class="comment">     \left(\frac{\mbox{d} x}{\mbox{d} s}\right)^{-1}. \f]</span></div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;<span class="comment">In element \f$ e \f$,</span></div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;<span class="comment">\f[  \frac{\mbox{d} u}{\mbox{d} x} =</span></div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;<span class="comment">     \left(\sum_{j=1}^n U_{{\cal J}(j,e)} \ </span></div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;<span class="comment">     \frac{\mbox{d} \psi_j(s)}{\mbox{d} s}</span></div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;<span class="comment">     \right)</span></div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;<span class="comment">     \left(\sum_{j=1}^n X_{{\cal J}(j,e)} \</span></div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;<span class="comment">     \frac{\mbox{d} \psi_j(s)}{\mbox{d} s}</span></div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;<span class="comment">     \right)^{-1}.</span></div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;<span class="comment">\f] </span></div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;<span class="comment">Finally, integration over the element can be</span></div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;<span class="comment">performed in local coordinates via</span></div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;<span class="comment">\f[ \int_e (...) \ dx = </span></div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;<span class="comment">\int_{-1}^1 (...)\ \widehat{\cal J} \ ds, \f]</span></div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;<span class="comment">where </span></div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;<span class="comment">\f[ \widehat{\cal J} = \frac{\mbox{d} x}{\mbox{d} s} \f]</span></div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;<span class="comment"> is the Jacobian of </span></div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;<span class="comment">the mapping between \f$x\f$ and \f$ s. \f$</span></div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;<span class="comment">Typically the integrands are too complicated to be evaluated</span></div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;<span class="comment">analytically and we use Gauss quadrature rules to evaluate</span></div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;<span class="comment">them numerically. Gauss rules (or any other quadrature rules)</span></div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;<span class="comment">are defined by</span></div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;<span class="comment">- the number of integration points \f$N_{int} \f$,</span></div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;<span class="comment">- the position of the integration points in the element </span></div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;<span class="comment">  \f$S_{i}, \ i=1,...,N_{int} \f$,</span></div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;<span class="comment">- the weights \f$W_{i}, \ i=1,...,N_{int} \f$,</span></div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;<span class="comment">and approximate the integral over the range </span></div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;<span class="comment">\f$ s\in [-1,1]\f$ by the sum</span></div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;<span class="comment">\f[ </span></div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;<span class="comment">\int_{-1}^1 {\cal F}(s)\  ds \approx </span></div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;<span class="comment">\sum_{i=1}^{N_{int}} W_i \ {\cal F}(S_i). \f]</span></div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;<span class="comment">As an example, the integration points and weights for a three-point </span></div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;<span class="comment">Gauss rule are given by</span></div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;<span class="comment">\f[ \mbox{</span></div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;<span class="comment">    \begin{tabular}{l  c  c  c}</span></div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;<span class="comment">    \hline \\</span></div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;<span class="comment">    \mbox{Integration point $i$} &amp; 1 &amp; 2 &amp; 3   \\</span></div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;<span class="comment">    \hline \\</span></div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;<span class="comment">    \mbox{Location $S_i$} &amp; $-\sqrt{3/5}$ &amp; $ 0$ &amp; $\sqrt{3/5}$ \\</span></div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;<span class="comment">    \hline \\</span></div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;<span class="comment">    \mbox{Weight $W_i$} &amp; 5/9 &amp; 8/9 &amp; 5/9 \\</span></div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;<span class="comment">    \hline \\</span></div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;<span class="comment">    \end{tabular}</span></div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;<span class="comment">    }</span></div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;<span class="comment"> \f]</span></div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;<span class="comment"> &lt;HR&gt;</span></div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;<span class="comment">\subsubsection altogether Putting it all together</span></div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;<span class="comment">We have now developed the necessary tools to formulate </span></div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;<span class="comment"> the final version of the finite element solution of problem P1</span></div>
<div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;<span class="comment"> which we summarise in the following algorithm:</span></div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;<span class="comment"> &lt;CENTER&gt; &lt;B&gt; Algorithm 10: The final version of</span></div>
<div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;<span class="comment"> the finite-element solution of problem P1 &lt;/B&gt; &lt;/CENTER&gt;</span></div>
<div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;<span class="comment"> &lt;B&gt; Phase 1: Setup&lt;/B&gt; </span></div>
<div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;<span class="comment"> &lt;B&gt; Phase 1a: Problem specification&lt;/B&gt; </span></div>
<div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;<span class="comment">- Choose the number of elements, \f$ N_E \f$, and the number of </span></div>
<div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;<span class="comment">  nodes per element, \f$ n\f$. This defines the total number of </span></div>
<div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;<span class="comment">  nodes, \f$N\f$, and the local shape functions  </span></div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;<span class="comment">  \f$ \psi_j(s) \ \ (j=1,...,n)\f$  for all elements. </span></div>
<div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;<span class="comment"> &lt;B&gt; Phase 1b: Mesh generation&lt;/B&gt; </span></div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;<span class="comment">- Discretise the domain by specifying the positions </span></div>
<div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;<span class="comment">  \f$ X_j \ (j=1,..,N)\f$,</span></div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;<span class="comment">  of the \f$ N \f$ nodes. </span></div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;<span class="comment">- Generate the lookup scheme \f$ {\cal J}(j,e)\f$ that </span></div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;<span class="comment">   establishes the relation</span></div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;<span class="comment">   between global and local node numbers. </span></div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;<span class="comment">- Identify which nodes are located on which domain boundaries. </span></div>
<div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;<span class="comment"> &lt;B&gt; Phase 1c: &quot;Pin&quot; nodes with essential (Dirichlet) </span></div>
<div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;<span class="comment">     boundary conditions &lt;/B&gt;  </span></div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;<span class="comment">- Loop over all global nodes \f$ j \f$ that are located </span></div>
<div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;<span class="comment">  on Dirichlet boundaries:</span></div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;<span class="comment">  - Assign a negative equation number to reflect the node&#39;s &quot;pinned&quot; </span></div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;<span class="comment">    status:</span></div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;<span class="comment">    \f[ {\cal E}(j) = -1 \f]</span></div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;<span class="comment"> &lt;B&gt; Phase 1d: Apply boundary conditions and provide initial guesses </span></div>
<div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;<span class="comment">     for all unknowns&lt;/B&gt; </span></div>
<div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;<span class="comment">- Loop over all global nodes \f$j=1,...,N\f$:</span></div>
<div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;<span class="comment">   - Provide an initial guess for the unknown nodal value (e.g. </span></div>
<div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;<span class="comment">     \f$ U_j=0 \f$), while ensuring that the values assigned to</span></div>
<div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;<span class="comment">     nodes on the boundary are consistent with the boundary conditions</span></div>
<div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;<span class="comment">     so that  \f$ U_j = g(X_j). \f$</span></div>
<div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;<span class="comment"> &lt;B&gt; Phase 1e: Set up the global equation numbering scheme&lt;/B&gt; </span></div>
<div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;<span class="comment">- Initialise the total number of unknowns, \f$M=0.\f$</span></div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;<span class="comment">- Loop over all global nodes \f$j=1,...,N\f$:</span></div>
<div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;<span class="comment">  - If global node \f$ j \f$ is not pinned</span></div>
<div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;<span class="comment">    (i.e. if \f$ {\cal E}(j) \ne -1 \f$) </span></div>
<div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;<span class="comment">     - Increment the number of unknowns</span></div>
<div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;<span class="comment">        \f[ M=M+1 \f]</span></div>
<div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;<span class="comment">     - Assign the global equation number</span></div>
<div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;<span class="comment">        \f[ {\cal E}(j) = M \f]</span></div>
<div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;<span class="comment"> &lt;B&gt; Phase 1f: Set up the local equation numbering scheme&lt;/B&gt; </span></div>
<div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;<span class="comment">- Loop over the elements  \f$ e=1,...,N_e \f$</span></div>
<div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;<span class="comment">  - Initialise the counter for the number of degrees of </span></div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;<span class="comment">    freedom in this element, \f$ j_{dof}=0 \f$.</span></div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;<span class="comment">  - Loop over the element&#39;s local nodes \f$ j_{local}=1,...,n\f$</span></div>
<div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;<span class="comment">    - Determine the global node number </span></div>
<div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;<span class="comment">      \f$ j_{global} = {\cal J}(j_{local},e) \f$</span></div>
<div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;<span class="comment">    - Determine the global equation number \f${\cal E}(j_{global})\f$</span></div>
<div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;<span class="comment">    - If  \f${\cal E}(j_{global}) \ne -1\f$:</span></div>
<div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;<span class="comment">      - Increment the number of degrees of </span></div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;<span class="comment">        freedom in this element \f$ j_{dof}=j_{dof}+1\f$</span></div>
<div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;<span class="comment">      - Add the entry to the lookup scheme that relates global</span></div>
<div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;<span class="comment">        and local equation numbers,</span></div>
<div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;<span class="comment">        \f$ \widehat{\cal E}(j_{dof},e) = {\cal E}(j_{global})\f$</span></div>
<div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;<span class="comment">      - Store the local equation number associated with the</span></div>
<div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;<span class="comment">        current local node: \f$ {\cal L}(j_{local},e)=j_{dof}.\f$</span></div>
<div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;<span class="comment">      .</span></div>
<div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;<span class="comment">    - Else:</span></div>
<div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;<span class="comment">      - Set the local equation number associated with the</span></div>
<div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;<span class="comment">        current local node to -1 to indicate that it is pinned:</span></div>
<div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;<span class="comment">        \f$ {\cal L}(j_{local},e)=-1\f$</span></div>
<div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;<span class="comment">    .</span></div>
<div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;<span class="comment">  - Assign the number of degrees of freedom in the element</span></div>
<div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;<span class="comment">    \f$ {\cal N}_{dof}(e)=j_{dof} \f$</span></div>
<div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;<span class="comment"> &lt;B&gt; End of setup:&lt;/B&gt; </span></div>
<div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;<span class="comment"> The setup phase is now complete and we can determine the </span></div>
<div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;<span class="comment"> current FE representation of  </span></div>
<div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;<span class="comment"> \f$ u^{(FE)}(x)\f$ and \f$ \mbox{d} u^{(FE)}(x)/\mbox{d} x\f$ </span></div>
<div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;<span class="comment"> in any element \f$e \ (e=1,..,N_E) \f$ from</span></div>
<div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;<span class="comment"> \f[ u = \sum_{j=1}^{n}  U_{{\cal J}(j,e)} \psi_j(s) </span></div>
<div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;<span class="comment">    \mbox{\ \ \ \ \ \ \ \  and \ \ \ \ \ \ \ \ }</span></div>
<div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;<span class="comment">    \frac{\mbox{d} u}{\mbox{d} x} =</span></div>
<div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;<span class="comment">     \left(\sum_{j=1}^n U_{{\cal J}(j,e)}</span></div>
<div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;<span class="comment">     \ \frac{\mbox{d} \psi_j(s)}{\mbox{d} s}</span></div>
<div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;<span class="comment">     \right)</span></div>
<div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;<span class="comment">     \left(\sum_{j=1}^n X_{{\cal J}(j,e)}</span></div>
<div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;<span class="comment">     \ \frac{\mbox{d} \psi_j(s)}{\mbox{d} s}</span></div>
<div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;<span class="comment">     \right)^{-1} \f]</span></div>
<div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;<span class="comment"> Similarly, the global coordinates and their derivatives </span></div>
<div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;<span class="comment"> with respect to the local coordinates are given by</span></div>
<div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;<span class="comment"> \f[ x = \sum_{j=1}^{n}  X_{{\cal J}(j,e)} \psi_j(s) </span></div>
<div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;<span class="comment">    \mbox{\ \ \ \ \ \ \ \  and \ \ \ \ \ \ \ \ }</span></div>
<div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;<span class="comment">    \widehat{\cal J} = \frac{\mbox{d} x}{\mbox{d} s} =</span></div>
<div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;<span class="comment">     \sum_{j=1}^n X_{{\cal J}(j,e)}</span></div>
<div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;<span class="comment">     \ \frac{\mbox{d} \psi_j(s)}{\mbox{d} s}.</span></div>
<div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;<span class="comment"> \f]</span></div>
<div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;<span class="comment"> The derivatives of the local shape functions, \f$ \psi_j \f$, with respect</span></div>
<div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;<span class="comment"> to the global coordinate \f$ x \f$ are</span></div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;<span class="comment">  \f[  \frac{\mbox{d} \psi_j}{\mbox{d} x} =</span></div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;<span class="comment">       \frac{\mbox{d} \psi_j(s)}{\mbox{d} s}  </span></div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;<span class="comment">       \left(\sum_{j=1}^n X_{{\cal J}(j,e)}</span></div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;<span class="comment">       \ \frac{\mbox{d} \psi_j(s)}{\mbox{d} s}</span></div>
<div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;<span class="comment">        \right)^{-1} \mbox{\ \ \ for $j=1,..,n$} </span></div>
<div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;<span class="comment">  \f]</span></div>
<div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;<span class="comment"> &lt;B&gt; Phase 2: Solution  &lt;/B&gt; </span></div>
<div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;<span class="comment"> </span></div>
<div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;<span class="comment"> &lt;B&gt; Phase 2a: Set up the linear system &lt;/B&gt; </span></div>
<div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;<span class="comment">- Initialise the global residual vector, \f$ r_j=0 \f$ for \f$j=1,...,M \f$</span></div>
<div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;<span class="comment">  and the global Jacobian matrix \f$ J_{jk}=0 \f$ for \f$j,k=1,...,M \f$</span></div>
<div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;<span class="comment">- Loop over the elements  \f$ e=1,...,N_E\f$</span></div>
<div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;<span class="comment">  \n\n   </span></div>
<div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;<span class="comment">  &lt;CENTER&gt; &lt;B&gt; Compute the element&#39;s residual vector and </span></div>
<div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;<span class="comment">  Jacobian matrix &lt;/B&gt;  &lt;/CENTER&gt;</span></div>
<div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;<span class="comment">  \n</span></div>
<div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;<span class="comment">  \f$ \bullet \f$ Determine the number of degrees of freedom in this element,</span></div>
<div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;<span class="comment">  \f$ n_{dof}={\cal N}_{dof}(e) \f$. \n</span></div>
<div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;<span class="comment">  \f$ \bullet \f$ Initialise the element residual vector, </span></div>
<div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;<span class="comment">  \f$ r_{j}^{(e)}=0 \f$ for \f$j=1,...,n_{dof} \f$</span></div>
<div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;<span class="comment">  and the element Jacobian matrix \f$ J_{jk}^{(e)}=0 \f$ </span></div>
<div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;<span class="comment">  for \f$j,k=1,...,n_{dof} \f$ \n</span></div>
<div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;<span class="comment">  \f$ \bullet \f$ Loop over the Gauss points \f$</span></div>
<div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;<span class="comment">  i_{int}=1,...,N_{int}\f$ \n</span></div>
<div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;<span class="comment">  - Determine the local coordinate of the integration point</span></div>
<div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;<span class="comment">    \f$ s = S_{i_{int}} \f$ and the associated weight \f$W_{i_{int}}.\f$</span></div>
<div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;<span class="comment">  - Compute \n</span></div>
<div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;<span class="comment">      \f$ \bullet \f$ the global coordinate  \f$ x = x(s) \f$\n</span></div>
<div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;<span class="comment">      \f$ \bullet \f$ the source function    \f$ f = f(x) =f(x(s)) \f$\n</span></div>
<div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;<span class="comment">      \f$ \bullet \f$ the derivative \f$ \mbox{d} u/\mbox{d} x \f$ \n</span></div>
<div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;<span class="comment">      \f$ \bullet \f$ the shape functions  \f$ \psi_j \f$ and their derivatives</span></div>
<div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;<span class="comment">      \f$ \mbox{d} \psi_j/\mbox{d} x \f$\n</span></div>
<div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;<span class="comment">      \f$ \bullet \f$ the Jacobian of the mapping between local and global</span></div>
<div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;<span class="comment">      coordinates, \f$ \widehat{\cal J} = \mbox{d} x/\mbox{d} s\f$\n</span></div>
<div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;<span class="comment">  - Loop over the local nodes \f$ j_{local}=1,...,n \f$</span></div>
<div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;<span class="comment">    - Determine the global node number </span></div>
<div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;<span class="comment">      \f$ j_{global}={\cal J}(j_{local},e)\f$</span></div>
<div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;<span class="comment">    - Determine the global equation number </span></div>
<div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;<span class="comment">      \f$ {\cal E}( j_{global}) \f$</span></div>
<div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;<span class="comment">    - If  \f$ {\cal E}( j_{global}) \ne -1 \f$ \n</span></div>
<div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;<span class="comment">      \f$ \bullet \f$ Determine the local equation number from the element&#39;s </span></div>
<div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;<span class="comment">      lookup scheme \f$ i_{dof}= {\cal L}(j_{local},e)\f$.\n</span></div>
<div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;<span class="comment">      \f$ \bullet \f$ Add the contribution to the element&#39;s residual vector</span></div>
<div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;<span class="comment">      \f[ r_{i_{dof}}^{(e)} = r_{i_{dof}}^{(e)} +</span></div>
<div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;<span class="comment">      \left( \frac{\mbox{d} </span></div>
<div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;<span class="comment">      u}{\mbox{d} x} \ </span></div>
<div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;<span class="comment">      \frac{\mbox{d} \psi_{j_{local}}}{\mbox{d} x} + </span></div>
<div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;<span class="comment">      f \  \psi_{j_{local}} \right) </span></div>
<div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;<span class="comment">      \widehat{\cal J}\  W_{i_{int}} \f]</span></div>
<div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;<span class="comment">      \f$ \bullet \f$ Loop over the local nodes \f$ k_{local}=1,...,n\f$ </span></div>
<div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;<span class="comment">      - Determine the global node number </span></div>
<div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;<span class="comment">        \f$ k_{global}={\cal J}(k_{local},e)\f$</span></div>
<div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;<span class="comment">      - Determine the global equation number </span></div>
<div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;<span class="comment">        \f$ {\cal E}( k_{global}) \f$</span></div>
<div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;<span class="comment">      - If  \f$ {\cal E}( k_{global}) \ne -1 \f$ \n</span></div>
<div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;<span class="comment">        \f$ \bullet \f$ Determine the local equation number from the element&#39;s </span></div>
<div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;<span class="comment">        lookup scheme \f$ j_{dof}= {\cal L}(k_{local},e)\f$.\n</span></div>
<div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;<span class="comment">        \f$ \bullet \f$ Add the contribution to the element&#39;s Jacobian matrix</span></div>
<div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;<span class="comment">        \f[ J_{i_{dof}j_{dof}}^{(e)} = J_{i_{dof}j_{dof}}^{(e)} + </span></div>
<div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;<span class="comment">        \left( </span></div>
<div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;<span class="comment">        \frac{\mbox{d} \psi_{k_{local}}}{\mbox{d} x} \ </span></div>
<div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;<span class="comment">        \frac{\mbox{d} \psi_{j_{local}}}{\mbox{d} x}</span></div>
<div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;<span class="comment">        \right)</span></div>
<div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;<span class="comment">        \widehat{\cal J} \ W_{i_{int}}  \f]</span></div>
<div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;<span class="comment">      .</span></div>
<div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;<span class="comment">    .</span></div>
<div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;<span class="comment">    \n  \n   </span></div>
<div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;<span class="comment">     &lt;CENTER&gt; &lt;B&gt; Add the element&#39;s contribution to the global residual</span></div>
<div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;<span class="comment">     vector and Jacobian matrix &lt;/B&gt;  &lt;/CENTER&gt;</span></div>
<div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;<span class="comment">    \n</span></div>
<div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;<span class="comment">  - Loop over the local degrees of freedom \f$ i_{dof}=1,...,n_{dof} \f$</span></div>
<div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;<span class="comment">    - Add the element&#39;s contribution to the global residual vector</span></div>
<div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;<span class="comment">      \f[ r_{\widehat{\cal E}(i_{dof},e)} =  r_{\widehat{\cal E}(i_{dof},e)} + </span></div>
<div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;<span class="comment">      r_{i_{dof}}^{(e)} \f]</span></div>
<div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;<span class="comment">    - Loop over the local degrees of freedom \f$</span></div>
<div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;<span class="comment">      j_{dof}=1,...,n_{dof}\f$ \n</span></div>
<div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;<span class="comment">      \f$\bullet \f$  Add the element&#39;s contribution to the </span></div>
<div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;<span class="comment">      global Jacobian matrix</span></div>
<div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;<span class="comment">      \f[ J_{\widehat{\cal E}(i_{dof},e)\widehat{\cal E}(j_{dof},e) } =  </span></div>
<div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;<span class="comment">      J_{\widehat{\cal E}(i_{dof},e)\widehat{\cal E}(j_{dof},e) } + </span></div>
<div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;<span class="comment">      J_{i_{dof} j_{dof}}^{(e)} \f]</span></div>
<div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;<span class="comment">    .</span></div>
<div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;<span class="comment">  .</span></div>
<div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;<span class="comment"> &lt;B&gt; Phase 2b: Solve the linear system &lt;/B&gt; </span></div>
<div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;<span class="comment">- Solve the \f$ M \times M\f$ linear system</span></div>
<div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;<span class="comment">  \f[ \sum_{j=1}^{M}  J_{jk} \ y_k = - r_j</span></div>
<div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;<span class="comment">        \mbox{\ \  \ for $j=1,...,M.$} \f]</span></div>
<div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;<span class="comment">  for \f$ y_k \ \ (k=1,...,M).\f$ </span></div>
<div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;<span class="comment"> &lt;B&gt; Phase 2c: Update the initial guess &lt;/B&gt; </span></div>
<div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;<span class="comment">-  Loop over all global nodes \f$ j\f$:</span></div>
<div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;<span class="comment">        - Determine the equation number: \f$ {\cal E}(j) \f$</span></div>
<div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;<span class="comment">        - If \f$ {\cal E}(j) \ne -1 \f$:</span></div>
<div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;<span class="comment">   \f[ U_{{\cal E}(j)} =   U_{{\cal E}(j)} +  y_{{\cal E}(j)} \f] </span></div>
<div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;<span class="comment">- Since P1 is a linear problem, \f$ U_j  \ (j=1,...,N) \f$</span></div>
<div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;<span class="comment">  is the exact solution; if the problem was nonlinear, we would</span></div>
<div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;<span class="comment">  have to continue the \ref Newton iteration until the residuals</span></div>
<div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;<span class="comment">  \f$r_j \ (j=1,...,M) \f$ are sufficiently</span></div>
<div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;<span class="comment">  small.</span></div>
<div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;<span class="comment"> &lt;B&gt; Phase 3: Postprocessing (document the solution)&lt;/B&gt; </span></div>
<div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;<span class="comment">- The finite-element solution in element \f$e\f$ is </span></div>
<div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;<span class="comment">  given by </span></div>
<div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;<span class="comment">  \f[ u = \sum_{j=1}^{n}  U_{{\cal J}(j,e)} \psi_j(s) \f]</span></div>
<div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;<span class="comment"> &lt;HR&gt;</span></div>
<div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;<span class="comment"> \subsubsection example_P1 A 1D example</span></div>
<div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;<span class="comment">Here is an example of the finite element solution of the problem</span></div>
<div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;<span class="comment">P1,</span></div>
<div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;<span class="comment">\f[ \frac{\mbox{d}^2 u}{\mbox{d} x^2} =  \pm 30 \sin(5.5 x), </span></div>
<div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;<span class="comment">  \mbox{\ \ \ subject to $u(0)=0$ and $u(1)=\mp 1$} \f]</span></div>
<div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;<span class="comment">This problem has the (fish-shaped) exact solution</span></div>
<div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;<span class="comment">\f[ u(x) =  \mp </span></div>
<div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;<span class="comment">  \left(\sin(5.5)-1\right) x - \sin(5.5 x).</span></div>
<div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;<span class="comment">The figure below compares the exact solution against the finite-element</span></div>
<div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;<span class="comment">solution, obtained from a discretisation wth ten two-node elements. </span></div>
<div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;<span class="comment">The finite-element solution was computed with \c oomph-lib, using</span></div>
<div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;<span class="comment">the driver codes discussed in the </span></div>
<div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;<span class="comment">&lt;A HREF=&quot;../../quick_guide/html/index.html&quot;&gt;Quick Guide&lt;/A&gt; and</span></div>
<div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;<span class="comment">the example code that illustrates the solution of a </span></div>
<div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;<span class="comment">&lt;A HREF=&quot;../../poisson/one_d_poisson/html/index.html&quot;&gt;1D Poisson equation</span></div>
<div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;<span class="comment">&lt;/A&gt; with elements from the \c oomph-lib element library.</span></div>
<div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;<span class="comment">\image html fish.gif &quot;Exact (green) and finite-element solution (red) obtained with ten two-node elements. &quot; </span></div>
<div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;<span class="comment">\image latex fish.eps &quot;Exact (green) and finite-element solution (red) obtained with ten two-node elements. &quot; width=0.75\textwidth</span></div>
<div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;<span class="comment">\section higher_dims Extension to higher-dimensional problems</span></div>
<div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;<span class="comment">Thus far, we have only discussed the implementation of the finite element</span></div>
<div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;<span class="comment">method for a 1D scalar problem. </span></div>
<div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;<span class="comment">For such (relatively trivial) problems, the sophisticated </span></div>
<div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;<span class="comment">&quot;machinery&quot; of Algorithm 10 might appear to be </span></div>
<div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;<span class="comment">overly complicated.</span></div>
<div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;<span class="comment">The advantage of the algorithm is that it can easily be</span></div>
<div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;<span class="comment">generalised to more complicated problems. We will illustrate this </span></div>
<div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;<span class="comment">by extending the algorithm to higher-dimensional problems and </span></div>
<div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;<span class="comment">consider the solution of the 2D Poisson problem P2 </span></div>
<div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;<span class="comment">\f[ {\cal R}(x_i; u(x_i)) = \frac{\partial^2 u(x_i)}{\partial x_i^2} -</span></div>
<div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;<span class="comment">f(x_i) =0 \mbox{ \ \ \ subject to \ \ \ }  u|_{\partial D} = g, \f]</span></div>
<div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;<span class="comment">in the non-trivial (fish-shaped) domain shown in this sketch:</span></div>
<div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;<span class="comment">\image html fish_domain.gif &quot;Fish-shaped domain &quot; </span></div>
<div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;<span class="comment">\image latex fish_domain.eps &quot;Fish-shaped domain &quot; width=0.75\textwidth</span></div>
<div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;<span class="comment">A careful inspection of Algorithm 10 shows that only </span></div>
<div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;<span class="comment">very few steps</span></div>
<div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;<span class="comment">need to be modified to implement this extension.</span></div>
<div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;<span class="comment">Specifically, we need to</span></div>
<div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;<span class="comment">- modify the mesh generation process so that it</span></div>
<div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;<span class="comment">   - decomposes the domain into 2D elements</span></div>
<div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;<span class="comment">   - assigns two coordinates for each nodal point.</span></div>
<div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;<span class="comment">   .</span></div>
<div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;<span class="comment">- define suitable (local) shape functions for the elements</span></div>
<div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;<span class="comment">- implement the computation of the elements&#39; residuals and </span></div>
<div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;<span class="comment"> Jacobian matrices which correspond to the (integrated-by-parts)</span></div>
<div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;<span class="comment"> weak form of problem P2,</span></div>
<div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;<span class="comment">\f[ r_k = \int_D \sum_{l=1}^2 \frac{\partial  u(x_i)}{\partial x_l} \ </span></div>
<div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;<span class="comment"> \frac{\partial \psi_k(x_i)}{\partial x_l} \  dx_1 dx_2 +</span></div>
<div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;<span class="comment"> \int_D f(x_i) \  \psi_k(x_i) \  dx_1 dx_2 =0. \f]</span></div>
<div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;<span class="comment">There are many ways to decompose the </span></div>
<div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;<span class="comment">2D domain into finite elements. The figure below </span></div>
<div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;<span class="comment">shows a discretisation using four-node quadrilaterals: a generalisation</span></div>
<div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;<span class="comment">of the two-node 1D elements used in problem P1:</span></div>
<div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;<span class="comment">\image html fish_domain_with_mesh.gif &quot;Fish-shaped domain discretised with four-node quadrilateral &quot; </span></div>
<div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;<span class="comment">\image latex fish_domain_with_mesh.eps &quot;Fish-shaped domain discretised with four-node quadrilateral &quot; width=0.75\textwidth</span></div>
<div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;<span class="comment">Each node in the mesh now has two coordinates and we</span></div>
<div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;<span class="comment">denote the \f$i\f$-th coordinate of nodal point \f$j\f$ by</span></div>
<div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;<span class="comment">\f$ X_{ij}\f$ where \f$ i=1,2 \f$.</span></div>
<div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;<span class="comment">We parametrise the 2D elements by two local coordinates,</span></div>
<div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;<span class="comment">\f$ s_i \in [-1,1] \ (i=1,2)\f$, where the local nodes </span></div>
<div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;<span class="comment">1,2,3 and 4 are located </span></div>
<div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;<span class="comment">at \f$(s_1,s_2)=(-1,-1), (1,-1), (-1,1)\f$ and \f$(1,1)\f$, respectively.</span></div>
<div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;<span class="comment">We define the local shape functions as tensor products</span></div>
<div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;<span class="comment">of the corresponding 1D linear shape functions,</span></div>
<div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;<span class="comment">\f[ \psi_1(s_1,s_2) = \frac{1}{4}(1-s_1)(1-s_2) \f]</span></div>
<div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;<span class="comment">\f[ \psi_2(s_1,s_2) = \frac{1}{4}(1+s_1)(1-s_2) \f]</span></div>
<div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;<span class="comment">\f[ \psi_3(s_1,s_2) = \frac{1}{4}(1-s_1)(1+s_2) \f]</span></div>
<div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;<span class="comment">\f[ \psi_4(s_1,s_2) = \frac{1}{4}(1+s_1)(1+s_2), \f]</span></div>
<div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;<span class="comment">and note that shape function \f$ \psi_j(s_1,s_2)\f$ is equal to 1</span></div>
<div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;<span class="comment">at local node \f$j\f$ and it vanishes at the other local nodes, as required.</span></div>
<div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;<span class="comment">The sketch below illustrates the corresponding global shape </span></div>
<div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;<span class="comment">function associated with a node in the interior of the domain:</span></div>
<div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;<span class="comment">\image html fish_domain_with_shape_fct.gif &quot;Discretised fish-shaped domain with a single (global) shape &quot; </span></div>
<div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;<span class="comment">\image latex fish_domain_with_shape_fct.eps &quot;Discretised fish-shaped domain with a single (global) shape &quot; width=0.75\textwidth</span></div>
<div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;<span class="comment">The solution \f$u\f$ and the coordinates</span></div>
<div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;<span class="comment">\f$x_i\f$ in an isoparametric element \f$e\f$ can be written as</span></div>
<div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;<span class="comment">\f[ u = \sum_{j=1}^n U_{{\cal J}(j,e)} \ \psi_j(s_1,s_2) \f]</span></div>
<div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;<span class="comment">and </span></div>
<div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;<span class="comment">\f[ x_i = \sum_{j=1}^n X_{i{\cal J}(j,e)} \  \psi_j(s_1,s_2). \f]</span></div>
<div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;<span class="comment">In 1D, the Jacobian of the mapping between \f$x\f$ and \f$s\f$</span></div>
<div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;<span class="comment">is given by \f$ \widehat{\cal J} = dx/ds\f$; in 2D the derivatives </span></div>
<div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;<span class="comment">transform according to the linear system</span></div>
<div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;<span class="comment">\left(</span></div>
<div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;<span class="comment">\begin{array}{c}</span></div>
<div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;<span class="comment"> \frac{\partial }{\partial s_1} \\ </span></div>
<div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;<span class="comment"> \frac{\partial }{\partial s_2}</span></div>
<div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;<span class="comment"> \end{array}</span></div>
<div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;<span class="comment">\right)</span></div>
<div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;<span class="comment">= </span></div>
<div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;<span class="comment">\left(</span></div>
<div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;<span class="comment">\begin{array}{cc}</span></div>
<div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;<span class="comment"> \frac{\partial x_1 }{\partial s_1} &amp; \frac{\partial x_2}{\partial s_1} \\ </span></div>
<div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;<span class="comment"> \frac{\partial x_1 }{\partial s_2} &amp; \frac{\partial x_2}{\partial s_2}</span></div>
<div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;<span class="comment"> \end{array}</span></div>
<div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;<span class="comment">\right)</span></div>
<div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;<span class="comment">\left(</span></div>
<div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;<span class="comment">\begin{array}{c}</span></div>
<div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;<span class="comment"> \frac{\partial }{\partial x_1} \\ </span></div>
<div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;<span class="comment"> \frac{\partial }{\partial x_2}</span></div>
<div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;<span class="comment"> \end{array}</span></div>
<div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;<span class="comment">\right),</span></div>
<div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;<span class="comment">and</span></div>
<div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;<span class="comment">\frac{\partial u}{\partial x_i} = \widehat{\cal J}_{ij}^{-1}</span></div>
<div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;<span class="comment">\frac{\partial u}{\partial s_j}</span></div>
<div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;<span class="comment">where \f$ \widehat{\cal J}_{ij}^{-1} \f$ is the inverse of the Jacobian</span></div>
<div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;<span class="comment">of the mapping (not to be confused with the Jacobian matrix in the Newton </span></div>
<div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;<span class="comment">method!),</span></div>
<div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;<span class="comment"> \widehat{\cal J}_{ij} = \frac{\partial x_i}{\partial s_j} = </span></div>
<div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;<span class="comment"> \sum_{k=1}^n X_{i{\cal J}(k,e)}</span></div>
<div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;<span class="comment"> \frac{\partial \psi_k(s_1,s_2)}{\partial s_j}.</span></div>
<div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;<span class="comment">If</span></div>
<div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;<span class="comment"> \widehat{\cal J} = \det \widehat{\cal J}_{ij}</span></div>
<div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;<span class="comment">then the integrals over the elements are</span></div>
<div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;<span class="comment">\int \int_e (...) \ dx_1 dx_2 =  </span></div>
<div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;<span class="comment">\int_{-1}^{1} \int_{-1}^{1} (...) \ \widehat{\cal J} \ ds_1 ds_2.</span></div>
<div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;<span class="comment">The integrals over the elements can be evaluated by 2D</span></div>
<div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;<span class="comment">Gauss rules</span></div>
<div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;<span class="comment">\f[ \int_{-1}^1  \int_{-1}^1 {\cal F}(s_1,s_2) \ ds_1 ds_2</span></div>
<div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;<span class="comment">\approx \sum_{i=1}^{N_{int}} {\cal F}(S_{i1},S_{i2}) \ W_{i},  \f]</span></div>
<div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;<span class="comment">where, for quadrilateral elements the integration points </span></div>
<div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;<span class="comment">\f$S_{i1},S_{i2} \ (i=1,...,N_{int})\f$ and weights</span></div>
<div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;<span class="comment">\f$ W_{i} \ (i=1,...,N_{int})\f$ are given by tensor </span></div>
<div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;<span class="comment">products of the corresponding quantities in the 1D Gauss rules.</span></div>
<div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;<span class="comment">\subsection example_P2 A 2D example</span></div>
<div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;<span class="comment">Here is an example of the finite element solution of problem</span></div>
<div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;<span class="comment">P2,</span></div>
<div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;<span class="comment">\f[ \sum_{j=1}^2 \frac{\partial^2 u(x_i)}{\partial x_j^2} = f(x_i), </span></div>
<div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;<span class="comment">  \mbox{\ \ \ subject to $u|_{\partial D}=0$} \f]</span></div>
<div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;<span class="comment">for</span></div>
<div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;<span class="comment">\f[  f(x_i) = -1\f]</span></div>
<div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;<span class="comment">in the fish-shaped domain.</span></div>
<div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;<span class="comment">\image html fish_poisson_soln.gif &quot;(Adaptive) solution of Poisson&#39;s equation in a 2D fish-shaped domain. &quot; </span></div>
<div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;<span class="comment">\image latex fish_poisson_soln.eps &quot;(Adaptive) solution of Poisson&#39;s equation in a 2D fish-shaped domain. &quot; width=0.75\textwidth</span></div>
<div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;<span class="comment">The solution was computed with \c oomph-lib, using a </span></div>
<div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;<span class="comment">&lt;A HREF=&quot;../../poisson/fish_poisson/html/index.html&quot;&gt;driver code&lt;/A&gt;</span></div>
<div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;<span class="comment">discussed elsewhere. Initially, the solution is computed on a</span></div>
<div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;<span class="comment">very coarse mesh which contains only four nine-node elements. Then </span></div>
<div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;<span class="comment">the mesh is adaptively refined, guided by an</span></div>
<div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;<span class="comment">automatic error estimator, and the problem is re-solved. This procedure</span></div>
<div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;<span class="comment">is repeated several times. Note how the adaptation</span></div>
<div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;<span class="comment">refines the mesh predominantly near the inward corners where the</span></div>
<div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;<span class="comment">solution has an unbounded gradient and is therefore (always) under-resolved.</span></div>
<div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;<span class="comment">\section towards_oo An object-oriented implementation</span></div>
<div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;<span class="comment">The steps described in Algorithm 10 can</span></div>
<div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;<span class="comment">easily be implemented in a procedural language such as</span></div>
<div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;<span class="comment">Fortran or C. The algorithm already contains</span></div>
<div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;<span class="comment">a number of well-defined phases, which lend themselves to</span></div>
<div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;<span class="comment">implementation as subroutines/functions. The various (global) </span></div>
<div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;<span class="comment">parameters (the number of nodes and elements, etc) and lookup schemes </span></div>
<div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;<span class="comment">(the relation between local and global equation numbers,</span></div>
<div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;<span class="comment">the number of unknowns per element, etc.) generated</span></div>
<div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;<span class="comment">during the setup phase would usually be passed to the subroutines</span></div>
<div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;<span class="comment">(or functions) via common blocks (or </span></div>
<div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;<span class="comment">&lt;A HREF=&quot;http://c2.com/cgi/wiki?GlobalVariablesAreBad&quot;&gt;</span></div>
<div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;<span class="comment">(bad!) global data&lt;/A&gt;). </span></div>
<div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;<span class="comment">We shall now discuss \c oomph-lib&#39;s object-oriented implementation of the</span></div>
<div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;<span class="comment">finite-element method. We begin </span></div>
<div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;<span class="comment">by examining the &quot;objects&quot; that occur</span></div>
<div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;<span class="comment">naturally in algorithm 10 and aim to re-distribute</span></div>
<div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;<span class="comment">all global data so that it becomes member data of an appropriate </span></div>
<div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;<span class="comment">object. Three &quot;objects&quot; already feature prominently in many parts of </span></div>
<div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;<span class="comment">our algorithms: </span></div>
<div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;<span class="comment">- the Nodes,</span></div>
<div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;<span class="comment">- the Elements,</span></div>
<div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;<span class="comment">- the Mesh.</span></div>
<div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;<span class="comment">In the procedural version of the algorithm, </span></div>
<div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;<span class="comment">data associated with Nodes is </span></div>
<div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;<span class="comment">stored in global arrays. </span></div>
<div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;<span class="comment">For instance, \f$ X_{ij}\f$  stores the</span></div>
<div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;<span class="comment">\f$i\f$-th coordinate of global node \f$ j \f$; similarly, </span></div>
<div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;<span class="comment">\f$ U_{j} \f$ stores the nodal value at </span></div>
<div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;<span class="comment">global node \f$j\f$; etc. Nodal positions and values are accessed</span></div>
<div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;<span class="comment">either directly via their global node number (which identifies</span></div>
<div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;<span class="comment">Nodes within the Mesh) or indirectly via their local node number</span></div>
<div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;<span class="comment">within an Element. The latter requires the global lookup scheme</span></div>
<div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;<span class="comment">\f$ J(j_{local},e)\f$ which determines the global node </span></div>
<div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;<span class="comment">number of local Node \f$j_{local}\f$ in Element \f$e\f$. </span></div>
<div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;<span class="comment">In \c oomph-lib&#39;s object-oriented implementation, all nodal data is stored</span></div>
<div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;<span class="comment">as member data of a Node object. Each Node stores</span></div>
<div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;<span class="comment">- a (vector of) coordinates, and</span></div>
<div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;<span class="comment">- a nodal value</span></div>
<div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;<span class="comment">.</span></div>
<div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;<span class="comment">as private member data. Access to these data </span></div>
<div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;<span class="comment">is provided by member functions, e.g.</span></div>
<div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;<span class="comment">\code</span></div>
<div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;<span class="comment">Node node;</span></div>
<div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;<span class="comment">double x_coord=node.x(0);</span></div>
<div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;<span class="comment">double y_coord=node.x(1);</span></div>
<div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;<span class="comment">\endcode</span></div>
<div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;<span class="comment">[Note the C++ convention of starting indices at 0, rather than 1!]</span></div>
<div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;<span class="comment">The Node object does \b not store a node number! This is because </span></div>
<div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;<span class="comment">node numbers are only used to identify Nodes in specific contexts. </span></div>
<div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;<span class="comment">For instance, as discussed above, the global node number identifies </span></div>
<div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;<span class="comment">Nodes within the context of the global Mesh. Instead, we </span></div>
<div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;<span class="comment">provide the Mesh object with a member function \c Mesh::node_pt(...)</span></div>
<div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;<span class="comment">which provides pointer-based access to its constituent Nodes:</span></div>
<div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;<span class="comment">\code</span></div>
<div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;<span class="comment">unsigned j;</span></div>
<div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;<span class="comment">Mesh mesh;</span></div>
<div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;<span class="comment">Node* node_pt=mesh.node_pt(j);</span></div>
<div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;<span class="comment">\endcode</span></div>
<div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;<span class="comment">Thus, we obtain the \f$x\f$-coordinate of global node \f$j\f$ via</span></div>
<div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;<span class="comment">\code</span></div>
<div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;<span class="comment">unsigned j;</span></div>
<div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;<span class="comment">Mesh mesh;</span></div>
<div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;<span class="comment">double x=mesh.node_pt(j)-&gt;x(0);</span></div>
<div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;<span class="comment">\endcode</span></div>
<div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;<span class="comment">Similarly, rather than determining the coordinates of local </span></div>
<div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;<span class="comment">node \f$j_{local}\f$ in element \f$e\f$ via the global lookup scheme</span></div>
<div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;<span class="comment">\f[ x_i = X_{iJ(j_{local},e)}, \f]</span></div>
<div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;<span class="comment">we provide each \c FiniteElement with a member function</span></div>
<div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;<span class="comment">that provides pointer-based access to its constituent Nodes</span></div>
<div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;<span class="comment">\code</span></div>
<div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;<span class="comment">unsigned j_local;</span></div>
<div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;<span class="comment">FiniteElement element;</span></div>
<div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;<span class="comment">Node* node_pt=element.node_pt(j_local);</span></div>
<div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;<span class="comment">\endcode</span></div>
<div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;<span class="comment">Similar procedures can be implemented for all other objects. We use</span></div>
<div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;<span class="comment">the general design principle that all objects store only their </span></div>
<div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;<span class="comment">&quot;own&quot; intrinsic data and we replace all global lookup schemes</span></div>
<div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;<span class="comment">by pointer-based access functions. To guide the implementation, we</span></div>
<div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160;<span class="comment">observe the following inter-dependence between our three</span></div>
<div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160;<span class="comment">fundamental objects:</span></div>
<div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;<span class="comment">- \b The \b Nodes: Nodes have positions and values. The nodal values </span></div>
<div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;<span class="comment">  are either &quot;pinned&quot; or &quot;free&quot;, in which case they </span></div>
<div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;<span class="comment">  represent unknowns in the problem.</span></div>
<div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;<span class="comment">  The &quot;pinned status&quot; of a Node is indicated by its global equation </span></div>
<div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;<span class="comment">  number, either a unique non-negative number, for unknowns, </span></div>
<div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;<span class="comment">  or -1, for values that are &quot;pinned&quot;. Note that this convention </span></div>
<div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;<span class="comment">  makes &quot;-1&quot; a &quot;magic number&quot; -- bad practice! In \c oomph-lib, we</span></div>
<div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;<span class="comment">  set the equation number of pinned Nodes to \c Node::Is_pinned --</span></div>
<div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;<span class="comment">  a static data member of the Node class that is, in fact, set to -1.</span></div>
<div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;<span class="comment">- \b The \b Elements: Elements contain Nodes and, within an Element,</span></div>
<div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;<span class="comment">  Nodes are identified by their local node numbers.</span></div>
<div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;<span class="comment">  Elements define their (local) shape functions and compute</span></div>
<div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;<span class="comment">  the elemental residual vector and Jacobian matrix, using data </span></div>
<div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;<span class="comment">  that is intrinsic to the Element. The entries in the Element&#39;s </span></div>
<div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;<span class="comment">  residual vector and its Jacobian matrix are labelled by local </span></div>
<div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;<span class="comment">  equation numbers, and each element stores a lookup scheme </span></div>
<div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;<span class="comment">  for the correspondence between local and global equation numbers.</span></div>
<div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;<span class="comment">- \b The \b Mesh: The Mesh consists of Elements and Nodes. The mesh </span></div>
<div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;<span class="comment">  generation process defines the nodal positions and establishes </span></div>
<div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;<span class="comment">  the connectivity between the Nodes. Meshes typically have a number </span></div>
<div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;<span class="comment">  of boundaries and the Mesh defines which Nodes are located on which </span></div>
<div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;<span class="comment">  boundary. Nodes are identified by a global node number within the Mesh.</span></div>
<div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;<span class="comment">An important difference between the three fundamental objects</span></div>
<div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;<span class="comment">is the degree to which their member functions can be</span></div>
<div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160;<span class="comment">implemented in complete generality. For instance,</span></div>
<div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160;<span class="comment">the Node object is completely generic -- there is only one type of Node,</span></div>
<div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160;<span class="comment">allowing the Node class to be fully implemented (as a &quot;concrete class&quot;,</span></div>
<div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160;<span class="comment">in C++ terminology) in \c oomph-lib.</span></div>
<div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160;<span class="comment">Conversely, although all Meshes have a certain amount of common functionality</span></div>
<div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160;<span class="comment">(e.g. they all provide pointer-based access to their constituent</span></div>
<div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160;<span class="comment">nodes), the implementation of other functions are Mesh-specific. </span></div>
<div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160;<span class="comment">For instance, the Mesh generation process itself (typically </span></div>
<div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160;<span class="comment">performed in the Mesh constructor) depends on the domain geometry, the </span></div>
<div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160;<span class="comment">topology of its elements etc. Such functions must be implemented </span></div>
<div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;<span class="comment">differently in different Meshes. \c oomph-lib therefore provides an abstract</span></div>
<div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;<span class="comment">base class \c Mesh, which defines and implements all functions that</span></div>
<div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;<span class="comment">are common to all Meshes. The class also defines a number of </span></div>
<div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160;<span class="comment">virtual functions to establish standard interfaces </span></div>
<div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;<span class="comment">for functions that can only be implemented</span></div>
<div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160;<span class="comment">in a concrete (derived) class, such as \c FishMesh.</span></div>
<div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160;<span class="comment">The same principle applies to Elements which we endow with</span></div>
<div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160;<span class="comment">a three-level inheritance structure:</span></div>
<div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;<span class="comment">- The abstract base class \c GeneralisedElement defines the</span></div>
<div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;<span class="comment">  common functionality that \e all Elements must have.</span></div>
<div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160;<span class="comment">  All Elements must have member functions that compute the elemental </span></div>
<div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160;<span class="comment">  Jacobian matrix and the</span></div>
<div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;<span class="comment">  elemental residual vector. The distinction </span></div>
<div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160;<span class="comment">  between \c GeneralisedElements and \c FiniteElements is</span></div>
<div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160;<span class="comment">  useful because many elements in \c oomph-lib are not finite elements, </span></div>
<div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160;<span class="comment">  and, for instance, do not have nodes.</span></div>
<div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160;<span class="comment">- The abstract base class \c FiniteElement is derived from </span></div>
<div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160;<span class="comment">  \c GeneralisedElement and defines the common functionality</span></div>
<div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;<span class="comment">  that is shared by all finite elements. The \c FiniteElement class </span></div>
<div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160;<span class="comment">  implements all functions that are generic for finite elements</span></div>
<div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160;<span class="comment">  and specifies the interfaces for any remaining functions</span></div>
<div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160;<span class="comment">  that cannot be implemented in complete generality. For instance,</span></div>
<div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160;<span class="comment">  all finite elements have shape functions but their implementation</span></div>
<div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;<span class="comment">  depends on the geometry of the element.</span></div>
<div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160;<span class="comment">- Finally, we have concrete Elements that are derived from </span></div>
<div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160;<span class="comment">  \c FiniteElement</span></div>
<div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;<span class="comment">  and implement any virtual functions defined at lower levels; these</span></div>
<div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;<span class="comment">  Elements provide a specific discretisation of a specific PDE. </span></div>
<div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;<span class="comment">  The \c QPoissonElement&lt;3,2&gt; implements, inter alia, </span></div>
<div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;<span class="comment">  the computation of the element residual</span></div>
<div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160;<span class="comment">  and the element Jacobian matrix for the 2D Poisson equation,</span></div>
<div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;<span class="comment">  in a nine-node quadrilateral element. </span></div>
<div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;<span class="comment">  [\b Note: In many cases, it is useful to sub-divide this</span></div>
<div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;<span class="comment">  level further by introducing an intermediate class that</span></div>
<div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160;<span class="comment">  implements only the Element geometry;</span></div>
<div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;<span class="comment">  motivated by the observation that a specific (geometric) Element type</span></div>
<div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160;<span class="comment">  (e.g. a 2D quadrilateral element) can form the basis for many different </span></div>
<div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;<span class="comment">  concrete Elements, e.g. Elements that solve the Poisson, </span></div>
<div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160;<span class="comment">  Advection-Diffusion or Navier-Stokes equations. Examples </span></div>
<div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160;<span class="comment">  of &quot;geometric Elements&quot; in \c oomph-lib include the \c QElements,</span></div>
<div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160;<span class="comment">  a family of 1D line/2D quad/3D brick elements with</span></div>
<div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160;<span class="comment">  linear (or {bi/tri}linear), quadratic (or {bi/tri}quadratic),...</span></div>
<div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160;<span class="comment">  shape functions.]</span></div>
<div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160;<span class="comment"> </span></div>
<div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160;<span class="comment"> Algorithm 10 can easily be expressed in an </span></div>
<div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160;<span class="comment"> object-oriented </span></div>
<div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160;<span class="comment"> form because most steps involve operations that act exclusively </span></div>
<div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160;<span class="comment"> on the objects&#39; member data. Such operations are </span></div>
<div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160;<span class="comment"> implemented as member functions of the appropriate objects.</span></div>
<div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160;<span class="comment"> </span></div>
<div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160;<span class="comment"> The steps in  Algorithm 10 that do not </span></div>
<div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160;<span class="comment"> fall into this category (the application of </span></div>
<div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160;<span class="comment"> boundary conditions, setting of initial conditions and boundary values,</span></div>
<div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160;<span class="comment"> etc) are usually problem-dependent and cannot be implemented </span></div>
<div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;<span class="comment"> in generality. However, certain steps (e.g. the </span></div>
<div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;<span class="comment"> solution of the nonlinear algebraic equations by Newton&#39;s method)</span></div>
<div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160;<span class="comment"> are identical for all problems and should be implemented in a</span></div>
<div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160;<span class="comment"> general form. For this purpose, we introduce a fourth fundamental</span></div>
<div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160;<span class="comment"> object, \b The \b Problem, an abstract base class that provides</span></div>
<div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;<span class="comment"> member functions for generic procedures such as</span></div>
<div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160;<span class="comment"> - setting up the equation numbering scheme</span></div>
<div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160;<span class="comment"> - solving the equations by Newton&#39;s method</span></div>
<div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160;<span class="comment"> and stores</span></div>
<div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160;<span class="comment"> - a pointer to the Mesh object</span></div>
<div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160;<span class="comment"> - a vector of pointers to the unknowns which must be updated</span></div>
<div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160;<span class="comment">   during the solution of the nonlinear system by Newton&#39;s method.</span></div>
<div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160;<span class="comment"> Concrete problems, such as the \c FishPoissonProblem discussed above,</span></div>
<div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160;<span class="comment"> should be derived from the abstract \c Problem class. </span></div>
<div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160;<span class="comment"> Any problem-specific steps can </span></div>
<div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160;<span class="comment"> be implemented in member functions of the derived class, often the</span></div>
<div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160;<span class="comment"> constructor.</span></div>
<div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160;<span class="comment">Here is an overview of overall data structure, as required by the</span></div>
<div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160;<span class="comment">Poisson problems described above. The complete data structure</span></div>
<div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160;<span class="comment">implemented in \c oomph-lib contains numerous extensions to permit the</span></div>
<div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160;<span class="comment">solution of time-dependent problems, problems with many nodal values, </span></div>
<div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160;<span class="comment">problems in deforming domains, adaptive mesh refinement and many</span></div>
<div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160;<span class="comment">other features. A complete description of </span></div>
<div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160;<span class="comment">&lt;a href=&quot;../../the_data_structure/html/index.html&quot;&gt; the data</span></div>
<div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160;<span class="comment">structure &lt;/a&gt; is given elsewhere.</span></div>
<div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;<span class="comment">&lt;CENTER&gt;</span></div>
<div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;<span class="comment">&lt;TABLE bgcolor=&quot;pink&quot;&gt;</span></div>
<div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160;<span class="comment">&lt;TR&gt;</span></div>
<div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160;<span class="comment">&lt;TD&gt;</span></div>
<div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160;<span class="comment">&lt;CENTER&gt;</span></div>
<div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160;<span class="comment">&lt;TABLE bgcolor=&quot;cornsilk&quot;&gt;</span></div>
<div class="line"><a name="l02362"></a><span class="lineno"> 2362</span>&#160;<span class="comment">&lt;TR&gt;</span></div>
<div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160;<span class="comment">&lt;TD&gt;</span></div>
<div class="line"><a name="l02364"></a><span class="lineno"> 2364</span>&#160;<span class="comment">&lt;CENTER&gt;</span></div>
<div class="line"><a name="l02365"></a><span class="lineno"> 2365</span>&#160;<span class="comment">&lt;B&gt;Data:&lt;/B&gt;</span></div>
<div class="line"><a name="l02366"></a><span class="lineno"> 2366</span>&#160;<span class="comment">&lt;/CENTER&gt;</span></div>
<div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160;<span class="comment">- Stores and provides access to:</span></div>
<div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160;<span class="comment">  - (pointers to) to values ( = double precision numbers). </span></div>
<div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160;<span class="comment">  - (pointers to) the global equation numbers for all values.</span></div>
<div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160;<span class="comment">- Defines and implements the functions that:</span></div>
<div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160;<span class="comment">  - allow pinning and unpinning of the values.</span></div>
<div class="line"><a name="l02372"></a><span class="lineno"> 2372</span>&#160;<span class="comment">  - assign global equation numbers to all unknown values.</span></div>
<div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160;<span class="comment">&lt;/TD&gt;</span></div>
<div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160;<span class="comment">&lt;/TR&gt;</span></div>
<div class="line"><a name="l02375"></a><span class="lineno"> 2375</span>&#160;<span class="comment">&lt;/TABLE&gt;</span></div>
<div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160;<span class="comment">&lt;TABLE bgcolor=&quot;cornsilk&quot;&gt;</span></div>
<div class="line"><a name="l02377"></a><span class="lineno"> 2377</span>&#160;<span class="comment">&lt;TR&gt;</span></div>
<div class="line"><a name="l02378"></a><span class="lineno"> 2378</span>&#160;<span class="comment">&lt;TD&gt;</span></div>
<div class="line"><a name="l02379"></a><span class="lineno"> 2379</span>&#160;<span class="comment">&lt;CENTER&gt;</span></div>
<div class="line"><a name="l02380"></a><span class="lineno"> 2380</span>&#160;<span class="comment">&lt;B&gt;Node:&lt;/B&gt; &lt;BR&gt;[derived from \b Data]</span></div>
<div class="line"><a name="l02381"></a><span class="lineno"> 2381</span>&#160;<span class="comment">&lt;/CENTER&gt;</span></div>
<div class="line"><a name="l02382"></a><span class="lineno"> 2382</span>&#160;<span class="comment">- Stores and provides access to:</span></div>
<div class="line"><a name="l02383"></a><span class="lineno"> 2383</span>&#160;<span class="comment">  - the spatial dimension of the Node.</span></div>
<div class="line"><a name="l02384"></a><span class="lineno"> 2384</span>&#160;<span class="comment">  - the Eulerian coordinates of the Node.</span></div>
<div class="line"><a name="l02385"></a><span class="lineno"> 2385</span>&#160;<span class="comment">&lt;/TD&gt;</span></div>
<div class="line"><a name="l02386"></a><span class="lineno"> 2386</span>&#160;<span class="comment">&lt;/TR&gt;</span></div>
<div class="line"><a name="l02387"></a><span class="lineno"> 2387</span>&#160;<span class="comment">&lt;/TABLE&gt;</span></div>
<div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160;<span class="comment">&lt;/TD&gt;</span></div>
<div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160;<span class="comment">&lt;/TR&gt;</span></div>
<div class="line"><a name="l02390"></a><span class="lineno"> 2390</span>&#160;<span class="comment">&lt;/TABLE&gt;</span></div>
<div class="line"><a name="l02391"></a><span class="lineno"> 2391</span>&#160;<span class="comment">&lt;/CENTER&gt;</span></div>
<div class="line"><a name="l02392"></a><span class="lineno"> 2392</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02393"></a><span class="lineno"> 2393</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02394"></a><span class="lineno"> 2394</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160;<span class="comment">&lt;TABLE bgcolor=&quot;pink&quot;&gt;</span></div>
<div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160;<span class="comment">&lt;TR&gt;</span></div>
<div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160;<span class="comment">&lt;TD&gt;</span></div>
<div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160;<span class="comment">&lt;CENTER&gt;</span></div>
<div class="line"><a name="l02399"></a><span class="lineno"> 2399</span>&#160;<span class="comment">&lt;TABLE bgcolor=&quot;cornsilk&quot;&gt;</span></div>
<div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160;<span class="comment">&lt;TR&gt;</span></div>
<div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160;<span class="comment">&lt;TD&gt;</span></div>
<div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160;<span class="comment">&lt;CENTER&gt;</span></div>
<div class="line"><a name="l02403"></a><span class="lineno"> 2403</span>&#160;<span class="comment">&lt;B&gt;GeneralisedElement:&lt;/B&gt;</span></div>
<div class="line"><a name="l02404"></a><span class="lineno"> 2404</span>&#160;<span class="comment">&lt;/CENTER&gt;</span></div>
<div class="line"><a name="l02405"></a><span class="lineno"> 2405</span>&#160;<span class="comment">- Stores and provides access to:</span></div>
<div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160;<span class="comment">  - the lookup scheme that stores the correspondence between</span></div>
<div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160;<span class="comment">    local and global equation numbers.</span></div>
<div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160;<span class="comment">- Defines interfaces for the (virtual) functions that:</span></div>
<div class="line"><a name="l02409"></a><span class="lineno"> 2409</span>&#160;<span class="comment">  - compute the element&#39;s residual vector and Jacobian matrix [\b V1].</span></div>
<div class="line"><a name="l02410"></a><span class="lineno"> 2410</span>&#160;<span class="comment">- Defines and implements functions that:</span></div>
<div class="line"><a name="l02411"></a><span class="lineno"> 2411</span>&#160;<span class="comment">  - return the global equation number for a given local unknown.</span></div>
<div class="line"><a name="l02412"></a><span class="lineno"> 2412</span>&#160;<span class="comment">  - return the number of degrees of freedom (= the total number of </span></div>
<div class="line"><a name="l02413"></a><span class="lineno"> 2413</span>&#160;<span class="comment">    unknowns) in the element. </span></div>
<div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160;<span class="comment">&lt;/TD&gt;</span></div>
<div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160;<span class="comment">&lt;/TR&gt;</span></div>
<div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160;<span class="comment">&lt;/TABLE&gt;</span></div>
<div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160;<span class="comment">&lt;/CENTER&gt;</span></div>
<div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160;<span class="comment">&lt;CENTER&gt;</span></div>
<div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160;<span class="comment">&lt;TABLE bgcolor=&quot;cornsilk&quot;&gt;</span></div>
<div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160;<span class="comment">&lt;TR&gt;</span></div>
<div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160;<span class="comment">&lt;TD&gt;</span></div>
<div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160;<span class="comment">&lt;CENTER&gt;</span></div>
<div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160;<span class="comment">&lt;B&gt;FiniteElement:&lt;/B&gt;  &lt;BR&gt;[derived from \b GeneralisedElement]</span></div>
<div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160;<span class="comment">&lt;/CENTER&gt;</span></div>
<div class="line"><a name="l02425"></a><span class="lineno"> 2425</span>&#160;<span class="comment">- Stores and provides access to:</span></div>
<div class="line"><a name="l02426"></a><span class="lineno"> 2426</span>&#160;<span class="comment">  - (pointers to) the \c Nodes. </span></div>
<div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160;<span class="comment">  - (a pointer to) the spatial integration scheme.</span></div>
<div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160;<span class="comment">  - the lookup scheme that stores the local equation number of the  </span></div>
<div class="line"><a name="l02429"></a><span class="lineno"> 2429</span>&#160;<span class="comment">    values stored at the \c Nodes.</span></div>
<div class="line"><a name="l02430"></a><span class="lineno"> 2430</span>&#160;<span class="comment">- Defines interfaces for the (virtual) functions that:</span></div>
<div class="line"><a name="l02431"></a><span class="lineno"> 2431</span>&#160;<span class="comment">  - specify the dimension of the element (i.e. the number of local</span></div>
<div class="line"><a name="l02432"></a><span class="lineno"> 2432</span>&#160;<span class="comment">    coordinates needed to parametrise its shape -- this may differ</span></div>
<div class="line"><a name="l02433"></a><span class="lineno"> 2433</span>&#160;<span class="comment">    from the spatial dimension of its \c Nodes!) [\b V2]</span></div>
<div class="line"><a name="l02434"></a><span class="lineno"> 2434</span>&#160;<span class="comment">  - specify the shape functions and their derivatives with respect</span></div>
<div class="line"><a name="l02435"></a><span class="lineno"> 2435</span>&#160;<span class="comment">    to the local coordinates [\b V3]</span></div>
<div class="line"><a name="l02436"></a><span class="lineno"> 2436</span>&#160;<span class="comment">  - specify the number of nodal values that should be stored</span></div>
<div class="line"><a name="l02437"></a><span class="lineno"> 2437</span>&#160;<span class="comment">    at each node, etc. [\b V4]</span></div>
<div class="line"><a name="l02438"></a><span class="lineno"> 2438</span>&#160;<span class="comment">- Defines and implements functions that:</span></div>
<div class="line"><a name="l02439"></a><span class="lineno"> 2439</span>&#160;<span class="comment">  - construct \c Nodes of the required spatial dimension,</span></div>
<div class="line"><a name="l02440"></a><span class="lineno"> 2440</span>&#160;<span class="comment">    with sufficient storage for the nodal values, etc. (This</span></div>
<div class="line"><a name="l02441"></a><span class="lineno"> 2441</span>&#160;<span class="comment">    information is obtained by calls to the virtual functions [V4] </span></div>
<div class="line"><a name="l02442"></a><span class="lineno"> 2442</span>&#160;<span class="comment">    that are defined at this level but only implemented for specific,</span></div>
<div class="line"><a name="l02443"></a><span class="lineno"> 2443</span>&#160;<span class="comment">    derived  elements).</span></div>
<div class="line"><a name="l02444"></a><span class="lineno"> 2444</span>&#160;<span class="comment">  - calculate the mapping between local and </span></div>
<div class="line"><a name="l02445"></a><span class="lineno"> 2445</span>&#160;<span class="comment">    global (Eulerian) coordinates,</span></div>
<div class="line"><a name="l02446"></a><span class="lineno"> 2446</span>&#160;<span class="comment">    in terms of the abstract shape functions defined in the</span></div>
<div class="line"><a name="l02447"></a><span class="lineno"> 2447</span>&#160;<span class="comment">    virtual functions [V3]</span></div>
<div class="line"><a name="l02448"></a><span class="lineno"> 2448</span>&#160;<span class="comment">  - provide direct access to the nodal coordinates </span></div>
<div class="line"><a name="l02449"></a><span class="lineno"> 2449</span>&#160;<span class="comment">    and the nodal values.</span></div>
<div class="line"><a name="l02450"></a><span class="lineno"> 2450</span>&#160;<span class="comment">  - assign local equation numbers to the values </span></div>
<div class="line"><a name="l02451"></a><span class="lineno"> 2451</span>&#160;<span class="comment">    stored at the \c Nodes.</span></div>
<div class="line"><a name="l02452"></a><span class="lineno"> 2452</span>&#160;<span class="comment">&lt;/TD&gt;</span></div>
<div class="line"><a name="l02453"></a><span class="lineno"> 2453</span>&#160;<span class="comment">&lt;/TR&gt;</span></div>
<div class="line"><a name="l02454"></a><span class="lineno"> 2454</span>&#160;<span class="comment">&lt;/TABLE&gt;</span></div>
<div class="line"><a name="l02455"></a><span class="lineno"> 2455</span>&#160;<span class="comment">&lt;/CENTER&gt;</span></div>
<div class="line"><a name="l02456"></a><span class="lineno"> 2456</span>&#160;<span class="comment">&lt;TABLE&gt;</span></div>
<div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160;<span class="comment">&lt;TR&gt;</span></div>
<div class="line"><a name="l02458"></a><span class="lineno"> 2458</span>&#160;<span class="comment">&lt;TD bgcolor=&quot;cornsilk&quot;&gt;</span></div>
<div class="line"><a name="l02459"></a><span class="lineno"> 2459</span>&#160;<span class="comment">&lt;CENTER&gt;</span></div>
<div class="line"><a name="l02460"></a><span class="lineno"> 2460</span>&#160;<span class="comment">&lt;B&gt;Specific Geometric Element:&lt;/B&gt; [e.g. a \c QElement] &lt;BR&gt;</span></div>
<div class="line"><a name="l02461"></a><span class="lineno"> 2461</span>&#160;<span class="comment">[derived from \b FiniteElement]</span></div>
<div class="line"><a name="l02462"></a><span class="lineno"> 2462</span>&#160;<span class="comment">&lt;/CENTER&gt;</span></div>
<div class="line"><a name="l02463"></a><span class="lineno"> 2463</span>&#160;<span class="comment">- Implements functions that:</span></div>
<div class="line"><a name="l02464"></a><span class="lineno"> 2464</span>&#160;<span class="comment">  - allocate the storage for the (pointers to the) element&#39;s \c Nodes.</span></div>
<div class="line"><a name="l02465"></a><span class="lineno"> 2465</span>&#160;<span class="comment">  - construct the spatial integration scheme and set the pointer</span></div>
<div class="line"><a name="l02466"></a><span class="lineno"> 2466</span>&#160;<span class="comment">  defined in \c FiniteElement.</span></div>
<div class="line"><a name="l02467"></a><span class="lineno"> 2467</span>&#160;<span class="comment">  - define the dimension of the element, i.e. the number of local</span></div>
<div class="line"><a name="l02468"></a><span class="lineno"> 2468</span>&#160;<span class="comment">    coordinates required to parametrise its shape. This implements</span></div>
<div class="line"><a name="l02469"></a><span class="lineno"> 2469</span>&#160;<span class="comment">    the virtual function [V2] defined in \c FiniteElement.</span></div>
<div class="line"><a name="l02470"></a><span class="lineno"> 2470</span>&#160;<span class="comment">  - compute the shape functions and their derivatives with respect</span></div>
<div class="line"><a name="l02471"></a><span class="lineno"> 2471</span>&#160;<span class="comment">    to the local coordinates. This implements</span></div>
<div class="line"><a name="l02472"></a><span class="lineno"> 2472</span>&#160;<span class="comment">    the virtual functions [V3], defined in \c FiniteElement.</span></div>
<div class="line"><a name="l02473"></a><span class="lineno"> 2473</span>&#160;<span class="comment">  .</span></div>
<div class="line"><a name="l02474"></a><span class="lineno"> 2474</span>&#160;<span class="comment">.</span></div>
<div class="line"><a name="l02475"></a><span class="lineno"> 2475</span>&#160;<span class="comment">&lt;B&gt;Note:&lt;/B&gt;</span></div>
<div class="line"><a name="l02476"></a><span class="lineno"> 2476</span>&#160;<span class="comment">- Templating is often used to implement entire</span></div>
<div class="line"><a name="l02477"></a><span class="lineno"> 2477</span>&#160;<span class="comment">  families of geometric elements. For instance, the elements of the </span></div>
<div class="line"><a name="l02478"></a><span class="lineno"> 2478</span>&#160;<span class="comment">  \c QElement family have two</span></div>
<div class="line"><a name="l02479"></a><span class="lineno"> 2479</span>&#160;<span class="comment">  template parameters: One defines the dimension of the element, </span></div>
<div class="line"><a name="l02480"></a><span class="lineno"> 2480</span>&#160;<span class="comment">  the other the number of nodes along a 1D element edge, so that</span></div>
<div class="line"><a name="l02481"></a><span class="lineno"> 2481</span>&#160;<span class="comment">  a \c QElement&lt;1,3&gt; is a three-node line element, while a </span></div>
<div class="line"><a name="l02482"></a><span class="lineno"> 2482</span>&#160;<span class="comment">  \c QElement&lt;3,2&gt; is an eight-node brick element, etc.</span></div>
<div class="line"><a name="l02483"></a><span class="lineno"> 2483</span>&#160;<span class="comment">&lt;/TD&gt;</span></div>
<div class="line"><a name="l02484"></a><span class="lineno"> 2484</span>&#160;<span class="comment">&lt;TD bgcolor=&quot;cornsilk&quot;&gt;</span></div>
<div class="line"><a name="l02485"></a><span class="lineno"> 2485</span>&#160;<span class="comment">&lt;CENTER&gt;</span></div>
<div class="line"><a name="l02486"></a><span class="lineno"> 2486</span>&#160;<span class="comment">&lt;B&gt;Specific Equation:&lt;/B&gt; [e.g. the \c PoissonEquations] &lt;BR&gt;</span></div>
<div class="line"><a name="l02487"></a><span class="lineno"> 2487</span>&#160;<span class="comment">[derived from \b FiniteElement]</span></div>
<div class="line"><a name="l02488"></a><span class="lineno"> 2488</span>&#160;<span class="comment">&lt;/CENTER&gt;</span></div>
<div class="line"><a name="l02489"></a><span class="lineno"> 2489</span>&#160;<span class="comment">- Stores and provides access to:</span></div>
<div class="line"><a name="l02490"></a><span class="lineno"> 2490</span>&#160;<span class="comment">  - (function pointers to) any source functions, forcing terms, etc.</span></div>
<div class="line"><a name="l02491"></a><span class="lineno"> 2491</span>&#160;<span class="comment">    that occur in the governing equations. </span></div>
<div class="line"><a name="l02492"></a><span class="lineno"> 2492</span>&#160;<span class="comment">  - (pointers to) any parameters in the governing equation.</span></div>
<div class="line"><a name="l02493"></a><span class="lineno"> 2493</span>&#160;<span class="comment">- Implements functions that:</span></div>
<div class="line"><a name="l02494"></a><span class="lineno"> 2494</span>&#160;<span class="comment">  - compute the element&#39;s residual vector and Jacobian matrix, as </span></div>
<div class="line"><a name="l02495"></a><span class="lineno"> 2495</span>&#160;<span class="comment">    defined by the virtual functions [V1] in \c FiniteElement. These</span></div>
<div class="line"><a name="l02496"></a><span class="lineno"> 2496</span>&#160;<span class="comment">    functions have access to the geometric shape functions, the number of </span></div>
<div class="line"><a name="l02497"></a><span class="lineno"> 2497</span>&#160;<span class="comment">    \c Nodes, the mapping between local and global coordinates, </span></div>
<div class="line"><a name="l02498"></a><span class="lineno"> 2498</span>&#160;<span class="comment">    etc, via the (abstract and concrete) functions defined in </span></div>
<div class="line"><a name="l02499"></a><span class="lineno"> 2499</span>&#160;<span class="comment">    \c FiniteElement.</span></div>
<div class="line"><a name="l02500"></a><span class="lineno"> 2500</span>&#160;<span class="comment">.</span></div>
<div class="line"><a name="l02501"></a><span class="lineno"> 2501</span>&#160;<span class="comment">- Defines and implements functions that:</span></div>
<div class="line"><a name="l02502"></a><span class="lineno"> 2502</span>&#160;<span class="comment">  - compute derived quantities of interest, e.g. the local flux</span></div>
<div class="line"><a name="l02503"></a><span class="lineno"> 2503</span>&#160;<span class="comment">.</span></div>
<div class="line"><a name="l02504"></a><span class="lineno"> 2504</span>&#160;<span class="comment">&lt;B&gt;Notes:&lt;/B&gt; </span></div>
<div class="line"><a name="l02505"></a><span class="lineno"> 2505</span>&#160;<span class="comment">- Templating is often used to implement the equations</span></div>
<div class="line"><a name="l02506"></a><span class="lineno"> 2506</span>&#160;<span class="comment">  in arbitrary spatial dimensions, such as</span></div>
<div class="line"><a name="l02507"></a><span class="lineno"> 2507</span>&#160;<span class="comment">  \c PoissonEquations&lt;DIM&gt;.</span></div>
<div class="line"><a name="l02508"></a><span class="lineno"> 2508</span>&#160;<span class="comment">&lt;/TD&gt;</span></div>
<div class="line"><a name="l02509"></a><span class="lineno"> 2509</span>&#160;<span class="comment">&lt;/TR&gt;</span></div>
<div class="line"><a name="l02510"></a><span class="lineno"> 2510</span>&#160;<span class="comment">&lt;/TABLE&gt;</span></div>
<div class="line"><a name="l02511"></a><span class="lineno"> 2511</span>&#160;<span class="comment">&lt;CENTER&gt;</span></div>
<div class="line"><a name="l02512"></a><span class="lineno"> 2512</span>&#160;<span class="comment">&lt;TABLE bgcolor=&quot;cornsilk&quot;&gt;</span></div>
<div class="line"><a name="l02513"></a><span class="lineno"> 2513</span>&#160;<span class="comment">&lt;TR&gt;</span></div>
<div class="line"><a name="l02514"></a><span class="lineno"> 2514</span>&#160;<span class="comment">&lt;TD&gt;</span></div>
<div class="line"><a name="l02515"></a><span class="lineno"> 2515</span>&#160;<span class="comment">&lt;CENTER&gt;</span></div>
<div class="line"><a name="l02516"></a><span class="lineno"> 2516</span>&#160;<span class="comment">&lt;B&gt;Specific Element:&lt;/B&gt; [e.g. a \c QPoissonElement] &lt;BR&gt;</span></div>
<div class="line"><a name="l02517"></a><span class="lineno"> 2517</span>&#160;<span class="comment">[Derived from a &lt;B&gt;Specific Equation &lt;/B&gt; and a </span></div>
<div class="line"><a name="l02518"></a><span class="lineno"> 2518</span>&#160;<span class="comment">&lt;B&gt;Specific Geometric Element&lt;/B&gt;  by multiple inheritance]</span></div>
<div class="line"><a name="l02519"></a><span class="lineno"> 2519</span>&#160;<span class="comment">&lt;/CENTER&gt;</span></div>
<div class="line"><a name="l02520"></a><span class="lineno"> 2520</span>&#160;<span class="comment">&lt;P&gt;</span></div>
<div class="line"><a name="l02521"></a><span class="lineno"> 2521</span>&#160;<span class="comment">- Implements functions that:</span></div>
<div class="line"><a name="l02522"></a><span class="lineno"> 2522</span>&#160;<span class="comment">  - specify the number of nodal values etc. to be stored</span></div>
<div class="line"><a name="l02523"></a><span class="lineno"> 2523</span>&#160;<span class="comment">    at each \c Node; this implements the virtual functions  </span></div>
<div class="line"><a name="l02524"></a><span class="lineno"> 2524</span>&#160;<span class="comment">    [V4] defined in \c FiniteElement.</span></div>
<div class="line"><a name="l02525"></a><span class="lineno"> 2525</span>&#160;<span class="comment">  - provide any additional functionality that might be</span></div>
<div class="line"><a name="l02526"></a><span class="lineno"> 2526</span>&#160;<span class="comment">    required at the \b Specific \b Element level.</span></div>
<div class="line"><a name="l02527"></a><span class="lineno"> 2527</span>&#160;<span class="comment">&lt;/TABLE&gt;</span></div>
<div class="line"><a name="l02528"></a><span class="lineno"> 2528</span>&#160;<span class="comment">&lt;/TD&gt;</span></div>
<div class="line"><a name="l02529"></a><span class="lineno"> 2529</span>&#160;<span class="comment">&lt;/TR&gt;</span></div>
<div class="line"><a name="l02530"></a><span class="lineno"> 2530</span>&#160;<span class="comment">&lt;/TABLE&gt;</span></div>
<div class="line"><a name="l02531"></a><span class="lineno"> 2531</span>&#160;<span class="comment">&lt;/CENTER&gt;</span></div>
<div class="line"><a name="l02532"></a><span class="lineno"> 2532</span>&#160;<span class="comment">&lt;/TABLE&gt;</span></div>
<div class="line"><a name="l02533"></a><span class="lineno"> 2533</span>&#160;<span class="comment">&lt;/CENTER&gt;</span></div>
<div class="line"><a name="l02534"></a><span class="lineno"> 2534</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02535"></a><span class="lineno"> 2535</span>&#160;<span class="comment">&lt;B&gt;Note:&lt;/B&gt; The subdivision into classes that define the</span></div>
<div class="line"><a name="l02536"></a><span class="lineno"> 2536</span>&#160;<span class="comment">element geometry and the specific equations to be solved</span></div>
<div class="line"><a name="l02537"></a><span class="lineno"> 2537</span>&#160;<span class="comment">is often useful but not compulsory. It is possible</span></div>
<div class="line"><a name="l02538"></a><span class="lineno"> 2538</span>&#160;<span class="comment">(and in some cases probably preferable) to provide the complete</span></div>
<div class="line"><a name="l02539"></a><span class="lineno"> 2539</span>&#160;<span class="comment">implementation for a specific element in a single class.</span></div>
<div class="line"><a name="l02540"></a><span class="lineno"> 2540</span>&#160;<span class="comment">Furthermore, not all elements in \c oomph-lib need to be</span></div>
<div class="line"><a name="l02541"></a><span class="lineno"> 2541</span>&#160;<span class="comment">\c FiniteElements. It is possible to formulate fully functional </span></div>
<div class="line"><a name="l02542"></a><span class="lineno"> 2542</span>&#160;<span class="comment">GeneralisedElements. Such elements are often used to formulate</span></div>
<div class="line"><a name="l02543"></a><span class="lineno"> 2543</span>&#160;<span class="comment">discrete constraints or boundary conditions. </span></div>
<div class="line"><a name="l02544"></a><span class="lineno"> 2544</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02545"></a><span class="lineno"> 2545</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02546"></a><span class="lineno"> 2546</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02547"></a><span class="lineno"> 2547</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02548"></a><span class="lineno"> 2548</span>&#160;<span class="comment">&lt;CENTER&gt;</span></div>
<div class="line"><a name="l02549"></a><span class="lineno"> 2549</span>&#160;<span class="comment">&lt;TABLE bgcolor=&quot;pink&quot;&gt;</span></div>
<div class="line"><a name="l02550"></a><span class="lineno"> 2550</span>&#160;<span class="comment">&lt;TR&gt;</span></div>
<div class="line"><a name="l02551"></a><span class="lineno"> 2551</span>&#160;<span class="comment">&lt;TD&gt;</span></div>
<div class="line"><a name="l02552"></a><span class="lineno"> 2552</span>&#160;<span class="comment">&lt;CENTER&gt;</span></div>
<div class="line"><a name="l02553"></a><span class="lineno"> 2553</span>&#160;<span class="comment">&lt;TABLE bgcolor=&quot;cornsilk&quot;&gt;</span></div>
<div class="line"><a name="l02554"></a><span class="lineno"> 2554</span>&#160;<span class="comment">&lt;TR&gt;</span></div>
<div class="line"><a name="l02555"></a><span class="lineno"> 2555</span>&#160;<span class="comment">&lt;TD&gt;</span></div>
<div class="line"><a name="l02556"></a><span class="lineno"> 2556</span>&#160;<span class="comment">&lt;CENTER&gt;</span></div>
<div class="line"><a name="l02557"></a><span class="lineno"> 2557</span>&#160;<span class="comment">&lt;B&gt;Mesh:&lt;/B&gt;</span></div>
<div class="line"><a name="l02558"></a><span class="lineno"> 2558</span>&#160;<span class="comment">&lt;/CENTER&gt;</span></div>
<div class="line"><a name="l02559"></a><span class="lineno"> 2559</span>&#160;<span class="comment">- Stores and provides access to:</span></div>
<div class="line"><a name="l02560"></a><span class="lineno"> 2560</span>&#160;<span class="comment">  - (pointers to) its constituent \c GeneralisedElements.</span></div>
<div class="line"><a name="l02561"></a><span class="lineno"> 2561</span>&#160;<span class="comment">  - (pointers to) its constituent \c Nodes.</span></div>
<div class="line"><a name="l02562"></a><span class="lineno"> 2562</span>&#160;<span class="comment">  - (pointers to) the \c Nodes that are located on the \c Mesh</span></div>
<div class="line"><a name="l02563"></a><span class="lineno"> 2563</span>&#160;<span class="comment">    boundaries.</span></div>
<div class="line"><a name="l02564"></a><span class="lineno"> 2564</span>&#160;<span class="comment">- Defines and implements functions that:</span></div>
<div class="line"><a name="l02565"></a><span class="lineno"> 2565</span>&#160;<span class="comment">  - assign the global equation numbers for all nodal values.</span></div>
<div class="line"><a name="l02566"></a><span class="lineno"> 2566</span>&#160;<span class="comment">  - execute the \c GeneralisedElement::assign_local_eqn_numbers()</span></div>
<div class="line"><a name="l02567"></a><span class="lineno"> 2567</span>&#160;<span class="comment">    function for all constituent GeneralisedElements.</span></div>
<div class="line"><a name="l02568"></a><span class="lineno"> 2568</span>&#160;<span class="comment">&lt;/TD&gt;</span></div>
<div class="line"><a name="l02569"></a><span class="lineno"> 2569</span>&#160;<span class="comment">&lt;/TR&gt;</span></div>
<div class="line"><a name="l02570"></a><span class="lineno"> 2570</span>&#160;<span class="comment">&lt;/TABLE&gt;</span></div>
<div class="line"><a name="l02571"></a><span class="lineno"> 2571</span>&#160;<span class="comment">&lt;/CENTER&gt;</span></div>
<div class="line"><a name="l02572"></a><span class="lineno"> 2572</span>&#160;<span class="comment">&lt;CENTER&gt;</span></div>
<div class="line"><a name="l02573"></a><span class="lineno"> 2573</span>&#160;<span class="comment">&lt;TABLE bgcolor=&quot;cornsilk&quot;&gt;</span></div>
<div class="line"><a name="l02574"></a><span class="lineno"> 2574</span>&#160;<span class="comment">&lt;TR&gt;</span></div>
<div class="line"><a name="l02575"></a><span class="lineno"> 2575</span>&#160;<span class="comment">&lt;TD&gt;</span></div>
<div class="line"><a name="l02576"></a><span class="lineno"> 2576</span>&#160;<span class="comment">&lt;CENTER&gt;</span></div>
<div class="line"><a name="l02577"></a><span class="lineno"> 2577</span>&#160;<span class="comment">&lt;B&gt;Specific Mesh:&lt;/B&gt; &lt;BR&gt;[derived from \b Mesh]</span></div>
<div class="line"><a name="l02578"></a><span class="lineno"> 2578</span>&#160;<span class="comment">&lt;/CENTER&gt;</span></div>
<div class="line"><a name="l02579"></a><span class="lineno"> 2579</span>&#160;<span class="comment">- Defines and implements functions that:</span></div>
<div class="line"><a name="l02580"></a><span class="lineno"> 2580</span>&#160;<span class="comment">  - create the Mesh. This is typically done in the Mesh constructor</span></div>
<div class="line"><a name="l02581"></a><span class="lineno"> 2581</span>&#160;<span class="comment">    and involves the following tasks:</span></div>
<div class="line"><a name="l02582"></a><span class="lineno"> 2582</span>&#160;<span class="comment">    - creating the \c Mesh&#39;s constituent \c Nodes and \c</span></div>
<div class="line"><a name="l02583"></a><span class="lineno"> 2583</span>&#160;<span class="comment">      GeneralisedElements</span></div>
<div class="line"><a name="l02584"></a><span class="lineno"> 2584</span>&#160;<span class="comment">    - setting up the lookup schemes that allow direct access to </span></div>
<div class="line"><a name="l02585"></a><span class="lineno"> 2585</span>&#160;<span class="comment">      \c Nodes and \c FiniteElements on the domain boundaries.</span></div>
<div class="line"><a name="l02586"></a><span class="lineno"> 2586</span>&#160;<span class="comment">&lt;/TD&gt;</span></div>
<div class="line"><a name="l02587"></a><span class="lineno"> 2587</span>&#160;<span class="comment">&lt;/TR&gt;</span></div>
<div class="line"><a name="l02588"></a><span class="lineno"> 2588</span>&#160;<span class="comment">&lt;/TABLE&gt;</span></div>
<div class="line"><a name="l02589"></a><span class="lineno"> 2589</span>&#160;<span class="comment">&lt;/CENTER&gt;</span></div>
<div class="line"><a name="l02590"></a><span class="lineno"> 2590</span>&#160;<span class="comment">&lt;/TD&gt;</span></div>
<div class="line"><a name="l02591"></a><span class="lineno"> 2591</span>&#160;<span class="comment">&lt;/TR&gt;</span></div>
<div class="line"><a name="l02592"></a><span class="lineno"> 2592</span>&#160;<span class="comment">&lt;/TABLE&gt;</span></div>
<div class="line"><a name="l02593"></a><span class="lineno"> 2593</span>&#160;<span class="comment">&lt;/CENTER&gt;</span></div>
<div class="line"><a name="l02594"></a><span class="lineno"> 2594</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02595"></a><span class="lineno"> 2595</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02596"></a><span class="lineno"> 2596</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02597"></a><span class="lineno"> 2597</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02598"></a><span class="lineno"> 2598</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02599"></a><span class="lineno"> 2599</span>&#160;<span class="comment">&lt;CENTER&gt;</span></div>
<div class="line"><a name="l02600"></a><span class="lineno"> 2600</span>&#160;<span class="comment">&lt;TABLE bgcolor=&quot;pink&quot;&gt;</span></div>
<div class="line"><a name="l02601"></a><span class="lineno"> 2601</span>&#160;<span class="comment">&lt;TR&gt;</span></div>
<div class="line"><a name="l02602"></a><span class="lineno"> 2602</span>&#160;<span class="comment">&lt;TD&gt;</span></div>
<div class="line"><a name="l02603"></a><span class="lineno"> 2603</span>&#160;<span class="comment">&lt;CENTER&gt;</span></div>
<div class="line"><a name="l02604"></a><span class="lineno"> 2604</span>&#160;<span class="comment">&lt;TABLE bgcolor=&quot;cornsilk&quot;&gt;</span></div>
<div class="line"><a name="l02605"></a><span class="lineno"> 2605</span>&#160;<span class="comment">&lt;TR&gt;</span></div>
<div class="line"><a name="l02606"></a><span class="lineno"> 2606</span>&#160;<span class="comment">&lt;TD&gt;</span></div>
<div class="line"><a name="l02607"></a><span class="lineno"> 2607</span>&#160;<span class="comment">&lt;CENTER&gt;</span></div>
<div class="line"><a name="l02608"></a><span class="lineno"> 2608</span>&#160;<span class="comment">&lt;B&gt;Problem:&lt;/B&gt;</span></div>
<div class="line"><a name="l02609"></a><span class="lineno"> 2609</span>&#160;<span class="comment">&lt;/CENTER&gt;</span></div>
<div class="line"><a name="l02610"></a><span class="lineno"> 2610</span>&#160;<span class="comment">- Stores and provides access to:</span></div>
<div class="line"><a name="l02611"></a><span class="lineno"> 2611</span>&#160;<span class="comment">  - (pointer to) the global \c Mesh which provides ordered access</span></div>
<div class="line"><a name="l02612"></a><span class="lineno"> 2612</span>&#160;<span class="comment">    to all \c Nodes and \c GeneralisedElements in the \c Problem. </span></div>
<div class="line"><a name="l02613"></a><span class="lineno"> 2613</span>&#160;<span class="comment">  - (pointers to) any global \c Data.</span></div>
<div class="line"><a name="l02614"></a><span class="lineno"> 2614</span>&#160;<span class="comment">  - (pointer to) a \c LinearSolver that will be used in the</span></div>
<div class="line"><a name="l02615"></a><span class="lineno"> 2615</span>&#160;<span class="comment">     Newton method.</span></div>
<div class="line"><a name="l02616"></a><span class="lineno"> 2616</span>&#160;<span class="comment">  - a vector of (pointers to) the \c Problem&#39;s degrees of freedom </span></div>
<div class="line"><a name="l02617"></a><span class="lineno"> 2617</span>&#160;<span class="comment">    (= double precision numbers).</span></div>
<div class="line"><a name="l02618"></a><span class="lineno"> 2618</span>&#160;<span class="comment">- Defines and implements functions that:</span></div>
<div class="line"><a name="l02619"></a><span class="lineno"> 2619</span>&#160;<span class="comment">  - set up  the global and local equation numbering schemes.</span></div>
<div class="line"><a name="l02620"></a><span class="lineno"> 2620</span>&#160;<span class="comment">  - solve the (global) nonlinear system of equations, formally</span></div>
<div class="line"><a name="l02621"></a><span class="lineno"> 2621</span>&#160;<span class="comment">    defined by the assembly of the \c GeneralisedElement&#39;s residual</span></div>
<div class="line"><a name="l02622"></a><span class="lineno"> 2622</span>&#160;<span class="comment">    vectors, using Newton&#39;s method. </span></div>
<div class="line"><a name="l02623"></a><span class="lineno"> 2623</span>&#160;<span class="comment">  - perform a self test of all fundamental objects involved in the</span></div>
<div class="line"><a name="l02624"></a><span class="lineno"> 2624</span>&#160;<span class="comment">    problem to check if the \c Problem has been set up properly.</span></div>
<div class="line"><a name="l02625"></a><span class="lineno"> 2625</span>&#160;<span class="comment">  - allow the entire Problem to be written to disk, in a format</span></div>
<div class="line"><a name="l02626"></a><span class="lineno"> 2626</span>&#160;<span class="comment">    that allows restarts.</span></div>
<div class="line"><a name="l02627"></a><span class="lineno"> 2627</span>&#160;<span class="comment">&lt;/TD&gt;</span></div>
<div class="line"><a name="l02628"></a><span class="lineno"> 2628</span>&#160;<span class="comment">&lt;/TR&gt;</span></div>
<div class="line"><a name="l02629"></a><span class="lineno"> 2629</span>&#160;<span class="comment">&lt;/TABLE&gt;</span></div>
<div class="line"><a name="l02630"></a><span class="lineno"> 2630</span>&#160;<span class="comment">&lt;/CENTER&gt;</span></div>
<div class="line"><a name="l02631"></a><span class="lineno"> 2631</span>&#160;<span class="comment">&lt;CENTER&gt;</span></div>
<div class="line"><a name="l02632"></a><span class="lineno"> 2632</span>&#160;<span class="comment">&lt;TABLE bgcolor=&quot;cornsilk&quot;&gt;</span></div>
<div class="line"><a name="l02633"></a><span class="lineno"> 2633</span>&#160;<span class="comment">&lt;TR&gt;</span></div>
<div class="line"><a name="l02634"></a><span class="lineno"> 2634</span>&#160;<span class="comment">&lt;TD&gt;</span></div>
<div class="line"><a name="l02635"></a><span class="lineno"> 2635</span>&#160;<span class="comment">&lt;CENTER&gt;</span></div>
<div class="line"><a name="l02636"></a><span class="lineno"> 2636</span>&#160;<span class="comment">&lt;B&gt;Specific Problem:&lt;/B&gt; &lt;BR&gt;[derived from \b Problem]</span></div>
<div class="line"><a name="l02637"></a><span class="lineno"> 2637</span>&#160;<span class="comment">&lt;/CENTER&gt;</span></div>
<div class="line"><a name="l02638"></a><span class="lineno"> 2638</span>&#160;<span class="comment">- Implements functions that:</span></div>
<div class="line"><a name="l02639"></a><span class="lineno"> 2639</span>&#160;<span class="comment">  - Set up the problem. This is usually done in the \c Problem</span></div>
<div class="line"><a name="l02640"></a><span class="lineno"> 2640</span>&#160;<span class="comment">    constructor and involves the following tasks:</span></div>
<div class="line"><a name="l02641"></a><span class="lineno"> 2641</span>&#160;<span class="comment">    - creation of the \c Mesh object</span></div>
<div class="line"><a name="l02642"></a><span class="lineno"> 2642</span>&#160;<span class="comment">    - application of boundary conditions</span></div>
<div class="line"><a name="l02643"></a><span class="lineno"> 2643</span>&#160;<span class="comment">    - completion of the build process for any \c GeneralisedElements</span></div>
<div class="line"><a name="l02644"></a><span class="lineno"> 2644</span>&#160;<span class="comment">      that need to be passed some global data, such as function pointers</span></div>
<div class="line"><a name="l02645"></a><span class="lineno"> 2645</span>&#160;<span class="comment">      to source functions, etc.</span></div>
<div class="line"><a name="l02646"></a><span class="lineno"> 2646</span>&#160;<span class="comment">    - setting up the equation numbering scheme. </span></div>
<div class="line"><a name="l02647"></a><span class="lineno"> 2647</span>&#160;<span class="comment">- Defines and implements functions that:</span></div>
<div class="line"><a name="l02648"></a><span class="lineno"> 2648</span>&#160;<span class="comment">  - perform parameter studies</span></div>
<div class="line"><a name="l02649"></a><span class="lineno"> 2649</span>&#160;<span class="comment">  - perform the post-processing of the results.</span></div>
<div class="line"><a name="l02650"></a><span class="lineno"> 2650</span>&#160;<span class="comment">&lt;/TD&gt;</span></div>
<div class="line"><a name="l02651"></a><span class="lineno"> 2651</span>&#160;<span class="comment">&lt;/TR&gt;</span></div>
<div class="line"><a name="l02652"></a><span class="lineno"> 2652</span>&#160;<span class="comment">&lt;/TABLE&gt;</span></div>
<div class="line"><a name="l02653"></a><span class="lineno"> 2653</span>&#160;<span class="comment">&lt;/CENTER&gt;</span></div>
<div class="line"><a name="l02654"></a><span class="lineno"> 2654</span>&#160;<span class="comment">&lt;/TD&gt;</span></div>
<div class="line"><a name="l02655"></a><span class="lineno"> 2655</span>&#160;<span class="comment">&lt;/TR&gt;</span></div>
<div class="line"><a name="l02656"></a><span class="lineno"> 2656</span>&#160;<span class="comment">&lt;/TABLE&gt;</span></div>
<div class="line"><a name="l02657"></a><span class="lineno"> 2657</span>&#160;<span class="comment">&lt;/CENTER&gt;</span></div>
<div class="line"><a name="l02658"></a><span class="lineno"> 2658</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02659"></a><span class="lineno"> 2659</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l02660"></a><span class="lineno"> 2660</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l02661"></a><span class="lineno"> 2661</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02662"></a><span class="lineno"> 2662</span>&#160;<span class="comment"> </span></div>
<div class="line"><a name="l02663"></a><span class="lineno"> 2663</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02664"></a><span class="lineno"> 2664</span>&#160;<span class="comment">&lt;hr&gt;</span></div>
<div class="line"><a name="l02665"></a><span class="lineno"> 2665</span>&#160;<span class="comment">&lt;hr&gt;</span></div>
<div class="line"><a name="l02666"></a><span class="lineno"> 2666</span>&#160;<span class="comment">\section pdf PDF file</span></div>
<div class="line"><a name="l02667"></a><span class="lineno"> 2667</span>&#160;<span class="comment">A &lt;a href=&quot;../latex/refman.pdf&quot;&gt;pdf version&lt;/a&gt; of this document is available.</span></div>
<div class="line"><a name="l02668"></a><span class="lineno"> 2668</span>&#160;<span class="comment">**/</span></div>
<div class="line"><a name="l02669"></a><span class="lineno"> 2669</span>&#160; </div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="aintro_8txt_html_adbf2558e429aa3829881ff287b289067"><div class="ttname"><a href="intro_8txt.html#adbf2558e429aa3829881ff287b289067">practice</a></div><div class="ttdeci">mathematically the only requirement is that the basis functions are sufficiently general that the solution can be represented by the the functions must be a complete basis for f E[(4)] f and we recall that this equation must be satisfied for e any test function f and so all possible test functions f the condition f[\mbox{...for any basis function $ \phi^{(test)}(x_i) $...} \f] becomes f[\mbox{...for any values of the coefficients $ \Phi_k$...} \f] Inserting the E[(6)] f where f[r_k(U_1, U_2,...)=\int_{D} {\cal R}\left(x_i;\ u_{p}(x_i)+\sum_{j=1}^{\infty} U_j \psi_j(x_i)\right) \ \psi_k(x_i) \ \mbox{d}x_1 \mbox{d}x_2. \ \ \ \ \ \ \ @E[(7)]@ \f] so the coefficients f U_j f must satisfy the equations f[r_k(U_1, U_2,...)=0, \mbox{ \ \ \ \ for } k=1, 2,... \f] In practice</div><div class="ttdef"><b>Definition:</b> <a href="intro_8txt_source.html#l00490">intro.txt:490</a></div></div>
<div class="ttc" id="aintro_8txt_html_a905d01d8737b36e847126d062633620c"><div class="ttname"><a href="intro_8txt.html#a905d01d8737b36e847126d062633620c">compact</a></div><div class="ttdeci">f where the function f $g f is given&lt;/CENTER &gt;&lt;/TD &gt;&lt;/TR &gt;&lt;/TABLE &gt;&lt;/CENTER &gt; To keep the notation compact</div><div class="ttdef"><b>Definition:</b> <a href="intro_8txt_source.html#l00114">intro.txt:114</a></div></div>
<div class="ttc" id="aintro_8txt_html_a2c0914bba462ef717ebea8190689c567"><div class="ttname"><a href="intro_8txt.html#a2c0914bba462ef717ebea8190689c567">form</a></div><div class="ttdeci">adopting the natural numbering when discussing the C implementation would make this documentation inconsistent with the actual implementation We therefore use both numbering each within their appropriate context&lt;/div &gt;&lt;/TD &gt;&lt;/TR &gt;&lt;/TABLE &gt;&lt;/CENTER &gt; the Poisson equation describes steady diffusion processes For the Poisson problem describes the temperature distribution f f $D whose boundary f partial D f is maintained at a prescribed f the strength of these heat sources is bounded because no physical process can release infinite amounts of energy in a finite domain we assume that f[\int_D f(x_i) \ dx_1 dx_2&lt; \infty.\f] We usually write all PDEs in residual form</div><div class="ttdef"><b>Definition:</b> <a href="intro_8txt_source.html#l00096">intro.txt:96</a></div></div>
<div class="ttc" id="aintro_8txt_html_afc381956b5f9d1e44299eb80417fcec5"><div class="ttname"><a href="intro_8txt.html#afc381956b5f9d1e44299eb80417fcec5">condition</a></div><div class="ttdeci">f where f f where f and f f&lt;/CENTER &gt;&lt;/TD &gt;&lt;/TR &gt;&lt;/TABLE &gt;&lt;/CENTER &gt; We stress that neither the finite element nor c oomph lib are restricted to scalar second order PDEs Documentation for the example drivers discusses generalisations f[{\cal R}(x_i;u(x_i)) \equiv 0 \ \ \ \forall x_i \in D\mbox{\ \ \ \ and \ \ \ \ } u|_{\partial D}=g. \f] The concept of a weak solution is based on a slight relaxation of this criterion A weak f f of problem P is any function that satisfies the essential boundary condition</div><div class="ttdef"><b>Definition:</b> <a href="intro_8txt_source.html#l00206">intro.txt:206</a></div></div>
<div class="ttc" id="aintro_8txt_html_a55bb2181bc00085512c633969d5b944b"><div class="ttname"><a href="intro_8txt.html#a55bb2181bc00085512c633969d5b944b">phi</a></div><div class="ttdeci">f where f f where f and f f&lt;/CENTER &gt;&lt;/TD &gt;&lt;/TR &gt;&lt;/TABLE &gt;&lt;/CENTER &gt; We stress that neither the finite element nor c oomph lib are restricted to scalar second order PDEs Documentation for the example drivers discusses generalisations f[{\cal R}(x_i;u(x_i)) \equiv 0 \ \ \ \forall x_i \in D\mbox{\ \ \ \ and \ \ \ \ } u|_{\partial D}=g. \f] The concept of a weak solution is based on a slight relaxation of this criterion A weak f f of problem P is any function that satisfies the essential boundary f[u_w|_{\partial D}=g, \f] and for which the so called weighted residual f[r=\int_{D} {\cal R}(x_i;u_w(x_i)) \ \phi^{(test)}(x_i) \ \mbox{d}x_1 \mbox{d}x_2 \ \ \ \ \ \ \ \ @E[weighted_residual]@ \f] vanishes for e any test function f phi</div><div class="ttdef"><b>Definition:</b> <a href="intro_8txt_source.html#l00212">intro.txt:212</a></div></div>
<div class="ttc" id="aintro_8txt_html_acf145151ba73a92176051eecc4ad1a6c"><div class="ttname"><a href="intro_8txt.html#acf145151ba73a92176051eecc4ad1a6c">same</a></div><div class="ttdeci">E[(8)] f and we determine the f $M f unknown f U_M from the f $M f algebraic equations f[r_k(U_1,..., U_M)=0, \mbox{\ \ where \ \ $k=1,..., M$}. \ \ \ \ \ \ \ \ @E[(9)]@ \f] The number of terms in each truncated expansion must be the same</div><div class="ttdef"><b>Definition:</b> <a href="intro_8txt_source.html#l00501">intro.txt:501</a></div></div>
<div class="ttc" id="aintro_8txt_html_a46877218a50ab1c4e569e21aa01f1a89"><div class="ttname"><a href="intro_8txt.html#a46877218a50ab1c4e569e21aa01f1a89">P</a></div><div class="ttdeci">B P</div><div class="ttdef"><b>Definition:</b> <a href="intro_8txt_source.html#l00526">intro.txt:526</a></div></div>
<div class="ttc" id="aintro_8txt_html_a2f9cf9d0788477757896c69e94741dbb"><div class="ttname"><a href="intro_8txt.html#a2f9cf9d0788477757896c69e94741dbb">x</a></div><div class="ttdeci">f(x) \mbox{ \ \ \ \ for $x\in[0, 1]$ \ \ \ subject to \ \ \ } u(x=0)=g_0 \mbox{\ \ \ and \ \ \ } u(x=1)=g_1, \mbox{\hspace{3cm}} \f] where \f$ f(x)\f$ and the constants \f $g_0\f$ and \f $g_1\f$ are given. The 2D equivalent is given by \f[\frac{\partial^2 u(x_1, x_2)}{\partial x_1^{2}}+\frac{\partial^{2} u(x_1, x_2)}{\partial x_2^{2}}=f(x_1, x_2) \mbox{ \ \ \ \ for $(x_1, x_2)\in D$ \ \ \ subject to \ \ \ } u|_{\partial D}=g, \mbox{\hspace{5cm}} \f] where \f$ f(x_1, x_2)\f$ and \f$ g(x_1, x_2)\f$ are given.&lt; CENTER &gt;&lt; TABLE class=&quot;oomph-table&quot;&gt;&lt; TR &gt;&lt; TD class=&quot;panel panel-default&quot;&gt;&lt; CENTER class=&quot;panel-heading&quot;&gt;&lt; B &gt; A note on notation&lt;/B &gt;&lt;/CENTER &gt;&lt; div class=&quot;panel-body&quot;&gt; Throughout this document, we use index notation and write, e.g., \f$ u(x_1, x_2) \f$ as \f$ u(x_i) \f$. We do not explicitly state the range of free indices where it is clear from the context -- in the above example it would be equal to the spatial dimension of the problem. All mathematical derivations are presented using the &quot;natural&quot; numbering of the indices:e.g., the components of the 3D vector \f${\bf f}\f$ are \f$ f_1, f_2 \f$ and \f$ f_3 \f$. Unfortunately, this notation is inconsistent with the implementation of vectors(and most other standard &quot;containers&quot;) in C++where the indices start from 0 and the components of \c vector&lt; double &gt; \c f(3) are \c f[0], \c f[1] and \c f[2]. There is no elegant way to resolve this conflict. Adopting C++-style numbering in the theoretical development would make the mathematics look very odd(try it!) x</div><div class="ttdef"><b>Definition:</b> <a href="intro_8txt_source.html#l00069">intro.txt:69</a></div></div>
<div class="ttc" id="aintro_8txt_html_aa3c33a01b4e9ab8d8e8d4b6354f7bbaa"><div class="ttname"><a href="intro_8txt.html#aa3c33a01b4e9ab8d8e8d4b6354f7bbaa">solution</a></div><div class="ttdeci">f where f f where f and f f&lt;/CENTER &gt;&lt;/TD &gt;&lt;/TR &gt;&lt;/TABLE &gt;&lt;/CENTER &gt; We stress that neither the finite element nor c oomph lib are restricted to scalar second order PDEs Documentation for the example drivers discusses generalisations f[{\cal R}(x_i;u(x_i)) \equiv 0 \ \ \ \forall x_i \in D\mbox{\ \ \ \ and \ \ \ \ } u|_{\partial D}=g. \f] The concept of a weak solution is based on a slight relaxation of this criterion A weak solution</div><div class="ttdef"><b>Definition:</b> <a href="intro_8txt_source.html#l00205">intro.txt:205</a></div></div>
<div class="ttc" id="aintro_8txt_html_a243ca26111e25076e3225bdd0be7526d"><div class="ttname"><a href="intro_8txt.html#a243ca26111e25076e3225bdd0be7526d">f</a></div><div class="ttdeci">adopting the natural numbering when discussing the C implementation would make this documentation inconsistent with the actual implementation We therefore use both numbering each within their appropriate context&lt;/div &gt;&lt;/TD &gt;&lt;/TR &gt;&lt;/TABLE &gt;&lt;/CENTER &gt; the Poisson equation describes steady diffusion processes For the Poisson problem describes the temperature distribution f f $D f</div><div class="ttdef"><b>Definition:</b> <a href="intro_8txt_source.html#l00084">intro.txt:84</a></div></div>
<div class="ttc" id="aintro_8txt_html_acfa0004f1e60e39f0aab7faadc5ec88c"><div class="ttname"><a href="intro_8txt.html#acfa0004f1e60e39f0aab7faadc5ec88c">widetilde</a></div><div class="ttdeci">D to so the approximate solution f widetilde</div><div class="ttdef"><b>Definition:</b> <a href="intro_8txt_source.html#l00515">intro.txt:515</a></div></div>
<div class="ttc" id="aintro_8txt_html_ac4307f93850d84004afb0a84de7ba5ad"><div class="ttname"><a href="intro_8txt.html#ac4307f93850d84004afb0a84de7ba5ad">Initially</a></div><div class="ttdeci">mainpage The Finite Element Method section intro Introduction This document provides a brief introduction to the finite element method and illustrates how the method is implemented in c oomph lib The first few sections present a self contained derivation of the method The exposition is constructive and avoids a number of which can be found in standard textbooks[e.g. E.B. Becker, G.F. Carey, and J.T. Oden. Finite Elements:An Introduction. Prentice-Hall, Englewood Cliffs, New Jersey,(1981)] We generally assume that all functions are sufficiently well behaved so that all mathematical manipulations make sense Function spaces are only used where they help to make the notation more compact Readers who are familiar with the theory of finite elements may skip the introductory but should consult the section ref towards_oo which explains the particular implementation used in c oomph lib Initially</div><div class="ttdef"><b>Definition:</b> <a href="intro_8txt_source.html#l00026">intro.txt:26</a></div></div>
<div class="ttc" id="aintro_8txt_html_a4011145d53a7c75c5d5009e34dc49603"><div class="ttname"><a href="intro_8txt.html#a4011145d53a7c75c5d5009e34dc49603">Hence</a></div><div class="ttdeci">adopting the natural numbering when discussing the C implementation would make this documentation inconsistent with the actual implementation We therefore use both numbering each within their appropriate context&lt;/div &gt;&lt;/TD &gt;&lt;/TR &gt;&lt;/TABLE &gt;&lt;/CENTER &gt; the Poisson equation describes steady diffusion processes For the Poisson problem describes the temperature distribution f f $D whose boundary f partial D f is maintained at a prescribed f the strength of these heat sources is bounded because no physical process can release infinite amounts of energy in a finite domain Hence</div><div class="ttdef"><b>Definition:</b> <a href="intro_8txt_source.html#l00091">intro.txt:91</a></div></div>
<div class="ttc" id="aintro_8txt_html_a668a7f95712648da277086a773cd06b0"><div class="ttname"><a href="intro_8txt.html#a668a7f95712648da277086a773cd06b0">speaking</a></div><div class="ttdeci">mathematically speaking</div><div class="ttdef"><b>Definition:</b> <a href="intro_8txt_source.html#l00450">intro.txt:450</a></div></div>
<div class="ttc" id="aintro_8txt_html_a530a37a02e224483b9789dab0bc8ecb7"><div class="ttname"><a href="intro_8txt.html#a530a37a02e224483b9789dab0bc8ecb7">Physically</a></div><div class="ttdeci">adopting the natural numbering when discussing the C implementation would make this documentation inconsistent with the actual implementation We therefore use both numbering each within their appropriate context&lt;/div &gt;&lt;/TD &gt;&lt;/TR &gt;&lt;/TABLE &gt;&lt;/CENTER &gt; Physically</div><div class="ttdef"><b>Definition:</b> <a href="intro_8txt_source.html#l00082">intro.txt:82</a></div></div>
<div class="ttc" id="aintro_8txt_html_a10a7a45578362c7ae96906ebb3d2a6e8"><div class="ttname"><a href="intro_8txt.html#a10a7a45578362c7ae96906ebb3d2a6e8">The</a></div><div class="ttdeci">f and for which f[\int_0^1 \left(\frac{\mbox{d} u(x)}{\mbox{d} x} \ \frac{\mbox{d} \phi^{(test)}(x)}{\mbox{d} x} \+f(x) \ \phi^{(test)}(x) \right)\ \mbox{d}x=0\f] for e all test functions f the higher Sobolev spaces f f would also ensure the existence of the integral but would impose unnecessary additional restrictions on our functions we need to construct a function f and the simplest option is the function f which interpolates linearly between the two boundary values Since f the discrete residuals are given by f[r_k(U_1, U_2,..., U_M)=\int_0^1 \left[\left((g_1 - g_0)+\sum_{j=1}^{M} U_j \frac{\mbox{d} \psi_j(x)}{\mbox{d} x} \right) \frac{\mbox{d} \psi_k(x)}{\mbox{d} x}+f(x) \ \psi_k(x) \right] \ \mbox{d}x \mbox{\ \ for $k=1,.., M$}, \ \ \ \ \ \ \ \ @E[discr_resid_P1]@ \f] and the Jacobian matrix has the form f[J_{kj}=\int_0^1 \frac{\mbox{d} \psi_j(x)}{\mbox{d} x} \frac{\mbox{d} \psi_k(x)}{\mbox{d} x} \ \mbox{d}x \mbox{\ \ for $j, k=1,.., M$}. \ \ \ \ \ \ \ \ @E[Jacob_P1]@ \f] The(Fourier) basis functions \f[\psi_j(x)</div></div>
<div class="ttc" id="aintro_8txt_html_a8558b047ca3469c9714d38936520cf95"><div class="ttname"><a href="intro_8txt.html#a8558b047ca3469c9714d38936520cf95">equation</a></div><div class="ttdeci">adopting the natural numbering when discussing the C implementation would make this documentation inconsistent with the actual implementation We therefore use both numbering each within their appropriate context&lt;/div &gt;&lt;/TD &gt;&lt;/TR &gt;&lt;/TABLE &gt;&lt;/CENTER &gt; the Poisson equation describes steady diffusion processes For the Poisson problem describes the temperature distribution f f $D whose boundary f partial D f is maintained at a prescribed f the strength of these heat sources is bounded because no physical process can release infinite amounts of energy in a finite domain we assume that f[\int_D f(x_i) \ dx_1 dx_2&lt; \infty.\f] We usually write all PDEs in residual obtained by moving all terms to the left hand side of the equation</div><div class="ttdef"><b>Definition:</b> <a href="intro_8txt_source.html#l00097">intro.txt:97</a></div></div>
<div class="ttc" id="aintro_8txt_html_a436e17f9d54ca59286009a5132cfef8e"><div class="ttname"><a href="intro_8txt.html#a436e17f9d54ca59286009a5132cfef8e">$u</a></div><div class="ttdeci">adopting the natural numbering when discussing the C implementation would make this documentation inconsistent with the actual implementation We therefore use both numbering each within their appropriate context&lt;/div &gt;&lt;/TD &gt;&lt;/TR &gt;&lt;/TABLE &gt;&lt;/CENTER &gt; the Poisson equation describes steady diffusion processes For the Poisson problem describes the temperature distribution f $u(x_i) \f$ within a 2D body</div></div>
<div class="ttc" id="aintro_8txt_html_a4afc37c088aecb0ea9fdfae4c2c4ccd0"><div class="ttname"><a href="intro_8txt.html#a4afc37c088aecb0ea9fdfae4c2c4ccd0">Vetterling</a></div><div class="ttdeci">and Vetterling</div><div class="ttdef"><b>Definition:</b> <a href="intro_8txt_source.html#l00527">intro.txt:527</a></div></div>
<div class="ttc" id="aintro_8txt_html_a4d8bb1ba77133c5198be832db567f5bb"><div class="ttname"><a href="intro_8txt.html#a4d8bb1ba77133c5198be832db567f5bb">temperature</a></div><div class="ttdeci">adopting the natural numbering when discussing the C implementation would make this documentation inconsistent with the actual implementation We therefore use both numbering each within their appropriate context&lt;/div &gt;&lt;/TD &gt;&lt;/TR &gt;&lt;/TABLE &gt;&lt;/CENTER &gt; the Poisson equation describes steady diffusion processes For the Poisson problem describes the temperature distribution f f $D whose boundary f partial D f is maintained at a prescribed temperature</div><div class="ttdef"><b>Definition:</b> <a href="intro_8txt_source.html#l00086">intro.txt:86</a></div></div>
<div class="ttc" id="aintro_8txt_html_ae1ab804dddfcba928c677a1b81670224"><div class="ttname"><a href="intro_8txt.html#ae1ab804dddfcba928c677a1b81670224">H_0</a></div><div class="ttdeci">in H_0(D). \f$ . \f$\widetilde</div><div class="ttdef"><b>Definition:</b> <a href="intro_8txt_source.html#l00512">intro.txt:512</a></div></div>
<div class="ttc" id="aintro_8txt_html_a7226454ed58cfa20d1291145013dceba"><div class="ttname"><a href="intro_8txt.html#a7226454ed58cfa20d1291145013dceba">however</a></div><div class="ttdeci">D to however</div><div class="ttdef"><b>Definition:</b> <a href="intro_8txt_source.html#l00514">intro.txt:514</a></div></div>
<div class="ttc" id="aintro_8txt_html_a50ca6d8f78e851220d6bafe6cad4aa50"><div class="ttname"><a href="intro_8txt.html#a50ca6d8f78e851220d6bafe6cad4aa50">to</a></div><div class="ttdeci">f where f f where f and f f&lt;/CENTER &gt;&lt;/TD &gt;&lt;/TR &gt;&lt;/TABLE &gt;&lt;/CENTER &gt; We stress that neither the finite element nor c oomph lib are restricted to scalar second order PDEs Documentation for the example drivers discusses generalisations to</div><div class="ttdef"><b>Definition:</b> <a href="intro_8txt_source.html#l00200">intro.txt:200</a></div></div>
<div class="ttc" id="aintro_8txt_html_a9b707eba406c69da923b38efd1a922ad"><div class="ttname"><a href="intro_8txt.html#a9b707eba406c69da923b38efd1a922ad">subtleties</a></div><div class="ttdeci">mainpage The Finite Element Method section intro Introduction This document provides a brief introduction to the finite element method and illustrates how the method is implemented in c oomph lib The first few sections present a self contained derivation of the method The exposition is constructive and avoids a number of subtleties</div><div class="ttdef"><b>Definition:</b> <a href="intro_8txt_source.html#l00011">intro.txt:11</a></div></div>
<div class="ttc" id="aintro_8txt_html_a226ce57475d9c32117f9b80287190efd"><div class="ttname"><a href="intro_8txt.html#a226ce57475d9c32117f9b80287190efd">$r_k</a></div><div class="ttdeci">D to so the approximate solution f the equations f $r_k(U_1,..., U_M)\f$ are nonlinear and must be solved by an iterative method such as Newton 's method. Consult your favourite numerical analysis textbook(if you can 't think of one</div></div>
<div class="ttc" id="aintro_8txt_html_a4f45d1c3b3ad61ec75e722412d0bdeaa"><div class="ttname"><a href="intro_8txt.html#a4f45d1c3b3ad61ec75e722412d0bdeaa">method</a></div><div class="ttdeci">f where f f where f and f f&lt;/CENTER &gt;&lt;/TD &gt;&lt;/TR &gt;&lt;/TABLE &gt;&lt;/CENTER &gt; We stress that neither the finite element method</div><div class="ttdef"><b>Definition:</b> <a href="intro_8txt_source.html#l00172">intro.txt:172</a></div></div>
<div class="ttc" id="aintro_8txt_html_aaf9dadf343bc42f8ae4f0ff42b0f91cd"><div class="ttname"><a href="intro_8txt.html#aaf9dadf343bc42f8ae4f0ff42b0f91cd">brief</a></div><div class="ttdeci">mainpage The Finite Element Method section intro Introduction This document provides a brief introduction to the finite element method and illustrates how the method is implemented in c oomph lib The first few sections present a brief</div><div class="ttdef"><b>Definition:</b> <a href="intro_8txt_source.html#l00009">intro.txt:9</a></div></div>
<div class="ttc" id="aintro_8txt_html_ab06edb6c154a2f27546c044d56043015"><div class="ttname"><a href="intro_8txt.html#ab06edb6c154a2f27546c044d56043015">purpose</a></div><div class="ttdeci">a class of functions that includes piecewise linear functions We shall now construct a particular set of piecewise linear basis functions often known as hat functions For this purpose</div><div class="ttdef"><b>Definition:</b> <a href="intro_8txt_source.html#l00770">intro.txt:770</a></div></div>
<div class="ttc" id="aintro_8txt_html_a83eaa3a8ae6e1f1143cd73a66ed822f6"><div class="ttname"><a href="intro_8txt.html#a83eaa3a8ae6e1f1143cd73a66ed822f6">conversely</a></div><div class="ttdeci">conversely</div><div class="ttdef"><b>Definition:</b> <a href="intro_8txt_source.html#l00069">intro.txt:69</a></div></div>
<div class="ttc" id="aintro_8txt_html_a3f06ee645524112cd97f921e588d9ce3"><div class="ttname"><a href="intro_8txt.html#a3f06ee645524112cd97f921e588d9ce3">A</a></div><div class="ttdeci">S A</div><div class="ttdef"><b>Definition:</b> <a href="intro_8txt_source.html#l00527">intro.txt:527</a></div></div>
<div class="ttc" id="aintro_8txt_html_a41bd815b9f868b318eff968815732744"><div class="ttname"><a href="intro_8txt.html#a41bd815b9f868b318eff968815732744">Flannery</a></div><div class="ttdeci">Flannery</div><div class="ttdef"><b>Definition:</b> <a href="intro_8txt_source.html#l00526">intro.txt:526</a></div></div>
<div class="ttc" id="aintro_8txt_html_a2d1ecabc713d6680adde70776518669e"><div class="ttname"><a href="intro_8txt.html#a2d1ecabc713d6680adde70776518669e">$H_0</a></div><div class="ttdeci">mathematically the only requirement is that the basis functions are sufficiently general that the solution can be represented by the the functions must be a complete basis for f $H_0(D)\f$. How do we determine the discrete coefficients \f$ U_j \f$? Inserting the expansion for \f $u(x)\f$ into the definition of the weighted residual yields \f[r</div></div>
<div class="ttc" id="aintro_8txt_html_ad096254abd121ccdd1ffb61037c4d4e1"><div class="ttname"><a href="intro_8txt.html#ad096254abd121ccdd1ffb61037c4d4e1">_j</a></div><div class="ttdeci">_j(j=1,.., M)\f$. - \f[r_k^</div><div class="ttdef"><b>Definition:</b> <a href="intro_8txt_source.html#l00536">intro.txt:536</a></div></div>
<div class="ttc" id="aintro_8txt_html_a6a528a40d98afb50b2e2e8f9f03f2b3b"><div class="ttname"><a href="intro_8txt.html#a6a528a40d98afb50b2e2e8f9f03f2b3b">H</a></div><div class="ttdeci">D to so the approximate solution f the equations f have a look through chapter in W H</div><div class="ttdef"><b>Definition:</b> <a href="intro_8txt_source.html#l00525">intro.txt:525</a></div></div>
<div class="ttc" id="aintro_8txt_html_a718b764728ff21d06b8089f1fb12dc4f"><div class="ttname"><a href="intro_8txt.html#a718b764728ff21d06b8089f1fb12dc4f">instance</a></div><div class="ttdeci">adopting the natural numbering when discussing the C implementation would make this documentation inconsistent with the actual implementation We therefore use both numbering each within their appropriate context&lt;/div &gt;&lt;/TD &gt;&lt;/TR &gt;&lt;/TABLE &gt;&lt;/CENTER &gt; the Poisson equation describes steady diffusion processes For instance</div><div class="ttdef"><b>Definition:</b> <a href="intro_8txt_source.html#l00083">intro.txt:83</a></div></div>
<div class="ttc" id="aintro_8txt_html_ac6be5a2aa88cc9fb18611ac964859566"><div class="ttname"><a href="intro_8txt.html#ac6be5a2aa88cc9fb18611ac964859566">i</a></div><div class="ttdeci">f where f f where f and f i</div><div class="ttdef"><b>Definition:</b> <a href="intro_8txt_source.html#l00165">intro.txt:165</a></div></div>
<div class="ttc" id="aintro_8txt_html_a1e779fb8018cf5766debdbbfd9c8fad7"><div class="ttname"><a href="intro_8txt.html#a1e779fb8018cf5766debdbbfd9c8fad7">matrix</a></div><div class="ttdeci">the product of their zeroth and second derivatives must be integrable over the domain The Jacobian matrix(@R[Jacob_P1]@) that arises from the symmetric form of the weak problem is symmetric for \e any choice of basis functions whereas the Jacobian matrix(@R[Jacobian_P1_asym]@) that arises from the original form is symmetric only for certain types of basis functions. This is not only advantageous for the solution of the linear system(only a fraction of the entries in the matrix need to be computed</div></div>
<div class="ttc" id="aintro_8txt_html_a2c35f2abf54a87dfb485e3f4198d0392"><div class="ttname"><a href="intro_8txt.html#a2c35f2abf54a87dfb485e3f4198d0392">coefficients</a></div><div class="ttdeci">E[(8)] f and we determine the f $M f unknown coefficients</div><div class="ttdef"><b>Definition:</b> <a href="intro_8txt_source.html#l00497">intro.txt:497</a></div></div>
<div class="ttc" id="aintro_8txt_html_aa35225ba13b71e2ef8e2beb3c063af52"><div class="ttname"><a href="intro_8txt.html#aa35225ba13b71e2ef8e2beb3c063af52">$U_1</a></div><div class="ttdeci">E[(8)] f and we determine the f $M f unknown f $U_1</div><div class="ttdef"><b>Definition:</b> <a href="intro_8txt_source.html#l00497">intro.txt:497</a></div></div>
<div class="ttc" id="aintro_8txt_html_a29199553dbc6f2c5c03671aba232d064"><div class="ttname"><a href="intro_8txt.html#a29199553dbc6f2c5c03671aba232d064">that</a></div><div class="ttdeci">f where f f where f and f f&lt;/CENTER &gt;&lt;/TD &gt;&lt;/TR &gt;&lt;/TABLE &gt;&lt;/CENTER &gt; We stress that neither the finite element nor c oomph lib are restricted to scalar second order PDEs Documentation for the example drivers discusses generalisations f[{\cal R}(x_i;u(x_i)) \equiv 0 \ \ \ \forall x_i \in D\mbox{\ \ \ \ and \ \ \ \ } u|_{\partial D}=g. \f] The concept of a weak solution is based on a slight relaxation of this criterion A weak f f of problem P is any function that satisfies the essential boundary f[u_w|_{\partial D}=g, \f] and for which the so called weighted residual f[r=\int_{D} {\cal R}(x_i;u_w(x_i)) \ \phi^{(test)}(x_i) \ \mbox{d}x_1 \mbox{d}x_2 \ \ \ \ \ \ \ \ @E[weighted_residual]@ \f] vanishes for e any test function f couldn t any function be a solution In this is not the case and we shall now demonstrate that</div><div class="ttdef"><b>Definition:</b> <a href="intro_8txt_source.html#l00220">intro.txt:220</a></div></div>
<div class="ttc" id="aintro_8txt_html_ac4927b65b7c0c0bc0868f82775813d32"><div class="ttname"><a href="intro_8txt.html#ac4927b65b7c0c0bc0868f82775813d32">$i</a></div><div class="ttdeci">0, 1, 2,...\f$ which contain all functions whose zeroth, first,..., i-th derivatives are square-integrable over the domain \f $D\f$. The members of these function spaces have the property that \f[u(x_i) \in H^0(D) \ \ \ \iff \ \ \ \int_D u^2(x_i) \ dx_1 dx_2&lt; \infty, \f] \f[u(x_i) \in H^1(D) \ \ \ \iff \ \ \ \int_D \left(u^2(x_i)+\sum_{j=1}^2 \left(\frac{\partial u(x_i)}{\partial x_j}\right)^2 \right) dx_1 dx_2&lt; \infty, \f] etc. We use the subscript &quot;0&quot; to restrict a given function space to the subset of its members which vanish on the domain boundary \f$ \partial D,\f$ \f[u(x_i) \in H^i_0(D) \ \ \ \iff \ \ \ \ u(x_i) \in H^i(D) \mbox{\ \ \ and \ \ \ } u|{\partial D}=0. \f] Using these function spaces, we can provide a concise definition of the weak form of problem P2:&lt; CENTER &gt;&lt; TABLE class=&quot;oomph-table&quot;&gt;&lt; TR &gt;&lt; TD class=&quot;panel panel-default&quot;&gt;&lt; CENTER class=&quot;panel-heading&quot;&gt;&lt; B &gt; Problem P2&lt; SUB &gt;weak&lt;/SUB &gt;&lt;/B &gt;&lt;/CENTER &gt;&lt; CENTER class=&quot;panel-body&quot;&gt; Find the function \f$ u(x_i) \in H^1(D) \f$ that satisfies the essential boundary conditions \f[\hfill u|_{\partial D}=g, \f] and for which \f[\int_D \sum_{j=1}^2 \frac{\partial u(x_i)}{\partial x_j} \ \frac{\partial \phi^{(test)}(x_i)}{\partial x_j} \ \mbox{d}x_1 \mbox{d}x_2+\int_D f(x_i) \ \phi^{(test)}(x_i) \ \mbox{d}x_1 \mbox{d}x_2=0 \f] for \e all test functions \f$ \phi^{(test)}(x_i) \in H^1_0(D). \f$&lt;/CENTER &gt;&lt;/TD &gt;&lt;/TR &gt;&lt;/TABLE &gt;&lt;/CENTER &gt; It is important to realise that the choice of suitable function spaces for \f $u(x_i)\f$ and \f$\phi^{(test)}(x_i)\f$ is problem-dependent, guided by the inspection of the weak form for a specific problem. The(pragmatic) procedure is straightforward:write down the weak form and determine the(minimal) constraints that must be imposed on \f $u(x_i)\f$ and \f$\phi(x_i)\f$ for the weak form to &quot;make sense&quot;. All functions that satisfy these constraints, are &quot;admissible&quot; and, collectively, they form a function space \f$ H(D) \f$, say. The weak form of the general problem P can then be written as \n \n&lt; CENTER &gt;&lt; TABLE class=&quot;oomph-table&quot;&gt;&lt; TR &gt;&lt; TD class=&quot;panel panel-default&quot;&gt;&lt; CENTER class=&quot;panel-heading&quot;&gt;&lt; B &gt; Problem P&lt; SUB &gt;weak&lt;/SUB &gt;&lt;/B &gt;&lt;/CENTER &gt;&lt; CENTER class=&quot;panel-body&quot;&gt; Find the function \f$ u(x_i) \in H(D) \f$ that satisfies the essential boundary conditions \f[\hfill u|_{\partial D}=g, \f] and for which \f[\int_D {\cal R}(x_i, u(x_i)) \ \phi^{(test)}(x_i) \ \mbox{d}x_1 \mbox{d}x_2=0 \f] for \e all test functions \f$ \phi^{(test)}(x_i) \in H_0(D). \f$&lt;/CENTER &gt;&lt;/TD &gt;&lt;/TR &gt;&lt;/TABLE &gt;&lt;/CENTER &gt; \n[If you followed the above argument carefully you will have realised that our strategy for ensuring that the weak form &quot;makes sense&quot; uses a sufficient rather than a necessary condition. For instance, it is not necessary for \f$ u(x_i)\f$ and \f$ \phi^{(test)}(x_i)\f$ to be members of the same function space. Alternative formulations are possible but we shall not pursue such ideas any further in this introduction.]&lt; HR &gt; \subsection galerkin The Galerkin method We now exploit the definition of the weak solution to develop a numerical method that can be used to determine approximate solutions to problem P&lt; SUB &gt;weak&lt;/SUB &gt;. We start by splitting the solution into two parts, \f[u(x_i)=u_{h}(x_i)+u_{p}(x_i), \f] where \f$ u_{p}(x_i)\f$ is an(arbitrary) function that satisfies the Dirichlet boundary conditions, \f[u_{p}|_{\partial D}=g. \f] The unknown function \f$ u_{h}(x_i) \f$ then has to satisfy the homogeneous boundary conditions \f[u_{h}|_{\partial D}=0.\f] We expand \f$ u_{h}(x_i) \f$ in terms of a(given) infinite set of basis functions \f$ \psi_j(x_i) \in H_0(D) \ \ \(j=1,...,\infty) \f$, \f[u(x_i)=u_{p}(x_i)+\sum_{j=1}^{\infty} U_j \psi_j(x_i), \ \ \ \ \ \ @E[(3)]@ \f] which discretises the problem because the solution is now determined by the(as yet unknown) discrete coefficients \f$ U_j \ \ \(j=1,...,\infty). \f$ There are many possible sets of basis functions:polynomials, trigonometric functions, systems of eigenfunctions $i</div><div class="ttdef"><b>Definition:</b> <a href="intro_8txt_source.html#l00450">intro.txt:450</a></div></div>
<div class="ttc" id="aintro_8txt_html_ac82e7257a43c59f1f7868e8bc87c49c8"><div class="ttname"><a href="intro_8txt.html#ac82e7257a43c59f1f7868e8bc87c49c8">systems</a></div><div class="ttdeci">adopting the natural numbering when discussing the C implementation would make this documentation inconsistent with the actual implementation We therefore use both numbering systems</div><div class="ttdef"><b>Definition:</b> <a href="intro_8txt_source.html#l00072">intro.txt:72</a></div></div>
<div class="ttc" id="aintro_8txt_html_a5d25cb4ba1861ce4a6e5b53328470653"><div class="ttname"><a href="intro_8txt.html#a5d25cb4ba1861ce4a6e5b53328470653">u_p</a></div><div class="ttdeci">f and for which f[\int_0^1 \left(\frac{\mbox{d} u(x)}{\mbox{d} x} \ \frac{\mbox{d} \phi^{(test)}(x)}{\mbox{d} x} \+f(x) \ \phi^{(test)}(x) \right)\ \mbox{d}x=0\f] for e all test functions f the higher Sobolev spaces f f would also ensure the existence of the integral but would impose unnecessary additional restrictions on our functions we need to construct a function f and the simplest option is the function f u_p(x)</div></div>
<div class="ttc" id="aintro_8txt_html_afb60e86c5a4bc881a6f86752e0d8e72b"><div class="ttname"><a href="intro_8txt.html#afb60e86c5a4bc881a6f86752e0d8e72b">by</a></div><div class="ttdeci">f where the function f $g f is given&lt;/CENTER &gt;&lt;/TD &gt;&lt;/TR &gt;&lt;/TABLE &gt;&lt;/CENTER &gt; To keep the notation we suppress the dependence of the residual forms of the two Poisson problems are given by</div><div class="ttdef"><b>Definition:</b> <a href="intro_8txt_source.html#l00136">intro.txt:136</a></div></div>
<div class="ttc" id="aintro_8txt_html_ad82b3af3f60293545ff52365c15128e9"><div class="ttname"><a href="intro_8txt.html#ad82b3af3f60293545ff52365c15128e9">and</a></div><div class="ttdeci">the product of their zeroth and second derivatives must be integrable over the domain The Jacobian and(more efficient) linear solvers that exploit the symmetry of the matrix can be used)</div></div>
<div class="ttc" id="aintro_8txt_html_a900930ee7ec882fc683437afc0eebc81"><div class="ttname"><a href="intro_8txt.html#a900930ee7ec882fc683437afc0eebc81">Teukolsky</a></div><div class="ttdeci">Teukolsky</div><div class="ttdef"><b>Definition:</b> <a href="intro_8txt_source.html#l00527">intro.txt:527</a></div></div>
<div class="ttc" id="aintro_8txt_html_a815c7caeb20923220296c8663a500a05"><div class="ttname"><a href="intro_8txt.html#a815c7caeb20923220296c8663a500a05">u</a></div><div class="ttdeci">u(x))</div></div>
<div class="ttc" id="aintro_8txt_html_ac9a7f65d68effd73a8e72884b5250dbd"><div class="ttname"><a href="intro_8txt.html#ac9a7f65d68effd73a8e72884b5250dbd">mbox</a></div><div class="ttdeci">f and for which f[\int_0^1 \left(\frac{\mbox{d} u(x)}{\mbox{d} x} \ \frac{\mbox{d} \phi^{(test)}(x)}{\mbox{d} x} \+f(x) \ \phi^{(test)}(x) \right)\ \mbox{d}x=0\f] for e all test functions f the higher Sobolev spaces f f would also ensure the existence of the integral but would impose unnecessary additional restrictions on our functions we need to construct a function f and the simplest option is the function f which interpolates linearly between the two boundary values Since f mbox</div><div class="ttdef"><b>Definition:</b> <a href="intro_8txt_source.html#l00631">intro.txt:631</a></div></div>
<div class="ttc" id="aintro_8txt_html_a5a554936ed16ec837fd02cf6290e1259"><div class="ttname"><a href="intro_8txt.html#a5a554936ed16ec837fd02cf6290e1259">fact</a></div><div class="ttdeci">f where f f where f and f f&lt;/CENTER &gt;&lt;/TD &gt;&lt;/TR &gt;&lt;/TABLE &gt;&lt;/CENTER &gt; We stress that neither the finite element nor c oomph lib are restricted to scalar second order PDEs Documentation for the example drivers discusses generalisations f[{\cal R}(x_i;u(x_i)) \equiv 0 \ \ \ \forall x_i \in D\mbox{\ \ \ \ and \ \ \ \ } u|_{\partial D}=g. \f] The concept of a weak solution is based on a slight relaxation of this criterion A weak f f of problem P is any function that satisfies the essential boundary f[u_w|_{\partial D}=g, \f] and for which the so called weighted residual f[r=\int_{D} {\cal R}(x_i;u_w(x_i)) \ \phi^{(test)}(x_i) \ \mbox{d}x_1 \mbox{d}x_2 \ \ \ \ \ \ \ \ @E[weighted_residual]@ \f] vanishes for e any test function f couldn t any function be a solution In fact</div><div class="ttdef"><b>Definition:</b> <a href="intro_8txt_source.html#l00219">intro.txt:219</a></div></div>
<div class="ttc" id="aintro_8txt_html_a7c22dd7a7c7b3b9c954964ef3bb5488d"><div class="ttname"><a href="intro_8txt.html#a7c22dd7a7c7b3b9c954964ef3bb5488d">conditions</a></div><div class="ttdeci">f where f f where f and f f&lt;/CENTER &gt;&lt;/TD &gt;&lt;/TR &gt;&lt;/TABLE &gt;&lt;/CENTER &gt; We stress that neither the finite element nor c oomph lib are restricted to scalar second order PDEs Documentation for the example drivers discusses generalisations f[{\cal R}(x_i;u(x_i)) \equiv 0 \ \ \ \forall x_i \in D\mbox{\ \ \ \ and \ \ \ \ } u|_{\partial D}=g. \f] The concept of a weak solution is based on a slight relaxation of this criterion A weak f f of problem P is any function that satisfies the essential boundary f[u_w|_{\partial D}=g, \f] and for which the so called weighted residual f[r=\int_{D} {\cal R}(x_i;u_w(x_i)) \ \phi^{(test)}(x_i) \ \mbox{d}x_1 \mbox{d}x_2 \ \ \ \ \ \ \ \ @E[weighted_residual]@ \f] vanishes for e any test function f couldn t any function be a solution In this is not the case and we shall now demonstrate for all practical the statement f[\mbox{ &quot;weak solutions are strong solutions&quot; } \f] is true The crucial observation is that the weak solution requires the weighted residual to vanish for e any test function To show that this is equivalent to demanding that let us try to construct a counter example for which and that we would have to re assess the argument etc&lt; HR &gt; subsection int_by_parts_1 A useful f[\int_D \left(\sum_{j=1}^2 \frac{\partial^2 u(x_i)}{\partial x_j^2} -f(x_i) \right) \phi^{(test)}(x_i) \ \mbox{d}x_1 \mbox{d}x_2=0\mbox{\ \ \ \ subject to\ \ \ \ } u|_{\partial D}=g. \ \ \ \ \ \ \ \ @E conditions[weak_P2]@ \f] After integration by parts and use of the divergence we obtain f[\int_D \sum_{j=1}^2 \frac{\partial u(x_i)}{\partial x_j} \ \frac{\partial \phi^{(test)}(x_i)}{\partial x_j} \ \mbox{d}x_1 \mbox{d}x_2+\int_D f(x_i) \ \phi^{(test)}(x_i) \ \mbox{d}x_1 \mbox{d}x_2=\oint_{\partial D} \frac{\partial u}{\partial n} \ \phi^{(test)} \ \mbox{d}s, \ \ \ \ \ @E[weak_P2_by_parts]@ \f] where f $s f is the arclength along the domain boundary f partial D f and f partial partial n f the outward normal derivative Since the test functions satisfy homogeneous boundary</div><div class="ttdef"><b>Definition:</b> <a href="intro_8txt_source.html#l00293">intro.txt:293</a></div></div>
<div class="ttc" id="aintro_8txt_html_adc1b55bf327e8ceb34bb21b28d2495ce"><div class="ttname"><a href="intro_8txt.html#adc1b55bf327e8ceb34bb21b28d2495ce">Equation</a></div><div class="ttdeci">mathematically the only requirement is that the basis functions are sufficiently general that the solution can be represented by the the functions must be a complete basis for f E[(4)] f and we recall that this equation must be satisfied for e any test function f and so all possible test functions f the condition f[\mbox{...for any basis function $ \phi^{(test)}(x_i) $...} \f] becomes f[\mbox{...for any values of the coefficients $ \Phi_k$...} \f] Inserting the E[(6)] f where f[r_k(U_1, U_2,...)=\int_{D} {\cal R}\left(x_i;\ u_{p}(x_i)+\sum_{j=1}^{\infty} U_j \psi_j(x_i)\right) \ \psi_k(x_i) \ \mbox{d}x_1 \mbox{d}x_2. \ \ \ \ \ \ \ @E[(7)]@ \f] Equation(@R[(6)]@) must hold for \e any value of the coefficients \f$ \Phi_k \f$</div></div>
<div class="ttc" id="aintro_8txt_html_a1b06aac308cf9f203e7511144b33c634"><div class="ttname"><a href="intro_8txt.html#a1b06aac308cf9f203e7511144b33c634">$u_w</a></div><div class="ttdeci">f where f f where f and f f&lt;/CENTER &gt;&lt;/TD &gt;&lt;/TR &gt;&lt;/TABLE &gt;&lt;/CENTER &gt; We stress that neither the finite element nor c oomph lib are restricted to scalar second order PDEs Documentation for the example drivers discusses generalisations f[{\cal R}(x_i;u(x_i)) \equiv 0 \ \ \ \forall x_i \in D\mbox{\ \ \ \ and \ \ \ \ } u|_{\partial D}=g. \f] The concept of a weak solution is based on a slight relaxation of this criterion A weak f $u_w(x_i)</div></div>
<div class="ttc" id="aintro_8txt_html_ab88fb56e11957a98cfea99083720173f"><div class="ttname"><a href="intro_8txt.html#ab88fb56e11957a98cfea99083720173f">for</a></div><div class="ttdeci">f where f f where f and f f&lt;/CENTER &gt;&lt;/TD &gt;&lt;/TR &gt;&lt;/TABLE &gt;&lt;/CENTER &gt; We stress that neither the finite element nor c oomph lib are restricted to scalar second order PDEs Documentation for the example drivers discusses generalisations f[{\cal R}(x_i;u(x_i)) \equiv 0 \ \ \ \forall x_i \in D\mbox{\ \ \ \ and \ \ \ \ } u|_{\partial D}=g. \f] The concept of a weak solution is based on a slight relaxation of this criterion A weak f f of problem P is any function that satisfies the essential boundary f[u_w|_{\partial D}=g, \f] and for which the so called weighted residual f[r=\int_{D} {\cal R}(x_i;u_w(x_i)) \ \phi^{(test)}(x_i) \ \mbox{d}x_1 \mbox{d}x_2 \ \ \ \ \ \ \ \ @E[weighted_residual]@ \f] vanishes for e any test function f couldn t any function be a solution In this is not the case and we shall now demonstrate for all practical the statement f[\mbox{ &quot;weak solutions are strong solutions&quot; } \f] is true The crucial observation is that the weak solution requires the weighted residual to vanish for e any test function To show that this is equivalent to demanding that let us try to construct a counter example for which and that we would have to re assess the argument for(pathological) cases in which the residual is nonzero only at finite number of points</div></div>
<div class="ttc" id="aintro_8txt_html_a1bdb7f0238b7b0b18826272a08ebb7dd"><div class="ttname"><a href="intro_8txt.html#a1bdb7f0238b7b0b18826272a08ebb7dd">how</a></div><div class="ttdeci">and W T Numerical Recipes in C The Art of Scientific Cambridge University Press for a reminder of how(and why) Newton 's method works. The following algorithm shows the method applied to our equations</div><div class="ttdef"><b>Definition:</b> <a href="intro_8txt_source.html#l00529">intro.txt:529</a></div></div>
<div class="ttc" id="aintro_8txt_html_ad2a33511ca90c23a1235a455ce3a4adb"><div class="ttname"><a href="intro_8txt.html#ad2a33511ca90c23a1235a455ce3a4adb">the</a></div><div class="ttdeci">the product of their zeroth and second derivatives must be integrable over the domain The Jacobian but also properly reflects the symmetry in the(self-adjoint!) ODE. .&lt;/div &gt;&lt;/TD &gt;&lt;/TR &gt;&lt;/TABLE &gt;&lt;/CENTER &gt;&lt; HR &gt;&lt; HR &gt; \section fe The Finite Element Method Galerkin 's method is an efficient method for finding the approximate solution to a given problem if(and only if) we can</div><div class="ttdef"><b>Definition:</b> <a href="intro_8txt_source.html#l00717">intro.txt:717</a></div></div>
<div class="ttc" id="aintro_8txt_html_a0a79951963bab7b7103c4e8acd93f77f"><div class="ttname"><a href="intro_8txt.html#a0a79951963bab7b7103c4e8acd93f77f">sections</a></div><div class="ttdeci">mainpage The Finite Element Method section intro Introduction This document provides a brief introduction to the finite element method and illustrates how the method is implemented in c oomph lib The first few sections present a self contained derivation of the method The exposition is constructive and avoids a number of which can be found in standard textbooks[e.g. E.B. Becker, G.F. Carey, and J.T. Oden. Finite Elements:An Introduction. Prentice-Hall, Englewood Cliffs, New Jersey,(1981)] We generally assume that all functions are sufficiently well behaved so that all mathematical manipulations make sense Function spaces are only used where they help to make the notation more compact Readers who are familiar with the theory of finite elements may skip the introductory sections</div><div class="ttdef"><b>Definition:</b> <a href="intro_8txt_source.html#l00023">intro.txt:23</a></div></div>
<div class="ttc" id="aintro_8txt_html_a6c5f768c318aa9c1c63a9f78bd84332c"><div class="ttname"><a href="intro_8txt.html#a6c5f768c318aa9c1c63a9f78bd84332c">g</a></div><div class="ttdeci">adopting the natural numbering when discussing the C implementation would make this documentation inconsistent with the actual implementation We therefore use both numbering each within their appropriate context&lt;/div &gt;&lt;/TD &gt;&lt;/TR &gt;&lt;/TABLE &gt;&lt;/CENTER &gt; the Poisson equation describes steady diffusion processes For the Poisson problem describes the temperature distribution f f $D whose boundary f partial D f is maintained at a prescribed f g(x_i)\f$. The function \f$ f(x_i)\f$ describes the strength of(distributed) heat sources in the body. In practical applications</div></div>
<div class="ttc" id="aintro_8txt_html_ac5756b516ae9ee54306c5a31512568e5"><div class="ttname"><a href="intro_8txt.html#ac5756b516ae9ee54306c5a31512568e5">Press</a></div><div class="ttdeci">D to so the approximate solution f the equations f have a look through chapter in Press</div><div class="ttdef"><b>Definition:</b> <a href="intro_8txt_source.html#l00525">intro.txt:525</a></div></div>
<div class="ttc" id="aintro_8txt_html_a0582ff70f0233218754fe261aef712ca"><div class="ttname"><a href="intro_8txt.html#a0582ff70f0233218754fe261aef712ca">Next</a></div><div class="ttdeci">f and for which f[\int_0^1 \left(\frac{\mbox{d} u(x)}{\mbox{d} x} \ \frac{\mbox{d} \phi^{(test)}(x)}{\mbox{d} x} \+f(x) \ \phi^{(test)}(x) \right)\ \mbox{d}x=0\f] for e all test functions f the higher Sobolev spaces f f would also ensure the existence of the integral but would impose unnecessary additional restrictions on our functions Next</div><div class="ttdef"><b>Definition:</b> <a href="intro_8txt_source.html#l00627">intro.txt:627</a></div></div>
<div class="ttc" id="aintro_8txt_html_a69f138496db3ebde4b24d470abde0964"><div class="ttname"><a href="intro_8txt.html#a69f138496db3ebde4b24d470abde0964">x_i</a></div><div class="ttdeci">x_i</div><div class="ttdef"><b>Definition:</b> <a href="intro_8txt_source.html#l00493">intro.txt:493</a></div></div>
<div class="ttc" id="aintro_8txt_html_a9eb0a724dc40394effc28af4c3f346f5"><div class="ttname"><a href="intro_8txt.html#a9eb0a724dc40394effc28af4c3f346f5">Dirichlet</a></div><div class="ttdeci">adopting the natural numbering when discussing the C implementation would make this documentation inconsistent with the actual implementation We therefore use both numbering each within their appropriate context&lt;/div &gt;&lt;/TD &gt;&lt;/TR &gt;&lt;/TABLE &gt;&lt;/CENTER &gt; the Poisson equation describes steady diffusion processes For the Poisson problem describes the temperature distribution f f $D whose boundary f partial D f is maintained at a prescribed f the strength of these heat sources is bounded because no physical process can release infinite amounts of energy in a finite domain we assume that f[\int_D f(x_i) \ dx_1 dx_2&lt; \infty.\f] We usually write all PDEs in residual obtained by moving all terms to the left hand side of the so that the general second order scalar PDE problem is&lt; CENTER &gt;&lt; TABLE class=&quot;oomph-table&quot;&gt;&lt; TR &gt;&lt; TD class=&quot;panel panel-default&quot;&gt;&lt; CENTER class=&quot;panel-heading&quot;&gt;&lt; B &gt; Problem P&lt;/B &gt;&lt;/CENTER &gt;&lt; CENTER class=&quot;panel-body&quot;&gt; f[{\cal R}\left(x_i;u(x_i), \frac{\partial u}{\partial x_i}, \frac{\partial^2 u}{\partial x_i \ \partial x_j}\right)=0 \ \mbox{ \ \ \ \ in \ \ \ } D,\f] with Dirichlet(essential) boundary conditions on \f$ \partial D \f$ \f[\hfill u|_</div><div class="ttdef"><b>Definition:</b> <a href="intro_8txt_source.html#l00112">intro.txt:112</a></div></div>
<div class="ttc" id="aintro_8txt_html_ab2ee804002f86d23da2f2e0a8dd51e31"><div class="ttname"><a href="intro_8txt.html#ab2ee804002f86d23da2f2e0a8dd51e31">whereas</a></div><div class="ttdeci">whereas(@R[weak_P2]@) involves second derivatives of \f$ u \f$ and the zero-th derivatives of \f$ \phi^</div><div class="ttdef"><b>Definition:</b> <a href="intro_8txt_source.html#l00303">intro.txt:303</a></div></div>
<div class="ttc" id="aintro_8txt_html_a7eb1aff8cf3e540c578615bd32025144"><div class="ttname"><a href="intro_8txt.html#a7eb1aff8cf3e540c578615bd32025144">expansion</a></div><div class="ttdeci">mathematically the only requirement is that the basis functions are sufficiently general that the solution can be represented by the expansion(@R[(3)]@). In other words</div></div>
<div class="ttc" id="aintro_8txt_html_a92efc6f00dcfe4a0bae149c2b991a22f"><div class="ttname"><a href="intro_8txt.html#a92efc6f00dcfe4a0bae149c2b991a22f">order</a></div><div class="ttdeci">mainpage The Finite Element Method section intro Introduction This document provides a brief introduction to the finite element method and illustrates how the method is implemented in c oomph lib The first few sections present a self contained derivation of the method The exposition is constructive and avoids a number of which can be found in standard textbooks[e.g. E.B. Becker, G.F. Carey, and J.T. Oden. Finite Elements:An Introduction. Prentice-Hall, Englewood Cliffs, New Jersey,(1981)] We generally assume that all functions are sufficiently well behaved so that all mathematical manipulations make sense Function spaces are only used where they help to make the notation more compact Readers who are familiar with the theory of finite elements may skip the introductory but should consult the section ref towards_oo which explains the particular implementation used in c oomph lib we develop the method for scalar second order(elliptic) PDEs with Dirichlet boundary conditions</div></div>
<div class="ttc" id="aintro_8txt_html_a09073ab68fe6664fdc56e2ae06b998d4"><div class="ttname"><a href="intro_8txt.html#a09073ab68fe6664fdc56e2ae06b998d4">expansions</a></div><div class="ttdeci">mathematically the only requirement is that the basis functions are sufficiently general that the solution can be represented by the the functions must be a complete basis for f E[(4)] f and we recall that this equation must be satisfied for e any test function f and so all possible test functions f the condition f[\mbox{...for any basis function $ \phi^{(test)}(x_i) $...} \f] becomes f[\mbox{...for any values of the coefficients $ \Phi_k$...} \f] Inserting the E[(6)] f where f[r_k(U_1, U_2,...)=\int_{D} {\cal R}\left(x_i;\ u_{p}(x_i)+\sum_{j=1}^{\infty} U_j \psi_j(x_i)\right) \ \psi_k(x_i) \ \mbox{d}x_1 \mbox{d}x_2. \ \ \ \ \ \ \ @E[(7)]@ \f] so the coefficients f U_j f must satisfy the equations f[r_k(U_1, U_2,...)=0, \mbox{ \ \ \ \ for } k=1, 2,... \f] In we truncate the expansions(@R[(3)]@) and(@R[(5)]@) after a finite number of terms to obtain the approximations(indicated by tildes) \f[\widetilde</div><div class="ttdef"><b>Definition:</b> <a href="intro_8txt_source.html#l00490">intro.txt:490</a></div></div>
<div class="ttc" id="aintro_8txt_html_a2c100cd1e8d74479a32db348a267263e"><div class="ttname"><a href="intro_8txt.html#a2c100cd1e8d74479a32db348a267263e">$u_p</a></div><div class="ttdeci">f and for which f[\int_0^1 \left(\frac{\mbox{d} u(x)}{\mbox{d} x} \ \frac{\mbox{d} \phi^{(test)}(x)}{\mbox{d} x} \+f(x) \ \phi^{(test)}(x) \right)\ \mbox{d}x=0\f] for e all test functions f the higher Sobolev spaces f f would also ensure the existence of the integral but would impose unnecessary additional restrictions on our functions we need to construct a function f $u_p(x)\f$ that satisfies the Dirichlet boundary conditions. In 1D this is trivial</div></div>

    <!-- jQuery for Bootstrap and Doxygen -->
    <script src="../../js/jquery-1.12.0.min.js"></script>
    <!-- Minified boostrap plugins-->
    <script src="../../js/bootstrap.js"></script>
    <!-- Doxygen dependency to add powertips to source code-->
    <script src="../../js/jquery.powertip.min.js"></script>
    <!-- The  following script is generated by doxygen and hides/shows levels in 
         the data structure lists and adds powertips to source code-->
    <script src="../../js/dynsections.js" ></script>
    <!-- add to Doxygen's class names so bootstrap css and js recognises them-->
    <script type="text/javascript">
    $(".contents").addClass("container");
    $(".header").addClass("container");
    $(".navpath").addClass("container");
    $("#navrow3").addClass("container");
    $("#navrow4").addClass("container");
    $(".mlabel").addClass("label");
    $(".mlabel").addClass("label-default");
    $(".memitem").addClass("panel");
    $(".memitem").addClass("panel-info");
    $(".memproto").addClass("panel-heading");
    $(".memdoc").addClass("panel-body");
    </script>
    <footer>
      <div class="container">
        <div class="text-muted" style="float:right;">Generated by <a href="http://www.doxygen.org/index.html">
          <img style="height:18px;" class="footer-img" src="doxygen.png" alt="doxygen"></a> on Wed Aug 18 2021 17:30:18
        </div>
      </div>
    </footer>
</body>
</html>

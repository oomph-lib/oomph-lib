<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
<title>oomph-lib: The spatially-adaptive solution of azimuthally Fourier-decomposed time-harmonic 3D acoustic fluid-structure interaction problems on unstructured meshes</title>
<link rel="apple-touch-icon" sizes="57x57" href="../../../figures/apple-touch-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="../../../figures/apple-touch-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="../../../figures/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="../../../figures/apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="../../../figures/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="../../../figures/apple-touch-icon-120x120.png">
<link rel="icon" type="image/png" href="../../../figures/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="../../../figures/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="../../../figures/favicon-16x16.png" sizes="16x16">
<link rel="manifest" href="../../../figures/manifest.json">
<link rel="mask-icon" href="../../../figures/safari-pinned-tab.svg" color="#008000">
<link rel="shortcut icon" href="../../../figures/favicon.ico">
<meta name="msapplication-TileColor" content="#00a300">
<meta name="msapplication-config" content="../../../figures/browserconfig.xml">
<meta name="theme-color" content="#008000">
<link href="http://fonts.googleapis.com/css?family=Open+Sans:400,300,600" rel="stylesheet" type="text/css">
<!-- Doxygen css-->
<!-- <link rel="stylesheet" type="text/css" href="doxygen.css"> -->
<!-- Bootstrap -->
<link href="../../../css/bootstrap.css" rel="stylesheet">
<!-- oomph-lib specific overrides -->
<link rel="stylesheet" type="text/css" href="../../../css/oomph_header.css">
</head>
<body>
<nav class="navbar navbar-default">
<div class="container">
<div class="container-fluid">
  <!-- Brand and toggle get grouped for better mobile display -->
  <div class="navbar-header">
    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
      <span class="sr-only">Toggle navigation</span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="../../../html/index.html"><img alt="oomph-lib" src="../../../figures/oomph_logo.png"></a>
  </div>
  <!-- Collect the nav links, forms, and other content for toggling -->
  <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
    <ul class="nav navbar-nav">          
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Documentation <span class="caret"></span></a>
        <ul class="dropdown-menu">
          <li class="dropdown-header">Big picture</li>
          <li><a href="../../../../doc/intro/html/index.html">The finite element method</a></li>
          <li><a href="../../../../doc/the_data_structure/html/index.html">The data structure</a></li>
          <li><a href="../../../../doc/quick_guide/html/index.html">Not-so-quick guide</a></li>
          <li><a href="../../../../doc/optimisation/html/index.html">Optimisation</a></li>
          <li><a href="../../../../doc/order_of_action_functions/html/index.html">Order of action functions</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Example codes and tutorials</li>
          <li><a href="../../../../doc/example_code_list/html/index.html">List of example codes and tutorials</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#meshes">Meshing</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#solvers">Solvers</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#parallel">MPI parallel processing</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#visualisation">Post-processing/visualisation</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Other</li>
          <li><a href="../../../../doc/change_log/html/index.html">Change log</a></li>
          <li><a href="../../../../doc/creating_doc/html/index.html">Creating documentation</a></li>
          <li><a href="../../../../doc/coding_conventions/html/index.html">Coding conventions</a></li>
          <li><a href="../../../../doc/index/html/index.html">Index</a></li>
          <li><a href="../../../../doc/FAQ/html/index.html">FAQ</a></li>
        </ul>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Installation<span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../../doc/the_distribution/html/index.html">Installation guide</a></li>
            <li><a href="../../../../doc/copyright/html/index.html">Copyright</a></li>
          </ul>
        </li>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">About <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../../doc/people/html/index.html">People</a></li>            
            <li><a href="../../../../doc/contact/html/index.html">Contact/Get involved</a></li>
            <li><a href="../../../../doc/publications/html/index.html">Publications</a></li>
            <li><a href="../../../../doc/acknowledgements/html/index.html">Acknowledgements</a></li>
            <li><a href="../../../../doc/picture_show/index.html">Picture show</a></li>
          </ul>
        </li>
      </li>
    </ul>
    <ul class="nav navbar-nav navbar-right navbar-search">
      <form class="navbar-form" role="search" action="../../../../doc/search_results/html/index.html">
        <div class="input-group">
          <input type="text" class="form-control" placeholder="Search" name="q">
          <span class="input-group-btn">
            <button class="btn btn-default" type="submit">Go</button>
          </span>
        </div><!-- /input-group -->
       <!--<div class="form-group">
          <input type="text" class="form-control" placeholder="Search">
        </div>
        <button type="submit" class="btn btn-default">Submit</button>-->
      </form>
    </ul>
  </div><!-- /.navbar-collapse -->
</div><!-- /.container-fluid -->
</div>
</nav>
<!-- Generated by Doxygen 1.9.1 -->
</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">The spatially-adaptive solution of azimuthally Fourier-decomposed time-harmonic 3D acoustic fluid-structure interaction problems on unstructured meshes </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>In this document we discuss the spatially-adaptive solution of 3D time-harmonic acoustic fluid-structure interaction problems in cylindrical polar coordinates on unstructured meshes.</p>
<p>The driver code is very similar to the one presented in <a href="../../sphere/html/index.html">another tutorial</a> and we only discuss the changes necessary to deal with the generation of the adaptive, unstructured meshes and the assignment of different material properties to different parts of the solid domain.</p>
<hr  />
 <hr  />
<h1><a class="anchor" id="test"></a>
A test problem</h1>
<p>The sketch below shows the problem setup: An elastic sphere which is reinforced with an azimuthal T-rib is immersed in a compressible fluid and subjected to a time-periodic pressure load of magnitude </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ {\bf t} = P ( \exp(\alpha(\theta-\pi/4)^2) + \exp(\alpha(\theta-3\pi/4)^2) ) \]" src="form_0.png" width="250" height="16"/>
</p>
<p> (where <img class="formulaInl" alt="$ \theta $" src="form_1.png" width="6" height="10"/> is the zenith angle) along its inner surface. The parameter <img class="formulaInl" alt="$ \alpha $" src="form_2.png" width="8" height="6"/> controls the "sharpness" of the pressure load. For <img class="formulaInl" alt="$ \alpha=0 $" src="form_3.png" width="30" height="9"/> we obtain a uniform, spherically symmetric load; the sketch below shows the pressure distribution (red vectors indicating the traction) for <img class="formulaInl" alt="$ \alpha = 200. $" src="form_4.png" width="46" height="9"/></p>
<div class="image">
<img src="setup.gif" alt=""/>
<div class="caption">
Sketch of the problem setup. </div></div>
 <hr  />
 <hr  />
<h1><a class="anchor" id="results"></a>
Results</h1>
<p>The figure below shows an animation of the structure's time-harmonic oscillation. The blue shaded region shows the shape of the oscillating structure while the pink region shows its undeformed configuration. The left half of the plot is used to show the (mirror image of the) adaptive unstructured mesh on which the displacement field was computed:</p>
<div class="image">
<img src="anim.gif" alt=""/>
<div class="caption">
Animation of the time-harmonic deformation. </div></div>
 <p>Here is a plot of the corresponding fluid displacement potential, a measure of the fluid pressure: <br  />
</p>
<div class="image">
<img src="potential_unstr.gif" alt=""/>
<div class="caption">
The fluid displacement potential, a measure of the fluid pressure. Elevation: real part; contours: imaginary part. </div></div>
 <p>This looks very pretty and shows that we can solve acoustic FSI problems in non-trivial geometries but should you believe the results? Here's an attempt to convince you: If we make the rib much softer than the sphere and set its inertia to zero, the rib will not offer much structural resistance and the sphere will deform as if the rib was not present. If we then set <img class="formulaInl" alt="$ \alpha = 0 $" src="form_5.png" width="30" height="9"/> we apply a spherically symmetric forcing onto the structure and would expect the resulting displacement field (at least in the sphere) to be spherically symmetric, too.</p>
<p>The animation of the displacement field for this case, shown below, shows that this is indeed the case:</p>
<div class="image">
<img src="anim_alpha0.gif" alt=""/>
<div class="caption">
Animation of the time-harmonic deformation for a uniform pressure load and a very soft and inertia-less rib. </div></div>
 <p>Here is a plot of the corresponding fluid displacement potential, a measure of the fluid pressure:</p>
<div class="image">
<img src="potential_unstr_alpha0.gif" alt=""/>
<div class="caption">
The fluid displacement potential, a measure of the fluid pressure for a uniform pressure load and a very soft and inertia-less rib. Elevation: real part; contours: imaginary part. </div></div>
 <hr  />
 <hr  />
<h1><a class="anchor" id="num"></a>
The numerical solution</h1>
<p>The driver code for this problem is very similar to the one discussed in <a href="../../sphere/html/index.html">another tutorial</a>. Running <code>sdiff</code> on the two driver codes </p><center> <a href="../../../../demo_drivers/interaction/fourier_decomposed_acoustic_fsi/fourier_decomposed_acoustic_fsi.cc">demo_drivers/interaction/fourier_decomposed_acoustic_fsi/fourier_decomposed_acoustic_fsi.cc </a> </center><p> and </p><center> <a href="../../../../demo_drivers/interaction/fourier_decomposed_acoustic_fsi/unstructured_fourier_decomposed_acoustic_fsi.cc">demo_drivers/interaction/fourier_decomposed_acoustic_fsi/unstructured_fourier_decomposed_acoustic_fsi.cc </a> </center><p> shows you the differences, the most important of which are:</p><ul>
<li>The provision of multiple non-dimensional Young's moduli and frequency parameters for the two different regions (the rib and the sphere). <a href="../../../time_harmonic_fourier_decomposed_linear_elasticity/cylinder/html/index.html#comments">Recall</a> that the non-dimensional Young's modulus specified via <code>TimeHarmonicFourierDecomposedLinearElasticityEquations::youngs_modulus_pt()</code> represents the ratio of the material's actual Young's modulus to the Young's modulus used in <a href="../../../time_harmonic_fourier_decomposed_linear_elasticity/cylinder/html/index.html#theory">the non-dimensionalisation of the equations. </a> <br  />
<br  />
</li>
<li>The change of forcing from a prescribed time-harmonic displacement to a pressure load on the inside boundary &ndash; this requires yet another mesh of <code>FaceElements</code>. <br  />
<br  />
</li>
<li>The provision of the <code>actions_before/after_adapt</code>() functions and a helper function <code>complete_problem_setup()</code> which rebuilds the elements (by passing the problem parameters to the elements) following the unstructured mesh adaptation. (The need/rationale for such a function is discussed in <a href="../../../meshes/mesh_from_inline_triangle/html/index.html">another tutorial.</a>) <br  />
<br  />
</li>
<li>The mesh generation &ndash; the specification of the curvilinear boundaries and the geometry of the rib is somewhat tedious. We refer to <a href="../../../meshes/mesh_from_inline_triangle_internal_boundaries/html/index.html">another tutorial</a> for a discussion of how to define the internal mesh boundary that separates the two regions (the rib and the sphere) so that we can assign different material properties to them. <br  />
<br  />
. <br  />
 All of this is reasonably straightforward and provides a powerful code that automatically adapts both meshes while respecting the curvilinear boundaries of the domain. Have a look through the driver code and play with it.</li>
</ul>
<hr  />
 <hr  />
<h1><a class="anchor" id="code"></a>
Code listing</h1>
<p>Here's a listing of the complete driver code:</p>
<div class="fragment"><div class="line"><span class="comment">//LIC// ====================================================================</span></div>
<div class="line"><span class="comment">//LIC// This file forms part of oomph-lib, the object-oriented, </span></div>
<div class="line"><span class="comment">//LIC// multi-physics finite-element library, available </span></div>
<div class="line"><span class="comment">//LIC// at http://www.oomph-lib.org.</span></div>
<div class="line"><span class="comment">//LIC// </span></div>
<div class="line"><span class="comment">//LIC// Copyright (C) 2006-2024 Matthias Heil and Andrew Hazel</span></div>
<div class="line"><span class="comment">//LIC// </span></div>
<div class="line"><span class="comment">//LIC// This library is free software; you can redistribute it and/or</span></div>
<div class="line"><span class="comment">//LIC// modify it under the terms of the GNU Lesser General Public</span></div>
<div class="line"><span class="comment">//LIC// License as published by the Free Software Foundation; either</span></div>
<div class="line"><span class="comment">//LIC// version 2.1 of the License, or (at your option) any later version.</span></div>
<div class="line"><span class="comment">//LIC// </span></div>
<div class="line"><span class="comment">//LIC// This library is distributed in the hope that it will be useful,</span></div>
<div class="line"><span class="comment">//LIC// but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div>
<div class="line"><span class="comment">//LIC// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</span></div>
<div class="line"><span class="comment">//LIC// Lesser General Public License for more details.</span></div>
<div class="line"><span class="comment">//LIC// </span></div>
<div class="line"><span class="comment">//LIC// You should have received a copy of the GNU Lesser General Public</span></div>
<div class="line"><span class="comment">//LIC// License along with this library; if not, write to the Free Software</span></div>
<div class="line"><span class="comment">//LIC// Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA</span></div>
<div class="line"><span class="comment">//LIC// 02110-1301  USA.</span></div>
<div class="line"><span class="comment">//LIC// </span></div>
<div class="line"><span class="comment">//LIC// The authors may be contacted at oomph-lib@maths.man.ac.uk.</span></div>
<div class="line"><span class="comment">//LIC// </span></div>
<div class="line"><span class="comment">//LIC//====================================================================</span></div>
<div class="line"><span class="comment">// Driver for Helmholtz/TimeHarmonicTimeHarmonicLinElast coupling</span></div>
<div class="line"><span class="preprocessor">#include &lt;complex&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;cmath&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">//Oomph-lib includes</span></div>
<div class="line"><span class="preprocessor">#include &quot;generic.h&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">//The Helmholtz equation</span></div>
<div class="line"><span class="preprocessor">#include &quot;fourier_decomposed_helmholtz.h&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">//The Elasticity equation</span></div>
<div class="line"><span class="preprocessor">#include &quot;time_harmonic_fourier_decomposed_linear_elasticity.h&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// The interaction elements</span></div>
<div class="line"><span class="preprocessor">#include &quot;multi_physics.h&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// The meshes</span></div>
<div class="line"><span class="preprocessor">#include &quot;meshes/annular_mesh.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;meshes/triangle_mesh.h&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Get the Bessel functions</span></div>
<div class="line"><span class="preprocessor">#include &quot;oomph_crbond_bessel.h&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">using namespace </span>oomph;</div>
<div class="line"><span class="keyword">using namespace </span>std;</div>
<div class="line"> </div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">/// ////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><span class="comment">/// ////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><span class="comment"></span><span class="comment">// Straight line as geometric object</span><span class="comment"></span></div>
<div class="line"><span class="comment">/// ////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><span class="comment">/// ////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment">//=========================================================================</span><span class="comment"></span></div>
<div class="line"><span class="comment">/// Straight 1D line in 2D space </span></div>
<div class="line"><span class="comment"></span><span class="comment">//=========================================================================</span></div>
<div class="line"><span class="keyword">class </span><a class="code" href="classMyStraightLine.html">MyStraightLine</a> : <span class="keyword">public</span> GeomObject</div>
<div class="line">{</div>
<div class="line"> </div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Constructor:  Pass start and end points</span></div>
<div class="line"><span class="comment"></span> <a class="code" href="classMyStraightLine.html">MyStraightLine</a>(<span class="keyword">const</span> Vector&lt;double&gt;&amp; r_start, <span class="keyword">const</span> Vector&lt;double&gt;&amp; r_end) </div>
<div class="line">  :  GeomObject(1,2), R_start(r_start), R_end(r_end)</div>
<div class="line">  { }</div>
<div class="line"> </div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Broken copy constructor</span></div>
<div class="line"><span class="comment"></span> <a class="code" href="classMyStraightLine.html">MyStraightLine</a>(<span class="keyword">const</span> <a class="code" href="classMyStraightLine.html">MyStraightLine</a>&amp; dummy) </div>
<div class="line">  { </div>
<div class="line">   BrokenCopy::broken_copy(<span class="stringliteral">&quot;MyStraightLine&quot;</span>);</div>
<div class="line">  } </div>
<div class="line"> <span class="comment"></span></div>
<div class="line"><span class="comment"> /// Destructor:  Empty</span></div>
<div class="line"><span class="comment"></span> ~<a class="code" href="classMyStraightLine.html">MyStraightLine</a>(){}</div>
<div class="line"> <span class="comment"></span></div>
<div class="line"><span class="comment"> /// Position Vector at Lagrangian coordinate zeta </span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">void</span> position(<span class="keyword">const</span> Vector&lt;double&gt;&amp; zeta, Vector&lt;double&gt;&amp; r)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword">  </span>{</div>
<div class="line">   <span class="comment">// Position Vector</span></div>
<div class="line">   r[0] = R_start[0]+(R_end[0]-R_start[0])*zeta[0];</div>
<div class="line">   r[1] = R_start[1]+(R_end[1]-R_start[1])*zeta[0];</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line"> <span class="comment"></span></div>
<div class="line"><span class="comment"> /// Start point of line</span></div>
<div class="line"><span class="comment"></span> Vector&lt;double&gt; R_start;</div>
<div class="line"> <span class="comment"></span></div>
<div class="line"><span class="comment"> /// End point of line</span></div>
<div class="line"><span class="comment"></span> Vector&lt;double&gt; R_end;</div>
<div class="line"> </div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">/// ///////////////////////////////////////////////////////////////////</span></div>
<div class="line"><span class="comment">/// ///////////////////////////////////////////////////////////////////</span></div>
<div class="line"><span class="comment">/// ///////////////////////////////////////////////////////////////////</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"> </div>
<div class="line"><span class="comment">//=======start_of_namespace==========================================</span><span class="comment"></span></div>
<div class="line"><span class="comment">/// Global variables</span></div>
<div class="line"><span class="comment"></span><span class="comment">//===================================================================</span></div>
<div class="line"><span class="keyword">namespace </span><a class="code" href="namespaceGlobal__Parameters.html">Global_Parameters</a></div>
<div class="line">{</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Square of wavenumber for the Helmholtz equation</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="namespaceGlobal__Parameters.html#a91a3fa265abaf9e724c668ee800ffb29">K_squared</a>=10.0;</div>
<div class="line"> <span class="comment"></span></div>
<div class="line"><span class="comment"> /// Radius of outer boundary of Helmholtz domain</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="namespaceGlobal__Parameters.html#a88ded445ecd7bd89701409e68fd0b900">Outer_radius</a>=2.0; </div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// FSI parameter</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="namespaceGlobal__Parameters.html#a7814fddf663e56168174a42d2cd6b4c1">Q</a>=10.0;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Non-dim thickness of elastic coating</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="namespaceGlobal__Parameters.html#ae3cf8878ede839bffda01f79bbe3e819">H_coating</a>=0.1; </div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Define azimuthal Fourier wavenumber</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">int</span> <a class="code" href="namespaceGlobal__Parameters.html#ae1198385d90f52c4ed921520ae43a9e7">Fourier_wavenumber</a>=0;</div>
<div class="line">   <span class="comment"></span></div>
<div class="line"><span class="comment"> /// Poisson&#39;s ratio Nu</span></div>
<div class="line"><span class="comment"></span> std::complex&lt;double&gt; <a class="code" href="namespaceGlobal__Parameters.html#a373950a959cd784c8f8028099807c2fb">Nu</a>(std::complex&lt;double&gt;(0.3,0.0));</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Define the non-dimensional Young&#39;s modulus</span></div>
<div class="line"><span class="comment"></span> Vector&lt;std::complex&lt;double&gt; &gt; <a class="code" href="namespaceGlobal__Parameters.html#aa961bcca2115ce9cb37cc8ccb1b90cae">E</a>(2,std::complex&lt;double&gt;(1.0,0.0));</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Non-dim square of frequency for solid -- dependent variable!</span></div>
<div class="line"><span class="comment"></span> Vector&lt;std::complex&lt;double&gt; &gt; <a class="code" href="namespaceGlobal__Parameters.html#a91314f7f1cc80c43543948568f50f405">Omega_sq</a>(2,std::complex&lt;double&gt;(100.0,0.0));</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Density ratio: solid to fluid</span></div>
<div class="line"><span class="comment"></span>Vector&lt;double&gt; <a class="code" href="namespaceGlobal__Parameters.html#a517d4c31b8bce6563c2f605266dd9679">Density_ratio</a>(2,1.0);</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Function to update dependent parameter values</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="namespaceGlobal__Parameters.html#ae0f9a80fb7510dbfbbef22582da231b7">update_parameter_values</a>()</div>
<div class="line"> {</div>
<div class="line">  <a class="code" href="namespaceGlobal__Parameters.html#a91314f7f1cc80c43543948568f50f405">Omega_sq</a>[0]=<a class="code" href="namespaceGlobal__Parameters.html#a517d4c31b8bce6563c2f605266dd9679">Density_ratio</a>[0]*<a class="code" href="namespaceGlobal__Parameters.html#a7814fddf663e56168174a42d2cd6b4c1">Q</a>;</div>
<div class="line">  <a class="code" href="namespaceGlobal__Parameters.html#a91314f7f1cc80c43543948568f50f405">Omega_sq</a>[1]=<a class="code" href="namespaceGlobal__Parameters.html#a517d4c31b8bce6563c2f605266dd9679">Density_ratio</a>[1]*<a class="code" href="namespaceGlobal__Parameters.html#a7814fddf663e56168174a42d2cd6b4c1">Q</a>;</div>
<div class="line"> }</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Uniform pressure</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="namespaceGlobal__Parameters.html#a31fb55c20db4aa0127aafa20f0d76731">P</a> = 0.1;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Peakiness parameter for pressure load</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="namespaceGlobal__Parameters.html#afbe27ad463a1fb23cb99d029a9fac731">Alpha</a>=0.0; </div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Pressure load (real and imag part)</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="namespaceGlobal__Parameters.html#a0ddb3a77481b907fbb34f2e8d0a6eb9f">pressure_load</a>(<span class="keyword">const</span> Vector&lt;double&gt; &amp;x,</div>
<div class="line">                    <span class="keyword">const</span> Vector&lt;double&gt; &amp;n, </div>
<div class="line">                    Vector&lt;std::complex&lt;double&gt; &gt;&amp;traction)</div>
<div class="line"> {</div>
<div class="line">  <span class="keywordtype">double</span> phi=atan2(x[1],x[0]);</div>
<div class="line">  <span class="keywordtype">double</span> magnitude=exp(-<a class="code" href="namespaceGlobal__Parameters.html#afbe27ad463a1fb23cb99d029a9fac731">Alpha</a>*pow(phi-0.25*MathematicalConstants::Pi,2));</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">unsigned</span> dim = 2;</div>
<div class="line">  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i=0;i&lt;dim;i++)</div>
<div class="line">   {</div>
<div class="line">    traction[i] = complex&lt;double&gt;(-magnitude*<a class="code" href="namespaceGlobal__Parameters.html#a31fb55c20db4aa0127aafa20f0d76731">P</a>*n[i],magnitude*<a class="code" href="namespaceGlobal__Parameters.html#a31fb55c20db4aa0127aafa20f0d76731">P</a>*n[i]);</div>
<div class="line">   }</div>
<div class="line"> } <span class="comment">// end_of_pressure_load</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Output directory</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">string</span> <a class="code" href="namespaceGlobal__Parameters.html#a301ab922df72030c660b21328d6caf76">Directory</a>=<span class="stringliteral">&quot;RESLT&quot;</span>;</div>
<div class="line"> </div>
<div class="line">} <span class="comment">//end_of_namespace</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment">//=============start_of_problem_class===================================</span><span class="comment"></span></div>
<div class="line"><span class="comment">/// Coated sphere FSI</span></div>
<div class="line"><span class="comment"></span><span class="comment">//====================================================================== </span></div>
<div class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> ELASTICITY_ELEMENT, <span class="keyword">class</span> HELMHOLTZ_ELEMENT&gt;</div>
<div class="line"><span class="keyword">class </span><a class="code" href="classCoatedSphereProblem.html">CoatedSphereProblem</a> : <span class="keyword">public</span> Problem</div>
<div class="line">{</div>
<div class="line"> </div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Constructor:</span></div>
<div class="line"><span class="comment"></span> <a class="code" href="classCoatedSphereProblem.html">CoatedSphereProblem</a>();</div>
<div class="line"> <span class="comment"></span></div>
<div class="line"><span class="comment"> /// Update function (empty)</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">void</span> actions_before_newton_solve(){}</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Update function (empty)</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">void</span> actions_after_newton_solve() {}</div>
<div class="line"> <span class="comment"></span></div>
<div class="line"><span class="comment"> /// Actions before adapt: Wipe the face meshes</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">void</span> actions_before_adapt();</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Actions after adapt: Rebuild the face meshes</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">void</span> actions_after_adapt();</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Recompute gamma integral before checking Newton residuals</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">void</span> actions_before_newton_convergence_check()</div>
<div class="line">  {</div>
<div class="line">   Helmholtz_DtN_mesh_pt-&gt;setup_gamma();</div>
<div class="line">  }</div>
<div class="line">  <span class="comment"></span></div>
<div class="line"><span class="comment"> /// Doc the solution</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">void</span> doc_solution(DocInfo&amp; doc_info);</div>
<div class="line"> </div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Create FSI traction elements</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">void</span> create_fsi_traction_elements();</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Create Helmholtz FSI flux elements</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">void</span> create_helmholtz_fsi_flux_elements(); </div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Setup interaction</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">void</span> setup_interaction();</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Create DtN elements on outer boundary</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">void</span> create_helmholtz_DtN_elements();</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Create solid traction elements </span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">void</span> create_solid_traction_elements();</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Delete (face) elements in specified mesh </span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">void</span> delete_face_elements(Mesh* <span class="keyword">const</span> &amp; boundary_mesh_pt);</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Complete problem setup</span></div>
<div class="line"> <span class="keywordtype">void</span> complete_problem_setup();</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Boundary ID of upper symmetry boundary</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">unsigned</span> Upper_symmetry_boundary_id;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Boundary ID of lower symmetry boundary</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">unsigned</span> Lower_symmetry_boundary_id;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Boundary ID of upper inner boundary</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">unsigned</span> Upper_inner_boundary_id;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Boundary ID of lower inner boundary</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">unsigned</span> Lower_inner_boundary_id;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Boundary ID of outer boundary</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">unsigned</span> Outer_boundary_id;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Boundary ID of rib divider</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">unsigned</span> Rib_divider_boundary_id;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Boundary ID of outer boundary in Helmholtz mesh</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">unsigned</span> HH_outer_boundary_id;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Boundary ID of inner boundary in Helmholtz mesh</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">unsigned</span> HH_inner_boundary_id;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Boundary ID of upper boundary in Helmholtz mesh</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">unsigned</span> HH_upper_symmetry_boundary_id;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Boundary ID of lower boundary in Helmholtz mesh</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">unsigned</span> HH_lower_symmetry_boundary_id;</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#ifdef ADAPTIVE</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Pointer to solid mesh</span></div>
<div class="line"><span class="comment"></span> RefineableTriangleMesh&lt;ELASTICITY_ELEMENT&gt;* Solid_mesh_pt;</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Pointer to solid mesh</span></div>
<div class="line"><span class="comment"></span> TriangleMesh&lt;ELASTICITY_ELEMENT&gt;* Solid_mesh_pt;</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"> </div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Pointer to mesh of solid traction elements</span></div>
<div class="line"><span class="comment"></span> Mesh* Solid_traction_mesh_pt;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Pointer to mesh of FSI traction elements</span></div>
<div class="line"><span class="comment"></span> Mesh* FSI_traction_mesh_pt;</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#ifdef ADAPTIVE</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Pointer to Helmholtz mesh</span></div>
<div class="line"><span class="comment"></span> RefineableTriangleMesh&lt;HELMHOLTZ_ELEMENT&gt;* Helmholtz_mesh_pt;</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Pointer to Helmholtz mesh</span></div>
<div class="line"><span class="comment"></span> TriangleMesh&lt;HELMHOLTZ_ELEMENT&gt;* Helmholtz_mesh_pt;</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Pointer to mesh of Helmholtz FSI flux elements</span></div>
<div class="line"><span class="comment"></span> Mesh* Helmholtz_fsi_flux_mesh_pt;</div>
<div class="line"> <span class="comment"></span></div>
<div class="line"><span class="comment"> /// Pointer to mesh containing the DtN elements</span></div>
<div class="line"><span class="comment"></span> FourierDecomposedHelmholtzDtNMesh&lt;HELMHOLTZ_ELEMENT&gt;* Helmholtz_DtN_mesh_pt;</div>
<div class="line"> <span class="comment"></span></div>
<div class="line"><span class="comment"> /// Trace file</span></div>
<div class="line"><span class="comment"></span> ofstream Trace_file;</div>
<div class="line"> </div>
<div class="line">};<span class="comment">// end_of_problem_class</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment">//===========start_of_constructor======================================= </span><span class="comment"></span></div>
<div class="line"><span class="comment">/// Constructor: </span></div>
<div class="line"><span class="comment"></span><span class="comment">//====================================================================== </span></div>
<div class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> ELASTICITY_ELEMENT, <span class="keyword">class</span> HELMHOLTZ_ELEMENT&gt;</div>
<div class="line"><a class="code" href="classCoatedSphereProblem.html#ab9c983e7f0bed66f13d59bd65d6d151b">CoatedSphereProblem&lt;ELASTICITY_ELEMENT, HELMHOLTZ_ELEMENT&gt;::</a></div>
<div class="line"><a class="code" href="classCoatedSphereProblem.html#ab9c983e7f0bed66f13d59bd65d6d151b">CoatedSphereProblem</a>() </div>
<div class="line">{</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Solid mesh</span></div>
<div class="line"> <span class="comment">//-----------</span></div>
<div class="line"> {</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Start and end coordinates</span></div>
<div class="line">  Vector&lt;double&gt; r_start(2);</div>
<div class="line">  Vector&lt;double&gt; r_end(2);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Outer radius of hull</span></div>
<div class="line">  <span class="keywordtype">double</span> r_outer = 1.0;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Inner radius of hull</span></div>
<div class="line">  <span class="keywordtype">double</span> r_inner = r_outer-<a class="code" href="namespaceGlobal__Parameters.html#ae3cf8878ede839bffda01f79bbe3e819">Global_Parameters::H_coating</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Thickness of rib</span></div>
<div class="line">  <span class="keywordtype">double</span> rib_thick=0.05;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Depth of rib</span></div>
<div class="line">  <span class="keywordtype">double</span> rib_depth=0.2;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Total width of T</span></div>
<div class="line">  <span class="keywordtype">double</span> t_width=0.2;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Thickness of T</span></div>
<div class="line">  <span class="keywordtype">double</span> t_thick=0.05;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Half-opening angle of rib</span></div>
<div class="line">  <span class="keywordtype">double</span> half_phi_rib=asin(0.5*rib_thick/r_inner);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Pointer to the closed curve that defines the outer boundary</span></div>
<div class="line">  TriangleMeshClosedCurve* closed_curve_pt=0;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Provide storage for pointers to the parts of the curvilinear boundary</span></div>
<div class="line">  Vector&lt;TriangleMeshCurveSection*&gt; curvilinear_boundary_pt;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Outer boundary</span></div>
<div class="line">  <span class="comment">//---------------</span></div>
<div class="line">  Ellipse* outer_boundary_circle_pt = <span class="keyword">new</span> Ellipse(r_outer,r_outer);</div>
<div class="line">  <span class="keywordtype">double</span> zeta_start=-0.5*MathematicalConstants::Pi;</div>
<div class="line">  <span class="keywordtype">double</span> zeta_end=0.5*MathematicalConstants::Pi;</div>
<div class="line">  <span class="keywordtype">unsigned</span> nsegment=50;</div>
<div class="line">  <span class="keywordtype">unsigned</span> boundary_id=curvilinear_boundary_pt.size();</div>
<div class="line">  curvilinear_boundary_pt.push_back(</div>
<div class="line">   <span class="keyword">new</span> TriangleMeshCurviLine(</div>
<div class="line">    outer_boundary_circle_pt,zeta_start,zeta_end,nsegment,boundary_id));</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Remember it</span></div>
<div class="line">  Outer_boundary_id=boundary_id;</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Upper straight line segment on symmetry axis</span></div>
<div class="line">  <span class="comment">//---------------------------------------------</span></div>
<div class="line">  r_start[0]=0.0;</div>
<div class="line">  r_start[1]=r_outer;</div>
<div class="line">  r_end[0]=0.0;</div>
<div class="line">  r_end[1]=r_inner;</div>
<div class="line">  <a class="code" href="classMyStraightLine.html">MyStraightLine</a>* upper_sym_pt = <span class="keyword">new</span> <a class="code" href="classMyStraightLine.html">MyStraightLine</a>(r_start,r_end);</div>
<div class="line">  zeta_start=0.0;</div>
<div class="line">  zeta_end=1.0;</div>
<div class="line">  nsegment=1;</div>
<div class="line">  boundary_id=curvilinear_boundary_pt.size();</div>
<div class="line">  curvilinear_boundary_pt.push_back(</div>
<div class="line">   <span class="keyword">new</span> TriangleMeshCurviLine(</div>
<div class="line">    upper_sym_pt,zeta_start,zeta_end,nsegment,boundary_id));</div>
<div class="line">                                                        </div>
<div class="line">  <span class="comment">// Remember it</span></div>
<div class="line">  Upper_symmetry_boundary_id=boundary_id;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Upper part of inner boundary</span></div>
<div class="line">  <span class="comment">//-----------------------------</span></div>
<div class="line">  Ellipse* upper_inner_boundary_pt = </div>
<div class="line">   <span class="keyword">new</span> Ellipse(r_inner,r_inner);</div>
<div class="line">  zeta_start=0.5*MathematicalConstants::Pi;</div>
<div class="line">  zeta_end=half_phi_rib;</div>
<div class="line">  nsegment=20;</div>
<div class="line">  boundary_id=curvilinear_boundary_pt.size();</div>
<div class="line">  curvilinear_boundary_pt.push_back(</div>
<div class="line">   <span class="keyword">new</span> TriangleMeshCurviLine(</div>
<div class="line">    upper_inner_boundary_pt,</div>
<div class="line">    zeta_start,zeta_end,nsegment,boundary_id));</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Remember it</span></div>
<div class="line">  Upper_inner_boundary_id=boundary_id;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Data associated with rib</span></div>
<div class="line">  <a class="code" href="classMyStraightLine.html">MyStraightLine</a>* upper_inward_rib_pt=0;</div>
<div class="line">  <a class="code" href="classMyStraightLine.html">MyStraightLine</a>* lower_inward_rib_pt=0;</div>
<div class="line">  TriangleMeshCurviLine* upper_inward_rib_curviline_pt=0;</div>
<div class="line">  Vector&lt;TriangleMeshOpenCurve*&gt; inner_boundary_pt;</div>
<div class="line">  TriangleMeshCurviLine* lower_inward_rib_curviline_pt=0;</div>
<div class="line">  Vector&lt;double&gt; rib_center(2);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Upper half of inward rib</span></div>
<div class="line">  <span class="comment">//-------------------------</span></div>
<div class="line">  r_start[0]=r_inner*cos(half_phi_rib);</div>
<div class="line">  r_start[1]=r_inner*sin(half_phi_rib);</div>
<div class="line">  r_end[0]=r_start[0]-rib_depth;</div>
<div class="line">  r_end[1]=r_start[1];</div>
<div class="line">  upper_inward_rib_pt = <span class="keyword">new</span> <a class="code" href="classMyStraightLine.html">MyStraightLine</a>(r_start,r_end);</div>
<div class="line">  zeta_start=0.0;</div>
<div class="line">  zeta_end=1.0;</div>
<div class="line">  nsegment=1;</div>
<div class="line">  boundary_id=curvilinear_boundary_pt.size();</div>
<div class="line">  upper_inward_rib_curviline_pt=</div>
<div class="line">   <span class="keyword">new</span> TriangleMeshCurviLine(</div>
<div class="line">    upper_inward_rib_pt,zeta_start,zeta_end,nsegment,boundary_id);</div>
<div class="line">  curvilinear_boundary_pt.push_back(upper_inward_rib_curviline_pt);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Vertical upper bit of T</span></div>
<div class="line">  <span class="comment">//------------------------</span></div>
<div class="line">  r_start[0]=r_end[0];</div>
<div class="line">  r_start[1]=r_end[1];</div>
<div class="line">  r_end[0]=r_start[0];</div>
<div class="line">  r_end[1]=r_start[1]+0.5*(t_width-rib_thick);</div>
<div class="line">  <a class="code" href="classMyStraightLine.html">MyStraightLine</a>* vertical_upper_t_rib_pt = <span class="keyword">new</span> <a class="code" href="classMyStraightLine.html">MyStraightLine</a>(r_start,r_end);</div>
<div class="line">  zeta_start=0.0;</div>
<div class="line">  zeta_end=1.0;</div>
<div class="line">  nsegment=1;</div>
<div class="line">  boundary_id=curvilinear_boundary_pt.size();</div>
<div class="line">  curvilinear_boundary_pt.push_back(</div>
<div class="line">   <span class="keyword">new</span> TriangleMeshCurviLine(</div>
<div class="line">    vertical_upper_t_rib_pt,zeta_start,zeta_end,nsegment,boundary_id));</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Horizontal upper bit of T</span></div>
<div class="line">  <span class="comment">//-----------==-------------</span></div>
<div class="line">  r_start[0]=r_end[0];</div>
<div class="line">  r_start[1]=r_end[1];</div>
<div class="line">  r_end[0]=r_start[0]-t_thick;</div>
<div class="line">  r_end[1]=r_start[1];</div>
<div class="line">  <a class="code" href="classMyStraightLine.html">MyStraightLine</a>* horizontal_upper_t_rib_pt = <span class="keyword">new</span> <a class="code" href="classMyStraightLine.html">MyStraightLine</a>(r_start,r_end);</div>
<div class="line">  zeta_start=0.0;</div>
<div class="line">  zeta_end=1.0;</div>
<div class="line">  nsegment=1;</div>
<div class="line">  boundary_id=curvilinear_boundary_pt.size();</div>
<div class="line">  curvilinear_boundary_pt.push_back(</div>
<div class="line">   <span class="keyword">new</span> TriangleMeshCurviLine(</div>
<div class="line">    horizontal_upper_t_rib_pt,zeta_start,zeta_end,nsegment,boundary_id));</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Vertical end of rib end</span></div>
<div class="line">  <span class="comment">//------------------------</span></div>
<div class="line">  r_start[0]=r_end[0];</div>
<div class="line">  r_start[1]=r_end[1];</div>
<div class="line">  r_end[0]=r_start[0];</div>
<div class="line">  r_end[1]=-r_start[1];</div>
<div class="line">  <a class="code" href="classMyStraightLine.html">MyStraightLine</a>* inner_vertical_rib_pt = <span class="keyword">new</span> <a class="code" href="classMyStraightLine.html">MyStraightLine</a>(r_start,r_end);</div>
<div class="line">  zeta_start=0.0;</div>
<div class="line">  zeta_end=1.0;</div>
<div class="line">  nsegment=1;</div>
<div class="line">  boundary_id=curvilinear_boundary_pt.size();</div>
<div class="line">  curvilinear_boundary_pt.push_back(</div>
<div class="line">   <span class="keyword">new</span> TriangleMeshCurviLine(</div>
<div class="line">    inner_vertical_rib_pt,zeta_start,zeta_end,nsegment,boundary_id));</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Horizontal lower bit of T</span></div>
<div class="line">  <span class="comment">//-----------==-------------</span></div>
<div class="line">  r_start[0]=r_end[0];</div>
<div class="line">  r_start[1]=r_end[1];</div>
<div class="line">  r_end[0]=r_start[0]+t_thick;</div>
<div class="line">  r_end[1]=r_start[1];</div>
<div class="line">  <a class="code" href="classMyStraightLine.html">MyStraightLine</a>* horizontal_lower_t_rib_pt = <span class="keyword">new</span> <a class="code" href="classMyStraightLine.html">MyStraightLine</a>(r_start,r_end);</div>
<div class="line">  zeta_start=0.0;</div>
<div class="line">  zeta_end=1.0;</div>
<div class="line">  nsegment=1;</div>
<div class="line">  boundary_id=curvilinear_boundary_pt.size();</div>
<div class="line">  curvilinear_boundary_pt.push_back(</div>
<div class="line">   <span class="keyword">new</span> TriangleMeshCurviLine(</div>
<div class="line">    horizontal_lower_t_rib_pt,zeta_start,zeta_end,nsegment,boundary_id));</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Vertical lower bit of T</span></div>
<div class="line">  <span class="comment">//------------------------</span></div>
<div class="line">  r_start[0]=r_end[0];</div>
<div class="line">  r_start[1]=r_end[1];</div>
<div class="line">  r_end[0]=r_start[0];</div>
<div class="line">  r_end[1]=r_start[1]+0.5*(t_width-rib_thick);</div>
<div class="line">  <a class="code" href="classMyStraightLine.html">MyStraightLine</a>* vertical_lower_t_rib_pt = <span class="keyword">new</span> <a class="code" href="classMyStraightLine.html">MyStraightLine</a>(r_start,r_end);</div>
<div class="line">  zeta_start=0.0;</div>
<div class="line">  zeta_end=1.0;</div>
<div class="line">  nsegment=1;</div>
<div class="line">  boundary_id=curvilinear_boundary_pt.size();</div>
<div class="line">  curvilinear_boundary_pt.push_back(</div>
<div class="line">   <span class="keyword">new</span> TriangleMeshCurviLine(</div>
<div class="line">    vertical_lower_t_rib_pt,zeta_start,zeta_end,nsegment,boundary_id));</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Lower half of inward rib</span></div>
<div class="line">  <span class="comment">//-------------------------</span></div>
<div class="line">  r_end[0]=r_inner*cos(half_phi_rib);</div>
<div class="line">  r_end[1]=-r_inner*sin(half_phi_rib);</div>
<div class="line">  r_start[0]=r_end[0]-rib_depth;</div>
<div class="line">  r_start[1]=r_end[1];</div>
<div class="line">  lower_inward_rib_pt = <span class="keyword">new</span> <a class="code" href="classMyStraightLine.html">MyStraightLine</a>(r_start,r_end);</div>
<div class="line">  zeta_start=0.0;</div>
<div class="line">  zeta_end=1.0;</div>
<div class="line">  nsegment=1;</div>
<div class="line">  boundary_id=curvilinear_boundary_pt.size();</div>
<div class="line">  lower_inward_rib_curviline_pt=</div>
<div class="line">   <span class="keyword">new</span> TriangleMeshCurviLine(</div>
<div class="line">    lower_inward_rib_pt,zeta_start,zeta_end,nsegment,boundary_id);</div>
<div class="line">  curvilinear_boundary_pt.push_back(lower_inward_rib_curviline_pt);</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Lower part of inner boundary</span></div>
<div class="line">  <span class="comment">//-----------------------------</span></div>
<div class="line">  Ellipse* lower_inner_boundary_circle_pt = <span class="keyword">new</span> Ellipse(r_inner,r_inner);</div>
<div class="line">  zeta_start=-half_phi_rib;</div>
<div class="line">  zeta_end=-0.5*MathematicalConstants::Pi;</div>
<div class="line">  nsegment=20;</div>
<div class="line">  boundary_id=curvilinear_boundary_pt.size();</div>
<div class="line">  curvilinear_boundary_pt.push_back(</div>
<div class="line">   <span class="keyword">new</span> TriangleMeshCurviLine(</div>
<div class="line">    lower_inner_boundary_circle_pt,zeta_start,zeta_end,nsegment,boundary_id)); </div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Remember it</span></div>
<div class="line">  Lower_inner_boundary_id=boundary_id;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Lower straight line segment on symmetry axis</span></div>
<div class="line">  <span class="comment">//---------------------------------------------</span></div>
<div class="line">  r_start[0]=0.0;</div>
<div class="line">  r_start[1]=-r_inner;</div>
<div class="line">  r_end[0]=0.0;</div>
<div class="line">  r_end[1]=-r_outer;</div>
<div class="line">  <a class="code" href="classMyStraightLine.html">MyStraightLine</a>* lower_sym_pt = <span class="keyword">new</span> <a class="code" href="classMyStraightLine.html">MyStraightLine</a>(r_start,r_end);</div>
<div class="line">  zeta_start=0.0;</div>
<div class="line">  zeta_end=1.0;</div>
<div class="line">  nsegment=1;</div>
<div class="line">  boundary_id=curvilinear_boundary_pt.size();</div>
<div class="line">  curvilinear_boundary_pt.push_back(</div>
<div class="line">   <span class="keyword">new</span> TriangleMeshCurviLine(</div>
<div class="line">    lower_sym_pt,zeta_start,zeta_end,nsegment,boundary_id));</div>
<div class="line">      </div>
<div class="line">  <span class="comment">// Remember it</span></div>
<div class="line">  Lower_symmetry_boundary_id=boundary_id;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Combine to curvilinear boundary</span></div>
<div class="line">  <span class="comment">//--------------------------------</span></div>
<div class="line">  closed_curve_pt=</div>
<div class="line">   <span class="keyword">new</span> TriangleMeshClosedCurve(curvilinear_boundary_pt); </div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Vertical dividing line across base of T-rib</span></div>
<div class="line">  <span class="comment">//--------------------------------------------</span></div>
<div class="line">  Vector&lt;TriangleMeshCurveSection*&gt; internal_polyline_pt(1);</div>
<div class="line">  r_start[0]=r_inner*cos(half_phi_rib);</div>
<div class="line">  r_start[1]=r_inner*sin(half_phi_rib);</div>
<div class="line">  r_end[0]=r_inner*cos(half_phi_rib);</div>
<div class="line">  r_end[1]=-r_inner*sin(half_phi_rib);</div>
<div class="line"> </div>
<div class="line">  Vector&lt;Vector&lt;double&gt; &gt; boundary_vertices(2);</div>
<div class="line">  boundary_vertices[0]=r_start;</div>
<div class="line">  boundary_vertices[1]=r_end;</div>
<div class="line">  boundary_id=100;</div>
<div class="line">  TriangleMeshPolyLine* rib_divider_pt=</div>
<div class="line">   <span class="keyword">new</span> TriangleMeshPolyLine(boundary_vertices,boundary_id); </div>
<div class="line">  internal_polyline_pt[0]=rib_divider_pt;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Remember it</span></div>
<div class="line">  Rib_divider_boundary_id=boundary_id;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Make connection</span></div>
<div class="line">  <span class="keywordtype">double</span> s_connect=0.0;</div>
<div class="line">  internal_polyline_pt[0]-&gt;connect_initial_vertex_to_curviline(</div>
<div class="line">   upper_inward_rib_curviline_pt,s_connect);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Make connection</span></div>
<div class="line">  s_connect=1.0;</div>
<div class="line">  internal_polyline_pt[0]-&gt;connect_final_vertex_to_curviline(</div>
<div class="line">   lower_inward_rib_curviline_pt,s_connect);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Create open curve that defines internal bondary</span></div>
<div class="line">  inner_boundary_pt.push_back(<span class="keyword">new</span> TriangleMeshOpenCurve(internal_polyline_pt));</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Define coordinates of a point inside the rib</span></div>
<div class="line">  rib_center[0]=r_inner-rib_depth;</div>
<div class="line">  rib_center[1]=0.0;</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Now build the mesh</span></div>
<div class="line">  <span class="comment">//===================</span></div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Use the TriangleMeshParameters object for helping on the manage of the</span></div>
<div class="line">  <span class="comment">// TriangleMesh parameters. The only parameter that needs to take is the</span></div>
<div class="line">  <span class="comment">// outer boundary.</span></div>
<div class="line">  TriangleMeshParameters triangle_mesh_parameters(closed_curve_pt);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Target area</span></div>
<div class="line">  triangle_mesh_parameters.element_area()=0.2;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Specify the internal open boundary</span></div>
<div class="line">  triangle_mesh_parameters.internal_open_curves_pt()=inner_boundary_pt;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Define the region</span></div>
<div class="line">  triangle_mesh_parameters.add_region_coordinates(1,rib_center);</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#ifdef ADAPTIVE</span></div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Build the mesh</span></div>
<div class="line">  Solid_mesh_pt=<span class="keyword">new</span> </div>
<div class="line">   RefineableTriangleMesh&lt;ELASTICITY_ELEMENT&gt;(triangle_mesh_parameters);</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Build the mesh</span></div>
<div class="line">  Solid_mesh_pt=<span class="keyword">new</span> </div>
<div class="line">   TriangleMesh&lt;ELASTICITY_ELEMENT&gt;(triangle_mesh_parameters);</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"> </div>
<div class="line"> }</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Helmholtz mesh</span></div>
<div class="line"> <span class="comment">//---------------</span></div>
<div class="line"> {</div>
<div class="line">  <span class="comment">// Start and end coordinates</span></div>
<div class="line">  Vector&lt;double&gt; r_start(2);</div>
<div class="line">  Vector&lt;double&gt; r_end(2);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Inner radius of helmholtz region</span></div>
<div class="line">  <span class="keywordtype">double</span> r_inner = 1.0;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Outer radius of Helmholtz region</span></div>
<div class="line">  <span class="keywordtype">double</span> r_outer = <a class="code" href="namespaceGlobal__Parameters.html#a88ded445ecd7bd89701409e68fd0b900">Global_Parameters::Outer_radius</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Pointer to the closed curve that defines the outer boundary</span></div>
<div class="line">  TriangleMeshClosedCurve* closed_curve_pt=0;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Provide storage for pointers to the parts of the curvilinear boundary</span></div>
<div class="line">  Vector&lt;TriangleMeshCurveSection*&gt; curvilinear_boundary_pt;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Outer boundary</span></div>
<div class="line">  <span class="comment">//---------------</span></div>
<div class="line">  Ellipse* outer_boundary_circle_pt = <span class="keyword">new</span> Ellipse(r_outer,r_outer);</div>
<div class="line">  <span class="keywordtype">double</span> zeta_start=-0.5*MathematicalConstants::Pi;</div>
<div class="line">  <span class="keywordtype">double</span> zeta_end=0.5*MathematicalConstants::Pi;</div>
<div class="line">  <span class="keywordtype">unsigned</span> nsegment=50;</div>
<div class="line">  <span class="keywordtype">unsigned</span> boundary_id=curvilinear_boundary_pt.size();</div>
<div class="line">  curvilinear_boundary_pt.push_back(</div>
<div class="line">   <span class="keyword">new</span> TriangleMeshCurviLine(</div>
<div class="line">    outer_boundary_circle_pt,zeta_start,zeta_end,nsegment,boundary_id));</div>
<div class="line">  </div>
<div class="line">  <span class="comment">// Remember it</span></div>
<div class="line">  HH_outer_boundary_id=boundary_id;</div>
<div class="line">  </div>
<div class="line">  </div>
<div class="line">  <span class="comment">// Upper straight line segment on symmetry axis</span></div>
<div class="line">  <span class="comment">//---------------------------------------------</span></div>
<div class="line">  r_start[0]=0.0;</div>
<div class="line">  r_start[1]=r_outer;</div>
<div class="line">  r_end[0]=0.0;</div>
<div class="line">  r_end[1]=r_inner;</div>
<div class="line">  <a class="code" href="classMyStraightLine.html">MyStraightLine</a>* upper_sym_pt = <span class="keyword">new</span> <a class="code" href="classMyStraightLine.html">MyStraightLine</a>(r_start,r_end);</div>
<div class="line">  zeta_start=0.0;</div>
<div class="line">  zeta_end=1.0;</div>
<div class="line">  nsegment=1;</div>
<div class="line">  boundary_id=curvilinear_boundary_pt.size();</div>
<div class="line">  curvilinear_boundary_pt.push_back(</div>
<div class="line">   <span class="keyword">new</span> TriangleMeshCurviLine(</div>
<div class="line">    upper_sym_pt,zeta_start,zeta_end,nsegment,boundary_id));</div>
<div class="line">                                                        </div>
<div class="line">  <span class="comment">// Remember it</span></div>
<div class="line">  HH_upper_symmetry_boundary_id=boundary_id;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Inner boundary</span></div>
<div class="line">  <span class="comment">//---------------</span></div>
<div class="line">  Ellipse* upper_inner_boundary_pt = </div>
<div class="line">   <span class="keyword">new</span> Ellipse(r_inner,r_inner);</div>
<div class="line">  zeta_start=0.5*MathematicalConstants::Pi;</div>
<div class="line">  zeta_end=-0.5*MathematicalConstants::Pi;</div>
<div class="line">  nsegment=40;</div>
<div class="line">  boundary_id=curvilinear_boundary_pt.size();</div>
<div class="line">  curvilinear_boundary_pt.push_back(</div>
<div class="line">   <span class="keyword">new</span> TriangleMeshCurviLine(</div>
<div class="line">    upper_inner_boundary_pt,</div>
<div class="line">    zeta_start,zeta_end,nsegment,boundary_id));</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Remember it</span></div>
<div class="line">  HH_inner_boundary_id=boundary_id;</div>
<div class="line">  </div>
<div class="line">  <span class="comment">// Lower straight line segment on symmetry axis</span></div>
<div class="line">  <span class="comment">//---------------------------------------------</span></div>
<div class="line">  r_start[0]=0.0;</div>
<div class="line">  r_start[1]=-r_inner;</div>
<div class="line">  r_end[0]=0.0;</div>
<div class="line">  r_end[1]=-r_outer;</div>
<div class="line">  <a class="code" href="classMyStraightLine.html">MyStraightLine</a>* lower_sym_pt = <span class="keyword">new</span> <a class="code" href="classMyStraightLine.html">MyStraightLine</a>(r_start,r_end);</div>
<div class="line">  zeta_start=0.0;</div>
<div class="line">  zeta_end=1.0;</div>
<div class="line">  nsegment=1;</div>
<div class="line">  boundary_id=curvilinear_boundary_pt.size();</div>
<div class="line">  curvilinear_boundary_pt.push_back(</div>
<div class="line">   <span class="keyword">new</span> TriangleMeshCurviLine(</div>
<div class="line">    lower_sym_pt,zeta_start,zeta_end,nsegment,boundary_id));</div>
<div class="line">      </div>
<div class="line">  <span class="comment">// Remember it</span></div>
<div class="line">  HH_lower_symmetry_boundary_id=boundary_id;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Combine to curvilinear boundary</span></div>
<div class="line">  <span class="comment">//--------------------------------</span></div>
<div class="line">  closed_curve_pt=</div>
<div class="line">   <span class="keyword">new</span> TriangleMeshClosedCurve(curvilinear_boundary_pt); </div>
<div class="line">  </div>
<div class="line">  <span class="comment">// Now build the mesh</span></div>
<div class="line">  <span class="comment">//===================</span></div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Use the TriangleMeshParameters object for helping on the manage of the</span></div>
<div class="line">  <span class="comment">// TriangleMesh parameters. The only parameter that needs to take is the</span></div>
<div class="line">  <span class="comment">// outer boundary.</span></div>
<div class="line">  TriangleMeshParameters triangle_mesh_parameters(closed_curve_pt);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Target area</span></div>
<div class="line">  triangle_mesh_parameters.element_area()=0.2;</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#ifdef ADAPTIVE</span></div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Build the mesh</span></div>
<div class="line">  Helmholtz_mesh_pt=<span class="keyword">new</span> </div>
<div class="line">   RefineableTriangleMesh&lt;HELMHOLTZ_ELEMENT&gt;(triangle_mesh_parameters);</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Build the mesh</span></div>
<div class="line">  Helmholtz_mesh_pt=<span class="keyword">new</span> </div>
<div class="line">   TriangleMesh&lt;HELMHOLTZ_ELEMENT&gt;(triangle_mesh_parameters);</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"> </div>
<div class="line"> }</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Create mesh for DtN elements on outer boundary</span></div>
<div class="line"> <span class="keywordtype">unsigned</span> nfourier=20;</div>
<div class="line"> Helmholtz_DtN_mesh_pt=</div>
<div class="line">  <span class="keyword">new</span> FourierDecomposedHelmholtzDtNMesh&lt;HELMHOLTZ_ELEMENT&gt;(</div>
<div class="line">   <a class="code" href="namespaceGlobal__Parameters.html#a88ded445ecd7bd89701409e68fd0b900">Global_Parameters::Outer_radius</a>,nfourier);</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#ifdef ADAPTIVE</span></div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Set error estimators</span></div>
<div class="line"> Solid_mesh_pt-&gt;spatial_error_estimator_pt()=<span class="keyword">new</span> Z2ErrorEstimator;</div>
<div class="line"> Helmholtz_mesh_pt-&gt;spatial_error_estimator_pt()=<span class="keyword">new</span> Z2ErrorEstimator;</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Output meshes and their boundaries so far so we can double </span></div>
<div class="line"> <span class="comment">// check the boundary enumeration</span></div>
<div class="line"> Solid_mesh_pt-&gt;output(<span class="stringliteral">&quot;solid_mesh.dat&quot;</span>);</div>
<div class="line"> Helmholtz_mesh_pt-&gt;output(<span class="stringliteral">&quot;helmholtz_mesh.dat&quot;</span>);</div>
<div class="line"> Solid_mesh_pt-&gt;output_boundaries(<span class="stringliteral">&quot;solid_mesh_boundary.dat&quot;</span>);</div>
<div class="line"> Helmholtz_mesh_pt-&gt;output_boundaries(<span class="stringliteral">&quot;helmholtz_mesh_boundary.dat&quot;</span>);</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Create FaceElement meshes for boundary conditions</span></div>
<div class="line"> <span class="comment">//--------------------------------------------------</span></div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Construct the solid traction element mesh</span></div>
<div class="line"> Solid_traction_mesh_pt=<span class="keyword">new</span> Mesh;</div>
<div class="line"> create_solid_traction_elements(); </div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Construct the fsi traction element mesh</span></div>
<div class="line"> FSI_traction_mesh_pt=<span class="keyword">new</span> Mesh;</div>
<div class="line"> create_fsi_traction_elements();</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Construct the Helmholtz fsi flux element mesh</span></div>
<div class="line"> Helmholtz_fsi_flux_mesh_pt=<span class="keyword">new</span> Mesh;</div>
<div class="line"> create_helmholtz_fsi_flux_elements();</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Create DtN elements</span></div>
<div class="line"> create_helmholtz_DtN_elements();</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Combine sub meshes</span></div>
<div class="line"> <span class="comment">//-------------------</span></div>
<div class="line"> add_sub_mesh(Solid_mesh_pt);</div>
<div class="line"> add_sub_mesh(Solid_traction_mesh_pt);</div>
<div class="line"> add_sub_mesh(FSI_traction_mesh_pt);</div>
<div class="line"> add_sub_mesh(Helmholtz_mesh_pt);</div>
<div class="line"> add_sub_mesh(Helmholtz_fsi_flux_mesh_pt);</div>
<div class="line"> add_sub_mesh(Helmholtz_DtN_mesh_pt); </div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Build the Problem&#39;s global mesh from its various sub-meshes</span></div>
<div class="line"> build_global_mesh();</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Complete problem setup</span></div>
<div class="line"> complete_problem_setup();</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Setup fluid-structure interaction</span></div>
<div class="line"> <span class="comment">//----------------------------------</span></div>
<div class="line"> setup_interaction();</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Open trace file</span></div>
<div class="line"> <span class="keywordtype">char</span> filename[100];</div>
<div class="line"> sprintf(filename,<span class="stringliteral">&quot;%s/trace.dat&quot;</span>,<a class="code" href="namespaceGlobal__Parameters.html#a301ab922df72030c660b21328d6caf76">Global_Parameters::Directory</a>.c_str());</div>
<div class="line"> Trace_file.open(filename);</div>
<div class="line">  </div>
<div class="line"> <span class="comment">// Setup equation numbering scheme</span></div>
<div class="line"> cout &lt;&lt;<span class="stringliteral">&quot;Number of equations: &quot;</span> &lt;&lt; assign_eqn_numbers() &lt;&lt; std::endl; </div>
<div class="line"> </div>
<div class="line">}<span class="comment">//end_of_constructor</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment">//=====================start_of_actions_before_adapt======================</span><span class="comment"></span></div>
<div class="line"><span class="comment">/// Actions before adapt: Wipe the meshes face elements</span></div>
<div class="line"><span class="comment"></span><span class="comment">//========================================================================</span></div>
<div class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> ELASTICITY_ELEMENT, <span class="keyword">class</span> HELMHOLTZ_ELEMENT&gt;</div>
<div class="line"><span class="keywordtype">void</span> <a class="code" href="classCoatedSphereProblem.html#a0cd5d4eea9d34eefd829f7539c41c998">CoatedSphereProblem&lt;ELASTICITY_ELEMENT,HELMHOLTZ_ELEMENT&gt;::</a></div>
<div class="line"><a class="code" href="classCoatedSphereProblem.html#a0cd5d4eea9d34eefd829f7539c41c998">actions_before_adapt</a>()</div>
<div class="line">{</div>
<div class="line"> <span class="comment">// Kill the solid traction elements and wipe surface mesh</span></div>
<div class="line"> delete_face_elements(Solid_traction_mesh_pt);</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Kill the fsi traction elements and wipe surface mesh</span></div>
<div class="line"> delete_face_elements(FSI_traction_mesh_pt);</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Kill Helmholtz FSI flux elements</span></div>
<div class="line"> delete_face_elements(Helmholtz_fsi_flux_mesh_pt);</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Kill Helmholtz BC elements </span></div>
<div class="line"> delete_face_elements(Helmholtz_DtN_mesh_pt);</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Rebuild the Problem&#39;s global mesh from its various sub-meshes</span></div>
<div class="line"> rebuild_global_mesh();</div>
<div class="line"> </div>
<div class="line">}<span class="comment">// end of actions_before_adapt</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment">//=====================start_of_actions_after_adapt=======================</span><span class="comment"></span></div>
<div class="line"><span class="comment">///  Actions after adapt: Rebuild the meshes of face elements</span></div>
<div class="line"><span class="comment"></span><span class="comment">//========================================================================</span></div>
<div class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> ELASTICITY_ELEMENT, <span class="keyword">class</span> HELMHOLTZ_ELEMENT&gt;</div>
<div class="line"><span class="keywordtype">void</span> <a class="code" href="classCoatedSphereProblem.html#a77906dadd8ceb1d1d3182f298a0ca2d2">CoatedSphereProblem&lt;ELASTICITY_ELEMENT,HELMHOLTZ_ELEMENT&gt;::</a></div>
<div class="line"><a class="code" href="classCoatedSphereProblem.html#a77906dadd8ceb1d1d3182f298a0ca2d2">actions_after_adapt</a>()</div>
<div class="line">{</div>
<div class="line"> <span class="comment">// Complete problem setup</span></div>
<div class="line"> complete_problem_setup(); </div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Construct the solid traction elements</span></div>
<div class="line"> create_solid_traction_elements(); </div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Create fsi traction elements from all elements that are </span></div>
<div class="line"> <span class="comment">// adjacent to FSI boundaries and add them to surface meshes</span></div>
<div class="line"> create_fsi_traction_elements();</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Create Helmholtz fsi flux elements</span></div>
<div class="line"> create_helmholtz_fsi_flux_elements();</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Create DtN elements from all elements that are </span></div>
<div class="line"> <span class="comment">// adjacent to the outer boundary of Helmholtz mesh</span></div>
<div class="line"> create_helmholtz_DtN_elements();</div>
<div class="line">   </div>
<div class="line"> <span class="comment">// Setup interaction</span></div>
<div class="line"> setup_interaction();</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Rebuild the Problem&#39;s global mesh from its various sub-meshes</span></div>
<div class="line"> rebuild_global_mesh();</div>
<div class="line"> </div>
<div class="line">}<span class="comment">// end of actions_after_adapt</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment">//=====================start_of_actions_after_adapt=======================</span><span class="comment"></span></div>
<div class="line"><span class="comment">/// Complete problem setup: Apply boundary conditions and set</span></div>
<div class="line"><span class="comment">/// physical properties</span></div>
<div class="line"><span class="comment"></span><span class="comment">//========================================================================</span></div>
<div class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> ELASTICITY_ELEMENT, <span class="keyword">class</span> HELMHOLTZ_ELEMENT&gt;</div>
<div class="line"><span class="keywordtype">void</span> <a class="code" href="classCoatedSphereProblem.html#a7417ba994216c3d817259891176cd392">CoatedSphereProblem&lt;ELASTICITY_ELEMENT,HELMHOLTZ_ELEMENT&gt;::</a></div>
<div class="line"><a class="code" href="classCoatedSphereProblem.html#a7417ba994216c3d817259891176cd392">complete_problem_setup</a>()</div>
<div class="line">{</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Solid boundary conditions:</span></div>
<div class="line"> <span class="comment">//---------------------------</span></div>
<div class="line"> <span class="comment">// Pin real and imag part of horizontal and azimuthal displacement components </span></div>
<div class="line"> <span class="comment">//---------------------------------------------------------------------------</span></div>
<div class="line"> <span class="comment">// on vertical boundaries</span></div>
<div class="line"> <span class="comment">//-----------------------</span></div>
<div class="line"> {  </div>
<div class="line">  <span class="comment">//Loop over the nodes to pin and assign boundary displacements on </span></div>
<div class="line">  <span class="comment">//solid boundary</span></div>
<div class="line">  <span class="keywordtype">unsigned</span> n_node = Solid_mesh_pt-&gt;nboundary_node(Upper_symmetry_boundary_id);</div>
<div class="line">  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i=0;i&lt;n_node;i++)</div>
<div class="line">   {</div>
<div class="line">    Node* nod_pt=Solid_mesh_pt-&gt;boundary_node_pt(Upper_symmetry_boundary_id,i);</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Real part of r-displacement </span></div>
<div class="line">    nod_pt-&gt;pin(0);</div>
<div class="line">    nod_pt-&gt;set_value(0,0.0);</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Imag part of r-displacement</span></div>
<div class="line">    nod_pt-&gt;pin(3);</div>
<div class="line">    nod_pt-&gt;set_value(3,0.0);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Real part of phi-displacement </span></div>
<div class="line">    nod_pt-&gt;pin(2);</div>
<div class="line">    nod_pt-&gt;set_value(2,0.0);</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Imag part of phi-displacement</span></div>
<div class="line">    nod_pt-&gt;pin(5);</div>
<div class="line">    nod_pt-&gt;set_value(5,0.0);</div>
<div class="line">   }</div>
<div class="line"> }</div>
<div class="line"> {</div>
<div class="line">  <span class="comment">//Loop over the nodes to pin and assign boundary displacements on </span></div>
<div class="line">  <span class="comment">//solid boundary</span></div>
<div class="line">  <span class="keywordtype">unsigned</span> n_node = Solid_mesh_pt-&gt;nboundary_node(Lower_symmetry_boundary_id);</div>
<div class="line">  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i=0;i&lt;n_node;i++)</div>
<div class="line">   {</div>
<div class="line">    Node* nod_pt=Solid_mesh_pt-&gt;boundary_node_pt(Lower_symmetry_boundary_id,i);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Real part of r-displacement </span></div>
<div class="line">    nod_pt-&gt;pin(0);</div>
<div class="line">    nod_pt-&gt;set_value(0,0.0);</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Imag part of r-displacement</span></div>
<div class="line">    nod_pt-&gt;pin(3);</div>
<div class="line">    nod_pt-&gt;set_value(3,0.0);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Real part of phi-displacement </span></div>
<div class="line">    nod_pt-&gt;pin(2);</div>
<div class="line">    nod_pt-&gt;set_value(2,0.0);</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Imag part of phi-displacement</span></div>
<div class="line">    nod_pt-&gt;pin(5);</div>
<div class="line">    nod_pt-&gt;set_value(5,0.0);</div>
<div class="line">   }</div>
<div class="line"> }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> <span class="comment">//Assign the physical properties to the elements</span></div>
<div class="line"> <span class="comment">//----------------------------------------------</span></div>
<div class="line"> <span class="keywordtype">unsigned</span> nreg=Solid_mesh_pt-&gt;nregion();</div>
<div class="line"> <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> r=0;r&lt;nreg;r++)</div>
<div class="line">  {</div>
<div class="line">   <span class="keywordtype">unsigned</span> nel=Solid_mesh_pt-&gt;nregion_element(r);</div>
<div class="line">   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> e=0;e&lt;nel;e++)</div>
<div class="line">    {     </div>
<div class="line">     <span class="comment">//Cast to a solid element</span></div>
<div class="line">     ELASTICITY_ELEMENT *el_pt = </div>
<div class="line">      <span class="keyword">dynamic_cast&lt;</span>ELASTICITY_ELEMENT*<span class="keyword">&gt;</span>(Solid_mesh_pt-&gt;</div>
<div class="line">                                        region_element_pt(r,e));</div>
<div class="line">     </div>
<div class="line">     <span class="comment">// Set the pointer to Fourier wavenumber</span></div>
<div class="line">     el_pt-&gt;fourier_wavenumber_pt() = &amp;<a class="code" href="namespaceGlobal__Parameters.html#ae1198385d90f52c4ed921520ae43a9e7">Global_Parameters::Fourier_wavenumber</a>;</div>
<div class="line">   </div>
<div class="line">     <span class="comment">// Set the pointer to Poisson&#39;s ratio</span></div>
<div class="line">     el_pt-&gt;nu_pt() = &amp;<a class="code" href="namespaceGlobal__Parameters.html#a373950a959cd784c8f8028099807c2fb">Global_Parameters::Nu</a>;</div>
<div class="line">      </div>
<div class="line">     <span class="comment">// Square of non-dim frequency</span></div>
<div class="line">     el_pt-&gt;omega_sq_pt()= &amp;<a class="code" href="namespaceGlobal__Parameters.html#a91314f7f1cc80c43543948568f50f405">Global_Parameters::Omega_sq</a>[r];</div>
<div class="line"> </div>
<div class="line">     <span class="comment">// Set the pointer to non-dim Young&#39;s modulus</span></div>
<div class="line">     el_pt-&gt;youngs_modulus_pt() = &amp;<a class="code" href="namespaceGlobal__Parameters.html#aa961bcca2115ce9cb37cc8ccb1b90cae">Global_Parameters::E</a>[r];</div>
<div class="line"> </div>
<div class="line">    }</div>
<div class="line">  }    </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Complete the build of all Helmholtz elements so they are fully functional</span></div>
<div class="line"> <span class="keywordtype">unsigned</span> n_element = Helmholtz_mesh_pt-&gt;nelement();</div>
<div class="line"> <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i=0;i&lt;n_element;i++)</div>
<div class="line">  {</div>
<div class="line">   <span class="comment">// Upcast from GeneralsedElement to the present element</span></div>
<div class="line">   HELMHOLTZ_ELEMENT *el_pt = <span class="keyword">dynamic_cast&lt;</span>HELMHOLTZ_ELEMENT*<span class="keyword">&gt;</span>(</div>
<div class="line">    Helmholtz_mesh_pt-&gt;element_pt(i));</div>
<div class="line">   </div>
<div class="line">   <span class="comment">//Set the k_squared pointer</span></div>
<div class="line">   el_pt-&gt;k_squared_pt()=&amp;<a class="code" href="namespaceGlobal__Parameters.html#a91a3fa265abaf9e724c668ee800ffb29">Global_Parameters::K_squared</a>;</div>
<div class="line">   </div>
<div class="line">   <span class="comment">// Set pointer to Fourier wave number</span></div>
<div class="line">   el_pt-&gt;fourier_wavenumber_pt()=&amp;<a class="code" href="namespaceGlobal__Parameters.html#ae1198385d90f52c4ed921520ae43a9e7">Global_Parameters::Fourier_wavenumber</a>;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment">//============start_of_delete_face_elements================</span><span class="comment"></span></div>
<div class="line"><span class="comment">/// Delete face elements and wipe the mesh</span></div>
<div class="line"><span class="comment"></span><span class="comment">//==========================================================</span></div>
<div class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> ELASTICITY_ELEMENT, <span class="keyword">class</span> HELMHOLTZ_ELEMENT&gt;</div>
<div class="line"><span class="keywordtype">void</span> <a class="code" href="classCoatedSphereProblem.html#a1092568f8c12afcefe7cbf56ebbb115c">CoatedSphereProblem&lt;ELASTICITY_ELEMENT,HELMHOLTZ_ELEMENT&gt;::</a></div>
<div class="line"><a class="code" href="classCoatedSphereProblem.html#a1092568f8c12afcefe7cbf56ebbb115c">delete_face_elements</a>(Mesh* <span class="keyword">const</span> &amp; boundary_mesh_pt)</div>
<div class="line">{</div>
<div class="line"> <span class="comment">// How many surface elements are in the surface mesh</span></div>
<div class="line"> <span class="keywordtype">unsigned</span> n_element = boundary_mesh_pt-&gt;nelement();</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Loop over the surface elements</span></div>
<div class="line"> <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> e=0;e&lt;n_element;e++)</div>
<div class="line">  {</div>
<div class="line">   <span class="comment">//   Kill surface element</span></div>
<div class="line">   <span class="keyword">delete</span> boundary_mesh_pt-&gt;element_pt(e);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Wipe the mesh</span></div>
<div class="line"> boundary_mesh_pt-&gt;flush_element_and_node_storage();</div>
<div class="line"> </div>
<div class="line">} <span class="comment">// end of delete_face_elements</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment">//============start_of_create_outer_bc_elements===========================</span><span class="comment"></span></div>
<div class="line"><span class="comment">/// Create BC elements on outer boundary</span></div>
<div class="line"><span class="comment"></span><span class="comment">//========================================================================</span></div>
<div class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> ELASTICITY_ELEMENT, <span class="keyword">class</span> HELMHOLTZ_ELEMENT&gt;</div>
<div class="line"><span class="keywordtype">void</span> <a class="code" href="classCoatedSphereProblem.html#a867f4ed706f00a73c87c2c862dcf19c3">CoatedSphereProblem&lt;ELASTICITY_ELEMENT,HELMHOLTZ_ELEMENT&gt;::</a></div>
<div class="line"><a class="code" href="classCoatedSphereProblem.html#a867f4ed706f00a73c87c2c862dcf19c3">create_helmholtz_DtN_elements</a>()</div>
<div class="line">{</div>
<div class="line"> <span class="comment">// Outer boundary:</span></div>
<div class="line"> <span class="keywordtype">unsigned</span> b=HH_outer_boundary_id;</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Loop over the bulk elements adjacent to boundary b?</span></div>
<div class="line"> <span class="keywordtype">unsigned</span> n_element = Helmholtz_mesh_pt-&gt;nboundary_element(b);</div>
<div class="line"> <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> e=0;e&lt;n_element;e++)</div>
<div class="line">  {</div>
<div class="line">   <span class="comment">// Get pointer to the bulk element that is adjacent to boundary b</span></div>
<div class="line">   HELMHOLTZ_ELEMENT* bulk_elem_pt = <span class="keyword">dynamic_cast&lt;</span>HELMHOLTZ_ELEMENT*<span class="keyword">&gt;</span>(</div>
<div class="line">    Helmholtz_mesh_pt-&gt;boundary_element_pt(b,e));</div>
<div class="line">   </div>
<div class="line">   <span class="comment">//Find the index of the face of element e along boundary b </span></div>
<div class="line">   <span class="keywordtype">int</span> face_index = Helmholtz_mesh_pt-&gt;face_index_at_boundary(b,e);</div>
<div class="line">   </div>
<div class="line">   <span class="comment">// Build the corresponding DtN element</span></div>
<div class="line">   FourierDecomposedHelmholtzDtNBoundaryElement&lt;HELMHOLTZ_ELEMENT&gt;* </div>
<div class="line">    flux_element_pt = <span class="keyword">new</span> </div>
<div class="line">    FourierDecomposedHelmholtzDtNBoundaryElement&lt;HELMHOLTZ_ELEMENT&gt;</div>
<div class="line">    (bulk_elem_pt,face_index);</div>
<div class="line">   </div>
<div class="line">   <span class="comment">//Add the flux boundary element to the  helmholtz_DtN_mesh</span></div>
<div class="line">   Helmholtz_DtN_mesh_pt-&gt;add_element_pt(flux_element_pt);</div>
<div class="line">   </div>
<div class="line">   <span class="comment">// Set pointer to the mesh that contains all the boundary condition</span></div>
<div class="line">   <span class="comment">// elements on this boundary</span></div>
<div class="line">   flux_element_pt-&gt;set_outer_boundary_mesh_pt(Helmholtz_DtN_mesh_pt);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">} <span class="comment">// end_of_create_outer_bc_elements</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment">//=====================start_of_setup_interaction======================</span><span class="comment"></span></div>
<div class="line"><span class="comment">/// Setup interaction between two fields</span></div>
<div class="line"><span class="comment"></span><span class="comment">//========================================================================</span></div>
<div class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> ELASTICITY_ELEMENT, <span class="keyword">class</span> HELMHOLTZ_ELEMENT&gt;</div>
<div class="line"><span class="keywordtype">void</span> <a class="code" href="classCoatedSphereProblem.html#aeea43c892871a6c65df992aedc3b3547">CoatedSphereProblem&lt;ELASTICITY_ELEMENT,HELMHOLTZ_ELEMENT&gt;::</a></div>
<div class="line"><a class="code" href="classCoatedSphereProblem.html#aeea43c892871a6c65df992aedc3b3547">setup_interaction</a>()</div>
<div class="line">{</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Setup Helmholtz &quot;pressure&quot; load on traction elements</span></div>
<div class="line"> <span class="keywordtype">unsigned</span> boundary_in_helmholtz_mesh=HH_inner_boundary_id;</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Doc boundary coordinate for Helmholtz</span></div>
<div class="line"> ofstream the_file;</div>
<div class="line"> the_file.open(<span class="stringliteral">&quot;boundary_coordinate_hh.dat&quot;</span>);</div>
<div class="line"> Helmholtz_mesh_pt-&gt;Mesh::template doc_boundary_coordinates&lt;HELMHOLTZ_ELEMENT&gt;</div>
<div class="line">  (boundary_in_helmholtz_mesh, the_file);</div>
<div class="line"> the_file.close();</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Setup interaction</span></div>
<div class="line">  Multi_domain_functions::setup_bulk_elements_adjacent_to_face_mesh</div>
<div class="line">  &lt;HELMHOLTZ_ELEMENT,2&gt;</div>
<div class="line">  (<span class="keyword">this</span>,boundary_in_helmholtz_mesh,Helmholtz_mesh_pt,FSI_traction_mesh_pt);</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Setup Helmholtz flux from normal displacement interaction</span></div>
<div class="line"> <span class="keywordtype">unsigned</span> boundary_in_solid_mesh=Outer_boundary_id;</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Doc boundary coordinate for solid mesh</span></div>
<div class="line"> the_file.open(<span class="stringliteral">&quot;boundary_coordinate_solid.dat&quot;</span>);</div>
<div class="line"> Solid_mesh_pt-&gt;Mesh::template doc_boundary_coordinates&lt;ELASTICITY_ELEMENT&gt;</div>
<div class="line">  (boundary_in_solid_mesh, the_file);</div>
<div class="line"> the_file.close();</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Setup interaction</span></div>
<div class="line"> Multi_domain_functions::setup_bulk_elements_adjacent_to_face_mesh</div>
<div class="line">  &lt;ELASTICITY_ELEMENT,2&gt;(</div>
<div class="line">   <span class="keyword">this</span>,boundary_in_solid_mesh,Solid_mesh_pt,Helmholtz_fsi_flux_mesh_pt);</div>
<div class="line"> </div>
<div class="line">}<span class="comment">// end_of_setup_interaction</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment">//============start_of_create_fsi_traction_elements======================</span><span class="comment"></span></div>
<div class="line"><span class="comment">/// Create fsi traction elements </span></div>
<div class="line"><span class="comment"></span><span class="comment">//=======================================================================</span></div>
<div class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> ELASTICITY_ELEMENT, <span class="keyword">class</span> HELMHOLTZ_ELEMENT&gt;</div>
<div class="line"><span class="keywordtype">void</span> <a class="code" href="classCoatedSphereProblem.html#a2d342158b3058cd5392e2de3fd7595da">CoatedSphereProblem&lt;ELASTICITY_ELEMENT,HELMHOLTZ_ELEMENT&gt;::</a></div>
<div class="line"><a class="code" href="classCoatedSphereProblem.html#a2d342158b3058cd5392e2de3fd7595da">create_fsi_traction_elements</a>()</div>
<div class="line">{</div>
<div class="line"> <span class="comment">// We&#39;re on outer boundary of the solid mesh</span></div>
<div class="line"> <span class="keywordtype">unsigned</span> b=Outer_boundary_id;</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// How many bulk elements are adjacent to boundary b?</span></div>
<div class="line"> <span class="keywordtype">unsigned</span> n_element = Solid_mesh_pt-&gt;nboundary_element(b);</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Loop over the bulk elements adjacent to boundary b</span></div>
<div class="line"> <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> e=0;e&lt;n_element;e++)</div>
<div class="line">  {</div>
<div class="line">   <span class="comment">// Get pointer to the bulk element that is adjacent to boundary b</span></div>
<div class="line">   ELASTICITY_ELEMENT* bulk_elem_pt = <span class="keyword">dynamic_cast&lt;</span>ELASTICITY_ELEMENT*<span class="keyword">&gt;</span>(</div>
<div class="line">    Solid_mesh_pt-&gt;boundary_element_pt(b,e));</div>
<div class="line">   </div>
<div class="line">   <span class="comment">//Find the index of the face of element e along boundary b</span></div>
<div class="line">   <span class="keywordtype">int</span> face_index = Solid_mesh_pt-&gt;face_index_at_boundary(b,e);</div>
<div class="line">   </div>
<div class="line">   <span class="comment">// Create element</span></div>
<div class="line">   FourierDecomposedTimeHarmonicLinElastLoadedByHelmholtzPressureBCElement</div>
<div class="line">    &lt;ELASTICITY_ELEMENT,HELMHOLTZ_ELEMENT&gt;* el_pt=</div>
<div class="line">    <span class="keyword">new</span> FourierDecomposedTimeHarmonicLinElastLoadedByHelmholtzPressureBCElement</div>
<div class="line">    &lt;ELASTICITY_ELEMENT,HELMHOLTZ_ELEMENT&gt;(bulk_elem_pt,</div>
<div class="line">                                           face_index);   </div>
<div class="line">   <span class="comment">// Add to mesh</span></div>
<div class="line">   FSI_traction_mesh_pt-&gt;add_element_pt(el_pt);</div>
<div class="line">   </div>
<div class="line">   <span class="comment">// Associate element with bulk boundary (to allow it to access</span></div>
<div class="line">   <span class="comment">// the boundary coordinates in the bulk mesh)</span></div>
<div class="line">   el_pt-&gt;set_boundary_number_in_bulk_mesh(b); </div>
<div class="line">   </div>
<div class="line">   <span class="comment">// Set FSI parameter</span></div>
<div class="line">   el_pt-&gt;q_pt()=&amp;<a class="code" href="namespaceGlobal__Parameters.html#a7814fddf663e56168174a42d2cd6b4c1">Global_Parameters::Q</a>;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">} <span class="comment">// end_of_create_fsi_traction_elements</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment">//============start_of_create_helmholtz_fsi_flux_elements================</span><span class="comment"></span></div>
<div class="line"><span class="comment">/// Create Helmholtz fsi flux elements </span></div>
<div class="line"><span class="comment"></span><span class="comment">//=======================================================================</span></div>
<div class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> ELASTICITY_ELEMENT, <span class="keyword">class</span> HELMHOLTZ_ELEMENT&gt;</div>
<div class="line"><span class="keywordtype">void</span> <a class="code" href="classCoatedSphereProblem.html#a9a301689052eefd53552aadc23ff893b">CoatedSphereProblem&lt;ELASTICITY_ELEMENT,HELMHOLTZ_ELEMENT&gt;::</a></div>
<div class="line"><a class="code" href="classCoatedSphereProblem.html#a9a301689052eefd53552aadc23ff893b">create_helmholtz_fsi_flux_elements</a>()</div>
<div class="line">{</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Attach to inner boundary of Helmholtz mesh </span></div>
<div class="line"> <span class="keywordtype">unsigned</span> b=HH_inner_boundary_id;</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// How many bulk elements are adjacent to boundary b?</span></div>
<div class="line"> <span class="keywordtype">unsigned</span> n_element = Helmholtz_mesh_pt-&gt;nboundary_element(b);</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Loop over the bulk elements adjacent to boundary b</span></div>
<div class="line"> <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> e=0;e&lt;n_element;e++)</div>
<div class="line">  {</div>
<div class="line">   <span class="comment">// Get pointer to the bulk element that is adjacent to boundary b</span></div>
<div class="line">   HELMHOLTZ_ELEMENT* bulk_elem_pt = <span class="keyword">dynamic_cast&lt;</span>HELMHOLTZ_ELEMENT*<span class="keyword">&gt;</span>(</div>
<div class="line">    Helmholtz_mesh_pt-&gt;boundary_element_pt(b,e));</div>
<div class="line">   </div>
<div class="line">   <span class="comment">//Find the index of the face of element e along boundary b</span></div>
<div class="line">   <span class="keywordtype">int</span> face_index = Helmholtz_mesh_pt-&gt;face_index_at_boundary(b,e);</div>
<div class="line">   </div>
<div class="line">   <span class="comment">// Create element</span></div>
<div class="line">   FourierDecomposedHelmholtzFluxFromNormalDisplacementBCElement</div>
<div class="line">    &lt;HELMHOLTZ_ELEMENT,ELASTICITY_ELEMENT&gt;* el_pt=</div>
<div class="line">    <span class="keyword">new</span> FourierDecomposedHelmholtzFluxFromNormalDisplacementBCElement</div>
<div class="line">    &lt;HELMHOLTZ_ELEMENT,ELASTICITY_ELEMENT&gt;(bulk_elem_pt,</div>
<div class="line">                                           face_index);</div>
<div class="line">   </div>
<div class="line">   <span class="comment">// Add to mesh</span></div>
<div class="line">   Helmholtz_fsi_flux_mesh_pt-&gt;add_element_pt(el_pt);</div>
<div class="line">   </div>
<div class="line">   <span class="comment">// Associate element with bulk boundary (to allow it to access</span></div>
<div class="line">   <span class="comment">// the boundary coordinates in the bulk mesh)</span></div>
<div class="line">   el_pt-&gt;set_boundary_number_in_bulk_mesh(b); </div>
<div class="line">  }  </div>
<div class="line">  </div>
<div class="line">} <span class="comment">// end_of_create_helmholtz_fsi_flux_elements</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment">//============start_of_create_solid_traction_elements====================</span><span class="comment"></span></div>
<div class="line"><span class="comment">/// Create solid traction elements </span></div>
<div class="line"><span class="comment"></span><span class="comment">//=======================================================================</span></div>
<div class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> ELASTICITY_ELEMENT, <span class="keyword">class</span> HELMHOLTZ_ELEMENT&gt;</div>
<div class="line"><span class="keywordtype">void</span> <a class="code" href="classCoatedSphereProblem.html#a93cb1d435858c7a1835cbd74f7cb5db8">CoatedSphereProblem&lt;ELASTICITY_ELEMENT,HELMHOLTZ_ELEMENT&gt;::</a></div>
<div class="line"><a class="code" href="classCoatedSphereProblem.html#a93cb1d435858c7a1835cbd74f7cb5db8">create_solid_traction_elements</a>()</div>
<div class="line">{</div>
<div class="line"> <span class="comment">// Loop over pressure loaded boundaries</span></div>
<div class="line"> <span class="keywordtype">unsigned</span> b=0;</div>
<div class="line"> <span class="keywordtype">unsigned</span> nb=3;</div>
<div class="line"> <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i=0;i&lt;nb;i++) </div>
<div class="line">  {</div>
<div class="line">   <span class="keywordflow">switch</span>(i)</div>
<div class="line">    {</div>
<div class="line">    <span class="keywordflow">case</span> 0:</div>
<div class="line">     b=Upper_inner_boundary_id;</div>
<div class="line">     <span class="keywordflow">break</span>;</div>
<div class="line">     </div>
<div class="line">    <span class="keywordflow">case</span> 1:</div>
<div class="line">     b=Lower_inner_boundary_id;</div>
<div class="line">     <span class="keywordflow">break</span>;</div>
<div class="line">     </div>
<div class="line">    <span class="keywordflow">case</span> 2:</div>
<div class="line">     b=Rib_divider_boundary_id;</div>
<div class="line">     <span class="keywordflow">break</span>;</div>
<div class="line">    }</div>
<div class="line">   </div>
<div class="line">   <span class="comment">// We&#39;re attaching face elements to region 0</span></div>
<div class="line">   <span class="keywordtype">unsigned</span> r=0;</div>
<div class="line">   </div>
<div class="line">   <span class="comment">// How many bulk elements are adjacent to boundary b?</span></div>
<div class="line">   <span class="keywordtype">unsigned</span> n_element = Solid_mesh_pt-&gt;nboundary_element_in_region(b,r);</div>
<div class="line">   </div>
<div class="line">   <span class="comment">// Loop over the bulk elements adjacent to boundary b</span></div>
<div class="line">   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> e=0;e&lt;n_element;e++)</div>
<div class="line">    {</div>
<div class="line">     <span class="comment">// Get pointer to the bulk element that is adjacent to boundary b</span></div>
<div class="line">     ELASTICITY_ELEMENT* bulk_elem_pt = <span class="keyword">dynamic_cast&lt;</span>ELASTICITY_ELEMENT*<span class="keyword">&gt;</span>(</div>
<div class="line">      Solid_mesh_pt-&gt;boundary_element_in_region_pt(b,r,e));</div>
<div class="line">     </div>
<div class="line">     <span class="comment">//Find the index of the face of element e along boundary b</span></div>
<div class="line">     <span class="keywordtype">int</span> face_index = Solid_mesh_pt-&gt;face_index_at_boundary_in_region(b,r,e);</div>
<div class="line">     </div>
<div class="line">     <span class="comment">// Create element</span></div>
<div class="line">     TimeHarmonicFourierDecomposedLinearElasticityTractionElement</div>
<div class="line">      &lt;ELASTICITY_ELEMENT&gt;* el_pt=</div>
<div class="line">      <span class="keyword">new</span> TimeHarmonicFourierDecomposedLinearElasticityTractionElement</div>
<div class="line">      &lt;ELASTICITY_ELEMENT&gt;(bulk_elem_pt,face_index);   </div>
<div class="line">     </div>
<div class="line">     <span class="comment">// Add to mesh</span></div>
<div class="line">     Solid_traction_mesh_pt-&gt;add_element_pt(el_pt);</div>
<div class="line">     </div>
<div class="line">     <span class="comment">// Associate element with bulk boundary (to allow it to access</span></div>
<div class="line">     <span class="comment">// the boundary coordinates in the bulk mesh)</span></div>
<div class="line">     el_pt-&gt;set_boundary_number_in_bulk_mesh(b); </div>
<div class="line">     </div>
<div class="line">     <span class="comment">//Set the traction function</span></div>
<div class="line">     el_pt-&gt;traction_fct_pt() = <a class="code" href="namespaceGlobal__Parameters.html#a0ddb3a77481b907fbb34f2e8d0a6eb9f">Global_Parameters::pressure_load</a>;  </div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line">} <span class="comment">// end of create_traction_elements</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment">//==============start_of_doc_solution===============================</span><span class="comment"></span></div>
<div class="line"><span class="comment">/// Doc the solution</span></div>
<div class="line"><span class="comment"></span><span class="comment">//==================================================================</span></div>
<div class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> ELASTICITY_ELEMENT, <span class="keyword">class</span> HELMHOLTZ_ELEMENT&gt;</div>
<div class="line"><span class="keywordtype">void</span> <a class="code" href="classCoatedSphereProblem.html#aaeade2a110160c002b2b45954a5a0edc">CoatedSphereProblem&lt;ELASTICITY_ELEMENT,HELMHOLTZ_ELEMENT&gt;::</a></div>
<div class="line"><a class="code" href="classCoatedSphereProblem.html#aaeade2a110160c002b2b45954a5a0edc">doc_solution</a>(DocInfo&amp; doc_info)</div>
<div class="line">{</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Doc parameters</span></div>
<div class="line"> oomph_info &lt;&lt; <span class="stringliteral">&quot;Writing result for step &quot;</span> &lt;&lt; doc_info.number() </div>
<div class="line">            &lt;&lt; <span class="stringliteral">&quot;. Parameters: &quot;</span>&lt;&lt; std::endl;</div>
<div class="line"> oomph_info &lt;&lt; <span class="stringliteral">&quot;Fourier mode number : N = &quot;</span></div>
<div class="line">            &lt;&lt; <a class="code" href="namespaceGlobal__Parameters.html#ae1198385d90f52c4ed921520ae43a9e7">Global_Parameters::Fourier_wavenumber</a> &lt;&lt; std::endl;</div>
<div class="line"> oomph_info &lt;&lt; <span class="stringliteral">&quot;FSI parameter : Q = &quot;</span> &lt;&lt; <a class="code" href="namespaceGlobal__Parameters.html#a7814fddf663e56168174a42d2cd6b4c1">Global_Parameters::Q</a> &lt;&lt; std::endl;</div>
<div class="line"> oomph_info &lt;&lt; <span class="stringliteral">&quot;Fluid outer radius : R = &quot;</span> &lt;&lt; <a class="code" href="namespaceGlobal__Parameters.html#a88ded445ecd7bd89701409e68fd0b900">Global_Parameters::Outer_radius</a></div>
<div class="line">            &lt;&lt; std::endl;</div>
<div class="line"> oomph_info &lt;&lt; <span class="stringliteral">&quot;Fluid wavenumber : k^2 = &quot;</span> &lt;&lt; <a class="code" href="namespaceGlobal__Parameters.html#a91a3fa265abaf9e724c668ee800ffb29">Global_Parameters::K_squared</a></div>
<div class="line">            &lt;&lt; std::endl;</div>
<div class="line"> oomph_info &lt;&lt; <span class="stringliteral">&quot;Solid wavenumber : Omega_sq = &quot;</span> </div>
<div class="line">            &lt;&lt; <a class="code" href="namespaceGlobal__Parameters.html#a91314f7f1cc80c43543948568f50f405">Global_Parameters::Omega_sq</a>[0] &lt;&lt; std::endl;</div>
<div class="line"> oomph_info &lt;&lt; <span class="stringliteral">&quot;Solid wavenumber : Omega_sq = &quot;</span> </div>
<div class="line">            &lt;&lt; <a class="code" href="namespaceGlobal__Parameters.html#a91314f7f1cc80c43543948568f50f405">Global_Parameters::Omega_sq</a>[1] </div>
<div class="line">            &lt;&lt; std::endl &lt;&lt; std::endl; </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> ofstream some_file,some_file2;</div>
<div class="line"> <span class="keywordtype">char</span> filename[100];</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Number of plot points</span></div>
<div class="line"> <span class="keywordtype">unsigned</span> n_plot=5; </div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Compute/output the radiated power</span></div>
<div class="line"> <span class="comment">//----------------------------------</span></div>
<div class="line"> sprintf(filename,<span class="stringliteral">&quot;%s/power%i.dat&quot;</span>,doc_info.directory().c_str(),</div>
<div class="line">         doc_info.number());</div>
<div class="line"> some_file.open(filename);</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Accumulate contribution from elements</span></div>
<div class="line"> <span class="keywordtype">double</span> power=0.0;</div>
<div class="line"> <span class="keywordtype">unsigned</span> nn_element=Helmholtz_DtN_mesh_pt-&gt;nelement(); </div>
<div class="line"> <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> e=0;e&lt;nn_element;e++)</div>
<div class="line">  {</div>
<div class="line">   FourierDecomposedHelmholtzBCElementBase&lt;HELMHOLTZ_ELEMENT&gt; *el_pt = </div>
<div class="line">    <span class="keyword">dynamic_cast&lt;</span>FourierDecomposedHelmholtzBCElementBase&lt;HELMHOLTZ_ELEMENT&gt;*<span class="keyword">&gt;</span>(</div>
<div class="line">     Helmholtz_DtN_mesh_pt-&gt;element_pt(e)); </div>
<div class="line">   power += el_pt-&gt;global_power_contribution(some_file);</div>
<div class="line">  }</div>
<div class="line"> some_file.close();</div>
<div class="line"> oomph_info &lt;&lt; <span class="stringliteral">&quot;Radiated power: &quot;</span> &lt;&lt; power &lt;&lt; std::endl;</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Output displacement field</span></div>
<div class="line"> <span class="comment">//--------------------------</span></div>
<div class="line"> sprintf(filename,<span class="stringliteral">&quot;%s/elast_soln%i.dat&quot;</span>,doc_info.directory().c_str(),</div>
<div class="line">         doc_info.number());</div>
<div class="line"> some_file.open(filename);</div>
<div class="line"> Solid_mesh_pt-&gt;output(some_file,n_plot);</div>
<div class="line"> some_file.close();</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Output Helmholtz</span></div>
<div class="line"> <span class="comment">//-----------------</span></div>
<div class="line"> sprintf(filename,<span class="stringliteral">&quot;%s/helmholtz_soln%i.dat&quot;</span>,doc_info.directory().c_str(),</div>
<div class="line">         doc_info.number());</div>
<div class="line"> some_file.open(filename);</div>
<div class="line"> Helmholtz_mesh_pt-&gt;output(some_file,n_plot);</div>
<div class="line"> some_file.close();</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Output fsi traction elements</span></div>
<div class="line"> <span class="comment">//----------------------------- </span></div>
<div class="line"> sprintf(filename,<span class="stringliteral">&quot;%s/fsi_traction_soln%i.dat&quot;</span>,doc_info.directory().c_str(),</div>
<div class="line">         doc_info.number());</div>
<div class="line"> some_file.open(filename);</div>
<div class="line"> FSI_traction_mesh_pt-&gt;output(some_file,n_plot);</div>
<div class="line"> some_file.close();</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Output Helmholtz fsi flux elements</span></div>
<div class="line"> <span class="comment">//----------------------------------- </span></div>
<div class="line"> sprintf(filename,<span class="stringliteral">&quot;%s/fsi_flux_bc_soln%i.dat&quot;</span>,doc_info.directory().c_str(),</div>
<div class="line">         doc_info.number());</div>
<div class="line"> some_file.open(filename);</div>
<div class="line"> Helmholtz_fsi_flux_mesh_pt-&gt;output(some_file,n_plot);</div>
<div class="line"> some_file.close();</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Write trace file</span></div>
<div class="line"> Trace_file &lt;&lt; <a class="code" href="namespaceGlobal__Parameters.html#a7814fddf663e56168174a42d2cd6b4c1">Global_Parameters::Q</a> &lt;&lt; <span class="stringliteral">&quot; &quot;</span> </div>
<div class="line">            &lt;&lt; <a class="code" href="namespaceGlobal__Parameters.html#a91a3fa265abaf9e724c668ee800ffb29">Global_Parameters::K_squared</a> &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line">            &lt;&lt; <a class="code" href="namespaceGlobal__Parameters.html#a517d4c31b8bce6563c2f605266dd9679">Global_Parameters::Density_ratio</a>[0] &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line">            &lt;&lt; <a class="code" href="namespaceGlobal__Parameters.html#a517d4c31b8bce6563c2f605266dd9679">Global_Parameters::Density_ratio</a>[1] &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line">            &lt;&lt; <a class="code" href="namespaceGlobal__Parameters.html#a91314f7f1cc80c43543948568f50f405">Global_Parameters::Omega_sq</a>[0].real() &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line">            &lt;&lt; <a class="code" href="namespaceGlobal__Parameters.html#a91314f7f1cc80c43543948568f50f405">Global_Parameters::Omega_sq</a>[1].real() &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line">            &lt;&lt; power &lt;&lt; <span class="stringliteral">&quot; &quot;</span> </div>
<div class="line">            &lt;&lt; std::endl;</div>
<div class="line">   </div>
<div class="line"> <span class="comment">// Bump up counter</span></div>
<div class="line"> doc_info.number()++;</div>
<div class="line"> </div>
<div class="line">} <span class="comment">//end_of_doc_solution</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment">//=======start_of_main==================================================</span><span class="comment"></span></div>
<div class="line"><span class="comment">/// Driver for coated sphere loaded by lineared fluid loading</span></div>
<div class="line"><span class="comment"></span><span class="comment">//======================================================================</span></div>
<div class="line"><span class="keywordtype">int</span> <a class="code" href="fourier__decomposed__acoustic__fsi_8cc.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a>(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv)</div>
<div class="line">{</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Store command line arguments</span></div>
<div class="line"> CommandLineArgs::setup(argc,argv);</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Define possible command line arguments and parse the ones that</span></div>
<div class="line"> <span class="comment">// were actually specified</span></div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Output directory</span></div>
<div class="line"> CommandLineArgs::specify_command_line_flag(<span class="stringliteral">&quot;--dir&quot;</span>,</div>
<div class="line">                                            &amp;<a class="code" href="namespaceGlobal__Parameters.html#a301ab922df72030c660b21328d6caf76">Global_Parameters::Directory</a>);</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Parameter controlling the sharpness of the pressure load</span></div>
<div class="line"> CommandLineArgs::specify_command_line_flag(<span class="stringliteral">&quot;--alpha&quot;</span>,</div>
<div class="line">                                            &amp;<a class="code" href="namespaceGlobal__Parameters.html#afbe27ad463a1fb23cb99d029a9fac731">Global_Parameters::Alpha</a>);</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Parse command line</span></div>
<div class="line"> CommandLineArgs::parse_and_assign(); </div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Doc what has actually been specified on the command line</span></div>
<div class="line"> CommandLineArgs::doc_specified_flags();</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Set values for parameter values</span></div>
<div class="line"> <a class="code" href="namespaceGlobal__Parameters.html#a7814fddf663e56168174a42d2cd6b4c1">Global_Parameters::Q</a>=5.0; </div>
<div class="line"> <a class="code" href="namespaceGlobal__Parameters.html#a517d4c31b8bce6563c2f605266dd9679">Global_Parameters::Density_ratio</a>[0]=0.1; </div>
<div class="line"> <a class="code" href="namespaceGlobal__Parameters.html#a517d4c31b8bce6563c2f605266dd9679">Global_Parameters::Density_ratio</a>[1]=0.1; </div>
<div class="line"> <a class="code" href="namespaceGlobal__Parameters.html#ae0f9a80fb7510dbfbbef22582da231b7">Global_Parameters::update_parameter_values</a>();</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Update dependent parameters values</span></div>
<div class="line"> <a class="code" href="namespaceGlobal__Parameters.html#ae0f9a80fb7510dbfbbef22582da231b7">Global_Parameters::update_parameter_values</a>();</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Set up doc info</span></div>
<div class="line"> DocInfo doc_info;</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Set output directory</span></div>
<div class="line"> doc_info.set_directory(<a class="code" href="namespaceGlobal__Parameters.html#a301ab922df72030c660b21328d6caf76">Global_Parameters::Directory</a>);</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#ifdef ADAPTIVE</span></div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Set up the problem</span></div>
<div class="line"> <a class="code" href="classCoatedSphereProblem.html">CoatedSphereProblem</a>&lt;</div>
<div class="line">  ProjectableTimeHarmonicFourierDecomposedLinearElasticityElement</div>
<div class="line">  &lt;TTimeHarmonicFourierDecomposedLinearElasticityElement&lt;3&gt; &gt;,</div>
<div class="line">  ProjectableFourierDecomposedHelmholtzElement</div>
<div class="line">  &lt;TFourierDecomposedHelmholtzElement&lt;3&gt; &gt; &gt; problem;</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Set up the problem</span></div>
<div class="line"> <a class="code" href="classCoatedSphereProblem.html">CoatedSphereProblem&lt;TTimeHarmonicFourierDecomposedLinearElasticityElement&lt;3&gt;</a>,</div>
<div class="line">                     TFourierDecomposedHelmholtzElement&lt;3&gt; &gt; problem;</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> <span class="comment">//Parameter incrementation</span></div>
<div class="line"> <span class="keywordtype">unsigned</span> nstep=3;</div>
<div class="line"> <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i=0;i&lt;nstep;i++)</div>
<div class="line">  {</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#ifdef ADAPTIVE</span></div>
<div class="line"> </div>
<div class="line">   <span class="comment">// Solve the problem with Newton&#39;s method, allowing</span></div>
<div class="line">   <span class="comment">// up to max_adapt mesh adaptations after every solve.</span></div>
<div class="line">   <span class="keywordtype">unsigned</span> max_adapt=3;</div>
<div class="line">   problem.newton_solve(max_adapt);</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line"> </div>
<div class="line">   <span class="comment">// Solve the problem with Newton&#39;s method</span></div>
<div class="line">   problem.newton_solve();</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"> </div>
<div class="line">   <span class="comment">// Doc solution</span></div>
<div class="line">   problem.<a class="code" href="classCoatedSphereProblem.html#aaeade2a110160c002b2b45954a5a0edc">doc_solution</a>(doc_info);</div>
<div class="line"> </div>
<div class="line">   <span class="comment">// Make rib a lot heavier but keep its stiffness</span></div>
<div class="line">   <span class="keywordflow">if</span> (i==0)</div>
<div class="line">    {</div>
<div class="line">     <a class="code" href="namespaceGlobal__Parameters.html#aa961bcca2115ce9cb37cc8ccb1b90cae">Global_Parameters::E</a>[1]=1.0;</div>
<div class="line">     <a class="code" href="namespaceGlobal__Parameters.html#a517d4c31b8bce6563c2f605266dd9679">Global_Parameters::Density_ratio</a>[1]=10.0; </div>
<div class="line">     <a class="code" href="namespaceGlobal__Parameters.html#ae0f9a80fb7510dbfbbef22582da231b7">Global_Parameters::update_parameter_values</a>();</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">   <span class="comment">// Make rib very soft and inertia-less</span></div>
<div class="line">   <span class="keywordflow">if</span> (i==1)</div>
<div class="line">    {</div>
<div class="line">     <a class="code" href="namespaceGlobal__Parameters.html#aa961bcca2115ce9cb37cc8ccb1b90cae">Global_Parameters::E</a>[1]=1.0e-16;</div>
<div class="line">     <a class="code" href="namespaceGlobal__Parameters.html#a517d4c31b8bce6563c2f605266dd9679">Global_Parameters::Density_ratio</a>[1]=0.0; </div>
<div class="line">     <a class="code" href="namespaceGlobal__Parameters.html#ae0f9a80fb7510dbfbbef22582da231b7">Global_Parameters::update_parameter_values</a>();</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">} <span class="comment">//end_of_main</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="ttc" id="aclassCoatedSphereProblem_html"><div class="ttname"><a href="classCoatedSphereProblem.html">CoatedSphereProblem</a></div><div class="ttdoc">Coated sphere FSI.</div><div class="ttdef"><b>Definition:</b> <a href="fourier__decomposed__acoustic__fsi_8cc_source.html#l00126">fourier_decomposed_acoustic_fsi.cc:127</a></div></div>
<div class="ttc" id="aclassCoatedSphereProblem_html_a0cd5d4eea9d34eefd829f7539c41c998"><div class="ttname"><a href="classCoatedSphereProblem.html#a0cd5d4eea9d34eefd829f7539c41c998">CoatedSphereProblem::actions_before_adapt</a></div><div class="ttdeci">void actions_before_adapt()</div><div class="ttdoc">Actions before adapt: Wipe the face meshes.</div><div class="ttdef"><b>Definition:</b> <a href="unstructured__fourier__decomposed__acoustic__fsi_8cc_source.html#l00816">unstructured_fourier_decomposed_acoustic_fsi.cc:817</a></div></div>
<div class="ttc" id="aclassCoatedSphereProblem_html_a1092568f8c12afcefe7cbf56ebbb115c"><div class="ttname"><a href="classCoatedSphereProblem.html#a1092568f8c12afcefe7cbf56ebbb115c">CoatedSphereProblem::delete_face_elements</a></div><div class="ttdeci">void delete_face_elements(Mesh *const &amp;boundary_mesh_pt)</div><div class="ttdoc">Delete (face) elements in specified mesh.</div><div class="ttdef"><b>Definition:</b> <a href="unstructured__fourier__decomposed__acoustic__fsi_8cc_source.html#l00991">unstructured_fourier_decomposed_acoustic_fsi.cc:992</a></div></div>
<div class="ttc" id="aclassCoatedSphereProblem_html_a2d342158b3058cd5392e2de3fd7595da"><div class="ttname"><a href="classCoatedSphereProblem.html#a2d342158b3058cd5392e2de3fd7595da">CoatedSphereProblem::create_fsi_traction_elements</a></div><div class="ttdeci">void create_fsi_traction_elements()</div><div class="ttdoc">Create FSI traction elements.</div><div class="ttdef"><b>Definition:</b> <a href="fourier__decomposed__acoustic__fsi_8cc_source.html#l00505">fourier_decomposed_acoustic_fsi.cc:506</a></div></div>
<div class="ttc" id="aclassCoatedSphereProblem_html_a7417ba994216c3d817259891176cd392"><div class="ttname"><a href="classCoatedSphereProblem.html#a7417ba994216c3d817259891176cd392">CoatedSphereProblem::complete_problem_setup</a></div><div class="ttdeci">void complete_problem_setup()</div><div class="ttdoc">Complete problem setup: Apply boundary conditions and set physical properties.</div><div class="ttdef"><b>Definition:</b> <a href="unstructured__fourier__decomposed__acoustic__fsi_8cc_source.html#l00877">unstructured_fourier_decomposed_acoustic_fsi.cc:878</a></div></div>
<div class="ttc" id="aclassCoatedSphereProblem_html_a77906dadd8ceb1d1d3182f298a0ca2d2"><div class="ttname"><a href="classCoatedSphereProblem.html#a77906dadd8ceb1d1d3182f298a0ca2d2">CoatedSphereProblem::actions_after_adapt</a></div><div class="ttdeci">void actions_after_adapt()</div><div class="ttdoc">Actions after adapt: Rebuild the face meshes.</div><div class="ttdef"><b>Definition:</b> <a href="unstructured__fourier__decomposed__acoustic__fsi_8cc_source.html#l00842">unstructured_fourier_decomposed_acoustic_fsi.cc:843</a></div></div>
<div class="ttc" id="aclassCoatedSphereProblem_html_a867f4ed706f00a73c87c2c862dcf19c3"><div class="ttname"><a href="classCoatedSphereProblem.html#a867f4ed706f00a73c87c2c862dcf19c3">CoatedSphereProblem::create_helmholtz_DtN_elements</a></div><div class="ttdeci">void create_helmholtz_DtN_elements()</div><div class="ttdoc">Create DtN elements on outer boundary.</div><div class="ttdef"><b>Definition:</b> <a href="fourier__decomposed__acoustic__fsi_8cc_source.html#l00421">fourier_decomposed_acoustic_fsi.cc:422</a></div></div>
<div class="ttc" id="aclassCoatedSphereProblem_html_a93cb1d435858c7a1835cbd74f7cb5db8"><div class="ttname"><a href="classCoatedSphereProblem.html#a93cb1d435858c7a1835cbd74f7cb5db8">CoatedSphereProblem::create_solid_traction_elements</a></div><div class="ttdeci">void create_solid_traction_elements()</div><div class="ttdoc">Create solid traction elements.</div><div class="ttdef"><b>Definition:</b> <a href="unstructured__fourier__decomposed__acoustic__fsi_8cc_source.html#l01185">unstructured_fourier_decomposed_acoustic_fsi.cc:1186</a></div></div>
<div class="ttc" id="aclassCoatedSphereProblem_html_a9a301689052eefd53552aadc23ff893b"><div class="ttname"><a href="classCoatedSphereProblem.html#a9a301689052eefd53552aadc23ff893b">CoatedSphereProblem::create_helmholtz_fsi_flux_elements</a></div><div class="ttdeci">void create_helmholtz_fsi_flux_elements()</div><div class="ttdoc">Create Helmholtz FSI flux elements.</div><div class="ttdef"><b>Definition:</b> <a href="fourier__decomposed__acoustic__fsi_8cc_source.html#l00549">fourier_decomposed_acoustic_fsi.cc:550</a></div></div>
<div class="ttc" id="aclassCoatedSphereProblem_html_aaeade2a110160c002b2b45954a5a0edc"><div class="ttname"><a href="classCoatedSphereProblem.html#aaeade2a110160c002b2b45954a5a0edc">CoatedSphereProblem::doc_solution</a></div><div class="ttdeci">void doc_solution(DocInfo &amp;doc_info)</div><div class="ttdoc">Doc the solution.</div><div class="ttdef"><b>Definition:</b> <a href="fourier__decomposed__acoustic__fsi_8cc_source.html#l00592">fourier_decomposed_acoustic_fsi.cc:593</a></div></div>
<div class="ttc" id="aclassCoatedSphereProblem_html_ab9c983e7f0bed66f13d59bd65d6d151b"><div class="ttname"><a href="classCoatedSphereProblem.html#ab9c983e7f0bed66f13d59bd65d6d151b">CoatedSphereProblem::CoatedSphereProblem</a></div><div class="ttdeci">CoatedSphereProblem()</div><div class="ttdoc">Constructor:</div><div class="ttdef"><b>Definition:</b> <a href="fourier__decomposed__acoustic__fsi_8cc_source.html#l00188">fourier_decomposed_acoustic_fsi.cc:189</a></div></div>
<div class="ttc" id="aclassCoatedSphereProblem_html_aeea43c892871a6c65df992aedc3b3547"><div class="ttname"><a href="classCoatedSphereProblem.html#aeea43c892871a6c65df992aedc3b3547">CoatedSphereProblem::setup_interaction</a></div><div class="ttdeci">void setup_interaction()</div><div class="ttdoc">Setup interaction.</div><div class="ttdef"><b>Definition:</b> <a href="fourier__decomposed__acoustic__fsi_8cc_source.html#l00462">fourier_decomposed_acoustic_fsi.cc:463</a></div></div>
<div class="ttc" id="aclassMyStraightLine_html"><div class="ttname"><a href="classMyStraightLine.html">MyStraightLine</a></div><div class="ttdoc">////////////////////////////////////////////////////////////////////</div><div class="ttdef"><b>Definition:</b> <a href="unstructured__fourier__decomposed__acoustic__fsi_8cc_source.html#l00064">unstructured_fourier_decomposed_acoustic_fsi.cc:65</a></div></div>
<div class="ttc" id="afourier__decomposed__acoustic__fsi_8cc_html_a3c04138a5bfe5d72780bb7e82a18e627"><div class="ttname"><a href="fourier__decomposed__acoustic__fsi_8cc.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a></div><div class="ttdeci">int main(int argc, char **argv)</div><div class="ttdoc">Driver for coated sphere loaded by lineared fluid loading.</div><div class="ttdef"><b>Definition:</b> <a href="fourier__decomposed__acoustic__fsi_8cc_source.html#l00687">fourier_decomposed_acoustic_fsi.cc:687</a></div></div>
<div class="ttc" id="anamespaceGlobal__Parameters_html"><div class="ttname"><a href="namespaceGlobal__Parameters.html">Global_Parameters</a></div><div class="ttdoc">/////////////////////////////////////////////////////////////////// /////////////////////////////////...</div><div class="ttdef"><b>Definition:</b> <a href="fourier__decomposed__acoustic__fsi_8cc_source.html#l00060">fourier_decomposed_acoustic_fsi.cc:61</a></div></div>
<div class="ttc" id="anamespaceGlobal__Parameters_html_a0ddb3a77481b907fbb34f2e8d0a6eb9f"><div class="ttname"><a href="namespaceGlobal__Parameters.html#a0ddb3a77481b907fbb34f2e8d0a6eb9f">Global_Parameters::pressure_load</a></div><div class="ttdeci">void pressure_load(const Vector&lt; double &gt; &amp;x, const Vector&lt; double &gt; &amp;n, Vector&lt; std::complex&lt; double &gt; &gt; &amp;traction)</div><div class="ttdoc">Pressure load (real and imag part)</div><div class="ttdef"><b>Definition:</b> <a href="unstructured__fourier__decomposed__acoustic__fsi_8cc_source.html#l00155">unstructured_fourier_decomposed_acoustic_fsi.cc:155</a></div></div>
<div class="ttc" id="anamespaceGlobal__Parameters_html_a301ab922df72030c660b21328d6caf76"><div class="ttname"><a href="namespaceGlobal__Parameters.html#a301ab922df72030c660b21328d6caf76">Global_Parameters::Directory</a></div><div class="ttdeci">string Directory</div><div class="ttdoc">Output directory.</div><div class="ttdef"><b>Definition:</b> <a href="fourier__decomposed__acoustic__fsi_8cc_source.html#l00113">fourier_decomposed_acoustic_fsi.cc:113</a></div></div>
<div class="ttc" id="anamespaceGlobal__Parameters_html_a31fb55c20db4aa0127aafa20f0d76731"><div class="ttname"><a href="namespaceGlobal__Parameters.html#a31fb55c20db4aa0127aafa20f0d76731">Global_Parameters::P</a></div><div class="ttdeci">double P</div><div class="ttdoc">Uniform pressure.</div><div class="ttdef"><b>Definition:</b> <a href="unstructured__fourier__decomposed__acoustic__fsi_8cc_source.html#l00149">unstructured_fourier_decomposed_acoustic_fsi.cc:149</a></div></div>
<div class="ttc" id="anamespaceGlobal__Parameters_html_a373950a959cd784c8f8028099807c2fb"><div class="ttname"><a href="namespaceGlobal__Parameters.html#a373950a959cd784c8f8028099807c2fb">Global_Parameters::Nu</a></div><div class="ttdeci">std::complex&lt; double &gt; Nu(std::complex&lt; double &gt;(0.3, 0.0))</div><div class="ttdoc">Poisson's ratio Nu.</div></div>
<div class="ttc" id="anamespaceGlobal__Parameters_html_a517d4c31b8bce6563c2f605266dd9679"><div class="ttname"><a href="namespaceGlobal__Parameters.html#a517d4c31b8bce6563c2f605266dd9679">Global_Parameters::Density_ratio</a></div><div class="ttdeci">double Density_ratio</div><div class="ttdoc">Density ratio: solid to fluid.</div><div class="ttdef"><b>Definition:</b> <a href="fourier__decomposed__acoustic__fsi_8cc_source.html#l00085">fourier_decomposed_acoustic_fsi.cc:85</a></div></div>
<div class="ttc" id="anamespaceGlobal__Parameters_html_a7814fddf663e56168174a42d2cd6b4c1"><div class="ttname"><a href="namespaceGlobal__Parameters.html#a7814fddf663e56168174a42d2cd6b4c1">Global_Parameters::Q</a></div><div class="ttdeci">double Q</div><div class="ttdoc">FSI parameter.</div><div class="ttdef"><b>Definition:</b> <a href="fourier__decomposed__acoustic__fsi_8cc_source.html#l00070">fourier_decomposed_acoustic_fsi.cc:70</a></div></div>
<div class="ttc" id="anamespaceGlobal__Parameters_html_a88ded445ecd7bd89701409e68fd0b900"><div class="ttname"><a href="namespaceGlobal__Parameters.html#a88ded445ecd7bd89701409e68fd0b900">Global_Parameters::Outer_radius</a></div><div class="ttdeci">double Outer_radius</div><div class="ttdoc">Radius of outer boundary of Helmholtz domain.</div><div class="ttdef"><b>Definition:</b> <a href="fourier__decomposed__acoustic__fsi_8cc_source.html#l00067">fourier_decomposed_acoustic_fsi.cc:67</a></div></div>
<div class="ttc" id="anamespaceGlobal__Parameters_html_a91314f7f1cc80c43543948568f50f405"><div class="ttname"><a href="namespaceGlobal__Parameters.html#a91314f7f1cc80c43543948568f50f405">Global_Parameters::Omega_sq</a></div><div class="ttdeci">std::complex&lt; double &gt; Omega_sq(std::complex&lt; double &gt;(100.0, 0.0))</div><div class="ttdoc">Non-dim square of frequency for solid – dependent variable!</div></div>
<div class="ttc" id="anamespaceGlobal__Parameters_html_a91a3fa265abaf9e724c668ee800ffb29"><div class="ttname"><a href="namespaceGlobal__Parameters.html#a91a3fa265abaf9e724c668ee800ffb29">Global_Parameters::K_squared</a></div><div class="ttdeci">double K_squared</div><div class="ttdoc">Square of wavenumber for the Helmholtz equation.</div><div class="ttdef"><b>Definition:</b> <a href="fourier__decomposed__acoustic__fsi_8cc_source.html#l00064">fourier_decomposed_acoustic_fsi.cc:64</a></div></div>
<div class="ttc" id="anamespaceGlobal__Parameters_html_aa961bcca2115ce9cb37cc8ccb1b90cae"><div class="ttname"><a href="namespaceGlobal__Parameters.html#aa961bcca2115ce9cb37cc8ccb1b90cae">Global_Parameters::E</a></div><div class="ttdeci">Vector&lt; std::complex&lt; double &gt; &gt; E(2, std::complex&lt; double &gt;(1.0, 0.0))</div><div class="ttdoc">Define the non-dimensional Young's modulus.</div></div>
<div class="ttc" id="anamespaceGlobal__Parameters_html_ae0f9a80fb7510dbfbbef22582da231b7"><div class="ttname"><a href="namespaceGlobal__Parameters.html#ae0f9a80fb7510dbfbbef22582da231b7">Global_Parameters::update_parameter_values</a></div><div class="ttdeci">void update_parameter_values()</div><div class="ttdoc">Function to update dependent parameter values.</div><div class="ttdef"><b>Definition:</b> <a href="fourier__decomposed__acoustic__fsi_8cc_source.html#l00088">fourier_decomposed_acoustic_fsi.cc:88</a></div></div>
<div class="ttc" id="anamespaceGlobal__Parameters_html_ae1198385d90f52c4ed921520ae43a9e7"><div class="ttname"><a href="namespaceGlobal__Parameters.html#ae1198385d90f52c4ed921520ae43a9e7">Global_Parameters::Fourier_wavenumber</a></div><div class="ttdeci">int Fourier_wavenumber</div><div class="ttdoc">Define azimuthal Fourier wavenumber.</div><div class="ttdef"><b>Definition:</b> <a href="fourier__decomposed__acoustic__fsi_8cc_source.html#l00076">fourier_decomposed_acoustic_fsi.cc:76</a></div></div>
<div class="ttc" id="anamespaceGlobal__Parameters_html_ae3cf8878ede839bffda01f79bbe3e819"><div class="ttname"><a href="namespaceGlobal__Parameters.html#ae3cf8878ede839bffda01f79bbe3e819">Global_Parameters::H_coating</a></div><div class="ttdeci">double H_coating</div><div class="ttdoc">Non-dim thickness of elastic coating.</div><div class="ttdef"><b>Definition:</b> <a href="fourier__decomposed__acoustic__fsi_8cc_source.html#l00073">fourier_decomposed_acoustic_fsi.cc:73</a></div></div>
<div class="ttc" id="anamespaceGlobal__Parameters_html_afbe27ad463a1fb23cb99d029a9fac731"><div class="ttname"><a href="namespaceGlobal__Parameters.html#afbe27ad463a1fb23cb99d029a9fac731">Global_Parameters::Alpha</a></div><div class="ttdeci">double Alpha</div><div class="ttdoc">Peakiness parameter for pressure load.</div><div class="ttdef"><b>Definition:</b> <a href="unstructured__fourier__decomposed__acoustic__fsi_8cc_source.html#l00152">unstructured_fourier_decomposed_acoustic_fsi.cc:152</a></div></div>
</div><!-- fragment --><hr  />
 <hr  />
<h1><a class="anchor" id="sources"></a>
Source files for this tutorial</h1>
<ul>
<li>The source files for this tutorial are located in the directory:<br  />
<br  />
 <center> <a href="../../../../demo_drivers/interaction/fourier_decomposed_acoustic_fsi">demo_drivers/interaction/fourier_decomposed_acoustic_fsi/ </a> </center><br  />
</li>
<li>The driver code is: <br  />
<br  />
 <center> <a href="../../../../demo_drivers/interaction/fourier_decomposed_acoustic_fsi/unstructured_fourier_decomposed_acoustic_fsi.cc">demo_drivers/interaction/fourier_decomposed_acoustic_fsi/unstructured_fourier_decomposed_acoustic_fsi.cc </a> </center></li>
</ul>
<hr  />
 <hr  />
 <h1><a class="anchor" id="pdf"></a>
PDF file</h1>
<p>A <a href="../latex/refman.pdf">pdf version</a> of this document is available. </p>
</div></div><!-- PageDoc -->
</div><!-- contents -->

    <!-- jQuery for Bootstrap and Doxygen -->
    <script src="../../../js/jquery-1.12.0.min.js"></script>
    <!-- Minified boostrap plugins-->
    <script src="../../../js/bootstrap.js"></script>
    <!-- Doxygen dependency to add powertips to source code-->
    <script src="../../../js/jquery.powertip.min.js"></script>
    <!-- The  following script is generated by doxygen and hides/shows levels in 
         the data structure lists and adds powertips to source code-->
    <script src="../../../js/dynsections.js" ></script>
    <!-- add to Doxygen's class names so bootstrap css and js recognises them-->
    <script type="text/javascript">
    $(".contents").addClass("container");
    $(".header").addClass("container");
    $(".navpath").addClass("container");
    $("#navrow3").addClass("container");
    $("#navrow4").addClass("container");
    $(".mlabel").addClass("label");
    $(".mlabel").addClass("label-default");
    $(".memitem").addClass("panel");
    $(".memitem").addClass("panel-info");
    $(".memproto").addClass("panel-heading");
    $(".memdoc").addClass("panel-body");
    </script>
    <footer>
      <div class="container">
        <div class="text-muted" style="float:right;">Generated by <a href="http://www.doxygen.org/index.html">
          <img style="height:18px;" class="footer-img" src="doxygen.png" alt="doxygen"></a> on Thu Dec 19 2024 11:44:51
        </div>
      </div>
    </footer>
</body>
</html>

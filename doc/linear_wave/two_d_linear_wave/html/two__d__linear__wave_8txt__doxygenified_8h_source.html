<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
<title>oomph-lib: two_d_linear_wave.txt_doxygenified.h Source File</title>
<link rel="apple-touch-icon" sizes="57x57" href="../../../figures/apple-touch-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="../../../figures/apple-touch-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="../../../figures/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="../../../figures/apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="../../../figures/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="../../../figures/apple-touch-icon-120x120.png">
<link rel="icon" type="image/png" href="../../../figures/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="../../../figures/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="../../../figures/favicon-16x16.png" sizes="16x16">
<link rel="manifest" href="../../../figures/manifest.json">
<link rel="mask-icon" href="../../../figures/safari-pinned-tab.svg" color="#008000">
<link rel="shortcut icon" href="../../../figures/favicon.ico">
<meta name="msapplication-TileColor" content="#00a300">
<meta name="msapplication-config" content="../../../figures/browserconfig.xml">
<meta name="theme-color" content="#008000">
<link href="http://fonts.googleapis.com/css?family=Open+Sans:400,300,600" rel="stylesheet" type="text/css">
<!-- Doxygen css-->
<!-- <link rel="stylesheet" type="text/css" href="doxygen.css"> -->
<!-- Bootstrap -->
<link href="../../../css/bootstrap.css" rel="stylesheet">
<!-- oomph-lib specific overrides -->
<link rel="stylesheet" type="text/css" href="../../../css/oomph_header.css">
</head>
<body>
<nav class="navbar navbar-default">
<div class="container">
<div class="container-fluid">
  <!-- Brand and toggle get grouped for better mobile display -->
  <div class="navbar-header">
    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
      <span class="sr-only">Toggle navigation</span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="../../../html/index.html"><img alt="oomph-lib" src="../../../figures/oomph_logo.png"></a>
  </div>
  <!-- Collect the nav links, forms, and other content for toggling -->
  <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
    <ul class="nav navbar-nav">          
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Documentation <span class="caret"></span></a>
        <ul class="dropdown-menu">
          <li class="dropdown-header">Big picture</li>
          <li><a href="../../../../doc/intro/html/index.html">The finite element method</a></li>
          <li><a href="../../../../doc/the_data_structure/html/index.html">The data structure</a></li>
          <li><a href="../../../../doc/quick_guide/html/index.html">Not-so-quick guide</a></li>
          <li><a href="../../../../doc/optimisation/html/index.html">Optimisation</a></li>
          <li><a href="../../../../doc/order_of_action_functions/html/index.html">Order of action functions</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Example codes and tutorials</li>
          <li><a href="../../../../doc/example_code_list/html/index.html">List of example codes and tutorials</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#meshes">Meshing</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#solvers">Solvers</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#parallel">MPI parallel processing</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#visualisation">Post-processing/visualisation</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Other</li>
          <li><a href="../../../../doc/change_log/html/index.html">Change log</a></li>
          <li><a href="../../../../doc/creating_doc/html/index.html">Creating documentation</a></li>
          <li><a href="../../../../doc/coding_conventions/html/index.html">Coding conventions</a></li>
          <li><a href="../../../../doc/index/html/index.html">Index</a></li>
          <li><a href="../../../../doc/FAQ/html/index.html">FAQ</a></li>
        </ul>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Get it <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../../doc/the_distribution/html/index.html">Installation guide</a></li>
            <li><a href="../../../../doc/subversion/html/index.html">Get code from subversion repository</a></li>
            <li><a href="../../../../doc/download/html/index.html">Get code as tar file</a></li>
            <li><a href="../../../../doc/copyright/html/index.html">Copyright</a></li>
          </ul>
        </li>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">About <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../../doc/people/html/index.html">People</a></li>            
            <li><a href="../../../../doc/contact/html/index.html">Contact/Get involved</a></li>
            <li><a href="../../../../doc/publications/html/index.html">Publications</a></li>
            <li><a href="../../../../doc/acknowledgements/html/index.html">Acknowledgements</a></li>
            <li><a href="../../../../doc/picture_show/index.html">Picture show</a></li>
          </ul>
        </li>
      </li>
    </ul>
    <ul class="nav navbar-nav navbar-right navbar-search">
      <form class="navbar-form" role="search" action="../../../../doc/search_results/html/index.html">
        <div class="input-group">
          <input type="text" class="form-control" placeholder="Search" name="q">
          <span class="input-group-btn">
            <button class="btn btn-default" type="submit">Go</button>
          </span>
        </div><!-- /input-group -->
       <!--<div class="form-group">
          <input type="text" class="form-control" placeholder="Search">
        </div>
        <button type="submit" class="btn btn-default">Submit</button>-->
      </form>
    </ul>
  </div><!-- /.navbar-collapse -->
</div><!-- /.container-fluid -->
</div>
</nav>
<!-- Generated by Doxygen 1.8.17 -->
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">two_d_linear_wave.txt_doxygenified.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="two__d__linear__wave_8txt__doxygenified_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">\mainpage Demo problem: Solution of the 2D linear wave equation</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">In this example we demonstrate the solution of the 2D linear</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">wave equation -- a hyperbolic PDE that involves second time-derivatives.</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">Timestepping of such problems may be performed with timesteppers</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">from the \c Newmark family. We demonstrate their use and </span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">illustrate how to assign the initial conditions. </span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">\section example_problem The example problem</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">We shall illustrate the timestepping procedures for hyperbolic</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">problems by considering the solution of the 2D linear wave </span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">equation in a rectangular domain:</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">&lt;CENTER&gt;</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">&lt;TABLE&gt;</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">&lt;TR&gt;</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">&lt;TD&gt;</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">&lt;CENTER&gt;</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">&lt;B&gt;The two-dimensional linear wave equation in a rectangular domain.&lt;/B&gt;</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">&lt;/CENTER&gt; </span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">Solve</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment">\sum_{i=1}^2\frac{\partial^2 u}{\partial x_i^2}</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">= \frac{\partial^2 u}{\partial t^2} + f\left(x_1,x_2,t\right),</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment"> \ \ \ \ \ \ \ \ \ \ (1)</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment">in the rectangular domain \f$ D = </span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment">\left\{ (x_1,x_2) \ \bigg| \ x_1 \in [0,1],\ x_2 \in [0,2] \right\} \f$,</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment">subject to the Dirichlet boundary conditions</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment">\left. u\right|_{\partial D}=g_0</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment">\ \ \ \ \ \ \ \ \ \ (2)</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment">and the initial conditions</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment">u(x_1,x_2,t=0)=h_0(x_1,x_2),</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment">\ \ \ \ \ \ \ \ \ \ (3)</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment">and</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment">\left. \frac{\partial u}{\partial t}\right|_{t=0}=k_0(x_1,x_2),</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment">\ \ \ \ \ \ \ \ \ \ (4)</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment">where the functions \f$ g_0, h_0\f$ and  \f$ k_0 \f$ are given.</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment">&lt;/TD&gt;</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment">&lt;/TR&gt;</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment">&lt;/TABLE&gt;</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment">&lt;/CENTER&gt;</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment">Here we consider the unforced case, \f$ f=0 \f$, and choose boundary</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="comment">and initial conditions that are consistent with the exact, </span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment">travelling-wave solution</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment">u_0(x_1,x_2,t) = \tanh\left(1-\alpha\left(\zeta-t\right)\right),</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment"> \ \ \ \ \ \ \ \ \ \ (5)</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment">where </span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment">\zeta=\cos\left(\phi\right)x_1+\sin\left(\phi\right)x_2,</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment"> \ \ \ \ \ \ \ \ \ \ (6)</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment">is the travelling-wave coordinate. The solution represents a tanh</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="comment">step profile that propagates with unit speed through the domain.</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="comment">The parameter \f$ \alpha \f$ controls the steepness of the</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="comment">step while \f$ \phi \f$ controls the orientation of the step in</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="comment">the \f$ (x_1,x_2) \f$ - plane.</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="comment">The figure below shows a plot of computed and exact solutions at</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="comment">time \f$ t = 0.25 \f$, for a steepness parameter \f$ \alpha=4 \f$, </span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="comment">and an angle \f$ \phi=\pi/6 \f$ . The plot is a snapshot,</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="comment">taken from the &lt;A HREF=&quot;../figures/wave_sol.avi&quot;&gt; animation of the</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="comment">solution&lt;/A&gt;.</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="comment">\image html wave_sol.gif &quot;Snapshot of the exact and computed solutions. &quot; </span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="comment">\image latex wave_sol.eps &quot;Snapshot of the exact and computed solutions. &quot; width=0.75\textwidth</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="comment">\section namespace Global parameters and functions</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="comment">As usual, we store the problem parameters in a namespace. Note that</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="comment">we define not only the exact solution but also its first and second</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="comment">time-derivatives, as both are needed to assign the initial conditions</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="comment">for the Newmark timestepper; see \ref IC for details. </span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="comment">\dontinclude two_d_linear_wave.cc</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="comment">\skipline start_of_tanh_solution</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment">\until end of tanh solution</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="comment">\section main The driver code</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="comment">As in most previous time-dependent example codes, we use the</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="comment">command line arguments as flags that indicate if the code is</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="comment">run in validation mode -- if command line arguments are specified,</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="comment">the code will only perform a small number of timesteps. </span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="comment">\skipline start_of_main</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="comment">\until CommandLineArgs::</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="comment">We build the problem with 2D bi-quadratic \c QLinearWaveElements</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="comment">and a  \c Newmark&lt;1&gt; timestepper (see \ref IC for an explanation of the</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="comment">template argument), passing the number of elements, and the pointer</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="comment">to the source function to the constructor, and run the time </span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="comment">time-dependent simulation. We solve the problem twice, once</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="comment">with an impulsive start and once a with &quot;smooth&quot; start from the </span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="comment">travelling-wave solution (5).</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="comment">\until end of main</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="comment">\section problem The problem class </span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="comment">The problem class is practically identical to that used for</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="comment">&lt;A HREF=&quot;../../../unsteady_heat/two_d_unsteady_heat/html/index.html&quot;&gt;</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="comment">the corresponding unsteady heat problem&lt;/A&gt;. No actions are required</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="comment">before or after the solve but the time-dependent boundary conditions</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="comment">must be updated before every timestep.</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="comment">\dontinclude two_d_linear_wave.cc</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="comment">\skipline start_of_problem_class</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="comment">\until end of problem class</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="comment">\section constructor The problem constructor</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="comment">The problem constructor is also fairly standard: We start by creating</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="comment">the timestepper (of the type specified by the template argument), </span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="comment">pass it to the Problem&#39;s collection of timesteppers, and</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="comment">initialise the parameters for the exact solution.</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="comment">\skipline start_of_constructor</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="comment">\until TanhSolnForLinearWave::Phi</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="comment">Next, we build the mesh and pin the nodal values on the Dirichlet</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="comment">boundaries (i.e. at all boundary nodes). </span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="comment">&lt;A HREF=&quot;../../../unsteady_heat/two_d_unsteady_heat/html/index.html&quot;&gt;</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="comment">Recall&lt;/A&gt; that the pointer to the timestepper must be </span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="comment">passed the mesh constructor to allow the creation of \c Nodes that </span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="comment">provide sufficient storage for the &quot;history values&quot; </span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="comment">required by the timestepper. </span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="comment">\until  //end of boundary conditions </span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="comment">Finally, we complete the </span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="comment">build of the elements by passing the pointer to the source</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="comment">function to the elements, and </span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="comment">set up the equation numbering scheme.</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="comment">\until end of constructor</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="comment">\section IC Setting the initial conditions for Newmark timesteppers</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="comment">Most of the code discussed so far was (and most of what follows is)</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="comment">practically identical to that in </span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="comment">&lt;A HREF=&quot;../../../unsteady_heat/two_d_unsteady_heat/html/index.html&quot;&gt; </span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="comment">the corresponding unsteady heat example&lt;/A&gt;. The main difference</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="comment">between the two example codes is the way in which the initial conditions</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="comment">are applied. This is closely related to the different role of the</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="comment">&quot;history values&quot; in \c BDF and \c Newmark timestepping schemes:</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="comment">\subsection BDFvsNewmark The interpretation of history values in BDF and Newmark timesteppers</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="comment">In problems in which first time-derivatives are </span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="comment">discretised by \c BDF timesteppers, the &quot;history values&quot; represent the </span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="comment">values of the solution at previous timesteps, i.e. </span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="comment">for a \c Data object that is associated with a timestepper from the</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;<span class="comment">\c BDF family, \c Data::value(t,i) returns the i-th value stored</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="comment">in the \c Data object, at the t-th previous timestep. We recall that</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<span class="comment">when assigning</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<span class="comment">initial conditions  for computations with higher-order timesteppers </span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<span class="comment">from the \c BDF family, the number of (mathematical) initial conditions </span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="comment">(the solution at the intial time, \f$ t=t_0 \f$ , say) </span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="comment">is \e smaller than the number of &quot;history values&quot; required by the</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="comment">timestepper. For instance, a computation with a \c BDF&lt;2&gt; timestepper and</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="comment">a timestep \c dt not only requires  the solution at \f$ t=t_0</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="comment">\f$ but also the solution at \f$ t=t_0- {\tt dt} \f$ . </span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="comment">In most of our examples, this did not cause any problems. We </span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="comment">either started the simulation with an &quot;impulsive start&quot; by setting </span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="comment">\e all history values to the solution at \f$ t=t_0 \f$ , or we assigned </span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="comment">the history values from an explicitly-given function (usually </span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="comment">an exact solution of the governing equations), in which case </span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="comment">the evaluation of the history values at previous timesteps was trivial. </span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="comment">Timesteppers from the \c Newmark family compute second-order accurate</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="comment">approximations for the first and second time-derivatives of </span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="comment">the values stored in an associated \c Data object. \c Newmark timesteppers are</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="comment">implicit, single-step schemes since the approximation of the time-derivatives</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="comment">only involves quantities evaluated at the current time (where the solution is</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="comment">unknown) and at a single previous timestep. To facilitate their </span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="comment">application in multiphysics problems where parts of a \c Problem </span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="comment">might be discretised by  timesteppers from the \c BDF family, say, </span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="comment">\c Newmark timesteppers can allocate additional storage for the solution at </span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="comment">the previous \c NSTEPS timesteps. These history values are </span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="comment">stored in the \c Data objects and are updated by the timestepper</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="comment">when the solution is advanced to the next time level, but they </span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="comment">are not used in the computation of the time-derivatives.</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;<span class="comment">For a \c Data object that is associated with a \c Newmark&lt;NSTEPS&gt;</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="comment">timestepper, the history value obtained from \c Data::value(t,i)</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="comment">may be interpreted as follows:</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="comment">- t=0:  The i-th value at at present time, \c Time_pt-&gt;time()</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="comment">- t=1:  The i-th value at the previous timestep, \c Time_pt-&gt;time()-dt</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="comment">- ...</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="comment">- t=NSTEPS: The i-th value at the NSTEPS-th previous timestep, </span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="comment">  i.e. at \c Time_pt-&gt;time()-NSTEPS*dt if the timestep dt was</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="comment">  kept constant.</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="comment">- t=NSTEPS+1: The 1st time derivative (= &quot;the velocity&quot;) of the i-th value</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<span class="comment">  at the previous timestep, \c Time_pt-&gt;time()-dt</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;<span class="comment">- t=NSTEPS+2: The 2nd time derivative (= &quot;the acceleration&quot;) of the i-th value</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="comment">  at the previous timestep, \c Time_pt-&gt;time()-dt. </span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="comment">.</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;<span class="comment">The \c Newmark&lt;1&gt; timestepper is equivalent to the classical Newmark scheme. </span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="comment">\subsection ic_for_newmark Assigning the history values for Newmark timesteppers</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;<span class="comment">The \c Newmark timestepper provides a number of helper functions that</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="comment">facilitate the assignment of &quot;history values&quot;. </span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="comment">-# &lt;B&gt;Impulsive starts: &lt;/B&gt; \n\n </span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;<span class="comment">   Given a pointer, \c data_pt, to a \c Data object, the function</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="comment">   \c Newmark&lt;NSTEPS&gt;::assign_initial_values_impulsive(data_pt)</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="comment">   assigns history values that are consistent with an impulsive start</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="comment">   from the \c Data object&#39;s current values.</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="comment">-# &lt;B&gt;&quot;Smooth&quot; starts from explicitly given time-histories: &lt;/B&gt; \n\n </span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="comment">   If the solution \f$ u \f$ and its first \e and second time-derivatives </span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;<span class="comment">   are available analytically for \f$ t \le t_0\f$, the</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;<span class="comment">   function \c Newmark&lt;NSTEPS&gt;::assign_initial_data_values(...)</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;<span class="comment">   may be used to assign history values that are consistent     </span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;<span class="comment">   with this time history. Note that, as in the case of the </span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;<span class="comment">   higher-order \c BDF timesteppers, we require more information</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;<span class="comment">   than is provided by the (mathematical) initial conditions</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;<span class="comment">   which only provide the value and the first time-derivative</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;<span class="comment">   of the unknown function at the initial time. </span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;<span class="comment">.</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;<span class="comment">\subsection implement_ic Implementation in the demo code</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="comment">The function \c set_initial_condition() demonstrates the</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="comment">use of these functions in our example problem. The assignment </span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="comment">of the &quot;history values&quot; for </span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="comment">the nodal \c Data is handled by the timestepper, a pointer to</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="comment">which can be obtained from the \c Problem:</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="comment">\skipline start_of_set_initial_condition</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="comment">\until dynamic_cast</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="comment">To start the simulation with an impulsive start from the</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;<span class="comment">travelling-wave solution, defined in the namespace \c TanhSolnForLinearWave, </span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;<span class="comment">we loop over all nodes and determine their positions. We then</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;<span class="comment">compute the value of the exact solution at that point and</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;<span class="comment">assign it to the current nodal value. &quot;History values&quot; that correspond </span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;<span class="comment">to an impulsive start from this value are then assigned by </span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;<span class="comment">calling \c Newmark&lt;NSTEPS&gt;::assign_initial_values_impulsive(...).</span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;<span class="comment">\until end impulsive start</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;<span class="comment">To start the simulation with a &quot;smooth&quot; start from the travelling-wave</span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;<span class="comment">solution we have to pass function pointers to the functions that </span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<span class="comment">specify the function and its first and second time-derivatives to </span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;<span class="comment">\c Newmark&lt;NSTEPS&gt;::assign_initial_data_values(...). As usual, </span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;<span class="comment">the required form of the function pointer is defined as a public</span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;<span class="comment">\c typedef in the Newmark class. Since \c Data objects can </span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;<span class="comment">store multiple values, each of which will generally have a</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;<span class="comment">different time-history, \c Newmark&lt;NSTEPS&gt;::assign_initial_data_values(...)</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;<span class="comment">expects a vector of function pointers. In the current example </span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;<span class="comment">where each node only stores a single value, these vectors only have </span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;<span class="comment">a single entry.</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;<span class="comment">\until initial_accel_fct[0]=&amp;TanhSolnForLinearWave::exact_d2udt2;</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<span class="comment">Now we loop over all nodes and pass the vectors of function pointers  </span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<span class="comment">to \c Newmark&lt;NSTEPS&gt;::assign_initial_data_values(...) to assign the</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;<span class="comment">required history values.</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="comment">\until end of smooth start</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;<span class="comment">To check/demonstrate that the assignment of the initial condition</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="comment">was successful, we compare the Newmark approximation for the</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;<span class="comment">zero-th, first and second time-derivatives of the nodal values</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="comment">against the exact solution and document the maximum discrepancy. </span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;<span class="comment">\until end of set initial condition</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;<span class="comment">\section doc Post processing</span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;<span class="comment">The post-processing routine is practically identical to that in the</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;<span class="comment">&lt;A HREF=&quot;../../../unsteady_heat/two_d_unsteady_heat/html/index.html&quot;&gt;</span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;<span class="comment">corresponding unsteady heat example&lt;/A&gt;. We output the solution,</span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<span class="comment">and compare the computed and exact solutions. </span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="comment">\until end of doc solution</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;<span class="comment">\section unsteady_run The timestepping loop</span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;<span class="comment">Timestepping the linear wave equation involves exactly the same steps as in the</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;<span class="comment">&lt;A HREF=&quot;../../../unsteady_heat/two_d_unsteady_heat/html/index.html&quot;&gt;</span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;<span class="comment">unsteady heat example:&lt;/A&gt; We start by creating a \c</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;<span class="comment">DocInfo object to specify the output directories and open </span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;<span class="comment">the trace file in which we record  the time-evolution of the error. </span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;<span class="comment">\skipline start_of_unsteady_run</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;<span class="comment">\until open(filename);</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;<span class="comment">We then initialise the time, set the initial condition and output the</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;<span class="comment">initial solution.</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;<span class="comment">\until ++;</span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="comment">Next we set up the number of timesteps to be performed. If the code is</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;<span class="comment">run in validation mode, indicated by a non-zero number of command line</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;<span class="comment">arguments, we only perform two timesteps.  </span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;<span class="comment">\until }</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;<span class="comment">Finally, we loop over the timesteps, solve the equations at each time level</span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;<span class="comment">and document the results. </span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;<span class="comment">\until end of unsteady run</span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;<span class="comment">\section comments Comments and Exercises</span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;<span class="comment">\subsection default Default parameters for the linear wave equations</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;<span class="comment">The linear wave equation does not contain any parameters, therefore</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;<span class="comment">the \c Problem constructor only passed the pointer to</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;<span class="comment">the pointer to the source function to the elements.</span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;<span class="comment">Passing the pointer to the source function is optional -- if no</span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;<span class="comment">source function pointer is specified, the linear-wave elements will</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;<span class="comment">use the default \f$ f(x_1,x_2,t)=0 \f$ , so that the unforced</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;<span class="comment">linear wave equation is solved. You should confirm</span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;<span class="comment">this by commenting out the assignment of the source function pointer</span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;<span class="comment">in the Problem constructor -- the code should (and does!) still compute the</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;<span class="comment">correct results. This is because the travelling-wave solution (5)</span></div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="comment">is in fact a solution of the \e unforced wave equation -- the source function </span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;<span class="comment">defined in the namespace \c TanhSolnForLinearWave implements</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;<span class="comment">\f$ f(x_1,x_2,t)=0 \f$ .</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;<span class="comment">\subsection imp_soln The errors induced by an impulsive start</span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;<span class="comment">-# View &lt;A HREF=&quot;../figures/impulsive_wave_solution.avi&quot;&gt;</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;<span class="comment">   the animation of the results obtained from the simulation that was</span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;<span class="comment">   started impulsively &lt;/A&gt; and explain how the</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;<span class="comment">   differences to the exact solution arise. </span></div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;<span class="comment">-# Does the error induced by the impulsive start decay with time?</span></div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;<span class="comment">   Contrast this with the behaviour in the</span></div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;<span class="comment">   &lt;A HREF=&quot;../../../unsteady_heat/two_d_unsteady_heat/html/index.html&quot;&gt;</span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;<span class="comment">   unsteady heat example. &lt;/A&gt;</span></div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;<span class="comment">.</span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;<span class="comment">\subsection flux The use of Neumann boundary conditions.</span></div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;<span class="comment">Neumann (&quot;flux&quot;) boundary conditions for the linear wave equation</span></div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;<span class="comment">can be applied by attaching elements of type </span></div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;<span class="comment">\c LinearWaveFluxElement&lt;BULK_LINEAR_WAVE_ELEMENT&gt; </span></div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;<span class="comment">to the boundary in exactly the same way as in the</span></div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;<span class="comment">&lt;A HREF=&quot;../../../poisson/two_d_poisson_flux_bc2/html/index.html&quot;&gt;</span></div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;<span class="comment">Poisson &lt;/A&gt; and </span></div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;<span class="comment">&lt;A HREF=&quot;../../../unsteady_heat/two_d_unsteady_heat_adapt/html/index.html&quot;&gt;</span></div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;<span class="comment">unsteady heat &lt;/A&gt; examples. We will therefore not discuss this</span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;<span class="comment">case in detail but simply refer to the listing of the</span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;<span class="comment">(well-documented) </span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;<span class="comment">&lt;A HREF=&quot;../../../../demo_drivers/linear_wave/two_d_linear_wave/two_d_linear_wave_flux.cc&quot;&gt;</span></div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;<span class="comment">driver code two_d_linear_wave_flux.cc&lt;/A&gt;</span></div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;<span class="comment">\section sources Source files for this tutorial</span></div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;<span class="comment">- The source files for this tutorial are located in the directory:</span></div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;<span class="comment">&lt;CENTER&gt;</span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;<span class="comment">&lt;A HREF=&quot;../../../../demo_drivers/linear_wave/two_d_linear_wave/&quot;&gt;</span></div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;<span class="comment">demo_drivers/linear_wave/two_d_linear_wave/</span></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;<span class="comment">&lt;/A&gt;</span></div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;<span class="comment">&lt;/CENTER&gt;</span></div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;<span class="comment">- The driver code is:</span></div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;<span class="comment">&lt;CENTER&gt;</span></div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;<span class="comment">&lt;A HREF=&quot;../../../../demo_drivers/linear_wave/two_d_linear_wave/two_d_linear_wave.cc&quot;&gt;</span></div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;<span class="comment">demo_drivers/linear_wave/two_d_linear_wave/two_d_linear_wave.cc</span></div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;<span class="comment">&lt;/A&gt;</span></div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;<span class="comment">&lt;/CENTER&gt;</span></div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;<span class="comment">.</span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;<span class="comment">&lt;hr&gt;</span></div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;<span class="comment">&lt;hr&gt;</span></div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;<span class="comment">\section pdf PDF file</span></div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;<span class="comment">A &lt;a href=&quot;../latex/refman.pdf&quot;&gt;pdf version&lt;/a&gt; of this document is available.</span></div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;<span class="comment">**/</span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160; </div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="atwo__d__linear__wave_8txt_html_ab4aae5f087bf5f3cd515c9ceb5e0ecfe"><div class="ttname"><a href="two__d__linear__wave_8txt.html#ab4aae5f087bf5f3cd515c9ceb5e0ecfe">timestepper</a></div><div class="ttdeci">namespace Global parameters and functions As usual we store the problem parameters in a namespace Note that we define not only the exact solution but also its first and second time derivatives as both are needed to assign the initial conditions for the Newmark timestepper</div><div class="ttdef"><b>Definition:</b> <a href="two__d__linear__wave_8txt_source.html#l00083">two_d_linear_wave.txt:83</a></div></div>
<div class="ttc" id="atwo__d__linear__wave_8txt_html_ae4ef72987dace2a540db22ace941eceb"><div class="ttname"><a href="two__d__linear__wave_8txt.html#ae4ef72987dace2a540db22ace941eceb">should</a></div><div class="ttdeci">Next we set up the number of timesteps to be performed If the code is run in validation indicated by a non zero number of command line we only perform two timesteps until we loop over the solve the equations at each time level and document the results until end of unsteady run&lt; HR &gt;&lt; HR &gt; section comments Comments and Exercises subsection default Default parameters for the linear wave equations The linear wave equation does not contain any therefore the c Problem constructor only passed the pointer to the pointer to the source function to the elements Passing the pointer to the source function is optional if no source function pointer is the linear wave elements will use the default f so that the unforced linear wave equation is solved You should confirm this by commenting out the assignment of the source function pointer in the Problem constructor the code should(and does!) still compute the correct results. This is because the travelling-wave solution(@R[ExactSoln1]@) is in fact a solution of the \e unforced wave equation -- the source function defined in the namespace \c TanhSolnForLinearWave implements \f$ f(x_1</div></div>
<div class="ttc" id="atwo__d__linear__wave_8txt_html_a296a3e5bfecd9974037e2ffba9127af2"><div class="ttname"><a href="two__d__linear__wave_8txt.html#a296a3e5bfecd9974037e2ffba9127af2">elements</a></div><div class="ttdeci">see ref IC for details dontinclude two_d_linear_wave cc skipline start_of_tanh_solution until end of tanh solution&lt; HR &gt;&lt; HR &gt; section main The driver code As in most previous time dependent example we use the command line arguments as flags that indicate if the code is run in validation mode if command line arguments are the code will only perform a small number of timesteps skipline start_of_main until CommandLineArgs::We build the problem with bi quadratic c QLinearWaveElements and a c Newmark&lt; 1 &gt; passing the number of elements</div><div class="ttdef"><b>Definition:</b> <a href="two__d__linear__wave_8txt_source.html#l00109">two_d_linear_wave.txt:109</a></div></div>
<div class="ttc" id="atwo__d__linear__wave_8txt_html_a41ba270ba090bb0d052ec204a24c2b15"><div class="ttname"><a href="two__d__linear__wave_8txt.html#a41ba270ba090bb0d052ec204a24c2b15">x_2</a></div><div class="ttdeci">mainpage Demo x_2</div><div class="ttdef"><b>Definition:</b> <a href="two__d__linear__wave_8txt_source.html#l00028">two_d_linear_wave.txt:28</a></div></div>
<div class="ttc" id="atwo__d__linear__wave_8txt_html_a6e4b88fbcede57d0a17d67b61f4fad11"><div class="ttname"><a href="two__d__linear__wave_8txt.html#a6e4b88fbcede57d0a17d67b61f4fad11">twice</a></div><div class="ttdeci">see ref IC for details dontinclude two_d_linear_wave cc skipline start_of_tanh_solution until end of tanh solution&lt; HR &gt;&lt; HR &gt; section main The driver code As in most previous time dependent example we use the command line arguments as flags that indicate if the code is run in validation mode if command line arguments are the code will only perform a small number of timesteps skipline start_of_main until CommandLineArgs::We build the problem with bi quadratic c QLinearWaveElements and a c Newmark&lt; 1 &gt; passing the number of and the pointer to the source function to the and run the time time dependent simulation We solve the problem twice</div><div class="ttdef"><b>Definition:</b> <a href="two__d__linear__wave_8txt_source.html#l00111">two_d_linear_wave.txt:111</a></div></div>
<div class="ttc" id="atwo__d__linear__wave_8txt_html_a8deb2937f52462562f803525a7229e58"><div class="ttname"><a href="two__d__linear__wave_8txt.html#a8deb2937f52462562f803525a7229e58">right</a></div><div class="ttdeci">mainpage Demo t right</div><div class="ttdef"><b>Definition:</b> <a href="two__d__linear__wave_8txt_source.html#l00028">two_d_linear_wave.txt:28</a></div></div>
<div class="ttc" id="atwo__d__linear__wave_8txt_html_a18d969b7f251363aed27bd9acbfc5096"><div class="ttname"><a href="two__d__linear__wave_8txt.html#a18d969b7f251363aed27bd9acbfc5096">specified</a></div><div class="ttdeci">see ref IC for details dontinclude two_d_linear_wave cc skipline start_of_tanh_solution until end of tanh solution&lt; HR &gt;&lt; HR &gt; section main The driver code As in most previous time dependent example we use the command line arguments as flags that indicate if the code is run in validation mode if command line arguments are specified</div><div class="ttdef"><b>Definition:</b> <a href="two__d__linear__wave_8txt_source.html#l00101">two_d_linear_wave.txt:101</a></div></div>
<div class="ttc" id="anamespaceTanhSolnForLinearWave_html_a63b7a0f5fd5d06cc2c0a43322a81fe43"><div class="ttname"><a href="namespaceTanhSolnForLinearWave.html#a63b7a0f5fd5d06cc2c0a43322a81fe43">TanhSolnForLinearWave::exact_d2udt2</a></div><div class="ttdeci">double exact_d2udt2(const double &amp;time, const Vector&lt; double &gt; &amp;x)</div><div class="ttdoc">2nd time-deriv of exact solution</div><div class="ttdef"><b>Definition:</b> <a href="two__d__linear__wave_8cc_source.html#l00073">two_d_linear_wave.cc:73</a></div></div>
<div class="ttc" id="atwo__d__linear__wave_8txt_html_a3014b0eaf478b612fa68a36e3137f97f"><div class="ttname"><a href="two__d__linear__wave_8txt.html#a3014b0eaf478b612fa68a36e3137f97f">until</a></div><div class="ttdeci">We then initialise the set the initial condition and output the initial solution until</div><div class="ttdef"><b>Definition:</b> <a href="two__d__linear__wave_8txt_source.html#l00329">two_d_linear_wave.txt:329</a></div></div>
<div class="ttc" id="atwo__d__linear__wave_8txt_html_a35f35c6757e7f45a1d0acf59649a63c3"><div class="ttname"><a href="two__d__linear__wave_8txt.html#a35f35c6757e7f45a1d0acf59649a63c3">g_0</a></div><div class="ttdeci">mainpage Demo t E[2DLinearWave] f in the rectangular domain f subject to the Dirichlet boundary conditions f[\left. u\right|_{\partial D}=g_0\ \ \ \ \ \ \ \ \ \ @E[2DLinearWave_BC1]@\f] and the initial conditions f[u(x_1, x_2, t=0)=h_0(x_1, x_2),\ \ \ \ \ \ \ \ \ \ @E[2DLinearWave_IC1]@\f] and f[\left. \frac{\partial u}{\partial t}\right|_{t=0}=k_0(x_1, x_2),\ \ \ \ \ \ \ \ \ \ @E[2DLinearWave_IC2]@\f] where the functions f g_0</div><div class="ttdef"><b>Definition:</b> <a href="two__d__linear__wave_8txt_source.html#l00048">two_d_linear_wave.txt:48</a></div></div>
<div class="ttc" id="atwo__d__linear__wave_8txt_html_a46197e9c78fac9bb1c50967be725ba6c"><div class="ttname"><a href="two__d__linear__wave_8txt.html#a46197e9c78fac9bb1c50967be725ba6c">case</a></div><div class="ttdeci">mainpage Demo t E[2DLinearWave] f in the rectangular domain f subject to the Dirichlet boundary conditions f[\left. u\right|_{\partial D}=g_0\ \ \ \ \ \ \ \ \ \ @E[2DLinearWave_BC1]@\f] and the initial conditions f[u(x_1, x_2, t=0)=h_0(x_1, x_2),\ \ \ \ \ \ \ \ \ \ @E[2DLinearWave_IC1]@\f] and f[\left. \frac{\partial u}{\partial t}\right|_{t=0}=k_0(x_1, x_2),\ \ \ \ \ \ \ \ \ \ @E[2DLinearWave_IC2]@\f] where the functions f h_0 f and f k_0 f are given&lt;/TD &gt;&lt;/TR &gt;&lt;/TABLE &gt;&lt;/CENTER &gt; Here we consider the unforced case</div><div class="ttdef"><b>Definition:</b> <a href="two__d__linear__wave_8txt_source.html#l00054">two_d_linear_wave.txt:54</a></div></div>
<div class="ttc" id="atwo__d__linear__wave_8txt_html_ac981130761cbf5d743da112c92397c93"><div class="ttname"><a href="two__d__linear__wave_8txt.html#ac981130761cbf5d743da112c92397c93">alpha</a></div><div class="ttdeci">mainpage Demo t E[2DLinearWave] f in the rectangular domain f subject to the Dirichlet boundary conditions f[\left. u\right|_{\partial D}=g_0\ \ \ \ \ \ \ \ \ \ @E[2DLinearWave_BC1]@\f] and the initial conditions f[u(x_1, x_2, t=0)=h_0(x_1, x_2),\ \ \ \ \ \ \ \ \ \ @E[2DLinearWave_IC1]@\f] and f[\left. \frac{\partial u}{\partial t}\right|_{t=0}=k_0(x_1, x_2),\ \ \ \ \ \ \ \ \ \ @E[2DLinearWave_IC2]@\f] where the functions f h_0 f and f k_0 f are given&lt;/TD &gt;&lt;/TR &gt;&lt;/TABLE &gt;&lt;/CENTER &gt; Here we consider the unforced f and choose boundary and initial conditions that are consistent with the travelling wave solution f[u_0(x_1, x_2, t)=\tanh\left(1-\alpha\left(\zeta-t\right)\right), \ \ \ \ \ \ \ \ \ \ @E[ExactSoln1]@\f] where f[\zeta=\cos\left(\phi\right) x_1+\sin\left(\phi\right) x_2, \ \ \ \ \ \ \ \ \ \ @E[ExactSoln2]@\f] is the travelling wave coordinate The solution represents a tanh step profile that propagates with unit speed through the domain The parameter f alpha f controls the steepness of the step while f phi f controls the orientation of the step in the for a steepness parameter f alpha</div><div class="ttdef"><b>Definition:</b> <a href="two__d__linear__wave_8txt_source.html#l00073">two_d_linear_wave.txt:73</a></div></div>
<div class="ttc" id="atwo__d__linear__wave_8txt_html_a4fef684a92649cef275027a253559e38"><div class="ttname"><a href="two__d__linear__wave_8txt.html#a4fef684a92649cef275027a253559e38">exact</a></div><div class="ttdeci">mainpage Demo t E[2DLinearWave] f in the rectangular domain f subject to the Dirichlet boundary conditions f[\left. u\right|_{\partial D}=g_0\ \ \ \ \ \ \ \ \ \ @E[2DLinearWave_BC1]@\f] and the initial conditions f[u(x_1, x_2, t=0)=h_0(x_1, x_2),\ \ \ \ \ \ \ \ \ \ @E[2DLinearWave_IC1]@\f] and f[\left. \frac{\partial u}{\partial t}\right|_{t=0}=k_0(x_1, x_2),\ \ \ \ \ \ \ \ \ \ @E[2DLinearWave_IC2]@\f] where the functions f h_0 f and f k_0 f are given&lt;/TD &gt;&lt;/TR &gt;&lt;/TABLE &gt;&lt;/CENTER &gt; Here we consider the unforced f and choose boundary and initial conditions that are consistent with the exact</div><div class="ttdef"><b>Definition:</b> <a href="two__d__linear__wave_8txt_source.html#l00055">two_d_linear_wave.txt:55</a></div></div>
<div class="ttc" id="atwo__d__linear__wave_8txt_html_a06b3fc8b5665a04be2171f6436da0d46"><div class="ttname"><a href="two__d__linear__wave_8txt.html#a06b3fc8b5665a04be2171f6436da0d46">phi</a></div><div class="ttdeci">mainpage Demo t E[2DLinearWave] f in the rectangular domain f subject to the Dirichlet boundary conditions f[\left. u\right|_{\partial D}=g_0\ \ \ \ \ \ \ \ \ \ @E[2DLinearWave_BC1]@\f] and the initial conditions f[u(x_1, x_2, t=0)=h_0(x_1, x_2),\ \ \ \ \ \ \ \ \ \ @E[2DLinearWave_IC1]@\f] and f[\left. \frac{\partial u}{\partial t}\right|_{t=0}=k_0(x_1, x_2),\ \ \ \ \ \ \ \ \ \ @E[2DLinearWave_IC2]@\f] where the functions f h_0 f and f k_0 f are given&lt;/TD &gt;&lt;/TR &gt;&lt;/TABLE &gt;&lt;/CENTER &gt; Here we consider the unforced f and choose boundary and initial conditions that are consistent with the travelling wave solution f[u_0(x_1, x_2, t)=\tanh\left(1-\alpha\left(\zeta-t\right)\right), \ \ \ \ \ \ \ \ \ \ @E[ExactSoln1]@\f] where f[\zeta=\cos\left(\phi\right) x_1+\sin\left(\phi\right) x_2, \ \ \ \ \ \ \ \ \ \ @E[ExactSoln2]@\f] is the travelling wave coordinate The solution represents a tanh step profile that propagates with unit speed through the domain The parameter f alpha f controls the steepness of the step while f phi f controls the orientation of the step in the for a steepness parameter f and an angle f phi</div><div class="ttdef"><b>Definition:</b> <a href="two__d__linear__wave_8txt_source.html#l00074">two_d_linear_wave.txt:74</a></div></div>
<div class="ttc" id="atwo__d__linear__wave_8txt_html_a8557a05c60c71ca0ae7ab317655852e1"><div class="ttname"><a href="two__d__linear__wave_8txt.html#a8557a05c60c71ca0ae7ab317655852e1">time</a></div><div class="ttdeci">We then initialise the time</div><div class="ttdef"><b>Definition:</b> <a href="two__d__linear__wave_8txt_source.html#l00326">two_d_linear_wave.txt:326</a></div></div>
<div class="ttc" id="atwo__d__linear__wave_8txt_html_a4074baada03976c061d5672f4237cca5"><div class="ttname"><a href="two__d__linear__wave_8txt.html#a4074baada03976c061d5672f4237cca5">problem</a></div><div class="ttdeci">mainpage Demo problem</div><div class="ttdef"><b>Definition:</b> <a href="two__d__linear__wave_8txt_source.html#l00028">two_d_linear_wave.txt:28</a></div></div>
<div class="ttc" id="atwo__d__linear__wave_8cc_html_a0ddf1224851353fc92bfbff6f499fa97"><div class="ttname"><a href="two__d__linear__wave_8cc.html#a0ddf1224851353fc92bfbff6f499fa97">main</a></div><div class="ttdeci">int main(int argc, char *argv[])</div><div class="ttdoc">Demonstrate how to solve LinearWave problem.</div><div class="ttdef"><b>Definition:</b> <a href="two__d__linear__wave_8cc_source.html#l00553">two_d_linear_wave.cc:553</a></div></div>
<div class="ttc" id="atwo__d__linear__wave_8txt_html_ad479b7afa8ea75b489299c9af614aef6"><div class="ttname"><a href="two__d__linear__wave_8txt.html#ad479b7afa8ea75b489299c9af614aef6">f</a></div><div class="ttdeci">mainpage Demo t E[2DLinearWave] f in the rectangular domain f subject to the Dirichlet boundary conditions f[\left. u\right|_{\partial D}=g_0\ \ \ \ \ \ \ \ \ \ @E[2DLinearWave_BC1]@\f] and the initial conditions f[u(x_1, x_2, t=0)=h_0(x_1, x_2),\ \ \ \ \ \ \ \ \ \ @E[2DLinearWave_IC1]@\f] and f[\left. \frac{\partial u}{\partial t}\right|_{t=0}=k_0(x_1, x_2),\ \ \ \ \ \ \ \ \ \ @E[2DLinearWave_IC2]@\f] where the functions f h_0 f and f k_0 f are given&lt;/TD &gt;&lt;/TR &gt;&lt;/TABLE &gt;&lt;/CENTER &gt; Here we consider the unforced f f</div><div class="ttdef"><b>Definition:</b> <a href="two__d__linear__wave_8txt_source.html#l00054">two_d_linear_wave.txt:54</a></div></div>
<div class="ttc" id="anamespaceTanhSolnForLinearWave_html"><div class="ttname"><a href="namespaceTanhSolnForLinearWave.html">TanhSolnForLinearWave</a></div><div class="ttdef"><b>Definition:</b> <a href="two__d__linear__wave_8cc_source.html#l00048">two_d_linear_wave.cc:48</a></div></div>
<div class="ttc" id="atwo__d__linear__wave_8txt_html_acd145270feed575feb630ed3ff8bb9a6"><div class="ttname"><a href="two__d__linear__wave_8txt.html#acd145270feed575feb630ed3ff8bb9a6">parameters</a></div><div class="ttdeci">Next we set up the number of timesteps to be performed If the code is run in validation indicated by a non zero number of command line we only perform two timesteps until we loop over the solve the equations at each time level and document the results until end of unsteady run&lt; HR &gt;&lt; HR &gt; section comments Comments and Exercises subsection default Default parameters for the linear wave equations The linear wave equation does not contain any parameters</div><div class="ttdef"><b>Definition:</b> <a href="two__d__linear__wave_8txt_source.html#l00348">two_d_linear_wave.txt:348</a></div></div>
<div class="ttc" id="atwo__d__linear__wave_8txt_html_a7a8193c95fb3ff0e038d38a62b0f9501"><div class="ttname"><a href="two__d__linear__wave_8txt.html#a7a8193c95fb3ff0e038d38a62b0f9501">codes</a></div><div class="ttdeci">see ref IC for details dontinclude two_d_linear_wave cc skipline start_of_tanh_solution until end of tanh solution&lt; HR &gt;&lt; HR &gt; section main The driver code As in most previous time dependent example codes</div><div class="ttdef"><b>Definition:</b> <a href="two__d__linear__wave_8txt_source.html#l00099">two_d_linear_wave.txt:99</a></div></div>
<div class="ttc" id="atwo__d__linear__wave_8txt_html_ab84f269ed920e60d70fea81270c5db45"><div class="ttname"><a href="two__d__linear__wave_8txt.html#ab84f269ed920e60d70fea81270c5db45">timesteps</a></div><div class="ttdeci">Next we set up the number of timesteps to be performed If the code is run in validation indicated by a non zero number of command line we only perform two timesteps until we loop over the timesteps</div><div class="ttdef"><b>Definition:</b> <a href="two__d__linear__wave_8txt_source.html#l00337">two_d_linear_wave.txt:337</a></div></div>
<div class="ttc" id="atwo__d__linear__wave_8txt_html_a7e4636f8386fe21c19e75ec950754acc"><div class="ttname"><a href="two__d__linear__wave_8txt.html#a7e4636f8386fe21c19e75ec950754acc">Finally</a></div><div class="ttdeci">Next we set up the number of timesteps to be performed If the code is run in validation indicated by a non zero number of command line we only perform two timesteps until Finally</div><div class="ttdef"><b>Definition:</b> <a href="two__d__linear__wave_8txt_source.html#l00337">two_d_linear_wave.txt:337</a></div></div>
<div class="ttc" id="atwo__d__linear__wave_8txt_html_a2ba8bc0eeb3abe9aaa13364d68988aeb"><div class="ttname"><a href="two__d__linear__wave_8txt.html#a2ba8bc0eeb3abe9aaa13364d68988aeb">th</a></div><div class="ttdeci">Now we loop over all nodes and pass the vectors of function pointers to c we compare the Newmark approximation for the zero th</div><div class="ttdef"><b>Definition:</b> <a href="two__d__linear__wave_8txt_source.html#l00297">two_d_linear_wave.txt:297</a></div></div>
<div class="ttc" id="atwo__d__linear__wave_8txt_html_a3126063820ee559efb451c17db97c3d1"><div class="ttname"><a href="two__d__linear__wave_8txt.html#a3126063820ee559efb451c17db97c3d1">D</a></div><div class="ttdeci">mainpage Demo t E[2DLinearWave] f in the rectangular domain f D</div><div class="ttdef"><b>Definition:</b> <a href="two__d__linear__wave_8txt_source.html#l00031">two_d_linear_wave.txt:31</a></div></div>
<div class="ttc" id="atwo__d__linear__wave_8txt_html_acae6eb0f5091039e206d4582c7d6f56c"><div class="ttname"><a href="two__d__linear__wave_8txt.html#acae6eb0f5091039e206d4582c7d6f56c">arguments</a></div><div class="ttdeci">Next we set up the number of timesteps to be performed If the code is run in validation indicated by a non zero number of command line arguments</div><div class="ttdef"><b>Definition:</b> <a href="two__d__linear__wave_8txt_source.html#l00333">two_d_linear_wave.txt:333</a></div></div>
<div class="ttc" id="atwo__d__linear__wave_8txt_html_a85916c045889a1e4c2ea7c275ebca92c"><div class="ttname"><a href="two__d__linear__wave_8txt.html#a85916c045889a1e4c2ea7c275ebca92c">solution</a></div><div class="ttdeci">Now we loop over all nodes and pass the vectors of function pointers to c we compare the Newmark approximation for the zero first and second time derivatives of the nodal values against the exact solution and document the maximum discrepancy until end of set initial condition&lt; HR &gt;&lt; HR &gt; section doc Post processing The post processing routine is practically identical to that in the&lt; A HREF=&quot;../../../unsteady_heat/two_d_unsteady_heat/html/index.html&quot;&gt; corresponding unsteady heat example&lt;/A &gt; We output the solution</div><div class="ttdef"><b>Definition:</b> <a href="two__d__linear__wave_8txt_source.html#l00308">two_d_linear_wave.txt:308</a></div></div>
<div class="ttc" id="atwo__d__linear__wave_8txt_html_a707e50bc4cb6608e5a58bad8f7e94e33"><div class="ttname"><a href="two__d__linear__wave_8txt.html#a707e50bc4cb6608e5a58bad8f7e94e33">example</a></div><div class="ttdeci">Now we loop over all nodes and pass the vectors of function pointers to c we compare the Newmark approximation for the zero first and second time derivatives of the nodal values against the exact solution and document the maximum discrepancy until end of set initial condition&lt; HR &gt;&lt; HR &gt; section doc Post processing The post processing routine is practically identical to that in the&lt; A HREF=&quot;../../../unsteady_heat/two_d_unsteady_heat/html/index.html&quot;&gt; corresponding unsteady heat example&lt;/A &gt; We output the and compare the computed and exact solutions until end of doc solution&lt; HR &gt;&lt; HR &gt; section unsteady_run The timestepping loop Timestepping the linear wave equation involves exactly the same steps as in the&lt; A HREF=&quot;../../../unsteady_heat/two_d_unsteady_heat/html/index.html&quot;&gt; unsteady heat example</div><div class="ttdef"><b>Definition:</b> <a href="two__d__linear__wave_8txt_source.html#l00324">two_d_linear_wave.txt:324</a></div></div>
<div class="ttc" id="atwo__d__linear__wave_8txt_html_aeedf7b2d150c02ef9efc4231ad36f9c4"><div class="ttname"><a href="two__d__linear__wave_8txt.html#aeedf7b2d150c02ef9efc4231ad36f9c4">mode</a></div><div class="ttdeci">Next we set up the number of timesteps to be performed If the code is run in validation mode</div><div class="ttdef"><b>Definition:</b> <a href="two__d__linear__wave_8txt_source.html#l00332">two_d_linear_wave.txt:332</a></div></div>
<div class="ttc" id="atwo__d__linear__wave_8txt_html_acf05aaf041272ee50ed0dc06113f0bee"><div class="ttname"><a href="two__d__linear__wave_8txt.html#acf05aaf041272ee50ed0dc06113f0bee">constructor</a></div><div class="ttdeci">see ref IC for details dontinclude two_d_linear_wave cc skipline start_of_tanh_solution until end of tanh solution&lt; HR &gt;&lt; HR &gt; section main The driver code As in most previous time dependent example we use the command line arguments as flags that indicate if the code is run in validation mode if command line arguments are the code will only perform a small number of timesteps skipline start_of_main until CommandLineArgs::We build the problem with bi quadratic c QLinearWaveElements and a c Newmark&lt; 1 &gt; passing the number of and the pointer to the source function to the constructor</div><div class="ttdef"><b>Definition:</b> <a href="two__d__linear__wave_8txt_source.html#l00110">two_d_linear_wave.txt:110</a></div></div>

    <!-- jQuery for Bootstrap and Doxygen -->
    <script src="../../../js/jquery-1.12.0.min.js"></script>
    <!-- Minified boostrap plugins-->
    <script src="../../../js/bootstrap.js"></script>
    <!-- Doxygen dependency to add powertips to source code-->
    <script src="../../../js/jquery.powertip.min.js"></script>
    <!-- The  following script is generated by doxygen and hides/shows levels in 
         the data structure lists and adds powertips to source code-->
    <script src="../../../js/dynsections.js" ></script>
    <!-- add to Doxygen's class names so bootstrap css and js recognises them-->
    <script type="text/javascript">
    $(".contents").addClass("container");
    $(".header").addClass("container");
    $(".navpath").addClass("container");
    $("#navrow3").addClass("container");
    $("#navrow4").addClass("container");
    $(".mlabel").addClass("label");
    $(".mlabel").addClass("label-default");
    $(".memitem").addClass("panel");
    $(".memitem").addClass("panel-info");
    $(".memproto").addClass("panel-heading");
    $(".memdoc").addClass("panel-body");
    </script>
    <footer>
      <div class="container">
        <div class="text-muted" style="float:right;">Generated by <a href="http://www.doxygen.org/index.html">
          <img style="height:18px;" class="footer-img" src="doxygen.png" alt="doxygen"></a> on Thu Jul 8 2021 23:06:18
        </div>
      </div>
    </footer>
</body>
</html>

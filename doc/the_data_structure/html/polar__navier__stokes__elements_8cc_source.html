<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
<title>oomph-lib: polar_navier_stokes_elements.cc Source File</title>
<link rel="apple-touch-icon" sizes="57x57" href="../../figures/apple-touch-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="../../figures/apple-touch-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="../../figures/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="../../figures/apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="../../figures/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="../../figures/apple-touch-icon-120x120.png">
<link rel="icon" type="image/png" href="../../figures/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="../../figures/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="../../figures/favicon-16x16.png" sizes="16x16">
<link rel="manifest" href="../../figures/manifest.json">
<link rel="mask-icon" href="../../figures/safari-pinned-tab.svg" color="#008000">
<link rel="shortcut icon" href="../../figures/favicon.ico">
<meta name="msapplication-TileColor" content="#00a300">
<meta name="msapplication-config" content="../../figures/browserconfig.xml">
<meta name="theme-color" content="#008000">
<link href="http://fonts.googleapis.com/css?family=Open+Sans:400,300,600" rel="stylesheet" type="text/css">
<!-- Doxygen css-->
<!-- <link rel="stylesheet" type="text/css" href="doxygen.css"> -->
<!-- Bootstrap -->
<link href="../../css/bootstrap.css" rel="stylesheet">
<!-- oomph-lib specific overrides -->
<link rel="stylesheet" type="text/css" href="../../css/oomph_header.css">
</head>
<body>
<nav class="navbar navbar-default">
<div class="container">
<div class="container-fluid">
  <!-- Brand and toggle get grouped for better mobile display -->
  <div class="navbar-header">
    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
      <span class="sr-only">Toggle navigation</span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="../../html/index.html"><img alt="oomph-lib" src="../../figures/oomph_logo.png"></a>
  </div>
  <!-- Collect the nav links, forms, and other content for toggling -->
  <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
    <ul class="nav navbar-nav">          
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Documentation <span class="caret"></span></a>
        <ul class="dropdown-menu">
          <li class="dropdown-header">Big picture</li>
          <li><a href="../../../doc/intro/html/index.html">The finite element method</a></li>
          <li><a href="../../../doc/the_data_structure/html/index.html">The data structure</a></li>
          <li><a href="../../../doc/quick_guide/html/index.html">Not-so-quick guide</a></li>
          <li><a href="../../../doc/optimisation/html/index.html">Optimisation</a></li>
          <li><a href="../../../doc/order_of_action_functions/html/index.html">Order of action functions</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Example codes and tutorials</li>
          <li><a href="../../../doc/example_code_list/html/index.html">List of example codes and tutorials</a></li>
          <li><a href="../../../doc/example_code_list/html/index.html#meshes">Meshing</a></li>
          <li><a href="../../../doc/example_code_list/html/index.html#solvers">Solvers</a></li>
          <li><a href="../../../doc/example_code_list/html/index.html#parallel">MPI parallel processing</a></li>
          <li><a href="../../../doc/example_code_list/html/index.html#visualisation">Post-processing/visualisation</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Other</li>
          <li><a href="../../../doc/change_log/html/index.html">Change log</a></li>
          <li><a href="../../../doc/creating_doc/html/index.html">Creating documentation</a></li>
          <li><a href="../../../doc/coding_conventions/html/index.html">Coding conventions</a></li>
          <li><a href="../../../doc/index/html/index.html">Index</a></li>
          <li><a href="../../../doc/FAQ/html/index.html">FAQ</a></li>
        </ul>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Get it <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../doc/the_distribution/html/index.html">Installation guide</a></li>
            <li><a href="../../../doc/subversion/html/index.html">Get code from subversion repository</a></li>
            <li><a href="../../../doc/download/html/index.html">Get code as tar file</a></li>
            <li><a href="../../../doc/copyright/html/index.html">Copyright</a></li>
          </ul>
        </li>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">About <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../doc/people/html/index.html">People</a></li>            
            <li><a href="../../../doc/contact/html/index.html">Contact/Get involved</a></li>
            <li><a href="../../../doc/publications/html/index.html">Publications</a></li>
            <li><a href="../../../doc/acknowledgements/html/index.html">Acknowledgements</a></li>
            <li><a href="../../../doc/picture_show/index.html">Picture show</a></li>
          </ul>
        </li>
      </li>
    </ul>
    <ul class="nav navbar-nav navbar-right navbar-search">
      <form class="navbar-form" role="search" action="../../../doc/search_results/html/index.html">
        <div class="input-group">
          <input type="text" class="form-control" placeholder="Search" name="q">
          <span class="input-group-btn">
            <button class="btn btn-default" type="submit">Go</button>
          </span>
        </div><!-- /input-group -->
       <!--<div class="form-group">
          <input type="text" class="form-control" placeholder="Search">
        </div>
        <button type="submit" class="btn btn-default">Submit</button>-->
      </form>
    </ul>
  </div><!-- /.navbar-collapse -->
</div><!-- /.container-fluid -->
</div>
</nav>
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_9f82a2030dd0bd28770517af419b082d.html">polar_navier_stokes</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">polar_navier_stokes_elements.cc</div>  </div>
</div><!--header-->
<div class="contents">
<a href="polar__navier__stokes__elements_8cc.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">//LIC// ====================================================================</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">//LIC// This file forms part of oomph-lib, the object-oriented, </span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">//LIC// multi-physics finite-element library, available </span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">//LIC// at http://www.oomph-lib.org.</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">//LIC// Copyright (C) 2006-2021 Matthias Heil and Andrew Hazel</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">//LIC// This library is free software; you can redistribute it and/or</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">//LIC// modify it under the terms of the GNU Lesser General Public</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">//LIC// License as published by the Free Software Foundation; either</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">//LIC// version 2.1 of the License, or (at your option) any later version.</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">//LIC// This library is distributed in the hope that it will be useful,</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">//LIC// but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">//LIC// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">//LIC// Lesser General Public License for more details.</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">//LIC// You should have received a copy of the GNU Lesser General Public</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">//LIC// License along with this library; if not, write to the Free Software</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">//LIC// Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">//LIC// 02110-1301  USA.</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">//LIC// The authors may be contacted at oomph-lib@maths.man.ac.uk.</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">//LIC//====================================================================</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="polar__navier__stokes__elements_8h.html">polar_navier_stokes_elements.h</a>&quot;</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160; </div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespaceoomph.html">oomph</a></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;{</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment">//////////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment"></span><span class="comment">//======================================================================//</span><span class="comment"></span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment">/// Start of what would&#39;ve been navier_stokes_elements.cc               //</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment"></span><span class="comment">//======================================================================//</span><span class="comment"></span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment">//////////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment"></span><span class="comment"></span> </div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment">/// Navier--Stokes equations static data</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment"></span>Vector&lt;double&gt; <a class="code" href="classoomph_1_1PolarNavierStokesEquations.html#a3370b89e66379cb0b53417db39357e77">PolarNavierStokesEquations::Gamma</a>(2,0.0);</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160; </div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment">//=================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment">/// &quot;Magic&quot; negative number that indicates that the pressure is</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment">/// not stored at a node. This cannot be -1 because that represents</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment">/// the positional hanging scheme in the hanging_pt object of nodes</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment"></span><span class="comment">//=================================================================</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="keywordtype">int</span> <a class="code" href="classoomph_1_1PolarNavierStokesEquations.html#a8fbf3013addd48f0017c92c5be561f0a">PolarNavierStokesEquations::Pressure_not_stored_at_node</a> = -100;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment">/// Navier--Stokes equations static data</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment"></span><span class="keywordtype">double</span> <a class="code" href="classoomph_1_1PolarNavierStokesEquations.html#a21029e3ad077fda4efe1290ed17cfa97">PolarNavierStokesEquations::Default_Physical_Constant_Value</a> = 0.0;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment">/// Navier--Stokes equations static data</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment"></span><span class="keywordtype">double</span> <a class="code" href="classoomph_1_1PolarNavierStokesEquations.html#a4b8d739e7ab84c6631042bc3bd8c6d9f">PolarNavierStokesEquations::Default_Physical_Ratio_Value</a> = 1.0;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment">/// Navier-Stokes equations default gravity vector</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment"></span>Vector&lt;double&gt; <a class="code" href="classoomph_1_1PolarNavierStokesEquations.html#a8be5c9ef3e825dac154d8cf41448978d">PolarNavierStokesEquations::Default_Gravity_vector</a>(2,0.0);</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160; </div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment">//======================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="comment">/// Validate against exact velocity solution at given time.</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment">/// Solution is provided via function pointer.</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment">/// Plot at a given number of plot points and compute L2 error</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment">/// and L2 norm of velocity solution over element.</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment"></span><span class="comment">//=======================================================================</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classoomph_1_1PolarNavierStokesEquations.html#af05fc0ab81fac7f46c937220b9ca3ac0">PolarNavierStokesEquations::</a></div>
<div class="line"><a name="l00063"></a><span class="lineno"><a class="line" href="classoomph_1_1PolarNavierStokesEquations.html#af05fc0ab81fac7f46c937220b9ca3ac0">   63</a></span>&#160;<a class="code" href="classoomph_1_1PolarNavierStokesEquations.html#af05fc0ab81fac7f46c937220b9ca3ac0">compute_error</a>(std::ostream &amp;outfile,</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;              <a class="code" href="classoomph_1_1FiniteElement.html#ad4ecf2b61b158a4b4d351a60d23c633e">FiniteElement::UnsteadyExactSolutionFctPt</a> exact_soln_pt,</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;              <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; time,</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;              <span class="keywordtype">double</span>&amp; error, <span class="keywordtype">double</span>&amp; norm)</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;{</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;   error=0.0;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;   norm=0.0;</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160; </div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;   <span class="comment">//Vector of local coordinates</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;   <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>(2);</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160; </div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;   <span class="comment">// Vector for coordintes</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;   <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> x(2);</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160; </div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;   <span class="comment">//Set the value of n_intpt</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;   <span class="keywordtype">unsigned</span> n_intpt = <a class="code" href="classoomph_1_1FiniteElement.html#a79f1710873332823c47023d370f0596b">integral_pt</a>()-&gt;<a class="code" href="classoomph_1_1Integral.html#a1a270de9d99a1fcf1d25a6c1017f65fa">nweight</a>();</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;   </div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;   outfile &lt;&lt; <span class="stringliteral">&quot;ZONE&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160; </div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;   <span class="comment">// Exact solution Vector (u,v,[w],p)</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;   <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> exact_soln(2+1);</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;   </div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;   <span class="comment">//Loop over the integration points</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> ipt=0;ipt&lt;n_intpt;ipt++)</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    {</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160; </div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;     <span class="comment">//Assign values of s</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;2;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;      {</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;       <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] = <a class="code" href="classoomph_1_1FiniteElement.html#a79f1710873332823c47023d370f0596b">integral_pt</a>()-&gt;<a class="code" href="classoomph_1_1Integral.html#a1a2122f99a87c18649bafdd9ed739758">knot</a>(ipt,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>);</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;      }</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160; </div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;     <span class="comment">//Get the integral weight</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;     <span class="keywordtype">double</span> w = <a class="code" href="classoomph_1_1FiniteElement.html#a79f1710873332823c47023d370f0596b">integral_pt</a>()-&gt;<a class="code" href="classoomph_1_1Integral.html#ac65335e2aab120b285b3d6c294507b06">weight</a>(ipt);</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160; </div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;     <span class="comment">// Get jacobian of mapping</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;     <span class="keywordtype">double</span> J=<a class="code" href="classoomph_1_1FiniteElement.html#a089e58d5ad9b8efee637221b0e264563">J_eulerian</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>);</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160; </div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;     <span class="comment">//Premultiply the weights and the Jacobian</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;     <span class="keywordtype">double</span> <a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a> = w*J;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160; </div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;     <span class="comment">// Get x position as Vector</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;     <a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,x);</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160; </div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;     <span class="comment">// Get exact solution at this point</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;     (*exact_soln_pt)(time,x,exact_soln);</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160; </div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;     <span class="comment">// Velocity error</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;2;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;      {</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;       norm+=exact_soln[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]*exact_soln[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;       error+=(exact_soln[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]-<a class="code" href="classoomph_1_1PolarNavierStokesEquations.html#ac3a3e89734b01c9f117520eac5a2ace3">interpolated_u_pnst</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>))*</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;        (exact_soln[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]-<a class="code" href="classoomph_1_1PolarNavierStokesEquations.html#ac3a3e89734b01c9f117520eac5a2ace3">interpolated_u_pnst</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>))*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;      }</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160; </div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;     <span class="comment">//Output x,y,...,u_exact</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;2;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;      {</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;       outfile &lt;&lt; x[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;      }</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160; </div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;     <span class="comment">//Output x,y,[z],u_error,v_error,[w_error]</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;2;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;      {</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;       outfile &lt;&lt; exact_soln[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]-<a class="code" href="classoomph_1_1PolarNavierStokesEquations.html#ac3a3e89734b01c9f117520eac5a2ace3">interpolated_u_pnst</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>) &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;      }</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160; </div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;     outfile &lt;&lt; std::endl;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    </div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    }</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;}</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160; </div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="comment">//======================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="comment">/// Validate against exact velocity solution</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="comment">/// Solution is provided via function pointer.</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="comment">/// Plot at a given number of plot points and compute L2 error</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="comment">/// and L2 norm of velocity solution over element.</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="comment"></span><span class="comment">//=======================================================================</span></div>
<div class="line"><a name="l00141"></a><span class="lineno"><a class="line" href="classoomph_1_1PolarNavierStokesEquations.html#afcd9707018a88a40b1c8408f711b9eb6">  141</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classoomph_1_1PolarNavierStokesEquations.html#af05fc0ab81fac7f46c937220b9ca3ac0">PolarNavierStokesEquations::compute_error</a>(std::ostream &amp;outfile,</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;                                      <a class="code" href="classoomph_1_1FiniteElement.html#a690fd33af26cc3e84f39bba6d5a85202">FiniteElement::SteadyExactSolutionFctPt</a> exact_soln_pt,</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;                                      <span class="keywordtype">double</span>&amp; error, <span class="keywordtype">double</span>&amp; norm)</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;{</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160; </div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;   error=0.0;</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;   norm=0.0;</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160; </div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;   <span class="comment">//Vector of local coordinates</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;   <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>(2);</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160; </div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;   <span class="comment">// Vector for coordintes</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;   <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> x(2);</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160; </div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;   <span class="comment">//Set the value of n_intpt</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;   <span class="keywordtype">unsigned</span> n_intpt = <a class="code" href="classoomph_1_1FiniteElement.html#a79f1710873332823c47023d370f0596b">integral_pt</a>()-&gt;<a class="code" href="classoomph_1_1Integral.html#a1a270de9d99a1fcf1d25a6c1017f65fa">nweight</a>();</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;   </div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;   outfile &lt;&lt; <span class="stringliteral">&quot;ZONE&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160; </div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;   <span class="comment">// Exact solution Vector (u,v,[w],p)</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;   <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> exact_soln(2+1);</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;   </div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;   <span class="comment">//Loop over the integration points</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> ipt=0;ipt&lt;n_intpt;ipt++)</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    {</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160; </div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;     <span class="comment">//Assign values of s</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;2;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;      {</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;       <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] = <a class="code" href="classoomph_1_1FiniteElement.html#a79f1710873332823c47023d370f0596b">integral_pt</a>()-&gt;<a class="code" href="classoomph_1_1Integral.html#a1a2122f99a87c18649bafdd9ed739758">knot</a>(ipt,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>);</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;      }</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160; </div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;     <span class="comment">//Get the integral weight</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;     <span class="keywordtype">double</span> w = <a class="code" href="classoomph_1_1FiniteElement.html#a79f1710873332823c47023d370f0596b">integral_pt</a>()-&gt;<a class="code" href="classoomph_1_1Integral.html#ac65335e2aab120b285b3d6c294507b06">weight</a>(ipt);</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160; </div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;     <span class="comment">// Get jacobian of mapping</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;     <span class="keywordtype">double</span> J=<a class="code" href="classoomph_1_1FiniteElement.html#a089e58d5ad9b8efee637221b0e264563">J_eulerian</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>);</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160; </div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;     <span class="comment">//Premultiply the weights and the Jacobian</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;     <span class="keywordtype">double</span> <a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a> = w*J;</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160; </div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;     <span class="comment">// Get x position as Vector</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;     <a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,x);</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160; </div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;     <span class="comment">// Get exact solution at this point</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;     (*exact_soln_pt)(x,exact_soln);</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160; </div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;     <span class="comment">// Velocity error</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;2;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;      {</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;       norm+=exact_soln[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]*exact_soln[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;       error+=(exact_soln[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]-<a class="code" href="classoomph_1_1PolarNavierStokesEquations.html#ac3a3e89734b01c9f117520eac5a2ace3">interpolated_u_pnst</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>))*</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;        (exact_soln[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]-<a class="code" href="classoomph_1_1PolarNavierStokesEquations.html#ac3a3e89734b01c9f117520eac5a2ace3">interpolated_u_pnst</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>))*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;      }</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160; </div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;     <span class="comment">//Output x,y,...,u_exact</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;2;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;      {</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;       outfile &lt;&lt; x[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;      }</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160; </div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;     <span class="comment">//Output x,y,[z],u_error,v_error,[w_error]</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;2;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;      {</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;       outfile &lt;&lt; exact_soln[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]-<a class="code" href="classoomph_1_1PolarNavierStokesEquations.html#ac3a3e89734b01c9f117520eac5a2ace3">interpolated_u_pnst</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>) &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;      }</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160; </div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;     outfile &lt;&lt; std::endl;</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    </div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    }</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;}</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160; </div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="comment">//======================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="comment">/// Output &quot;exact&quot; solution</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="comment">/// Solution is provided via function pointer.</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;<span class="comment">/// Plot at a given number of plot points.</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="comment">/// Function prints as many components as are returned in solution Vector.</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="comment"></span><span class="comment">//=======================================================================</span></div>
<div class="line"><a name="l00219"></a><span class="lineno"><a class="line" href="classoomph_1_1PolarNavierStokesEquations.html#a72787983b9bcc07aafb46d5f7a2e592d">  219</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classoomph_1_1PolarNavierStokesEquations.html#a72787983b9bcc07aafb46d5f7a2e592d">PolarNavierStokesEquations::output_fct</a>(std::ostream &amp;outfile, </div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;                                   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;nplot, </div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;                                   <a class="code" href="classoomph_1_1FiniteElement.html#a690fd33af26cc3e84f39bba6d5a85202">FiniteElement::SteadyExactSolutionFctPt</a> exact_soln_pt)</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;{</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160; </div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160; <span class="comment">//Vector of local coordinates</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160; <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>(2);</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160; </div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160; <span class="comment">// Vector for coordintes</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160; <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> x(2);</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160; </div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160; <span class="comment">// Tecplot header info</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160; outfile &lt;&lt; <a class="code" href="classoomph_1_1FiniteElement.html#a3193df31f9ce38e0609d17a8ffb386c6">tecplot_zone_string</a>(nplot);</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160; </div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160; <span class="comment">// Exact solution Vector</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160; <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> exact_soln;</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160; </div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160; <span class="comment">// Loop over plot points</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160; <span class="keywordtype">unsigned</span> num_plot_points=<a class="code" href="classoomph_1_1FiniteElement.html#a8ed563c7ff0cfd8bafdbb0132b388106">nplot_points</a>(nplot);</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160; <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> iplot=0;iplot&lt;num_plot_points;iplot++)</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;  {</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;   </div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;   <span class="comment">// Get local coordinates of plot point</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;   <a class="code" href="classoomph_1_1FiniteElement.html#a82da844fd3ebb2005842464cdc148a03">get_s_plot</a>(iplot,nplot,<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>);</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;   </div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;   <span class="comment">// Get x position as Vector</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;   <a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,x);</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;   </div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;   <span class="comment">// Get exact solution at this point</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;   (*exact_soln_pt)(x,exact_soln);</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;   </div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;   <span class="comment">//Output x,y,...</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;2;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    {</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;     outfile &lt;&lt; x[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    }</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;   </div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;   <span class="comment">//Output &quot;exact solution&quot;</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;exact_soln.size();<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    {</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;     outfile &lt;&lt; exact_soln[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    }</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;   </div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;   outfile &lt;&lt; std::endl;</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;  }</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160; </div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="comment">// Write tecplot footer (e.g. FE connectivity lists)</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160; <a class="code" href="classoomph_1_1FiniteElement.html#ac3987a5ead7dc20c63d86b333466e2b5">write_tecplot_zone_footer</a>(outfile,nplot);</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;}</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160; </div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;<span class="comment">//======================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;<span class="comment">/// Output &quot;exact&quot; solution at a given time</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;<span class="comment">/// Solution is provided via function pointer.</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;<span class="comment">/// Plot at a given number of plot points.</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;<span class="comment">/// Function prints as many components as are returned in solution Vector.</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;<span class="comment"></span><span class="comment">//=======================================================================</span></div>
<div class="line"><a name="l00275"></a><span class="lineno"><a class="line" href="classoomph_1_1PolarNavierStokesEquations.html#a89353546dd511060090ef8f3e70e840a">  275</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classoomph_1_1PolarNavierStokesEquations.html#a72787983b9bcc07aafb46d5f7a2e592d">PolarNavierStokesEquations::output_fct</a>(std::ostream &amp;outfile,</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;                                   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;nplot, </div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;                                   <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; time,</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;                                   <a class="code" href="classoomph_1_1FiniteElement.html#ad4ecf2b61b158a4b4d351a60d23c633e">FiniteElement::UnsteadyExactSolutionFctPt</a> exact_soln_pt)</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;{</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160; </div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160; <span class="comment">//Vector of local coordinates</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160; <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>(2);</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160; </div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160; <span class="comment">// Vector for coordintes</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160; <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> x(2);</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;  </div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160; <span class="comment">// Tecplot header info</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160; outfile &lt;&lt; <a class="code" href="classoomph_1_1FiniteElement.html#a3193df31f9ce38e0609d17a8ffb386c6">tecplot_zone_string</a>(nplot);</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160; </div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160; <span class="comment">// Exact solution Vector</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160; <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> exact_soln;</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160; </div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160; <span class="comment">// Loop over plot points</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160; <span class="keywordtype">unsigned</span> num_plot_points=<a class="code" href="classoomph_1_1FiniteElement.html#a8ed563c7ff0cfd8bafdbb0132b388106">nplot_points</a>(nplot);</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160; <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> iplot=0;iplot&lt;num_plot_points;iplot++)</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;  {</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;   </div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;   <span class="comment">// Get local coordinates of plot point</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;   <a class="code" href="classoomph_1_1FiniteElement.html#a82da844fd3ebb2005842464cdc148a03">get_s_plot</a>(iplot,nplot,<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>);</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;   </div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;   <span class="comment">// Get x position as Vector</span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;   <a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,x);</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;   </div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;   <span class="comment">// Get exact solution at this point</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;   (*exact_soln_pt)(time,x,exact_soln);</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;   </div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;   <span class="comment">//Output x,y,...</span></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;2;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    {</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;     outfile &lt;&lt; x[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    }</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;   </div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;   <span class="comment">//Output &quot;exact solution&quot;</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;exact_soln.size();<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    {</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;     outfile &lt;&lt; exact_soln[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    }</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;   </div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;   outfile &lt;&lt; std::endl;</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;   </div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;  }</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160; </div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160; <span class="comment">// Write tecplot footer (e.g. FE connectivity lists)</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160; <a class="code" href="classoomph_1_1FiniteElement.html#ac3987a5ead7dc20c63d86b333466e2b5">write_tecplot_zone_footer</a>(outfile,nplot);</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160; </div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160; </div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;}</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160; </div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;<span class="comment">//==============================================================</span><span class="comment"></span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;<span class="comment">/// Output function: Velocities only  </span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;<span class="comment">/// x,y,[z],u,v,[w]</span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;<span class="comment">/// in tecplot format at specified previous timestep (t=0: present;</span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;<span class="comment">/// t&gt;0: previous timestep). Specified number of plot points in each</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="comment">/// coordinate direction.</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;<span class="comment"></span><span class="comment">//==============================================================</span></div>
<div class="line"><a name="l00336"></a><span class="lineno"><a class="line" href="classoomph_1_1PolarNavierStokesEquations.html#a960e2b96a00d4f29f91aeef9dafb1bdb">  336</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classoomph_1_1PolarNavierStokesEquations.html#a960e2b96a00d4f29f91aeef9dafb1bdb">PolarNavierStokesEquations::output_veloc</a>(std::ostream&amp; outfile, </div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;                                     <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; nplot, </div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;                                     <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; <a class="code" href="cfortran_8h.html#af6f0bd3dc13317f895c91323c25c2b8f">t</a>)</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;{</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160; </div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160; <span class="comment">//Find number of nodes</span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160; <span class="keywordtype">unsigned</span> n_node = <a class="code" href="classoomph_1_1FiniteElement.html#a6219ed269a6d89b5aa14659cce48905a">nnode</a>();</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160; </div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160; <span class="comment">//Local shape function</span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160; <a class="code" href="classoomph_1_1Shape.html">Shape</a> psi(n_node);</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160; </div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160; <span class="comment">//Vectors of local coordinates and coords and velocities</span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160; <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>(2);</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160; <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> <a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>(2);</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160; <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> <a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>(2);</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160; </div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160; <span class="comment">// Tecplot header info</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160; outfile &lt;&lt; <a class="code" href="classoomph_1_1FiniteElement.html#a3193df31f9ce38e0609d17a8ffb386c6">tecplot_zone_string</a>(nplot);</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160; </div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160; <span class="comment">// Loop over plot points</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160; <span class="keywordtype">unsigned</span> num_plot_points=<a class="code" href="classoomph_1_1FiniteElement.html#a8ed563c7ff0cfd8bafdbb0132b388106">nplot_points</a>(nplot);</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160; <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> iplot=0;iplot&lt;num_plot_points;iplot++)</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;  {</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;   </div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;   <span class="comment">// Get local coordinates of plot point</span></div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;   <a class="code" href="classoomph_1_1FiniteElement.html#a82da844fd3ebb2005842464cdc148a03">get_s_plot</a>(iplot,nplot,<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>);</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;  </div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;   <span class="comment">// Get shape functions</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;   <a class="code" href="classoomph_1_1FiniteElement.html#a58a25b6859ddd43b7bfe64a19fee5023">shape</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,psi);</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160; </div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;   <span class="comment">// Loop over directions</span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;2;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++) </div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    {</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;     <a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]=0.0;</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;     <a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]=0.0;</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;     <span class="comment">//Loop over the local nodes and sum</span></div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l=0;l&lt;n_node;l++) </div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;      {</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;       <a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] += <a class="code" href="classoomph_1_1PolarNavierStokesEquations.html#ae4bfb7b4c54bf5558111f84119f530d0">u_pnst</a>(<a class="code" href="cfortran_8h.html#af6f0bd3dc13317f895c91323c25c2b8f">t</a>,l,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>)*psi[l];</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;       <a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] += <a class="code" href="classoomph_1_1FiniteElement.html#a9152c16ae9899168bcdaac7c2f977444">nodal_position</a>(<a class="code" href="cfortran_8h.html#af6f0bd3dc13317f895c91323c25c2b8f">t</a>,l,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>)*psi[l];</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;      }</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    }</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;   </div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;   <span class="comment">// Coordinates</span></div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;2;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++) </div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    {</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;     outfile &lt;&lt; <a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    }</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;   </div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;   <span class="comment">// Velocities</span></div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;2;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++) </div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    {</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;     outfile &lt;&lt; <a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    }</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;   </div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;   outfile &lt;&lt; std::endl;   </div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;  }</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;<span class="comment">// Write tecplot footer (e.g. FE connectivity lists)</span></div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160; <a class="code" href="classoomph_1_1FiniteElement.html#ac3987a5ead7dc20c63d86b333466e2b5">write_tecplot_zone_footer</a>(outfile,nplot);</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160; </div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160; </div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;}</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160; </div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;<span class="comment">//  keyword: primary</span></div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;<span class="comment">//==============================================================</span><span class="comment"></span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;<span class="comment">/// Output function: </span></div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;<span class="comment">/// x,y,[z],u,v,[w],p</span></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;<span class="comment">/// in tecplot format. Specified number of plot points in each</span></div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;<span class="comment">/// coordinate direction.</span></div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;<span class="comment"></span><span class="comment">//==============================================================</span></div>
<div class="line"><a name="l00406"></a><span class="lineno"><a class="line" href="classoomph_1_1PolarNavierStokesEquations.html#a830bb7a0fc6532994fd1e173f7803d54">  406</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classoomph_1_1PolarNavierStokesEquations.html#a720f9b13abd3bf876793f1f9e8538f61">PolarNavierStokesEquations::output</a>(std::ostream &amp;outfile, </div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;                               <span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;nplot)</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;{</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160; </div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160; <span class="comment">//Vector of local coordinates</span></div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160; <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>(2);</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160; </div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160; <span class="comment">// Tecplot header info</span></div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160; outfile &lt;&lt; <a class="code" href="classoomph_1_1FiniteElement.html#a3193df31f9ce38e0609d17a8ffb386c6">tecplot_zone_string</a>(nplot);</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160; </div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160; <span class="comment">// Loop over plot points</span></div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160; <span class="keywordtype">unsigned</span> num_plot_points=<a class="code" href="classoomph_1_1FiniteElement.html#a8ed563c7ff0cfd8bafdbb0132b388106">nplot_points</a>(nplot);</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160; <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> iplot=0;iplot&lt;num_plot_points;iplot++)</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;  {</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;   </div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;   <span class="comment">// Get local coordinates of plot point</span></div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;   <a class="code" href="classoomph_1_1FiniteElement.html#a82da844fd3ebb2005842464cdc148a03">get_s_plot</a>(iplot,nplot,<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>);</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160; </div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;   <span class="comment">//Work out global physical coordinate</span></div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">double</span> Alpha = <a class="code" href="classoomph_1_1PolarNavierStokesEquations.html#a4bde38e6f8a429c4e3da7c3ce273045e">alpha</a>();</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;   <span class="keywordtype">double</span> r = <a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,0);</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;   <span class="keywordtype">double</span> phi = <a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,1);</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;   <span class="keywordtype">double</span> theta = Alpha*phi;</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160; </div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;   <span class="comment">// Coordinates</span></div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;   outfile &lt;&lt; r*cos(theta) &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; r*sin(theta) &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;     </div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;   <span class="comment">// Velocities</span></div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;   outfile &lt;&lt; <a class="code" href="classoomph_1_1PolarNavierStokesEquations.html#ac3a3e89734b01c9f117520eac5a2ace3">interpolated_u_pnst</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,0)*cos(theta) - <a class="code" href="classoomph_1_1PolarNavierStokesEquations.html#ac3a3e89734b01c9f117520eac5a2ace3">interpolated_u_pnst</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,1)*sin(theta) </div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;           &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;   outfile &lt;&lt; <a class="code" href="classoomph_1_1PolarNavierStokesEquations.html#ac3a3e89734b01c9f117520eac5a2ace3">interpolated_u_pnst</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,0)*sin(theta) + <a class="code" href="classoomph_1_1PolarNavierStokesEquations.html#ac3a3e89734b01c9f117520eac5a2ace3">interpolated_u_pnst</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,1)*cos(theta)</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;           &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;      </div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;   <span class="comment">// Pressure</span></div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;   outfile &lt;&lt; <a class="code" href="classoomph_1_1PolarNavierStokesEquations.html#afcc85389a45dfa0e811852012fc40442">interpolated_p_pnst</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>)  &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160; </div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;   <span class="comment">// Radial and Azimuthal velocities</span></div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;   outfile &lt;&lt; <a class="code" href="classoomph_1_1PolarNavierStokesEquations.html#ac3a3e89734b01c9f117520eac5a2ace3">interpolated_u_pnst</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,0) &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="classoomph_1_1PolarNavierStokesEquations.html#ac3a3e89734b01c9f117520eac5a2ace3">interpolated_u_pnst</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,1) &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;  </div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;   <span class="comment">//comment start here</span></div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;   <span class="comment">/*</span></div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;<span class="comment">   double similarity_solution,dsimilarity_solution;</span></div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;<span class="comment">   get_similarity_solution(theta,Alpha,similarity_solution,dsimilarity_solution);</span></div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;<span class="comment">   // Similarity solution:</span></div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;<span class="comment">   outfile &lt;&lt; similarity_solution/(Alpha*r) &lt;&lt; &quot; &quot;;  </span></div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;<span class="comment">   // Error from similarity solution:</span></div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;<span class="comment">   outfile &lt;&lt; interpolated_u_pnst(s,0) - similarity_solution/(Alpha*r) &lt;&lt; &quot; &quot;;</span></div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;<span class="comment">   */</span></div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;   <span class="comment">/*</span></div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;<span class="comment">   //Work out the Stokes flow similarity solution</span></div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;<span class="comment">   double mult = (Alpha/(sin(2.*Alpha)-2.*Alpha*cos(2.*Alpha)));</span></div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;<span class="comment">   double similarity_solution = mult*(cos(2.*Alpha*phi)-cos(2.*Alpha));</span></div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;<span class="comment">   // Similarity solution:</span></div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;<span class="comment">   outfile &lt;&lt; similarity_solution/(Alpha*r) &lt;&lt; &quot; &quot;;  </span></div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;<span class="comment">   // Error from similarity solution:</span></div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;<span class="comment">   outfile &lt;&lt; interpolated_u_pnst(s,0) - similarity_solution/(Alpha*r) &lt;&lt; &quot; &quot;;</span></div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;<span class="comment">   //comment end here</span></div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;<span class="comment">   */</span> </div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;   outfile &lt;&lt; 0 &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; 1 &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160; </div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;   <span class="comment">// r and theta for better plotting</span></div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;   outfile &lt;&lt; r &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; phi &lt;&lt; <span class="stringliteral">&quot; &quot;</span>; </div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;   </div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;   outfile &lt;&lt; std::endl;   </div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;  }</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160; outfile &lt;&lt; std::endl;</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160; </div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;}</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160; </div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;<span class="comment">//Full_convergence_checks output:</span></div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;<span class="comment">//==============================================================</span><span class="comment"></span></div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;<span class="comment">/// Output the exact similarity solution and error</span></div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;<span class="comment">/// Output function in tecplot format. </span></div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;<span class="comment">/// Specified number of plot points in each</span></div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;<span class="comment">/// coordinate direction.</span></div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;<span class="comment"></span>//==============================================================</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;void PolarNavierStokesEquations::output(std::ostream &amp;outfile, </div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;                               const unsigned &amp;nplot)</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;{</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160; </div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160; //Vector of local coordinates</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160; Vector&lt;double&gt; s(2);</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160; </div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160; // Tecplot header info</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160; outfile &lt;&lt; tecplot_zone_string(nplot);</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160; </div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160; // Loop over plot points</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160; unsigned num_plot_points=nplot_points(nplot);</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160; for (unsigned iplot=0;iplot&lt;num_plot_points;iplot++)</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;  {</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;   </div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;   // Get local coordinates of plot point</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;   get_s_plot(iplot,nplot,s);</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160; </div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;   //Work out global physical coordinate</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;   const double Alpha = alpha();</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;   double r = interpolated_x(s,0);</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;   double phi = interpolated_x(s,1);</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;   double theta = Alpha*phi;</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160; </div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;   // Coordinates</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;   outfile &lt;&lt; r*cos(theta) &lt;&lt; &quot; &quot; &lt;&lt; r*sin(theta) &lt;&lt; &quot; &quot;;</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;     </div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;   // Velocities</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;   outfile &lt;&lt; interpolated_u_pnst(s,0)*cos(theta) - interpolated_u_pnst(s,1)*sin(theta) </div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;           &lt;&lt; &quot; &quot;;</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;   outfile &lt;&lt; interpolated_u_pnst(s,0)*sin(theta) + interpolated_u_pnst(s,1)*cos(theta)</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;           &lt;&lt; &quot; &quot;;</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;      </div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;   // Pressure</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;   outfile &lt;&lt; interpolated_p_pnst(s)  &lt;&lt; &quot; &quot;;</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160; </div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;   // Radial and Azimuthal velocities</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;   outfile &lt;&lt; interpolated_u_pnst(s,0) &lt;&lt; &quot; &quot; &lt;&lt; interpolated_u_pnst(s,1) &lt;&lt; &quot; &quot;;  </div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160; </div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;   // I need to add exact pressure, radial velocity and radial velocity derivatives here</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;   // Plus the error from these</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;   double m=2.*Alpha;</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;   double mu=(1./(sin(m)-m*cos(m)));</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;   double exact_u=(mu/r)*(cos(m*phi)-cos(m));</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;   double exact_p=(2.*mu)*((cos(m*phi)/(r*r))-cos(m));</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;   double exact_dudr=-(exact_u/r);</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;   double exact_dudphi=-mu*m*sin(m*phi)/r;</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160; </div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;   // If we don&#39;t have Stokes flow then we need to overwrite the Stokes solution by </div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;   // reading in the correct similarity solution from file</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;   const double Re = re();</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;   if(Re&gt;1.e-8)</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    {</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;     double similarity_solution,dsimilarity_solution;</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;     get_similarity_solution(theta,Alpha,similarity_solution,dsimilarity_solution);</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;     double A = Global_Physical_Variables::P2/Alpha;</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160; </div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;     exact_u = similarity_solution/(r*Alpha);</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;     exact_p = 2.*(exact_u/r)-(A/(2.*Alpha*Alpha))*((1./(r*r))-1.);</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;     exact_dudr = -(exact_u/r);</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;     exact_dudphi = dsimilarity_solution/(r*Alpha);</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;    }</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160; </div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;   // exact pressure and error</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;   outfile &lt;&lt; exact_p &lt;&lt; &quot; &quot; &lt;&lt; (interpolated_p_pnst(s)-exact_p) &lt;&lt; &quot; &quot;;</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160; </div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;   // r and theta for better plotting</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;   outfile &lt;&lt; r &lt;&lt; &quot; &quot; &lt;&lt; phi &lt;&lt; &quot; &quot;; </div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160; </div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;   // exact and oomph du/dr and du/dphi?</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;   outfile &lt;&lt; exact_u &lt;&lt; &quot; &quot; &lt;&lt; (interpolated_u_pnst(s,0)-exact_u) &lt;&lt; &quot; &quot;;</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;   outfile &lt;&lt; exact_dudr &lt;&lt; &quot; &quot; &lt;&lt; (interpolated_dudx_pnst(s,0,0)-exact_dudr) &lt;&lt; &quot; &quot;;</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;   outfile &lt;&lt; exact_dudphi &lt;&lt; &quot; &quot; &lt;&lt; (interpolated_dudx_pnst(s,0,1)-exact_dudphi) &lt;&lt; &quot; &quot;;</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;   </div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;   outfile &lt;&lt; std::endl;   </div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;  }</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160; outfile &lt;&lt; std::endl;</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;}</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;*/</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;<span class="comment">//==============================================================</span><span class="comment"></span></div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;<span class="comment">/// C-style output function: </span></div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;<span class="comment">/// x,y,[z],u,v,[w],p</span></div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;<span class="comment">/// in tecplot format. Specified number of plot points in each</span></div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;<span class="comment">/// coordinate direction.</span></div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;<span class="comment"></span><span class="comment">//==============================================================</span></div>
<div class="line"><a name="l00567"></a><span class="lineno"><a class="line" href="classoomph_1_1PolarNavierStokesEquations.html#a1dd19ac88c126db21ad12bdb06a512f9">  567</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classoomph_1_1PolarNavierStokesEquations.html#a720f9b13abd3bf876793f1f9e8538f61">PolarNavierStokesEquations::output</a>(FILE* file_pt,</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;                                        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;nplot)</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;{</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160; </div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160; <span class="comment">//Vector of local coordinates</span></div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160; <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>(2);</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160; </div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160; <span class="comment">// Tecplot header info</span></div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160; <span class="comment">//outfile &lt;&lt; tecplot_zone_string(nplot);</span></div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160; fprintf(file_pt,<span class="stringliteral">&quot;%s&quot;</span>,<a class="code" href="classoomph_1_1FiniteElement.html#a3193df31f9ce38e0609d17a8ffb386c6">tecplot_zone_string</a>(nplot).c_str());</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160; </div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160; <span class="comment">// Loop over plot points</span></div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160; <span class="keywordtype">unsigned</span> num_plot_points=<a class="code" href="classoomph_1_1FiniteElement.html#a8ed563c7ff0cfd8bafdbb0132b388106">nplot_points</a>(nplot);</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160; <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> iplot=0;iplot&lt;num_plot_points;iplot++)</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;  {</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;   </div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;   <span class="comment">// Get local coordinates of plot point</span></div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;   <a class="code" href="classoomph_1_1FiniteElement.html#a82da844fd3ebb2005842464cdc148a03">get_s_plot</a>(iplot,nplot,<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>);</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;  </div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;   <span class="comment">// Coordinates</span></div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;2;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++) </div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;    {</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;     <span class="comment">//outfile &lt;&lt; interpolated_x(s,i) &lt;&lt; &quot; &quot;;</span></div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;     fprintf(file_pt,<span class="stringliteral">&quot;%g &quot;</span>,<a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>));</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;    }</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;   </div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;   <span class="comment">// Velocities</span></div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;2;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++) </div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;    {</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;     <span class="comment">//outfile &lt;&lt; interpolated_u_pnst(s,i) &lt;&lt; &quot; &quot;;</span></div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;     fprintf(file_pt,<span class="stringliteral">&quot;%g &quot;</span>,<a class="code" href="classoomph_1_1PolarNavierStokesEquations.html#ac3a3e89734b01c9f117520eac5a2ace3">interpolated_u_pnst</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>));</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;    }</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;   </div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;   <span class="comment">// Pressure</span></div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;   <span class="comment">//outfile &lt;&lt; interpolated_p_pnst(s)  &lt;&lt; &quot; &quot;;</span></div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;   fprintf(file_pt,<span class="stringliteral">&quot;%g \n&quot;</span>,<a class="code" href="classoomph_1_1PolarNavierStokesEquations.html#afcc85389a45dfa0e811852012fc40442">interpolated_p_pnst</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>));</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;  }</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160; fprintf(file_pt,<span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160; </div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;}</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160; </div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160; </div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;<span class="comment">//==============================================================</span><span class="comment"></span></div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;<span class="comment">/// Full output function: </span></div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;<span class="comment">/// x,y,[z],u,v,[w],p,du/dt,dv/dt,[dw/dt],dissipation</span></div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;<span class="comment">/// in tecplot format. Specified number of plot points in each</span></div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;<span class="comment">/// coordinate direction </span></div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;<span class="comment"></span><span class="comment">//==============================================================</span></div>
<div class="line"><a name="l00615"></a><span class="lineno"><a class="line" href="classoomph_1_1PolarNavierStokesEquations.html#a51eb6471730901fdc5cccf2edbf2c870">  615</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classoomph_1_1PolarNavierStokesEquations.html#abe241e9deab5ea6f3b4059a63c19ec3d">PolarNavierStokesEquations::full_output</a>(std::ostream &amp;outfile, </div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;                                    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;nplot)</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;{</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160; </div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160; <span class="comment">//Vector of local coordinates</span></div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160; <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>(2);</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160; </div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160; <span class="comment">// Acceleration</span></div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160; <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> dudt(2);</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160; </div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160; <span class="comment">// Mesh elocity</span></div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160; <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> mesh_veloc(2);</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160; </div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160; <span class="comment">// Tecplot header info</span></div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160; outfile &lt;&lt; <a class="code" href="classoomph_1_1FiniteElement.html#a3193df31f9ce38e0609d17a8ffb386c6">tecplot_zone_string</a>(nplot);</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;  </div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160; <span class="comment">//Find out how many nodes there are</span></div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160; <span class="keywordtype">unsigned</span> n_node = <a class="code" href="classoomph_1_1FiniteElement.html#a6219ed269a6d89b5aa14659cce48905a">nnode</a>();</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160; </div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160; <span class="comment">//Set up memory for the shape functions</span></div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160; <a class="code" href="classoomph_1_1Shape.html">Shape</a> psif(n_node);</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160; <a class="code" href="classoomph_1_1DShape.html">DShape</a> dpsifdx(n_node,2);</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160; </div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160; <span class="comment">// Loop over plot points</span></div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160; <span class="keywordtype">unsigned</span> num_plot_points=<a class="code" href="classoomph_1_1FiniteElement.html#a8ed563c7ff0cfd8bafdbb0132b388106">nplot_points</a>(nplot);</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160; <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> iplot=0;iplot&lt;num_plot_points;iplot++)</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;  {</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;   </div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;   <span class="comment">// Get local coordinates of plot point</span></div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;   <a class="code" href="classoomph_1_1FiniteElement.html#a82da844fd3ebb2005842464cdc148a03">get_s_plot</a>(iplot,nplot,<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>);</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;   </div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;   <span class="comment">//Call the derivatives of the shape and test functions</span></div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;   <a class="code" href="classoomph_1_1FiniteElement.html#a9296c17b134688049256a4bbc886df69">dshape_eulerian</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,psif,dpsifdx);</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;      </div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;   <span class="comment">//Allocate storage</span></div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;   <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> mesh_veloc(2);</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;   <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> dudt(2);</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;   <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> dudt_ALE(2);</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;   <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> interpolated_dudx(2,2);</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;   <span class="comment">//DenseDoubleMatrix interpolated_dudx(2,2);</span></div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160; </div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;   <span class="comment">//Initialise everything to zero</span></div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;2;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;    {</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;     mesh_veloc[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]=0.0;</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;     dudt[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]=0.0;</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;     dudt_ALE[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]=0.0;</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> j=0;j&lt;2;j++)</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;      {</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;       interpolated_dudx(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>,j) = 0.0;</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;      }</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;    }</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;   </div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;   <span class="comment">//Calculate velocities and derivatives</span></div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;   </div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;   <span class="comment">// Loop over nodes</span></div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l=0;l&lt;n_node;l++) </div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;    {</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;     <span class="comment">//Loop over directions</span></div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;2;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;      {</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160; </div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;       dudt[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]+=<a class="code" href="classoomph_1_1PolarNavierStokesEquations.html#ac6c31807b4f2edd3f00965b11b2a0622">du_dt_pnst</a>(l,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>)*psif[l];</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;       mesh_veloc[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]+=<a class="code" href="classoomph_1_1FiniteElement.html#adcd3fe593044db9afae4c15f85ebb175">dnodal_position_dt</a>(l,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>)*psif[l];</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160; </div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;       <span class="comment">//Loop over derivative directions for velocity gradients</span></div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;       <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> j=0;j&lt;2;j++)</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;        {                               </div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;         interpolated_dudx(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>,j) += <a class="code" href="classoomph_1_1PolarNavierStokesEquations.html#ae4bfb7b4c54bf5558111f84119f530d0">u_pnst</a>(l,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>)*dpsifdx(l,j);</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;        }</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160; </div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;      }</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;    }</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160; </div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160; </div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;   <span class="comment">// Get dudt in ALE form (incl mesh veloc)</span></div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;2;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;    {</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;     dudt_ALE[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]=dudt[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>];</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> k=0;k&lt;2;k++)</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;      {</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;       dudt_ALE[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]-=mesh_veloc[k]*interpolated_dudx(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>,k);</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;      }</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;    }</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;   </div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;  </div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;   <span class="comment">// Coordinates</span></div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;2;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++) </div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;    {</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;     outfile &lt;&lt; <a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>) &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;    }</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;   </div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;   <span class="comment">// Velocities</span></div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;2;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++) </div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;    {</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;     outfile &lt;&lt; <a class="code" href="classoomph_1_1PolarNavierStokesEquations.html#ac3a3e89734b01c9f117520eac5a2ace3">interpolated_u_pnst</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>) &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;    }</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;   </div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;   <span class="comment">// Pressure</span></div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;   outfile &lt;&lt; <a class="code" href="classoomph_1_1PolarNavierStokesEquations.html#afcc85389a45dfa0e811852012fc40442">interpolated_p_pnst</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>)  &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;   </div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;   <span class="comment">// Accelerations</span></div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;2;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++) </div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;    {</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;     outfile &lt;&lt; dudt_ALE[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;    }</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;   </div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;   <span class="comment">// Dissipation </span></div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;   outfile &lt;&lt; <a class="code" href="classoomph_1_1PolarNavierStokesEquations.html#a058dc7463bf84d85eebf98a32037adb4">dissipation</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>) &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160; </div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160; </div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;   outfile &lt;&lt; std::endl;   </div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160; </div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;  }</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;  </div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;}</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160; </div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;<span class="comment">//==============================================================</span><span class="comment"></span></div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;<span class="comment">/// Return integral of dissipation over element</span></div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;<span class="comment"></span><span class="comment">//==============================================================</span></div>
<div class="line"><a name="l00735"></a><span class="lineno"><a class="line" href="classoomph_1_1PolarNavierStokesEquations.html#a058dc7463bf84d85eebf98a32037adb4">  735</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="classoomph_1_1PolarNavierStokesEquations.html#a058dc7463bf84d85eebf98a32037adb4">PolarNavierStokesEquations::dissipation</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;<span class="keyword"></span>{  </div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160; </div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160; <span class="comment">// Initialise</span></div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160; <span class="keywordtype">double</span> diss=0.0;</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160; </div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160; <span class="comment">//Set the value of n_intpt</span></div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160; <span class="keywordtype">unsigned</span> n_intpt = <a class="code" href="classoomph_1_1FiniteElement.html#a79f1710873332823c47023d370f0596b">integral_pt</a>()-&gt;<a class="code" href="classoomph_1_1Integral.html#a1a270de9d99a1fcf1d25a6c1017f65fa">nweight</a>();</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160; </div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160; <span class="comment">//Set the Vector to hold local coordinates</span></div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160; <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>(2);</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160; </div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160; <span class="comment">//Loop over the integration points</span></div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160; <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> ipt=0;ipt&lt;n_intpt;ipt++)</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;  {</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;   </div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;   <span class="comment">//Assign values of s</span></div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;2;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;    {</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;     <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] = <a class="code" href="classoomph_1_1FiniteElement.html#a79f1710873332823c47023d370f0596b">integral_pt</a>()-&gt;<a class="code" href="classoomph_1_1Integral.html#a1a2122f99a87c18649bafdd9ed739758">knot</a>(ipt,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>);</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;    }</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;   </div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;   <span class="comment">//Get the integral weight</span></div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;   <span class="keywordtype">double</span> w = <a class="code" href="classoomph_1_1FiniteElement.html#a79f1710873332823c47023d370f0596b">integral_pt</a>()-&gt;<a class="code" href="classoomph_1_1Integral.html#ac65335e2aab120b285b3d6c294507b06">weight</a>(ipt);</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;   </div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;   <span class="comment">// Get Jacobian of mapping</span></div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;   <span class="keywordtype">double</span> J = <a class="code" href="classoomph_1_1FiniteElement.html#a089e58d5ad9b8efee637221b0e264563">J_eulerian</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>);</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;   </div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;   <span class="comment">// Get strain rate matrix</span></div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;   <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> strainrate(2,2);</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;   <span class="comment">//DenseDoubleMatrix strainrate(2,2);</span></div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;   <a class="code" href="classoomph_1_1PolarNavierStokesEquations.html#a5d46a1417439c7abd56219f8a538a63a">strain_rate</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,strainrate);</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160; </div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;   <span class="comment">// Initialise</span></div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;   <span class="keywordtype">double</span> local_diss=0.0;</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;2;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++) </div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;    {</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> j=0;j&lt;2;j++) </div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;      {    </div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;       local_diss+=2.0*strainrate(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>,j)*strainrate(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>,j);</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;      }</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;    }</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;   </div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;   diss+=local_diss*w*J;</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;  }</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160; </div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160; <span class="keywordflow">return</span> diss;</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160; </div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;}</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160; </div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;<span class="comment">//==============================================================</span><span class="comment"></span></div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;<span class="comment">/// \short Compute traction (on the viscous scale) at local</span></div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;<span class="comment">/// coordinate s for outer unit normal N</span></div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;<span class="comment"></span><span class="comment">//==============================================================</span></div>
<div class="line"><a name="l00789"></a><span class="lineno"><a class="line" href="classoomph_1_1PolarNavierStokesEquations.html#a535d5104145a0ebb128c850c5d87d3c4">  789</a></span>&#160; <span class="keywordtype">void</span>  <a class="code" href="classoomph_1_1PolarNavierStokesEquations.html#a535d5104145a0ebb128c850c5d87d3c4">PolarNavierStokesEquations::get_traction</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;                                                <span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; <a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7dabc60bec4cc294aa2adf92726c6d6823a">N</a>, </div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;                                                <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; traction)</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;{</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160; </div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160; <span class="comment">// Get velocity gradients</span></div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160; <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> strainrate(2,2);</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160; <span class="comment">//DenseDoubleMatrix strainrate(2,2);</span></div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160; <a class="code" href="classoomph_1_1PolarNavierStokesEquations.html#a5d46a1417439c7abd56219f8a538a63a">strain_rate</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,strainrate);</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160; </div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160; <span class="comment">// Get pressure</span></div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160; <span class="keywordtype">double</span> <a class="code" href="the__data__structure_8txt.html#a15043ffc2013f4797ce93c4d1cc7a9ba">press</a>=<a class="code" href="classoomph_1_1PolarNavierStokesEquations.html#afcc85389a45dfa0e811852012fc40442">interpolated_p_pnst</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>);</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160; </div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160; <span class="comment">// Loop over traction components</span></div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160; <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;2;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;  {</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;   traction[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]=-<a class="code" href="the__data__structure_8txt.html#a15043ffc2013f4797ce93c4d1cc7a9ba">press</a>*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7dabc60bec4cc294aa2adf92726c6d6823a">N</a>[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>];</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j=0;j&lt;2;j++)</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;    {</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;     traction[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]+=2.0*strainrate(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>,j)*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7dabc60bec4cc294aa2adf92726c6d6823a">N</a>[j];</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;    }</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;  }</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;}</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160; </div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;<span class="comment">//==============================================================</span><span class="comment"></span></div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;<span class="comment">/// Return dissipation at local coordinate s</span></div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;<span class="comment"></span><span class="comment">//==============================================================</span></div>
<div class="line"><a name="l00816"></a><span class="lineno"><a class="line" href="classoomph_1_1PolarNavierStokesEquations.html#ae8db187877c291548f6249266a4f6341">  816</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="classoomph_1_1PolarNavierStokesEquations.html#a058dc7463bf84d85eebf98a32037adb4">PolarNavierStokesEquations::dissipation</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>)<span class="keyword"> const</span></div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;<span class="keyword"></span>{  </div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160; <span class="comment">// Get strain rate matrix</span></div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160; <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> strainrate(2,2);</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160; <span class="comment">//DenseDoubleMatrix strainrate(2,2);</span></div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160; <a class="code" href="classoomph_1_1PolarNavierStokesEquations.html#a5d46a1417439c7abd56219f8a538a63a">strain_rate</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,strainrate);</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160; </div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160; <span class="comment">// Initialise</span></div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160; <span class="keywordtype">double</span> local_diss=0.0;</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160; <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;2;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++) </div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;  {</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> j=0;j&lt;2;j++) </div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;    {    </div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;     local_diss+=2.0*strainrate(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>,j)*strainrate(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>,j);</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;    }</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;  }</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160; </div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160; <span class="keywordflow">return</span> local_diss;</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;}</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160; </div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;<span class="comment">//==============================================================</span><span class="comment"></span></div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;<span class="comment">/// Get strain-rate tensor: </span></div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;<span class="comment">/// Slightly more complicated in polar coordinates (see eg. Aris)</span></div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;<span class="comment"></span><span class="comment">//==============================================================</span></div>
<div class="line"><a name="l00840"></a><span class="lineno"><a class="line" href="classoomph_1_1PolarNavierStokesEquations.html#a5d46a1417439c7abd56219f8a538a63a">  840</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classoomph_1_1PolarNavierStokesEquations.html#a5d46a1417439c7abd56219f8a538a63a">PolarNavierStokesEquations::strain_rate</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>, </div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;                                             <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a>&amp; strainrate)<span class="keyword"> const</span></div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160; </div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;   <span class="keywordflow">if</span> ((strainrate.<a class="code" href="classoomph_1_1DenseMatrix.html#a9937181f1cb4cfaed7aaf3b483c42456">ncol</a>()!=2)||(strainrate.<a class="code" href="classoomph_1_1DenseMatrix.html#a1b425094510d833ffe91920747a0a962">nrow</a>()!=2))</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;    {</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;     std::ostringstream error_stream;</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;     error_stream &lt;&lt; <span class="stringliteral">&quot;Wrong size &quot;</span> &lt;&lt; strainrate.<a class="code" href="classoomph_1_1DenseMatrix.html#a9937181f1cb4cfaed7aaf3b483c42456">ncol</a>() &lt;&lt; <span class="stringliteral">&quot; &quot;</span> </div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;                  &lt;&lt; strainrate.<a class="code" href="classoomph_1_1DenseMatrix.html#a1b425094510d833ffe91920747a0a962">nrow</a>() &lt;&lt; std::endl;</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;     <span class="keywordflow">throw</span> <a class="code" href="classoomph_1_1OomphLibError.html">OomphLibError</a>(error_stream.str(),</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;                         OOMPH_CURRENT_FUNCTION,</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;                         OOMPH_EXCEPTION_LOCATION);</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;    }</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160; </div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;   <span class="comment">// Velocity gradient matrix</span></div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;   <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> dudx(2); </div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160; </div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;   <span class="comment">//Find out how many nodes there are in the element</span></div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;   <span class="keywordtype">unsigned</span> n_node = <a class="code" href="classoomph_1_1FiniteElement.html#a6219ed269a6d89b5aa14659cce48905a">nnode</a>();</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160; </div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;   <span class="comment">//Set up memory for the shape and test functions</span></div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;   <a class="code" href="classoomph_1_1Shape.html">Shape</a> psif(n_node);</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;   <a class="code" href="classoomph_1_1DShape.html">DShape</a> dpsifdx(n_node,2);</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160; </div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;   <span class="comment">//Call the derivatives of the shape functions</span></div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;   <a class="code" href="classoomph_1_1FiniteElement.html#a9296c17b134688049256a4bbc886df69">dshape_eulerian</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,psif,dpsifdx);</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160; </div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;   <span class="comment">//Find the indices at which the local velocities are stored</span></div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;   <span class="keywordtype">unsigned</span> u_nodal_index[2];</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;2;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++) {u_nodal_index[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] = <a class="code" href="classoomph_1_1PolarNavierStokesEquations.html#aa478578286aece66720cbd841f450ba0">u_index_pnst</a>(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>);}</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160; </div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;   <span class="comment">//Calculate local values of the velocity components</span></div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;   <span class="comment">//Allocate</span></div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;   <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> <a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>(2);</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;   <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> <a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>(2);</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;   <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> interpolated_dudx(2,2);</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;   </div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;   <span class="comment">//Initialise to zero</span></div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;2;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;    {</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;     <a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] = 0.0;</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;     <a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] = 0.0;</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> j=0;j&lt;2;j++)</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;      {</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;       interpolated_dudx(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>,j) = 0.0;</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;      }</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;    }</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;   </div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;   <span class="comment">//Calculate velocities and derivatives:</span></div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;   <span class="comment">// Loop over nodes</span></div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l=0;l&lt;n_node;l++) </div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;    {</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;     <span class="comment">//Loop over directions</span></div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;2;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;      {</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;       <span class="comment">//Get the nodal value</span></div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;       <span class="keywordtype">double</span> u_value = this-&gt;<a class="code" href="classoomph_1_1FiniteElement.html#a28fd5c2d4aeba5ef65bee0e0d72569f5">nodal_value</a>(l,u_nodal_index[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]);</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;       <a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] += u_value*psif[l];</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;       <a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] += this-&gt;<a class="code" href="classoomph_1_1FiniteElement.html#a9152c16ae9899168bcdaac7c2f977444">nodal_position</a>(l,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>)*psif[l];</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;       </div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;       <span class="comment">//Loop over derivative directions</span></div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;       <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> j=0;j&lt;2;j++)</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;        {                               </div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;         interpolated_dudx(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>,j) += u_value*dpsifdx(l,j);</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;        }</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;      }</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;    }</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160; </div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">double</span> Alpha = <a class="code" href="classoomph_1_1PolarNavierStokesEquations.html#a4bde38e6f8a429c4e3da7c3ce273045e">alpha</a>();</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;   <span class="comment">//Can no longer loop over strain components               </span></div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;   strainrate(0,0)=interpolated_dudx(0,0);</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;   strainrate(1,1)=(1./(Alpha*<a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>[0]))*interpolated_dudx(1,1)+(<a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>[0]/<a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>[0]);</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;   strainrate(1,0)=0.5*(interpolated_dudx(1,0)-(<a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>[1]/<a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>[0])+(1./(Alpha*<a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>[0]))*interpolated_dudx(0,1));</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;   strainrate(0,1)=strainrate(1,0);</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160; </div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;  }</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160; </div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;<span class="comment">//==============================================================</span><span class="comment"></span></div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;<span class="comment">/// Return polar strain-rate tensor multiplied by r</span></div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;<span class="comment">/// Slightly more complicated in polar coordinates (see eg. Aris)</span></div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;<span class="comment"></span><span class="comment">//==============================================================</span></div>
<div class="line"><a name="l00923"></a><span class="lineno"><a class="line" href="classoomph_1_1PolarNavierStokesEquations.html#a969a6d8caaa879136a4fb6ed00cc6cf2">  923</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classoomph_1_1PolarNavierStokesEquations.html#a969a6d8caaa879136a4fb6ed00cc6cf2">PolarNavierStokesEquations::strain_rate_by_r</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>, </div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;                                             <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a>&amp; strainrate)<span class="keyword"> const</span></div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160; </div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;   <span class="keywordflow">if</span> ((strainrate.<a class="code" href="classoomph_1_1DenseMatrix.html#a9937181f1cb4cfaed7aaf3b483c42456">ncol</a>()!=2)||(strainrate.<a class="code" href="classoomph_1_1DenseMatrix.html#a1b425094510d833ffe91920747a0a962">nrow</a>()!=2))</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;    {</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;     std::ostringstream error_stream;</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;     error_stream &lt;&lt; <span class="stringliteral">&quot;Wrong size &quot;</span> &lt;&lt; strainrate.<a class="code" href="classoomph_1_1DenseMatrix.html#a9937181f1cb4cfaed7aaf3b483c42456">ncol</a>() &lt;&lt; <span class="stringliteral">&quot; &quot;</span> </div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;                  &lt;&lt; strainrate.<a class="code" href="classoomph_1_1DenseMatrix.html#a1b425094510d833ffe91920747a0a962">nrow</a>() &lt;&lt; std::endl;</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;     <span class="keywordflow">throw</span> <a class="code" href="classoomph_1_1OomphLibError.html">OomphLibError</a>(error_stream.str(),</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;                         OOMPH_CURRENT_FUNCTION,</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;                         OOMPH_EXCEPTION_LOCATION);</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;    }</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160; </div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;   <span class="comment">// Velocity gradient matrix</span></div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;   <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> dudx(2); </div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160; </div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;   <span class="comment">//Find out how many nodes there are in the element</span></div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;   <span class="keywordtype">unsigned</span> n_node = <a class="code" href="classoomph_1_1FiniteElement.html#a6219ed269a6d89b5aa14659cce48905a">nnode</a>();</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160; </div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;   <span class="comment">//Set up memory for the shape and test functions</span></div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;   <a class="code" href="classoomph_1_1Shape.html">Shape</a> psif(n_node);</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;   <a class="code" href="classoomph_1_1DShape.html">DShape</a> dpsifdx(n_node,2);</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160; </div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;   <span class="comment">//Call the derivatives of the shape functions</span></div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;   <a class="code" href="classoomph_1_1FiniteElement.html#a9296c17b134688049256a4bbc886df69">dshape_eulerian</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,psif,dpsifdx);</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160; </div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;   <span class="comment">//Find the indices at which the local velocities are stored</span></div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;   <span class="keywordtype">unsigned</span> u_nodal_index[2];</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;2;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++) {u_nodal_index[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] = <a class="code" href="classoomph_1_1PolarNavierStokesEquations.html#aa478578286aece66720cbd841f450ba0">u_index_pnst</a>(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>);}</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160; </div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;   <span class="comment">//Calculate local values of the velocity components</span></div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;   <span class="comment">//Allocate</span></div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;   <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> <a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>(2);</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;   <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> <a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>(2);</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;   <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> interpolated_dudx(2,2);</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;   </div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;   <span class="comment">//Initialise to zero</span></div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;2;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;    {</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;     <a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] = 0.0;</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;     <a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] = 0.0;</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> j=0;j&lt;2;j++)</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;      {</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;       interpolated_dudx(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>,j) = 0.0;</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;      }</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;    }</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;   </div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;   <span class="comment">//Calculate velocities and derivatives:</span></div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;   <span class="comment">// Loop over nodes</span></div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l=0;l&lt;n_node;l++) </div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;    {</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;     <span class="comment">//Loop over directions</span></div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;2;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;      {</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;       <span class="comment">//Get the nodal value</span></div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;       <span class="keywordtype">double</span> u_value = this-&gt;<a class="code" href="classoomph_1_1FiniteElement.html#a28fd5c2d4aeba5ef65bee0e0d72569f5">nodal_value</a>(l,u_nodal_index[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]);</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;       <a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] += u_value*psif[l];</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;       <a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] += this-&gt;<a class="code" href="classoomph_1_1FiniteElement.html#a9152c16ae9899168bcdaac7c2f977444">nodal_position</a>(l,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>)*psif[l];</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;       </div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;       <span class="comment">//Loop over derivative directions</span></div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;       <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> j=0;j&lt;2;j++)</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;        {                               </div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;         interpolated_dudx(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>,j) += u_value*dpsifdx(l,j);</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;        }</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;      }</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;    }</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160; </div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">double</span> Alpha = <a class="code" href="classoomph_1_1PolarNavierStokesEquations.html#a4bde38e6f8a429c4e3da7c3ce273045e">alpha</a>();</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;   <span class="comment">//Can no longer loop over strain components               </span></div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;   strainrate(0,0)=interpolated_dudx(0,0);</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;   strainrate(1,1)=(1./(Alpha*<a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>[0]))*interpolated_dudx(1,1)+(<a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>[0]/<a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>[0]);</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;   strainrate(1,0)=0.5*(interpolated_dudx(1,0)-(<a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>[1]/<a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>[0])+(1./(Alpha*<a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>[0]))*interpolated_dudx(0,1));</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;   strainrate(0,1)=strainrate(1,0);</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;  </div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;   strainrate(0,0)*=<a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>[0];</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;   strainrate(1,1)*=<a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>[0];</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;   strainrate(1,0)*=<a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>[0];</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;   strainrate(0,1)*=<a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>[0];</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;   <span class="comment">/*</span></div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;<span class="comment">   strainrate(0,0)*=interpolated_x[0];</span></div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;<span class="comment">   strainrate(1,1)*=interpolated_x[0];</span></div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;<span class="comment">   strainrate(1,0)*=interpolated_x[0];</span></div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;<span class="comment">   strainrate(0,1)*=interpolated_x[0];</span></div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;<span class="comment">   */</span></div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;  }</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160; </div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;<span class="comment">//==============================================================</span><span class="comment"></span></div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;<span class="comment">///  \short Get integral of kinetic energy over element:</span></div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;<span class="comment"></span><span class="comment">//==============================================================</span></div>
<div class="line"><a name="l01015"></a><span class="lineno"><a class="line" href="classoomph_1_1PolarNavierStokesEquations.html#a1e9cfddfe57aa786569129ea22c637b0"> 1015</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="classoomph_1_1PolarNavierStokesEquations.html#a1e9cfddfe57aa786569129ea22c637b0">PolarNavierStokesEquations::kin_energy</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;<span class="keyword"></span>{  </div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160; </div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160; <span class="comment">// Initialise</span></div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160; <span class="keywordtype">double</span> kin_en=0.0;</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160; </div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160; <span class="comment">//Set the value of n_intpt</span></div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160; <span class="keywordtype">unsigned</span> n_intpt = <a class="code" href="classoomph_1_1FiniteElement.html#a79f1710873332823c47023d370f0596b">integral_pt</a>()-&gt;<a class="code" href="classoomph_1_1Integral.html#a1a270de9d99a1fcf1d25a6c1017f65fa">nweight</a>();</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160; </div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160; <span class="comment">//Set the Vector to hold local coordinates</span></div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160; <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>(2);</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160; </div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160; <span class="comment">//Loop over the integration points</span></div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160; <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> ipt=0;ipt&lt;n_intpt;ipt++)</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;  {   </div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;   <span class="comment">//Assign values of s</span></div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;2;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;    {</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;     <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] = <a class="code" href="classoomph_1_1FiniteElement.html#a79f1710873332823c47023d370f0596b">integral_pt</a>()-&gt;<a class="code" href="classoomph_1_1Integral.html#a1a2122f99a87c18649bafdd9ed739758">knot</a>(ipt,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>);</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;    }</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;   </div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;   <span class="comment">//Get the integral weight</span></div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;   <span class="keywordtype">double</span> w = <a class="code" href="classoomph_1_1FiniteElement.html#a79f1710873332823c47023d370f0596b">integral_pt</a>()-&gt;<a class="code" href="classoomph_1_1Integral.html#ac65335e2aab120b285b3d6c294507b06">weight</a>(ipt);</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;   </div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;   <span class="comment">//Get Jacobian of mapping</span></div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;   <span class="keywordtype">double</span> J = <a class="code" href="classoomph_1_1FiniteElement.html#a089e58d5ad9b8efee637221b0e264563">J_eulerian</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>);</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;   </div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;   <span class="comment">// Loop over directions</span></div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;   <span class="keywordtype">double</span> veloc_squared=0.0;</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;2;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++) </div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;    {</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;     veloc_squared+=<a class="code" href="classoomph_1_1PolarNavierStokesEquations.html#ac3a3e89734b01c9f117520eac5a2ace3">interpolated_u_pnst</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>)*<a class="code" href="classoomph_1_1PolarNavierStokesEquations.html#ac3a3e89734b01c9f117520eac5a2ace3">interpolated_u_pnst</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>);</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;    }</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;   </div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;   kin_en+=0.5*veloc_squared*w*J;</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;  }</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160; </div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160; <span class="keywordflow">return</span> kin_en;</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160; </div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;}</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160; </div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;<span class="comment">//==============================================================</span><span class="comment"></span></div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;<span class="comment">/// Return pressure integrated over the element</span></div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;<span class="comment"></span><span class="comment">//==============================================================</span></div>
<div class="line"><a name="l01059"></a><span class="lineno"><a class="line" href="classoomph_1_1PolarNavierStokesEquations.html#ad95e0de64c45d54690bcc422cd17a1fc"> 1059</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="classoomph_1_1PolarNavierStokesEquations.html#ad95e0de64c45d54690bcc422cd17a1fc">PolarNavierStokesEquations::pressure_integral</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160; </div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160; <span class="comment">// Initialise </span></div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160; <span class="keywordtype">double</span> press_int=0;</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160; </div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160; <span class="comment">//Set the value of n_intpt</span></div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160; <span class="keywordtype">unsigned</span> n_intpt = <a class="code" href="classoomph_1_1FiniteElement.html#a79f1710873332823c47023d370f0596b">integral_pt</a>()-&gt;<a class="code" href="classoomph_1_1Integral.html#a1a270de9d99a1fcf1d25a6c1017f65fa">nweight</a>();</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160; </div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160; <span class="comment">//Set the Vector to hold local coordinates</span></div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160; <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>(2);</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160; </div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160; <span class="comment">//Loop over the integration points</span></div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160; <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> ipt=0;ipt&lt;n_intpt;ipt++)</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;  {</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;   </div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;   <span class="comment">//Assign values of s</span></div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;2;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;    {</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;     <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] = <a class="code" href="classoomph_1_1FiniteElement.html#a79f1710873332823c47023d370f0596b">integral_pt</a>()-&gt;<a class="code" href="classoomph_1_1Integral.html#a1a2122f99a87c18649bafdd9ed739758">knot</a>(ipt,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>);</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;    }</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;   </div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;   <span class="comment">//Get the integral weight</span></div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;   <span class="keywordtype">double</span> w = <a class="code" href="classoomph_1_1FiniteElement.html#a79f1710873332823c47023d370f0596b">integral_pt</a>()-&gt;<a class="code" href="classoomph_1_1Integral.html#ac65335e2aab120b285b3d6c294507b06">weight</a>(ipt);</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;   </div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;   <span class="comment">//Get Jacobian of mapping</span></div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;   <span class="keywordtype">double</span> J = <a class="code" href="classoomph_1_1FiniteElement.html#a089e58d5ad9b8efee637221b0e264563">J_eulerian</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>);</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;   </div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;   <span class="comment">//Premultiply the weights and the Jacobian</span></div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;   <span class="keywordtype">double</span> <a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a> = w*J;</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;   </div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;   <span class="comment">// Get pressure</span></div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;   <span class="keywordtype">double</span> <a class="code" href="the__data__structure_8txt.html#a15043ffc2013f4797ce93c4d1cc7a9ba">press</a>=<a class="code" href="classoomph_1_1PolarNavierStokesEquations.html#afcc85389a45dfa0e811852012fc40442">interpolated_p_pnst</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>);</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;   </div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;   <span class="comment">// Add</span></div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;   press_int+=<a class="code" href="the__data__structure_8txt.html#a15043ffc2013f4797ce93c4d1cc7a9ba">press</a>*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;   </div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;  }</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160; </div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160; <span class="keywordflow">return</span> press_int;</div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160; </div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;}</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;  <span class="comment"></span></div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;<span class="comment">//////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;<span class="comment">//// The finished version of the new equations                   /////</span></div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;<span class="comment">//////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;<span class="comment">//==============================================================</span><span class="comment"></span></div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;<span class="comment">///  Compute the residuals for the Navier--Stokes </span></div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;<span class="comment">///  equations; flag=1(or 0): do (or don&#39;t) compute the </span></div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;<span class="comment">///  Jacobian as well. </span></div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;<span class="comment">///  flag=2 for Residuals, Jacobian and mass_matrix</span></div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;<span class="comment">///  This is now my new version with Jacobian and </span></div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;<span class="comment">///  dimensionless phi</span></div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;<span class="comment"></span><span class="comment">//==============================================================</span></div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classoomph_1_1PolarNavierStokesEquations.html#ad0188bfed5fc5e929017226cde427839">PolarNavierStokesEquations::</a></div>
<div class="line"><a name="l01116"></a><span class="lineno"><a class="line" href="classoomph_1_1PolarNavierStokesEquations.html#ad0188bfed5fc5e929017226cde427839"> 1116</a></span>&#160;<a class="code" href="classoomph_1_1PolarNavierStokesEquations.html#ad0188bfed5fc5e929017226cde427839">fill_in_generic_residual_contribution</a>(<a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;<a class="code" href="the__data__structure_8txt.html#a1400a973def57b85051cfe1070be1810">residuals</a>, </div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;                                      <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> &amp;jacobian,</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;                                      <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> &amp;mass_matrix, </div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;                                      <span class="keywordtype">unsigned</span> flag)</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;{ </div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160; </div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160; <span class="comment">//Find out how many nodes there are</span></div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160; <span class="keywordtype">unsigned</span> n_node = <a class="code" href="classoomph_1_1FiniteElement.html#a6219ed269a6d89b5aa14659cce48905a">nnode</a>();</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160; </div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160; <span class="comment">//Find out how many pressure dofs there are</span></div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160; <span class="keywordtype">unsigned</span> n_pres = <a class="code" href="classoomph_1_1PolarNavierStokesEquations.html#af66cafead00372b56b677ab40a184d1f">npres_pnst</a>();</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160; </div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160; <span class="comment">//Find the indices at which the local velocities are stored</span></div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160; <span class="keywordtype">unsigned</span> u_nodal_index[2];</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160; <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;2;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++) {u_nodal_index[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] = <a class="code" href="classoomph_1_1PolarNavierStokesEquations.html#aa478578286aece66720cbd841f450ba0">u_index_pnst</a>(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>);}</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160; </div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160; <span class="comment">//Set up memory for the shape and test functions</span></div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160; <a class="code" href="classoomph_1_1Shape.html">Shape</a> psif(n_node), testf(n_node);</div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160; <a class="code" href="classoomph_1_1DShape.html">DShape</a> dpsifdx(n_node,2), dtestfdx(n_node,2);</div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;  </div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160; <span class="comment">//Set up memory for pressure shape and test functions</span></div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160; <a class="code" href="classoomph_1_1Shape.html">Shape</a> psip(n_pres), testp(n_pres);</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160; </div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160; <span class="comment">//Number of integration points</span></div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160; <span class="keywordtype">unsigned</span> n_intpt = <a class="code" href="classoomph_1_1FiniteElement.html#a79f1710873332823c47023d370f0596b">integral_pt</a>()-&gt;<a class="code" href="classoomph_1_1Integral.html#a1a270de9d99a1fcf1d25a6c1017f65fa">nweight</a>();</div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;   </div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160; <span class="comment">//Set the Vector to hold local coordinates</span></div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160; <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>(2);</div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160; </div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160; <span class="comment">//Get the reynolds number and Alpha</span></div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160; <span class="keyword">const</span> <span class="keywordtype">double</span> Re = <a class="code" href="classoomph_1_1PolarNavierStokesEquations.html#ac0de4c87dc0440dad909f044a5a99080">re</a>();</div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160; <span class="keyword">const</span> <span class="keywordtype">double</span> Alpha = <a class="code" href="classoomph_1_1PolarNavierStokesEquations.html#a4bde38e6f8a429c4e3da7c3ce273045e">alpha</a>();</div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160; <span class="keyword">const</span> <span class="keywordtype">double</span> Re_St = <a class="code" href="classoomph_1_1PolarNavierStokesEquations.html#ac539e938a5a877e708e2af0d84ca4edb">re_st</a>();</div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160; </div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160; <span class="comment">//Integers to store the local equations and unknowns</span></div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160; <span class="keywordtype">int</span> local_eqn=0, local_unknown=0;</div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160; </div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160; <span class="comment">//Loop over the integration points</span></div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160; <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> ipt=0;ipt&lt;n_intpt;ipt++)</div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;  {</div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;   <span class="comment">//Assign values of s</span></div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;2;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++) <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] = <a class="code" href="classoomph_1_1FiniteElement.html#a79f1710873332823c47023d370f0596b">integral_pt</a>()-&gt;<a class="code" href="classoomph_1_1Integral.html#a1a2122f99a87c18649bafdd9ed739758">knot</a>(ipt,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>);</div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;   <span class="comment">//Get the integral weight</span></div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;   <span class="keywordtype">double</span> w = <a class="code" href="classoomph_1_1FiniteElement.html#a79f1710873332823c47023d370f0596b">integral_pt</a>()-&gt;<a class="code" href="classoomph_1_1Integral.html#ac65335e2aab120b285b3d6c294507b06">weight</a>(ipt);</div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;   </div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;   <span class="comment">//Call the derivatives of the shape and test functions</span></div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;   <span class="keywordtype">double</span> J = </div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;     <a class="code" href="classoomph_1_1PolarNavierStokesEquations.html#a7fda7aac0b9eb09410dfff38f992374c">dshape_and_dtest_eulerian_at_knot_pnst</a>(ipt,psif,dpsifdx,testf,dtestfdx);</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;   </div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;   <span class="comment">//Call the pressure shape and test functions</span></div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;   <a class="code" href="classoomph_1_1PolarNavierStokesEquations.html#a1b382bf38d7b7041417bbc91ad85b38f">pshape_pnst</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,psip,testp);</div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;   </div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;   <span class="comment">//Premultiply the weights and the Jacobian</span></div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;   <span class="keywordtype">double</span> <a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a> = w*J;</div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;   </div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;   <span class="comment">//Calculate local values of the pressure and velocity components</span></div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;   <span class="comment">//Allocate</span></div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;   <span class="keywordtype">double</span> interpolated_p=0.0;</div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;   <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> <a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>(2);</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;   <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> <a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>(2);</div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;   <span class="comment">//Vector&lt;double&gt; mesh_velocity(2);</span></div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;   <span class="comment">//Vector&lt;double&gt; dudt(2);</span></div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;   <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> interpolated_dudx(2,2);</div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;   </div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;   <span class="comment">//Initialise to zero</span></div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;2;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;    {</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;     <span class="comment">//dudt[i] = 0.0;</span></div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;     <span class="comment">//mesh_velocity[i] = 0.0;</span></div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;     <a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] = 0.0;</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;     <a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] = 0.0;</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> j=0;j&lt;2;j++)</div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;      {</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;       interpolated_dudx(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>,j) = 0.0;</div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;      }</div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;    }</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;   </div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;   <span class="comment">//Calculate pressure</span></div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l=0;l&lt;n_pres;l++) interpolated_p += <a class="code" href="classoomph_1_1PolarNavierStokesEquations.html#a4db8f8149fe830b204de3c5f64fd3113">p_pnst</a>(l)*psip[l];</div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;   </div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;   <span class="comment">//Calculate velocities and derivatives:</span></div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160; </div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;   <span class="comment">// Loop over nodes</span></div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l=0;l&lt;n_node;l++) </div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;    {</div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;     <span class="comment">//Loop over directions</span></div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;2;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;      {</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;       <span class="comment">//Get the nodal value</span></div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;       <span class="keywordtype">double</span> u_value = this-&gt;<a class="code" href="classoomph_1_1FiniteElement.html#a28fd5c2d4aeba5ef65bee0e0d72569f5">nodal_value</a>(l,u_nodal_index[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]);</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;       <a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] += u_value*psif[l];</div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;       <a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] += this-&gt;<a class="code" href="classoomph_1_1FiniteElement.html#a9152c16ae9899168bcdaac7c2f977444">nodal_position</a>(l,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>)*psif[l];</div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;       <span class="comment">//dudt[i]+=du_dt_pnst(l,i)*psif[l];</span></div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;       <span class="comment">//mesh_velocity[i] +=dx_dt(l,i)*psif[l];</span></div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;       </div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;       <span class="comment">//Loop over derivative directions</span></div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;       <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> j=0;j&lt;2;j++)</div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;        {                               </div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;         interpolated_dudx(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>,j) += u_value*dpsifdx(l,j);</div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;        }</div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;      }</div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;    }</div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160; </div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;   <span class="comment">//MOMENTUM EQUATIONS</span></div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;   <span class="comment">//------------------</span></div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;   </div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;   <span class="comment">//Loop over the test functions</span></div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l=0;l&lt;n_node;l++)</div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;    {</div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;      <span class="comment">// Can&#39;t loop over velocity components as don&#39;t have identical contributions</span></div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;      <span class="comment">// Do seperately for i = {0,1} instead</span></div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;      <span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;</div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;      {</div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;        <span class="comment">/*IF it&#39;s not a boundary condition*/</span></div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;        local_eqn = <a class="code" href="classoomph_1_1FiniteElement.html#a5da80bbed97543e586f698251d67941d">nodal_local_eqn</a>(l,u_nodal_index[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]);</div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;        <span class="keywordflow">if</span>(local_eqn &gt;= 0)</div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;         {         </div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;          <span class="comment">//Add the testf[l] term of the stress tensor</span></div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;          <a class="code" href="the__data__structure_8txt.html#a1400a973def57b85051cfe1070be1810">residuals</a>[local_eqn] +=  ((interpolated_p/<a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>[0]) </div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;                                    - ((1.+<a class="code" href="classoomph_1_1PolarNavierStokesEquations.html#a3370b89e66379cb0b53417db39357e77">Gamma</a>[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>])/pow(<a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>[0],2.))*((1./Alpha)*interpolated_dudx(1,1)+<a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>[0]))</div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;           *testf[l]*<a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>[0]*Alpha*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;          </div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;          <span class="comment">//Add the dtestfdx(l,0) term of the stress tensor</span></div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;          <a class="code" href="the__data__structure_8txt.html#a1400a973def57b85051cfe1070be1810">residuals</a>[local_eqn] +=  (interpolated_p - (1.+<a class="code" href="classoomph_1_1PolarNavierStokesEquations.html#a3370b89e66379cb0b53417db39357e77">Gamma</a>[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>])*interpolated_dudx(0,0))</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;           *dtestfdx(l,0)*<a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>[0]*Alpha*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;          </div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;          <span class="comment">//Add the dtestfdx(l,1) term of the stress tensor</span></div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;          <a class="code" href="the__data__structure_8txt.html#a1400a973def57b85051cfe1070be1810">residuals</a>[local_eqn] -=  ((1./(<a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>[0]*Alpha))*interpolated_dudx(0,1)</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;                                     - (<a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>[1]/<a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>[0])</div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;                                    + <a class="code" href="classoomph_1_1PolarNavierStokesEquations.html#a3370b89e66379cb0b53417db39357e77">Gamma</a>[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]*interpolated_dudx(1,0))</div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;           *(1./(<a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>[0]*Alpha))*dtestfdx(l,1)*<a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>[0]*Alpha*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;  </div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;          </div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;          <span class="comment">//Convective terms</span></div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;          <a class="code" href="the__data__structure_8txt.html#a1400a973def57b85051cfe1070be1810">residuals</a>[local_eqn] -=  Re*(<a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>[0]*interpolated_dudx(0,0)</div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;                                    +(<a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>[1]/(<a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>[0]*Alpha))*interpolated_dudx(0,1)</div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;                                    -(pow(<a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>[1],2.)/<a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>[0]))</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;            *testf[l]*<a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>[0]*Alpha*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;    </div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;                </div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;                </div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;                <span class="comment">//CALCULATE THE JACOBIAN</span></div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;                <span class="keywordflow">if</span>(flag)</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;                 {</div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;                  <span class="comment">//Loop over the velocity shape functions again</span></div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;                  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l2=0;l2&lt;n_node;l2++)</div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;                   { </div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;                    <span class="comment">// Again can&#39;t loop over velocity components due to loss of symmetry</span></div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;                    <span class="keywordtype">unsigned</span> i2=0;</div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;                    { </div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;                     <span class="comment">//If at a non-zero degree of freedom add in the entry</span></div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;                     local_unknown = <a class="code" href="classoomph_1_1FiniteElement.html#a5da80bbed97543e586f698251d67941d">nodal_local_eqn</a>(l2,u_nodal_index[i2]);</div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;                     <span class="keywordflow">if</span>(local_unknown &gt;= 0)</div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;                      {</div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;                       <span class="comment">//Add contribution to Elemental Matrix</span></div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;                       jacobian(local_eqn,local_unknown) </div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;                        -= (1.+<a class="code" href="classoomph_1_1PolarNavierStokesEquations.html#a3370b89e66379cb0b53417db39357e77">Gamma</a>[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>])*(psif[l2]/pow(<a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>[0],2.))*testf[l]*<a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>[0]*Alpha*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;                       </div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;                       jacobian(local_eqn,local_unknown) </div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;                        -= (1.+<a class="code" href="classoomph_1_1PolarNavierStokesEquations.html#a3370b89e66379cb0b53417db39357e77">Gamma</a>[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>])*dpsifdx(l2,0)*dtestfdx(l,0)*<a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>[0]*Alpha*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;                       </div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;                       jacobian(local_eqn,local_unknown) </div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;                        -= (1./(<a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>[0]*Alpha))*dpsifdx(l2,1)*(1./(<a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>[0]*Alpha))*dtestfdx(l,1)*<a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>[0]*Alpha*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;                       </div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;                       <span class="comment">//Now add in the inertial terms</span></div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;                       jacobian(local_eqn,local_unknown)</div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;                        -= Re*(psif[l2]*interpolated_dudx(0,0)+<a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>[0]*dpsifdx(l2,0)</div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;                               +(<a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>[1]/(<a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>[0]*Alpha))*dpsifdx(l2,1))*testf[l]*<a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>[0]*Alpha*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;                       </div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;                       <span class="comment">//extra bit for mass matrix</span></div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;                       <span class="keywordflow">if</span>(flag==2) </div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;                        {</div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;                         mass_matrix(local_eqn, local_unknown) += </div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;                          Re_St*psif[l2]*testf[l]*<a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>[0]*Alpha*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;                        }</div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160; </div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;                      } <span class="comment">//End of (Jacobian&#39;s) if not boundary condition statement</span></div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;                    } <span class="comment">//End of i2=0 section</span></div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;                    </div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;                    i2=1;</div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;                    {</div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;                     </div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;                    <span class="comment">//If at a non-zero degree of freedom add in the entry</span></div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;                    local_unknown = <a class="code" href="classoomph_1_1FiniteElement.html#a5da80bbed97543e586f698251d67941d">nodal_local_eqn</a>(l2,u_nodal_index[i2]);</div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;                    <span class="keywordflow">if</span>(local_unknown &gt;= 0)</div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;                     {</div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;                       <span class="comment">//Add contribution to Elemental Matrix</span></div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;                       jacobian(local_eqn,local_unknown) </div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;                        -= ((1.+<a class="code" href="classoomph_1_1PolarNavierStokesEquations.html#a3370b89e66379cb0b53417db39357e77">Gamma</a>[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>])/(pow(<a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>[0],2.)*Alpha))*dpsifdx(l2,1)*testf[l]*<a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>[0]*Alpha*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;                       </div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;                       jacobian(local_eqn,local_unknown) </div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;                        -= (-(psif[l2]/<a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>[0])+<a class="code" href="classoomph_1_1PolarNavierStokesEquations.html#a3370b89e66379cb0b53417db39357e77">Gamma</a>[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]*dpsifdx(l2,0))</div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;                                      *(1./(<a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>[0]*Alpha))*dtestfdx(l,1)*<a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>[0]*Alpha*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;                                      </div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;                       <span class="comment">//Now add in the inertial terms</span></div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;                       jacobian(local_eqn,local_unknown)</div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;                        -= Re*((psif[l2]/(<a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>[0]*Alpha))*interpolated_dudx(0,1)-2*<a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>[1]*(psif[l2]/<a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>[0]))</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;                            *testf[l]*<a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>[0]*Alpha*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;                        </div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;                      } <span class="comment">//End of (Jacobian&#39;s) if not boundary condition statement</span></div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;                  } <span class="comment">//End of i2=1 section</span></div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;                  </div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;               } <span class="comment">//End of l2 loop</span></div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;               </div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;               <span class="comment">/*Now loop over pressure shape functions*/</span></div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;               <span class="comment">/*This is the contribution from pressure gradient*/</span></div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;               <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l2=0;l2&lt;n_pres;l2++)</div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;                {</div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;                  <span class="comment">/*If we are at a non-zero degree of freedom in the entry*/</span></div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;                  local_unknown = <a class="code" href="classoomph_1_1PolarNavierStokesEquations.html#a4738c2cb0df9ba80c581442ceade039e">p_local_eqn</a>(l2);</div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;                  <span class="keywordflow">if</span>(local_unknown &gt;= 0)</div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;                   {</div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;                     jacobian(local_eqn,local_unknown)</div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;                      += (psip[l2]/<a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>[0])*testf[l]*<a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>[0]*Alpha*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160; </div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;                     jacobian(local_eqn,local_unknown)</div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;                      += psip[l2]*dtestfdx(l,0)*<a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>[0]*Alpha*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;                   }</div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;                }</div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;            } <span class="comment">/*End of Jacobian calculation*/</span></div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;           </div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;         } <span class="comment">//End of if not boundary condition statement</span></div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;      } <span class="comment">//End of i=0 section</span></div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;      </div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;      <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=1;</div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;      {</div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;        <span class="comment">/*IF it&#39;s not a boundary condition*/</span></div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;        local_eqn = <a class="code" href="classoomph_1_1FiniteElement.html#a5da80bbed97543e586f698251d67941d">nodal_local_eqn</a>(l,u_nodal_index[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]);</div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;        <span class="keywordflow">if</span>(local_eqn &gt;= 0)</div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;         {         </div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;          <span class="comment">//Add the testf[l] term of the stress tensor</span></div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;          <a class="code" href="the__data__structure_8txt.html#a1400a973def57b85051cfe1070be1810">residuals</a>[local_eqn] +=  ((1./(pow(<a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>[0],2.)*Alpha))*interpolated_dudx(0,1)</div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;                                    -(<a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>[1]/pow(<a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>[0],2.))</div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;                                    +<a class="code" href="classoomph_1_1PolarNavierStokesEquations.html#a3370b89e66379cb0b53417db39357e77">Gamma</a>[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]*(1./<a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>[0])*interpolated_dudx(1,0)) </div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;            *testf[l]*<a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>[0]*Alpha*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;                                                                                                                    </div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;          <span class="comment">//Add the dtestfdx(l,0) term of the stress tensor</span></div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;          <a class="code" href="the__data__structure_8txt.html#a1400a973def57b85051cfe1070be1810">residuals</a>[local_eqn] -=  (interpolated_dudx(1,0) </div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;                                    +<a class="code" href="classoomph_1_1PolarNavierStokesEquations.html#a3370b89e66379cb0b53417db39357e77">Gamma</a>[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]*((1./(<a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>[0]*Alpha))*interpolated_dudx(0,1)-(<a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>[1]/<a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>[0])))</div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;            *dtestfdx(l,0)*<a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>[0]*Alpha*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;          </div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;          <span class="comment">//Add the dtestfdx(l,1) term of the stress tensor</span></div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;          <a class="code" href="the__data__structure_8txt.html#a1400a973def57b85051cfe1070be1810">residuals</a>[local_eqn] +=   (interpolated_p</div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;                                     -(1.+<a class="code" href="classoomph_1_1PolarNavierStokesEquations.html#a3370b89e66379cb0b53417db39357e77">Gamma</a>[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>])*((1./(<a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>[0]*Alpha))*interpolated_dudx(1,1)+(<a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>[0]/<a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>[0])))</div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;            *(1./(<a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>[0]*Alpha))*dtestfdx(l,1)*<a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>[0]*Alpha*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;  </div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;          </div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;          <span class="comment">//Convective terms</span></div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;          <a class="code" href="the__data__structure_8txt.html#a1400a973def57b85051cfe1070be1810">residuals</a>[local_eqn] -= Re*(<a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>[0]*interpolated_dudx(1,0)</div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;                                      +(<a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>[1]/(<a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>[0]*Alpha))*interpolated_dudx(1,1)</div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;                                      +((<a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>[0]*<a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>[1])/<a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>[0]))</div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;            *testf[l]*<a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>[0]*Alpha*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;    </div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;          </div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;           <span class="comment">//CALCULATE THE JACOBIAN</span></div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;           <span class="keywordflow">if</span>(flag)</div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;            {</div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;              <span class="comment">//Loop over the velocity shape functions again</span></div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;              <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l2=0;l2&lt;n_node;l2++)</div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;               { </div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;                 <span class="comment">// Again can&#39;t loop over velocity components due to loss of symmetry</span></div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;                 <span class="keywordtype">unsigned</span> i2=0;</div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;                 {</div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;                   <span class="comment">//If at a non-zero degree of freedom add in the entry</span></div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;                   local_unknown = <a class="code" href="classoomph_1_1FiniteElement.html#a5da80bbed97543e586f698251d67941d">nodal_local_eqn</a>(l2,u_nodal_index[i2]);</div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;                   <span class="keywordflow">if</span>(local_unknown &gt;= 0)</div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;                    {</div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;                      <span class="comment">//Add contribution to Elemental Matrix</span></div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;                      jacobian(local_eqn,local_unknown)               </div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;                       += (1./(pow(<a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>[0],2.)*Alpha))*dpsifdx(l2,1)</div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;                        *testf[l]*<a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>[0]*Alpha*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;                                </div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;                      jacobian(local_eqn,local_unknown) </div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;                       -= <a class="code" href="classoomph_1_1PolarNavierStokesEquations.html#a3370b89e66379cb0b53417db39357e77">Gamma</a>[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]*(1./(<a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>[0]*Alpha))*dpsifdx(l2,1)</div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;                        *dtestfdx(l,0)*<a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>[0]*Alpha*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;                             </div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;                      jacobian(local_eqn,local_unknown) </div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;                       -= (1+<a class="code" href="classoomph_1_1PolarNavierStokesEquations.html#a3370b89e66379cb0b53417db39357e77">Gamma</a>[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>])*(psif[l2]/<a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>[0])*(1./(<a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>[0]*Alpha)) </div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;                        *dtestfdx(l,1)*<a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>[0]*Alpha*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;                          </div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;                      <span class="comment">//Now add in the inertial terms</span></div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;                      jacobian(local_eqn,local_unknown)</div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;                       -= Re*(psif[l2]*interpolated_dudx(1,0)+(psif[l2]*<a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>[1]/<a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>[0]))</div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;                        *testf[l]*<a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>[0]*Alpha*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;                                               </div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;                     } <span class="comment">//End of (Jacobian&#39;s) if not boundary condition statement</span></div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;                  } <span class="comment">//End of i2=0 section</span></div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;                  </div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;                  i2=1;</div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;                  {</div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;                    <span class="comment">//If at a non-zero degree of freedom add in the entry</span></div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;                    local_unknown = <a class="code" href="classoomph_1_1FiniteElement.html#a5da80bbed97543e586f698251d67941d">nodal_local_eqn</a>(l2,u_nodal_index[i2]);</div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;                    <span class="keywordflow">if</span>(local_unknown &gt;= 0)</div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;                     {</div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;                       <span class="comment">//Add contribution to Elemental Matrix</span></div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;                       jacobian(local_eqn,local_unknown)</div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;                        += (-(psif[l2]/pow(<a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>[0],2.))+<a class="code" href="classoomph_1_1PolarNavierStokesEquations.html#a3370b89e66379cb0b53417db39357e77">Gamma</a>[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]*(1./<a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>[0])*dpsifdx(l2,0))</div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;                         *testf[l]*<a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>[0]*Alpha*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;                                     </div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;                       jacobian(local_eqn,local_unknown) </div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;                        -= (dpsifdx(l2,0)-<a class="code" href="classoomph_1_1PolarNavierStokesEquations.html#a3370b89e66379cb0b53417db39357e77">Gamma</a>[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]*(psif[l2]/<a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>[0]))</div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;                         *dtestfdx(l,0)*<a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>[0]*Alpha*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;                            </div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;                       jacobian(local_eqn,local_unknown) </div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;                        -= (1.+<a class="code" href="classoomph_1_1PolarNavierStokesEquations.html#a3370b89e66379cb0b53417db39357e77">Gamma</a>[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>])*(1./(<a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>[0]*Alpha))*dpsifdx(l2,1)</div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;                         *(1./(<a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>[0]*Alpha))*dtestfdx(l,1)*<a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>[0]*Alpha*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;                           </div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;                       <span class="comment">//Now add in the inertial terms</span></div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;                       jacobian(local_eqn,local_unknown)</div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;                        -= Re*(<a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>[0]*dpsifdx(l2,0)+(psif[l2]/(<a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>[0]*Alpha))*interpolated_dudx(1,1)</div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;                            +(<a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>[1]/(<a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>[0]*Alpha))*dpsifdx(l2,1)+(<a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>[0]*psif[l2]/<a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>[0]))</div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;                         *testf[l]*<a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>[0]*Alpha*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;   </div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;                                       </div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;                 <span class="comment">//extra bit for mass matrix</span></div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;                 <span class="keywordflow">if</span>(flag==2) </div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;                  {</div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;                   mass_matrix(local_eqn, local_unknown) </div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;                    += Re_St*psif[l2]*testf[l]*<a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>[0]*Alpha*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;                  }</div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;                 </div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;                     } <span class="comment">//End of (Jacobian&#39;s) if not boundary condition statement</span></div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;                  } <span class="comment">//End of i2=1 section</span></div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;                  </div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;               } <span class="comment">//End of l2 loop</span></div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;               </div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;               <span class="comment">/*Now loop over pressure shape functions*/</span></div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;               <span class="comment">/*This is the contribution from pressure gradient*/</span></div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;               <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l2=0;l2&lt;n_pres;l2++)</div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;                {</div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;                  <span class="comment">/*If we are at a non-zero degree of freedom in the entry*/</span></div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;                  local_unknown = <a class="code" href="classoomph_1_1PolarNavierStokesEquations.html#a4738c2cb0df9ba80c581442ceade039e">p_local_eqn</a>(l2);</div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;                  <span class="keywordflow">if</span>(local_unknown &gt;= 0)</div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;                   {</div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;                      jacobian(local_eqn,local_unknown)</div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;                       += (psip[l2]/<a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>[0])*(1./Alpha)*dtestfdx(l,1)*<a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>[0]*Alpha*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160; </div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;                   }</div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;                }</div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;            } <span class="comment">/*End of Jacobian calculation*/</span></div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;           </div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;         } <span class="comment">//End of if not boundary condition statement</span></div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;                </div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;      } <span class="comment">//End of i=1 section </span></div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;    </div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;  } <span class="comment">//End of loop over shape functions</span></div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160; </div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;   <span class="comment">//CONTINUITY EQUATION</span></div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;   <span class="comment">//-------------------</span></div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;      </div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;   <span class="comment">//Loop over the shape functions</span></div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l=0;l&lt;n_pres;l++)</div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;    {</div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;      local_eqn = <a class="code" href="classoomph_1_1PolarNavierStokesEquations.html#a4738c2cb0df9ba80c581442ceade039e">p_local_eqn</a>(l);</div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;     <span class="comment">//If not a boundary conditions</span></div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;     <span class="keywordflow">if</span>(local_eqn &gt;= 0)</div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;      {</div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;       <a class="code" href="the__data__structure_8txt.html#a1400a973def57b85051cfe1070be1810">residuals</a>[local_eqn] += (interpolated_dudx(0,0)+(<a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>[0]/<a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>[0])+(1./(<a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>[0]*Alpha))*interpolated_dudx(1,1))</div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;                              *testp[l]*<a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>[0]*Alpha*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;     </div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;       </div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;       <span class="comment">/*CALCULATE THE JACOBIAN*/</span></div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;       <span class="keywordflow">if</span>(flag)</div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;        {</div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;         <span class="comment">/*Loop over the velocity shape functions*/</span></div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;         <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l2=0;l2&lt;n_node;l2++)</div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;          { </div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;           <span class="keywordtype">unsigned</span> i2=0;</div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;            {</div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;             <span class="comment">/*If we&#39;re at a non-zero degree of freedom add it in*/</span> </div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;             local_unknown = <a class="code" href="classoomph_1_1FiniteElement.html#a5da80bbed97543e586f698251d67941d">nodal_local_eqn</a>(l2,u_nodal_index[i2]);</div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;             <span class="keywordflow">if</span>(local_unknown &gt;= 0)</div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;              {</div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;                jacobian(local_eqn,local_unknown)</div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;                 += (dpsifdx(l2,0)+(psif[l2]/<a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>[0]))*testp[l]*<a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>[0]*Alpha*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;              }</div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;            } <span class="comment">//End of i2=0 section</span></div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160; </div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;            i2=1;</div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;            {</div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;              <span class="comment">/*If we&#39;re at a non-zero degree of freedom add it in*/</span> </div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;              local_unknown = <a class="code" href="classoomph_1_1FiniteElement.html#a5da80bbed97543e586f698251d67941d">nodal_local_eqn</a>(l2,u_nodal_index[i2]);</div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;              <span class="keywordflow">if</span>(local_unknown &gt;= 0)</div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;                {</div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;                  jacobian(local_eqn,local_unknown)</div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;                   += (1./(<a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>[0]*Alpha))*dpsifdx(l2,1)*testp[l]*<a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>[0]*Alpha*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;                }</div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;            } <span class="comment">//End of i2=1 section</span></div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160; </div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;          } <span class="comment">/*End of loop over l2*/</span></div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;        } <span class="comment">/*End of Jacobian calculation*/</span></div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;       </div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;      } <span class="comment">//End of if not boundary condition</span></div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;    } <span class="comment">//End of loop over l</span></div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160; </div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160; </div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;  } <span class="comment">//End of loop over integration points</span></div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160; </div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;} <span class="comment">//End of add_generic_residual_contribution</span></div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;<span class="comment">//////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;<span class="comment">//////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;<span class="comment">//////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;<span class="comment"></span><span class="comment"></span> </div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;<span class="comment">///2D Crouzeix-Raviart elements</span></div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;<span class="comment"></span><span class="comment">//Set the data for the number of Variables at each node</span></div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <a class="code" href="classoomph_1_1PolarCrouzeixRaviartElement.html#aed13ef3c1adcea8f31184f91dedaff28">PolarCrouzeixRaviartElement::Initial_Nvalue</a>[9]</div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;={2,2,2,2,2,2,2,2,2};</div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160; </div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;<span class="comment">//========================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;<span class="comment">/// Number of values (pinned or dofs) required at node n.</span></div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;<span class="comment"></span><span class="comment">//========================================================================</span></div>
<div class="line"><a name="l01523"></a><span class="lineno"><a class="line" href="classoomph_1_1PolarCrouzeixRaviartElement.html#a36edbd6c9a877d4da2c99d5e70691c34"> 1523</a></span>&#160;<span class="keywordtype">unsigned</span> <a class="code" href="classoomph_1_1PolarCrouzeixRaviartElement.html#a36edbd6c9a877d4da2c99d5e70691c34">PolarCrouzeixRaviartElement::required_nvalue</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> </div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;                                                   <span class="keywordtype">int</span> &amp;<a class="code" href="the__data__structure_8txt.html#af88b2d950fae19ab641bd1690e08445c">n</a>)<span class="keyword"> const</span></div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;<span class="keyword"> </span>{<span class="keywordflow">return</span> <a class="code" href="classoomph_1_1PolarCrouzeixRaviartElement.html#aed13ef3c1adcea8f31184f91dedaff28">Initial_Nvalue</a>[<a class="code" href="the__data__structure_8txt.html#af88b2d950fae19ab641bd1690e08445c">n</a>];}</div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160; </div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;<span class="comment">//=========================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;<span class="comment">/// Add pointers to Data and indices of the values</span></div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;<span class="comment">/// that affect the potential load (traction) applied</span></div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;<span class="comment">/// to the SolidElements to the set paired_load_data</span></div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;<span class="comment"></span><span class="comment">//=========================================================================</span></div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classoomph_1_1PolarCrouzeixRaviartElement.html#a575257c6dc7b44e56c687066cbda3791">PolarCrouzeixRaviartElement::</a></div>
<div class="line"><a name="l01533"></a><span class="lineno"><a class="line" href="classoomph_1_1PolarCrouzeixRaviartElement.html#a575257c6dc7b44e56c687066cbda3791"> 1533</a></span>&#160;<a class="code" href="classoomph_1_1PolarCrouzeixRaviartElement.html#a575257c6dc7b44e56c687066cbda3791">get_load_data</a>(std::set&lt;std::pair&lt;Data*,unsigned&gt; &gt; &amp;paired_load_data)</div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;{</div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160; <span class="comment">//Loop over the nodes</span></div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160; <span class="keywordtype">unsigned</span> n_node = this-&gt;<a class="code" href="classoomph_1_1FiniteElement.html#a6219ed269a6d89b5aa14659cce48905a">nnode</a>();</div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160; <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="the__data__structure_8txt.html#af88b2d950fae19ab641bd1690e08445c">n</a>=0;<a class="code" href="the__data__structure_8txt.html#af88b2d950fae19ab641bd1690e08445c">n</a>&lt;n_node;<a class="code" href="the__data__structure_8txt.html#af88b2d950fae19ab641bd1690e08445c">n</a>++)</div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;  {</div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;   <span class="comment">//Loop over the velocity components and add pointer to their data</span></div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;   <span class="comment">//and indices to the vectors</span></div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;2;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;    {</div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;     paired_load_data.insert(std::make_pair(this-&gt;<a class="code" href="classoomph_1_1FiniteElement.html#ace0e7fb72a805b5c2c600347bfae7a9b">node_pt</a>(<a class="code" href="the__data__structure_8txt.html#af88b2d950fae19ab641bd1690e08445c">n</a>),<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>));</div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;    }</div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;  }</div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160; </div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160; <span class="comment">//Loop over the internal data</span></div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160; <span class="keywordtype">unsigned</span> n_internal = this-&gt;<a class="code" href="classoomph_1_1GeneralisedElement.html#a6b736de0af4c92831968636479b3480e">ninternal_data</a>();</div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160; <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l=0;l&lt;n_internal;l++)</div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;  {</div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;   <span class="keywordtype">unsigned</span> nval=this-&gt;<a class="code" href="classoomph_1_1GeneralisedElement.html#a45e32d895d4b3686e0f15fe455f4ed44">internal_data_pt</a>(l)-&gt;<a class="code" href="classoomph_1_1Data.html#a7e67fc78a2e8a2fd6eb75bd292d42ff8">nvalue</a>();</div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;   <span class="comment">//Add internal data</span></div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j=0;j&lt;nval;j++)</div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;    {</div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;     paired_load_data.insert(std::make_pair(this-&gt;<a class="code" href="classoomph_1_1GeneralisedElement.html#a45e32d895d4b3686e0f15fe455f4ed44">internal_data_pt</a>(l),j));</div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;    }</div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;  }</div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;}</div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;<span class="comment">///////////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;<span class="comment">///////////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;<span class="comment">///////////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;<span class="comment">//2D Taylor--Hood</span></div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;<span class="comment">//Set the data for the number of Variables at each node</span></div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <a class="code" href="classoomph_1_1PolarTaylorHoodElement.html#a4db1fda841168bbf5889e060b52f4344">PolarTaylorHoodElement::Initial_Nvalue</a>[9]={3,2,3,2,2,2,3,2,3};</div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160; </div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;<span class="comment">//Set the data for the pressure conversion array</span></div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <a class="code" href="classoomph_1_1PolarTaylorHoodElement.html#a4804e4bdf732b17cdb7e55aebaebcab0">PolarTaylorHoodElement::Pconv</a>[4]={0,2,6,8};</div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160; </div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;<span class="comment">//=========================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;<span class="comment">/// Add pointers to Data and the indices of the values </span></div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;<span class="comment">/// that affect the potential load (traction) applied</span></div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;<span class="comment">/// to the SolidElements to the set  paired_load_data. </span></div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;<span class="comment"></span><span class="comment">//=========================================================================</span></div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classoomph_1_1PolarTaylorHoodElement.html#a0a432b5a93ca2e789992ec77d050f49a">PolarTaylorHoodElement::</a></div>
<div class="line"><a name="l01577"></a><span class="lineno"><a class="line" href="classoomph_1_1PolarTaylorHoodElement.html#a0a432b5a93ca2e789992ec77d050f49a"> 1577</a></span>&#160;<a class="code" href="classoomph_1_1PolarTaylorHoodElement.html#a0a432b5a93ca2e789992ec77d050f49a">get_load_data</a>(std::set&lt;std::pair&lt;Data*,unsigned&gt; &gt; &amp;paired_load_data)</div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;{</div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160; <span class="comment">//Loop over the nodes</span></div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160; <span class="keywordtype">unsigned</span> n_node = this-&gt;<a class="code" href="classoomph_1_1FiniteElement.html#a6219ed269a6d89b5aa14659cce48905a">nnode</a>();</div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160; <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="the__data__structure_8txt.html#af88b2d950fae19ab641bd1690e08445c">n</a>=0;<a class="code" href="the__data__structure_8txt.html#af88b2d950fae19ab641bd1690e08445c">n</a>&lt;n_node;<a class="code" href="the__data__structure_8txt.html#af88b2d950fae19ab641bd1690e08445c">n</a>++)</div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;  {</div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;   <span class="comment">//Loop over the velocity components and add pointer to their data</span></div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;   <span class="comment">//and indices to the vectors</span></div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;2;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;    {</div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;     paired_load_data.insert(std::make_pair(this-&gt;<a class="code" href="classoomph_1_1FiniteElement.html#ace0e7fb72a805b5c2c600347bfae7a9b">node_pt</a>(<a class="code" href="the__data__structure_8txt.html#af88b2d950fae19ab641bd1690e08445c">n</a>),<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>));</div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;    }</div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;  }</div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160; </div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160; <span class="comment">//Loop over the pressure data</span></div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160; <span class="keywordtype">unsigned</span> n_pres= <a class="code" href="classoomph_1_1PolarTaylorHoodElement.html#a4ffb1ba7522ccb0d2fb181faa5bdf79b">npres_pnst</a>();</div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160; <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l=0;l&lt;n_pres;l++)</div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;  {</div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;   <span class="comment">//The 2th entry in each nodal data is the pressure, which</span></div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;   <span class="comment">//affects the traction</span></div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;   paired_load_data.insert(std::make_pair(this-&gt;<a class="code" href="classoomph_1_1FiniteElement.html#ace0e7fb72a805b5c2c600347bfae7a9b">node_pt</a>(<a class="code" href="classoomph_1_1PolarTaylorHoodElement.html#a4804e4bdf732b17cdb7e55aebaebcab0">Pconv</a>[l]),2));</div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;  }</div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;}</div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160; </div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;<span class="comment">//========================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;<span class="comment">/// Compute traction at local coordinate s for outer unit normal N</span></div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;<span class="comment"></span><span class="comment">//========================================================================</span></div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;<span class="comment">//template&lt;unsigned 2&gt;</span></div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;<span class="comment">//void PolarTaylorHoodElement::get_traction(const Vector&lt;double&gt;&amp; s, </span></div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;<span class="comment">//                                      const Vector&lt;double&gt;&amp; N, </span></div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;<span class="comment">//                                      Vector&lt;double&gt;&amp; traction)</span></div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;<span class="comment">//{</span></div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;<span class="comment">// PolarNavierStokesEquations::traction(s,N,traction);</span></div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;<span class="comment">//}</span></div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160; </div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;}</div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="aclassoomph_1_1FiniteElement_html_ace0e7fb72a805b5c2c600347bfae7a9b"><div class="ttname"><a href="classoomph_1_1FiniteElement.html#ace0e7fb72a805b5c2c600347bfae7a9b">oomph::FiniteElement::node_pt</a></div><div class="ttdeci">Node *&amp; node_pt(const unsigned &amp;n)</div><div class="ttdoc">Return a pointer to the local node n.</div><div class="ttdef"><b>Definition:</b> <a href="elements_8h_source.html#l02122">elements.h:2122</a></div></div>
<div class="ttc" id="aclassoomph_1_1PolarNavierStokesEquations_html_a72787983b9bcc07aafb46d5f7a2e592d"><div class="ttname"><a href="classoomph_1_1PolarNavierStokesEquations.html#a72787983b9bcc07aafb46d5f7a2e592d">oomph::PolarNavierStokesEquations::output_fct</a></div><div class="ttdeci">void output_fct(std::ostream &amp;outfile, const unsigned &amp;nplot, FiniteElement::SteadyExactSolutionFctPt exact_soln_pt)</div><div class="ttdoc">Output exact solution specified via function pointer at a given number of plot points....</div><div class="ttdef"><b>Definition:</b> <a href="polar__navier__stokes__elements_8cc_source.html#l00219">polar_navier_stokes_elements.cc:219</a></div></div>
<div class="ttc" id="aclassoomph_1_1PolarNavierStokesEquations_html_a5d46a1417439c7abd56219f8a538a63a"><div class="ttname"><a href="classoomph_1_1PolarNavierStokesEquations.html#a5d46a1417439c7abd56219f8a538a63a">oomph::PolarNavierStokesEquations::strain_rate</a></div><div class="ttdeci">void strain_rate(const Vector&lt; double &gt; &amp;s, DenseMatrix&lt; double &gt; &amp;strain_rate) const</div><div class="ttdoc">Strain-rate tensor: Now returns polar strain.</div><div class="ttdef"><b>Definition:</b> <a href="polar__navier__stokes__elements_8cc_source.html#l00840">polar_navier_stokes_elements.cc:840</a></div></div>
<div class="ttc" id="aclassoomph_1_1PolarNavierStokesEquations_html_aa478578286aece66720cbd841f450ba0"><div class="ttname"><a href="classoomph_1_1PolarNavierStokesEquations.html#aa478578286aece66720cbd841f450ba0">oomph::PolarNavierStokesEquations::u_index_pnst</a></div><div class="ttdeci">virtual unsigned u_index_pnst(const unsigned &amp;i) const</div><div class="ttdoc">Return the index at which the i-th unknown velocity component.</div><div class="ttdef"><b>Definition:</b> <a href="polar__navier__stokes__elements_8h_source.html#l00329">polar_navier_stokes_elements.h:329</a></div></div>
<div class="ttc" id="aclassoomph_1_1PolarNavierStokesEquations_html_ac6c31807b4f2edd3f00965b11b2a0622"><div class="ttname"><a href="classoomph_1_1PolarNavierStokesEquations.html#ac6c31807b4f2edd3f00965b11b2a0622">oomph::PolarNavierStokesEquations::du_dt_pnst</a></div><div class="ttdeci">double du_dt_pnst(const unsigned &amp;n, const unsigned &amp;i) const</div><div class="ttdoc">i-th component of du/dt at local node n. Uses suitably interpolated value for hanging nodes.</div><div class="ttdef"><b>Definition:</b> <a href="polar__navier__stokes__elements_8h_source.html#l00333">polar_navier_stokes_elements.h:333</a></div></div>
<div class="ttc" id="athe__data__structure_8txt_html_a5448c72da3359c7796cf0c5f800732a1"><div class="ttname"><a href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a></div><div class="ttdeci">and code FiniteElement::J_eulerian(...) \endcode returns the Jacobian of the mapping from Eulerian coordinates to local coordinates. - The function \c GeneralisedElement c QElement&lt; 3, 2 &gt; is an node brick element with a trilinear mapping between and global coordinates The dimension and the number of c Nodes must be set by calling the appropriate c set_ functions in the see ref set_commands above The most important member functions implemented at this level include Functions that evaluate the shape in terms of the c FiniteElement s coordinates functions that determine whether a c Node is located at a particular coordinate Output functions that allow the element shapes to be plotted we specify a pointer to a spatial integration the default assignment can be over written at a higher level This is discussed in more detail in a&lt; A HREF=&quot;../../optimisation/html/index.html&quot;&gt; separate document&lt;/A &gt; subsubsection Maths_Element we implement the equations that are represented by the specific element We implement the employing either the geometric shape functions that already exist on or employing additional shape functions defined at this level This allows us to write further member functions such as c interpolated_u(...)</div></div>
<div class="ttc" id="aclassoomph_1_1FiniteElement_html_a8ed563c7ff0cfd8bafdbb0132b388106"><div class="ttname"><a href="classoomph_1_1FiniteElement.html#a8ed563c7ff0cfd8bafdbb0132b388106">oomph::FiniteElement::nplot_points</a></div><div class="ttdeci">virtual unsigned nplot_points(const unsigned &amp;nplot) const</div><div class="ttdoc">Return total number of plot points (when plotting nplot points in each &quot;coordinate direction&quot;)</div><div class="ttdef"><b>Definition:</b> <a href="elements_8h_source.html#l03045">elements.h:3045</a></div></div>
<div class="ttc" id="aclassoomph_1_1PolarNavierStokesEquations_html_a058dc7463bf84d85eebf98a32037adb4"><div class="ttname"><a href="classoomph_1_1PolarNavierStokesEquations.html#a058dc7463bf84d85eebf98a32037adb4">oomph::PolarNavierStokesEquations::dissipation</a></div><div class="ttdeci">double dissipation() const</div><div class="ttdoc">Return integral of dissipation over element.</div><div class="ttdef"><b>Definition:</b> <a href="polar__navier__stokes__elements_8cc_source.html#l00735">polar_navier_stokes_elements.cc:735</a></div></div>
<div class="ttc" id="aclassoomph_1_1FiniteElement_html_adcd3fe593044db9afae4c15f85ebb175"><div class="ttname"><a href="classoomph_1_1FiniteElement.html#adcd3fe593044db9afae4c15f85ebb175">oomph::FiniteElement::dnodal_position_dt</a></div><div class="ttdeci">double dnodal_position_dt(const unsigned &amp;n, const unsigned &amp;i) const</div><div class="ttdoc">Return the i-th component of nodal velocity: dx/dt at local node n.</div><div class="ttdef"><b>Definition:</b> <a href="elements_8h_source.html#l02251">elements.h:2251</a></div></div>
<div class="ttc" id="athe__data__structure_8txt_html_a1400a973def57b85051cfe1070be1810"><div class="ttname"><a href="the__data__structure_8txt.html#a1400a973def57b85051cfe1070be1810">residuals</a></div><div class="ttdeci">endcode The default implementation of c the simplest possible implementation of a new element requires only the specification of c we need to know which c Data affects the residuals(and hence the Jacobian matrix). For a \c GeneralisedElement such \c Data exists in two forms</div></div>
<div class="ttc" id="aclassoomph_1_1PolarNavierStokesEquations_html_abe241e9deab5ea6f3b4059a63c19ec3d"><div class="ttname"><a href="classoomph_1_1PolarNavierStokesEquations.html#abe241e9deab5ea6f3b4059a63c19ec3d">oomph::PolarNavierStokesEquations::full_output</a></div><div class="ttdeci">void full_output(std::ostream &amp;outfile)</div><div class="ttdoc">Full output function: x,y,[z],u,v,[w],p,du/dt,dv/dt,[dw/dt],dissipation in tecplot format....</div><div class="ttdef"><b>Definition:</b> <a href="polar__navier__stokes__elements_8h_source.html#l00430">polar_navier_stokes_elements.h:430</a></div></div>
<div class="ttc" id="aclassoomph_1_1PolarNavierStokesEquations_html_a1e9cfddfe57aa786569129ea22c637b0"><div class="ttname"><a href="classoomph_1_1PolarNavierStokesEquations.html#a1e9cfddfe57aa786569129ea22c637b0">oomph::PolarNavierStokesEquations::kin_energy</a></div><div class="ttdeci">double kin_energy() const</div><div class="ttdoc">Get integral of kinetic energy over element.</div><div class="ttdef"><b>Definition:</b> <a href="polar__navier__stokes__elements_8cc_source.html#l01015">polar_navier_stokes_elements.cc:1015</a></div></div>
<div class="ttc" id="aclassoomph_1_1GeneralisedElement_html_a45e32d895d4b3686e0f15fe455f4ed44"><div class="ttname"><a href="classoomph_1_1GeneralisedElement.html#a45e32d895d4b3686e0f15fe455f4ed44">oomph::GeneralisedElement::internal_data_pt</a></div><div class="ttdeci">Data *&amp; internal_data_pt(const unsigned &amp;i)</div><div class="ttdoc">Return a pointer to i-th internal data object.</div><div class="ttdef"><b>Definition:</b> <a href="elements_8h_source.html#l00619">elements.h:619</a></div></div>
<div class="ttc" id="aclassoomph_1_1PolarNavierStokesEquations_html_af66cafead00372b56b677ab40a184d1f"><div class="ttname"><a href="classoomph_1_1PolarNavierStokesEquations.html#af66cafead00372b56b677ab40a184d1f">oomph::PolarNavierStokesEquations::npres_pnst</a></div><div class="ttdeci">virtual unsigned npres_pnst() const =0</div><div class="ttdoc">Function to return number of pressure degrees of freedom.</div></div>
<div class="ttc" id="aclassoomph_1_1OomphLibError_html"><div class="ttname"><a href="classoomph_1_1OomphLibError.html">oomph::OomphLibError</a></div><div class="ttdef"><b>Definition:</b> <a href="oomph__definitions_8h_source.html#l00225">oomph_definitions.h:225</a></div></div>
<div class="ttc" id="aclassoomph_1_1PolarNavierStokesEquations_html_ac0de4c87dc0440dad909f044a5a99080"><div class="ttname"><a href="classoomph_1_1PolarNavierStokesEquations.html#ac0de4c87dc0440dad909f044a5a99080">oomph::PolarNavierStokesEquations::re</a></div><div class="ttdeci">const double &amp; re() const</div><div class="ttdoc">Reynolds number.</div><div class="ttdef"><b>Definition:</b> <a href="polar__navier__stokes__elements_8h_source.html#l00254">polar_navier_stokes_elements.h:254</a></div></div>
<div class="ttc" id="aclassoomph_1_1FiniteElement_html_a5a9c1ead9819cd17603096e63087020f"><div class="ttname"><a href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">oomph::FiniteElement::interpolated_x</a></div><div class="ttdeci">virtual double interpolated_x(const Vector&lt; double &gt; &amp;s, const unsigned &amp;i) const</div><div class="ttdoc">Return FE interpolated coordinate x[i] at local coordinate s.</div><div class="ttdef"><b>Definition:</b> <a href="elements_8cc_source.html#l03877">elements.cc:3877</a></div></div>
<div class="ttc" id="aclassoomph_1_1FiniteElement_html_a089e58d5ad9b8efee637221b0e264563"><div class="ttname"><a href="classoomph_1_1FiniteElement.html#a089e58d5ad9b8efee637221b0e264563">oomph::FiniteElement::J_eulerian</a></div><div class="ttdeci">virtual double J_eulerian(const Vector&lt; double &gt; &amp;s) const</div><div class="ttdoc">Return the Jacobian of mapping from local to global coordinates at local position s.</div><div class="ttdef"><b>Definition:</b> <a href="the__data__structure_8txt_source.html#l00540">the_data_structure.txt:540</a></div></div>
<div class="ttc" id="aclassoomph_1_1FiniteElement_html_a690fd33af26cc3e84f39bba6d5a85202"><div class="ttname"><a href="classoomph_1_1FiniteElement.html#a690fd33af26cc3e84f39bba6d5a85202">oomph::FiniteElement::SteadyExactSolutionFctPt</a></div><div class="ttdeci">void(* SteadyExactSolutionFctPt)(const Vector&lt; double &gt; &amp;, Vector&lt; double &gt; &amp;)</div><div class="ttdoc">Function pointer for function that computes vector-valued steady &quot;exact solution&quot;  as .</div><div class="ttdef"><b>Definition:</b> <a href="elements_8h_source.html#l01736">elements.h:1736</a></div></div>
<div class="ttc" id="aclassoomph_1_1GeneralisedElement_html_a6b736de0af4c92831968636479b3480e"><div class="ttname"><a href="classoomph_1_1GeneralisedElement.html#a6b736de0af4c92831968636479b3480e">oomph::GeneralisedElement::ninternal_data</a></div><div class="ttdeci">unsigned ninternal_data() const</div><div class="ttdoc">Return the number of internal data objects.</div><div class="ttdef"><b>Definition:</b> <a href="elements_8h_source.html#l00824">elements.h:824</a></div></div>
<div class="ttc" id="aclassoomph_1_1FiniteElement_html_a9296c17b134688049256a4bbc886df69"><div class="ttname"><a href="classoomph_1_1FiniteElement.html#a9296c17b134688049256a4bbc886df69">oomph::FiniteElement::dshape_eulerian</a></div><div class="ttdeci">double dshape_eulerian(const Vector&lt; double &gt; &amp;s, Shape &amp;psi, DShape &amp;dpsidx) const</div><div class="ttdoc">Compute the geometric shape functions and also first derivatives w.r.t. global coordinates at local c...</div><div class="ttdef"><b>Definition:</b> <a href="elements_8cc_source.html#l03223">elements.cc:3223</a></div></div>
<div class="ttc" id="aclassoomph_1_1FiniteElement_html_ac3987a5ead7dc20c63d86b333466e2b5"><div class="ttname"><a href="classoomph_1_1FiniteElement.html#ac3987a5ead7dc20c63d86b333466e2b5">oomph::FiniteElement::write_tecplot_zone_footer</a></div><div class="ttdeci">virtual void write_tecplot_zone_footer(std::ostream &amp;outfile, const unsigned &amp;nplot) const</div><div class="ttdoc">Add tecplot zone &quot;footer&quot; to output stream (when plotting nplot points in each &quot;coordinate direction&quot;...</div><div class="ttdef"><b>Definition:</b> <a href="elements_8h_source.html#l03031">elements.h:3031</a></div></div>
<div class="ttc" id="aclassoomph_1_1PolarTaylorHoodElement_html_a0a432b5a93ca2e789992ec77d050f49a"><div class="ttname"><a href="classoomph_1_1PolarTaylorHoodElement.html#a0a432b5a93ca2e789992ec77d050f49a">oomph::PolarTaylorHoodElement::get_load_data</a></div><div class="ttdeci">void get_load_data(std::set&lt; std::pair&lt; Data *, unsigned &gt; &gt; &amp;paired_load_data)</div><div class="ttdoc">Add to the set paired_load_data pairs of pointers to data objects and unsigned integers that index th...</div><div class="ttdef"><b>Definition:</b> <a href="polar__navier__stokes__elements_8cc_source.html#l01577">polar_navier_stokes_elements.cc:1577</a></div></div>
<div class="ttc" id="aclassoomph_1_1Integral_html_a1a270de9d99a1fcf1d25a6c1017f65fa"><div class="ttname"><a href="classoomph_1_1Integral.html#a1a270de9d99a1fcf1d25a6c1017f65fa">oomph::Integral::nweight</a></div><div class="ttdeci">virtual unsigned nweight() const =0</div><div class="ttdoc">Return the number of integration points of the scheme.</div></div>
<div class="ttc" id="aclassoomph_1_1DenseMatrix_html_a9937181f1cb4cfaed7aaf3b483c42456"><div class="ttname"><a href="classoomph_1_1DenseMatrix.html#a9937181f1cb4cfaed7aaf3b483c42456">oomph::DenseMatrix::ncol</a></div><div class="ttdeci">unsigned long ncol() const</div><div class="ttdoc">Return the number of columns of the matrix.</div><div class="ttdef"><b>Definition:</b> <a href="matrices_8h_source.html#l00503">matrices.h:503</a></div></div>
<div class="ttc" id="apolar__navier__stokes__elements_8h_html"><div class="ttname"><a href="polar__navier__stokes__elements_8h.html">polar_navier_stokes_elements.h</a></div></div>
<div class="ttc" id="aclassoomph_1_1PolarNavierStokesEquations_html_a4b8d739e7ab84c6631042bc3bd8c6d9f"><div class="ttname"><a href="classoomph_1_1PolarNavierStokesEquations.html#a4b8d739e7ab84c6631042bc3bd8c6d9f">oomph::PolarNavierStokesEquations::Default_Physical_Ratio_Value</a></div><div class="ttdeci">static double Default_Physical_Ratio_Value</div><div class="ttdoc">Static default value for the physical ratios (all are initialised to one)</div><div class="ttdef"><b>Definition:</b> <a href="polar__navier__stokes__elements_8h_source.html#l00134">polar_navier_stokes_elements.h:134</a></div></div>
<div class="ttc" id="aclassoomph_1_1Data_html_a7e67fc78a2e8a2fd6eb75bd292d42ff8"><div class="ttname"><a href="classoomph_1_1Data.html#a7e67fc78a2e8a2fd6eb75bd292d42ff8">oomph::Data::nvalue</a></div><div class="ttdeci">unsigned nvalue() const</div><div class="ttdoc">Return number of values stored in data object (incl pinned ones).</div><div class="ttdef"><b>Definition:</b> <a href="nodes_8h_source.html#l00444">nodes.h:444</a></div></div>
<div class="ttc" id="aclassoomph_1_1FiniteElement_html_a9152c16ae9899168bcdaac7c2f977444"><div class="ttname"><a href="classoomph_1_1FiniteElement.html#a9152c16ae9899168bcdaac7c2f977444">oomph::FiniteElement::nodal_position</a></div><div class="ttdeci">double nodal_position(const unsigned &amp;n, const unsigned &amp;i) const</div><div class="ttdoc">Return the i-th coordinate at local node n. If the node is hanging, the appropriate interpolation is ...</div><div class="ttdef"><b>Definition:</b> <a href="elements_8h_source.html#l02240">elements.h:2240</a></div></div>
<div class="ttc" id="aclassoomph_1_1DenseMatrix_html"><div class="ttname"><a href="classoomph_1_1DenseMatrix.html">oomph::DenseMatrix&lt; double &gt;</a></div></div>
<div class="ttc" id="aclassoomph_1_1PolarCrouzeixRaviartElement_html_a575257c6dc7b44e56c687066cbda3791"><div class="ttname"><a href="classoomph_1_1PolarCrouzeixRaviartElement.html#a575257c6dc7b44e56c687066cbda3791">oomph::PolarCrouzeixRaviartElement::get_load_data</a></div><div class="ttdeci">void get_load_data(std::set&lt; std::pair&lt; Data *, unsigned &gt; &gt; &amp;paired_load_data)</div><div class="ttdoc">Add to the set paired_load_data pairs of pointers to data objects and unsigned integers that index th...</div><div class="ttdef"><b>Definition:</b> <a href="polar__navier__stokes__elements_8cc_source.html#l01533">polar_navier_stokes_elements.cc:1533</a></div></div>
<div class="ttc" id="aclassoomph_1_1PolarCrouzeixRaviartElement_html_a36edbd6c9a877d4da2c99d5e70691c34"><div class="ttname"><a href="classoomph_1_1PolarCrouzeixRaviartElement.html#a36edbd6c9a877d4da2c99d5e70691c34">oomph::PolarCrouzeixRaviartElement::required_nvalue</a></div><div class="ttdeci">virtual unsigned required_nvalue(const unsigned &amp;n) const</div><div class="ttdoc">Number of values (pinned or dofs) required at local node n.</div><div class="ttdef"><b>Definition:</b> <a href="polar__navier__stokes__elements_8cc_source.html#l01523">polar_navier_stokes_elements.cc:1523</a></div></div>
<div class="ttc" id="aclassoomph_1_1PolarNavierStokesEquations_html_afcc85389a45dfa0e811852012fc40442"><div class="ttname"><a href="classoomph_1_1PolarNavierStokesEquations.html#afcc85389a45dfa0e811852012fc40442">oomph::PolarNavierStokesEquations::interpolated_p_pnst</a></div><div class="ttdeci">double interpolated_p_pnst(const Vector&lt; double &gt; &amp;s) const</div><div class="ttdoc">Return FE interpolated pressure at local coordinate s.</div><div class="ttdef"><b>Definition:</b> <a href="polar__navier__stokes__elements_8h_source.html#l00611">polar_navier_stokes_elements.h:611</a></div></div>
<div class="ttc" id="acfortran_8h_html_af6f0bd3dc13317f895c91323c25c2b8f"><div class="ttname"><a href="cfortran_8h.html#af6f0bd3dc13317f895c91323c25c2b8f">t</a></div><div class="ttdeci">char t</div><div class="ttdef"><b>Definition:</b> <a href="cfortran_8h_source.html#l00568">cfortran.h:568</a></div></div>
<div class="ttc" id="aclassoomph_1_1PolarNavierStokesEquations_html_a969a6d8caaa879136a4fb6ed00cc6cf2"><div class="ttname"><a href="classoomph_1_1PolarNavierStokesEquations.html#a969a6d8caaa879136a4fb6ed00cc6cf2">oomph::PolarNavierStokesEquations::strain_rate_by_r</a></div><div class="ttdeci">void strain_rate_by_r(const Vector&lt; double &gt; &amp;s, DenseMatrix&lt; double &gt; &amp;strain_rate) const</div><div class="ttdoc">Function to return polar strain multiplied by r.</div><div class="ttdef"><b>Definition:</b> <a href="polar__navier__stokes__elements_8cc_source.html#l00923">polar_navier_stokes_elements.cc:923</a></div></div>
<div class="ttc" id="aclassoomph_1_1PolarNavierStokesEquations_html_a3370b89e66379cb0b53417db39357e77"><div class="ttname"><a href="classoomph_1_1PolarNavierStokesEquations.html#a3370b89e66379cb0b53417db39357e77">oomph::PolarNavierStokesEquations::Gamma</a></div><div class="ttdeci">static Vector&lt; double &gt; Gamma</div><div class="ttdoc">Vector to decide whether the stress-divergence form is used or not.</div><div class="ttdef"><b>Definition:</b> <a href="polar__navier__stokes__elements_8h_source.html#l00249">polar_navier_stokes_elements.h:249</a></div></div>
<div class="ttc" id="anamespaceoomph_1_1QuadTreeNames_html_a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6"><div class="ttname"><a href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">oomph::QuadTreeNames::W</a></div><div class="ttdeci">@ W</div><div class="ttdef"><b>Definition:</b> <a href="quadtree_8h_source.html#l00056">quadtree.h:56</a></div></div>
<div class="ttc" id="aclassoomph_1_1FiniteElement_html_a82da844fd3ebb2005842464cdc148a03"><div class="ttname"><a href="classoomph_1_1FiniteElement.html#a82da844fd3ebb2005842464cdc148a03">oomph::FiniteElement::get_s_plot</a></div><div class="ttdeci">virtual void get_s_plot(const unsigned &amp;i, const unsigned &amp;nplot, Vector&lt; double &gt; &amp;s, const bool &amp;shifted_to_interior=false) const</div><div class="ttdoc">Get cector of local coordinates of plot point i (when plotting nplot points in each &quot;coordinate direc...</div><div class="ttdef"><b>Definition:</b> <a href="elements_8h_source.html#l03006">elements.h:3006</a></div></div>
<div class="ttc" id="aclassoomph_1_1PolarNavierStokesEquations_html_ae4bfb7b4c54bf5558111f84119f530d0"><div class="ttname"><a href="classoomph_1_1PolarNavierStokesEquations.html#ae4bfb7b4c54bf5558111f84119f530d0">oomph::PolarNavierStokesEquations::u_pnst</a></div><div class="ttdeci">virtual double u_pnst(const unsigned &amp;n, const unsigned &amp;i) const =0</div><div class="ttdoc">Velocity i at local node n. Uses suitably interpolated value for hanging nodes.</div></div>
<div class="ttc" id="aclassoomph_1_1PolarNavierStokesEquations_html_a960e2b96a00d4f29f91aeef9dafb1bdb"><div class="ttname"><a href="classoomph_1_1PolarNavierStokesEquations.html#a960e2b96a00d4f29f91aeef9dafb1bdb">oomph::PolarNavierStokesEquations::output_veloc</a></div><div class="ttdeci">void output_veloc(std::ostream &amp;outfile, const unsigned &amp;nplot, const unsigned &amp;t)</div><div class="ttdoc">Output function: x,y,[z],u,v,[w] in tecplot format. nplot points in each coordinate direction at time...</div><div class="ttdef"><b>Definition:</b> <a href="polar__navier__stokes__elements_8cc_source.html#l00336">polar_navier_stokes_elements.cc:336</a></div></div>
<div class="ttc" id="aclassoomph_1_1Integral_html_a1a2122f99a87c18649bafdd9ed739758"><div class="ttname"><a href="classoomph_1_1Integral.html#a1a2122f99a87c18649bafdd9ed739758">oomph::Integral::knot</a></div><div class="ttdeci">virtual double knot(const unsigned &amp;i, const unsigned &amp;j) const =0</div><div class="ttdoc">Return local coordinate s[j] of i-th integration point.</div></div>
<div class="ttc" id="aclassoomph_1_1PolarNavierStokesEquations_html_a535d5104145a0ebb128c850c5d87d3c4"><div class="ttname"><a href="classoomph_1_1PolarNavierStokesEquations.html#a535d5104145a0ebb128c850c5d87d3c4">oomph::PolarNavierStokesEquations::get_traction</a></div><div class="ttdeci">void get_traction(const Vector&lt; double &gt; &amp;s, const Vector&lt; double &gt; &amp;N, Vector&lt; double &gt; &amp;traction)</div><div class="ttdoc">Compute traction (on the viscous scale) at local coordinate s for outer unit normal N.</div><div class="ttdef"><b>Definition:</b> <a href="polar__navier__stokes__elements_8cc_source.html#l00789">polar_navier_stokes_elements.cc:789</a></div></div>
<div class="ttc" id="aclassoomph_1_1PolarNavierStokesEquations_html_a720f9b13abd3bf876793f1f9e8538f61"><div class="ttname"><a href="classoomph_1_1PolarNavierStokesEquations.html#a720f9b13abd3bf876793f1f9e8538f61">oomph::PolarNavierStokesEquations::output</a></div><div class="ttdeci">void output(std::ostream &amp;outfile)</div><div class="ttdoc">Output functionget_vels(const Vector&lt;double&gt;&amp; x_to_get, Vector&lt;double&gt;&amp; vels): x,y,...</div><div class="ttdef"><b>Definition:</b> <a href="polar__navier__stokes__elements_8h_source.html#l00405">polar_navier_stokes_elements.h:405</a></div></div>
<div class="ttc" id="aclassoomph_1_1FiniteElement_html_ad4ecf2b61b158a4b4d351a60d23c633e"><div class="ttname"><a href="classoomph_1_1FiniteElement.html#ad4ecf2b61b158a4b4d351a60d23c633e">oomph::FiniteElement::UnsteadyExactSolutionFctPt</a></div><div class="ttdeci">void(* UnsteadyExactSolutionFctPt)(const double &amp;, const Vector&lt; double &gt; &amp;, Vector&lt; double &gt; &amp;)</div><div class="ttdoc">Function pointer for function that computes Vector-valued time-dependent function  as .</div><div class="ttdef"><b>Definition:</b> <a href="elements_8h_source.html#l01742">elements.h:1742</a></div></div>
<div class="ttc" id="aclassoomph_1_1FiniteElement_html_a79f1710873332823c47023d370f0596b"><div class="ttname"><a href="classoomph_1_1FiniteElement.html#a79f1710873332823c47023d370f0596b">oomph::FiniteElement::integral_pt</a></div><div class="ttdeci">Integral *const &amp; integral_pt() const</div><div class="ttdoc">Return the pointer to the integration scheme (const version)</div><div class="ttdef"><b>Definition:</b> <a href="elements_8h_source.html#l01921">elements.h:1921</a></div></div>
<div class="ttc" id="aclassoomph_1_1PolarNavierStokesEquations_html_ac539e938a5a877e708e2af0d84ca4edb"><div class="ttname"><a href="classoomph_1_1PolarNavierStokesEquations.html#ac539e938a5a877e708e2af0d84ca4edb">oomph::PolarNavierStokesEquations::re_st</a></div><div class="ttdeci">const double &amp; re_st() const</div><div class="ttdoc">Product of Reynolds and Strouhal number (=Womersley number)</div><div class="ttdef"><b>Definition:</b> <a href="polar__navier__stokes__elements_8h_source.html#l00260">polar_navier_stokes_elements.h:260</a></div></div>
<div class="ttc" id="aclassoomph_1_1PolarNavierStokesEquations_html_a1b382bf38d7b7041417bbc91ad85b38f"><div class="ttname"><a href="classoomph_1_1PolarNavierStokesEquations.html#a1b382bf38d7b7041417bbc91ad85b38f">oomph::PolarNavierStokesEquations::pshape_pnst</a></div><div class="ttdeci">virtual void pshape_pnst(const Vector&lt; double &gt; &amp;s, Shape &amp;psi) const =0</div><div class="ttdoc">Compute the pressure shape functions at local coordinate s.</div></div>
<div class="ttc" id="aclassoomph_1_1PolarTaylorHoodElement_html_a4ffb1ba7522ccb0d2fb181faa5bdf79b"><div class="ttname"><a href="classoomph_1_1PolarTaylorHoodElement.html#a4ffb1ba7522ccb0d2fb181faa5bdf79b">oomph::PolarTaylorHoodElement::npres_pnst</a></div><div class="ttdeci">unsigned npres_pnst() const</div><div class="ttdoc">Return number of pressure values.</div><div class="ttdef"><b>Definition:</b> <a href="polar__navier__stokes__elements_8h_source.html#l00957">polar_navier_stokes_elements.h:957</a></div></div>
<div class="ttc" id="anamespaceoomph_html"><div class="ttname"><a href="namespaceoomph.html">oomph</a></div><div class="ttdoc">DRAIG: Change all instances of (SPATIAL_DIM) to (DIM-1).</div><div class="ttdef"><b>Definition:</b> <a href="advection__diffusion__elements_8cc_source.html#l00029">advection_diffusion_elements.cc:29</a></div></div>
<div class="ttc" id="aclassoomph_1_1FiniteElement_html_a6219ed269a6d89b5aa14659cce48905a"><div class="ttname"><a href="classoomph_1_1FiniteElement.html#a6219ed269a6d89b5aa14659cce48905a">oomph::FiniteElement::nnode</a></div><div class="ttdeci">unsigned nnode() const</div><div class="ttdoc">Return the number of nodes.</div><div class="ttdef"><b>Definition:</b> <a href="elements_8h_source.html#l02159">elements.h:2159</a></div></div>
<div class="ttc" id="aclassoomph_1_1Vector_html"><div class="ttname"><a href="classoomph_1_1Vector.html">oomph::Vector&lt; double &gt;</a></div></div>
<div class="ttc" id="aclassoomph_1_1PolarCrouzeixRaviartElement_html_aed13ef3c1adcea8f31184f91dedaff28"><div class="ttname"><a href="classoomph_1_1PolarCrouzeixRaviartElement.html#aed13ef3c1adcea8f31184f91dedaff28">oomph::PolarCrouzeixRaviartElement::Initial_Nvalue</a></div><div class="ttdeci">static const unsigned Initial_Nvalue[]</div><div class="ttdoc">Static array of ints to hold required number of variables at nodes.</div><div class="ttdef"><b>Definition:</b> <a href="polar__navier__stokes__elements_8h_source.html#l00680">polar_navier_stokes_elements.h:680</a></div></div>
<div class="ttc" id="aclassoomph_1_1PolarNavierStokesEquations_html_a4bde38e6f8a429c4e3da7c3ce273045e"><div class="ttname"><a href="classoomph_1_1PolarNavierStokesEquations.html#a4bde38e6f8a429c4e3da7c3ce273045e">oomph::PolarNavierStokesEquations::alpha</a></div><div class="ttdeci">const double &amp; alpha() const</div><div class="ttdoc">Alpha.</div><div class="ttdef"><b>Definition:</b> <a href="polar__navier__stokes__elements_8h_source.html#l00257">polar_navier_stokes_elements.h:257</a></div></div>
<div class="ttc" id="aclassoomph_1_1FiniteElement_html_a58a25b6859ddd43b7bfe64a19fee5023"><div class="ttname"><a href="classoomph_1_1FiniteElement.html#a58a25b6859ddd43b7bfe64a19fee5023">oomph::FiniteElement::shape</a></div><div class="ttdeci">virtual void shape(const Vector&lt; double &gt; &amp;s, Shape &amp;psi) const =0</div><div class="ttdoc">Calculate the geometric shape functions at local coordinate s. This function must be overloaded for e...</div></div>
<div class="ttc" id="acfortran_8h_html_adb50e893b86b3e55e751a42eab3cba82"><div class="ttname"><a href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a></div><div class="ttdeci">cstr elem_len * i</div><div class="ttdef"><b>Definition:</b> <a href="cfortran_8h_source.html#l00603">cfortran.h:603</a></div></div>
<div class="ttc" id="aclassoomph_1_1DenseMatrix_html_a1b425094510d833ffe91920747a0a962"><div class="ttname"><a href="classoomph_1_1DenseMatrix.html#a1b425094510d833ffe91920747a0a962">oomph::DenseMatrix::nrow</a></div><div class="ttdeci">unsigned long nrow() const</div><div class="ttdoc">Return the number of rows of the matrix.</div><div class="ttdef"><b>Definition:</b> <a href="matrices_8h_source.html#l00500">matrices.h:500</a></div></div>
<div class="ttc" id="aclassoomph_1_1FiniteElement_html_a3193df31f9ce38e0609d17a8ffb386c6"><div class="ttname"><a href="classoomph_1_1FiniteElement.html#a3193df31f9ce38e0609d17a8ffb386c6">oomph::FiniteElement::tecplot_zone_string</a></div><div class="ttdeci">virtual std::string tecplot_zone_string(const unsigned &amp;nplot) const</div><div class="ttdoc">Return string for tecplot zone header (when plotting nplot points in each &quot;coordinate direction&quot;)</div><div class="ttdef"><b>Definition:</b> <a href="elements_8h_source.html#l03018">elements.h:3018</a></div></div>
<div class="ttc" id="anamespaceoomph_1_1QuadTreeNames_html_a8954a5947b19986b8c4b755bc7639f7dabc60bec4cc294aa2adf92726c6d6823a"><div class="ttname"><a href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7dabc60bec4cc294aa2adf92726c6d6823a">oomph::QuadTreeNames::N</a></div><div class="ttdeci">@ N</div><div class="ttdef"><b>Definition:</b> <a href="quadtree_8h_source.html#l00056">quadtree.h:56</a></div></div>
<div class="ttc" id="aclassoomph_1_1DShape_html"><div class="ttname"><a href="classoomph_1_1DShape.html">oomph::DShape</a></div><div class="ttdef"><b>Definition:</b> <a href="shape_8h_source.html#l00271">shape.h:271</a></div></div>
<div class="ttc" id="aclassoomph_1_1PolarNavierStokesEquations_html_ad95e0de64c45d54690bcc422cd17a1fc"><div class="ttname"><a href="classoomph_1_1PolarNavierStokesEquations.html#ad95e0de64c45d54690bcc422cd17a1fc">oomph::PolarNavierStokesEquations::pressure_integral</a></div><div class="ttdeci">double pressure_integral() const</div><div class="ttdoc">Integral of pressure over element.</div><div class="ttdef"><b>Definition:</b> <a href="polar__navier__stokes__elements_8cc_source.html#l01059">polar_navier_stokes_elements.cc:1059</a></div></div>
<div class="ttc" id="aclassoomph_1_1PolarNavierStokesEquations_html_a8fbf3013addd48f0017c92c5be561f0a"><div class="ttname"><a href="classoomph_1_1PolarNavierStokesEquations.html#a8fbf3013addd48f0017c92c5be561f0a">oomph::PolarNavierStokesEquations::Pressure_not_stored_at_node</a></div><div class="ttdeci">static int Pressure_not_stored_at_node</div><div class="ttdoc">Static &quot;magic&quot; number that indicates that the pressure is not stored at a node.</div><div class="ttdef"><b>Definition:</b> <a href="polar__navier__stokes__elements_8h_source.html#l00128">polar_navier_stokes_elements.h:128</a></div></div>
<div class="ttc" id="athe__data__structure_8txt_html_af88b2d950fae19ab641bd1690e08445c"><div class="ttname"><a href="the__data__structure_8txt.html#af88b2d950fae19ab641bd1690e08445c">n</a></div><div class="ttdeci">endcode We introduce wrapper functions to access function so that we can formulate The Maths in generic terms Rather than referring to the pressure at node c n</div><div class="ttdef"><b>Definition:</b> <a href="the__data__structure_8txt_source.html#l00582">the_data_structure.txt:582</a></div></div>
<div class="ttc" id="aclassoomph_1_1FiniteElement_html_a5da80bbed97543e586f698251d67941d"><div class="ttname"><a href="classoomph_1_1FiniteElement.html#a5da80bbed97543e586f698251d67941d">oomph::FiniteElement::nodal_local_eqn</a></div><div class="ttdeci">int nodal_local_eqn(const unsigned &amp;n, const unsigned &amp;i) const</div><div class="ttdoc">Return the local equation number corresponding to the i-th value at the n-th local node.</div><div class="ttdef"><b>Definition:</b> <a href="elements_8h_source.html#l01399">elements.h:1399</a></div></div>
<div class="ttc" id="aclassoomph_1_1PolarNavierStokesEquations_html_a8be5c9ef3e825dac154d8cf41448978d"><div class="ttname"><a href="classoomph_1_1PolarNavierStokesEquations.html#a8be5c9ef3e825dac154d8cf41448978d">oomph::PolarNavierStokesEquations::Default_Gravity_vector</a></div><div class="ttdeci">static Vector&lt; double &gt; Default_Gravity_vector</div><div class="ttdoc">Static default value for the gravity vector.</div><div class="ttdef"><b>Definition:</b> <a href="polar__navier__stokes__elements_8h_source.html#l00137">polar_navier_stokes_elements.h:137</a></div></div>
<div class="ttc" id="aclassoomph_1_1PolarNavierStokesEquations_html_ac3a3e89734b01c9f117520eac5a2ace3"><div class="ttname"><a href="classoomph_1_1PolarNavierStokesEquations.html#ac3a3e89734b01c9f117520eac5a2ace3">oomph::PolarNavierStokesEquations::interpolated_u_pnst</a></div><div class="ttdeci">void interpolated_u_pnst(const Vector&lt; double &gt; &amp;s, Vector&lt; double &gt; &amp;veloc) const</div><div class="ttdoc">Compute vector of FE interpolated velocity u at local coordinate s.</div><div class="ttdef"><b>Definition:</b> <a href="polar__navier__stokes__elements_8h_source.html#l00568">polar_navier_stokes_elements.h:568</a></div></div>
<div class="ttc" id="athe__data__structure_8txt_html_a15043ffc2013f4797ce93c4d1cc7a9ba"><div class="ttname"><a href="the__data__structure_8txt.html#a15043ffc2013f4797ce93c4d1cc7a9ba">press</a></div><div class="ttdeci">double press</div><div class="ttdef"><b>Definition:</b> <a href="the__data__structure_8txt_source.html#l00585">the_data_structure.txt:585</a></div></div>
<div class="ttc" id="aclassoomph_1_1PolarNavierStokesEquations_html_a4db8f8149fe830b204de3c5f64fd3113"><div class="ttname"><a href="classoomph_1_1PolarNavierStokesEquations.html#a4db8f8149fe830b204de3c5f64fd3113">oomph::PolarNavierStokesEquations::p_pnst</a></div><div class="ttdeci">virtual double p_pnst(const unsigned &amp;n_p) const =0</div><div class="ttdoc">Pressure at local pressure &quot;node&quot; n_p Uses suitably interpolated value for hanging nodes.</div></div>
<div class="ttc" id="aclassoomph_1_1PolarNavierStokesEquations_html_a7fda7aac0b9eb09410dfff38f992374c"><div class="ttname"><a href="classoomph_1_1PolarNavierStokesEquations.html#a7fda7aac0b9eb09410dfff38f992374c">oomph::PolarNavierStokesEquations::dshape_and_dtest_eulerian_at_knot_pnst</a></div><div class="ttdeci">virtual double dshape_and_dtest_eulerian_at_knot_pnst(const unsigned &amp;ipt, Shape &amp;psi, DShape &amp;dpsidx, Shape &amp;test, DShape &amp;dtestdx) const =0</div><div class="ttdoc">Compute the shape functions and derivatives w.r.t. global coords at ipt-th integration point Return J...</div></div>
<div class="ttc" id="aclassoomph_1_1PolarNavierStokesEquations_html_af05fc0ab81fac7f46c937220b9ca3ac0"><div class="ttname"><a href="classoomph_1_1PolarNavierStokesEquations.html#af05fc0ab81fac7f46c937220b9ca3ac0">oomph::PolarNavierStokesEquations::compute_error</a></div><div class="ttdeci">void compute_error(std::ostream &amp;outfile, FiniteElement::UnsteadyExactSolutionFctPt exact_soln_pt, const double &amp;time, double &amp;error, double &amp;norm)</div><div class="ttdoc">Validate against exact solution at given time Solution is provided via function pointer....</div><div class="ttdef"><b>Definition:</b> <a href="polar__navier__stokes__elements_8cc_source.html#l00063">polar_navier_stokes_elements.cc:63</a></div></div>
<div class="ttc" id="aclassoomph_1_1PolarTaylorHoodElement_html_a4804e4bdf732b17cdb7e55aebaebcab0"><div class="ttname"><a href="classoomph_1_1PolarTaylorHoodElement.html#a4804e4bdf732b17cdb7e55aebaebcab0">oomph::PolarTaylorHoodElement::Pconv</a></div><div class="ttdeci">static const unsigned Pconv[]</div><div class="ttdoc">Static array of ints to hold conversion from pressure node numbers to actual node numbers.</div><div class="ttdef"><b>Definition:</b> <a href="polar__navier__stokes__elements_8h_source.html#l00895">polar_navier_stokes_elements.h:895</a></div></div>
<div class="ttc" id="aclassoomph_1_1PolarNavierStokesEquations_html_a4738c2cb0df9ba80c581442ceade039e"><div class="ttname"><a href="classoomph_1_1PolarNavierStokesEquations.html#a4738c2cb0df9ba80c581442ceade039e">oomph::PolarNavierStokesEquations::p_local_eqn</a></div><div class="ttdeci">virtual int p_local_eqn(const unsigned &amp;n)=0</div><div class="ttdoc">Access function for the local equation number information for the pressure. p_local_eqn[n] = local eq...</div></div>
<div class="ttc" id="aclassoomph_1_1PolarTaylorHoodElement_html_a4db1fda841168bbf5889e060b52f4344"><div class="ttname"><a href="classoomph_1_1PolarTaylorHoodElement.html#a4db1fda841168bbf5889e060b52f4344">oomph::PolarTaylorHoodElement::Initial_Nvalue</a></div><div class="ttdeci">static const unsigned Initial_Nvalue[]</div><div class="ttdoc">Static array of ints to hold number of variables at node.</div><div class="ttdef"><b>Definition:</b> <a href="polar__navier__stokes__elements_8h_source.html#l00889">polar_navier_stokes_elements.h:889</a></div></div>
<div class="ttc" id="aclassoomph_1_1PolarNavierStokesEquations_html_a21029e3ad077fda4efe1290ed17cfa97"><div class="ttname"><a href="classoomph_1_1PolarNavierStokesEquations.html#a21029e3ad077fda4efe1290ed17cfa97">oomph::PolarNavierStokesEquations::Default_Physical_Constant_Value</a></div><div class="ttdeci">static double Default_Physical_Constant_Value</div><div class="ttdoc">Static default value for the physical constants (all initialised to zero)</div><div class="ttdef"><b>Definition:</b> <a href="polar__navier__stokes__elements_8h_source.html#l00131">polar_navier_stokes_elements.h:131</a></div></div>
<div class="ttc" id="aclassoomph_1_1FiniteElement_html_a28fd5c2d4aeba5ef65bee0e0d72569f5"><div class="ttname"><a href="classoomph_1_1FiniteElement.html#a28fd5c2d4aeba5ef65bee0e0d72569f5">oomph::FiniteElement::nodal_value</a></div><div class="ttdeci">double nodal_value(const unsigned &amp;n, const unsigned &amp;i) const</div><div class="ttdoc">Return the i-th value stored at local node n. Produces suitably interpolated values for hanging nodes...</div><div class="ttdef"><b>Definition:</b> <a href="elements_8h_source.html#l02483">elements.h:2483</a></div></div>
<div class="ttc" id="aclassoomph_1_1PolarNavierStokesEquations_html_ad0188bfed5fc5e929017226cde427839"><div class="ttname"><a href="classoomph_1_1PolarNavierStokesEquations.html#ad0188bfed5fc5e929017226cde427839">oomph::PolarNavierStokesEquations::fill_in_generic_residual_contribution</a></div><div class="ttdeci">virtual void fill_in_generic_residual_contribution(Vector&lt; double &gt; &amp;residuals, DenseMatrix&lt; double &gt; &amp;jacobian, DenseMatrix&lt; double &gt; &amp;mass_matrix, unsigned flag)</div><div class="ttdoc">Compute the residuals for the NavierStokes equations; flag=1(or 0): do (or don't) compute the Jacobi...</div><div class="ttdef"><b>Definition:</b> <a href="polar__navier__stokes__elements_8cc_source.html#l01116">polar_navier_stokes_elements.cc:1116</a></div></div>
<div class="ttc" id="aclassoomph_1_1Integral_html_ac65335e2aab120b285b3d6c294507b06"><div class="ttname"><a href="classoomph_1_1Integral.html#ac65335e2aab120b285b3d6c294507b06">oomph::Integral::weight</a></div><div class="ttdeci">virtual double weight(const unsigned &amp;i) const =0</div><div class="ttdoc">Return weight of i-th integration point.</div></div>
<div class="ttc" id="aclassoomph_1_1Shape_html"><div class="ttname"><a href="classoomph_1_1Shape.html">oomph::Shape</a></div><div class="ttdef"><b>Definition:</b> <a href="shape_8h_source.html#l00077">shape.h:77</a></div></div>
<div class="ttc" id="acfortran_8h_html_ab7123126e4885ef647dd9c6e3807a21c"><div class="ttname"><a href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a></div><div class="ttdeci">static char t char * s</div><div class="ttdef"><b>Definition:</b> <a href="cfortran_8h_source.html#l00568">cfortran.h:568</a></div></div>

    <!-- jQuery for Bootstrap and Doxygen -->
    <script src="../../js/jquery-1.12.0.min.js"></script>
    <!-- Minified boostrap plugins-->
    <script src="../../js/bootstrap.js"></script>
    <!-- Doxygen dependency to add powertips to source code-->
    <script src="../../js/jquery.powertip.min.js"></script>
    <!-- The  following script is generated by doxygen and hides/shows levels in 
         the data structure lists and adds powertips to source code-->
    <script src="../../js/dynsections.js" ></script>
    <!-- add to Doxygen's class names so bootstrap css and js recognises them-->
    <script type="text/javascript">
    $(".contents").addClass("container");
    $(".header").addClass("container");
    $(".navpath").addClass("container");
    $("#navrow3").addClass("container");
    $("#navrow4").addClass("container");
    $(".mlabel").addClass("label");
    $(".mlabel").addClass("label-default");
    $(".memitem").addClass("panel");
    $(".memitem").addClass("panel-info");
    $(".memproto").addClass("panel-heading");
    $(".memdoc").addClass("panel-body");
    </script>
    <footer>
      <div class="container">
        <div class="text-muted" style="float:right;">Generated by <a href="http://www.doxygen.org/index.html">
          <img style="height:18px;" class="footer-img" src="doxygen.png" alt="doxygen"></a> on Wed Jul 21 2021 16:04:59
        </div>
      </div>
    </footer>
</body>
</html>

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
<title>oomph-lib: spherical_advection_diffusion_elements.h Source File</title>
<link rel="apple-touch-icon" sizes="57x57" href="../../figures/apple-touch-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="../../figures/apple-touch-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="../../figures/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="../../figures/apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="../../figures/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="../../figures/apple-touch-icon-120x120.png">
<link rel="icon" type="image/png" href="../../figures/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="../../figures/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="../../figures/favicon-16x16.png" sizes="16x16">
<link rel="manifest" href="../../figures/manifest.json">
<link rel="mask-icon" href="../../figures/safari-pinned-tab.svg" color="#008000">
<link rel="shortcut icon" href="../../figures/favicon.ico">
<meta name="msapplication-TileColor" content="#00a300">
<meta name="msapplication-config" content="../../figures/browserconfig.xml">
<meta name="theme-color" content="#008000">
<link href="http://fonts.googleapis.com/css?family=Open+Sans:400,300,600" rel="stylesheet" type="text/css">
<!-- Doxygen css-->
<!-- <link rel="stylesheet" type="text/css" href="doxygen.css"> -->
<!-- Bootstrap -->
<link href="../../css/bootstrap.css" rel="stylesheet">
<!-- oomph-lib specific overrides -->
<link rel="stylesheet" type="text/css" href="../../css/oomph_header.css">
</head>
<body>
<nav class="navbar navbar-default">
<div class="container">
<div class="container-fluid">
  <!-- Brand and toggle get grouped for better mobile display -->
  <div class="navbar-header">
    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
      <span class="sr-only">Toggle navigation</span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="../../html/index.html"><img alt="oomph-lib" src="../../figures/oomph_logo.png"></a>
  </div>
  <!-- Collect the nav links, forms, and other content for toggling -->
  <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
    <ul class="nav navbar-nav">          
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Documentation <span class="caret"></span></a>
        <ul class="dropdown-menu">
          <li class="dropdown-header">Big picture</li>
          <li><a href="../../../doc/intro/html/index.html">The finite element method</a></li>
          <li><a href="../../../doc/the_data_structure/html/index.html">The data structure</a></li>
          <li><a href="../../../doc/quick_guide/html/index.html">Not-so-quick guide</a></li>
          <li><a href="../../../doc/optimisation/html/index.html">Optimisation</a></li>
          <li><a href="../../../doc/order_of_action_functions/html/index.html">Order of action functions</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Example codes and tutorials</li>
          <li><a href="../../../doc/example_code_list/html/index.html">List of example codes and tutorials</a></li>
          <li><a href="../../../doc/example_code_list/html/index.html#meshes">Meshing</a></li>
          <li><a href="../../../doc/example_code_list/html/index.html#solvers">Solvers</a></li>
          <li><a href="../../../doc/example_code_list/html/index.html#parallel">MPI parallel processing</a></li>
          <li><a href="../../../doc/example_code_list/html/index.html#visualisation">Post-processing/visualisation</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Other</li>
          <li><a href="../../../doc/change_log/html/index.html">Change log</a></li>
          <li><a href="../../../doc/creating_doc/html/index.html">Creating documentation</a></li>
          <li><a href="../../../doc/coding_conventions/html/index.html">Coding conventions</a></li>
          <li><a href="../../../doc/index/html/index.html">Index</a></li>
          <li><a href="../../../doc/FAQ/html/index.html">FAQ</a></li>
        </ul>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Get it <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../doc/the_distribution/html/index.html">Installation guide</a></li>
            <li><a href="../../../doc/subversion/html/index.html">Get code from subversion repository</a></li>
            <li><a href="../../../doc/download/html/index.html">Get code as tar file</a></li>
            <li><a href="../../../doc/copyright/html/index.html">Copyright</a></li>
          </ul>
        </li>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">About <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../doc/people/html/index.html">People</a></li>            
            <li><a href="../../../doc/contact/html/index.html">Contact/Get involved</a></li>
            <li><a href="../../../doc/publications/html/index.html">Publications</a></li>
            <li><a href="../../../doc/acknowledgements/html/index.html">Acknowledgements</a></li>
            <li><a href="../../../doc/picture_show/index.html">Picture show</a></li>
          </ul>
        </li>
      </li>
    </ul>
    <ul class="nav navbar-nav navbar-right navbar-search">
      <form class="navbar-form" role="search" action="../../../doc/search_results/html/index.html">
        <div class="input-group">
          <input type="text" class="form-control" placeholder="Search" name="q">
          <span class="input-group-btn">
            <button class="btn btn-default" type="submit">Go</button>
          </span>
        </div><!-- /input-group -->
       <!--<div class="form-group">
          <input type="text" class="form-control" placeholder="Search">
        </div>
        <button type="submit" class="btn btn-default">Submit</button>-->
      </form>
    </ul>
  </div><!-- /.navbar-collapse -->
</div><!-- /.container-fluid -->
</div>
</nav>
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_549c0ee5f54455cc2d48d18e10e40493.html">spherical_advection_diffusion</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">spherical_advection_diffusion_elements.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="spherical__advection__diffusion__elements_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">//LIC// ====================================================================</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">//LIC// This file forms part of oomph-lib, the object-oriented, </span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">//LIC// multi-physics finite-element library, available </span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">//LIC// at http://www.oomph-lib.org.</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">//LIC// Copyright (C) 2006-2021 Matthias Heil and Andrew Hazel</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">//LIC// This library is free software; you can redistribute it and/or</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">//LIC// modify it under the terms of the GNU Lesser General Public</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">//LIC// License as published by the Free Software Foundation; either</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">//LIC// version 2.1 of the License, or (at your option) any later version.</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">//LIC// This library is distributed in the hope that it will be useful,</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">//LIC// but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">//LIC// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">//LIC// Lesser General Public License for more details.</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">//LIC// You should have received a copy of the GNU Lesser General Public</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">//LIC// License along with this library; if not, write to the Free Software</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">//LIC// Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">//LIC// 02110-1301  USA.</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">//LIC// The authors may be contacted at oomph-lib@maths.man.ac.uk.</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">//LIC//====================================================================</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">//Header file for advection diffusion elements in a spherical polar coordinate</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">//system</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#ifndef OOMPH_SPHERICAL_ADV_DIFF_ELEMENTS_HEADER</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#define OOMPH_SPHERICAL_ADV_DIFF_ELEMENTS_HEADER</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160; </div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160; </div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment">// Config header generated by autoconfig</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#ifdef HAVE_CONFIG_H</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#include &lt;oomph-lib-config.h&gt;</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160; </div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment">//OOMPH-LIB headers</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="preprocessor">#include &quot;../generic/nodes.h&quot;</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="preprocessor">#include &quot;../generic/Qelements.h&quot;</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="preprocessor">#include &quot;../generic/refineable_elements.h&quot;</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="preprocessor">#include &quot;../generic/oomph_utilities.h&quot;</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160; </div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespaceoomph.html">oomph</a></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;{</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160; </div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment">//=============================================================</span><span class="comment"></span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment">/// \short A class for all elements that solve the </span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment">/// Advection Diffusion equations in a spherical polar coordinate system</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment">/// using isoparametric elements.</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment">/// \f[ </span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment">/// Pe \mathbf{w}\cdot(\mathbf{x}) \nabla u = </span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment">/// \nabla \cdot \left( \nabla u \right) + f(\mathbf{x})    </span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment">/// \f] </span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment">/// This contains the generic maths. Shape functions, geometric</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment">/// mapping etc. must get implemented in derived class.</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment"></span><span class="comment">//=============================================================</span></div>
<div class="line"><a name="l00057"></a><span class="lineno"><a class="line" href="classoomph_1_1SphericalAdvectionDiffusionEquations.html">   57</a></span>&#160;<span class="keyword">class </span><a class="code" href="classoomph_1_1SphericalAdvectionDiffusionEquations.html">SphericalAdvectionDiffusionEquations</a> : <span class="keyword">public</span> <span class="keyword">virtual</span> <a class="code" href="classoomph_1_1FiniteElement.html">FiniteElement</a></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;{</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160; </div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment"> /// \short Function pointer to source function fct(x,f(x)) -- </span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment"> /// x is a Vector! </span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment"></span> <span class="keyword">typedef</span> void (*<a class="code" href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#aa02d787c43f88e46ad5e21c7b299b5cb">SphericalAdvectionDiffusionSourceFctPt</a>)</div>
<div class="line"><a name="l00065"></a><span class="lineno"><a class="line" href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#aa02d787c43f88e46ad5e21c7b299b5cb">   65</a></span>&#160;  (<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; x, <span class="keywordtype">double</span>&amp; f);</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160; </div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment"> /// \short Function pointer to wind function fct(x,w(x)) -- </span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="comment"> /// x is a Vector! </span></div>
<div class="line"><a name="l00070"></a><span class="lineno"><a class="line" href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#adef9c036e9f80c134078d8d78049199e">   70</a></span>&#160;<span class="comment"></span> <span class="keyword">typedef</span> void (*<a class="code" href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#adef9c036e9f80c134078d8d78049199e">SphericalAdvectionDiffusionWindFctPt</a>)(</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  <span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; x, <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; wind);</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160; </div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="comment"> /// \short Constructor: Initialise the Source_fct_pt and Wind_fct_pt </span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="comment"> /// to null and set (pointer to) Peclet number to default</span></div>
<div class="line"><a name="l00076"></a><span class="lineno"><a class="line" href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#aed5cfed74d16b43e5a9ca081b845b2a2">   76</a></span>&#160;<span class="comment"></span> <a class="code" href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#aed5cfed74d16b43e5a9ca081b845b2a2">SphericalAdvectionDiffusionEquations</a>() : <a class="code" href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#a588bb8fcf23cd8bc38225f974d4cde7e">Source_fct_pt</a>(0), <a class="code" href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#a6a8673efdb4df145804fbb92dccd1835">Wind_fct_pt</a>(0)</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  {</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;   <span class="comment">//Set pointer to Peclet number to the default value zero</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;   <a class="code" href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#ab650e6ff8db720b2c7d061f885f1c628">Pe_pt</a> = &amp;<a class="code" href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#ab28f6e9b6c44a405e7ee7611df43e7c7">Default_peclet_number</a>;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;   <a class="code" href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#a3fdb5e8765ae60ea6c218629e2cb207c">PeSt_pt</a> = &amp;<a class="code" href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#ab28f6e9b6c44a405e7ee7611df43e7c7">Default_peclet_number</a>;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  }</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="comment"> /// Broken copy constructor</span></div>
<div class="line"><a name="l00084"></a><span class="lineno"><a class="line" href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#a3ef8f55c02bf521af9da3cae9eb2a689">   84</a></span>&#160;<span class="comment"></span> <a class="code" href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#a3ef8f55c02bf521af9da3cae9eb2a689">SphericalAdvectionDiffusionEquations</a>(</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  <span class="keyword">const</span> <a class="code" href="classoomph_1_1SphericalAdvectionDiffusionEquations.html">SphericalAdvectionDiffusionEquations</a>&amp; dummy) </div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;  { </div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;   <a class="code" href="namespaceoomph_1_1BrokenCopy.html#a7e5cd7fda8b8c790003151bee77a84ac">BrokenCopy::broken_copy</a>(<span class="stringliteral">&quot;SphericalAdvectionDiffusionEquations&quot;</span>);</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  } </div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="comment"> /// Broken assignment operator</span></div>
<div class="line"><a name="l00091"></a><span class="lineno"><a class="line" href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#ac1df4b72634538673bfd5c1eab02ddad">   91</a></span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#ac1df4b72634538673bfd5c1eab02ddad">operator=</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1SphericalAdvectionDiffusionEquations.html">SphericalAdvectionDiffusionEquations</a>&amp;) </div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  {</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;   <a class="code" href="namespaceoomph_1_1BrokenCopy.html#a32dc384e671e786bac0c67cbff701f45">BrokenCopy::broken_assign</a>(<span class="stringliteral">&quot;SphericalAdvectionDiffusionEquations&quot;</span>);</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  }</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment"> /// \short Return the index at which the unknown value</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="comment"> /// is stored. The default value, 0, is appropriate for single-physics</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="comment"> /// problems, when there is only one variable, the value that satisfies</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="comment"> /// the spherical advection-diffusion equation. </span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="comment"> /// In derived multi-physics elements, this function should be overloaded</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="comment"> /// to reflect the chosen storage scheme. Note that these equations require</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="comment"> /// that the unknown is always stored at the same index at each node.</span></div>
<div class="line"><a name="l00103"></a><span class="lineno"><a class="line" href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#a9a2928db14dc07aa3af1ee2dd7901dc5">  103</a></span>&#160;<span class="comment"></span> <span class="keyword">virtual</span> <span class="keyword">inline</span> <span class="keywordtype">unsigned</span> <a class="code" href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#a9a2928db14dc07aa3af1ee2dd7901dc5">u_index_spherical_adv_diff</a>()<span class="keyword"> const </span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;   <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  }</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160; </div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="comment">/// \short du/dt at local node n. </span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="comment"> /// Uses suitably interpolated value for hanging nodes.</span></div>
<div class="line"><a name="l00111"></a><span class="lineno"><a class="line" href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#a5159b68db86351eba5efa89f4c922745">  111</a></span>&#160;<span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#a5159b68db86351eba5efa89f4c922745">du_dt_spherical_adv_diff</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;<a class="code" href="the__data__structure_8txt.html#af88b2d950fae19ab641bd1690e08445c">n</a>)<span class="keyword"> const</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="keyword"> </span>{</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  <span class="comment">// Get the data&#39;s timestepper</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  <a class="code" href="classoomph_1_1TimeStepper.html">TimeStepper</a>* <a class="code" href="classoomph_1_1GeomObject.html#a3c92023891dd4a0e818022f467eeb7f1">time_stepper_pt</a>= this-&gt;<a class="code" href="classoomph_1_1FiniteElement.html#ace0e7fb72a805b5c2c600347bfae7a9b">node_pt</a>(n)-&gt;<a class="code" href="classoomph_1_1Data.html#a5b34970d16205921dca3ada720da8445">time_stepper_pt</a>();</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  </div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  <span class="comment">//Initialise dudt</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  <span class="keywordtype">double</span> dudt=0.0;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  <span class="comment">//Loop over the timesteps, if there is a non Steady timestepper</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="classoomph_1_1GeomObject.html#a3c92023891dd4a0e818022f467eeb7f1">time_stepper_pt</a>-&gt;<a class="code" href="classoomph_1_1TimeStepper.html#ad341ba9e80265e1c26c1cda0f40c8292">is_steady</a>())</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;   {</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    <span class="comment">//Find the index at which the variable is stored</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> u_nodal_index = <a class="code" href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#a9a2928db14dc07aa3af1ee2dd7901dc5">u_index_spherical_adv_diff</a>();</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    </div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <span class="comment">// Number of timsteps (past &amp; present)</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_time = <a class="code" href="classoomph_1_1GeomObject.html#a3c92023891dd4a0e818022f467eeb7f1">time_stepper_pt</a>-&gt;<a class="code" href="classoomph_1_1TimeStepper.html#a3939b77ec3578e4bd5b453c85649d631">ntstorage</a>();</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    </div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#af6f0bd3dc13317f895c91323c25c2b8f">t</a>=0;<a class="code" href="cfortran_8h.html#af6f0bd3dc13317f895c91323c25c2b8f">t</a>&lt;n_time;<a class="code" href="cfortran_8h.html#af6f0bd3dc13317f895c91323c25c2b8f">t</a>++)</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;     {</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;      dudt += <a class="code" href="classoomph_1_1GeomObject.html#a3c92023891dd4a0e818022f467eeb7f1">time_stepper_pt</a>-&gt;<a class="code" href="classoomph_1_1TimeStepper.html#a4cb0aecb044b77ba0553cdd54b586d8a">weight</a>(1,<a class="code" href="cfortran_8h.html#af6f0bd3dc13317f895c91323c25c2b8f">t</a>)*<a class="code" href="classoomph_1_1FiniteElement.html#a28fd5c2d4aeba5ef65bee0e0d72569f5">nodal_value</a>(<a class="code" href="cfortran_8h.html#af6f0bd3dc13317f895c91323c25c2b8f">t</a>,<a class="code" href="the__data__structure_8txt.html#af88b2d950fae19ab641bd1690e08445c">n</a>,u_nodal_index);</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;     }</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;   }</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  <span class="keywordflow">return</span> dudt;</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160; }</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160; </div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="comment"> /// \short Disable ALE -- empty overload to suppress warning. </span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="comment"> /// ALE isn&#39;t implemented anyway</span></div>
<div class="line"><a name="l00138"></a><span class="lineno"><a class="line" href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#a097613909cb9b016e55190df3c7b3d2f">  138</a></span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#a097613909cb9b016e55190df3c7b3d2f">disable_ALE</a>() {}</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="comment"> /// Output with default number of plot points</span></div>
<div class="line"><a name="l00141"></a><span class="lineno"><a class="line" href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#a4b4f59d82dd7b2e1641eba4b91d54d40">  141</a></span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#a4b4f59d82dd7b2e1641eba4b91d54d40">output</a>(std::ostream &amp;outfile) </div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  {</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;   <span class="keywordtype">unsigned</span> nplot = 5;</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;   <a class="code" href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#a4b4f59d82dd7b2e1641eba4b91d54d40">output</a>(outfile,nplot);</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  }</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="comment"> /// \short Output FE representation of soln: r,z,u  at </span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="comment"> /// nplot^2 plot points</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#a4b4f59d82dd7b2e1641eba4b91d54d40">output</a>(std::ostream &amp;outfile, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;nplot);</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160; </div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="comment"> /// C_style output with default number of plot points</span></div>
<div class="line"><a name="l00153"></a><span class="lineno"><a class="line" href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#a5e2334112c6c967c490fc9e5f54f5b35">  153</a></span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#a5e2334112c6c967c490fc9e5f54f5b35">output</a>(FILE* file_pt)</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;  {</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;   <span class="keywordtype">unsigned</span> n_plot = 5;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;   <a class="code" href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#a4b4f59d82dd7b2e1641eba4b91d54d40">output</a>(file_pt,n_plot);</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  }</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="comment"> /// \short C-style output FE representation of soln: r,z,u  at </span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="comment"> /// n_plot^2 plot points</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#a4b4f59d82dd7b2e1641eba4b91d54d40">output</a>(FILE* file_pt, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;n_plot);</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160; </div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="comment"> /// Output exact soln: r,z,u_exact at nplot^2 plot points</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#a2fcb664a740cfb2a645b0e1893a00773">output_fct</a>(std::ostream &amp;outfile, </div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;                 <span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;nplot, </div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;                 <a class="code" href="classoomph_1_1FiniteElement.html#a690fd33af26cc3e84f39bba6d5a85202">FiniteElement::SteadyExactSolutionFctPt</a> </div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;                 exact_soln_pt);</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="comment"> /// Get error against and norm of exact solution</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#a92998bc7fd574a8e0bb6afe3694fb62b">compute_error</a>(std::ostream &amp;outfile, </div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;                    <a class="code" href="classoomph_1_1FiniteElement.html#a690fd33af26cc3e84f39bba6d5a85202">FiniteElement::SteadyExactSolutionFctPt</a> </div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;                    exact_soln_pt, <span class="keywordtype">double</span>&amp; error, </div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;                    <span class="keywordtype">double</span>&amp; norm);</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="comment"> /// Access function: Pointer to source function</span></div>
<div class="line"><a name="l00177"></a><span class="lineno"><a class="line" href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#a9895841883dedbbc00fb1fc51ad0493e">  177</a></span>&#160;<span class="comment"></span> <span class="keyword">inline</span> <a class="code" href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#aa02d787c43f88e46ad5e21c7b299b5cb">SphericalAdvectionDiffusionSourceFctPt</a>&amp; <a class="code" href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#a9895841883dedbbc00fb1fc51ad0493e">source_fct_pt</a>() </div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;  {<span class="keywordflow">return</span> <a class="code" href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#a588bb8fcf23cd8bc38225f974d4cde7e">Source_fct_pt</a>;}</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160; </div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="comment"> /// Access function: Pointer to source function. Const version</span></div>
<div class="line"><a name="l00182"></a><span class="lineno"><a class="line" href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#a9c4d749b66acb943eac37478584683aa">  182</a></span>&#160;<span class="comment"></span> <span class="keyword">inline</span> <a class="code" href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#aa02d787c43f88e46ad5e21c7b299b5cb">SphericalAdvectionDiffusionSourceFctPt</a> <a class="code" href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#a9c4d749b66acb943eac37478584683aa">source_fct_pt</a>()<span class="keyword"> const </span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="keyword">  </span>{<span class="keywordflow">return</span> <a class="code" href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#a588bb8fcf23cd8bc38225f974d4cde7e">Source_fct_pt</a>;}</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160; </div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="comment"> /// Access function: Pointer to wind function</span></div>
<div class="line"><a name="l00187"></a><span class="lineno"><a class="line" href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#ae3d7908aae79d3eae5ba6e1bb638498b">  187</a></span>&#160;<span class="comment"></span> <span class="keyword">inline</span> <a class="code" href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#adef9c036e9f80c134078d8d78049199e">SphericalAdvectionDiffusionWindFctPt</a>&amp; <a class="code" href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#ae3d7908aae79d3eae5ba6e1bb638498b">wind_fct_pt</a>() </div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;  {<span class="keywordflow">return</span> <a class="code" href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#a6a8673efdb4df145804fbb92dccd1835">Wind_fct_pt</a>;}</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160; </div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="comment"> /// Access function: Pointer to wind function. Const version</span></div>
<div class="line"><a name="l00192"></a><span class="lineno"><a class="line" href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#a143f3e3ec0e1ac832b957635ce5c58f0">  192</a></span>&#160;<span class="comment"></span> <span class="keyword">inline</span> <a class="code" href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#adef9c036e9f80c134078d8d78049199e">SphericalAdvectionDiffusionWindFctPt</a> <a class="code" href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#a143f3e3ec0e1ac832b957635ce5c58f0">wind_fct_pt</a>()<span class="keyword"> const </span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="keyword">  </span>{<span class="keywordflow">return</span> <a class="code" href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#a6a8673efdb4df145804fbb92dccd1835">Wind_fct_pt</a>;}</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160; </div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160; <span class="comment">// Access functions for the physical constants</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="comment"> /// Peclet number</span></div>
<div class="line"><a name="l00198"></a><span class="lineno"><a class="line" href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#a33f78b13bf746a2d0b21d3675c4c4d95">  198</a></span>&#160;<span class="comment"></span> <span class="keyword">inline</span> <span class="keyword">const</span> <span class="keywordtype">double</span> &amp;<a class="code" href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#a33f78b13bf746a2d0b21d3675c4c4d95">pe</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> *<a class="code" href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#ab650e6ff8db720b2c7d061f885f1c628">Pe_pt</a>;}</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="comment"> /// Pointer to Peclet number</span></div>
<div class="line"><a name="l00201"></a><span class="lineno"><a class="line" href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#aefe9930f320bf5931f853461253951ef">  201</a></span>&#160;<span class="comment"></span> <span class="keyword">inline</span> <span class="keywordtype">double</span>* &amp;<a class="code" href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#aefe9930f320bf5931f853461253951ef">pe_pt</a>() {<span class="keywordflow">return</span> <a class="code" href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#ab650e6ff8db720b2c7d061f885f1c628">Pe_pt</a>;}</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="comment"> /// Peclet number multiplied by Strouhal number</span></div>
<div class="line"><a name="l00204"></a><span class="lineno"><a class="line" href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#a7f7a29ec80961ed10841bd5e2ba9f51c">  204</a></span>&#160;<span class="comment"></span> <span class="keyword">inline</span> <span class="keyword">const</span> <span class="keywordtype">double</span> &amp;<a class="code" href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#a7f7a29ec80961ed10841bd5e2ba9f51c">pe_st</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> *<a class="code" href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#a3fdb5e8765ae60ea6c218629e2cb207c">PeSt_pt</a>;}</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="comment"> /// Pointer to Peclet number multipled by Strouha number</span></div>
<div class="line"><a name="l00207"></a><span class="lineno"><a class="line" href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#ab70b9505075279b1dc935a620407df1f">  207</a></span>&#160;<span class="comment"></span> <span class="keyword">inline</span> <span class="keywordtype">double</span>* &amp;<a class="code" href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#ab70b9505075279b1dc935a620407df1f">pe_st_pt</a>() {<span class="keywordflow">return</span> <a class="code" href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#a3fdb5e8765ae60ea6c218629e2cb207c">PeSt_pt</a>;}</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="comment"> /// \short Get source term at (Eulerian) position x. This function is</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="comment"> /// virtual to allow overloading in multi-physics problems where</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="comment"> /// the strength of the source function might be determined by</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="comment"> /// another system of equations </span></div>
<div class="line"><a name="l00213"></a><span class="lineno"><a class="line" href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#a139999156e95fba4e789d7b72def465e">  213</a></span>&#160;<span class="comment"></span> <span class="keyword">inline</span> <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#a139999156e95fba4e789d7b72def465e">get_source_spherical_adv_diff</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; ipt,</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;                                                   <span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; x,</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;                                                   <span class="keywordtype">double</span>&amp; source)<span class="keyword"> const</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;   <span class="comment">//If no source function has been set, return zero</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;   <span class="keywordflow">if</span>(<a class="code" href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#a588bb8fcf23cd8bc38225f974d4cde7e">Source_fct_pt</a>==0) </div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    {</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;     source = 0.0;</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    }</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;   <span class="keywordflow">else</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    {</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;     <span class="comment">//Get source strength</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;     (*Source_fct_pt)(x,source);</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    }</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;  }</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="comment"> /// \short Get wind at (Eulerian) position x and/or local coordinate s. </span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;<span class="comment"> /// This function is</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;<span class="comment"> /// virtual to allow overloading in multi-physics problems where</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="comment"> /// the wind function might be determined by</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="comment"> /// another system of equations </span></div>
<div class="line"><a name="l00234"></a><span class="lineno"><a class="line" href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#afbea24565ef0db2546b804233a114a86">  234</a></span>&#160;<span class="comment"></span> <span class="keyword">inline</span> <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#afbea24565ef0db2546b804233a114a86">get_wind_spherical_adv_diff</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; ipt,</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;                                                 <span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;                                                 <span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; x,</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;                                                 <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; wind)<span class="keyword"> const</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="keyword"> </span>{</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;  <span class="comment">//If no wind function has been set, return zero</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#a6a8673efdb4df145804fbb92dccd1835">Wind_fct_pt</a>==0)</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;   {</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;3;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++) </div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;     { </div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;      wind[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] = 0.0;</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;     }</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;   }</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;   {</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <span class="comment">//Get wind</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    (*Wind_fct_pt)(x,wind);</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;   }</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160; }</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;<span class="comment"> /// \short Get flux: </span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;<span class="comment"> /// \f[</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;<span class="comment"> /// \mbox{flux}[i] = \nabla u = \mbox{d}u / \mbox{d} r </span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;<span class="comment"> /// + 1/r \mbox{d}u / \mbox{d} \theta</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="comment"> /// \f]</span></div>
<div class="line"><a name="l00259"></a><span class="lineno"><a class="line" href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#a52e4a713aa779de8cd57ec5faa60a709">  259</a></span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#a52e4a713aa779de8cd57ec5faa60a709">get_flux</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>, <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; flux)<span class="keyword"> const</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;   <span class="comment">//Find out how many nodes there are in the element</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_node = <a class="code" href="classoomph_1_1FiniteElement.html#a6219ed269a6d89b5aa14659cce48905a">nnode</a>();</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;   </div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;   <span class="comment">//Get the nodal index at which the unknown is stored</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> u_nodal_index = <a class="code" href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#a9a2928db14dc07aa3af1ee2dd7901dc5">u_index_spherical_adv_diff</a>();</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160; </div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;   <span class="comment">//Set up memory for the shape and test functions</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;   <a class="code" href="classoomph_1_1Shape.html">Shape</a> psi(n_node);</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;   <a class="code" href="classoomph_1_1DShape.html">DShape</a> dpsidx(n_node,2);</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160; </div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;   <span class="comment">//Call the derivatives of the shape and test functions</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;   <a class="code" href="classoomph_1_1FiniteElement.html#a9296c17b134688049256a4bbc886df69">dshape_eulerian</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,psi,dpsidx);</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;     </div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;   <span class="comment">//Initialise to zero</span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> j=0;j&lt;2;j++) {flux[j] = 0.0;}</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;   </div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;   <span class="comment">//Loop over nodes</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l=0;l&lt;n_node;l++) </div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    {</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;     <span class="keyword">const</span> <span class="keywordtype">double</span> u_value = this-&gt;<a class="code" href="classoomph_1_1FiniteElement.html#a28fd5c2d4aeba5ef65bee0e0d72569f5">nodal_value</a>(l,u_nodal_index);</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;     <span class="keyword">const</span> <span class="keywordtype">double</span> r = this-&gt;<a class="code" href="classoomph_1_1FiniteElement.html#a9152c16ae9899168bcdaac7c2f977444">nodal_position</a>(l,0);</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;     <span class="comment">//Add in the derivative directions</span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;     flux[0] += u_value*dpsidx(l,0);</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;     flux[1] += u_value*dpsidx(l,1)/r;</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    }</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;  }</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160; </div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;<span class="comment"> /// Add the element&#39;s contribution to its residual vector (wrapper)</span></div>
<div class="line"><a name="l00290"></a><span class="lineno"><a class="line" href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#a57068b61f67c6aa99f3339cf852fa696">  290</a></span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#a57068b61f67c6aa99f3339cf852fa696">fill_in_contribution_to_residuals</a>(<a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;<a class="code" href="the__data__structure_8txt.html#a1400a973def57b85051cfe1070be1810">residuals</a>)</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;  {</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;   <span class="comment">//Call the generic residuals function with flag set to 0 and using</span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;   <span class="comment">//a dummy matrix</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;   <a class="code" href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#ad97d019b2b4715d379adca3320262d29">fill_in_generic_residual_contribution_spherical_adv_diff</a>(</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    <a class="code" href="the__data__structure_8txt.html#a1400a973def57b85051cfe1070be1810">residuals</a>,</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    <a class="code" href="classoomph_1_1GeneralisedElement.html#a4bff11b8ff97aefabb2df41e61e1779f">GeneralisedElement::Dummy_matrix</a>,</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    <a class="code" href="classoomph_1_1GeneralisedElement.html#a4bff11b8ff97aefabb2df41e61e1779f">GeneralisedElement::Dummy_matrix</a>,</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    0);</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;  }</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160; </div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;<span class="comment"> /// \short Add the element&#39;s contribution to its residual vector and </span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;<span class="comment"> /// the element Jacobian matrix (wrapper)</span></div>
<div class="line"><a name="l00304"></a><span class="lineno"><a class="line" href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#a9ed67207accc327c4d2bf614c4c452e0">  304</a></span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#a9ed67207accc327c4d2bf614c4c452e0">fill_in_contribution_to_jacobian</a>(<a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;<a class="code" href="the__data__structure_8txt.html#a1400a973def57b85051cfe1070be1810">residuals</a>,</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;                                       <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> &amp;jacobian)</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;  {</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;   <span class="comment">//Call the generic routine with the flag set to 1</span></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;   <a class="code" href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#ad97d019b2b4715d379adca3320262d29">fill_in_generic_residual_contribution_spherical_adv_diff</a>(</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    <a class="code" href="the__data__structure_8txt.html#a1400a973def57b85051cfe1070be1810">residuals</a>,</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    jacobian,</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    <a class="code" href="classoomph_1_1GeneralisedElement.html#a4bff11b8ff97aefabb2df41e61e1779f">GeneralisedElement::Dummy_matrix</a>,1);</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;  }</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="comment"> /// \short Add the element&#39;s contribution to its residual vector and </span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<span class="comment"> /// the element Jacobian matrix (wrapper) and mass matrix</span></div>
<div class="line"><a name="l00316"></a><span class="lineno"><a class="line" href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#a7aeb7cc67f60d713fd64321004229401">  316</a></span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#a7aeb7cc67f60d713fd64321004229401">fill_in_contribution_to_jacobian_and_mass_matrix</a>(</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;  <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;<a class="code" href="the__data__structure_8txt.html#a1400a973def57b85051cfe1070be1810">residuals</a>,</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;  <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> &amp;jacobian,</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;  <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> &amp;mass_matrix)</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;  {</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;   <span class="comment">//Call the generic routine with the flag set to 2</span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;   <a class="code" href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#ad97d019b2b4715d379adca3320262d29">fill_in_generic_residual_contribution_spherical_adv_diff</a>(</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    <a class="code" href="the__data__structure_8txt.html#a1400a973def57b85051cfe1070be1810">residuals</a>,</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    jacobian,</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    mass_matrix,2);</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;  }</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160; </div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160; </div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;<span class="comment"> /// Return FE representation of function value u(s) at local coordinate s</span></div>
<div class="line"><a name="l00331"></a><span class="lineno"><a class="line" href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#a25c6b912aba1088ed4759a7523a1d19a">  331</a></span>&#160;<span class="comment"></span> <span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#a25c6b912aba1088ed4759a7523a1d19a">interpolated_u_spherical_adv_diff</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>)<span class="keyword"> const</span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;   <span class="comment">//Find number of nodes</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_node = <a class="code" href="classoomph_1_1FiniteElement.html#a6219ed269a6d89b5aa14659cce48905a">nnode</a>();</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160; </div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;   <span class="comment">//Get the nodal index at which the unknown is stored</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> u_nodal_index = <a class="code" href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#a9a2928db14dc07aa3af1ee2dd7901dc5">u_index_spherical_adv_diff</a>();</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160; </div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;   <span class="comment">//Local shape function</span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;   <a class="code" href="classoomph_1_1Shape.html">Shape</a> psi(n_node);</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160; </div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;   <span class="comment">//Find values of shape function</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;   <a class="code" href="classoomph_1_1FiniteElement.html#a58a25b6859ddd43b7bfe64a19fee5023">shape</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,psi);</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160; </div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;   <span class="comment">//Initialise value of u</span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;   <span class="keywordtype">double</span> <a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a> = 0.0;</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160; </div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;   <span class="comment">//Loop over the local nodes and sum</span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l=0;l&lt;n_node;l++) </div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    {</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;     <a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a> += <a class="code" href="classoomph_1_1FiniteElement.html#a28fd5c2d4aeba5ef65bee0e0d72569f5">nodal_value</a>(l,u_nodal_index)*psi[l];</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    }</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160; </div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;   <span class="keywordflow">return</span>(<a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>);</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;  }</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160; </div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;<span class="comment"> ///\short Return derivative of u at point s with respect to all data</span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;<span class="comment"> ///that can affect its value.</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;<span class="comment"> ///In addition, return the global equation numbers corresponding to the</span></div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="comment"> ///data. This is virtual so that it can be overloaded in the</span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;<span class="comment"> ///refineable version</span></div>
<div class="line"><a name="l00363"></a><span class="lineno"><a class="line" href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#aec614fe14108871e1c47345b8cac97d7">  363</a></span>&#160;<span class="comment"></span> <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#aec614fe14108871e1c47345b8cac97d7">dinterpolated_u_adv_diff_ddata</a>(</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;  <span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>, </div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;  <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;du_ddata,</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;  <a class="code" href="classoomph_1_1Vector.html">Vector&lt;unsigned&gt;</a> &amp;global_eqn_number)</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;  {</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;   <span class="comment">//Find number of nodes</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_node = <a class="code" href="classoomph_1_1FiniteElement.html#a6219ed269a6d89b5aa14659cce48905a">nnode</a>();</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160; </div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;   <span class="comment">//Get the nodal index at which the unknown is stored</span></div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> u_nodal_index = <a class="code" href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#a9a2928db14dc07aa3af1ee2dd7901dc5">u_index_spherical_adv_diff</a>();</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160; </div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;   <span class="comment">//Local shape function</span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;   <a class="code" href="classoomph_1_1Shape.html">Shape</a> psi(n_node);</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160; </div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;   <span class="comment">//Find values of shape function</span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;   <a class="code" href="classoomph_1_1FiniteElement.html#a58a25b6859ddd43b7bfe64a19fee5023">shape</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,psi);</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160; </div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;   <span class="comment">//Find the number of dofs associated with interpolated u</span></div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;   <span class="keywordtype">unsigned</span> n_u_dof = 0;</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l=0;l&lt;n_node;l++) </div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    {</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;     <span class="keywordtype">int</span> global_eqn = this-&gt;<a class="code" href="classoomph_1_1FiniteElement.html#ace0e7fb72a805b5c2c600347bfae7a9b">node_pt</a>(l)-&gt;<a class="code" href="classoomph_1_1Data.html#a13206dcb7a088db0ef845ab71af505d2">eqn_number</a>(u_nodal_index);</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;     <span class="comment">//If it&#39;s positive add to the count</span></div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;     <span class="keywordflow">if</span> (global_eqn &gt;=0) </div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;      {</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;       ++n_u_dof;</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;      }</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    }</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;     </div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;   <span class="comment">//Now resize the storage schemes</span></div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;   du_ddata.resize(n_u_dof,0.0); </div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;   global_eqn_number.resize(n_u_dof,0);</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;   </div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;   <span class="comment">//Loop over the nodes again and set the derivatives</span></div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;   <span class="keywordtype">unsigned</span> count = 0;</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l=0;l&lt;n_node;l++)</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    {</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;     <span class="comment">//Get the global equation number</span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;     <span class="keywordtype">int</span> global_eqn=this-&gt;<a class="code" href="classoomph_1_1FiniteElement.html#ace0e7fb72a805b5c2c600347bfae7a9b">node_pt</a>(l)-&gt;<a class="code" href="classoomph_1_1Data.html#a13206dcb7a088db0ef845ab71af505d2">eqn_number</a>(u_nodal_index);</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;     <span class="comment">//If it&#39;s positive</span></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;     <span class="keywordflow">if</span> (global_eqn &gt;= 0)</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;      {</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;       <span class="comment">//Set the global equation number</span></div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;       global_eqn_number[count] = global_eqn;</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;       <span class="comment">//Set the derivative with respect to the unknown</span></div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;       du_ddata[count] = psi[l];</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;       <span class="comment">//Increase the counter</span></div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;       ++count;</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;      }</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    }</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;  }</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160; </div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;<span class="comment"> /// \short Self-test: Return 0 for OK</span></div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;<span class="comment"></span> <span class="keywordtype">unsigned</span> <a class="code" href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#a058fcdc912959c322e704d82d33cde6c">self_test</a>();</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160; </div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;<span class="keyword">protected</span>:</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;<span class="comment"> /// \short Shape/test functions and derivs w.r.t. to global coords at </span></div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;<span class="comment"> /// local coord. s; return  Jacobian of mapping</span></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;<span class="comment"></span> <span class="keyword">virtual</span> <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#adad87bb3578d688543743e139aa1d84f">dshape_and_dtest_eulerian_spherical_adv_diff</a>(</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;  <span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>, </div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;  <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;psi, </div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;  <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;dpsidx, </div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;  <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;test, </div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;                                                   <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;dtestdx) </div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;  <span class="keyword">const</span> = 0;</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;<span class="comment"> /// \short Shape/test functions and derivs w.r.t. to global coords at </span></div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;<span class="comment"> /// integration point ipt; return  Jacobian of mapping</span></div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;<span class="comment"></span> <span class="keyword">virtual</span> <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#a2b61d50b166871a64507ee13b8e94f54">dshape_and_dtest_eulerian_at_knot_spherical_adv_diff</a>(</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;ipt, </div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;  <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;psi, </div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;  <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;dpsidx,</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;  <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;test, </div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;  <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;dtestdx) </div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;  <span class="keyword">const</span> = 0;</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;<span class="comment"> /// \short Add the element&#39;s contribution to its residual vector only </span></div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;<span class="comment"> /// (if flag=and/or element  Jacobian matrix </span></div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;<span class="comment"></span> <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#ad97d019b2b4715d379adca3320262d29">fill_in_generic_residual_contribution_spherical_adv_diff</a>(</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;  <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;<a class="code" href="the__data__structure_8txt.html#a1400a973def57b85051cfe1070be1810">residuals</a>,  <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> &amp;jacobian, </div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;  <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> &amp;mass_matrix, <span class="keywordtype">unsigned</span> flag); </div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;  </div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160; <span class="comment">// Physical constants</span></div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;<span class="comment"> /// Pointer to global Peclet number</span></div>
<div class="line"><a name="l00450"></a><span class="lineno"><a class="line" href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#ab650e6ff8db720b2c7d061f885f1c628">  450</a></span>&#160;<span class="comment"></span> <span class="keywordtype">double</span> *<a class="code" href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#ab650e6ff8db720b2c7d061f885f1c628">Pe_pt</a>;</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;<span class="comment"> /// Pointer to global Peclet number multiplied by Strouhal number</span></div>
<div class="line"><a name="l00453"></a><span class="lineno"><a class="line" href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#a3fdb5e8765ae60ea6c218629e2cb207c">  453</a></span>&#160;<span class="comment"></span> <span class="keywordtype">double</span> *<a class="code" href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#a3fdb5e8765ae60ea6c218629e2cb207c">PeSt_pt</a>;</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;<span class="comment"> /// Pointer to source function:</span></div>
<div class="line"><a name="l00456"></a><span class="lineno"><a class="line" href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#a588bb8fcf23cd8bc38225f974d4cde7e">  456</a></span>&#160;<span class="comment"></span> <a class="code" href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#aa02d787c43f88e46ad5e21c7b299b5cb">SphericalAdvectionDiffusionSourceFctPt</a> <a class="code" href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#a588bb8fcf23cd8bc38225f974d4cde7e">Source_fct_pt</a>;</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;<span class="comment"> /// Pointer to wind function:</span></div>
<div class="line"><a name="l00459"></a><span class="lineno"><a class="line" href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#a6a8673efdb4df145804fbb92dccd1835">  459</a></span>&#160;<span class="comment"></span> <a class="code" href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#adef9c036e9f80c134078d8d78049199e">SphericalAdvectionDiffusionWindFctPt</a> <a class="code" href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#a6a8673efdb4df145804fbb92dccd1835">Wind_fct_pt</a>;</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160; </div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160; <span class="keyword">private</span>:</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;<span class="comment"> /// Static default value for the Peclet number</span></div>
<div class="line"><a name="l00464"></a><span class="lineno"><a class="line" href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#ab28f6e9b6c44a405e7ee7611df43e7c7">  464</a></span>&#160;<span class="comment"></span> <span class="keyword">static</span> <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#ab28f6e9b6c44a405e7ee7611df43e7c7">Default_peclet_number</a>;</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160; </div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;  </div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;};<span class="comment">//End class SphericalAdvectionDiffusionEquations</span></div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160; </div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;<span class="comment">///////////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;<span class="comment">///////////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;<span class="comment">///////////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160; </div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160; </div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;<span class="comment">//======================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;<span class="comment">/// \short QSphericalAdvectionDiffusionElement elements are </span></div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;<span class="comment">/// linear/quadrilateral/brick-shaped Axisymmetric Advection Diffusion </span></div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;<span class="comment">/// elements with isoparametric interpolation for the function.</span></div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;<span class="comment"></span><span class="comment">//======================================================================</span></div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;<span class="keyword">template</span> &lt;<span class="keywordtype">unsigned</span> NNODE_1D&gt;</div>
<div class="line"><a name="l00482"></a><span class="lineno"><a class="line" href="classoomph_1_1QSphericalAdvectionDiffusionElement.html">  482</a></span>&#160;<span class="keyword">class </span><a class="code" href="classoomph_1_1QSphericalAdvectionDiffusionElement.html">QSphericalAdvectionDiffusionElement</a> : <span class="keyword">public</span> <span class="keyword">virtual</span> <a class="code" href="classoomph_1_1QElement.html">QElement</a>&lt;2,NNODE_1D&gt;,</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;<span class="keyword">public</span> <span class="keyword">virtual</span> <a class="code" href="classoomph_1_1SphericalAdvectionDiffusionEquations.html">SphericalAdvectionDiffusionEquations</a></div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;{</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160; </div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;<span class="comment"> /// \short Static array of ints to hold number of variables at </span></div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;<span class="comment"> /// nodes: Initial_Nvalue[n]</span></div>
<div class="line"><a name="l00490"></a><span class="lineno"><a class="line" href="classoomph_1_1QSphericalAdvectionDiffusionElement.html#a8d490ed0cc7142335000801a905ed852">  490</a></span>&#160;<span class="comment"></span> <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <a class="code" href="classoomph_1_1QSphericalAdvectionDiffusionElement.html#a8d490ed0cc7142335000801a905ed852">Initial_Nvalue</a>;</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160; </div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160; </div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;<span class="comment"> ///\short Constructor: Call constructors for QElement and </span></div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;<span class="comment"> /// Advection Diffusion equations</span></div>
<div class="line"><a name="l00497"></a><span class="lineno"><a class="line" href="classoomph_1_1QSphericalAdvectionDiffusionElement.html#a7a82f6fad31e48bcc3fe1e1d7b818a74">  497</a></span>&#160;<span class="comment"></span> <a class="code" href="classoomph_1_1QSphericalAdvectionDiffusionElement.html#a7a82f6fad31e48bcc3fe1e1d7b818a74">QSphericalAdvectionDiffusionElement</a>() : <a class="code" href="classoomph_1_1QElement.html">QElement</a>&lt;2,NNODE_1D&gt;(), </div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160; <a class="code" href="classoomph_1_1SphericalAdvectionDiffusionEquations.html">SphericalAdvectionDiffusionEquations</a>()</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;  { }</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;<span class="comment"> /// Broken copy constructor</span></div>
<div class="line"><a name="l00502"></a><span class="lineno"><a class="line" href="classoomph_1_1QSphericalAdvectionDiffusionElement.html#a3ab4082df2e8a5d0c6dc95432487ba71">  502</a></span>&#160;<span class="comment"></span> <a class="code" href="classoomph_1_1QSphericalAdvectionDiffusionElement.html#a3ab4082df2e8a5d0c6dc95432487ba71">QSphericalAdvectionDiffusionElement</a>(</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;  <span class="keyword">const</span> <a class="code" href="classoomph_1_1QSphericalAdvectionDiffusionElement.html">QSphericalAdvectionDiffusionElement&lt;NNODE_1D&gt;</a>&amp; dummy) </div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;  { </div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;   <a class="code" href="namespaceoomph_1_1BrokenCopy.html#a7e5cd7fda8b8c790003151bee77a84ac">BrokenCopy::broken_copy</a>(<span class="stringliteral">&quot;QSphericalAdvectionDiffusionElement&quot;</span>);</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;  } </div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;<span class="comment"> /// Broken assignment operator</span></div>
<div class="line"><a name="l00509"></a><span class="lineno"><a class="line" href="classoomph_1_1QSphericalAdvectionDiffusionElement.html#ade39bb468f6f05959ae31698b40cde10">  509</a></span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1QSphericalAdvectionDiffusionElement.html#ade39bb468f6f05959ae31698b40cde10">operator=</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1QSphericalAdvectionDiffusionElement.html">QSphericalAdvectionDiffusionElement&lt;NNODE_1D&gt;</a>&amp;) </div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;  {</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;   <a class="code" href="namespaceoomph_1_1BrokenCopy.html#a32dc384e671e786bac0c67cbff701f45">BrokenCopy::broken_assign</a>(<span class="stringliteral">&quot;QSphericalAdvectionDiffusionElement&quot;</span>);</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;  }</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;<span class="comment"> /// \short  Required  # of `values&#39; (pinned or dofs) </span></div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;<span class="comment"> /// at node n</span></div>
<div class="line"><a name="l00516"></a><span class="lineno"><a class="line" href="classoomph_1_1QSphericalAdvectionDiffusionElement.html#acd51b557de9302ded1dd48c72760d3df">  516</a></span>&#160;<span class="comment"></span> <span class="keyword">inline</span> <span class="keywordtype">unsigned</span> <a class="code" href="classoomph_1_1QSphericalAdvectionDiffusionElement.html#acd51b557de9302ded1dd48c72760d3df">required_nvalue</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;<a class="code" href="the__data__structure_8txt.html#af88b2d950fae19ab641bd1690e08445c">n</a>)<span class="keyword"> const </span></div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="classoomph_1_1QSphericalAdvectionDiffusionElement.html#a8d490ed0cc7142335000801a905ed852">Initial_Nvalue</a>;</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;  }</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;<span class="comment"> /// \short Output function:  </span></div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;<span class="comment"> ///  r,z,u</span></div>
<div class="line"><a name="l00523"></a><span class="lineno"><a class="line" href="classoomph_1_1QSphericalAdvectionDiffusionElement.html#addf1f59cc684120c3063774ce75a72a4">  523</a></span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1QSphericalAdvectionDiffusionElement.html#addf1f59cc684120c3063774ce75a72a4">output</a>(std::ostream &amp;outfile)</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;  {</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;   <a class="code" href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#a4b4f59d82dd7b2e1641eba4b91d54d40">SphericalAdvectionDiffusionEquations::output</a>(outfile);</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;  }</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;<span class="comment"> /// \short Output function:  </span></div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;<span class="comment"> ///  r,z,u  at n_plot^2 plot points</span></div>
<div class="line"><a name="l00530"></a><span class="lineno"><a class="line" href="classoomph_1_1QSphericalAdvectionDiffusionElement.html#abc3c98e85e168e66999ccae5a35e0987">  530</a></span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1QSphericalAdvectionDiffusionElement.html#abc3c98e85e168e66999ccae5a35e0987">output</a>(std::ostream &amp;outfile, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;n_plot)</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;  {</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;   <a class="code" href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#a4b4f59d82dd7b2e1641eba4b91d54d40">SphericalAdvectionDiffusionEquations::output</a>(outfile,n_plot);</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;  }</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160; </div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;<span class="comment"> /// \short C-style output function:  </span></div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;<span class="comment"> ///  r,z,u</span></div>
<div class="line"><a name="l00538"></a><span class="lineno"><a class="line" href="classoomph_1_1QSphericalAdvectionDiffusionElement.html#a160d448e9026e125714d38a4550676a4">  538</a></span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1QSphericalAdvectionDiffusionElement.html#a160d448e9026e125714d38a4550676a4">output</a>(FILE* file_pt)</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;  {</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;   <a class="code" href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#a4b4f59d82dd7b2e1641eba4b91d54d40">SphericalAdvectionDiffusionEquations::output</a>(file_pt);</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;  }</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;<span class="comment"> ///  \short C-style output function:  </span></div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;<span class="comment"> ///   r,z,u at n_plot^2 plot points</span></div>
<div class="line"><a name="l00545"></a><span class="lineno"><a class="line" href="classoomph_1_1QSphericalAdvectionDiffusionElement.html#a16854bbf99abd7b8512474992a29f72b">  545</a></span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1QSphericalAdvectionDiffusionElement.html#a16854bbf99abd7b8512474992a29f72b">output</a>(FILE* file_pt, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;n_plot)</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;  {</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;   <a class="code" href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#a4b4f59d82dd7b2e1641eba4b91d54d40">SphericalAdvectionDiffusionEquations::output</a>(file_pt,n_plot);</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;  }</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;<span class="comment"> /// \short Output function for an exact solution:</span></div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;<span class="comment"> ///  r,z,u_exact at n_plot^2 plot points</span></div>
<div class="line"><a name="l00552"></a><span class="lineno"><a class="line" href="classoomph_1_1QSphericalAdvectionDiffusionElement.html#ae67830606f8940978529b305794ec98d">  552</a></span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1QSphericalAdvectionDiffusionElement.html#ae67830606f8940978529b305794ec98d">output_fct</a>(std::ostream &amp;outfile, </div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;                 <span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;n_plot,</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;                 <a class="code" href="classoomph_1_1FiniteElement.html#a690fd33af26cc3e84f39bba6d5a85202">FiniteElement::SteadyExactSolutionFctPt</a> exact_soln_pt)</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;  {</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;   <a class="code" href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#a2fcb664a740cfb2a645b0e1893a00773">SphericalAdvectionDiffusionEquations::output_fct</a>(outfile,n_plot,exact_soln_pt);</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;  }</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160; </div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160; </div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;<span class="keyword">protected</span>:</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;<span class="comment"> /// Shape, test functions &amp; derivs. w.r.t. to global coords. Return Jacobian.</span></div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;<span class="comment"></span> <span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1QSphericalAdvectionDiffusionElement.html#a75d5e8f33411030e31e82da809d946d2">dshape_and_dtest_eulerian_spherical_adv_diff</a>(</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;  <span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>, </div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;  <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;psi, </div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;  <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;dpsidx, </div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;  <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;test, </div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;  <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;dtestdx) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;<span class="comment"> /// \short Shape, test functions &amp; derivs. w.r.t. to global coords. at</span></div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;<span class="comment"> /// integration point ipt. Return Jacobian.</span></div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;<span class="comment"></span> <span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1QSphericalAdvectionDiffusionElement.html#ac15987174b58e77489aa6e5f12b9db81">dshape_and_dtest_eulerian_at_knot_spherical_adv_diff</a>(</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; ipt,</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;  <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;psi, </div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;  <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;dpsidx, </div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;  <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;test,</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;  <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;dtestdx) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160; </div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;};<span class="comment">//End class QSphericalAdvectionDiffusionElement</span></div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160; </div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;<span class="comment">//Inline functions:</span></div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160; </div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;<span class="comment">//======================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;<span class="comment">/// \short Define the shape functions and test functions and derivatives</span></div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;<span class="comment">/// w.r.t. global coordinates and return Jacobian of mapping.</span></div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;<span class="comment">/// Galerkin: Test functions = shape functions</span></div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;<span class="comment"></span><span class="comment">//======================================================================</span></div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160; </div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;<span class="keyword">template</span>&lt;<span class="keywordtype">unsigned</span> NNODE_1D&gt;</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;<span class="keywordtype">double</span> <a class="code" href="classoomph_1_1QSphericalAdvectionDiffusionElement.html#a75d5e8f33411030e31e82da809d946d2">QSphericalAdvectionDiffusionElement&lt;NNODE_1D&gt;::</a></div>
<div class="line"><a name="l00592"></a><span class="lineno"><a class="line" href="classoomph_1_1QSphericalAdvectionDiffusionElement.html#a75d5e8f33411030e31e82da809d946d2">  592</a></span>&#160;<a class="code" href="classoomph_1_1QSphericalAdvectionDiffusionElement.html#a75d5e8f33411030e31e82da809d946d2">dshape_and_dtest_eulerian_spherical_adv_diff</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;                                             <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;psi, </div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;                                             <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;dpsidx,</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;                                             <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;test, </div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;                                             <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;dtestdx)<span class="keyword"> const</span></div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160; <span class="comment">//Call the geometrical shape functions and derivatives  </span></div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160; <span class="keywordtype">double</span> J = this-&gt;dshape_eulerian(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,psi,dpsidx);</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160; </div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160; <span class="comment">//Loop over the test functions and derivatives and set them equal to the</span></div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160; <span class="comment">//shape functions</span></div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160; <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;NNODE_1D;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;  {</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;   test[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] = psi[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]; </div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> j=0;j&lt;2;j++)</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;    {</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;     dtestdx(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>,j) = dpsidx(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>,j);</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;    }</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;  }</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160; </div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160; <span class="comment">//Return the jacobian</span></div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160; <span class="keywordflow">return</span> J;</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;}</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160; </div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160; </div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160; </div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;<span class="comment">//======================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;<span class="comment">/// \short Define the shape functions and test functions and derivatives</span></div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;<span class="comment">/// w.r.t. global coordinates and return Jacobian of mapping.</span></div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;<span class="comment">/// Galerkin: Test functions = shape functions</span></div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;<span class="comment"></span><span class="comment">//======================================================================</span></div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160; </div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;<span class="keyword">template</span>&lt;<span class="keywordtype">unsigned</span> NNODE_1D&gt;</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;<span class="keywordtype">double</span> <a class="code" href="classoomph_1_1QSphericalAdvectionDiffusionElement.html#ac15987174b58e77489aa6e5f12b9db81">QSphericalAdvectionDiffusionElement&lt;NNODE_1D&gt;::</a></div>
<div class="line"><a name="l00627"></a><span class="lineno"><a class="line" href="classoomph_1_1QSphericalAdvectionDiffusionElement.html#ac15987174b58e77489aa6e5f12b9db81">  627</a></span>&#160;<a class="code" href="classoomph_1_1QSphericalAdvectionDiffusionElement.html#ac15987174b58e77489aa6e5f12b9db81">dshape_and_dtest_eulerian_at_knot_spherical_adv_diff</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;ipt,</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;                                                     <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;psi, </div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;                                                     <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;dpsidx,</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;                                                     <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;test, </div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;                                                     <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;dtestdx)<span class="keyword"> const</span></div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160; <span class="comment">//Call the geometrical shape functions and derivatives  </span></div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160; <span class="keywordtype">double</span> J = this-&gt;dshape_eulerian_at_knot(ipt,psi,dpsidx);</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160; </div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160; <span class="comment">//Set the test functions equal to the shape functions (pointer copy)</span></div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160; test = psi;</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160; dtestdx = dpsidx;</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160; </div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160; <span class="comment">//Return the jacobian</span></div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160; <span class="keywordflow">return</span> J;</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;}</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;<span class="keyword">template</span>&lt;<span class="keywordtype">unsigned</span> NNODE_1D&gt;</div>
<div class="line"><a name="l00649"></a><span class="lineno"><a class="line" href="classoomph_1_1FaceGeometry_3_01QSphericalAdvectionDiffusionElement_3_01NNODE__1D_01_4_01_4.html">  649</a></span>&#160;<span class="keyword">class </span><a class="code" href="classoomph_1_1FaceGeometry.html">FaceGeometry</a>&lt;<a class="code" href="classoomph_1_1QSphericalAdvectionDiffusionElement.html">QSphericalAdvectionDiffusionElement</a>&lt;NNODE_1D&gt; &gt;: </div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;<span class="keyword">public</span> <span class="keyword">virtual</span>  <a class="code" href="classoomph_1_1QElement.html">QElement</a>&lt;1,NNODE_1D&gt;</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;{</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160; </div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;  <span class="keyword">public</span>:</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;<span class="comment"> /// \short Constructor: Call the constructor for the</span></div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;<span class="comment"> /// appropriate lower-dimensional QElement</span></div>
<div class="line"><a name="l00657"></a><span class="lineno"><a class="line" href="classoomph_1_1FaceGeometry_3_01QSphericalAdvectionDiffusionElement_3_01NNODE__1D_01_4_01_4.html#a8ed2838c5dacbfa9facfb20466a60039">  657</a></span>&#160;<span class="comment"></span> <a class="code" href="classoomph_1_1FaceGeometry_3_01QSphericalAdvectionDiffusionElement_3_01NNODE__1D_01_4_01_4.html#a8ed2838c5dacbfa9facfb20466a60039">FaceGeometry</a>() : <a class="code" href="classoomph_1_1QElement.html">QElement</a>&lt;1,NNODE_1D&gt;() {}</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160; </div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;};</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160; </div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160; </div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160; </div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;<span class="comment">//======================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;<span class="comment">/// \short A class for elements that allow the imposition of an </span></div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;<span class="comment">/// applied Robin boundary condition on the boundaries of Steady </span></div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;<span class="comment">/// Axisymmnetric Advection Diffusion Flux elements.</span></div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;<span class="comment">/// \f[ </span></div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;<span class="comment">/// -\Delta u \cdot \mathbf{n} + \alpha(r,z) u = \beta(r,z) </span></div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;<span class="comment">/// \f] </span></div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;<span class="comment">/// The element geometry is obtained from the FaceGeometry&lt;ELEMENT&gt; </span></div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;<span class="comment">/// policy class.</span></div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;<span class="comment"></span><span class="comment">//======================================================================</span></div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> ELEMENT&gt;</div>
<div class="line"><a name="l00679"></a><span class="lineno"><a class="line" href="classoomph_1_1SphericalAdvectionDiffusionFluxElement.html">  679</a></span>&#160;<span class="keyword">class </span><a class="code" href="classoomph_1_1SphericalAdvectionDiffusionFluxElement.html">SphericalAdvectionDiffusionFluxElement</a> : </div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;<span class="keyword">public</span> <span class="keyword">virtual</span> <a class="code" href="classoomph_1_1FaceGeometry.html">FaceGeometry</a>&lt;ELEMENT&gt;, </div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160; <span class="keyword">public</span> <span class="keyword">virtual</span> <a class="code" href="classoomph_1_1FaceElement.html">FaceElement</a></div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;{</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160; </div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160; </div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;<span class="comment"> /// \short Function pointer to the prescribed-beta function fct(x,beta(x)) -- </span></div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;<span class="comment"> /// x is a Vector! </span></div>
<div class="line"><a name="l00689"></a><span class="lineno"><a class="line" href="classoomph_1_1SphericalAdvectionDiffusionFluxElement.html#a1fe86f85817dd5621ab510d37b3a8ce8">  689</a></span>&#160;<span class="comment"></span> <span class="keyword">typedef</span> void (*<a class="code" href="classoomph_1_1SphericalAdvectionDiffusionFluxElement.html#a1fe86f85817dd5621ab510d37b3a8ce8">SphericalAdvectionDiffusionPrescribedBetaFctPt</a>)(</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;  <span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; x, </div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;  <span class="keywordtype">double</span>&amp; beta);</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;<span class="comment"> /// \short Function pointer to the prescribed-alpha function fct(x,alpha(x)) -- </span></div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;<span class="comment"> /// x is a Vector! </span></div>
<div class="line"><a name="l00695"></a><span class="lineno"><a class="line" href="classoomph_1_1SphericalAdvectionDiffusionFluxElement.html#aabc503a4eeac639334283e7297b88423">  695</a></span>&#160;<span class="comment"></span> <span class="keyword">typedef</span> void (*<a class="code" href="classoomph_1_1SphericalAdvectionDiffusionFluxElement.html#aabc503a4eeac639334283e7297b88423">SphericalAdvectionDiffusionPrescribedAlphaFctPt</a>)(</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;  <span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; x, </div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;  <span class="keywordtype">double</span>&amp; alpha);</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160; </div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;<span class="comment"> /// \short Constructor, takes the pointer to the &quot;bulk&quot; element</span></div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;<span class="comment"> /// and the index of the face to be created</span></div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;<span class="comment"></span> <a class="code" href="classoomph_1_1SphericalAdvectionDiffusionFluxElement.html#afd26b6adc3a9a6402b38a3c15fc16c0a">SphericalAdvectionDiffusionFluxElement</a>(<a class="code" href="classoomph_1_1FiniteElement.html">FiniteElement</a>* <span class="keyword">const</span> &amp;bulk_el_pt, </div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;                                        <span class="keyword">const</span> <span class="keywordtype">int</span> &amp;<a class="code" href="classoomph_1_1FaceElement.html#a478d577ac6db67ecc80f1f02ae3ab170">face_index</a>);</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160; </div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;<span class="comment"> /// Broken empty constructor</span></div>
<div class="line"><a name="l00707"></a><span class="lineno"><a class="line" href="classoomph_1_1SphericalAdvectionDiffusionFluxElement.html#afd26b6adc3a9a6402b38a3c15fc16c0a">  707</a></span>&#160;<span class="comment"></span> <a class="code" href="classoomph_1_1SphericalAdvectionDiffusionFluxElement.html#afd26b6adc3a9a6402b38a3c15fc16c0a">SphericalAdvectionDiffusionFluxElement</a>()</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;  {</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;   <span class="keywordflow">throw</span> <a class="code" href="classoomph_1_1OomphLibError.html">OomphLibError</a>(</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;    <span class="stringliteral">&quot;Don&#39;t call empty constructor for SphericalAdvectionDiffusionFluxElement&quot;</span>,</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;    OOMPH_CURRENT_FUNCTION,</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;    OOMPH_EXCEPTION_LOCATION);</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;  }</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;<span class="comment"> /// Broken copy constructor</span></div>
<div class="line"><a name="l00716"></a><span class="lineno"><a class="line" href="classoomph_1_1SphericalAdvectionDiffusionFluxElement.html#a85e2f9e5a93f978b21cbf6d425d8c991">  716</a></span>&#160;<span class="comment"></span> <a class="code" href="classoomph_1_1SphericalAdvectionDiffusionFluxElement.html#a85e2f9e5a93f978b21cbf6d425d8c991">SphericalAdvectionDiffusionFluxElement</a>(</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;  <span class="keyword">const</span> <a class="code" href="classoomph_1_1SphericalAdvectionDiffusionFluxElement.html">SphericalAdvectionDiffusionFluxElement</a>&amp; dummy) </div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;  { </div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;   <a class="code" href="namespaceoomph_1_1BrokenCopy.html#a7e5cd7fda8b8c790003151bee77a84ac">BrokenCopy::broken_copy</a>(<span class="stringliteral">&quot;SphericalAdvectionDiffusionFluxElement&quot;</span>);</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;  } </div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;<span class="comment"> /// Broken assignment operator</span></div>
<div class="line"><a name="l00723"></a><span class="lineno"><a class="line" href="classoomph_1_1SphericalAdvectionDiffusionFluxElement.html#afbcbd2ed140bb94e69d518fcc60960d8">  723</a></span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1SphericalAdvectionDiffusionFluxElement.html#afbcbd2ed140bb94e69d518fcc60960d8">operator=</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1SphericalAdvectionDiffusionFluxElement.html">SphericalAdvectionDiffusionFluxElement</a>&amp;) </div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;  {</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;   <a class="code" href="namespaceoomph_1_1BrokenCopy.html#a32dc384e671e786bac0c67cbff701f45">BrokenCopy::broken_assign</a>(<span class="stringliteral">&quot;SphericalAdvectionDiffusionFluxElement&quot;</span>);</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;  }</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;<span class="comment"> /// Access function for the prescribed-beta function pointer</span></div>
<div class="line"><a name="l00729"></a><span class="lineno"><a class="line" href="classoomph_1_1SphericalAdvectionDiffusionFluxElement.html#a3e9d700a25464270aae4cfb8ac0abb66">  729</a></span>&#160;<span class="comment"></span> <a class="code" href="classoomph_1_1SphericalAdvectionDiffusionFluxElement.html#a1fe86f85817dd5621ab510d37b3a8ce8">SphericalAdvectionDiffusionPrescribedBetaFctPt</a>&amp; <a class="code" href="classoomph_1_1SphericalAdvectionDiffusionFluxElement.html#a3e9d700a25464270aae4cfb8ac0abb66">beta_fct_pt</a>() </div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;  {</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="classoomph_1_1SphericalAdvectionDiffusionFluxElement.html#afac22354e3e360de61691047efe82be3">Beta_fct_pt</a>;</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;  }</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;<span class="comment"> /// Access function for the prescribed-alpha function pointer</span></div>
<div class="line"><a name="l00735"></a><span class="lineno"><a class="line" href="classoomph_1_1SphericalAdvectionDiffusionFluxElement.html#ab84762e928d94711e2f77339c3f9ee49">  735</a></span>&#160;<span class="comment"></span> <a class="code" href="classoomph_1_1SphericalAdvectionDiffusionFluxElement.html#aabc503a4eeac639334283e7297b88423">SphericalAdvectionDiffusionPrescribedAlphaFctPt</a>&amp; <a class="code" href="classoomph_1_1SphericalAdvectionDiffusionFluxElement.html#ab84762e928d94711e2f77339c3f9ee49">alpha_fct_pt</a>() </div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;  {</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="classoomph_1_1SphericalAdvectionDiffusionFluxElement.html#a0d9b714320a27d346fa8d0ccc1ef4148">Alpha_fct_pt</a>;</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;  }</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160; </div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;<span class="comment"> /// Add the element&#39;s contribution to its residual vector</span></div>
<div class="line"><a name="l00742"></a><span class="lineno"><a class="line" href="classoomph_1_1SphericalAdvectionDiffusionFluxElement.html#ac8579ca5c2ad606199559db1f971d13b">  742</a></span>&#160;<span class="comment"></span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1SphericalAdvectionDiffusionFluxElement.html#ac8579ca5c2ad606199559db1f971d13b">fill_in_contribution_to_residuals</a>(<a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;<a class="code" href="the__data__structure_8txt.html#a1400a973def57b85051cfe1070be1810">residuals</a>)</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;  {</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;   <span class="comment">//Call the generic residuals function with flag set to 0</span></div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;   <span class="comment">//using a dummy matrix</span></div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;   <a class="code" href="classoomph_1_1SphericalAdvectionDiffusionFluxElement.html#a7dd7a4627052f615642c64eea143e4c5">fill_in_generic_residual_contribution_spherical_adv_diff_flux</a>(</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;    <a class="code" href="the__data__structure_8txt.html#a1400a973def57b85051cfe1070be1810">residuals</a>,</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;    <a class="code" href="classoomph_1_1GeneralisedElement.html#a4bff11b8ff97aefabb2df41e61e1779f">GeneralisedElement::Dummy_matrix</a>,0);</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;  }</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160; </div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;<span class="comment"> /// \short Add the element&#39;s contribution to its residual vector and </span></div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;<span class="comment"> /// its Jacobian matrix</span></div>
<div class="line"><a name="l00754"></a><span class="lineno"><a class="line" href="classoomph_1_1SphericalAdvectionDiffusionFluxElement.html#a3863a02374ac70bacd47face3285d469">  754</a></span>&#160;<span class="comment"></span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1SphericalAdvectionDiffusionFluxElement.html#a3863a02374ac70bacd47face3285d469">fill_in_contribution_to_jacobian</a>(<a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;<a class="code" href="the__data__structure_8txt.html#a1400a973def57b85051cfe1070be1810">residuals</a>,</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;                                              <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> &amp;jacobian)</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;  {</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;   <span class="comment">//Call the generic routine with the flag set to 1</span></div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;   <a class="code" href="classoomph_1_1SphericalAdvectionDiffusionFluxElement.html#a7dd7a4627052f615642c64eea143e4c5">fill_in_generic_residual_contribution_spherical_adv_diff_flux</a>(<a class="code" href="the__data__structure_8txt.html#a1400a973def57b85051cfe1070be1810">residuals</a>,</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;                                                       jacobian,</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;                                                       1);</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;  }</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;<span class="comment"> /// Specify the value of nodal zeta from the face geometry</span></div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;<span class="comment"> /// \short The &quot;global&quot; intrinsic coordinate of the element when</span></div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;<span class="comment"> /// viewed as part of a geometric object should be given by</span></div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;<span class="comment"> /// the FaceElement representation, by default (needed to break</span></div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;<span class="comment"> /// indeterminacy if bulk element is SolidElement)</span></div>
<div class="line"><a name="l00768"></a><span class="lineno"><a class="line" href="classoomph_1_1SphericalAdvectionDiffusionFluxElement.html#ab7dc1526807ada4b9189526b69653c91">  768</a></span>&#160;<span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1SphericalAdvectionDiffusionFluxElement.html#ab7dc1526807ada4b9189526b69653c91">zeta_nodal</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;<a class="code" href="the__data__structure_8txt.html#af88b2d950fae19ab641bd1690e08445c">n</a>, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;k,           </div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;                   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>)<span class="keyword"> const </span></div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;<span class="keyword"> </span>{<span class="keywordflow">return</span> <a class="code" href="classoomph_1_1FaceElement.html#a58c9f93705c7741f76c8487d152e68a6">FaceElement::zeta_nodal</a>(<a class="code" href="the__data__structure_8txt.html#af88b2d950fae19ab641bd1690e08445c">n</a>,k,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>);}     </div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;<span class="comment"> /// \short Output function -- forward to broken version in FiniteElement</span></div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;<span class="comment"> /// until somebody decides what exactly they want to plot here...</span></div>
<div class="line"><a name="l00774"></a><span class="lineno"><a class="line" href="classoomph_1_1SphericalAdvectionDiffusionFluxElement.html#a9ac365607431a072d3adc043cf057611">  774</a></span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1SphericalAdvectionDiffusionFluxElement.html#a9ac365607431a072d3adc043cf057611">output</a>(std::ostream &amp;outfile) </div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;  {</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;   <a class="code" href="classoomph_1_1FiniteElement.html#a2ad98a3d2ef4999f1bef62c0ff13f2a7">FiniteElement::output</a>(outfile);</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;  }</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;<span class="comment"> /// \short Output function -- forward to broken version in FiniteElement</span></div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;<span class="comment"> /// until somebody decides what exactly they want to plot here...</span></div>
<div class="line"><a name="l00781"></a><span class="lineno"><a class="line" href="classoomph_1_1SphericalAdvectionDiffusionFluxElement.html#a80df265285debfbfbffd4a48df4a2152">  781</a></span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1SphericalAdvectionDiffusionFluxElement.html#a80df265285debfbfbffd4a48df4a2152">output</a>(std::ostream &amp;outfile, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;nplot)</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;  {</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;   <a class="code" href="classoomph_1_1FiniteElement.html#a2ad98a3d2ef4999f1bef62c0ff13f2a7">FiniteElement::output</a>(outfile,nplot);</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;  }</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160; </div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160; </div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;<span class="keyword">protected</span>:</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;<span class="comment"> /// \short Function to compute the shape and test functions and to return </span></div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;<span class="comment"> /// the Jacobian of mapping between local and global (Eulerian)</span></div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;<span class="comment"> /// coordinates</span></div>
<div class="line"><a name="l00792"></a><span class="lineno"><a class="line" href="classoomph_1_1SphericalAdvectionDiffusionFluxElement.html#ae68704bbc324e11392b724b6e3406eb8">  792</a></span>&#160;<span class="comment"></span> <span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1SphericalAdvectionDiffusionFluxElement.html#ae68704bbc324e11392b724b6e3406eb8">shape_and_test</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>, </div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;                              <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;psi, </div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;                              <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;test)<span class="keyword"> const</span></div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;   <span class="comment">//Find number of nodes</span></div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;   <span class="keywordtype">unsigned</span> n_node = <a class="code" href="classoomph_1_1FiniteElement.html#a6219ed269a6d89b5aa14659cce48905a">nnode</a>();</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160; </div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;   <span class="comment">//Get the shape functions</span></div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;   <a class="code" href="classoomph_1_1FiniteElement.html#a58a25b6859ddd43b7bfe64a19fee5023">shape</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,psi);</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160; </div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;   <span class="comment">//Set the test functions to be the same as the shape functions</span></div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;n_node;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++) </div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;    {</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;     test[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] = psi[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>];</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;    }</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160; </div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;   <span class="comment">//Return the value of the jacobian</span></div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="classoomph_1_1FaceElement.html#a919d0d76746eaa78a8a3c7f75f99a9e5">J_eulerian</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>);</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;  }</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160; </div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;<span class="comment"> /// \short Function to compute the shape and test functions and to return </span></div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;<span class="comment"> /// the Jacobian of mapping between local and global (Eulerian)</span></div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;<span class="comment"> /// coordinates</span></div>
<div class="line"><a name="l00816"></a><span class="lineno"><a class="line" href="classoomph_1_1SphericalAdvectionDiffusionFluxElement.html#a34f7cc1f18c22b23e553cc9f0144a48d">  816</a></span>&#160;<span class="comment"></span> <span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1SphericalAdvectionDiffusionFluxElement.html#a34f7cc1f18c22b23e553cc9f0144a48d">shape_and_test_at_knot</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;ipt,</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;                                      <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;psi, </div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;                                      <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;test)<span class="keyword"> const</span></div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;   <span class="comment">//Find number of nodes</span></div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;   <span class="keywordtype">unsigned</span> n_node = <a class="code" href="classoomph_1_1FiniteElement.html#a6219ed269a6d89b5aa14659cce48905a">nnode</a>();</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160; </div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;   <span class="comment">//Get the shape functions</span></div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;   <a class="code" href="classoomph_1_1FiniteElement.html#aeccc0f774e3fab8c536e2d41004a1665">shape_at_knot</a>(ipt,psi);</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160; </div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;   <span class="comment">//Set the test functions to be the same as the shape functions</span></div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;n_node;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++) </div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;    {</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;     test[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] = psi[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>];</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;    }</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160; </div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;   <span class="comment">//Return the value of the jacobian</span></div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="classoomph_1_1FaceElement.html#aa6380a08afc18bd4f35e337a1131a9d8">J_eulerian_at_knot</a>(ipt);</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;  }</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;<span class="comment"> /// \short Function to calculate the prescribed beta at a given spatial</span></div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;<span class="comment"> /// position</span></div>
<div class="line"><a name="l00838"></a><span class="lineno"><a class="line" href="classoomph_1_1SphericalAdvectionDiffusionFluxElement.html#a7ba9d40e23873038895ec070b9bc29ad">  838</a></span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1SphericalAdvectionDiffusionFluxElement.html#a7ba9d40e23873038895ec070b9bc29ad">get_beta</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; x, <span class="keywordtype">double</span>&amp; beta)</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;  {</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;   <span class="comment">//If the function pointer is zero return zero</span></div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;   <span class="keywordflow">if</span>(<a class="code" href="classoomph_1_1SphericalAdvectionDiffusionFluxElement.html#afac22354e3e360de61691047efe82be3">Beta_fct_pt</a> == 0)</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;    {</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;     beta = 0.0;</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;    }</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;   <span class="comment">//Otherwise call the function</span></div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;   <span class="keywordflow">else</span></div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;    {</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;     (*Beta_fct_pt)(x,beta);</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;    }</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;  }</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;<span class="comment"> /// \short Function to calculate the prescribed alpha at a given spatial</span></div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;<span class="comment"> /// position</span></div>
<div class="line"><a name="l00854"></a><span class="lineno"><a class="line" href="classoomph_1_1SphericalAdvectionDiffusionFluxElement.html#a1e3a162c505bc7719da00e30f8c6cb58">  854</a></span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1SphericalAdvectionDiffusionFluxElement.html#a1e3a162c505bc7719da00e30f8c6cb58">get_alpha</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; x, <span class="keywordtype">double</span>&amp; alpha)</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;  {</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;   <span class="comment">//If the function pointer is zero return zero</span></div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;   <span class="keywordflow">if</span>(<a class="code" href="classoomph_1_1SphericalAdvectionDiffusionFluxElement.html#a0d9b714320a27d346fa8d0ccc1ef4148">Alpha_fct_pt</a> == 0)</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;    {</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;     alpha = 0.0;</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;    }</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;   <span class="comment">//Otherwise call the function</span></div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;   <span class="keywordflow">else</span></div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;    {</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;     (*Alpha_fct_pt)(x,alpha);</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;    }</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;  }</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160; </div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160; </div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;<span class="comment"> /// \short Add the element&#39;s contribution to its residual vector.</span></div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;<span class="comment"> /// flag=1(or 0): do (or don&#39;t) compute the Jacobian as well. </span></div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1SphericalAdvectionDiffusionFluxElement.html#a7dd7a4627052f615642c64eea143e4c5">fill_in_generic_residual_contribution_spherical_adv_diff_flux</a>(</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;  <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;<a class="code" href="the__data__structure_8txt.html#a1400a973def57b85051cfe1070be1810">residuals</a>, <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> &amp;jacobian, </div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;  <span class="keywordtype">unsigned</span> flag);</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160; </div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;<span class="comment"> /// Function pointer to the (global) prescribed-beta function</span></div>
<div class="line"><a name="l00879"></a><span class="lineno"><a class="line" href="classoomph_1_1SphericalAdvectionDiffusionFluxElement.html#afac22354e3e360de61691047efe82be3">  879</a></span>&#160;<span class="comment"></span> <a class="code" href="classoomph_1_1SphericalAdvectionDiffusionFluxElement.html#a1fe86f85817dd5621ab510d37b3a8ce8">SphericalAdvectionDiffusionPrescribedBetaFctPt</a> <a class="code" href="classoomph_1_1SphericalAdvectionDiffusionFluxElement.html#afac22354e3e360de61691047efe82be3">Beta_fct_pt</a>;</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;<span class="comment"> /// Function pointer to the (global) prescribed-alpha function</span></div>
<div class="line"><a name="l00882"></a><span class="lineno"><a class="line" href="classoomph_1_1SphericalAdvectionDiffusionFluxElement.html#a0d9b714320a27d346fa8d0ccc1ef4148">  882</a></span>&#160;<span class="comment"></span> <a class="code" href="classoomph_1_1SphericalAdvectionDiffusionFluxElement.html#aabc503a4eeac639334283e7297b88423">SphericalAdvectionDiffusionPrescribedAlphaFctPt</a> <a class="code" href="classoomph_1_1SphericalAdvectionDiffusionFluxElement.html#a0d9b714320a27d346fa8d0ccc1ef4148">Alpha_fct_pt</a>;</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;<span class="comment"> /// The index at which the unknown is stored at the nodes</span></div>
<div class="line"><a name="l00885"></a><span class="lineno"><a class="line" href="classoomph_1_1SphericalAdvectionDiffusionFluxElement.html#a03f3019943b1bd0d2818882c08f955f4">  885</a></span>&#160;<span class="comment"></span> <span class="keywordtype">unsigned</span> <a class="code" href="classoomph_1_1SphericalAdvectionDiffusionFluxElement.html#a03f3019943b1bd0d2818882c08f955f4">U_index_adv_diff</a>;</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160; </div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160; </div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;};<span class="comment">//End class SphericalAdvectionDiffusionFluxElement</span></div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160; </div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;<span class="comment">///////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;<span class="comment">///////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;<span class="comment">///////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160; </div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;<span class="comment">//===========================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;<span class="comment">/// \short Constructor, takes the pointer to the &quot;bulk&quot; element and the index</span></div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;<span class="comment">/// of the face to be created </span></div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;<span class="comment"></span><span class="comment">//===========================================================================</span></div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> ELEMENT&gt;</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;<a class="code" href="classoomph_1_1SphericalAdvectionDiffusionFluxElement.html#afd26b6adc3a9a6402b38a3c15fc16c0a">SphericalAdvectionDiffusionFluxElement&lt;ELEMENT&gt;::</a></div>
<div class="line"><a name="l00902"></a><span class="lineno"><a class="line" href="classoomph_1_1SphericalAdvectionDiffusionFluxElement.html#aa8fb5f46838d3fbb9d15aca49944c671">  902</a></span>&#160;<a class="code" href="classoomph_1_1SphericalAdvectionDiffusionFluxElement.html#afd26b6adc3a9a6402b38a3c15fc16c0a">SphericalAdvectionDiffusionFluxElement</a>(<a class="code" href="classoomph_1_1FiniteElement.html">FiniteElement</a>* <span class="keyword">const</span> &amp;bulk_el_pt, </div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;                                          <span class="keyword">const</span> <span class="keywordtype">int</span> &amp;face_index) : </div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;<a class="code" href="classoomph_1_1FaceGeometry.html">FaceGeometry</a>&lt;ELEMENT&gt;(), <a class="code" href="classoomph_1_1FaceElement.html">FaceElement</a>()</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160; </div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;{ </div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160; <span class="comment">//Let the bulk element build the FaceElement, i.e. setup the pointers </span></div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160; <span class="comment">//to its nodes (by referring to the appropriate nodes in the bulk</span></div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160; <span class="comment">//element), etc.</span></div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160; bulk_el_pt-&gt;<a class="code" href="classoomph_1_1FiniteElement.html#aaf7bead5b462cfd5401d97b3dbdc7af7">build_face_element</a>(<a class="code" href="classoomph_1_1FaceElement.html#a478d577ac6db67ecc80f1f02ae3ab170">face_index</a>,<span class="keyword">this</span>); </div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160; </div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160; {</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;  <span class="comment">//Check that the element is not a refineable 3d element</span></div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;  ELEMENT* elem_pt = <span class="keyword">dynamic_cast&lt;</span>ELEMENT*<span class="keyword">&gt;</span>(bulk_el_pt);</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160; </div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;  <span class="comment">//If it&#39;s three-d</span></div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;  <span class="keywordflow">if</span>(elem_pt-&gt;dim()==3)</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;   {</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;    <span class="comment">//Is it refineable</span></div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;    <a class="code" href="classoomph_1_1RefineableElement.html">RefineableElement</a>* ref_el_pt=<span class="keyword">dynamic_cast&lt;</span><a class="code" href="classoomph_1_1RefineableElement.html">RefineableElement</a>*<span class="keyword">&gt;</span>(elem_pt);</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;    <span class="keywordflow">if</span>(ref_el_pt!=0)</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;     {</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;      <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classoomph_1_1FiniteElement.html#af6bc41bed877f6f9a1705d7d375ddfde">has_hanging_nodes</a>())</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;       {</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="classoomph_1_1OomphLibError.html">OomphLibError</a>(</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;         <span class="stringliteral">&quot;This flux element will not work correctly if nodes are hanging\n&quot;</span>,</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;         OOMPH_CURRENT_FUNCTION,</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;         OOMPH_EXCEPTION_LOCATION);</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;       }</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;     }</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;   }</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160; }</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160; </div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160; <span class="comment">//Initialise the prescribed-beta function pointer to zero</span></div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160; <a class="code" href="classoomph_1_1SphericalAdvectionDiffusionFluxElement.html#afac22354e3e360de61691047efe82be3">Beta_fct_pt</a> = 0;</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160; </div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160; <span class="comment">//Set up U_index_adv_diff. Initialise to zero, which probably won&#39;t change</span></div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160; <span class="comment">//in most cases, oh well, the price we pay for generality</span></div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160; <a class="code" href="classoomph_1_1SphericalAdvectionDiffusionFluxElement.html#a03f3019943b1bd0d2818882c08f955f4">U_index_adv_diff</a> = 0;</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160; </div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160; <span class="comment">//Cast to the appropriate AdvectionDiffusionEquation so that we can</span></div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160; <span class="comment">//find the index at which the variable is stored</span></div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160; <span class="comment">//We assume that the dimension of the full problem is the same</span></div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160; <span class="comment">//as the dimension of the node, if this is not the case you will have</span></div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160; <span class="comment">//to write custom elements, sorry</span></div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160; <a class="code" href="classoomph_1_1SphericalAdvectionDiffusionEquations.html">SphericalAdvectionDiffusionEquations</a>* eqn_pt =   </div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160; <span class="keyword">dynamic_cast&lt;</span><a class="code" href="classoomph_1_1SphericalAdvectionDiffusionEquations.html">SphericalAdvectionDiffusionEquations</a>*<span class="keyword">&gt;</span>(bulk_el_pt);</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160; </div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160; <span class="comment">//If the cast has failed die</span></div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160; <span class="keywordflow">if</span>(eqn_pt==0)</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;  {</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;     <a class="code" href="namespaceoomph_1_1Global__string__for__annotation.html#ac5379de2fa7fe44f2cb31785fc208135">std::string</a> error_string =</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;      <span class="stringliteral">&quot;Bulk element must inherit from SphericalAdvectionDiffusionEquations.&quot;</span>;</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;     error_string += </div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;      <span class="stringliteral">&quot;Nodes are two dimensional, but cannot cast the bulk element to\n&quot;</span>;</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;     error_string += <span class="stringliteral">&quot;SphericalAdvectionDiffusionEquations&lt;2&gt;\n.&quot;</span>;</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;     error_string += </div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;      <span class="stringliteral">&quot;If you desire this functionality, you must implement it yourself\n&quot;</span>;</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;     </div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;     <span class="keywordflow">throw</span> <a class="code" href="classoomph_1_1OomphLibError.html">OomphLibError</a>(</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;      error_string,</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;      OOMPH_CURRENT_FUNCTION,</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;      OOMPH_EXCEPTION_LOCATION);</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;  }</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160; <span class="keywordflow">else</span></div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;  {</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;   <span class="comment">//Read the index from the (cast) bulk element.</span></div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;   <a class="code" href="classoomph_1_1SphericalAdvectionDiffusionFluxElement.html#a03f3019943b1bd0d2818882c08f955f4">U_index_adv_diff</a> = eqn_pt-&gt;<a class="code" href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#a9a2928db14dc07aa3af1ee2dd7901dc5">u_index_spherical_adv_diff</a>();</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;  }</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160; </div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160; </div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;}</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160; </div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160; </div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;<span class="comment">//===========================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;<span class="comment">/// \short Compute the element&#39;s residual vector and the (zero) Jacobian </span></div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;<span class="comment">/// matrix for the Robin boundary condition:</span></div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;<span class="comment">/// \f[ </span></div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;<span class="comment">/// \Delta u \cdot \mathbf{n} + \alpha (\mathbf{x}) = \beta (\mathbf{x})</span></div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;<span class="comment">/// \f] </span></div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;<span class="comment"></span><span class="comment">//===========================================================================</span></div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> ELEMENT&gt;</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classoomph_1_1SphericalAdvectionDiffusionFluxElement.html#a7dd7a4627052f615642c64eea143e4c5">SphericalAdvectionDiffusionFluxElement&lt;ELEMENT&gt;::</a></div>
<div class="line"><a name="l00986"></a><span class="lineno"><a class="line" href="classoomph_1_1SphericalAdvectionDiffusionFluxElement.html#a7dd7a4627052f615642c64eea143e4c5">  986</a></span>&#160;<a class="code" href="classoomph_1_1SphericalAdvectionDiffusionFluxElement.html#a7dd7a4627052f615642c64eea143e4c5">fill_in_generic_residual_contribution_spherical_adv_diff_flux</a>(</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160; <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;<a class="code" href="the__data__structure_8txt.html#a1400a973def57b85051cfe1070be1810">residuals</a>, </div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160; <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> &amp;jacobian, </div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160; <span class="keywordtype">unsigned</span> flag)</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;{</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160; <span class="comment">//Find out how many nodes there are</span></div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160; <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_node = nnode();</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160; </div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160; <span class="comment">// Locally cache the index at which the variable is stored</span></div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160; <span class="keyword">const</span> <span class="keywordtype">unsigned</span> u_index_spherical_adv_diff = U_index_adv_diff;</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;  </div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160; <span class="comment">//Set up memory for the shape and test functions</span></div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160; <a class="code" href="classoomph_1_1Shape.html">Shape</a> psif(n_node), testf(n_node);</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160; </div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160; <span class="comment">//Set the value of n_intpt</span></div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160; <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_intpt = integral_pt()-&gt;nweight();</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160; </div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160; <span class="comment">//Set the Vector to hold local coordinates</span></div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160; <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>(1);</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160; </div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160; <span class="comment">//Integers used to store the local equation number and local unknown</span></div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160; <span class="comment">//indices for the residuals and jacobians</span></div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160; <span class="keywordtype">int</span> local_eqn=0, local_unknown=0;</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160; </div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160; <span class="comment">//Loop over the integration points</span></div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160; <span class="comment">//--------------------------------</span></div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160; <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> ipt=0;ipt&lt;n_intpt;ipt++)</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;  {</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160; </div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;   <span class="comment">//Assign values of s</span></div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;1;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++) </div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;    {</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;     <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] = integral_pt()-&gt;knot(ipt,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>);</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;    }</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;   </div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;   <span class="comment">//Get the integral weight</span></div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;   <span class="keywordtype">double</span> w = integral_pt()-&gt;weight(ipt);</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;   </div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;   <span class="comment">//Find the shape and test functions and return the Jacobian</span></div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;   <span class="comment">//of the mapping</span></div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;   <span class="keywordtype">double</span> J = shape_and_test(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,psif,testf);</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160; </div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;   <span class="comment">//Premultiply the weights and the Jacobian</span></div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;   <span class="keywordtype">double</span> <a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a> = w*J;</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160; </div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;   <span class="comment">//Calculate local values of the solution and its derivatives</span></div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;   <span class="comment">//Allocate</span></div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;   <span class="keywordtype">double</span> <a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>=0.0;</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;   <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> interpolated_x(2,0.0);</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;      </div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;   <span class="comment">//Calculate position</span></div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l=0;l&lt;n_node;l++) </div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;    {</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;     <span class="comment">//Get the value at the node</span></div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;     <span class="keywordtype">double</span> u_value = raw_nodal_value(l,u_index_spherical_adv_diff);</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;     <a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a> += u_value*psif(l);</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;     <span class="comment">//Loop over coordinate direction</span></div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;2;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;      {</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;       interpolated_x[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] += nodal_position(l,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>)*psif(l);</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;      }</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;    }</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;   </div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;   <span class="comment">//Get the imposed beta (beta=flux when alpha=0.0)</span></div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;   <span class="keywordtype">double</span> beta;</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;   get_beta(interpolated_x,beta);</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160; </div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;   <span class="comment">//Get the imposed alpha</span></div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;   <span class="keywordtype">double</span> alpha;</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;   get_alpha(interpolated_x,alpha);</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160; </div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;   <span class="comment">//calculate the area weighting dS = r^{2} sin theta dr dtheta</span></div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;   <span class="comment">// r = x[0] and theta = x[1]</span></div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;   <span class="keywordtype">double</span> dS = interpolated_x[0]*interpolated_x[0]*sin(interpolated_x[1]);</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160; </div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;   <span class="comment">//Now add to the appropriate equations</span></div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;   </div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;   <span class="comment">//Loop over the test functions</span></div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l=0;l&lt;n_node;l++)</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;    {</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;     <span class="comment">//Set the local equation number</span></div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;     local_eqn = nodal_local_eqn(l,u_index_spherical_adv_diff);</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;     <span class="comment">/*IF it&#39;s not a boundary condition*/</span></div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;     <span class="keywordflow">if</span>(local_eqn &gt;= 0)</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;      {</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;       <span class="comment">//Add the prescribed beta terms</span></div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;       <a class="code" href="the__data__structure_8txt.html#a1400a973def57b85051cfe1070be1810">residuals</a>[local_eqn] -= dS*(beta - alpha*<a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>)*testf(l)*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;            </div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;       <span class="comment">//Calculate the Jacobian</span></div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;       <span class="comment">//----------------------</span></div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;       <span class="keywordflow">if</span> ( (flag) &amp;&amp; (alpha!=0.0) )</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;        {</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;         <span class="comment">//Loop over the velocity shape functions again</span></div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;         <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l2=0;l2&lt;n_node;l2++)</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;          {</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;           <span class="comment">//Set the number of the unknown</span></div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;           local_unknown = nodal_local_eqn(l2,u_index_spherical_adv_diff);</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;           </div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;           <span class="comment">//If at a non-zero degree of freedom add in the entry</span></div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;           <span class="keywordflow">if</span>(local_unknown &gt;= 0)</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;            {</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;             jacobian(local_eqn,local_unknown) +=</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;              dS*alpha*psif[l2]*testf[l]*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;            }</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;          }</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;        }</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;       </div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;      }</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;    } <span class="comment">//end loop over test functions</span></div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160; </div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;  } <span class="comment">//end loop over integration points</span></div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160; </div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;}<span class="comment">//end fill_in_generic_residual_contribution_adv_diff_flux</span></div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160; </div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160; </div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;} <span class="comment">//End SphericalAdvectionDiffusionFluxElement class</span></div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160; </div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;<span class="preprocessor">#endif</span></div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="aclassoomph_1_1SphericalAdvectionDiffusionFluxElement_html_a03f3019943b1bd0d2818882c08f955f4"><div class="ttname"><a href="classoomph_1_1SphericalAdvectionDiffusionFluxElement.html#a03f3019943b1bd0d2818882c08f955f4">oomph::SphericalAdvectionDiffusionFluxElement::U_index_adv_diff</a></div><div class="ttdeci">unsigned U_index_adv_diff</div><div class="ttdoc">The index at which the unknown is stored at the nodes.</div><div class="ttdef"><b>Definition:</b> <a href="spherical__advection__diffusion__elements_8h_source.html#l00885">spherical_advection_diffusion_elements.h:885</a></div></div>
<div class="ttc" id="aclassoomph_1_1SphericalAdvectionDiffusionEquations_html_a3fdb5e8765ae60ea6c218629e2cb207c"><div class="ttname"><a href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#a3fdb5e8765ae60ea6c218629e2cb207c">oomph::SphericalAdvectionDiffusionEquations::PeSt_pt</a></div><div class="ttdeci">double * PeSt_pt</div><div class="ttdoc">Pointer to global Peclet number multiplied by Strouhal number.</div><div class="ttdef"><b>Definition:</b> <a href="spherical__advection__diffusion__elements_8h_source.html#l00453">spherical_advection_diffusion_elements.h:453</a></div></div>
<div class="ttc" id="aclassoomph_1_1QSphericalAdvectionDiffusionElement_html_abc3c98e85e168e66999ccae5a35e0987"><div class="ttname"><a href="classoomph_1_1QSphericalAdvectionDiffusionElement.html#abc3c98e85e168e66999ccae5a35e0987">oomph::QSphericalAdvectionDiffusionElement::output</a></div><div class="ttdeci">void output(std::ostream &amp;outfile, const unsigned &amp;n_plot)</div><div class="ttdoc">Output function:   r,z,u at n_plot^2 plot points.</div><div class="ttdef"><b>Definition:</b> <a href="spherical__advection__diffusion__elements_8h_source.html#l00530">spherical_advection_diffusion_elements.h:530</a></div></div>
<div class="ttc" id="aclassoomph_1_1SphericalAdvectionDiffusionEquations_html_afbea24565ef0db2546b804233a114a86"><div class="ttname"><a href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#afbea24565ef0db2546b804233a114a86">oomph::SphericalAdvectionDiffusionEquations::get_wind_spherical_adv_diff</a></div><div class="ttdeci">virtual void get_wind_spherical_adv_diff(const unsigned &amp;ipt, const Vector&lt; double &gt; &amp;s, const Vector&lt; double &gt; &amp;x, Vector&lt; double &gt; &amp;wind) const</div><div class="ttdoc">Get wind at (Eulerian) position x and/or local coordinate s. This function is virtual to allow overlo...</div><div class="ttdef"><b>Definition:</b> <a href="spherical__advection__diffusion__elements_8h_source.html#l00234">spherical_advection_diffusion_elements.h:234</a></div></div>
<div class="ttc" id="aclassoomph_1_1FiniteElement_html_ace0e7fb72a805b5c2c600347bfae7a9b"><div class="ttname"><a href="classoomph_1_1FiniteElement.html#ace0e7fb72a805b5c2c600347bfae7a9b">oomph::FiniteElement::node_pt</a></div><div class="ttdeci">Node *&amp; node_pt(const unsigned &amp;n)</div><div class="ttdoc">Return a pointer to the local node n.</div><div class="ttdef"><b>Definition:</b> <a href="elements_8h_source.html#l02122">elements.h:2122</a></div></div>
<div class="ttc" id="aclassoomph_1_1SphericalAdvectionDiffusionFluxElement_html_ab7dc1526807ada4b9189526b69653c91"><div class="ttname"><a href="classoomph_1_1SphericalAdvectionDiffusionFluxElement.html#ab7dc1526807ada4b9189526b69653c91">oomph::SphericalAdvectionDiffusionFluxElement::zeta_nodal</a></div><div class="ttdeci">double zeta_nodal(const unsigned &amp;n, const unsigned &amp;k, const unsigned &amp;i) const</div><div class="ttdoc">The &quot;global&quot; intrinsic coordinate of the element when viewed as part of a geometric object should be ...</div><div class="ttdef"><b>Definition:</b> <a href="spherical__advection__diffusion__elements_8h_source.html#l00768">spherical_advection_diffusion_elements.h:768</a></div></div>
<div class="ttc" id="athe__data__structure_8txt_html_a5448c72da3359c7796cf0c5f800732a1"><div class="ttname"><a href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a></div><div class="ttdeci">and code FiniteElement::J_eulerian(...) \endcode returns the Jacobian of the mapping from Eulerian coordinates to local coordinates. - The function \c GeneralisedElement c QElement&lt; 3, 2 &gt; is an node brick element with a trilinear mapping between and global coordinates The dimension and the number of c Nodes must be set by calling the appropriate c set_ functions in the see ref set_commands above The most important member functions implemented at this level include Functions that evaluate the shape in terms of the c FiniteElement s coordinates functions that determine whether a c Node is located at a particular coordinate Output functions that allow the element shapes to be plotted we specify a pointer to a spatial integration the default assignment can be over written at a higher level This is discussed in more detail in a&lt; A HREF=&quot;../../optimisation/html/index.html&quot;&gt; separate document&lt;/A &gt; subsubsection Maths_Element we implement the equations that are represented by the specific element We implement the employing either the geometric shape functions that already exist on or employing additional shape functions defined at this level This allows us to write further member functions such as c interpolated_u(...)</div></div>
<div class="ttc" id="aclassoomph_1_1SphericalAdvectionDiffusionEquations_html_adef9c036e9f80c134078d8d78049199e"><div class="ttname"><a href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#adef9c036e9f80c134078d8d78049199e">oomph::SphericalAdvectionDiffusionEquations::SphericalAdvectionDiffusionWindFctPt</a></div><div class="ttdeci">void(* SphericalAdvectionDiffusionWindFctPt)(const Vector&lt; double &gt; &amp;x, Vector&lt; double &gt; &amp;wind)</div><div class="ttdoc">Function pointer to wind function fct(x,w(x))  x is a Vector!</div><div class="ttdef"><b>Definition:</b> <a href="spherical__advection__diffusion__elements_8h_source.html#l00070">spherical_advection_diffusion_elements.h:70</a></div></div>
<div class="ttc" id="aclassoomph_1_1SphericalAdvectionDiffusionFluxElement_html_aabc503a4eeac639334283e7297b88423"><div class="ttname"><a href="classoomph_1_1SphericalAdvectionDiffusionFluxElement.html#aabc503a4eeac639334283e7297b88423">oomph::SphericalAdvectionDiffusionFluxElement::SphericalAdvectionDiffusionPrescribedAlphaFctPt</a></div><div class="ttdeci">void(* SphericalAdvectionDiffusionPrescribedAlphaFctPt)(const Vector&lt; double &gt; &amp;x, double &amp;alpha)</div><div class="ttdoc">Function pointer to the prescribed-alpha function fct(x,alpha(x))  x is a Vector!</div><div class="ttdef"><b>Definition:</b> <a href="spherical__advection__diffusion__elements_8h_source.html#l00695">spherical_advection_diffusion_elements.h:695</a></div></div>
<div class="ttc" id="aclassoomph_1_1FaceElement_html_a58c9f93705c7741f76c8487d152e68a6"><div class="ttname"><a href="classoomph_1_1FaceElement.html#a58c9f93705c7741f76c8487d152e68a6">oomph::FaceElement::zeta_nodal</a></div><div class="ttdeci">double zeta_nodal(const unsigned &amp;n, const unsigned &amp;k, const unsigned &amp;i) const</div><div class="ttdoc">In a FaceElement, the &quot;global&quot; intrinsic coordinate of the element along the boundary,...</div><div class="ttdef"><b>Definition:</b> <a href="elements_8h_source.html#l04377">elements.h:4377</a></div></div>
<div class="ttc" id="athe__data__structure_8txt_html_a1400a973def57b85051cfe1070be1810"><div class="ttname"><a href="the__data__structure_8txt.html#a1400a973def57b85051cfe1070be1810">residuals</a></div><div class="ttdeci">endcode The default implementation of c the simplest possible implementation of a new element requires only the specification of c we need to know which c Data affects the residuals(and hence the Jacobian matrix). For a \c GeneralisedElement such \c Data exists in two forms</div></div>
<div class="ttc" id="aclassoomph_1_1FaceElement_html_a478d577ac6db67ecc80f1f02ae3ab170"><div class="ttname"><a href="classoomph_1_1FaceElement.html#a478d577ac6db67ecc80f1f02ae3ab170">oomph::FaceElement::face_index</a></div><div class="ttdeci">int &amp; face_index()</div><div class="ttdoc">Index of the face (a number that uniquely identifies the face in the element)</div><div class="ttdef"><b>Definition:</b> <a href="elements_8h_source.html#l04497">elements.h:4497</a></div></div>
<div class="ttc" id="aclassoomph_1_1QElement_html"><div class="ttname"><a href="classoomph_1_1QElement.html">oomph::QElement</a></div><div class="ttdef"><b>Definition:</b> <a href="Qelements_8h_source.html#l00481">Qelements.h:481</a></div></div>
<div class="ttc" id="aclassoomph_1_1FiniteElement_html_aaf7bead5b462cfd5401d97b3dbdc7af7"><div class="ttname"><a href="classoomph_1_1FiniteElement.html#aaf7bead5b462cfd5401d97b3dbdc7af7">oomph::FiniteElement::build_face_element</a></div><div class="ttdeci">virtual void build_face_element(const int &amp;face_index, FaceElement *face_element_pt)</div><div class="ttdoc">Function for building a lower dimensional FaceElement on the specified face of the FiniteElement....</div><div class="ttdef"><b>Definition:</b> <a href="elements_8cc_source.html#l05001">elements.cc:5001</a></div></div>
<div class="ttc" id="aclassoomph_1_1SphericalAdvectionDiffusionEquations_html_a097613909cb9b016e55190df3c7b3d2f"><div class="ttname"><a href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#a097613909cb9b016e55190df3c7b3d2f">oomph::SphericalAdvectionDiffusionEquations::disable_ALE</a></div><div class="ttdeci">void disable_ALE()</div><div class="ttdoc">Disable ALE  empty overload to suppress warning. ALE isn't implemented anyway.</div><div class="ttdef"><b>Definition:</b> <a href="spherical__advection__diffusion__elements_8h_source.html#l00138">spherical_advection_diffusion_elements.h:138</a></div></div>
<div class="ttc" id="aclassoomph_1_1SphericalAdvectionDiffusionEquations_html_ae3d7908aae79d3eae5ba6e1bb638498b"><div class="ttname"><a href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#ae3d7908aae79d3eae5ba6e1bb638498b">oomph::SphericalAdvectionDiffusionEquations::wind_fct_pt</a></div><div class="ttdeci">SphericalAdvectionDiffusionWindFctPt &amp; wind_fct_pt()</div><div class="ttdoc">Access function: Pointer to wind function.</div><div class="ttdef"><b>Definition:</b> <a href="spherical__advection__diffusion__elements_8h_source.html#l00187">spherical_advection_diffusion_elements.h:187</a></div></div>
<div class="ttc" id="aclassoomph_1_1SphericalAdvectionDiffusionEquations_html_ab650e6ff8db720b2c7d061f885f1c628"><div class="ttname"><a href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#ab650e6ff8db720b2c7d061f885f1c628">oomph::SphericalAdvectionDiffusionEquations::Pe_pt</a></div><div class="ttdeci">double * Pe_pt</div><div class="ttdoc">Pointer to global Peclet number.</div><div class="ttdef"><b>Definition:</b> <a href="spherical__advection__diffusion__elements_8h_source.html#l00450">spherical_advection_diffusion_elements.h:450</a></div></div>
<div class="ttc" id="aclassoomph_1_1FiniteElement_html"><div class="ttname"><a href="classoomph_1_1FiniteElement.html">oomph::FiniteElement</a></div><div class="ttdoc">A general Finite Element class.</div><div class="ttdef"><b>Definition:</b> <a href="elements_8h_source.html#l01287">elements.h:1287</a></div></div>
<div class="ttc" id="aclassoomph_1_1QSphericalAdvectionDiffusionElement_html_a75d5e8f33411030e31e82da809d946d2"><div class="ttname"><a href="classoomph_1_1QSphericalAdvectionDiffusionElement.html#a75d5e8f33411030e31e82da809d946d2">oomph::QSphericalAdvectionDiffusionElement::dshape_and_dtest_eulerian_spherical_adv_diff</a></div><div class="ttdeci">double dshape_and_dtest_eulerian_spherical_adv_diff(const Vector&lt; double &gt; &amp;s, Shape &amp;psi, DShape &amp;dpsidx, Shape &amp;test, DShape &amp;dtestdx) const</div><div class="ttdoc">Shape, test functions &amp; derivs. w.r.t. to global coords. Return Jacobian.</div><div class="ttdef"><b>Definition:</b> <a href="spherical__advection__diffusion__elements_8h_source.html#l00592">spherical_advection_diffusion_elements.h:592</a></div></div>
<div class="ttc" id="aclassoomph_1_1OomphLibError_html"><div class="ttname"><a href="classoomph_1_1OomphLibError.html">oomph::OomphLibError</a></div><div class="ttdef"><b>Definition:</b> <a href="oomph__definitions_8h_source.html#l00225">oomph_definitions.h:225</a></div></div>
<div class="ttc" id="aclassoomph_1_1SphericalAdvectionDiffusionEquations_html_a9ed67207accc327c4d2bf614c4c452e0"><div class="ttname"><a href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#a9ed67207accc327c4d2bf614c4c452e0">oomph::SphericalAdvectionDiffusionEquations::fill_in_contribution_to_jacobian</a></div><div class="ttdeci">void fill_in_contribution_to_jacobian(Vector&lt; double &gt; &amp;residuals, DenseMatrix&lt; double &gt; &amp;jacobian)</div><div class="ttdoc">Add the element's contribution to its residual vector and the element Jacobian matrix (wrapper)</div><div class="ttdef"><b>Definition:</b> <a href="spherical__advection__diffusion__elements_8h_source.html#l00304">spherical_advection_diffusion_elements.h:304</a></div></div>
<div class="ttc" id="aclassoomph_1_1SphericalAdvectionDiffusionEquations_html_a7aeb7cc67f60d713fd64321004229401"><div class="ttname"><a href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#a7aeb7cc67f60d713fd64321004229401">oomph::SphericalAdvectionDiffusionEquations::fill_in_contribution_to_jacobian_and_mass_matrix</a></div><div class="ttdeci">void fill_in_contribution_to_jacobian_and_mass_matrix(Vector&lt; double &gt; &amp;residuals, DenseMatrix&lt; double &gt; &amp;jacobian, DenseMatrix&lt; double &gt; &amp;mass_matrix)</div><div class="ttdoc">Add the element's contribution to its residual vector and the element Jacobian matrix (wrapper) and m...</div><div class="ttdef"><b>Definition:</b> <a href="spherical__advection__diffusion__elements_8h_source.html#l00316">spherical_advection_diffusion_elements.h:316</a></div></div>
<div class="ttc" id="aclassoomph_1_1SphericalAdvectionDiffusionEquations_html_a588bb8fcf23cd8bc38225f974d4cde7e"><div class="ttname"><a href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#a588bb8fcf23cd8bc38225f974d4cde7e">oomph::SphericalAdvectionDiffusionEquations::Source_fct_pt</a></div><div class="ttdeci">SphericalAdvectionDiffusionSourceFctPt Source_fct_pt</div><div class="ttdoc">Pointer to source function:</div><div class="ttdef"><b>Definition:</b> <a href="spherical__advection__diffusion__elements_8h_source.html#l00456">spherical_advection_diffusion_elements.h:456</a></div></div>
<div class="ttc" id="aclassoomph_1_1FiniteElement_html_aeccc0f774e3fab8c536e2d41004a1665"><div class="ttname"><a href="classoomph_1_1FiniteElement.html#aeccc0f774e3fab8c536e2d41004a1665">oomph::FiniteElement::shape_at_knot</a></div><div class="ttdeci">virtual void shape_at_knot(const unsigned &amp;ipt, Shape &amp;psi) const</div><div class="ttdoc">Return the geometric shape function at the ipt-th integration point.</div><div class="ttdef"><b>Definition:</b> <a href="elements_8cc_source.html#l03156">elements.cc:3156</a></div></div>
<div class="ttc" id="aclassoomph_1_1FiniteElement_html_a690fd33af26cc3e84f39bba6d5a85202"><div class="ttname"><a href="classoomph_1_1FiniteElement.html#a690fd33af26cc3e84f39bba6d5a85202">oomph::FiniteElement::SteadyExactSolutionFctPt</a></div><div class="ttdeci">void(* SteadyExactSolutionFctPt)(const Vector&lt; double &gt; &amp;, Vector&lt; double &gt; &amp;)</div><div class="ttdoc">Function pointer for function that computes vector-valued steady &quot;exact solution&quot;  as .</div><div class="ttdef"><b>Definition:</b> <a href="elements_8h_source.html#l01736">elements.h:1736</a></div></div>
<div class="ttc" id="aclassoomph_1_1SphericalAdvectionDiffusionEquations_html_a6a8673efdb4df145804fbb92dccd1835"><div class="ttname"><a href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#a6a8673efdb4df145804fbb92dccd1835">oomph::SphericalAdvectionDiffusionEquations::Wind_fct_pt</a></div><div class="ttdeci">SphericalAdvectionDiffusionWindFctPt Wind_fct_pt</div><div class="ttdoc">Pointer to wind function:</div><div class="ttdef"><b>Definition:</b> <a href="spherical__advection__diffusion__elements_8h_source.html#l00459">spherical_advection_diffusion_elements.h:459</a></div></div>
<div class="ttc" id="aclassoomph_1_1TimeStepper_html_a3939b77ec3578e4bd5b453c85649d631"><div class="ttname"><a href="classoomph_1_1TimeStepper.html#a3939b77ec3578e4bd5b453c85649d631">oomph::TimeStepper::ntstorage</a></div><div class="ttdeci">unsigned ntstorage() const</div><div class="ttdoc">Return the number of doubles required to represent history (one for steady)</div><div class="ttdef"><b>Definition:</b> <a href="timesteppers_8h_source.html#l00558">timesteppers.h:558</a></div></div>
<div class="ttc" id="aclassoomph_1_1SphericalAdvectionDiffusionEquations_html_a92998bc7fd574a8e0bb6afe3694fb62b"><div class="ttname"><a href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#a92998bc7fd574a8e0bb6afe3694fb62b">oomph::SphericalAdvectionDiffusionEquations::compute_error</a></div><div class="ttdeci">void compute_error(std::ostream &amp;outfile, FiniteElement::SteadyExactSolutionFctPt exact_soln_pt, double &amp;error, double &amp;norm)</div><div class="ttdoc">Get error against and norm of exact solution.</div><div class="ttdef"><b>Definition:</b> <a href="spherical__advection__diffusion__elements_8cc_source.html#l00401">spherical_advection_diffusion_elements.cc:401</a></div></div>
<div class="ttc" id="aclassoomph_1_1SphericalAdvectionDiffusionFluxElement_html_a0d9b714320a27d346fa8d0ccc1ef4148"><div class="ttname"><a href="classoomph_1_1SphericalAdvectionDiffusionFluxElement.html#a0d9b714320a27d346fa8d0ccc1ef4148">oomph::SphericalAdvectionDiffusionFluxElement::Alpha_fct_pt</a></div><div class="ttdeci">SphericalAdvectionDiffusionPrescribedAlphaFctPt Alpha_fct_pt</div><div class="ttdoc">Function pointer to the (global) prescribed-alpha function.</div><div class="ttdef"><b>Definition:</b> <a href="spherical__advection__diffusion__elements_8h_source.html#l00882">spherical_advection_diffusion_elements.h:882</a></div></div>
<div class="ttc" id="aclassoomph_1_1SphericalAdvectionDiffusionEquations_html_aed5cfed74d16b43e5a9ca081b845b2a2"><div class="ttname"><a href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#aed5cfed74d16b43e5a9ca081b845b2a2">oomph::SphericalAdvectionDiffusionEquations::SphericalAdvectionDiffusionEquations</a></div><div class="ttdeci">SphericalAdvectionDiffusionEquations()</div><div class="ttdoc">Constructor: Initialise the Source_fct_pt and Wind_fct_pt to null and set (pointer to) Peclet number ...</div><div class="ttdef"><b>Definition:</b> <a href="spherical__advection__diffusion__elements_8h_source.html#l00076">spherical_advection_diffusion_elements.h:76</a></div></div>
<div class="ttc" id="aclassoomph_1_1FaceElement_html_aa6380a08afc18bd4f35e337a1131a9d8"><div class="ttname"><a href="classoomph_1_1FaceElement.html#aa6380a08afc18bd4f35e337a1131a9d8">oomph::FaceElement::J_eulerian_at_knot</a></div><div class="ttdeci">double J_eulerian_at_knot(const unsigned &amp;ipt) const</div><div class="ttdoc">Return the Jacobian of the mapping from local to global coordinates at the ipt-th integration point O...</div><div class="ttdef"><b>Definition:</b> <a href="elements_8cc_source.html#l05200">elements.cc:5200</a></div></div>
<div class="ttc" id="aclassoomph_1_1FiniteElement_html_a9296c17b134688049256a4bbc886df69"><div class="ttname"><a href="classoomph_1_1FiniteElement.html#a9296c17b134688049256a4bbc886df69">oomph::FiniteElement::dshape_eulerian</a></div><div class="ttdeci">double dshape_eulerian(const Vector&lt; double &gt; &amp;s, Shape &amp;psi, DShape &amp;dpsidx) const</div><div class="ttdoc">Compute the geometric shape functions and also first derivatives w.r.t. global coordinates at local c...</div><div class="ttdef"><b>Definition:</b> <a href="elements_8cc_source.html#l03223">elements.cc:3223</a></div></div>
<div class="ttc" id="aclassoomph_1_1SphericalAdvectionDiffusionEquations_html_aefe9930f320bf5931f853461253951ef"><div class="ttname"><a href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#aefe9930f320bf5931f853461253951ef">oomph::SphericalAdvectionDiffusionEquations::pe_pt</a></div><div class="ttdeci">double *&amp; pe_pt()</div><div class="ttdoc">Pointer to Peclet number.</div><div class="ttdef"><b>Definition:</b> <a href="spherical__advection__diffusion__elements_8h_source.html#l00201">spherical_advection_diffusion_elements.h:201</a></div></div>
<div class="ttc" id="aclassoomph_1_1SphericalAdvectionDiffusionFluxElement_html_a7ba9d40e23873038895ec070b9bc29ad"><div class="ttname"><a href="classoomph_1_1SphericalAdvectionDiffusionFluxElement.html#a7ba9d40e23873038895ec070b9bc29ad">oomph::SphericalAdvectionDiffusionFluxElement::get_beta</a></div><div class="ttdeci">void get_beta(const Vector&lt; double &gt; &amp;x, double &amp;beta)</div><div class="ttdoc">Function to calculate the prescribed beta at a given spatial position.</div><div class="ttdef"><b>Definition:</b> <a href="spherical__advection__diffusion__elements_8h_source.html#l00838">spherical_advection_diffusion_elements.h:838</a></div></div>
<div class="ttc" id="aclassoomph_1_1SphericalAdvectionDiffusionFluxElement_html_afd26b6adc3a9a6402b38a3c15fc16c0a"><div class="ttname"><a href="classoomph_1_1SphericalAdvectionDiffusionFluxElement.html#afd26b6adc3a9a6402b38a3c15fc16c0a">oomph::SphericalAdvectionDiffusionFluxElement::SphericalAdvectionDiffusionFluxElement</a></div><div class="ttdeci">SphericalAdvectionDiffusionFluxElement()</div><div class="ttdoc">Broken empty constructor.</div><div class="ttdef"><b>Definition:</b> <a href="spherical__advection__diffusion__elements_8h_source.html#l00707">spherical_advection_diffusion_elements.h:707</a></div></div>
<div class="ttc" id="aclassoomph_1_1SphericalAdvectionDiffusionFluxElement_html_a3e9d700a25464270aae4cfb8ac0abb66"><div class="ttname"><a href="classoomph_1_1SphericalAdvectionDiffusionFluxElement.html#a3e9d700a25464270aae4cfb8ac0abb66">oomph::SphericalAdvectionDiffusionFluxElement::beta_fct_pt</a></div><div class="ttdeci">SphericalAdvectionDiffusionPrescribedBetaFctPt &amp; beta_fct_pt()</div><div class="ttdoc">Access function for the prescribed-beta function pointer.</div><div class="ttdef"><b>Definition:</b> <a href="spherical__advection__diffusion__elements_8h_source.html#l00729">spherical_advection_diffusion_elements.h:729</a></div></div>
<div class="ttc" id="aclassoomph_1_1SphericalAdvectionDiffusionEquations_html_aec614fe14108871e1c47345b8cac97d7"><div class="ttname"><a href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#aec614fe14108871e1c47345b8cac97d7">oomph::SphericalAdvectionDiffusionEquations::dinterpolated_u_adv_diff_ddata</a></div><div class="ttdeci">virtual void dinterpolated_u_adv_diff_ddata(const Vector&lt; double &gt; &amp;s, Vector&lt; double &gt; &amp;du_ddata, Vector&lt; unsigned &gt; &amp;global_eqn_number)</div><div class="ttdoc">Return derivative of u at point s with respect to all data that can affect its value....</div><div class="ttdef"><b>Definition:</b> <a href="spherical__advection__diffusion__elements_8h_source.html#l00363">spherical_advection_diffusion_elements.h:363</a></div></div>
<div class="ttc" id="aclassoomph_1_1SphericalAdvectionDiffusionFluxElement_html_ae68704bbc324e11392b724b6e3406eb8"><div class="ttname"><a href="classoomph_1_1SphericalAdvectionDiffusionFluxElement.html#ae68704bbc324e11392b724b6e3406eb8">oomph::SphericalAdvectionDiffusionFluxElement::shape_and_test</a></div><div class="ttdeci">double shape_and_test(const Vector&lt; double &gt; &amp;s, Shape &amp;psi, Shape &amp;test) const</div><div class="ttdoc">Function to compute the shape and test functions and to return the Jacobian of mapping between local ...</div><div class="ttdef"><b>Definition:</b> <a href="spherical__advection__diffusion__elements_8h_source.html#l00792">spherical_advection_diffusion_elements.h:792</a></div></div>
<div class="ttc" id="aclassoomph_1_1SphericalAdvectionDiffusionFluxElement_html_a34f7cc1f18c22b23e553cc9f0144a48d"><div class="ttname"><a href="classoomph_1_1SphericalAdvectionDiffusionFluxElement.html#a34f7cc1f18c22b23e553cc9f0144a48d">oomph::SphericalAdvectionDiffusionFluxElement::shape_and_test_at_knot</a></div><div class="ttdeci">double shape_and_test_at_knot(const unsigned &amp;ipt, Shape &amp;psi, Shape &amp;test) const</div><div class="ttdoc">Function to compute the shape and test functions and to return the Jacobian of mapping between local ...</div><div class="ttdef"><b>Definition:</b> <a href="spherical__advection__diffusion__elements_8h_source.html#l00816">spherical_advection_diffusion_elements.h:816</a></div></div>
<div class="ttc" id="aclassoomph_1_1SphericalAdvectionDiffusionEquations_html_a4b4f59d82dd7b2e1641eba4b91d54d40"><div class="ttname"><a href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#a4b4f59d82dd7b2e1641eba4b91d54d40">oomph::SphericalAdvectionDiffusionEquations::output</a></div><div class="ttdeci">void output(std::ostream &amp;outfile)</div><div class="ttdoc">Output with default number of plot points.</div><div class="ttdef"><b>Definition:</b> <a href="spherical__advection__diffusion__elements_8h_source.html#l00141">spherical_advection_diffusion_elements.h:141</a></div></div>
<div class="ttc" id="aclassoomph_1_1SphericalAdvectionDiffusionEquations_html_aa02d787c43f88e46ad5e21c7b299b5cb"><div class="ttname"><a href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#aa02d787c43f88e46ad5e21c7b299b5cb">oomph::SphericalAdvectionDiffusionEquations::SphericalAdvectionDiffusionSourceFctPt</a></div><div class="ttdeci">void(* SphericalAdvectionDiffusionSourceFctPt)(const Vector&lt; double &gt; &amp;x, double &amp;f)</div><div class="ttdoc">Function pointer to source function fct(x,f(x))  x is a Vector!</div><div class="ttdef"><b>Definition:</b> <a href="spherical__advection__diffusion__elements_8h_source.html#l00065">spherical_advection_diffusion_elements.h:65</a></div></div>
<div class="ttc" id="aclassoomph_1_1SphericalAdvectionDiffusionEquations_html_a3ef8f55c02bf521af9da3cae9eb2a689"><div class="ttname"><a href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#a3ef8f55c02bf521af9da3cae9eb2a689">oomph::SphericalAdvectionDiffusionEquations::SphericalAdvectionDiffusionEquations</a></div><div class="ttdeci">SphericalAdvectionDiffusionEquations(const SphericalAdvectionDiffusionEquations &amp;dummy)</div><div class="ttdoc">Broken copy constructor.</div><div class="ttdef"><b>Definition:</b> <a href="spherical__advection__diffusion__elements_8h_source.html#l00084">spherical_advection_diffusion_elements.h:84</a></div></div>
<div class="ttc" id="aclassoomph_1_1SphericalAdvectionDiffusionFluxElement_html_a1e3a162c505bc7719da00e30f8c6cb58"><div class="ttname"><a href="classoomph_1_1SphericalAdvectionDiffusionFluxElement.html#a1e3a162c505bc7719da00e30f8c6cb58">oomph::SphericalAdvectionDiffusionFluxElement::get_alpha</a></div><div class="ttdeci">void get_alpha(const Vector&lt; double &gt; &amp;x, double &amp;alpha)</div><div class="ttdoc">Function to calculate the prescribed alpha at a given spatial position.</div><div class="ttdef"><b>Definition:</b> <a href="spherical__advection__diffusion__elements_8h_source.html#l00854">spherical_advection_diffusion_elements.h:854</a></div></div>
<div class="ttc" id="aclassoomph_1_1SphericalAdvectionDiffusionEquations_html_a9a2928db14dc07aa3af1ee2dd7901dc5"><div class="ttname"><a href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#a9a2928db14dc07aa3af1ee2dd7901dc5">oomph::SphericalAdvectionDiffusionEquations::u_index_spherical_adv_diff</a></div><div class="ttdeci">virtual unsigned u_index_spherical_adv_diff() const</div><div class="ttdoc">Return the index at which the unknown value is stored. The default value, 0, is appropriate for singl...</div><div class="ttdef"><b>Definition:</b> <a href="spherical__advection__diffusion__elements_8h_source.html#l00103">spherical_advection_diffusion_elements.h:103</a></div></div>
<div class="ttc" id="aclassoomph_1_1FiniteElement_html_af6bc41bed877f6f9a1705d7d375ddfde"><div class="ttname"><a href="classoomph_1_1FiniteElement.html#af6bc41bed877f6f9a1705d7d375ddfde">oomph::FiniteElement::has_hanging_nodes</a></div><div class="ttdeci">bool has_hanging_nodes() const</div><div class="ttdoc">Return boolean to indicate if any of the element's nodes are geometrically hanging.</div><div class="ttdef"><b>Definition:</b> <a href="elements_8h_source.html#l02369">elements.h:2369</a></div></div>
<div class="ttc" id="aclassoomph_1_1FiniteElement_html_a9152c16ae9899168bcdaac7c2f977444"><div class="ttname"><a href="classoomph_1_1FiniteElement.html#a9152c16ae9899168bcdaac7c2f977444">oomph::FiniteElement::nodal_position</a></div><div class="ttdeci">double nodal_position(const unsigned &amp;n, const unsigned &amp;i) const</div><div class="ttdoc">Return the i-th coordinate at local node n. If the node is hanging, the appropriate interpolation is ...</div><div class="ttdef"><b>Definition:</b> <a href="elements_8h_source.html#l02240">elements.h:2240</a></div></div>
<div class="ttc" id="aclassoomph_1_1DenseMatrix_html"><div class="ttname"><a href="classoomph_1_1DenseMatrix.html">oomph::DenseMatrix&lt; double &gt;</a></div></div>
<div class="ttc" id="aclassoomph_1_1SphericalAdvectionDiffusionEquations_html_a139999156e95fba4e789d7b72def465e"><div class="ttname"><a href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#a139999156e95fba4e789d7b72def465e">oomph::SphericalAdvectionDiffusionEquations::get_source_spherical_adv_diff</a></div><div class="ttdeci">virtual void get_source_spherical_adv_diff(const unsigned &amp;ipt, const Vector&lt; double &gt; &amp;x, double &amp;source) const</div><div class="ttdoc">Get source term at (Eulerian) position x. This function is virtual to allow overloading in multi-phys...</div><div class="ttdef"><b>Definition:</b> <a href="spherical__advection__diffusion__elements_8h_source.html#l00213">spherical_advection_diffusion_elements.h:213</a></div></div>
<div class="ttc" id="aclassoomph_1_1SphericalAdvectionDiffusionEquations_html_a2b61d50b166871a64507ee13b8e94f54"><div class="ttname"><a href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#a2b61d50b166871a64507ee13b8e94f54">oomph::SphericalAdvectionDiffusionEquations::dshape_and_dtest_eulerian_at_knot_spherical_adv_diff</a></div><div class="ttdeci">virtual double dshape_and_dtest_eulerian_at_knot_spherical_adv_diff(const unsigned &amp;ipt, Shape &amp;psi, DShape &amp;dpsidx, Shape &amp;test, DShape &amp;dtestdx) const =0</div><div class="ttdoc">Shape/test functions and derivs w.r.t. to global coords at integration point ipt; return Jacobian of ...</div></div>
<div class="ttc" id="aclassoomph_1_1RefineableElement_html"><div class="ttname"><a href="classoomph_1_1RefineableElement.html">oomph::RefineableElement</a></div><div class="ttdef"><b>Definition:</b> <a href="refineable__elements_8h_source.html#l00097">refineable_elements.h:97</a></div></div>
<div class="ttc" id="aclassoomph_1_1SphericalAdvectionDiffusionEquations_html_a52e4a713aa779de8cd57ec5faa60a709"><div class="ttname"><a href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#a52e4a713aa779de8cd57ec5faa60a709">oomph::SphericalAdvectionDiffusionEquations::get_flux</a></div><div class="ttdeci">void get_flux(const Vector&lt; double &gt; &amp;s, Vector&lt; double &gt; &amp;flux) const</div><div class="ttdoc">Get flux:</div><div class="ttdef"><b>Definition:</b> <a href="spherical__advection__diffusion__elements_8h_source.html#l00259">spherical_advection_diffusion_elements.h:259</a></div></div>
<div class="ttc" id="aclassoomph_1_1SphericalAdvectionDiffusionEquations_html_a2fcb664a740cfb2a645b0e1893a00773"><div class="ttname"><a href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#a2fcb664a740cfb2a645b0e1893a00773">oomph::SphericalAdvectionDiffusionEquations::output_fct</a></div><div class="ttdeci">void output_fct(std::ostream &amp;outfile, const unsigned &amp;nplot, FiniteElement::SteadyExactSolutionFctPt exact_soln_pt)</div><div class="ttdoc">Output exact soln: r,z,u_exact at nplot^2 plot points.</div><div class="ttdef"><b>Definition:</b> <a href="spherical__advection__diffusion__elements_8cc_source.html#l00348">spherical_advection_diffusion_elements.cc:348</a></div></div>
<div class="ttc" id="aclassoomph_1_1SphericalAdvectionDiffusionFluxElement_html_a3863a02374ac70bacd47face3285d469"><div class="ttname"><a href="classoomph_1_1SphericalAdvectionDiffusionFluxElement.html#a3863a02374ac70bacd47face3285d469">oomph::SphericalAdvectionDiffusionFluxElement::fill_in_contribution_to_jacobian</a></div><div class="ttdeci">void fill_in_contribution_to_jacobian(Vector&lt; double &gt; &amp;residuals, DenseMatrix&lt; double &gt; &amp;jacobian)</div><div class="ttdoc">Add the element's contribution to its residual vector and its Jacobian matrix.</div><div class="ttdef"><b>Definition:</b> <a href="spherical__advection__diffusion__elements_8h_source.html#l00754">spherical_advection_diffusion_elements.h:754</a></div></div>
<div class="ttc" id="aclassoomph_1_1SphericalAdvectionDiffusionEquations_html_ab70b9505075279b1dc935a620407df1f"><div class="ttname"><a href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#ab70b9505075279b1dc935a620407df1f">oomph::SphericalAdvectionDiffusionEquations::pe_st_pt</a></div><div class="ttdeci">double *&amp; pe_st_pt()</div><div class="ttdoc">Pointer to Peclet number multipled by Strouha number.</div><div class="ttdef"><b>Definition:</b> <a href="spherical__advection__diffusion__elements_8h_source.html#l00207">spherical_advection_diffusion_elements.h:207</a></div></div>
<div class="ttc" id="aclassoomph_1_1QSphericalAdvectionDiffusionElement_html_ade39bb468f6f05959ae31698b40cde10"><div class="ttname"><a href="classoomph_1_1QSphericalAdvectionDiffusionElement.html#ade39bb468f6f05959ae31698b40cde10">oomph::QSphericalAdvectionDiffusionElement::operator=</a></div><div class="ttdeci">void operator=(const QSphericalAdvectionDiffusionElement&lt; NNODE_1D &gt; &amp;)</div><div class="ttdoc">Broken assignment operator.</div><div class="ttdef"><b>Definition:</b> <a href="spherical__advection__diffusion__elements_8h_source.html#l00509">spherical_advection_diffusion_elements.h:509</a></div></div>
<div class="ttc" id="aclassoomph_1_1SphericalAdvectionDiffusionEquations_html_ad97d019b2b4715d379adca3320262d29"><div class="ttname"><a href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#ad97d019b2b4715d379adca3320262d29">oomph::SphericalAdvectionDiffusionEquations::fill_in_generic_residual_contribution_spherical_adv_diff</a></div><div class="ttdeci">virtual void fill_in_generic_residual_contribution_spherical_adv_diff(Vector&lt; double &gt; &amp;residuals, DenseMatrix&lt; double &gt; &amp;jacobian, DenseMatrix&lt; double &gt; &amp;mass_matrix, unsigned flag)</div><div class="ttdoc">Add the element's contribution to its residual vector only (if flag=and/or element Jacobian matrix</div><div class="ttdef"><b>Definition:</b> <a href="spherical__advection__diffusion__elements_8cc_source.html#l00049">spherical_advection_diffusion_elements.cc:49</a></div></div>
<div class="ttc" id="acfortran_8h_html_af6f0bd3dc13317f895c91323c25c2b8f"><div class="ttname"><a href="cfortran_8h.html#af6f0bd3dc13317f895c91323c25c2b8f">t</a></div><div class="ttdeci">char t</div><div class="ttdef"><b>Definition:</b> <a href="cfortran_8h_source.html#l00568">cfortran.h:568</a></div></div>
<div class="ttc" id="aclassoomph_1_1SphericalAdvectionDiffusionEquations_html_a33f78b13bf746a2d0b21d3675c4c4d95"><div class="ttname"><a href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#a33f78b13bf746a2d0b21d3675c4c4d95">oomph::SphericalAdvectionDiffusionEquations::pe</a></div><div class="ttdeci">const double &amp; pe() const</div><div class="ttdoc">Peclet number.</div><div class="ttdef"><b>Definition:</b> <a href="spherical__advection__diffusion__elements_8h_source.html#l00198">spherical_advection_diffusion_elements.h:198</a></div></div>
<div class="ttc" id="aclassoomph_1_1FaceGeometry_3_01QSphericalAdvectionDiffusionElement_3_01NNODE__1D_01_4_01_4_html_a8ed2838c5dacbfa9facfb20466a60039"><div class="ttname"><a href="classoomph_1_1FaceGeometry_3_01QSphericalAdvectionDiffusionElement_3_01NNODE__1D_01_4_01_4.html#a8ed2838c5dacbfa9facfb20466a60039">oomph::FaceGeometry&lt; QSphericalAdvectionDiffusionElement&lt; NNODE_1D &gt; &gt;::FaceGeometry</a></div><div class="ttdeci">FaceGeometry()</div><div class="ttdoc">Constructor: Call the constructor for the appropriate lower-dimensional QElement.</div><div class="ttdef"><b>Definition:</b> <a href="spherical__advection__diffusion__elements_8h_source.html#l00657">spherical_advection_diffusion_elements.h:657</a></div></div>
<div class="ttc" id="anamespaceoomph_1_1QuadTreeNames_html_a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6"><div class="ttname"><a href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">oomph::QuadTreeNames::W</a></div><div class="ttdeci">@ W</div><div class="ttdef"><b>Definition:</b> <a href="quadtree_8h_source.html#l00056">quadtree.h:56</a></div></div>
<div class="ttc" id="anamespaceoomph_1_1BrokenCopy_html_a7e5cd7fda8b8c790003151bee77a84ac"><div class="ttname"><a href="namespaceoomph_1_1BrokenCopy.html#a7e5cd7fda8b8c790003151bee77a84ac">oomph::BrokenCopy::broken_copy</a></div><div class="ttdeci">void broken_copy(const std::string &amp;class_name)</div><div class="ttdoc">Issue error message and terminate execution.</div><div class="ttdef"><b>Definition:</b> <a href="oomph__utilities_8cc_source.html#l00214">oomph_utilities.cc:214</a></div></div>
<div class="ttc" id="aclassoomph_1_1SphericalAdvectionDiffusionEquations_html_a7f7a29ec80961ed10841bd5e2ba9f51c"><div class="ttname"><a href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#a7f7a29ec80961ed10841bd5e2ba9f51c">oomph::SphericalAdvectionDiffusionEquations::pe_st</a></div><div class="ttdeci">const double &amp; pe_st() const</div><div class="ttdoc">Peclet number multiplied by Strouhal number.</div><div class="ttdef"><b>Definition:</b> <a href="spherical__advection__diffusion__elements_8h_source.html#l00204">spherical_advection_diffusion_elements.h:204</a></div></div>
<div class="ttc" id="aclassoomph_1_1SphericalAdvectionDiffusionFluxElement_html_a85e2f9e5a93f978b21cbf6d425d8c991"><div class="ttname"><a href="classoomph_1_1SphericalAdvectionDiffusionFluxElement.html#a85e2f9e5a93f978b21cbf6d425d8c991">oomph::SphericalAdvectionDiffusionFluxElement::SphericalAdvectionDiffusionFluxElement</a></div><div class="ttdeci">SphericalAdvectionDiffusionFluxElement(const SphericalAdvectionDiffusionFluxElement &amp;dummy)</div><div class="ttdoc">Broken copy constructor.</div><div class="ttdef"><b>Definition:</b> <a href="spherical__advection__diffusion__elements_8h_source.html#l00716">spherical_advection_diffusion_elements.h:716</a></div></div>
<div class="ttc" id="aclassoomph_1_1GeomObject_html_a3c92023891dd4a0e818022f467eeb7f1"><div class="ttname"><a href="classoomph_1_1GeomObject.html#a3c92023891dd4a0e818022f467eeb7f1">oomph::GeomObject::time_stepper_pt</a></div><div class="ttdeci">TimeStepper *&amp; time_stepper_pt()</div><div class="ttdoc">Access function for pointer to time stepper: Null if object is not time-dependent.</div><div class="ttdef"><b>Definition:</b> <a href="geom__objects_8h_source.html#l00193">geom_objects.h:193</a></div></div>
<div class="ttc" id="aclassoomph_1_1TimeStepper_html"><div class="ttname"><a href="classoomph_1_1TimeStepper.html">oomph::TimeStepper</a></div><div class="ttdoc">Base class for time-stepping schemes. Timestepper provides an approximation of the temporal derivativ...</div><div class="ttdef"><b>Definition:</b> <a href="timesteppers_8h_source.html#l00215">timesteppers.h:215</a></div></div>
<div class="ttc" id="aclassoomph_1_1SphericalAdvectionDiffusionFluxElement_html_a9ac365607431a072d3adc043cf057611"><div class="ttname"><a href="classoomph_1_1SphericalAdvectionDiffusionFluxElement.html#a9ac365607431a072d3adc043cf057611">oomph::SphericalAdvectionDiffusionFluxElement::output</a></div><div class="ttdeci">void output(std::ostream &amp;outfile)</div><div class="ttdoc">Output function  forward to broken version in FiniteElement until somebody decides what exactly they...</div><div class="ttdef"><b>Definition:</b> <a href="spherical__advection__diffusion__elements_8h_source.html#l00774">spherical_advection_diffusion_elements.h:774</a></div></div>
<div class="ttc" id="aclassoomph_1_1QSphericalAdvectionDiffusionElement_html_ae67830606f8940978529b305794ec98d"><div class="ttname"><a href="classoomph_1_1QSphericalAdvectionDiffusionElement.html#ae67830606f8940978529b305794ec98d">oomph::QSphericalAdvectionDiffusionElement::output_fct</a></div><div class="ttdeci">void output_fct(std::ostream &amp;outfile, const unsigned &amp;n_plot, FiniteElement::SteadyExactSolutionFctPt exact_soln_pt)</div><div class="ttdoc">Output function for an exact solution: r,z,u_exact at n_plot^2 plot points.</div><div class="ttdef"><b>Definition:</b> <a href="spherical__advection__diffusion__elements_8h_source.html#l00552">spherical_advection_diffusion_elements.h:552</a></div></div>
<div class="ttc" id="aclassoomph_1_1GeneralisedElement_html_a4bff11b8ff97aefabb2df41e61e1779f"><div class="ttname"><a href="classoomph_1_1GeneralisedElement.html#a4bff11b8ff97aefabb2df41e61e1779f">oomph::GeneralisedElement::Dummy_matrix</a></div><div class="ttdeci">static DenseMatrix&lt; double &gt; Dummy_matrix</div><div class="ttdoc">Empty dense matrix used as a dummy argument to combined residual and jacobian functions in the case w...</div><div class="ttdef"><b>Definition:</b> <a href="elements_8h_source.html#l00224">elements.h:224</a></div></div>
<div class="ttc" id="aclassoomph_1_1SphericalAdvectionDiffusionEquations_html_a143f3e3ec0e1ac832b957635ce5c58f0"><div class="ttname"><a href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#a143f3e3ec0e1ac832b957635ce5c58f0">oomph::SphericalAdvectionDiffusionEquations::wind_fct_pt</a></div><div class="ttdeci">SphericalAdvectionDiffusionWindFctPt wind_fct_pt() const</div><div class="ttdoc">Access function: Pointer to wind function. Const version.</div><div class="ttdef"><b>Definition:</b> <a href="spherical__advection__diffusion__elements_8h_source.html#l00192">spherical_advection_diffusion_elements.h:192</a></div></div>
<div class="ttc" id="aclassoomph_1_1QSphericalAdvectionDiffusionElement_html_a16854bbf99abd7b8512474992a29f72b"><div class="ttname"><a href="classoomph_1_1QSphericalAdvectionDiffusionElement.html#a16854bbf99abd7b8512474992a29f72b">oomph::QSphericalAdvectionDiffusionElement::output</a></div><div class="ttdeci">void output(FILE *file_pt, const unsigned &amp;n_plot)</div><div class="ttdoc">C-style output function:   r,z,u at n_plot^2 plot points.</div><div class="ttdef"><b>Definition:</b> <a href="spherical__advection__diffusion__elements_8h_source.html#l00545">spherical_advection_diffusion_elements.h:545</a></div></div>
<div class="ttc" id="aclassoomph_1_1QSphericalAdvectionDiffusionElement_html_ac15987174b58e77489aa6e5f12b9db81"><div class="ttname"><a href="classoomph_1_1QSphericalAdvectionDiffusionElement.html#ac15987174b58e77489aa6e5f12b9db81">oomph::QSphericalAdvectionDiffusionElement::dshape_and_dtest_eulerian_at_knot_spherical_adv_diff</a></div><div class="ttdeci">double dshape_and_dtest_eulerian_at_knot_spherical_adv_diff(const unsigned &amp;ipt, Shape &amp;psi, DShape &amp;dpsidx, Shape &amp;test, DShape &amp;dtestdx) const</div><div class="ttdoc">Shape, test functions &amp; derivs. w.r.t. to global coords. at integration point ipt....</div><div class="ttdef"><b>Definition:</b> <a href="spherical__advection__diffusion__elements_8h_source.html#l00627">spherical_advection_diffusion_elements.h:627</a></div></div>
<div class="ttc" id="anamespaceoomph_html"><div class="ttname"><a href="namespaceoomph.html">oomph</a></div><div class="ttdoc">DRAIG: Change all instances of (SPATIAL_DIM) to (DIM-1).</div><div class="ttdef"><b>Definition:</b> <a href="advection__diffusion__elements_8cc_source.html#l00029">advection_diffusion_elements.cc:29</a></div></div>
<div class="ttc" id="aclassoomph_1_1SphericalAdvectionDiffusionEquations_html_a058fcdc912959c322e704d82d33cde6c"><div class="ttname"><a href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#a058fcdc912959c322e704d82d33cde6c">oomph::SphericalAdvectionDiffusionEquations::self_test</a></div><div class="ttdeci">unsigned self_test()</div><div class="ttdoc">Self-test: Return 0 for OK.</div><div class="ttdef"><b>Definition:</b> <a href="spherical__advection__diffusion__elements_8cc_source.html#l00216">spherical_advection_diffusion_elements.cc:216</a></div></div>
<div class="ttc" id="aclassoomph_1_1FiniteElement_html_a6219ed269a6d89b5aa14659cce48905a"><div class="ttname"><a href="classoomph_1_1FiniteElement.html#a6219ed269a6d89b5aa14659cce48905a">oomph::FiniteElement::nnode</a></div><div class="ttdeci">unsigned nnode() const</div><div class="ttdoc">Return the number of nodes.</div><div class="ttdef"><b>Definition:</b> <a href="elements_8h_source.html#l02159">elements.h:2159</a></div></div>
<div class="ttc" id="aclassoomph_1_1QSphericalAdvectionDiffusionElement_html_a160d448e9026e125714d38a4550676a4"><div class="ttname"><a href="classoomph_1_1QSphericalAdvectionDiffusionElement.html#a160d448e9026e125714d38a4550676a4">oomph::QSphericalAdvectionDiffusionElement::output</a></div><div class="ttdeci">void output(FILE *file_pt)</div><div class="ttdoc">C-style output function:   r,z,u.</div><div class="ttdef"><b>Definition:</b> <a href="spherical__advection__diffusion__elements_8h_source.html#l00538">spherical_advection_diffusion_elements.h:538</a></div></div>
<div class="ttc" id="aclassoomph_1_1SphericalAdvectionDiffusionEquations_html_a9c4d749b66acb943eac37478584683aa"><div class="ttname"><a href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#a9c4d749b66acb943eac37478584683aa">oomph::SphericalAdvectionDiffusionEquations::source_fct_pt</a></div><div class="ttdeci">SphericalAdvectionDiffusionSourceFctPt source_fct_pt() const</div><div class="ttdoc">Access function: Pointer to source function. Const version.</div><div class="ttdef"><b>Definition:</b> <a href="spherical__advection__diffusion__elements_8h_source.html#l00182">spherical_advection_diffusion_elements.h:182</a></div></div>
<div class="ttc" id="aclassoomph_1_1Vector_html"><div class="ttname"><a href="classoomph_1_1Vector.html">oomph::Vector&lt; double &gt;</a></div></div>
<div class="ttc" id="aclassoomph_1_1SphericalAdvectionDiffusionEquations_html_adad87bb3578d688543743e139aa1d84f"><div class="ttname"><a href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#adad87bb3578d688543743e139aa1d84f">oomph::SphericalAdvectionDiffusionEquations::dshape_and_dtest_eulerian_spherical_adv_diff</a></div><div class="ttdeci">virtual double dshape_and_dtest_eulerian_spherical_adv_diff(const Vector&lt; double &gt; &amp;s, Shape &amp;psi, DShape &amp;dpsidx, Shape &amp;test, DShape &amp;dtestdx) const =0</div><div class="ttdoc">Shape/test functions and derivs w.r.t. to global coords at local coord. s; return Jacobian of mapping...</div></div>
<div class="ttc" id="aclassoomph_1_1FiniteElement_html_a58a25b6859ddd43b7bfe64a19fee5023"><div class="ttname"><a href="classoomph_1_1FiniteElement.html#a58a25b6859ddd43b7bfe64a19fee5023">oomph::FiniteElement::shape</a></div><div class="ttdeci">virtual void shape(const Vector&lt; double &gt; &amp;s, Shape &amp;psi) const =0</div><div class="ttdoc">Calculate the geometric shape functions at local coordinate s. This function must be overloaded for e...</div></div>
<div class="ttc" id="aclassoomph_1_1QSphericalAdvectionDiffusionElement_html_a3ab4082df2e8a5d0c6dc95432487ba71"><div class="ttname"><a href="classoomph_1_1QSphericalAdvectionDiffusionElement.html#a3ab4082df2e8a5d0c6dc95432487ba71">oomph::QSphericalAdvectionDiffusionElement::QSphericalAdvectionDiffusionElement</a></div><div class="ttdeci">QSphericalAdvectionDiffusionElement(const QSphericalAdvectionDiffusionElement&lt; NNODE_1D &gt; &amp;dummy)</div><div class="ttdoc">Broken copy constructor.</div><div class="ttdef"><b>Definition:</b> <a href="spherical__advection__diffusion__elements_8h_source.html#l00502">spherical_advection_diffusion_elements.h:502</a></div></div>
<div class="ttc" id="acfortran_8h_html_adb50e893b86b3e55e751a42eab3cba82"><div class="ttname"><a href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a></div><div class="ttdeci">cstr elem_len * i</div><div class="ttdef"><b>Definition:</b> <a href="cfortran_8h_source.html#l00603">cfortran.h:603</a></div></div>
<div class="ttc" id="aclassoomph_1_1SphericalAdvectionDiffusionFluxElement_html_afac22354e3e360de61691047efe82be3"><div class="ttname"><a href="classoomph_1_1SphericalAdvectionDiffusionFluxElement.html#afac22354e3e360de61691047efe82be3">oomph::SphericalAdvectionDiffusionFluxElement::Beta_fct_pt</a></div><div class="ttdeci">SphericalAdvectionDiffusionPrescribedBetaFctPt Beta_fct_pt</div><div class="ttdoc">Function pointer to the (global) prescribed-beta function.</div><div class="ttdef"><b>Definition:</b> <a href="spherical__advection__diffusion__elements_8h_source.html#l00879">spherical_advection_diffusion_elements.h:879</a></div></div>
<div class="ttc" id="aclassoomph_1_1SphericalAdvectionDiffusionFluxElement_html"><div class="ttname"><a href="classoomph_1_1SphericalAdvectionDiffusionFluxElement.html">oomph::SphericalAdvectionDiffusionFluxElement</a></div><div class="ttdoc">A class for elements that allow the imposition of an applied Robin boundary condition on the boundari...</div><div class="ttdef"><b>Definition:</b> <a href="spherical__advection__diffusion__elements_8h_source.html#l00679">spherical_advection_diffusion_elements.h:679</a></div></div>
<div class="ttc" id="aclassoomph_1_1Data_html_a13206dcb7a088db0ef845ab71af505d2"><div class="ttname"><a href="classoomph_1_1Data.html#a13206dcb7a088db0ef845ab71af505d2">oomph::Data::eqn_number</a></div><div class="ttdeci">long &amp; eqn_number(const unsigned &amp;i)</div><div class="ttdoc">Return the equation number of the i-th stored variable.</div><div class="ttdef"><b>Definition:</b> <a href="nodes_8h_source.html#l00361">nodes.h:361</a></div></div>
<div class="ttc" id="aclassoomph_1_1QSphericalAdvectionDiffusionElement_html_addf1f59cc684120c3063774ce75a72a4"><div class="ttname"><a href="classoomph_1_1QSphericalAdvectionDiffusionElement.html#addf1f59cc684120c3063774ce75a72a4">oomph::QSphericalAdvectionDiffusionElement::output</a></div><div class="ttdeci">void output(std::ostream &amp;outfile)</div><div class="ttdoc">Output function:   r,z,u.</div><div class="ttdef"><b>Definition:</b> <a href="spherical__advection__diffusion__elements_8h_source.html#l00523">spherical_advection_diffusion_elements.h:523</a></div></div>
<div class="ttc" id="aclassoomph_1_1DShape_html"><div class="ttname"><a href="classoomph_1_1DShape.html">oomph::DShape</a></div><div class="ttdef"><b>Definition:</b> <a href="shape_8h_source.html#l00271">shape.h:271</a></div></div>
<div class="ttc" id="aclassoomph_1_1SphericalAdvectionDiffusionFluxElement_html_a1fe86f85817dd5621ab510d37b3a8ce8"><div class="ttname"><a href="classoomph_1_1SphericalAdvectionDiffusionFluxElement.html#a1fe86f85817dd5621ab510d37b3a8ce8">oomph::SphericalAdvectionDiffusionFluxElement::SphericalAdvectionDiffusionPrescribedBetaFctPt</a></div><div class="ttdeci">void(* SphericalAdvectionDiffusionPrescribedBetaFctPt)(const Vector&lt; double &gt; &amp;x, double &amp;beta)</div><div class="ttdoc">Function pointer to the prescribed-beta function fct(x,beta(x))  x is a Vector!</div><div class="ttdef"><b>Definition:</b> <a href="spherical__advection__diffusion__elements_8h_source.html#l00689">spherical_advection_diffusion_elements.h:689</a></div></div>
<div class="ttc" id="aclassoomph_1_1SphericalAdvectionDiffusionEquations_html_a5159b68db86351eba5efa89f4c922745"><div class="ttname"><a href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#a5159b68db86351eba5efa89f4c922745">oomph::SphericalAdvectionDiffusionEquations::du_dt_spherical_adv_diff</a></div><div class="ttdeci">double du_dt_spherical_adv_diff(const unsigned &amp;n) const</div><div class="ttdoc">du/dt at local node n.</div><div class="ttdef"><b>Definition:</b> <a href="spherical__advection__diffusion__elements_8h_source.html#l00111">spherical_advection_diffusion_elements.h:111</a></div></div>
<div class="ttc" id="aclassoomph_1_1QSphericalAdvectionDiffusionElement_html_a7a82f6fad31e48bcc3fe1e1d7b818a74"><div class="ttname"><a href="classoomph_1_1QSphericalAdvectionDiffusionElement.html#a7a82f6fad31e48bcc3fe1e1d7b818a74">oomph::QSphericalAdvectionDiffusionElement::QSphericalAdvectionDiffusionElement</a></div><div class="ttdeci">QSphericalAdvectionDiffusionElement()</div><div class="ttdoc">Constructor: Call constructors for QElement and Advection Diffusion equations.</div><div class="ttdef"><b>Definition:</b> <a href="spherical__advection__diffusion__elements_8h_source.html#l00497">spherical_advection_diffusion_elements.h:497</a></div></div>
<div class="ttc" id="athe__data__structure_8txt_html_af88b2d950fae19ab641bd1690e08445c"><div class="ttname"><a href="the__data__structure_8txt.html#af88b2d950fae19ab641bd1690e08445c">n</a></div><div class="ttdeci">endcode We introduce wrapper functions to access function so that we can formulate The Maths in generic terms Rather than referring to the pressure at node c n</div><div class="ttdef"><b>Definition:</b> <a href="the__data__structure_8txt_source.html#l00582">the_data_structure.txt:582</a></div></div>
<div class="ttc" id="aclassoomph_1_1QSphericalAdvectionDiffusionElement_html_acd51b557de9302ded1dd48c72760d3df"><div class="ttname"><a href="classoomph_1_1QSphericalAdvectionDiffusionElement.html#acd51b557de9302ded1dd48c72760d3df">oomph::QSphericalAdvectionDiffusionElement::required_nvalue</a></div><div class="ttdeci">unsigned required_nvalue(const unsigned &amp;n) const</div><div class="ttdoc">Required # of values (pinned or dofs) at node n.</div><div class="ttdef"><b>Definition:</b> <a href="spherical__advection__diffusion__elements_8h_source.html#l00516">spherical_advection_diffusion_elements.h:516</a></div></div>
<div class="ttc" id="aclassoomph_1_1SphericalAdvectionDiffusionEquations_html_a25c6b912aba1088ed4759a7523a1d19a"><div class="ttname"><a href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#a25c6b912aba1088ed4759a7523a1d19a">oomph::SphericalAdvectionDiffusionEquations::interpolated_u_spherical_adv_diff</a></div><div class="ttdeci">double interpolated_u_spherical_adv_diff(const Vector&lt; double &gt; &amp;s) const</div><div class="ttdoc">Return FE representation of function value u(s) at local coordinate s.</div><div class="ttdef"><b>Definition:</b> <a href="spherical__advection__diffusion__elements_8h_source.html#l00331">spherical_advection_diffusion_elements.h:331</a></div></div>
<div class="ttc" id="aclassoomph_1_1TimeStepper_html_ad341ba9e80265e1c26c1cda0f40c8292"><div class="ttname"><a href="classoomph_1_1TimeStepper.html#ad341ba9e80265e1c26c1cda0f40c8292">oomph::TimeStepper::is_steady</a></div><div class="ttdeci">bool is_steady() const</div><div class="ttdoc">Flag to indicate if a timestepper has been made steady (possibly temporarily to switch off time-depen...</div><div class="ttdef"><b>Definition:</b> <a href="timesteppers_8h_source.html#l00371">timesteppers.h:371</a></div></div>
<div class="ttc" id="aclassoomph_1_1SphericalAdvectionDiffusionEquations_html_a9895841883dedbbc00fb1fc51ad0493e"><div class="ttname"><a href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#a9895841883dedbbc00fb1fc51ad0493e">oomph::SphericalAdvectionDiffusionEquations::source_fct_pt</a></div><div class="ttdeci">SphericalAdvectionDiffusionSourceFctPt &amp; source_fct_pt()</div><div class="ttdoc">Access function: Pointer to source function.</div><div class="ttdef"><b>Definition:</b> <a href="spherical__advection__diffusion__elements_8h_source.html#l00177">spherical_advection_diffusion_elements.h:177</a></div></div>
<div class="ttc" id="aclassoomph_1_1Data_html_a5b34970d16205921dca3ada720da8445"><div class="ttname"><a href="classoomph_1_1Data.html#a5b34970d16205921dca3ada720da8445">oomph::Data::time_stepper_pt</a></div><div class="ttdeci">TimeStepper *&amp; time_stepper_pt()</div><div class="ttdoc">Return the pointer to the timestepper.</div><div class="ttdef"><b>Definition:</b> <a href="nodes_8h_source.html#l00242">nodes.h:242</a></div></div>
<div class="ttc" id="aclassoomph_1_1SphericalAdvectionDiffusionFluxElement_html_afbcbd2ed140bb94e69d518fcc60960d8"><div class="ttname"><a href="classoomph_1_1SphericalAdvectionDiffusionFluxElement.html#afbcbd2ed140bb94e69d518fcc60960d8">oomph::SphericalAdvectionDiffusionFluxElement::operator=</a></div><div class="ttdeci">void operator=(const SphericalAdvectionDiffusionFluxElement &amp;)</div><div class="ttdoc">Broken assignment operator.</div><div class="ttdef"><b>Definition:</b> <a href="spherical__advection__diffusion__elements_8h_source.html#l00723">spherical_advection_diffusion_elements.h:723</a></div></div>
<div class="ttc" id="aclassoomph_1_1FaceElement_html"><div class="ttname"><a href="classoomph_1_1FaceElement.html">oomph::FaceElement</a></div><div class="ttdef"><b>Definition:</b> <a href="elements_8h_source.html#l04215">elements.h:4215</a></div></div>
<div class="ttc" id="aclassoomph_1_1SphericalAdvectionDiffusionFluxElement_html_ac8579ca5c2ad606199559db1f971d13b"><div class="ttname"><a href="classoomph_1_1SphericalAdvectionDiffusionFluxElement.html#ac8579ca5c2ad606199559db1f971d13b">oomph::SphericalAdvectionDiffusionFluxElement::fill_in_contribution_to_residuals</a></div><div class="ttdeci">void fill_in_contribution_to_residuals(Vector&lt; double &gt; &amp;residuals)</div><div class="ttdoc">Add the element's contribution to its residual vector.</div><div class="ttdef"><b>Definition:</b> <a href="spherical__advection__diffusion__elements_8h_source.html#l00742">spherical_advection_diffusion_elements.h:742</a></div></div>
<div class="ttc" id="aclassoomph_1_1QSphericalAdvectionDiffusionElement_html_a8d490ed0cc7142335000801a905ed852"><div class="ttname"><a href="classoomph_1_1QSphericalAdvectionDiffusionElement.html#a8d490ed0cc7142335000801a905ed852">oomph::QSphericalAdvectionDiffusionElement::Initial_Nvalue</a></div><div class="ttdeci">static const unsigned Initial_Nvalue</div><div class="ttdoc">Static array of ints to hold number of variables at nodes: Initial_Nvalue[n].</div><div class="ttdef"><b>Definition:</b> <a href="spherical__advection__diffusion__elements_8h_source.html#l00490">spherical_advection_diffusion_elements.h:490</a></div></div>
<div class="ttc" id="aclassoomph_1_1TimeStepper_html_a4cb0aecb044b77ba0553cdd54b586d8a"><div class="ttname"><a href="classoomph_1_1TimeStepper.html#a4cb0aecb044b77ba0553cdd54b586d8a">oomph::TimeStepper::weight</a></div><div class="ttdeci">virtual double weight(const unsigned &amp;i, const unsigned &amp;j) const</div><div class="ttdoc">Access function for j-th weight for the i-th derivative.</div><div class="ttdef"><b>Definition:</b> <a href="timesteppers_8h_source.html#l00553">timesteppers.h:553</a></div></div>
<div class="ttc" id="aclassoomph_1_1SphericalAdvectionDiffusionFluxElement_html_a7dd7a4627052f615642c64eea143e4c5"><div class="ttname"><a href="classoomph_1_1SphericalAdvectionDiffusionFluxElement.html#a7dd7a4627052f615642c64eea143e4c5">oomph::SphericalAdvectionDiffusionFluxElement::fill_in_generic_residual_contribution_spherical_adv_diff_flux</a></div><div class="ttdeci">void fill_in_generic_residual_contribution_spherical_adv_diff_flux(Vector&lt; double &gt; &amp;residuals, DenseMatrix&lt; double &gt; &amp;jacobian, unsigned flag)</div><div class="ttdoc">Add the element's contribution to its residual vector. flag=1(or 0): do (or don't) compute the Jacobi...</div><div class="ttdef"><b>Definition:</b> <a href="spherical__advection__diffusion__elements_8h_source.html#l00986">spherical_advection_diffusion_elements.h:986</a></div></div>
<div class="ttc" id="aclassoomph_1_1FiniteElement_html_a2ad98a3d2ef4999f1bef62c0ff13f2a7"><div class="ttname"><a href="classoomph_1_1FiniteElement.html#a2ad98a3d2ef4999f1bef62c0ff13f2a7">oomph::FiniteElement::output</a></div><div class="ttdeci">virtual void output(std::ostream &amp;outfile)</div><div class="ttdoc">Output the element data  typically the values at the nodes in a format suitable for post-processing.</div><div class="ttdef"><b>Definition:</b> <a href="elements_8h_source.html#l02912">elements.h:2912</a></div></div>
<div class="ttc" id="aclassoomph_1_1QSphericalAdvectionDiffusionElement_html"><div class="ttname"><a href="classoomph_1_1QSphericalAdvectionDiffusionElement.html">oomph::QSphericalAdvectionDiffusionElement</a></div><div class="ttdoc">QSphericalAdvectionDiffusionElement elements are linear/quadrilateral/brick-shaped Axisymmetric Advec...</div><div class="ttdef"><b>Definition:</b> <a href="spherical__advection__diffusion__elements_8h_source.html#l00482">spherical_advection_diffusion_elements.h:482</a></div></div>
<div class="ttc" id="aclassoomph_1_1FiniteElement_html_a28fd5c2d4aeba5ef65bee0e0d72569f5"><div class="ttname"><a href="classoomph_1_1FiniteElement.html#a28fd5c2d4aeba5ef65bee0e0d72569f5">oomph::FiniteElement::nodal_value</a></div><div class="ttdeci">double nodal_value(const unsigned &amp;n, const unsigned &amp;i) const</div><div class="ttdoc">Return the i-th value stored at local node n. Produces suitably interpolated values for hanging nodes...</div><div class="ttdef"><b>Definition:</b> <a href="elements_8h_source.html#l02483">elements.h:2483</a></div></div>
<div class="ttc" id="aclassoomph_1_1SphericalAdvectionDiffusionEquations_html_ab28f6e9b6c44a405e7ee7611df43e7c7"><div class="ttname"><a href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#ab28f6e9b6c44a405e7ee7611df43e7c7">oomph::SphericalAdvectionDiffusionEquations::Default_peclet_number</a></div><div class="ttdeci">static double Default_peclet_number</div><div class="ttdoc">Static default value for the Peclet number.</div><div class="ttdef"><b>Definition:</b> <a href="spherical__advection__diffusion__elements_8h_source.html#l00464">spherical_advection_diffusion_elements.h:464</a></div></div>
<div class="ttc" id="aclassoomph_1_1Shape_html"><div class="ttname"><a href="classoomph_1_1Shape.html">oomph::Shape</a></div><div class="ttdef"><b>Definition:</b> <a href="shape_8h_source.html#l00077">shape.h:77</a></div></div>
<div class="ttc" id="aclassoomph_1_1SphericalAdvectionDiffusionFluxElement_html_ab84762e928d94711e2f77339c3f9ee49"><div class="ttname"><a href="classoomph_1_1SphericalAdvectionDiffusionFluxElement.html#ab84762e928d94711e2f77339c3f9ee49">oomph::SphericalAdvectionDiffusionFluxElement::alpha_fct_pt</a></div><div class="ttdeci">SphericalAdvectionDiffusionPrescribedAlphaFctPt &amp; alpha_fct_pt()</div><div class="ttdoc">Access function for the prescribed-alpha function pointer.</div><div class="ttdef"><b>Definition:</b> <a href="spherical__advection__diffusion__elements_8h_source.html#l00735">spherical_advection_diffusion_elements.h:735</a></div></div>
<div class="ttc" id="aclassoomph_1_1SphericalAdvectionDiffusionEquations_html"><div class="ttname"><a href="classoomph_1_1SphericalAdvectionDiffusionEquations.html">oomph::SphericalAdvectionDiffusionEquations</a></div><div class="ttdoc">A class for all elements that solve the Advection Diffusion equations in a spherical polar coordinate...</div><div class="ttdef"><b>Definition:</b> <a href="spherical__advection__diffusion__elements_8h_source.html#l00057">spherical_advection_diffusion_elements.h:57</a></div></div>
<div class="ttc" id="aclassoomph_1_1SphericalAdvectionDiffusionFluxElement_html_a80df265285debfbfbffd4a48df4a2152"><div class="ttname"><a href="classoomph_1_1SphericalAdvectionDiffusionFluxElement.html#a80df265285debfbfbffd4a48df4a2152">oomph::SphericalAdvectionDiffusionFluxElement::output</a></div><div class="ttdeci">void output(std::ostream &amp;outfile, const unsigned &amp;nplot)</div><div class="ttdoc">Output function  forward to broken version in FiniteElement until somebody decides what exactly they...</div><div class="ttdef"><b>Definition:</b> <a href="spherical__advection__diffusion__elements_8h_source.html#l00781">spherical_advection_diffusion_elements.h:781</a></div></div>
<div class="ttc" id="acfortran_8h_html_ab7123126e4885ef647dd9c6e3807a21c"><div class="ttname"><a href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a></div><div class="ttdeci">static char t char * s</div><div class="ttdef"><b>Definition:</b> <a href="cfortran_8h_source.html#l00568">cfortran.h:568</a></div></div>
<div class="ttc" id="aclassoomph_1_1FaceGeometry_html"><div class="ttname"><a href="classoomph_1_1FaceGeometry.html">oomph::FaceGeometry</a></div><div class="ttdef"><b>Definition:</b> <a href="elements_8h_source.html#l04837">elements.h:4837</a></div></div>
<div class="ttc" id="anamespaceoomph_1_1BrokenCopy_html_a32dc384e671e786bac0c67cbff701f45"><div class="ttname"><a href="namespaceoomph_1_1BrokenCopy.html#a32dc384e671e786bac0c67cbff701f45">oomph::BrokenCopy::broken_assign</a></div><div class="ttdeci">void broken_assign(const std::string &amp;class_name)</div><div class="ttdoc">Issue error message and terminate execution.</div><div class="ttdef"><b>Definition:</b> <a href="oomph__utilities_8cc_source.html#l00197">oomph_utilities.cc:197</a></div></div>
<div class="ttc" id="aclassoomph_1_1SphericalAdvectionDiffusionEquations_html_a5e2334112c6c967c490fc9e5f54f5b35"><div class="ttname"><a href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#a5e2334112c6c967c490fc9e5f54f5b35">oomph::SphericalAdvectionDiffusionEquations::output</a></div><div class="ttdeci">void output(FILE *file_pt)</div><div class="ttdoc">C_style output with default number of plot points.</div><div class="ttdef"><b>Definition:</b> <a href="spherical__advection__diffusion__elements_8h_source.html#l00153">spherical_advection_diffusion_elements.h:153</a></div></div>
<div class="ttc" id="aclassoomph_1_1SphericalAdvectionDiffusionEquations_html_ac1df4b72634538673bfd5c1eab02ddad"><div class="ttname"><a href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#ac1df4b72634538673bfd5c1eab02ddad">oomph::SphericalAdvectionDiffusionEquations::operator=</a></div><div class="ttdeci">void operator=(const SphericalAdvectionDiffusionEquations &amp;)</div><div class="ttdoc">Broken assignment operator.</div><div class="ttdef"><b>Definition:</b> <a href="spherical__advection__diffusion__elements_8h_source.html#l00091">spherical_advection_diffusion_elements.h:91</a></div></div>
<div class="ttc" id="anamespaceoomph_1_1Global__string__for__annotation_html_ac5379de2fa7fe44f2cb31785fc208135"><div class="ttname"><a href="namespaceoomph_1_1Global__string__for__annotation.html#ac5379de2fa7fe44f2cb31785fc208135">oomph::Global_string_for_annotation::string</a></div><div class="ttdeci">std::string string(const unsigned &amp;i)</div><div class="ttdoc">Return the i-th string or &quot;&quot; if the relevant string hasn't been defined.</div><div class="ttdef"><b>Definition:</b> <a href="oomph__definitions_8cc_source.html#l00289">oomph_definitions.cc:289</a></div></div>
<div class="ttc" id="aclassoomph_1_1SphericalAdvectionDiffusionEquations_html_a57068b61f67c6aa99f3339cf852fa696"><div class="ttname"><a href="classoomph_1_1SphericalAdvectionDiffusionEquations.html#a57068b61f67c6aa99f3339cf852fa696">oomph::SphericalAdvectionDiffusionEquations::fill_in_contribution_to_residuals</a></div><div class="ttdeci">void fill_in_contribution_to_residuals(Vector&lt; double &gt; &amp;residuals)</div><div class="ttdoc">Add the element's contribution to its residual vector (wrapper)</div><div class="ttdef"><b>Definition:</b> <a href="spherical__advection__diffusion__elements_8h_source.html#l00290">spherical_advection_diffusion_elements.h:290</a></div></div>
<div class="ttc" id="aclassoomph_1_1FaceElement_html_a919d0d76746eaa78a8a3c7f75f99a9e5"><div class="ttname"><a href="classoomph_1_1FaceElement.html#a919d0d76746eaa78a8a3c7f75f99a9e5">oomph::FaceElement::J_eulerian</a></div><div class="ttdeci">double J_eulerian(const Vector&lt; double &gt; &amp;s) const</div><div class="ttdoc">Return the Jacobian of mapping from local to global coordinates at local position s....</div><div class="ttdef"><b>Definition:</b> <a href="elements_8cc_source.html#l05112">elements.cc:5112</a></div></div>

    <!-- jQuery for Bootstrap and Doxygen -->
    <script src="../../js/jquery-1.12.0.min.js"></script>
    <!-- Minified boostrap plugins-->
    <script src="../../js/bootstrap.js"></script>
    <!-- Doxygen dependency to add powertips to source code-->
    <script src="../../js/jquery.powertip.min.js"></script>
    <!-- The  following script is generated by doxygen and hides/shows levels in 
         the data structure lists and adds powertips to source code-->
    <script src="../../js/dynsections.js" ></script>
    <!-- add to Doxygen's class names so bootstrap css and js recognises them-->
    <script type="text/javascript">
    $(".contents").addClass("container");
    $(".header").addClass("container");
    $(".navpath").addClass("container");
    $("#navrow3").addClass("container");
    $("#navrow4").addClass("container");
    $(".mlabel").addClass("label");
    $(".mlabel").addClass("label-default");
    $(".memitem").addClass("panel");
    $(".memitem").addClass("panel-info");
    $(".memproto").addClass("panel-heading");
    $(".memdoc").addClass("panel-body");
    </script>
    <footer>
      <div class="container">
        <div class="text-muted" style="float:right;">Generated by <a href="http://www.doxygen.org/index.html">
          <img style="height:18px;" class="footer-img" src="doxygen.png" alt="doxygen"></a> on Wed Aug 4 2021 20:00:59
        </div>
      </div>
    </footer>
</body>
</html>

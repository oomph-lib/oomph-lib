<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
<title>oomph-lib: refineable_brick_element.cc Source File</title>
<link rel="apple-touch-icon" sizes="57x57" href="../../figures/apple-touch-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="../../figures/apple-touch-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="../../figures/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="../../figures/apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="../../figures/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="../../figures/apple-touch-icon-120x120.png">
<link rel="icon" type="image/png" href="../../figures/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="../../figures/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="../../figures/favicon-16x16.png" sizes="16x16">
<link rel="manifest" href="../../figures/manifest.json">
<link rel="mask-icon" href="../../figures/safari-pinned-tab.svg" color="#008000">
<link rel="shortcut icon" href="../../figures/favicon.ico">
<meta name="msapplication-TileColor" content="#00a300">
<meta name="msapplication-config" content="../../figures/browserconfig.xml">
<meta name="theme-color" content="#008000">
<link href="http://fonts.googleapis.com/css?family=Open+Sans:400,300,600" rel="stylesheet" type="text/css">
<!-- Doxygen css-->
<!-- <link rel="stylesheet" type="text/css" href="doxygen.css"> -->
<!-- Bootstrap -->
<link href="../../css/bootstrap.css" rel="stylesheet">
<!-- oomph-lib specific overrides -->
<link rel="stylesheet" type="text/css" href="../../css/oomph_header.css">
</head>
<body>
<nav class="navbar navbar-default">
<div class="container">
<div class="container-fluid">
  <!-- Brand and toggle get grouped for better mobile display -->
  <div class="navbar-header">
    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
      <span class="sr-only">Toggle navigation</span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="../../html/index.html"><img alt="oomph-lib" src="../../figures/oomph_logo.png"></a>
  </div>
  <!-- Collect the nav links, forms, and other content for toggling -->
  <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
    <ul class="nav navbar-nav">          
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Documentation <span class="caret"></span></a>
        <ul class="dropdown-menu">
          <li class="dropdown-header">Big picture</li>
          <li><a href="../../../doc/intro/html/index.html">The finite element method</a></li>
          <li><a href="../../../doc/the_data_structure/html/index.html">The data structure</a></li>
          <li><a href="../../../doc/quick_guide/html/index.html">Not-so-quick guide</a></li>
          <li><a href="../../../doc/optimisation/html/index.html">Optimisation</a></li>
          <li><a href="../../../doc/order_of_action_functions/html/index.html">Order of action functions</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Example codes and tutorials</li>
          <li><a href="../../../doc/example_code_list/html/index.html">List of example codes and tutorials</a></li>
          <li><a href="../../../doc/example_code_list/html/index.html#meshes">Meshing</a></li>
          <li><a href="../../../doc/example_code_list/html/index.html#solvers">Solvers</a></li>
          <li><a href="../../../doc/example_code_list/html/index.html#parallel">MPI parallel processing</a></li>
          <li><a href="../../../doc/example_code_list/html/index.html#visualisation">Post-processing/visualisation</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Other</li>
          <li><a href="../../../doc/change_log/html/index.html">Change log</a></li>
          <li><a href="../../../doc/creating_doc/html/index.html">Creating documentation</a></li>
          <li><a href="../../../doc/coding_conventions/html/index.html">Coding conventions</a></li>
          <li><a href="../../../doc/index/html/index.html">Index</a></li>
          <li><a href="../../../doc/FAQ/html/index.html">FAQ</a></li>
        </ul>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Get it <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../doc/the_distribution/html/index.html">Installation guide</a></li>
            <li><a href="../../../doc/subversion/html/index.html">Get code from subversion repository</a></li>
            <li><a href="../../../doc/download/html/index.html">Get code as tar file</a></li>
            <li><a href="../../../doc/copyright/html/index.html">Copyright</a></li>
          </ul>
        </li>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">About <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../doc/people/html/index.html">People</a></li>            
            <li><a href="../../../doc/contact/html/index.html">Contact/Get involved</a></li>
            <li><a href="../../../doc/publications/html/index.html">Publications</a></li>
            <li><a href="../../../doc/acknowledgements/html/index.html">Acknowledgements</a></li>
            <li><a href="../../../doc/picture_show/index.html">Picture show</a></li>
          </ul>
        </li>
      </li>
    </ul>
    <ul class="nav navbar-nav navbar-right navbar-search">
      <form class="navbar-form" role="search" action="../../../doc/search_results/html/index.html">
        <div class="input-group">
          <input type="text" class="form-control" placeholder="Search" name="q">
          <span class="input-group-btn">
            <button class="btn btn-default" type="submit">Go</button>
          </span>
        </div><!-- /input-group -->
       <!--<div class="form-group">
          <input type="text" class="form-control" placeholder="Search">
        </div>
        <button type="submit" class="btn btn-default">Submit</button>-->
      </form>
    </ul>
  </div><!-- /.navbar-collapse -->
</div><!-- /.container-fluid -->
</div>
</nav>
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_4075b182e53a3873a42d885f4e1e98c4.html">generic</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">refineable_brick_element.cc</div>  </div>
</div><!--header-->
<div class="contents">
<a href="refineable__brick__element_8cc.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">//LIC// ====================================================================</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">//LIC// This file forms part of oomph-lib, the object-oriented, </span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">//LIC// multi-physics finite-element library, available </span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">//LIC// at http://www.oomph-lib.org.</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">//LIC// Copyright (C) 2006-2021 Matthias Heil and Andrew Hazel</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">//LIC// This library is free software; you can redistribute it and/or</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">//LIC// modify it under the terms of the GNU Lesser General Public</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">//LIC// License as published by the Free Software Foundation; either</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">//LIC// version 2.1 of the License, or (at your option) any later version.</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">//LIC// This library is distributed in the hope that it will be useful,</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">//LIC// but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">//LIC// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">//LIC// Lesser General Public License for more details.</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">//LIC// You should have received a copy of the GNU Lesser General Public</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">//LIC// License along with this library; if not, write to the Free Software</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">//LIC// Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">//LIC// 02110-1301  USA.</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">//LIC// The authors may be contacted at oomph-lib@maths.man.ac.uk.</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">//LIC//====================================================================</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &lt;algorithm&gt;</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160; </div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="mesh_8h.html">mesh.h</a>&quot;</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="algebraic__elements_8h.html">algebraic_elements.h</a>&quot;</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="macro__element__node__update__element_8h.html">macro_element_node_update_element.h</a>&quot;</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="refineable__brick__element_8h.html">refineable_brick_element.h</a>&quot;</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160; </div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160; </div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespaceoomph.html">oomph</a></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;{</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160; <span class="comment">//========================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment"> ///  Print corner nodes, use colour (default &quot;BLACK&quot;)</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment"> ///  in right order so that tecplot can draw a cube without crossed lines</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment"></span> <span class="comment">//========================================================================</span></div>
<div class="line"><a name="l00040"></a><span class="lineno"><a class="line" href="classoomph_1_1RefineableQElement_3_013_01_4.html#aa8ea5cf2c9fee8ff9a1c52505e736bbb">   40</a></span>&#160; <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1RefineableQElement.html">RefineableQElement&lt;3&gt;::output_corners</a>(std::ostream&amp; outfile, </div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;                                            <span class="keyword">const</span> <a class="code" href="namespaceoomph_1_1Global__string__for__annotation.html#ac5379de2fa7fe44f2cb31785fc208135">std::string</a>&amp; <a class="code" href="namespaceoomph_1_1TecplotNames.html#a628a7d88afc7542861c9afd2f4ea498c">colour</a>)<span class="keyword"></span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="keyword">  const</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="keyword"> </span>{</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160; </div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>(3);</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> corner(3);</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;             </div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  outfile &lt;&lt; <span class="stringliteral">&quot;ZONE I=2, J=2, K=2 C=&quot;</span> &lt;&lt; <a class="code" href="namespaceoomph_1_1TecplotNames.html#a628a7d88afc7542861c9afd2f4ea498c">colour</a> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;         </div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]=-1.0;</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]=-1.0;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[2]=-1.0;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  get_x(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,corner);</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  outfile &lt;&lt; corner[0]  &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; corner[1]  &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; corner[2] </div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;          &lt;&lt; <span class="stringliteral">&quot; &quot;</span>  &lt;&lt; <a class="code" href="namespaceoomph_1_1Global__unsigned.html#aa0b4579f7ee228aaf16302f4b39e0fdf">Number</a> &lt;&lt;  std::endl;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;             </div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]=-1.0;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]=-1.0;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[2]= 1.0;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  get_x(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,corner);</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  outfile &lt;&lt; corner[0]  &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; corner[1]  &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; corner[2]</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;          &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="namespaceoomph_1_1Global__unsigned.html#aa0b4579f7ee228aaf16302f4b39e0fdf">Number</a> &lt;&lt;  std::endl;</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;             </div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]=-1.0;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]= 1.0;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[2]=-1.0;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  get_x(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,corner);</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  outfile &lt;&lt; corner[0]  &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; corner[1]  &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; corner[2]</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;          &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="namespaceoomph_1_1Global__unsigned.html#aa0b4579f7ee228aaf16302f4b39e0fdf">Number</a> &lt;&lt;  std::endl;</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;             </div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]=-1.0;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]= 1.0;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[2]= 1.0;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  get_x(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,corner);</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  outfile &lt;&lt; corner[0]  &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; corner[1]  &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; corner[2]</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;          &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="namespaceoomph_1_1Global__unsigned.html#aa0b4579f7ee228aaf16302f4b39e0fdf">Number</a> &lt;&lt;  std::endl;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160; </div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="comment">// next face</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160; </div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;             </div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]= 1.0;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;  <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]=-1.0;</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[2]=-1.0;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  get_x(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,corner);</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  outfile &lt;&lt; corner[0]  &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; corner[1]  &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; corner[2] </div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;          &lt;&lt; <span class="stringliteral">&quot; &quot;</span>  &lt;&lt; <a class="code" href="namespaceoomph_1_1Global__unsigned.html#aa0b4579f7ee228aaf16302f4b39e0fdf">Number</a> &lt;&lt;  std::endl;</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;             </div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]= 1.0;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]=-1.0;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[2]= 1.0;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  get_x(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,corner);</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  outfile &lt;&lt; corner[0]  &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; corner[1]  &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; corner[2]</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;          &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="namespaceoomph_1_1Global__unsigned.html#aa0b4579f7ee228aaf16302f4b39e0fdf">Number</a> &lt;&lt;  std::endl;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;             </div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]= 1.0;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]= 1.0;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[2]=-1.0;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  get_x(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,corner);</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  outfile &lt;&lt; corner[0]  &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; corner[1]  &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; corner[2]</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;          &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="namespaceoomph_1_1Global__unsigned.html#aa0b4579f7ee228aaf16302f4b39e0fdf">Number</a> &lt;&lt;  std::endl;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;             </div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]= 1.0;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]= 1.0;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[2]= 1.0;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  get_x(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,corner);</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  outfile &lt;&lt; corner[0]  &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; corner[1]  &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; corner[2]</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;          &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="namespaceoomph_1_1Global__unsigned.html#aa0b4579f7ee228aaf16302f4b39e0fdf">Number</a> &lt;&lt;  std::endl;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160; </div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160; </div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="comment">//  outfile &lt;&lt; &quot;TEXT  CS = GRID, X = &quot; &lt;&lt; corner[0] &lt;&lt;</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="comment">//   &quot;,Y = &quot; &lt;&lt; corner[1] &lt;&lt; &quot;,Z = &quot; &lt;&lt; corner[2] &lt;&lt;</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="comment">//   &quot;, HU = GRID, H = 0.01, AN = MIDCENTER, T =\&quot;&quot; </span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="comment">//          &lt;&lt; Number &lt;&lt; &quot;\&quot;&quot; &lt;&lt; std::endl; </span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;             </div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160; }</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160; </div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160; </div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;   </div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="comment">//==================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="comment">/// Setup static matrix for coincidence between son nodal points and </span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="comment">/// father boundaries:</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="comment">/// </span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="comment">/// Father_bound[nnode_1d](nnode_son,son_type)={RU/RF/RD/RB/.../ OMEGA}</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="comment">/// so that node nnode_son in element of type son_type lies </span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="comment">/// on boundary/vertex Father_bound[nnode_1d](nnode_son,son_type) in its </span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="comment">/// father element. If the node doesn&#39;t lie on a boundary </span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="comment">/// the value is OMEGA.</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="comment"></span><span class="comment">//==================================================================</span></div>
<div class="line"><a name="l00130"></a><span class="lineno"><a class="line" href="classoomph_1_1RefineableQElement_3_013_01_4.html#a8e9be85046f3898ece0a328512392ca8">  130</a></span>&#160; <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1RefineableQElement.html">RefineableQElement&lt;3&gt;::setup_father_bounds</a>()</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160; {</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  <span class="keyword">using namespace </span>OcTreeNames;</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160; </div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;  <span class="comment">//Find the number of nodes along a 1D edge</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  <span class="keywordtype">unsigned</span> n_p = nnode_1d();</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160; </div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  <span class="comment">//Allocate space for the boundary information</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;  Father_bound[n_p].resize(n_p*n_p*n_p,8);</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160; </div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;  <span class="comment">//Initialise: By default points are not on the boundary</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="the__data__structure_8txt.html#af88b2d950fae19ab641bd1690e08445c">n</a>=0;<a class="code" href="the__data__structure_8txt.html#af88b2d950fae19ab641bd1690e08445c">n</a>&lt;n_p*n_p*n_p;<a class="code" href="the__data__structure_8txt.html#af88b2d950fae19ab641bd1690e08445c">n</a>++)</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  {<span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> ison=0;ison&lt;8;ison++) {Father_bound[n_p](<a class="code" href="the__data__structure_8txt.html#af88b2d950fae19ab641bd1690e08445c">n</a>,ison)=<a class="code" href="classoomph_1_1Tree.html#a9e532196340dcd859ff8207eea2ddbbc">Tree::OMEGA</a>;}}</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160; </div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i_son=<a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40abed39d2cabdadba8a0746381691ccf77">LDB</a>;i_son&lt;=<a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a9db7ad20ea4f76808cd9cf026229bcdc">RUF</a>;i_son++)</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  {</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;   <span class="comment">//vector representing the son</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;   <a class="code" href="classoomph_1_1Vector.html">Vector&lt;int&gt;</a> vect_son(3); </div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;   <span class="comment">//vector representing (at the end) the boundaries</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;   <a class="code" href="classoomph_1_1Vector.html">Vector&lt;int&gt;</a> vect_bound(3);</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;   vect_son=<a class="code" href="classoomph_1_1OcTree.html#adf813fbb9cffe89fb51f3c8ccd3083ca">OcTree::Direction_to_vector</a>[i_son];</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i0=0;i0&lt;n_p;i0++)</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;   {</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i1=0;i1&lt;n_p;i1++)</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    {</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i2=0;i2&lt;n_p;i2++)</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;     {</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;      <span class="comment">// Initialisation to make it work</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;3;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;      {</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;       vect_bound[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]=-vect_son[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>];</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;      }</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;      <span class="comment">// Seting up the boundaries coordinates as if the coordinates </span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;      <span class="comment">// of vect_bound had been initialised to 0 if it were so, </span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;      <span class="comment">// vect_bound would be the vector of the boundaries in the son</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;      <span class="comment">// itself.</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160; </div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;      <span class="keywordflow">if</span> (i0==0) {vect_bound[0]=-1;}</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;      <span class="keywordflow">if</span> (i0==n_p-1) {vect_bound[0]=1;}</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;      <span class="keywordflow">if</span> (i1==0) {vect_bound[1]=-1;}</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;      <span class="keywordflow">if</span> (i1==n_p-1) {vect_bound[1]=1;}</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;      <span class="keywordflow">if</span> (i2==0) {vect_bound[2]=-1;}</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;      <span class="keywordflow">if</span> (i2==n_p-1) {vect_bound[2]=1;}</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;         </div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;      <span class="comment">// The effect of this is to filter the boundaries to keep only the </span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;      <span class="comment">// ones which are effectively father boundaries.</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;      <span class="comment">// -- if the node is not on a &quot;i0 boundary&quot;, we still </span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;      <span class="comment">//    have vect_bound[0]=-vect_son[0]</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;      <span class="comment">//    and the result is vect_bound[0]=0 </span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;      <span class="comment">//    (he is not on this boundary for his father)</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;      <span class="comment">// -- if he is on a son&#39;s boundary  which is not one of </span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;      <span class="comment">//    the father -&gt; same thing</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;      <span class="comment">// -- if he is on a boundary which is one of his father&#39;s, </span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;      <span class="comment">//    vect_bound[i]=vect_son[i]</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;      <span class="comment">//    and the new vect_bound[i] is the same as the old one</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;3;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;      {</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;       vect_bound[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]=(vect_bound[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]+vect_son[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>])/2;</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;      }</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160; </div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;      <span class="comment">// Return the result as {U,R,D,...RDB,LUF,OMEGA}</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;      Father_bound[n_p](i0+n_p*i1+n_p*n_p*i2,i_son)=</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;       <a class="code" href="classoomph_1_1OcTree.html#aec83bade91057d89aa3896274cb96b7e">OcTree::Vector_to_direction</a>[vect_bound];</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;  </div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;     } <span class="comment">// Loop over i2</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    } <span class="comment">// Loop over i1</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;   } <span class="comment">// Loop over i0</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;  } <span class="comment">// Loop over i_son</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160; </div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160; } <span class="comment">// setup_father_bounds()</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160; </div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160; </div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160; </div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="comment">//==================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="comment">/// Determine Vector of boundary conditions along the element&#39;s boundary </span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="comment">/// bound.</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="comment">/// This function assumes that the same boundary condition is applied</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="comment">/// along the entire area of an element&#39;s face (of course, the</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="comment">/// vertices combine the boundary conditions of their two adjacent edges</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="comment">/// in the most restrictive combination. Hence, if we&#39;re at a vertex,</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="comment">/// we apply the most restrictive boundary condition of the</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="comment">/// two adjacent edges. If we&#39;re on an edge (in its proper interior), </span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="comment">/// we apply the least restrictive boundary condition of all nodes </span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="comment">/// along the edge.</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;<span class="comment">/// Usual convention: </span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="comment">///   - bound_cons[ival]=0 if value ival on this boundary is free </span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="comment">///   - bound_cons[ival]=1 if value ival on this boundary is pinned</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="comment"></span><span class="comment">//==================================================================</span></div>
<div class="line"><a name="l00220"></a><span class="lineno"><a class="line" href="classoomph_1_1RefineableQElement_3_013_01_4.html#aac2601ff8f740680675e5e6ba5c35e9d">  220</a></span>&#160; <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1RefineableQElement.html">RefineableQElement&lt;3&gt;::get_bcs</a>(<span class="keywordtype">int</span> bound, </div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;                                     <a class="code" href="classoomph_1_1Vector.html">Vector&lt;int&gt;</a>&amp; bound_cons)<span class="keyword"> const</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="keyword"> </span>{</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;  <span class="keyword">using namespace </span>OcTreeNames;</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160; </div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;  <span class="comment">//Max. number of nodal data values in element</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;  <span class="keywordtype">unsigned</span> nvalue=ncont_interpolated_values();</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;  <span class="comment">//Set up temporary vectors to hold edge boundary conditions</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;  <a class="code" href="classoomph_1_1Vector.html">Vector&lt;int&gt;</a> bound_cons1(nvalue), bound_cons2(nvalue); </div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;  <a class="code" href="classoomph_1_1Vector.html">Vector&lt;int&gt;</a> bound_cons3(nvalue);</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160; </div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;  <a class="code" href="classoomph_1_1Vector.html">Vector&lt;int&gt;</a> vect1(3),vect2(3),vect3(3);</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;  <a class="code" href="classoomph_1_1Vector.html">Vector&lt;int&gt;</a> vect_elem;</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;  <a class="code" href="classoomph_1_1Vector.html">Vector&lt;int&gt;</a> notzero;</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="the__data__structure_8txt.html#af88b2d950fae19ab641bd1690e08445c">n</a>=0;</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160; </div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;  vect_elem=<a class="code" href="classoomph_1_1OcTree.html#adf813fbb9cffe89fb51f3c8ccd3083ca">OcTree::Direction_to_vector</a>[bound];</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160; </div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;  <span class="comment">// Just to see if bound is a face, an edge, or a vertex, n stores </span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;  <span class="comment">// the number of non-zero values in the vector reprensenting the bound</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;  <span class="comment">// and the vector notzero stores the position of these values</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;3;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;  {</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;   <span class="keywordflow">if</span> (vect_elem[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]!=0)</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;   {</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    <a class="code" href="the__data__structure_8txt.html#af88b2d950fae19ab641bd1690e08445c">n</a>++;</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    notzero.push_back(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>);</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;   }</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;  }</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160; </div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;  <span class="keywordflow">switch</span>(<a class="code" href="the__data__structure_8txt.html#af88b2d950fae19ab641bd1690e08445c">n</a>)</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;  {</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;   <span class="comment">// If there is only one non-zero value, bound is a face</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;  <span class="keywordflow">case</span> 1 :</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;   get_face_bcs(bound,bound_cons);</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;   <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160; </div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;   <span class="comment">// If there are two non-zero values, bound is an edge   </span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;  <span class="keywordflow">case</span> 2 :</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160; </div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;3;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;   {</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    vect1[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]=0; vect2[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]=0;</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;   }</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;   <span class="comment">// vect1 and vect2 are the vector of the two faces adjacent to bound</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;   vect1[notzero[0]]=vect_elem[notzero[0]];</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;   vect2[notzero[1]]=vect_elem[notzero[1]];</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;   </div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;   get_face_bcs(<a class="code" href="classoomph_1_1OcTree.html#aec83bade91057d89aa3896274cb96b7e">OcTree::Vector_to_direction</a>[vect1],bound_cons1);</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;   get_face_bcs(<a class="code" href="classoomph_1_1OcTree.html#aec83bade91057d89aa3896274cb96b7e">OcTree::Vector_to_direction</a>[vect2],bound_cons2);</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;   <span class="comment">// get the most restrictive bc</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> k=0;k&lt;nvalue;k++)</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;   {</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    bound_cons[k]=(bound_cons1[k]||bound_cons2[k]);</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;   }</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;   <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160; </div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;   <span class="comment">// If there are three non-zero value, bound is a vertex</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;  <span class="keywordflow">case</span> 3 :</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160; </div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;3;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;   {</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    vect1[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]=0; vect2[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]=0; vect3[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]=0;</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;   }</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;   <span class="comment">// vectors to the three adjacent faces of the vertex</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;   vect1[0]=vect_elem[0];</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;   vect2[1]=vect_elem[1];</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;   vect3[2]=vect_elem[2];</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;   </div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;   get_face_bcs(<a class="code" href="classoomph_1_1OcTree.html#aec83bade91057d89aa3896274cb96b7e">OcTree::Vector_to_direction</a>[vect1],bound_cons1);</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;   get_face_bcs(<a class="code" href="classoomph_1_1OcTree.html#aec83bade91057d89aa3896274cb96b7e">OcTree::Vector_to_direction</a>[vect2],bound_cons2);</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;   get_face_bcs(<a class="code" href="classoomph_1_1OcTree.html#aec83bade91057d89aa3896274cb96b7e">OcTree::Vector_to_direction</a>[vect3],bound_cons3);</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;   </div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160; </div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;   <span class="comment">// set the bcs to the most restrictive ones </span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> k=0;k&lt;nvalue;k++)</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;   {</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    bound_cons[k]=(bound_cons1[k]||bound_cons2[k]||</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;                   bound_cons3[k]);</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;   }</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;   <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;   </div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;  default :</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;   <span class="keywordflow">throw</span> <a class="code" href="classoomph_1_1OomphLibError.html">OomphLibError</a>(<span class="stringliteral">&quot;Make sure you are not giving OMEGA as bound&quot;</span>,</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;                       OOMPH_CURRENT_FUNCTION,</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;                       OOMPH_EXCEPTION_LOCATION);</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;  }</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160; }</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160; </div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;<span class="comment">//==================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;<span class="comment">/// Determine Vector of boundary conditions along the element&#39;s </span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;<span class="comment">/// face (R/L/U/D/B/F) -- BC is the least restrictive combination </span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<span class="comment">/// of all the nodes on this face</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="comment">/// Usual convention: </span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<span class="comment">///   - bound_cons[ival]=0 if value ival on this boundary is free </span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="comment">///   - bound_cons[ival]=1 if value ival on this boundary is pinned</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="comment"></span><span class="comment">//==================================================================</span></div>
<div class="line"><a name="l00318"></a><span class="lineno"><a class="line" href="classoomph_1_1RefineableQElement_3_013_01_4.html#ab7548543df38dcc3a011d51c6ed357ac">  318</a></span>&#160; <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1RefineableQElement.html">RefineableQElement&lt;3&gt;::get_face_bcs</a>(<span class="keyword">const</span> <span class="keywordtype">int</span>&amp; face, </div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;                                          <a class="code" href="classoomph_1_1Vector.html">Vector&lt;int&gt;</a>&amp; bound_cons)<span class="keyword"> const</span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;<span class="keyword"> </span>{</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;  <span class="keyword">using namespace </span>OcTreeNames;</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160; </div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;  <span class="comment">//Number of nodes along 1D edge</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;  <span class="keywordtype">unsigned</span> n_p = nnode_1d();</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;  <span class="comment">//the four corner nodes on the boundary</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;  <span class="keywordtype">unsigned</span> node1, node2, node3, node4;</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160; </div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;  <span class="comment">//Set the four corner nodes for the face </span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;  <span class="keywordflow">switch</span>(face)</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;  {</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a9d5dc3f8f9d04ae80237132101f4258f">U</a>:</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;   node1 = n_p*n_p*n_p-1; </div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;   node2 = n_p*n_p - 1;</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;   node3 = n_p*(n_p-1); </div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;   node4 = n_p*(n_p*n_p - 1);</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;   <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160; </div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a51292b8e4d96f2bb9f0d6bb0340d1620">D</a>:</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;   node1 = 0;</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;   node2 = n_p-1;</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;   node3 = (n_p*n_p+1)*(n_p-1); </div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;   node4 = n_p*n_p*(n_p-1);</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;   <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160; </div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespaceoomph_1_1BinaryTreeNames.html#a7ff5e7e46beae31bf81579531b1f9895a1bf47d3f36e6272d94344ae84aca2498">R</a>:</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;   node1 = n_p-1;</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;   node2 = (n_p*n_p+1)*(n_p-1);</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;   node3 = n_p*n_p*n_p-1; </div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;   node4 = n_p*n_p - 1;</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;   <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160; </div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespaceoomph_1_1BinaryTreeNames.html#a7ff5e7e46beae31bf81579531b1f9895a8df863dabb4096fa066f7a6dbf7502d1">L</a>:</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;   node1 = 0;</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;   node2 = n_p*(n_p - 1);</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;   node3 = n_p*(n_p*n_p-1); </div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;   node4 = n_p*n_p*(n_p-1);</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;   <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160; </div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a43c804e2bcf9862a4bf629d5f01761e8">B</a> :</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;   node1 = 0;</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;   node2 = n_p-1;</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;   node3 = n_p*n_p-1; </div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;   node4 = n_p*(n_p -1);</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;   <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;   </div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a755807a4724a0f4d96f0817559c0a927">F</a> :</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;   node1 = n_p*n_p*n_p-1;</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;   node2 = n_p*(n_p*n_p-1);</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;   node3 = n_p*n_p*(n_p-1); </div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;   node4 = (n_p-1)*(n_p*n_p+1);</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;   <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160; </div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;  <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;   std::ostringstream error_stream;</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;   error_stream &lt;&lt; <span class="stringliteral">&quot;Wrong edge &quot;</span> &lt;&lt; face &lt;&lt; <span class="stringliteral">&quot; passed\n&quot;</span>;</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160; </div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;   <span class="keywordflow">throw</span> <a class="code" href="classoomph_1_1OomphLibError.html">OomphLibError</a>(error_stream.str(),</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;                       OOMPH_CURRENT_FUNCTION,</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;                       OOMPH_EXCEPTION_LOCATION);</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;  }</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160; </div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;  <span class="comment">// Max. number of nodal data values in element</span></div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;  <span class="keywordtype">unsigned</span> maxnvalue=ncont_interpolated_values();</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160; </div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;  <span class="comment">//Loop over all values, the least restrictive value is </span></div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;  <span class="comment">//the multiplication of the boundary conditions at the 4 nodes</span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;  <span class="comment">//Assuming that free is always zero and pinned is one</span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> k=0;k&lt;maxnvalue;k++)</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;  {</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;   bound_cons[k] = </div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    node_pt(node1)-&gt;is_pinned(k)*node_pt(node2)-&gt;is_pinned(k)*</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    node_pt(node3)-&gt;is_pinned(k)*node_pt(node4)-&gt;is_pinned(k);</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;  }</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160; }</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160; </div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160; </div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;<span class="comment">//==================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;<span class="comment">/// Given an element edge/vertex, return a Vector which contains</span></div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;<span class="comment">/// all the (mesh-)boundary numbers that this element edge/vertex </span></div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;<span class="comment">/// lives on.</span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;<span class="comment">/// For proper edges, the boundary is the one (if any) that is shared by</span></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;<span class="comment">/// both vertex nodes). For vertex nodes, we just return their</span></div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;<span class="comment">/// boundaries.</span></div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;<span class="comment"></span><span class="comment">//==================================================================</span></div>
<div class="line"><a name="l00406"></a><span class="lineno"><a class="line" href="classoomph_1_1RefineableQElement_3_013_01_4.html#ac61083ce6abe6338ec5d7795d9f1e051">  406</a></span>&#160; <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1RefineableQElement.html">RefineableQElement&lt;3&gt;::get_boundaries</a>(<span class="keyword">const</span> <span class="keywordtype">int</span>&amp; <a class="code" href="the__data__structure_8txt.html#a23b5a245f0462b0a4823b0eb07a65baf">element</a>, </div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;                                            std::set&lt;unsigned&gt;&amp; boundary)<span class="keyword"> const</span></div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;<span class="keyword"> </span>{</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;  <span class="keyword">using namespace </span>OcTreeNames;</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160; </div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;  <span class="comment">//Number of 1d nodes along an edge</span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;  <span class="keywordtype">unsigned</span> n_p = nnode_1d();</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;  <span class="comment">//Left and right-hand nodes</span></div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="the__data__structure_8txt.html#ae56499a02d89f315ab025070e7a0058f">node</a>[4];</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>=0,b=0;</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="the__data__structure_8txt.html#af88b2d950fae19ab641bd1690e08445c">n</a>=0;</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;  <a class="code" href="classoomph_1_1Vector.html">Vector&lt;int&gt;</a> vect_face(3);</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;  vect_face=<a class="code" href="classoomph_1_1OcTree.html#adf813fbb9cffe89fb51f3c8ccd3083ca">OcTree::Direction_to_vector</a>[<a class="code" href="the__data__structure_8txt.html#a23b5a245f0462b0a4823b0eb07a65baf">element</a>];</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;  <span class="comment">//Set the left (lower) and right (upper) nodes for the edge </span></div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160; </div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;  <span class="comment">// this is to know what is the type of element (face, edge, vertex)</span></div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;  <span class="comment">// we just need to count the number of values equal to 0 in the </span></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;  <span class="comment">// vector representing this element</span></div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160; </div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;  <span class="comment">//Local storage for the node-numbers in given directions</span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;  <span class="comment">//Initialise to zero (assume at LH end of each domain)</span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;  <span class="keywordtype">int</span> one_d_node_number[3]={0,0,0};</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;  <span class="comment">// n stores the number of values equal to 0, a is the position of the </span></div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;  <span class="comment">// last 0-value ;b is the position of the last non0-value</span></div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;3;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;  {</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;   <span class="keywordflow">if</span> (vect_face[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]==0) </div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;   {</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    <a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>=<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>;</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    <a class="code" href="the__data__structure_8txt.html#af88b2d950fae19ab641bd1690e08445c">n</a>++;</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;   }</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;   <span class="keywordflow">else</span></div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;   {</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    b=<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>;</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    <span class="comment">//If we are at the extreme (RH) end of the face, </span></div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    <span class="comment">//set the node number accordingly</span></div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;    <span class="keywordflow">if</span> (vect_face[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]==1) {one_d_node_number[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] = n_p-1;}</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;   }</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;  }</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160; </div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;  <span class="keywordflow">switch</span>(<a class="code" href="the__data__structure_8txt.html#af88b2d950fae19ab641bd1690e08445c">n</a>)</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;  {</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;   <span class="comment">// if n=0 element is a vertex, and need to look at only one node</span></div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;  <span class="keywordflow">case</span> 0:</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;   <a class="code" href="the__data__structure_8txt.html#ae56499a02d89f315ab025070e7a0058f">node</a>[0] = one_d_node_number[0] + n_p*one_d_node_number[1] + </div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    n_p*n_p*one_d_node_number[2];</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;   <a class="code" href="the__data__structure_8txt.html#ae56499a02d89f315ab025070e7a0058f">node</a>[1]=<a class="code" href="the__data__structure_8txt.html#ae56499a02d89f315ab025070e7a0058f">node</a>[0];</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;   <a class="code" href="the__data__structure_8txt.html#ae56499a02d89f315ab025070e7a0058f">node</a>[2]=<a class="code" href="the__data__structure_8txt.html#ae56499a02d89f315ab025070e7a0058f">node</a>[0];</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;   <a class="code" href="the__data__structure_8txt.html#ae56499a02d89f315ab025070e7a0058f">node</a>[3]=<a class="code" href="the__data__structure_8txt.html#ae56499a02d89f315ab025070e7a0058f">node</a>[0];</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;   <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160; </div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;   <span class="comment">//if n=1 element is an edge, and we need to look at two nodes</span></div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;  <span class="keywordflow">case</span> 1:</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>==0)</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;   {</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;    <a class="code" href="the__data__structure_8txt.html#ae56499a02d89f315ab025070e7a0058f">node</a>[0] = (n_p-1) + n_p*one_d_node_number[1] +</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;     n_p*n_p*one_d_node_number[2];</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    <a class="code" href="the__data__structure_8txt.html#ae56499a02d89f315ab025070e7a0058f">node</a>[1] = n_p*one_d_node_number[1] + n_p*n_p*one_d_node_number[2];</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;   }</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;   <span class="keywordflow">else</span></div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>==1)</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    {</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;     <a class="code" href="the__data__structure_8txt.html#ae56499a02d89f315ab025070e7a0058f">node</a>[0] = n_p*(n_p-1) + one_d_node_number[0] +</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;      n_p*n_p*one_d_node_number[2];</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;     <a class="code" href="the__data__structure_8txt.html#ae56499a02d89f315ab025070e7a0058f">node</a>[1] = one_d_node_number[0] + n_p*n_p*one_d_node_number[2];</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;    }</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;     <span class="keywordflow">if</span> (<a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>==2)</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;     {</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;      <a class="code" href="the__data__structure_8txt.html#ae56499a02d89f315ab025070e7a0058f">node</a>[0] = one_d_node_number[0] + n_p*one_d_node_number[1]</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;       + n_p*n_p*(n_p-1);</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;      <a class="code" href="the__data__structure_8txt.html#ae56499a02d89f315ab025070e7a0058f">node</a>[1] = one_d_node_number[0] + n_p*one_d_node_number[1];</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;     }</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;   <a class="code" href="the__data__structure_8txt.html#ae56499a02d89f315ab025070e7a0058f">node</a>[2]=<a class="code" href="the__data__structure_8txt.html#ae56499a02d89f315ab025070e7a0058f">node</a>[1];</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;   <a class="code" href="the__data__structure_8txt.html#ae56499a02d89f315ab025070e7a0058f">node</a>[3]=<a class="code" href="the__data__structure_8txt.html#ae56499a02d89f315ab025070e7a0058f">node</a>[1];</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;   <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160; </div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;   <span class="comment">//if n=2 element is a face, and we need to look at its 4 nodes </span></div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;  <span class="keywordflow">case</span> 2:</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;   <span class="keywordflow">if</span> (b==0)</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;   {</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    <a class="code" href="the__data__structure_8txt.html#ae56499a02d89f315ab025070e7a0058f">node</a>[0] = one_d_node_number[0] + n_p*n_p*(n_p-1) + n_p*(n_p-1);</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    <a class="code" href="the__data__structure_8txt.html#ae56499a02d89f315ab025070e7a0058f">node</a>[1] = one_d_node_number[0] + n_p*(n_p-1);</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    <a class="code" href="the__data__structure_8txt.html#ae56499a02d89f315ab025070e7a0058f">node</a>[2] = one_d_node_number[0] + n_p*n_p*(n_p-1);</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    <a class="code" href="the__data__structure_8txt.html#ae56499a02d89f315ab025070e7a0058f">node</a>[3] = one_d_node_number[0];</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;   }</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;   <span class="keywordflow">else</span></div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    <span class="keywordflow">if</span> (b==1)</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    {</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;     <a class="code" href="the__data__structure_8txt.html#ae56499a02d89f315ab025070e7a0058f">node</a>[0]=n_p*one_d_node_number[1] + n_p*n_p*(n_p-1)+(n_p-1);</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;     <a class="code" href="the__data__structure_8txt.html#ae56499a02d89f315ab025070e7a0058f">node</a>[1]=n_p*one_d_node_number[1] + (n_p-1);</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;     <a class="code" href="the__data__structure_8txt.html#ae56499a02d89f315ab025070e7a0058f">node</a>[2]=n_p*one_d_node_number[1] + n_p*n_p*(n_p-1);</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;     <a class="code" href="the__data__structure_8txt.html#ae56499a02d89f315ab025070e7a0058f">node</a>[3]=n_p*one_d_node_number[1];</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160; </div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    }</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;     <span class="keywordflow">if</span> (b==2)</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;     {</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;      <a class="code" href="the__data__structure_8txt.html#ae56499a02d89f315ab025070e7a0058f">node</a>[0]=n_p*n_p*one_d_node_number[2] + n_p*(n_p-1)+(n_p-1);</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;      <a class="code" href="the__data__structure_8txt.html#ae56499a02d89f315ab025070e7a0058f">node</a>[1]=n_p*n_p*one_d_node_number[2] + (n_p-1);</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;      <a class="code" href="the__data__structure_8txt.html#ae56499a02d89f315ab025070e7a0058f">node</a>[2]=n_p*n_p*one_d_node_number[2] + n_p*(n_p-1);</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;      <a class="code" href="the__data__structure_8txt.html#ae56499a02d89f315ab025070e7a0058f">node</a>[3]=n_p*n_p*one_d_node_number[2];</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160; </div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;     }</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;   <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;  default :</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;   <span class="keywordflow">throw</span> <a class="code" href="classoomph_1_1OomphLibError.html">OomphLibError</a>(<span class="stringliteral">&quot;Make sure you are not giving OMEGA as boundary&quot;</span>,</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;                       OOMPH_CURRENT_FUNCTION,</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;                       OOMPH_EXCEPTION_LOCATION);</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;  }</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160; </div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160; </div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;  <span class="comment">//Empty boundary set: Edge does not live on any boundary</span></div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;  boundary.clear();</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160; </div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;  <span class="comment">//Storage for the boundaries at the four nodes</span></div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;  <a class="code" href="classoomph_1_1Vector.html">Vector&lt;std::set&lt;unsigned&gt;</a>*&gt; node_boundaries_pt(4,0);</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160; </div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;  <span class="comment">//Loop over the four nodes and get the boundary information</span></div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;4;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;  {</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;   node_pt(<a class="code" href="the__data__structure_8txt.html#ae56499a02d89f315ab025070e7a0058f">node</a>[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>])-&gt;get_boundaries_pt(node_boundaries_pt[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]);</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;  }</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160; </div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160; </div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;  <span class="comment">//Now work out the intersections</span></div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;  <a class="code" href="classoomph_1_1Vector.html">Vector&lt;std::set&lt;unsigned&gt;</a> &gt; boundary_aux(2);</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160; </div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;2;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;  {</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;   <span class="comment">//If the two nodes both lie on boundaries</span></div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;   <span class="keywordflow">if</span> ((node_boundaries_pt[2*<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]!=0) &amp;&amp; (node_boundaries_pt[2*<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>+1]!=0))</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;   {</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;    <span class="comment">//Find the intersection (the common boundaries) of these nodes</span></div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;    std::set_intersection(node_boundaries_pt[2*<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]-&gt;begin(),</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;                          node_boundaries_pt[2*<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]-&gt;end(),</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;                          node_boundaries_pt[2*<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>+1]-&gt;begin(),</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;                          node_boundaries_pt[2*<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>+1]-&gt;end(),</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;                          inserter(boundary_aux[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>],</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;                                   boundary_aux[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>].begin()));</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;   }</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;  }</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160; </div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;  <span class="comment">//Now calculate the total intersection</span></div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;  set_intersection(boundary_aux[0].begin(),boundary_aux[0].end(),</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;                   boundary_aux[1].begin(),boundary_aux[1].end(),</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;                   inserter(boundary,boundary.begin()));</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160; }</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160; </div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160; </div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;<span class="comment">//===================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;<span class="comment">/// Return the value of the intrinsic boundary coordinate interpolated</span></div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;<span class="comment">/// along the face</span></div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;<span class="comment"></span><span class="comment">//===================================================================</span></div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160; <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1RefineableQElement.html">RefineableQElement&lt;3&gt;::</a></div>
<div class="line"><a name="l00561"></a><span class="lineno"><a class="line" href="classoomph_1_1RefineableQElement_3_013_01_4.html#aa0feadb4fbbe8861366a77373b122293">  561</a></span>&#160;<a class="code" href="classoomph_1_1RefineableQElement.html"> interpolated_zeta_on_face</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;boundary,</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;                           <span class="keyword">const</span> <span class="keywordtype">int</span> &amp;face, <span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;                           <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;zeta)</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160; {</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;  <span class="keyword">using namespace </span>OcTreeNames;</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160; </div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;  <span class="comment">//Number of nodes along an edge</span></div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;  <span class="keywordtype">unsigned</span> nnodes_1d = nnode_1d();</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160; </div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;  <span class="comment">//Number of nodes on a face</span></div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;  <span class="keywordtype">unsigned</span> nnodes_2d = nnodes_1d*nnodes_1d;</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160; </div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;  <span class="comment">//Total number of nodes</span></div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;  <span class="keywordtype">unsigned</span> nnodes_3d = nnode();</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160; </div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;  <span class="comment">//Storage for the shape functions</span></div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;  <a class="code" href="classoomph_1_1Shape.html">Shape</a> psi(nnodes_3d);</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160; </div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;  <span class="comment">//Get the shape functions at the passed position</span></div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;  this-&gt;<a class="code" href="namespaceoomph_1_1OneDimLagrange.html#a117f8b892dc89989ecdad99ff261e120">shape</a>(s,psi);</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160; </div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;  <span class="comment">//Unsigned data that give starts and increments for the loop</span></div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;  <span class="comment">//over the nodes on the faces.</span></div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;  <span class="keywordtype">unsigned</span> <a class="code" href="namespaceoomph_1_1CumulativeTimings.html#aeafe5cb81741d54561e4b62572a1e3df">start</a>=0, increment1=1, increment2=1;</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160; </div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;  <span class="comment">//Flag to record if actually on a face or an edge</span></div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;  <span class="keywordtype">bool</span> on_edge = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160; </div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;  <span class="comment">//Which face?</span></div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;  <span class="keywordflow">switch</span>(face)</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;  {</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespaceoomph_1_1BinaryTreeNames.html#a7ff5e7e46beae31bf81579531b1f9895a8df863dabb4096fa066f7a6dbf7502d1">L</a>:</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0] != -1.0)</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;   {</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;    std::ostringstream error_stream;</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;    error_stream&lt;&lt; <span class="stringliteral">&quot;Coordinate &quot;</span> &lt;&lt; <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[2]</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;                &lt;&lt; <span class="stringliteral">&quot; is not on Left face\n&quot;</span>;</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;     </div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="classoomph_1_1OomphLibError.html">OomphLibError</a>(error_stream.str(),</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;                        OOMPH_CURRENT_FUNCTION,</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;                        OOMPH_EXCEPTION_LOCATION);</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;   }</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;   <span class="comment">//Start is zero (bottom-left-back corner)</span></div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;   increment1 = nnodes_1d;</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;   increment2 = 0;</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;   on_edge = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;   <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160; </div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespaceoomph_1_1BinaryTreeNames.html#a7ff5e7e46beae31bf81579531b1f9895a1bf47d3f36e6272d94344ae84aca2498">R</a>:</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0] != 1.0)</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;   {</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;    std::ostringstream error_stream;</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;    error_stream&lt;&lt; <span class="stringliteral">&quot;Coordinate &quot;</span> &lt;&lt; <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[2]</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;                &lt;&lt; <span class="stringliteral">&quot; is not on Right face\n&quot;</span>;</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;     </div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="classoomph_1_1OomphLibError.html">OomphLibError</a>(error_stream.str(),</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;                        OOMPH_CURRENT_FUNCTION,</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;                        OOMPH_EXCEPTION_LOCATION);</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;   }</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;   <span class="comment">//Start is bottom-right-back corner</span></div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;   <a class="code" href="namespaceoomph_1_1CumulativeTimings.html#aeafe5cb81741d54561e4b62572a1e3df">start</a> = nnodes_1d-1;</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;   increment1 = nnodes_1d;</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;   increment2 = 0;</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;   on_edge = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;   <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160; </div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a51292b8e4d96f2bb9f0d6bb0340d1620">D</a>:</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1] != -1.0)</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;   {</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;    std::ostringstream error_stream;</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;    error_stream&lt;&lt; <span class="stringliteral">&quot;Coordinate &quot;</span> &lt;&lt; <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[2]</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;                &lt;&lt; <span class="stringliteral">&quot; is not on Bottom face\n&quot;</span>;</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;     </div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="classoomph_1_1OomphLibError.html">OomphLibError</a>(error_stream.str(),</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;                        OOMPH_CURRENT_FUNCTION,</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;                        OOMPH_EXCEPTION_LOCATION);</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;   }</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;   <span class="comment">//Start is zero and increments2 is nnode_2d-nnode_1d</span></div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;   increment2 = nnodes_2d-nnodes_1d;</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;   on_edge = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;   <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160; </div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a9d5dc3f8f9d04ae80237132101f4258f">U</a>:</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1] != 1.0)</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;   {</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;    std::ostringstream error_stream;</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;    error_stream&lt;&lt; <span class="stringliteral">&quot;Coordinate &quot;</span> &lt;&lt; <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[2]</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;                &lt;&lt; <span class="stringliteral">&quot; is not on Upper face\n&quot;</span>;</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;     </div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="classoomph_1_1OomphLibError.html">OomphLibError</a>(error_stream.str(),</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;                        OOMPH_CURRENT_FUNCTION,</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;                        OOMPH_EXCEPTION_LOCATION);</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;   }</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;   <span class="comment">//Start is top-left-back corner and increments2 is nnode_2d-nnode_1d</span></div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;   <a class="code" href="namespaceoomph_1_1CumulativeTimings.html#aeafe5cb81741d54561e4b62572a1e3df">start</a> = nnodes_2d-nnodes_1d;</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;   increment2 = <a class="code" href="namespaceoomph_1_1CumulativeTimings.html#aeafe5cb81741d54561e4b62572a1e3df">start</a>;</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;   on_edge = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;   <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160; </div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a43c804e2bcf9862a4bf629d5f01761e8">B</a>:</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[2] != -1.0)</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;   {</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;    std::ostringstream error_stream;</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;    error_stream&lt;&lt; <span class="stringliteral">&quot;Coordinate &quot;</span> &lt;&lt; <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[2]</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;                &lt;&lt; <span class="stringliteral">&quot; is not on Back face\n&quot;</span>;</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;     </div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="classoomph_1_1OomphLibError.html">OomphLibError</a>(error_stream.str(),</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;                        OOMPH_CURRENT_FUNCTION,</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;                        OOMPH_EXCEPTION_LOCATION);</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;   }</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;   <span class="comment">//Start is zero and increments are 1 and 0</span></div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;   increment2=0;</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;   on_edge = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;   <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160; </div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a755807a4724a0f4d96f0817559c0a927">F</a>:</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[2] != 1.0)</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;   {</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;    std::ostringstream error_stream;</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;    error_stream&lt;&lt; <span class="stringliteral">&quot;Coordinate &quot;</span> &lt;&lt; <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[2]</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;                &lt;&lt; <span class="stringliteral">&quot; is not on Front face\n&quot;</span>;</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;     </div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="classoomph_1_1OomphLibError.html">OomphLibError</a>(error_stream.str(),</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;                        OOMPH_CURRENT_FUNCTION,</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;                        OOMPH_EXCEPTION_LOCATION);</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;   }</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;   <span class="comment">//Start is bottom-left-front corner</span></div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;   <a class="code" href="namespaceoomph_1_1CumulativeTimings.html#aeafe5cb81741d54561e4b62572a1e3df">start</a> = nnodes_3d-nnodes_2d;</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;   increment2=0;</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;   on_edge = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;   <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160; </div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a854222a7a6f7470d6803ffb8d11180bc">LF</a>:</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;   <span class="keywordflow">if</span> ( (<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0] != -1.0) || (<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[2] != 1.0) )</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;   {</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;    std::ostringstream error_stream;</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;    error_stream&lt;&lt; <span class="stringliteral">&quot;Coordinate &quot;</span> &lt;&lt; <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[2]</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;                &lt;&lt; <span class="stringliteral">&quot; is not on Front-Left edge\n&quot;</span>;</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;     </div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="classoomph_1_1OomphLibError.html">OomphLibError</a>(error_stream.str(),</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;                        OOMPH_CURRENT_FUNCTION,</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;                        OOMPH_EXCEPTION_LOCATION);</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;   }</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;   <a class="code" href="namespaceoomph_1_1CumulativeTimings.html#aeafe5cb81741d54561e4b62572a1e3df">start</a> = nnodes_3d-nnodes_2d;</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;   increment1=nnodes_1d;</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;   <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160; </div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a91fa3c9ccf834f81f50238be7bcc5269">LD</a>:</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;   <span class="keywordflow">if</span> ( (<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0] != -1.0) || (<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1] != -1.0) )</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;   {</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;    std::ostringstream error_stream;</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;    error_stream&lt;&lt; <span class="stringliteral">&quot;Coordinate &quot;</span> &lt;&lt; <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[2]</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;                &lt;&lt; <span class="stringliteral">&quot; is not on Bottom-Left edge\n&quot;</span>;</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;     </div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="classoomph_1_1OomphLibError.html">OomphLibError</a>(error_stream.str(),</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;                        OOMPH_CURRENT_FUNCTION,</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;                        OOMPH_EXCEPTION_LOCATION);</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;   }</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;   increment1=nnodes_2d;</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;   <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160; </div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40ae7245a89994ff850f2a88ea7bff7e7f8">LU</a>:</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;   <span class="keywordflow">if</span> ( (<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0] != -1.0) || (<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1] != 1.0) )</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;   {</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;    std::ostringstream error_stream;</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;    error_stream&lt;&lt; <span class="stringliteral">&quot;Coordinate &quot;</span> &lt;&lt; <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[2]</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;                &lt;&lt; <span class="stringliteral">&quot; is not on Upper-Left edge\n&quot;</span>;</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;     </div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="classoomph_1_1OomphLibError.html">OomphLibError</a>(error_stream.str(),</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;                        OOMPH_CURRENT_FUNCTION,</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;                        OOMPH_EXCEPTION_LOCATION);</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;   }</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;   <a class="code" href="namespaceoomph_1_1CumulativeTimings.html#aeafe5cb81741d54561e4b62572a1e3df">start</a> = nnodes_2d-nnodes_1d;</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;   increment1=nnodes_2d;</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;   <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160; </div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40aff75a49d684424436ad419a818d0f480">LB</a>:</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;   <span class="keywordflow">if</span> ( (<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0] != -1.0) || (<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[2] != -1.0) )</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;   {</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;    std::ostringstream error_stream;</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;    error_stream&lt;&lt; <span class="stringliteral">&quot;Coordinate &quot;</span> &lt;&lt; <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[2]</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;                &lt;&lt; <span class="stringliteral">&quot; is not on Back-Left edge\n&quot;</span>;</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;     </div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="classoomph_1_1OomphLibError.html">OomphLibError</a>(error_stream.str(),</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;                        OOMPH_CURRENT_FUNCTION,</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;                        OOMPH_EXCEPTION_LOCATION);</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;   }</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;   increment1=nnodes_1d;</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;   <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160; </div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40aa2aad9af9821c9f410b188efa95908d1">RF</a>:</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;   <span class="keywordflow">if</span> ( (<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0] != 1.0) || (<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[2] != 1.0) )</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;   {</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;    std::ostringstream error_stream;</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;    error_stream&lt;&lt; <span class="stringliteral">&quot;Coordinate &quot;</span> &lt;&lt; <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[2]</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;                &lt;&lt; <span class="stringliteral">&quot; is not on Front-Right edge\n&quot;</span>;</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;     </div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="classoomph_1_1OomphLibError.html">OomphLibError</a>(error_stream.str(),</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;                        OOMPH_CURRENT_FUNCTION,</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;                        OOMPH_EXCEPTION_LOCATION);</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;   }</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;   <a class="code" href="namespaceoomph_1_1CumulativeTimings.html#aeafe5cb81741d54561e4b62572a1e3df">start</a> = nnodes_3d-1;</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;   increment1=-nnodes_1d;</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;   <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160; </div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a37246039cac1119e55029efcae57ef85">RD</a>:</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;   <span class="keywordflow">if</span> ( (<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0] != 1.0) || (<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1] != -1.0) )</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;   {</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;    std::ostringstream error_stream;</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;    error_stream&lt;&lt; <span class="stringliteral">&quot;Coordinate &quot;</span> &lt;&lt; <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[2]</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;                &lt;&lt; <span class="stringliteral">&quot; is not on Bottom-Right edge\n&quot;</span>;</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;     </div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="classoomph_1_1OomphLibError.html">OomphLibError</a>(error_stream.str(),</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;                        OOMPH_CURRENT_FUNCTION,</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;                        OOMPH_EXCEPTION_LOCATION);</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;   }</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;   <a class="code" href="namespaceoomph_1_1CumulativeTimings.html#aeafe5cb81741d54561e4b62572a1e3df">start</a> = nnodes_1d-1;</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;   increment1=nnodes_2d;</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;   <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160; </div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a72d8c5c6b2d5fa77e57930951a567546">RU</a>:</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;   <span class="keywordflow">if</span> ( (<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0] != 1.0) || (<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1] != 1.0) )</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;   {</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;    std::ostringstream error_stream;</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;    error_stream&lt;&lt; <span class="stringliteral">&quot;Coordinate &quot;</span> &lt;&lt; <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[2]</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;                &lt;&lt; <span class="stringliteral">&quot; is not on Upper-Right edge\n&quot;</span>;</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;     </div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="classoomph_1_1OomphLibError.html">OomphLibError</a>(error_stream.str(),</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;                        OOMPH_CURRENT_FUNCTION,</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;                        OOMPH_EXCEPTION_LOCATION);</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;   }</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;   <a class="code" href="namespaceoomph_1_1CumulativeTimings.html#aeafe5cb81741d54561e4b62572a1e3df">start</a> = nnodes_2d-1;</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;   increment1=nnodes_2d;</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;   <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160; </div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a593ad5f0759943d367efb7f308deabc4">RB</a>:</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;   <span class="keywordflow">if</span> ( (<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0] != 1.0) || (<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[2] != -1.0) )</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;   {</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;    std::ostringstream error_stream;</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;    error_stream&lt;&lt; <span class="stringliteral">&quot;Coordinate &quot;</span> &lt;&lt; <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[2]</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;                &lt;&lt; <span class="stringliteral">&quot; is not on Back-Right edge\n&quot;</span>;</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;     </div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="classoomph_1_1OomphLibError.html">OomphLibError</a>(error_stream.str(),</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;                        OOMPH_CURRENT_FUNCTION,</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;                        OOMPH_EXCEPTION_LOCATION);</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;   }</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;   <a class="code" href="namespaceoomph_1_1CumulativeTimings.html#aeafe5cb81741d54561e4b62572a1e3df">start</a> = nnodes_1d-1;</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;   increment1=nnodes_1d;</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;   <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160; </div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40aeb944d7232b126b9034678f074c3078e">DB</a>:</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;   <span class="keywordflow">if</span> ( (<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1] != -1.0) || (<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[2] != -1.0) )</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;   {</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;    std::ostringstream error_stream;</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;    error_stream&lt;&lt; <span class="stringliteral">&quot;Coordinate &quot;</span> &lt;&lt; <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[2]</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;                &lt;&lt; <span class="stringliteral">&quot; is not on Back-Bottom edge\n&quot;</span>;</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;     </div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="classoomph_1_1OomphLibError.html">OomphLibError</a>(error_stream.str(),</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;                        OOMPH_CURRENT_FUNCTION,</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;                        OOMPH_EXCEPTION_LOCATION);</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;   }</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;   <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160; </div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a1dd915e02b2435707c33bc9f24b0d5c8">DF</a>:</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;   <span class="keywordflow">if</span> ( (<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1] != -1.0) || (<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[2] != 1.0) )</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;   {</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;    std::ostringstream error_stream;</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;    error_stream&lt;&lt; <span class="stringliteral">&quot;Coordinate &quot;</span> &lt;&lt; <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[2]</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;                &lt;&lt; <span class="stringliteral">&quot; is not on Front-Bottom edge\n&quot;</span>;</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;     </div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="classoomph_1_1OomphLibError.html">OomphLibError</a>(error_stream.str(),</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;                        OOMPH_CURRENT_FUNCTION,</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;                        OOMPH_EXCEPTION_LOCATION);</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;   }</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;   <a class="code" href="namespaceoomph_1_1CumulativeTimings.html#aeafe5cb81741d54561e4b62572a1e3df">start</a> = nnodes_3d-nnodes_2d;</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;   <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160; </div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40afd5ae3a92102eb1faf7e8e77c6742831">UB</a>:</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;   <span class="keywordflow">if</span> ( (<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1] != 1.0) || (<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[2] != -1.0) )</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;   {</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;    std::ostringstream error_stream;</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;    error_stream&lt;&lt; <span class="stringliteral">&quot;Coordinate &quot;</span> &lt;&lt; <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[2]</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;                &lt;&lt; <span class="stringliteral">&quot; is not on Back-Upper edge\n&quot;</span>;</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;     </div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="classoomph_1_1OomphLibError.html">OomphLibError</a>(error_stream.str(),</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;                        OOMPH_CURRENT_FUNCTION,</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;                        OOMPH_EXCEPTION_LOCATION);</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;   }</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;   <a class="code" href="namespaceoomph_1_1CumulativeTimings.html#aeafe5cb81741d54561e4b62572a1e3df">start</a> = nnodes_2d-nnodes_1d;</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;   <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160; </div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a5f1bfb03fbc606141a391b7a2f9d4ea7">UF</a>:</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;   <span class="keywordflow">if</span> ( (<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1] != 1.0) || (<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[2] != 1.0) )</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;   {</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;    std::ostringstream error_stream;</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;    error_stream&lt;&lt; <span class="stringliteral">&quot;Coordinate &quot;</span> &lt;&lt; <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[2]</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;                &lt;&lt; <span class="stringliteral">&quot; is not on Upper-Front edge\n&quot;</span>;</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;     </div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="classoomph_1_1OomphLibError.html">OomphLibError</a>(error_stream.str(),</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;                        OOMPH_CURRENT_FUNCTION,</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;                        OOMPH_EXCEPTION_LOCATION);</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;   }</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;   <a class="code" href="namespaceoomph_1_1CumulativeTimings.html#aeafe5cb81741d54561e4b62572a1e3df">start</a> = nnodes_3d-nnodes_1d;</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;   <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;   </div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;  <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160; </div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;   std::ostringstream error_stream;</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;   error_stream</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;    &lt;&lt; <span class="stringliteral">&quot;Wrong face &quot;</span> &lt;&lt; <a class="code" href="classoomph_1_1OcTree.html#a2e9487b716f4d583aada06a850b8eae9">OcTree::Direct_string</a>[face] &lt;&lt; <span class="stringliteral">&quot; passed&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;   error_stream &lt;&lt; <span class="stringliteral">&quot;Trouble at : s= [&quot;</span>  </div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;                &lt;&lt; <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[2]</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;                &lt;&lt; <span class="stringliteral">&quot;]\n&quot;</span>;</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;   <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> x(3);</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;   this-&gt;interpolated_x(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,x);</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;   error_stream &lt;&lt; <span class="stringliteral">&quot;corresponding to : x= [&quot;</span>  </div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;                &lt;&lt; x[0] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; x[1] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; x[2]</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;                &lt;&lt; <span class="stringliteral">&quot;]\n&quot;</span>;</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;   <span class="keywordflow">throw</span> <a class="code" href="classoomph_1_1OomphLibError.html">OomphLibError</a>(error_stream.str(),</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;                       OOMPH_CURRENT_FUNCTION,</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;                       OOMPH_EXCEPTION_LOCATION);</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;  }</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160; </div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;  <span class="comment">//Initialise the intrinsic coordinate</span></div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;  zeta[0] = 0.0;</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;  zeta[1] = 0.0;</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160; </div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;  <span class="comment">//Set the start node number</span></div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;  <span class="keywordtype">unsigned</span> <a class="code" href="the__data__structure_8txt.html#ae56499a02d89f315ab025070e7a0058f">node</a>=<a class="code" href="namespaceoomph_1_1CumulativeTimings.html#aeafe5cb81741d54561e4b62572a1e3df">start</a>;</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160; </div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;  <span class="keywordflow">if</span> (on_edge)</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;  {</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> l1=0;l1&lt;nnodes_1d;l1++)</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;   {</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;    <span class="comment">//Get the intrinsic coordinate</span></div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;    <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> node_zeta(2);</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;    node_pt(<a class="code" href="the__data__structure_8txt.html#ae56499a02d89f315ab025070e7a0058f">node</a>)-&gt;get_coordinates_on_boundary(boundary,node_zeta);</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160; </div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;    <span class="comment">//Now multiply by the shape function</span></div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;    zeta[0] += node_zeta[0]*psi(<a class="code" href="the__data__structure_8txt.html#ae56499a02d89f315ab025070e7a0058f">node</a>);</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;    zeta[1] += node_zeta[1]*psi(<a class="code" href="the__data__structure_8txt.html#ae56499a02d89f315ab025070e7a0058f">node</a>);</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160; </div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;    <span class="comment">//Update node</span></div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;    <a class="code" href="the__data__structure_8txt.html#ae56499a02d89f315ab025070e7a0058f">node</a> += increment1;</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;   }</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;  }</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;  {</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> l2=0;l2&lt;nnodes_1d;l2++)</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;   {</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> l1=0;l1&lt;nnodes_1d;l1++)</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;    {</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;     <span class="comment">//Get the intrinsic coordinate</span></div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;     <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> node_zeta(2);</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;     node_pt(<a class="code" href="the__data__structure_8txt.html#ae56499a02d89f315ab025070e7a0058f">node</a>)-&gt;get_coordinates_on_boundary(boundary,node_zeta);</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160; </div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;     <span class="comment">//Now multiply by the shape function</span></div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;     zeta[0] += node_zeta[0]*psi(<a class="code" href="the__data__structure_8txt.html#ae56499a02d89f315ab025070e7a0058f">node</a>);</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;     zeta[1] += node_zeta[1]*psi(<a class="code" href="the__data__structure_8txt.html#ae56499a02d89f315ab025070e7a0058f">node</a>);</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160; </div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;     <span class="comment">//Update node</span></div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;     <a class="code" href="the__data__structure_8txt.html#ae56499a02d89f315ab025070e7a0058f">node</a> += increment1;</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;    }</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;    <span class="comment">//Update node</span></div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;    <a class="code" href="the__data__structure_8txt.html#ae56499a02d89f315ab025070e7a0058f">node</a> += increment2;</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;   }</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;  }</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160; }</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160; </div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160; <span class="comment">//===================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;<span class="comment"> /// If a neighbouring element has already created a node at a</span></div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;<span class="comment"> /// position corresponding to the local fractional position within the</span></div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;<span class="comment"> /// present element, s_fraction, return</span></div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;<span class="comment"> /// a pointer to that node. If not, return NULL (0).</span></div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;<span class="comment"></span> <span class="comment">//===================================================================</span></div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160; <a class="code" href="classoomph_1_1Node.html">Node</a>* <a class="code" href="classoomph_1_1RefineableQElement.html">RefineableQElement&lt;3&gt;::</a></div>
<div class="line"><a name="l00973"></a><span class="lineno"><a class="line" href="classoomph_1_1RefineableQElement_3_013_01_4.html#ac5676804b139e7a02c0a06a16a913316">  973</a></span>&#160;<a class="code" href="classoomph_1_1RefineableQElement.html"> node_created_by_neighbour</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;s_fraction,</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;                           <span class="keywordtype">bool</span>&amp; is_periodic) </div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160; {  </div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;  <span class="keyword">using namespace </span>OcTreeNames;</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160; </div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;  <span class="comment">//Calculate the faces/edges on which the node lies</span></div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;  <a class="code" href="classoomph_1_1Vector.html">Vector&lt;int&gt;</a> faces;</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;  <a class="code" href="classoomph_1_1Vector.html">Vector&lt;int&gt;</a> edges;</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160; </div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;  <span class="keywordflow">if</span> (s_fraction[0]==0.0)</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;  {</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;   faces.push_back(<a class="code" href="namespaceoomph_1_1BinaryTreeNames.html#a7ff5e7e46beae31bf81579531b1f9895a8df863dabb4096fa066f7a6dbf7502d1">L</a>);</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;   <span class="keywordflow">if</span> (s_fraction[1]==0.0) {edges.push_back(<a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a91fa3c9ccf834f81f50238be7bcc5269">LD</a>);}</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;   <span class="keywordflow">if</span> (s_fraction[2]==0.0) {edges.push_back(<a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40aff75a49d684424436ad419a818d0f480">LB</a>);}</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;   <span class="keywordflow">if</span> (s_fraction[1]==1.0) {edges.push_back(<a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40ae7245a89994ff850f2a88ea7bff7e7f8">LU</a>);}</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;   <span class="keywordflow">if</span> (s_fraction[2]==1.0) {edges.push_back(<a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a854222a7a6f7470d6803ffb8d11180bc">LF</a>);}</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;  }</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160; </div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;  <span class="keywordflow">if</span> (s_fraction[0]==1.0) </div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;  {</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;   faces.push_back(<a class="code" href="namespaceoomph_1_1BinaryTreeNames.html#a7ff5e7e46beae31bf81579531b1f9895a1bf47d3f36e6272d94344ae84aca2498">R</a>);</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;   <span class="keywordflow">if</span> (s_fraction[1]==0.0) {edges.push_back(<a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a37246039cac1119e55029efcae57ef85">RD</a>);}</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;   <span class="keywordflow">if</span> (s_fraction[2]==0.0) {edges.push_back(<a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a593ad5f0759943d367efb7f308deabc4">RB</a>);}</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;   <span class="keywordflow">if</span> (s_fraction[1]==1.0) {edges.push_back(<a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a72d8c5c6b2d5fa77e57930951a567546">RU</a>);}</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;   <span class="keywordflow">if</span> (s_fraction[2]==1.0) {edges.push_back(<a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40aa2aad9af9821c9f410b188efa95908d1">RF</a>);}</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;  }</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160; </div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;  <span class="keywordflow">if</span> (s_fraction[1]==0.0)</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;  {</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;   faces.push_back(<a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a51292b8e4d96f2bb9f0d6bb0340d1620">D</a>);</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;   <span class="keywordflow">if</span> (s_fraction[2]==0.0) {edges.push_back(<a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40aeb944d7232b126b9034678f074c3078e">DB</a>);}</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;   <span class="keywordflow">if</span> (s_fraction[2]==1.0) {edges.push_back(<a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a1dd915e02b2435707c33bc9f24b0d5c8">DF</a>);}</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;  }</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160; </div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;  <span class="keywordflow">if</span> (s_fraction[1]==1.0) </div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;  {</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;   faces.push_back(<a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a9d5dc3f8f9d04ae80237132101f4258f">U</a>);</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;   <span class="keywordflow">if</span> (s_fraction[2]==0.0) {edges.push_back(<a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40afd5ae3a92102eb1faf7e8e77c6742831">UB</a>);}</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;   <span class="keywordflow">if</span> (s_fraction[2]==1.0) {edges.push_back(<a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a5f1bfb03fbc606141a391b7a2f9d4ea7">UF</a>);}</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;  }</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160; </div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;  <span class="keywordflow">if</span> (s_fraction[2]==0.0)</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;  {</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;   faces.push_back(<a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a43c804e2bcf9862a4bf629d5f01761e8">B</a>);</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;  }</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160; </div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;  <span class="keywordflow">if</span> (s_fraction[2]==1.0)</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;  {</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;   faces.push_back(<a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a755807a4724a0f4d96f0817559c0a927">F</a>);</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;  }</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;  </div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;  <span class="comment">//Find the number of faces</span></div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;  <span class="keywordtype">unsigned</span> n_face = faces.size();</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160; </div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;  <span class="comment">//Find the number of edges</span></div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;  <span class="keywordtype">unsigned</span> n_edge = edges.size();</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160; </div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;  <a class="code" href="classoomph_1_1Vector.html">Vector&lt;unsigned&gt;</a> translate_s(3);</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;  <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> s_lo_neigh(3);</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;  <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> s_hi_neigh(3);</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;  <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>(3);</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160; </div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;  <span class="keywordtype">int</span> neigh_face, diff_level;</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160; </div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;  <span class="comment">// Loop over the faces on which the node lies</span></div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;  <span class="comment">//-------------------------------------------</span></div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j=0;j&lt;n_face;j++)</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;  {</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;   <span class="comment">// Boolean to indicate whether or not the neighbour has a</span></div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;   <span class="comment">// different Tree root</span></div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;   <span class="keywordtype">bool</span> in_neighbouring_tree;</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;  </div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;   <span class="comment">// Find pointer to neighbouring element along face </span></div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;   <a class="code" href="classoomph_1_1OcTree.html">OcTree</a>* neigh_pt;</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;   neigh_pt = octree_pt()-&gt;</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;    gteq_face_neighbour(faces[j],translate_s,s_lo_neigh,s_hi_neigh,</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;                        neigh_face,diff_level,in_neighbouring_tree);</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;   </div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;   <span class="comment">// Neighbour exists</span></div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;   <span class="keywordflow">if</span> (neigh_pt!=0)</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;   {</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;    <span class="comment">// Have its nodes been created yet?</span></div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;    <span class="keywordflow">if</span> (neigh_pt-&gt;<a class="code" href="classoomph_1_1Tree.html#a2f2eeb0f1dd161f696cccc652974ff4c">object_pt</a>()-&gt;<a class="code" href="classoomph_1_1RefineableElement.html#a50758228db823d72ea8da23dbb000901">nodes_built</a>())</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;    {</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;     <span class="comment">//We now need to translate the nodal location, defined in terms</span></div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;     <span class="comment">//of the fractional coordinates of the present element into</span></div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;     <span class="comment">//those of its neighbour. For this we use the information returned</span></div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;     <span class="comment">//to use from the octree function.</span></div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;       </div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;     <span class="comment">//Calculate the local coordinate in the neighbour</span></div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;     <span class="comment">//Note that we need to use the translation scheme in case</span></div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;     <span class="comment">//the local coordinates are swapped in the neighbour.</span></div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;3;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;     {</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;      <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] = s_lo_neigh[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] + s_fraction[translate_s[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]]*</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;       (s_hi_neigh[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] - s_lo_neigh[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]);</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;     }</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;       </div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;     <span class="comment">// Find the node in the neighbour</span></div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;     <a class="code" href="classoomph_1_1Node.html">Node</a>* neighbour_node_pt=</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;      neigh_pt-&gt;<a class="code" href="classoomph_1_1Tree.html#a2f2eeb0f1dd161f696cccc652974ff4c">object_pt</a>()-&gt;<a class="code" href="classoomph_1_1FiniteElement.html#a2ddbb05c5f8bb35b64bec287d653105c">get_node_at_local_coordinate</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>);</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;       </div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;     <span class="comment">//If there is a node, return it</span></div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;     <span class="keywordflow">if</span> (neighbour_node_pt!=0)</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;     {       </div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;      <span class="comment">// Now work out whether it&#39;s a periodic boundary. This is </span></div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;      <span class="comment">// only possible if we have moved into a neighbouring tree</span></div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;      <span class="keywordflow">if</span> (in_neighbouring_tree)</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;      {</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;       <span class="comment">// Return whether the neighbour is periodic </span></div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;       is_periodic=octree_pt()-&gt;root_pt()-&gt;is_neighbour_periodic(faces[j]);       </div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;      }</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;      </div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;      <span class="comment">// Return the neighbour node pointer</span></div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;      <span class="keywordflow">return</span> neighbour_node_pt;</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;     }</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;    } <span class="comment">// if (neigh_pt-&gt;object_pt()-&gt;nodes_built())</span></div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;   } <span class="comment">// if (neigh_pt!=0)</span></div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;  } <span class="comment">// for (unsigned j=0;j&lt;n_face;j++)</span></div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;         </div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;  <span class="comment">// Loop over the edges on which the node lies</span></div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;  <span class="comment">//------------------------------------------</span></div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j=0;j&lt;n_edge;j++)</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;  {</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;   <span class="comment">// Even if we restrict ourselves to true edge neighbours (i.e.</span></div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;   <span class="comment">// elements that are not also face neighbours) there may be multiple</span></div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;   <span class="comment">// edge neighbours across the edges between multiple root octrees.</span></div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;   <span class="comment">// When making the first call to OcTree::gteq_true_edge_neighbour(...)</span></div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;   <span class="comment">// we simply return the first one of these multiple edge neighbours</span></div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;   <span class="comment">// (if there are any at all, of course) and also return the total number</span></div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;   <span class="comment">// of true edge neighbours. If the node in question already exists</span></div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;   <span class="comment">// on the first edge neighbour we&#39;re done. If it doesn&#39;t it may exist</span></div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;   <span class="comment">// on other edge neighbours so we repeat the process over all</span></div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;   <span class="comment">// other edge neighbours (bailing out if a node is found, of course).</span></div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160; </div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;   <span class="comment">// Initially return the zero-th true edge neighbour</span></div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;   <span class="keywordtype">unsigned</span> i_root_edge_neighbour=0;</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160; </div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;   <span class="comment">// Initialise the total number of true edge neighbours</span></div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;   <span class="keywordtype">unsigned</span> nroot_edge_neighbour=0;</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;   </div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;   <span class="comment">// Keep searching until we&#39;ve found the node or until we&#39;ve checked</span></div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;   <span class="comment">// all available edge neighbours</span></div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;   <span class="keywordtype">bool</span> keep_searching=<span class="keyword">true</span>;</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;   <span class="keywordflow">while</span> (keep_searching)</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;   {</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;    <span class="comment">// Find pointer to neighbouring element along edge</span></div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;    <a class="code" href="classoomph_1_1OcTree.html">OcTree</a>* neigh_pt;</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;    neigh_pt = octree_pt()-&gt;</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;     gteq_true_edge_neighbour(edges[j],</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;                              i_root_edge_neighbour,</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;                              nroot_edge_neighbour, </div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;                              translate_s,</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;                              s_lo_neigh,s_hi_neigh,</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;                              neigh_face,diff_level);</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;     </div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;    <span class="comment">// Neighbour exists</span></div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;    <span class="keywordflow">if</span> (neigh_pt!=0)</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;    {</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;     <span class="comment">// Have its nodes been created yet?</span></div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;     <span class="keywordflow">if</span> (neigh_pt-&gt;<a class="code" href="classoomph_1_1Tree.html#a2f2eeb0f1dd161f696cccc652974ff4c">object_pt</a>()-&gt;<a class="code" href="classoomph_1_1RefineableElement.html#a50758228db823d72ea8da23dbb000901">nodes_built</a>())</div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;     {         </div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;      <span class="comment">//We now need to translate the nodal location, defined in terms</span></div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;      <span class="comment">//of the fractional coordinates of the present element into</span></div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;      <span class="comment">//those of its neighbour. For this we use the information returned</span></div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;      <span class="comment">//to use from the octree function.</span></div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;         </div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;      <span class="comment">//Calculate the local coordinate in the neighbour</span></div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;      <span class="comment">//Note that we need to use the translation scheme in case</span></div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;      <span class="comment">//the local coordinates are swapped in the neighbour.</span></div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;3;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;      {</div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;       <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] = s_lo_neigh[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] + s_fraction[translate_s[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]]*</div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;        (s_hi_neigh[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] - s_lo_neigh[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]);</div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;      }</div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;         </div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;      <span class="comment">// Find the node in the neighbour</span></div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;      <a class="code" href="classoomph_1_1Node.html">Node</a>* neighbour_node_pt =</div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;       neigh_pt-&gt;<a class="code" href="classoomph_1_1Tree.html#a2f2eeb0f1dd161f696cccc652974ff4c">object_pt</a>()-&gt;<a class="code" href="classoomph_1_1FiniteElement.html#a2ddbb05c5f8bb35b64bec287d653105c">get_node_at_local_coordinate</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>);</div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160; </div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;      <span class="comment">//If there is a node, return it</span></div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;      <span class="keywordflow">if</span> (neighbour_node_pt!=0)</div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;      {</div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;       <span class="comment">// Get the faces on which the edge lies</span></div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;       <a class="code" href="classoomph_1_1Vector.html">Vector&lt;int&gt;</a> faces_attached_to_edge=<a class="code" href="classoomph_1_1OcTree.html#a29d019becbc07f9ea2811a0ff0881d9a">OcTree::faces_of_common_edge</a>(edges[j]);</div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160; </div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;       <span class="comment">// Get the number of entries in the vector</span></div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;       <span class="keywordtype">unsigned</span> n_faces_attached_to_edge=faces_attached_to_edge.size();</div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;       </div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;       <span class="comment">// Loop over the faces</span></div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;       <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i_face=0;i_face&lt;n_faces_attached_to_edge;i_face++)</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;       {</div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;        <span class="comment">// Is the node periodic in the face direction?</span></div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;        is_periodic=octree_pt()-&gt;root_pt()-&gt;</div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;         is_neighbour_periodic(faces_attached_to_edge[i_face]);</div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160; </div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;        <span class="comment">// Check if the edge is periodic in the i_face-th face direction</span></div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;        <span class="keywordflow">if</span> (is_periodic)</div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;        {</div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;         <span class="comment">// We&#39;re done!</span></div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;         <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;        }</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;       } <span class="comment">// for (unsigned i_face=0;i_face&lt;n_faces_attached_to_edge;i_face++)</span></div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;       </div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;       <span class="comment">// Return the neighbour node pointer</span></div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;       <span class="keywordflow">return</span> neighbour_node_pt;</div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;      } <span class="comment">// if (neighbour_node_pt!=0)</span></div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;     } <span class="comment">// if (neigh_pt-&gt;object_pt()-&gt;nodes_built())</span></div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;    } <span class="comment">// if (neigh_pt!=0)</span></div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;     </div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;    <span class="comment">// Keep searching, but only if there are further edge neighbours</span></div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;    <span class="comment">// Try next root edge neighbour</span></div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;    i_root_edge_neighbour++;</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;     </div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;    <span class="comment">// Have we exhausted the search?</span></div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;    <span class="keywordflow">if</span> (i_root_edge_neighbour&gt;=nroot_edge_neighbour)</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;    {</div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;     <span class="comment">// Stop searching</span></div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;     keep_searching=<span class="keyword">false</span>;</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;    }</div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;   } <span class="comment">// End of while keep searching over all true edge neighbours</span></div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;  } <span class="comment">//End of loop over edges</span></div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160; </div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;  <span class="comment">//Node not found, return null</span></div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;  <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160; }</div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160; </div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160; </div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;<span class="comment">//==================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;<span class="comment">/// Build the element by doing the following:</span></div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;<span class="comment">/// - Give it nodal positions (by establishing the pointers to its</span></div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;<span class="comment">///   nodes)</span></div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;<span class="comment">/// - In the process create new nodes where required (i.e. if they</span></div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;<span class="comment">///   don&#39;t exist in father element or have already been created</span></div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;<span class="comment">///   while building new neighbour elements). Node building</span></div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;<span class="comment">///   involves the following steps:</span></div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;<span class="comment">///   - Get nodal position from father element.</span></div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;<span class="comment">///   - Establish the time-history of the newly created nodal point</span></div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;<span class="comment">///     (its coordinates and the previous values) consistent with</span></div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;<span class="comment">///     the father&#39;s history.</span></div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;<span class="comment">///   - Determine the boundary conditions of the nodes (newly</span></div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;<span class="comment">///     created nodes can only lie on the interior of any</span></div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;<span class="comment">///     edges of the father element -- this makes it possible to</span></div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;<span class="comment">///     to figure out what their bc should be...)</span></div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;<span class="comment">///   - Add node to the mesh&#39;s stoarge scheme for the boundary nodes.</span></div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;<span class="comment">///   - Add the new node to the mesh itself</span></div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;<span class="comment">///   - Doc newly created nodes in file &quot;new_nodes.dat&quot; in the directory</span></div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;<span class="comment">////    of the DocInfo object (only if it&#39;s open!)</span></div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;<span class="comment">/// - Finally, excute the element-specific further_build() </span></div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;<span class="comment">///   (empty by default -- must be overloaded for specific elements).</span></div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;<span class="comment">///   This deals with any build operations that are not included</span></div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;<span class="comment">///   in the generic process outlined above. For instance, in</span></div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;<span class="comment">///   Crouzeix Raviart elements we need to initialise the internal</span></div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;<span class="comment">///   pressure values in manner consistent with the pressure</span></div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;<span class="comment">///   distribution in the father element.</span></div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;<span class="comment"></span><span class="comment">//==================================================================</span></div>
<div class="line"><a name="l01229"></a><span class="lineno"><a class="line" href="classoomph_1_1RefineableQElement_3_013_01_4.html#ac085ca58b7eefb81628275e2b7ab07ce"> 1229</a></span>&#160; <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1RefineableQElement.html">RefineableQElement&lt;3&gt;::build</a>(<a class="code" href="classoomph_1_1Mesh.html">Mesh</a>*&amp; mesh_pt, </div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;                                   <a class="code" href="classoomph_1_1Vector.html">Vector&lt;Node*&gt;</a>&amp; new_node_pt,</div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;                                   <span class="keywordtype">bool</span>&amp; was_already_built,</div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;                                   std::ofstream &amp;new_nodes_file)</div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160; {</div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;  <span class="keyword">using namespace </span>OcTreeNames;</div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160; </div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;  <span class="comment">// Number of dimensions</span></div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;  <span class="keywordtype">unsigned</span> n_dim=3;</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160; </div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;  <span class="comment">//Get the number of 1d nodes</span></div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;  <span class="keywordtype">unsigned</span> n_p = nnode_1d();</div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160; </div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;  <span class="comment">//Check whether static father_bound needs to be created</span></div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;  <span class="keywordflow">if</span> (Father_bound[n_p].nrow()==0) {setup_father_bounds();}</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160; </div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;  <span class="comment">//Pointer to my father (in octree impersonation)</span></div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;  <a class="code" href="classoomph_1_1OcTree.html">OcTree</a>* father_pt = <span class="keyword">dynamic_cast&lt;</span><a class="code" href="classoomph_1_1OcTree.html">OcTree</a>*<span class="keyword">&gt;</span>(octree_pt()-&gt;father_pt());</div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160; </div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;  <span class="comment">// What type of son am I? Ask my octree representation...</span></div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;  <span class="keywordtype">int</span> son_type=octree_pt()-&gt;<a class="code" href="classoomph_1_1Tree.html#a7537f8fe7c896d2220eb2da03567b34d">son_type</a>();</div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160; </div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;  <span class="comment">// Has somebody build me already? (If any nodes have not been built)</span></div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;  <span class="keywordflow">if</span> (!nodes_built())</div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;  {</div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;   <span class="keywordflow">if</span> (father_pt==0)</div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;   {</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;    <a class="code" href="namespaceoomph_1_1Global__string__for__annotation.html#ac5379de2fa7fe44f2cb31785fc208135">std::string</a> error_message=</div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;     <span class="stringliteral">&quot;Something fishy here: I have no father and yet \n&quot;</span>;</div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;    error_message+=<span class="stringliteral">&quot;I have no nodes. Who has created me then?!\n&quot;</span>;</div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160; </div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="classoomph_1_1OomphLibError.html">OomphLibError</a>(error_message,</div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;                        OOMPH_CURRENT_FUNCTION,</div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;                        OOMPH_EXCEPTION_LOCATION);</div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;   }</div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160; </div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;   <span class="comment">// Indicate status:</span></div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;   was_already_built=<span class="keyword">false</span>;</div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160; </div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;   <span class="comment">// Return pointer to father element</span></div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;   <a class="code" href="classoomph_1_1RefineableQElement_3_013_01_4.html">RefineableQElement&lt;3&gt;</a>* father_el_pt =</div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;    <span class="keyword">dynamic_cast&lt;</span><a class="code" href="classoomph_1_1RefineableQElement_3_013_01_4.html">RefineableQElement&lt;3&gt;</a>*<span class="keyword">&gt;</span>(father_pt-&gt;<a class="code" href="classoomph_1_1Tree.html#a2f2eeb0f1dd161f696cccc652974ff4c">object_pt</a>());</div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160; </div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;   <span class="comment">// Timestepper should be the same for all nodes in father</span></div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;   <span class="comment">// element -- use it create timesteppers for new nodes</span></div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;   <a class="code" href="classoomph_1_1TimeStepper.html">TimeStepper</a>* time_stepper_pt=father_el_pt-&gt;<a class="code" href="classoomph_1_1FiniteElement.html#ace0e7fb72a805b5c2c600347bfae7a9b">node_pt</a>(0)-&gt;<a class="code" href="classoomph_1_1Data.html#a5b34970d16205921dca3ada720da8445">time_stepper_pt</a>();</div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160; </div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;   <span class="comment">// Number of history values (incl. present)</span></div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;   <span class="keywordtype">unsigned</span> ntstorage=time_stepper_pt-&gt;ntstorage();</div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160; </div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;   <span class="comment">// Currently we can&#39;t handle the case of generalised coordinates</span></div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;   <span class="comment">// since we haven&#39;t established how they should be interpolated</span></div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;   <span class="comment">// Buffer this case:</span></div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;   <span class="keywordflow">if</span> (father_el_pt-&gt;<a class="code" href="classoomph_1_1FiniteElement.html#ace0e7fb72a805b5c2c600347bfae7a9b">node_pt</a>(0)-&gt;<a class="code" href="classoomph_1_1Node.html#aee6f2b7a46fc9d875c6736895d7fc095">nposition_type</a>()!=1)</div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;   {</div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="classoomph_1_1OomphLibError.html">OomphLibError</a>(</div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;     <span class="stringliteral">&quot;Can&#39;t handle generalised nodal positions (yet).&quot;</span>,</div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;     OOMPH_CURRENT_FUNCTION,</div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;     OOMPH_EXCEPTION_LOCATION);</div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;   }</div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160; </div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;   <a class="code" href="classoomph_1_1Vector.html">Vector&lt;int&gt;</a> s_lo(n_dim);</div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;   <a class="code" href="classoomph_1_1Vector.html">Vector&lt;int&gt;</a> s_hi(n_dim);</div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;   <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>(n_dim);</div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;   <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> x(n_dim);</div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160; </div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;   <span class="comment">// Setup vertex coordinates in father element:</span></div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;   <span class="comment">//--------------------------------------------</span></div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;   <span class="comment">// find the s_lo coordinates</span></div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;   s_lo=octree_pt()-&gt;Direction_to_vector[son_type];</div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;   </div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;   <span class="comment">// Just scale them, because the Direction_to_vector</span></div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;   <span class="comment">// doesn&#39;t really gives s_lo;</span></div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;n_dim;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;   {</div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;    s_lo[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]=(s_lo[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]+1)/2-1;</div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;   }</div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160; </div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;   <span class="comment">// setup s_hi (Actually s_hi[i]=s_lo[i]+1)</span></div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;n_dim;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;   {</div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;    s_hi[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]=s_lo[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]+1;</div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;   }</div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;      </div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;   <span class="comment">// Pass macro element pointer on to sons and</span></div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;   <span class="comment">// set coordinates in macro element</span></div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;   <span class="keywordflow">if</span> (father_el_pt-&gt;<a class="code" href="classoomph_1_1FiniteElement.html#aa8bce95f69e3199a508672eea7ecc226">macro_elem_pt</a>()!=0)</div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;   {</div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;    set_macro_elem_pt(father_el_pt-&gt;<a class="code" href="classoomph_1_1FiniteElement.html#aa8bce95f69e3199a508672eea7ecc226">macro_elem_pt</a>());</div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;n_dim;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;    {</div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;     s_macro_ll(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>)=      father_el_pt-&gt;<a class="code" href="classoomph_1_1QElementBase.html#a788011c6b64ed0c6e314b7a1f3165687">s_macro_ll</a>(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>)+</div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;      0.5*(s_lo[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]+1.0)*(father_el_pt-&gt;<a class="code" href="classoomph_1_1QElementBase.html#aec37122110d976a88d60a061262592a2">s_macro_ur</a>(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>)-</div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;                         father_el_pt-&gt;<a class="code" href="classoomph_1_1QElementBase.html#a788011c6b64ed0c6e314b7a1f3165687">s_macro_ll</a>(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>));</div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;     s_macro_ur(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>)=      father_el_pt-&gt;<a class="code" href="classoomph_1_1QElementBase.html#a788011c6b64ed0c6e314b7a1f3165687">s_macro_ll</a>(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>)+</div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;      0.5*(s_hi[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]+1.0)*(father_el_pt-&gt;<a class="code" href="classoomph_1_1QElementBase.html#aec37122110d976a88d60a061262592a2">s_macro_ur</a>(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>)-</div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;                         father_el_pt-&gt;<a class="code" href="classoomph_1_1QElementBase.html#a788011c6b64ed0c6e314b7a1f3165687">s_macro_ll</a>(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>));</div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;    }</div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;     </div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;   }</div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;   </div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160; </div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;   <span class="comment">// If the father element hasn&#39;t been generated yet, we&#39;re stuck...</span></div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;   <span class="keywordflow">if</span> (father_el_pt-&gt;<a class="code" href="classoomph_1_1FiniteElement.html#ace0e7fb72a805b5c2c600347bfae7a9b">node_pt</a>(0)==0)</div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;   {</div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="classoomph_1_1OomphLibError.html">OomphLibError</a>(</div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;     <span class="stringliteral">&quot;Trouble: father_el_pt-&gt;node_pt(0)==0\n Can&#39;t build son element!\n&quot;</span>,</div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;     OOMPH_CURRENT_FUNCTION,</div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;     OOMPH_EXCEPTION_LOCATION);</div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;   }</div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;   <span class="keywordflow">else</span></div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;   {</div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;    <span class="keywordtype">unsigned</span> jnod=0;</div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;    <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> s_fraction(n_dim);</div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;    </div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;    <span class="comment">// Loop over nodes in element</span></div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i0=0;i0&lt;n_p;i0++)</div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;    {</div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;     <span class="comment">//Get the fractional position of the node in the direction of s[0]</span></div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;     s_fraction[0] = local_one_d_fraction_of_node(i0,0);</div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;     <span class="comment">// Local coordinate in father element</span></div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;     <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0] = s_lo[0] + (s_hi[0]-s_lo[0])*s_fraction[0];</div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160; </div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i1=0;i1&lt;n_p;i1++)</div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;     {</div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;      <span class="comment">//Get the fractional position of the node in the direction of s[1]</span></div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;      s_fraction[1] = local_one_d_fraction_of_node(i1,1);</div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;      <span class="comment">// Local coordinate in father element</span></div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;      <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1] = s_lo[1] + (s_hi[1]-s_lo[1])*s_fraction[1];</div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;         </div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i2=0;i2&lt;n_p;i2++)</div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;      {</div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;       <span class="comment">//Get the fractional position of the node in the direction of s[2]</span></div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;       s_fraction[2] = local_one_d_fraction_of_node(i2,2);</div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;       </div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;       <span class="comment">// Local coordinate in father element</span></div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;       <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[2] = s_lo[2] + (s_hi[2]-s_lo[2])*s_fraction[2];</div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160; </div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;       <span class="comment">// Local node number</span></div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;       jnod=i0 + n_p*i1 +n_p*n_p*i2;</div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160; </div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;       <span class="comment">// Initialise flag: So far, this node hasn&#39;t been built</span></div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;       <span class="comment">// or copied yet</span></div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;       <span class="keywordtype">bool</span> node_done=<span class="keyword">false</span>;</div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160; </div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;       <span class="comment">//Get the pointer to the node in the father; returns NULL</span></div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;       <span class="comment">//if there is not a node</span></div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;       <a class="code" href="classoomph_1_1Node.html">Node</a>* created_node_pt=father_el_pt-&gt;<a class="code" href="classoomph_1_1FiniteElement.html#a2ddbb05c5f8bb35b64bec287d653105c">get_node_at_local_coordinate</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>);</div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;       </div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;       <span class="comment">// Does this node already exist in father element?</span></div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;       <span class="comment">//------------------------------------------------</span></div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;       <span class="keywordtype">bool</span> node_exists_in_father=<span class="keyword">false</span>;</div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;       <span class="keywordflow">if</span> (created_node_pt!=0)</div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;       {        </div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;        <span class="comment">// Remember this!</span></div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;        node_exists_in_father=<span class="keyword">true</span>;</div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160; </div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;        <span class="comment">// Copy node across</span></div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;        node_pt(jnod) = created_node_pt;</div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160; </div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;        <span class="comment">//Make sure that we update the values at the node so that</span></div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;        <span class="comment">//they are consistent with the present representation.</span></div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;        <span class="comment">//This is only need for mixed interpolation where the value</span></div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;        <span class="comment">//at the father could now become active.</span></div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;             </div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;        <span class="comment">// Loop over all history values</span></div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#af6f0bd3dc13317f895c91323c25c2b8f">t</a>=0;<a class="code" href="cfortran_8h.html#af6f0bd3dc13317f895c91323c25c2b8f">t</a>&lt;ntstorage;<a class="code" href="cfortran_8h.html#af6f0bd3dc13317f895c91323c25c2b8f">t</a>++)</div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;        {</div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;         <span class="comment">// Get values from father element</span></div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;         <span class="comment">// Note: get_interpolated_values() sets Vector size itself.</span></div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;         <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> prev_values;</div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;         father_el_pt-&gt;<a class="code" href="classoomph_1_1RefineableElement.html#ad9a4f92880668a2373326d8306365c43">get_interpolated_values</a>(<a class="code" href="cfortran_8h.html#af6f0bd3dc13317f895c91323c25c2b8f">t</a>,<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,prev_values);</div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;         <span class="comment">//Find the minimum number of values</span></div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;         <span class="comment">//(either those stored at the node, or those returned by</span></div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;         <span class="comment">// the function)</span></div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;         <span class="keywordtype">unsigned</span> n_val_at_node = created_node_pt-&gt;<a class="code" href="classoomph_1_1Data.html#a7e67fc78a2e8a2fd6eb75bd292d42ff8">nvalue</a>();</div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;         <span class="keywordtype">unsigned</span> n_val_from_function = prev_values.size(); </div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;         <span class="comment">//Use the ternary conditional operator here</span></div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;         <span class="keywordtype">unsigned</span> n_var = n_val_at_node &lt; n_val_from_function ?</div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;                                          n_val_at_node : n_val_from_function;</div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;         <span class="comment">//Assign the values that we can</span></div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;         <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> k=0;k&lt;n_var;k++)</div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;         {</div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;          created_node_pt-&gt;<a class="code" href="classoomph_1_1Data.html#a7289ca322725c6fd493970a19474b382">set_value</a>(<a class="code" href="cfortran_8h.html#af6f0bd3dc13317f895c91323c25c2b8f">t</a>,k,prev_values[k]);</div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;         }</div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;        }</div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160; </div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;        <span class="comment">// Node has been created by copy</span></div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;        node_done=<span class="keyword">true</span>;</div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;       }          </div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;       <span class="comment">// Node does not exist in father element but might already</span></div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;       <span class="comment">//--------------------------------------------------------</span></div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;       <span class="comment">// have been created by neighbouring elements</span></div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;       <span class="comment">//-------------------------------------------</span></div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;       <span class="keywordflow">else</span></div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;       {</div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;        <span class="comment">// Boolean to check if the node is periodic</span></div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;        <span class="keywordtype">bool</span> is_periodic=<span class="keyword">false</span>;</div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;           </div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;        <span class="comment">// Was the node created by one of its neighbours</span></div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;        <span class="comment">// Whether or not the node lies on an edge can be determined</span></div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;        <span class="comment">// from the fractional position</span></div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;        created_node_pt=node_created_by_neighbour(s_fraction,is_periodic);</div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160; </div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;        <span class="comment">// If so, then copy the pointer across</span></div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;        <span class="keywordflow">if</span> (created_node_pt!=0)</div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;        {       </div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;         <span class="comment">// Now the node must be on a boundary, but we don&#39;t know which</span></div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;         <span class="comment">// one. The returned created_node_pt is actually the neighbouring</span></div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;         <span class="comment">// periodic node</span></div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;         <a class="code" href="classoomph_1_1Node.html">Node</a>* neighbour_node_pt = created_node_pt;</div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;  </div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;         <span class="comment">// Determine the edge on which the new node will live</span></div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;         <span class="keywordtype">int</span> father_bound=Father_bound[n_p](jnod,son_type);</div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;          </div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;         <span class="comment">// Storage for the set of Mesh boundaries on which the </span></div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;         <span class="comment">// appropriate father edge lives.</span></div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;         std::set&lt;unsigned&gt; <a class="code" href="the__data__structure_8txt.html#a5641be16902d346c51580a49fb9885dc">boundaries</a>;</div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;          </div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;         <span class="comment">// Only get the boundaries if we are at the edge of</span></div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;         <span class="comment">// an element. Nodes in the centre of an element cannot be</span></div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;         <span class="comment">// on Mesh boundaries</span></div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;         <span class="keywordflow">if</span> (father_bound!=<a class="code" href="classoomph_1_1Tree.html#a9e532196340dcd859ff8207eea2ddbbc">Tree::OMEGA</a>)</div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;         {</div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;          father_el_pt-&gt;<a class="code" href="classoomph_1_1RefineableQElement_3_013_01_4.html#ac61083ce6abe6338ec5d7795d9f1e051">get_boundaries</a>(father_bound,<a class="code" href="the__data__structure_8txt.html#a5641be16902d346c51580a49fb9885dc">boundaries</a>);</div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;         }</div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;               </div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;         <span class="comment">// Case where a new node lives on more than one boundary</span></div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;         <span class="comment">// seems fishy enough to flag</span></div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="the__data__structure_8txt.html#a5641be16902d346c51580a49fb9885dc">boundaries</a>.size()&gt;2)</div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;         {</div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;          <span class="keywordflow">throw</span> <a class="code" href="classoomph_1_1OomphLibError.html">OomphLibError</a>(<span class="stringliteral">&quot;boundaries.size()&gt;2 seems a bit strange..\n&quot;</span>,</div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;                              OOMPH_CURRENT_FUNCTION,</div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;                              OOMPH_EXCEPTION_LOCATION);</div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;         }</div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;           </div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;         <span class="comment">// If the node is periodic and is definitely a boundary node.</span></div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;         <span class="comment">// NOTE: the reason for this is that confusion can arise when</span></div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;         <span class="comment">// a node is created on an edge that joins a periodic face.</span></div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;         <span class="keywordflow">if</span> ((is_periodic)&amp;&amp;(<a class="code" href="the__data__structure_8txt.html#a5641be16902d346c51580a49fb9885dc">boundaries</a>.size()&gt;0))</div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;         {            </div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;          <span class="comment">// Create node and set the pointer to it from the element </span></div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;          created_node_pt=construct_boundary_node(jnod,time_stepper_pt);</div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160; </div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;          <span class="comment">//Make the node periodic from the neighbour</span></div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;          created_node_pt-&gt;<a class="code" href="classoomph_1_1Node.html#aeb07848c19b83fd8b9690b8fcc200d56">make_periodic</a>(neighbour_node_pt);</div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160; </div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;          <span class="comment">// Add to vector of new nodes</span></div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;          new_node_pt.push_back(created_node_pt);</div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;               </div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;          <span class="comment">// Loop over # of history values</span></div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#af6f0bd3dc13317f895c91323c25c2b8f">t</a>=0;<a class="code" href="cfortran_8h.html#af6f0bd3dc13317f895c91323c25c2b8f">t</a>&lt;ntstorage;<a class="code" href="cfortran_8h.html#af6f0bd3dc13317f895c91323c25c2b8f">t</a>++)</div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;          {</div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;           <span class="comment">// Get position from father element -- this uses the macro</span></div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;           <span class="comment">// element representation if appropriate. If the node</span></div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;           <span class="comment">// turns out to be a hanging node later on, then</span></div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;           <span class="comment">// its position gets adjusted in line with its</span></div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;           <span class="comment">// hanging node interpolation.</span></div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;           <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> x_prev(n_dim);</div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;           father_el_pt-&gt;<a class="code" href="classoomph_1_1FiniteElement.html#a6fc14cbf4e1d031acbc59b415cefa1ca">get_x</a>(<a class="code" href="cfortran_8h.html#af6f0bd3dc13317f895c91323c25c2b8f">t</a>,<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,x_prev);</div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;           <span class="comment">// Set previous positions of the new node</span></div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;           <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;n_dim;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;           {</div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;            created_node_pt-&gt;<a class="code" href="classoomph_1_1Node.html#a056f8e82da938369cd38541c5cdc598a">x</a>(<a class="code" href="cfortran_8h.html#af6f0bd3dc13317f895c91323c25c2b8f">t</a>,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>) = x_prev[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>];</div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;           }</div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;          }</div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;          </div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;          <span class="comment">// Next, we Update the boundary lookup schemes</span></div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;          <span class="comment">// Loop over the boundaries stored in the set</span></div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;          <span class="keywordflow">for</span>(std::set&lt;unsigned&gt;::iterator it = <a class="code" href="the__data__structure_8txt.html#a5641be16902d346c51580a49fb9885dc">boundaries</a>.begin();</div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;              it != <a class="code" href="the__data__structure_8txt.html#a5641be16902d346c51580a49fb9885dc">boundaries</a>.end(); ++it)</div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;          {</div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;           <span class="comment">//Add the node to the boundary</span></div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;           mesh_pt-&gt;<a class="code" href="classoomph_1_1Mesh.html#a007b102ac8e42328872ad658d7110bfc">add_boundary_node</a>(*it,created_node_pt);</div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;                 </div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;           <span class="comment">//If we have set an intrinsic coordinate on this</span></div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;           <span class="comment">//mesh boundary then it must also be interpolated on</span></div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;           <span class="comment">//the new node</span></div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;           <span class="comment">//Now interpolate the intrinsic boundary coordinate</span></div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;           <span class="keywordflow">if</span>(mesh_pt-&gt;<a class="code" href="classoomph_1_1Mesh.html#ad1b124a959628aba00162b89617b3a62">boundary_coordinate_exists</a>(*it)==<span class="keyword">true</span>)</div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;           {</div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;            <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> zeta(2,0.0);</div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;            father_el_pt-&gt;<a class="code" href="classoomph_1_1RefineableQElement_3_013_01_4.html#aa0feadb4fbbe8861366a77373b122293">interpolated_zeta_on_face</a>(*it,father_bound,<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,zeta);</div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;            created_node_pt-&gt;<a class="code" href="classoomph_1_1Node.html#a94c19e165ab4e88aabbfa27443c530b7">set_coordinates_on_boundary</a>(*it,zeta);</div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;           }</div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;          }</div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;               </div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;          <span class="comment">// Make sure that we add the node to the mesh</span></div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;          mesh_pt-&gt;<a class="code" href="classoomph_1_1Mesh.html#ac09a9bfeb6d70d8bbefe13c86948a6fc">add_node_pt</a>(created_node_pt);        </div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;         } <span class="comment">// End of periodic case</span></div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;         <span class="comment">//Otherwise the node is not periodic, so just set the </span></div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;         <span class="comment">//pointer to the neighbours node</span></div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;         <span class="keywordflow">else</span></div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;         {</div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;          node_pt(jnod) = created_node_pt;</div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;         }</div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;         node_done=<span class="keyword">true</span>;</div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;        }</div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;        <span class="comment">// Node does not exist in neighbour element but might already</span></div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;        <span class="comment">//-----------------------------------------------------------</span></div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;        <span class="comment">// have been created by a son of a neighbouring element</span></div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;        <span class="comment">//-----------------------------------------------------</span></div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;        {</div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;         <span class="comment">//Was the node created by one of its neighbours&#39; sons</span></div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;         <span class="comment">//Whether or not the node lies on an edge can be calculated</span></div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;         <span class="comment">//by from the fractional position</span></div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;         <span class="keywordtype">bool</span> is_periodic=<span class="keyword">false</span>;</div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;         created_node_pt=node_created_by_son_of_neighbour(s_fraction,</div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;                                                          is_periodic);</div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;  </div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;         <span class="comment">//If the node was so created, assign the pointers</span></div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;         <span class="keywordflow">if</span>(created_node_pt!=0)</div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;         {</div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;          <span class="comment">//If the node is periodic</span></div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;          <span class="keywordflow">if</span>(is_periodic)</div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;          {</div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;           <span class="comment">//Now the node must be on a boundary, but we don&#39;t know which</span></div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;           <span class="comment">//one</span></div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;           <span class="comment">//The returned created_node_pt is actually the neighbouring</span></div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;           <span class="comment">//periodic node</span></div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;           <a class="code" href="classoomph_1_1Node.html">Node</a>* neighbour_node_pt=created_node_pt;</div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;    </div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;           <span class="comment">// Determine the edge on which the new node will live</span></div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;           <span class="keywordtype">int</span> father_bound=Father_bound[n_p](jnod,son_type);</div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;                 </div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;           <span class="comment">// Storage for the set of Mesh boundaries on which the </span></div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;           <span class="comment">// appropriate father edge lives.</span></div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;           std::set&lt;unsigned&gt; <a class="code" href="the__data__structure_8txt.html#a5641be16902d346c51580a49fb9885dc">boundaries</a>;</div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;           </div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;           <span class="comment">//Only get the boundaries if we are at the edge of</span></div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;           <span class="comment">//an element. Nodes in the centre of an element cannot be</span></div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;           <span class="comment">//on Mesh boundaries</span></div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;           <span class="keywordflow">if</span> (father_bound!=<a class="code" href="classoomph_1_1Tree.html#a9e532196340dcd859ff8207eea2ddbbc">Tree::OMEGA</a>)</div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;           {</div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;            father_el_pt-&gt;<a class="code" href="classoomph_1_1RefineableQElement_3_013_01_4.html#ac61083ce6abe6338ec5d7795d9f1e051">get_boundaries</a>(father_bound,<a class="code" href="the__data__structure_8txt.html#a5641be16902d346c51580a49fb9885dc">boundaries</a>);</div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;           }</div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;                 </div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;           <span class="comment">//Case where a new node lives on more than one boundary</span></div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;           <span class="comment">// seems fishy enough to flag</span></div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;           <span class="keywordflow">if</span> (<a class="code" href="the__data__structure_8txt.html#a5641be16902d346c51580a49fb9885dc">boundaries</a>.size()&gt;2)</div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;           {</div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;            <span class="keywordflow">throw</span> <a class="code" href="classoomph_1_1OomphLibError.html">OomphLibError</a>(<span class="stringliteral">&quot;boundaries.size()&gt;2 seems a bit strange..\n&quot;</span>,</div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;                                OOMPH_CURRENT_FUNCTION,</div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;                                OOMPH_EXCEPTION_LOCATION);</div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;           }</div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;  </div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;           <span class="comment">//Case when there are no boundaries, we are in big trouble</span></div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;           <span class="keywordflow">if</span> (<a class="code" href="the__data__structure_8txt.html#a5641be16902d346c51580a49fb9885dc">boundaries</a>.size()==0)</div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;           {</div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;            std::ostringstream error_stream;</div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;            error_stream &lt;&lt; <span class="stringliteral">&quot;Periodic node is not on a boundary...\n&quot;</span></div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;                         &lt;&lt; <span class="stringliteral">&quot;Coordinates: &quot;</span> </div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;                         &lt;&lt; created_node_pt-&gt;<a class="code" href="classoomph_1_1Node.html#a056f8e82da938369cd38541c5cdc598a">x</a>(0) &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;                         &lt;&lt; created_node_pt-&gt;<a class="code" href="classoomph_1_1Node.html#a056f8e82da938369cd38541c5cdc598a">x</a>(1) &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;            <span class="keywordflow">throw</span> <a class="code" href="classoomph_1_1OomphLibError.html">OomphLibError</a>(error_stream.str(),</div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;                                OOMPH_CURRENT_FUNCTION,</div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;                                OOMPH_EXCEPTION_LOCATION);</div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;           }</div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;                 </div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;           <span class="comment">// Create node and set the pointer to it from the element </span></div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;           created_node_pt=construct_boundary_node(jnod,time_stepper_pt);</div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;           </div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;           <span class="comment">//Make the node periodic from the neighbour</span></div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;           created_node_pt-&gt;<a class="code" href="classoomph_1_1Node.html#aeb07848c19b83fd8b9690b8fcc200d56">make_periodic</a>(neighbour_node_pt);</div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;           </div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;           <span class="comment">// Add to vector of new nodes</span></div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;           new_node_pt.push_back(created_node_pt);</div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;                           </div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;           <span class="comment">// Loop over # of history values</span></div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;           <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#af6f0bd3dc13317f895c91323c25c2b8f">t</a>=0;<a class="code" href="cfortran_8h.html#af6f0bd3dc13317f895c91323c25c2b8f">t</a>&lt;ntstorage;<a class="code" href="cfortran_8h.html#af6f0bd3dc13317f895c91323c25c2b8f">t</a>++)</div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;           {</div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;            <span class="comment">// Get position from father element -- this uses the macro</span></div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;            <span class="comment">// element representation if appropriate. If the node</span></div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;            <span class="comment">// turns out to be a hanging node later on, then</span></div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;            <span class="comment">// its position gets adjusted in line with its</span></div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;            <span class="comment">// hanging node interpolation.</span></div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;            <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> x_prev(n_dim,0.0);</div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;            father_el_pt-&gt;<a class="code" href="classoomph_1_1FiniteElement.html#a6fc14cbf4e1d031acbc59b415cefa1ca">get_x</a>(<a class="code" href="cfortran_8h.html#af6f0bd3dc13317f895c91323c25c2b8f">t</a>,<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,x_prev);</div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;            <span class="comment">// Set previous positions of the new node</span></div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;n_dim;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;            {</div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;             created_node_pt-&gt;<a class="code" href="classoomph_1_1Node.html#a056f8e82da938369cd38541c5cdc598a">x</a>(<a class="code" href="cfortran_8h.html#af6f0bd3dc13317f895c91323c25c2b8f">t</a>,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>) = x_prev[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>];</div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;            }</div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;           }</div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;                 </div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;           <span class="comment">// Next, we Update the boundary lookup schemes</span></div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;           <span class="comment">//Loop over the boundaries stored in the set</span></div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;           <span class="keywordflow">for</span>(std::set&lt;unsigned&gt;::iterator it = <a class="code" href="the__data__structure_8txt.html#a5641be16902d346c51580a49fb9885dc">boundaries</a>.begin();</div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;               it != <a class="code" href="the__data__structure_8txt.html#a5641be16902d346c51580a49fb9885dc">boundaries</a>.end(); ++it)</div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;           {</div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;            <span class="comment">//Add the node to the boundary</span></div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;            mesh_pt-&gt;<a class="code" href="classoomph_1_1Mesh.html#a007b102ac8e42328872ad658d7110bfc">add_boundary_node</a>(*it,created_node_pt);</div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;                   </div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;            <span class="comment">//If we have set an intrinsic coordinate on this</span></div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;            <span class="comment">//mesh boundary then it must also be interpolated on</span></div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;            <span class="comment">//the new node</span></div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;            <span class="comment">//Now interpolate the intrinsic boundary coordinate</span></div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;            <span class="keywordflow">if</span>(mesh_pt-&gt;<a class="code" href="classoomph_1_1Mesh.html#ad1b124a959628aba00162b89617b3a62">boundary_coordinate_exists</a>(*it)==<span class="keyword">true</span>)</div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;            {</div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;             <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> zeta(2,0.0);</div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;             father_el_pt-&gt;<a class="code" href="classoomph_1_1RefineableQElement_3_013_01_4.html#aa0feadb4fbbe8861366a77373b122293">interpolated_zeta_on_face</a>(*it,father_bound,<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,zeta);</div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;             created_node_pt-&gt;<a class="code" href="classoomph_1_1Node.html#a94c19e165ab4e88aabbfa27443c530b7">set_coordinates_on_boundary</a>(*it,zeta);</div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;            }</div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;           }</div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;                 </div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;           <span class="comment">//Make sure that we add the node to the mesh</span></div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;           mesh_pt-&gt;<a class="code" href="classoomph_1_1Mesh.html#ac09a9bfeb6d70d8bbefe13c86948a6fc">add_node_pt</a>(created_node_pt);        </div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;          } <span class="comment">//End of periodic case</span></div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;          <span class="comment">//Otherwise the node is not periodic, so just set the </span></div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;          <span class="comment">//pointer to the neighbours node</span></div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;          {</div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;           node_pt(jnod) = created_node_pt;</div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;          }</div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;          <span class="comment">//Node has been created</span></div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;          node_done = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;         } <span class="comment">// Node does not exist in son of neighbouring element</span></div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;        } <span class="comment">// Node does not exist in neighbouring element</span></div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;       } <span class="comment">// Node does not exist in father element         </span></div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;           </div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;       <span class="comment">// Node already exists in father: No need to do anything else!</span></div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;       <span class="comment">// otherwise deal with boundary information etc.</span></div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;       <span class="keywordflow">if</span> (!node_exists_in_father)</div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;       {         </div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;        <span class="comment">// Check boundary status</span></div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;        <span class="comment">//----------------------</span></div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;             </div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;        <span class="comment">//Firstly, we need to determine whether or not a node lies</span></div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;        <span class="comment">//on the boundary before building it, because </span></div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;        <span class="comment">//we actually assign a different type of node on boundaries.</span></div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;             </div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;        <span class="comment">// If the new node lives on a face that is</span></div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;        <span class="comment">// shared with a face of its father element,</span></div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;        <span class="comment">// it needs to inherit the bounday conditions</span></div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;        <span class="comment">// from the father face</span></div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;        <span class="keywordtype">int</span> father_bound=Father_bound[n_p](jnod,son_type);</div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;             </div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;        <span class="comment">// Storage for the set of Mesh boundaries on which the </span></div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;        <span class="comment">// appropriate father face lives.</span></div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;        <span class="comment">// [New nodes should always be mid-edge nodes in father</span></div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;        <span class="comment">// and therefore only live on one boundary but just to </span></div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;        <span class="comment">// play it safe...]</span></div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;        std::set&lt;unsigned&gt; <a class="code" href="the__data__structure_8txt.html#a5641be16902d346c51580a49fb9885dc">boundaries</a>;</div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;             </div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;        <span class="comment">//Only get the boundaries if we are at the edge of</span></div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;        <span class="comment">//an element. Nodes in the centre of an element cannot be</span></div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;        <span class="comment">//on Mesh boundaries</span></div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;        <span class="keywordflow">if</span> (father_bound!=<a class="code" href="classoomph_1_1Tree.html#a9e532196340dcd859ff8207eea2ddbbc">Tree::OMEGA</a>)</div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;        {father_el_pt-&gt;<a class="code" href="classoomph_1_1RefineableQElement_3_013_01_4.html#ac61083ce6abe6338ec5d7795d9f1e051">get_boundaries</a>(father_bound,<a class="code" href="the__data__structure_8txt.html#a5641be16902d346c51580a49fb9885dc">boundaries</a>);}</div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;             </div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;        <span class="comment">//Case where a new node lives on more than two boundaries</span></div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;        <span class="comment">// seems fishy enough to flag</span></div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="the__data__structure_8txt.html#a5641be16902d346c51580a49fb9885dc">boundaries</a>.size()&gt;2)</div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;        {</div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;         <span class="keywordflow">throw</span> <a class="code" href="classoomph_1_1OomphLibError.html">OomphLibError</a>(</div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;          <span class="stringliteral">&quot;boundaries.size()&gt;2 seems a bit strange..\n&quot;</span>,</div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;          OOMPH_CURRENT_FUNCTION,</div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;          OOMPH_EXCEPTION_LOCATION);</div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;        }</div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;             </div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;        <span class="comment">//If the node lives on a mesh boundary, </span></div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;        <span class="comment">//then we need to create a boundary node</span></div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="the__data__structure_8txt.html#a5641be16902d346c51580a49fb9885dc">boundaries</a>.size()&gt; 0)</div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;        {</div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;         <span class="comment">// Do we need a new node?</span></div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;         <span class="keywordflow">if</span> (!node_done)</div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;         {</div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;          <span class="comment">// Create node and set the internal pointer</span></div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;          created_node_pt = </div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;           construct_boundary_node(jnod,time_stepper_pt);</div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;          <span class="comment">// Add to vector of new nodes</span></div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;          new_node_pt.push_back(created_node_pt);</div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;         }</div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;               </div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;         <span class="comment">//Now we need to work out whether to pin the values at</span></div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;         <span class="comment">//the new node based on the boundary conditions applied at</span></div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;         <span class="comment">//its Mesh boundary </span></div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;               </div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;         <span class="comment">// Get the boundary conditions from the father.</span></div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;         <span class="comment">// Note: We can only deal with the values that are </span></div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;         <span class="comment">//       continuously interpolated in the bulk element.</span></div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;         <span class="keywordtype">unsigned</span> n_cont=ncont_interpolated_values();</div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;         <a class="code" href="classoomph_1_1Vector.html">Vector&lt;int&gt;</a> bound_cons(n_cont);</div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;         father_el_pt-&gt;<a class="code" href="classoomph_1_1RefineableQElement_3_013_01_4.html#aac2601ff8f740680675e5e6ba5c35e9d">get_bcs</a>(father_bound,bound_cons);</div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;               </div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;         <span class="comment">// Loop over the continuously interpolated values and pin, </span></div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;         <span class="comment">// if necessary</span></div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;         <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> k=0;k&lt;n_cont;k++)</div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;         {                </div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;          <span class="keywordflow">if</span> (bound_cons[k])</div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;          {</div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;           created_node_pt-&gt;<a class="code" href="classoomph_1_1Data.html#a422231c58e423f0b43822827aa334d79">pin</a>(k);</div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;          }</div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;         }</div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;               </div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;         <span class="comment">// Solid node? If so, deal with the positional boundary</span></div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;         <span class="comment">// conditions:</span></div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;         <a class="code" href="classoomph_1_1SolidNode.html">SolidNode</a>* solid_node_pt = </div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;          <span class="keyword">dynamic_cast&lt;</span><a class="code" href="classoomph_1_1SolidNode.html">SolidNode</a>*<span class="keyword">&gt;</span>(created_node_pt);</div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;         <span class="keywordflow">if</span> (solid_node_pt!=0)</div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;         {</div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;          <span class="comment">//Get the positional boundary conditions from the father:</span></div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;          <span class="keywordtype">unsigned</span> n_dim = created_node_pt-&gt;<a class="code" href="classoomph_1_1Node.html#a786c96a8e46eb27a03b2b31f629d41b3">ndim</a>();</div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;          <a class="code" href="classoomph_1_1Vector.html">Vector&lt;int&gt;</a> solid_bound_cons(n_dim);</div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;          <a class="code" href="classoomph_1_1RefineableSolidQElement_3_013_01_4.html">RefineableSolidQElement&lt;3&gt;</a>* father_solid_el_pt=</div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;           <span class="keyword">dynamic_cast&lt;</span><a class="code" href="classoomph_1_1RefineableSolidQElement_3_013_01_4.html">RefineableSolidQElement&lt;3&gt;</a>*<span class="keyword">&gt;</span>(father_el_pt);</div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;          <span class="keywordflow">if</span> (father_solid_el_pt==0)</div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;          {</div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;           <a class="code" href="namespaceoomph_1_1Global__string__for__annotation.html#ac5379de2fa7fe44f2cb31785fc208135">std::string</a> error_message =</div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;            <span class="stringliteral">&quot;We have a SolidNode outside a refineable SolidElement\n&quot;</span>;</div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;           error_message +=</div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;            <span class="stringliteral">&quot;during mesh refinement -- this doesn&#39;t make sense&quot;</span>;</div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;                   </div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;           <span class="keywordflow">throw</span> <a class="code" href="classoomph_1_1OomphLibError.html">OomphLibError</a>(error_message,</div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;                               OOMPH_CURRENT_FUNCTION,</div>
<div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;                               OOMPH_EXCEPTION_LOCATION);</div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;          }</div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;          father_solid_el_pt-&gt;</div>
<div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;           get_solid_bcs(father_bound,solid_bound_cons);</div>
<div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;                 </div>
<div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;          <span class="comment">//Loop over the positions and pin, if necessary</span></div>
<div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> k=0;k&lt;n_dim;k++)</div>
<div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;          {</div>
<div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;           <span class="keywordflow">if</span> (solid_bound_cons[k]) {solid_node_pt-&gt;<a class="code" href="classoomph_1_1SolidNode.html#aa283a553b0141e859dd7b4f80bb88e6d">pin_position</a>(k);}</div>
<div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;          }</div>
<div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;         } <span class="comment">//End of if solid_node_pt</span></div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;               </div>
<div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;         <span class="comment">//Next update the boundary look-up schemes</span></div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;               </div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;         <span class="comment">//Loop over the boundaries in the set</span></div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;         <span class="keywordflow">for</span> (std::set&lt;unsigned&gt;::iterator it = <a class="code" href="the__data__structure_8txt.html#a5641be16902d346c51580a49fb9885dc">boundaries</a>.begin();</div>
<div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;              it != <a class="code" href="the__data__structure_8txt.html#a5641be16902d346c51580a49fb9885dc">boundaries</a>.end(); ++it)</div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;         {</div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;          <span class="comment">//Add the node to the bounadry</span></div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;          mesh_pt-&gt;<a class="code" href="classoomph_1_1Mesh.html#a007b102ac8e42328872ad658d7110bfc">add_boundary_node</a>(*it,created_node_pt);</div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;                 </div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;          <span class="comment">//If we have set an intrinsic coordinate on this</span></div>
<div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;          <span class="comment">//mesh boundary then it must also be interpolated on</span></div>
<div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;          <span class="comment">//the new node</span></div>
<div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;          <span class="comment">//Now interpolate the intrinsic boundary coordinate</span></div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;          <span class="keywordflow">if</span> (mesh_pt-&gt;<a class="code" href="classoomph_1_1Mesh.html#ad1b124a959628aba00162b89617b3a62">boundary_coordinate_exists</a>(*it)==<span class="keyword">true</span>)</div>
<div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;          {</div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;           <span class="comment">//Usually there will be two coordinates</span></div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;           <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> zeta(2);</div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;           father_el_pt-&gt;<a class="code" href="classoomph_1_1RefineableQElement_3_013_01_4.html#aa0feadb4fbbe8861366a77373b122293">interpolated_zeta_on_face</a>(*it,</div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;                                                   father_bound,</div>
<div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;                                                   <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,zeta);</div>
<div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;                   </div>
<div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;           created_node_pt-&gt;<a class="code" href="classoomph_1_1Node.html#a94c19e165ab4e88aabbfa27443c530b7">set_coordinates_on_boundary</a>(*it,zeta);</div>
<div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;          }</div>
<div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;         }</div>
<div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;        }</div>
<div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;        <span class="comment">//Otherwise the node is not on a Mesh boundary and </span></div>
<div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;        <span class="comment">//we create a normal &quot;bulk&quot; node</span></div>
<div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;        {</div>
<div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;         <span class="comment">// Do we need a new node?</span></div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;         <span class="keywordflow">if</span> (!node_done)</div>
<div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;         {</div>
<div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;          <span class="comment">// Create node and set the pointer to it from the element </span></div>
<div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;          created_node_pt = construct_node(jnod,time_stepper_pt);</div>
<div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;          <span class="comment">// Add to vector of new nodes</span></div>
<div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;          new_node_pt.push_back(created_node_pt);</div>
<div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;         }</div>
<div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;        }</div>
<div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;             </div>
<div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;        <span class="comment">// In the first instance use macro element or FE representation</span></div>
<div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;        <span class="comment">// to create past and present nodal positions.</span></div>
<div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;        <span class="comment">// (THIS STEP SHOULD NOT BE SKIPPED FOR ALGEBRAIC</span></div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;        <span class="comment">// ELEMENTS AS NOT ALL OF THEM NECESSARILY IMPLEMENT</span></div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;        <span class="comment">// NONTRIVIAL NODE UPDATE FUNCTIONS. CALLING</span></div>
<div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;        <span class="comment">// THE NODE UPDATE FOR SUCH ELEMENTS/NODES WILL LEAVE</span></div>
<div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;        <span class="comment">// THEIR NODAL POSITIONS WHERE THEY WERE (THIS IS APPROPRIATE</span></div>
<div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;        <span class="comment">// ONCE THEY HAVE BEEN GIVEN POSITIONS) BUT WILL</span></div>
<div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;        <span class="comment">// NOT ASSIGN SENSIBLE INITIAL POSITONS!</span></div>
<div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;             </div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;             </div>
<div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;        <span class="comment">// Have we created a new node?</span></div>
<div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;        <span class="keywordflow">if</span> (!node_done)</div>
<div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;        {  </div>
<div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;         <span class="comment">// Loop over # of history values</span></div>
<div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;         <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#af6f0bd3dc13317f895c91323c25c2b8f">t</a>=0;<a class="code" href="cfortran_8h.html#af6f0bd3dc13317f895c91323c25c2b8f">t</a>&lt;ntstorage;<a class="code" href="cfortran_8h.html#af6f0bd3dc13317f895c91323c25c2b8f">t</a>++)</div>
<div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;         {</div>
<div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;          <span class="comment">// Get position from father element -- this uses the macro</span></div>
<div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;          <span class="comment">// element representation if appropriate. If the node</span></div>
<div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;          <span class="comment">// turns out to be a hanging node later on, then</span></div>
<div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;          <span class="comment">// its position gets adjusted in line with its</span></div>
<div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;          <span class="comment">// hanging node interpolation.</span></div>
<div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;          <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> x_prev(n_dim);</div>
<div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;          father_el_pt-&gt;<a class="code" href="classoomph_1_1FiniteElement.html#a6fc14cbf4e1d031acbc59b415cefa1ca">get_x</a>(<a class="code" href="cfortran_8h.html#af6f0bd3dc13317f895c91323c25c2b8f">t</a>,<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,x_prev);</div>
<div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;                 </div>
<div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;          <span class="comment">// Set previous positions of the new node</span></div>
<div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;n_dim;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;          {</div>
<div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;           created_node_pt-&gt;<a class="code" href="classoomph_1_1Node.html#a056f8e82da938369cd38541c5cdc598a">x</a>(<a class="code" href="cfortran_8h.html#af6f0bd3dc13317f895c91323c25c2b8f">t</a>,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>) = x_prev[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>];</div>
<div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;          }</div>
<div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;         }</div>
<div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;               </div>
<div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;         <span class="comment">// Now set the values</span></div>
<div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;         <span class="comment">// Loop over all history values</span></div>
<div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;         <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#af6f0bd3dc13317f895c91323c25c2b8f">t</a>=0;<a class="code" href="cfortran_8h.html#af6f0bd3dc13317f895c91323c25c2b8f">t</a>&lt;ntstorage;<a class="code" href="cfortran_8h.html#af6f0bd3dc13317f895c91323c25c2b8f">t</a>++)</div>
<div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;         {</div>
<div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;          <span class="comment">// Get values from father element</span></div>
<div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;          <span class="comment">// Note: get_interpolated_values() sets Vector size itself.</span></div>
<div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;          <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> prev_values;</div>
<div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;          father_el_pt-&gt;<a class="code" href="classoomph_1_1RefineableElement.html#ad9a4f92880668a2373326d8306365c43">get_interpolated_values</a>(<a class="code" href="cfortran_8h.html#af6f0bd3dc13317f895c91323c25c2b8f">t</a>,<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,prev_values);</div>
<div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;                 </div>
<div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;          <span class="comment">//Initialise the values at the new node</span></div>
<div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;          <span class="keywordtype">unsigned</span> n_value = created_node_pt-&gt;<a class="code" href="classoomph_1_1Data.html#a7e67fc78a2e8a2fd6eb75bd292d42ff8">nvalue</a>();</div>
<div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> k=0;k&lt;n_value;k++)</div>
<div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;          {</div>
<div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;           created_node_pt-&gt;<a class="code" href="classoomph_1_1Data.html#a7289ca322725c6fd493970a19474b382">set_value</a>(<a class="code" href="cfortran_8h.html#af6f0bd3dc13317f895c91323c25c2b8f">t</a>,k,prev_values[k]);</div>
<div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;          }</div>
<div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;         }</div>
<div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160; </div>
<div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;         <span class="comment">// Add new node to mesh</span></div>
<div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;         mesh_pt-&gt;<a class="code" href="classoomph_1_1Mesh.html#ac09a9bfeb6d70d8bbefe13c86948a6fc">add_node_pt</a>(created_node_pt);</div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;               </div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;        } <span class="comment">//End of whether the node has been created by us or not</span></div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;           </div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;       } <span class="comment">// End of if node already existed in father in which case </span></div>
<div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;       <span class="comment">// everything above gets bypassed.</span></div>
<div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160; </div>
<div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;       <span class="comment">// Check if the element is an algebraic element</span></div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;       <a class="code" href="classoomph_1_1AlgebraicElementBase.html">AlgebraicElementBase</a>* alg_el_pt=</div>
<div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;        <span class="keyword">dynamic_cast&lt;</span><a class="code" href="classoomph_1_1AlgebraicElementBase.html">AlgebraicElementBase</a>*<span class="keyword">&gt;</span>(<span class="keyword">this</span>);              </div>
<div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;           </div>
<div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;       <span class="comment">// If the element is an algebraic element, setup </span></div>
<div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;       <span class="comment">// node position (past and present) from algebraic update</span></div>
<div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;       <span class="comment">// function.</span></div>
<div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;       <span class="comment">// NOTE: YES, THIS NEEDS TO BE CALLED REPEATEDLY IF THE</span></div>
<div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;       <span class="comment">// NODE IS MEMBER OF MULTIPLE ELEMENTS: THEY ALL ASSIGN</span></div>
<div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;       <span class="comment">// THE SAME NODAL POSITIONS BUT WE NEED TO ADD THE REMESH </span></div>
<div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;       <span class="comment">// INFO FOR *ALL* ROOT ELEMENTS!</span></div>
<div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;       <span class="keywordflow">if</span> (alg_el_pt!=0)</div>
<div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;       {</div>
<div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;        <span class="comment">// Build algebraic node update info for new node </span></div>
<div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;        <span class="comment">// This sets up the node update data for all node update</span></div>
<div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;        <span class="comment">// functions that are shared by all nodes in the father</span></div>
<div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;        <span class="comment">// element</span></div>
<div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;        alg_el_pt-&gt;<a class="code" href="classoomph_1_1AlgebraicElementBase.html#ab9ada27015d5cb28ae00b086ace3600f">setup_algebraic_node_update</a>(node_pt(jnod),<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,</div>
<div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;                                               father_el_pt);</div>
<div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;       }</div>
<div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;          </div>
<div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;       <span class="comment">// We have built the node and we are documenting </span></div>
<div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;       <span class="keywordflow">if</span> ((!node_done) &amp;&amp; (new_nodes_file.is_open()))</div>
<div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;       {</div>
<div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;        new_nodes_file&lt;&lt; node_pt(jnod)-&gt;x(0) &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; </div>
<div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;         node_pt(jnod)-&gt;x(1) &lt;&lt;<span class="stringliteral">&quot; &quot;</span> &lt;&lt;node_pt(jnod)-&gt;x(2)&lt;&lt;std::endl;</div>
<div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;       }</div>
<div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;           </div>
<div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;      } <span class="comment">// End of Z loop over nodes in element</span></div>
<div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160; </div>
<div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;     } <span class="comment">// End of vertical loop over nodes in element</span></div>
<div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;       </div>
<div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;    } <span class="comment">// End of horizontal loop over nodes in element</span></div>
<div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;   </div>
<div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;    <span class="comment">// If the element is a MacroElementNodeUpdateElement, set</span></div>
<div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;    <span class="comment">// the update parameters for the current element&#39;s nodes --</span></div>
<div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;    <span class="comment">// all this needs is the vector of (pointers to the) </span></div>
<div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;    <span class="comment">// geometric objects that affect the MacroElement-based</span></div>
<div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;    <span class="comment">// node update -- this is the same as that in the father element</span></div>
<div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;    <a class="code" href="classoomph_1_1MacroElementNodeUpdateElementBase.html">MacroElementNodeUpdateElementBase</a>* father_m_el_pt=<span class="keyword">dynamic_cast&lt;</span></div>
<div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;                               <a class="code" href="classoomph_1_1MacroElementNodeUpdateElementBase.html">MacroElementNodeUpdateElementBase</a>*<span class="keyword">&gt;</span>(father_el_pt);</div>
<div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;    <span class="keywordflow">if</span> (father_m_el_pt!=0)</div>
<div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;    {</div>
<div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;     <span class="comment">// Get vector of geometric objects from father (construct vector</span></div>
<div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;     <span class="comment">// via copy operation)</span></div>
<div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;     <a class="code" href="classoomph_1_1Vector.html">Vector&lt;GeomObject*&gt;</a> geom_object_pt(father_m_el_pt-&gt;<a class="code" href="classoomph_1_1MacroElementNodeUpdateElementBase.html#a45d0d15ee371799c84f59bb13cdac304">geom_object_pt</a>());</div>
<div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;       </div>
<div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;     <span class="comment">// Cast current element to MacroElementNodeUpdateElement:</span></div>
<div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;     <a class="code" href="classoomph_1_1MacroElementNodeUpdateElementBase.html">MacroElementNodeUpdateElementBase</a>* m_el_pt=<span class="keyword">dynamic_cast&lt;</span></div>
<div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;      <a class="code" href="classoomph_1_1MacroElementNodeUpdateElementBase.html">MacroElementNodeUpdateElementBase</a>*<span class="keyword">&gt;</span>(<span class="keyword">this</span>);</div>
<div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;       </div>
<div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;     <span class="keywordflow">if</span> (m_el_pt==0)</div>
<div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;     {</div>
<div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;      <a class="code" href="namespaceoomph_1_1Global__string__for__annotation.html#ac5379de2fa7fe44f2cb31785fc208135">std::string</a> error_message =</div>
<div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;       <span class="stringliteral">&quot;Failed to cast to MacroElementNodeUpdateElementBase*\n&quot;</span>;</div>
<div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;      error_message += </div>
<div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;       <span class="stringliteral">&quot;Strange -- if the father is a MacroElementNodeUpdateElement\n&quot;</span>;</div>
<div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;      error_message += <span class="stringliteral">&quot;the son should be too....\n&quot;</span>;</div>
<div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;         </div>
<div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;      <span class="keywordflow">throw</span> <a class="code" href="classoomph_1_1OomphLibError.html">OomphLibError</a>(error_message,</div>
<div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;                          OOMPH_CURRENT_FUNCTION,</div>
<div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;                          OOMPH_EXCEPTION_LOCATION);</div>
<div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;     }</div>
<div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;     <span class="comment">// Build update info by passing vector of geometric objects:</span></div>
<div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;     <span class="comment">// This sets the current element to be the update element</span></div>
<div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;     <span class="comment">// for all of the element&#39;s nodes -- this is reversed</span></div>
<div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;     <span class="comment">// if the element is ever un-refined in the father element&#39;s</span></div>
<div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;     <span class="comment">// rebuild_from_sons() function which overwrites this</span></div>
<div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;     <span class="comment">// assignment to avoid nasty segmentation faults that occur</span></div>
<div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;     <span class="comment">// when a node tries to update itself via an element that no</span></div>
<div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;     <span class="comment">// longer exists...</span></div>
<div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;     m_el_pt-&gt;<a class="code" href="classoomph_1_1MacroElementNodeUpdateElementBase.html#aa2408d8463e8cecc2ad12a93e10390b1">set_node_update_info</a>(geom_object_pt);</div>
<div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;    }</div>
<div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;     </div>
<div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;    <span class="comment">// Is the new element a halo element?</span></div>
<div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;    <span class="keywordflow">if</span> (tree_pt()-&gt;father_pt()-&gt;object_pt()-&gt;is_halo())</div>
<div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;    {</div>
<div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;     Non_halo_proc_ID=</div>
<div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;      tree_pt()-&gt;father_pt()-&gt;object_pt()-&gt;non_halo_proc_ID();</div>
<div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;    }</div>
<div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160; </div>
<div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;    <span class="comment">// Is it an ElementWithMovingNodes? </span></div>
<div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;    <a class="code" href="classoomph_1_1ElementWithMovingNodes.html">ElementWithMovingNodes</a>* aux_el_pt=</div>
<div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;     <span class="keyword">dynamic_cast&lt;</span><a class="code" href="classoomph_1_1ElementWithMovingNodes.html">ElementWithMovingNodes</a>*<span class="keyword">&gt;</span>(<span class="keyword">this</span>);</div>
<div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;     </div>
<div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;    <span class="comment">// Pass down the information re the method for the evaluation</span></div>
<div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;    <span class="comment">// of the shape derivatives</span></div>
<div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;    <span class="keywordflow">if</span> (aux_el_pt!=0)</div>
<div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;    {</div>
<div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;     <a class="code" href="classoomph_1_1ElementWithMovingNodes.html">ElementWithMovingNodes</a>* aux_father_el_pt=</div>
<div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;      <span class="keyword">dynamic_cast&lt;</span><a class="code" href="classoomph_1_1ElementWithMovingNodes.html">ElementWithMovingNodes</a>*<span class="keyword">&gt;</span>(father_el_pt);</div>
<div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160; </div>
<div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;     <span class="keywordflow">if</span> (aux_father_el_pt==0)</div>
<div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;     {</div>
<div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;      <a class="code" href="namespaceoomph_1_1Global__string__for__annotation.html#ac5379de2fa7fe44f2cb31785fc208135">std::string</a> error_message =</div>
<div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;       <span class="stringliteral">&quot;Failed to cast to ElementWithMovingNodes*\n&quot;</span>;</div>
<div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;      error_message += </div>
<div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;       <span class="stringliteral">&quot;Strange -- if the son is a ElementWithMovingNodes\n&quot;</span>;</div>
<div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;      error_message += <span class="stringliteral">&quot;the father should be too....\n&quot;</span>;</div>
<div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160; </div>
<div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;      <span class="keywordflow">throw</span> <a class="code" href="classoomph_1_1OomphLibError.html">OomphLibError</a>(error_message,</div>
<div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;                          OOMPH_CURRENT_FUNCTION,</div>
<div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;                          OOMPH_EXCEPTION_LOCATION);</div>
<div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;     }</div>
<div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;       </div>
<div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;     <span class="comment">//If evaluating the residuals by finite differences in the father</span></div>
<div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;     <span class="comment">//continue to do so in the child</span></div>
<div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;     <span class="keywordflow">if</span> (aux_father_el_pt</div>
<div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;         -&gt;are_dresidual_dnodal_coordinates_always_evaluated_by_fd())</div>
<div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;     {</div>
<div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;      aux_el_pt-&gt;</div>
<div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;       enable_always_evaluate_dresidual_dnodal_coordinates_by_fd();</div>
<div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;     }</div>
<div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160; </div>
<div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;       </div>
<div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;     aux_el_pt-&gt;<a class="code" href="classoomph_1_1ElementWithMovingNodes.html#a600d39b3c167989dd8eed5869726d35b">method_for_shape_derivs</a>()=</div>
<div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;      aux_father_el_pt-&gt;<a class="code" href="classoomph_1_1ElementWithMovingNodes.html#a600d39b3c167989dd8eed5869726d35b">method_for_shape_derivs</a>();</div>
<div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160; </div>
<div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;     <span class="comment">//If bypassing the evaluation of fill_in_jacobian_from_geometric_data</span></div>
<div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;     <span class="comment">//continue to do so</span></div>
<div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;     <span class="keywordflow">if</span> (aux_father_el_pt</div>
<div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;         -&gt;is_fill_in_jacobian_from_geometric_data_bypassed())</div>
<div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;     {</div>
<div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;      aux_el_pt-&gt;<a class="code" href="classoomph_1_1ElementWithMovingNodes.html#a580ecb70417536ceb1121afd3bea0d54">enable_bypass_fill_in_jacobian_from_geometric_data</a>();</div>
<div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;     }</div>
<div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;    }</div>
<div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160; </div>
<div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;    <span class="comment">// Now do further build (if any)</span></div>
<div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;    further_build();</div>
<div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;     </div>
<div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;   } <span class="comment">// Sanity check: Father element has been generated</span></div>
<div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;   </div>
<div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;  } <span class="comment">// End for element has not been built yet</span></div>
<div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;  {</div>
<div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;   was_already_built=<span class="keyword">true</span>;</div>
<div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;  }</div>
<div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160; }</div>
<div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160; </div>
<div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;<span class="comment">//====================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;<span class="comment">/// Set up all hanging nodes.</span></div>
<div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;<span class="comment">/// (Wrapper to avoid specification of the unwanted output file).</span></div>
<div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;<span class="comment"></span><span class="comment">//==================================================================== </span></div>
<div class="line"><a name="l02013"></a><span class="lineno"><a class="line" href="classoomph_1_1RefineableQElement_3_013_01_4.html#ab1300b5bdb62b11aeb88df3268c6ba92"> 2013</a></span>&#160; <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1RefineableQElement.html">RefineableQElement&lt;3&gt;::setup_hanging_nodes</a>(<a class="code" href="classoomph_1_1Vector.html">Vector&lt;std::ofstream*&gt;</a> </div>
<div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;                                                 &amp;output_stream)</div>
<div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160; {</div>
<div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;  <span class="keywordflow">if</span> (output_stream.size() != 6)</div>
<div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;  {</div>
<div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;   <span class="keywordflow">throw</span> <a class="code" href="classoomph_1_1OomphLibError.html">OomphLibError</a>(<span class="stringliteral">&quot;There must be six output streams&quot;</span>,</div>
<div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;                       OOMPH_CURRENT_FUNCTION,</div>
<div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;                       OOMPH_EXCEPTION_LOCATION);</div>
<div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;  }</div>
<div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160; </div>
<div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;  <span class="keyword">using namespace </span>OcTreeNames;</div>
<div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160; </div>
<div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;  <span class="comment">//Setup hanging nodes on each edge of the element</span></div>
<div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;  oc_hang_helper(-1,<a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a9d5dc3f8f9d04ae80237132101f4258f">U</a>,*(output_stream[0]));</div>
<div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;  oc_hang_helper(-1,<a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a51292b8e4d96f2bb9f0d6bb0340d1620">D</a>,*(output_stream[1]));</div>
<div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;  oc_hang_helper(-1,<a class="code" href="namespaceoomph_1_1BinaryTreeNames.html#a7ff5e7e46beae31bf81579531b1f9895a8df863dabb4096fa066f7a6dbf7502d1">L</a>,*(output_stream[2]));</div>
<div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;  oc_hang_helper(-1,<a class="code" href="namespaceoomph_1_1BinaryTreeNames.html#a7ff5e7e46beae31bf81579531b1f9895a1bf47d3f36e6272d94344ae84aca2498">R</a>,*(output_stream[3]));</div>
<div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;  oc_hang_helper(-1,<a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a43c804e2bcf9862a4bf629d5f01761e8">B</a>,*(output_stream[4]));</div>
<div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;  oc_hang_helper(-1,<a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a755807a4724a0f4d96f0817559c0a927">F</a>,*(output_stream[5]));</div>
<div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160; }</div>
<div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160; </div>
<div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;<span class="comment">//================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;<span class="comment">/// Internal function that sets up the hanging node scheme for a </span></div>
<div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;<span class="comment">/// particular value</span></div>
<div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;<span class="comment"></span><span class="comment">//=================================================================</span></div>
<div class="line"><a name="l02040"></a><span class="lineno"><a class="line" href="classoomph_1_1RefineableQElement_3_013_01_4.html#a3d38b1cfacb055140a330e3d251b601f"> 2040</a></span>&#160; <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1RefineableQElement.html">RefineableQElement&lt;3&gt;::setup_hang_for_value</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> &amp;value_id)</div>
<div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160; {</div>
<div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;  <span class="keyword">using namespace </span>OcTreeNames;</div>
<div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160; </div>
<div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;  std::ofstream dummy_hangfile;</div>
<div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;  <span class="comment">//Setup hanging nodes on each edge of the element</span></div>
<div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;  oc_hang_helper(value_id,<a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a9d5dc3f8f9d04ae80237132101f4258f">U</a>,dummy_hangfile);</div>
<div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;  oc_hang_helper(value_id,<a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a51292b8e4d96f2bb9f0d6bb0340d1620">D</a>,dummy_hangfile);</div>
<div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;  oc_hang_helper(value_id,<a class="code" href="namespaceoomph_1_1BinaryTreeNames.html#a7ff5e7e46beae31bf81579531b1f9895a1bf47d3f36e6272d94344ae84aca2498">R</a>,dummy_hangfile);</div>
<div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;  oc_hang_helper(value_id,<a class="code" href="namespaceoomph_1_1BinaryTreeNames.html#a7ff5e7e46beae31bf81579531b1f9895a8df863dabb4096fa066f7a6dbf7502d1">L</a>,dummy_hangfile);</div>
<div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;  oc_hang_helper(value_id,<a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a43c804e2bcf9862a4bf629d5f01761e8">B</a>,dummy_hangfile);</div>
<div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;  oc_hang_helper(value_id,<a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a755807a4724a0f4d96f0817559c0a927">F</a>,dummy_hangfile);</div>
<div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160; }</div>
<div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160; </div>
<div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;<span class="comment">//=================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;<span class="comment">/// Internal function to set up the hanging nodes on a particular</span></div>
<div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;<span class="comment">/// face of the element</span></div>
<div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;<span class="comment"></span><span class="comment">//=================================================================</span></div>
<div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160; <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1RefineableQElement.html">RefineableQElement&lt;3&gt;::</a></div>
<div class="line"><a name="l02059"></a><span class="lineno"><a class="line" href="classoomph_1_1RefineableQElement_3_013_01_4.html#abde04c6b8616bd2551b24ac1abade563"> 2059</a></span>&#160;<a class="code" href="classoomph_1_1RefineableQElement.html"> oc_hang_helper</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> &amp;value_id, </div>
<div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;                <span class="keyword">const</span> <span class="keywordtype">int</span> &amp;my_face, std::ofstream&amp; output_hangfile)</div>
<div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160; {</div>
<div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;  <span class="keyword">using namespace </span>OcTreeNames;</div>
<div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160; </div>
<div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;  <span class="comment">// Number of dimensions</span></div>
<div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;  <span class="keywordtype">unsigned</span> n_dim=3;</div>
<div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;  </div>
<div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;  <a class="code" href="classoomph_1_1Vector.html">Vector&lt;unsigned&gt;</a> translate_s(n_dim);</div>
<div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;  <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> s_lo_neigh(n_dim);</div>
<div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;  <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> s_hi_neigh(n_dim);</div>
<div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;  <span class="keywordtype">int</span> neigh_face;</div>
<div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;  <span class="keywordtype">int</span> diff_level;</div>
<div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;  <span class="keywordtype">bool</span> in_neighbouring_tree;</div>
<div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160; </div>
<div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;  <span class="comment">// Find pointer to neighbour in this direction</span></div>
<div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;  <a class="code" href="classoomph_1_1OcTree.html">OcTree</a>* neigh_pt;</div>
<div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;  neigh_pt=octree_pt()-&gt;</div>
<div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;   gteq_face_neighbour(my_face, translate_s, s_lo_neigh, </div>
<div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;                       s_hi_neigh,neigh_face,diff_level,</div>
<div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;                       in_neighbouring_tree);</div>
<div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160; </div>
<div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;  <span class="comment">// Neighbour exists</span></div>
<div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;  <span class="keywordflow">if</span> (neigh_pt!=0)</div>
<div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;  {</div>
<div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;   <span class="comment">// Different sized element?</span></div>
<div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;   <span class="keywordflow">if</span> (diff_level!=0)</div>
<div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;   {</div>
<div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;    <span class="comment">//Test for the periodic node case</span></div>
<div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;    <span class="comment">//Are we crossing a periodic boundary</span></div>
<div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;    <span class="keywordtype">bool</span> is_periodic = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;    <span class="keywordflow">if</span> (in_neighbouring_tree)</div>
<div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;    {</div>
<div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;     is_periodic=tree_pt()-&gt;root_pt()-&gt;is_neighbour_periodic(my_face);</div>
<div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;    }</div>
<div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;     </div>
<div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;    <span class="comment">//If it is periodic we actually need to get the node in</span></div>
<div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;    <span class="comment">//the neighbour of the neighbour (which will be a parent of</span></div>
<div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;    <span class="comment">//the present element) so that the &quot;fixed&quot; coordinate is</span></div>
<div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;    <span class="comment">//correctly calculated.</span></div>
<div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;    <span class="comment">//The idea is to replace the neigh_pt and associated data</span></div>
<div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;    <span class="comment">//with those of the neighbour of the neighbour</span></div>
<div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;    <span class="keywordflow">if</span> (is_periodic)</div>
<div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;    {</div>
<div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;     <span class="comment">//Required data for the neighbour finding routine</span></div>
<div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;     <a class="code" href="classoomph_1_1Vector.html">Vector&lt;unsigned&gt;</a> translate_s_in_neigh(n_dim,0.0);</div>
<div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;     <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> s_lo_neigh_of_neigh(n_dim,0.0);</div>
<div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;     <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> s_hi_neigh_of_neigh(n_dim,0.0);</div>
<div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;     <span class="keywordtype">int</span> neigh_face_of_neigh;</div>
<div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;     <span class="keywordtype">int</span> diff_level_of_neigh;</div>
<div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;     <span class="keywordtype">bool</span> in_neighbouring_tree_of_neigh;</div>
<div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;       </div>
<div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;     <span class="comment">// Find pointer to neighbour of the neighbour on the edge</span></div>
<div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;     <span class="comment">// that we are currently considering</span></div>
<div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;     <a class="code" href="classoomph_1_1OcTree.html">OcTree</a>* neigh_of_neigh_pt;</div>
<div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;     neigh_of_neigh_pt = neigh_pt-&gt;</div>
<div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;      gteq_face_neighbour(neigh_face, translate_s_in_neigh, </div>
<div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;                          s_lo_neigh_of_neigh, </div>
<div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;                          s_hi_neigh_of_neigh,</div>
<div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;                          neigh_face_of_neigh,</div>
<div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;                          diff_level_of_neigh,</div>
<div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;                          in_neighbouring_tree_of_neigh);</div>
<div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160; </div>
<div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;     <span class="comment">//Set the value of the NEW neighbour and edge</span></div>
<div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;     neigh_pt = neigh_of_neigh_pt;</div>
<div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;     neigh_face = neigh_face_of_neigh;</div>
<div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160; </div>
<div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;     <span class="comment">//Set the values of the translation schemes</span></div>
<div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;     <span class="comment">//Need to find the values of s_lo and s_hi</span></div>
<div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;     <span class="comment">//in the neighbour of the neighbour</span></div>
<div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160; </div>
<div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;     <span class="comment">//Get the minimum and maximum values of the coordinate</span></div>
<div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;     <span class="comment">//in the neighbour (don&#39;t like this, but I think it&#39;s</span></div>
<div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;     <span class="comment">//necessary) Note that these values are hardcoded</span></div>
<div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;     <span class="comment">//in the quadtrees at some point!!</span></div>
<div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;     <span class="keywordtype">double</span> s_min = neigh_pt-&gt;<a class="code" href="classoomph_1_1Tree.html#a2f2eeb0f1dd161f696cccc652974ff4c">object_pt</a>()-&gt;<a class="code" href="classoomph_1_1FiniteElement.html#a35f0803115b68bd162c07de04eeb6c5c">s_min</a>();</div>
<div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;     <span class="keywordtype">double</span> s_max = neigh_pt-&gt;<a class="code" href="classoomph_1_1Tree.html#a2f2eeb0f1dd161f696cccc652974ff4c">object_pt</a>()-&gt;<a class="code" href="classoomph_1_1FiniteElement.html#a64adbe9356927133686ab53f00341ea8">s_max</a>();</div>
<div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;     <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> s_lo_frac(n_dim), s_hi_frac(n_dim);</div>
<div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;     <span class="comment">//Work out the fractional position of the low and high points</span></div>
<div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;     <span class="comment">//of the original element</span></div>
<div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;n_dim;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;     {</div>
<div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;      s_lo_frac[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] = (s_lo_neigh[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] - s_min)/(s_max - s_min);</div>
<div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;      s_hi_frac[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] = (s_hi_neigh[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] - s_min)/(s_max - s_min);</div>
<div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;     }</div>
<div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;       </div>
<div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;     <span class="comment">//We should now be able to construct the low and high points in </span></div>
<div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;     <span class="comment">//the neighbour of the neighbour</span></div>
<div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;n_dim;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;     {</div>
<div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;      s_lo_neigh[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] = s_lo_neigh_of_neigh[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] </div>
<div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;       + s_lo_frac[translate_s_in_neigh[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]]*</div>
<div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;       (s_hi_neigh_of_neigh[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] - s_lo_neigh_of_neigh[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]);</div>
<div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;      s_hi_neigh[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] = s_lo_neigh_of_neigh[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] </div>
<div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;       + s_hi_frac[translate_s_in_neigh[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]]*</div>
<div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;       (s_hi_neigh_of_neigh[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] - s_lo_neigh_of_neigh[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]);</div>
<div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;     }</div>
<div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160; </div>
<div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;     <span class="comment">//Finally we must sort out the translation scheme</span></div>
<div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;     <a class="code" href="classoomph_1_1Vector.html">Vector&lt;unsigned&gt;</a> temp_translate(n_dim,0.0);</div>
<div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;n_dim;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;     {</div>
<div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;      temp_translate[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] = translate_s_in_neigh[translate_s[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]];</div>
<div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;     }</div>
<div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;n_dim;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;     {</div>
<div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;      translate_s[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] = temp_translate[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>];</div>
<div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;     }</div>
<div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;    } <span class="comment">//End of special treatment for periodic hanging nodes</span></div>
<div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160; </div>
<div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;    <span class="comment">//Number of nodes in one dimension</span></div>
<div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;    <span class="keywordtype">unsigned</span> n_p = ninterpolating_node_1d(value_id);</div>
<div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;    <span class="comment">//Storage for the local nodes along the face of the element</span></div>
<div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;    <a class="code" href="classoomph_1_1Node.html">Node</a>* local_node_pt=0;</div>
<div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160; </div>
<div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;    <span class="comment">// Loop over nodes along the face</span></div>
<div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i0=0;i0&lt;n_p;i0++)</div>
<div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;    {</div>
<div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i1=0;i1&lt;n_p;i1++)</div>
<div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;     {</div>
<div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;      <span class="comment">//Storage for the fractional position of the node in the element</span></div>
<div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;      <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> s_fraction(n_dim);</div>
<div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160; </div>
<div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;      <span class="comment">// Local node number</span></div>
<div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;      <span class="keywordflow">switch</span>(my_face)</div>
<div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;      {</div>
<div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a9d5dc3f8f9d04ae80237132101f4258f">U</a>:</div>
<div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;       s_fraction[0] = </div>
<div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;        local_one_d_fraction_of_interpolating_node(i0,0,value_id);</div>
<div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;       s_fraction[1] = 1.0;</div>
<div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;       s_fraction[2] = </div>
<div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;        local_one_d_fraction_of_interpolating_node(i1,2,value_id);</div>
<div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;       local_node_pt = </div>
<div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;        interpolating_node_pt(i0 +(n_p-1)*n_p + n_p*n_p*i1,value_id);</div>
<div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;       <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160; </div>
<div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a51292b8e4d96f2bb9f0d6bb0340d1620">D</a>:</div>
<div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;       s_fraction[0] = </div>
<div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;        local_one_d_fraction_of_interpolating_node(i0,0,value_id);</div>
<div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;       s_fraction[1] = 0.0;</div>
<div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;       s_fraction[2] = </div>
<div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;        local_one_d_fraction_of_interpolating_node(i1,2,value_id);</div>
<div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;       local_node_pt = </div>
<div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;        interpolating_node_pt(i0+n_p*n_p*i1,value_id);</div>
<div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;       <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160; </div>
<div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="namespaceoomph_1_1BinaryTreeNames.html#a7ff5e7e46beae31bf81579531b1f9895a1bf47d3f36e6272d94344ae84aca2498">R</a>:</div>
<div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;       s_fraction[0] = 1.0;</div>
<div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;       s_fraction[1] = </div>
<div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;        local_one_d_fraction_of_interpolating_node(i0,1,value_id);</div>
<div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;       s_fraction[2] = </div>
<div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;        local_one_d_fraction_of_interpolating_node(i1,2,value_id);</div>
<div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;       local_node_pt =</div>
<div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;        interpolating_node_pt(n_p-1 + i0*n_p + i1*n_p*n_p,value_id);</div>
<div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;       <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160; </div>
<div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="namespaceoomph_1_1BinaryTreeNames.html#a7ff5e7e46beae31bf81579531b1f9895a8df863dabb4096fa066f7a6dbf7502d1">L</a>:</div>
<div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;       s_fraction[0] = 0.0;</div>
<div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;       s_fraction[1] = </div>
<div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;        local_one_d_fraction_of_interpolating_node(i0,1,value_id);</div>
<div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;       s_fraction[2] = </div>
<div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;        local_one_d_fraction_of_interpolating_node(i1,2,value_id);</div>
<div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;       local_node_pt = </div>
<div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;        interpolating_node_pt(n_p*i0 + i1*n_p*n_p,value_id);</div>
<div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;       <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160; </div>
<div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a43c804e2bcf9862a4bf629d5f01761e8">B</a>:</div>
<div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;       s_fraction[0] = </div>
<div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;        local_one_d_fraction_of_interpolating_node(i0,0,value_id);</div>
<div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;       s_fraction[1] = </div>
<div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;        local_one_d_fraction_of_interpolating_node(i1,1,value_id);</div>
<div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;       s_fraction[2] = 0.0;</div>
<div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;       local_node_pt = </div>
<div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160;        interpolating_node_pt(i0 + i1*n_p,value_id);</div>
<div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160;       <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160; </div>
<div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a755807a4724a0f4d96f0817559c0a927">F</a>:</div>
<div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;       s_fraction[0] = </div>
<div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;        local_one_d_fraction_of_interpolating_node(i0,0,value_id);</div>
<div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;       s_fraction[1] = </div>
<div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;        local_one_d_fraction_of_interpolating_node(i1,1,value_id);</div>
<div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;       s_fraction[2] = 1.0;</div>
<div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;       local_node_pt = </div>
<div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;        interpolating_node_pt(i0 + i1*n_p + (n_p-1)*n_p*n_p,value_id);</div>
<div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;       <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160; </div>
<div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;      <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;       <span class="keywordflow">throw</span> <a class="code" href="classoomph_1_1OomphLibError.html">OomphLibError</a>(<span class="stringliteral">&quot;my_face not U, D, L, R, B, F\n&quot;</span>,</div>
<div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;                           OOMPH_CURRENT_FUNCTION,</div>
<div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;                           OOMPH_EXCEPTION_LOCATION);</div>
<div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;      }</div>
<div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160; </div>
<div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;      <span class="comment">//Set up the coordinate in the neighbour</span></div>
<div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;      <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> s_in_neighb(n_dim);</div>
<div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;n_dim;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;      {</div>
<div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;       s_in_neighb[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] = s_lo_neigh[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] + s_fraction[translate_s[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]]*</div>
<div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;        (s_hi_neigh[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] - s_lo_neigh[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]);</div>
<div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;      }</div>
<div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160; </div>
<div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;      <span class="comment">//Find the Node in the neighbouring element</span></div>
<div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;      <a class="code" href="classoomph_1_1Node.html">Node</a>* neighbouring_node_pt = neigh_pt-&gt;<a class="code" href="classoomph_1_1Tree.html#a2f2eeb0f1dd161f696cccc652974ff4c">object_pt</a>()-&gt;</div>
<div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160;       get_interpolating_node_at_local_coordinate(s_in_neighb,value_id);</div>
<div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160;         </div>
<div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160;      <span class="comment">//If the neighbour does not have a node at this point</span></div>
<div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160;      <span class="keywordflow">if</span> (0==neighbouring_node_pt)</div>
<div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160;      {</div>
<div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160;       <span class="comment">//Do we need to make a hanging node, we assume that we don&#39;t </span></div>
<div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160;       <span class="comment">//initially</span></div>
<div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160;       <span class="keywordtype">bool</span> make_hanging_node = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160;           </div>
<div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160;       <span class="comment">//If the node is not hanging geometrically, then we must make it </span></div>
<div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;       <span class="comment">//hang</span></div>
<div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;       <span class="keywordflow">if</span> (!local_node_pt-&gt;<a class="code" href="classoomph_1_1Node.html#af0e6237dfafad62cf427ff5013ddcfef">is_hanging</a>())</div>
<div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;       {</div>
<div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160;        make_hanging_node = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;       }</div>
<div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160;       <span class="comment">//Otherwise is could be hanging geometrically, but still require</span></div>
<div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160;       <span class="comment">//a different hanging scheme for this data value</span></div>
<div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160;       <span class="keywordflow">else</span></div>
<div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;       {</div>
<div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;        <span class="keywordflow">if</span> ((value_id!=-1) &amp;&amp; (local_node_pt-&gt;<a class="code" href="classoomph_1_1Node.html#ab7b94371e9a8b62fe9a5cc7a03113ad9">hanging_pt</a>(value_id)==</div>
<div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160;                               local_node_pt-&gt;<a class="code" href="classoomph_1_1Node.html#ab7b94371e9a8b62fe9a5cc7a03113ad9">hanging_pt</a>()))</div>
<div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160;        {</div>
<div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;         make_hanging_node = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160;        }</div>
<div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160;       }</div>
<div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160; </div>
<div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160;       <span class="keywordflow">if</span> (make_hanging_node == <span class="keyword">true</span>)</div>
<div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160;       {</div>
<div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;        <span class="comment">//Cache refineable element used here</span></div>
<div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160;        <a class="code" href="classoomph_1_1RefineableElement.html">RefineableElement</a>* <span class="keyword">const</span> obj_pt = neigh_pt-&gt;<a class="code" href="classoomph_1_1Tree.html#a2f2eeb0f1dd161f696cccc652974ff4c">object_pt</a>();</div>
<div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160; </div>
<div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160;        <span class="comment">//Get shape functions in neighbour element</span></div>
<div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160;        <a class="code" href="classoomph_1_1Shape.html">Shape</a> psi(obj_pt-&gt;<a class="code" href="classoomph_1_1RefineableElement.html#a8b1b5031b55141567ba24913a21534f4">ninterpolating_node</a>(value_id));</div>
<div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;        obj_pt-&gt;<a class="code" href="classoomph_1_1RefineableElement.html#a8ca420443c28708e5c6315a80f520137">interpolating_basis</a>(s_in_neighb,psi,value_id);</div>
<div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160;             </div>
<div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160;        <span class="comment">//Allocate the storage for the Hang pointer</span></div>
<div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;        <span class="comment">//We know that it will hold n_p*n_p nodes</span></div>
<div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;        <a class="code" href="classoomph_1_1HangInfo.html">HangInfo</a> *hang_pt = <span class="keyword">new</span> <a class="code" href="classoomph_1_1HangInfo.html">HangInfo</a>(n_p*n_p);</div>
<div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;             </div>
<div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;        <span class="comment">// Loop over nodes on edge in neighbour and mark them as nodes</span></div>
<div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160;        <span class="comment">// that this node depends on</span></div>
<div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;        <span class="keywordtype">unsigned</span> n_neighbour;</div>
<div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;             </div>
<div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;        <span class="comment">// Number of nodes along edge in neighbour element</span></div>
<div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> ii0=0;ii0&lt;n_p;ii0++)</div>
<div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;        {</div>
<div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160;         <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> ii1=0;ii1&lt;n_p;ii1++)</div>
<div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;         {</div>
<div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160;          <span class="keywordflow">switch</span>(neigh_face)</div>
<div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160;          {</div>
<div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160;          <span class="keywordflow">case</span> <a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a9d5dc3f8f9d04ae80237132101f4258f">U</a>:</div>
<div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160;           n_neighbour = ii0+ n_p*(n_p-1) + ii1*n_p*n_p;</div>
<div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160;           <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160;                   </div>
<div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160;          <span class="keywordflow">case</span> <a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a51292b8e4d96f2bb9f0d6bb0340d1620">D</a>:</div>
<div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160;           n_neighbour = ii0 + ii1*n_p*n_p;</div>
<div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160;           <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160;               </div>
<div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160;          <span class="keywordflow">case</span> <a class="code" href="namespaceoomph_1_1BinaryTreeNames.html#a7ff5e7e46beae31bf81579531b1f9895a8df863dabb4096fa066f7a6dbf7502d1">L</a>:</div>
<div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160;           n_neighbour = ii0*n_p + ii1*n_p*n_p;</div>
<div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160;           <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160;                   </div>
<div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160;          <span class="keywordflow">case</span> <a class="code" href="namespaceoomph_1_1BinaryTreeNames.html#a7ff5e7e46beae31bf81579531b1f9895a1bf47d3f36e6272d94344ae84aca2498">R</a>:</div>
<div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160;           n_neighbour = (n_p-1) + ii0*n_p + ii1*n_p*n_p;</div>
<div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;           <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;                  </div>
<div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160;          <span class="keywordflow">case</span> <a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a43c804e2bcf9862a4bf629d5f01761e8">B</a>:</div>
<div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160;           n_neighbour = ii0 +ii1*n_p;</div>
<div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160;           <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;                   </div>
<div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160;          <span class="keywordflow">case</span> <a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a755807a4724a0f4d96f0817559c0a927">F</a>:</div>
<div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160;           n_neighbour = ii0 + ii1*n_p + n_p*n_p*(n_p-1);</div>
<div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160;           <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160;          <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160;           <span class="keywordflow">throw</span> <a class="code" href="classoomph_1_1OomphLibError.html">OomphLibError</a>(</div>
<div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160;            <span class="stringliteral">&quot;neigh_face not U, L, R, B, F\n&quot;</span>,</div>
<div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160;            OOMPH_CURRENT_FUNCTION,</div>
<div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;            OOMPH_EXCEPTION_LOCATION);</div>
<div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160;          }</div>
<div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160;                 </div>
<div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160;          <span class="comment">// Push back neighbouring node and weight into </span></div>
<div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160;          <span class="comment">// Vector of (pointers to) </span></div>
<div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160;          <span class="comment">// master nodes and weights</span></div>
<div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160;          <span class="comment">// The weight is merely the value of the shape function </span></div>
<div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160;          <span class="comment">// corresponding to the node in the neighbour</span></div>
<div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160;          hang_pt-&gt;</div>
<div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160;           set_master_node_pt(ii0*n_p + ii1,</div>
<div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160;                              obj_pt-&gt;<a class="code" href="classoomph_1_1RefineableElement.html#ab27986fc2f6033a4758662cde78a7b76">interpolating_node_pt</a>(n_neighbour,</div>
<div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160;                                                            value_id),</div>
<div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160;                              psi[n_neighbour]);</div>
<div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160;         }</div>
<div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160;        }</div>
<div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160;        <span class="comment">//Now set the hanging data for the position</span></div>
<div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160;        <span class="comment">//This also constrains the data values associated with the</span></div>
<div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160;        <span class="comment">//value id</span></div>
<div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;        local_node_pt-&gt;<a class="code" href="classoomph_1_1Node.html#a98b3e63390c43196db9429f32319b0ca">set_hanging_pt</a>(hang_pt,value_id);</div>
<div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;       }</div>
<div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160;                 </div>
<div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160;       <span class="keywordflow">if</span> (output_hangfile.is_open()) </div>
<div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160;       {</div>
<div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160;        <span class="comment">//output_hangfile</span></div>
<div class="line"><a name="l02362"></a><span class="lineno"> 2362</span>&#160;        output_hangfile &lt;&lt; local_node_pt-&gt;<a class="code" href="classoomph_1_1Node.html#a056f8e82da938369cd38541c5cdc598a">x</a>(0) &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; </div>
<div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160;         local_node_pt-&gt;<a class="code" href="classoomph_1_1Node.html#a056f8e82da938369cd38541c5cdc598a">x</a>(1) &lt;&lt;<span class="stringliteral">&quot; &quot;</span>&lt;&lt; local_node_pt-&gt;<a class="code" href="classoomph_1_1Node.html#a056f8e82da938369cd38541c5cdc598a">x</a>(2) &lt;&lt; std::endl; </div>
<div class="line"><a name="l02364"></a><span class="lineno"> 2364</span>&#160;       } </div>
<div class="line"><a name="l02365"></a><span class="lineno"> 2365</span>&#160;      }</div>
<div class="line"><a name="l02366"></a><span class="lineno"> 2366</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160;      {</div>
<div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160;       <span class="keywordflow">if</span> (local_node_pt!=neighbouring_node_pt)</div>
<div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160;       {</div>
<div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160;        std::ofstream reportage(<span class="stringliteral">&quot;dodgy.dat&quot;</span>,std::ios_base::app);</div>
<div class="line"><a name="l02372"></a><span class="lineno"> 2372</span>&#160;        reportage &lt;&lt; local_node_pt-&gt;<a class="code" href="classoomph_1_1Node.html#a056f8e82da938369cd38541c5cdc598a">x</a>(0) &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160;                  &lt;&lt; local_node_pt-&gt;<a class="code" href="classoomph_1_1Node.html#a056f8e82da938369cd38541c5cdc598a">x</a>(1) &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160;                  &lt;&lt; local_node_pt-&gt;<a class="code" href="classoomph_1_1Node.html#a056f8e82da938369cd38541c5cdc598a">x</a>(2) &lt;&lt; std::endl;</div>
<div class="line"><a name="l02375"></a><span class="lineno"> 2375</span>&#160;        reportage.close();</div>
<div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160; </div>
<div class="line"><a name="l02377"></a><span class="lineno"> 2377</span>&#160;        std::ostringstream warning_stream;</div>
<div class="line"><a name="l02378"></a><span class="lineno"> 2378</span>&#160;        warning_stream &lt;&lt; <span class="stringliteral">&quot;SANITY CHECK in oc_hang_helper      \n&quot;</span></div>
<div class="line"><a name="l02379"></a><span class="lineno"> 2379</span>&#160;                       &lt;&lt; <span class="stringliteral">&quot;Current node      &quot;</span> &lt;&lt; local_node_pt </div>
<div class="line"><a name="l02380"></a><span class="lineno"> 2380</span>&#160;                       &lt;&lt; <span class="stringliteral">&quot; at &quot;</span> </div>
<div class="line"><a name="l02381"></a><span class="lineno"> 2381</span>&#160;                       &lt;&lt; <span class="stringliteral">&quot;(&quot;</span> &lt;&lt; local_node_pt-&gt;<a class="code" href="classoomph_1_1Node.html#a056f8e82da938369cd38541c5cdc598a">x</a>(0) &lt;&lt; <span class="stringliteral">&quot;, &quot;</span></div>
<div class="line"><a name="l02382"></a><span class="lineno"> 2382</span>&#160;                       &lt;&lt; local_node_pt-&gt;<a class="code" href="classoomph_1_1Node.html#a056f8e82da938369cd38541c5cdc598a">x</a>(1) &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> </div>
<div class="line"><a name="l02383"></a><span class="lineno"> 2383</span>&#160;                       &lt;&lt; local_node_pt-&gt;<a class="code" href="classoomph_1_1Node.html#a056f8e82da938369cd38541c5cdc598a">x</a>(2) &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> &lt;&lt; std::endl </div>
<div class="line"><a name="l02384"></a><span class="lineno"> 2384</span>&#160;                       &lt;&lt; <span class="stringliteral">&quot; is not hanging and has &quot;</span> &lt;&lt; std::endl</div>
<div class="line"><a name="l02385"></a><span class="lineno"> 2385</span>&#160;                       &lt;&lt; <span class="stringliteral">&quot;Neighbour&#39;s node  &quot;</span> &lt;&lt; neighbouring_node_pt </div>
<div class="line"><a name="l02386"></a><span class="lineno"> 2386</span>&#160;                       &lt;&lt; <span class="stringliteral">&quot; at &quot;</span> </div>
<div class="line"><a name="l02387"></a><span class="lineno"> 2387</span>&#160;                       &lt;&lt; <span class="stringliteral">&quot;(&quot;</span> &lt;&lt; neighbouring_node_pt-&gt;<a class="code" href="classoomph_1_1Node.html#a056f8e82da938369cd38541c5cdc598a">x</a>(0) &lt;&lt; <span class="stringliteral">&quot;, &quot;</span></div>
<div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160;                       &lt;&lt; neighbouring_node_pt-&gt;<a class="code" href="classoomph_1_1Node.html#a056f8e82da938369cd38541c5cdc598a">x</a>(1) &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> </div>
<div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160;                       &lt;&lt; neighbouring_node_pt-&gt;<a class="code" href="classoomph_1_1Node.html#a056f8e82da938369cd38541c5cdc598a">x</a>(2) &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> </div>
<div class="line"><a name="l02390"></a><span class="lineno"> 2390</span>&#160;                       &lt;&lt; std::endl </div>
<div class="line"><a name="l02391"></a><span class="lineno"> 2391</span>&#160;                       &lt;&lt; <span class="stringliteral">&quot;even though the two should be &quot;</span></div>
<div class="line"><a name="l02392"></a><span class="lineno"> 2392</span>&#160;                       &lt;&lt; <span class="stringliteral">&quot;identical&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l02393"></a><span class="lineno"> 2393</span>&#160;        <a class="code" href="classoomph_1_1OomphLibWarning.html">OomphLibWarning</a>(warning_stream.str(),</div>
<div class="line"><a name="l02394"></a><span class="lineno"> 2394</span>&#160;                        OOMPH_CURRENT_FUNCTION,</div>
<div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160;                        OOMPH_EXCEPTION_LOCATION);</div>
<div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160;       }</div>
<div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160;      }</div>
<div class="line"><a name="l02399"></a><span class="lineno"> 2399</span>&#160;         </div>
<div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160;      <span class="comment">//If we are doing the position then</span></div>
<div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160;      <span class="keywordflow">if</span> (value_id==-1)</div>
<div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160;      {</div>
<div class="line"><a name="l02403"></a><span class="lineno"> 2403</span>&#160;           </div>
<div class="line"><a name="l02404"></a><span class="lineno"> 2404</span>&#160;       <span class="comment">// Get the nodal position from neighbour element</span></div>
<div class="line"><a name="l02405"></a><span class="lineno"> 2405</span>&#160;       <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> x_in_neighb(n_dim);</div>
<div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160;       neigh_pt-&gt;<a class="code" href="classoomph_1_1Tree.html#a2f2eeb0f1dd161f696cccc652974ff4c">object_pt</a>()-&gt;<a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>(s_in_neighb,x_in_neighb);</div>
<div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160;           </div>
<div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160;       <span class="comment">// Fine adjust the coordinates (macro map will pick up boundary</span></div>
<div class="line"><a name="l02409"></a><span class="lineno"> 2409</span>&#160;       <span class="comment">// accurately but will lead to different element edges)</span></div>
<div class="line"><a name="l02410"></a><span class="lineno"> 2410</span>&#160;       local_node_pt-&gt;<a class="code" href="classoomph_1_1Node.html#a056f8e82da938369cd38541c5cdc598a">x</a>(0)=x_in_neighb[0];</div>
<div class="line"><a name="l02411"></a><span class="lineno"> 2411</span>&#160;       local_node_pt-&gt;<a class="code" href="classoomph_1_1Node.html#a056f8e82da938369cd38541c5cdc598a">x</a>(1)=x_in_neighb[1];</div>
<div class="line"><a name="l02412"></a><span class="lineno"> 2412</span>&#160;       local_node_pt-&gt;<a class="code" href="classoomph_1_1Node.html#a056f8e82da938369cd38541c5cdc598a">x</a>(2)=x_in_neighb[2];</div>
<div class="line"><a name="l02413"></a><span class="lineno"> 2413</span>&#160;      }</div>
<div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160;     }</div>
<div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160;    }</div>
<div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160;   }</div>
<div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160;  }</div>
<div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160; }</div>
<div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160; </div>
<div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160; </div>
<div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160; </div>
<div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160;<span class="comment">//=================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160;<span class="comment">/// Check inter-element continuity of </span></div>
<div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160;<span class="comment">/// - nodal positions</span></div>
<div class="line"><a name="l02425"></a><span class="lineno"> 2425</span>&#160;<span class="comment">/// - (nodally) interpolated function values</span></div>
<div class="line"><a name="l02426"></a><span class="lineno"> 2426</span>&#160;<span class="comment"></span><span class="comment">//==================================================================== </span></div>
<div class="line"><a name="l02427"></a><span class="lineno"><a class="line" href="classoomph_1_1RefineableQElement_3_013_01_4.html#ac956bd05c434861ba65b0431024c1072"> 2427</a></span>&#160; <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1RefineableQElement.html">RefineableQElement&lt;3&gt;::check_integrity</a>(<span class="keywordtype">double</span>&amp; max_error)</div>
<div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160; {</div>
<div class="line"><a name="l02429"></a><span class="lineno"> 2429</span>&#160; </div>
<div class="line"><a name="l02430"></a><span class="lineno"> 2430</span>&#160;  <span class="keyword">using namespace </span>OcTreeNames;</div>
<div class="line"><a name="l02431"></a><span class="lineno"> 2431</span>&#160; </div>
<div class="line"><a name="l02432"></a><span class="lineno"> 2432</span>&#160;  <span class="comment">//std::ofstream error_file(&quot;errors.dat&quot;);</span></div>
<div class="line"><a name="l02433"></a><span class="lineno"> 2433</span>&#160; </div>
<div class="line"><a name="l02434"></a><span class="lineno"> 2434</span>&#160;  <span class="comment">// Number of nodes along edge</span></div>
<div class="line"><a name="l02435"></a><span class="lineno"> 2435</span>&#160;  <span class="keywordtype">unsigned</span> n_p=nnode_1d();</div>
<div class="line"><a name="l02436"></a><span class="lineno"> 2436</span>&#160; </div>
<div class="line"><a name="l02437"></a><span class="lineno"> 2437</span>&#160;  <span class="comment">// Number of timesteps (incl. present) for which continuity is </span></div>
<div class="line"><a name="l02438"></a><span class="lineno"> 2438</span>&#160;  <span class="comment">// to be checked.</span></div>
<div class="line"><a name="l02439"></a><span class="lineno"> 2439</span>&#160;  <span class="keywordtype">unsigned</span> n_time=1;</div>
<div class="line"><a name="l02440"></a><span class="lineno"> 2440</span>&#160; </div>
<div class="line"><a name="l02441"></a><span class="lineno"> 2441</span>&#160;  <span class="comment">// Initialise errors</span></div>
<div class="line"><a name="l02442"></a><span class="lineno"> 2442</span>&#160;  max_error=0.0;</div>
<div class="line"><a name="l02443"></a><span class="lineno"> 2443</span>&#160;  <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> max_error_x(3,0.0);</div>
<div class="line"><a name="l02444"></a><span class="lineno"> 2444</span>&#160;  <span class="keywordtype">double</span> max_error_val=0.0;</div>
<div class="line"><a name="l02445"></a><span class="lineno"> 2445</span>&#160; </div>
<div class="line"><a name="l02446"></a><span class="lineno"> 2446</span>&#160;  <span class="comment">//Set the faces</span></div>
<div class="line"><a name="l02447"></a><span class="lineno"> 2447</span>&#160;  <a class="code" href="classoomph_1_1Vector.html">Vector&lt;int&gt;</a> faces(6);</div>
<div class="line"><a name="l02448"></a><span class="lineno"> 2448</span>&#160;  faces[0] = <a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a51292b8e4d96f2bb9f0d6bb0340d1620">D</a>; faces[1] = <a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a9d5dc3f8f9d04ae80237132101f4258f">U</a>;  faces[2] = <a class="code" href="namespaceoomph_1_1BinaryTreeNames.html#a7ff5e7e46beae31bf81579531b1f9895a8df863dabb4096fa066f7a6dbf7502d1">L</a>; faces[3] = <a class="code" href="namespaceoomph_1_1BinaryTreeNames.html#a7ff5e7e46beae31bf81579531b1f9895a1bf47d3f36e6272d94344ae84aca2498">R</a>; </div>
<div class="line"><a name="l02449"></a><span class="lineno"> 2449</span>&#160;  faces[4] = <a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a43c804e2bcf9862a4bf629d5f01761e8">B</a>; faces[5] = <a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a755807a4724a0f4d96f0817559c0a927">F</a>;</div>
<div class="line"><a name="l02450"></a><span class="lineno"> 2450</span>&#160; </div>
<div class="line"><a name="l02451"></a><span class="lineno"> 2451</span>&#160;  <span class="comment">//Loop over the edges</span></div>
<div class="line"><a name="l02452"></a><span class="lineno"> 2452</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> face_counter=0;face_counter&lt;6;face_counter++)</div>
<div class="line"><a name="l02453"></a><span class="lineno"> 2453</span>&#160;  {</div>
<div class="line"><a name="l02454"></a><span class="lineno"> 2454</span>&#160;   <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>(3), s_lo_neigh(3), s_hi_neigh(3);</div>
<div class="line"><a name="l02455"></a><span class="lineno"> 2455</span>&#160;   <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> s_fraction(3);</div>
<div class="line"><a name="l02456"></a><span class="lineno"> 2456</span>&#160;   <a class="code" href="classoomph_1_1Vector.html">Vector&lt;unsigned&gt;</a> translate_s(3);</div>
<div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160;   <span class="keywordtype">int</span> neigh_face,diff_level;</div>
<div class="line"><a name="l02458"></a><span class="lineno"> 2458</span>&#160;   <span class="keywordtype">int</span> my_face;</div>
<div class="line"><a name="l02459"></a><span class="lineno"> 2459</span>&#160;   <span class="keywordtype">bool</span> in_neighbouring_tree;</div>
<div class="line"><a name="l02460"></a><span class="lineno"> 2460</span>&#160; </div>
<div class="line"><a name="l02461"></a><span class="lineno"> 2461</span>&#160;   my_face = faces[face_counter];</div>
<div class="line"><a name="l02462"></a><span class="lineno"> 2462</span>&#160; </div>
<div class="line"><a name="l02463"></a><span class="lineno"> 2463</span>&#160;   <span class="comment">// Find pointer to neighbour in this direction</span></div>
<div class="line"><a name="l02464"></a><span class="lineno"> 2464</span>&#160;   <a class="code" href="classoomph_1_1OcTree.html">OcTree</a>* neigh_pt;</div>
<div class="line"><a name="l02465"></a><span class="lineno"> 2465</span>&#160;   neigh_pt=octree_pt()-&gt;<a class="code" href="classoomph_1_1OcTree.html#a690c4fbbca73bd48c0bc3b2913a9b39c">gteq_face_neighbour</a>(my_face,</div>
<div class="line"><a name="l02466"></a><span class="lineno"> 2466</span>&#160;                                             translate_s,</div>
<div class="line"><a name="l02467"></a><span class="lineno"> 2467</span>&#160;                                             s_lo_neigh,s_hi_neigh,</div>
<div class="line"><a name="l02468"></a><span class="lineno"> 2468</span>&#160;                                             neigh_face,diff_level,</div>
<div class="line"><a name="l02469"></a><span class="lineno"> 2469</span>&#160;                                             in_neighbouring_tree);</div>
<div class="line"><a name="l02470"></a><span class="lineno"> 2470</span>&#160;   </div>
<div class="line"><a name="l02471"></a><span class="lineno"> 2471</span>&#160;   <span class="comment">// Neighbour exists and has existing nodes</span></div>
<div class="line"><a name="l02472"></a><span class="lineno"> 2472</span>&#160;   <span class="keywordflow">if</span> ((neigh_pt!=0) &amp;&amp; (neigh_pt-&gt;<a class="code" href="classoomph_1_1Tree.html#a2f2eeb0f1dd161f696cccc652974ff4c">object_pt</a>()-&gt;<a class="code" href="classoomph_1_1RefineableElement.html#a50758228db823d72ea8da23dbb000901">nodes_built</a>()))</div>
<div class="line"><a name="l02473"></a><span class="lineno"> 2473</span>&#160;   {</div>
<div class="line"><a name="l02474"></a><span class="lineno"> 2474</span>&#160;    <span class="comment">//if (diff_level!=0)</span></div>
<div class="line"><a name="l02475"></a><span class="lineno"> 2475</span>&#160;    {</div>
<div class="line"><a name="l02476"></a><span class="lineno"> 2476</span>&#160;     <span class="comment">//Need to exclude periodic nodes from this check</span></div>
<div class="line"><a name="l02477"></a><span class="lineno"> 2477</span>&#160;     <span class="comment">//There are only periodic nodes if we are in a neighbouring tree</span></div>
<div class="line"><a name="l02478"></a><span class="lineno"> 2478</span>&#160;     <span class="keywordtype">bool</span> is_periodic=<span class="keyword">false</span>;</div>
<div class="line"><a name="l02479"></a><span class="lineno"> 2479</span>&#160;     <span class="keywordflow">if</span>(in_neighbouring_tree)</div>
<div class="line"><a name="l02480"></a><span class="lineno"> 2480</span>&#160;     {</div>
<div class="line"><a name="l02481"></a><span class="lineno"> 2481</span>&#160;      <span class="comment">//Is it periodic</span></div>
<div class="line"><a name="l02482"></a><span class="lineno"> 2482</span>&#160;      is_periodic=tree_pt()-&gt;<a class="code" href="classoomph_1_1Tree.html#ae48479dc463d2a8f10400b4b00643a27">root_pt</a>()-&gt;<a class="code" href="classoomph_1_1TreeRoot.html#a7be347e54e34f924c008c302f5146064">is_neighbour_periodic</a>(faces[face_counter]);</div>
<div class="line"><a name="l02483"></a><span class="lineno"> 2483</span>&#160;     }</div>
<div class="line"><a name="l02484"></a><span class="lineno"> 2484</span>&#160; </div>
<div class="line"><a name="l02485"></a><span class="lineno"> 2485</span>&#160;     <span class="comment">// Loop over nodes along the edge</span></div>
<div class="line"><a name="l02486"></a><span class="lineno"> 2486</span>&#160;     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i0=0;i0&lt;n_p;i0++)</div>
<div class="line"><a name="l02487"></a><span class="lineno"> 2487</span>&#160;     {</div>
<div class="line"><a name="l02488"></a><span class="lineno"> 2488</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i1=0;i1&lt;n_p;i1++)</div>
<div class="line"><a name="l02489"></a><span class="lineno"> 2489</span>&#160;      {</div>
<div class="line"><a name="l02490"></a><span class="lineno"> 2490</span>&#160;       <span class="comment">//Local node number</span></div>
<div class="line"><a name="l02491"></a><span class="lineno"> 2491</span>&#160;       <span class="keywordtype">unsigned</span> <a class="code" href="the__data__structure_8txt.html#af88b2d950fae19ab641bd1690e08445c">n</a>=0;</div>
<div class="line"><a name="l02492"></a><span class="lineno"> 2492</span>&#160;       <span class="keywordflow">switch</span>(face_counter)</div>
<div class="line"><a name="l02493"></a><span class="lineno"> 2493</span>&#160;       {</div>
<div class="line"><a name="l02494"></a><span class="lineno"> 2494</span>&#160;       <span class="keywordflow">case</span> 0:</div>
<div class="line"><a name="l02495"></a><span class="lineno"> 2495</span>&#160;        <span class="comment">//Fractions</span></div>
<div class="line"><a name="l02496"></a><span class="lineno"> 2496</span>&#160;        s_fraction[0] = local_one_d_fraction_of_node(i0,0);</div>
<div class="line"><a name="l02497"></a><span class="lineno"> 2497</span>&#160;        s_fraction[1] = 0.0;</div>
<div class="line"><a name="l02498"></a><span class="lineno"> 2498</span>&#160;        s_fraction[2] = local_one_d_fraction_of_node(i1,2);</div>
<div class="line"><a name="l02499"></a><span class="lineno"> 2499</span>&#160;        <span class="comment">// Set local node number</span></div>
<div class="line"><a name="l02500"></a><span class="lineno"> 2500</span>&#160;        <a class="code" href="the__data__structure_8txt.html#af88b2d950fae19ab641bd1690e08445c">n</a>= i0 + i1*n_p*n_p;</div>
<div class="line"><a name="l02501"></a><span class="lineno"> 2501</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02502"></a><span class="lineno"> 2502</span>&#160;          </div>
<div class="line"><a name="l02503"></a><span class="lineno"> 2503</span>&#160;       <span class="keywordflow">case</span> 1:</div>
<div class="line"><a name="l02504"></a><span class="lineno"> 2504</span>&#160;        s_fraction[0] = local_one_d_fraction_of_node(i0,0);</div>
<div class="line"><a name="l02505"></a><span class="lineno"> 2505</span>&#160;        s_fraction[1] = 1.0;</div>
<div class="line"><a name="l02506"></a><span class="lineno"> 2506</span>&#160;        s_fraction[2] = local_one_d_fraction_of_node(i1,2);</div>
<div class="line"><a name="l02507"></a><span class="lineno"> 2507</span>&#160;        <span class="comment">// Set local node number</span></div>
<div class="line"><a name="l02508"></a><span class="lineno"> 2508</span>&#160;        <a class="code" href="the__data__structure_8txt.html#af88b2d950fae19ab641bd1690e08445c">n</a>= i0 + n_p*(n_p-1) + i1*n_p*n_p;</div>
<div class="line"><a name="l02509"></a><span class="lineno"> 2509</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02510"></a><span class="lineno"> 2510</span>&#160;            </div>
<div class="line"><a name="l02511"></a><span class="lineno"> 2511</span>&#160;       <span class="keywordflow">case</span> 2:</div>
<div class="line"><a name="l02512"></a><span class="lineno"> 2512</span>&#160;        s_fraction[0] = 0.0;</div>
<div class="line"><a name="l02513"></a><span class="lineno"> 2513</span>&#160;        s_fraction[1] = local_one_d_fraction_of_node(i0,1);</div>
<div class="line"><a name="l02514"></a><span class="lineno"> 2514</span>&#160;        s_fraction[2] = local_one_d_fraction_of_node(i1,2);</div>
<div class="line"><a name="l02515"></a><span class="lineno"> 2515</span>&#160;        <span class="comment">// Set local node number</span></div>
<div class="line"><a name="l02516"></a><span class="lineno"> 2516</span>&#160;        <a class="code" href="the__data__structure_8txt.html#af88b2d950fae19ab641bd1690e08445c">n</a> =  n_p*i0 + i1*n_p*n_p;</div>
<div class="line"><a name="l02517"></a><span class="lineno"> 2517</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02518"></a><span class="lineno"> 2518</span>&#160;            </div>
<div class="line"><a name="l02519"></a><span class="lineno"> 2519</span>&#160;       <span class="keywordflow">case</span> 3:</div>
<div class="line"><a name="l02520"></a><span class="lineno"> 2520</span>&#160;        s_fraction[0] = 1.0;</div>
<div class="line"><a name="l02521"></a><span class="lineno"> 2521</span>&#160;        s_fraction[1] = local_one_d_fraction_of_node(i0,1);</div>
<div class="line"><a name="l02522"></a><span class="lineno"> 2522</span>&#160;        s_fraction[2] = local_one_d_fraction_of_node(i1,2);</div>
<div class="line"><a name="l02523"></a><span class="lineno"> 2523</span>&#160;        <span class="comment">// Set local node number</span></div>
<div class="line"><a name="l02524"></a><span class="lineno"> 2524</span>&#160;        <a class="code" href="the__data__structure_8txt.html#af88b2d950fae19ab641bd1690e08445c">n</a> = n_p-1 + n_p*i0 + n_p*n_p*i1;</div>
<div class="line"><a name="l02525"></a><span class="lineno"> 2525</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02526"></a><span class="lineno"> 2526</span>&#160; </div>
<div class="line"><a name="l02527"></a><span class="lineno"> 2527</span>&#160;       <span class="keywordflow">case</span> 4:</div>
<div class="line"><a name="l02528"></a><span class="lineno"> 2528</span>&#160;        s_fraction[0] = local_one_d_fraction_of_node(i0,0);</div>
<div class="line"><a name="l02529"></a><span class="lineno"> 2529</span>&#160;        s_fraction[1] = local_one_d_fraction_of_node(i1,1);</div>
<div class="line"><a name="l02530"></a><span class="lineno"> 2530</span>&#160;        s_fraction[2] = 0.0;</div>
<div class="line"><a name="l02531"></a><span class="lineno"> 2531</span>&#160;        <span class="comment">// Set local node number</span></div>
<div class="line"><a name="l02532"></a><span class="lineno"> 2532</span>&#160;        <a class="code" href="the__data__structure_8txt.html#af88b2d950fae19ab641bd1690e08445c">n</a> = i0 + n_p*i1;</div>
<div class="line"><a name="l02533"></a><span class="lineno"> 2533</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02534"></a><span class="lineno"> 2534</span>&#160; </div>
<div class="line"><a name="l02535"></a><span class="lineno"> 2535</span>&#160;       <span class="keywordflow">case</span> 5:</div>
<div class="line"><a name="l02536"></a><span class="lineno"> 2536</span>&#160;        s_fraction[0] = local_one_d_fraction_of_node(i0,0);</div>
<div class="line"><a name="l02537"></a><span class="lineno"> 2537</span>&#160;        s_fraction[1] = local_one_d_fraction_of_node(i1,1);</div>
<div class="line"><a name="l02538"></a><span class="lineno"> 2538</span>&#160;        s_fraction[2] = 1.0;</div>
<div class="line"><a name="l02539"></a><span class="lineno"> 2539</span>&#160;        <span class="comment">// Set local node number</span></div>
<div class="line"><a name="l02540"></a><span class="lineno"> 2540</span>&#160;        <a class="code" href="the__data__structure_8txt.html#af88b2d950fae19ab641bd1690e08445c">n</a> = i0 + n_p*i1 + n_p*n_p*(n_p-1);</div>
<div class="line"><a name="l02541"></a><span class="lineno"> 2541</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02542"></a><span class="lineno"> 2542</span>&#160;       }</div>
<div class="line"><a name="l02543"></a><span class="lineno"> 2543</span>&#160;          </div>
<div class="line"><a name="l02544"></a><span class="lineno"> 2544</span>&#160;         </div>
<div class="line"><a name="l02545"></a><span class="lineno"> 2545</span>&#160;       <span class="comment">// We have to check if the hi and lo directions along the </span></div>
<div class="line"><a name="l02546"></a><span class="lineno"> 2546</span>&#160;       <span class="comment">// face are inverted or not</span></div>
<div class="line"><a name="l02547"></a><span class="lineno"> 2547</span>&#160;       <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> s_in_neighb(3);</div>
<div class="line"><a name="l02548"></a><span class="lineno"> 2548</span>&#160;       <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;3;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l02549"></a><span class="lineno"> 2549</span>&#160;       {</div>
<div class="line"><a name="l02550"></a><span class="lineno"> 2550</span>&#160;        <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] = -1.0 + 2.0*s_fraction[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>];</div>
<div class="line"><a name="l02551"></a><span class="lineno"> 2551</span>&#160;        s_in_neighb[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] = s_lo_neigh[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] + s_fraction[translate_s[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]]*</div>
<div class="line"><a name="l02552"></a><span class="lineno"> 2552</span>&#160;         (s_hi_neigh[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] - s_lo_neigh[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]);</div>
<div class="line"><a name="l02553"></a><span class="lineno"> 2553</span>&#160;       }</div>
<div class="line"><a name="l02554"></a><span class="lineno"> 2554</span>&#160; </div>
<div class="line"><a name="l02555"></a><span class="lineno"> 2555</span>&#160;                    </div>
<div class="line"><a name="l02556"></a><span class="lineno"> 2556</span>&#160;       <span class="comment">//Loop over timesteps</span></div>
<div class="line"><a name="l02557"></a><span class="lineno"> 2557</span>&#160;       <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#af6f0bd3dc13317f895c91323c25c2b8f">t</a>=0;<a class="code" href="cfortran_8h.html#af6f0bd3dc13317f895c91323c25c2b8f">t</a>&lt;n_time;<a class="code" href="cfortran_8h.html#af6f0bd3dc13317f895c91323c25c2b8f">t</a>++)</div>
<div class="line"><a name="l02558"></a><span class="lineno"> 2558</span>&#160;       {</div>
<div class="line"><a name="l02559"></a><span class="lineno"> 2559</span>&#160;        <span class="comment">// Get the nodal position from neighbour element</span></div>
<div class="line"><a name="l02560"></a><span class="lineno"> 2560</span>&#160;        <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> x_in_neighb(3);</div>
<div class="line"><a name="l02561"></a><span class="lineno"> 2561</span>&#160;        neigh_pt-&gt;<a class="code" href="classoomph_1_1Tree.html#a2f2eeb0f1dd161f696cccc652974ff4c">object_pt</a>()-&gt;<a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>(<a class="code" href="cfortran_8h.html#af6f0bd3dc13317f895c91323c25c2b8f">t</a>,s_in_neighb,x_in_neighb);</div>
<div class="line"><a name="l02562"></a><span class="lineno"> 2562</span>&#160;            </div>
<div class="line"><a name="l02563"></a><span class="lineno"> 2563</span>&#160;        <span class="comment">// Check error only if the node is NOT periodic</span></div>
<div class="line"><a name="l02564"></a><span class="lineno"> 2564</span>&#160;        <span class="keywordflow">if</span>(is_periodic==<span class="keyword">false</span>)</div>
<div class="line"><a name="l02565"></a><span class="lineno"> 2565</span>&#160;        {</div>
<div class="line"><a name="l02566"></a><span class="lineno"> 2566</span>&#160;         <span class="comment">// Check error</span></div>
<div class="line"><a name="l02567"></a><span class="lineno"> 2567</span>&#160;         <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;3;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l02568"></a><span class="lineno"> 2568</span>&#160;         {</div>
<div class="line"><a name="l02569"></a><span class="lineno"> 2569</span>&#160;          <span class="comment">//Find the spatial error</span></div>
<div class="line"><a name="l02570"></a><span class="lineno"> 2570</span>&#160;          <span class="keywordtype">double</span> err=std::fabs(node_pt(<a class="code" href="the__data__structure_8txt.html#af88b2d950fae19ab641bd1690e08445c">n</a>)-&gt;x(<a class="code" href="cfortran_8h.html#af6f0bd3dc13317f895c91323c25c2b8f">t</a>,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>) - x_in_neighb[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]);</div>
<div class="line"><a name="l02571"></a><span class="lineno"> 2571</span>&#160;              </div>
<div class="line"><a name="l02572"></a><span class="lineno"> 2572</span>&#160;          <span class="comment">//If it&#39;s bigger than our tolerance, say so</span></div>
<div class="line"><a name="l02573"></a><span class="lineno"> 2573</span>&#160;          <span class="keywordflow">if</span> (err&gt;1<a class="code" href="cfortran_8h.html#a37cd013acc76697829c324bdd8562d82">e</a>-9)</div>
<div class="line"><a name="l02574"></a><span class="lineno"> 2574</span>&#160;          {</div>
<div class="line"><a name="l02575"></a><span class="lineno"> 2575</span>&#160;           <a class="code" href="namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;errx[&quot;</span> &lt;&lt; <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a> &lt;&lt; <span class="stringliteral">&quot;], t x, x_neigh: &quot;</span> </div>
<div class="line"><a name="l02576"></a><span class="lineno"> 2576</span>&#160;                      &lt;&lt; err &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="cfortran_8h.html#af6f0bd3dc13317f895c91323c25c2b8f">t</a> &lt;&lt; <span class="stringliteral">&quot; &quot;</span> </div>
<div class="line"><a name="l02577"></a><span class="lineno"> 2577</span>&#160;                      &lt;&lt; node_pt(<a class="code" href="the__data__structure_8txt.html#af88b2d950fae19ab641bd1690e08445c">n</a>)-&gt;x(<a class="code" href="cfortran_8h.html#af6f0bd3dc13317f895c91323c25c2b8f">t</a>,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>) </div>
<div class="line"><a name="l02578"></a><span class="lineno"> 2578</span>&#160;                      &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt;  x_in_neighb[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]&lt;&lt; std::endl;</div>
<div class="line"><a name="l02579"></a><span class="lineno"> 2579</span>&#160;           <a class="code" href="namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;at &quot;</span> </div>
<div class="line"><a name="l02580"></a><span class="lineno"> 2580</span>&#160;                      &lt;&lt;  node_pt(<a class="code" href="the__data__structure_8txt.html#af88b2d950fae19ab641bd1690e08445c">n</a>)-&gt;x(0) &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l02581"></a><span class="lineno"> 2581</span>&#160;                      &lt;&lt;  node_pt(<a class="code" href="the__data__structure_8txt.html#af88b2d950fae19ab641bd1690e08445c">n</a>)-&gt;x(1) &lt;&lt; <span class="stringliteral">&quot; &quot;</span> </div>
<div class="line"><a name="l02582"></a><span class="lineno"> 2582</span>&#160;                      &lt;&lt;  node_pt(<a class="code" href="the__data__structure_8txt.html#af88b2d950fae19ab641bd1690e08445c">n</a>)-&gt;x(2) &lt;&lt; <span class="stringliteral">&quot; &quot;</span> </div>
<div class="line"><a name="l02583"></a><span class="lineno"> 2583</span>&#160;                      &lt;&lt; std::endl;</div>
<div class="line"><a name="l02584"></a><span class="lineno"> 2584</span>&#160;          }</div>
<div class="line"><a name="l02585"></a><span class="lineno"> 2585</span>&#160;              </div>
<div class="line"><a name="l02586"></a><span class="lineno"> 2586</span>&#160;          <span class="comment">//If it&#39;s bigger than the previous max error, it is the</span></div>
<div class="line"><a name="l02587"></a><span class="lineno"> 2587</span>&#160;          <span class="comment">//new max error!</span></div>
<div class="line"><a name="l02588"></a><span class="lineno"> 2588</span>&#160;          <span class="keywordflow">if</span> (err&gt;max_error_x[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]) {max_error_x[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]=err;}</div>
<div class="line"><a name="l02589"></a><span class="lineno"> 2589</span>&#160;         }</div>
<div class="line"><a name="l02590"></a><span class="lineno"> 2590</span>&#160;        }</div>
<div class="line"><a name="l02591"></a><span class="lineno"> 2591</span>&#160;            </div>
<div class="line"><a name="l02592"></a><span class="lineno"> 2592</span>&#160;        <span class="comment">// Get the values from neighbour element. Note: # of values</span></div>
<div class="line"><a name="l02593"></a><span class="lineno"> 2593</span>&#160;        <span class="comment">// gets set by routine (because in general we don&#39;t know</span></div>
<div class="line"><a name="l02594"></a><span class="lineno"> 2594</span>&#160;        <span class="comment">// how many interpolated values a certain element has</span></div>
<div class="line"><a name="l02595"></a><span class="lineno"> 2595</span>&#160;        <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> values_in_neighb;</div>
<div class="line"><a name="l02596"></a><span class="lineno"> 2596</span>&#160;        neigh_pt-&gt;<a class="code" href="classoomph_1_1Tree.html#a2f2eeb0f1dd161f696cccc652974ff4c">object_pt</a>()-&gt;</div>
<div class="line"><a name="l02597"></a><span class="lineno"> 2597</span>&#160;         get_interpolated_values(<a class="code" href="cfortran_8h.html#af6f0bd3dc13317f895c91323c25c2b8f">t</a>,s_in_neighb,values_in_neighb);</div>
<div class="line"><a name="l02598"></a><span class="lineno"> 2598</span>&#160;            </div>
<div class="line"><a name="l02599"></a><span class="lineno"> 2599</span>&#160;        <span class="comment">// Get the values in current element.</span></div>
<div class="line"><a name="l02600"></a><span class="lineno"> 2600</span>&#160;        <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> <a class="code" href="the__data__structure_8txt.html#a70eaf7a61463de09f737da1f4bb551c3">values</a>;</div>
<div class="line"><a name="l02601"></a><span class="lineno"> 2601</span>&#160;        get_interpolated_values(<a class="code" href="cfortran_8h.html#af6f0bd3dc13317f895c91323c25c2b8f">t</a>,<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,<a class="code" href="the__data__structure_8txt.html#a70eaf7a61463de09f737da1f4bb551c3">values</a>);</div>
<div class="line"><a name="l02602"></a><span class="lineno"> 2602</span>&#160;            </div>
<div class="line"><a name="l02603"></a><span class="lineno"> 2603</span>&#160;        <span class="comment">// Now figure out how many continuously interpolated </span></div>
<div class="line"><a name="l02604"></a><span class="lineno"> 2604</span>&#160;        <span class="comment">// values there are</span></div>
<div class="line"><a name="l02605"></a><span class="lineno"> 2605</span>&#160;        <span class="keywordtype">unsigned</span> num_val=neigh_pt-&gt;<a class="code" href="classoomph_1_1Tree.html#a2f2eeb0f1dd161f696cccc652974ff4c">object_pt</a>()-&gt;<a class="code" href="classoomph_1_1RefineableElement.html#a53e171a18c9f43f1db90a6876516a073">ncont_interpolated_values</a>();</div>
<div class="line"><a name="l02606"></a><span class="lineno"> 2606</span>&#160;            </div>
<div class="line"><a name="l02607"></a><span class="lineno"> 2607</span>&#160;        <span class="comment">// Check error</span></div>
<div class="line"><a name="l02608"></a><span class="lineno"> 2608</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> ival=0;ival&lt;num_val;ival++)</div>
<div class="line"><a name="l02609"></a><span class="lineno"> 2609</span>&#160;        {</div>
<div class="line"><a name="l02610"></a><span class="lineno"> 2610</span>&#160;         <span class="keywordtype">double</span> err=std::fabs(<a class="code" href="the__data__structure_8txt.html#a70eaf7a61463de09f737da1f4bb551c3">values</a>[ival] - values_in_neighb[ival]);</div>
<div class="line"><a name="l02611"></a><span class="lineno"> 2611</span>&#160;              </div>
<div class="line"><a name="l02612"></a><span class="lineno"> 2612</span>&#160;         <span class="keywordflow">if</span> (err&gt;1.0<a class="code" href="cfortran_8h.html#a37cd013acc76697829c324bdd8562d82">e</a>-10)</div>
<div class="line"><a name="l02613"></a><span class="lineno"> 2613</span>&#160;         {</div>
<div class="line"><a name="l02614"></a><span class="lineno"> 2614</span>&#160;          <a class="code" href="namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt;  node_pt(<a class="code" href="the__data__structure_8txt.html#af88b2d950fae19ab641bd1690e08445c">n</a>)-&gt;x(0) &lt;&lt; <span class="stringliteral">&quot; &quot;</span> </div>
<div class="line"><a name="l02615"></a><span class="lineno"> 2615</span>&#160;                     &lt;&lt;  node_pt(<a class="code" href="the__data__structure_8txt.html#af88b2d950fae19ab641bd1690e08445c">n</a>)-&gt;x(1) &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l02616"></a><span class="lineno"> 2616</span>&#160;                     &lt;&lt;  node_pt(<a class="code" href="the__data__structure_8txt.html#af88b2d950fae19ab641bd1690e08445c">n</a>)-&gt;x(2) &lt;&lt; <span class="stringliteral">&quot; \n# &quot;</span></div>
<div class="line"><a name="l02617"></a><span class="lineno"> 2617</span>&#160;                     &lt;&lt; <span class="stringliteral">&quot;erru (S)&quot;</span> &lt;&lt; err &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; ival &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="the__data__structure_8txt.html#af88b2d950fae19ab641bd1690e08445c">n</a> &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l02618"></a><span class="lineno"> 2618</span>&#160;                     &lt;&lt; <a class="code" href="the__data__structure_8txt.html#a70eaf7a61463de09f737da1f4bb551c3">values</a>[ival]</div>
<div class="line"><a name="l02619"></a><span class="lineno"> 2619</span>&#160;                     &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; values_in_neighb[ival] &lt;&lt; std::endl;</div>
<div class="line"><a name="l02620"></a><span class="lineno"> 2620</span>&#160;          <span class="comment">//error_file&lt;&lt;&quot;ZONE&quot;&lt;&lt;std::endl</span></div>
<div class="line"><a name="l02621"></a><span class="lineno"> 2621</span>&#160;          <span class="comment">//          &lt;&lt;  node_pt(n)-&gt;x(0) &lt;&lt; &quot; &quot; </span></div>
<div class="line"><a name="l02622"></a><span class="lineno"> 2622</span>&#160;          <span class="comment">//          &lt;&lt;  node_pt(n)-&gt;x(1) &lt;&lt; &quot; &quot;</span></div>
<div class="line"><a name="l02623"></a><span class="lineno"> 2623</span>&#160;          <span class="comment">//          &lt;&lt;  node_pt(n)-&gt;x(2) &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l02624"></a><span class="lineno"> 2624</span>&#160;         }</div>
<div class="line"><a name="l02625"></a><span class="lineno"> 2625</span>&#160;              </div>
<div class="line"><a name="l02626"></a><span class="lineno"> 2626</span>&#160;         <span class="keywordflow">if</span> (err&gt;max_error_val) {max_error_val=err;}</div>
<div class="line"><a name="l02627"></a><span class="lineno"> 2627</span>&#160;              </div>
<div class="line"><a name="l02628"></a><span class="lineno"> 2628</span>&#160;        }</div>
<div class="line"><a name="l02629"></a><span class="lineno"> 2629</span>&#160;       }</div>
<div class="line"><a name="l02630"></a><span class="lineno"> 2630</span>&#160;      }</div>
<div class="line"><a name="l02631"></a><span class="lineno"> 2631</span>&#160;     }</div>
<div class="line"><a name="l02632"></a><span class="lineno"> 2632</span>&#160;    }</div>
<div class="line"><a name="l02633"></a><span class="lineno"> 2633</span>&#160;   }</div>
<div class="line"><a name="l02634"></a><span class="lineno"> 2634</span>&#160;  }</div>
<div class="line"><a name="l02635"></a><span class="lineno"> 2635</span>&#160; </div>
<div class="line"><a name="l02636"></a><span class="lineno"> 2636</span>&#160;  max_error=max_error_x[0];</div>
<div class="line"><a name="l02637"></a><span class="lineno"> 2637</span>&#160;  <span class="keywordflow">if</span> (max_error_x[1]&gt;max_error) max_error=max_error_x[1];</div>
<div class="line"><a name="l02638"></a><span class="lineno"> 2638</span>&#160;  <span class="keywordflow">if</span> (max_error_x[2]&gt;max_error) max_error=max_error_x[2];</div>
<div class="line"><a name="l02639"></a><span class="lineno"> 2639</span>&#160;  <span class="keywordflow">if</span> (max_error_val&gt;max_error) max_error=max_error_val;</div>
<div class="line"><a name="l02640"></a><span class="lineno"> 2640</span>&#160; </div>
<div class="line"><a name="l02641"></a><span class="lineno"> 2641</span>&#160;  <span class="keywordflow">if</span> (max_error&gt;1<a class="code" href="cfortran_8h.html#a37cd013acc76697829c324bdd8562d82">e</a>-9)</div>
<div class="line"><a name="l02642"></a><span class="lineno"> 2642</span>&#160;  {</div>
<div class="line"><a name="l02643"></a><span class="lineno"> 2643</span>&#160;   <a class="code" href="namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;\n#------------------------------------ \n#Max error &quot;</span> ;</div>
<div class="line"><a name="l02644"></a><span class="lineno"> 2644</span>&#160;   <a class="code" href="namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; max_error_x[0] </div>
<div class="line"><a name="l02645"></a><span class="lineno"> 2645</span>&#160;              &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; max_error_x[1] </div>
<div class="line"><a name="l02646"></a><span class="lineno"> 2646</span>&#160;              &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; max_error_x[2] </div>
<div class="line"><a name="l02647"></a><span class="lineno"> 2647</span>&#160;              &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; max_error_val &lt;&lt; std::endl;</div>
<div class="line"><a name="l02648"></a><span class="lineno"> 2648</span>&#160;   <a class="code" href="namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;#------------------------------------ \n &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l02649"></a><span class="lineno"> 2649</span>&#160;   </div>
<div class="line"><a name="l02650"></a><span class="lineno"> 2650</span>&#160;  }</div>
<div class="line"><a name="l02651"></a><span class="lineno"> 2651</span>&#160; </div>
<div class="line"><a name="l02652"></a><span class="lineno"> 2652</span>&#160;  <span class="comment">//error_file.close();</span></div>
<div class="line"><a name="l02653"></a><span class="lineno"> 2653</span>&#160; }</div>
<div class="line"><a name="l02654"></a><span class="lineno"> 2654</span>&#160; </div>
<div class="line"><a name="l02655"></a><span class="lineno"> 2655</span>&#160; </div>
<div class="line"><a name="l02656"></a><span class="lineno"> 2656</span>&#160;<span class="comment">//==================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l02657"></a><span class="lineno"> 2657</span>&#160;<span class="comment">/// Determine vector of solid (positional) boundary conditions along </span></div>
<div class="line"><a name="l02658"></a><span class="lineno"> 2658</span>&#160;<span class="comment">/// the element&#39;s boundary (or vertex) bound (S/W/N/E/SW/SE/NW/NE). </span></div>
<div class="line"><a name="l02659"></a><span class="lineno"> 2659</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l02660"></a><span class="lineno"> 2660</span>&#160;<span class="comment">/// This function assumes that the same boundary condition is applied</span></div>
<div class="line"><a name="l02661"></a><span class="lineno"> 2661</span>&#160;<span class="comment">/// along the entire length of an element&#39;s edge (of course, the</span></div>
<div class="line"><a name="l02662"></a><span class="lineno"> 2662</span>&#160;<span class="comment">/// vertices combine the boundary conditions of their two adjacent edges</span></div>
<div class="line"><a name="l02663"></a><span class="lineno"> 2663</span>&#160;<span class="comment">/// in the most restrictive combination. Hence, if we&#39;re at a vertex,</span></div>
<div class="line"><a name="l02664"></a><span class="lineno"> 2664</span>&#160;<span class="comment">/// we apply the most restrictive boundary condition of the</span></div>
<div class="line"><a name="l02665"></a><span class="lineno"> 2665</span>&#160;<span class="comment">/// two adjacent edges. If we&#39;re on an edge (in its proper interior), </span></div>
<div class="line"><a name="l02666"></a><span class="lineno"> 2666</span>&#160;<span class="comment">/// we apply the least restrictive boundary condition of all nodes </span></div>
<div class="line"><a name="l02667"></a><span class="lineno"> 2667</span>&#160;<span class="comment">/// along the edge.</span></div>
<div class="line"><a name="l02668"></a><span class="lineno"> 2668</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l02669"></a><span class="lineno"> 2669</span>&#160;<span class="comment">/// Usual convention: </span></div>
<div class="line"><a name="l02670"></a><span class="lineno"> 2670</span>&#160;<span class="comment">///   - solid_bound_cons[i]=0 if displacement in coordinate direction i</span></div>
<div class="line"><a name="l02671"></a><span class="lineno"> 2671</span>&#160;<span class="comment">///                           on this boundary is free. </span></div>
<div class="line"><a name="l02672"></a><span class="lineno"> 2672</span>&#160;<span class="comment">///   - solid_bound_cons[i]=1 if it&#39;s pinned.</span></div>
<div class="line"><a name="l02673"></a><span class="lineno"> 2673</span>&#160;<span class="comment"></span><span class="comment">//==================================================================</span></div>
<div class="line"><a name="l02674"></a><span class="lineno"><a class="line" href="classoomph_1_1RefineableSolidQElement_3_013_01_4.html#a57590ae1b7cb21cc362a371eef096217"> 2674</a></span>&#160; <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1RefineableSolidQElement.html">RefineableSolidQElement&lt;3&gt;::get_solid_bcs</a>(<span class="keywordtype">int</span> bound, </div>
<div class="line"><a name="l02675"></a><span class="lineno"> 2675</span>&#160;                                                <a class="code" href="classoomph_1_1Vector.html">Vector&lt;int&gt;</a>&amp; solid_bound_cons)<span class="keyword"> const</span></div>
<div class="line"><a name="l02676"></a><span class="lineno"> 2676</span>&#160;<span class="keyword"> </span>{</div>
<div class="line"><a name="l02677"></a><span class="lineno"> 2677</span>&#160;  <span class="keyword">using namespace </span>OcTreeNames;</div>
<div class="line"><a name="l02678"></a><span class="lineno"> 2678</span>&#160; </div>
<div class="line"><a name="l02679"></a><span class="lineno"> 2679</span>&#160;  <span class="comment">//Spatial dimension of all nodes</span></div>
<div class="line"><a name="l02680"></a><span class="lineno"> 2680</span>&#160;  <span class="keywordtype">unsigned</span> n_dim = this-&gt;nodal_dimension();</div>
<div class="line"><a name="l02681"></a><span class="lineno"> 2681</span>&#160;  <span class="comment">//Set up temporary vectors to hold edge boundary conditions</span></div>
<div class="line"><a name="l02682"></a><span class="lineno"> 2682</span>&#160;  <a class="code" href="classoomph_1_1Vector.html">Vector&lt;int&gt;</a> bound_cons1(n_dim), bound_cons2(n_dim); </div>
<div class="line"><a name="l02683"></a><span class="lineno"> 2683</span>&#160;  <a class="code" href="classoomph_1_1Vector.html">Vector&lt;int&gt;</a> bound_cons3(n_dim);</div>
<div class="line"><a name="l02684"></a><span class="lineno"> 2684</span>&#160; </div>
<div class="line"><a name="l02685"></a><span class="lineno"> 2685</span>&#160;  <a class="code" href="classoomph_1_1Vector.html">Vector&lt;int&gt;</a> vect1(3),vect2(3),vect3(3);</div>
<div class="line"><a name="l02686"></a><span class="lineno"> 2686</span>&#160;  <a class="code" href="classoomph_1_1Vector.html">Vector&lt;int&gt;</a> vect_elem;</div>
<div class="line"><a name="l02687"></a><span class="lineno"> 2687</span>&#160;  <a class="code" href="classoomph_1_1Vector.html">Vector&lt;int&gt;</a> notzero;</div>
<div class="line"><a name="l02688"></a><span class="lineno"> 2688</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="the__data__structure_8txt.html#af88b2d950fae19ab641bd1690e08445c">n</a>=0;</div>
<div class="line"><a name="l02689"></a><span class="lineno"> 2689</span>&#160; </div>
<div class="line"><a name="l02690"></a><span class="lineno"> 2690</span>&#160;  vect_elem=<a class="code" href="classoomph_1_1OcTree.html#adf813fbb9cffe89fb51f3c8ccd3083ca">OcTree::Direction_to_vector</a>[bound];</div>
<div class="line"><a name="l02691"></a><span class="lineno"> 2691</span>&#160; </div>
<div class="line"><a name="l02692"></a><span class="lineno"> 2692</span>&#160;  <span class="comment">// Just to see if bound is a face, an edge, or a vertex, n stores </span></div>
<div class="line"><a name="l02693"></a><span class="lineno"> 2693</span>&#160;  <span class="comment">// the number of non-zero values in the vector reprensenting the bound</span></div>
<div class="line"><a name="l02694"></a><span class="lineno"> 2694</span>&#160;  <span class="comment">// and the vector notzero stores the position of these values</span></div>
<div class="line"><a name="l02695"></a><span class="lineno"> 2695</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;3;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l02696"></a><span class="lineno"> 2696</span>&#160;  {</div>
<div class="line"><a name="l02697"></a><span class="lineno"> 2697</span>&#160;   <span class="keywordflow">if</span> (vect_elem[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]!=0)</div>
<div class="line"><a name="l02698"></a><span class="lineno"> 2698</span>&#160;   {</div>
<div class="line"><a name="l02699"></a><span class="lineno"> 2699</span>&#160;    <a class="code" href="the__data__structure_8txt.html#af88b2d950fae19ab641bd1690e08445c">n</a>++;</div>
<div class="line"><a name="l02700"></a><span class="lineno"> 2700</span>&#160;    notzero.push_back(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>);</div>
<div class="line"><a name="l02701"></a><span class="lineno"> 2701</span>&#160;   }</div>
<div class="line"><a name="l02702"></a><span class="lineno"> 2702</span>&#160;  }</div>
<div class="line"><a name="l02703"></a><span class="lineno"> 2703</span>&#160; </div>
<div class="line"><a name="l02704"></a><span class="lineno"> 2704</span>&#160;  <span class="keywordflow">switch</span>(<a class="code" href="the__data__structure_8txt.html#af88b2d950fae19ab641bd1690e08445c">n</a>)</div>
<div class="line"><a name="l02705"></a><span class="lineno"> 2705</span>&#160;  {</div>
<div class="line"><a name="l02706"></a><span class="lineno"> 2706</span>&#160;   <span class="comment">// If there is only one non-zero value, bound is a face</span></div>
<div class="line"><a name="l02707"></a><span class="lineno"> 2707</span>&#160;  <span class="keywordflow">case</span> 1 :</div>
<div class="line"><a name="l02708"></a><span class="lineno"> 2708</span>&#160;   get_face_solid_bcs(bound,solid_bound_cons);</div>
<div class="line"><a name="l02709"></a><span class="lineno"> 2709</span>&#160;   <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02710"></a><span class="lineno"> 2710</span>&#160; </div>
<div class="line"><a name="l02711"></a><span class="lineno"> 2711</span>&#160;   <span class="comment">// If there are two non-zero values, bound is an edge   </span></div>
<div class="line"><a name="l02712"></a><span class="lineno"> 2712</span>&#160;  <span class="keywordflow">case</span> 2 :</div>
<div class="line"><a name="l02713"></a><span class="lineno"> 2713</span>&#160; </div>
<div class="line"><a name="l02714"></a><span class="lineno"> 2714</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;3;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l02715"></a><span class="lineno"> 2715</span>&#160;   {</div>
<div class="line"><a name="l02716"></a><span class="lineno"> 2716</span>&#160;    vect1[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]=0; vect2[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]=0;</div>
<div class="line"><a name="l02717"></a><span class="lineno"> 2717</span>&#160;   }</div>
<div class="line"><a name="l02718"></a><span class="lineno"> 2718</span>&#160;   <span class="comment">// vect1 and vect2 are the vector of the two faces adjacent to bound</span></div>
<div class="line"><a name="l02719"></a><span class="lineno"> 2719</span>&#160;   vect1[notzero[0]]=vect_elem[notzero[0]];</div>
<div class="line"><a name="l02720"></a><span class="lineno"> 2720</span>&#160;   vect2[notzero[1]]=vect_elem[notzero[1]];</div>
<div class="line"><a name="l02721"></a><span class="lineno"> 2721</span>&#160;   </div>
<div class="line"><a name="l02722"></a><span class="lineno"> 2722</span>&#160;   get_face_solid_bcs(<a class="code" href="classoomph_1_1OcTree.html#aec83bade91057d89aa3896274cb96b7e">OcTree::Vector_to_direction</a>[vect1],bound_cons1);</div>
<div class="line"><a name="l02723"></a><span class="lineno"> 2723</span>&#160;   get_face_solid_bcs(<a class="code" href="classoomph_1_1OcTree.html#aec83bade91057d89aa3896274cb96b7e">OcTree::Vector_to_direction</a>[vect2],bound_cons2);</div>
<div class="line"><a name="l02724"></a><span class="lineno"> 2724</span>&#160;   <span class="comment">// get the most restrictive bc</span></div>
<div class="line"><a name="l02725"></a><span class="lineno"> 2725</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> k=0;k&lt;n_dim;k++)</div>
<div class="line"><a name="l02726"></a><span class="lineno"> 2726</span>&#160;   {</div>
<div class="line"><a name="l02727"></a><span class="lineno"> 2727</span>&#160;    solid_bound_cons[k]=(bound_cons1[k]||bound_cons2[k]);</div>
<div class="line"><a name="l02728"></a><span class="lineno"> 2728</span>&#160;   }</div>
<div class="line"><a name="l02729"></a><span class="lineno"> 2729</span>&#160;   <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02730"></a><span class="lineno"> 2730</span>&#160; </div>
<div class="line"><a name="l02731"></a><span class="lineno"> 2731</span>&#160;   <span class="comment">// If there are three non-zero value, bound is a vertex</span></div>
<div class="line"><a name="l02732"></a><span class="lineno"> 2732</span>&#160;  <span class="keywordflow">case</span> 3 :</div>
<div class="line"><a name="l02733"></a><span class="lineno"> 2733</span>&#160; </div>
<div class="line"><a name="l02734"></a><span class="lineno"> 2734</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;3;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l02735"></a><span class="lineno"> 2735</span>&#160;   {</div>
<div class="line"><a name="l02736"></a><span class="lineno"> 2736</span>&#160;    vect1[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]=0; vect2[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]=0; vect3[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]=0;</div>
<div class="line"><a name="l02737"></a><span class="lineno"> 2737</span>&#160;   }</div>
<div class="line"><a name="l02738"></a><span class="lineno"> 2738</span>&#160;   <span class="comment">// vectors to the three adjacent faces of the vertex</span></div>
<div class="line"><a name="l02739"></a><span class="lineno"> 2739</span>&#160;   vect1[0]=vect_elem[0];</div>
<div class="line"><a name="l02740"></a><span class="lineno"> 2740</span>&#160;   vect2[1]=vect_elem[1];</div>
<div class="line"><a name="l02741"></a><span class="lineno"> 2741</span>&#160;   vect3[2]=vect_elem[2];</div>
<div class="line"><a name="l02742"></a><span class="lineno"> 2742</span>&#160;   </div>
<div class="line"><a name="l02743"></a><span class="lineno"> 2743</span>&#160;   get_face_solid_bcs(<a class="code" href="classoomph_1_1OcTree.html#aec83bade91057d89aa3896274cb96b7e">OcTree::Vector_to_direction</a>[vect1],bound_cons1);</div>
<div class="line"><a name="l02744"></a><span class="lineno"> 2744</span>&#160;   get_face_solid_bcs(<a class="code" href="classoomph_1_1OcTree.html#aec83bade91057d89aa3896274cb96b7e">OcTree::Vector_to_direction</a>[vect2],bound_cons2);</div>
<div class="line"><a name="l02745"></a><span class="lineno"> 2745</span>&#160;   get_face_solid_bcs(<a class="code" href="classoomph_1_1OcTree.html#aec83bade91057d89aa3896274cb96b7e">OcTree::Vector_to_direction</a>[vect3],bound_cons3);</div>
<div class="line"><a name="l02746"></a><span class="lineno"> 2746</span>&#160;   </div>
<div class="line"><a name="l02747"></a><span class="lineno"> 2747</span>&#160; </div>
<div class="line"><a name="l02748"></a><span class="lineno"> 2748</span>&#160;   <span class="comment">// set the bcs to the most restrictive ones </span></div>
<div class="line"><a name="l02749"></a><span class="lineno"> 2749</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> k=0;k&lt;n_dim;k++)</div>
<div class="line"><a name="l02750"></a><span class="lineno"> 2750</span>&#160;   {</div>
<div class="line"><a name="l02751"></a><span class="lineno"> 2751</span>&#160;    solid_bound_cons[k]=(bound_cons1[k]||bound_cons2[k]||</div>
<div class="line"><a name="l02752"></a><span class="lineno"> 2752</span>&#160;                         bound_cons3[k]);</div>
<div class="line"><a name="l02753"></a><span class="lineno"> 2753</span>&#160;   }</div>
<div class="line"><a name="l02754"></a><span class="lineno"> 2754</span>&#160;   <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02755"></a><span class="lineno"> 2755</span>&#160;   </div>
<div class="line"><a name="l02756"></a><span class="lineno"> 2756</span>&#160;  default :</div>
<div class="line"><a name="l02757"></a><span class="lineno"> 2757</span>&#160;   <span class="keywordflow">throw</span> <a class="code" href="classoomph_1_1OomphLibError.html">OomphLibError</a>(<span class="stringliteral">&quot;Make sure you are not giving  OMEGA as bound&quot;</span>,</div>
<div class="line"><a name="l02758"></a><span class="lineno"> 2758</span>&#160;                       OOMPH_CURRENT_FUNCTION,</div>
<div class="line"><a name="l02759"></a><span class="lineno"> 2759</span>&#160;                       OOMPH_EXCEPTION_LOCATION);</div>
<div class="line"><a name="l02760"></a><span class="lineno"> 2760</span>&#160;  }</div>
<div class="line"><a name="l02761"></a><span class="lineno"> 2761</span>&#160; }</div>
<div class="line"><a name="l02762"></a><span class="lineno"> 2762</span>&#160; </div>
<div class="line"><a name="l02763"></a><span class="lineno"> 2763</span>&#160;<span class="comment">//==================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l02764"></a><span class="lineno"> 2764</span>&#160;<span class="comment">/// Determine Vector of solid (positional) boundary conditions along </span></div>
<div class="line"><a name="l02765"></a><span class="lineno"> 2765</span>&#160;<span class="comment">/// the element&#39;s edge (S/N/W/E) -- BC is the least restrictive combination </span></div>
<div class="line"><a name="l02766"></a><span class="lineno"> 2766</span>&#160;<span class="comment">/// of all the nodes on this edge</span></div>
<div class="line"><a name="l02767"></a><span class="lineno"> 2767</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l02768"></a><span class="lineno"> 2768</span>&#160;<span class="comment">/// Usual convention: </span></div>
<div class="line"><a name="l02769"></a><span class="lineno"> 2769</span>&#160;<span class="comment">///   - solid_bound_cons[i]=0 if displacement in coordinate direction i</span></div>
<div class="line"><a name="l02770"></a><span class="lineno"> 2770</span>&#160;<span class="comment">///                           on this boundary is free </span></div>
<div class="line"><a name="l02771"></a><span class="lineno"> 2771</span>&#160;<span class="comment">///   - solid_bound_cons[i]=1 if it&#39;s pinned</span></div>
<div class="line"><a name="l02772"></a><span class="lineno"> 2772</span>&#160;<span class="comment"></span><span class="comment">//==================================================================</span></div>
<div class="line"><a name="l02773"></a><span class="lineno"><a class="line" href="classoomph_1_1RefineableSolidQElement_3_013_01_4.html#ac880a52e8224bd4798969c5c7b5fb540"> 2773</a></span>&#160; <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1RefineableSolidQElement.html">RefineableSolidQElement&lt;3&gt;::get_face_solid_bcs</a>(</div>
<div class="line"><a name="l02774"></a><span class="lineno"> 2774</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span>&amp; face, <a class="code" href="classoomph_1_1Vector.html">Vector&lt;int&gt;</a>&amp; solid_bound_cons)<span class="keyword"> const</span></div>
<div class="line"><a name="l02775"></a><span class="lineno"> 2775</span>&#160;<span class="keyword"> </span>{</div>
<div class="line"><a name="l02776"></a><span class="lineno"> 2776</span>&#160;  <span class="keyword">using namespace </span>OcTreeNames;</div>
<div class="line"><a name="l02777"></a><span class="lineno"> 2777</span>&#160; </div>
<div class="line"><a name="l02778"></a><span class="lineno"> 2778</span>&#160;  <span class="comment">//Number of nodes along 1D edge</span></div>
<div class="line"><a name="l02779"></a><span class="lineno"> 2779</span>&#160;  <span class="keywordtype">unsigned</span> n_p = nnode_1d();</div>
<div class="line"><a name="l02780"></a><span class="lineno"> 2780</span>&#160;  <span class="comment">//the four corner nodes on the boundary</span></div>
<div class="line"><a name="l02781"></a><span class="lineno"> 2781</span>&#160;  <span class="keywordtype">unsigned</span> node1, node2, node3, node4;</div>
<div class="line"><a name="l02782"></a><span class="lineno"> 2782</span>&#160; </div>
<div class="line"><a name="l02783"></a><span class="lineno"> 2783</span>&#160;  <span class="comment">//Set the four corner nodes for the face </span></div>
<div class="line"><a name="l02784"></a><span class="lineno"> 2784</span>&#160;  <span class="keywordflow">switch</span>(face)</div>
<div class="line"><a name="l02785"></a><span class="lineno"> 2785</span>&#160;  {</div>
<div class="line"><a name="l02786"></a><span class="lineno"> 2786</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a9d5dc3f8f9d04ae80237132101f4258f">U</a>:</div>
<div class="line"><a name="l02787"></a><span class="lineno"> 2787</span>&#160;   node1 = n_p*n_p*n_p-1; </div>
<div class="line"><a name="l02788"></a><span class="lineno"> 2788</span>&#160;   node2 = n_p*n_p - 1;</div>
<div class="line"><a name="l02789"></a><span class="lineno"> 2789</span>&#160;   node3 = n_p*(n_p-1); </div>
<div class="line"><a name="l02790"></a><span class="lineno"> 2790</span>&#160;   node4 = n_p*(n_p*n_p - 1);</div>
<div class="line"><a name="l02791"></a><span class="lineno"> 2791</span>&#160;   <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02792"></a><span class="lineno"> 2792</span>&#160; </div>
<div class="line"><a name="l02793"></a><span class="lineno"> 2793</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a51292b8e4d96f2bb9f0d6bb0340d1620">D</a>:</div>
<div class="line"><a name="l02794"></a><span class="lineno"> 2794</span>&#160;   node1 = 0;</div>
<div class="line"><a name="l02795"></a><span class="lineno"> 2795</span>&#160;   node2 = n_p-1;</div>
<div class="line"><a name="l02796"></a><span class="lineno"> 2796</span>&#160;   node3 = (n_p*n_p+1)*(n_p-1); </div>
<div class="line"><a name="l02797"></a><span class="lineno"> 2797</span>&#160;   node4 = n_p*n_p*(n_p-1);</div>
<div class="line"><a name="l02798"></a><span class="lineno"> 2798</span>&#160;   <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02799"></a><span class="lineno"> 2799</span>&#160; </div>
<div class="line"><a name="l02800"></a><span class="lineno"> 2800</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespaceoomph_1_1BinaryTreeNames.html#a7ff5e7e46beae31bf81579531b1f9895a1bf47d3f36e6272d94344ae84aca2498">R</a>:</div>
<div class="line"><a name="l02801"></a><span class="lineno"> 2801</span>&#160;   node1 = n_p-1;</div>
<div class="line"><a name="l02802"></a><span class="lineno"> 2802</span>&#160;   node2 = (n_p*n_p+1)*(n_p-1);</div>
<div class="line"><a name="l02803"></a><span class="lineno"> 2803</span>&#160;   node3 = n_p*n_p*n_p-1; </div>
<div class="line"><a name="l02804"></a><span class="lineno"> 2804</span>&#160;   node4 = n_p*n_p - 1;</div>
<div class="line"><a name="l02805"></a><span class="lineno"> 2805</span>&#160;   <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02806"></a><span class="lineno"> 2806</span>&#160; </div>
<div class="line"><a name="l02807"></a><span class="lineno"> 2807</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespaceoomph_1_1BinaryTreeNames.html#a7ff5e7e46beae31bf81579531b1f9895a8df863dabb4096fa066f7a6dbf7502d1">L</a>:</div>
<div class="line"><a name="l02808"></a><span class="lineno"> 2808</span>&#160;   node1 = 0;</div>
<div class="line"><a name="l02809"></a><span class="lineno"> 2809</span>&#160;   node2 = n_p*(n_p - 1);</div>
<div class="line"><a name="l02810"></a><span class="lineno"> 2810</span>&#160;   node3 = n_p*(n_p*n_p-1); </div>
<div class="line"><a name="l02811"></a><span class="lineno"> 2811</span>&#160;   node4 = n_p*n_p*(n_p-1);</div>
<div class="line"><a name="l02812"></a><span class="lineno"> 2812</span>&#160;   <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02813"></a><span class="lineno"> 2813</span>&#160; </div>
<div class="line"><a name="l02814"></a><span class="lineno"> 2814</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a43c804e2bcf9862a4bf629d5f01761e8">B</a> :</div>
<div class="line"><a name="l02815"></a><span class="lineno"> 2815</span>&#160;   node1 = 0;</div>
<div class="line"><a name="l02816"></a><span class="lineno"> 2816</span>&#160;   node2 = n_p-1;</div>
<div class="line"><a name="l02817"></a><span class="lineno"> 2817</span>&#160;   node3 = n_p*n_p-1; </div>
<div class="line"><a name="l02818"></a><span class="lineno"> 2818</span>&#160;   node4 = n_p*(n_p -1);</div>
<div class="line"><a name="l02819"></a><span class="lineno"> 2819</span>&#160;   <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02820"></a><span class="lineno"> 2820</span>&#160;   </div>
<div class="line"><a name="l02821"></a><span class="lineno"> 2821</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a755807a4724a0f4d96f0817559c0a927">F</a> :</div>
<div class="line"><a name="l02822"></a><span class="lineno"> 2822</span>&#160;   node1 = n_p*n_p*n_p-1;</div>
<div class="line"><a name="l02823"></a><span class="lineno"> 2823</span>&#160;   node2 = n_p*(n_p*n_p-1);</div>
<div class="line"><a name="l02824"></a><span class="lineno"> 2824</span>&#160;   node3 = n_p*n_p*(n_p-1); </div>
<div class="line"><a name="l02825"></a><span class="lineno"> 2825</span>&#160;   node4 = (n_p-1)*(n_p*n_p+1);</div>
<div class="line"><a name="l02826"></a><span class="lineno"> 2826</span>&#160;   <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02827"></a><span class="lineno"> 2827</span>&#160; </div>
<div class="line"><a name="l02828"></a><span class="lineno"> 2828</span>&#160;  <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l02829"></a><span class="lineno"> 2829</span>&#160;   std::ostringstream error_stream;</div>
<div class="line"><a name="l02830"></a><span class="lineno"> 2830</span>&#160;   error_stream &lt;&lt; <span class="stringliteral">&quot;Wrong edge &quot;</span> &lt;&lt; face &lt;&lt; <span class="stringliteral">&quot; passed\n&quot;</span>;</div>
<div class="line"><a name="l02831"></a><span class="lineno"> 2831</span>&#160; </div>
<div class="line"><a name="l02832"></a><span class="lineno"> 2832</span>&#160;   <span class="keywordflow">throw</span> <a class="code" href="classoomph_1_1OomphLibError.html">OomphLibError</a>(error_stream.str(),</div>
<div class="line"><a name="l02833"></a><span class="lineno"> 2833</span>&#160;                       OOMPH_CURRENT_FUNCTION,</div>
<div class="line"><a name="l02834"></a><span class="lineno"> 2834</span>&#160;                       OOMPH_EXCEPTION_LOCATION);</div>
<div class="line"><a name="l02835"></a><span class="lineno"> 2835</span>&#160;  }</div>
<div class="line"><a name="l02836"></a><span class="lineno"> 2836</span>&#160; </div>
<div class="line"><a name="l02837"></a><span class="lineno"> 2837</span>&#160;  <span class="comment">//Cast to solid nodes</span></div>
<div class="line"><a name="l02838"></a><span class="lineno"> 2838</span>&#160;  <a class="code" href="classoomph_1_1SolidNode.html">SolidNode</a> *solid_node1_pt = <span class="keyword">dynamic_cast&lt;</span><a class="code" href="classoomph_1_1SolidNode.html">SolidNode</a>*<span class="keyword">&gt;</span>(node_pt(node1)); </div>
<div class="line"><a name="l02839"></a><span class="lineno"> 2839</span>&#160;  <a class="code" href="classoomph_1_1SolidNode.html">SolidNode</a> *solid_node2_pt = <span class="keyword">dynamic_cast&lt;</span><a class="code" href="classoomph_1_1SolidNode.html">SolidNode</a>*<span class="keyword">&gt;</span>(node_pt(node2)); </div>
<div class="line"><a name="l02840"></a><span class="lineno"> 2840</span>&#160;  <a class="code" href="classoomph_1_1SolidNode.html">SolidNode</a> *solid_node3_pt = <span class="keyword">dynamic_cast&lt;</span><a class="code" href="classoomph_1_1SolidNode.html">SolidNode</a>*<span class="keyword">&gt;</span>(node_pt(node3)); </div>
<div class="line"><a name="l02841"></a><span class="lineno"> 2841</span>&#160;  <a class="code" href="classoomph_1_1SolidNode.html">SolidNode</a> *solid_node4_pt = <span class="keyword">dynamic_cast&lt;</span><a class="code" href="classoomph_1_1SolidNode.html">SolidNode</a>*<span class="keyword">&gt;</span>(node_pt(node4)); </div>
<div class="line"><a name="l02842"></a><span class="lineno"> 2842</span>&#160; </div>
<div class="line"><a name="l02843"></a><span class="lineno"> 2843</span>&#160;<span class="comment">//#ifdef PARANOID</span></div>
<div class="line"><a name="l02844"></a><span class="lineno"> 2844</span>&#160;  <span class="keywordflow">if</span> (solid_node1_pt==0)</div>
<div class="line"><a name="l02845"></a><span class="lineno"> 2845</span>&#160;  {</div>
<div class="line"><a name="l02846"></a><span class="lineno"> 2846</span>&#160;   <span class="keywordflow">throw</span> <a class="code" href="classoomph_1_1OomphLibError.html">OomphLibError</a>(</div>
<div class="line"><a name="l02847"></a><span class="lineno"> 2847</span>&#160;    <span class="stringliteral">&quot;Corner node 1 cannot be cast to SolidNode --&gt; something is wrong&quot;</span>,</div>
<div class="line"><a name="l02848"></a><span class="lineno"> 2848</span>&#160;    OOMPH_CURRENT_FUNCTION,</div>
<div class="line"><a name="l02849"></a><span class="lineno"> 2849</span>&#160;    OOMPH_EXCEPTION_LOCATION);</div>
<div class="line"><a name="l02850"></a><span class="lineno"> 2850</span>&#160;  }</div>
<div class="line"><a name="l02851"></a><span class="lineno"> 2851</span>&#160; </div>
<div class="line"><a name="l02852"></a><span class="lineno"> 2852</span>&#160;  <span class="keywordflow">if</span> (solid_node2_pt==0)</div>
<div class="line"><a name="l02853"></a><span class="lineno"> 2853</span>&#160;  {</div>
<div class="line"><a name="l02854"></a><span class="lineno"> 2854</span>&#160;   <span class="keywordflow">throw</span> <a class="code" href="classoomph_1_1OomphLibError.html">OomphLibError</a>(</div>
<div class="line"><a name="l02855"></a><span class="lineno"> 2855</span>&#160;    <span class="stringliteral">&quot;Corner node 2 cannot be cast to SolidNode --&gt; something is wrong&quot;</span>,</div>
<div class="line"><a name="l02856"></a><span class="lineno"> 2856</span>&#160;    OOMPH_CURRENT_FUNCTION,</div>
<div class="line"><a name="l02857"></a><span class="lineno"> 2857</span>&#160;    OOMPH_EXCEPTION_LOCATION);</div>
<div class="line"><a name="l02858"></a><span class="lineno"> 2858</span>&#160;  }</div>
<div class="line"><a name="l02859"></a><span class="lineno"> 2859</span>&#160; </div>
<div class="line"><a name="l02860"></a><span class="lineno"> 2860</span>&#160;  <span class="keywordflow">if</span> (solid_node3_pt==0)</div>
<div class="line"><a name="l02861"></a><span class="lineno"> 2861</span>&#160;  {</div>
<div class="line"><a name="l02862"></a><span class="lineno"> 2862</span>&#160;   <span class="keywordflow">throw</span> <a class="code" href="classoomph_1_1OomphLibError.html">OomphLibError</a>(</div>
<div class="line"><a name="l02863"></a><span class="lineno"> 2863</span>&#160;    <span class="stringliteral">&quot;Corner node 3 cannot be cast to SolidNode --&gt; something is wrong&quot;</span>,</div>
<div class="line"><a name="l02864"></a><span class="lineno"> 2864</span>&#160;    OOMPH_CURRENT_FUNCTION,</div>
<div class="line"><a name="l02865"></a><span class="lineno"> 2865</span>&#160;    OOMPH_EXCEPTION_LOCATION);</div>
<div class="line"><a name="l02866"></a><span class="lineno"> 2866</span>&#160;  }</div>
<div class="line"><a name="l02867"></a><span class="lineno"> 2867</span>&#160; </div>
<div class="line"><a name="l02868"></a><span class="lineno"> 2868</span>&#160;  <span class="keywordflow">if</span> (solid_node4_pt==0)</div>
<div class="line"><a name="l02869"></a><span class="lineno"> 2869</span>&#160;  {</div>
<div class="line"><a name="l02870"></a><span class="lineno"> 2870</span>&#160;   <span class="keywordflow">throw</span> <a class="code" href="classoomph_1_1OomphLibError.html">OomphLibError</a>(</div>
<div class="line"><a name="l02871"></a><span class="lineno"> 2871</span>&#160;    <span class="stringliteral">&quot;Corner node 4 cannot be cast to SolidNode --&gt; something is wrong&quot;</span>,</div>
<div class="line"><a name="l02872"></a><span class="lineno"> 2872</span>&#160;    OOMPH_CURRENT_FUNCTION,</div>
<div class="line"><a name="l02873"></a><span class="lineno"> 2873</span>&#160;    OOMPH_EXCEPTION_LOCATION);</div>
<div class="line"><a name="l02874"></a><span class="lineno"> 2874</span>&#160;  }</div>
<div class="line"><a name="l02875"></a><span class="lineno"> 2875</span>&#160; </div>
<div class="line"><a name="l02876"></a><span class="lineno"> 2876</span>&#160;<span class="comment">//#endif</span></div>
<div class="line"><a name="l02877"></a><span class="lineno"> 2877</span>&#160; </div>
<div class="line"><a name="l02878"></a><span class="lineno"> 2878</span>&#160;  <span class="comment">//Number of coordinates</span></div>
<div class="line"><a name="l02879"></a><span class="lineno"> 2879</span>&#160;  <span class="keywordtype">unsigned</span> n_dim = this-&gt;nodal_dimension();</div>
<div class="line"><a name="l02880"></a><span class="lineno"> 2880</span>&#160; </div>
<div class="line"><a name="l02881"></a><span class="lineno"> 2881</span>&#160;  <span class="comment">//Loop over all directions, the least restrictive value is </span></div>
<div class="line"><a name="l02882"></a><span class="lineno"> 2882</span>&#160;  <span class="comment">//the multiplication of the boundary conditions at the 4 nodes</span></div>
<div class="line"><a name="l02883"></a><span class="lineno"> 2883</span>&#160;  <span class="comment">//Assuming that free is always zero and pinned is one</span></div>
<div class="line"><a name="l02884"></a><span class="lineno"> 2884</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> k=0;k&lt;n_dim;k++)</div>
<div class="line"><a name="l02885"></a><span class="lineno"> 2885</span>&#160;  {</div>
<div class="line"><a name="l02886"></a><span class="lineno"> 2886</span>&#160;   solid_bound_cons[k] = </div>
<div class="line"><a name="l02887"></a><span class="lineno"> 2887</span>&#160;    solid_node1_pt-&gt;<a class="code" href="classoomph_1_1SolidNode.html#afd8204156be2ff0fa40834ca35daf243">position_is_pinned</a>(k)*</div>
<div class="line"><a name="l02888"></a><span class="lineno"> 2888</span>&#160;    solid_node2_pt-&gt;<a class="code" href="classoomph_1_1SolidNode.html#afd8204156be2ff0fa40834ca35daf243">position_is_pinned</a>(k)*</div>
<div class="line"><a name="l02889"></a><span class="lineno"> 2889</span>&#160;    solid_node3_pt-&gt;<a class="code" href="classoomph_1_1SolidNode.html#afd8204156be2ff0fa40834ca35daf243">position_is_pinned</a>(k)*</div>
<div class="line"><a name="l02890"></a><span class="lineno"> 2890</span>&#160;    solid_node4_pt-&gt;<a class="code" href="classoomph_1_1SolidNode.html#afd8204156be2ff0fa40834ca35daf243">position_is_pinned</a>(k);</div>
<div class="line"><a name="l02891"></a><span class="lineno"> 2891</span>&#160;  }</div>
<div class="line"><a name="l02892"></a><span class="lineno"> 2892</span>&#160; </div>
<div class="line"><a name="l02893"></a><span class="lineno"> 2893</span>&#160; }</div>
<div class="line"><a name="l02894"></a><span class="lineno"> 2894</span>&#160; </div>
<div class="line"><a name="l02895"></a><span class="lineno"> 2895</span>&#160; </div>
<div class="line"><a name="l02896"></a><span class="lineno"> 2896</span>&#160; </div>
<div class="line"><a name="l02897"></a><span class="lineno"> 2897</span>&#160;<span class="comment">//========================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l02898"></a><span class="lineno"> 2898</span>&#160;<span class="comment">/// Static matrix for coincidence between son nodal points and </span></div>
<div class="line"><a name="l02899"></a><span class="lineno"> 2899</span>&#160;<span class="comment">/// father boundaries</span></div>
<div class="line"><a name="l02900"></a><span class="lineno"> 2900</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l02901"></a><span class="lineno"> 2901</span>&#160;<span class="comment"></span><span class="comment">//========================================================================</span></div>
<div class="line"><a name="l02902"></a><span class="lineno"> 2902</span>&#160; std::map&lt;unsigned,DenseMatrix&lt;int&gt; &gt; <a class="code" href="classoomph_1_1RefineableQElement.html">RefineableQElement&lt;3&gt;::Father_bound</a>;</div>
<div class="line"><a name="l02903"></a><span class="lineno"> 2903</span>&#160; </div>
<div class="line"><a name="l02904"></a><span class="lineno"> 2904</span>&#160; </div>
<div class="line"><a name="l02905"></a><span class="lineno"> 2905</span>&#160;}</div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="anamespaceoomph_html_aec474227917784dc0a255faf289cfc16"><div class="ttname"><a href="namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph::oomph_info</a></div><div class="ttdeci">OomphInfo oomph_info</div><div class="ttdef"><b>Definition:</b> <a href="oomph__definitions_8cc_source.html#l00322">oomph_definitions.cc:322</a></div></div>
<div class="ttc" id="aclassoomph_1_1RefineableSolidQElement_3_013_01_4_html"><div class="ttname"><a href="classoomph_1_1RefineableSolidQElement_3_013_01_4.html">oomph::RefineableSolidQElement&lt; 3 &gt;</a></div><div class="ttdoc">Refineable version of Solid brick elements.</div><div class="ttdef"><b>Definition:</b> <a href="refineable__brick__element_8h_source.html#l00235">refineable_brick_element.h:235</a></div></div>
<div class="ttc" id="aclassoomph_1_1OcTree_html_a690c4fbbca73bd48c0bc3b2913a9b39c"><div class="ttname"><a href="classoomph_1_1OcTree.html#a690c4fbbca73bd48c0bc3b2913a9b39c">oomph::OcTree::gteq_face_neighbour</a></div><div class="ttdeci">OcTree * gteq_face_neighbour(const int &amp;direction, Vector&lt; unsigned &gt; &amp;translate_s, Vector&lt; double &gt; &amp;s_sw, Vector&lt; double &gt; &amp;s_ne, int &amp;face, int &amp;diff_level, bool &amp;in_neighbouring_tree) const</div><div class="ttdoc">Find (pointer to) greater-or-equal-sized face neighbour in given direction (L/R/U/D/F/B)....</div><div class="ttdef"><b>Definition:</b> <a href="octree_8cc_source.html#l03343">octree.cc:3343</a></div></div>
<div class="ttc" id="aclassoomph_1_1FiniteElement_html_ace0e7fb72a805b5c2c600347bfae7a9b"><div class="ttname"><a href="classoomph_1_1FiniteElement.html#ace0e7fb72a805b5c2c600347bfae7a9b">oomph::FiniteElement::node_pt</a></div><div class="ttdeci">Node *&amp; node_pt(const unsigned &amp;n)</div><div class="ttdoc">Return a pointer to the local node n.</div><div class="ttdef"><b>Definition:</b> <a href="elements_8h_source.html#l02122">elements.h:2122</a></div></div>
<div class="ttc" id="aclassoomph_1_1RefineableElement_html_ad9a4f92880668a2373326d8306365c43"><div class="ttname"><a href="classoomph_1_1RefineableElement.html#ad9a4f92880668a2373326d8306365c43">oomph::RefineableElement::get_interpolated_values</a></div><div class="ttdeci">virtual void get_interpolated_values(const Vector&lt; double &gt; &amp;s, Vector&lt; double &gt; &amp;values)</div><div class="ttdoc">Get all continously interpolated function values in this element as a Vector. Note: Vector sets is ow...</div><div class="ttdef"><b>Definition:</b> <a href="refineable__elements_8h_source.html#l00365">refineable_elements.h:365</a></div></div>
<div class="ttc" id="aclassoomph_1_1ElementWithMovingNodes_html_a600d39b3c167989dd8eed5869726d35b"><div class="ttname"><a href="classoomph_1_1ElementWithMovingNodes.html#a600d39b3c167989dd8eed5869726d35b">oomph::ElementWithMovingNodes::method_for_shape_derivs</a></div><div class="ttdeci">int &amp; method_for_shape_derivs()</div><div class="ttdoc">Access to method (enumerated flag) for determination of shape derivs.</div><div class="ttdef"><b>Definition:</b> <a href="element__with__moving__nodes_8h_source.html#l00267">element_with_moving_nodes.h:267</a></div></div>
<div class="ttc" id="aclassoomph_1_1RefineableSolidQElement_html"><div class="ttname"><a href="classoomph_1_1RefineableSolidQElement.html">oomph::RefineableSolidQElement</a></div><div class="ttdef"><b>Definition:</b> <a href="Qelements_8h_source.html#l02152">Qelements.h:2152</a></div></div>
<div class="ttc" id="aclassoomph_1_1OcTree_html_a2e9487b716f4d583aada06a850b8eae9"><div class="ttname"><a href="classoomph_1_1OcTree.html#a2e9487b716f4d583aada06a850b8eae9">oomph::OcTree::Direct_string</a></div><div class="ttdeci">static Vector&lt; std::string &gt; Direct_string</div><div class="ttdoc">Translate (enumerated) directions into strings.</div><div class="ttdef"><b>Definition:</b> <a href="octree_8h_source.html#l00314">octree.h:314</a></div></div>
<div class="ttc" id="aclassoomph_1_1Tree_html_a7537f8fe7c896d2220eb2da03567b34d"><div class="ttname"><a href="classoomph_1_1Tree.html#a7537f8fe7c896d2220eb2da03567b34d">oomph::Tree::son_type</a></div><div class="ttdeci">int son_type() const</div><div class="ttdoc">Return son type.</div><div class="ttdef"><b>Definition:</b> <a href="tree_8h_source.html#l00205">tree.h:205</a></div></div>
<div class="ttc" id="aclassoomph_1_1FiniteElement_html_a35f0803115b68bd162c07de04eeb6c5c"><div class="ttname"><a href="classoomph_1_1FiniteElement.html#a35f0803115b68bd162c07de04eeb6c5c">oomph::FiniteElement::s_min</a></div><div class="ttdeci">virtual double s_min() const</div><div class="ttdoc">Min value of local coordinate.</div><div class="ttdef"><b>Definition:</b> <a href="elements_8h_source.html#l02656">elements.h:2656</a></div></div>
<div class="ttc" id="aclassoomph_1_1Data_html_a7289ca322725c6fd493970a19474b382"><div class="ttname"><a href="classoomph_1_1Data.html#a7289ca322725c6fd493970a19474b382">oomph::Data::set_value</a></div><div class="ttdeci">void set_value(const unsigned &amp;i, const double &amp;value_)</div><div class="ttdoc">Set the i-th stored data value to specified value. The only reason that we require an explicit set fu...</div><div class="ttdef"><b>Definition:</b> <a href="nodes_8h_source.html#l00263">nodes.h:263</a></div></div>
<div class="ttc" id="athe__data__structure_8txt_html_ae56499a02d89f315ab025070e7a0058f"><div class="ttname"><a href="the__data__structure_8txt.html#ae56499a02d89f315ab025070e7a0058f">node</a></div><div class="ttdeci">c Data can also store a certain number of c Data stores a pointer to a c TimeStepper whose member functions relate the history values to the values time derivatives pointer based read write access to the c Data values is provided by the functions code and by code Data::value_pt(t, i) \endcode which returns a pointer to the \c t -th history value associated with value \c i. Read-only access is also provided by the functions \code Data and its time dependent counterpart code whereas the values associated with t correspond to history values In many but this is not guaranteed See the section ref timestepping for further details subsection nodes Nodes In FE all c Nodes in a finite element mesh have c Data associated with them c Nodes are therefore derived from c but also store a spatial specified by a certain number of spatial(Eulerian) coordinates. The nodal positions are accessed by the member function \code Node note that the history values are not necessarily positions at previous timesteps subsubsection advanced_features_of_nodes Advanced we must evaluate mesh which requires the storage of the nodal position at a number of previous timesteps Storage for the positional history values is allocated by the c Node constructor A different c TimeStepper may be used to represent time derivatives of nodal so c Nodes store a separate pointer to a positional c TimeStepper[Note:By default, we allocate the same amount of storage for the history of the nodal positions as we do for the history of the nodal values;e.g. if a \c BDF&lt; 2 &gt; scheme is used to evaluate the time-derivatives of the fluid velocities, we assume that the same timestepping scheme is used(and the same amount of storage required) to determine the mesh velocities from the nodal positions.] For finite elements in which the global position of a point in an element is determined by interpolation from the position of the element s c we need only store the spatial position of the c Nodes In many other the interpolation of the geometry requires additional e g the derivative of the mapping between and global coordinates we allow the storage of additional positional variables at each c so in every c Node has a number of e generalised coordinates for each spatial coordinate direction For for nodes in Hermite the nodal coordinate of type stores the global position at the node</div><div class="ttdef"><b>Definition:</b> <a href="the__data__structure_8txt_source.html#l00190">the_data_structure.txt:190</a></div></div>
<div class="ttc" id="anamespaceoomph_1_1OcTreeNames_html_ae7e7e58298b85825061eeff362656c40a755807a4724a0f4d96f0817559c0a927"><div class="ttname"><a href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a755807a4724a0f4d96f0817559c0a927">oomph::OcTreeNames::F</a></div><div class="ttdeci">@ F</div><div class="ttdef"><b>Definition:</b> <a href="octree_8h_source.html#l00055">octree.h:55</a></div></div>
<div class="ttc" id="anamespaceoomph_1_1OcTreeNames_html_ae7e7e58298b85825061eeff362656c40a854222a7a6f7470d6803ffb8d11180bc"><div class="ttname"><a href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a854222a7a6f7470d6803ffb8d11180bc">oomph::OcTreeNames::LF</a></div><div class="ttdeci">@ LF</div><div class="ttdef"><b>Definition:</b> <a href="octree_8h_source.html#l00054">octree.h:54</a></div></div>
<div class="ttc" id="aclassoomph_1_1RefineableElement_html_ab27986fc2f6033a4758662cde78a7b76"><div class="ttname"><a href="classoomph_1_1RefineableElement.html#ab27986fc2f6033a4758662cde78a7b76">oomph::RefineableElement::interpolating_node_pt</a></div><div class="ttdeci">virtual Node * interpolating_node_pt(const unsigned &amp;n, const int &amp;value_id)</div><div class="ttdoc">In mixed elements, different sets of nodes are used to interpolate different unknowns....</div><div class="ttdef"><b>Definition:</b> <a href="refineable__elements_8h_source.html#l00385">refineable_elements.h:385</a></div></div>
<div class="ttc" id="aclassoomph_1_1RefineableQElement_3_013_01_4_html_aac2601ff8f740680675e5e6ba5c35e9d"><div class="ttname"><a href="classoomph_1_1RefineableQElement_3_013_01_4.html#aac2601ff8f740680675e5e6ba5c35e9d">oomph::RefineableQElement&lt; 3 &gt;::get_bcs</a></div><div class="ttdeci">void get_bcs(int bound, Vector&lt; int &gt; &amp;bound_cons) const</div><div class="ttdoc">Determine Vector of boundary conditions along the element's boundary (or vertex) bound (S/W/N/E/SW/SE...</div><div class="ttdef"><b>Definition:</b> <a href="refineable__brick__element_8cc_source.html#l00220">refineable_brick_element.cc:220</a></div></div>
<div class="ttc" id="anamespaceoomph_1_1OcTreeNames_html_ae7e7e58298b85825061eeff362656c40a37246039cac1119e55029efcae57ef85"><div class="ttname"><a href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a37246039cac1119e55029efcae57ef85">oomph::OcTreeNames::RD</a></div><div class="ttdeci">@ RD</div><div class="ttdef"><b>Definition:</b> <a href="octree_8h_source.html#l00053">octree.h:53</a></div></div>
<div class="ttc" id="aclassoomph_1_1Node_html_a94c19e165ab4e88aabbfa27443c530b7"><div class="ttname"><a href="classoomph_1_1Node.html#a94c19e165ab4e88aabbfa27443c530b7">oomph::Node::set_coordinates_on_boundary</a></div><div class="ttdeci">virtual void set_coordinates_on_boundary(const unsigned &amp;b, const unsigned &amp;k, const Vector&lt; double &gt; &amp;boundary_zeta)</div><div class="ttdoc">Set the vector of the k-th generalised boundary coordinates on mesh boundary b. Broken virtual interf...</div><div class="ttdef"><b>Definition:</b> <a href="nodes_8cc_source.html#l02311">nodes.cc:2311</a></div></div>
<div class="ttc" id="aclassoomph_1_1RefineableQElement_3_013_01_4_html_ac61083ce6abe6338ec5d7795d9f1e051"><div class="ttname"><a href="classoomph_1_1RefineableQElement_3_013_01_4.html#ac61083ce6abe6338ec5d7795d9f1e051">oomph::RefineableQElement&lt; 3 &gt;::get_boundaries</a></div><div class="ttdeci">void get_boundaries(const int &amp;edge, std::set&lt; unsigned &gt; &amp;boundaries) const</div><div class="ttdef"><b>Definition:</b> <a href="refineable__brick__element_8cc_source.html#l00406">refineable_brick_element.cc:406</a></div></div>
<div class="ttc" id="aclassoomph_1_1OomphLibError_html"><div class="ttname"><a href="classoomph_1_1OomphLibError.html">oomph::OomphLibError</a></div><div class="ttdef"><b>Definition:</b> <a href="oomph__definitions_8h_source.html#l00225">oomph_definitions.h:225</a></div></div>
<div class="ttc" id="aclassoomph_1_1SolidNode_html_afd8204156be2ff0fa40834ca35daf243"><div class="ttname"><a href="classoomph_1_1SolidNode.html#afd8204156be2ff0fa40834ca35daf243">oomph::SolidNode::position_is_pinned</a></div><div class="ttdeci">bool position_is_pinned(const unsigned &amp;i)</div><div class="ttdoc">Test whether the i-th coordinate is pinned, 0: false; 1: true.</div><div class="ttdef"><b>Definition:</b> <a href="nodes_8h_source.html#l01680">nodes.h:1680</a></div></div>
<div class="ttc" id="aclassoomph_1_1FiniteElement_html_a5a9c1ead9819cd17603096e63087020f"><div class="ttname"><a href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">oomph::FiniteElement::interpolated_x</a></div><div class="ttdeci">virtual double interpolated_x(const Vector&lt; double &gt; &amp;s, const unsigned &amp;i) const</div><div class="ttdoc">Return FE interpolated coordinate x[i] at local coordinate s.</div><div class="ttdef"><b>Definition:</b> <a href="elements_8cc_source.html#l03877">elements.cc:3877</a></div></div>
<div class="ttc" id="aclassoomph_1_1FiniteElement_html_aa8bce95f69e3199a508672eea7ecc226"><div class="ttname"><a href="classoomph_1_1FiniteElement.html#aa8bce95f69e3199a508672eea7ecc226">oomph::FiniteElement::macro_elem_pt</a></div><div class="ttdeci">MacroElement * macro_elem_pt()</div><div class="ttdoc">Access function to pointer to macro element.</div><div class="ttdef"><b>Definition:</b> <a href="elements_8h_source.html#l01850">elements.h:1850</a></div></div>
<div class="ttc" id="athe__data__structure_8txt_html_a23b5a245f0462b0a4823b0eb07a65baf"><div class="ttname"><a href="the__data__structure_8txt.html#a23b5a245f0462b0a4823b0eb07a65baf">element</a></div><div class="ttdeci">the nodal coordinates represent the c Nodes fixed positions in this domain When the elastic body material which can be unknowns in the problem To avoid confusion between the the access function for the nodal code we provide a wrapper code in the case of generalised coordinates code Node::x_gen(...) \endcode always refers to the generalised Eulerian position and \code SolidNode endcode where the c MultiPhysicsElement inherits from c SinglePhysicsOneElement and c SinglePhysicsTwoElement A problem with this implementation arises when we consider where to initialise the residuals vector If the second single physics c then the contribution of the first single physics element will be negated When writing a single physics element</div><div class="ttdef"><b>Definition:</b> <a href="the__data__structure_8txt_source.html#l00302">the_data_structure.txt:302</a></div></div>
<div class="ttc" id="aalgebraic__elements_8h_html"><div class="ttname"><a href="algebraic__elements_8h.html">algebraic_elements.h</a></div></div>
<div class="ttc" id="anamespaceoomph_1_1OcTreeNames_html_ae7e7e58298b85825061eeff362656c40a593ad5f0759943d367efb7f308deabc4"><div class="ttname"><a href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a593ad5f0759943d367efb7f308deabc4">oomph::OcTreeNames::RB</a></div><div class="ttdeci">@ RB</div><div class="ttdef"><b>Definition:</b> <a href="octree_8h_source.html#l00052">octree.h:52</a></div></div>
<div class="ttc" id="anamespaceoomph_1_1OcTreeNames_html_ae7e7e58298b85825061eeff362656c40afd5ae3a92102eb1faf7e8e77c6742831"><div class="ttname"><a href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40afd5ae3a92102eb1faf7e8e77c6742831">oomph::OcTreeNames::UB</a></div><div class="ttdeci">@ UB</div><div class="ttdef"><b>Definition:</b> <a href="octree_8h_source.html#l00052">octree.h:52</a></div></div>
<div class="ttc" id="anamespaceoomph_1_1CumulativeTimings_html_aeafe5cb81741d54561e4b62572a1e3df"><div class="ttname"><a href="namespaceoomph_1_1CumulativeTimings.html#aeafe5cb81741d54561e4b62572a1e3df">oomph::CumulativeTimings::start</a></div><div class="ttdeci">void start(const unsigned &amp;i)</div><div class="ttdoc">(Re-)start i-th timer</div><div class="ttdef"><b>Definition:</b> <a href="oomph__utilities_8cc_source.html#l00248">oomph_utilities.cc:248</a></div></div>
<div class="ttc" id="aclassoomph_1_1RefineableElement_html_a53e171a18c9f43f1db90a6876516a073"><div class="ttname"><a href="classoomph_1_1RefineableElement.html#a53e171a18c9f43f1db90a6876516a073">oomph::RefineableElement::ncont_interpolated_values</a></div><div class="ttdeci">virtual unsigned ncont_interpolated_values() const =0</div><div class="ttdoc">Number of continuously interpolated values. Note: We assume that they are located at the beginning of...</div></div>
<div class="ttc" id="aclassoomph_1_1FiniteElement_html_a64adbe9356927133686ab53f00341ea8"><div class="ttname"><a href="classoomph_1_1FiniteElement.html#a64adbe9356927133686ab53f00341ea8">oomph::FiniteElement::s_max</a></div><div class="ttdeci">virtual double s_max() const</div><div class="ttdoc">Max. value of local coordinate.</div><div class="ttdef"><b>Definition:</b> <a href="elements_8h_source.html#l02667">elements.h:2667</a></div></div>
<div class="ttc" id="aclassoomph_1_1MacroElementNodeUpdateElementBase_html"><div class="ttname"><a href="classoomph_1_1MacroElementNodeUpdateElementBase.html">oomph::MacroElementNodeUpdateElementBase</a></div><div class="ttdoc">Base class for elements that allow MacroElement-based node update.</div><div class="ttdef"><b>Definition:</b> <a href="macro__element__node__update__element_8h_source.html#l00205">macro_element_node_update_element.h:205</a></div></div>
<div class="ttc" id="aclassoomph_1_1Mesh_html"><div class="ttname"><a href="classoomph_1_1Mesh.html">oomph::Mesh</a></div><div class="ttdoc">A general mesh class.</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8h_source.html#l00070">mesh.h:70</a></div></div>
<div class="ttc" id="aclassoomph_1_1TreeRoot_html_a7be347e54e34f924c008c302f5146064"><div class="ttname"><a href="classoomph_1_1TreeRoot.html#a7be347e54e34f924c008c302f5146064">oomph::TreeRoot::is_neighbour_periodic</a></div><div class="ttdeci">bool is_neighbour_periodic(const int &amp;direction)</div><div class="ttdoc">Return whether the neighbour in the particular direction is periodic.</div><div class="ttdef"><b>Definition:</b> <a href="tree_8h_source.html#l00346">tree.h:346</a></div></div>
<div class="ttc" id="aclassoomph_1_1Node_html_ab7b94371e9a8b62fe9a5cc7a03113ad9"><div class="ttname"><a href="classoomph_1_1Node.html#ab7b94371e9a8b62fe9a5cc7a03113ad9">oomph::Node::hanging_pt</a></div><div class="ttdeci">HangInfo *const &amp; hanging_pt() const</div><div class="ttdoc">Return pointer to hanging node data (this refers to the geometric hanging node status) (const version...</div><div class="ttdef"><b>Definition:</b> <a href="nodes_8h_source.html#l01143">nodes.h:1143</a></div></div>
<div class="ttc" id="anamespaceoomph_1_1OcTreeNames_html_ae7e7e58298b85825061eeff362656c40aa2aad9af9821c9f410b188efa95908d1"><div class="ttname"><a href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40aa2aad9af9821c9f410b188efa95908d1">oomph::OcTreeNames::RF</a></div><div class="ttdeci">@ RF</div><div class="ttdef"><b>Definition:</b> <a href="octree_8h_source.html#l00054">octree.h:54</a></div></div>
<div class="ttc" id="aclassoomph_1_1Data_html_a7e67fc78a2e8a2fd6eb75bd292d42ff8"><div class="ttname"><a href="classoomph_1_1Data.html#a7e67fc78a2e8a2fd6eb75bd292d42ff8">oomph::Data::nvalue</a></div><div class="ttdeci">unsigned nvalue() const</div><div class="ttdoc">Return number of values stored in data object (incl pinned ones).</div><div class="ttdef"><b>Definition:</b> <a href="nodes_8h_source.html#l00444">nodes.h:444</a></div></div>
<div class="ttc" id="aclassoomph_1_1RefineableElement_html"><div class="ttname"><a href="classoomph_1_1RefineableElement.html">oomph::RefineableElement</a></div><div class="ttdef"><b>Definition:</b> <a href="refineable__elements_8h_source.html#l00097">refineable_elements.h:97</a></div></div>
<div class="ttc" id="aclassoomph_1_1FiniteElement_html_a6fc14cbf4e1d031acbc59b415cefa1ca"><div class="ttname"><a href="classoomph_1_1FiniteElement.html#a6fc14cbf4e1d031acbc59b415cefa1ca">oomph::FiniteElement::get_x</a></div><div class="ttdeci">void get_x(const Vector&lt; double &gt; &amp;s, Vector&lt; double &gt; &amp;x) const</div><div class="ttdoc">Global coordinates as function of local coordinates. Either via FE representation or via macro-elemen...</div><div class="ttdef"><b>Definition:</b> <a href="elements_8h_source.html#l01854">elements.h:1854</a></div></div>
<div class="ttc" id="athe__data__structure_8txt_html_a5641be16902d346c51580a49fb9885dc"><div class="ttname"><a href="the__data__structure_8txt.html#a5641be16902d346c51580a49fb9885dc">boundaries</a></div><div class="ttdeci">in the role of the member functions c Node::position() and \c Node the latter case arises if the c Node is located on edges and corners of the mesh Storage of this information facilitates the automatic determination of boundary conditions for new c Nodes that are created during mesh refinement n The majority of the c Nodes will b not be located on boundaries</div><div class="ttdef"><b>Definition:</b> <a href="the__data__structure_8txt_source.html#l00201">the_data_structure.txt:201</a></div></div>
<div class="ttc" id="aclassoomph_1_1RefineableElement_html_a8b1b5031b55141567ba24913a21534f4"><div class="ttname"><a href="classoomph_1_1RefineableElement.html#a8b1b5031b55141567ba24913a21534f4">oomph::RefineableElement::ninterpolating_node</a></div><div class="ttdeci">virtual unsigned ninterpolating_node(const int &amp;value_id)</div><div class="ttdoc">Return the number of nodes that are used to interpolate the value_id-th unknown. Default is to assume...</div><div class="ttdef"><b>Definition:</b> <a href="refineable__elements_8h_source.html#l00410">refineable_elements.h:410</a></div></div>
<div class="ttc" id="athe__data__structure_8txt_html_a70eaf7a61463de09f737da1f4bb551c3"><div class="ttname"><a href="the__data__structure_8txt.html#a70eaf7a61463de09f737da1f4bb551c3">values</a></div><div class="ttdeci">endcode We introduce wrapper functions to access function values</div><div class="ttdef"><b>Definition:</b> <a href="the__data__structure_8txt_source.html#l00580">the_data_structure.txt:580</a></div></div>
<div class="ttc" id="aclassoomph_1_1RefineableElement_html_a50758228db823d72ea8da23dbb000901"><div class="ttname"><a href="classoomph_1_1RefineableElement.html#a50758228db823d72ea8da23dbb000901">oomph::RefineableElement::nodes_built</a></div><div class="ttdeci">virtual bool nodes_built()</div><div class="ttdoc">Return true if all the nodes have been built, false if not.</div><div class="ttdef"><b>Definition:</b> <a href="refineable__elements_8h_source.html#l00346">refineable_elements.h:346</a></div></div>
<div class="ttc" id="anamespaceoomph_1_1TecplotNames_html_a628a7d88afc7542861c9afd2f4ea498c"><div class="ttname"><a href="namespaceoomph_1_1TecplotNames.html#a628a7d88afc7542861c9afd2f4ea498c">oomph::TecplotNames::colour</a></div><div class="ttdeci">Vector&lt; std::string &gt; colour</div><div class="ttdoc">Tecplot colours.</div><div class="ttdef"><b>Definition:</b> <a href="oomph__utilities_8cc_source.html#l01158">oomph_utilities.cc:1158</a></div></div>
<div class="ttc" id="anamespaceoomph_1_1OcTreeNames_html_ae7e7e58298b85825061eeff362656c40aeb944d7232b126b9034678f074c3078e"><div class="ttname"><a href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40aeb944d7232b126b9034678f074c3078e">oomph::OcTreeNames::DB</a></div><div class="ttdeci">@ DB</div><div class="ttdef"><b>Definition:</b> <a href="octree_8h_source.html#l00052">octree.h:52</a></div></div>
<div class="ttc" id="acfortran_8h_html_af6f0bd3dc13317f895c91323c25c2b8f"><div class="ttname"><a href="cfortran_8h.html#af6f0bd3dc13317f895c91323c25c2b8f">t</a></div><div class="ttdeci">char t</div><div class="ttdef"><b>Definition:</b> <a href="cfortran_8h_source.html#l00568">cfortran.h:568</a></div></div>
<div class="ttc" id="aclassoomph_1_1ElementWithMovingNodes_html"><div class="ttname"><a href="classoomph_1_1ElementWithMovingNodes.html">oomph::ElementWithMovingNodes</a></div><div class="ttdoc">A policy class that serves to establish the common interfaces for elements that contain moving nodes....</div><div class="ttdef"><b>Definition:</b> <a href="element__with__moving__nodes_8h_source.html#l00071">element_with_moving_nodes.h:71</a></div></div>
<div class="ttc" id="aclassoomph_1_1QElementBase_html_a788011c6b64ed0c6e314b7a1f3165687"><div class="ttname"><a href="classoomph_1_1QElementBase.html#a788011c6b64ed0c6e314b7a1f3165687">oomph::QElementBase::s_macro_ll</a></div><div class="ttdeci">double &amp; s_macro_ll(const unsigned &amp;i)</div><div class="ttdoc">Access fct to the i-th coordinate of the element's &quot;lower left&quot; vertex in the associated MacroElement...</div><div class="ttdef"><b>Definition:</b> <a href="Qelements_8h_source.html#l00207">Qelements.h:207</a></div></div>
<div class="ttc" id="aclassoomph_1_1HangInfo_html"><div class="ttname"><a href="classoomph_1_1HangInfo.html">oomph::HangInfo</a></div><div class="ttdoc">Class that contains data for hanging nodes.</div><div class="ttdef"><b>Definition:</b> <a href="nodes_8h_source.html#l00679">nodes.h:679</a></div></div>
<div class="ttc" id="aclassoomph_1_1FiniteElement_html_a2ddbb05c5f8bb35b64bec287d653105c"><div class="ttname"><a href="classoomph_1_1FiniteElement.html#a2ddbb05c5f8bb35b64bec287d653105c">oomph::FiniteElement::get_node_at_local_coordinate</a></div><div class="ttdeci">virtual Node * get_node_at_local_coordinate(const Vector&lt; double &gt; &amp;s) const</div><div class="ttdoc">If there is a node at this local coordinate, return the pointer to the node.</div><div class="ttdef"><b>Definition:</b> <a href="elements_8cc_source.html#l03802">elements.cc:3802</a></div></div>
<div class="ttc" id="aclassoomph_1_1Data_html_a422231c58e423f0b43822827aa334d79"><div class="ttname"><a href="classoomph_1_1Data.html#a422231c58e423f0b43822827aa334d79">oomph::Data::pin</a></div><div class="ttdeci">void pin(const unsigned &amp;i)</div><div class="ttdoc">Pin the i-th stored variable.</div><div class="ttdef"><b>Definition:</b> <a href="nodes_8h_source.html#l00379">nodes.h:379</a></div></div>
<div class="ttc" id="aclassoomph_1_1OcTree_html"><div class="ttname"><a href="classoomph_1_1OcTree.html">oomph::OcTree</a></div><div class="ttdef"><b>Definition:</b> <a href="octree_8h_source.html#l00093">octree.h:93</a></div></div>
<div class="ttc" id="anamespaceoomph_1_1OcTreeNames_html_ae7e7e58298b85825061eeff362656c40a43c804e2bcf9862a4bf629d5f01761e8"><div class="ttname"><a href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a43c804e2bcf9862a4bf629d5f01761e8">oomph::OcTreeNames::B</a></div><div class="ttdeci">@ B</div><div class="ttdef"><b>Definition:</b> <a href="octree_8h_source.html#l00055">octree.h:55</a></div></div>
<div class="ttc" id="anamespaceoomph_1_1OneDimLagrange_html_a117f8b892dc89989ecdad99ff261e120"><div class="ttname"><a href="namespaceoomph_1_1OneDimLagrange.html#a117f8b892dc89989ecdad99ff261e120">oomph::OneDimLagrange::shape</a></div><div class="ttdeci">void shape(const double &amp;s, double *Psi)</div><div class="ttdoc">Definition for 1D Lagrange shape functions. The value of all the shape functions at the local coordin...</div><div class="ttdef"><b>Definition:</b> <a href="shape_8h_source.html#l00545">shape.h:545</a></div></div>
<div class="ttc" id="aclassoomph_1_1Node_html_a056f8e82da938369cd38541c5cdc598a"><div class="ttname"><a href="classoomph_1_1Node.html#a056f8e82da938369cd38541c5cdc598a">oomph::Node::x</a></div><div class="ttdeci">double &amp; x(const unsigned &amp;i)</div><div class="ttdoc">Return the i-th nodal coordinate.</div><div class="ttdef"><b>Definition:</b> <a href="nodes_8h_source.html#l00990">nodes.h:990</a></div></div>
<div class="ttc" id="aclassoomph_1_1TimeStepper_html"><div class="ttname"><a href="classoomph_1_1TimeStepper.html">oomph::TimeStepper</a></div><div class="ttdoc">Base class for time-stepping schemes. Timestepper provides an approximation of the temporal derivativ...</div><div class="ttdef"><b>Definition:</b> <a href="timesteppers_8h_source.html#l00215">timesteppers.h:215</a></div></div>
<div class="ttc" id="aclassoomph_1_1RefineableElement_html_a8ca420443c28708e5c6315a80f520137"><div class="ttname"><a href="classoomph_1_1RefineableElement.html#a8ca420443c28708e5c6315a80f520137">oomph::RefineableElement::interpolating_basis</a></div><div class="ttdeci">virtual void interpolating_basis(const Vector&lt; double &gt; &amp;s, Shape &amp;psi, const int &amp;value_id) const</div><div class="ttdoc">Return the basis functions that are used to interpolate the value_id-th unknown. By default assume is...</div><div class="ttdef"><b>Definition:</b> <a href="refineable__elements_8h_source.html#l00420">refineable_elements.h:420</a></div></div>
<div class="ttc" id="anamespaceoomph_1_1OcTreeNames_html_ae7e7e58298b85825061eeff362656c40a51292b8e4d96f2bb9f0d6bb0340d1620"><div class="ttname"><a href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a51292b8e4d96f2bb9f0d6bb0340d1620">oomph::OcTreeNames::D</a></div><div class="ttdeci">@ D</div><div class="ttdef"><b>Definition:</b> <a href="octree_8h_source.html#l00055">octree.h:55</a></div></div>
<div class="ttc" id="anamespaceoomph_1_1Global__unsigned_html_aa0b4579f7ee228aaf16302f4b39e0fdf"><div class="ttname"><a href="namespaceoomph_1_1Global__unsigned.html#aa0b4579f7ee228aaf16302f4b39e0fdf">oomph::Global_unsigned::Number</a></div><div class="ttdeci">unsigned Number</div><div class="ttdoc">The unsigned.</div><div class="ttdef"><b>Definition:</b> <a href="oomph__definitions_8cc_source.html#l00271">oomph_definitions.cc:271</a></div></div>
<div class="ttc" id="aclassoomph_1_1SolidNode_html_aa283a553b0141e859dd7b4f80bb88e6d"><div class="ttname"><a href="classoomph_1_1SolidNode.html#aa283a553b0141e859dd7b4f80bb88e6d">oomph::SolidNode::pin_position</a></div><div class="ttdeci">void pin_position(const unsigned &amp;i)</div><div class="ttdoc">Pin the nodal position.</div><div class="ttdef"><b>Definition:</b> <a href="nodes_8h_source.html#l01689">nodes.h:1689</a></div></div>
<div class="ttc" id="anamespaceoomph_1_1OcTreeNames_html_ae7e7e58298b85825061eeff362656c40aff75a49d684424436ad419a818d0f480"><div class="ttname"><a href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40aff75a49d684424436ad419a818d0f480">oomph::OcTreeNames::LB</a></div><div class="ttdeci">@ LB</div><div class="ttdef"><b>Definition:</b> <a href="octree_8h_source.html#l00052">octree.h:52</a></div></div>
<div class="ttc" id="anamespaceoomph_1_1BinaryTreeNames_html_a7ff5e7e46beae31bf81579531b1f9895a8df863dabb4096fa066f7a6dbf7502d1"><div class="ttname"><a href="namespaceoomph_1_1BinaryTreeNames.html#a7ff5e7e46beae31bf81579531b1f9895a8df863dabb4096fa066f7a6dbf7502d1">oomph::BinaryTreeNames::L</a></div><div class="ttdeci">@ L</div><div class="ttdef"><b>Definition:</b> <a href="binary__tree_8h_source.html#l00048">binary_tree.h:48</a></div></div>
<div class="ttc" id="aclassoomph_1_1Node_html_af0e6237dfafad62cf427ff5013ddcfef"><div class="ttname"><a href="classoomph_1_1Node.html#af0e6237dfafad62cf427ff5013ddcfef">oomph::Node::is_hanging</a></div><div class="ttdeci">bool is_hanging() const</div><div class="ttdoc">Test whether the node is geometrically hanging.</div><div class="ttdef"><b>Definition:</b> <a href="nodes_8h_source.html#l01202">nodes.h:1202</a></div></div>
<div class="ttc" id="aclassoomph_1_1SolidNode_html"><div class="ttname"><a href="classoomph_1_1SolidNode.html">oomph::SolidNode</a></div><div class="ttdoc">A Class for nodes that deform elastically (i.e. position is an unknown in the problem)....</div><div class="ttdef"><b>Definition:</b> <a href="nodes_8h_source.html#l01564">nodes.h:1564</a></div></div>
<div class="ttc" id="amesh_8h_html"><div class="ttname"><a href="mesh_8h.html">mesh.h</a></div></div>
<div class="ttc" id="aclassoomph_1_1Tree_html_a2f2eeb0f1dd161f696cccc652974ff4c"><div class="ttname"><a href="classoomph_1_1Tree.html#a2f2eeb0f1dd161f696cccc652974ff4c">oomph::Tree::object_pt</a></div><div class="ttdeci">RefineableElement * object_pt() const</div><div class="ttdoc">Return the pointer to the object (RefineableElement) represented by the tree.</div><div class="ttdef"><b>Definition:</b> <a href="tree_8h_source.html#l00098">tree.h:98</a></div></div>
<div class="ttc" id="anamespaceoomph_html"><div class="ttname"><a href="namespaceoomph.html">oomph</a></div><div class="ttdoc">DRAIG: Change all instances of (SPATIAL_DIM) to (DIM-1).</div><div class="ttdef"><b>Definition:</b> <a href="advection__diffusion__elements_8cc_source.html#l00029">advection_diffusion_elements.cc:29</a></div></div>
<div class="ttc" id="aclassoomph_1_1Node_html"><div class="ttname"><a href="classoomph_1_1Node.html">oomph::Node</a></div><div class="ttdoc">Nodes are derived from Data, but, in addition, have a definite (Eulerian) position in a space of a gi...</div><div class="ttdef"><b>Definition:</b> <a href="nodes_8h_source.html#l00847">nodes.h:847</a></div></div>
<div class="ttc" id="aclassoomph_1_1Vector_html"><div class="ttname"><a href="classoomph_1_1Vector.html">oomph::Vector&lt; double &gt;</a></div></div>
<div class="ttc" id="aclassoomph_1_1OcTree_html_adf813fbb9cffe89fb51f3c8ccd3083ca"><div class="ttname"><a href="classoomph_1_1OcTree.html#adf813fbb9cffe89fb51f3c8ccd3083ca">oomph::OcTree::Direction_to_vector</a></div><div class="ttdeci">static Vector&lt; Vector&lt; int &gt; &gt; Direction_to_vector</div><div class="ttdoc">For each direction, i.e. a son_type (vertex), a face or an edge, this defines a vector that indicates...</div><div class="ttdef"><b>Definition:</b> <a href="octree_8h_source.html#l00338">octree.h:338</a></div></div>
<div class="ttc" id="anamespaceoomph_1_1OcTreeNames_html_ae7e7e58298b85825061eeff362656c40ae7245a89994ff850f2a88ea7bff7e7f8"><div class="ttname"><a href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40ae7245a89994ff850f2a88ea7bff7e7f8">oomph::OcTreeNames::LU</a></div><div class="ttdeci">@ LU</div><div class="ttdef"><b>Definition:</b> <a href="octree_8h_source.html#l00053">octree.h:53</a></div></div>
<div class="ttc" id="aclassoomph_1_1ElementWithMovingNodes_html_a580ecb70417536ceb1121afd3bea0d54"><div class="ttname"><a href="classoomph_1_1ElementWithMovingNodes.html#a580ecb70417536ceb1121afd3bea0d54">oomph::ElementWithMovingNodes::enable_bypass_fill_in_jacobian_from_geometric_data</a></div><div class="ttdeci">void enable_bypass_fill_in_jacobian_from_geometric_data()</div><div class="ttdoc">Bypass the call to fill_in_jacobian_from_geometric_data.</div><div class="ttdef"><b>Definition:</b> <a href="element__with__moving__nodes_8h_source.html#l00270">element_with_moving_nodes.h:270</a></div></div>
<div class="ttc" id="aclassoomph_1_1OcTree_html_a29d019becbc07f9ea2811a0ff0881d9a"><div class="ttname"><a href="classoomph_1_1OcTree.html#a29d019becbc07f9ea2811a0ff0881d9a">oomph::OcTree::faces_of_common_edge</a></div><div class="ttdeci">static Vector&lt; int &gt; faces_of_common_edge(const int &amp;edge)</div><div class="ttdoc">Function that, given an edge, returns the two faces on which it.</div><div class="ttdef"><b>Definition:</b> <a href="octree_8cc_source.html#l00279">octree.cc:279</a></div></div>
<div class="ttc" id="aclassoomph_1_1MacroElementNodeUpdateElementBase_html_a45d0d15ee371799c84f59bb13cdac304"><div class="ttname"><a href="classoomph_1_1MacroElementNodeUpdateElementBase.html#a45d0d15ee371799c84f59bb13cdac304">oomph::MacroElementNodeUpdateElementBase::geom_object_pt</a></div><div class="ttdeci">Vector&lt; GeomObject * &gt; &amp; geom_object_pt()</div><div class="ttdoc">Vector of (pointers to) geometric objects involved in node update function.</div><div class="ttdef"><b>Definition:</b> <a href="macro__element__node__update__element_8h_source.html#l00239">macro_element_node_update_element.h:239</a></div></div>
<div class="ttc" id="acfortran_8h_html_adb50e893b86b3e55e751a42eab3cba82"><div class="ttname"><a href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a></div><div class="ttdeci">cstr elem_len * i</div><div class="ttdef"><b>Definition:</b> <a href="cfortran_8h_source.html#l00603">cfortran.h:603</a></div></div>
<div class="ttc" id="aclassoomph_1_1Node_html_aeb07848c19b83fd8b9690b8fcc200d56"><div class="ttname"><a href="classoomph_1_1Node.html#aeb07848c19b83fd8b9690b8fcc200d56">oomph::Node::make_periodic</a></div><div class="ttdeci">virtual void make_periodic(Node *const &amp;node_pt)</div><div class="ttdoc">Make the node periodic by copying the values from node_pt. Note that the coordinates will always rema...</div><div class="ttdef"><b>Definition:</b> <a href="nodes_8cc_source.html#l02176">nodes.cc:2176</a></div></div>
<div class="ttc" id="aclassoomph_1_1Node_html_a786c96a8e46eb27a03b2b31f629d41b3"><div class="ttname"><a href="classoomph_1_1Node.html#a786c96a8e46eb27a03b2b31f629d41b3">oomph::Node::ndim</a></div><div class="ttdeci">unsigned ndim() const</div><div class="ttdoc">Return (Eulerian) spatial dimension of the node.</div><div class="ttdef"><b>Definition:</b> <a href="nodes_8h_source.html#l00987">nodes.h:987</a></div></div>
<div class="ttc" id="aclassoomph_1_1MacroElementNodeUpdateElementBase_html_aa2408d8463e8cecc2ad12a93e10390b1"><div class="ttname"><a href="classoomph_1_1MacroElementNodeUpdateElementBase.html#aa2408d8463e8cecc2ad12a93e10390b1">oomph::MacroElementNodeUpdateElementBase::set_node_update_info</a></div><div class="ttdeci">virtual void set_node_update_info(const Vector&lt; GeomObject * &gt; &amp;geom_object_pt)=0</div><div class="ttdoc">Set node update information: Pass the vector of (pointers to) the geometric objects that affect the n...</div></div>
<div class="ttc" id="anamespaceoomph_1_1OcTreeNames_html_ae7e7e58298b85825061eeff362656c40a1dd915e02b2435707c33bc9f24b0d5c8"><div class="ttname"><a href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a1dd915e02b2435707c33bc9f24b0d5c8">oomph::OcTreeNames::DF</a></div><div class="ttdeci">@ DF</div><div class="ttdef"><b>Definition:</b> <a href="octree_8h_source.html#l00054">octree.h:54</a></div></div>
<div class="ttc" id="anamespaceoomph_1_1BinaryTreeNames_html_a7ff5e7e46beae31bf81579531b1f9895a1bf47d3f36e6272d94344ae84aca2498"><div class="ttname"><a href="namespaceoomph_1_1BinaryTreeNames.html#a7ff5e7e46beae31bf81579531b1f9895a1bf47d3f36e6272d94344ae84aca2498">oomph::BinaryTreeNames::R</a></div><div class="ttdeci">@ R</div><div class="ttdef"><b>Definition:</b> <a href="binary__tree_8h_source.html#l00048">binary_tree.h:48</a></div></div>
<div class="ttc" id="anamespaceoomph_1_1OcTreeNames_html_ae7e7e58298b85825061eeff362656c40a72d8c5c6b2d5fa77e57930951a567546"><div class="ttname"><a href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a72d8c5c6b2d5fa77e57930951a567546">oomph::OcTreeNames::RU</a></div><div class="ttdeci">@ RU</div><div class="ttdef"><b>Definition:</b> <a href="octree_8h_source.html#l00053">octree.h:53</a></div></div>
<div class="ttc" id="aclassoomph_1_1Tree_html_a9e532196340dcd859ff8207eea2ddbbc"><div class="ttname"><a href="classoomph_1_1Tree.html#a9e532196340dcd859ff8207eea2ddbbc">oomph::Tree::OMEGA</a></div><div class="ttdeci">static const int OMEGA</div><div class="ttdoc">Default value for an unassigned neighbour.</div><div class="ttdef"><b>Definition:</b> <a href="tree_8h_source.html#l00237">tree.h:237</a></div></div>
<div class="ttc" id="athe__data__structure_8txt_html_af88b2d950fae19ab641bd1690e08445c"><div class="ttname"><a href="the__data__structure_8txt.html#af88b2d950fae19ab641bd1690e08445c">n</a></div><div class="ttdeci">endcode We introduce wrapper functions to access function so that we can formulate The Maths in generic terms Rather than referring to the pressure at node c n</div><div class="ttdef"><b>Definition:</b> <a href="the__data__structure_8txt_source.html#l00582">the_data_structure.txt:582</a></div></div>
<div class="ttc" id="aclassoomph_1_1OomphLibWarning_html"><div class="ttname"><a href="classoomph_1_1OomphLibWarning.html">oomph::OomphLibWarning</a></div><div class="ttdef"><b>Definition:</b> <a href="oomph__definitions_8h_source.html#l00262">oomph_definitions.h:262</a></div></div>
<div class="ttc" id="aclassoomph_1_1Mesh_html_a007b102ac8e42328872ad658d7110bfc"><div class="ttname"><a href="classoomph_1_1Mesh.html#a007b102ac8e42328872ad658d7110bfc">oomph::Mesh::add_boundary_node</a></div><div class="ttdeci">void add_boundary_node(const unsigned &amp;b, Node *const &amp;node_pt)</div><div class="ttdoc">Add a (pointer to) a node to the b-th boundary.</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8cc_source.html#l00242">mesh.cc:242</a></div></div>
<div class="ttc" id="anamespaceoomph_1_1OcTreeNames_html_ae7e7e58298b85825061eeff362656c40a91fa3c9ccf834f81f50238be7bcc5269"><div class="ttname"><a href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a91fa3c9ccf834f81f50238be7bcc5269">oomph::OcTreeNames::LD</a></div><div class="ttdeci">@ LD</div><div class="ttdef"><b>Definition:</b> <a href="octree_8h_source.html#l00053">octree.h:53</a></div></div>
<div class="ttc" id="aclassoomph_1_1Mesh_html_ad1b124a959628aba00162b89617b3a62"><div class="ttname"><a href="classoomph_1_1Mesh.html#ad1b124a959628aba00162b89617b3a62">oomph::Mesh::boundary_coordinate_exists</a></div><div class="ttdeci">bool boundary_coordinate_exists(const unsigned &amp;i) const</div><div class="ttdoc">Indicate whether the i-th boundary has an intrinsic coordinate.</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8h_source.html#l00561">mesh.h:561</a></div></div>
<div class="ttc" id="aclassoomph_1_1OcTree_html_aec83bade91057d89aa3896274cb96b7e"><div class="ttname"><a href="classoomph_1_1OcTree.html#aec83bade91057d89aa3896274cb96b7e">oomph::OcTree::Vector_to_direction</a></div><div class="ttdeci">static std::map&lt; Vector&lt; int &gt;, int &gt; Vector_to_direction</div><div class="ttdoc">Each vector representing a direction can be translated into a direction, either a son type (vertex),...</div><div class="ttdef"><b>Definition:</b> <a href="octree_8h_source.html#l00333">octree.h:333</a></div></div>
<div class="ttc" id="aclassoomph_1_1RefineableQElement_html"><div class="ttname"><a href="classoomph_1_1RefineableQElement.html">oomph::RefineableQElement</a></div><div class="ttdef"><b>Definition:</b> <a href="Qelements_8h_source.html#l02123">Qelements.h:2123</a></div></div>
<div class="ttc" id="aclassoomph_1_1RefineableQElement_3_013_01_4_html"><div class="ttname"><a href="classoomph_1_1RefineableQElement_3_013_01_4.html">oomph::RefineableQElement&lt; 3 &gt;</a></div><div class="ttdef"><b>Definition:</b> <a href="refineable__brick__element_8h_source.html#l00067">refineable_brick_element.h:67</a></div></div>
<div class="ttc" id="aclassoomph_1_1Data_html_a5b34970d16205921dca3ada720da8445"><div class="ttname"><a href="classoomph_1_1Data.html#a5b34970d16205921dca3ada720da8445">oomph::Data::time_stepper_pt</a></div><div class="ttdeci">TimeStepper *&amp; time_stepper_pt()</div><div class="ttdoc">Return the pointer to the timestepper.</div><div class="ttdef"><b>Definition:</b> <a href="nodes_8h_source.html#l00242">nodes.h:242</a></div></div>
<div class="ttc" id="arefineable__brick__element_8h_html"><div class="ttname"><a href="refineable__brick__element_8h.html">refineable_brick_element.h</a></div></div>
<div class="ttc" id="aclassoomph_1_1AlgebraicElementBase_html"><div class="ttname"><a href="classoomph_1_1AlgebraicElementBase.html">oomph::AlgebraicElementBase</a></div><div class="ttdef"><b>Definition:</b> <a href="algebraic__elements_8h_source.html#l00516">algebraic_elements.h:516</a></div></div>
<div class="ttc" id="aclassoomph_1_1Node_html_aee6f2b7a46fc9d875c6736895d7fc095"><div class="ttname"><a href="classoomph_1_1Node.html#aee6f2b7a46fc9d875c6736895d7fc095">oomph::Node::nposition_type</a></div><div class="ttdeci">unsigned nposition_type() const</div><div class="ttdoc">Number of coordinate types needed in the mapping between local and global coordinates.</div><div class="ttdef"><b>Definition:</b> <a href="nodes_8h_source.html#l00961">nodes.h:961</a></div></div>
<div class="ttc" id="anamespaceoomph_1_1OcTreeNames_html_ae7e7e58298b85825061eeff362656c40a9d5dc3f8f9d04ae80237132101f4258f"><div class="ttname"><a href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a9d5dc3f8f9d04ae80237132101f4258f">oomph::OcTreeNames::U</a></div><div class="ttdeci">@ U</div><div class="ttdef"><b>Definition:</b> <a href="octree_8h_source.html#l00055">octree.h:55</a></div></div>
<div class="ttc" id="aclassoomph_1_1Mesh_html_ac09a9bfeb6d70d8bbefe13c86948a6fc"><div class="ttname"><a href="classoomph_1_1Mesh.html#ac09a9bfeb6d70d8bbefe13c86948a6fc">oomph::Mesh::add_node_pt</a></div><div class="ttdeci">void add_node_pt(Node *const &amp;node_pt)</div><div class="ttdoc">Add a (pointer to a) node to the mesh.</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8h_source.html#l00598">mesh.h:598</a></div></div>
<div class="ttc" id="anamespaceoomph_1_1OcTreeNames_html_ae7e7e58298b85825061eeff362656c40abed39d2cabdadba8a0746381691ccf77"><div class="ttname"><a href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40abed39d2cabdadba8a0746381691ccf77">oomph::OcTreeNames::LDB</a></div><div class="ttdeci">@ LDB</div><div class="ttdef"><b>Definition:</b> <a href="octree_8h_source.html#l00050">octree.h:50</a></div></div>
<div class="ttc" id="anamespaceoomph_1_1OcTreeNames_html_ae7e7e58298b85825061eeff362656c40a9db7ad20ea4f76808cd9cf026229bcdc"><div class="ttname"><a href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a9db7ad20ea4f76808cd9cf026229bcdc">oomph::OcTreeNames::RUF</a></div><div class="ttdeci">@ RUF</div><div class="ttdef"><b>Definition:</b> <a href="octree_8h_source.html#l00051">octree.h:51</a></div></div>
<div class="ttc" id="aclassoomph_1_1AlgebraicElementBase_html_ab9ada27015d5cb28ae00b086ace3600f"><div class="ttname"><a href="classoomph_1_1AlgebraicElementBase.html#ab9ada27015d5cb28ae00b086ace3600f">oomph::AlgebraicElementBase::setup_algebraic_node_update</a></div><div class="ttdeci">void setup_algebraic_node_update(Node *&amp;node_pt, const Vector&lt; double &gt; &amp;s_father, FiniteElement *father_el_pt) const</div><div class="ttdoc">Set up node update info for (newly created) algebraic node: I.e. work out its node update information...</div><div class="ttdef"><b>Definition:</b> <a href="algebraic__elements_8cc_source.html#l00050">algebraic_elements.cc:50</a></div></div>
<div class="ttc" id="aclassoomph_1_1RefineableQElement_3_013_01_4_html_aa0feadb4fbbe8861366a77373b122293"><div class="ttname"><a href="classoomph_1_1RefineableQElement_3_013_01_4.html#aa0feadb4fbbe8861366a77373b122293">oomph::RefineableQElement&lt; 3 &gt;::interpolated_zeta_on_face</a></div><div class="ttdeci">void interpolated_zeta_on_face(const unsigned &amp;boundary, const int &amp;face, const Vector&lt; double &gt; &amp;s, Vector&lt; double &gt; &amp;zeta)</div><div class="ttdoc">Return the value of the intrinsic boundary coordinate interpolated along the face</div><div class="ttdef"><b>Definition:</b> <a href="refineable__brick__element_8cc_source.html#l00561">refineable_brick_element.cc:561</a></div></div>
<div class="ttc" id="acfortran_8h_html_a37cd013acc76697829c324bdd8562d82"><div class="ttname"><a href="cfortran_8h.html#a37cd013acc76697829c324bdd8562d82">e</a></div><div class="ttdeci">e</div><div class="ttdef"><b>Definition:</b> <a href="cfortran_8h_source.html#l00571">cfortran.h:571</a></div></div>
<div class="ttc" id="athe__data__structure_8txt_html_a26a1818885f7aebd0129ce36f6d391e8"><div class="ttname"><a href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a></div><div class="ttdeci">often abbreviated as dof b History b history values are but b not b the values at previous timesteps b Pinned c c c Mesh and c Problem subsection data Data The most elementary data structure in c oomph lib is c these values fall into two and those that must be determined as part of the solution c Data stores a value a double precision number the values of the unknowns are determined by the solution of a system of algebraic equations The solution of this system usually requires a(linear) numbering of the unknowns and associated equations. Hence</div></div>
<div class="ttc" id="aclassoomph_1_1Shape_html"><div class="ttname"><a href="classoomph_1_1Shape.html">oomph::Shape</a></div><div class="ttdef"><b>Definition:</b> <a href="shape_8h_source.html#l00077">shape.h:77</a></div></div>
<div class="ttc" id="aclassoomph_1_1Node_html_a98b3e63390c43196db9429f32319b0ca"><div class="ttname"><a href="classoomph_1_1Node.html#a98b3e63390c43196db9429f32319b0ca">oomph::Node::set_hanging_pt</a></div><div class="ttdeci">void set_hanging_pt(HangInfo *const &amp;hang_pt, const int &amp;i)</div><div class="ttdoc">Set the hanging data for the i-th value. (hang_pt=0 to make non-hanging)</div><div class="ttdef"><b>Definition:</b> <a href="nodes_8cc_source.html#l01993">nodes.cc:1993</a></div></div>
<div class="ttc" id="amacro__element__node__update__element_8h_html"><div class="ttname"><a href="macro__element__node__update__element_8h.html">macro_element_node_update_element.h</a></div></div>
<div class="ttc" id="acfortran_8h_html_ab7123126e4885ef647dd9c6e3807a21c"><div class="ttname"><a href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a></div><div class="ttdeci">static char t char * s</div><div class="ttdef"><b>Definition:</b> <a href="cfortran_8h_source.html#l00568">cfortran.h:568</a></div></div>
<div class="ttc" id="aclassoomph_1_1Tree_html_ae48479dc463d2a8f10400b4b00643a27"><div class="ttname"><a href="classoomph_1_1Tree.html#ae48479dc463d2a8f10400b4b00643a27">oomph::Tree::root_pt</a></div><div class="ttdeci">TreeRoot *&amp; root_pt()</div><div class="ttdoc">Return pointer to root of the tree.</div><div class="ttdef"><b>Definition:</b> <a href="tree_8h_source.html#l00139">tree.h:139</a></div></div>
<div class="ttc" id="anamespaceoomph_1_1OcTreeNames_html_ae7e7e58298b85825061eeff362656c40a5f1bfb03fbc606141a391b7a2f9d4ea7"><div class="ttname"><a href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a5f1bfb03fbc606141a391b7a2f9d4ea7">oomph::OcTreeNames::UF</a></div><div class="ttdeci">@ UF</div><div class="ttdef"><b>Definition:</b> <a href="octree_8h_source.html#l00054">octree.h:54</a></div></div>
<div class="ttc" id="aclassoomph_1_1QElementBase_html_aec37122110d976a88d60a061262592a2"><div class="ttname"><a href="classoomph_1_1QElementBase.html#aec37122110d976a88d60a061262592a2">oomph::QElementBase::s_macro_ur</a></div><div class="ttdeci">double &amp; s_macro_ur(const unsigned &amp;i)</div><div class="ttdoc">Access fct to the i-th coordinate of the element's &quot;upper right&quot; vertex in the associated MacroElemen...</div><div class="ttdef"><b>Definition:</b> <a href="Qelements_8h_source.html#l00224">Qelements.h:224</a></div></div>
<div class="ttc" id="anamespaceoomph_1_1Global__string__for__annotation_html_ac5379de2fa7fe44f2cb31785fc208135"><div class="ttname"><a href="namespaceoomph_1_1Global__string__for__annotation.html#ac5379de2fa7fe44f2cb31785fc208135">oomph::Global_string_for_annotation::string</a></div><div class="ttdeci">std::string string(const unsigned &amp;i)</div><div class="ttdoc">Return the i-th string or &quot;&quot; if the relevant string hasn't been defined.</div><div class="ttdef"><b>Definition:</b> <a href="oomph__definitions_8cc_source.html#l00289">oomph_definitions.cc:289</a></div></div>

    <!-- jQuery for Bootstrap and Doxygen -->
    <script src="../../js/jquery-1.12.0.min.js"></script>
    <!-- Minified boostrap plugins-->
    <script src="../../js/bootstrap.js"></script>
    <!-- Doxygen dependency to add powertips to source code-->
    <script src="../../js/jquery.powertip.min.js"></script>
    <!-- The  following script is generated by doxygen and hides/shows levels in 
         the data structure lists and adds powertips to source code-->
    <script src="../../js/dynsections.js" ></script>
    <!-- add to Doxygen's class names so bootstrap css and js recognises them-->
    <script type="text/javascript">
    $(".contents").addClass("container");
    $(".header").addClass("container");
    $(".navpath").addClass("container");
    $("#navrow3").addClass("container");
    $("#navrow4").addClass("container");
    $(".mlabel").addClass("label");
    $(".mlabel").addClass("label-default");
    $(".memitem").addClass("panel");
    $(".memitem").addClass("panel-info");
    $(".memproto").addClass("panel-heading");
    $(".memdoc").addClass("panel-body");
    </script>
    <footer>
      <div class="container">
        <div class="text-muted" style="float:right;">Generated by <a href="http://www.doxygen.org/index.html">
          <img style="height:18px;" class="footer-img" src="doxygen.png" alt="doxygen"></a> on Fri Aug 13 2021 14:53:07
        </div>
      </div>
    </footer>
</body>
</html>

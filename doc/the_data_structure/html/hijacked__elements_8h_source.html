<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
<title>oomph-lib: hijacked_elements.h Source File</title>
<link rel="apple-touch-icon" sizes="57x57" href="../../figures/apple-touch-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="../../figures/apple-touch-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="../../figures/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="../../figures/apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="../../figures/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="../../figures/apple-touch-icon-120x120.png">
<link rel="icon" type="image/png" href="../../figures/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="../../figures/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="../../figures/favicon-16x16.png" sizes="16x16">
<link rel="manifest" href="../../figures/manifest.json">
<link rel="mask-icon" href="../../figures/safari-pinned-tab.svg" color="#008000">
<link rel="shortcut icon" href="../../figures/favicon.ico">
<meta name="msapplication-TileColor" content="#00a300">
<meta name="msapplication-config" content="../../figures/browserconfig.xml">
<meta name="theme-color" content="#008000">
<link href="http://fonts.googleapis.com/css?family=Open+Sans:400,300,600" rel="stylesheet" type="text/css">
<!-- Doxygen css-->
<!-- <link rel="stylesheet" type="text/css" href="doxygen.css"> -->
<!-- Bootstrap -->
<link href="../../css/bootstrap.css" rel="stylesheet">
<!-- oomph-lib specific overrides -->
<link rel="stylesheet" type="text/css" href="../../css/oomph_header.css">
</head>
<body>
<nav class="navbar navbar-default">
<div class="container">
<div class="container-fluid">
  <!-- Brand and toggle get grouped for better mobile display -->
  <div class="navbar-header">
    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
      <span class="sr-only">Toggle navigation</span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="../../html/index.html"><img alt="oomph-lib" src="../../figures/oomph_logo.png"></a>
  </div>
  <!-- Collect the nav links, forms, and other content for toggling -->
  <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
    <ul class="nav navbar-nav">          
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Documentation <span class="caret"></span></a>
        <ul class="dropdown-menu">
          <li class="dropdown-header">Big picture</li>
          <li><a href="../../../doc/intro/html/index.html">The finite element method</a></li>
          <li><a href="../../../doc/the_data_structure/html/index.html">The data structure</a></li>
          <li><a href="../../../doc/quick_guide/html/index.html">Not-so-quick guide</a></li>
          <li><a href="../../../doc/optimisation/html/index.html">Optimisation</a></li>
          <li><a href="../../../doc/order_of_action_functions/html/index.html">Order of action functions</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Example codes and tutorials</li>
          <li><a href="../../../doc/example_code_list/html/index.html">List of example codes and tutorials</a></li>
          <li><a href="../../../doc/example_code_list/html/index.html#meshes">Meshing</a></li>
          <li><a href="../../../doc/example_code_list/html/index.html#solvers">Solvers</a></li>
          <li><a href="../../../doc/example_code_list/html/index.html#parallel">MPI parallel processing</a></li>
          <li><a href="../../../doc/example_code_list/html/index.html#visualisation">Post-processing/visualisation</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Other</li>
          <li><a href="../../../doc/change_log/html/index.html">Change log</a></li>
          <li><a href="../../../doc/creating_doc/html/index.html">Creating documentation</a></li>
          <li><a href="../../../doc/coding_conventions/html/index.html">Coding conventions</a></li>
          <li><a href="../../../doc/index/html/index.html">Index</a></li>
          <li><a href="../../../doc/FAQ/html/index.html">FAQ</a></li>
        </ul>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Installation<span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../doc/the_distribution/html/index.html">Installation guide</a></li>
            <li><a href="../../../doc/copyright/html/index.html">Copyright</a></li>
          </ul>
        </li>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">About <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../doc/people/html/index.html">People</a></li>            
            <li><a href="../../../doc/contact/html/index.html">Contact/Get involved</a></li>
            <li><a href="../../../doc/publications/html/index.html">Publications</a></li>
            <li><a href="../../../doc/acknowledgements/html/index.html">Acknowledgements</a></li>
            <li><a href="../../../doc/picture_show/index.html">Picture show</a></li>
          </ul>
        </li>
      </li>
    </ul>
    <ul class="nav navbar-nav navbar-right navbar-search">
      <form class="navbar-form" role="search" action="../../../doc/search_results/html/index.html">
        <div class="input-group">
          <input type="text" class="form-control" placeholder="Search" name="q">
          <span class="input-group-btn">
            <button class="btn btn-default" type="submit">Go</button>
          </span>
        </div><!-- /input-group -->
       <!--<div class="form-group">
          <input type="text" class="form-control" placeholder="Search">
        </div>
        <button type="submit" class="btn btn-default">Submit</button>-->
      </form>
    </ul>
  </div><!-- /.navbar-collapse -->
</div><!-- /.container-fluid -->
</div>
</nav>
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_4075b182e53a3873a42d885f4e1e98c4.html">generic</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">hijacked_elements.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="hijacked__elements_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">// LIC// ====================================================================</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">// LIC// This file forms part of oomph-lib, the object-oriented,</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">// LIC// multi-physics finite-element library, available</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">// LIC// at http://www.oomph-lib.org.</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">// LIC//</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">// LIC// Copyright (C) 2006-2021 Matthias Heil and Andrew Hazel</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">// LIC//</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">// LIC// This library is free software; you can redistribute it and/or</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">// LIC// modify it under the terms of the GNU Lesser General Public</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">// LIC// License as published by the Free Software Foundation; either</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">// LIC// version 2.1 of the License, or (at your option) any later version.</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">// LIC//</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">// LIC// This library is distributed in the hope that it will be useful,</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">// LIC// but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">// LIC// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">// LIC// Lesser General Public License for more details.</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">// LIC//</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">// LIC// You should have received a copy of the GNU Lesser General Public</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">// LIC// License along with this library; if not, write to the Free Software</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">// LIC// Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">// LIC// 02110-1301  USA.</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">// LIC//</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">// LIC// The authors may be contacted at oomph-lib@maths.man.ac.uk.</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">// LIC//</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">// LIC//====================================================================</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">// Header file for hijacked elements</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160; </div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment">// Include guards to prevent multiple inclusion of the header</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#ifndef OOMPH_HIJACKED_ELEMENTS_HEADER</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#define OOMPH_HIJACKED_ELEMENTS_HEADER</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160; </div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160; </div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment">// oomph-lib header</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="elements_8h.html">elements.h</a>&quot;</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="spines_8h.html">spines.h</a>&quot;</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160; </div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespaceoomph.html">oomph</a></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;{</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;  <span class="comment">//========================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment">  /// HijackedElement base class that provides storage and access funcitons</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment">  /// for pointers to the global equation numbers that are hijacked by</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment">  /// the HijackedElement. A default residuals multiplier is also provided.</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment"></span>  <span class="comment">//========================================================================</span></div>
<div class="line"><a name="l00044"></a><span class="lineno"><a class="line" href="classoomph_1_1HijackedElementBase.html">   44</a></span>&#160;  <span class="keyword">class </span><a class="code" href="classoomph_1_1HijackedElementBase.html">HijackedElementBase</a></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  {</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  <span class="keyword">public</span>:<span class="comment"></span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment">    /// \short Constructor, initialise the pointer to the equation numbers</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment">    /// for the storage to zero</span></div>
<div class="line"><a name="l00049"></a><span class="lineno"><a class="line" href="classoomph_1_1HijackedElementBase.html#ad062d9c27f6fd3d613a86b32980fa71e">   49</a></span>&#160;<span class="comment"></span>    <a class="code" href="classoomph_1_1HijackedElementBase.html#ad062d9c27f6fd3d613a86b32980fa71e">HijackedElementBase</a>()</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;      : <a class="code" href="classoomph_1_1HijackedElementBase.html#a9c3a9a4e39ee5e3af0f5594c31f532c5">Hijacked_global_eqn_number_pt</a>(0), <a class="code" href="classoomph_1_1HijackedElementBase.html#ae604da2f744f328f3866a2cefa3aa80c">Hijacked_local_eqn_number_pt</a>(0)</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    {</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;      <span class="comment">// Set the default value of the pointer to the residuals multiplier.</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;      <span class="comment">// The default value is zero, so that the element is &quot;completely hijacked&quot;</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;      <span class="comment">// and the exisiting contributions to the residuals and jacobian are</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;      <span class="comment">// totally wiped</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;      <a class="code" href="classoomph_1_1HijackedElementBase.html#a283509b7af09479e7a1cb8c0e05a8c16">Residual_multiplier_pt</a> = &amp;<a class="code" href="classoomph_1_1HijackedElementBase.html#afd87cc7c33c2b846c5f7a373c352f13a">Default_residual_multiplier</a>;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    }</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment">    /// Destructor, destroy the storage for the equation numbers</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment"></span>    <span class="keyword">virtual</span> <a class="code" href="classoomph_1_1HijackedElementBase.html#af3393a98fc80a2f7761046920b4a3040">~HijackedElementBase</a>();</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment">    /// \short Reset the hijacked data pt, so that none of the equations in the</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment">    /// element are hijacked.</span></div>
<div class="line"><a name="l00064"></a><span class="lineno"><a class="line" href="classoomph_1_1HijackedElementBase.html#a0a373a87d121205b9cc0fd54ea41f4ad">   64</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1HijackedElementBase.html#a0a373a87d121205b9cc0fd54ea41f4ad">unhijack_all_data</a>()</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    {</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;      <a class="code" href="classoomph_1_1HijackedElementBase.html#a9c3a9a4e39ee5e3af0f5594c31f532c5">Hijacked_global_eqn_number_pt</a>-&gt;clear();</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    }</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="comment">    /// Return the value of the residual multiplier</span></div>
<div class="line"><a name="l00070"></a><span class="lineno"><a class="line" href="classoomph_1_1HijackedElementBase.html#a79740641b6ac5b5a966d072bd10ab66a">   70</a></span>&#160;<span class="comment"></span>    <span class="keyword">inline</span> <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; <a class="code" href="classoomph_1_1HijackedElementBase.html#a79740641b6ac5b5a966d072bd10ab66a">residual_multiplier</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="keyword">    </span>{</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;      <span class="keywordflow">return</span> *<a class="code" href="classoomph_1_1HijackedElementBase.html#a283509b7af09479e7a1cb8c0e05a8c16">Residual_multiplier_pt</a>;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    }</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="comment">    /// Return the pointer to the residual multiplier</span></div>
<div class="line"><a name="l00076"></a><span class="lineno"><a class="line" href="classoomph_1_1HijackedElementBase.html#a812cf3a3eacd9b587dffa8afb752d8d6">   76</a></span>&#160;<span class="comment"></span>    <span class="keyword">inline</span> <span class="keywordtype">double</span>*&amp; <a class="code" href="classoomph_1_1HijackedElementBase.html#a812cf3a3eacd9b587dffa8afb752d8d6">residual_multiplier_pt</a>()</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    {</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classoomph_1_1HijackedElementBase.html#a283509b7af09479e7a1cb8c0e05a8c16">Residual_multiplier_pt</a>;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    }</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160; </div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  <span class="keyword">protected</span>:<span class="comment"></span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment">    /// Pointer to a Set of pointers to the equation numbers that will be</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="comment">    /// hijacked by this element. Note that these MUST be pointers because</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="comment">    /// hijacking information is set BEFORE global equation numbers have</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="comment">    /// been assigned.</span></div>
<div class="line"><a name="l00086"></a><span class="lineno"><a class="line" href="classoomph_1_1HijackedElementBase.html#a9c3a9a4e39ee5e3af0f5594c31f532c5">   86</a></span>&#160;<span class="comment"></span>    std::set&lt;long*&gt;* <a class="code" href="classoomph_1_1HijackedElementBase.html#a9c3a9a4e39ee5e3af0f5594c31f532c5">Hijacked_global_eqn_number_pt</a>;</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="comment">    /// \short Pointer to  a vector of integers</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="comment">    /// containing the local equation numbers of</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="comment">    /// any hijacked variables in the element.</span></div>
<div class="line"><a name="l00091"></a><span class="lineno"><a class="line" href="classoomph_1_1HijackedElementBase.html#ae604da2f744f328f3866a2cefa3aa80c">   91</a></span>&#160;<span class="comment"></span>    <a class="code" href="classoomph_1_1Vector.html">Vector&lt;int&gt;</a>* <a class="code" href="classoomph_1_1HijackedElementBase.html#ae604da2f744f328f3866a2cefa3aa80c">Hijacked_local_eqn_number_pt</a>;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="comment">    /// \short Pointer to a double that multiplies the contribution to</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="comment">    /// the residuals from the original element.</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="comment">    /// This is usually used as a homotopy parameter to permit a smooth</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment">    /// transition between different types of boundary conditions, rather than</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="comment">    /// switching them on or off abruptly</span></div>
<div class="line"><a name="l00098"></a><span class="lineno"><a class="line" href="classoomph_1_1HijackedElementBase.html#a283509b7af09479e7a1cb8c0e05a8c16">   98</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">double</span>* <a class="code" href="classoomph_1_1HijackedElementBase.html#a283509b7af09479e7a1cb8c0e05a8c16">Residual_multiplier_pt</a>;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="comment">    /// Static default value for the double that multiplies the original</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="comment">    /// residuals</span></div>
<div class="line"><a name="l00102"></a><span class="lineno"><a class="line" href="classoomph_1_1HijackedElementBase.html#afd87cc7c33c2b846c5f7a373c352f13a">  102</a></span>&#160;<span class="comment"></span>    <span class="keyword">static</span> <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1HijackedElementBase.html#afd87cc7c33c2b846c5f7a373c352f13a">Default_residual_multiplier</a>;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="comment">    /// \short Mark the global equation, addressed by global_eqn_pt,</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="comment">    /// as hijacked by this element.</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1HijackedElementBase.html#ac518df71f978c2b80cd25a1283353ab5">hijack_global_eqn</a>(<span class="keywordtype">long</span>* <span class="keyword">const</span>&amp; global_eqn_pt);</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="comment">    /// \short The global equation, addressed by global_eqn_pt,</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="comment">    /// is no longer hijacked by this element.</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1HijackedElementBase.html#aa94e2c93374151302879645f4c354c3f">unhijack_global_eqn</a>(<span class="keywordtype">long</span>* <span class="keyword">const</span>&amp; global_eqn_pt);</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  };</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160; </div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160; </div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  <span class="comment">//========================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="comment">  /// \short Hijacked elements are elements in which one or more</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="comment">  /// Data values that affect the element&#39;s residuals, are determined</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="comment">  /// by another element -- the data values are then said to have</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="comment">  /// been hijacked by another element. The main functionality</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="comment">  /// added by the Hijacked element class is that it wipes out</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="comment">  /// those entries in the element&#39;s residual vector and those rows in</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="comment">  /// the element&#39;s Jacobian matrix that are determined by the &quot;other&quot;</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="comment">  /// elements that have hijacked the values. Note that for continuation</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="comment">  /// in homotopy parameters, it may be desriable to multiply the residuals</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="comment">  /// and corresponding jacobian entries by a &quot;homotopy parameter&quot;. The</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="comment">  /// value of this parameter can be set by assigning residual_multiplier_pt()</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="comment">  /// which has a default value of zero. Note: it would be possible to extend</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="comment">  /// the functionality so that different residuals are multiplied by</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="comment">  /// different values, but will this ever be required?</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="comment"></span>  <span class="comment">//========================================================================</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;  <span class="keyword">template</span>&lt;<span class="keyword">class</span> ELEMENT&gt;</div>
<div class="line"><a name="l00131"></a><span class="lineno"><a class="line" href="classoomph_1_1Hijacked.html">  131</a></span>&#160;  <span class="keyword">class </span><a class="code" href="classoomph_1_1Hijacked.html">Hijacked</a> : <span class="keyword">public</span> <span class="keyword">virtual</span> ELEMENT, <span class="keyword">public</span> <span class="keyword">virtual</span> <a class="code" href="classoomph_1_1HijackedElementBase.html">HijackedElementBase</a></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  {</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;  <span class="keyword">public</span>:<span class="comment"></span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="comment">    /// Constructor, call the constructors of the base elements</span></div>
<div class="line"><a name="l00135"></a><span class="lineno"><a class="line" href="classoomph_1_1Hijacked.html#aaf792ec7672bf812fdc5b3e74c31f807">  135</a></span>&#160;<span class="comment"></span>    <a class="code" href="classoomph_1_1Hijacked.html#aaf792ec7672bf812fdc5b3e74c31f807">Hijacked</a>() : ELEMENT(), <a class="code" href="classoomph_1_1HijackedElementBase.html">HijackedElementBase</a>() {}</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="comment">    /// Constructor used for hijacking face elements</span></div>
<div class="line"><a name="l00138"></a><span class="lineno"><a class="line" href="classoomph_1_1Hijacked.html#a5e4aa47011d8141757f9ecbd8f787811">  138</a></span>&#160;<span class="comment"></span>    <a class="code" href="classoomph_1_1Hijacked.html#a5e4aa47011d8141757f9ecbd8f787811">Hijacked</a>(<a class="code" href="classoomph_1_1FiniteElement.html">FiniteElement</a>* <span class="keyword">const</span>&amp; element_pt, <span class="keyword">const</span> <span class="keywordtype">int</span>&amp; face_index)</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;      : ELEMENT(element_pt, face_index), <a class="code" href="classoomph_1_1HijackedElementBase.html">HijackedElementBase</a>()</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    {</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    }</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160; </div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="comment">    /// \short Constructor used for hijacking face elements with specification</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="comment">    /// of ID of additional variables</span></div>
<div class="line"><a name="l00146"></a><span class="lineno"><a class="line" href="classoomph_1_1Hijacked.html#ac03d9be9ce8252556d41ef643b3658be">  146</a></span>&#160;<span class="comment"></span>    <a class="code" href="classoomph_1_1Hijacked.html#ac03d9be9ce8252556d41ef643b3658be">Hijacked</a>(<a class="code" href="classoomph_1_1FiniteElement.html">FiniteElement</a>* <span class="keyword">const</span>&amp; element_pt,</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;             <span class="keyword">const</span> <span class="keywordtype">int</span>&amp; face_index,</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;             <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; <span class="keywordtype">id</span> = 0)</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;      : ELEMENT(element_pt, face_index, id), <a class="code" href="classoomph_1_1HijackedElementBase.html">HijackedElementBase</a>()</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    {</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    }</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160; </div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="comment">    /// \short Hijack the i-th value stored at internal data n.</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="comment">    /// Optionally return a custom-made (copied) data object that contains only</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="comment">    /// the hijacked value. This can be used as the input to other elements.</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="comment">    /// Note that the calling program assumes responsibility for this</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="comment">    /// data object and must clean it up. The default is that</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="comment">    /// the data object is returned</span></div>
<div class="line"><a name="l00160"></a><span class="lineno"><a class="line" href="classoomph_1_1Hijacked.html#a835ce930b91c2c138f3b4de12aeba216">  160</a></span>&#160;<span class="comment"></span>    <a class="code" href="classoomph_1_1Data.html">Data</a>* <a class="code" href="classoomph_1_1Hijacked.html#a835ce930b91c2c138f3b4de12aeba216">hijack_internal_value</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; <a class="code" href="the__data__structure_8txt.html#af88b2d950fae19ab641bd1690e08445c">n</a>,</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;                                <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>,</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;                                <span class="keyword">const</span> <span class="keywordtype">bool</span>&amp; return_data = <span class="keyword">true</span>)</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    {</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;      <span class="comment">// Initialise pointer to zero</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;      <a class="code" href="classoomph_1_1Data.html">Data</a>* temp_data_pt = 0;</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160; </div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;      <span class="comment">// If desired,</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;      <span class="comment">// Create a new Data object containing only the value that is to be</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;      <span class="comment">// hijacked</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;      <span class="keywordflow">if</span> (return_data)</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;      {</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;        temp_data_pt = <span class="keyword">new</span> <a class="code" href="classoomph_1_1HijackedData.html">HijackedData</a>(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>, this-&gt;internal_data_pt(<a class="code" href="the__data__structure_8txt.html#af88b2d950fae19ab641bd1690e08445c">n</a>));</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;      }</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160; </div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;      <span class="comment">// Mark the value as hijacked</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;      <a class="code" href="classoomph_1_1HijackedElementBase.html#ac518df71f978c2b80cd25a1283353ab5">hijack_global_eqn</a>(this-&gt;internal_data_pt(<a class="code" href="the__data__structure_8txt.html#af88b2d950fae19ab641bd1690e08445c">n</a>)-&gt;eqn_number_pt(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>));</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160; </div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;      <span class="comment">// Return the pointer to the data</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;      <span class="keywordflow">return</span> temp_data_pt;</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    }</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160; </div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="comment">    /// \short Hijack the i-th value stored at external data n.</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="comment">    /// Optionally return a custom-made (copied) data object that contains only</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;<span class="comment">    /// the hijacked value. Note that the calling program assumes</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="comment">    /// responsibility for this data object and must clean it up.</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<span class="comment">    /// The default is that the data object is returned</span></div>
<div class="line"><a name="l00188"></a><span class="lineno"><a class="line" href="classoomph_1_1Hijacked.html#a9e11fa249f667b130e93af9379322182">  188</a></span>&#160;<span class="comment"></span>    <a class="code" href="classoomph_1_1Data.html">Data</a>* <a class="code" href="classoomph_1_1Hijacked.html#a9e11fa249f667b130e93af9379322182">hijack_external_value</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; <a class="code" href="the__data__structure_8txt.html#af88b2d950fae19ab641bd1690e08445c">n</a>,</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;                                <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>,</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;                                <span class="keyword">const</span> <span class="keywordtype">bool</span>&amp; return_data = <span class="keyword">true</span>)</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    {</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;      <span class="comment">// Initialise pointer to zero</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;      <a class="code" href="classoomph_1_1Data.html">Data</a>* temp_data_pt = 0;</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;      <span class="comment">// If desired</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;      <span class="comment">// create a new Data object containing only the value that is to be</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;      <span class="comment">// hijacked</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;      <span class="keywordflow">if</span> (return_data)</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;      {</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;        temp_data_pt = <span class="keyword">new</span> <a class="code" href="classoomph_1_1HijackedData.html">HijackedData</a>(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>, this-&gt;external_data_pt(<a class="code" href="the__data__structure_8txt.html#af88b2d950fae19ab641bd1690e08445c">n</a>));</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;      }</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160; </div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;      <span class="comment">// Mark the value as hijacked</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;      <a class="code" href="classoomph_1_1HijackedElementBase.html#ac518df71f978c2b80cd25a1283353ab5">hijack_global_eqn</a>(this-&gt;external_data_pt(<a class="code" href="the__data__structure_8txt.html#af88b2d950fae19ab641bd1690e08445c">n</a>)-&gt;eqn_number_pt(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>));</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160; </div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;      <span class="comment">// Return the pointer to the data</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;      <span class="keywordflow">return</span> temp_data_pt;</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    }</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="comment">    /// \short Hijack the i-th value stored at node n.</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="comment">    /// Optionally return a custom-made (copied) data object that contains only</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="comment">    /// the hijacked value. Once again, the calling program must</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="comment">    /// clean up the allocated Data object.</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="comment">    /// The default is that the data object is returned</span></div>
<div class="line"><a name="l00214"></a><span class="lineno"><a class="line" href="classoomph_1_1Hijacked.html#acd1255b8d3783d0bce222095f9f78aa2">  214</a></span>&#160;<span class="comment"></span>    <a class="code" href="classoomph_1_1Data.html">Data</a>* <a class="code" href="classoomph_1_1Hijacked.html#acd1255b8d3783d0bce222095f9f78aa2">hijack_nodal_value</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; <a class="code" href="the__data__structure_8txt.html#af88b2d950fae19ab641bd1690e08445c">n</a>,</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;                             <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>,</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;                             <span class="keyword">const</span> <span class="keywordtype">bool</span>&amp; return_data = <span class="keyword">true</span>)</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    {</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;      <span class="comment">// Initialise pointer to zero</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;      <a class="code" href="classoomph_1_1Data.html">Data</a>* temp_data_pt = 0;</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;      <span class="comment">// If desired</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;      <span class="comment">// create a new Data object containing only the value that is to be</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;      <span class="comment">// hijacked</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;      <span class="keywordflow">if</span> (return_data)</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;      {</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;        temp_data_pt = <span class="keyword">new</span> <a class="code" href="classoomph_1_1HijackedData.html">HijackedData</a>(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>, this-&gt;node_pt(<a class="code" href="the__data__structure_8txt.html#af88b2d950fae19ab641bd1690e08445c">n</a>));</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;      }</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160; </div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;      <span class="comment">// Mark the value as hijacked</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;      <a class="code" href="classoomph_1_1HijackedElementBase.html#ac518df71f978c2b80cd25a1283353ab5">hijack_global_eqn</a>(this-&gt;node_pt(<a class="code" href="the__data__structure_8txt.html#af88b2d950fae19ab641bd1690e08445c">n</a>)-&gt;eqn_number_pt(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>));</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160; </div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;      <span class="comment">// Return the pointer to the data, which may be null</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;      <span class="keywordflow">return</span> temp_data_pt;</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    }</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="comment">    /// \short Hijack the i-th positional value stored at node n.</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;<span class="comment">    /// Optionaly return a custom-made (copied) data object that contains only</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="comment">    /// the hijacked value. Again, responsibility for the memory allocated</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="comment">    /// lies with the calling function.</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;<span class="comment">    /// The default is that the data object is returned</span></div>
<div class="line"><a name="l00240"></a><span class="lineno"><a class="line" href="classoomph_1_1Hijacked.html#a3c4a0ed281996d74c30f5d4af9a5a324">  240</a></span>&#160;<span class="comment"></span>    <a class="code" href="classoomph_1_1Data.html">Data</a>* <a class="code" href="classoomph_1_1Hijacked.html#a3c4a0ed281996d74c30f5d4af9a5a324">hijack_nodal_position_value</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; <a class="code" href="the__data__structure_8txt.html#af88b2d950fae19ab641bd1690e08445c">n</a>,</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;                                      <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>,</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;                                      <span class="keyword">const</span> <span class="keywordtype">bool</span>&amp; return_data = <span class="keyword">true</span>)</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    {</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;      <span class="comment">// Can we do the casting?</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;      <a class="code" href="classoomph_1_1SolidNode.html">SolidNode</a>* solid_node_pt = <span class="keyword">dynamic_cast&lt;</span><a class="code" href="classoomph_1_1SolidNode.html">SolidNode</a>*<span class="keyword">&gt;</span>(this-&gt;node_pt(<a class="code" href="the__data__structure_8txt.html#af88b2d950fae19ab641bd1690e08445c">n</a>));</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;      <span class="keywordflow">if</span> (solid_node_pt == 0)</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;      {</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;        <a class="code" href="namespaceoomph_1_1Global__string__for__annotation.html#ac5379de2fa7fe44f2cb31785fc208135">std::string</a> error_message = <span class="stringliteral">&quot;Failed to cast to SolidNode\n &quot;</span>;</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;        error_message += <span class="stringliteral">&quot;You may be trying to hijack a non-elastic element\n&quot;</span>;</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160; </div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="classoomph_1_1OomphLibError.html">OomphLibError</a>(</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;          error_message, OOMPH_CURRENT_FUNCTION, OOMPH_EXCEPTION_LOCATION);</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;      }</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160; </div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;      <span class="comment">// Initialise pointer to zero</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;      <a class="code" href="classoomph_1_1Data.html">Data</a>* temp_data_pt = 0;</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;      <span class="comment">// If desired</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;      <span class="comment">// create a new Data object containing only the value that is to be</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;      <span class="comment">// hijacked</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;      <span class="keywordflow">if</span> (return_data)</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;      {</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;        temp_data_pt =</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;          <span class="keyword">new</span> <a class="code" href="classoomph_1_1HijackedData.html">HijackedData</a>(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>, solid_node_pt-&gt;<a class="code" href="classoomph_1_1SolidNode.html#ae9a8abd197728f5555730131fa0f6971">variable_position_pt</a>());</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;      }</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160; </div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;      <span class="comment">// Mark the value as hijacked</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;      <a class="code" href="classoomph_1_1HijackedElementBase.html#ac518df71f978c2b80cd25a1283353ab5">hijack_global_eqn</a>(</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;        solid_node_pt-&gt;<a class="code" href="classoomph_1_1SolidNode.html#ae9a8abd197728f5555730131fa0f6971">variable_position_pt</a>()-&gt;<a class="code" href="classoomph_1_1Data.html#a35cc8d05b72d9101e54ddf5808da4a54">eqn_number_pt</a>(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>));</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160; </div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;      <span class="comment">// Return the pointer to the data</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;      <span class="keywordflow">return</span> temp_data_pt;</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    }</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;<span class="comment">    /// \short Hijack the i-th value stored at the spine that affects</span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;<span class="comment">    /// local node n.</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;<span class="comment">    /// Optionally return a custom-made (copied) data object that contains only</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;<span class="comment">    /// the hijacked value. Deletion must be handled at the higher level</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;<span class="comment">    /// The default is that the data object is returned</span></div>
<div class="line"><a name="l00279"></a><span class="lineno"><a class="line" href="classoomph_1_1Hijacked.html#a3d4f055a9ade75b19d69d8aa7eb26417">  279</a></span>&#160;<span class="comment"></span>    <a class="code" href="classoomph_1_1Data.html">Data</a>* <a class="code" href="classoomph_1_1Hijacked.html#a3d4f055a9ade75b19d69d8aa7eb26417">hijack_nodal_spine_value</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; <a class="code" href="the__data__structure_8txt.html#af88b2d950fae19ab641bd1690e08445c">n</a>,</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;                                   <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>,</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;                                   <span class="keyword">const</span> <span class="keywordtype">bool</span>&amp; return_data = <span class="keyword">true</span>)</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    {</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;      <span class="comment">// Can we actually do this casting</span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;      <a class="code" href="classoomph_1_1SpineNode.html">SpineNode</a>* spine_node_pt = <span class="keyword">dynamic_cast&lt;</span><a class="code" href="classoomph_1_1SpineNode.html">SpineNode</a>*<span class="keyword">&gt;</span>(this-&gt;node_pt(<a class="code" href="the__data__structure_8txt.html#af88b2d950fae19ab641bd1690e08445c">n</a>));</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;      <span class="keywordflow">if</span> (spine_node_pt == 0)</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;      {</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;        <a class="code" href="namespaceoomph_1_1Global__string__for__annotation.html#ac5379de2fa7fe44f2cb31785fc208135">std::string</a> error_message = <span class="stringliteral">&quot;Failed to cast to SpineNode\n &quot;</span>;</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;        error_message += <span class="stringliteral">&quot;You may be trying to hijack a non-spine element\n&quot;</span>;</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160; </div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="classoomph_1_1OomphLibError.html">OomphLibError</a>(</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;          error_message, OOMPH_CURRENT_FUNCTION, OOMPH_EXCEPTION_LOCATION);</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;      }</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160; </div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;      <span class="comment">// Initialise pointer to zero</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;      <a class="code" href="classoomph_1_1Data.html">Data</a>* temp_data_pt = 0;</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;      <span class="comment">// If desired</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;      <span class="comment">// create a new Data object containing only the value that is to be</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;      <span class="comment">// hijacked</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;      <span class="keywordflow">if</span> (return_data)</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;      {</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;        temp_data_pt =</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;          <span class="keyword">new</span> <a class="code" href="classoomph_1_1HijackedData.html">HijackedData</a>(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>, spine_node_pt-&gt;<a class="code" href="classoomph_1_1SpineNode.html#acb15e93d53f62e899a3c126736b41079">spine_pt</a>()-&gt;<a class="code" href="classoomph_1_1Spine.html#ac34e4b12d9c1843611e42968ba5d90c7">spine_height_pt</a>());</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;      }</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160; </div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;      <span class="comment">// Mark the data as hijacked</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;      <a class="code" href="classoomph_1_1HijackedElementBase.html#ac518df71f978c2b80cd25a1283353ab5">hijack_global_eqn</a>(</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;        spine_node_pt-&gt;<a class="code" href="classoomph_1_1SpineNode.html#acb15e93d53f62e899a3c126736b41079">spine_pt</a>()-&gt;<a class="code" href="classoomph_1_1Spine.html#ac34e4b12d9c1843611e42968ba5d90c7">spine_height_pt</a>()-&gt;<a class="code" href="classoomph_1_1Data.html#a35cc8d05b72d9101e54ddf5808da4a54">eqn_number_pt</a>(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>));</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160; </div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;      <span class="comment">// Return the pointer to the data</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;      <span class="keywordflow">return</span> temp_data_pt;</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    }</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160; </div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="comment">    /// \short Set up the local equation numbers for the underlying element,</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<span class="comment">    /// then set up the local arrays to hold the hijacked variables.</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="comment">    /// If the boolean argument is true then pointers to the associated degrees</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="comment">    /// of freedom are stored in the array Dof_pt</span></div>
<div class="line"><a name="l00318"></a><span class="lineno"><a class="line" href="classoomph_1_1Hijacked.html#afd4a5578291487aa37b0931dab845701">  318</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1Hijacked.html#afd4a5578291487aa37b0931dab845701">assign_local_eqn_numbers</a>(<span class="keyword">const</span> <span class="keywordtype">bool</span>&amp; store_local_dof_pt)</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    {</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;      <span class="comment">// If things have already been allocated,</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;      <span class="comment">// clear the local hijacked array, so that if the equation numbers</span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;      <span class="comment">// are reassigned after changes in the boundary conditions, the</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;      <span class="comment">// correct terms will be in the array.</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classoomph_1_1HijackedElementBase.html#ae604da2f744f328f3866a2cefa3aa80c">Hijacked_local_eqn_number_pt</a> != 0)</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;      {</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;        <a class="code" href="classoomph_1_1HijackedElementBase.html#ae604da2f744f328f3866a2cefa3aa80c">Hijacked_local_eqn_number_pt</a>-&gt;clear();</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;      }</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;      <span class="comment">// Otherwise allocate it</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;      {</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;        <a class="code" href="classoomph_1_1HijackedElementBase.html#ae604da2f744f328f3866a2cefa3aa80c">Hijacked_local_eqn_number_pt</a> = <span class="keyword">new</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;int&gt;</a>;</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;      }</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160; </div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160; </div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;      <span class="comment">// Call the hijacked element&#39;s assign_local_eqn_numbers</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;      ELEMENT::assign_local_eqn_numbers(store_local_dof_pt);</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160; </div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;      <span class="comment">// If any values have been hijacked, we need to find the corresponding</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;      <span class="comment">// local equation numbers</span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classoomph_1_1HijackedElementBase.html#a9c3a9a4e39ee5e3af0f5594c31f532c5">Hijacked_global_eqn_number_pt</a> != 0)</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;      {</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;        <span class="comment">// Now loop over the local array that stores GLOBAL equation numbers</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;        <span class="comment">// to check if any of the local values have in fact been hijacked</span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;        <span class="comment">// by &quot;somebody&quot;</span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;        <span class="keywordtype">unsigned</span> n_dof = this-&gt;ndof();</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a> = 0; <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a> &lt; n_dof; <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;        {</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;          <span class="comment">// Loop over *all* hijacked data</span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;          <span class="keywordflow">for</span> (std::set&lt;long*&gt;::iterator it =</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;                 <a class="code" href="classoomph_1_1HijackedElementBase.html#a9c3a9a4e39ee5e3af0f5594c31f532c5">Hijacked_global_eqn_number_pt</a>-&gt;begin();</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;               it != <a class="code" href="classoomph_1_1HijackedElementBase.html#a9c3a9a4e39ee5e3af0f5594c31f532c5">Hijacked_global_eqn_number_pt</a>-&gt;end();</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;               ++it)</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;          {</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;            <span class="comment">// If the hijacked (global!) equation is not pinned</span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;            <span class="keywordflow">if</span> (*(*it) &gt;= 0)</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;            {</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;              <span class="comment">// Get the (unsigned) global equation number:</span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;              <span class="comment">// Note that it is only unsigned AFTER the test above.</span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;              <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> hijacked_eqn_number = *(*it);</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160; </div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;              <span class="comment">// If a GLOBAL variable used by this element is hijacked add the</span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;              <span class="comment">// variable&#39;s LOCAL index to the array</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;              <span class="keywordflow">if</span> (hijacked_eqn_number == this-&gt;eqn_number(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>))</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;              {</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;                <a class="code" href="classoomph_1_1HijackedElementBase.html#ae604da2f744f328f3866a2cefa3aa80c">Hijacked_local_eqn_number_pt</a>-&gt;push_back(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>);</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;              }</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;            }</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;          }</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;        }</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;      }</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    }</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;<span class="comment">    /// \short Get the residuals from the underlying element, but then wipe the</span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;<span class="comment">    /// entries in the residual vector that correspond to hijacked</span></div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;<span class="comment">    /// values -- they will be computed by other elements.</span></div>
<div class="line"><a name="l00377"></a><span class="lineno"><a class="line" href="classoomph_1_1Hijacked.html#adb1760705326df86f6289cc3774d37b9">  377</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1Hijacked.html#adb1760705326df86f6289cc3774d37b9">get_residuals</a>(<a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; <a class="code" href="the__data__structure_8txt.html#a1400a973def57b85051cfe1070be1810">residuals</a>)</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    {</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;      <span class="comment">// Get parent redisuals</span></div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;      <a class="code" href="the__data__structure_8txt.html#a80f7344c0300e389acecd2d048f2bb58">ELEMENT::get_residuals</a>(<a class="code" href="the__data__structure_8txt.html#a1400a973def57b85051cfe1070be1810">residuals</a>);</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;      <span class="comment">// Multiply any hijacked dofs by the residual multiplier</span></div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;      <span class="comment">//(default value is zero)</span></div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;      <span class="keywordtype">unsigned</span> n_hijacked = <a class="code" href="classoomph_1_1HijackedElementBase.html#ae604da2f744f328f3866a2cefa3aa80c">Hijacked_local_eqn_number_pt</a>-&gt;size();</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a> = 0; <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a> &lt; n_hijacked; <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;      {</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;        <a class="code" href="the__data__structure_8txt.html#a1400a973def57b85051cfe1070be1810">residuals</a>[(*Hijacked_local_eqn_number_pt)[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]] *= <a class="code" href="classoomph_1_1HijackedElementBase.html#a79740641b6ac5b5a966d072bd10ab66a">residual_multiplier</a>();</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;      }</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    }</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160; </div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;<span class="comment">    /// \short Get the residuals and Jacobian matrix from the underlying</span></div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;<span class="comment">    /// element, but then wipe the entries in the residual vector and the</span></div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;<span class="comment">    /// rows in the Jacobian matrix that correspond to hijacked</span></div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;<span class="comment">    /// values -- they will be computed by other elements.</span></div>
<div class="line"><a name="l00395"></a><span class="lineno"><a class="line" href="classoomph_1_1Hijacked.html#a35778dccc9cf036c37ee569efe5b5f7c">  395</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1Hijacked.html#a35778dccc9cf036c37ee569efe5b5f7c">get_jacobian</a>(<a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; <a class="code" href="the__data__structure_8txt.html#a1400a973def57b85051cfe1070be1810">residuals</a>, <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a>&amp; jacobian)</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    {</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;      <span class="comment">// Call the element&#39;s get jacobian function</span></div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;      ELEMENT::get_jacobian(<a class="code" href="the__data__structure_8txt.html#a1400a973def57b85051cfe1070be1810">residuals</a>, jacobian);</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;      <span class="comment">// Wipe any hijacked dofs</span></div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;      <span class="keywordtype">unsigned</span> n_hijacked = <a class="code" href="classoomph_1_1HijackedElementBase.html#ae604da2f744f328f3866a2cefa3aa80c">Hijacked_local_eqn_number_pt</a>-&gt;size();</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;      <span class="keywordtype">unsigned</span> n_dof = this-&gt;ndof();</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a> = 0; <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a> &lt; n_hijacked; <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;      {</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;        <span class="comment">// Multiply any hijacked dofs by the residual multiplier</span></div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;        <span class="comment">//(default value is zero)</span></div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;        <a class="code" href="the__data__structure_8txt.html#a1400a973def57b85051cfe1070be1810">residuals</a>[(*Hijacked_local_eqn_number_pt)[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]] *= <a class="code" href="classoomph_1_1HijackedElementBase.html#a79740641b6ac5b5a966d072bd10ab66a">residual_multiplier</a>();</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;        <span class="comment">// Multiply the row in the Jacobian matrix by the residual</span></div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;        <span class="comment">// multiplier for consistency</span></div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j = 0; j &lt; n_dof; j++)</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;        {</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;          jacobian((*<a class="code" href="classoomph_1_1HijackedElementBase.html#ae604da2f744f328f3866a2cefa3aa80c">Hijacked_local_eqn_number_pt</a>)[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>], j) *=</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;            <a class="code" href="classoomph_1_1HijackedElementBase.html#a79740641b6ac5b5a966d072bd10ab66a">residual_multiplier</a>();</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;        }</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;      }</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    }</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;  };</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160; </div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160; </div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;  <span class="comment">//============================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;<span class="comment">  ///\short Explicit definition of the face geometry of hijacked elements:</span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;<span class="comment">  /// the same as the face geometry of the underlying element</span></div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;<span class="comment"></span>  <span class="comment">//============================================================================</span></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;  <span class="keyword">template</span>&lt;<span class="keyword">class</span> ELEMENT&gt;</div>
<div class="line"><a name="l00424"></a><span class="lineno"><a class="line" href="classoomph_1_1FaceGeometry_3_01Hijacked_3_01ELEMENT_01_4_01_4.html">  424</a></span>&#160;  <span class="keyword">class </span><a class="code" href="classoomph_1_1FaceGeometry.html">FaceGeometry</a>&lt;<a class="code" href="classoomph_1_1Hijacked.html">Hijacked</a>&lt;ELEMENT&gt;&gt; : <span class="keyword">public</span> <span class="keyword">virtual</span> <a class="code" href="classoomph_1_1FaceGeometry.html">FaceGeometry</a>&lt;ELEMENT&gt;</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;  {</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;  <span class="keyword">public</span>:<span class="comment"></span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;<span class="comment">    /// Constructor</span></div>
<div class="line"><a name="l00428"></a><span class="lineno"><a class="line" href="classoomph_1_1FaceGeometry_3_01Hijacked_3_01ELEMENT_01_4_01_4.html#aa15ca241abd8d8c44efffac9b710a13f">  428</a></span>&#160;<span class="comment"></span>    <a class="code" href="classoomph_1_1FaceGeometry_3_01Hijacked_3_01ELEMENT_01_4_01_4.html#aa15ca241abd8d8c44efffac9b710a13f">FaceGeometry</a>() : <a class="code" href="classoomph_1_1FaceGeometry.html">FaceGeometry</a>&lt;ELEMENT&gt;() {}</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160; </div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;  <span class="keyword">protected</span>:</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;  };</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160; </div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;  <span class="comment">//============================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;<span class="comment">  ///\short Explicit definition of the face geometry of hijacked elements:</span></div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;<span class="comment">  /// the same as the face geometry of the underlying element</span></div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;<span class="comment"></span>  <span class="comment">//============================================================================</span></div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;  <span class="keyword">template</span>&lt;<span class="keyword">class</span> ELEMENT&gt;</div>
<div class="line"><a name="l00438"></a><span class="lineno"><a class="line" href="classoomph_1_1FaceGeometry_3_01FaceGeometry_3_01Hijacked_3_01ELEMENT_01_4_01_4_01_4.html">  438</a></span>&#160;  <span class="keyword">class </span><a class="code" href="classoomph_1_1FaceGeometry.html">FaceGeometry</a>&lt;<a class="code" href="classoomph_1_1FaceGeometry.html">FaceGeometry</a>&lt;<a class="code" href="classoomph_1_1Hijacked.html">Hijacked</a>&lt;ELEMENT&gt;&gt;&gt;</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    : <span class="keyword">public</span> <span class="keyword">virtual</span> <a class="code" href="classoomph_1_1FaceGeometry.html">FaceGeometry</a>&lt;FaceGeometry&lt;ELEMENT&gt;&gt;</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;  {</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;  <span class="keyword">public</span>:<span class="comment"></span></div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;<span class="comment">    /// Constructor</span></div>
<div class="line"><a name="l00443"></a><span class="lineno"><a class="line" href="classoomph_1_1FaceGeometry_3_01FaceGeometry_3_01Hijacked_3_01ELEMENT_01_4_01_4_01_4.html#aeef3807dfeeb7259e2ff63b94c43181a">  443</a></span>&#160;<span class="comment"></span>    <a class="code" href="classoomph_1_1FaceGeometry_3_01FaceGeometry_3_01Hijacked_3_01ELEMENT_01_4_01_4_01_4.html#aeef3807dfeeb7259e2ff63b94c43181a">FaceGeometry</a>() : <a class="code" href="classoomph_1_1FaceGeometry.html">FaceGeometry</a>&lt;<a class="code" href="classoomph_1_1FaceGeometry.html">FaceGeometry</a>&lt;ELEMENT&gt;&gt;() {}</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160; </div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;  <span class="keyword">protected</span>:</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;  };</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160; </div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;  <span class="comment">//============================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;<span class="comment">  ///\short Explicit definition of the face geometry of hijacked elements:</span></div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;<span class="comment">  /// the same as the face geometry of the underlying element</span></div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;<span class="comment"></span>  <span class="comment">//============================================================================</span></div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;  <span class="keyword">template</span>&lt;<span class="keyword">class</span> ELEMENT&gt;</div>
<div class="line"><a name="l00453"></a><span class="lineno"><a class="line" href="classoomph_1_1FaceGeometry_3_01Hijacked_3_01FaceGeometry_3_01ELEMENT_01_4_01_4_01_4.html">  453</a></span>&#160;  <span class="keyword">class </span><a class="code" href="classoomph_1_1FaceGeometry.html">FaceGeometry</a>&lt;<a class="code" href="classoomph_1_1Hijacked.html">Hijacked</a>&lt;<a class="code" href="classoomph_1_1FaceGeometry.html">FaceGeometry</a>&lt;ELEMENT&gt;&gt;&gt;</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    : <span class="keyword">public</span> <span class="keyword">virtual</span> <a class="code" href="classoomph_1_1FaceGeometry.html">FaceGeometry</a>&lt;FaceGeometry&lt;ELEMENT&gt;&gt;</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;  {</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;  <span class="keyword">public</span>:<span class="comment"></span></div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;<span class="comment">    /// Constructor</span></div>
<div class="line"><a name="l00458"></a><span class="lineno"><a class="line" href="classoomph_1_1FaceGeometry_3_01Hijacked_3_01FaceGeometry_3_01ELEMENT_01_4_01_4_01_4.html#a2acbd5452df461b690cca240f5249647">  458</a></span>&#160;<span class="comment"></span>    <a class="code" href="classoomph_1_1FaceGeometry_3_01Hijacked_3_01FaceGeometry_3_01ELEMENT_01_4_01_4_01_4.html#a2acbd5452df461b690cca240f5249647">FaceGeometry</a>() : <a class="code" href="classoomph_1_1FaceGeometry.html">FaceGeometry</a>&lt;<a class="code" href="classoomph_1_1FaceGeometry.html">FaceGeometry</a>&lt;ELEMENT&gt;&gt;() {}</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160; </div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;  <span class="keyword">protected</span>:</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;  };</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160; </div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160; </div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;} <span class="comment">// namespace oomph</span></div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160; </div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;<span class="preprocessor">#endif</span></div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="aclassoomph_1_1HijackedElementBase_html_a812cf3a3eacd9b587dffa8afb752d8d6"><div class="ttname"><a href="classoomph_1_1HijackedElementBase.html#a812cf3a3eacd9b587dffa8afb752d8d6">oomph::HijackedElementBase::residual_multiplier_pt</a></div><div class="ttdeci">double *&amp; residual_multiplier_pt()</div><div class="ttdoc">Return the pointer to the residual multiplier.</div><div class="ttdef"><b>Definition:</b> <a href="hijacked__elements_8h_source.html#l00076">hijacked_elements.h:76</a></div></div>
<div class="ttc" id="aclassoomph_1_1Hijacked_html_ac03d9be9ce8252556d41ef643b3658be"><div class="ttname"><a href="classoomph_1_1Hijacked.html#ac03d9be9ce8252556d41ef643b3658be">oomph::Hijacked::Hijacked</a></div><div class="ttdeci">Hijacked(FiniteElement *const &amp;element_pt, const int &amp;face_index, const unsigned &amp;id=0)</div><div class="ttdoc">Constructor used for hijacking face elements with specification of ID of additional variables.</div><div class="ttdef"><b>Definition:</b> <a href="hijacked__elements_8h_source.html#l00146">hijacked_elements.h:146</a></div></div>
<div class="ttc" id="aclassoomph_1_1FaceGeometry_3_01Hijacked_3_01FaceGeometry_3_01ELEMENT_01_4_01_4_01_4_html_a2acbd5452df461b690cca240f5249647"><div class="ttname"><a href="classoomph_1_1FaceGeometry_3_01Hijacked_3_01FaceGeometry_3_01ELEMENT_01_4_01_4_01_4.html#a2acbd5452df461b690cca240f5249647">oomph::FaceGeometry&lt; Hijacked&lt; FaceGeometry&lt; ELEMENT &gt; &gt; &gt;::FaceGeometry</a></div><div class="ttdeci">FaceGeometry()</div><div class="ttdoc">Constructor.</div><div class="ttdef"><b>Definition:</b> <a href="hijacked__elements_8h_source.html#l00458">hijacked_elements.h:458</a></div></div>
<div class="ttc" id="athe__data__structure_8txt_html_a1400a973def57b85051cfe1070be1810"><div class="ttname"><a href="the__data__structure_8txt.html#a1400a973def57b85051cfe1070be1810">residuals</a></div><div class="ttdeci">endcode The default implementation of c the simplest possible implementation of a new element requires only the specification of c we need to know which c Data affects the residuals(and hence the Jacobian matrix). For a \c GeneralisedElement such \c Data exists in two forms</div></div>
<div class="ttc" id="aclassoomph_1_1Hijacked_html_a3c4a0ed281996d74c30f5d4af9a5a324"><div class="ttname"><a href="classoomph_1_1Hijacked.html#a3c4a0ed281996d74c30f5d4af9a5a324">oomph::Hijacked::hijack_nodal_position_value</a></div><div class="ttdeci">Data * hijack_nodal_position_value(const unsigned &amp;n, const unsigned &amp;i, const bool &amp;return_data=true)</div><div class="ttdoc">Hijack the i-th positional value stored at node n. Optionaly return a custom-made (copied) data objec...</div><div class="ttdef"><b>Definition:</b> <a href="hijacked__elements_8h_source.html#l00240">hijacked_elements.h:240</a></div></div>
<div class="ttc" id="aclassoomph_1_1HijackedElementBase_html_af3393a98fc80a2f7761046920b4a3040"><div class="ttname"><a href="classoomph_1_1HijackedElementBase.html#af3393a98fc80a2f7761046920b4a3040">oomph::HijackedElementBase::~HijackedElementBase</a></div><div class="ttdeci">virtual ~HijackedElementBase()</div><div class="ttdoc">Destructor, destroy the storage for the equation numbers.</div><div class="ttdef"><b>Definition:</b> <a href="hijacked__elements_8cc_source.html#l00041">hijacked_elements.cc:41</a></div></div>
<div class="ttc" id="aclassoomph_1_1FiniteElement_html"><div class="ttname"><a href="classoomph_1_1FiniteElement.html">oomph::FiniteElement</a></div><div class="ttdoc">A general Finite Element class.</div><div class="ttdef"><b>Definition:</b> <a href="elements_8h_source.html#l01318">elements.h:1318</a></div></div>
<div class="ttc" id="aclassoomph_1_1OomphLibError_html"><div class="ttname"><a href="classoomph_1_1OomphLibError.html">oomph::OomphLibError</a></div><div class="ttdef"><b>Definition:</b> <a href="oomph__definitions_8h_source.html#l00221">oomph_definitions.h:221</a></div></div>
<div class="ttc" id="aclassoomph_1_1Data_html"><div class="ttname"><a href="classoomph_1_1Data.html">oomph::Data</a></div><div class="ttdoc">A class that represents a collection of data; each Data object may contain many different individual ...</div><div class="ttdef"><b>Definition:</b> <a href="nodes_8h_source.html#l00085">nodes.h:85</a></div></div>
<div class="ttc" id="aclassoomph_1_1Hijacked_html"><div class="ttname"><a href="classoomph_1_1Hijacked.html">oomph::Hijacked</a></div><div class="ttdoc">Hijacked elements are elements in which one or more Data values that affect the element's residuals,...</div><div class="ttdef"><b>Definition:</b> <a href="hijacked__elements_8h_source.html#l00131">hijacked_elements.h:131</a></div></div>
<div class="ttc" id="aclassoomph_1_1SpineNode_html_acb15e93d53f62e899a3c126736b41079"><div class="ttname"><a href="classoomph_1_1SpineNode.html#acb15e93d53f62e899a3c126736b41079">oomph::SpineNode::spine_pt</a></div><div class="ttdeci">Spine *&amp; spine_pt()</div><div class="ttdoc">Access function to spine.</div><div class="ttdef"><b>Definition:</b> <a href="spines_8h_source.html#l00372">spines.h:372</a></div></div>
<div class="ttc" id="aclassoomph_1_1HijackedElementBase_html_a9c3a9a4e39ee5e3af0f5594c31f532c5"><div class="ttname"><a href="classoomph_1_1HijackedElementBase.html#a9c3a9a4e39ee5e3af0f5594c31f532c5">oomph::HijackedElementBase::Hijacked_global_eqn_number_pt</a></div><div class="ttdeci">std::set&lt; long * &gt; * Hijacked_global_eqn_number_pt</div><div class="ttdef"><b>Definition:</b> <a href="hijacked__elements_8h_source.html#l00086">hijacked_elements.h:86</a></div></div>
<div class="ttc" id="aclassoomph_1_1HijackedElementBase_html_aa94e2c93374151302879645f4c354c3f"><div class="ttname"><a href="classoomph_1_1HijackedElementBase.html#aa94e2c93374151302879645f4c354c3f">oomph::HijackedElementBase::unhijack_global_eqn</a></div><div class="ttdeci">void unhijack_global_eqn(long *const &amp;global_eqn_pt)</div><div class="ttdoc">The global equation, addressed by global_eqn_pt, is no longer hijacked by this element.</div><div class="ttdef"><b>Definition:</b> <a href="hijacked__elements_8cc_source.html#l00079">hijacked_elements.cc:79</a></div></div>
<div class="ttc" id="aclassoomph_1_1FaceGeometry_3_01Hijacked_3_01ELEMENT_01_4_01_4_html_aa15ca241abd8d8c44efffac9b710a13f"><div class="ttname"><a href="classoomph_1_1FaceGeometry_3_01Hijacked_3_01ELEMENT_01_4_01_4.html#aa15ca241abd8d8c44efffac9b710a13f">oomph::FaceGeometry&lt; Hijacked&lt; ELEMENT &gt; &gt;::FaceGeometry</a></div><div class="ttdeci">FaceGeometry()</div><div class="ttdoc">Constructor.</div><div class="ttdef"><b>Definition:</b> <a href="hijacked__elements_8h_source.html#l00428">hijacked_elements.h:428</a></div></div>
<div class="ttc" id="aclassoomph_1_1DenseMatrix_html"><div class="ttname"><a href="classoomph_1_1DenseMatrix.html">oomph::DenseMatrix&lt; double &gt;</a></div></div>
<div class="ttc" id="aclassoomph_1_1HijackedElementBase_html_a0a373a87d121205b9cc0fd54ea41f4ad"><div class="ttname"><a href="classoomph_1_1HijackedElementBase.html#a0a373a87d121205b9cc0fd54ea41f4ad">oomph::HijackedElementBase::unhijack_all_data</a></div><div class="ttdeci">void unhijack_all_data()</div><div class="ttdoc">Reset the hijacked data pt, so that none of the equations in the element are hijacked.</div><div class="ttdef"><b>Definition:</b> <a href="hijacked__elements_8h_source.html#l00064">hijacked_elements.h:64</a></div></div>
<div class="ttc" id="aclassoomph_1_1HijackedElementBase_html_ad062d9c27f6fd3d613a86b32980fa71e"><div class="ttname"><a href="classoomph_1_1HijackedElementBase.html#ad062d9c27f6fd3d613a86b32980fa71e">oomph::HijackedElementBase::HijackedElementBase</a></div><div class="ttdeci">HijackedElementBase()</div><div class="ttdoc">Constructor, initialise the pointer to the equation numbers for the storage to zero.</div><div class="ttdef"><b>Definition:</b> <a href="hijacked__elements_8h_source.html#l00049">hijacked_elements.h:49</a></div></div>
<div class="ttc" id="aclassoomph_1_1Hijacked_html_adb1760705326df86f6289cc3774d37b9"><div class="ttname"><a href="classoomph_1_1Hijacked.html#adb1760705326df86f6289cc3774d37b9">oomph::Hijacked::get_residuals</a></div><div class="ttdeci">void get_residuals(Vector&lt; double &gt; &amp;residuals)</div><div class="ttdoc">Get the residuals from the underlying element, but then wipe the entries in the residual vector that ...</div><div class="ttdef"><b>Definition:</b> <a href="hijacked__elements_8h_source.html#l00377">hijacked_elements.h:377</a></div></div>
<div class="ttc" id="aelements_8h_html"><div class="ttname"><a href="elements_8h.html">elements.h</a></div></div>
<div class="ttc" id="athe__data__structure_8txt_html_a80f7344c0300e389acecd2d048f2bb58"><div class="ttname"><a href="the__data__structure_8txt.html#a80f7344c0300e389acecd2d048f2bb58">get_residuals</a></div><div class="ttdeci">the nodal coordinates represent the c Nodes fixed positions in this domain When the elastic body material which can be unknowns in the problem To avoid confusion between the the access function for the nodal code we provide a wrapper code in the case of generalised coordinates code Node::x_gen(...) \endcode always refers to the generalised Eulerian position and \code SolidNode endcode where the c MultiPhysicsElement inherits from c SinglePhysicsOneElement and c SinglePhysicsTwoElement A problem with this implementation arises when we consider where to initialise the residuals vector If the second single physics c get_residuals(...) function initialises the residuals vector</div><div class="ttdef"><b>Definition:</b> <a href="the__data__structure_8txt_source.html#l00304">the_data_structure.txt:304</a></div></div>
<div class="ttc" id="aclassoomph_1_1Hijacked_html_a5e4aa47011d8141757f9ecbd8f787811"><div class="ttname"><a href="classoomph_1_1Hijacked.html#a5e4aa47011d8141757f9ecbd8f787811">oomph::Hijacked::Hijacked</a></div><div class="ttdeci">Hijacked(FiniteElement *const &amp;element_pt, const int &amp;face_index)</div><div class="ttdoc">Constructor used for hijacking face elements.</div><div class="ttdef"><b>Definition:</b> <a href="hijacked__elements_8h_source.html#l00138">hijacked_elements.h:138</a></div></div>
<div class="ttc" id="aclassoomph_1_1SolidNode_html"><div class="ttname"><a href="classoomph_1_1SolidNode.html">oomph::SolidNode</a></div><div class="ttdoc">A Class for nodes that deform elastically (i.e. position is an unknown in the problem)....</div><div class="ttdef"><b>Definition:</b> <a href="nodes_8h_source.html#l01710">nodes.h:1710</a></div></div>
<div class="ttc" id="anamespaceoomph_html"><div class="ttname"><a href="namespaceoomph.html">oomph</a></div><div class="ttdoc">DRAIG: Change all instances of (SPATIAL_DIM) to (DIM-1).</div><div class="ttdef"><b>Definition:</b> <a href="advection__diffusion__elements_8cc_source.html#l00029">advection_diffusion_elements.cc:29</a></div></div>
<div class="ttc" id="aclassoomph_1_1Hijacked_html_a3d4f055a9ade75b19d69d8aa7eb26417"><div class="ttname"><a href="classoomph_1_1Hijacked.html#a3d4f055a9ade75b19d69d8aa7eb26417">oomph::Hijacked::hijack_nodal_spine_value</a></div><div class="ttdeci">Data * hijack_nodal_spine_value(const unsigned &amp;n, const unsigned &amp;i, const bool &amp;return_data=true)</div><div class="ttdoc">Hijack the i-th value stored at the spine that affects local node n. Optionally return a custom-made ...</div><div class="ttdef"><b>Definition:</b> <a href="hijacked__elements_8h_source.html#l00279">hijacked_elements.h:279</a></div></div>
<div class="ttc" id="aclassoomph_1_1Data_html_a35cc8d05b72d9101e54ddf5808da4a54"><div class="ttname"><a href="classoomph_1_1Data.html#a35cc8d05b72d9101e54ddf5808da4a54">oomph::Data::eqn_number_pt</a></div><div class="ttdeci">long * eqn_number_pt(const unsigned &amp;i)</div><div class="ttdoc">Return the pointer to the equation number of the i-th stored variable.</div><div class="ttdef"><b>Definition:</b> <a href="nodes_8h_source.html#l00364">nodes.h:364</a></div></div>
<div class="ttc" id="aclassoomph_1_1Vector_html"><div class="ttname"><a href="classoomph_1_1Vector.html">oomph::Vector&lt; int &gt;</a></div></div>
<div class="ttc" id="aclassoomph_1_1Hijacked_html_acd1255b8d3783d0bce222095f9f78aa2"><div class="ttname"><a href="classoomph_1_1Hijacked.html#acd1255b8d3783d0bce222095f9f78aa2">oomph::Hijacked::hijack_nodal_value</a></div><div class="ttdeci">Data * hijack_nodal_value(const unsigned &amp;n, const unsigned &amp;i, const bool &amp;return_data=true)</div><div class="ttdoc">Hijack the i-th value stored at node n. Optionally return a custom-made (copied) data object that con...</div><div class="ttdef"><b>Definition:</b> <a href="hijacked__elements_8h_source.html#l00214">hijacked_elements.h:214</a></div></div>
<div class="ttc" id="aclassoomph_1_1HijackedElementBase_html_ac518df71f978c2b80cd25a1283353ab5"><div class="ttname"><a href="classoomph_1_1HijackedElementBase.html#ac518df71f978c2b80cd25a1283353ab5">oomph::HijackedElementBase::hijack_global_eqn</a></div><div class="ttdeci">void hijack_global_eqn(long *const &amp;global_eqn_pt)</div><div class="ttdoc">Mark the global equation, addressed by global_eqn_pt, as hijacked by this element.</div><div class="ttdef"><b>Definition:</b> <a href="hijacked__elements_8cc_source.html#l00062">hijacked_elements.cc:62</a></div></div>
<div class="ttc" id="aclassoomph_1_1HijackedElementBase_html_a79740641b6ac5b5a966d072bd10ab66a"><div class="ttname"><a href="classoomph_1_1HijackedElementBase.html#a79740641b6ac5b5a966d072bd10ab66a">oomph::HijackedElementBase::residual_multiplier</a></div><div class="ttdeci">const double &amp; residual_multiplier() const</div><div class="ttdoc">Return the value of the residual multiplier.</div><div class="ttdef"><b>Definition:</b> <a href="hijacked__elements_8h_source.html#l00070">hijacked_elements.h:70</a></div></div>
<div class="ttc" id="acfortran_8h_html_adb50e893b86b3e55e751a42eab3cba82"><div class="ttname"><a href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a></div><div class="ttdeci">cstr elem_len * i</div><div class="ttdef"><b>Definition:</b> <a href="cfortran_8h_source.html#l00603">cfortran.h:603</a></div></div>
<div class="ttc" id="aclassoomph_1_1HijackedElementBase_html_a283509b7af09479e7a1cb8c0e05a8c16"><div class="ttname"><a href="classoomph_1_1HijackedElementBase.html#a283509b7af09479e7a1cb8c0e05a8c16">oomph::HijackedElementBase::Residual_multiplier_pt</a></div><div class="ttdeci">double * Residual_multiplier_pt</div><div class="ttdoc">Pointer to a double that multiplies the contribution to the residuals from the original element....</div><div class="ttdef"><b>Definition:</b> <a href="hijacked__elements_8h_source.html#l00098">hijacked_elements.h:98</a></div></div>
<div class="ttc" id="aclassoomph_1_1SpineNode_html"><div class="ttname"><a href="classoomph_1_1SpineNode.html">oomph::SpineNode</a></div><div class="ttdef"><b>Definition:</b> <a href="spines_8h_source.html#l00327">spines.h:327</a></div></div>
<div class="ttc" id="aclassoomph_1_1HijackedData_html"><div class="ttname"><a href="classoomph_1_1HijackedData.html">oomph::HijackedData</a></div><div class="ttdoc">Custom Data class that is used when HijackingData. The class always contains a single value that is c...</div><div class="ttdef"><b>Definition:</b> <a href="nodes_8h_source.html#l00580">nodes.h:580</a></div></div>
<div class="ttc" id="aclassoomph_1_1Spine_html_ac34e4b12d9c1843611e42968ba5d90c7"><div class="ttname"><a href="classoomph_1_1Spine.html#ac34e4b12d9c1843611e42968ba5d90c7">oomph::Spine::spine_height_pt</a></div><div class="ttdeci">Data *&amp; spine_height_pt()</div><div class="ttdoc">Access function to Data object that stores the spine height.</div><div class="ttdef"><b>Definition:</b> <a href="spines_8h_source.html#l00156">spines.h:156</a></div></div>
<div class="ttc" id="aclassoomph_1_1HijackedElementBase_html_ae604da2f744f328f3866a2cefa3aa80c"><div class="ttname"><a href="classoomph_1_1HijackedElementBase.html#ae604da2f744f328f3866a2cefa3aa80c">oomph::HijackedElementBase::Hijacked_local_eqn_number_pt</a></div><div class="ttdeci">Vector&lt; int &gt; * Hijacked_local_eqn_number_pt</div><div class="ttdoc">Pointer to a vector of integers containing the local equation numbers of any hijacked variables in th...</div><div class="ttdef"><b>Definition:</b> <a href="hijacked__elements_8h_source.html#l00091">hijacked_elements.h:91</a></div></div>
<div class="ttc" id="aclassoomph_1_1Hijacked_html_aaf792ec7672bf812fdc5b3e74c31f807"><div class="ttname"><a href="classoomph_1_1Hijacked.html#aaf792ec7672bf812fdc5b3e74c31f807">oomph::Hijacked::Hijacked</a></div><div class="ttdeci">Hijacked()</div><div class="ttdoc">Constructor, call the constructors of the base elements.</div><div class="ttdef"><b>Definition:</b> <a href="hijacked__elements_8h_source.html#l00135">hijacked_elements.h:135</a></div></div>
<div class="ttc" id="athe__data__structure_8txt_html_af88b2d950fae19ab641bd1690e08445c"><div class="ttname"><a href="the__data__structure_8txt.html#af88b2d950fae19ab641bd1690e08445c">n</a></div><div class="ttdeci">endcode We introduce wrapper functions to access function so that we can formulate The Maths in generic terms Rather than referring to the pressure at node c n</div><div class="ttdef"><b>Definition:</b> <a href="the__data__structure_8txt_source.html#l00582">the_data_structure.txt:582</a></div></div>
<div class="ttc" id="aclassoomph_1_1Hijacked_html_a35778dccc9cf036c37ee569efe5b5f7c"><div class="ttname"><a href="classoomph_1_1Hijacked.html#a35778dccc9cf036c37ee569efe5b5f7c">oomph::Hijacked::get_jacobian</a></div><div class="ttdeci">void get_jacobian(Vector&lt; double &gt; &amp;residuals, DenseMatrix&lt; double &gt; &amp;jacobian)</div><div class="ttdoc">Get the residuals and Jacobian matrix from the underlying element, but then wipe the entries in the r...</div><div class="ttdef"><b>Definition:</b> <a href="hijacked__elements_8h_source.html#l00395">hijacked_elements.h:395</a></div></div>
<div class="ttc" id="aclassoomph_1_1HijackedElementBase_html"><div class="ttname"><a href="classoomph_1_1HijackedElementBase.html">oomph::HijackedElementBase</a></div><div class="ttdef"><b>Definition:</b> <a href="hijacked__elements_8h_source.html#l00044">hijacked_elements.h:44</a></div></div>
<div class="ttc" id="aspines_8h_html"><div class="ttname"><a href="spines_8h.html">spines.h</a></div></div>
<div class="ttc" id="aclassoomph_1_1FaceGeometry_3_01FaceGeometry_3_01Hijacked_3_01ELEMENT_01_4_01_4_01_4_html_aeef3807dfeeb7259e2ff63b94c43181a"><div class="ttname"><a href="classoomph_1_1FaceGeometry_3_01FaceGeometry_3_01Hijacked_3_01ELEMENT_01_4_01_4_01_4.html#aeef3807dfeeb7259e2ff63b94c43181a">oomph::FaceGeometry&lt; FaceGeometry&lt; Hijacked&lt; ELEMENT &gt; &gt; &gt;::FaceGeometry</a></div><div class="ttdeci">FaceGeometry()</div><div class="ttdoc">Constructor.</div><div class="ttdef"><b>Definition:</b> <a href="hijacked__elements_8h_source.html#l00443">hijacked_elements.h:443</a></div></div>
<div class="ttc" id="aclassoomph_1_1Hijacked_html_a9e11fa249f667b130e93af9379322182"><div class="ttname"><a href="classoomph_1_1Hijacked.html#a9e11fa249f667b130e93af9379322182">oomph::Hijacked::hijack_external_value</a></div><div class="ttdeci">Data * hijack_external_value(const unsigned &amp;n, const unsigned &amp;i, const bool &amp;return_data=true)</div><div class="ttdoc">Hijack the i-th value stored at external data n. Optionally return a custom-made (copied) data object...</div><div class="ttdef"><b>Definition:</b> <a href="hijacked__elements_8h_source.html#l00188">hijacked_elements.h:188</a></div></div>
<div class="ttc" id="aclassoomph_1_1SolidNode_html_ae9a8abd197728f5555730131fa0f6971"><div class="ttname"><a href="classoomph_1_1SolidNode.html#ae9a8abd197728f5555730131fa0f6971">oomph::SolidNode::variable_position_pt</a></div><div class="ttdeci">Data *const  &amp; variable_position_pt() const</div><div class="ttdoc">Pointer to variable_position data (const version)</div><div class="ttdef"><b>Definition:</b> <a href="nodes_8h_source.html#l01796">nodes.h:1796</a></div></div>
<div class="ttc" id="aclassoomph_1_1Hijacked_html_a835ce930b91c2c138f3b4de12aeba216"><div class="ttname"><a href="classoomph_1_1Hijacked.html#a835ce930b91c2c138f3b4de12aeba216">oomph::Hijacked::hijack_internal_value</a></div><div class="ttdeci">Data * hijack_internal_value(const unsigned &amp;n, const unsigned &amp;i, const bool &amp;return_data=true)</div><div class="ttdoc">Hijack the i-th value stored at internal data n. Optionally return a custom-made (copied) data object...</div><div class="ttdef"><b>Definition:</b> <a href="hijacked__elements_8h_source.html#l00160">hijacked_elements.h:160</a></div></div>
<div class="ttc" id="aclassoomph_1_1HijackedElementBase_html_afd87cc7c33c2b846c5f7a373c352f13a"><div class="ttname"><a href="classoomph_1_1HijackedElementBase.html#afd87cc7c33c2b846c5f7a373c352f13a">oomph::HijackedElementBase::Default_residual_multiplier</a></div><div class="ttdeci">static double Default_residual_multiplier</div><div class="ttdef"><b>Definition:</b> <a href="hijacked__elements_8h_source.html#l00102">hijacked_elements.h:102</a></div></div>
<div class="ttc" id="aclassoomph_1_1Hijacked_html_afd4a5578291487aa37b0931dab845701"><div class="ttname"><a href="classoomph_1_1Hijacked.html#afd4a5578291487aa37b0931dab845701">oomph::Hijacked::assign_local_eqn_numbers</a></div><div class="ttdeci">void assign_local_eqn_numbers(const bool &amp;store_local_dof_pt)</div><div class="ttdoc">Set up the local equation numbers for the underlying element, then set up the local arrays to hold th...</div><div class="ttdef"><b>Definition:</b> <a href="hijacked__elements_8h_source.html#l00318">hijacked_elements.h:318</a></div></div>
<div class="ttc" id="aclassoomph_1_1FaceGeometry_html"><div class="ttname"><a href="classoomph_1_1FaceGeometry.html">oomph::FaceGeometry</a></div><div class="ttdef"><b>Definition:</b> <a href="elements_8h_source.html#l05063">elements.h:5063</a></div></div>
<div class="ttc" id="anamespaceoomph_1_1Global__string__for__annotation_html_ac5379de2fa7fe44f2cb31785fc208135"><div class="ttname"><a href="namespaceoomph_1_1Global__string__for__annotation.html#ac5379de2fa7fe44f2cb31785fc208135">oomph::Global_string_for_annotation::string</a></div><div class="ttdeci">std::string string(const unsigned &amp;i)</div><div class="ttdoc">Return the i-th string or &quot;&quot; if the relevant string hasn't been defined.</div><div class="ttdef"><b>Definition:</b> <a href="oomph__definitions_8cc_source.html#l00286">oomph_definitions.cc:286</a></div></div>

    <!-- jQuery for Bootstrap and Doxygen -->
    <script src="../../js/jquery-1.12.0.min.js"></script>
    <!-- Minified boostrap plugins-->
    <script src="../../js/bootstrap.js"></script>
    <!-- Doxygen dependency to add powertips to source code-->
    <script src="../../js/jquery.powertip.min.js"></script>
    <!-- The  following script is generated by doxygen and hides/shows levels in 
         the data structure lists and adds powertips to source code-->
    <script src="../../js/dynsections.js" ></script>
    <!-- add to Doxygen's class names so bootstrap css and js recognises them-->
    <script type="text/javascript">
    $(".contents").addClass("container");
    $(".header").addClass("container");
    $(".navpath").addClass("container");
    $("#navrow3").addClass("container");
    $("#navrow4").addClass("container");
    $(".mlabel").addClass("label");
    $(".mlabel").addClass("label-default");
    $(".memitem").addClass("panel");
    $(".memitem").addClass("panel-info");
    $(".memproto").addClass("panel-heading");
    $(".memdoc").addClass("panel-body");
    </script>
    <footer>
      <div class="container">
        <div class="text-muted" style="float:right;">Generated by <a href="http://www.doxygen.org/index.html">
          <img style="height:18px;" class="footer-img" src="doxygen.png" alt="doxygen"></a> on Wed Aug 25 2021 19:48:06
        </div>
      </div>
    </footer>
</body>
</html>

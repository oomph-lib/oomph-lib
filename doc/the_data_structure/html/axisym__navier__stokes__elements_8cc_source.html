<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
<title>oomph-lib: axisym_navier_stokes_elements.cc Source File</title>
<link rel="apple-touch-icon" sizes="57x57" href="../../figures/apple-touch-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="../../figures/apple-touch-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="../../figures/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="../../figures/apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="../../figures/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="../../figures/apple-touch-icon-120x120.png">
<link rel="icon" type="image/png" href="../../figures/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="../../figures/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="../../figures/favicon-16x16.png" sizes="16x16">
<link rel="manifest" href="../../figures/manifest.json">
<link rel="mask-icon" href="../../figures/safari-pinned-tab.svg" color="#008000">
<link rel="shortcut icon" href="../../figures/favicon.ico">
<meta name="msapplication-TileColor" content="#00a300">
<meta name="msapplication-config" content="../../figures/browserconfig.xml">
<meta name="theme-color" content="#008000">
<link href="http://fonts.googleapis.com/css?family=Open+Sans:400,300,600" rel="stylesheet" type="text/css">
<!-- Doxygen css-->
<!-- <link rel="stylesheet" type="text/css" href="doxygen.css"> -->
<!-- Bootstrap -->
<link href="../../css/bootstrap.css" rel="stylesheet">
<!-- oomph-lib specific overrides -->
<link rel="stylesheet" type="text/css" href="../../css/oomph_header.css">
</head>
<body>
<nav class="navbar navbar-default">
<div class="container">
<div class="container-fluid">
  <!-- Brand and toggle get grouped for better mobile display -->
  <div class="navbar-header">
    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
      <span class="sr-only">Toggle navigation</span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="../../html/index.html"><img alt="oomph-lib" src="../../figures/oomph_logo.png"></a>
  </div>
  <!-- Collect the nav links, forms, and other content for toggling -->
  <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
    <ul class="nav navbar-nav">          
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Documentation <span class="caret"></span></a>
        <ul class="dropdown-menu">
          <li class="dropdown-header">Big picture</li>
          <li><a href="../../../doc/intro/html/index.html">The finite element method</a></li>
          <li><a href="../../../doc/the_data_structure/html/index.html">The data structure</a></li>
          <li><a href="../../../doc/quick_guide/html/index.html">Not-so-quick guide</a></li>
          <li><a href="../../../doc/optimisation/html/index.html">Optimisation</a></li>
          <li><a href="../../../doc/order_of_action_functions/html/index.html">Order of action functions</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Example codes and tutorials</li>
          <li><a href="../../../doc/example_code_list/html/index.html">List of example codes and tutorials</a></li>
          <li><a href="../../../doc/example_code_list/html/index.html#meshes">Meshing</a></li>
          <li><a href="../../../doc/example_code_list/html/index.html#solvers">Solvers</a></li>
          <li><a href="../../../doc/example_code_list/html/index.html#parallel">MPI parallel processing</a></li>
          <li><a href="../../../doc/example_code_list/html/index.html#visualisation">Post-processing/visualisation</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Other</li>
          <li><a href="../../../doc/change_log/html/index.html">Change log</a></li>
          <li><a href="../../../doc/creating_doc/html/index.html">Creating documentation</a></li>
          <li><a href="../../../doc/coding_conventions/html/index.html">Coding conventions</a></li>
          <li><a href="../../../doc/index/html/index.html">Index</a></li>
          <li><a href="../../../doc/FAQ/html/index.html">FAQ</a></li>
        </ul>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Get it <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../doc/the_distribution/html/index.html">Installation guide</a></li>
            <li><a href="../../../doc/subversion/html/index.html">Get code from subversion repository</a></li>
            <li><a href="../../../doc/download/html/index.html">Get code as tar file</a></li>
            <li><a href="../../../doc/copyright/html/index.html">Copyright</a></li>
          </ul>
        </li>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">About <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../doc/people/html/index.html">People</a></li>            
            <li><a href="../../../doc/contact/html/index.html">Contact/Get involved</a></li>
            <li><a href="../../../doc/publications/html/index.html">Publications</a></li>
            <li><a href="../../../doc/acknowledgements/html/index.html">Acknowledgements</a></li>
            <li><a href="../../../doc/picture_show/index.html">Picture show</a></li>
          </ul>
        </li>
      </li>
    </ul>
    <ul class="nav navbar-nav navbar-right navbar-search">
      <form class="navbar-form" role="search" action="../../../doc/search_results/html/index.html">
        <div class="input-group">
          <input type="text" class="form-control" placeholder="Search" name="q">
          <span class="input-group-btn">
            <button class="btn btn-default" type="submit">Go</button>
          </span>
        </div><!-- /input-group -->
       <!--<div class="form-group">
          <input type="text" class="form-control" placeholder="Search">
        </div>
        <button type="submit" class="btn btn-default">Submit</button>-->
      </form>
    </ul>
  </div><!-- /.navbar-collapse -->
</div><!-- /.container-fluid -->
</div>
</nav>
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_b4701c55780f5db8d6465ead99d41949.html">axisym_navier_stokes</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">axisym_navier_stokes_elements.cc</div>  </div>
</div><!--header-->
<div class="contents">
<a href="axisym__navier__stokes__elements_8cc.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">//LIC// ====================================================================</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">//LIC// This file forms part of oomph-lib, the object-oriented, </span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">//LIC// multi-physics finite-element library, available </span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">//LIC// at http://www.oomph-lib.org.</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">//LIC// Copyright (C) 2006-2021 Matthias Heil and Andrew Hazel</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">//LIC// This library is free software; you can redistribute it and/or</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">//LIC// modify it under the terms of the GNU Lesser General Public</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">//LIC// License as published by the Free Software Foundation; either</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">//LIC// version 2.1 of the License, or (at your option) any later version.</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">//LIC// This library is distributed in the hope that it will be useful,</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">//LIC// but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">//LIC// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">//LIC// Lesser General Public License for more details.</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">//LIC// You should have received a copy of the GNU Lesser General Public</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">//LIC// License along with this library; if not, write to the Free Software</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">//LIC// Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">//LIC// 02110-1301  USA.</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">//LIC// The authors may be contacted at oomph-lib@maths.man.ac.uk.</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">//LIC//====================================================================</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">// Non-inline functions for NS elements</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="axisym__navier__stokes__elements_8h.html">axisym_navier_stokes_elements.h</a>&quot;</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160; </div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160; </div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespaceoomph.html">oomph</a></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;{</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment">/// Navier--Stokes equations static data</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment"></span>Vector&lt;double&gt; <a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#aff943b6b83128398a0320cae90c6b94c">AxisymmetricNavierStokesEquations::Gamma</a>(2,1.0);</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160; </div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment">//=================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment">/// &quot;Magic&quot; negative number that indicates that the pressure is</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment">/// not stored at a node. This cannot be -1 because that represents</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment">/// the positional hanging scheme in the hanging_pt object of nodes</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment"></span><span class="comment">//=================================================================</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160; <span class="keywordtype">int</span> <a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a7de6189781f4b7f59de7ae96f669a93b">AxisymmetricNavierStokesEquations::Pressure_not_stored_at_node</a> = -100;</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment">/// Navier--Stokes equations static data</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment"></span><span class="keywordtype">double</span> <a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a8ee03721082e7ca463e79083f4029b24">AxisymmetricNavierStokesEquations::</a></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a8ee03721082e7ca463e79083f4029b24">Default_Physical_Constant_Value</a> = 0.0;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160; </div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment">// Navier--Stokes equations static data</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="keywordtype">double</span> <a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a817781d8e3ef49e200ab675d3b48c541">AxisymmetricNavierStokesEquations::</a></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a817781d8e3ef49e200ab675d3b48c541">Default_Physical_Ratio_Value</a> = 1.0;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment">/// Navier-Stokes equations default gravity vector</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment"></span>Vector&lt;double&gt; <a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a03822b722ac8aa9adceaa52aa4f7dafa">AxisymmetricNavierStokesEquations::</a></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a03822b722ac8aa9adceaa52aa4f7dafa">Default_Gravity_vector</a>(3,0.0);</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160; </div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160; </div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment">//================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="comment">/// Compute the diagonal of the velocity/pressure mass matrices.</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment">/// If which one=0, both are computed, otherwise only the pressure </span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment">/// (which_one=1) or the velocity mass matrix (which_one=2 -- the </span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment">/// LSC version of the preconditioner only needs that one)</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment">/// NOTE: pressure versions isn&#39;t implemented yet because this</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment">///       element has never been tried with Fp preconditoner.</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment"></span><span class="comment">//================================================================</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160; <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#ac0c850c7a41b408784f3a103f9aba982">AxisymmetricNavierStokesEquations::</a></div>
<div class="line"><a name="l00065"></a><span class="lineno"><a class="line" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#ac0c850c7a41b408784f3a103f9aba982">   65</a></span>&#160;<a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#ac0c850c7a41b408784f3a103f9aba982"> get_pressure_and_velocity_mass_matrix_diagonal</a>(</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;press_mass_diag, <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;veloc_mass_diag,</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; which_one)</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160; {</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160; </div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  <span class="keywordflow">if</span> ((which_one==0)||(which_one==1)) </div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;   {</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="classoomph_1_1OomphLibError.html">OomphLibError</a>(</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;     <span class="stringliteral">&quot;Computation of diagonal of pressure mass matrix is not impmented yet.\n&quot;</span>,</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;     OOMPH_CURRENT_FUNCTION,</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;     OOMPH_EXCEPTION_LOCATION);</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;   }</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="preprocessor">#endif  </span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160; </div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  <span class="comment">// Resize and initialise</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  veloc_mass_diag.assign(<a class="code" href="classoomph_1_1GeneralisedElement.html#a37204f67b37d212fd170c68d48f6da57">ndof</a>(), 0.0);</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;  </div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  <span class="comment">// find out how many nodes there are</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_node = <a class="code" href="classoomph_1_1FiniteElement.html#a6219ed269a6d89b5aa14659cce48905a">nnode</a>();</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  </div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;  <span class="comment">// find number of coordinates</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_value = 3;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  </div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  <span class="comment">// find the indices at which the local velocities are stored</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  <a class="code" href="classoomph_1_1Vector.html">Vector&lt;unsigned&gt;</a> u_nodal_index(n_value);</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0; <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;n_value; <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;   {</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    u_nodal_index[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] = this-&gt;<a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#afbdea50fcf4799e2e4e5209ee3249bf0">u_index_axi_nst</a>(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>);</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;   }</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  </div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  <span class="comment">//Set up memory for test functions</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  <a class="code" href="classoomph_1_1Shape.html">Shape</a> test(n_node);</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  </div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  <span class="comment">//Number of integration points</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  <span class="keywordtype">unsigned</span> n_intpt = <a class="code" href="classoomph_1_1FiniteElement.html#a79f1710873332823c47023d370f0596b">integral_pt</a>()-&gt;<a class="code" href="classoomph_1_1Integral.html#a1a270de9d99a1fcf1d25a6c1017f65fa">nweight</a>();</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  </div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  <span class="comment">//Integer to store the local equations no</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  <span class="keywordtype">int</span> local_eqn=0;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  </div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  <span class="comment">//Loop over the integration points</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> ipt=0; ipt&lt;n_intpt; ipt++)</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;   {</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    </div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <span class="comment">//Get the integral weight</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <span class="keywordtype">double</span> w = <a class="code" href="classoomph_1_1FiniteElement.html#a79f1710873332823c47023d370f0596b">integral_pt</a>()-&gt;<a class="code" href="classoomph_1_1Integral.html#ac65335e2aab120b285b3d6c294507b06">weight</a>(ipt);</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160; </div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <span class="comment">//Get determinant of Jacobian of the mapping</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    <span class="keywordtype">double</span> J = <a class="code" href="classoomph_1_1FiniteElement.html#aa8a201e448a9200af7f87d612ef01227">J_eulerian_at_knot</a>(ipt);</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    </div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <span class="comment">//Premultiply weights and Jacobian</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a> = w*J;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160; </div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <span class="comment">//Get the velocity test functions - there is no explicit </span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    <span class="comment">// function to give the test function so use shape</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    <a class="code" href="classoomph_1_1FiniteElement.html#aeccc0f774e3fab8c536e2d41004a1665">shape_at_knot</a>(ipt,test);</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    </div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <span class="comment">//Need to get the position to sort out the jacobian properly</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    <span class="keywordtype">double</span> r = 0.0;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l=0;l&lt;n_node;l++)</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;     {</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;      r += this-&gt;<a class="code" href="classoomph_1_1FiniteElement.html#a9152c16ae9899168bcdaac7c2f977444">nodal_position</a>(l,0)*test(l);</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;     }</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160; </div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <span class="comment">//Multiply by the geometric factor</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a> *= r;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160; </div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <span class="comment">//Loop over the veclocity test functions</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l=0; l&lt;n_node; l++)</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;     {</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;      <span class="comment">//Loop over the velocity components</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0; <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;n_value; <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;       {</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;        local_eqn = <a class="code" href="classoomph_1_1FiniteElement.html#a5da80bbed97543e586f698251d67941d">nodal_local_eqn</a>(l,u_nodal_index[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]);</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160; </div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        <span class="comment">//If not a boundary condition</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        <span class="keywordflow">if</span>(local_eqn &gt;= 0)</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;         {</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;          <span class="comment">//Add the contribution</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;          veloc_mass_diag[local_eqn] += test[l]*test[l] * <a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;         } <span class="comment">//End of if not boundary condition statement</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;       } <span class="comment">//End of loop over dimension</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;     } <span class="comment">//End of loop over test functions</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160; </div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;   }</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160; }</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160; </div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160; </div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="comment">//======================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="comment">/// Validate against exact velocity solution at given time.</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="comment">/// Solution is provided via function pointer.</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="comment">/// Plot at a given number of plot points and compute L2 error</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="comment">/// and L2 norm of velocity solution over element.</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="comment"></span><span class="comment">//=======================================================================</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a827372afbe927e224d3648b7d6477f2d">AxisymmetricNavierStokesEquations::</a></div>
<div class="line"><a name="l00160"></a><span class="lineno"><a class="line" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a827372afbe927e224d3648b7d6477f2d">  160</a></span>&#160;<a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a827372afbe927e224d3648b7d6477f2d">compute_error</a>(std::ostream &amp;outfile,</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;              <a class="code" href="classoomph_1_1FiniteElement.html#ad4ecf2b61b158a4b4d351a60d23c633e">FiniteElement::UnsteadyExactSolutionFctPt</a> exact_soln_pt,</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;              <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; time,</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;              <span class="keywordtype">double</span>&amp; error, <span class="keywordtype">double</span>&amp; norm)</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;{</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160; error=0.0;</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160; norm=0.0;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160; </div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160; <span class="comment">//Vector of local coordinates</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160; <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>(2);</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160; </div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160; <span class="comment">// Vector for coordintes</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160; <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> x(2);</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160; </div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160; <span class="comment">//Set the value of Nintpt</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160; <span class="keywordtype">unsigned</span> Nintpt = <a class="code" href="classoomph_1_1FiniteElement.html#a79f1710873332823c47023d370f0596b">integral_pt</a>()-&gt;<a class="code" href="classoomph_1_1Integral.html#a1a270de9d99a1fcf1d25a6c1017f65fa">nweight</a>();</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;   </div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160; outfile &lt;&lt; <span class="stringliteral">&quot;ZONE&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160; </div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160; <span class="comment">// Exact solution Vector (u,v,w,p)</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160; <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> exact_soln(4);</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;   </div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160; <span class="comment">//Loop over the integration points</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160; <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> ipt=0;ipt&lt;Nintpt;ipt++)</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;  {</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;   <span class="comment">//Assign values of s</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;2;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++) {<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] = <a class="code" href="classoomph_1_1FiniteElement.html#a79f1710873332823c47023d370f0596b">integral_pt</a>()-&gt;<a class="code" href="classoomph_1_1Integral.html#a1a2122f99a87c18649bafdd9ed739758">knot</a>(ipt,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>);}</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160; </div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;   <span class="comment">//Get the integral weight</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;   <span class="keywordtype">double</span> w = <a class="code" href="classoomph_1_1FiniteElement.html#a79f1710873332823c47023d370f0596b">integral_pt</a>()-&gt;<a class="code" href="classoomph_1_1Integral.html#ac65335e2aab120b285b3d6c294507b06">weight</a>(ipt);</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160; </div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;   <span class="comment">// Get jacobian of mapping</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;   <span class="keywordtype">double</span> J = <a class="code" href="classoomph_1_1FiniteElement.html#a089e58d5ad9b8efee637221b0e264563">J_eulerian</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>);</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160; </div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;   <span class="comment">// Get x position as Vector</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;   <a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,x);</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160; </div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;   <span class="comment">//Premultiply the weights and the Jacobian and r</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;   <span class="keywordtype">double</span> <a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a> = w*J*x[0];</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160; </div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;   <span class="comment">// Get exact solution at this point</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;   (*exact_soln_pt)(time,x,exact_soln);</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160; </div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;   <span class="comment">// Velocity error</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;3;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    {</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;     norm+=exact_soln[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]*exact_soln[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;     error+=(exact_soln[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]-<a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a6be05bce8f257044e1bb6929aa5e791e">interpolated_u_axi_nst</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>))*</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;      (exact_soln[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]-<a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a6be05bce8f257044e1bb6929aa5e791e">interpolated_u_axi_nst</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>))*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    }</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160; </div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;   <span class="comment">//Output x,y,...,u_exact</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;2;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++) {outfile &lt;&lt; x[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;}</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160; </div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;   <span class="comment">//Output x,y,[z],u_error,v_error,[w_error]</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;3;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    {outfile &lt;&lt; exact_soln[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]-<a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a6be05bce8f257044e1bb6929aa5e791e">interpolated_u_axi_nst</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>) &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;}</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160; </div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;   outfile &lt;&lt; std::endl;</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;  }</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;}</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160; </div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="comment">//======================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="comment">/// Validate against exact velocity solution</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="comment">/// Solution is provided via function pointer.</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="comment">/// Plot at a given number of plot points and compute L2 error</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<span class="comment">/// and L2 norm of velocity solution over element.</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;<span class="comment"></span><span class="comment">//=======================================================================</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a827372afbe927e224d3648b7d6477f2d">AxisymmetricNavierStokesEquations::</a></div>
<div class="line"><a name="l00229"></a><span class="lineno"><a class="line" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#af7cc7591c11d44f8d426502b3bd5c81f">  229</a></span>&#160;<a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a827372afbe927e224d3648b7d6477f2d">compute_error</a>(std::ostream &amp;outfile,</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;              <a class="code" href="classoomph_1_1FiniteElement.html#a690fd33af26cc3e84f39bba6d5a85202">FiniteElement::SteadyExactSolutionFctPt</a> exact_soln_pt,</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;              <span class="keywordtype">double</span>&amp; error, <span class="keywordtype">double</span>&amp; norm)</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;{</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160; error=0.0;</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160; norm=0.0;</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160; </div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160; <span class="comment">//Vector of local coordinates</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160; <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>(2);</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160; </div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160; <span class="comment">// Vector for coordintes</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160; <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> x(2);</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160; </div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160; <span class="comment">//Set the value of Nintpt</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160; <span class="keywordtype">unsigned</span> Nintpt = <a class="code" href="classoomph_1_1FiniteElement.html#a79f1710873332823c47023d370f0596b">integral_pt</a>()-&gt;<a class="code" href="classoomph_1_1Integral.html#a1a270de9d99a1fcf1d25a6c1017f65fa">nweight</a>();</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160; </div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160; outfile &lt;&lt; <span class="stringliteral">&quot;ZONE&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160; </div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160; <span class="comment">// Exact solution Vector (u,v,w,p)</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160; <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> exact_soln(4);</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160; </div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160; <span class="comment">//Loop over the integration points</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160; <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> ipt=0;ipt&lt;Nintpt;ipt++)</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;  {</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;   </div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;   <span class="comment">//Assign values of s</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;2;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++) {<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] = <a class="code" href="classoomph_1_1FiniteElement.html#a79f1710873332823c47023d370f0596b">integral_pt</a>()-&gt;<a class="code" href="classoomph_1_1Integral.html#a1a2122f99a87c18649bafdd9ed739758">knot</a>(ipt,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>);}</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;   </div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;   <span class="comment">//Get the integral weight</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;   <span class="keywordtype">double</span> w = <a class="code" href="classoomph_1_1FiniteElement.html#a79f1710873332823c47023d370f0596b">integral_pt</a>()-&gt;<a class="code" href="classoomph_1_1Integral.html#ac65335e2aab120b285b3d6c294507b06">weight</a>(ipt);</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;   </div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;   <span class="comment">// Get jacobian of mapping</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;   <span class="keywordtype">double</span> J=<a class="code" href="classoomph_1_1FiniteElement.html#a089e58d5ad9b8efee637221b0e264563">J_eulerian</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>);</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;   </div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;   <span class="comment">// Get x position as Vector</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;   <a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,x);</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;   </div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;   <span class="comment">//Premultiply the weights and the Jacobian and r</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;   <span class="keywordtype">double</span> <a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a> = w*J*x[0];</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;   </div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;   <span class="comment">// Get exact solution at this point</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;   (*exact_soln_pt)(x,exact_soln);</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;   </div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;   <span class="comment">// Velocity error</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;3;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    {</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;     norm+=exact_soln[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]*exact_soln[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;     error+=(exact_soln[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]-<a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a6be05bce8f257044e1bb6929aa5e791e">interpolated_u_axi_nst</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>))*</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;      (exact_soln[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]-<a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a6be05bce8f257044e1bb6929aa5e791e">interpolated_u_axi_nst</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>))*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    }</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160; </div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;   <span class="comment">//Output x,y,...,u_exact</span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;2;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++) {outfile &lt;&lt; x[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;}</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160; </div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;     <span class="comment">//Output x,y,u_error,v_error,w_error</span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;3;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;      {outfile &lt;&lt; exact_soln[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]-<a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a6be05bce8f257044e1bb6929aa5e791e">interpolated_u_axi_nst</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>) &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;}</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160; </div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;     outfile &lt;&lt; std::endl;</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;  }</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;}</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160; </div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;<span class="comment">//======================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<span class="comment">/// Output &quot;exact&quot; solution</span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<span class="comment">/// Solution is provided via function pointer.</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;<span class="comment">/// Plot at a given number of plot points.</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;<span class="comment">/// Function prints as many components as are returned in solution Vector.</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="comment"></span><span class="comment">//=======================================================================</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a454a2d627bad75944359e90be0a535a5">AxisymmetricNavierStokesEquations::</a></div>
<div class="line"><a name="l00298"></a><span class="lineno"><a class="line" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a454a2d627bad75944359e90be0a535a5">  298</a></span>&#160;<a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a454a2d627bad75944359e90be0a535a5">output_fct</a>(std::ostream &amp;outfile, </div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;           <span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;nplot, </div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;           <a class="code" href="classoomph_1_1FiniteElement.html#a690fd33af26cc3e84f39bba6d5a85202">FiniteElement::SteadyExactSolutionFctPt</a> exact_soln_pt)</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;{</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160; </div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160; <span class="comment">//Vector of local coordinates</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160; <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>(2);</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160; </div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160; <span class="comment">// Vector for coordintes</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160; <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> x(2);</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160; </div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160; <span class="comment">// Tecplot header info</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160; outfile &lt;&lt; <a class="code" href="classoomph_1_1FiniteElement.html#a3193df31f9ce38e0609d17a8ffb386c6">tecplot_zone_string</a>(nplot);</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160; </div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160; <span class="comment">// Exact solution Vector</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160; <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> exact_soln;</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160; </div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160; <span class="comment">// Loop over plot points</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160; <span class="keywordtype">unsigned</span> num_plot_points=<a class="code" href="classoomph_1_1FiniteElement.html#a8ed563c7ff0cfd8bafdbb0132b388106">nplot_points</a>(nplot);</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160; <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> iplot=0;iplot&lt;num_plot_points;iplot++)</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;  {</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;   </div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;   <span class="comment">// Get local coordinates of plot point</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;   <a class="code" href="classoomph_1_1FiniteElement.html#a82da844fd3ebb2005842464cdc148a03">get_s_plot</a>(iplot,nplot,<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>);</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;   </div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;   <span class="comment">// Get x position as Vector</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;   <a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,x);</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;   </div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;   <span class="comment">// Get exact solution at this point</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;   (*exact_soln_pt)(x,exact_soln);</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;   </div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;   <span class="comment">//Output x,y,...</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;2;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    {</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;     outfile &lt;&lt; x[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    }</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;   </div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;   <span class="comment">//Output &quot;exact solution&quot;</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;exact_soln.size();<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    {</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;     outfile &lt;&lt; exact_soln[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    }</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;   </div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;   outfile &lt;&lt; std::endl;</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;   </div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;  }</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160; </div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160; <span class="comment">// Write tecplot footer (e.g. FE connectivity lists)</span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160; <a class="code" href="classoomph_1_1FiniteElement.html#ac3987a5ead7dc20c63d86b333466e2b5">write_tecplot_zone_footer</a>(outfile,nplot);</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160; </div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;}</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160; </div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;<span class="comment">//======================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;<span class="comment">/// Output &quot;exact&quot; solution at a given time</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;<span class="comment">/// Solution is provided via function pointer.</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;<span class="comment">/// Plot at a given number of plot points.</span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;<span class="comment">/// Function prints as many components as are returned in solution Vector.</span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;<span class="comment"></span><span class="comment">//=======================================================================</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a454a2d627bad75944359e90be0a535a5">AxisymmetricNavierStokesEquations::</a></div>
<div class="line"><a name="l00357"></a><span class="lineno"><a class="line" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a4a706a0922fc624f337fc5e5376002ae">  357</a></span>&#160;<a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a454a2d627bad75944359e90be0a535a5">output_fct</a>(std::ostream &amp;outfile,</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;           <span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;nplot, </div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;           <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; time,</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;           <a class="code" href="classoomph_1_1FiniteElement.html#ad4ecf2b61b158a4b4d351a60d23c633e">FiniteElement::UnsteadyExactSolutionFctPt</a> exact_soln_pt)</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;{</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160; </div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160; <span class="comment">//Vector of local coordinates</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160; <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>(2);</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160; </div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160; <span class="comment">// Vector for coordintes</span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160; <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> x(2);</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;  </div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160; <span class="comment">// Tecplot header info</span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160; outfile &lt;&lt; <a class="code" href="classoomph_1_1FiniteElement.html#a3193df31f9ce38e0609d17a8ffb386c6">tecplot_zone_string</a>(nplot);</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160; </div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160; <span class="comment">// Exact solution Vector</span></div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160; <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> exact_soln;</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160; </div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160; <span class="comment">// Loop over plot points</span></div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160; <span class="keywordtype">unsigned</span> num_plot_points=<a class="code" href="classoomph_1_1FiniteElement.html#a8ed563c7ff0cfd8bafdbb0132b388106">nplot_points</a>(nplot);</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160; <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> iplot=0;iplot&lt;num_plot_points;iplot++)</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;  {</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;   </div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;   <span class="comment">// Get local coordinates of plot point</span></div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;   <a class="code" href="classoomph_1_1FiniteElement.html#a82da844fd3ebb2005842464cdc148a03">get_s_plot</a>(iplot,nplot,<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>);</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;   </div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;   <span class="comment">// Get x position as Vector</span></div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;   <a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,x);</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;   </div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;   <span class="comment">// Get exact solution at this point</span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;   (*exact_soln_pt)(time,x,exact_soln);</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;   </div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;   <span class="comment">//Output x,y,...</span></div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;2;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    {</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;     outfile &lt;&lt; x[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;    }</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;   </div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;   <span class="comment">//Output &quot;exact solution&quot;</span></div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;exact_soln.size();<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    {</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;     outfile &lt;&lt; exact_soln[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    }</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;   </div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;   outfile &lt;&lt; std::endl;</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;   </div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;  }</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160; </div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160; <span class="comment">// Write tecplot footer (e.g. FE connectivity lists)</span></div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160; <a class="code" href="classoomph_1_1FiniteElement.html#ac3987a5ead7dc20c63d86b333466e2b5">write_tecplot_zone_footer</a>(outfile,nplot);</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160; </div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;}</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160; </div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;<span class="comment">//==============================================================</span><span class="comment"></span></div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;<span class="comment">/// Output function: Velocities only  </span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;<span class="comment">/// x,y,[z],u,v,[w]</span></div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;<span class="comment">/// in tecplot format at specified previous timestep (t=0: present;</span></div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;<span class="comment">/// t&gt;0: previous timestep). Specified number of plot points in each</span></div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;<span class="comment">/// coordinate direction.</span></div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;<span class="comment"></span><span class="comment">//==============================================================</span></div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a3993d25e1ae47080505ec2570ba8c41f">AxisymmetricNavierStokesEquations::</a></div>
<div class="line"><a name="l00418"></a><span class="lineno"><a class="line" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a3993d25e1ae47080505ec2570ba8c41f">  418</a></span>&#160;<a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a3993d25e1ae47080505ec2570ba8c41f">output_veloc</a>(std::ostream &amp;outfile, </div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;             <span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;nplot, </div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;             <span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;<a class="code" href="cfortran_8h.html#af6f0bd3dc13317f895c91323c25c2b8f">t</a>) </div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;{</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160; <span class="comment">//Find number of nodes</span></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160; <span class="keywordtype">unsigned</span> n_node = <a class="code" href="classoomph_1_1FiniteElement.html#a6219ed269a6d89b5aa14659cce48905a">nnode</a>();</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160; </div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160; <span class="comment">//Local shape function</span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160; <a class="code" href="classoomph_1_1Shape.html">Shape</a> psi(n_node);</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160; </div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160; <span class="comment">//Vectors of local coordinates and coords and velocities</span></div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160; <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>(2);</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160; <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> <a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>(2);</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160; <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> <a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>(3);</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160; </div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160; </div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160; <span class="comment">// Tecplot header info</span></div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160; outfile &lt;&lt; <a class="code" href="classoomph_1_1FiniteElement.html#a3193df31f9ce38e0609d17a8ffb386c6">tecplot_zone_string</a>(nplot);</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160; </div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160; <span class="comment">// Loop over plot points</span></div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160; <span class="keywordtype">unsigned</span> num_plot_points=<a class="code" href="classoomph_1_1FiniteElement.html#a8ed563c7ff0cfd8bafdbb0132b388106">nplot_points</a>(nplot);</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160; <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> iplot=0;iplot&lt;num_plot_points;iplot++)</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;  {</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;   </div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;   <span class="comment">// Get local coordinates of plot point</span></div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;   <a class="code" href="classoomph_1_1FiniteElement.html#a82da844fd3ebb2005842464cdc148a03">get_s_plot</a>(iplot,nplot,<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>);</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;  </div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;   <span class="comment">// Get shape functions</span></div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;   <a class="code" href="classoomph_1_1FiniteElement.html#a58a25b6859ddd43b7bfe64a19fee5023">shape</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,psi);</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160; </div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;   <span class="comment">// Loop over coordinate directions</span></div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;2;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++) </div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    {</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;     <a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]=0.0;</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;     <span class="comment">//Loop over the local nodes and sum</span></div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l=0;l&lt;n_node;l++) </div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;      {<a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] += <a class="code" href="classoomph_1_1FiniteElement.html#a9152c16ae9899168bcdaac7c2f977444">nodal_position</a>(<a class="code" href="cfortran_8h.html#af6f0bd3dc13317f895c91323c25c2b8f">t</a>,l,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>)*psi[l];}</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    }</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;   </div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;   <span class="comment">//Loop over the velocity components</span></div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;3;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++) </div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    {</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;     <span class="comment">//Get the index at which the velocity is stored</span></div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;     <span class="keywordtype">unsigned</span> u_nodal_index = <a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#afbdea50fcf4799e2e4e5209ee3249bf0">u_index_axi_nst</a>(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>);</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;     <a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]=0.0;</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;     <span class="comment">//Loop over the local nodes and sum</span></div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l=0;l&lt;n_node;l++) </div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;      {<a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] += <a class="code" href="classoomph_1_1FiniteElement.html#a28fd5c2d4aeba5ef65bee0e0d72569f5">nodal_value</a>(<a class="code" href="cfortran_8h.html#af6f0bd3dc13317f895c91323c25c2b8f">t</a>,l,u_nodal_index)*psi[l];}</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    }</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160; </div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;   <span class="comment">// Coordinates</span></div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;2;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++) {outfile &lt;&lt; <a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;}</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;   </div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;   <span class="comment">// Velocities</span></div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;3;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++) {outfile &lt;&lt; <a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;}</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;   </div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;   outfile &lt;&lt; std::endl;   </div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;  }</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160; </div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160; <span class="comment">// Write tecplot footer (e.g. FE connectivity lists)</span></div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160; <a class="code" href="classoomph_1_1FiniteElement.html#ac3987a5ead7dc20c63d86b333466e2b5">write_tecplot_zone_footer</a>(outfile,nplot);</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160; </div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;}</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160; </div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;<span class="comment">//==============================================================</span><span class="comment"></span></div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;<span class="comment">/// Output function: </span></div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;<span class="comment">/// r,z,u,v,w,p</span></div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;<span class="comment">/// in tecplot format. Specified number of plot points in each</span></div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;<span class="comment">/// coordinate direction.</span></div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;<span class="comment"></span><span class="comment">//==============================================================</span></div>
<div class="line"><a name="l00488"></a><span class="lineno"><a class="line" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a94a243ca05ba3b995e366564e6cf7695">  488</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#afe0c7b607ec3fd03a73b7db4f1fe6252">AxisymmetricNavierStokesEquations::output</a>(std::ostream &amp;outfile, </div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;                                               <span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;nplot)</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;{</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160; <span class="comment">//Vector of local coordinates</span></div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160; <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>(2);</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160; </div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;  <span class="comment">// Tecplot header info</span></div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160; outfile &lt;&lt; <a class="code" href="classoomph_1_1FiniteElement.html#a3193df31f9ce38e0609d17a8ffb386c6">tecplot_zone_string</a>(nplot);</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160; </div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160; <span class="comment">// Loop over plot points</span></div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160; <span class="keywordtype">unsigned</span> num_plot_points=<a class="code" href="classoomph_1_1FiniteElement.html#a8ed563c7ff0cfd8bafdbb0132b388106">nplot_points</a>(nplot);</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160; <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> iplot=0;iplot&lt;num_plot_points;iplot++)</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;  {</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;   </div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;   <span class="comment">// Get local coordinates of plot point</span></div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;   <a class="code" href="classoomph_1_1FiniteElement.html#a82da844fd3ebb2005842464cdc148a03">get_s_plot</a>(iplot,nplot,<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>);</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;  </div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;   <span class="comment">// Coordinates</span></div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;2;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++) {outfile &lt;&lt; <a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>) &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;}</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;   </div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;   <span class="comment">// Velocities</span></div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;3;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++) {outfile &lt;&lt; <a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a6be05bce8f257044e1bb6929aa5e791e">interpolated_u_axi_nst</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>) &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;}</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;   </div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;   <span class="comment">// Pressure</span></div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;   outfile &lt;&lt; <a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#ab355488fd99663f08df3aa24d8a8eec4">interpolated_p_axi_nst</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>)  &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;   </div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;   outfile &lt;&lt; std::endl;   </div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;  }</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160; outfile &lt;&lt; std::endl;</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160; </div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160; <span class="comment">// Write tecplot footer (e.g. FE connectivity lists)</span></div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160; <a class="code" href="classoomph_1_1FiniteElement.html#ac3987a5ead7dc20c63d86b333466e2b5">write_tecplot_zone_footer</a>(outfile,nplot);</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160; </div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;}</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160; </div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160; </div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;<span class="comment">//==============================================================</span><span class="comment"></span></div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;<span class="comment">/// Output function: </span></div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;<span class="comment">/// r,z,u,v,w,p</span></div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;<span class="comment">/// in tecplot format. Specified number of plot points in each</span></div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;<span class="comment">/// coordinate direction.</span></div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;<span class="comment"></span><span class="comment">//==============================================================</span></div>
<div class="line"><a name="l00530"></a><span class="lineno"><a class="line" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#abc2ca00250845e243da3f4e0845b2c96">  530</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#afe0c7b607ec3fd03a73b7db4f1fe6252">AxisymmetricNavierStokesEquations::output</a>(FILE* file_pt,</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;                                               <span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;nplot)</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;{</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160; <span class="comment">//Vector of local coordinates</span></div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160; <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>(2);</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160; </div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160; <span class="comment">// Tecplot header info</span></div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;  fprintf(file_pt,<span class="stringliteral">&quot;%s &quot;</span>,<a class="code" href="classoomph_1_1FiniteElement.html#a3193df31f9ce38e0609d17a8ffb386c6">tecplot_zone_string</a>(nplot).c_str());</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160; </div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160; <span class="comment">// Loop over plot points</span></div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160; <span class="keywordtype">unsigned</span> num_plot_points=<a class="code" href="classoomph_1_1FiniteElement.html#a8ed563c7ff0cfd8bafdbb0132b388106">nplot_points</a>(nplot);</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160; <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> iplot=0;iplot&lt;num_plot_points;iplot++)</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;  {</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;   </div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;   <span class="comment">// Get local coordinates of plot point</span></div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;   <a class="code" href="classoomph_1_1FiniteElement.html#a82da844fd3ebb2005842464cdc148a03">get_s_plot</a>(iplot,nplot,<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>);</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;  </div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;   <span class="comment">// Coordinates</span></div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;2;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++) </div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;    {</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;     <span class="comment">//outfile &lt;&lt; interpolated_x(s,i) &lt;&lt; &quot; &quot;;</span></div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;     fprintf(file_pt,<span class="stringliteral">&quot;%g &quot;</span>,<a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>));</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;    }</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;   </div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;   <span class="comment">// Velocities</span></div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;3;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++) </div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;    {</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;     <span class="comment">//outfile &lt;&lt; interpolated_u(s,i) &lt;&lt; &quot; &quot;;</span></div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;     fprintf(file_pt,<span class="stringliteral">&quot;%g &quot;</span>,<a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a6be05bce8f257044e1bb6929aa5e791e">interpolated_u_axi_nst</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>));</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;    }</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;   </div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;   <span class="comment">// Pressure</span></div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;   <span class="comment">//outfile &lt;&lt; interpolated_p(s)  &lt;&lt; &quot; &quot;;</span></div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;   fprintf(file_pt,<span class="stringliteral">&quot;%g &quot;</span>,<a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#ab355488fd99663f08df3aa24d8a8eec4">interpolated_p_axi_nst</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>));</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160; </div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;   <span class="comment">//outfile &lt;&lt; std::endl;   </span></div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;   fprintf(file_pt,<span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;  }</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160; <span class="comment">//outfile &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160; fprintf(file_pt,<span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160; </div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160; <span class="comment">// Write tecplot footer (e.g. FE connectivity lists)</span></div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160; <a class="code" href="classoomph_1_1FiniteElement.html#ac3987a5ead7dc20c63d86b333466e2b5">write_tecplot_zone_footer</a>(file_pt,nplot);</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160; </div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;}</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160; </div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160; </div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160; </div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160; </div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;<span class="comment">//==============================================================</span><span class="comment"></span></div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;<span class="comment">/// Return integral of dissipation over element</span></div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;<span class="comment"></span><span class="comment">//==============================================================</span></div>
<div class="line"><a name="l00582"></a><span class="lineno"><a class="line" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a002f84742337fbf2dcba83866b1d089e">  582</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a002f84742337fbf2dcba83866b1d089e">AxisymmetricNavierStokesEquations::dissipation</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;<span class="keyword"></span>{  </div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160; <span class="keywordflow">throw</span> <a class="code" href="classoomph_1_1OomphLibError.html">OomphLibError</a>(</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;  <span class="stringliteral">&quot;Check the dissipation calculation for axisymmetric NSt&quot;</span>,</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;  OOMPH_CURRENT_FUNCTION,</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;  OOMPH_EXCEPTION_LOCATION);</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160; </div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160; <span class="comment">// Initialise</span></div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160; <span class="keywordtype">double</span> diss=0.0;</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160; </div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160; <span class="comment">//Set the value of Nintpt</span></div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160; <span class="keywordtype">unsigned</span> Nintpt = <a class="code" href="classoomph_1_1FiniteElement.html#a79f1710873332823c47023d370f0596b">integral_pt</a>()-&gt;<a class="code" href="classoomph_1_1Integral.html#a1a270de9d99a1fcf1d25a6c1017f65fa">nweight</a>();</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160; </div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160; <span class="comment">//Set the Vector to hold local coordinates</span></div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160; <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>(2);</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160; </div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160; <span class="comment">//Loop over the integration points</span></div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160; <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> ipt=0;ipt&lt;Nintpt;ipt++)</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;  {</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;   </div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;   <span class="comment">//Assign values of s</span></div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;2;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;    {</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;     <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] = <a class="code" href="classoomph_1_1FiniteElement.html#a79f1710873332823c47023d370f0596b">integral_pt</a>()-&gt;<a class="code" href="classoomph_1_1Integral.html#a1a2122f99a87c18649bafdd9ed739758">knot</a>(ipt,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>);</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;    }</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;   </div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;   <span class="comment">//Get the integral weight</span></div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;   <span class="keywordtype">double</span> w = <a class="code" href="classoomph_1_1FiniteElement.html#a79f1710873332823c47023d370f0596b">integral_pt</a>()-&gt;<a class="code" href="classoomph_1_1Integral.html#ac65335e2aab120b285b3d6c294507b06">weight</a>(ipt);</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;   </div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;   <span class="comment">// Get Jacobian of mapping</span></div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;   <span class="keywordtype">double</span> J = <a class="code" href="classoomph_1_1FiniteElement.html#a089e58d5ad9b8efee637221b0e264563">J_eulerian</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>);</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;   </div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;   <span class="comment">// Get strain rate matrix</span></div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;   <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> strainrate(3,3);</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;   <a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#ad12929a11d71f7d91627f3edc8f2cdce">strain_rate</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,strainrate);</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160; </div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;   <span class="comment">// Initialise</span></div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;   <span class="keywordtype">double</span> local_diss=0.0;</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;3;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++) </div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;    {</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> j=0;j&lt;3;j++) </div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;      {    </div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;       local_diss+=2.0*strainrate(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>,j)*strainrate(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>,j);</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;      }</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;    }</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;   </div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;   diss+=local_diss*w*J;</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;  }</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160; </div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160; <span class="keywordflow">return</span> diss;</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160; </div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;}</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160; </div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;<span class="comment">//==============================================================</span><span class="comment"></span></div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;<span class="comment">/// \short Compute traction (on the viscous scale) at local</span></div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;<span class="comment">/// coordinate s for outer unit normal N</span></div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;<span class="comment"></span><span class="comment">//==============================================================</span></div>
<div class="line"><a name="l00639"></a><span class="lineno"><a class="line" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a0a5523b91d5191c2f9e23fe8d74f4e07">  639</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a0a5523b91d5191c2f9e23fe8d74f4e07">AxisymmetricNavierStokesEquations::traction</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;                                                 <span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; <a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7dabc60bec4cc294aa2adf92726c6d6823a">N</a>, </div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;                                                 <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; traction)<span class="keyword"></span></div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;<span class="keyword"> const </span></div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160; <span class="comment">//throw OomphLibError(</span></div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160; <span class="comment">// &quot;Check the traction calculation for axisymmetric NSt&quot;,</span></div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160; <span class="comment">// OOMPH_CURRENT_FUNCTION,</span></div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160; <span class="comment">// OOMPH_EXCEPTION_LOCATION);</span></div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160; </div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160; <span class="comment">// Pad out normal vector if required</span></div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160; <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> n_local(3,0.0);</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160; n_local[0]=<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7dabc60bec4cc294aa2adf92726c6d6823a">N</a>[0];</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160; n_local[1]=<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7dabc60bec4cc294aa2adf92726c6d6823a">N</a>[1];</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160; </div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160; <span class="keywordflow">if</span> ((<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7dabc60bec4cc294aa2adf92726c6d6823a">N</a>.size()==3)&amp;&amp;(<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7dabc60bec4cc294aa2adf92726c6d6823a">N</a>[2]!=0.0))</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;  {</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;   <span class="keywordflow">throw</span> <a class="code" href="classoomph_1_1OomphLibError.html">OomphLibError</a>(</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;    <span class="stringliteral">&quot;Unit normal passed into this fct should either be 2D (r,z) or have a zero component in the theta-direction&quot;</span>,</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;    OOMPH_CURRENT_FUNCTION,</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;    OOMPH_EXCEPTION_LOCATION);</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;  }</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160; </div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160; <span class="comment">// Get velocity gradients</span></div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160; <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> strainrate(3,3);</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160; <a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#ad12929a11d71f7d91627f3edc8f2cdce">strain_rate</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,strainrate);</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160; </div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160; <span class="comment">// Get pressure</span></div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160; <span class="keywordtype">double</span> <a class="code" href="the__data__structure_8txt.html#a15043ffc2013f4797ce93c4d1cc7a9ba">press</a>=<a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#ab355488fd99663f08df3aa24d8a8eec4">interpolated_p_axi_nst</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>);</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160; </div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160; <span class="comment">// Loop over traction components</span></div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160; <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;3;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;  {</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;   <a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a0a5523b91d5191c2f9e23fe8d74f4e07">traction</a>[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]=-<a class="code" href="the__data__structure_8txt.html#a15043ffc2013f4797ce93c4d1cc7a9ba">press</a>*n_local[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>];</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j=0;j&lt;3;j++)</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;    {</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;     <a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a0a5523b91d5191c2f9e23fe8d74f4e07">traction</a>[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]+=2.0*strainrate(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>,j)*n_local[j];</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;    }</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;  }</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;}</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160; </div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;<span class="comment">//==============================================================</span><span class="comment"></span></div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;<span class="comment">/// Return dissipation at local coordinate s</span></div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;<span class="comment"></span><span class="comment">//==============================================================</span></div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;<span class="keywordtype">double</span> <a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a002f84742337fbf2dcba83866b1d089e">AxisymmetricNavierStokesEquations::</a></div>
<div class="line"><a name="l00686"></a><span class="lineno"><a class="line" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a17b8b46a8ebbb5d75486077c960d5844">  686</a></span>&#160;<a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a002f84742337fbf2dcba83866b1d089e">dissipation</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>)<span class="keyword"> const</span></div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;<span class="keyword"></span>{  </div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160; <span class="keywordflow">throw</span> <a class="code" href="classoomph_1_1OomphLibError.html">OomphLibError</a>(</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;  <span class="stringliteral">&quot;Check the dissipation calculation for axisymmetric NSt&quot;</span>,</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;OOMPH_CURRENT_FUNCTION,</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;  OOMPH_EXCEPTION_LOCATION);</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160; </div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160; <span class="comment">// Get strain rate matrix</span></div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160; <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> strainrate(3,3);</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160; <a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#ad12929a11d71f7d91627f3edc8f2cdce">strain_rate</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,strainrate);</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160; </div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160; <span class="comment">// Initialise</span></div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160; <span class="keywordtype">double</span> local_diss=0.0;</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160; <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;3;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++) </div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;  {</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> j=0;j&lt;3;j++) </div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;    {    </div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;     local_diss+=2.0*strainrate(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>,j)*strainrate(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>,j);</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;    }</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;  }</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160; </div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160; <span class="keywordflow">return</span> local_diss;</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;}</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160; </div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;<span class="comment">//==============================================================</span><span class="comment"></span></div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;<span class="comment">/// Get strain-rate tensor: \f$ e_{ij} \f$  where </span></div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;<span class="comment">/// \f$ i,j = r,z,\theta \f$ (in that order)</span></div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;<span class="comment"></span><span class="comment">//==============================================================</span></div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#ad12929a11d71f7d91627f3edc8f2cdce">AxisymmetricNavierStokesEquations::</a></div>
<div class="line"><a name="l00715"></a><span class="lineno"><a class="line" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#ad12929a11d71f7d91627f3edc8f2cdce">  715</a></span>&#160;<a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#ad12929a11d71f7d91627f3edc8f2cdce">strain_rate</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>, <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a>&amp; strainrate)<span class="keyword"> const</span></div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160; </div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160; <span class="keywordflow">if</span> ((strainrate.<a class="code" href="classoomph_1_1DenseMatrix.html#a9937181f1cb4cfaed7aaf3b483c42456">ncol</a>()!=3)||(strainrate.<a class="code" href="classoomph_1_1DenseMatrix.html#a1b425094510d833ffe91920747a0a962">nrow</a>()!=3))</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;  {</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;   std::ostringstream error_message;</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;   error_message  &lt;&lt; <span class="stringliteral">&quot;The strain rate has incorrect dimensions &quot;</span> </div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;                  &lt;&lt; strainrate.<a class="code" href="classoomph_1_1DenseMatrix.html#a9937181f1cb4cfaed7aaf3b483c42456">ncol</a>() &lt;&lt; <span class="stringliteral">&quot; x &quot;</span> </div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;                  &lt;&lt; strainrate.<a class="code" href="classoomph_1_1DenseMatrix.html#a1b425094510d833ffe91920747a0a962">nrow</a>() &lt;&lt; <span class="stringliteral">&quot; Not 3&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;   </div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;   <span class="keywordflow">throw</span> <a class="code" href="classoomph_1_1OomphLibError.html">OomphLibError</a>(error_message.str(),</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;OOMPH_CURRENT_FUNCTION,</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;                         OOMPH_EXCEPTION_LOCATION);</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;  }</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160; </div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160; <span class="comment">//Find out how many nodes there are in the element</span></div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160; <span class="keywordtype">unsigned</span> n_node = <a class="code" href="classoomph_1_1FiniteElement.html#a6219ed269a6d89b5aa14659cce48905a">nnode</a>();</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160; </div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160; <span class="comment">//Set up memory for the shape and test functions</span></div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160; <a class="code" href="classoomph_1_1Shape.html">Shape</a> psi(n_node);</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160; <a class="code" href="classoomph_1_1DShape.html">DShape</a> dpsidx(n_node,2);</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160; </div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160; <span class="comment">//Call the derivatives of the shape functions</span></div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160; <a class="code" href="classoomph_1_1FiniteElement.html#a9296c17b134688049256a4bbc886df69">dshape_eulerian</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,psi,dpsidx);</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160; </div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160; <span class="comment">// Radius</span></div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160; <span class="keywordtype">double</span> interpolated_r = 0.0;</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160; </div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160; <span class="comment">// Velocity components and their derivatives</span></div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160; <span class="keywordtype">double</span> ur=0.0;</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160; <span class="keywordtype">double</span> durdr=0.0;</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160; <span class="keywordtype">double</span> durdz=0.0;</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160; <span class="keywordtype">double</span> uz=0.0;</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160; <span class="keywordtype">double</span> duzdr=0.0;</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160; <span class="keywordtype">double</span> duzdz=0.0;</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160; <span class="keywordtype">double</span> uphi=0.0;</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160; <span class="keywordtype">double</span> duphidr=0.0;</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160; <span class="keywordtype">double</span> duphidz=0.0;</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160; </div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160; <span class="comment">//Get the local storage for the indices</span></div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160; <span class="keywordtype">unsigned</span> u_nodal_index[3];</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160; <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;3;++<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>) {u_nodal_index[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] = <a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#afbdea50fcf4799e2e4e5209ee3249bf0">u_index_axi_nst</a>(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>);}</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160; </div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160; <span class="comment">// Loop over nodes to assemble velocities and their derivatives</span></div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160; <span class="comment">// w.r.t. to r and z (x_0 and x_1)</span></div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160; <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l=0;l&lt;n_node;l++) </div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;  {   </div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;   interpolated_r += <a class="code" href="classoomph_1_1FiniteElement.html#a9152c16ae9899168bcdaac7c2f977444">nodal_position</a>(l,0)*psi[l];</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160; </div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;   ur += <a class="code" href="classoomph_1_1FiniteElement.html#a28fd5c2d4aeba5ef65bee0e0d72569f5">nodal_value</a>(l,u_nodal_index[0])*psi[l];</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;   uz += <a class="code" href="classoomph_1_1FiniteElement.html#a28fd5c2d4aeba5ef65bee0e0d72569f5">nodal_value</a>(l,u_nodal_index[1])*psi[l];</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;   uphi += <a class="code" href="classoomph_1_1FiniteElement.html#a28fd5c2d4aeba5ef65bee0e0d72569f5">nodal_value</a>(l,u_nodal_index[2])*psi[l];</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160; </div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;   durdr += <a class="code" href="classoomph_1_1FiniteElement.html#a28fd5c2d4aeba5ef65bee0e0d72569f5">nodal_value</a>(l,u_nodal_index[0])*dpsidx(l,0);</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;   durdz += <a class="code" href="classoomph_1_1FiniteElement.html#a28fd5c2d4aeba5ef65bee0e0d72569f5">nodal_value</a>(l,u_nodal_index[0])*dpsidx(l,1);</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160; </div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;   duzdr += <a class="code" href="classoomph_1_1FiniteElement.html#a28fd5c2d4aeba5ef65bee0e0d72569f5">nodal_value</a>(l,u_nodal_index[1])*dpsidx(l,0);</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;   duzdz += <a class="code" href="classoomph_1_1FiniteElement.html#a28fd5c2d4aeba5ef65bee0e0d72569f5">nodal_value</a>(l,u_nodal_index[1])*dpsidx(l,1);</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160; </div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;   duphidr += <a class="code" href="classoomph_1_1FiniteElement.html#a28fd5c2d4aeba5ef65bee0e0d72569f5">nodal_value</a>(l,u_nodal_index[2])*dpsidx(l,0);</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;   duphidz += <a class="code" href="classoomph_1_1FiniteElement.html#a28fd5c2d4aeba5ef65bee0e0d72569f5">nodal_value</a>(l,u_nodal_index[2])*dpsidx(l,1);</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;  }</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160; </div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160; </div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160; <span class="comment">// Assign strain rates without negative powers of the radius</span></div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160; <span class="comment">// and zero those with:</span></div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160; strainrate(0,0)=durdr;</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160; strainrate(0,1)=0.5*(durdz+duzdr);</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160; strainrate(1,0)=strainrate(0,1);</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160; strainrate(0,2)=0.0;</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160; strainrate(2,0)=strainrate(0,2);</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160; strainrate(1,1)=duzdz;</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160; strainrate(1,2)=0.5*duphidz;</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160; strainrate(2,1)=strainrate(1,2);</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160; strainrate(2,2)=0.0;</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160; </div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160; </div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160; <span class="comment">// Overwrite the strain rates with negative powers of the radius</span></div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160; <span class="comment">// unless we&#39;re at the origin</span></div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160; <span class="keywordflow">if</span> (std::fabs(interpolated_r)&gt;1.0<a class="code" href="cfortran_8h.html#a37cd013acc76697829c324bdd8562d82">e</a>-16)</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;  {</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;   <span class="keywordtype">double</span> inverse_radius=1.0/interpolated_r;</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;   strainrate(0,2)=0.5*(duphidr-inverse_radius*uphi);</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;   strainrate(2,0)=strainrate(0,2);</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;   strainrate(2,2)=inverse_radius*ur;</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;  }</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160; </div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160; </div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;}</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160; </div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160; </div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;<span class="comment">//==============================================================</span><span class="comment"></span></div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;<span class="comment">///  \short Get integral of kinetic energy over element:</span></div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;<span class="comment"></span><span class="comment">//==============================================================</span></div>
<div class="line"><a name="l00811"></a><span class="lineno"><a class="line" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a823b3494f75b435cf8d0fbe5572937a8">  811</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a823b3494f75b435cf8d0fbe5572937a8">AxisymmetricNavierStokesEquations::kin_energy</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;<span class="keyword"></span>{  </div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160; </div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160; <span class="keywordflow">throw</span> <a class="code" href="classoomph_1_1OomphLibError.html">OomphLibError</a>(</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;  <span class="stringliteral">&quot;Check the kinetic energy calculation for axisymmetric NSt&quot;</span>,</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;OOMPH_CURRENT_FUNCTION,</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;  OOMPH_EXCEPTION_LOCATION);</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160; </div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160; <span class="comment">// Initialise</span></div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160; <span class="keywordtype">double</span> kin_en=0.0;</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160; </div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160; <span class="comment">//Set the value of Nintpt</span></div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160; <span class="keywordtype">unsigned</span> Nintpt = <a class="code" href="classoomph_1_1FiniteElement.html#a79f1710873332823c47023d370f0596b">integral_pt</a>()-&gt;<a class="code" href="classoomph_1_1Integral.html#a1a270de9d99a1fcf1d25a6c1017f65fa">nweight</a>();</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160; </div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160; <span class="comment">//Set the Vector to hold local coordinates</span></div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160; <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>(2);</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160; </div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160; <span class="comment">//Loop over the integration points</span></div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160; <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> ipt=0;ipt&lt;Nintpt;ipt++)</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;  {   </div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;   <span class="comment">//Assign values of s</span></div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;2;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++) {<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] = <a class="code" href="classoomph_1_1FiniteElement.html#a79f1710873332823c47023d370f0596b">integral_pt</a>()-&gt;<a class="code" href="classoomph_1_1Integral.html#a1a2122f99a87c18649bafdd9ed739758">knot</a>(ipt,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>);}</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;   </div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;   <span class="comment">//Get the integral weight</span></div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;   <span class="keywordtype">double</span> w = <a class="code" href="classoomph_1_1FiniteElement.html#a79f1710873332823c47023d370f0596b">integral_pt</a>()-&gt;<a class="code" href="classoomph_1_1Integral.html#ac65335e2aab120b285b3d6c294507b06">weight</a>(ipt);</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;   </div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;   <span class="comment">//Get Jacobian of mapping</span></div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;   <span class="keywordtype">double</span> J = <a class="code" href="classoomph_1_1FiniteElement.html#a089e58d5ad9b8efee637221b0e264563">J_eulerian</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>);</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;   </div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;   <span class="comment">// Loop over directions</span></div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;   <span class="keywordtype">double</span> veloc_squared=0.0;</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;3;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++) </div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;    {</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;     veloc_squared+=<a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a6be05bce8f257044e1bb6929aa5e791e">interpolated_u_axi_nst</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>)*<a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a6be05bce8f257044e1bb6929aa5e791e">interpolated_u_axi_nst</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>);</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;    }</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;   </div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;   kin_en+=0.5*veloc_squared*w*J*<a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,0);</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;  }</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160; </div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160; <span class="keywordflow">return</span> kin_en;</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160; </div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;}</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160; </div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;<span class="comment">//==============================================================</span><span class="comment"></span></div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;<span class="comment">/// Return pressure integrated over the element</span></div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;<span class="comment"></span><span class="comment">//==============================================================</span></div>
<div class="line"><a name="l00857"></a><span class="lineno"><a class="line" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a056e6c406e93a62763a0ac8912ce9e1b">  857</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a056e6c406e93a62763a0ac8912ce9e1b">AxisymmetricNavierStokesEquations::pressure_integral</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160; </div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160; <span class="comment">// Initialise </span></div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160; <span class="keywordtype">double</span> press_int=0;</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160; </div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160; <span class="comment">//Set the value of Nintpt</span></div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160; <span class="keywordtype">unsigned</span> Nintpt = <a class="code" href="classoomph_1_1FiniteElement.html#a79f1710873332823c47023d370f0596b">integral_pt</a>()-&gt;<a class="code" href="classoomph_1_1Integral.html#a1a270de9d99a1fcf1d25a6c1017f65fa">nweight</a>();</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160; </div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160; <span class="comment">//Set the Vector to hold local coordinates</span></div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160; <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>(2);</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160; </div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160; <span class="comment">//Loop over the integration points</span></div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160; <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> ipt=0;ipt&lt;Nintpt;ipt++)</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;  {</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;   </div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;   <span class="comment">//Assign values of s</span></div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;2;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;    {</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;     <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] = <a class="code" href="classoomph_1_1FiniteElement.html#a79f1710873332823c47023d370f0596b">integral_pt</a>()-&gt;<a class="code" href="classoomph_1_1Integral.html#a1a2122f99a87c18649bafdd9ed739758">knot</a>(ipt,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>);</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;    }</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;   </div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;   <span class="comment">//Get the integral weight</span></div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;   <span class="keywordtype">double</span> w = <a class="code" href="classoomph_1_1FiniteElement.html#a79f1710873332823c47023d370f0596b">integral_pt</a>()-&gt;<a class="code" href="classoomph_1_1Integral.html#ac65335e2aab120b285b3d6c294507b06">weight</a>(ipt);</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;   </div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;   <span class="comment">//Get Jacobian of mapping</span></div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;   <span class="keywordtype">double</span> J = <a class="code" href="classoomph_1_1FiniteElement.html#a089e58d5ad9b8efee637221b0e264563">J_eulerian</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>);</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;   </div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;   <span class="comment">//Premultiply the weights and the Jacobian</span></div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;   <span class="keywordtype">double</span> <a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a> = w*J*<a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,0);</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;   </div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;   <span class="comment">// Get pressure</span></div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;   <span class="keywordtype">double</span> <a class="code" href="the__data__structure_8txt.html#a15043ffc2013f4797ce93c4d1cc7a9ba">press</a>=<a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#ab355488fd99663f08df3aa24d8a8eec4">interpolated_p_axi_nst</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>);</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;   </div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;   <span class="comment">// Add</span></div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;   press_int+=<a class="code" href="the__data__structure_8txt.html#a15043ffc2013f4797ce93c4d1cc7a9ba">press</a>*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;   </div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;  }</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160; </div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160; <span class="keywordflow">return</span> press_int;</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160; </div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;}</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160; </div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;<span class="comment">//==============================================================</span><span class="comment"></span></div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;<span class="comment">///  Compute the residuals for the Navier--Stokes </span></div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;<span class="comment">///  equations; flag=1(or 0): do (or don&#39;t) compute the </span></div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;<span class="comment">///  Jacobian as well. </span></div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;<span class="comment"></span><span class="comment">//==============================================================</span></div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a9a19729ca5b08abca8e8202614e70b29">AxisymmetricNavierStokesEquations::</a></div>
<div class="line"><a name="l00906"></a><span class="lineno"><a class="line" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a9a19729ca5b08abca8e8202614e70b29">  906</a></span>&#160;<a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a9a19729ca5b08abca8e8202614e70b29">fill_in_generic_residual_contribution_axi_nst</a>(<a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;<a class="code" href="the__data__structure_8txt.html#a1400a973def57b85051cfe1070be1810">residuals</a>, </div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;                                              <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> &amp;jacobian, </div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;                                              <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> &amp;mass_matrix,</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;                                              <span class="keywordtype">unsigned</span> flag)</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;{</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160; <span class="comment">//Find out how many nodes there are</span></div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160; <span class="keywordtype">unsigned</span> n_node = <a class="code" href="classoomph_1_1FiniteElement.html#a6219ed269a6d89b5aa14659cce48905a">nnode</a>();</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160; </div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160; <span class="comment">// Get continuous time from timestepper of first node</span></div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160; <span class="keywordtype">double</span> time=<a class="code" href="classoomph_1_1FiniteElement.html#ace0e7fb72a805b5c2c600347bfae7a9b">node_pt</a>(0)-&gt;<a class="code" href="classoomph_1_1Data.html#a5b34970d16205921dca3ada720da8445">time_stepper_pt</a>()-&gt;<a class="code" href="classoomph_1_1TimeStepper.html#ad77678873af47aa208a9385b26ac1641">time_pt</a>()-&gt;<a class="code" href="classoomph_1_1Time.html#a6e28ea7a6664a2f5f5e1be871304a2c7">time</a>();</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;  </div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160; <span class="comment">//Find out how many pressure dofs there are</span></div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160; <span class="keywordtype">unsigned</span> n_pres = <a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a89edaffb4913131cc14a5f6e45ed117a">npres_axi_nst</a>();</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160; </div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160; <span class="comment">//Get the nodal indices at which the velocity is stored</span></div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160; <span class="keywordtype">unsigned</span> u_nodal_index[3];</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160; <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;3;++<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>) {u_nodal_index[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] = <a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#afbdea50fcf4799e2e4e5209ee3249bf0">u_index_axi_nst</a>(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>);}</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160; </div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160; <span class="comment">//Set up memory for the shape and test functions</span></div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160; <span class="comment">//Note that there are only two dimensions, r and z in this problem</span></div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160; <a class="code" href="classoomph_1_1Shape.html">Shape</a> psif(n_node), testf(n_node);</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160; <a class="code" href="classoomph_1_1DShape.html">DShape</a> dpsifdx(n_node,2), dtestfdx(n_node,2);</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;   </div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160; <span class="comment">//Set up memory for pressure shape and test functions</span></div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160; <a class="code" href="classoomph_1_1Shape.html">Shape</a> psip(n_pres), testp(n_pres);</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160; </div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160; <span class="comment">//Number of integration points</span></div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160; <span class="keywordtype">unsigned</span> Nintpt = <a class="code" href="classoomph_1_1FiniteElement.html#a79f1710873332823c47023d370f0596b">integral_pt</a>()-&gt;<a class="code" href="classoomph_1_1Integral.html#a1a270de9d99a1fcf1d25a6c1017f65fa">nweight</a>();</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;   </div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160; <span class="comment">//Set the Vector to hold local coordinates (two dimensions)</span></div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160; <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>(2);</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160; </div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160; <span class="comment">//Get Physical Variables from Element</span></div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160; <span class="comment">//Reynolds number must be multiplied by the density ratio</span></div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160; <span class="keywordtype">double</span> scaled_re = <a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a5326eb9f37e9ca42103ea7c72622a415">re</a>()*<a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a26df65fe19563b703fe274179e829900">density_ratio</a>();</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160; <span class="keywordtype">double</span> scaled_re_st = <a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#aa951cf371f58231f3c0967255843a50a">re_st</a>()*<a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a26df65fe19563b703fe274179e829900">density_ratio</a>();</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160; <span class="keywordtype">double</span> scaled_re_inv_fr = <a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#aab647203e95cec99d25d42cee76a5e38">re_invfr</a>()*<a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a26df65fe19563b703fe274179e829900">density_ratio</a>();</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160; <span class="keywordtype">double</span> scaled_re_inv_ro = <a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a30e9502122f5c88cdfb33edb45d88c5f">re_invro</a>()*<a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a26df65fe19563b703fe274179e829900">density_ratio</a>();</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160; <span class="comment">// double visc_ratio = viscosity_ratio();</span></div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160; <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> G = <a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a518c31629e6ef42334cd031e2901efea">g</a>();</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160; </div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160; <span class="comment">//Integers used to store the local equation and unknown numbers</span></div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160; <span class="keywordtype">int</span> local_eqn=0, local_unknown=0;</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160; </div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160; <span class="comment">//Loop over the integration points</span></div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160; <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> ipt=0;ipt&lt;Nintpt;ipt++)</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;  {</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;   <span class="comment">//Assign values of s</span></div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;2;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++) <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] = <a class="code" href="classoomph_1_1FiniteElement.html#a79f1710873332823c47023d370f0596b">integral_pt</a>()-&gt;<a class="code" href="classoomph_1_1Integral.html#a1a2122f99a87c18649bafdd9ed739758">knot</a>(ipt,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>);</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;   <span class="comment">//Get the integral weight</span></div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;   <span class="keywordtype">double</span> w = <a class="code" href="classoomph_1_1FiniteElement.html#a79f1710873332823c47023d370f0596b">integral_pt</a>()-&gt;<a class="code" href="classoomph_1_1Integral.html#ac65335e2aab120b285b3d6c294507b06">weight</a>(ipt);</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;   </div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;   <span class="comment">//Call the derivatives of the shape and test functions</span></div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;   <span class="keywordtype">double</span> J = </div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;    <a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a76e090fdac4507d10eb9f81feb53a51b">dshape_and_dtest_eulerian_at_knot_axi_nst</a>(ipt,psif,dpsifdx,testf,dtestfdx);</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;   </div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;   <span class="comment">//Call the pressure shape and test functions</span></div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;   <a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a6309780fd1964c4df0cca0818ccff158">pshape_axi_nst</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,psip,testp);</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;   </div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;   <span class="comment">//Premultiply the weights and the Jacobian</span></div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;   <span class="keywordtype">double</span> <a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a> = w*J;</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160; </div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;   <span class="comment">//Allocate storage for the position and the derivative of the </span></div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;   <span class="comment">//mesh positions wrt time</span></div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;   <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> <a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>(2,0.0);</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;   <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> mesh_velocity(2,0.0);</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;   <span class="comment">//Allocate storage for the pressure, velocity components and their</span></div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;   <span class="comment">//time and spatial derivatives</span></div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;   <span class="keywordtype">double</span> interpolated_p=0.0;</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;   <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> <a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>(3,0.0);</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;   <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> dudt(3,0.0);</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;   <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> interpolated_dudx(3,2,0.0);</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;   </div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;   <span class="comment">//Calculate pressure at integration point</span></div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l=0;l&lt;n_pres;l++) {interpolated_p += <a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a3aa173227f477a40fb4adba84a337f5b">p_axi_nst</a>(l)*psip[l];}</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;   </div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;   <span class="comment">//Calculate velocities and derivatives at integration point</span></div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160; </div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;   <span class="comment">// Loop over nodes</span></div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l=0;l&lt;n_node;l++) </div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;    {</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;     <span class="comment">//Cache the shape function</span></div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;     <span class="keyword">const</span> <span class="keywordtype">double</span> psif_ = psif(l);</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;     <span class="comment">//Loop over the two coordinate directions</span></div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;2;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;      {</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;       <a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] += this-&gt;<a class="code" href="classoomph_1_1FiniteElement.html#abe831900a6d6a08ee4a43fd9c07af32e">raw_nodal_position</a>(l,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>)*psif_;</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;      }</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;       <span class="comment">//mesh_velocity[i]  += dnodal_position_dt(l,i)*psif[l];</span></div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160; </div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;     <span class="comment">//Loop over the three velocity directions</span></div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;3;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;      {</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;       <span class="comment">//Get the u_value</span></div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;       <span class="keyword">const</span> <span class="keywordtype">double</span> u_value = this-&gt;<a class="code" href="classoomph_1_1FiniteElement.html#abdc430bef622e0257397407416e6aac8">raw_nodal_value</a>(l,u_nodal_index[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]);</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;       <a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] += u_value*psif_;</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;       dudt[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]+= <a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a80b3415e150243f8fff3f8eb87082b24">du_dt_axi_nst</a>(l,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>)*psif_;</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;       <span class="comment">//Loop over derivative directions</span></div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;       <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> j=0;j&lt;2;j++)</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;        {interpolated_dudx(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>,j) += u_value*dpsifdx(l,j);}</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;      }</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;    }</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160; </div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;   <span class="comment">//Get the mesh velocity if ALE is enabled</span></div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;   <span class="keywordflow">if</span>(!<a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a97f46e5472537187107d0454b6013b5f">ALE_is_disabled</a>)</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;    {</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;     <span class="comment">// Loop over nodes</span></div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l=0;l&lt;n_node;l++) </div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;      {</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;       <span class="comment">//Loop over the two coordinate directions</span></div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;       <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;2;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;        {</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;         mesh_velocity[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]  += this-&gt;<a class="code" href="classoomph_1_1FiniteElement.html#aaaa11f3783ab48d882ac1858d74adba4">raw_dnodal_position_dt</a>(l,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>)*psif(l);</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;        }</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;      }</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;    }</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;       </div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;   </div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;   <span class="comment">//Get the user-defined body force terms</span></div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;   <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> body_force(3);</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;   <a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#adf10fc1309b9aeb92dc11be274ae65a2">get_body_force_axi_nst</a>(time,ipt,<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,<a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>,body_force);</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;   </div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;   <span class="comment">//Get the user-defined source function</span></div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;   <span class="keywordtype">double</span> source = <a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a7b965ac308b3a398a9365d76aa21a65f">get_source_fct</a>(time,ipt,<a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>);</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160; </div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;   <span class="comment">//Get the user-defined viscosity function</span></div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;   <span class="keywordtype">double</span> visc_ratio; </div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;   <a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a6b75b0e3184053cbf32458df944ec330">get_viscosity_ratio_axisym_nst</a>(ipt,</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;                                  <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>, </div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;                                  <a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>,</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;                                  visc_ratio);</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160; </div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;   <span class="comment">//r is the first position component</span></div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;   <span class="keywordtype">double</span> r = <a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>[0];</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160; </div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;   <span class="comment">//MOMENTUM EQUATIONS</span></div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;   <span class="comment">//------------------</span></div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;   </div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;   <span class="comment">//Loop over the test functions</span></div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l=0;l&lt;n_node;l++)</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;    {</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;     <span class="comment">//FIRST (RADIAL) MOMENTUM EQUATION</span></div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;     local_eqn = <a class="code" href="classoomph_1_1FiniteElement.html#a5da80bbed97543e586f698251d67941d">nodal_local_eqn</a>(l,u_nodal_index[0]);</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;     <span class="comment">//If it&#39;s not a boundary condition</span></div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;     <span class="keywordflow">if</span>(local_eqn &gt;= 0)</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;      {</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;       <span class="comment">//Add the user-defined body force terms</span></div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;       <a class="code" href="the__data__structure_8txt.html#a1400a973def57b85051cfe1070be1810">residuals</a>[local_eqn] += </div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;        r*body_force[0]*testf[l]*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160; </div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;       <span class="comment">//Add the gravitational body force term</span></div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;       <a class="code" href="the__data__structure_8txt.html#a1400a973def57b85051cfe1070be1810">residuals</a>[local_eqn] += r*scaled_re_inv_fr*testf[l]*G[0]*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;       </div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;       <span class="comment">//Add the pressure gradient term</span></div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;       <a class="code" href="the__data__structure_8txt.html#a1400a973def57b85051cfe1070be1810">residuals</a>[local_eqn]  += </div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;        interpolated_p*(testf[l] + r*dtestfdx(l,0))*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;       </div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;       <span class="comment">//Add in the stress tensor terms</span></div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;       <span class="comment">//The viscosity ratio needs to go in here to ensure</span></div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;       <span class="comment">//continuity of normal stress is satisfied even in flows</span></div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;       <span class="comment">//with zero pressure gradient!</span></div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;       <a class="code" href="the__data__structure_8txt.html#a1400a973def57b85051cfe1070be1810">residuals</a>[local_eqn] -= visc_ratio*</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;        r*(1.0+<a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#aff943b6b83128398a0320cae90c6b94c">Gamma</a>[0])*interpolated_dudx(0,0)*dtestfdx(l,0)*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;       </div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;       <a class="code" href="the__data__structure_8txt.html#a1400a973def57b85051cfe1070be1810">residuals</a>[local_eqn] -= visc_ratio*r*</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;        (interpolated_dudx(0,1) + <a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#aff943b6b83128398a0320cae90c6b94c">Gamma</a>[0]*interpolated_dudx(1,0))*</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;        dtestfdx(l,1)*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160; </div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;       <a class="code" href="the__data__structure_8txt.html#a1400a973def57b85051cfe1070be1810">residuals</a>[local_eqn] -= </div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;        visc_ratio*(1.0 + <a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#aff943b6b83128398a0320cae90c6b94c">Gamma</a>[0])*<a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>[0]*testf[l]*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>/r;</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;       </div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;       <span class="comment">//Add in the inertial terms</span></div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;       <span class="comment">//du/dt term</span></div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;       <a class="code" href="the__data__structure_8txt.html#a1400a973def57b85051cfe1070be1810">residuals</a>[local_eqn] -= scaled_re_st*r*dudt[0]*testf[l]*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160; </div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;       <span class="comment">//Convective terms</span></div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;       <a class="code" href="the__data__structure_8txt.html#a1400a973def57b85051cfe1070be1810">residuals</a>[local_eqn] -= </div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;        scaled_re*(r*<a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>[0]*interpolated_dudx(0,0) </div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;            - <a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>[2]*<a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>[2] </div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;            + r*<a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>[1]*interpolated_dudx(0,1))*testf[l]*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160; </div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;       <span class="comment">//Mesh velocity terms</span></div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;       <span class="keywordflow">if</span>(!<a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a97f46e5472537187107d0454b6013b5f">ALE_is_disabled</a>)</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;        {</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;         <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> k=0;k&lt;2;k++)</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;          {</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;           <a class="code" href="the__data__structure_8txt.html#a1400a973def57b85051cfe1070be1810">residuals</a>[local_eqn] += </div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;            scaled_re_st*r*mesh_velocity[k]*interpolated_dudx(0,k)*testf[l]*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;          }</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;        }</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160; </div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;       <span class="comment">//Add the Coriolis term</span></div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;       <a class="code" href="the__data__structure_8txt.html#a1400a973def57b85051cfe1070be1810">residuals</a>[local_eqn] += </div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;        2.0*r*scaled_re_inv_ro*<a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>[2]*testf[l]*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160; </div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;       <span class="comment">//CALCULATE THE JACOBIAN</span></div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;       <span class="keywordflow">if</span>(flag)</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;        {</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;         <span class="comment">//Loop over the velocity shape functions again</span></div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;         <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l2=0;l2&lt;n_node;l2++)</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;          { </div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;           local_unknown = <a class="code" href="classoomph_1_1FiniteElement.html#a5da80bbed97543e586f698251d67941d">nodal_local_eqn</a>(l2,u_nodal_index[0]);</div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;           <span class="comment">//Radial velocity component</span></div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;           <span class="keywordflow">if</span>(local_unknown &gt;= 0)</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;            {</div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;             <span class="keywordflow">if</span>(flag==2)</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;              {</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;               <span class="comment">//Add the mass matrix</span></div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;               mass_matrix(local_eqn,local_unknown) +=</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;                scaled_re_st*r*psif[l2]*testf[l]*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;              }</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160; </div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;             <span class="comment">//Add contribution to the Jacobian matrix</span></div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;             jacobian(local_eqn,local_unknown)</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;              -= visc_ratio*r*(1.0+<a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#aff943b6b83128398a0320cae90c6b94c">Gamma</a>[0])</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;              *dpsifdx(l2,0)*dtestfdx(l,0)*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160; </div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;             jacobian(local_eqn,local_unknown)</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;              -= visc_ratio*r*dpsifdx(l2,1)*dtestfdx(l,1)*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;       </div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;             jacobian(local_eqn,local_unknown)</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;              -= visc_ratio*(1.0 + <a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#aff943b6b83128398a0320cae90c6b94c">Gamma</a>[0])*psif[l2]*testf[l]*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>/r;</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;       </div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;             <span class="comment">//Add in the inertial terms</span></div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;             <span class="comment">//du/dt term</span></div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;             jacobian(local_eqn,local_unknown) </div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;              -= scaled_re_st*r*<a class="code" href="classoomph_1_1FiniteElement.html#ace0e7fb72a805b5c2c600347bfae7a9b">node_pt</a>(l2)-&gt;<a class="code" href="classoomph_1_1Data.html#a5b34970d16205921dca3ada720da8445">time_stepper_pt</a>()-&gt;<a class="code" href="classoomph_1_1TimeStepper.html#a4cb0aecb044b77ba0553cdd54b586d8a">weight</a>(1,0)*</div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;              psif[l2]*testf[l]*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160; </div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;             <span class="comment">//Convective terms</span></div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;             jacobian(local_eqn,local_unknown) -=</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;              scaled_re*(r*psif[l2]*interpolated_dudx(0,0) </div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;                  + r*<a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>[0]*dpsifdx(l2,0)</div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;                  + r*<a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>[1]*dpsifdx(l2,1))*testf[l]*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160; </div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;             <span class="comment">//Mesh velocity terms</span></div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;             <span class="keywordflow">if</span>(!<a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a97f46e5472537187107d0454b6013b5f">ALE_is_disabled</a>)</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;              {</div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;               <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> k=0;k&lt;2;k++)</div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;                {</div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;                 jacobian(local_eqn,local_unknown) += </div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;                  scaled_re_st*r*mesh_velocity[k]*dpsifdx(l2,k)*testf[l]*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;                }</div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;              }</div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;            }</div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160; </div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160; </div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;           <span class="comment">//Axial velocity component</span></div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;           local_unknown = <a class="code" href="classoomph_1_1FiniteElement.html#a5da80bbed97543e586f698251d67941d">nodal_local_eqn</a>(l2,u_nodal_index[1]);</div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;           <span class="keywordflow">if</span>(local_unknown &gt;= 0)</div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;            {</div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;             jacobian(local_eqn,local_unknown) -=</div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;              visc_ratio*r*<a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#aff943b6b83128398a0320cae90c6b94c">Gamma</a>[0]*dpsifdx(l2,0)*dtestfdx(l,1)*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;             </div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;             <span class="comment">//Convective terms</span></div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;             jacobian(local_eqn,local_unknown) -= </div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;              scaled_re*r*psif[l2]*interpolated_dudx(0,1)*testf[l]*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;            }</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160; </div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;           <span class="comment">//Azimuthal velocity component</span></div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;           local_unknown = <a class="code" href="classoomph_1_1FiniteElement.html#a5da80bbed97543e586f698251d67941d">nodal_local_eqn</a>(l2,u_nodal_index[2]);</div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;           <span class="keywordflow">if</span>(local_unknown &gt;= 0)</div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;            {</div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;             <span class="comment">//Convective terms</span></div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;             jacobian(local_eqn,local_unknown) -= </div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;              - scaled_re*2.0*<a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>[2]*psif[l2]*testf[l]*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160; </div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;             <span class="comment">//Coriolis terms</span></div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;             jacobian(local_eqn,local_unknown) +=</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;              2.0*r*scaled_re_inv_ro*psif[l2]*testf[l]*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;            }</div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;          }</div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;         </div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;         <span class="comment">/*Now loop over pressure shape functions*/</span></div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;         <span class="comment">/*This is the contribution from pressure gradient*/</span></div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;         <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l2=0;l2&lt;n_pres;l2++)</div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;          {</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;           local_unknown = <a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#ad6ac62ca5fa411c365fd2ecc72aa25e8">p_local_eqn</a>(l2);</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;           <span class="comment">/*If we are at a non-zero degree of freedom in the entry*/</span></div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;           <span class="keywordflow">if</span>(local_unknown &gt;= 0)</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;            {</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;             jacobian(local_eqn,local_unknown)</div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;              += psip[l2]*(testf[l] + r*dtestfdx(l,0))*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;            }</div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;          }</div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;        } <span class="comment">/*End of Jacobian calculation*/</span></div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;       </div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;      } <span class="comment">//End of if not boundary condition statement</span></div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160; </div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;     <span class="comment">//SECOND (AXIAL) MOMENTUM EQUATION</span></div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;     local_eqn = <a class="code" href="classoomph_1_1FiniteElement.html#a5da80bbed97543e586f698251d67941d">nodal_local_eqn</a>(l,u_nodal_index[1]);</div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;     <span class="comment">//If it&#39;s not a boundary condition</span></div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;     <span class="keywordflow">if</span>(local_eqn &gt;= 0)</div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;      {</div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;       <span class="comment">//Add the user-defined body force terms</span></div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;       <span class="comment">//Remember to multiply by the density ratio!</span></div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;       <a class="code" href="the__data__structure_8txt.html#a1400a973def57b85051cfe1070be1810">residuals</a>[local_eqn] += </div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;        r*body_force[1]*testf[l]*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;       </div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;       <span class="comment">//Add the gravitational body force term</span></div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;       <a class="code" href="the__data__structure_8txt.html#a1400a973def57b85051cfe1070be1810">residuals</a>[local_eqn] += r*scaled_re_inv_fr*testf[l]*G[1]*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160; </div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;       <span class="comment">//Add the pressure gradient term</span></div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;       <a class="code" href="the__data__structure_8txt.html#a1400a973def57b85051cfe1070be1810">residuals</a>[local_eqn]  += r*interpolated_p*dtestfdx(l,1)*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;       </div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;       <span class="comment">//Add in the stress tensor terms</span></div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;       <span class="comment">//The viscosity ratio needs to go in here to ensure</span></div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;       <span class="comment">//continuity of normal stress is satisfied even in flows</span></div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;       <span class="comment">//with zero pressure gradient!</span></div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;       <a class="code" href="the__data__structure_8txt.html#a1400a973def57b85051cfe1070be1810">residuals</a>[local_eqn] -= visc_ratio*</div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;        r*(interpolated_dudx(1,0) + <a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#aff943b6b83128398a0320cae90c6b94c">Gamma</a>[1]*interpolated_dudx(0,1))</div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;        *dtestfdx(l,0)*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;       </div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;       <a class="code" href="the__data__structure_8txt.html#a1400a973def57b85051cfe1070be1810">residuals</a>[local_eqn] -= visc_ratio*r*</div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;        (1.0 + <a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#aff943b6b83128398a0320cae90c6b94c">Gamma</a>[1])*interpolated_dudx(1,1)*dtestfdx(l,1)*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;       </div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;       <span class="comment">//Add in the inertial terms</span></div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;       <span class="comment">//du/dt term</span></div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;       <a class="code" href="the__data__structure_8txt.html#a1400a973def57b85051cfe1070be1810">residuals</a>[local_eqn] -= scaled_re_st*r*dudt[1]*testf[l]*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160; </div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;       <span class="comment">//Convective terms</span></div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;       <a class="code" href="the__data__structure_8txt.html#a1400a973def57b85051cfe1070be1810">residuals</a>[local_eqn] -= </div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;        scaled_re*(r*<a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>[0]*interpolated_dudx(1,0) </div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;            + r*<a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>[1]*interpolated_dudx(1,1))*testf[l]*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160; </div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;       <span class="comment">//Mesh velocity terms</span></div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;       <span class="keywordflow">if</span>(!<a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a97f46e5472537187107d0454b6013b5f">ALE_is_disabled</a>)</div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;        {</div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;         <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> k=0;k&lt;2;k++)</div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;          {</div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;           <a class="code" href="the__data__structure_8txt.html#a1400a973def57b85051cfe1070be1810">residuals</a>[local_eqn] += </div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;            scaled_re_st*r*mesh_velocity[k]*interpolated_dudx(1,k)*testf[l]*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;          }</div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;        }</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;       </div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;       <span class="comment">//CALCULATE THE JACOBIAN</span></div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;       <span class="keywordflow">if</span>(flag)</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;        {</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;         <span class="comment">//Loop over the velocity shape functions again</span></div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;         <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l2=0;l2&lt;n_node;l2++)</div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;          { </div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;           local_unknown = <a class="code" href="classoomph_1_1FiniteElement.html#a5da80bbed97543e586f698251d67941d">nodal_local_eqn</a>(l2,u_nodal_index[0]);</div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;           <span class="comment">//Radial velocity component</span></div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;           <span class="keywordflow">if</span>(local_unknown &gt;= 0)</div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;            {</div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;             <span class="comment">//Add in the stress tensor terms</span></div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;             <span class="comment">//The viscosity ratio needs to go in here to ensure</span></div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;             <span class="comment">//continuity of normal stress is satisfied even in flows</span></div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;             <span class="comment">//with zero pressure gradient!</span></div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;             jacobian(local_eqn,local_unknown) -= </div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;              visc_ratio*r*<a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#aff943b6b83128398a0320cae90c6b94c">Gamma</a>[1]*dpsifdx(l2,1)*dtestfdx(l,0)*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;       </div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;             <span class="comment">//Convective terms</span></div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;             jacobian(local_eqn,local_unknown) -= </div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;              scaled_re*r*psif[l2]*interpolated_dudx(1,0)*testf[l]*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;            }</div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160; </div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;           <span class="comment">//Axial velocity component</span></div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;           local_unknown = <a class="code" href="classoomph_1_1FiniteElement.html#a5da80bbed97543e586f698251d67941d">nodal_local_eqn</a>(l2,u_nodal_index[1]);</div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;           <span class="keywordflow">if</span>(local_unknown &gt;= 0)</div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;            {</div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;             <span class="keywordflow">if</span>(flag==2)</div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;              {</div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;               <span class="comment">//Add the mass matrix</span></div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;               mass_matrix(local_eqn,local_unknown) +=</div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;                scaled_re_st*r*psif[l2]*testf[l]*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;              }</div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160; </div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160; </div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;             <span class="comment">//Add in the stress tensor terms</span></div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;             <span class="comment">//The viscosity ratio needs to go in here to ensure</span></div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;             <span class="comment">//continuity of normal stress is satisfied even in flows</span></div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;             <span class="comment">//with zero pressure gradient!</span></div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;             jacobian(local_eqn,local_unknown) -= </div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;              visc_ratio*r*dpsifdx(l2,0)*dtestfdx(l,0)*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;       </div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;             jacobian(local_eqn,local_unknown) -= </div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;              visc_ratio*r*(1.0 + <a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#aff943b6b83128398a0320cae90c6b94c">Gamma</a>[1])*dpsifdx(l2,1)*</div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;              dtestfdx(l,1)*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;       </div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;             <span class="comment">//Add in the inertial terms</span></div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;             <span class="comment">//du/dt term</span></div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;             jacobian(local_eqn,local_unknown) -= </div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;              scaled_re_st*r*<a class="code" href="classoomph_1_1FiniteElement.html#ace0e7fb72a805b5c2c600347bfae7a9b">node_pt</a>(l2)-&gt;<a class="code" href="classoomph_1_1Data.html#a5b34970d16205921dca3ada720da8445">time_stepper_pt</a>()-&gt;<a class="code" href="classoomph_1_1TimeStepper.html#a4cb0aecb044b77ba0553cdd54b586d8a">weight</a>(1,0)*</div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;              psif[l2]*testf[l]*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160; </div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;             <span class="comment">//Convective terms</span></div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;             jacobian(local_eqn,local_unknown) -= </div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;              scaled_re*(r*<a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>[0]*dpsifdx(l2,0) </div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;                  + r*psif[l2]*interpolated_dudx(1,1)</div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;                  + r*<a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>[1]*dpsifdx(l2,1))*testf[l]*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;       </div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;             </div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;             <span class="comment">//Mesh velocity terms</span></div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;             <span class="keywordflow">if</span>(!<a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a97f46e5472537187107d0454b6013b5f">ALE_is_disabled</a>)</div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;              {</div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;               <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> k=0;k&lt;2;k++)</div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;                {</div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;                 jacobian(local_eqn,local_unknown) += </div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;                  scaled_re_st*r*mesh_velocity[k]*dpsifdx(l2,k)*testf[l]*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;                }</div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;              }</div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;            }</div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160; </div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;           <span class="comment">//There are no azimithal terms in the axial momentum equation</span></div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;          } <span class="comment">//End of loop over velocity shape functions</span></div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;       </div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;         <span class="comment">/*Now loop over pressure shape functions*/</span></div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;         <span class="comment">/*This is the contribution from pressure gradient*/</span></div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;         <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l2=0;l2&lt;n_pres;l2++)</div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;          {</div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;           local_unknown = <a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#ad6ac62ca5fa411c365fd2ecc72aa25e8">p_local_eqn</a>(l2);</div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;           <span class="comment">/*If we are at a non-zero degree of freedom in the entry*/</span></div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;           <span class="keywordflow">if</span>(local_unknown &gt;= 0)</div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;              {</div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;               jacobian(local_eqn,local_unknown)</div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;                += r*psip[l2]*dtestfdx(l,1)*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;              }</div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;          }</div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;        } <span class="comment">/*End of Jacobian calculation*/</span></div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;       </div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;      } <span class="comment">//End of AXIAL MOMENTUM EQUATION</span></div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160; </div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;     <span class="comment">//THIRD (AZIMUTHAL) MOMENTUM EQUATION</span></div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;     local_eqn = <a class="code" href="classoomph_1_1FiniteElement.html#a5da80bbed97543e586f698251d67941d">nodal_local_eqn</a>(l,u_nodal_index[2]);</div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;     <span class="keywordflow">if</span>(local_eqn &gt;= 0)</div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;      {</div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;       <span class="comment">//Add the user-defined body force terms</span></div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;       <span class="comment">//Remember to multiply by the density ratio!</span></div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;       <a class="code" href="the__data__structure_8txt.html#a1400a973def57b85051cfe1070be1810">residuals</a>[local_eqn] += </div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;        r*body_force[2]*testf[l]*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;       </div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;       <span class="comment">//Add the gravitational body force term</span></div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;       <a class="code" href="the__data__structure_8txt.html#a1400a973def57b85051cfe1070be1810">residuals</a>[local_eqn] += r*scaled_re_inv_fr*testf[l]*G[2]*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;       </div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;       <span class="comment">//There is NO pressure gradient term</span></div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;       </div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;       <span class="comment">//Add in the stress tensor terms</span></div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;       <span class="comment">//The viscosity ratio needs to go in here to ensure</span></div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;       <span class="comment">//continuity of normal stress is satisfied even in flows</span></div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;       <span class="comment">//with zero pressure gradient!</span></div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;       <a class="code" href="the__data__structure_8txt.html#a1400a973def57b85051cfe1070be1810">residuals</a>[local_eqn] -= visc_ratio*</div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;        (r*interpolated_dudx(2,0) - </div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;         <a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#aff943b6b83128398a0320cae90c6b94c">Gamma</a>[0]*<a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>[2])*dtestfdx(l,0)*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;       </div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;       <a class="code" href="the__data__structure_8txt.html#a1400a973def57b85051cfe1070be1810">residuals</a>[local_eqn] -= visc_ratio*r*</div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;        interpolated_dudx(2,1)*dtestfdx(l,1)*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160; </div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;       <a class="code" href="the__data__structure_8txt.html#a1400a973def57b85051cfe1070be1810">residuals</a>[local_eqn] -= visc_ratio*</div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;        ((<a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>[2]/r) - <a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#aff943b6b83128398a0320cae90c6b94c">Gamma</a>[0]*interpolated_dudx(2,0))*testf[l]*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160; </div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160; </div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;       <span class="comment">//Add in the inertial terms</span></div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;       <span class="comment">//du/dt term</span></div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;       <a class="code" href="the__data__structure_8txt.html#a1400a973def57b85051cfe1070be1810">residuals</a>[local_eqn] -= scaled_re_st*r*dudt[2]*testf[l]*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160; </div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;       <span class="comment">//Convective terms</span></div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;       <a class="code" href="the__data__structure_8txt.html#a1400a973def57b85051cfe1070be1810">residuals</a>[local_eqn] -= </div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;        scaled_re*(r*<a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>[0]*interpolated_dudx(2,0)</div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;            + <a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>[0]*<a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>[2]</div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;            + r*<a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>[1]*interpolated_dudx(2,1))*testf[l]*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;       </div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;       <span class="comment">//Mesh velocity terms</span></div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;       <span class="keywordflow">if</span>(!<a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a97f46e5472537187107d0454b6013b5f">ALE_is_disabled</a>)</div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;        {</div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;         <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> k=0;k&lt;2;k++)</div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;          {</div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;           <a class="code" href="the__data__structure_8txt.html#a1400a973def57b85051cfe1070be1810">residuals</a>[local_eqn] += </div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;            scaled_re_st*r*mesh_velocity[k]*interpolated_dudx(2,k)*testf[l]*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;          }</div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;        }</div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160; </div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;       <span class="comment">//Add the Coriolis term</span></div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;       <a class="code" href="the__data__structure_8txt.html#a1400a973def57b85051cfe1070be1810">residuals</a>[local_eqn] -= </div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;        2.0*r*scaled_re_inv_ro*<a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>[0]*testf[l]*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;       </div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;       <span class="comment">//CALCULATE THE JACOBIAN</span></div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;       <span class="keywordflow">if</span>(flag)</div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;        {</div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;         <span class="comment">//Loop over the velocity shape functions again</span></div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;         <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l2=0;l2&lt;n_node;l2++)</div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;          { </div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;           <span class="comment">//Radial velocity component</span></div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;           local_unknown = <a class="code" href="classoomph_1_1FiniteElement.html#a5da80bbed97543e586f698251d67941d">nodal_local_eqn</a>(l2,u_nodal_index[0]);</div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;           <span class="keywordflow">if</span>(local_unknown &gt;= 0)</div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;            {</div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;             <span class="comment">//Convective terms</span></div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;             jacobian(local_eqn,local_unknown) -= </div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;              scaled_re*(r*psif[l2]*interpolated_dudx(2,0)</div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;                  + psif[l2]*<a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>[2])*testf[l]*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160; </div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;             <span class="comment">//Coriolis term</span></div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;             jacobian(local_eqn,local_unknown) -=</div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;              2.0*r*scaled_re_inv_ro*psif[l2]*testf[l]*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;            }</div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160; </div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;           <span class="comment">//Axial velocity component</span></div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;           local_unknown = <a class="code" href="classoomph_1_1FiniteElement.html#a5da80bbed97543e586f698251d67941d">nodal_local_eqn</a>(l2,u_nodal_index[1]);</div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;           <span class="keywordflow">if</span>(local_unknown &gt;= 0)</div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;            {</div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;             <span class="comment">//Convective terms</span></div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;             jacobian(local_eqn,local_unknown) -= </div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;              scaled_re*r*psif[l2]*interpolated_dudx(2,1)*testf[l]*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;            }</div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160; </div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;           <span class="comment">//Azimuthal velocity component</span></div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;           local_unknown = <a class="code" href="classoomph_1_1FiniteElement.html#a5da80bbed97543e586f698251d67941d">nodal_local_eqn</a>(l2,u_nodal_index[2]);</div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;           <span class="keywordflow">if</span>(local_unknown &gt;= 0)</div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;            {</div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;             <span class="keywordflow">if</span>(flag==2)</div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;              {</div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;               <span class="comment">//Add the mass matrix</span></div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;               mass_matrix(local_eqn,local_unknown) +=</div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;                scaled_re_st*r*psif[l2]*testf[l]*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;              }</div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160; </div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;             <span class="comment">//Add in the stress tensor terms</span></div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;             <span class="comment">//The viscosity ratio needs to go in here to ensure</span></div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;             <span class="comment">//continuity of normal stress is satisfied even in flows</span></div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;             <span class="comment">//with zero pressure gradient!</span></div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;             jacobian(local_eqn,local_unknown) -= </div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;              visc_ratio*(r*dpsifdx(l2,0) - </div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;                               <a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#aff943b6b83128398a0320cae90c6b94c">Gamma</a>[0]*psif[l2])*dtestfdx(l,0)*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;       </div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;             jacobian(local_eqn,local_unknown) -= </div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;              visc_ratio*r*dpsifdx(l2,1)*dtestfdx(l,1)*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160; </div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;             jacobian(local_eqn,local_unknown) -= </div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;              visc_ratio*((psif[l2]/r) - <a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#aff943b6b83128398a0320cae90c6b94c">Gamma</a>[0]*dpsifdx(l2,0))</div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;              *testf[l]*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;             </div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;             <span class="comment">//Add in the inertial terms</span></div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;             <span class="comment">//du/dt term</span></div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;             jacobian(local_eqn,local_unknown) -= </div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;              scaled_re_st*r*<a class="code" href="classoomph_1_1FiniteElement.html#ace0e7fb72a805b5c2c600347bfae7a9b">node_pt</a>(l2)-&gt;<a class="code" href="classoomph_1_1Data.html#a5b34970d16205921dca3ada720da8445">time_stepper_pt</a>()-&gt;<a class="code" href="classoomph_1_1TimeStepper.html#a4cb0aecb044b77ba0553cdd54b586d8a">weight</a>(1,0)*</div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;              psif[l2]*testf[l]*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160; </div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;             <span class="comment">//Convective terms</span></div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;             jacobian(local_eqn,local_unknown) -= </div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;              scaled_re*(r*<a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>[0]*dpsifdx(l2,0)</div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;                  + <a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>[0]*psif[l2]</div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;                  + r*<a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>[1]*dpsifdx(l2,1))*testf[l]*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;             </div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;             <span class="comment">//Mesh velocity terms</span></div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;             <span class="keywordflow">if</span>(!<a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a97f46e5472537187107d0454b6013b5f">ALE_is_disabled</a>)</div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;              {</div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;               <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> k=0;k&lt;2;k++)</div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;                {</div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;                 jacobian(local_eqn,local_unknown) += </div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;                  scaled_re_st*r*mesh_velocity[k]*dpsifdx(l2,k)*testf[l]*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;                }</div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;              }</div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;            }</div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;          }</div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160; </div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;         <span class="comment">//There are no pressure terms</span></div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;        } <span class="comment">//End of Jacobian</span></div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160; </div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;      } <span class="comment">//End of AZIMUTHAL EQUATION</span></div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160; </div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;    } <span class="comment">//End of loop over shape functions</span></div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;      </div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;   </div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;   <span class="comment">//CONTINUITY EQUATION</span></div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;   <span class="comment">//-------------------</span></div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;   </div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;   <span class="comment">//Loop over the shape functions</span></div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l=0;l&lt;n_pres;l++)</div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;    {</div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;     local_eqn = <a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#ad6ac62ca5fa411c365fd2ecc72aa25e8">p_local_eqn</a>(l);</div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;     <span class="comment">//If not a boundary conditions</span></div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;     <span class="keywordflow">if</span>(local_eqn &gt;= 0)</div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;      {</div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;       <span class="comment">// Source term</span></div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;       <a class="code" href="the__data__structure_8txt.html#a1400a973def57b85051cfe1070be1810">residuals</a>[local_eqn] -= r*source*testp[l]*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160; </div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;       <span class="comment">//Gradient terms</span></div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;       <a class="code" href="the__data__structure_8txt.html#a1400a973def57b85051cfe1070be1810">residuals</a>[local_eqn] += </div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;        (<a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>[0] + r*interpolated_dudx(0,0) </div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;         + r*interpolated_dudx(1,1))*testp[l]*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160; </div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;       <span class="comment">/*CALCULATE THE JACOBIAN*/</span></div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;       <span class="keywordflow">if</span>(flag)</div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;        {</div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;         <span class="comment">/*Loop over the velocity shape functions*/</span></div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;         <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l2=0;l2&lt;n_node;l2++)</div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;          { </div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;           <span class="comment">//Radial velocity component</span></div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;           local_unknown = <a class="code" href="classoomph_1_1FiniteElement.html#a5da80bbed97543e586f698251d67941d">nodal_local_eqn</a>(l2,u_nodal_index[0]);</div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;           <span class="keywordflow">if</span>(local_unknown &gt;= 0)</div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;            {</div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;             jacobian(local_eqn,local_unknown) +=</div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;              (psif[l2] + r*dpsifdx(l2,0))*testp[l]*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;           </div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;            }</div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160; </div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;           <span class="comment">//Axial velocity component</span></div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;           local_unknown = <a class="code" href="classoomph_1_1FiniteElement.html#a5da80bbed97543e586f698251d67941d">nodal_local_eqn</a>(l2,u_nodal_index[1]);</div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;           <span class="keywordflow">if</span>(local_unknown &gt;= 0)</div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;            {</div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;             jacobian(local_eqn,local_unknown) +=</div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;              r*dpsifdx(l2,1)*testp[l]*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;            }</div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;          } <span class="comment">/*End of loop over l2*/</span></div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;        } <span class="comment">/*End of Jacobian calculation*/</span></div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;       </div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;      } <span class="comment">//End of if not boundary condition</span></div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160; </div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;    } <span class="comment">//End of loop over l</span></div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;  }</div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160; </div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;}</div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160; </div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160; </div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160; </div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;<span class="comment">//======================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;<span class="comment">/// Compute derivatives of elemental residual vector with respect</span></div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;<span class="comment">/// to nodal coordinates. </span></div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;<span class="comment">/// dresidual_dnodal_coordinates(l,i,j) = d res(l) / dX_{ij}</span></div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;<span class="comment">/// Overloads the FD-based version in the FiniteElement base class.</span></div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;<span class="comment"></span><span class="comment">//======================================================================</span></div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#aea99b11bfac734a5c868aaafffadd820">AxisymmetricNavierStokesEquations::</a></div>
<div class="line"><a name="l01528"></a><span class="lineno"><a class="line" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#aea99b11bfac734a5c868aaafffadd820"> 1528</a></span>&#160;<a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#aea99b11bfac734a5c868aaafffadd820">get_dresidual_dnodal_coordinates</a>(</div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160; <a class="code" href="classoomph_1_1RankThreeTensor.html">RankThreeTensor&lt;double&gt;</a>&amp; dresidual_dnodal_coordinates)</div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;{</div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160; <span class="comment">// Return immediately if there are no dofs</span></div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160; <span class="keywordflow">if</span>(<a class="code" href="classoomph_1_1GeneralisedElement.html#a37204f67b37d212fd170c68d48f6da57">ndof</a>()==0) { <span class="keywordflow">return</span>; }</div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160; </div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160; <span class="comment">// Get continuous time from timestepper of first node</span></div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160; <span class="keywordtype">double</span> time=<a class="code" href="classoomph_1_1FiniteElement.html#ace0e7fb72a805b5c2c600347bfae7a9b">node_pt</a>(0)-&gt;<a class="code" href="classoomph_1_1Data.html#a5b34970d16205921dca3ada720da8445">time_stepper_pt</a>()-&gt;<a class="code" href="classoomph_1_1TimeStepper.html#ad77678873af47aa208a9385b26ac1641">time_pt</a>()-&gt;<a class="code" href="classoomph_1_1Time.html#a6e28ea7a6664a2f5f5e1be871304a2c7">time</a>();</div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;  </div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160; <span class="comment">// Determine number of nodes in element</span></div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160; <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_node = <a class="code" href="classoomph_1_1FiniteElement.html#a6219ed269a6d89b5aa14659cce48905a">nnode</a>();</div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160; </div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160; <span class="comment">// Determine number of pressure dofs in element</span></div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160; <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_pres = <a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a89edaffb4913131cc14a5f6e45ed117a">npres_axi_nst</a>();</div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160; </div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160; <span class="comment">// Find the indices at which the local velocities are stored</span></div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160; <span class="keywordtype">unsigned</span> u_nodal_index[3];</div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160; <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;3;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++) { u_nodal_index[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] = <a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#afbdea50fcf4799e2e4e5209ee3249bf0">u_index_axi_nst</a>(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>); }</div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160; </div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160; <span class="comment">// Set up memory for the shape and test functions</span></div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160; <span class="comment">// Note that there are only two dimensions, r and z, in this problem</span></div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160; <a class="code" href="classoomph_1_1Shape.html">Shape</a> psif(n_node), testf(n_node);</div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160; <a class="code" href="classoomph_1_1DShape.html">DShape</a> dpsifdx(n_node,2), dtestfdx(n_node,2);</div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160; </div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160; <span class="comment">// Set up memory for pressure shape and test functions</span></div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160; <a class="code" href="classoomph_1_1Shape.html">Shape</a> psip(n_pres), testp(n_pres);</div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160; </div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160; <span class="comment">// Deriatives of shape fct derivatives w.r.t. nodal coords</span></div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160; <a class="code" href="classoomph_1_1RankFourTensor.html">RankFourTensor&lt;double&gt;</a> d_dpsifdx_dX(2,n_node,n_node,2);</div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160; <a class="code" href="classoomph_1_1RankFourTensor.html">RankFourTensor&lt;double&gt;</a> d_dtestfdx_dX(2,n_node,n_node,2);</div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160; </div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160; <span class="comment">// Derivative of Jacobian of mapping w.r.t. to nodal coords</span></div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160; <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> dJ_dX(2,n_node);</div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160; </div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160; <span class="comment">// Derivatives of derivative of u w.r.t. nodal coords</span></div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160; <span class="comment">// Note that the entry d_dudx_dX(p,q,i,k) contains the derivative w.r.t.</span></div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160; <span class="comment">// nodal coordinate X_pq of du_i/dx_k. Since there are three velocity</span></div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160; <span class="comment">// components, i can take on the values 0, 1 and 2, while k and p only</span></div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160; <span class="comment">// take on the values 0 and 1 since there are only two spatial dimensions.</span></div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160; <a class="code" href="classoomph_1_1RankFourTensor.html">RankFourTensor&lt;double&gt;</a> d_dudx_dX(2,n_node,3,2);</div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160; </div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160; <span class="comment">// Derivatives of nodal velocities w.r.t. nodal coords:</span></div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160; <span class="comment">// Assumption: Interaction only local via no-slip so </span></div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160; <span class="comment">// X_pq only affects U_iq.</span></div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160; <span class="comment">// Note that the entry d_U_dX(p,q,i) contains the derivative w.r.t. nodal</span></div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160; <span class="comment">// coordinate X_pq of nodal value U_iq. In other words this entry is the</span></div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160; <span class="comment">// derivative of the i-th velocity component w.r.t. the p-th spatial</span></div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160; <span class="comment">// coordinate, taken at the q-th local node.</span></div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160; <a class="code" href="classoomph_1_1RankThreeTensor.html">RankThreeTensor&lt;double&gt;</a> d_U_dX(2,n_node,3,0.0);</div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160; </div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160; <span class="comment">// Determine the number of integration points</span></div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160; <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_intpt = <a class="code" href="classoomph_1_1FiniteElement.html#a79f1710873332823c47023d370f0596b">integral_pt</a>()-&gt;<a class="code" href="classoomph_1_1Integral.html#a1a270de9d99a1fcf1d25a6c1017f65fa">nweight</a>();</div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;   </div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160; <span class="comment">// Vector to hold local coordinates (two dimensions)</span></div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160; <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>(2);</div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160; </div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160; <span class="comment">// Get physical variables from element</span></div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160; <span class="comment">// (Reynolds number must be multiplied by the density ratio)</span></div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160; <span class="keyword">const</span> <span class="keywordtype">double</span> scaled_re = <a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a5326eb9f37e9ca42103ea7c72622a415">re</a>()*<a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a26df65fe19563b703fe274179e829900">density_ratio</a>();</div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160; <span class="keyword">const</span> <span class="keywordtype">double</span> scaled_re_st = <a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#aa951cf371f58231f3c0967255843a50a">re_st</a>()*<a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a26df65fe19563b703fe274179e829900">density_ratio</a>();</div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160; <span class="keyword">const</span> <span class="keywordtype">double</span> scaled_re_inv_fr = <a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#aab647203e95cec99d25d42cee76a5e38">re_invfr</a>()*<a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a26df65fe19563b703fe274179e829900">density_ratio</a>();</div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160; <span class="keyword">const</span> <span class="keywordtype">double</span> scaled_re_inv_ro = <a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a30e9502122f5c88cdfb33edb45d88c5f">re_invro</a>()*<a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a26df65fe19563b703fe274179e829900">density_ratio</a>();</div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160; <span class="keyword">const</span> <span class="keywordtype">double</span> visc_ratio = <a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a4cf2dc737978f76fc7e0ad6358414f88">viscosity_ratio</a>();</div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160; <span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> G = <a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a518c31629e6ef42334cd031e2901efea">g</a>();</div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160; </div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160; <span class="comment">// FD step </span></div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160; <span class="keywordtype">double</span> eps_fd = <a class="code" href="classoomph_1_1GeneralisedElement.html#a156163c9f6fbd17548a9fa836616d19b">GeneralisedElement::Default_fd_jacobian_step</a>;</div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;   </div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160; <span class="comment">// Pre-compute derivatives of nodal velocities w.r.t. nodal coords:</span></div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160; <span class="comment">// Assumption: Interaction only local via no-slip so </span></div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160; <span class="comment">// X_ij only affects U_ij.</span></div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160; <span class="keywordtype">bool</span> element_has_node_with_aux_node_update_fct=<span class="keyword">false</span>;</div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160; <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> q=0;q&lt;n_node;q++)</div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;  {</div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;   <span class="comment">// Get pointer to q-th local node</span></div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;   <a class="code" href="classoomph_1_1Node.html">Node</a>* nod_pt = <a class="code" href="classoomph_1_1FiniteElement.html#ace0e7fb72a805b5c2c600347bfae7a9b">node_pt</a>(q);</div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160; </div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;   <span class="comment">// Only compute if there&#39;s a node-update fct involved</span></div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;   <span class="keywordflow">if</span>(nod_pt-&gt;<a class="code" href="classoomph_1_1Node.html#ad5fe8ac9dcb705612903bc6945926375">has_auxiliary_node_update_fct_pt</a>())</div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;    {</div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;     element_has_node_with_aux_node_update_fct=<span class="keyword">true</span>;</div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160; </div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;     <span class="comment">// This functionality has not been tested so issue a warning</span></div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;     <span class="comment">// to this effect</span></div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;     std::ostringstream warning_stream;</div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;     warning_stream &lt;&lt; <span class="stringliteral">&quot;\nThe functionality to evaluate the additional&quot;</span></div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot;\ncontribution to the deriv of the residual eqn&quot;</span></div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot;\nw.r.t. the nodal coordinates which comes about&quot;</span></div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot;\nif a node&#39;s values are updated using an auxiliary&quot;</span></div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot;\nnode update function has NOT been tested for&quot;</span></div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot;\naxisymmetric Navier-Stokes elements. Use at your&quot;</span></div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot;\nown risk&quot;</span></div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;                    &lt;&lt; std::endl;</div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;     <a class="code" href="classoomph_1_1OomphLibWarning.html">OomphLibWarning</a>(</div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;      warning_stream.str(),</div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;      <span class="stringliteral">&quot;AxisymmetricNavierStokesEquations::get_dresidual_dnodal_coordinates&quot;</span>,</div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;      OOMPH_EXCEPTION_LOCATION);</div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160; </div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;     <span class="comment">// Current nodal velocity</span></div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;     <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> u_ref(3);</div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;3;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;      {</div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;       u_ref[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]=*(nod_pt-&gt;<a class="code" href="classoomph_1_1Data.html#a559dc196abee87cad34d655c8d6dac1e">value_pt</a>(u_nodal_index[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]));</div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;      }</div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;     </div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;     <span class="comment">// FD</span></div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> p=0;p&lt;2;p++)</div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;      {</div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;       <span class="comment">// Make backup</span></div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;       <span class="keywordtype">double</span> backup=nod_pt-&gt;<a class="code" href="classoomph_1_1Node.html#a056f8e82da938369cd38541c5cdc598a">x</a>(p);</div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;       </div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;       <span class="comment">// Do FD step. No node update required as we&#39;re</span></div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;       <span class="comment">// attacking the coordinate directly...</span></div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;       nod_pt-&gt;<a class="code" href="classoomph_1_1Node.html#a056f8e82da938369cd38541c5cdc598a">x</a>(p) += eps_fd;</div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;       </div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;       <span class="comment">// Do auxiliary node update (to apply no slip)</span></div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;       nod_pt-&gt;<a class="code" href="classoomph_1_1Node.html#a6c287aa85c19f2d37ed7952ece5c76dd">perform_auxiliary_node_update_fct</a>();</div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;       </div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;       <span class="comment">// Loop over velocity components</span></div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;       <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;3;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;        {</div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;         <span class="comment">// Evaluate</span></div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;         d_U_dX(p,q,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>)=(*(nod_pt-&gt;<a class="code" href="classoomph_1_1Data.html#a559dc196abee87cad34d655c8d6dac1e">value_pt</a>(u_nodal_index[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]))-u_ref[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>])/eps_fd;</div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;        }</div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;       </div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;       <span class="comment">// Reset </span></div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;       nod_pt-&gt;<a class="code" href="classoomph_1_1Node.html#a056f8e82da938369cd38541c5cdc598a">x</a>(p)=backup;</div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;       </div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;       <span class="comment">// Do auxiliary node update (to apply no slip)</span></div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;       nod_pt-&gt;<a class="code" href="classoomph_1_1Node.html#a6c287aa85c19f2d37ed7952ece5c76dd">perform_auxiliary_node_update_fct</a>();</div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;      }</div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;    }</div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;  }</div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160; </div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160; <span class="comment">// Integer to store the local equation number</span></div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160; <span class="keywordtype">int</span> local_eqn=0;</div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160; </div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160; <span class="comment">// Loop over the integration points</span></div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160; <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> ipt=0;ipt&lt;n_intpt;ipt++)</div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;  {</div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;   <span class="comment">// Assign values of s</span></div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;2;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++) { <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] = <a class="code" href="classoomph_1_1FiniteElement.html#a79f1710873332823c47023d370f0596b">integral_pt</a>()-&gt;<a class="code" href="classoomph_1_1Integral.html#a1a2122f99a87c18649bafdd9ed739758">knot</a>(ipt,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>); }</div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160; </div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;   <span class="comment">// Get the integral weight</span></div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">double</span> w = <a class="code" href="classoomph_1_1FiniteElement.html#a79f1710873332823c47023d370f0596b">integral_pt</a>()-&gt;<a class="code" href="classoomph_1_1Integral.html#ac65335e2aab120b285b3d6c294507b06">weight</a>(ipt);</div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;   </div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;   <span class="comment">// Call the derivatives of the shape and test functions</span></div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">double</span> J = <a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a76e090fdac4507d10eb9f81feb53a51b">dshape_and_dtest_eulerian_at_knot_axi_nst</a>(</div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;    ipt,psif,dpsifdx,d_dpsifdx_dX,testf,dtestfdx,d_dtestfdx_dX,dJ_dX);</div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;   </div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;   <span class="comment">// Call the pressure shape and test functions</span></div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;   <a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a6309780fd1964c4df0cca0818ccff158">pshape_axi_nst</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,psip,testp);</div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;   </div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;   <span class="comment">// Allocate storage for the position and the derivative of the </span></div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;   <span class="comment">// mesh positions w.r.t. time</span></div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;   <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> <a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>(2,0.0);</div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;   <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> mesh_velocity(2,0.0);</div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160; </div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;   <span class="comment">// Allocate storage for the pressure, velocity components and their</span></div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;   <span class="comment">// time and spatial derivatives</span></div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;   <span class="keywordtype">double</span> interpolated_p=0.0;</div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;   <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> <a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>(3,0.0);</div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;   <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> dudt(3,0.0);</div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;   <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> interpolated_dudx(3,2,0.0);    </div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160; </div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;   <span class="comment">// Calculate pressure at integration point</span></div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l=0;l&lt;n_pres;l++) { interpolated_p += <a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a3aa173227f477a40fb4adba84a337f5b">p_axi_nst</a>(l)*psip[l]; }</div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;   </div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;   <span class="comment">// Calculate velocities and derivatives at integration point</span></div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;   <span class="comment">// ---------------------------------------------------------</span></div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160; </div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;   <span class="comment">// Loop over nodes</span></div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l=0;l&lt;n_node;l++) </div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;    {</div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;     <span class="comment">// Cache the shape function</span></div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;     <span class="keyword">const</span> <span class="keywordtype">double</span> psif_ = psif(l);</div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160; </div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;     <span class="comment">// Loop over the two coordinate directions</span></div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;2;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;      {</div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;       <a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] += this-&gt;<a class="code" href="classoomph_1_1FiniteElement.html#abe831900a6d6a08ee4a43fd9c07af32e">raw_nodal_position</a>(l,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>)*psif_;</div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;      }</div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160; </div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;     <span class="comment">// Loop over the three velocity directions</span></div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;3;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;      {</div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;       <span class="comment">// Get the nodal value</span></div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;       <span class="keyword">const</span> <span class="keywordtype">double</span> u_value = this-&gt;<a class="code" href="classoomph_1_1FiniteElement.html#abdc430bef622e0257397407416e6aac8">raw_nodal_value</a>(l,u_nodal_index[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]);</div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;       <a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] += u_value*psif_;</div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;       dudt[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] += <a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a80b3415e150243f8fff3f8eb87082b24">du_dt_axi_nst</a>(l,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>)*psif_;</div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;       </div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;       <span class="comment">// Loop over derivative directions</span></div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;       <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> j=0;j&lt;2;j++)</div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;        {                               </div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;         interpolated_dudx(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>,j) += u_value*dpsifdx(l,j);</div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;        }</div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;      }</div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;    }</div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160; </div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;   <span class="comment">// Get the mesh velocity if ALE is enabled</span></div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;   <span class="keywordflow">if</span>(!<a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a97f46e5472537187107d0454b6013b5f">ALE_is_disabled</a>)</div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;    {</div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;     <span class="comment">// Loop over nodes</span></div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l=0;l&lt;n_node;l++) </div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;      {</div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;       <span class="comment">// Loop over the two coordinate directions</span></div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;       <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;2;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;        {</div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;         mesh_velocity[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] += this-&gt;<a class="code" href="classoomph_1_1FiniteElement.html#aaaa11f3783ab48d882ac1858d74adba4">raw_dnodal_position_dt</a>(l,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>)*psif[l];</div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;        }</div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;      }</div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;    }</div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160; </div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;   <span class="comment">// Calculate derivative of du_i/dx_k w.r.t. nodal positions X_{pq}</span></div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> q=0;q&lt;n_node;q++)</div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;    {</div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;     <span class="comment">// Loop over the two coordinate directions</span></div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> p=0;p&lt;2;p++)</div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;      {</div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;       <span class="comment">// Loop over the three velocity components</span></div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;       <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;3;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;        {</div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;         <span class="comment">// Loop over the two coordinate directions</span></div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;         <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> k=0;k&lt;2;k++)</div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;          {</div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;           <span class="keywordtype">double</span> aux = 0.0;</div>
<div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160; </div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;           <span class="comment">// Loop over nodes and add contribution</span></div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;           <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> j=0;j&lt;n_node;j++)</div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;            {</div>
<div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;             aux += </div>
<div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;              this-&gt;<a class="code" href="classoomph_1_1FiniteElement.html#abdc430bef622e0257397407416e6aac8">raw_nodal_value</a>(j,u_nodal_index[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>])*d_dpsifdx_dX(p,q,j,k);</div>
<div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;            }</div>
<div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;           d_dudx_dX(p,q,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>,k) = aux;</div>
<div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;          }</div>
<div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;        }</div>
<div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;      }</div>
<div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;    }</div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160; </div>
<div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;   <span class="comment">// Get weight of actual nodal position/value in computation of mesh</span></div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;   <span class="comment">// velocity from positional/value time stepper</span></div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">double</span> pos_time_weight</div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;    = <a class="code" href="classoomph_1_1FiniteElement.html#ace0e7fb72a805b5c2c600347bfae7a9b">node_pt</a>(0)-&gt;<a class="code" href="classoomph_1_1Node.html#a89175b154594ba5b1a6cdde6f385dc71">position_time_stepper_pt</a>()-&gt;<a class="code" href="classoomph_1_1TimeStepper.html#a4cb0aecb044b77ba0553cdd54b586d8a">weight</a>(1,0);</div>
<div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">double</span> val_time_weight = <a class="code" href="classoomph_1_1FiniteElement.html#ace0e7fb72a805b5c2c600347bfae7a9b">node_pt</a>(0)-&gt;<a class="code" href="classoomph_1_1Data.html#a5b34970d16205921dca3ada720da8445">time_stepper_pt</a>()-&gt;<a class="code" href="classoomph_1_1TimeStepper.html#a4cb0aecb044b77ba0553cdd54b586d8a">weight</a>(1,0);</div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160; </div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;   <span class="comment">// Get the user-defined body force terms</span></div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;   <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> body_force(3);</div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;   <a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#adf10fc1309b9aeb92dc11be274ae65a2">get_body_force_axi_nst</a>(time,ipt,<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,<a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>,body_force);</div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;   </div>
<div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;   <span class="comment">// Get the user-defined source function</span></div>
<div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">double</span> source = <a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a7b965ac308b3a398a9365d76aa21a65f">get_source_fct</a>(time,ipt,<a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>);</div>
<div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160; </div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;   <span class="comment">// Note: Can use raw values and avoid bypassing hanging information</span></div>
<div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;   <span class="comment">// because this is the non-refineable version! </span></div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160; </div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;   <span class="comment">// Get gradient of body force function</span></div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;   <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> d_body_force_dx(3,2,0.0);</div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;   <a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#ab4a21f4cfb33ae0561d572126d672964">get_body_force_gradient_axi_nst</a>(time,ipt,<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,<a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>,</div>
<div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;                                   d_body_force_dx);</div>
<div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160; </div>
<div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;   <span class="comment">// Get gradient of source function</span></div>
<div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;   <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> source_gradient(2,0.0);</div>
<div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;   <a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a9b7e10587877daae2ef6be75cc35bef8">get_source_fct_gradient</a>(time,ipt,<a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>,source_gradient);</div>
<div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160; </div>
<div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;   <span class="comment">// Cache r (the first position component)</span></div>
<div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">double</span> r = <a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>[0];</div>
<div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160; </div>
<div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;   <span class="comment">// Assemble shape derivatives</span></div>
<div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;   <span class="comment">// --------------------------</span></div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160; </div>
<div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;   <span class="comment">// ==================</span></div>
<div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;   <span class="comment">// MOMENTUM EQUATIONS</span></div>
<div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;   <span class="comment">// ==================</span></div>
<div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;   </div>
<div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;   <span class="comment">// Loop over the test functions</span></div>
<div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l=0;l&lt;n_node;l++)</div>
<div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;    {</div>
<div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;     <span class="comment">// Cache the test function</span></div>
<div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;     <span class="keyword">const</span> <span class="keywordtype">double</span> testf_ = testf[l];</div>
<div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160; </div>
<div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;     <span class="comment">// --------------------------------</span></div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;     <span class="comment">// FIRST (RADIAL) MOMENTUM EQUATION</span></div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;     <span class="comment">// --------------------------------</span></div>
<div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;     local_eqn = <a class="code" href="classoomph_1_1FiniteElement.html#a5da80bbed97543e586f698251d67941d">nodal_local_eqn</a>(l,u_nodal_index[0]);;</div>
<div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;       </div>
<div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;     <span class="comment">// If it&#39;s not a boundary condition</span></div>
<div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;     <span class="keywordflow">if</span>(local_eqn &gt;= 0)</div>
<div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;      {</div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;       <span class="comment">// Loop over the two coordinate directions</span></div>
<div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;       <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> p=0;p&lt;2;p++)</div>
<div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;        {              </div>
<div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;         <span class="comment">// Loop over nodes</span></div>
<div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;         <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> q=0;q&lt;n_node;q++)</div>
<div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;          {       </div>
<div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;           </div>
<div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;           <span class="comment">// Residual x deriv of Jacobian</span></div>
<div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;           <span class="comment">// ----------------------------</span></div>
<div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160; </div>
<div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;           <span class="comment">// Add the user-defined body force terms</span></div>
<div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;           <span class="keywordtype">double</span> sum = r*body_force[0]*testf_;</div>
<div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160; </div>
<div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;           <span class="comment">// Add the gravitational body force term</span></div>
<div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;           sum += r*scaled_re_inv_fr*testf_*G[0];</div>
<div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;           </div>
<div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;           <span class="comment">// Add the pressure gradient term</span></div>
<div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;           sum += interpolated_p*(testf_ + r*dtestfdx(l,0));</div>
<div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;           </div>
<div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;           <span class="comment">// Add the stress tensor terms</span></div>
<div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;           <span class="comment">// The viscosity ratio needs to go in here to ensure</span></div>
<div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;           <span class="comment">// continuity of normal stress is satisfied even in flows</span></div>
<div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;           <span class="comment">// with zero pressure gradient!</span></div>
<div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;           sum -= visc_ratio*</div>
<div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;            r*(1.0+<a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#aff943b6b83128398a0320cae90c6b94c">Gamma</a>[0])*interpolated_dudx(0,0)*dtestfdx(l,0);</div>
<div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;           </div>
<div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;           sum -= visc_ratio*r*</div>
<div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;            (interpolated_dudx(0,1) + <a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#aff943b6b83128398a0320cae90c6b94c">Gamma</a>[0]*interpolated_dudx(1,0))*</div>
<div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;            dtestfdx(l,1);</div>
<div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;           </div>
<div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;           sum -= visc_ratio*(1.0 + <a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#aff943b6b83128398a0320cae90c6b94c">Gamma</a>[0])*<a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>[0]*testf_/r;</div>
<div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;           </div>
<div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;           <span class="comment">// Add the du/dt term</span></div>
<div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;           sum -= scaled_re_st*r*dudt[0]*testf_;</div>
<div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;           </div>
<div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;           <span class="comment">// Add the convective terms</span></div>
<div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;           sum -= </div>
<div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;            scaled_re*(r*<a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>[0]*interpolated_dudx(0,0) </div>
<div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;                       - <a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>[2]*<a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>[2] </div>
<div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;                       + r*<a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>[1]*interpolated_dudx(0,1))*testf_;</div>
<div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;           </div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;           <span class="comment">// Add the mesh velocity terms</span></div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;           <span class="keywordflow">if</span>(!<a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a97f46e5472537187107d0454b6013b5f">ALE_is_disabled</a>)</div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;            {</div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;             <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> k=0;k&lt;2;k++)</div>
<div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;              {</div>
<div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;               sum += scaled_re_st*r*mesh_velocity[k]</div>
<div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;                *interpolated_dudx(0,k)*testf_;</div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;              }</div>
<div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;            }</div>
<div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;           </div>
<div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;           <span class="comment">// Add the Coriolis term</span></div>
<div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;           sum += 2.0*r*scaled_re_inv_ro*<a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>[2]*testf_;</div>
<div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160; </div>
<div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;           <span class="comment">// Multiply through by deriv of Jacobian and integration weight</span></div>
<div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;           dresidual_dnodal_coordinates(local_eqn,p,q) += sum*dJ_dX(p,q)*w;</div>
<div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;             </div>
<div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;           <span class="comment">// Derivative of residual x Jacobian</span></div>
<div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;           <span class="comment">// ---------------------------------</span></div>
<div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160; </div>
<div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;           <span class="comment">// Body force</span></div>
<div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;           sum = r*d_body_force_dx(0,p)*psif[q]*testf_;</div>
<div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;           <span class="keywordflow">if</span>(p==0) { sum += body_force[0]*psif[q]*testf_; }</div>
<div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160; </div>
<div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;           <span class="comment">// Gravitational body force</span></div>
<div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;           <span class="keywordflow">if</span>(p==0) { sum += scaled_re_inv_fr*G[0]*psif[q]*testf_; }</div>
<div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160; </div>
<div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;           <span class="comment">// Pressure gradient term</span></div>
<div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;           sum += r*interpolated_p*d_dtestfdx_dX(p,q,l,0);</div>
<div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;           <span class="keywordflow">if</span>(p==0) { sum += interpolated_p*psif[q]*dtestfdx(l,0); }</div>
<div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160; </div>
<div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;           <span class="comment">// Viscous terms</span></div>
<div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;           sum -= r*visc_ratio*(</div>
<div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;            (1.0+<a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#aff943b6b83128398a0320cae90c6b94c">Gamma</a>[0])*(</div>
<div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;             d_dudx_dX(p,q,0,0)*dtestfdx(l,0)</div>
<div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;             + interpolated_dudx(0,0)*d_dtestfdx_dX(p,q,l,0))</div>
<div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;            + (d_dudx_dX(p,q,0,1)</div>
<div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;               + <a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#aff943b6b83128398a0320cae90c6b94c">Gamma</a>[0]*d_dudx_dX(p,q,1,0))*dtestfdx(l,1)</div>
<div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;            + (interpolated_dudx(0,1)</div>
<div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;               + <a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#aff943b6b83128398a0320cae90c6b94c">Gamma</a>[0]*interpolated_dudx(1,0))</div>
<div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;            *d_dtestfdx_dX(p,q,l,1));</div>
<div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;           <span class="keywordflow">if</span>(p==0)</div>
<div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;            {</div>
<div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;             sum -= visc_ratio*(</div>
<div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;              (1.0+<a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#aff943b6b83128398a0320cae90c6b94c">Gamma</a>[0])*(</div>
<div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;               interpolated_dudx(0,0)*psif[q]*dtestfdx(l,0)</div>
<div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;               - <a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>[0]*psif[q]*testf_/(r*r))</div>
<div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;              + (interpolated_dudx(0,1)</div>
<div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;                 + <a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#aff943b6b83128398a0320cae90c6b94c">Gamma</a>[0]*interpolated_dudx(1,0))*psif[q]*dtestfdx(l,1));</div>
<div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;            }</div>
<div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;           </div>
<div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;           <span class="comment">// Convective terms, including mesh velocity</span></div>
<div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;           <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> k=0;k&lt;2;k++)</div>
<div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;            {</div>
<div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;             <span class="keywordtype">double</span> tmp = scaled_re*<a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>[k];</div>
<div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;             <span class="keywordflow">if</span>(!<a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a97f46e5472537187107d0454b6013b5f">ALE_is_disabled</a>) { tmp -= scaled_re_st*mesh_velocity[k]; }</div>
<div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;             sum -= r*tmp*d_dudx_dX(p,q,0,k)*testf_;</div>
<div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;             <span class="keywordflow">if</span>(p==0) { sum -= tmp*interpolated_dudx(0,k)*psif[q]*testf_; }</div>
<div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;            }</div>
<div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;           <span class="keywordflow">if</span>(!<a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a97f46e5472537187107d0454b6013b5f">ALE_is_disabled</a>)</div>
<div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;            {</div>
<div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;             sum += scaled_re_st*r*pos_time_weight*interpolated_dudx(0,p)</div>
<div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;              *psif[q]*testf_;</div>
<div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;            }</div>
<div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160; </div>
<div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;           <span class="comment">// du/dt term</span></div>
<div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;           <span class="keywordflow">if</span>(p==0) { sum -= scaled_re_st*dudt[0]*psif[q]*testf_; }</div>
<div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160; </div>
<div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;           <span class="comment">// Coriolis term</span></div>
<div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;           <span class="keywordflow">if</span>(p==0)</div>
<div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;            {</div>
<div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;             sum += 2.0*scaled_re_inv_ro*<a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>[2]*psif[q]*testf_;</div>
<div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;            }</div>
<div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160; </div>
<div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;           <span class="comment">// Multiply through by Jacobian and integration weight</span></div>
<div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;           dresidual_dnodal_coordinates(local_eqn,p,q) += sum*J*w;</div>
<div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160; </div>
<div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;           <span class="comment">// Derivs w.r.t. nodal velocities</span></div>
<div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;           <span class="comment">// ------------------------------</span></div>
<div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;           <span class="keywordflow">if</span>(element_has_node_with_aux_node_update_fct)</div>
<div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;            {</div>
<div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;             <span class="comment">// Contribution from deriv of first velocity component</span></div>
<div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;             <span class="keywordtype">double</span> tmp = scaled_re_st*r*val_time_weight*psif[q]*testf_;</div>
<div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;             tmp += r*scaled_re*interpolated_dudx(0,0)*psif[q]*testf_;</div>
<div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;             <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> k=0;k&lt;2;k++)</div>
<div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;              {</div>
<div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;               <span class="keywordtype">double</span> tmp2 = scaled_re*<a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>[k];</div>
<div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;               <span class="keywordflow">if</span>(!<a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a97f46e5472537187107d0454b6013b5f">ALE_is_disabled</a>) { tmp2 -= scaled_re_st*mesh_velocity[k]; }</div>
<div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;               tmp += r*tmp2*dpsifdx(q,k)*testf_;</div>
<div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;              }</div>
<div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160; </div>
<div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;             tmp += r*visc_ratio*(1.0+<a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#aff943b6b83128398a0320cae90c6b94c">Gamma</a>[0])*dpsifdx(q,0)*dtestfdx(l,0);</div>
<div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;             tmp += r*visc_ratio*dpsifdx(q,1)*dtestfdx(l,1);</div>
<div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;             tmp += visc_ratio*(1.0+<a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#aff943b6b83128398a0320cae90c6b94c">Gamma</a>[0])*psif[q]*testf_/r;</div>
<div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160; </div>
<div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;             <span class="comment">// Multiply through by dU_0q/dX_pq</span></div>
<div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;             sum = -d_U_dX(p,q,0)*tmp;</div>
<div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160; </div>
<div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;             <span class="comment">// Contribution from deriv of second velocity component</span></div>
<div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;             tmp = scaled_re*r*interpolated_dudx(0,1)*psif[q]*testf_;</div>
<div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;             tmp += r*visc_ratio*<a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#aff943b6b83128398a0320cae90c6b94c">Gamma</a>[0]*dpsifdx(q,0)*dtestfdx(l,1);</div>
<div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160; </div>
<div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;             <span class="comment">// Multiply through by dU_1q/dX_pq</span></div>
<div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;             sum -= d_U_dX(p,q,1)*tmp;</div>
<div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160; </div>
<div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;             <span class="comment">// Contribution from deriv of third velocity component</span></div>
<div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;             tmp = 2.0*(r*scaled_re_inv_ro</div>
<div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;                        + scaled_re*<a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>[2])*psif[q]*testf_;</div>
<div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160; </div>
<div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;             <span class="comment">// Multiply through by dU_2q/dX_pq</span></div>
<div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;             sum += d_U_dX(p,q,2)*tmp;</div>
<div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;             </div>
<div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;             <span class="comment">// Multiply through by Jacobian and integration weight</span></div>
<div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;             dresidual_dnodal_coordinates(local_eqn,p,q) += sum*J*w; </div>
<div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;            }</div>
<div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;          } <span class="comment">// End of loop over q</span></div>
<div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;        } <span class="comment">// End of loop over p</span></div>
<div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;      } <span class="comment">// End of if it&#39;s not a boundary condition</span></div>
<div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160; </div>
<div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;     <span class="comment">// --------------------------------</span></div>
<div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;     <span class="comment">// SECOND (AXIAL) MOMENTUM EQUATION</span></div>
<div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;     <span class="comment">// --------------------------------</span></div>
<div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;     local_eqn = <a class="code" href="classoomph_1_1FiniteElement.html#a5da80bbed97543e586f698251d67941d">nodal_local_eqn</a>(l,u_nodal_index[1]);;</div>
<div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;       </div>
<div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;     <span class="comment">// If it&#39;s not a boundary condition</span></div>
<div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;     <span class="keywordflow">if</span>(local_eqn &gt;= 0)</div>
<div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;      {</div>
<div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;       <span class="comment">// Loop over the two coordinate directions</span></div>
<div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;       <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> p=0;p&lt;2;p++)</div>
<div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;        {              </div>
<div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;         <span class="comment">// Loop over nodes</span></div>
<div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;         <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> q=0;q&lt;n_node;q++)</div>
<div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;          {       </div>
<div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;           </div>
<div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;           <span class="comment">// Residual x deriv of Jacobian</span></div>
<div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;           <span class="comment">// ----------------------------</span></div>
<div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160; </div>
<div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;           <span class="comment">// Add the user-defined body force terms</span></div>
<div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;           <span class="keywordtype">double</span> sum = r*body_force[1]*testf_;</div>
<div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;           </div>
<div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;           <span class="comment">// Add the gravitational body force term</span></div>
<div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;           sum += r*scaled_re_inv_fr*testf_*G[1];</div>
<div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;           </div>
<div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;           <span class="comment">// Add the pressure gradient term</span></div>
<div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;           sum  += r*interpolated_p*dtestfdx(l,1);</div>
<div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;           </div>
<div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;           <span class="comment">// Add the stress tensor terms</span></div>
<div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;           <span class="comment">// The viscosity ratio needs to go in here to ensure</span></div>
<div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;           <span class="comment">// continuity of normal stress is satisfied even in flows</span></div>
<div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;           <span class="comment">// with zero pressure gradient!</span></div>
<div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;           sum -= visc_ratio*</div>
<div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;            r*(interpolated_dudx(1,0) + <a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#aff943b6b83128398a0320cae90c6b94c">Gamma</a>[1]*interpolated_dudx(0,1))</div>
<div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;            *dtestfdx(l,0);</div>
<div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;           </div>
<div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;           sum -= visc_ratio*r*</div>
<div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;            (1.0 + <a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#aff943b6b83128398a0320cae90c6b94c">Gamma</a>[1])*interpolated_dudx(1,1)*dtestfdx(l,1);</div>
<div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;           </div>
<div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;           <span class="comment">// Add the du/dt term</span></div>
<div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;           sum -= scaled_re_st*r*dudt[1]*testf_;</div>
<div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;           </div>
<div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;           <span class="comment">// Add the convective terms</span></div>
<div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;           sum -=</div>
<div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;            scaled_re*(r*<a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>[0]*interpolated_dudx(1,0) </div>
<div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;                       + r*<a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>[1]*interpolated_dudx(1,1))*testf_;</div>
<div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;           </div>
<div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;           <span class="comment">// Add the mesh velocity terms</span></div>
<div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;           <span class="keywordflow">if</span>(!<a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a97f46e5472537187107d0454b6013b5f">ALE_is_disabled</a>)</div>
<div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;            {</div>
<div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;             <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> k=0;k&lt;2;k++)</div>
<div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;              {</div>
<div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;               sum += </div>
<div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;                scaled_re_st*r*mesh_velocity[k]*interpolated_dudx(1,k)*testf_;</div>
<div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;              }</div>
<div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;            }</div>
<div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160; </div>
<div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;           <span class="comment">// Multiply through by deriv of Jacobian and integration weight</span></div>
<div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;           dresidual_dnodal_coordinates(local_eqn,p,q) += sum*dJ_dX(p,q)*w;</div>
<div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;             </div>
<div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;           <span class="comment">// Derivative of residual x Jacobian</span></div>
<div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;           <span class="comment">// ---------------------------------</span></div>
<div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160; </div>
<div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;           <span class="comment">// Body force</span></div>
<div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;           sum = r*d_body_force_dx(1,p)*psif[q]*testf_;</div>
<div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;           <span class="keywordflow">if</span>(p==0) { sum += body_force[1]*psif[q]*testf_; }</div>
<div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160; </div>
<div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;           <span class="comment">// Gravitational body force</span></div>
<div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;           <span class="keywordflow">if</span>(p==0) { sum += scaled_re_inv_fr*G[1]*psif[q]*testf_; }</div>
<div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160; </div>
<div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;           <span class="comment">// Pressure gradient term</span></div>
<div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;           sum += r*interpolated_p*d_dtestfdx_dX(p,q,l,1);</div>
<div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;           <span class="keywordflow">if</span>(p==0) { sum += interpolated_p*psif[q]*dtestfdx(l,1); }</div>
<div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160; </div>
<div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;           <span class="comment">// Viscous terms</span></div>
<div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;           sum -= r*visc_ratio*(</div>
<div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;            (d_dudx_dX(p,q,1,0) + <a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#aff943b6b83128398a0320cae90c6b94c">Gamma</a>[1]*d_dudx_dX(p,q,0,1))*dtestfdx(l,0)</div>
<div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;            + (interpolated_dudx(1,0)</div>
<div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;               + <a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#aff943b6b83128398a0320cae90c6b94c">Gamma</a>[1]*interpolated_dudx(0,1))*d_dtestfdx_dX(p,q,l,0)</div>
<div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;            + (1.0+<a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#aff943b6b83128398a0320cae90c6b94c">Gamma</a>[1])*d_dudx_dX(p,q,1,1)*dtestfdx(l,1)</div>
<div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;            + (1.0+<a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#aff943b6b83128398a0320cae90c6b94c">Gamma</a>[1])*interpolated_dudx(1,1)*d_dtestfdx_dX(p,q,l,1));</div>
<div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;           <span class="keywordflow">if</span>(p==0)</div>
<div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;            {</div>
<div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;             sum -= visc_ratio*(</div>
<div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;              (interpolated_dudx(1,0)</div>
<div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;               + <a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#aff943b6b83128398a0320cae90c6b94c">Gamma</a>[1]*interpolated_dudx(0,1))*psif[q]*dtestfdx(l,0)</div>
<div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;              + (1.0+<a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#aff943b6b83128398a0320cae90c6b94c">Gamma</a>[1])*interpolated_dudx(1,1)*psif[q]*dtestfdx(l,1));</div>
<div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;            }</div>
<div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160; </div>
<div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;           <span class="comment">// Convective terms, including mesh velocity</span></div>
<div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;           <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> k=0;k&lt;2;k++)</div>
<div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;            {</div>
<div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;             <span class="keywordtype">double</span> tmp = scaled_re*<a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>[k];</div>
<div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;             <span class="keywordflow">if</span>(!<a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a97f46e5472537187107d0454b6013b5f">ALE_is_disabled</a>) { tmp -= scaled_re_st*mesh_velocity[k]; }</div>
<div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;             sum -= r*tmp*d_dudx_dX(p,q,1,k)*testf_;</div>
<div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;             <span class="keywordflow">if</span>(p==0) { sum -= tmp*interpolated_dudx(1,k)*psif[q]*testf_; }</div>
<div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;            }</div>
<div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;           <span class="keywordflow">if</span>(!<a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a97f46e5472537187107d0454b6013b5f">ALE_is_disabled</a>)</div>
<div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;            {</div>
<div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;             sum += scaled_re_st*r*pos_time_weight*interpolated_dudx(1,p)</div>
<div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;              *psif[q]*testf_;</div>
<div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;            }</div>
<div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160; </div>
<div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;           <span class="comment">// du/dt term</span></div>
<div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;           <span class="keywordflow">if</span>(p==0) { sum -= scaled_re_st*dudt[1]*psif[q]*testf_; }</div>
<div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160; </div>
<div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;           <span class="comment">// Multiply through by Jacobian and integration weight</span></div>
<div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;           dresidual_dnodal_coordinates(local_eqn,p,q) += sum*J*w;</div>
<div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160; </div>
<div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;           <span class="comment">// Derivs w.r.t. to nodal velocities</span></div>
<div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;           <span class="comment">// ---------------------------------</span></div>
<div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;           <span class="keywordflow">if</span>(element_has_node_with_aux_node_update_fct)</div>
<div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;            {</div>
<div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;             <span class="comment">// Contribution from deriv of first velocity component</span></div>
<div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;             <span class="keywordtype">double</span> tmp = scaled_re*r*interpolated_dudx(1,0)*psif[q]*testf_;</div>
<div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;             tmp += r*visc_ratio*<a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#aff943b6b83128398a0320cae90c6b94c">Gamma</a>[1]*dpsifdx(q,1)*dtestfdx(l,0);</div>
<div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;             </div>
<div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;             <span class="comment">// Multiply through by dU_0q/dX_pq</span></div>
<div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;             sum = -d_U_dX(p,q,0)*tmp;</div>
<div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160; </div>
<div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;             <span class="comment">// Contribution from deriv of second velocity component</span></div>
<div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;             tmp = scaled_re_st*r*val_time_weight*psif[q]*testf_;</div>
<div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;             tmp += r*scaled_re*interpolated_dudx(1,1)*psif[q]*testf_;</div>
<div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;             <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> k=0;k&lt;2;k++)</div>
<div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;              {</div>
<div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;               <span class="keywordtype">double</span> tmp2 = scaled_re*<a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>[k];</div>
<div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;               <span class="keywordflow">if</span>(!<a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a97f46e5472537187107d0454b6013b5f">ALE_is_disabled</a>) { tmp2 -= scaled_re_st*mesh_velocity[k]; }</div>
<div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;               tmp += r*tmp2*dpsifdx(q,k)*testf_;</div>
<div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;              }</div>
<div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;             tmp += r*visc_ratio*(dpsifdx(q,0)*dtestfdx(l,0)</div>
<div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;                                  + (1.0+<a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#aff943b6b83128398a0320cae90c6b94c">Gamma</a>[1])*dpsifdx(q,1)*dtestfdx(l,1));</div>
<div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;             </div>
<div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;             <span class="comment">// Multiply through by dU_1q/dX_pq</span></div>
<div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;             sum -= d_U_dX(p,q,1)*tmp;</div>
<div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160; </div>
<div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;             <span class="comment">// Multiply through by Jacobian and integration weight</span></div>
<div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;             dresidual_dnodal_coordinates(local_eqn,p,q) += sum*J*w; </div>
<div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;            }</div>
<div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;          } <span class="comment">// End of loop over q</span></div>
<div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;        } <span class="comment">// End of loop over p</span></div>
<div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;      } <span class="comment">// End of if it&#39;s not a boundary condition</span></div>
<div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160; </div>
<div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;     <span class="comment">// -----------------------------------</span></div>
<div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;     <span class="comment">// THIRD (AZIMUTHAL) MOMENTUM EQUATION</span></div>
<div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;     <span class="comment">// -----------------------------------</span></div>
<div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;     local_eqn = <a class="code" href="classoomph_1_1FiniteElement.html#a5da80bbed97543e586f698251d67941d">nodal_local_eqn</a>(l,u_nodal_index[2]);;</div>
<div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;       </div>
<div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;     <span class="comment">// If it&#39;s not a boundary condition</span></div>
<div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;     <span class="keywordflow">if</span>(local_eqn &gt;= 0)</div>
<div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;      {</div>
<div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;       <span class="comment">// Loop over the two coordinate directions</span></div>
<div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;       <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> p=0;p&lt;2;p++)</div>
<div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;        {              </div>
<div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;         <span class="comment">// Loop over nodes</span></div>
<div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;         <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> q=0;q&lt;n_node;q++)</div>
<div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;          {       </div>
<div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;           </div>
<div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;           <span class="comment">// Residual x deriv of Jacobian</span></div>
<div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;           <span class="comment">// ----------------------------</span></div>
<div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160; </div>
<div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;           <span class="comment">// Add the user-defined body force terms</span></div>
<div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;           <span class="keywordtype">double</span> sum = r*body_force[2]*testf_;</div>
<div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;           </div>
<div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;           <span class="comment">// Add the gravitational body force term</span></div>
<div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;           sum += r*scaled_re_inv_fr*testf_*G[2];</div>
<div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;       </div>
<div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;           <span class="comment">// There is NO pressure gradient term</span></div>
<div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;       </div>
<div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;           <span class="comment">// Add in the stress tensor terms</span></div>
<div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;           <span class="comment">// The viscosity ratio needs to go in here to ensure</span></div>
<div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;           <span class="comment">// continuity of normal stress is satisfied even in flows</span></div>
<div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;           <span class="comment">// with zero pressure gradient!</span></div>
<div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;           sum -= visc_ratio*(r*interpolated_dudx(2,0) - </div>
<div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;                              <a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#aff943b6b83128398a0320cae90c6b94c">Gamma</a>[0]*<a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>[2])*dtestfdx(l,0);</div>
<div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;       </div>
<div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;           sum -= visc_ratio*r*interpolated_dudx(2,1)*dtestfdx(l,1);</div>
<div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;            </div>
<div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;           sum -= visc_ratio*((<a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>[2]/r)</div>
<div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;                              - <a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#aff943b6b83128398a0320cae90c6b94c">Gamma</a>[0]*interpolated_dudx(2,0))*testf_;</div>
<div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;            </div>
<div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;           <span class="comment">// Add the du/dt term</span></div>
<div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;           sum -= scaled_re_st*r*dudt[2]*testf_;</div>
<div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160; </div>
<div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;           <span class="comment">// Add the convective terms</span></div>
<div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;           sum -= </div>
<div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;            scaled_re*(r*<a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>[0]*interpolated_dudx(2,0)</div>
<div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;                       + <a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>[0]*<a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>[2]</div>
<div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;                       + r*<a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>[1]*interpolated_dudx(2,1))*testf_;</div>
<div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;       </div>
<div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;           <span class="comment">// Add the mesh velocity terms</span></div>
<div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;           <span class="keywordflow">if</span>(!<a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a97f46e5472537187107d0454b6013b5f">ALE_is_disabled</a>)</div>
<div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;            {</div>
<div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;             <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> k=0;k&lt;2;k++)</div>
<div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;              {</div>
<div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;               sum += </div>
<div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;                scaled_re_st*r*mesh_velocity[k]*interpolated_dudx(2,k)*testf_;</div>
<div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;              }</div>
<div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;            }</div>
<div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160; </div>
<div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;           <span class="comment">// Add the Coriolis term</span></div>
<div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;           sum -= 2.0*r*scaled_re_inv_ro*<a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>[0]*testf_;</div>
<div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;           </div>
<div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;           <span class="comment">// Multiply through by deriv of Jacobian and integration weight</span></div>
<div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;           dresidual_dnodal_coordinates(local_eqn,p,q) += sum*dJ_dX(p,q)*w;</div>
<div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;             </div>
<div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;           <span class="comment">// Derivative of residual x Jacobian</span></div>
<div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;           <span class="comment">// ---------------------------------</span></div>
<div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160; </div>
<div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;           <span class="comment">// Body force</span></div>
<div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;           sum = r*d_body_force_dx(2,p)*psif[q]*testf_;</div>
<div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;           <span class="keywordflow">if</span>(p==0) { sum += body_force[2]*psif[q]*testf_; }</div>
<div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160; </div>
<div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;           <span class="comment">// Gravitational body force</span></div>
<div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;           <span class="keywordflow">if</span>(p==0) { sum += scaled_re_inv_fr*G[2]*psif[q]*testf_; }</div>
<div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160; </div>
<div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;           <span class="comment">// There is NO pressure gradient term</span></div>
<div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160; </div>
<div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;           <span class="comment">// Viscous terms</span></div>
<div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;           sum -= visc_ratio*r*(</div>
<div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;            d_dudx_dX(p,q,2,0)*dtestfdx(l,0)</div>
<div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;            + interpolated_dudx(2,0)*d_dtestfdx_dX(p,q,l,0)</div>
<div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;            + d_dudx_dX(p,q,2,1)*dtestfdx(l,1)</div>
<div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;            + interpolated_dudx(2,1)*d_dtestfdx_dX(p,q,l,1));</div>
<div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160; </div>
<div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;           sum += visc_ratio*<a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#aff943b6b83128398a0320cae90c6b94c">Gamma</a>[0]*d_dudx_dX(p,q,2,0)*testf_;</div>
<div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160; </div>
<div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;           <span class="keywordflow">if</span>(p==0)</div>
<div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;            {</div>
<div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;             sum -= visc_ratio*(interpolated_dudx(2,0)*psif[q]*dtestfdx(l,0)</div>
<div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;                                + interpolated_dudx(2,1)*psif[q]*dtestfdx(l,1)</div>
<div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;                                + <a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>[2]*psif[q]*testf_/(r*r));</div>
<div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;            }</div>
<div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160; </div>
<div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;           <span class="comment">// Convective terms, including mesh velocity</span></div>
<div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;           <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> k=0;k&lt;2;k++)</div>
<div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;            {</div>
<div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;             <span class="keywordtype">double</span> tmp = scaled_re*<a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>[k];</div>
<div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;             <span class="keywordflow">if</span>(!<a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a97f46e5472537187107d0454b6013b5f">ALE_is_disabled</a>) { tmp -= scaled_re_st*mesh_velocity[k]; }</div>
<div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;             sum -= r*tmp*d_dudx_dX(p,q,2,k)*testf_;</div>
<div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;             <span class="keywordflow">if</span>(p==0) { sum -= tmp*interpolated_dudx(2,k)*psif[q]*testf_; }</div>
<div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;            }</div>
<div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;           <span class="keywordflow">if</span>(!<a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a97f46e5472537187107d0454b6013b5f">ALE_is_disabled</a>)</div>
<div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;            {</div>
<div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;             sum += scaled_re_st*r*pos_time_weight*interpolated_dudx(2,p)</div>
<div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;              *psif[q]*testf_;</div>
<div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;            }</div>
<div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160; </div>
<div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;           <span class="comment">// du/dt term</span></div>
<div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;           <span class="keywordflow">if</span>(p==0) { sum -= scaled_re_st*dudt[2]*psif[q]*testf_; }</div>
<div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160; </div>
<div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;           <span class="comment">// Coriolis term</span></div>
<div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;           <span class="keywordflow">if</span>(p==0)</div>
<div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;            {</div>
<div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;             sum -= 2.0*scaled_re_inv_ro*<a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>[0]*psif[q]*testf_;</div>
<div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;            }</div>
<div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160; </div>
<div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;           <span class="comment">// Multiply through by Jacobian and integration weight</span></div>
<div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;           dresidual_dnodal_coordinates(local_eqn,p,q) += sum*J*w;</div>
<div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160; </div>
<div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160;           <span class="comment">// Derivs w.r.t. to nodal velocities</span></div>
<div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;           <span class="comment">// ---------------------------------</span></div>
<div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;           <span class="keywordflow">if</span>(element_has_node_with_aux_node_update_fct)</div>
<div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;            {</div>
<div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;             <span class="comment">// Contribution from deriv of first velocity component</span></div>
<div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;             <span class="keywordtype">double</span> tmp = (2.0*r*scaled_re_inv_ro</div>
<div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;                           + r*scaled_re*interpolated_dudx(2,0)</div>
<div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;                           - scaled_re*<a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>[2])*psif[q]*testf_;</div>
<div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160; </div>
<div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;             <span class="comment">// Multiply through by dU_0q/dX_pq</span></div>
<div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;             sum = -d_U_dX(p,q,0)*tmp;</div>
<div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160; </div>
<div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;             <span class="comment">// Contribution from deriv of second velocity component</span></div>
<div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;             <span class="comment">// Multiply through by dU_1q/dX_pq</span></div>
<div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;             sum -= d_U_dX(p,q,1)*scaled_re*r*interpolated_dudx(2,1)</div>
<div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;              *psif[q]*testf_;</div>
<div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160; </div>
<div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;             <span class="comment">// Contribution from deriv of third velocity component</span></div>
<div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;             tmp = scaled_re_st*r*val_time_weight*psif[q]*testf_;</div>
<div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;             tmp -= scaled_re*<a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>[0]*psif[q]*testf_;</div>
<div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;             <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> k=0;k&lt;2;k++)</div>
<div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;              {</div>
<div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;               <span class="keywordtype">double</span> tmp2 = scaled_re*<a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>[k];</div>
<div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;               <span class="keywordflow">if</span>(!<a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a97f46e5472537187107d0454b6013b5f">ALE_is_disabled</a>) { tmp2 -= scaled_re_st*mesh_velocity[k]; }</div>
<div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;               tmp += r*tmp2*dpsifdx(q,k)*testf_;</div>
<div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;              }</div>
<div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;             tmp += visc_ratio*(r*dpsifdx(q,0)</div>
<div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;                                - <a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#aff943b6b83128398a0320cae90c6b94c">Gamma</a>[0]*psif[q])*dtestfdx(l,0);</div>
<div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160;             tmp += r*visc_ratio*dpsifdx(q,1)*dtestfdx(l,1);</div>
<div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160;             tmp += visc_ratio*((psif[q]/r) - <a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#aff943b6b83128398a0320cae90c6b94c">Gamma</a>[0]*dpsifdx(q,0))*testf_;</div>
<div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160;             </div>
<div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160;             <span class="comment">// Multiply through by dU_2q/dX_pq</span></div>
<div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160;             sum -= d_U_dX(p,q,2)*tmp;</div>
<div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160; </div>
<div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160;             <span class="comment">// Multiply through by Jacobian and integration weight</span></div>
<div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160;             dresidual_dnodal_coordinates(local_eqn,p,q) += sum*J*w; </div>
<div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160;            }</div>
<div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160;          } <span class="comment">// End of loop over q</span></div>
<div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;        } <span class="comment">// End of loop over p</span></div>
<div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;      } <span class="comment">// End of if it&#39;s not a boundary condition</span></div>
<div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160; </div>
<div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160;    } <span class="comment">// End of loop over test functions</span></div>
<div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;   </div>
<div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160; </div>
<div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160;   <span class="comment">// ===================</span></div>
<div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160;   <span class="comment">// CONTINUITY EQUATION</span></div>
<div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;   <span class="comment">// ===================</span></div>
<div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;   </div>
<div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160;   <span class="comment">// Loop over the shape functions</span></div>
<div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l=0;l&lt;n_pres;l++)</div>
<div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;    {</div>
<div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160;     local_eqn = <a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#ad6ac62ca5fa411c365fd2ecc72aa25e8">p_local_eqn</a>(l);</div>
<div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160;  </div>
<div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160;     <span class="comment">// Cache the test function</span></div>
<div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160;     <span class="keyword">const</span> <span class="keywordtype">double</span> testp_ = testp[l];</div>
<div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160; </div>
<div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;     <span class="comment">// If not a boundary conditions</span></div>
<div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160;     <span class="keywordflow">if</span>(local_eqn &gt;= 0)</div>
<div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160;      {</div>
<div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160; </div>
<div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160;       <span class="comment">// Loop over the two coordinate directions</span></div>
<div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;       <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> p=0;p&lt;2;p++)</div>
<div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160;        {              </div>
<div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160;         <span class="comment">// Loop over nodes</span></div>
<div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;         <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> q=0;q&lt;n_node;q++)</div>
<div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;          {       </div>
<div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;           </div>
<div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;           <span class="comment">// Residual x deriv of Jacobian</span></div>
<div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160;           <span class="comment">//-----------------------------</span></div>
<div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;           </div>
<div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;           <span class="comment">// Source term</span></div>
<div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;           <span class="keywordtype">double</span> aux = -r*source;</div>
<div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160; </div>
<div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;           <span class="comment">// Gradient terms</span></div>
<div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160;           aux += (<a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>[0]</div>
<div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;                   + r*interpolated_dudx(0,0) </div>
<div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160;                   + r*interpolated_dudx(1,1));</div>
<div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160; </div>
<div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160;           <span class="comment">// Multiply through by deriv of Jacobian and integration weight</span></div>
<div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160;           dresidual_dnodal_coordinates(local_eqn,p,q) +=</div>
<div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160;            aux*dJ_dX(p,q)*testp_*w;</div>
<div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160; </div>
<div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160;           <span class="comment">// Derivative of residual x Jacobian</span></div>
<div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160;           <span class="comment">// ---------------------------------          </span></div>
<div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160; </div>
<div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160;           <span class="comment">// Gradient of source function</span></div>
<div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160;           aux = -r*source_gradient[p]*psif[q];</div>
<div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160;           <span class="keywordflow">if</span>(p==0) { aux -= source*psif[q]; }</div>
<div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160; </div>
<div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160;           <span class="comment">// Gradient terms</span></div>
<div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160;           aux += r*(d_dudx_dX(p,q,0,0) + d_dudx_dX(p,q,1,1));</div>
<div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160;           <span class="keywordflow">if</span>(p==0)</div>
<div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;            {</div>
<div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;             aux += (interpolated_dudx(0,0) + interpolated_dudx(1,1))*psif[q];</div>
<div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160;            }</div>
<div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160; </div>
<div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160;           <span class="comment">// Derivs w.r.t. nodal velocities</span></div>
<div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;           <span class="comment">// ------------------------------</span></div>
<div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160;           <span class="keywordflow">if</span>(element_has_node_with_aux_node_update_fct)</div>
<div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160;            {</div>
<div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160;             aux += d_U_dX(p,q,0)*(psif[q] + r*dpsifdx(q,0));</div>
<div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160;             aux += d_U_dX(p,q,1)*r*dpsifdx(q,1);</div>
<div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160;            }</div>
<div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160; </div>
<div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160;           <span class="comment">// Multiply through by Jacobian, test fct and integration weight</span></div>
<div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;           dresidual_dnodal_coordinates(local_eqn,p,q) += aux*testp_*J*w;</div>
<div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160;            </div>
<div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160;          }</div>
<div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160;        }</div>
<div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160;      }</div>
<div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160;    } <span class="comment">// End of loop over shape functions for continuity eqn</span></div>
<div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160; </div>
<div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160;  } <span class="comment">// End of loop over integration points</span></div>
<div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160;}   </div>
<div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160; </div>
<div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160; </div>
<div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160; </div>
<div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160; </div>
<div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160; </div>
<div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160;<span class="comment">//==============================================================</span><span class="comment"></span></div>
<div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160;<span class="comment">///  Compute the residuals for the Navier--Stokes </span></div>
<div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160;<span class="comment">///  equations; flag=1(or 0): do (or don&#39;t) compute the </span></div>
<div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160;<span class="comment">///  Jacobian as well. </span></div>
<div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;<span class="comment"></span><span class="comment">//==============================================================</span></div>
<div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a19a4b0c9d98bd79212fe8b507d44f7ab">AxisymmetricNavierStokesEquations::</a></div>
<div class="line"><a name="l02358"></a><span class="lineno"><a class="line" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a19a4b0c9d98bd79212fe8b507d44f7ab"> 2358</a></span>&#160;<a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a19a4b0c9d98bd79212fe8b507d44f7ab">fill_in_generic_dresidual_contribution_axi_nst</a>(</div>
<div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160; <span class="keywordtype">double</span>* <span class="keyword">const</span> &amp;parameter_pt,</div>
<div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160; <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;dres_dparam, </div>
<div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160; <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> &amp;djac_dparam, </div>
<div class="line"><a name="l02362"></a><span class="lineno"> 2362</span>&#160; <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> &amp;dmass_matrix_dparam,</div>
<div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160; <span class="keywordtype">unsigned</span> flag)</div>
<div class="line"><a name="l02364"></a><span class="lineno"> 2364</span>&#160;{</div>
<div class="line"><a name="l02365"></a><span class="lineno"> 2365</span>&#160; <span class="comment">//Die if the parameter is not the Reynolds number</span></div>
<div class="line"><a name="l02366"></a><span class="lineno"> 2366</span>&#160; <span class="keywordflow">if</span>(parameter_pt!=this-&gt;<a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a783cd0439da3951032dcf984d7c98433">re_pt</a>())</div>
<div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160;  {</div>
<div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160;   std::ostringstream error_stream;</div>
<div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160;   error_stream &lt;&lt; </div>
<div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160;    <span class="stringliteral">&quot;Cannot compute analytic jacobian for parameter addressed by &quot;</span> </div>
<div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160;                &lt;&lt; parameter_pt &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l02372"></a><span class="lineno"> 2372</span>&#160;   error_stream &lt;&lt; <span class="stringliteral">&quot;Can only compute derivatives wrt Re (&quot;</span></div>
<div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160;                &lt;&lt; <a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a623385a5197597302d8fcb21e201c50a">Re_pt</a> &lt;&lt; <span class="stringliteral">&quot;)\n&quot;</span>;</div>
<div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160;   <span class="keywordflow">throw</span> <a class="code" href="classoomph_1_1OomphLibError.html">OomphLibError</a>(</div>
<div class="line"><a name="l02375"></a><span class="lineno"> 2375</span>&#160;      error_stream.str(),</div>
<div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160;      OOMPH_CURRENT_FUNCTION,</div>
<div class="line"><a name="l02377"></a><span class="lineno"> 2377</span>&#160;      OOMPH_EXCEPTION_LOCATION);</div>
<div class="line"><a name="l02378"></a><span class="lineno"> 2378</span>&#160;  }</div>
<div class="line"><a name="l02379"></a><span class="lineno"> 2379</span>&#160; </div>
<div class="line"><a name="l02380"></a><span class="lineno"> 2380</span>&#160; <span class="comment">//Which parameters are we differentiating with respect to</span></div>
<div class="line"><a name="l02381"></a><span class="lineno"> 2381</span>&#160; <span class="keywordtype">bool</span> diff_re = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02382"></a><span class="lineno"> 2382</span>&#160; <span class="keywordtype">bool</span> diff_re_st = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02383"></a><span class="lineno"> 2383</span>&#160; <span class="keywordtype">bool</span> diff_re_inv_fr = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02384"></a><span class="lineno"> 2384</span>&#160; <span class="keywordtype">bool</span> diff_re_inv_ro = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02385"></a><span class="lineno"> 2385</span>&#160; </div>
<div class="line"><a name="l02386"></a><span class="lineno"> 2386</span>&#160; <span class="comment">//Set the boolean flags according to the parameter pointer</span></div>
<div class="line"><a name="l02387"></a><span class="lineno"> 2387</span>&#160; <span class="keywordflow">if</span>(parameter_pt==this-&gt;<a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a783cd0439da3951032dcf984d7c98433">re_pt</a>()) {diff_re = <span class="keyword">true</span>;}</div>
<div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160; <span class="keywordflow">if</span>(parameter_pt==this-&gt;<a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a64f354d90dcae78352e08b369a4c2a02">re_st_pt</a>()) {diff_re_st = <span class="keyword">true</span>;}</div>
<div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160; <span class="keywordflow">if</span>(parameter_pt==this-&gt;<a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a2b2641a17d3406043cdf535fb6ede367">re_invfr_pt</a>()) {diff_re_inv_fr = <span class="keyword">true</span>;}</div>
<div class="line"><a name="l02390"></a><span class="lineno"> 2390</span>&#160; <span class="keywordflow">if</span>(parameter_pt==this-&gt;<a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a5f10cf57b03c4a76b70151df35a249e3">re_invro_pt</a>()) {diff_re_inv_ro = <span class="keyword">true</span>;}</div>
<div class="line"><a name="l02391"></a><span class="lineno"> 2391</span>&#160; </div>
<div class="line"><a name="l02392"></a><span class="lineno"> 2392</span>&#160; </div>
<div class="line"><a name="l02393"></a><span class="lineno"> 2393</span>&#160; <span class="comment">//Find out how many nodes there are</span></div>
<div class="line"><a name="l02394"></a><span class="lineno"> 2394</span>&#160; <span class="keywordtype">unsigned</span> n_node = <a class="code" href="classoomph_1_1FiniteElement.html#a6219ed269a6d89b5aa14659cce48905a">nnode</a>();</div>
<div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160; </div>
<div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160; <span class="comment">//Find out how many pressure dofs there are</span></div>
<div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160; <span class="keywordtype">unsigned</span> n_pres = <a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a89edaffb4913131cc14a5f6e45ed117a">npres_axi_nst</a>();</div>
<div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160; </div>
<div class="line"><a name="l02399"></a><span class="lineno"> 2399</span>&#160; <span class="comment">//Get the nodal indices at which the velocity is stored</span></div>
<div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160; <span class="keywordtype">unsigned</span> u_nodal_index[3];</div>
<div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160; <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;3;++<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>) {u_nodal_index[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] = <a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#afbdea50fcf4799e2e4e5209ee3249bf0">u_index_axi_nst</a>(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>);}</div>
<div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160; </div>
<div class="line"><a name="l02403"></a><span class="lineno"> 2403</span>&#160; <span class="comment">//Set up memory for the shape and test functions</span></div>
<div class="line"><a name="l02404"></a><span class="lineno"> 2404</span>&#160; <span class="comment">//Note that there are only two dimensions, r and z in this problem</span></div>
<div class="line"><a name="l02405"></a><span class="lineno"> 2405</span>&#160; <a class="code" href="classoomph_1_1Shape.html">Shape</a> psif(n_node), testf(n_node);</div>
<div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160; <a class="code" href="classoomph_1_1DShape.html">DShape</a> dpsifdx(n_node,2), dtestfdx(n_node,2);</div>
<div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160;   </div>
<div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160; <span class="comment">//Set up memory for pressure shape and test functions</span></div>
<div class="line"><a name="l02409"></a><span class="lineno"> 2409</span>&#160; <a class="code" href="classoomph_1_1Shape.html">Shape</a> psip(n_pres), testp(n_pres);</div>
<div class="line"><a name="l02410"></a><span class="lineno"> 2410</span>&#160; </div>
<div class="line"><a name="l02411"></a><span class="lineno"> 2411</span>&#160; <span class="comment">//Number of integration points</span></div>
<div class="line"><a name="l02412"></a><span class="lineno"> 2412</span>&#160; <span class="keywordtype">unsigned</span> Nintpt = <a class="code" href="classoomph_1_1FiniteElement.html#a79f1710873332823c47023d370f0596b">integral_pt</a>()-&gt;<a class="code" href="classoomph_1_1Integral.html#a1a270de9d99a1fcf1d25a6c1017f65fa">nweight</a>();</div>
<div class="line"><a name="l02413"></a><span class="lineno"> 2413</span>&#160;   </div>
<div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160; <span class="comment">//Set the Vector to hold local coordinates (two dimensions)</span></div>
<div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160; <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>(2);</div>
<div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160; </div>
<div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160; <span class="comment">//Get Physical Variables from Element</span></div>
<div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160; <span class="comment">//Reynolds number must be multiplied by the density ratio</span></div>
<div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160; <span class="comment">//double scaled_re = re()*density_ratio();</span></div>
<div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160; <span class="comment">//double scaled_re_st = re_st()*density_ratio();</span></div>
<div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160; <span class="comment">//double scaled_re_inv_fr = re_invfr()*density_ratio();</span></div>
<div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160; <span class="comment">//double scaled_re_inv_ro = re_invro()*density_ratio();</span></div>
<div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160; <span class="keywordtype">double</span> dens_ratio = this-&gt;<a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a26df65fe19563b703fe274179e829900">density_ratio</a>();</div>
<div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160; <span class="comment">// double visc_ratio = viscosity_ratio();</span></div>
<div class="line"><a name="l02425"></a><span class="lineno"> 2425</span>&#160; <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> G = <a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a518c31629e6ef42334cd031e2901efea">g</a>();</div>
<div class="line"><a name="l02426"></a><span class="lineno"> 2426</span>&#160; </div>
<div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160; <span class="comment">//Integers used to store the local equation and unknown numbers</span></div>
<div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160; <span class="keywordtype">int</span> local_eqn=0, local_unknown=0;</div>
<div class="line"><a name="l02429"></a><span class="lineno"> 2429</span>&#160; </div>
<div class="line"><a name="l02430"></a><span class="lineno"> 2430</span>&#160; <span class="comment">//Loop over the integration points</span></div>
<div class="line"><a name="l02431"></a><span class="lineno"> 2431</span>&#160; <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> ipt=0;ipt&lt;Nintpt;ipt++)</div>
<div class="line"><a name="l02432"></a><span class="lineno"> 2432</span>&#160;  {</div>
<div class="line"><a name="l02433"></a><span class="lineno"> 2433</span>&#160;   <span class="comment">//Assign values of s</span></div>
<div class="line"><a name="l02434"></a><span class="lineno"> 2434</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;2;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++) <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] = <a class="code" href="classoomph_1_1FiniteElement.html#a79f1710873332823c47023d370f0596b">integral_pt</a>()-&gt;<a class="code" href="classoomph_1_1Integral.html#a1a2122f99a87c18649bafdd9ed739758">knot</a>(ipt,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>);</div>
<div class="line"><a name="l02435"></a><span class="lineno"> 2435</span>&#160;   <span class="comment">//Get the integral weight</span></div>
<div class="line"><a name="l02436"></a><span class="lineno"> 2436</span>&#160;   <span class="keywordtype">double</span> w = <a class="code" href="classoomph_1_1FiniteElement.html#a79f1710873332823c47023d370f0596b">integral_pt</a>()-&gt;<a class="code" href="classoomph_1_1Integral.html#ac65335e2aab120b285b3d6c294507b06">weight</a>(ipt);</div>
<div class="line"><a name="l02437"></a><span class="lineno"> 2437</span>&#160;   </div>
<div class="line"><a name="l02438"></a><span class="lineno"> 2438</span>&#160;   <span class="comment">//Call the derivatives of the shape and test functions</span></div>
<div class="line"><a name="l02439"></a><span class="lineno"> 2439</span>&#160;   <span class="keywordtype">double</span> J = </div>
<div class="line"><a name="l02440"></a><span class="lineno"> 2440</span>&#160;    <a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a76e090fdac4507d10eb9f81feb53a51b">dshape_and_dtest_eulerian_at_knot_axi_nst</a>(ipt,psif,dpsifdx,testf,dtestfdx);</div>
<div class="line"><a name="l02441"></a><span class="lineno"> 2441</span>&#160;   </div>
<div class="line"><a name="l02442"></a><span class="lineno"> 2442</span>&#160;   <span class="comment">//Call the pressure shape and test functions</span></div>
<div class="line"><a name="l02443"></a><span class="lineno"> 2443</span>&#160;   <a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a6309780fd1964c4df0cca0818ccff158">pshape_axi_nst</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,psip,testp);</div>
<div class="line"><a name="l02444"></a><span class="lineno"> 2444</span>&#160;   </div>
<div class="line"><a name="l02445"></a><span class="lineno"> 2445</span>&#160;   <span class="comment">//Premultiply the weights and the Jacobian</span></div>
<div class="line"><a name="l02446"></a><span class="lineno"> 2446</span>&#160;   <span class="keywordtype">double</span> <a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a> = w*J;</div>
<div class="line"><a name="l02447"></a><span class="lineno"> 2447</span>&#160; </div>
<div class="line"><a name="l02448"></a><span class="lineno"> 2448</span>&#160;   <span class="comment">//Allocate storage for the position and the derivative of the </span></div>
<div class="line"><a name="l02449"></a><span class="lineno"> 2449</span>&#160;   <span class="comment">//mesh positions wrt time</span></div>
<div class="line"><a name="l02450"></a><span class="lineno"> 2450</span>&#160;   <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> <a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>(2,0.0);</div>
<div class="line"><a name="l02451"></a><span class="lineno"> 2451</span>&#160;   <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> mesh_velocity(2,0.0);</div>
<div class="line"><a name="l02452"></a><span class="lineno"> 2452</span>&#160;   <span class="comment">//Allocate storage for the pressure, velocity components and their</span></div>
<div class="line"><a name="l02453"></a><span class="lineno"> 2453</span>&#160;   <span class="comment">//time and spatial derivatives</span></div>
<div class="line"><a name="l02454"></a><span class="lineno"> 2454</span>&#160;   <span class="keywordtype">double</span> interpolated_p=0.0;</div>
<div class="line"><a name="l02455"></a><span class="lineno"> 2455</span>&#160;   <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> <a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>(3,0.0);</div>
<div class="line"><a name="l02456"></a><span class="lineno"> 2456</span>&#160;   <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> dudt(3,0.0);</div>
<div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160;   <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> interpolated_dudx(3,2,0.0);</div>
<div class="line"><a name="l02458"></a><span class="lineno"> 2458</span>&#160;   </div>
<div class="line"><a name="l02459"></a><span class="lineno"> 2459</span>&#160;   <span class="comment">//Calculate pressure at integration point</span></div>
<div class="line"><a name="l02460"></a><span class="lineno"> 2460</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l=0;l&lt;n_pres;l++) {interpolated_p += <a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a3aa173227f477a40fb4adba84a337f5b">p_axi_nst</a>(l)*psip[l];}</div>
<div class="line"><a name="l02461"></a><span class="lineno"> 2461</span>&#160;   </div>
<div class="line"><a name="l02462"></a><span class="lineno"> 2462</span>&#160;   <span class="comment">//Calculate velocities and derivatives at integration point</span></div>
<div class="line"><a name="l02463"></a><span class="lineno"> 2463</span>&#160; </div>
<div class="line"><a name="l02464"></a><span class="lineno"> 2464</span>&#160;   <span class="comment">// Loop over nodes</span></div>
<div class="line"><a name="l02465"></a><span class="lineno"> 2465</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l=0;l&lt;n_node;l++) </div>
<div class="line"><a name="l02466"></a><span class="lineno"> 2466</span>&#160;    {</div>
<div class="line"><a name="l02467"></a><span class="lineno"> 2467</span>&#160;     <span class="comment">//Cache the shape function</span></div>
<div class="line"><a name="l02468"></a><span class="lineno"> 2468</span>&#160;     <span class="keyword">const</span> <span class="keywordtype">double</span> psif_ = psif(l);</div>
<div class="line"><a name="l02469"></a><span class="lineno"> 2469</span>&#160;     <span class="comment">//Loop over the two coordinate directions</span></div>
<div class="line"><a name="l02470"></a><span class="lineno"> 2470</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;2;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l02471"></a><span class="lineno"> 2471</span>&#160;      {</div>
<div class="line"><a name="l02472"></a><span class="lineno"> 2472</span>&#160;       <a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] += this-&gt;<a class="code" href="classoomph_1_1FiniteElement.html#abe831900a6d6a08ee4a43fd9c07af32e">raw_nodal_position</a>(l,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>)*psif_;</div>
<div class="line"><a name="l02473"></a><span class="lineno"> 2473</span>&#160;      }</div>
<div class="line"><a name="l02474"></a><span class="lineno"> 2474</span>&#160;       <span class="comment">//mesh_velocity[i]  += dnodal_position_dt(l,i)*psif[l];</span></div>
<div class="line"><a name="l02475"></a><span class="lineno"> 2475</span>&#160; </div>
<div class="line"><a name="l02476"></a><span class="lineno"> 2476</span>&#160;     <span class="comment">//Loop over the three velocity directions</span></div>
<div class="line"><a name="l02477"></a><span class="lineno"> 2477</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;3;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l02478"></a><span class="lineno"> 2478</span>&#160;      {</div>
<div class="line"><a name="l02479"></a><span class="lineno"> 2479</span>&#160;       <span class="comment">//Get the u_value</span></div>
<div class="line"><a name="l02480"></a><span class="lineno"> 2480</span>&#160;       <span class="keyword">const</span> <span class="keywordtype">double</span> u_value = this-&gt;<a class="code" href="classoomph_1_1FiniteElement.html#abdc430bef622e0257397407416e6aac8">raw_nodal_value</a>(l,u_nodal_index[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]);</div>
<div class="line"><a name="l02481"></a><span class="lineno"> 2481</span>&#160;       <a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] += u_value*psif_;</div>
<div class="line"><a name="l02482"></a><span class="lineno"> 2482</span>&#160;       dudt[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]+= <a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a80b3415e150243f8fff3f8eb87082b24">du_dt_axi_nst</a>(l,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>)*psif_;</div>
<div class="line"><a name="l02483"></a><span class="lineno"> 2483</span>&#160;       <span class="comment">//Loop over derivative directions</span></div>
<div class="line"><a name="l02484"></a><span class="lineno"> 2484</span>&#160;       <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> j=0;j&lt;2;j++)</div>
<div class="line"><a name="l02485"></a><span class="lineno"> 2485</span>&#160;        {interpolated_dudx(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>,j) += u_value*dpsifdx(l,j);}</div>
<div class="line"><a name="l02486"></a><span class="lineno"> 2486</span>&#160;      }</div>
<div class="line"><a name="l02487"></a><span class="lineno"> 2487</span>&#160;    }</div>
<div class="line"><a name="l02488"></a><span class="lineno"> 2488</span>&#160; </div>
<div class="line"><a name="l02489"></a><span class="lineno"> 2489</span>&#160;   <span class="comment">//Get the mesh velocity if ALE is enabled</span></div>
<div class="line"><a name="l02490"></a><span class="lineno"> 2490</span>&#160;   <span class="keywordflow">if</span>(!<a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a97f46e5472537187107d0454b6013b5f">ALE_is_disabled</a>)</div>
<div class="line"><a name="l02491"></a><span class="lineno"> 2491</span>&#160;    {</div>
<div class="line"><a name="l02492"></a><span class="lineno"> 2492</span>&#160;     <span class="comment">// Loop over nodes</span></div>
<div class="line"><a name="l02493"></a><span class="lineno"> 2493</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l=0;l&lt;n_node;l++) </div>
<div class="line"><a name="l02494"></a><span class="lineno"> 2494</span>&#160;      {</div>
<div class="line"><a name="l02495"></a><span class="lineno"> 2495</span>&#160;       <span class="comment">//Loop over the two coordinate directions</span></div>
<div class="line"><a name="l02496"></a><span class="lineno"> 2496</span>&#160;       <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;2;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l02497"></a><span class="lineno"> 2497</span>&#160;        {</div>
<div class="line"><a name="l02498"></a><span class="lineno"> 2498</span>&#160;         mesh_velocity[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]  += this-&gt;<a class="code" href="classoomph_1_1FiniteElement.html#aaaa11f3783ab48d882ac1858d74adba4">raw_dnodal_position_dt</a>(l,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>)*psif(l);</div>
<div class="line"><a name="l02499"></a><span class="lineno"> 2499</span>&#160;        }</div>
<div class="line"><a name="l02500"></a><span class="lineno"> 2500</span>&#160;      }</div>
<div class="line"><a name="l02501"></a><span class="lineno"> 2501</span>&#160;    }</div>
<div class="line"><a name="l02502"></a><span class="lineno"> 2502</span>&#160;       </div>
<div class="line"><a name="l02503"></a><span class="lineno"> 2503</span>&#160;   </div>
<div class="line"><a name="l02504"></a><span class="lineno"> 2504</span>&#160;   <span class="comment">//Get the user-defined body force terms</span></div>
<div class="line"><a name="l02505"></a><span class="lineno"> 2505</span>&#160;   <span class="comment">//Vector&lt;double&gt; body_force(3);</span></div>
<div class="line"><a name="l02506"></a><span class="lineno"> 2506</span>&#160;   <span class="comment">//get_body_force(time(),ipt,interpolated_x,body_force);</span></div>
<div class="line"><a name="l02507"></a><span class="lineno"> 2507</span>&#160;   </div>
<div class="line"><a name="l02508"></a><span class="lineno"> 2508</span>&#160;   <span class="comment">//Get the user-defined source function</span></div>
<div class="line"><a name="l02509"></a><span class="lineno"> 2509</span>&#160;   <span class="comment">//double source = get_source_fct(time(),ipt,interpolated_x);</span></div>
<div class="line"><a name="l02510"></a><span class="lineno"> 2510</span>&#160; </div>
<div class="line"><a name="l02511"></a><span class="lineno"> 2511</span>&#160;   <span class="comment">//Get the user-defined viscosity function</span></div>
<div class="line"><a name="l02512"></a><span class="lineno"> 2512</span>&#160;   <span class="keywordtype">double</span> visc_ratio; </div>
<div class="line"><a name="l02513"></a><span class="lineno"> 2513</span>&#160;   <a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a6b75b0e3184053cbf32458df944ec330">get_viscosity_ratio_axisym_nst</a>(ipt,</div>
<div class="line"><a name="l02514"></a><span class="lineno"> 2514</span>&#160;                                  <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>, </div>
<div class="line"><a name="l02515"></a><span class="lineno"> 2515</span>&#160;                                  <a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>,</div>
<div class="line"><a name="l02516"></a><span class="lineno"> 2516</span>&#160;                                  visc_ratio);</div>
<div class="line"><a name="l02517"></a><span class="lineno"> 2517</span>&#160; </div>
<div class="line"><a name="l02518"></a><span class="lineno"> 2518</span>&#160;   <span class="comment">//r is the first position component</span></div>
<div class="line"><a name="l02519"></a><span class="lineno"> 2519</span>&#160;   <span class="keywordtype">double</span> r = <a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>[0];</div>
<div class="line"><a name="l02520"></a><span class="lineno"> 2520</span>&#160; </div>
<div class="line"><a name="l02521"></a><span class="lineno"> 2521</span>&#160; </div>
<div class="line"><a name="l02522"></a><span class="lineno"> 2522</span>&#160;   <span class="comment">//MOMENTUM EQUATIONS</span></div>
<div class="line"><a name="l02523"></a><span class="lineno"> 2523</span>&#160;   <span class="comment">//------------------</span></div>
<div class="line"><a name="l02524"></a><span class="lineno"> 2524</span>&#160;   </div>
<div class="line"><a name="l02525"></a><span class="lineno"> 2525</span>&#160;   <span class="comment">//Loop over the test functions</span></div>
<div class="line"><a name="l02526"></a><span class="lineno"> 2526</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l=0;l&lt;n_node;l++)</div>
<div class="line"><a name="l02527"></a><span class="lineno"> 2527</span>&#160;    {</div>
<div class="line"><a name="l02528"></a><span class="lineno"> 2528</span>&#160; </div>
<div class="line"><a name="l02529"></a><span class="lineno"> 2529</span>&#160;     <span class="comment">//FIRST (RADIAL) MOMENTUM EQUATION</span></div>
<div class="line"><a name="l02530"></a><span class="lineno"> 2530</span>&#160;     local_eqn = <a class="code" href="classoomph_1_1FiniteElement.html#a5da80bbed97543e586f698251d67941d">nodal_local_eqn</a>(l,u_nodal_index[0]);</div>
<div class="line"><a name="l02531"></a><span class="lineno"> 2531</span>&#160;     <span class="comment">//If it&#39;s not a boundary condition</span></div>
<div class="line"><a name="l02532"></a><span class="lineno"> 2532</span>&#160;     <span class="keywordflow">if</span>(local_eqn &gt;= 0)</div>
<div class="line"><a name="l02533"></a><span class="lineno"> 2533</span>&#160;      {</div>
<div class="line"><a name="l02534"></a><span class="lineno"> 2534</span>&#160;       <span class="comment">//No user-defined body force terms</span></div>
<div class="line"><a name="l02535"></a><span class="lineno"> 2535</span>&#160;       <span class="comment">//dres_dparam[local_eqn] += </span></div>
<div class="line"><a name="l02536"></a><span class="lineno"> 2536</span>&#160;       <span class="comment">// r*body_force[0]*testf[l]*W;</span></div>
<div class="line"><a name="l02537"></a><span class="lineno"> 2537</span>&#160; </div>
<div class="line"><a name="l02538"></a><span class="lineno"> 2538</span>&#160;       <span class="comment">//Add the gravitational body force term if the reynolds number</span></div>
<div class="line"><a name="l02539"></a><span class="lineno"> 2539</span>&#160;       <span class="comment">//is equal to re_inv_fr</span></div>
<div class="line"><a name="l02540"></a><span class="lineno"> 2540</span>&#160;       <span class="keywordflow">if</span>(diff_re_inv_fr)</div>
<div class="line"><a name="l02541"></a><span class="lineno"> 2541</span>&#160;        {</div>
<div class="line"><a name="l02542"></a><span class="lineno"> 2542</span>&#160;         dres_dparam[local_eqn] += r*dens_ratio*testf[l]*G[0]*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l02543"></a><span class="lineno"> 2543</span>&#160;        }</div>
<div class="line"><a name="l02544"></a><span class="lineno"> 2544</span>&#160; </div>
<div class="line"><a name="l02545"></a><span class="lineno"> 2545</span>&#160;       <span class="comment">//No pressure gradient term</span></div>
<div class="line"><a name="l02546"></a><span class="lineno"> 2546</span>&#160;       <span class="comment">//residuals[local_eqn]  += </span></div>
<div class="line"><a name="l02547"></a><span class="lineno"> 2547</span>&#160;       <span class="comment">// interpolated_p*(testf[l] + r*dtestfdx(l,0))*W;</span></div>
<div class="line"><a name="l02548"></a><span class="lineno"> 2548</span>&#160;       </div>
<div class="line"><a name="l02549"></a><span class="lineno"> 2549</span>&#160;       <span class="comment">//No in the stress tensor terms</span></div>
<div class="line"><a name="l02550"></a><span class="lineno"> 2550</span>&#160;       <span class="comment">//The viscosity ratio needs to go in here to ensure</span></div>
<div class="line"><a name="l02551"></a><span class="lineno"> 2551</span>&#160;       <span class="comment">//continuity of normal stress is satisfied even in flows</span></div>
<div class="line"><a name="l02552"></a><span class="lineno"> 2552</span>&#160;       <span class="comment">//with zero pressure gradient!</span></div>
<div class="line"><a name="l02553"></a><span class="lineno"> 2553</span>&#160;       <span class="comment">//residuals[local_eqn] -= visc_ratio*</span></div>
<div class="line"><a name="l02554"></a><span class="lineno"> 2554</span>&#160;       <span class="comment">// r*(1.0+Gamma[0])*interpolated_dudx(0,0)*dtestfdx(l,0)*W;</span></div>
<div class="line"><a name="l02555"></a><span class="lineno"> 2555</span>&#160;       </div>
<div class="line"><a name="l02556"></a><span class="lineno"> 2556</span>&#160;       <span class="comment">//residuals[local_eqn] -= visc_ratio*r*</span></div>
<div class="line"><a name="l02557"></a><span class="lineno"> 2557</span>&#160;       <span class="comment">// (interpolated_dudx(0,1) + Gamma[0]*interpolated_dudx(1,0))*</span></div>
<div class="line"><a name="l02558"></a><span class="lineno"> 2558</span>&#160;       <span class="comment">// dtestfdx(l,1)*W;</span></div>
<div class="line"><a name="l02559"></a><span class="lineno"> 2559</span>&#160; </div>
<div class="line"><a name="l02560"></a><span class="lineno"> 2560</span>&#160;       <span class="comment">//residuals[local_eqn] -= </span></div>
<div class="line"><a name="l02561"></a><span class="lineno"> 2561</span>&#160;       <span class="comment">// visc_ratio*(1.0 + Gamma[0])*interpolated_u[0]*testf[l]*W/r;</span></div>
<div class="line"><a name="l02562"></a><span class="lineno"> 2562</span>&#160;       </div>
<div class="line"><a name="l02563"></a><span class="lineno"> 2563</span>&#160;       <span class="comment">//Add in the inertial terms</span></div>
<div class="line"><a name="l02564"></a><span class="lineno"> 2564</span>&#160;       <span class="comment">//du/dt term</span></div>
<div class="line"><a name="l02565"></a><span class="lineno"> 2565</span>&#160;       <span class="keywordflow">if</span>(diff_re_st)</div>
<div class="line"><a name="l02566"></a><span class="lineno"> 2566</span>&#160;        {</div>
<div class="line"><a name="l02567"></a><span class="lineno"> 2567</span>&#160;         dres_dparam[local_eqn] -= dens_ratio*r*dudt[0]*testf[l]*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l02568"></a><span class="lineno"> 2568</span>&#160;        }</div>
<div class="line"><a name="l02569"></a><span class="lineno"> 2569</span>&#160; </div>
<div class="line"><a name="l02570"></a><span class="lineno"> 2570</span>&#160;       <span class="comment">//Convective terms</span></div>
<div class="line"><a name="l02571"></a><span class="lineno"> 2571</span>&#160;       <span class="keywordflow">if</span>(diff_re)</div>
<div class="line"><a name="l02572"></a><span class="lineno"> 2572</span>&#160;        {</div>
<div class="line"><a name="l02573"></a><span class="lineno"> 2573</span>&#160;         dres_dparam[local_eqn] -= </div>
<div class="line"><a name="l02574"></a><span class="lineno"> 2574</span>&#160;          dens_ratio*(r*<a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>[0]*interpolated_dudx(0,0) </div>
<div class="line"><a name="l02575"></a><span class="lineno"> 2575</span>&#160;                    - <a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>[2]*<a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>[2] </div>
<div class="line"><a name="l02576"></a><span class="lineno"> 2576</span>&#160;                      + r*<a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>[1]*interpolated_dudx(0,1))*testf[l]*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l02577"></a><span class="lineno"> 2577</span>&#160;        }</div>
<div class="line"><a name="l02578"></a><span class="lineno"> 2578</span>&#160; </div>
<div class="line"><a name="l02579"></a><span class="lineno"> 2579</span>&#160;       <span class="comment">//Mesh velocity terms</span></div>
<div class="line"><a name="l02580"></a><span class="lineno"> 2580</span>&#160;       <span class="keywordflow">if</span>(!<a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a97f46e5472537187107d0454b6013b5f">ALE_is_disabled</a>)</div>
<div class="line"><a name="l02581"></a><span class="lineno"> 2581</span>&#160;        {</div>
<div class="line"><a name="l02582"></a><span class="lineno"> 2582</span>&#160;         <span class="keywordflow">if</span>(diff_re_st)</div>
<div class="line"><a name="l02583"></a><span class="lineno"> 2583</span>&#160;          {</div>
<div class="line"><a name="l02584"></a><span class="lineno"> 2584</span>&#160;           <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> k=0;k&lt;2;k++)</div>
<div class="line"><a name="l02585"></a><span class="lineno"> 2585</span>&#160;            {</div>
<div class="line"><a name="l02586"></a><span class="lineno"> 2586</span>&#160;             dres_dparam[local_eqn] += </div>
<div class="line"><a name="l02587"></a><span class="lineno"> 2587</span>&#160;              dens_ratio*r*mesh_velocity[k]*interpolated_dudx(0,k)*testf[l]*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l02588"></a><span class="lineno"> 2588</span>&#160;            }</div>
<div class="line"><a name="l02589"></a><span class="lineno"> 2589</span>&#160;          }</div>
<div class="line"><a name="l02590"></a><span class="lineno"> 2590</span>&#160;        }</div>
<div class="line"><a name="l02591"></a><span class="lineno"> 2591</span>&#160; </div>
<div class="line"><a name="l02592"></a><span class="lineno"> 2592</span>&#160;       <span class="comment">//Add the Coriolis term</span></div>
<div class="line"><a name="l02593"></a><span class="lineno"> 2593</span>&#160;       <span class="keywordflow">if</span>(diff_re_inv_ro)</div>
<div class="line"><a name="l02594"></a><span class="lineno"> 2594</span>&#160;        {</div>
<div class="line"><a name="l02595"></a><span class="lineno"> 2595</span>&#160;         dres_dparam[local_eqn] += </div>
<div class="line"><a name="l02596"></a><span class="lineno"> 2596</span>&#160;          2.0*r*dens_ratio*<a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>[2]*testf[l]*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l02597"></a><span class="lineno"> 2597</span>&#160;        }</div>
<div class="line"><a name="l02598"></a><span class="lineno"> 2598</span>&#160; </div>
<div class="line"><a name="l02599"></a><span class="lineno"> 2599</span>&#160;       <span class="comment">//CALCULATE THE JACOBIAN</span></div>
<div class="line"><a name="l02600"></a><span class="lineno"> 2600</span>&#160;       <span class="keywordflow">if</span>(flag)</div>
<div class="line"><a name="l02601"></a><span class="lineno"> 2601</span>&#160;        {</div>
<div class="line"><a name="l02602"></a><span class="lineno"> 2602</span>&#160;         <span class="comment">//Loop over the velocity shape functions again</span></div>
<div class="line"><a name="l02603"></a><span class="lineno"> 2603</span>&#160;         <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l2=0;l2&lt;n_node;l2++)</div>
<div class="line"><a name="l02604"></a><span class="lineno"> 2604</span>&#160;          { </div>
<div class="line"><a name="l02605"></a><span class="lineno"> 2605</span>&#160;           local_unknown = <a class="code" href="classoomph_1_1FiniteElement.html#a5da80bbed97543e586f698251d67941d">nodal_local_eqn</a>(l2,u_nodal_index[0]);</div>
<div class="line"><a name="l02606"></a><span class="lineno"> 2606</span>&#160;           <span class="comment">//Radial velocity component</span></div>
<div class="line"><a name="l02607"></a><span class="lineno"> 2607</span>&#160;           <span class="keywordflow">if</span>(local_unknown &gt;= 0)</div>
<div class="line"><a name="l02608"></a><span class="lineno"> 2608</span>&#160;            {</div>
<div class="line"><a name="l02609"></a><span class="lineno"> 2609</span>&#160;             <span class="keywordflow">if</span>(flag==2)</div>
<div class="line"><a name="l02610"></a><span class="lineno"> 2610</span>&#160;              {</div>
<div class="line"><a name="l02611"></a><span class="lineno"> 2611</span>&#160;               <span class="keywordflow">if</span>(diff_re_st)</div>
<div class="line"><a name="l02612"></a><span class="lineno"> 2612</span>&#160;                {</div>
<div class="line"><a name="l02613"></a><span class="lineno"> 2613</span>&#160;                 <span class="comment">//Add the mass matrix</span></div>
<div class="line"><a name="l02614"></a><span class="lineno"> 2614</span>&#160;                 dmass_matrix_dparam(local_eqn,local_unknown) +=</div>
<div class="line"><a name="l02615"></a><span class="lineno"> 2615</span>&#160;                  dens_ratio*r*psif[l2]*testf[l]*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l02616"></a><span class="lineno"> 2616</span>&#160;                }</div>
<div class="line"><a name="l02617"></a><span class="lineno"> 2617</span>&#160;              }</div>
<div class="line"><a name="l02618"></a><span class="lineno"> 2618</span>&#160; </div>
<div class="line"><a name="l02619"></a><span class="lineno"> 2619</span>&#160;             <span class="comment">//Add contribution to the Jacobian matrix</span></div>
<div class="line"><a name="l02620"></a><span class="lineno"> 2620</span>&#160;             <span class="comment">//jacobian(local_eqn,local_unknown)</span></div>
<div class="line"><a name="l02621"></a><span class="lineno"> 2621</span>&#160;             <span class="comment">// -= visc_ratio*r*(1.0+Gamma[0])</span></div>
<div class="line"><a name="l02622"></a><span class="lineno"> 2622</span>&#160;             <span class="comment">//*dpsifdx(l2,0)*dtestfdx(l,0)*W;</span></div>
<div class="line"><a name="l02623"></a><span class="lineno"> 2623</span>&#160; </div>
<div class="line"><a name="l02624"></a><span class="lineno"> 2624</span>&#160;             <span class="comment">//jacobian(local_eqn,local_unknown)</span></div>
<div class="line"><a name="l02625"></a><span class="lineno"> 2625</span>&#160;             <span class="comment">// -= visc_ratio*r*dpsifdx(l2,1)*dtestfdx(l,1)*W;</span></div>
<div class="line"><a name="l02626"></a><span class="lineno"> 2626</span>&#160;       </div>
<div class="line"><a name="l02627"></a><span class="lineno"> 2627</span>&#160;             <span class="comment">//jacobian(local_eqn,local_unknown)</span></div>
<div class="line"><a name="l02628"></a><span class="lineno"> 2628</span>&#160;             <span class="comment">// -= visc_ratio*(1.0 + Gamma[0])*psif[l2]*testf[l]*W/r;</span></div>
<div class="line"><a name="l02629"></a><span class="lineno"> 2629</span>&#160;       </div>
<div class="line"><a name="l02630"></a><span class="lineno"> 2630</span>&#160;             <span class="comment">//Add in the inertial terms</span></div>
<div class="line"><a name="l02631"></a><span class="lineno"> 2631</span>&#160;             <span class="comment">//du/dt term</span></div>
<div class="line"><a name="l02632"></a><span class="lineno"> 2632</span>&#160;             <span class="keywordflow">if</span>(diff_re_st)</div>
<div class="line"><a name="l02633"></a><span class="lineno"> 2633</span>&#160;              {</div>
<div class="line"><a name="l02634"></a><span class="lineno"> 2634</span>&#160;               djac_dparam(local_eqn,local_unknown) </div>
<div class="line"><a name="l02635"></a><span class="lineno"> 2635</span>&#160;                -= dens_ratio*r*<a class="code" href="classoomph_1_1FiniteElement.html#ace0e7fb72a805b5c2c600347bfae7a9b">node_pt</a>(l2)-&gt;<a class="code" href="classoomph_1_1Data.html#a5b34970d16205921dca3ada720da8445">time_stepper_pt</a>()-&gt;<a class="code" href="classoomph_1_1TimeStepper.html#a4cb0aecb044b77ba0553cdd54b586d8a">weight</a>(1,0)*</div>
<div class="line"><a name="l02636"></a><span class="lineno"> 2636</span>&#160;                psif[l2]*testf[l]*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l02637"></a><span class="lineno"> 2637</span>&#160;              }</div>
<div class="line"><a name="l02638"></a><span class="lineno"> 2638</span>&#160; </div>
<div class="line"><a name="l02639"></a><span class="lineno"> 2639</span>&#160;             <span class="comment">//Convective terms</span></div>
<div class="line"><a name="l02640"></a><span class="lineno"> 2640</span>&#160;             <span class="keywordflow">if</span>(diff_re)</div>
<div class="line"><a name="l02641"></a><span class="lineno"> 2641</span>&#160;              {</div>
<div class="line"><a name="l02642"></a><span class="lineno"> 2642</span>&#160;               djac_dparam(local_eqn,local_unknown) -=</div>
<div class="line"><a name="l02643"></a><span class="lineno"> 2643</span>&#160;                dens_ratio*(r*psif[l2]*interpolated_dudx(0,0) </div>
<div class="line"><a name="l02644"></a><span class="lineno"> 2644</span>&#160;                            + r*<a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>[0]*dpsifdx(l2,0)</div>
<div class="line"><a name="l02645"></a><span class="lineno"> 2645</span>&#160;                  + r*<a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>[1]*dpsifdx(l2,1))*testf[l]*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l02646"></a><span class="lineno"> 2646</span>&#160;              }</div>
<div class="line"><a name="l02647"></a><span class="lineno"> 2647</span>&#160; </div>
<div class="line"><a name="l02648"></a><span class="lineno"> 2648</span>&#160;             <span class="comment">//Mesh velocity terms</span></div>
<div class="line"><a name="l02649"></a><span class="lineno"> 2649</span>&#160;             <span class="keywordflow">if</span>(!<a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a97f46e5472537187107d0454b6013b5f">ALE_is_disabled</a>)</div>
<div class="line"><a name="l02650"></a><span class="lineno"> 2650</span>&#160;              {</div>
<div class="line"><a name="l02651"></a><span class="lineno"> 2651</span>&#160;               <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> k=0;k&lt;2;k++)</div>
<div class="line"><a name="l02652"></a><span class="lineno"> 2652</span>&#160;                {</div>
<div class="line"><a name="l02653"></a><span class="lineno"> 2653</span>&#160;                 <span class="keywordflow">if</span>(diff_re_st)</div>
<div class="line"><a name="l02654"></a><span class="lineno"> 2654</span>&#160;                  {</div>
<div class="line"><a name="l02655"></a><span class="lineno"> 2655</span>&#160;                   djac_dparam(local_eqn,local_unknown) += </div>
<div class="line"><a name="l02656"></a><span class="lineno"> 2656</span>&#160;                    dens_ratio*r*mesh_velocity[k]*dpsifdx(l2,k)*testf[l]*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l02657"></a><span class="lineno"> 2657</span>&#160;                  }</div>
<div class="line"><a name="l02658"></a><span class="lineno"> 2658</span>&#160;                }</div>
<div class="line"><a name="l02659"></a><span class="lineno"> 2659</span>&#160;              }</div>
<div class="line"><a name="l02660"></a><span class="lineno"> 2660</span>&#160;            }</div>
<div class="line"><a name="l02661"></a><span class="lineno"> 2661</span>&#160; </div>
<div class="line"><a name="l02662"></a><span class="lineno"> 2662</span>&#160;           <span class="comment">//Axial velocity component</span></div>
<div class="line"><a name="l02663"></a><span class="lineno"> 2663</span>&#160;           local_unknown = <a class="code" href="classoomph_1_1FiniteElement.html#a5da80bbed97543e586f698251d67941d">nodal_local_eqn</a>(l2,u_nodal_index[1]);</div>
<div class="line"><a name="l02664"></a><span class="lineno"> 2664</span>&#160;           <span class="keywordflow">if</span>(local_unknown &gt;= 0)</div>
<div class="line"><a name="l02665"></a><span class="lineno"> 2665</span>&#160;            {</div>
<div class="line"><a name="l02666"></a><span class="lineno"> 2666</span>&#160;             <span class="comment">//jacobian(local_eqn,local_unknown) -=</span></div>
<div class="line"><a name="l02667"></a><span class="lineno"> 2667</span>&#160;             <span class="comment">// visc_ratio*r*Gamma[0]*dpsifdx(l2,0)*dtestfdx(l,1)*W;</span></div>
<div class="line"><a name="l02668"></a><span class="lineno"> 2668</span>&#160;             </div>
<div class="line"><a name="l02669"></a><span class="lineno"> 2669</span>&#160;             <span class="comment">//Convective terms</span></div>
<div class="line"><a name="l02670"></a><span class="lineno"> 2670</span>&#160;             <span class="keywordflow">if</span>(diff_re)</div>
<div class="line"><a name="l02671"></a><span class="lineno"> 2671</span>&#160;              {</div>
<div class="line"><a name="l02672"></a><span class="lineno"> 2672</span>&#160;               djac_dparam(local_eqn,local_unknown) -= </div>
<div class="line"><a name="l02673"></a><span class="lineno"> 2673</span>&#160;                dens_ratio*r*psif[l2]*interpolated_dudx(0,1)*testf[l]*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l02674"></a><span class="lineno"> 2674</span>&#160;              }</div>
<div class="line"><a name="l02675"></a><span class="lineno"> 2675</span>&#160;            }</div>
<div class="line"><a name="l02676"></a><span class="lineno"> 2676</span>&#160;           </div>
<div class="line"><a name="l02677"></a><span class="lineno"> 2677</span>&#160;           <span class="comment">//Azimuthal velocity component</span></div>
<div class="line"><a name="l02678"></a><span class="lineno"> 2678</span>&#160;           local_unknown = <a class="code" href="classoomph_1_1FiniteElement.html#a5da80bbed97543e586f698251d67941d">nodal_local_eqn</a>(l2,u_nodal_index[2]);</div>
<div class="line"><a name="l02679"></a><span class="lineno"> 2679</span>&#160;           <span class="keywordflow">if</span>(local_unknown &gt;= 0)</div>
<div class="line"><a name="l02680"></a><span class="lineno"> 2680</span>&#160;            {</div>
<div class="line"><a name="l02681"></a><span class="lineno"> 2681</span>&#160;             <span class="comment">//Convective terms</span></div>
<div class="line"><a name="l02682"></a><span class="lineno"> 2682</span>&#160;             <span class="keywordflow">if</span>(diff_re)</div>
<div class="line"><a name="l02683"></a><span class="lineno"> 2683</span>&#160;              {</div>
<div class="line"><a name="l02684"></a><span class="lineno"> 2684</span>&#160;               djac_dparam(local_eqn,local_unknown) -= </div>
<div class="line"><a name="l02685"></a><span class="lineno"> 2685</span>&#160;                - dens_ratio*2.0*<a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>[2]*psif[l2]*testf[l]*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l02686"></a><span class="lineno"> 2686</span>&#160;              }</div>
<div class="line"><a name="l02687"></a><span class="lineno"> 2687</span>&#160;             <span class="comment">//Coriolis terms</span></div>
<div class="line"><a name="l02688"></a><span class="lineno"> 2688</span>&#160;             <span class="keywordflow">if</span>(diff_re_inv_ro)</div>
<div class="line"><a name="l02689"></a><span class="lineno"> 2689</span>&#160;              {</div>
<div class="line"><a name="l02690"></a><span class="lineno"> 2690</span>&#160;               djac_dparam(local_eqn,local_unknown) +=</div>
<div class="line"><a name="l02691"></a><span class="lineno"> 2691</span>&#160;                2.0*r*dens_ratio*psif[l2]*testf[l]*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l02692"></a><span class="lineno"> 2692</span>&#160;              }</div>
<div class="line"><a name="l02693"></a><span class="lineno"> 2693</span>&#160;            }</div>
<div class="line"><a name="l02694"></a><span class="lineno"> 2694</span>&#160;          }</div>
<div class="line"><a name="l02695"></a><span class="lineno"> 2695</span>&#160;         </div>
<div class="line"><a name="l02696"></a><span class="lineno"> 2696</span>&#160;         <span class="comment">/*Now loop over pressure shape functions*/</span></div>
<div class="line"><a name="l02697"></a><span class="lineno"> 2697</span>&#160;         <span class="comment">/*This is the contribution from pressure gradient*/</span></div>
<div class="line"><a name="l02698"></a><span class="lineno"> 2698</span>&#160;         <span class="comment">//for(unsigned l2=0;l2&lt;n_pres;l2++)</span></div>
<div class="line"><a name="l02699"></a><span class="lineno"> 2699</span>&#160;         <span class="comment">// {</span></div>
<div class="line"><a name="l02700"></a><span class="lineno"> 2700</span>&#160;         <span class="comment">//  local_unknown = p_local_eqn(l2);</span></div>
<div class="line"><a name="l02701"></a><span class="lineno"> 2701</span>&#160;         <span class="comment">//  /*If we are at a non-zero degree of freedom in the entry*/</span></div>
<div class="line"><a name="l02702"></a><span class="lineno"> 2702</span>&#160;         <span class="comment">//  if(local_unknown &gt;= 0)</span></div>
<div class="line"><a name="l02703"></a><span class="lineno"> 2703</span>&#160;         <span class="comment">//   {</span></div>
<div class="line"><a name="l02704"></a><span class="lineno"> 2704</span>&#160;         <span class="comment">//    jacobian(local_eqn,local_unknown)</span></div>
<div class="line"><a name="l02705"></a><span class="lineno"> 2705</span>&#160;         <span class="comment">//     += psip[l2]*(testf[l] + r*dtestfdx(l,0))*W;</span></div>
<div class="line"><a name="l02706"></a><span class="lineno"> 2706</span>&#160;         <span class="comment">//   }</span></div>
<div class="line"><a name="l02707"></a><span class="lineno"> 2707</span>&#160;         <span class="comment">// }</span></div>
<div class="line"><a name="l02708"></a><span class="lineno"> 2708</span>&#160;        } <span class="comment">/*End of Jacobian calculation*/</span></div>
<div class="line"><a name="l02709"></a><span class="lineno"> 2709</span>&#160;       </div>
<div class="line"><a name="l02710"></a><span class="lineno"> 2710</span>&#160;      } <span class="comment">//End of if not boundary condition statement</span></div>
<div class="line"><a name="l02711"></a><span class="lineno"> 2711</span>&#160;       </div>
<div class="line"><a name="l02712"></a><span class="lineno"> 2712</span>&#160;     <span class="comment">//SECOND (AXIAL) MOMENTUM EQUATION</span></div>
<div class="line"><a name="l02713"></a><span class="lineno"> 2713</span>&#160;     local_eqn = <a class="code" href="classoomph_1_1FiniteElement.html#a5da80bbed97543e586f698251d67941d">nodal_local_eqn</a>(l,u_nodal_index[1]);</div>
<div class="line"><a name="l02714"></a><span class="lineno"> 2714</span>&#160;     <span class="comment">//If it&#39;s not a boundary condition</span></div>
<div class="line"><a name="l02715"></a><span class="lineno"> 2715</span>&#160;     <span class="keywordflow">if</span>(local_eqn &gt;= 0)</div>
<div class="line"><a name="l02716"></a><span class="lineno"> 2716</span>&#160;      {</div>
<div class="line"><a name="l02717"></a><span class="lineno"> 2717</span>&#160;       <span class="comment">//Add the user-defined body force terms</span></div>
<div class="line"><a name="l02718"></a><span class="lineno"> 2718</span>&#160;       <span class="comment">//Remember to multiply by the density ratio!</span></div>
<div class="line"><a name="l02719"></a><span class="lineno"> 2719</span>&#160;       <span class="comment">//residuals[local_eqn] += </span></div>
<div class="line"><a name="l02720"></a><span class="lineno"> 2720</span>&#160;       <span class="comment">// r*body_force[1]*testf[l]*W;</span></div>
<div class="line"><a name="l02721"></a><span class="lineno"> 2721</span>&#160;       </div>
<div class="line"><a name="l02722"></a><span class="lineno"> 2722</span>&#160;       <span class="comment">//Add the gravitational body force term</span></div>
<div class="line"><a name="l02723"></a><span class="lineno"> 2723</span>&#160;       <span class="keywordflow">if</span>(diff_re_inv_fr)</div>
<div class="line"><a name="l02724"></a><span class="lineno"> 2724</span>&#160;        {</div>
<div class="line"><a name="l02725"></a><span class="lineno"> 2725</span>&#160;         dres_dparam[local_eqn] += r*dens_ratio*testf[l]*G[1]*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l02726"></a><span class="lineno"> 2726</span>&#160;        }</div>
<div class="line"><a name="l02727"></a><span class="lineno"> 2727</span>&#160;       </div>
<div class="line"><a name="l02728"></a><span class="lineno"> 2728</span>&#160;       <span class="comment">//Add the pressure gradient term</span></div>
<div class="line"><a name="l02729"></a><span class="lineno"> 2729</span>&#160;       <span class="comment">//residuals[local_eqn]  += r*interpolated_p*dtestfdx(l,1)*W;</span></div>
<div class="line"><a name="l02730"></a><span class="lineno"> 2730</span>&#160;       </div>
<div class="line"><a name="l02731"></a><span class="lineno"> 2731</span>&#160;       <span class="comment">//Add in the stress tensor terms</span></div>
<div class="line"><a name="l02732"></a><span class="lineno"> 2732</span>&#160;       <span class="comment">//The viscosity ratio needs to go in here to ensure</span></div>
<div class="line"><a name="l02733"></a><span class="lineno"> 2733</span>&#160;       <span class="comment">//continuity of normal stress is satisfied even in flows</span></div>
<div class="line"><a name="l02734"></a><span class="lineno"> 2734</span>&#160;       <span class="comment">//with zero pressure gradient!</span></div>
<div class="line"><a name="l02735"></a><span class="lineno"> 2735</span>&#160;       <span class="comment">//residuals[local_eqn] -= visc_ratio*</span></div>
<div class="line"><a name="l02736"></a><span class="lineno"> 2736</span>&#160;       <span class="comment">//  r*(interpolated_dudx(1,0) + Gamma[1]*interpolated_dudx(0,1))</span></div>
<div class="line"><a name="l02737"></a><span class="lineno"> 2737</span>&#160;       <span class="comment">// *dtestfdx(l,0)*W;</span></div>
<div class="line"><a name="l02738"></a><span class="lineno"> 2738</span>&#160;       </div>
<div class="line"><a name="l02739"></a><span class="lineno"> 2739</span>&#160;       <span class="comment">//residuals[local_eqn] -= visc_ratio*r*</span></div>
<div class="line"><a name="l02740"></a><span class="lineno"> 2740</span>&#160;       <span class="comment">// (1.0 + Gamma[1])*interpolated_dudx(1,1)*dtestfdx(l,1)*W;</span></div>
<div class="line"><a name="l02741"></a><span class="lineno"> 2741</span>&#160;       </div>
<div class="line"><a name="l02742"></a><span class="lineno"> 2742</span>&#160;       <span class="comment">//Add in the inertial terms</span></div>
<div class="line"><a name="l02743"></a><span class="lineno"> 2743</span>&#160;       <span class="comment">//du/dt term</span></div>
<div class="line"><a name="l02744"></a><span class="lineno"> 2744</span>&#160;       <span class="keywordflow">if</span>(diff_re_st)</div>
<div class="line"><a name="l02745"></a><span class="lineno"> 2745</span>&#160;        {</div>
<div class="line"><a name="l02746"></a><span class="lineno"> 2746</span>&#160;         dres_dparam[local_eqn] -= dens_ratio*r*dudt[1]*testf[l]*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l02747"></a><span class="lineno"> 2747</span>&#160;        }</div>
<div class="line"><a name="l02748"></a><span class="lineno"> 2748</span>&#160; </div>
<div class="line"><a name="l02749"></a><span class="lineno"> 2749</span>&#160;       <span class="comment">//Convective terms</span></div>
<div class="line"><a name="l02750"></a><span class="lineno"> 2750</span>&#160;       <span class="keywordflow">if</span>(diff_re)</div>
<div class="line"><a name="l02751"></a><span class="lineno"> 2751</span>&#160;        {</div>
<div class="line"><a name="l02752"></a><span class="lineno"> 2752</span>&#160;         dres_dparam[local_eqn] -= </div>
<div class="line"><a name="l02753"></a><span class="lineno"> 2753</span>&#160;          dens_ratio*(r*<a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>[0]*interpolated_dudx(1,0) </div>
<div class="line"><a name="l02754"></a><span class="lineno"> 2754</span>&#160;                      + r*<a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>[1]*interpolated_dudx(1,1))*testf[l]*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l02755"></a><span class="lineno"> 2755</span>&#160;        }</div>
<div class="line"><a name="l02756"></a><span class="lineno"> 2756</span>&#160; </div>
<div class="line"><a name="l02757"></a><span class="lineno"> 2757</span>&#160;       <span class="comment">//Mesh velocity terms</span></div>
<div class="line"><a name="l02758"></a><span class="lineno"> 2758</span>&#160;       <span class="keywordflow">if</span>(!<a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a97f46e5472537187107d0454b6013b5f">ALE_is_disabled</a>)</div>
<div class="line"><a name="l02759"></a><span class="lineno"> 2759</span>&#160;        {</div>
<div class="line"><a name="l02760"></a><span class="lineno"> 2760</span>&#160;         <span class="keywordflow">if</span>(diff_re_st)</div>
<div class="line"><a name="l02761"></a><span class="lineno"> 2761</span>&#160;          {</div>
<div class="line"><a name="l02762"></a><span class="lineno"> 2762</span>&#160;           <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> k=0;k&lt;2;k++)</div>
<div class="line"><a name="l02763"></a><span class="lineno"> 2763</span>&#160;            {</div>
<div class="line"><a name="l02764"></a><span class="lineno"> 2764</span>&#160;             dres_dparam[local_eqn] += </div>
<div class="line"><a name="l02765"></a><span class="lineno"> 2765</span>&#160;            dens_ratio*r*mesh_velocity[k]*interpolated_dudx(1,k)*testf[l]*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l02766"></a><span class="lineno"> 2766</span>&#160;            }</div>
<div class="line"><a name="l02767"></a><span class="lineno"> 2767</span>&#160;          }</div>
<div class="line"><a name="l02768"></a><span class="lineno"> 2768</span>&#160;        }</div>
<div class="line"><a name="l02769"></a><span class="lineno"> 2769</span>&#160;       </div>
<div class="line"><a name="l02770"></a><span class="lineno"> 2770</span>&#160;       <span class="comment">//CALCULATE THE JACOBIAN</span></div>
<div class="line"><a name="l02771"></a><span class="lineno"> 2771</span>&#160;       <span class="keywordflow">if</span>(flag)</div>
<div class="line"><a name="l02772"></a><span class="lineno"> 2772</span>&#160;        {</div>
<div class="line"><a name="l02773"></a><span class="lineno"> 2773</span>&#160;         <span class="comment">//Loop over the velocity shape functions again</span></div>
<div class="line"><a name="l02774"></a><span class="lineno"> 2774</span>&#160;         <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l2=0;l2&lt;n_node;l2++)</div>
<div class="line"><a name="l02775"></a><span class="lineno"> 2775</span>&#160;          { </div>
<div class="line"><a name="l02776"></a><span class="lineno"> 2776</span>&#160;           local_unknown = <a class="code" href="classoomph_1_1FiniteElement.html#a5da80bbed97543e586f698251d67941d">nodal_local_eqn</a>(l2,u_nodal_index[0]);</div>
<div class="line"><a name="l02777"></a><span class="lineno"> 2777</span>&#160;           <span class="comment">//Radial velocity component</span></div>
<div class="line"><a name="l02778"></a><span class="lineno"> 2778</span>&#160;           <span class="keywordflow">if</span>(local_unknown &gt;= 0)</div>
<div class="line"><a name="l02779"></a><span class="lineno"> 2779</span>&#160;            {</div>
<div class="line"><a name="l02780"></a><span class="lineno"> 2780</span>&#160;             <span class="comment">//Add in the stress tensor terms</span></div>
<div class="line"><a name="l02781"></a><span class="lineno"> 2781</span>&#160;             <span class="comment">//The viscosity ratio needs to go in here to ensure</span></div>
<div class="line"><a name="l02782"></a><span class="lineno"> 2782</span>&#160;             <span class="comment">//continuity of normal stress is satisfied even in flows</span></div>
<div class="line"><a name="l02783"></a><span class="lineno"> 2783</span>&#160;             <span class="comment">//with zero pressure gradient!</span></div>
<div class="line"><a name="l02784"></a><span class="lineno"> 2784</span>&#160;             <span class="comment">//jacobian(local_eqn,local_unknown) -= </span></div>
<div class="line"><a name="l02785"></a><span class="lineno"> 2785</span>&#160;             <span class="comment">//visc_ratio*r*Gamma[1]*dpsifdx(l2,1)*dtestfdx(l,0)*W;</span></div>
<div class="line"><a name="l02786"></a><span class="lineno"> 2786</span>&#160;       </div>
<div class="line"><a name="l02787"></a><span class="lineno"> 2787</span>&#160;             <span class="comment">//Convective terms</span></div>
<div class="line"><a name="l02788"></a><span class="lineno"> 2788</span>&#160;             <span class="keywordflow">if</span>(diff_re)</div>
<div class="line"><a name="l02789"></a><span class="lineno"> 2789</span>&#160;              {</div>
<div class="line"><a name="l02790"></a><span class="lineno"> 2790</span>&#160;               djac_dparam(local_eqn,local_unknown) -= </div>
<div class="line"><a name="l02791"></a><span class="lineno"> 2791</span>&#160;                dens_ratio*r*psif[l2]*interpolated_dudx(1,0)*testf[l]*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l02792"></a><span class="lineno"> 2792</span>&#160;              }</div>
<div class="line"><a name="l02793"></a><span class="lineno"> 2793</span>&#160;            }</div>
<div class="line"><a name="l02794"></a><span class="lineno"> 2794</span>&#160;           </div>
<div class="line"><a name="l02795"></a><span class="lineno"> 2795</span>&#160;           <span class="comment">//Axial velocity component</span></div>
<div class="line"><a name="l02796"></a><span class="lineno"> 2796</span>&#160;           local_unknown = <a class="code" href="classoomph_1_1FiniteElement.html#a5da80bbed97543e586f698251d67941d">nodal_local_eqn</a>(l2,u_nodal_index[1]);</div>
<div class="line"><a name="l02797"></a><span class="lineno"> 2797</span>&#160;           <span class="keywordflow">if</span>(local_unknown &gt;= 0)</div>
<div class="line"><a name="l02798"></a><span class="lineno"> 2798</span>&#160;            {</div>
<div class="line"><a name="l02799"></a><span class="lineno"> 2799</span>&#160;             <span class="keywordflow">if</span>(flag==2)</div>
<div class="line"><a name="l02800"></a><span class="lineno"> 2800</span>&#160;              {</div>
<div class="line"><a name="l02801"></a><span class="lineno"> 2801</span>&#160;               <span class="keywordflow">if</span>(diff_re_st)</div>
<div class="line"><a name="l02802"></a><span class="lineno"> 2802</span>&#160;                {</div>
<div class="line"><a name="l02803"></a><span class="lineno"> 2803</span>&#160;                 <span class="comment">//Add the mass matrix</span></div>
<div class="line"><a name="l02804"></a><span class="lineno"> 2804</span>&#160;                 dmass_matrix_dparam(local_eqn,local_unknown) +=</div>
<div class="line"><a name="l02805"></a><span class="lineno"> 2805</span>&#160;                  dens_ratio*r*psif[l2]*testf[l]*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l02806"></a><span class="lineno"> 2806</span>&#160;                }</div>
<div class="line"><a name="l02807"></a><span class="lineno"> 2807</span>&#160;              }</div>
<div class="line"><a name="l02808"></a><span class="lineno"> 2808</span>&#160; </div>
<div class="line"><a name="l02809"></a><span class="lineno"> 2809</span>&#160; </div>
<div class="line"><a name="l02810"></a><span class="lineno"> 2810</span>&#160;             <span class="comment">//Add in the stress tensor terms</span></div>
<div class="line"><a name="l02811"></a><span class="lineno"> 2811</span>&#160;             <span class="comment">//The viscosity ratio needs to go in here to ensure</span></div>
<div class="line"><a name="l02812"></a><span class="lineno"> 2812</span>&#160;             <span class="comment">//continuity of normal stress is satisfied even in flows</span></div>
<div class="line"><a name="l02813"></a><span class="lineno"> 2813</span>&#160;             <span class="comment">//with zero pressure gradient!</span></div>
<div class="line"><a name="l02814"></a><span class="lineno"> 2814</span>&#160;             <span class="comment">//jacobian(local_eqn,local_unknown) -= </span></div>
<div class="line"><a name="l02815"></a><span class="lineno"> 2815</span>&#160;             <span class="comment">//visc_ratio*r*dpsifdx(l2,0)*dtestfdx(l,0)*W;</span></div>
<div class="line"><a name="l02816"></a><span class="lineno"> 2816</span>&#160;       </div>
<div class="line"><a name="l02817"></a><span class="lineno"> 2817</span>&#160;             <span class="comment">//jacobian(local_eqn,local_unknown) -= </span></div>
<div class="line"><a name="l02818"></a><span class="lineno"> 2818</span>&#160;             <span class="comment">// visc_ratio*r*(1.0 + Gamma[1])*dpsifdx(l2,1)*</span></div>
<div class="line"><a name="l02819"></a><span class="lineno"> 2819</span>&#160;             <span class="comment">// dtestfdx(l,1)*W;</span></div>
<div class="line"><a name="l02820"></a><span class="lineno"> 2820</span>&#160;       </div>
<div class="line"><a name="l02821"></a><span class="lineno"> 2821</span>&#160;             <span class="comment">//Add in the inertial terms</span></div>
<div class="line"><a name="l02822"></a><span class="lineno"> 2822</span>&#160;             <span class="comment">//du/dt term</span></div>
<div class="line"><a name="l02823"></a><span class="lineno"> 2823</span>&#160;             <span class="keywordflow">if</span>(diff_re_st)</div>
<div class="line"><a name="l02824"></a><span class="lineno"> 2824</span>&#160;              {</div>
<div class="line"><a name="l02825"></a><span class="lineno"> 2825</span>&#160;               djac_dparam(local_eqn,local_unknown) -= </div>
<div class="line"><a name="l02826"></a><span class="lineno"> 2826</span>&#160;                dens_ratio*r*<a class="code" href="classoomph_1_1FiniteElement.html#ace0e7fb72a805b5c2c600347bfae7a9b">node_pt</a>(l2)-&gt;<a class="code" href="classoomph_1_1Data.html#a5b34970d16205921dca3ada720da8445">time_stepper_pt</a>()-&gt;<a class="code" href="classoomph_1_1TimeStepper.html#a4cb0aecb044b77ba0553cdd54b586d8a">weight</a>(1,0)*</div>
<div class="line"><a name="l02827"></a><span class="lineno"> 2827</span>&#160;                psif[l2]*testf[l]*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l02828"></a><span class="lineno"> 2828</span>&#160;              }</div>
<div class="line"><a name="l02829"></a><span class="lineno"> 2829</span>&#160; </div>
<div class="line"><a name="l02830"></a><span class="lineno"> 2830</span>&#160;             <span class="comment">//Convective terms</span></div>
<div class="line"><a name="l02831"></a><span class="lineno"> 2831</span>&#160;             <span class="keywordflow">if</span>(diff_re)</div>
<div class="line"><a name="l02832"></a><span class="lineno"> 2832</span>&#160;              {</div>
<div class="line"><a name="l02833"></a><span class="lineno"> 2833</span>&#160;               djac_dparam(local_eqn,local_unknown) -= </div>
<div class="line"><a name="l02834"></a><span class="lineno"> 2834</span>&#160;                dens_ratio*(r*<a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>[0]*dpsifdx(l2,0) </div>
<div class="line"><a name="l02835"></a><span class="lineno"> 2835</span>&#160;                            + r*psif[l2]*interpolated_dudx(1,1)</div>
<div class="line"><a name="l02836"></a><span class="lineno"> 2836</span>&#160;                            + r*<a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>[1]*dpsifdx(l2,1))*testf[l]*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l02837"></a><span class="lineno"> 2837</span>&#160;              }</div>
<div class="line"><a name="l02838"></a><span class="lineno"> 2838</span>&#160;             </div>
<div class="line"><a name="l02839"></a><span class="lineno"> 2839</span>&#160;             <span class="comment">//Mesh velocity terms</span></div>
<div class="line"><a name="l02840"></a><span class="lineno"> 2840</span>&#160;             <span class="keywordflow">if</span>(!<a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a97f46e5472537187107d0454b6013b5f">ALE_is_disabled</a>)</div>
<div class="line"><a name="l02841"></a><span class="lineno"> 2841</span>&#160;              {</div>
<div class="line"><a name="l02842"></a><span class="lineno"> 2842</span>&#160;               <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> k=0;k&lt;2;k++)</div>
<div class="line"><a name="l02843"></a><span class="lineno"> 2843</span>&#160;                {</div>
<div class="line"><a name="l02844"></a><span class="lineno"> 2844</span>&#160;                 <span class="keywordflow">if</span>(diff_re_st)</div>
<div class="line"><a name="l02845"></a><span class="lineno"> 2845</span>&#160;                  {</div>
<div class="line"><a name="l02846"></a><span class="lineno"> 2846</span>&#160;                   djac_dparam(local_eqn,local_unknown) += </div>
<div class="line"><a name="l02847"></a><span class="lineno"> 2847</span>&#160;                    dens_ratio*r*mesh_velocity[k]*dpsifdx(l2,k)*testf[l]*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l02848"></a><span class="lineno"> 2848</span>&#160;                  }</div>
<div class="line"><a name="l02849"></a><span class="lineno"> 2849</span>&#160;                }</div>
<div class="line"><a name="l02850"></a><span class="lineno"> 2850</span>&#160;              }</div>
<div class="line"><a name="l02851"></a><span class="lineno"> 2851</span>&#160;            }</div>
<div class="line"><a name="l02852"></a><span class="lineno"> 2852</span>&#160;           </div>
<div class="line"><a name="l02853"></a><span class="lineno"> 2853</span>&#160;           <span class="comment">//There are no azimithal terms in the axial momentum equation</span></div>
<div class="line"><a name="l02854"></a><span class="lineno"> 2854</span>&#160;          } <span class="comment">//End of loop over velocity shape functions</span></div>
<div class="line"><a name="l02855"></a><span class="lineno"> 2855</span>&#160; </div>
<div class="line"><a name="l02856"></a><span class="lineno"> 2856</span>&#160;        } <span class="comment">/*End of Jacobian calculation*/</span></div>
<div class="line"><a name="l02857"></a><span class="lineno"> 2857</span>&#160;       </div>
<div class="line"><a name="l02858"></a><span class="lineno"> 2858</span>&#160;      } <span class="comment">//End of AXIAL MOMENTUM EQUATION</span></div>
<div class="line"><a name="l02859"></a><span class="lineno"> 2859</span>&#160; </div>
<div class="line"><a name="l02860"></a><span class="lineno"> 2860</span>&#160;     <span class="comment">//THIRD (AZIMUTHAL) MOMENTUM EQUATION</span></div>
<div class="line"><a name="l02861"></a><span class="lineno"> 2861</span>&#160;     local_eqn = <a class="code" href="classoomph_1_1FiniteElement.html#a5da80bbed97543e586f698251d67941d">nodal_local_eqn</a>(l,u_nodal_index[2]);</div>
<div class="line"><a name="l02862"></a><span class="lineno"> 2862</span>&#160;     <span class="keywordflow">if</span>(local_eqn &gt;= 0)</div>
<div class="line"><a name="l02863"></a><span class="lineno"> 2863</span>&#160;      {</div>
<div class="line"><a name="l02864"></a><span class="lineno"> 2864</span>&#160;       <span class="comment">//Add the user-defined body force terms</span></div>
<div class="line"><a name="l02865"></a><span class="lineno"> 2865</span>&#160;       <span class="comment">//Remember to multiply by the density ratio!</span></div>
<div class="line"><a name="l02866"></a><span class="lineno"> 2866</span>&#160;       <span class="comment">//residuals[local_eqn] += </span></div>
<div class="line"><a name="l02867"></a><span class="lineno"> 2867</span>&#160;       <span class="comment">// r*body_force[2]*testf[l]*W;</span></div>
<div class="line"><a name="l02868"></a><span class="lineno"> 2868</span>&#160;       </div>
<div class="line"><a name="l02869"></a><span class="lineno"> 2869</span>&#160;       <span class="comment">//Add the gravitational body force term</span></div>
<div class="line"><a name="l02870"></a><span class="lineno"> 2870</span>&#160;       <span class="keywordflow">if</span>(diff_re_inv_fr)</div>
<div class="line"><a name="l02871"></a><span class="lineno"> 2871</span>&#160;        {</div>
<div class="line"><a name="l02872"></a><span class="lineno"> 2872</span>&#160;         dres_dparam[local_eqn] += r*dens_ratio*testf[l]*G[2]*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l02873"></a><span class="lineno"> 2873</span>&#160;        }</div>
<div class="line"><a name="l02874"></a><span class="lineno"> 2874</span>&#160; </div>
<div class="line"><a name="l02875"></a><span class="lineno"> 2875</span>&#160;       <span class="comment">//There is NO pressure gradient term</span></div>
<div class="line"><a name="l02876"></a><span class="lineno"> 2876</span>&#160;       </div>
<div class="line"><a name="l02877"></a><span class="lineno"> 2877</span>&#160;       <span class="comment">//Add in the stress tensor terms</span></div>
<div class="line"><a name="l02878"></a><span class="lineno"> 2878</span>&#160;       <span class="comment">//The viscosity ratio needs to go in here to ensure</span></div>
<div class="line"><a name="l02879"></a><span class="lineno"> 2879</span>&#160;       <span class="comment">//continuity of normal stress is satisfied even in flows</span></div>
<div class="line"><a name="l02880"></a><span class="lineno"> 2880</span>&#160;       <span class="comment">//with zero pressure gradient!</span></div>
<div class="line"><a name="l02881"></a><span class="lineno"> 2881</span>&#160;       <span class="comment">//residuals[local_eqn] -= visc_ratio*</span></div>
<div class="line"><a name="l02882"></a><span class="lineno"> 2882</span>&#160;       <span class="comment">// (r*interpolated_dudx(2,0) - </span></div>
<div class="line"><a name="l02883"></a><span class="lineno"> 2883</span>&#160;       <span class="comment">//  Gamma[0]*interpolated_u[2])*dtestfdx(l,0)*W;</span></div>
<div class="line"><a name="l02884"></a><span class="lineno"> 2884</span>&#160;       </div>
<div class="line"><a name="l02885"></a><span class="lineno"> 2885</span>&#160;       <span class="comment">//residuals[local_eqn] -= visc_ratio*r*</span></div>
<div class="line"><a name="l02886"></a><span class="lineno"> 2886</span>&#160;       <span class="comment">// interpolated_dudx(2,1)*dtestfdx(l,1)*W;</span></div>
<div class="line"><a name="l02887"></a><span class="lineno"> 2887</span>&#160; </div>
<div class="line"><a name="l02888"></a><span class="lineno"> 2888</span>&#160;       <span class="comment">//residuals[local_eqn] -= visc_ratio*</span></div>
<div class="line"><a name="l02889"></a><span class="lineno"> 2889</span>&#160;       <span class="comment">// ((interpolated_u[2]/r) - Gamma[0]*interpolated_dudx(2,0))*testf[l]*W;</span></div>
<div class="line"><a name="l02890"></a><span class="lineno"> 2890</span>&#160; </div>
<div class="line"><a name="l02891"></a><span class="lineno"> 2891</span>&#160; </div>
<div class="line"><a name="l02892"></a><span class="lineno"> 2892</span>&#160;       <span class="comment">//Add in the inertial terms</span></div>
<div class="line"><a name="l02893"></a><span class="lineno"> 2893</span>&#160;       <span class="comment">//du/dt term</span></div>
<div class="line"><a name="l02894"></a><span class="lineno"> 2894</span>&#160;       <span class="keywordflow">if</span>(diff_re_st)</div>
<div class="line"><a name="l02895"></a><span class="lineno"> 2895</span>&#160;        {</div>
<div class="line"><a name="l02896"></a><span class="lineno"> 2896</span>&#160;         dres_dparam[local_eqn] -= dens_ratio*r*dudt[2]*testf[l]*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l02897"></a><span class="lineno"> 2897</span>&#160;        }</div>
<div class="line"><a name="l02898"></a><span class="lineno"> 2898</span>&#160; </div>
<div class="line"><a name="l02899"></a><span class="lineno"> 2899</span>&#160;       <span class="comment">//Convective terms</span></div>
<div class="line"><a name="l02900"></a><span class="lineno"> 2900</span>&#160;       <span class="keywordflow">if</span>(diff_re)</div>
<div class="line"><a name="l02901"></a><span class="lineno"> 2901</span>&#160;        {</div>
<div class="line"><a name="l02902"></a><span class="lineno"> 2902</span>&#160;         dres_dparam[local_eqn] -= </div>
<div class="line"><a name="l02903"></a><span class="lineno"> 2903</span>&#160;          dens_ratio*(r*<a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>[0]*interpolated_dudx(2,0)</div>
<div class="line"><a name="l02904"></a><span class="lineno"> 2904</span>&#160;                      + <a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>[0]*<a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>[2]</div>
<div class="line"><a name="l02905"></a><span class="lineno"> 2905</span>&#160;                      + r*<a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>[1]*interpolated_dudx(2,1))*testf[l]*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l02906"></a><span class="lineno"> 2906</span>&#160;        }</div>
<div class="line"><a name="l02907"></a><span class="lineno"> 2907</span>&#160; </div>
<div class="line"><a name="l02908"></a><span class="lineno"> 2908</span>&#160;       <span class="comment">//Mesh velocity terms</span></div>
<div class="line"><a name="l02909"></a><span class="lineno"> 2909</span>&#160;       <span class="keywordflow">if</span>(!<a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a97f46e5472537187107d0454b6013b5f">ALE_is_disabled</a>)</div>
<div class="line"><a name="l02910"></a><span class="lineno"> 2910</span>&#160;        {</div>
<div class="line"><a name="l02911"></a><span class="lineno"> 2911</span>&#160;         <span class="keywordflow">if</span>(diff_re_st)</div>
<div class="line"><a name="l02912"></a><span class="lineno"> 2912</span>&#160;          {</div>
<div class="line"><a name="l02913"></a><span class="lineno"> 2913</span>&#160;           <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> k=0;k&lt;2;k++)</div>
<div class="line"><a name="l02914"></a><span class="lineno"> 2914</span>&#160;            {</div>
<div class="line"><a name="l02915"></a><span class="lineno"> 2915</span>&#160;             dres_dparam[local_eqn] += </div>
<div class="line"><a name="l02916"></a><span class="lineno"> 2916</span>&#160;              dens_ratio*r*mesh_velocity[k]*interpolated_dudx(2,k)*testf[l]*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l02917"></a><span class="lineno"> 2917</span>&#160;            }</div>
<div class="line"><a name="l02918"></a><span class="lineno"> 2918</span>&#160;          }</div>
<div class="line"><a name="l02919"></a><span class="lineno"> 2919</span>&#160;        }</div>
<div class="line"><a name="l02920"></a><span class="lineno"> 2920</span>&#160; </div>
<div class="line"><a name="l02921"></a><span class="lineno"> 2921</span>&#160;       <span class="comment">//Add the Coriolis term</span></div>
<div class="line"><a name="l02922"></a><span class="lineno"> 2922</span>&#160;       <span class="keywordflow">if</span>(diff_re_inv_ro)</div>
<div class="line"><a name="l02923"></a><span class="lineno"> 2923</span>&#160;        {</div>
<div class="line"><a name="l02924"></a><span class="lineno"> 2924</span>&#160;         dres_dparam[local_eqn] -= </div>
<div class="line"><a name="l02925"></a><span class="lineno"> 2925</span>&#160;          2.0*r*dens_ratio*<a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>[0]*testf[l]*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l02926"></a><span class="lineno"> 2926</span>&#160;        }</div>
<div class="line"><a name="l02927"></a><span class="lineno"> 2927</span>&#160;       </div>
<div class="line"><a name="l02928"></a><span class="lineno"> 2928</span>&#160;       <span class="comment">//CALCULATE THE JACOBIAN</span></div>
<div class="line"><a name="l02929"></a><span class="lineno"> 2929</span>&#160;       <span class="keywordflow">if</span>(flag)</div>
<div class="line"><a name="l02930"></a><span class="lineno"> 2930</span>&#160;        {</div>
<div class="line"><a name="l02931"></a><span class="lineno"> 2931</span>&#160;         <span class="comment">//Loop over the velocity shape functions again</span></div>
<div class="line"><a name="l02932"></a><span class="lineno"> 2932</span>&#160;         <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l2=0;l2&lt;n_node;l2++)</div>
<div class="line"><a name="l02933"></a><span class="lineno"> 2933</span>&#160;          { </div>
<div class="line"><a name="l02934"></a><span class="lineno"> 2934</span>&#160;           <span class="comment">//Radial velocity component</span></div>
<div class="line"><a name="l02935"></a><span class="lineno"> 2935</span>&#160;           local_unknown = <a class="code" href="classoomph_1_1FiniteElement.html#a5da80bbed97543e586f698251d67941d">nodal_local_eqn</a>(l2,u_nodal_index[0]);</div>
<div class="line"><a name="l02936"></a><span class="lineno"> 2936</span>&#160;           <span class="keywordflow">if</span>(local_unknown &gt;= 0)</div>
<div class="line"><a name="l02937"></a><span class="lineno"> 2937</span>&#160;            {</div>
<div class="line"><a name="l02938"></a><span class="lineno"> 2938</span>&#160;             <span class="comment">//Convective terms</span></div>
<div class="line"><a name="l02939"></a><span class="lineno"> 2939</span>&#160;             <span class="keywordflow">if</span>(diff_re)</div>
<div class="line"><a name="l02940"></a><span class="lineno"> 2940</span>&#160;              {</div>
<div class="line"><a name="l02941"></a><span class="lineno"> 2941</span>&#160;               djac_dparam(local_eqn,local_unknown) -= </div>
<div class="line"><a name="l02942"></a><span class="lineno"> 2942</span>&#160;                dens_ratio*(r*psif[l2]*interpolated_dudx(2,0)</div>
<div class="line"><a name="l02943"></a><span class="lineno"> 2943</span>&#160;                          + psif[l2]*<a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>[2])*testf[l]*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l02944"></a><span class="lineno"> 2944</span>&#160;              }</div>
<div class="line"><a name="l02945"></a><span class="lineno"> 2945</span>&#160; </div>
<div class="line"><a name="l02946"></a><span class="lineno"> 2946</span>&#160;             <span class="comment">//Coriolis term</span></div>
<div class="line"><a name="l02947"></a><span class="lineno"> 2947</span>&#160;             <span class="keywordflow">if</span>(diff_re_inv_ro)</div>
<div class="line"><a name="l02948"></a><span class="lineno"> 2948</span>&#160;              {</div>
<div class="line"><a name="l02949"></a><span class="lineno"> 2949</span>&#160;               djac_dparam(local_eqn,local_unknown) -=</div>
<div class="line"><a name="l02950"></a><span class="lineno"> 2950</span>&#160;                2.0*r*dens_ratio*psif[l2]*testf[l]*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l02951"></a><span class="lineno"> 2951</span>&#160;              }</div>
<div class="line"><a name="l02952"></a><span class="lineno"> 2952</span>&#160;            }</div>
<div class="line"><a name="l02953"></a><span class="lineno"> 2953</span>&#160; </div>
<div class="line"><a name="l02954"></a><span class="lineno"> 2954</span>&#160;           <span class="comment">//Axial velocity component</span></div>
<div class="line"><a name="l02955"></a><span class="lineno"> 2955</span>&#160;           local_unknown = <a class="code" href="classoomph_1_1FiniteElement.html#a5da80bbed97543e586f698251d67941d">nodal_local_eqn</a>(l2,u_nodal_index[1]);</div>
<div class="line"><a name="l02956"></a><span class="lineno"> 2956</span>&#160;           <span class="keywordflow">if</span>(local_unknown &gt;= 0)</div>
<div class="line"><a name="l02957"></a><span class="lineno"> 2957</span>&#160;            {</div>
<div class="line"><a name="l02958"></a><span class="lineno"> 2958</span>&#160;             <span class="comment">//Convective terms</span></div>
<div class="line"><a name="l02959"></a><span class="lineno"> 2959</span>&#160;             <span class="keywordflow">if</span>(diff_re)</div>
<div class="line"><a name="l02960"></a><span class="lineno"> 2960</span>&#160;              {</div>
<div class="line"><a name="l02961"></a><span class="lineno"> 2961</span>&#160;               djac_dparam(local_eqn,local_unknown) -= </div>
<div class="line"><a name="l02962"></a><span class="lineno"> 2962</span>&#160;                dens_ratio*r*psif[l2]*interpolated_dudx(2,1)*testf[l]*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l02963"></a><span class="lineno"> 2963</span>&#160;              }</div>
<div class="line"><a name="l02964"></a><span class="lineno"> 2964</span>&#160;            }</div>
<div class="line"><a name="l02965"></a><span class="lineno"> 2965</span>&#160; </div>
<div class="line"><a name="l02966"></a><span class="lineno"> 2966</span>&#160;           <span class="comment">//Azimuthal velocity component</span></div>
<div class="line"><a name="l02967"></a><span class="lineno"> 2967</span>&#160;           local_unknown = <a class="code" href="classoomph_1_1FiniteElement.html#a5da80bbed97543e586f698251d67941d">nodal_local_eqn</a>(l2,u_nodal_index[2]);</div>
<div class="line"><a name="l02968"></a><span class="lineno"> 2968</span>&#160;           <span class="keywordflow">if</span>(local_unknown &gt;= 0)</div>
<div class="line"><a name="l02969"></a><span class="lineno"> 2969</span>&#160;            {</div>
<div class="line"><a name="l02970"></a><span class="lineno"> 2970</span>&#160;             <span class="keywordflow">if</span>(flag==2)</div>
<div class="line"><a name="l02971"></a><span class="lineno"> 2971</span>&#160;              {</div>
<div class="line"><a name="l02972"></a><span class="lineno"> 2972</span>&#160;               <span class="comment">//Add the mass matrix</span></div>
<div class="line"><a name="l02973"></a><span class="lineno"> 2973</span>&#160;               <span class="keywordflow">if</span>(diff_re_st)</div>
<div class="line"><a name="l02974"></a><span class="lineno"> 2974</span>&#160;                {</div>
<div class="line"><a name="l02975"></a><span class="lineno"> 2975</span>&#160;                 dmass_matrix_dparam(local_eqn,local_unknown) +=</div>
<div class="line"><a name="l02976"></a><span class="lineno"> 2976</span>&#160;                  dens_ratio*r*psif[l2]*testf[l]*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l02977"></a><span class="lineno"> 2977</span>&#160;                }</div>
<div class="line"><a name="l02978"></a><span class="lineno"> 2978</span>&#160;              }</div>
<div class="line"><a name="l02979"></a><span class="lineno"> 2979</span>&#160; </div>
<div class="line"><a name="l02980"></a><span class="lineno"> 2980</span>&#160;             <span class="comment">//Add in the stress tensor terms</span></div>
<div class="line"><a name="l02981"></a><span class="lineno"> 2981</span>&#160;             <span class="comment">//The viscosity ratio needs to go in here to ensure</span></div>
<div class="line"><a name="l02982"></a><span class="lineno"> 2982</span>&#160;             <span class="comment">//continuity of normal stress is satisfied even in flows</span></div>
<div class="line"><a name="l02983"></a><span class="lineno"> 2983</span>&#160;             <span class="comment">//with zero pressure gradient!</span></div>
<div class="line"><a name="l02984"></a><span class="lineno"> 2984</span>&#160;             <span class="comment">//jacobian(local_eqn,local_unknown) -= </span></div>
<div class="line"><a name="l02985"></a><span class="lineno"> 2985</span>&#160;             <span class="comment">// visc_ratio*(r*dpsifdx(l2,0) - </span></div>
<div class="line"><a name="l02986"></a><span class="lineno"> 2986</span>&#160;             <span class="comment">//                  Gamma[0]*psif[l2])*dtestfdx(l,0)*W;</span></div>
<div class="line"><a name="l02987"></a><span class="lineno"> 2987</span>&#160;       </div>
<div class="line"><a name="l02988"></a><span class="lineno"> 2988</span>&#160;             <span class="comment">//jacobian(local_eqn,local_unknown) -= </span></div>
<div class="line"><a name="l02989"></a><span class="lineno"> 2989</span>&#160;             <span class="comment">// visc_ratio*r*dpsifdx(l2,1)*dtestfdx(l,1)*W;</span></div>
<div class="line"><a name="l02990"></a><span class="lineno"> 2990</span>&#160; </div>
<div class="line"><a name="l02991"></a><span class="lineno"> 2991</span>&#160;             <span class="comment">//jacobian(local_eqn,local_unknown) -= </span></div>
<div class="line"><a name="l02992"></a><span class="lineno"> 2992</span>&#160;             <span class="comment">// visc_ratio*((psif[l2]/r) - Gamma[0]*dpsifdx(l2,0))</span></div>
<div class="line"><a name="l02993"></a><span class="lineno"> 2993</span>&#160;             <span class="comment">// *testf[l]*W;</span></div>
<div class="line"><a name="l02994"></a><span class="lineno"> 2994</span>&#160;             </div>
<div class="line"><a name="l02995"></a><span class="lineno"> 2995</span>&#160;             <span class="comment">//Add in the inertial terms</span></div>
<div class="line"><a name="l02996"></a><span class="lineno"> 2996</span>&#160;             <span class="comment">//du/dt term</span></div>
<div class="line"><a name="l02997"></a><span class="lineno"> 2997</span>&#160;             <span class="keywordflow">if</span>(diff_re_st)</div>
<div class="line"><a name="l02998"></a><span class="lineno"> 2998</span>&#160;              {</div>
<div class="line"><a name="l02999"></a><span class="lineno"> 2999</span>&#160;               djac_dparam(local_eqn,local_unknown) -= </div>
<div class="line"><a name="l03000"></a><span class="lineno"> 3000</span>&#160;                dens_ratio*r*<a class="code" href="classoomph_1_1FiniteElement.html#ace0e7fb72a805b5c2c600347bfae7a9b">node_pt</a>(l2)-&gt;<a class="code" href="classoomph_1_1Data.html#a5b34970d16205921dca3ada720da8445">time_stepper_pt</a>()-&gt;<a class="code" href="classoomph_1_1TimeStepper.html#a4cb0aecb044b77ba0553cdd54b586d8a">weight</a>(1,0)*</div>
<div class="line"><a name="l03001"></a><span class="lineno"> 3001</span>&#160;                psif[l2]*testf[l]*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l03002"></a><span class="lineno"> 3002</span>&#160;              }</div>
<div class="line"><a name="l03003"></a><span class="lineno"> 3003</span>&#160; </div>
<div class="line"><a name="l03004"></a><span class="lineno"> 3004</span>&#160;             <span class="comment">//Convective terms</span></div>
<div class="line"><a name="l03005"></a><span class="lineno"> 3005</span>&#160;             <span class="keywordflow">if</span>(diff_re)</div>
<div class="line"><a name="l03006"></a><span class="lineno"> 3006</span>&#160;              {</div>
<div class="line"><a name="l03007"></a><span class="lineno"> 3007</span>&#160;               djac_dparam(local_eqn,local_unknown) -= </div>
<div class="line"><a name="l03008"></a><span class="lineno"> 3008</span>&#160;                dens_ratio*(r*<a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>[0]*dpsifdx(l2,0)</div>
<div class="line"><a name="l03009"></a><span class="lineno"> 3009</span>&#160;                            + <a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>[0]*psif[l2]</div>
<div class="line"><a name="l03010"></a><span class="lineno"> 3010</span>&#160;                            + r*<a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>[1]*dpsifdx(l2,1))*testf[l]*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l03011"></a><span class="lineno"> 3011</span>&#160;              }</div>
<div class="line"><a name="l03012"></a><span class="lineno"> 3012</span>&#160;             </div>
<div class="line"><a name="l03013"></a><span class="lineno"> 3013</span>&#160;             <span class="comment">//Mesh velocity terms</span></div>
<div class="line"><a name="l03014"></a><span class="lineno"> 3014</span>&#160;             <span class="keywordflow">if</span>(!<a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a97f46e5472537187107d0454b6013b5f">ALE_is_disabled</a>)</div>
<div class="line"><a name="l03015"></a><span class="lineno"> 3015</span>&#160;              {</div>
<div class="line"><a name="l03016"></a><span class="lineno"> 3016</span>&#160;               <span class="keywordflow">if</span>(diff_re_st)</div>
<div class="line"><a name="l03017"></a><span class="lineno"> 3017</span>&#160;                {</div>
<div class="line"><a name="l03018"></a><span class="lineno"> 3018</span>&#160;                 <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> k=0;k&lt;2;k++)</div>
<div class="line"><a name="l03019"></a><span class="lineno"> 3019</span>&#160;                  {</div>
<div class="line"><a name="l03020"></a><span class="lineno"> 3020</span>&#160;                   djac_dparam(local_eqn,local_unknown) += </div>
<div class="line"><a name="l03021"></a><span class="lineno"> 3021</span>&#160;                    dens_ratio*r*mesh_velocity[k]*dpsifdx(l2,k)*testf[l]*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l03022"></a><span class="lineno"> 3022</span>&#160;                  }</div>
<div class="line"><a name="l03023"></a><span class="lineno"> 3023</span>&#160;                }</div>
<div class="line"><a name="l03024"></a><span class="lineno"> 3024</span>&#160;              }</div>
<div class="line"><a name="l03025"></a><span class="lineno"> 3025</span>&#160;            }</div>
<div class="line"><a name="l03026"></a><span class="lineno"> 3026</span>&#160;          }</div>
<div class="line"><a name="l03027"></a><span class="lineno"> 3027</span>&#160;         </div>
<div class="line"><a name="l03028"></a><span class="lineno"> 3028</span>&#160;         <span class="comment">//There are no pressure terms</span></div>
<div class="line"><a name="l03029"></a><span class="lineno"> 3029</span>&#160;        } <span class="comment">//End of Jacobian</span></div>
<div class="line"><a name="l03030"></a><span class="lineno"> 3030</span>&#160;       </div>
<div class="line"><a name="l03031"></a><span class="lineno"> 3031</span>&#160;      } <span class="comment">//End of AZIMUTHAL EQUATION</span></div>
<div class="line"><a name="l03032"></a><span class="lineno"> 3032</span>&#160; </div>
<div class="line"><a name="l03033"></a><span class="lineno"> 3033</span>&#160;    } <span class="comment">//End of loop over shape functions</span></div>
<div class="line"><a name="l03034"></a><span class="lineno"> 3034</span>&#160;      </div>
<div class="line"><a name="l03035"></a><span class="lineno"> 3035</span>&#160;   </div>
<div class="line"><a name="l03036"></a><span class="lineno"> 3036</span>&#160;   <span class="comment">//CONTINUITY EQUATION NO PARAMETERS</span></div>
<div class="line"><a name="l03037"></a><span class="lineno"> 3037</span>&#160;   <span class="comment">//-------------------</span></div>
<div class="line"><a name="l03038"></a><span class="lineno"> 3038</span>&#160;  }</div>
<div class="line"><a name="l03039"></a><span class="lineno"> 3039</span>&#160; </div>
<div class="line"><a name="l03040"></a><span class="lineno"> 3040</span>&#160;}</div>
<div class="line"><a name="l03041"></a><span class="lineno"> 3041</span>&#160; </div>
<div class="line"><a name="l03042"></a><span class="lineno"> 3042</span>&#160;<span class="comment">//=========================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l03043"></a><span class="lineno"> 3043</span>&#160;<span class="comment">/// \short Compute the hessian tensor vector products required to</span></div>
<div class="line"><a name="l03044"></a><span class="lineno"> 3044</span>&#160;<span class="comment">/// perform continuation of bifurcations analytically</span></div>
<div class="line"><a name="l03045"></a><span class="lineno"> 3045</span>&#160;<span class="comment"></span><span class="comment">//=========================================================================</span></div>
<div class="line"><a name="l03046"></a><span class="lineno"> 3046</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a295dab32c432e6f2597db7aa78c306d9">AxisymmetricNavierStokesEquations::</a></div>
<div class="line"><a name="l03047"></a><span class="lineno"><a class="line" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a295dab32c432e6f2597db7aa78c306d9"> 3047</a></span>&#160;<a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a295dab32c432e6f2597db7aa78c306d9">fill_in_contribution_to_hessian_vector_products</a>(</div>
<div class="line"><a name="l03048"></a><span class="lineno"> 3048</span>&#160; <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> <span class="keyword">const</span> &amp;Y,</div>
<div class="line"><a name="l03049"></a><span class="lineno"> 3049</span>&#160; <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> <span class="keyword">const</span> &amp;C,</div>
<div class="line"><a name="l03050"></a><span class="lineno"> 3050</span>&#160; <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> &amp;product)</div>
<div class="line"><a name="l03051"></a><span class="lineno"> 3051</span>&#160;{</div>
<div class="line"><a name="l03052"></a><span class="lineno"> 3052</span>&#160; <span class="comment">//Find out how many nodes there are</span></div>
<div class="line"><a name="l03053"></a><span class="lineno"> 3053</span>&#160; <span class="keywordtype">unsigned</span> n_node = <a class="code" href="classoomph_1_1FiniteElement.html#a6219ed269a6d89b5aa14659cce48905a">nnode</a>();</div>
<div class="line"><a name="l03054"></a><span class="lineno"> 3054</span>&#160; </div>
<div class="line"><a name="l03055"></a><span class="lineno"> 3055</span>&#160; <span class="comment">//Get the nodal indices at which the velocity is stored</span></div>
<div class="line"><a name="l03056"></a><span class="lineno"> 3056</span>&#160; <span class="keywordtype">unsigned</span> u_nodal_index[3];</div>
<div class="line"><a name="l03057"></a><span class="lineno"> 3057</span>&#160; <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;3;++<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>) {u_nodal_index[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] = <a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#afbdea50fcf4799e2e4e5209ee3249bf0">u_index_axi_nst</a>(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>);}</div>
<div class="line"><a name="l03058"></a><span class="lineno"> 3058</span>&#160; </div>
<div class="line"><a name="l03059"></a><span class="lineno"> 3059</span>&#160; <span class="comment">//Set up memory for the shape and test functions</span></div>
<div class="line"><a name="l03060"></a><span class="lineno"> 3060</span>&#160; <span class="comment">//Note that there are only two dimensions, r and z in this problem</span></div>
<div class="line"><a name="l03061"></a><span class="lineno"> 3061</span>&#160; <a class="code" href="classoomph_1_1Shape.html">Shape</a> psif(n_node), testf(n_node);</div>
<div class="line"><a name="l03062"></a><span class="lineno"> 3062</span>&#160; <a class="code" href="classoomph_1_1DShape.html">DShape</a> dpsifdx(n_node,2), dtestfdx(n_node,2);</div>
<div class="line"><a name="l03063"></a><span class="lineno"> 3063</span>&#160; </div>
<div class="line"><a name="l03064"></a><span class="lineno"> 3064</span>&#160; <span class="comment">//Number of integration points</span></div>
<div class="line"><a name="l03065"></a><span class="lineno"> 3065</span>&#160; <span class="keywordtype">unsigned</span> Nintpt = <a class="code" href="classoomph_1_1FiniteElement.html#a79f1710873332823c47023d370f0596b">integral_pt</a>()-&gt;<a class="code" href="classoomph_1_1Integral.html#a1a270de9d99a1fcf1d25a6c1017f65fa">nweight</a>();</div>
<div class="line"><a name="l03066"></a><span class="lineno"> 3066</span>&#160;   </div>
<div class="line"><a name="l03067"></a><span class="lineno"> 3067</span>&#160; <span class="comment">//Set the Vector to hold local coordinates (two dimensions)</span></div>
<div class="line"><a name="l03068"></a><span class="lineno"> 3068</span>&#160; <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>(2);</div>
<div class="line"><a name="l03069"></a><span class="lineno"> 3069</span>&#160; </div>
<div class="line"><a name="l03070"></a><span class="lineno"> 3070</span>&#160; <span class="comment">//Get Physical Variables from Element</span></div>
<div class="line"><a name="l03071"></a><span class="lineno"> 3071</span>&#160; <span class="comment">//Reynolds number must be multiplied by the density ratio</span></div>
<div class="line"><a name="l03072"></a><span class="lineno"> 3072</span>&#160; <span class="keywordtype">double</span> scaled_re = <a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a5326eb9f37e9ca42103ea7c72622a415">re</a>()*<a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a26df65fe19563b703fe274179e829900">density_ratio</a>();</div>
<div class="line"><a name="l03073"></a><span class="lineno"> 3073</span>&#160; <span class="comment">// double visc_ratio = viscosity_ratio();</span></div>
<div class="line"><a name="l03074"></a><span class="lineno"> 3074</span>&#160; <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> G = <a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a518c31629e6ef42334cd031e2901efea">g</a>();</div>
<div class="line"><a name="l03075"></a><span class="lineno"> 3075</span>&#160; </div>
<div class="line"><a name="l03076"></a><span class="lineno"> 3076</span>&#160; <span class="comment">//Integers used to store the local equation and unknown numbers</span></div>
<div class="line"><a name="l03077"></a><span class="lineno"> 3077</span>&#160; <span class="keywordtype">int</span> local_eqn=0, local_unknown=0, local_freedom=0;</div>
<div class="line"><a name="l03078"></a><span class="lineno"> 3078</span>&#160; </div>
<div class="line"><a name="l03079"></a><span class="lineno"> 3079</span>&#160; <span class="comment">//How may dofs are there</span></div>
<div class="line"><a name="l03080"></a><span class="lineno"> 3080</span>&#160; <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_dof = this-&gt;<a class="code" href="classoomph_1_1GeneralisedElement.html#a37204f67b37d212fd170c68d48f6da57">ndof</a>();</div>
<div class="line"><a name="l03081"></a><span class="lineno"> 3081</span>&#160; </div>
<div class="line"><a name="l03082"></a><span class="lineno"> 3082</span>&#160; <span class="comment">//Create a local matrix eigenvector product contribution</span></div>
<div class="line"><a name="l03083"></a><span class="lineno"> 3083</span>&#160; <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> jac_y(n_dof,n_dof,0.0);</div>
<div class="line"><a name="l03084"></a><span class="lineno"> 3084</span>&#160; </div>
<div class="line"><a name="l03085"></a><span class="lineno"> 3085</span>&#160; <span class="comment">//Loop over the integration points</span></div>
<div class="line"><a name="l03086"></a><span class="lineno"> 3086</span>&#160; <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> ipt=0;ipt&lt;Nintpt;ipt++)</div>
<div class="line"><a name="l03087"></a><span class="lineno"> 3087</span>&#160;  {</div>
<div class="line"><a name="l03088"></a><span class="lineno"> 3088</span>&#160;   <span class="comment">//Assign values of s</span></div>
<div class="line"><a name="l03089"></a><span class="lineno"> 3089</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;2;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++) <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] = <a class="code" href="classoomph_1_1FiniteElement.html#a79f1710873332823c47023d370f0596b">integral_pt</a>()-&gt;<a class="code" href="classoomph_1_1Integral.html#a1a2122f99a87c18649bafdd9ed739758">knot</a>(ipt,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>);</div>
<div class="line"><a name="l03090"></a><span class="lineno"> 3090</span>&#160;   <span class="comment">//Get the integral weight</span></div>
<div class="line"><a name="l03091"></a><span class="lineno"> 3091</span>&#160;   <span class="keywordtype">double</span> w = <a class="code" href="classoomph_1_1FiniteElement.html#a79f1710873332823c47023d370f0596b">integral_pt</a>()-&gt;<a class="code" href="classoomph_1_1Integral.html#ac65335e2aab120b285b3d6c294507b06">weight</a>(ipt);</div>
<div class="line"><a name="l03092"></a><span class="lineno"> 3092</span>&#160;   </div>
<div class="line"><a name="l03093"></a><span class="lineno"> 3093</span>&#160;   <span class="comment">//Call the derivatives of the shape and test functions</span></div>
<div class="line"><a name="l03094"></a><span class="lineno"> 3094</span>&#160;   <span class="keywordtype">double</span> J = </div>
<div class="line"><a name="l03095"></a><span class="lineno"> 3095</span>&#160;    <a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a76e090fdac4507d10eb9f81feb53a51b">dshape_and_dtest_eulerian_at_knot_axi_nst</a>(ipt,psif,dpsifdx,testf,dtestfdx);</div>
<div class="line"><a name="l03096"></a><span class="lineno"> 3096</span>&#160;   </div>
<div class="line"><a name="l03097"></a><span class="lineno"> 3097</span>&#160;   <span class="comment">//Premultiply the weights and the Jacobian</span></div>
<div class="line"><a name="l03098"></a><span class="lineno"> 3098</span>&#160;   <span class="keywordtype">double</span> <a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a> = w*J;</div>
<div class="line"><a name="l03099"></a><span class="lineno"> 3099</span>&#160; </div>
<div class="line"><a name="l03100"></a><span class="lineno"> 3100</span>&#160;   <span class="comment">//Allocate storage for the position and the derivative of the </span></div>
<div class="line"><a name="l03101"></a><span class="lineno"> 3101</span>&#160;   <span class="comment">//mesh positions wrt time</span></div>
<div class="line"><a name="l03102"></a><span class="lineno"> 3102</span>&#160;   <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> <a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>(2,0.0);</div>
<div class="line"><a name="l03103"></a><span class="lineno"> 3103</span>&#160;   <span class="comment">//Vector&lt;double&gt; mesh_velocity(2,0.0);</span></div>
<div class="line"><a name="l03104"></a><span class="lineno"> 3104</span>&#160;   <span class="comment">//Allocate storage for the pressure, velocity components and their</span></div>
<div class="line"><a name="l03105"></a><span class="lineno"> 3105</span>&#160;   <span class="comment">//time and spatial derivatives</span></div>
<div class="line"><a name="l03106"></a><span class="lineno"> 3106</span>&#160;   <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> <a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>(3,0.0);</div>
<div class="line"><a name="l03107"></a><span class="lineno"> 3107</span>&#160;   <span class="comment">//Vector&lt;double&gt; dudt(3,0.0);</span></div>
<div class="line"><a name="l03108"></a><span class="lineno"> 3108</span>&#160;   <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> interpolated_dudx(3,2,0.0);</div>
<div class="line"><a name="l03109"></a><span class="lineno"> 3109</span>&#160;   </div>
<div class="line"><a name="l03110"></a><span class="lineno"> 3110</span>&#160;   <span class="comment">//Calculate velocities and derivatives at integration point</span></div>
<div class="line"><a name="l03111"></a><span class="lineno"> 3111</span>&#160; </div>
<div class="line"><a name="l03112"></a><span class="lineno"> 3112</span>&#160;   <span class="comment">// Loop over nodes</span></div>
<div class="line"><a name="l03113"></a><span class="lineno"> 3113</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l=0;l&lt;n_node;l++) </div>
<div class="line"><a name="l03114"></a><span class="lineno"> 3114</span>&#160;    {</div>
<div class="line"><a name="l03115"></a><span class="lineno"> 3115</span>&#160;     <span class="comment">//Cache the shape function</span></div>
<div class="line"><a name="l03116"></a><span class="lineno"> 3116</span>&#160;     <span class="keyword">const</span> <span class="keywordtype">double</span> psif_ = psif(l);</div>
<div class="line"><a name="l03117"></a><span class="lineno"> 3117</span>&#160;     <span class="comment">//Loop over the two coordinate directions</span></div>
<div class="line"><a name="l03118"></a><span class="lineno"> 3118</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;2;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l03119"></a><span class="lineno"> 3119</span>&#160;      {</div>
<div class="line"><a name="l03120"></a><span class="lineno"> 3120</span>&#160;       <a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] += this-&gt;<a class="code" href="classoomph_1_1FiniteElement.html#abe831900a6d6a08ee4a43fd9c07af32e">raw_nodal_position</a>(l,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>)*psif_;</div>
<div class="line"><a name="l03121"></a><span class="lineno"> 3121</span>&#160;      }</div>
<div class="line"><a name="l03122"></a><span class="lineno"> 3122</span>&#160; </div>
<div class="line"><a name="l03123"></a><span class="lineno"> 3123</span>&#160;     <span class="comment">//Loop over the three velocity directions</span></div>
<div class="line"><a name="l03124"></a><span class="lineno"> 3124</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;3;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l03125"></a><span class="lineno"> 3125</span>&#160;      {</div>
<div class="line"><a name="l03126"></a><span class="lineno"> 3126</span>&#160;       <span class="comment">//Get the u_value</span></div>
<div class="line"><a name="l03127"></a><span class="lineno"> 3127</span>&#160;       <span class="keyword">const</span> <span class="keywordtype">double</span> u_value = this-&gt;<a class="code" href="classoomph_1_1FiniteElement.html#abdc430bef622e0257397407416e6aac8">raw_nodal_value</a>(l,u_nodal_index[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]);</div>
<div class="line"><a name="l03128"></a><span class="lineno"> 3128</span>&#160;       <a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] += u_value*psif_;</div>
<div class="line"><a name="l03129"></a><span class="lineno"> 3129</span>&#160;       <span class="comment">//dudt[i]+= du_dt_axi_nst(l,i)*psif_;</span></div>
<div class="line"><a name="l03130"></a><span class="lineno"> 3130</span>&#160;       <span class="comment">//Loop over derivative directions</span></div>
<div class="line"><a name="l03131"></a><span class="lineno"> 3131</span>&#160;       <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> j=0;j&lt;2;j++)</div>
<div class="line"><a name="l03132"></a><span class="lineno"> 3132</span>&#160;        {interpolated_dudx(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>,j) += u_value*dpsifdx(l,j);}</div>
<div class="line"><a name="l03133"></a><span class="lineno"> 3133</span>&#160;      }</div>
<div class="line"><a name="l03134"></a><span class="lineno"> 3134</span>&#160;    }</div>
<div class="line"><a name="l03135"></a><span class="lineno"> 3135</span>&#160; </div>
<div class="line"><a name="l03136"></a><span class="lineno"> 3136</span>&#160;   <span class="comment">//Get the mesh velocity if ALE is enabled</span></div>
<div class="line"><a name="l03137"></a><span class="lineno"> 3137</span>&#160;   <span class="keywordflow">if</span>(!<a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a97f46e5472537187107d0454b6013b5f">ALE_is_disabled</a>)</div>
<div class="line"><a name="l03138"></a><span class="lineno"> 3138</span>&#160;    {</div>
<div class="line"><a name="l03139"></a><span class="lineno"> 3139</span>&#160;     <span class="keywordflow">throw</span> <a class="code" href="classoomph_1_1OomphLibError.html">OomphLibError</a>(<span class="stringliteral">&quot;Moving nodes not implemented\n&quot;</span>,</div>
<div class="line"><a name="l03140"></a><span class="lineno"> 3140</span>&#160;                         OOMPH_CURRENT_FUNCTION,</div>
<div class="line"><a name="l03141"></a><span class="lineno"> 3141</span>&#160;                                     OOMPH_EXCEPTION_LOCATION);</div>
<div class="line"><a name="l03142"></a><span class="lineno"> 3142</span>&#160;    }</div>
<div class="line"><a name="l03143"></a><span class="lineno"> 3143</span>&#160; </div>
<div class="line"><a name="l03144"></a><span class="lineno"> 3144</span>&#160;   <span class="comment">//r is the first position component</span></div>
<div class="line"><a name="l03145"></a><span class="lineno"> 3145</span>&#160;   <span class="keywordtype">double</span> r = <a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>[0];</div>
<div class="line"><a name="l03146"></a><span class="lineno"> 3146</span>&#160; </div>
<div class="line"><a name="l03147"></a><span class="lineno"> 3147</span>&#160; </div>
<div class="line"><a name="l03148"></a><span class="lineno"> 3148</span>&#160;   <span class="comment">//MOMENTUM EQUATIONS</span></div>
<div class="line"><a name="l03149"></a><span class="lineno"> 3149</span>&#160;   <span class="comment">//------------------</span></div>
<div class="line"><a name="l03150"></a><span class="lineno"> 3150</span>&#160;   </div>
<div class="line"><a name="l03151"></a><span class="lineno"> 3151</span>&#160;   <span class="comment">//Loop over the test functions</span></div>
<div class="line"><a name="l03152"></a><span class="lineno"> 3152</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l=0;l&lt;n_node;l++)</div>
<div class="line"><a name="l03153"></a><span class="lineno"> 3153</span>&#160;    {</div>
<div class="line"><a name="l03154"></a><span class="lineno"> 3154</span>&#160; </div>
<div class="line"><a name="l03155"></a><span class="lineno"> 3155</span>&#160;     <span class="comment">//FIRST (RADIAL) MOMENTUM EQUATION</span></div>
<div class="line"><a name="l03156"></a><span class="lineno"> 3156</span>&#160;     local_eqn = <a class="code" href="classoomph_1_1FiniteElement.html#a5da80bbed97543e586f698251d67941d">nodal_local_eqn</a>(l,u_nodal_index[0]);</div>
<div class="line"><a name="l03157"></a><span class="lineno"> 3157</span>&#160;     <span class="comment">//If it&#39;s not a boundary condition</span></div>
<div class="line"><a name="l03158"></a><span class="lineno"> 3158</span>&#160;     <span class="keywordflow">if</span>(local_eqn &gt;= 0)</div>
<div class="line"><a name="l03159"></a><span class="lineno"> 3159</span>&#160;      {</div>
<div class="line"><a name="l03160"></a><span class="lineno"> 3160</span>&#160;       <span class="comment">//Loop over the velocity shape functions yet again</span></div>
<div class="line"><a name="l03161"></a><span class="lineno"> 3161</span>&#160;       <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l3=0;l3&lt;n_node;l3++)</div>
<div class="line"><a name="l03162"></a><span class="lineno"> 3162</span>&#160;        {</div>
<div class="line"><a name="l03163"></a><span class="lineno"> 3163</span>&#160;         <span class="comment">//Derivative of jacobian terms with respect to radial velocity</span></div>
<div class="line"><a name="l03164"></a><span class="lineno"> 3164</span>&#160;         local_freedom = <a class="code" href="classoomph_1_1FiniteElement.html#a5da80bbed97543e586f698251d67941d">nodal_local_eqn</a>(l3,u_nodal_index[0]);</div>
<div class="line"><a name="l03165"></a><span class="lineno"> 3165</span>&#160;         <span class="keywordflow">if</span>(local_freedom &gt;= 0)</div>
<div class="line"><a name="l03166"></a><span class="lineno"> 3166</span>&#160;          {</div>
<div class="line"><a name="l03167"></a><span class="lineno"> 3167</span>&#160;           <span class="comment">//Storage for the sums</span></div>
<div class="line"><a name="l03168"></a><span class="lineno"> 3168</span>&#160;           <span class="keywordtype">double</span> temp = 0.0;</div>
<div class="line"><a name="l03169"></a><span class="lineno"> 3169</span>&#160; </div>
<div class="line"><a name="l03170"></a><span class="lineno"> 3170</span>&#160;           <span class="comment">//Loop over the velocity shape functions again</span></div>
<div class="line"><a name="l03171"></a><span class="lineno"> 3171</span>&#160;           <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l2=0;l2&lt;n_node;l2++)</div>
<div class="line"><a name="l03172"></a><span class="lineno"> 3172</span>&#160;            { </div>
<div class="line"><a name="l03173"></a><span class="lineno"> 3173</span>&#160;             local_unknown = <a class="code" href="classoomph_1_1FiniteElement.html#a5da80bbed97543e586f698251d67941d">nodal_local_eqn</a>(l2,u_nodal_index[0]);</div>
<div class="line"><a name="l03174"></a><span class="lineno"> 3174</span>&#160;             <span class="comment">//Radial velocity component</span></div>
<div class="line"><a name="l03175"></a><span class="lineno"> 3175</span>&#160;             <span class="keywordflow">if</span>(local_unknown &gt;= 0)</div>
<div class="line"><a name="l03176"></a><span class="lineno"> 3176</span>&#160;              {</div>
<div class="line"><a name="l03177"></a><span class="lineno"> 3177</span>&#160;               <span class="comment">//Remains of convective terms</span></div>
<div class="line"><a name="l03178"></a><span class="lineno"> 3178</span>&#160;               temp -=scaled_re*(r*psif[l2]*dpsifdx(l3,0)</div>
<div class="line"><a name="l03179"></a><span class="lineno"> 3179</span>&#160;                                 + r*psif[l3]*dpsifdx(l2,0))*</div>
<div class="line"><a name="l03180"></a><span class="lineno"> 3180</span>&#160;                Y[local_unknown]*testf[l]*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l03181"></a><span class="lineno"> 3181</span>&#160;              }</div>
<div class="line"><a name="l03182"></a><span class="lineno"> 3182</span>&#160;             </div>
<div class="line"><a name="l03183"></a><span class="lineno"> 3183</span>&#160;             <span class="comment">//Axial velocity component</span></div>
<div class="line"><a name="l03184"></a><span class="lineno"> 3184</span>&#160;             local_unknown = <a class="code" href="classoomph_1_1FiniteElement.html#a5da80bbed97543e586f698251d67941d">nodal_local_eqn</a>(l2,u_nodal_index[1]);</div>
<div class="line"><a name="l03185"></a><span class="lineno"> 3185</span>&#160;             <span class="keywordflow">if</span>(local_unknown &gt;= 0)</div>
<div class="line"><a name="l03186"></a><span class="lineno"> 3186</span>&#160;              {</div>
<div class="line"><a name="l03187"></a><span class="lineno"> 3187</span>&#160;               <span class="comment">//Convective terms</span></div>
<div class="line"><a name="l03188"></a><span class="lineno"> 3188</span>&#160;               temp -= </div>
<div class="line"><a name="l03189"></a><span class="lineno"> 3189</span>&#160;                scaled_re*r*psif[l2]*dpsifdx(l3,1)*Y[local_unknown]*testf[l]*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l03190"></a><span class="lineno"> 3190</span>&#160;              }</div>
<div class="line"><a name="l03191"></a><span class="lineno"> 3191</span>&#160;            }</div>
<div class="line"><a name="l03192"></a><span class="lineno"> 3192</span>&#160;           <span class="comment">//Add the summed contribution to the product matrix</span></div>
<div class="line"><a name="l03193"></a><span class="lineno"> 3193</span>&#160;           jac_y(local_eqn,local_freedom) += temp;</div>
<div class="line"><a name="l03194"></a><span class="lineno"> 3194</span>&#160;          } <span class="comment">//End of derivative wrt radial coordinate</span></div>
<div class="line"><a name="l03195"></a><span class="lineno"> 3195</span>&#160;         </div>
<div class="line"><a name="l03196"></a><span class="lineno"> 3196</span>&#160;         </div>
<div class="line"><a name="l03197"></a><span class="lineno"> 3197</span>&#160;         <span class="comment">//Derivative of jacobian terms with respect to axial velocity</span></div>
<div class="line"><a name="l03198"></a><span class="lineno"> 3198</span>&#160;         local_freedom = <a class="code" href="classoomph_1_1FiniteElement.html#a5da80bbed97543e586f698251d67941d">nodal_local_eqn</a>(l3,u_nodal_index[1]);</div>
<div class="line"><a name="l03199"></a><span class="lineno"> 3199</span>&#160;         <span class="keywordflow">if</span>(local_freedom &gt;= 0)</div>
<div class="line"><a name="l03200"></a><span class="lineno"> 3200</span>&#160;          {</div>
<div class="line"><a name="l03201"></a><span class="lineno"> 3201</span>&#160;           <span class="keywordtype">double</span> temp = 0.0;</div>
<div class="line"><a name="l03202"></a><span class="lineno"> 3202</span>&#160;           </div>
<div class="line"><a name="l03203"></a><span class="lineno"> 3203</span>&#160;           <span class="comment">//Loop over the velocity shape functions again</span></div>
<div class="line"><a name="l03204"></a><span class="lineno"> 3204</span>&#160;           <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l2=0;l2&lt;n_node;l2++)</div>
<div class="line"><a name="l03205"></a><span class="lineno"> 3205</span>&#160;            { </div>
<div class="line"><a name="l03206"></a><span class="lineno"> 3206</span>&#160;             local_unknown = <a class="code" href="classoomph_1_1FiniteElement.html#a5da80bbed97543e586f698251d67941d">nodal_local_eqn</a>(l2,u_nodal_index[0]);</div>
<div class="line"><a name="l03207"></a><span class="lineno"> 3207</span>&#160;             <span class="comment">//Radial velocity component</span></div>
<div class="line"><a name="l03208"></a><span class="lineno"> 3208</span>&#160;             <span class="keywordflow">if</span>(local_unknown &gt;= 0)</div>
<div class="line"><a name="l03209"></a><span class="lineno"> 3209</span>&#160;              {</div>
<div class="line"><a name="l03210"></a><span class="lineno"> 3210</span>&#160;               <span class="comment">//Remains of convective terms</span></div>
<div class="line"><a name="l03211"></a><span class="lineno"> 3211</span>&#160;               temp -= scaled_re*(r*psif[l3]*dpsifdx(l2,1))*</div>
<div class="line"><a name="l03212"></a><span class="lineno"> 3212</span>&#160;                Y[local_unknown]*testf[l]*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l03213"></a><span class="lineno"> 3213</span>&#160;              }</div>
<div class="line"><a name="l03214"></a><span class="lineno"> 3214</span>&#160;            }</div>
<div class="line"><a name="l03215"></a><span class="lineno"> 3215</span>&#160;           <span class="comment">//Add the summed contribution to the product matrix</span></div>
<div class="line"><a name="l03216"></a><span class="lineno"> 3216</span>&#160;           jac_y(local_eqn,local_freedom) += temp;</div>
<div class="line"><a name="l03217"></a><span class="lineno"> 3217</span>&#160;          } <span class="comment">//End of derivative wrt axial coordinate</span></div>
<div class="line"><a name="l03218"></a><span class="lineno"> 3218</span>&#160; </div>
<div class="line"><a name="l03219"></a><span class="lineno"> 3219</span>&#160;         <span class="comment">//Derivative of jacobian terms with respect to azimuthal velocity</span></div>
<div class="line"><a name="l03220"></a><span class="lineno"> 3220</span>&#160;         local_freedom = <a class="code" href="classoomph_1_1FiniteElement.html#a5da80bbed97543e586f698251d67941d">nodal_local_eqn</a>(l3,u_nodal_index[2]);</div>
<div class="line"><a name="l03221"></a><span class="lineno"> 3221</span>&#160;         <span class="keywordflow">if</span>(local_freedom &gt;= 0)</div>
<div class="line"><a name="l03222"></a><span class="lineno"> 3222</span>&#160;          {</div>
<div class="line"><a name="l03223"></a><span class="lineno"> 3223</span>&#160;           <span class="keywordtype">double</span> temp = 0.0;</div>
<div class="line"><a name="l03224"></a><span class="lineno"> 3224</span>&#160;           </div>
<div class="line"><a name="l03225"></a><span class="lineno"> 3225</span>&#160;           <span class="comment">//Loop over the velocity shape functions again</span></div>
<div class="line"><a name="l03226"></a><span class="lineno"> 3226</span>&#160;           <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l2=0;l2&lt;n_node;l2++)</div>
<div class="line"><a name="l03227"></a><span class="lineno"> 3227</span>&#160;            { </div>
<div class="line"><a name="l03228"></a><span class="lineno"> 3228</span>&#160;             <span class="comment">//Azimuthal velocity component</span></div>
<div class="line"><a name="l03229"></a><span class="lineno"> 3229</span>&#160;             local_unknown = <a class="code" href="classoomph_1_1FiniteElement.html#a5da80bbed97543e586f698251d67941d">nodal_local_eqn</a>(l2,u_nodal_index[2]);</div>
<div class="line"><a name="l03230"></a><span class="lineno"> 3230</span>&#160;             <span class="keywordflow">if</span>(local_unknown &gt;= 0)</div>
<div class="line"><a name="l03231"></a><span class="lineno"> 3231</span>&#160;              {</div>
<div class="line"><a name="l03232"></a><span class="lineno"> 3232</span>&#160;               <span class="comment">//Convective terms</span></div>
<div class="line"><a name="l03233"></a><span class="lineno"> 3233</span>&#160;               temp -= </div>
<div class="line"><a name="l03234"></a><span class="lineno"> 3234</span>&#160;                - scaled_re*2.0*psif[l3]*psif[l2]*Y[local_unknown]*testf[l]*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l03235"></a><span class="lineno"> 3235</span>&#160;              }</div>
<div class="line"><a name="l03236"></a><span class="lineno"> 3236</span>&#160;            }</div>
<div class="line"><a name="l03237"></a><span class="lineno"> 3237</span>&#160;           <span class="comment">//Add the summed contibution </span></div>
<div class="line"><a name="l03238"></a><span class="lineno"> 3238</span>&#160;           jac_y(local_eqn,local_freedom) += temp;</div>
<div class="line"><a name="l03239"></a><span class="lineno"> 3239</span>&#160;           </div>
<div class="line"><a name="l03240"></a><span class="lineno"> 3240</span>&#160;          } <span class="comment">//End of if not boundary condition statement</span></div>
<div class="line"><a name="l03241"></a><span class="lineno"> 3241</span>&#160;        } <span class="comment">//End of loop over freedoms</span></div>
<div class="line"><a name="l03242"></a><span class="lineno"> 3242</span>&#160;      } <span class="comment">//End of RADIAL MOMENTUM EQUATION</span></div>
<div class="line"><a name="l03243"></a><span class="lineno"> 3243</span>&#160; </div>
<div class="line"><a name="l03244"></a><span class="lineno"> 3244</span>&#160;       </div>
<div class="line"><a name="l03245"></a><span class="lineno"> 3245</span>&#160;     <span class="comment">//SECOND (AXIAL) MOMENTUM EQUATION</span></div>
<div class="line"><a name="l03246"></a><span class="lineno"> 3246</span>&#160;     local_eqn = <a class="code" href="classoomph_1_1FiniteElement.html#a5da80bbed97543e586f698251d67941d">nodal_local_eqn</a>(l,u_nodal_index[1]);</div>
<div class="line"><a name="l03247"></a><span class="lineno"> 3247</span>&#160;     <span class="comment">//If it&#39;s not a boundary condition</span></div>
<div class="line"><a name="l03248"></a><span class="lineno"> 3248</span>&#160;     <span class="keywordflow">if</span>(local_eqn &gt;= 0)</div>
<div class="line"><a name="l03249"></a><span class="lineno"> 3249</span>&#160;      {</div>
<div class="line"><a name="l03250"></a><span class="lineno"> 3250</span>&#160;       <span class="comment">//Loop over the velocity shape functions yet again</span></div>
<div class="line"><a name="l03251"></a><span class="lineno"> 3251</span>&#160;       <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l3=0;l3&lt;n_node;l3++)</div>
<div class="line"><a name="l03252"></a><span class="lineno"> 3252</span>&#160;        {</div>
<div class="line"><a name="l03253"></a><span class="lineno"> 3253</span>&#160;         <span class="comment">//Derivative of jacobian terms with respect to radial velocity</span></div>
<div class="line"><a name="l03254"></a><span class="lineno"> 3254</span>&#160;         local_freedom = <a class="code" href="classoomph_1_1FiniteElement.html#a5da80bbed97543e586f698251d67941d">nodal_local_eqn</a>(l3,u_nodal_index[0]);</div>
<div class="line"><a name="l03255"></a><span class="lineno"> 3255</span>&#160;         <span class="keywordflow">if</span>(local_freedom &gt;= 0)</div>
<div class="line"><a name="l03256"></a><span class="lineno"> 3256</span>&#160;          {</div>
<div class="line"><a name="l03257"></a><span class="lineno"> 3257</span>&#160;           <span class="keywordtype">double</span> temp = 0.0;</div>
<div class="line"><a name="l03258"></a><span class="lineno"> 3258</span>&#160;           </div>
<div class="line"><a name="l03259"></a><span class="lineno"> 3259</span>&#160;           <span class="comment">//Loop over the velocity shape functions again</span></div>
<div class="line"><a name="l03260"></a><span class="lineno"> 3260</span>&#160;           <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l2=0;l2&lt;n_node;l2++)</div>
<div class="line"><a name="l03261"></a><span class="lineno"> 3261</span>&#160;            { </div>
<div class="line"><a name="l03262"></a><span class="lineno"> 3262</span>&#160;             <span class="comment">//Axial velocity component</span></div>
<div class="line"><a name="l03263"></a><span class="lineno"> 3263</span>&#160;             local_unknown = <a class="code" href="classoomph_1_1FiniteElement.html#a5da80bbed97543e586f698251d67941d">nodal_local_eqn</a>(l2,u_nodal_index[1]);</div>
<div class="line"><a name="l03264"></a><span class="lineno"> 3264</span>&#160;             <span class="keywordflow">if</span>(local_unknown &gt;= 0)</div>
<div class="line"><a name="l03265"></a><span class="lineno"> 3265</span>&#160;              {</div>
<div class="line"><a name="l03266"></a><span class="lineno"> 3266</span>&#160;               <span class="comment">//Convective terms</span></div>
<div class="line"><a name="l03267"></a><span class="lineno"> 3267</span>&#160;               temp -= </div>
<div class="line"><a name="l03268"></a><span class="lineno"> 3268</span>&#160;                scaled_re*(r*psif[l3]*dpsifdx(l2,0))*</div>
<div class="line"><a name="l03269"></a><span class="lineno"> 3269</span>&#160;                Y[local_unknown]*testf[l]*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l03270"></a><span class="lineno"> 3270</span>&#160;              }</div>
<div class="line"><a name="l03271"></a><span class="lineno"> 3271</span>&#160;            }</div>
<div class="line"><a name="l03272"></a><span class="lineno"> 3272</span>&#160;           jac_y(local_eqn,local_freedom) += temp;</div>
<div class="line"><a name="l03273"></a><span class="lineno"> 3273</span>&#160;           </div>
<div class="line"><a name="l03274"></a><span class="lineno"> 3274</span>&#160;           <span class="comment">//There are no azimithal terms in the axial momentum equation</span></div>
<div class="line"><a name="l03275"></a><span class="lineno"> 3275</span>&#160;          } <span class="comment">//End of loop over velocity shape functions</span></div>
<div class="line"><a name="l03276"></a><span class="lineno"> 3276</span>&#160; </div>
<div class="line"><a name="l03277"></a><span class="lineno"> 3277</span>&#160; </div>
<div class="line"><a name="l03278"></a><span class="lineno"> 3278</span>&#160;         <span class="comment">//Derivative of jacobian terms with respect to axial velocity</span></div>
<div class="line"><a name="l03279"></a><span class="lineno"> 3279</span>&#160;         local_freedom = <a class="code" href="classoomph_1_1FiniteElement.html#a5da80bbed97543e586f698251d67941d">nodal_local_eqn</a>(l3,u_nodal_index[1]);</div>
<div class="line"><a name="l03280"></a><span class="lineno"> 3280</span>&#160;         <span class="keywordflow">if</span>(local_freedom &gt;= 0)</div>
<div class="line"><a name="l03281"></a><span class="lineno"> 3281</span>&#160;          {</div>
<div class="line"><a name="l03282"></a><span class="lineno"> 3282</span>&#160;           <span class="keywordtype">double</span> temp = 0.0;</div>
<div class="line"><a name="l03283"></a><span class="lineno"> 3283</span>&#160;           </div>
<div class="line"><a name="l03284"></a><span class="lineno"> 3284</span>&#160;           <span class="comment">//Loop over the velocity shape functions again</span></div>
<div class="line"><a name="l03285"></a><span class="lineno"> 3285</span>&#160;           <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l2=0;l2&lt;n_node;l2++)</div>
<div class="line"><a name="l03286"></a><span class="lineno"> 3286</span>&#160;            { </div>
<div class="line"><a name="l03287"></a><span class="lineno"> 3287</span>&#160;             local_unknown = <a class="code" href="classoomph_1_1FiniteElement.html#a5da80bbed97543e586f698251d67941d">nodal_local_eqn</a>(l2,u_nodal_index[0]);</div>
<div class="line"><a name="l03288"></a><span class="lineno"> 3288</span>&#160;             <span class="comment">//Radial velocity component</span></div>
<div class="line"><a name="l03289"></a><span class="lineno"> 3289</span>&#160;             <span class="keywordflow">if</span>(local_unknown &gt;= 0)</div>
<div class="line"><a name="l03290"></a><span class="lineno"> 3290</span>&#160;              {</div>
<div class="line"><a name="l03291"></a><span class="lineno"> 3291</span>&#160;               <span class="comment">//Convective terms</span></div>
<div class="line"><a name="l03292"></a><span class="lineno"> 3292</span>&#160;               temp -= </div>
<div class="line"><a name="l03293"></a><span class="lineno"> 3293</span>&#160;                scaled_re*r*psif[l2]*dpsifdx(l3,0)*Y[local_unknown]*testf[l]*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l03294"></a><span class="lineno"> 3294</span>&#160;              }</div>
<div class="line"><a name="l03295"></a><span class="lineno"> 3295</span>&#160;             </div>
<div class="line"><a name="l03296"></a><span class="lineno"> 3296</span>&#160;             <span class="comment">//Axial velocity component</span></div>
<div class="line"><a name="l03297"></a><span class="lineno"> 3297</span>&#160;             local_unknown = <a class="code" href="classoomph_1_1FiniteElement.html#a5da80bbed97543e586f698251d67941d">nodal_local_eqn</a>(l2,u_nodal_index[1]);</div>
<div class="line"><a name="l03298"></a><span class="lineno"> 3298</span>&#160;             <span class="keywordflow">if</span>(local_unknown &gt;= 0)</div>
<div class="line"><a name="l03299"></a><span class="lineno"> 3299</span>&#160;              {</div>
<div class="line"><a name="l03300"></a><span class="lineno"> 3300</span>&#160;               <span class="comment">//Convective terms</span></div>
<div class="line"><a name="l03301"></a><span class="lineno"> 3301</span>&#160;               temp -= </div>
<div class="line"><a name="l03302"></a><span class="lineno"> 3302</span>&#160;              scaled_re*(</div>
<div class="line"><a name="l03303"></a><span class="lineno"> 3303</span>&#160;               r*psif[l2]*dpsifdx(l3,1)</div>
<div class="line"><a name="l03304"></a><span class="lineno"> 3304</span>&#160;                  + r*psif[l3]*dpsifdx(l2,1))*Y[local_unknown]*testf[l]*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l03305"></a><span class="lineno"> 3305</span>&#160;              }</div>
<div class="line"><a name="l03306"></a><span class="lineno"> 3306</span>&#160;           </div>
<div class="line"><a name="l03307"></a><span class="lineno"> 3307</span>&#160;             <span class="comment">//There are no azimithal terms in the axial momentum equation</span></div>
<div class="line"><a name="l03308"></a><span class="lineno"> 3308</span>&#160;            } <span class="comment">//End of loop over velocity shape functions</span></div>
<div class="line"><a name="l03309"></a><span class="lineno"> 3309</span>&#160;           </div>
<div class="line"><a name="l03310"></a><span class="lineno"> 3310</span>&#160;           <span class="comment">//Add summed contributiont to jacobian product matrix</span></div>
<div class="line"><a name="l03311"></a><span class="lineno"> 3311</span>&#160;           jac_y(local_eqn,local_freedom) += temp;</div>
<div class="line"><a name="l03312"></a><span class="lineno"> 3312</span>&#160;          }</div>
<div class="line"><a name="l03313"></a><span class="lineno"> 3313</span>&#160;        } <span class="comment">//End of loop over local freedoms</span></div>
<div class="line"><a name="l03314"></a><span class="lineno"> 3314</span>&#160; </div>
<div class="line"><a name="l03315"></a><span class="lineno"> 3315</span>&#160;      } <span class="comment">//End of AXIAL MOMENTUM EQUATION</span></div>
<div class="line"><a name="l03316"></a><span class="lineno"> 3316</span>&#160;     </div>
<div class="line"><a name="l03317"></a><span class="lineno"> 3317</span>&#160;     <span class="comment">//THIRD (AZIMUTHAL) MOMENTUM EQUATION</span></div>
<div class="line"><a name="l03318"></a><span class="lineno"> 3318</span>&#160;     local_eqn = <a class="code" href="classoomph_1_1FiniteElement.html#a5da80bbed97543e586f698251d67941d">nodal_local_eqn</a>(l,u_nodal_index[2]);</div>
<div class="line"><a name="l03319"></a><span class="lineno"> 3319</span>&#160;     <span class="keywordflow">if</span>(local_eqn &gt;= 0)</div>
<div class="line"><a name="l03320"></a><span class="lineno"> 3320</span>&#160;      {</div>
<div class="line"><a name="l03321"></a><span class="lineno"> 3321</span>&#160;       <span class="comment">//Loop over the velocity shape functions yet again</span></div>
<div class="line"><a name="l03322"></a><span class="lineno"> 3322</span>&#160;       <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l3=0;l3&lt;n_node;l3++)</div>
<div class="line"><a name="l03323"></a><span class="lineno"> 3323</span>&#160;        {</div>
<div class="line"><a name="l03324"></a><span class="lineno"> 3324</span>&#160;         <span class="comment">//Derivative of jacobian terms with respect to radial velocity</span></div>
<div class="line"><a name="l03325"></a><span class="lineno"> 3325</span>&#160;         local_freedom = <a class="code" href="classoomph_1_1FiniteElement.html#a5da80bbed97543e586f698251d67941d">nodal_local_eqn</a>(l3,u_nodal_index[0]);</div>
<div class="line"><a name="l03326"></a><span class="lineno"> 3326</span>&#160;         <span class="keywordflow">if</span>(local_freedom &gt;= 0)</div>
<div class="line"><a name="l03327"></a><span class="lineno"> 3327</span>&#160;          {</div>
<div class="line"><a name="l03328"></a><span class="lineno"> 3328</span>&#160;           <span class="keywordtype">double</span> temp = 0.0;</div>
<div class="line"><a name="l03329"></a><span class="lineno"> 3329</span>&#160; </div>
<div class="line"><a name="l03330"></a><span class="lineno"> 3330</span>&#160;           <span class="comment">//Loop over the velocity shape functions again</span></div>
<div class="line"><a name="l03331"></a><span class="lineno"> 3331</span>&#160;           <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l2=0;l2&lt;n_node;l2++)</div>
<div class="line"><a name="l03332"></a><span class="lineno"> 3332</span>&#160;            { </div>
<div class="line"><a name="l03333"></a><span class="lineno"> 3333</span>&#160;             <span class="comment">//Azimuthal velocity component</span></div>
<div class="line"><a name="l03334"></a><span class="lineno"> 3334</span>&#160;             local_unknown = <a class="code" href="classoomph_1_1FiniteElement.html#a5da80bbed97543e586f698251d67941d">nodal_local_eqn</a>(l2,u_nodal_index[2]);</div>
<div class="line"><a name="l03335"></a><span class="lineno"> 3335</span>&#160;             <span class="keywordflow">if</span>(local_unknown &gt;= 0)</div>
<div class="line"><a name="l03336"></a><span class="lineno"> 3336</span>&#160;              {</div>
<div class="line"><a name="l03337"></a><span class="lineno"> 3337</span>&#160;               <span class="comment">//Convective terms</span></div>
<div class="line"><a name="l03338"></a><span class="lineno"> 3338</span>&#160;               temp -= </div>
<div class="line"><a name="l03339"></a><span class="lineno"> 3339</span>&#160;                scaled_re*(r*psif[l3]*dpsifdx(l2,0)</div>
<div class="line"><a name="l03340"></a><span class="lineno"> 3340</span>&#160;                           + psif[l3]*psif[l2])*Y[local_unknown]*testf[l]*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l03341"></a><span class="lineno"> 3341</span>&#160;              }</div>
<div class="line"><a name="l03342"></a><span class="lineno"> 3342</span>&#160;            }</div>
<div class="line"><a name="l03343"></a><span class="lineno"> 3343</span>&#160;           <span class="comment">//Add the summed contribution to the jacobian eigenvector sum</span></div>
<div class="line"><a name="l03344"></a><span class="lineno"> 3344</span>&#160;           jac_y(local_eqn,local_freedom) += temp;</div>
<div class="line"><a name="l03345"></a><span class="lineno"> 3345</span>&#160;          }</div>
<div class="line"><a name="l03346"></a><span class="lineno"> 3346</span>&#160;         </div>
<div class="line"><a name="l03347"></a><span class="lineno"> 3347</span>&#160;         <span class="comment">//Derivative of jacobian terms with respect to axial velocity</span></div>
<div class="line"><a name="l03348"></a><span class="lineno"> 3348</span>&#160;         local_freedom = <a class="code" href="classoomph_1_1FiniteElement.html#a5da80bbed97543e586f698251d67941d">nodal_local_eqn</a>(l3,u_nodal_index[1]);</div>
<div class="line"><a name="l03349"></a><span class="lineno"> 3349</span>&#160;         <span class="keywordflow">if</span>(local_freedom &gt;= 0)</div>
<div class="line"><a name="l03350"></a><span class="lineno"> 3350</span>&#160;          {</div>
<div class="line"><a name="l03351"></a><span class="lineno"> 3351</span>&#160;           <span class="keywordtype">double</span> temp = 0.0;</div>
<div class="line"><a name="l03352"></a><span class="lineno"> 3352</span>&#160; </div>
<div class="line"><a name="l03353"></a><span class="lineno"> 3353</span>&#160;           <span class="comment">//Loop over the velocity shape functions again</span></div>
<div class="line"><a name="l03354"></a><span class="lineno"> 3354</span>&#160;           <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l2=0;l2&lt;n_node;l2++)</div>
<div class="line"><a name="l03355"></a><span class="lineno"> 3355</span>&#160;            { </div>
<div class="line"><a name="l03356"></a><span class="lineno"> 3356</span>&#160;             <span class="comment">//Azimuthal velocity component</span></div>
<div class="line"><a name="l03357"></a><span class="lineno"> 3357</span>&#160;             local_unknown = <a class="code" href="classoomph_1_1FiniteElement.html#a5da80bbed97543e586f698251d67941d">nodal_local_eqn</a>(l2,u_nodal_index[2]);</div>
<div class="line"><a name="l03358"></a><span class="lineno"> 3358</span>&#160;             <span class="keywordflow">if</span>(local_unknown &gt;= 0)</div>
<div class="line"><a name="l03359"></a><span class="lineno"> 3359</span>&#160;              {</div>
<div class="line"><a name="l03360"></a><span class="lineno"> 3360</span>&#160;               <span class="comment">//Convective terms</span></div>
<div class="line"><a name="l03361"></a><span class="lineno"> 3361</span>&#160;               temp  -= </div>
<div class="line"><a name="l03362"></a><span class="lineno"> 3362</span>&#160;                scaled_re*(r*psif[l3]*dpsifdx(l2,1))*</div>
<div class="line"><a name="l03363"></a><span class="lineno"> 3363</span>&#160;                Y[local_unknown]*testf[l]*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l03364"></a><span class="lineno"> 3364</span>&#160;              }</div>
<div class="line"><a name="l03365"></a><span class="lineno"> 3365</span>&#160;            }</div>
<div class="line"><a name="l03366"></a><span class="lineno"> 3366</span>&#160;           <span class="comment">//Add the summed contribution to the jacobian eigenvector sum</span></div>
<div class="line"><a name="l03367"></a><span class="lineno"> 3367</span>&#160;           jac_y(local_eqn,local_freedom) += temp;</div>
<div class="line"><a name="l03368"></a><span class="lineno"> 3368</span>&#160;          }</div>
<div class="line"><a name="l03369"></a><span class="lineno"> 3369</span>&#160; </div>
<div class="line"><a name="l03370"></a><span class="lineno"> 3370</span>&#160;         </div>
<div class="line"><a name="l03371"></a><span class="lineno"> 3371</span>&#160;         <span class="comment">//Derivative of jacobian terms with respect to azimuthal velocity</span></div>
<div class="line"><a name="l03372"></a><span class="lineno"> 3372</span>&#160;         local_freedom = <a class="code" href="classoomph_1_1FiniteElement.html#a5da80bbed97543e586f698251d67941d">nodal_local_eqn</a>(l3,u_nodal_index[2]);</div>
<div class="line"><a name="l03373"></a><span class="lineno"> 3373</span>&#160;         <span class="keywordflow">if</span>(local_freedom &gt;= 0)</div>
<div class="line"><a name="l03374"></a><span class="lineno"> 3374</span>&#160;          {</div>
<div class="line"><a name="l03375"></a><span class="lineno"> 3375</span>&#160;           <span class="keywordtype">double</span> temp = 0.0;</div>
<div class="line"><a name="l03376"></a><span class="lineno"> 3376</span>&#160;           </div>
<div class="line"><a name="l03377"></a><span class="lineno"> 3377</span>&#160; </div>
<div class="line"><a name="l03378"></a><span class="lineno"> 3378</span>&#160;           <span class="comment">//Loop over the velocity shape functions again</span></div>
<div class="line"><a name="l03379"></a><span class="lineno"> 3379</span>&#160;           <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l2=0;l2&lt;n_node;l2++)</div>
<div class="line"><a name="l03380"></a><span class="lineno"> 3380</span>&#160;            { </div>
<div class="line"><a name="l03381"></a><span class="lineno"> 3381</span>&#160;             <span class="comment">//Radial velocity component</span></div>
<div class="line"><a name="l03382"></a><span class="lineno"> 3382</span>&#160;             local_unknown = <a class="code" href="classoomph_1_1FiniteElement.html#a5da80bbed97543e586f698251d67941d">nodal_local_eqn</a>(l2,u_nodal_index[0]);</div>
<div class="line"><a name="l03383"></a><span class="lineno"> 3383</span>&#160;             <span class="keywordflow">if</span>(local_unknown &gt;= 0)</div>
<div class="line"><a name="l03384"></a><span class="lineno"> 3384</span>&#160;              {</div>
<div class="line"><a name="l03385"></a><span class="lineno"> 3385</span>&#160;               <span class="comment">//Convective terms</span></div>
<div class="line"><a name="l03386"></a><span class="lineno"> 3386</span>&#160;               temp -= </div>
<div class="line"><a name="l03387"></a><span class="lineno"> 3387</span>&#160;                scaled_re*(r*psif[l2]*dpsifdx(l3,0)</div>
<div class="line"><a name="l03388"></a><span class="lineno"> 3388</span>&#160;                  + psif[l2]*psif[l3])*Y[local_unknown]*testf[l]*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l03389"></a><span class="lineno"> 3389</span>&#160;              }</div>
<div class="line"><a name="l03390"></a><span class="lineno"> 3390</span>&#160;             </div>
<div class="line"><a name="l03391"></a><span class="lineno"> 3391</span>&#160;             <span class="comment">//Axial velocity component</span></div>
<div class="line"><a name="l03392"></a><span class="lineno"> 3392</span>&#160;             local_unknown = <a class="code" href="classoomph_1_1FiniteElement.html#a5da80bbed97543e586f698251d67941d">nodal_local_eqn</a>(l2,u_nodal_index[1]);</div>
<div class="line"><a name="l03393"></a><span class="lineno"> 3393</span>&#160;             <span class="keywordflow">if</span>(local_unknown &gt;= 0)</div>
<div class="line"><a name="l03394"></a><span class="lineno"> 3394</span>&#160;              {</div>
<div class="line"><a name="l03395"></a><span class="lineno"> 3395</span>&#160;               <span class="comment">//Convective terms</span></div>
<div class="line"><a name="l03396"></a><span class="lineno"> 3396</span>&#160;               temp -= </div>
<div class="line"><a name="l03397"></a><span class="lineno"> 3397</span>&#160;                scaled_re*r*psif[l2]*dpsifdx(l3,1)*Y[local_unknown]*testf[l]*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l03398"></a><span class="lineno"> 3398</span>&#160;              }</div>
<div class="line"><a name="l03399"></a><span class="lineno"> 3399</span>&#160;            }</div>
<div class="line"><a name="l03400"></a><span class="lineno"> 3400</span>&#160;           <span class="comment">//Add the fully summed contribution</span></div>
<div class="line"><a name="l03401"></a><span class="lineno"> 3401</span>&#160;           jac_y(local_eqn,local_freedom) += temp;</div>
<div class="line"><a name="l03402"></a><span class="lineno"> 3402</span>&#160;          }</div>
<div class="line"><a name="l03403"></a><span class="lineno"> 3403</span>&#160;        } <span class="comment">//End of loop over freedoms</span></div>
<div class="line"><a name="l03404"></a><span class="lineno"> 3404</span>&#160; </div>
<div class="line"><a name="l03405"></a><span class="lineno"> 3405</span>&#160;         <span class="comment">//There are no pressure terms</span></div>
<div class="line"><a name="l03406"></a><span class="lineno"> 3406</span>&#160;      } <span class="comment">//End of AZIMUTHAL EQUATION</span></div>
<div class="line"><a name="l03407"></a><span class="lineno"> 3407</span>&#160; </div>
<div class="line"><a name="l03408"></a><span class="lineno"> 3408</span>&#160;    } <span class="comment">//End of loop over shape functions</span></div>
<div class="line"><a name="l03409"></a><span class="lineno"> 3409</span>&#160;  }</div>
<div class="line"><a name="l03410"></a><span class="lineno"> 3410</span>&#160; </div>
<div class="line"><a name="l03411"></a><span class="lineno"> 3411</span>&#160; <span class="comment">//We have now assembled the matrix (d J_{ij} Y_j)/d u_{k}</span></div>
<div class="line"><a name="l03412"></a><span class="lineno"> 3412</span>&#160; <span class="comment">//and simply need to sum over the vectors</span></div>
<div class="line"><a name="l03413"></a><span class="lineno"> 3413</span>&#160; <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_vec = C.<a class="code" href="classoomph_1_1DenseMatrix.html#a1b425094510d833ffe91920747a0a962">nrow</a>();</div>
<div class="line"><a name="l03414"></a><span class="lineno"> 3414</span>&#160; <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;n_dof;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l03415"></a><span class="lineno"> 3415</span>&#160;  {</div>
<div class="line"><a name="l03416"></a><span class="lineno"> 3416</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> k=0;k&lt;n_dof;k++)</div>
<div class="line"><a name="l03417"></a><span class="lineno"> 3417</span>&#160;    {</div>
<div class="line"><a name="l03418"></a><span class="lineno"> 3418</span>&#160;     <span class="comment">//Cache the value of the hessian y product</span></div>
<div class="line"><a name="l03419"></a><span class="lineno"> 3419</span>&#160;     <span class="keyword">const</span> <span class="keywordtype">double</span> j_y = jac_y(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>,k);</div>
<div class="line"><a name="l03420"></a><span class="lineno"> 3420</span>&#160;     <span class="comment">//Loop over the possible vectors</span></div>
<div class="line"><a name="l03421"></a><span class="lineno"> 3421</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> v=0;v&lt;n_vec;v++)</div>
<div class="line"><a name="l03422"></a><span class="lineno"> 3422</span>&#160;      {</div>
<div class="line"><a name="l03423"></a><span class="lineno"> 3423</span>&#160;       product(v,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>) += j_y*C(v,k);</div>
<div class="line"><a name="l03424"></a><span class="lineno"> 3424</span>&#160;      }</div>
<div class="line"><a name="l03425"></a><span class="lineno"> 3425</span>&#160;    }</div>
<div class="line"><a name="l03426"></a><span class="lineno"> 3426</span>&#160;  }</div>
<div class="line"><a name="l03427"></a><span class="lineno"> 3427</span>&#160;}</div>
<div class="line"><a name="l03428"></a><span class="lineno"> 3428</span>&#160; </div>
<div class="line"><a name="l03429"></a><span class="lineno"> 3429</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l03430"></a><span class="lineno"> 3430</span>&#160;<span class="comment">//////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l03431"></a><span class="lineno"> 3431</span>&#160;<span class="comment">//////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l03432"></a><span class="lineno"> 3432</span>&#160;<span class="comment">//////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l03433"></a><span class="lineno"> 3433</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l03434"></a><span class="lineno"> 3434</span>&#160;<span class="comment">//=============================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l03435"></a><span class="lineno"> 3435</span>&#160;<span class="comment">/// Create a list of pairs for all unknowns in this element,</span></div>
<div class="line"><a name="l03436"></a><span class="lineno"> 3436</span>&#160;<span class="comment">/// so that the first entry in each pair contains the global equation</span></div>
<div class="line"><a name="l03437"></a><span class="lineno"> 3437</span>&#160;<span class="comment">/// number of the unknown, while the second one contains the number</span></div>
<div class="line"><a name="l03438"></a><span class="lineno"> 3438</span>&#160;<span class="comment">/// of the &quot;DOF type&quot; that this unknown is associated with.</span></div>
<div class="line"><a name="l03439"></a><span class="lineno"> 3439</span>&#160;<span class="comment">/// (Function can obviously only be called if the equation numbering</span></div>
<div class="line"><a name="l03440"></a><span class="lineno"> 3440</span>&#160;<span class="comment">/// scheme has been set up.)</span></div>
<div class="line"><a name="l03441"></a><span class="lineno"> 3441</span>&#160;<span class="comment"></span><span class="comment">//=============================================================================</span></div>
<div class="line"><a name="l03442"></a><span class="lineno"><a class="line" href="classoomph_1_1AxisymmetricQCrouzeixRaviartElement.html#a83a50021a007f1a932fe841119d93412"> 3442</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classoomph_1_1AxisymmetricQCrouzeixRaviartElement.html#a83a50021a007f1a932fe841119d93412">AxisymmetricQCrouzeixRaviartElement::get_dof_numbers_for_unknowns</a>(</div>
<div class="line"><a name="l03443"></a><span class="lineno"> 3443</span>&#160; std::list&lt;std::pair&lt;unsigned long,unsigned&gt; &gt;&amp; dof_lookup_list)<span class="keyword"> const</span></div>
<div class="line"><a name="l03444"></a><span class="lineno"> 3444</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l03445"></a><span class="lineno"> 3445</span>&#160; <span class="comment">// number of nodes</span></div>
<div class="line"><a name="l03446"></a><span class="lineno"> 3446</span>&#160; <span class="keywordtype">unsigned</span> n_node = this-&gt;<a class="code" href="classoomph_1_1FiniteElement.html#a6219ed269a6d89b5aa14659cce48905a">nnode</a>();</div>
<div class="line"><a name="l03447"></a><span class="lineno"> 3447</span>&#160; </div>
<div class="line"><a name="l03448"></a><span class="lineno"> 3448</span>&#160; <span class="comment">// number of pressure values</span></div>
<div class="line"><a name="l03449"></a><span class="lineno"> 3449</span>&#160; <span class="keywordtype">unsigned</span> n_press = this-&gt;<a class="code" href="classoomph_1_1AxisymmetricQCrouzeixRaviartElement.html#a923c2ccbc5bd523118273e63cc18fd5f">npres_axi_nst</a>();</div>
<div class="line"><a name="l03450"></a><span class="lineno"> 3450</span>&#160; </div>
<div class="line"><a name="l03451"></a><span class="lineno"> 3451</span>&#160; <span class="comment">// temporary pair (used to store dof lookup prior to being added to list)</span></div>
<div class="line"><a name="l03452"></a><span class="lineno"> 3452</span>&#160; std::pair&lt;unsigned,unsigned&gt; dof_lookup;</div>
<div class="line"><a name="l03453"></a><span class="lineno"> 3453</span>&#160; </div>
<div class="line"><a name="l03454"></a><span class="lineno"> 3454</span>&#160; <span class="comment">// pressure dof number (is this really OK?)</span></div>
<div class="line"><a name="l03455"></a><span class="lineno"> 3455</span>&#160; <span class="keywordtype">unsigned</span> pressure_dof_number = 3;</div>
<div class="line"><a name="l03456"></a><span class="lineno"> 3456</span>&#160; </div>
<div class="line"><a name="l03457"></a><span class="lineno"> 3457</span>&#160; <span class="comment">// loop over the pressure values</span></div>
<div class="line"><a name="l03458"></a><span class="lineno"> 3458</span>&#160; <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="the__data__structure_8txt.html#af88b2d950fae19ab641bd1690e08445c">n</a> = 0; <a class="code" href="the__data__structure_8txt.html#af88b2d950fae19ab641bd1690e08445c">n</a> &lt; n_press; <a class="code" href="the__data__structure_8txt.html#af88b2d950fae19ab641bd1690e08445c">n</a>++)</div>
<div class="line"><a name="l03459"></a><span class="lineno"> 3459</span>&#160;  {</div>
<div class="line"><a name="l03460"></a><span class="lineno"> 3460</span>&#160;   <span class="comment">// determine local eqn number</span></div>
<div class="line"><a name="l03461"></a><span class="lineno"> 3461</span>&#160;   <span class="keywordtype">int</span> <a class="code" href="classoomph_1_1GeneralisedElement.html#a3d46b71d27f94aeba21aff1ef84fd0a6">local_eqn_number</a> = this-&gt;<a class="code" href="classoomph_1_1AxisymmetricQCrouzeixRaviartElement.html#adc569122e3649deba56231175f3116cf">p_local_eqn</a>(<a class="code" href="the__data__structure_8txt.html#af88b2d950fae19ab641bd1690e08445c">n</a>);</div>
<div class="line"><a name="l03462"></a><span class="lineno"> 3462</span>&#160;   </div>
<div class="line"><a name="l03463"></a><span class="lineno"> 3463</span>&#160;   <span class="comment">// ignore pinned values - far away degrees of freedom resulting </span></div>
<div class="line"><a name="l03464"></a><span class="lineno"> 3464</span>&#160;   <span class="comment">// from hanging nodes can be ignored since these are be dealt</span></div>
<div class="line"><a name="l03465"></a><span class="lineno"> 3465</span>&#160;   <span class="comment">// with by the element containing their master nodes</span></div>
<div class="line"><a name="l03466"></a><span class="lineno"> 3466</span>&#160;   <span class="keywordflow">if</span> (local_eqn_number &gt;= 0)</div>
<div class="line"><a name="l03467"></a><span class="lineno"> 3467</span>&#160;    {</div>
<div class="line"><a name="l03468"></a><span class="lineno"> 3468</span>&#160;     <span class="comment">// store dof lookup in temporary pair: First entry in pair</span></div>
<div class="line"><a name="l03469"></a><span class="lineno"> 3469</span>&#160;     <span class="comment">// is global equation number; second entry is dof type</span></div>
<div class="line"><a name="l03470"></a><span class="lineno"> 3470</span>&#160;     dof_lookup.first = this-&gt;<a class="code" href="classoomph_1_1GeneralisedElement.html#a37ac5a1d5234fa931ab710c0c74d55d2">eqn_number</a>(local_eqn_number);</div>
<div class="line"><a name="l03471"></a><span class="lineno"> 3471</span>&#160;     dof_lookup.second = pressure_dof_number;</div>
<div class="line"><a name="l03472"></a><span class="lineno"> 3472</span>&#160;     </div>
<div class="line"><a name="l03473"></a><span class="lineno"> 3473</span>&#160;     <span class="comment">// add to list</span></div>
<div class="line"><a name="l03474"></a><span class="lineno"> 3474</span>&#160;     dof_lookup_list.push_front(dof_lookup);</div>
<div class="line"><a name="l03475"></a><span class="lineno"> 3475</span>&#160;    }</div>
<div class="line"><a name="l03476"></a><span class="lineno"> 3476</span>&#160;  }</div>
<div class="line"><a name="l03477"></a><span class="lineno"> 3477</span>&#160; </div>
<div class="line"><a name="l03478"></a><span class="lineno"> 3478</span>&#160; <span class="comment">// loop over the nodes</span></div>
<div class="line"><a name="l03479"></a><span class="lineno"> 3479</span>&#160; <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="the__data__structure_8txt.html#af88b2d950fae19ab641bd1690e08445c">n</a> = 0; <a class="code" href="the__data__structure_8txt.html#af88b2d950fae19ab641bd1690e08445c">n</a> &lt; n_node; <a class="code" href="the__data__structure_8txt.html#af88b2d950fae19ab641bd1690e08445c">n</a>++)</div>
<div class="line"><a name="l03480"></a><span class="lineno"> 3480</span>&#160;  {</div>
<div class="line"><a name="l03481"></a><span class="lineno"> 3481</span>&#160;   <span class="comment">// find the number of values at this node</span></div>
<div class="line"><a name="l03482"></a><span class="lineno"> 3482</span>&#160;   <span class="keywordtype">unsigned</span> nv = this-&gt;<a class="code" href="classoomph_1_1FiniteElement.html#ace0e7fb72a805b5c2c600347bfae7a9b">node_pt</a>(<a class="code" href="the__data__structure_8txt.html#af88b2d950fae19ab641bd1690e08445c">n</a>)-&gt;<a class="code" href="classoomph_1_1Data.html#a7e67fc78a2e8a2fd6eb75bd292d42ff8">nvalue</a>();</div>
<div class="line"><a name="l03483"></a><span class="lineno"> 3483</span>&#160;   </div>
<div class="line"><a name="l03484"></a><span class="lineno"> 3484</span>&#160;   <span class="comment">//loop over these values</span></div>
<div class="line"><a name="l03485"></a><span class="lineno"> 3485</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> v = 0; v &lt; nv; v++)</div>
<div class="line"><a name="l03486"></a><span class="lineno"> 3486</span>&#160;    {</div>
<div class="line"><a name="l03487"></a><span class="lineno"> 3487</span>&#160;     <span class="comment">// determine local eqn number</span></div>
<div class="line"><a name="l03488"></a><span class="lineno"> 3488</span>&#160;     <span class="keywordtype">int</span> <a class="code" href="classoomph_1_1GeneralisedElement.html#a3d46b71d27f94aeba21aff1ef84fd0a6">local_eqn_number</a> = this-&gt;<a class="code" href="classoomph_1_1FiniteElement.html#a5da80bbed97543e586f698251d67941d">nodal_local_eqn</a>(<a class="code" href="the__data__structure_8txt.html#af88b2d950fae19ab641bd1690e08445c">n</a>, v);</div>
<div class="line"><a name="l03489"></a><span class="lineno"> 3489</span>&#160;     </div>
<div class="line"><a name="l03490"></a><span class="lineno"> 3490</span>&#160;     <span class="comment">// ignore pinned values</span></div>
<div class="line"><a name="l03491"></a><span class="lineno"> 3491</span>&#160;     <span class="keywordflow">if</span> (<a class="code" href="classoomph_1_1GeneralisedElement.html#a3d46b71d27f94aeba21aff1ef84fd0a6">local_eqn_number</a> &gt;= 0)</div>
<div class="line"><a name="l03492"></a><span class="lineno"> 3492</span>&#160;      {</div>
<div class="line"><a name="l03493"></a><span class="lineno"> 3493</span>&#160;       <span class="comment">// store dof lookup in temporary pair: First entry in pair</span></div>
<div class="line"><a name="l03494"></a><span class="lineno"> 3494</span>&#160;       <span class="comment">// is global equation number; second entry is dof type</span></div>
<div class="line"><a name="l03495"></a><span class="lineno"> 3495</span>&#160;       dof_lookup.first = this-&gt;<a class="code" href="classoomph_1_1GeneralisedElement.html#a37ac5a1d5234fa931ab710c0c74d55d2">eqn_number</a>(local_eqn_number);</div>
<div class="line"><a name="l03496"></a><span class="lineno"> 3496</span>&#160;       dof_lookup.second = v;</div>
<div class="line"><a name="l03497"></a><span class="lineno"> 3497</span>&#160;       </div>
<div class="line"><a name="l03498"></a><span class="lineno"> 3498</span>&#160;       <span class="comment">// add to list</span></div>
<div class="line"><a name="l03499"></a><span class="lineno"> 3499</span>&#160;       dof_lookup_list.push_front(dof_lookup);</div>
<div class="line"><a name="l03500"></a><span class="lineno"> 3500</span>&#160;       </div>
<div class="line"><a name="l03501"></a><span class="lineno"> 3501</span>&#160;      }</div>
<div class="line"><a name="l03502"></a><span class="lineno"> 3502</span>&#160;    }</div>
<div class="line"><a name="l03503"></a><span class="lineno"> 3503</span>&#160;  }</div>
<div class="line"><a name="l03504"></a><span class="lineno"> 3504</span>&#160;}</div>
<div class="line"><a name="l03505"></a><span class="lineno"> 3505</span>&#160; </div>
<div class="line"><a name="l03506"></a><span class="lineno"> 3506</span>&#160; </div>
<div class="line"><a name="l03507"></a><span class="lineno"> 3507</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l03508"></a><span class="lineno"> 3508</span>&#160;<span class="comment">///Axisymmetric Crouzeix-Raviart elements</span></div>
<div class="line"><a name="l03509"></a><span class="lineno"> 3509</span>&#160;<span class="comment"></span><span class="comment">//Set the data for the number of Variables at each node</span></div>
<div class="line"><a name="l03510"></a><span class="lineno"> 3510</span>&#160;<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <a class="code" href="classoomph_1_1AxisymmetricQCrouzeixRaviartElement.html#a6edd4a05741c3ee8ee1ac82f7c3f9eff">AxisymmetricQCrouzeixRaviartElement::</a></div>
<div class="line"><a name="l03511"></a><span class="lineno"> 3511</span>&#160;<a class="code" href="classoomph_1_1AxisymmetricQCrouzeixRaviartElement.html#a6edd4a05741c3ee8ee1ac82f7c3f9eff">Initial_Nvalue</a>[9]={3,3,3,3,3,3,3,3,3};</div>
<div class="line"><a name="l03512"></a><span class="lineno"> 3512</span>&#160; </div>
<div class="line"><a name="l03513"></a><span class="lineno"> 3513</span>&#160;<span class="comment">//========================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l03514"></a><span class="lineno"> 3514</span>&#160;<span class="comment">/// Number of values (pinned or dofs) required at node n.</span></div>
<div class="line"><a name="l03515"></a><span class="lineno"> 3515</span>&#160;<span class="comment"></span><span class="comment">//========================================================================</span></div>
<div class="line"><a name="l03516"></a><span class="lineno"> 3516</span>&#160;<span class="keywordtype">unsigned</span> <a class="code" href="classoomph_1_1AxisymmetricQCrouzeixRaviartElement.html#ae7988679549e63ef87fc3f062fb6a559">AxisymmetricQCrouzeixRaviartElement::</a></div>
<div class="line"><a name="l03517"></a><span class="lineno"><a class="line" href="classoomph_1_1AxisymmetricQCrouzeixRaviartElement.html#ae7988679549e63ef87fc3f062fb6a559"> 3517</a></span>&#160;<a class="code" href="classoomph_1_1AxisymmetricQCrouzeixRaviartElement.html#ae7988679549e63ef87fc3f062fb6a559">required_nvalue</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;<a class="code" href="the__data__structure_8txt.html#af88b2d950fae19ab641bd1690e08445c">n</a>)<span class="keyword"> const </span>{<span class="keywordflow">return</span> <a class="code" href="classoomph_1_1AxisymmetricQCrouzeixRaviartElement.html#a6edd4a05741c3ee8ee1ac82f7c3f9eff">Initial_Nvalue</a>[<a class="code" href="the__data__structure_8txt.html#af88b2d950fae19ab641bd1690e08445c">n</a>];}</div>
<div class="line"><a name="l03518"></a><span class="lineno"> 3518</span>&#160; </div>
<div class="line"><a name="l03519"></a><span class="lineno"> 3519</span>&#160;<span class="comment">//========================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l03520"></a><span class="lineno"> 3520</span>&#160;<span class="comment">/// Compute traction at local coordinate s for outer unit normal N</span></div>
<div class="line"><a name="l03521"></a><span class="lineno"> 3521</span>&#160;<span class="comment"></span><span class="comment">//========================================================================</span></div>
<div class="line"><a name="l03522"></a><span class="lineno"><a class="line" href="classoomph_1_1AxisymmetricQCrouzeixRaviartElement.html#a60ea4ee3c006bc04984f1dcadb87a79d"> 3522</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classoomph_1_1AxisymmetricQCrouzeixRaviartElement.html#a60ea4ee3c006bc04984f1dcadb87a79d">AxisymmetricQCrouzeixRaviartElement::get_traction</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>, </div>
<div class="line"><a name="l03523"></a><span class="lineno"> 3523</span>&#160;                                                       <span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; <a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7dabc60bec4cc294aa2adf92726c6d6823a">N</a>, </div>
<div class="line"><a name="l03524"></a><span class="lineno"> 3524</span>&#160;                                                       <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; traction)<span class="keyword"></span></div>
<div class="line"><a name="l03525"></a><span class="lineno"> 3525</span>&#160;<span class="keyword"> const</span></div>
<div class="line"><a name="l03526"></a><span class="lineno"> 3526</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l03527"></a><span class="lineno"> 3527</span>&#160; <a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a0a5523b91d5191c2f9e23fe8d74f4e07">AxisymmetricNavierStokesEquations::traction</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7dabc60bec4cc294aa2adf92726c6d6823a">N</a>,<a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a0a5523b91d5191c2f9e23fe8d74f4e07">traction</a>);</div>
<div class="line"><a name="l03528"></a><span class="lineno"> 3528</span>&#160;}</div>
<div class="line"><a name="l03529"></a><span class="lineno"> 3529</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l03530"></a><span class="lineno"> 3530</span>&#160;<span class="comment">///////////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l03531"></a><span class="lineno"> 3531</span>&#160;<span class="comment">///////////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l03532"></a><span class="lineno"> 3532</span>&#160;<span class="comment">///////////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l03533"></a><span class="lineno"> 3533</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l03534"></a><span class="lineno"> 3534</span>&#160; </div>
<div class="line"><a name="l03535"></a><span class="lineno"> 3535</span>&#160; </div>
<div class="line"><a name="l03536"></a><span class="lineno"> 3536</span>&#160;<span class="comment">//============================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l03537"></a><span class="lineno"> 3537</span>&#160;<span class="comment">/// Create a list of pairs for all unknowns in this element,</span></div>
<div class="line"><a name="l03538"></a><span class="lineno"> 3538</span>&#160;<span class="comment">/// so the first entry in each pair contains the global equation</span></div>
<div class="line"><a name="l03539"></a><span class="lineno"> 3539</span>&#160;<span class="comment">/// number of the unknown, while the second one contains the number</span></div>
<div class="line"><a name="l03540"></a><span class="lineno"> 3540</span>&#160;<span class="comment">/// of the &quot;DOF type&quot; that this unknown is associated with.</span></div>
<div class="line"><a name="l03541"></a><span class="lineno"> 3541</span>&#160;<span class="comment">/// (Function can obviously only be called if the equation numbering</span></div>
<div class="line"><a name="l03542"></a><span class="lineno"> 3542</span>&#160;<span class="comment">/// scheme has been set up.)</span></div>
<div class="line"><a name="l03543"></a><span class="lineno"> 3543</span>&#160;<span class="comment"></span><span class="comment">//============================================================================</span></div>
<div class="line"><a name="l03544"></a><span class="lineno"><a class="line" href="classoomph_1_1AxisymmetricQTaylorHoodElement.html#ad763c91177814d4221ec485b076a38e9"> 3544</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classoomph_1_1AxisymmetricQTaylorHoodElement.html#ad763c91177814d4221ec485b076a38e9">AxisymmetricQTaylorHoodElement::get_dof_numbers_for_unknowns</a>(</div>
<div class="line"><a name="l03545"></a><span class="lineno"> 3545</span>&#160; std::list&lt;std::pair&lt;<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>,</div>
<div class="line"><a name="l03546"></a><span class="lineno"> 3546</span>&#160; <span class="keywordtype">unsigned</span>&gt; &gt;&amp; dof_lookup_list)<span class="keyword"> const</span></div>
<div class="line"><a name="l03547"></a><span class="lineno"> 3547</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l03548"></a><span class="lineno"> 3548</span>&#160; <span class="comment">// number of nodes</span></div>
<div class="line"><a name="l03549"></a><span class="lineno"> 3549</span>&#160; <span class="keywordtype">unsigned</span> n_node = this-&gt;<a class="code" href="classoomph_1_1FiniteElement.html#a6219ed269a6d89b5aa14659cce48905a">nnode</a>();</div>
<div class="line"><a name="l03550"></a><span class="lineno"> 3550</span>&#160; </div>
<div class="line"><a name="l03551"></a><span class="lineno"> 3551</span>&#160; <span class="comment">// temporary pair (used to store dof lookup prior to being added to list)</span></div>
<div class="line"><a name="l03552"></a><span class="lineno"> 3552</span>&#160; std::pair&lt;unsigned,unsigned&gt; dof_lookup;</div>
<div class="line"><a name="l03553"></a><span class="lineno"> 3553</span>&#160; </div>
<div class="line"><a name="l03554"></a><span class="lineno"> 3554</span>&#160; <span class="comment">// loop over the nodes</span></div>
<div class="line"><a name="l03555"></a><span class="lineno"> 3555</span>&#160; <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="the__data__structure_8txt.html#af88b2d950fae19ab641bd1690e08445c">n</a> = 0; <a class="code" href="the__data__structure_8txt.html#af88b2d950fae19ab641bd1690e08445c">n</a> &lt; n_node; <a class="code" href="the__data__structure_8txt.html#af88b2d950fae19ab641bd1690e08445c">n</a>++)</div>
<div class="line"><a name="l03556"></a><span class="lineno"> 3556</span>&#160;  {</div>
<div class="line"><a name="l03557"></a><span class="lineno"> 3557</span>&#160;   <span class="comment">// find the number of values at this node</span></div>
<div class="line"><a name="l03558"></a><span class="lineno"> 3558</span>&#160;   <span class="keywordtype">unsigned</span> nv = this-&gt;<a class="code" href="classoomph_1_1FiniteElement.html#ace0e7fb72a805b5c2c600347bfae7a9b">node_pt</a>(<a class="code" href="the__data__structure_8txt.html#af88b2d950fae19ab641bd1690e08445c">n</a>)-&gt;<a class="code" href="classoomph_1_1Data.html#a7e67fc78a2e8a2fd6eb75bd292d42ff8">nvalue</a>();</div>
<div class="line"><a name="l03559"></a><span class="lineno"> 3559</span>&#160;   </div>
<div class="line"><a name="l03560"></a><span class="lineno"> 3560</span>&#160;   <span class="comment">//loop over these values</span></div>
<div class="line"><a name="l03561"></a><span class="lineno"> 3561</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> v = 0; v &lt; nv; v++)</div>
<div class="line"><a name="l03562"></a><span class="lineno"> 3562</span>&#160;    {</div>
<div class="line"><a name="l03563"></a><span class="lineno"> 3563</span>&#160;     <span class="comment">// determine local eqn number</span></div>
<div class="line"><a name="l03564"></a><span class="lineno"> 3564</span>&#160;     <span class="keywordtype">int</span> <a class="code" href="classoomph_1_1GeneralisedElement.html#a3d46b71d27f94aeba21aff1ef84fd0a6">local_eqn_number</a> = this-&gt;<a class="code" href="classoomph_1_1FiniteElement.html#a5da80bbed97543e586f698251d67941d">nodal_local_eqn</a>(<a class="code" href="the__data__structure_8txt.html#af88b2d950fae19ab641bd1690e08445c">n</a>, v);</div>
<div class="line"><a name="l03565"></a><span class="lineno"> 3565</span>&#160;     </div>
<div class="line"><a name="l03566"></a><span class="lineno"> 3566</span>&#160;     <span class="comment">// ignore pinned values - far away degrees of freedom resulting </span></div>
<div class="line"><a name="l03567"></a><span class="lineno"> 3567</span>&#160;     <span class="comment">// from hanging nodes can be ignored since these are be dealt</span></div>
<div class="line"><a name="l03568"></a><span class="lineno"> 3568</span>&#160;     <span class="comment">// with by the element containing their master nodes</span></div>
<div class="line"><a name="l03569"></a><span class="lineno"> 3569</span>&#160;     <span class="keywordflow">if</span> (<a class="code" href="classoomph_1_1GeneralisedElement.html#a3d46b71d27f94aeba21aff1ef84fd0a6">local_eqn_number</a> &gt;= 0)</div>
<div class="line"><a name="l03570"></a><span class="lineno"> 3570</span>&#160;      {</div>
<div class="line"><a name="l03571"></a><span class="lineno"> 3571</span>&#160;       <span class="comment">// store dof lookup in temporary pair: Global equation number</span></div>
<div class="line"><a name="l03572"></a><span class="lineno"> 3572</span>&#160;       <span class="comment">// is the first entry in pair</span></div>
<div class="line"><a name="l03573"></a><span class="lineno"> 3573</span>&#160;       dof_lookup.first = this-&gt;<a class="code" href="classoomph_1_1GeneralisedElement.html#a37ac5a1d5234fa931ab710c0c74d55d2">eqn_number</a>(local_eqn_number);</div>
<div class="line"><a name="l03574"></a><span class="lineno"> 3574</span>&#160;       </div>
<div class="line"><a name="l03575"></a><span class="lineno"> 3575</span>&#160;       <span class="comment">// set dof numbers: Dof number is the second entry in pair</span></div>
<div class="line"><a name="l03576"></a><span class="lineno"> 3576</span>&#160;       dof_lookup.second = v;</div>
<div class="line"><a name="l03577"></a><span class="lineno"> 3577</span>&#160;       </div>
<div class="line"><a name="l03578"></a><span class="lineno"> 3578</span>&#160;       <span class="comment">// add to list</span></div>
<div class="line"><a name="l03579"></a><span class="lineno"> 3579</span>&#160;       dof_lookup_list.push_front(dof_lookup);</div>
<div class="line"><a name="l03580"></a><span class="lineno"> 3580</span>&#160;      }</div>
<div class="line"><a name="l03581"></a><span class="lineno"> 3581</span>&#160;    }</div>
<div class="line"><a name="l03582"></a><span class="lineno"> 3582</span>&#160;  }</div>
<div class="line"><a name="l03583"></a><span class="lineno"> 3583</span>&#160;}</div>
<div class="line"><a name="l03584"></a><span class="lineno"> 3584</span>&#160; </div>
<div class="line"><a name="l03585"></a><span class="lineno"> 3585</span>&#160; </div>
<div class="line"><a name="l03586"></a><span class="lineno"> 3586</span>&#160; </div>
<div class="line"><a name="l03587"></a><span class="lineno"> 3587</span>&#160;<span class="comment">//Axisymmetric Taylor--Hood</span></div>
<div class="line"><a name="l03588"></a><span class="lineno"> 3588</span>&#160;<span class="comment">//Set the data for the number of Variables at each node</span></div>
<div class="line"><a name="l03589"></a><span class="lineno"> 3589</span>&#160;<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <a class="code" href="classoomph_1_1AxisymmetricQTaylorHoodElement.html#ae0826bd23cb739552135795de862c758">AxisymmetricQTaylorHoodElement::</a></div>
<div class="line"><a name="l03590"></a><span class="lineno"> 3590</span>&#160;<a class="code" href="classoomph_1_1AxisymmetricQTaylorHoodElement.html#ae0826bd23cb739552135795de862c758">Initial_Nvalue</a>[9]={4,3,4,3,3,3,4,3,4};</div>
<div class="line"><a name="l03591"></a><span class="lineno"> 3591</span>&#160; </div>
<div class="line"><a name="l03592"></a><span class="lineno"> 3592</span>&#160;<span class="comment">//Set the data for the pressure conversion array</span></div>
<div class="line"><a name="l03593"></a><span class="lineno"> 3593</span>&#160;<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <a class="code" href="classoomph_1_1AxisymmetricQTaylorHoodElement.html#a40720e74e6b8ce8d803ee95d7a6ad119">AxisymmetricQTaylorHoodElement::Pconv</a>[4]={0,2,6,8};</div>
<div class="line"><a name="l03594"></a><span class="lineno"> 3594</span>&#160; </div>
<div class="line"><a name="l03595"></a><span class="lineno"> 3595</span>&#160; </div>
<div class="line"><a name="l03596"></a><span class="lineno"> 3596</span>&#160;<span class="comment">//========================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l03597"></a><span class="lineno"> 3597</span>&#160;<span class="comment">/// Compute traction at local coordinate s for outer unit normal N</span></div>
<div class="line"><a name="l03598"></a><span class="lineno"> 3598</span>&#160;<span class="comment"></span><span class="comment">//========================================================================</span></div>
<div class="line"><a name="l03599"></a><span class="lineno"><a class="line" href="classoomph_1_1AxisymmetricQTaylorHoodElement.html#abfaf2fb0ff51a888f77c724af8c20809"> 3599</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classoomph_1_1AxisymmetricQTaylorHoodElement.html#abfaf2fb0ff51a888f77c724af8c20809">AxisymmetricQTaylorHoodElement::get_traction</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>, </div>
<div class="line"><a name="l03600"></a><span class="lineno"> 3600</span>&#160;                                                  <span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; <a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7dabc60bec4cc294aa2adf92726c6d6823a">N</a>, </div>
<div class="line"><a name="l03601"></a><span class="lineno"> 3601</span>&#160;                                                  <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; traction)<span class="keyword"></span></div>
<div class="line"><a name="l03602"></a><span class="lineno"> 3602</span>&#160;<span class="keyword"> const</span></div>
<div class="line"><a name="l03603"></a><span class="lineno"> 3603</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l03604"></a><span class="lineno"> 3604</span>&#160; <a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a0a5523b91d5191c2f9e23fe8d74f4e07">AxisymmetricNavierStokesEquations::traction</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7dabc60bec4cc294aa2adf92726c6d6823a">N</a>,<a class="code" href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a0a5523b91d5191c2f9e23fe8d74f4e07">traction</a>);</div>
<div class="line"><a name="l03605"></a><span class="lineno"> 3605</span>&#160;}</div>
<div class="line"><a name="l03606"></a><span class="lineno"> 3606</span>&#160; </div>
<div class="line"><a name="l03607"></a><span class="lineno"> 3607</span>&#160;}</div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="aclassoomph_1_1AxisymmetricNavierStokesEquations_html_aa951cf371f58231f3c0967255843a50a"><div class="ttname"><a href="classoomph_1_1AxisymmetricNavierStokesEquations.html#aa951cf371f58231f3c0967255843a50a">oomph::AxisymmetricNavierStokesEquations::re_st</a></div><div class="ttdeci">const double &amp; re_st() const</div><div class="ttdoc">Product of Reynolds and Strouhal number (=Womersley number)</div><div class="ttdef"><b>Definition:</b> <a href="axisym__navier__stokes__elements_8h_source.html#l00498">axisym_navier_stokes_elements.h:498</a></div></div>
<div class="ttc" id="aclassoomph_1_1RankFourTensor_html"><div class="ttname"><a href="classoomph_1_1RankFourTensor.html">oomph::RankFourTensor</a></div><div class="ttdoc">A Rank 4 Tensor class.</div><div class="ttdef"><b>Definition:</b> <a href="matrices_8h_source.html#l01621">matrices.h:1621</a></div></div>
<div class="ttc" id="aclassoomph_1_1AxisymmetricNavierStokesEquations_html_a26df65fe19563b703fe274179e829900"><div class="ttname"><a href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a26df65fe19563b703fe274179e829900">oomph::AxisymmetricNavierStokesEquations::density_ratio</a></div><div class="ttdeci">const double &amp; density_ratio() const</div><div class="ttdoc">Density ratio for element: Element's density relative to the viscosity used in the definition of the ...</div><div class="ttdef"><b>Definition:</b> <a href="axisym__navier__stokes__elements_8h_source.html#l00526">axisym_navier_stokes_elements.h:526</a></div></div>
<div class="ttc" id="aclassoomph_1_1FiniteElement_html_ace0e7fb72a805b5c2c600347bfae7a9b"><div class="ttname"><a href="classoomph_1_1FiniteElement.html#ace0e7fb72a805b5c2c600347bfae7a9b">oomph::FiniteElement::node_pt</a></div><div class="ttdeci">Node *&amp; node_pt(const unsigned &amp;n)</div><div class="ttdoc">Return a pointer to the local node n.</div><div class="ttdef"><b>Definition:</b> <a href="elements_8h_source.html#l02122">elements.h:2122</a></div></div>
<div class="ttc" id="aclassoomph_1_1AxisymmetricNavierStokesEquations_html_a623385a5197597302d8fcb21e201c50a"><div class="ttname"><a href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a623385a5197597302d8fcb21e201c50a">oomph::AxisymmetricNavierStokesEquations::Re_pt</a></div><div class="ttdeci">double * Re_pt</div><div class="ttdoc">Pointer to global Reynolds number.</div><div class="ttdef"><b>Definition:</b> <a href="axisym__navier__stokes__elements_8h_source.html#l00250">axisym_navier_stokes_elements.h:250</a></div></div>
<div class="ttc" id="aclassoomph_1_1AxisymmetricNavierStokesEquations_html_a783cd0439da3951032dcf984d7c98433"><div class="ttname"><a href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a783cd0439da3951032dcf984d7c98433">oomph::AxisymmetricNavierStokesEquations::re_pt</a></div><div class="ttdeci">double *&amp; re_pt()</div><div class="ttdoc">Pointer to Reynolds number.</div><div class="ttdef"><b>Definition:</b> <a href="axisym__navier__stokes__elements_8h_source.html#l00501">axisym_navier_stokes_elements.h:501</a></div></div>
<div class="ttc" id="athe__data__structure_8txt_html_a5448c72da3359c7796cf0c5f800732a1"><div class="ttname"><a href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a></div><div class="ttdeci">and code FiniteElement::J_eulerian(...) \endcode returns the Jacobian of the mapping from Eulerian coordinates to local coordinates. - The function \c GeneralisedElement c QElement&lt; 3, 2 &gt; is an node brick element with a trilinear mapping between and global coordinates The dimension and the number of c Nodes must be set by calling the appropriate c set_ functions in the see ref set_commands above The most important member functions implemented at this level include Functions that evaluate the shape in terms of the c FiniteElement s coordinates functions that determine whether a c Node is located at a particular coordinate Output functions that allow the element shapes to be plotted we specify a pointer to a spatial integration the default assignment can be over written at a higher level This is discussed in more detail in a&lt; A HREF=&quot;../../optimisation/html/index.html&quot;&gt; separate document&lt;/A &gt; subsubsection Maths_Element we implement the equations that are represented by the specific element We implement the employing either the geometric shape functions that already exist on or employing additional shape functions defined at this level This allows us to write further member functions such as c interpolated_u(...)</div></div>
<div class="ttc" id="aclassoomph_1_1FiniteElement_html_a8ed563c7ff0cfd8bafdbb0132b388106"><div class="ttname"><a href="classoomph_1_1FiniteElement.html#a8ed563c7ff0cfd8bafdbb0132b388106">oomph::FiniteElement::nplot_points</a></div><div class="ttdeci">virtual unsigned nplot_points(const unsigned &amp;nplot) const</div><div class="ttdoc">Return total number of plot points (when plotting nplot points in each &quot;coordinate direction&quot;)</div><div class="ttdef"><b>Definition:</b> <a href="elements_8h_source.html#l03045">elements.h:3045</a></div></div>
<div class="ttc" id="athe__data__structure_8txt_html_a1400a973def57b85051cfe1070be1810"><div class="ttname"><a href="the__data__structure_8txt.html#a1400a973def57b85051cfe1070be1810">residuals</a></div><div class="ttdeci">endcode The default implementation of c the simplest possible implementation of a new element requires only the specification of c we need to know which c Data affects the residuals(and hence the Jacobian matrix). For a \c GeneralisedElement such \c Data exists in two forms</div></div>
<div class="ttc" id="aclassoomph_1_1AxisymmetricNavierStokesEquations_html_a5f10cf57b03c4a76b70151df35a249e3"><div class="ttname"><a href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a5f10cf57b03c4a76b70151df35a249e3">oomph::AxisymmetricNavierStokesEquations::re_invro_pt</a></div><div class="ttdeci">double *&amp; re_invro_pt()</div><div class="ttdoc">Pointer to global inverse Froude number.</div><div class="ttdef"><b>Definition:</b> <a href="axisym__navier__stokes__elements_8h_source.html#l00516">axisym_navier_stokes_elements.h:516</a></div></div>
<div class="ttc" id="aclassoomph_1_1AxisymmetricNavierStokesEquations_html_a518c31629e6ef42334cd031e2901efea"><div class="ttname"><a href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a518c31629e6ef42334cd031e2901efea">oomph::AxisymmetricNavierStokesEquations::g</a></div><div class="ttdeci">const Vector&lt; double &gt; &amp; g() const</div><div class="ttdoc">Vector of gravitational components.</div><div class="ttdef"><b>Definition:</b> <a href="axisym__navier__stokes__elements_8h_source.html#l00519">axisym_navier_stokes_elements.h:519</a></div></div>
<div class="ttc" id="aclassoomph_1_1OomphLibError_html"><div class="ttname"><a href="classoomph_1_1OomphLibError.html">oomph::OomphLibError</a></div><div class="ttdef"><b>Definition:</b> <a href="oomph__definitions_8h_source.html#l00225">oomph_definitions.h:225</a></div></div>
<div class="ttc" id="aclassoomph_1_1AxisymmetricNavierStokesEquations_html_a817781d8e3ef49e200ab675d3b48c541"><div class="ttname"><a href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a817781d8e3ef49e200ab675d3b48c541">oomph::AxisymmetricNavierStokesEquations::Default_Physical_Ratio_Value</a></div><div class="ttdeci">static double Default_Physical_Ratio_Value</div><div class="ttdoc">Static default value for the physical ratios (all are initialised to one)</div><div class="ttdef"><b>Definition:</b> <a href="axisym__navier__stokes__elements_8h_source.html#l00230">axisym_navier_stokes_elements.h:230</a></div></div>
<div class="ttc" id="aaxisym__navier__stokes__elements_8h_html"><div class="ttname"><a href="axisym__navier__stokes__elements_8h.html">axisym_navier_stokes_elements.h</a></div></div>
<div class="ttc" id="aclassoomph_1_1AxisymmetricNavierStokesEquations_html_a80b3415e150243f8fff3f8eb87082b24"><div class="ttname"><a href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a80b3415e150243f8fff3f8eb87082b24">oomph::AxisymmetricNavierStokesEquations::du_dt_axi_nst</a></div><div class="ttdeci">double du_dt_axi_nst(const unsigned &amp;n, const unsigned &amp;i) const</div><div class="ttdoc">i-th component of du/dt at local node n. Uses suitably interpolated value for hanging nodes.</div><div class="ttdef"><b>Definition:</b> <a href="axisym__navier__stokes__elements_8h_source.html#l00575">axisym_navier_stokes_elements.h:575</a></div></div>
<div class="ttc" id="aclassoomph_1_1FiniteElement_html_aeccc0f774e3fab8c536e2d41004a1665"><div class="ttname"><a href="classoomph_1_1FiniteElement.html#aeccc0f774e3fab8c536e2d41004a1665">oomph::FiniteElement::shape_at_knot</a></div><div class="ttdeci">virtual void shape_at_knot(const unsigned &amp;ipt, Shape &amp;psi) const</div><div class="ttdoc">Return the geometric shape function at the ipt-th integration point.</div><div class="ttdef"><b>Definition:</b> <a href="elements_8cc_source.html#l03156">elements.cc:3156</a></div></div>
<div class="ttc" id="aclassoomph_1_1FiniteElement_html_a5a9c1ead9819cd17603096e63087020f"><div class="ttname"><a href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">oomph::FiniteElement::interpolated_x</a></div><div class="ttdeci">virtual double interpolated_x(const Vector&lt; double &gt; &amp;s, const unsigned &amp;i) const</div><div class="ttdoc">Return FE interpolated coordinate x[i] at local coordinate s.</div><div class="ttdef"><b>Definition:</b> <a href="elements_8cc_source.html#l03877">elements.cc:3877</a></div></div>
<div class="ttc" id="aclassoomph_1_1FiniteElement_html_a089e58d5ad9b8efee637221b0e264563"><div class="ttname"><a href="classoomph_1_1FiniteElement.html#a089e58d5ad9b8efee637221b0e264563">oomph::FiniteElement::J_eulerian</a></div><div class="ttdeci">virtual double J_eulerian(const Vector&lt; double &gt; &amp;s) const</div><div class="ttdoc">Return the Jacobian of mapping from local to global coordinates at local position s.</div><div class="ttdef"><b>Definition:</b> <a href="the__data__structure_8txt_source.html#l00540">the_data_structure.txt:540</a></div></div>
<div class="ttc" id="aclassoomph_1_1FiniteElement_html_a690fd33af26cc3e84f39bba6d5a85202"><div class="ttname"><a href="classoomph_1_1FiniteElement.html#a690fd33af26cc3e84f39bba6d5a85202">oomph::FiniteElement::SteadyExactSolutionFctPt</a></div><div class="ttdeci">void(* SteadyExactSolutionFctPt)(const Vector&lt; double &gt; &amp;, Vector&lt; double &gt; &amp;)</div><div class="ttdoc">Function pointer for function that computes vector-valued steady &quot;exact solution&quot;  as .</div><div class="ttdef"><b>Definition:</b> <a href="elements_8h_source.html#l01736">elements.h:1736</a></div></div>
<div class="ttc" id="aclassoomph_1_1AxisymmetricNavierStokesEquations_html_a3aa173227f477a40fb4adba84a337f5b"><div class="ttname"><a href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a3aa173227f477a40fb4adba84a337f5b">oomph::AxisymmetricNavierStokesEquations::p_axi_nst</a></div><div class="ttdeci">virtual double p_axi_nst(const unsigned &amp;n_p) const =0</div><div class="ttdoc">Pressure at local pressure &quot;node&quot; n_p Uses suitably interpolated value for hanging nodes.</div></div>
<div class="ttc" id="aclassoomph_1_1AxisymmetricNavierStokesEquations_html_a827372afbe927e224d3648b7d6477f2d"><div class="ttname"><a href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a827372afbe927e224d3648b7d6477f2d">oomph::AxisymmetricNavierStokesEquations::compute_error</a></div><div class="ttdeci">void compute_error(std::ostream &amp;outfile, FiniteElement::UnsteadyExactSolutionFctPt exact_soln_pt, const double &amp;time, double &amp;error, double &amp;norm)</div><div class="ttdoc">Validate against exact solution at given time Solution is provided via function pointer....</div><div class="ttdef"><b>Definition:</b> <a href="axisym__navier__stokes__elements_8cc_source.html#l00160">axisym_navier_stokes_elements.cc:160</a></div></div>
<div class="ttc" id="aclassoomph_1_1Time_html_a6e28ea7a6664a2f5f5e1be871304a2c7"><div class="ttname"><a href="classoomph_1_1Time.html#a6e28ea7a6664a2f5f5e1be871304a2c7">oomph::Time::time</a></div><div class="ttdeci">double &amp; time()</div><div class="ttdoc">Return the current value of the continuous time.</div><div class="ttdef"><b>Definition:</b> <a href="timesteppers_8h_source.html#l00126">timesteppers.h:126</a></div></div>
<div class="ttc" id="aclassoomph_1_1Node_html_a6c287aa85c19f2d37ed7952ece5c76dd"><div class="ttname"><a href="classoomph_1_1Node.html#a6c287aa85c19f2d37ed7952ece5c76dd">oomph::Node::perform_auxiliary_node_update_fct</a></div><div class="ttdeci">void perform_auxiliary_node_update_fct()</div><div class="ttdoc">Execute auxiliary update function (if any)  this can be used to update any nodal values following th...</div><div class="ttdef"><b>Definition:</b> <a href="nodes_8h_source.html#l01505">nodes.h:1505</a></div></div>
<div class="ttc" id="aclassoomph_1_1AxisymmetricNavierStokesEquations_html_a0a5523b91d5191c2f9e23fe8d74f4e07"><div class="ttname"><a href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a0a5523b91d5191c2f9e23fe8d74f4e07">oomph::AxisymmetricNavierStokesEquations::traction</a></div><div class="ttdeci">void traction(const Vector&lt; double &gt; &amp;s, const Vector&lt; double &gt; &amp;N, Vector&lt; double &gt; &amp;traction) const</div><div class="ttdoc">Compute traction (on the viscous scale) at local coordinate s for outer unit normal N.</div><div class="ttdef"><b>Definition:</b> <a href="axisym__navier__stokes__elements_8cc_source.html#l00639">axisym_navier_stokes_elements.cc:639</a></div></div>
<div class="ttc" id="aclassoomph_1_1FiniteElement_html_a9296c17b134688049256a4bbc886df69"><div class="ttname"><a href="classoomph_1_1FiniteElement.html#a9296c17b134688049256a4bbc886df69">oomph::FiniteElement::dshape_eulerian</a></div><div class="ttdeci">double dshape_eulerian(const Vector&lt; double &gt; &amp;s, Shape &amp;psi, DShape &amp;dpsidx) const</div><div class="ttdoc">Compute the geometric shape functions and also first derivatives w.r.t. global coordinates at local c...</div><div class="ttdef"><b>Definition:</b> <a href="elements_8cc_source.html#l03223">elements.cc:3223</a></div></div>
<div class="ttc" id="aclassoomph_1_1AxisymmetricNavierStokesEquations_html_a03822b722ac8aa9adceaa52aa4f7dafa"><div class="ttname"><a href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a03822b722ac8aa9adceaa52aa4f7dafa">oomph::AxisymmetricNavierStokesEquations::Default_Gravity_vector</a></div><div class="ttdeci">static Vector&lt; double &gt; Default_Gravity_vector</div><div class="ttdoc">Static default value for the gravity vector.</div><div class="ttdef"><b>Definition:</b> <a href="axisym__navier__stokes__elements_8h_source.html#l00233">axisym_navier_stokes_elements.h:233</a></div></div>
<div class="ttc" id="aclassoomph_1_1AxisymmetricNavierStokesEquations_html_a9a19729ca5b08abca8e8202614e70b29"><div class="ttname"><a href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a9a19729ca5b08abca8e8202614e70b29">oomph::AxisymmetricNavierStokesEquations::fill_in_generic_residual_contribution_axi_nst</a></div><div class="ttdeci">virtual void fill_in_generic_residual_contribution_axi_nst(Vector&lt; double &gt; &amp;residuals, DenseMatrix&lt; double &gt; &amp;jacobian, DenseMatrix&lt; double &gt; &amp;mass_matrix, unsigned flag)</div><div class="ttdoc">Compute the residuals for the NavierStokes equations; flag=2 or 1 or 0: compute the Jacobian and/or ...</div><div class="ttdef"><b>Definition:</b> <a href="axisym__navier__stokes__elements_8cc_source.html#l00906">axisym_navier_stokes_elements.cc:906</a></div></div>
<div class="ttc" id="aclassoomph_1_1AxisymmetricNavierStokesEquations_html_afbdea50fcf4799e2e4e5209ee3249bf0"><div class="ttname"><a href="classoomph_1_1AxisymmetricNavierStokesEquations.html#afbdea50fcf4799e2e4e5209ee3249bf0">oomph::AxisymmetricNavierStokesEquations::u_index_axi_nst</a></div><div class="ttdeci">virtual unsigned u_index_axi_nst(const unsigned &amp;i) const</div><div class="ttdoc">Return the index at which the i-th unknown velocity component.</div><div class="ttdef"><b>Definition:</b> <a href="axisym__navier__stokes__elements_8h_source.html#l00558">axisym_navier_stokes_elements.h:558</a></div></div>
<div class="ttc" id="aclassoomph_1_1FiniteElement_html_ac3987a5ead7dc20c63d86b333466e2b5"><div class="ttname"><a href="classoomph_1_1FiniteElement.html#ac3987a5ead7dc20c63d86b333466e2b5">oomph::FiniteElement::write_tecplot_zone_footer</a></div><div class="ttdeci">virtual void write_tecplot_zone_footer(std::ostream &amp;outfile, const unsigned &amp;nplot) const</div><div class="ttdoc">Add tecplot zone &quot;footer&quot; to output stream (when plotting nplot points in each &quot;coordinate direction&quot;...</div><div class="ttdef"><b>Definition:</b> <a href="elements_8h_source.html#l03031">elements.h:3031</a></div></div>
<div class="ttc" id="aclassoomph_1_1GeneralisedElement_html_a156163c9f6fbd17548a9fa836616d19b"><div class="ttname"><a href="classoomph_1_1GeneralisedElement.html#a156163c9f6fbd17548a9fa836616d19b">oomph::GeneralisedElement::Default_fd_jacobian_step</a></div><div class="ttdeci">static double Default_fd_jacobian_step</div><div class="ttdoc">Double used for the default finite difference step in elemental jacobian calculations.</div><div class="ttdef"><b>Definition:</b> <a href="elements_8h_source.html#l01177">elements.h:1177</a></div></div>
<div class="ttc" id="aclassoomph_1_1AxisymmetricNavierStokesEquations_html_ad6ac62ca5fa411c365fd2ecc72aa25e8"><div class="ttname"><a href="classoomph_1_1AxisymmetricNavierStokesEquations.html#ad6ac62ca5fa411c365fd2ecc72aa25e8">oomph::AxisymmetricNavierStokesEquations::p_local_eqn</a></div><div class="ttdeci">virtual int p_local_eqn(const unsigned &amp;n) const =0</div><div class="ttdoc">Access function for the local equation number information for the pressure. p_local_eqn[n] = local eq...</div></div>
<div class="ttc" id="aclassoomph_1_1AxisymmetricQCrouzeixRaviartElement_html_a60ea4ee3c006bc04984f1dcadb87a79d"><div class="ttname"><a href="classoomph_1_1AxisymmetricQCrouzeixRaviartElement.html#a60ea4ee3c006bc04984f1dcadb87a79d">oomph::AxisymmetricQCrouzeixRaviartElement::get_traction</a></div><div class="ttdeci">void get_traction(const Vector&lt; double &gt; &amp;s, const Vector&lt; double &gt; &amp;N, Vector&lt; double &gt; &amp;traction) const</div><div class="ttdoc">Compute traction at local coordinate s for outer unit normal N.</div><div class="ttdef"><b>Definition:</b> <a href="axisym__navier__stokes__elements_8cc_source.html#l03522">axisym_navier_stokes_elements.cc:3522</a></div></div>
<div class="ttc" id="aclassoomph_1_1AxisymmetricNavierStokesEquations_html_a6b75b0e3184053cbf32458df944ec330"><div class="ttname"><a href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a6b75b0e3184053cbf32458df944ec330">oomph::AxisymmetricNavierStokesEquations::get_viscosity_ratio_axisym_nst</a></div><div class="ttdeci">virtual void get_viscosity_ratio_axisym_nst(const unsigned &amp;ipt, const Vector&lt; double &gt; &amp;s, const Vector&lt; double &gt; &amp;x, double &amp;visc_ratio)</div><div class="ttdoc">Calculate the viscosity ratio relative to the viscosity used in the definition of the Reynolds number...</div><div class="ttdef"><b>Definition:</b> <a href="axisym__navier__stokes__elements_8h_source.html#l00433">axisym_navier_stokes_elements.h:433</a></div></div>
<div class="ttc" id="aclassoomph_1_1AxisymmetricNavierStokesEquations_html_a89edaffb4913131cc14a5f6e45ed117a"><div class="ttname"><a href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a89edaffb4913131cc14a5f6e45ed117a">oomph::AxisymmetricNavierStokesEquations::npres_axi_nst</a></div><div class="ttdeci">virtual unsigned npres_axi_nst() const =0</div><div class="ttdoc">Function to return number of pressure degrees of freedom.</div></div>
<div class="ttc" id="aclassoomph_1_1Integral_html_a1a270de9d99a1fcf1d25a6c1017f65fa"><div class="ttname"><a href="classoomph_1_1Integral.html#a1a270de9d99a1fcf1d25a6c1017f65fa">oomph::Integral::nweight</a></div><div class="ttdeci">virtual unsigned nweight() const =0</div><div class="ttdoc">Return the number of integration points of the scheme.</div></div>
<div class="ttc" id="aclassoomph_1_1RankThreeTensor_html"><div class="ttname"><a href="classoomph_1_1RankThreeTensor.html">oomph::RankThreeTensor</a></div><div class="ttdoc">A Rank 3 Tensor class.</div><div class="ttdef"><b>Definition:</b> <a href="matrices_8h_source.html#l01333">matrices.h:1333</a></div></div>
<div class="ttc" id="aclassoomph_1_1AxisymmetricNavierStokesEquations_html_a7de6189781f4b7f59de7ae96f669a93b"><div class="ttname"><a href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a7de6189781f4b7f59de7ae96f669a93b">oomph::AxisymmetricNavierStokesEquations::Pressure_not_stored_at_node</a></div><div class="ttdeci">static int Pressure_not_stored_at_node</div><div class="ttdoc">Static &quot;magic&quot; number that indicates that the pressure is not stored at a node.</div><div class="ttdef"><b>Definition:</b> <a href="axisym__navier__stokes__elements_8h_source.html#l00224">axisym_navier_stokes_elements.h:224</a></div></div>
<div class="ttc" id="aclassoomph_1_1AxisymmetricNavierStokesEquations_html_a3993d25e1ae47080505ec2570ba8c41f"><div class="ttname"><a href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a3993d25e1ae47080505ec2570ba8c41f">oomph::AxisymmetricNavierStokesEquations::output_veloc</a></div><div class="ttdeci">void output_veloc(std::ostream &amp;outfile, const unsigned &amp;nplot, const unsigned &amp;t)</div><div class="ttdoc">Output function: x,y,[z],u,v,[w] in tecplot format. nplot points in each coordinate direction at time...</div><div class="ttdef"><b>Definition:</b> <a href="axisym__navier__stokes__elements_8cc_source.html#l00418">axisym_navier_stokes_elements.cc:418</a></div></div>
<div class="ttc" id="aclassoomph_1_1AxisymmetricNavierStokesEquations_html_aff943b6b83128398a0320cae90c6b94c"><div class="ttname"><a href="classoomph_1_1AxisymmetricNavierStokesEquations.html#aff943b6b83128398a0320cae90c6b94c">oomph::AxisymmetricNavierStokesEquations::Gamma</a></div><div class="ttdeci">static Vector&lt; double &gt; Gamma</div><div class="ttdoc">Vector to decide whether the stress-divergence form is used or not.</div><div class="ttdef"><b>Definition:</b> <a href="axisym__navier__stokes__elements_8h_source.html#l00490">axisym_navier_stokes_elements.h:490</a></div></div>
<div class="ttc" id="aclassoomph_1_1DenseMatrix_html_a9937181f1cb4cfaed7aaf3b483c42456"><div class="ttname"><a href="classoomph_1_1DenseMatrix.html#a9937181f1cb4cfaed7aaf3b483c42456">oomph::DenseMatrix::ncol</a></div><div class="ttdeci">unsigned long ncol() const</div><div class="ttdoc">Return the number of columns of the matrix.</div><div class="ttdef"><b>Definition:</b> <a href="matrices_8h_source.html#l00503">matrices.h:503</a></div></div>
<div class="ttc" id="aclassoomph_1_1AxisymmetricNavierStokesEquations_html_a6309780fd1964c4df0cca0818ccff158"><div class="ttname"><a href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a6309780fd1964c4df0cca0818ccff158">oomph::AxisymmetricNavierStokesEquations::pshape_axi_nst</a></div><div class="ttdeci">virtual void pshape_axi_nst(const Vector&lt; double &gt; &amp;s, Shape &amp;psi) const =0</div><div class="ttdoc">Compute the pressure shape functions at local coordinate s.</div></div>
<div class="ttc" id="aclassoomph_1_1Data_html_a7e67fc78a2e8a2fd6eb75bd292d42ff8"><div class="ttname"><a href="classoomph_1_1Data.html#a7e67fc78a2e8a2fd6eb75bd292d42ff8">oomph::Data::nvalue</a></div><div class="ttdeci">unsigned nvalue() const</div><div class="ttdoc">Return number of values stored in data object (incl pinned ones).</div><div class="ttdef"><b>Definition:</b> <a href="nodes_8h_source.html#l00444">nodes.h:444</a></div></div>
<div class="ttc" id="aclassoomph_1_1FiniteElement_html_a9152c16ae9899168bcdaac7c2f977444"><div class="ttname"><a href="classoomph_1_1FiniteElement.html#a9152c16ae9899168bcdaac7c2f977444">oomph::FiniteElement::nodal_position</a></div><div class="ttdeci">double nodal_position(const unsigned &amp;n, const unsigned &amp;i) const</div><div class="ttdoc">Return the i-th coordinate at local node n. If the node is hanging, the appropriate interpolation is ...</div><div class="ttdef"><b>Definition:</b> <a href="elements_8h_source.html#l02240">elements.h:2240</a></div></div>
<div class="ttc" id="aclassoomph_1_1TimeStepper_html_ad77678873af47aa208a9385b26ac1641"><div class="ttname"><a href="classoomph_1_1TimeStepper.html#ad77678873af47aa208a9385b26ac1641">oomph::TimeStepper::time_pt</a></div><div class="ttdeci">Time *const &amp; time_pt() const</div><div class="ttdoc">Access function for the pointer to time (const version)</div><div class="ttdef"><b>Definition:</b> <a href="timesteppers_8h_source.html#l00536">timesteppers.h:536</a></div></div>
<div class="ttc" id="aclassoomph_1_1DenseMatrix_html"><div class="ttname"><a href="classoomph_1_1DenseMatrix.html">oomph::DenseMatrix&lt; double &gt;</a></div></div>
<div class="ttc" id="aclassoomph_1_1AxisymmetricNavierStokesEquations_html_ac0c850c7a41b408784f3a103f9aba982"><div class="ttname"><a href="classoomph_1_1AxisymmetricNavierStokesEquations.html#ac0c850c7a41b408784f3a103f9aba982">oomph::AxisymmetricNavierStokesEquations::get_pressure_and_velocity_mass_matrix_diagonal</a></div><div class="ttdeci">void get_pressure_and_velocity_mass_matrix_diagonal(Vector&lt; double &gt; &amp;press_mass_diag, Vector&lt; double &gt; &amp;veloc_mass_diag, const unsigned &amp;which_one=0)</div><div class="ttdoc">Compute the diagonal of the velocity/pressure mass matrices. If which one=0, both are computed,...</div><div class="ttdef"><b>Definition:</b> <a href="axisym__navier__stokes__elements_8cc_source.html#l00065">axisym_navier_stokes_elements.cc:65</a></div></div>
<div class="ttc" id="aclassoomph_1_1AxisymmetricNavierStokesEquations_html_a76e090fdac4507d10eb9f81feb53a51b"><div class="ttname"><a href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a76e090fdac4507d10eb9f81feb53a51b">oomph::AxisymmetricNavierStokesEquations::dshape_and_dtest_eulerian_at_knot_axi_nst</a></div><div class="ttdeci">virtual double dshape_and_dtest_eulerian_at_knot_axi_nst(const unsigned &amp;ipt, Shape &amp;psi, DShape &amp;dpsidx, Shape &amp;test, DShape &amp;dtestdx) const =0</div><div class="ttdoc">Compute the shape functions and derivatives w.r.t. global coords at ipt-th integration point Return J...</div></div>
<div class="ttc" id="aclassoomph_1_1AxisymmetricNavierStokesEquations_html_a64f354d90dcae78352e08b369a4c2a02"><div class="ttname"><a href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a64f354d90dcae78352e08b369a4c2a02">oomph::AxisymmetricNavierStokesEquations::re_st_pt</a></div><div class="ttdeci">double *&amp; re_st_pt()</div><div class="ttdoc">Pointer to product of Reynolds and Strouhal number (=Womersley number)</div><div class="ttdef"><b>Definition:</b> <a href="axisym__navier__stokes__elements_8h_source.html#l00504">axisym_navier_stokes_elements.h:504</a></div></div>
<div class="ttc" id="aclassoomph_1_1AxisymmetricNavierStokesEquations_html_ad12929a11d71f7d91627f3edc8f2cdce"><div class="ttname"><a href="classoomph_1_1AxisymmetricNavierStokesEquations.html#ad12929a11d71f7d91627f3edc8f2cdce">oomph::AxisymmetricNavierStokesEquations::strain_rate</a></div><div class="ttdeci">void strain_rate(const Vector&lt; double &gt; &amp;s, DenseMatrix&lt; double &gt; &amp;strain_rate) const</div><div class="ttdoc">Strain-rate tensor:  where  (in that order)</div><div class="ttdef"><b>Definition:</b> <a href="axisym__navier__stokes__elements_8cc_source.html#l00715">axisym_navier_stokes_elements.cc:715</a></div></div>
<div class="ttc" id="aclassoomph_1_1AxisymmetricNavierStokesEquations_html_aab647203e95cec99d25d42cee76a5e38"><div class="ttname"><a href="classoomph_1_1AxisymmetricNavierStokesEquations.html#aab647203e95cec99d25d42cee76a5e38">oomph::AxisymmetricNavierStokesEquations::re_invfr</a></div><div class="ttdeci">const double &amp; re_invfr() const</div><div class="ttdoc">Global inverse Froude number.</div><div class="ttdef"><b>Definition:</b> <a href="axisym__navier__stokes__elements_8h_source.html#l00507">axisym_navier_stokes_elements.h:507</a></div></div>
<div class="ttc" id="aclassoomph_1_1AxisymmetricNavierStokesEquations_html_a002f84742337fbf2dcba83866b1d089e"><div class="ttname"><a href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a002f84742337fbf2dcba83866b1d089e">oomph::AxisymmetricNavierStokesEquations::dissipation</a></div><div class="ttdeci">double dissipation() const</div><div class="ttdoc">Return integral of dissipation over element.</div><div class="ttdef"><b>Definition:</b> <a href="axisym__navier__stokes__elements_8cc_source.html#l00582">axisym_navier_stokes_elements.cc:582</a></div></div>
<div class="ttc" id="acfortran_8h_html_af6f0bd3dc13317f895c91323c25c2b8f"><div class="ttname"><a href="cfortran_8h.html#af6f0bd3dc13317f895c91323c25c2b8f">t</a></div><div class="ttdeci">char t</div><div class="ttdef"><b>Definition:</b> <a href="cfortran_8h_source.html#l00568">cfortran.h:568</a></div></div>
<div class="ttc" id="aclassoomph_1_1FiniteElement_html_aaaa11f3783ab48d882ac1858d74adba4"><div class="ttname"><a href="classoomph_1_1FiniteElement.html#aaaa11f3783ab48d882ac1858d74adba4">oomph::FiniteElement::raw_dnodal_position_dt</a></div><div class="ttdeci">double raw_dnodal_position_dt(const unsigned &amp;n, const unsigned &amp;i) const</div><div class="ttdoc">Return the i-th component of nodal velocity: dx/dt at local node n. Do not use the hanging node repre...</div><div class="ttdef"><b>Definition:</b> <a href="elements_8h_source.html#l02195">elements.h:2195</a></div></div>
<div class="ttc" id="aclassoomph_1_1AxisymmetricNavierStokesEquations_html_a7b965ac308b3a398a9365d76aa21a65f"><div class="ttname"><a href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a7b965ac308b3a398a9365d76aa21a65f">oomph::AxisymmetricNavierStokesEquations::get_source_fct</a></div><div class="ttdeci">double get_source_fct(const double &amp;time, const unsigned &amp;ipt, const Vector&lt; double &gt; &amp;x)</div><div class="ttdoc">Calculate the source fct at given time and Eulerian position.</div><div class="ttdef"><b>Definition:</b> <a href="axisym__navier__stokes__elements_8h_source.html#l00385">axisym_navier_stokes_elements.h:385</a></div></div>
<div class="ttc" id="anamespaceoomph_1_1QuadTreeNames_html_a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6"><div class="ttname"><a href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">oomph::QuadTreeNames::W</a></div><div class="ttdeci">@ W</div><div class="ttdef"><b>Definition:</b> <a href="quadtree_8h_source.html#l00056">quadtree.h:56</a></div></div>
<div class="ttc" id="aclassoomph_1_1FiniteElement_html_a82da844fd3ebb2005842464cdc148a03"><div class="ttname"><a href="classoomph_1_1FiniteElement.html#a82da844fd3ebb2005842464cdc148a03">oomph::FiniteElement::get_s_plot</a></div><div class="ttdeci">virtual void get_s_plot(const unsigned &amp;i, const unsigned &amp;nplot, Vector&lt; double &gt; &amp;s, const bool &amp;shifted_to_interior=false) const</div><div class="ttdoc">Get cector of local coordinates of plot point i (when plotting nplot points in each &quot;coordinate direc...</div><div class="ttdef"><b>Definition:</b> <a href="elements_8h_source.html#l03006">elements.h:3006</a></div></div>
<div class="ttc" id="aclassoomph_1_1AxisymmetricQTaylorHoodElement_html_abfaf2fb0ff51a888f77c724af8c20809"><div class="ttname"><a href="classoomph_1_1AxisymmetricQTaylorHoodElement.html#abfaf2fb0ff51a888f77c724af8c20809">oomph::AxisymmetricQTaylorHoodElement::get_traction</a></div><div class="ttdeci">void get_traction(const Vector&lt; double &gt; &amp;s, const Vector&lt; double &gt; &amp;N, Vector&lt; double &gt; &amp;traction) const</div><div class="ttdoc">Compute traction at local coordinate s for outer unit normal N.</div><div class="ttdef"><b>Definition:</b> <a href="axisym__navier__stokes__elements_8cc_source.html#l03599">axisym_navier_stokes_elements.cc:3599</a></div></div>
<div class="ttc" id="aclassoomph_1_1Node_html_a056f8e82da938369cd38541c5cdc598a"><div class="ttname"><a href="classoomph_1_1Node.html#a056f8e82da938369cd38541c5cdc598a">oomph::Node::x</a></div><div class="ttdeci">double &amp; x(const unsigned &amp;i)</div><div class="ttdoc">Return the i-th nodal coordinate.</div><div class="ttdef"><b>Definition:</b> <a href="nodes_8h_source.html#l00990">nodes.h:990</a></div></div>
<div class="ttc" id="aclassoomph_1_1AxisymmetricNavierStokesEquations_html_a056e6c406e93a62763a0ac8912ce9e1b"><div class="ttname"><a href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a056e6c406e93a62763a0ac8912ce9e1b">oomph::AxisymmetricNavierStokesEquations::pressure_integral</a></div><div class="ttdeci">double pressure_integral() const</div><div class="ttdoc">Integral of pressure over element.</div><div class="ttdef"><b>Definition:</b> <a href="axisym__navier__stokes__elements_8cc_source.html#l00857">axisym_navier_stokes_elements.cc:857</a></div></div>
<div class="ttc" id="aclassoomph_1_1Integral_html_a1a2122f99a87c18649bafdd9ed739758"><div class="ttname"><a href="classoomph_1_1Integral.html#a1a2122f99a87c18649bafdd9ed739758">oomph::Integral::knot</a></div><div class="ttdeci">virtual double knot(const unsigned &amp;i, const unsigned &amp;j) const =0</div><div class="ttdoc">Return local coordinate s[j] of i-th integration point.</div></div>
<div class="ttc" id="aclassoomph_1_1AxisymmetricQTaylorHoodElement_html_ae0826bd23cb739552135795de862c758"><div class="ttname"><a href="classoomph_1_1AxisymmetricQTaylorHoodElement.html#ae0826bd23cb739552135795de862c758">oomph::AxisymmetricQTaylorHoodElement::Initial_Nvalue</a></div><div class="ttdeci">static const unsigned Initial_Nvalue[]</div><div class="ttdoc">Static array of ints to hold number of variables at node.</div><div class="ttdef"><b>Definition:</b> <a href="axisym__navier__stokes__elements_8h_source.html#l01542">axisym_navier_stokes_elements.h:1542</a></div></div>
<div class="ttc" id="aclassoomph_1_1AxisymmetricNavierStokesEquations_html_aea99b11bfac734a5c868aaafffadd820"><div class="ttname"><a href="classoomph_1_1AxisymmetricNavierStokesEquations.html#aea99b11bfac734a5c868aaafffadd820">oomph::AxisymmetricNavierStokesEquations::get_dresidual_dnodal_coordinates</a></div><div class="ttdeci">virtual void get_dresidual_dnodal_coordinates(RankThreeTensor&lt; double &gt; &amp;dresidual_dnodal_coordinates)</div><div class="ttdoc">Compute derivatives of elemental residual vector with respect to nodal coordinates....</div><div class="ttdef"><b>Definition:</b> <a href="axisym__navier__stokes__elements_8cc_source.html#l01528">axisym_navier_stokes_elements.cc:1528</a></div></div>
<div class="ttc" id="aclassoomph_1_1AxisymmetricQCrouzeixRaviartElement_html_a6edd4a05741c3ee8ee1ac82f7c3f9eff"><div class="ttname"><a href="classoomph_1_1AxisymmetricQCrouzeixRaviartElement.html#a6edd4a05741c3ee8ee1ac82f7c3f9eff">oomph::AxisymmetricQCrouzeixRaviartElement::Initial_Nvalue</a></div><div class="ttdeci">static const unsigned Initial_Nvalue[]</div><div class="ttdoc">Static array of ints to hold required number of variables at nodes.</div><div class="ttdef"><b>Definition:</b> <a href="axisym__navier__stokes__elements_8h_source.html#l01264">axisym_navier_stokes_elements.h:1264</a></div></div>
<div class="ttc" id="aclassoomph_1_1FiniteElement_html_ad4ecf2b61b158a4b4d351a60d23c633e"><div class="ttname"><a href="classoomph_1_1FiniteElement.html#ad4ecf2b61b158a4b4d351a60d23c633e">oomph::FiniteElement::UnsteadyExactSolutionFctPt</a></div><div class="ttdeci">void(* UnsteadyExactSolutionFctPt)(const double &amp;, const Vector&lt; double &gt; &amp;, Vector&lt; double &gt; &amp;)</div><div class="ttdoc">Function pointer for function that computes Vector-valued time-dependent function  as .</div><div class="ttdef"><b>Definition:</b> <a href="elements_8h_source.html#l01742">elements.h:1742</a></div></div>
<div class="ttc" id="aclassoomph_1_1Node_html_ad5fe8ac9dcb705612903bc6945926375"><div class="ttname"><a href="classoomph_1_1Node.html#ad5fe8ac9dcb705612903bc6945926375">oomph::Node::has_auxiliary_node_update_fct_pt</a></div><div class="ttdeci">bool has_auxiliary_node_update_fct_pt()</div><div class="ttdoc">Boolean to indicate if node has a pointer to and auxiliary update function.</div><div class="ttdef"><b>Definition:</b> <a href="nodes_8h_source.html#l01496">nodes.h:1496</a></div></div>
<div class="ttc" id="aclassoomph_1_1FiniteElement_html_a79f1710873332823c47023d370f0596b"><div class="ttname"><a href="classoomph_1_1FiniteElement.html#a79f1710873332823c47023d370f0596b">oomph::FiniteElement::integral_pt</a></div><div class="ttdeci">Integral *const &amp; integral_pt() const</div><div class="ttdoc">Return the pointer to the integration scheme (const version)</div><div class="ttdef"><b>Definition:</b> <a href="elements_8h_source.html#l01921">elements.h:1921</a></div></div>
<div class="ttc" id="aclassoomph_1_1GeneralisedElement_html_a37ac5a1d5234fa931ab710c0c74d55d2"><div class="ttname"><a href="classoomph_1_1GeneralisedElement.html#a37ac5a1d5234fa931ab710c0c74d55d2">oomph::GeneralisedElement::eqn_number</a></div><div class="ttdeci">unsigned long eqn_number(const unsigned &amp;ieqn_local) const</div><div class="ttdoc">Return the global equation number corresponding to the ieqn_local-th local equation number.</div><div class="ttdef"><b>Definition:</b> <a href="elements_8h_source.html#l00705">elements.h:705</a></div></div>
<div class="ttc" id="aclassoomph_1_1AxisymmetricNavierStokesEquations_html_a5326eb9f37e9ca42103ea7c72622a415"><div class="ttname"><a href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a5326eb9f37e9ca42103ea7c72622a415">oomph::AxisymmetricNavierStokesEquations::re</a></div><div class="ttdeci">const double &amp; re() const</div><div class="ttdoc">Reynolds number.</div><div class="ttdef"><b>Definition:</b> <a href="axisym__navier__stokes__elements_8h_source.html#l00495">axisym_navier_stokes_elements.h:495</a></div></div>
<div class="ttc" id="aclassoomph_1_1AxisymmetricNavierStokesEquations_html_a9b7e10587877daae2ef6be75cc35bef8"><div class="ttname"><a href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a9b7e10587877daae2ef6be75cc35bef8">oomph::AxisymmetricNavierStokesEquations::get_source_fct_gradient</a></div><div class="ttdeci">virtual void get_source_fct_gradient(const double &amp;time, const unsigned &amp;ipt, const Vector&lt; double &gt; &amp;x, Vector&lt; double &gt; &amp;gradient)</div><div class="ttdef"><b>Definition:</b> <a href="axisym__navier__stokes__elements_8h_source.html#l00398">axisym_navier_stokes_elements.h:398</a></div></div>
<div class="ttc" id="anamespaceoomph_html"><div class="ttname"><a href="namespaceoomph.html">oomph</a></div><div class="ttdoc">DRAIG: Change all instances of (SPATIAL_DIM) to (DIM-1).</div><div class="ttdef"><b>Definition:</b> <a href="advection__diffusion__elements_8cc_source.html#l00029">advection_diffusion_elements.cc:29</a></div></div>
<div class="ttc" id="aclassoomph_1_1AxisymmetricNavierStokesEquations_html_a823b3494f75b435cf8d0fbe5572937a8"><div class="ttname"><a href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a823b3494f75b435cf8d0fbe5572937a8">oomph::AxisymmetricNavierStokesEquations::kin_energy</a></div><div class="ttdeci">double kin_energy() const</div><div class="ttdoc">Get integral of kinetic energy over element.</div><div class="ttdef"><b>Definition:</b> <a href="axisym__navier__stokes__elements_8cc_source.html#l00811">axisym_navier_stokes_elements.cc:811</a></div></div>
<div class="ttc" id="aclassoomph_1_1FiniteElement_html_a6219ed269a6d89b5aa14659cce48905a"><div class="ttname"><a href="classoomph_1_1FiniteElement.html#a6219ed269a6d89b5aa14659cce48905a">oomph::FiniteElement::nnode</a></div><div class="ttdeci">unsigned nnode() const</div><div class="ttdoc">Return the number of nodes.</div><div class="ttdef"><b>Definition:</b> <a href="elements_8h_source.html#l02159">elements.h:2159</a></div></div>
<div class="ttc" id="aclassoomph_1_1AxisymmetricQCrouzeixRaviartElement_html_a923c2ccbc5bd523118273e63cc18fd5f"><div class="ttname"><a href="classoomph_1_1AxisymmetricQCrouzeixRaviartElement.html#a923c2ccbc5bd523118273e63cc18fd5f">oomph::AxisymmetricQCrouzeixRaviartElement::npres_axi_nst</a></div><div class="ttdeci">unsigned npres_axi_nst() const</div><div class="ttdoc">Return number of pressure values.</div><div class="ttdef"><b>Definition:</b> <a href="axisym__navier__stokes__elements_8h_source.html#l01332">axisym_navier_stokes_elements.h:1332</a></div></div>
<div class="ttc" id="aclassoomph_1_1Node_html"><div class="ttname"><a href="classoomph_1_1Node.html">oomph::Node</a></div><div class="ttdoc">Nodes are derived from Data, but, in addition, have a definite (Eulerian) position in a space of a gi...</div><div class="ttdef"><b>Definition:</b> <a href="nodes_8h_source.html#l00847">nodes.h:847</a></div></div>
<div class="ttc" id="aclassoomph_1_1Vector_html"><div class="ttname"><a href="classoomph_1_1Vector.html">oomph::Vector&lt; double &gt;</a></div></div>
<div class="ttc" id="aclassoomph_1_1AxisymmetricNavierStokesEquations_html_ab355488fd99663f08df3aa24d8a8eec4"><div class="ttname"><a href="classoomph_1_1AxisymmetricNavierStokesEquations.html#ab355488fd99663f08df3aa24d8a8eec4">oomph::AxisymmetricNavierStokesEquations::interpolated_p_axi_nst</a></div><div class="ttdeci">double interpolated_p_axi_nst(const Vector&lt; double &gt; &amp;s) const</div><div class="ttdoc">Return FE interpolated pressure at local coordinate s.</div><div class="ttdef"><b>Definition:</b> <a href="axisym__navier__stokes__elements_8h_source.html#l01033">axisym_navier_stokes_elements.h:1033</a></div></div>
<div class="ttc" id="aclassoomph_1_1AxisymmetricNavierStokesEquations_html_ab4a21f4cfb33ae0561d572126d672964"><div class="ttname"><a href="classoomph_1_1AxisymmetricNavierStokesEquations.html#ab4a21f4cfb33ae0561d572126d672964">oomph::AxisymmetricNavierStokesEquations::get_body_force_gradient_axi_nst</a></div><div class="ttdeci">virtual void get_body_force_gradient_axi_nst(const double &amp;time, const unsigned &amp;ipt, const Vector&lt; double &gt; &amp;s, const Vector&lt; double &gt; &amp;x, DenseMatrix&lt; double &gt; &amp;d_body_force_dx)</div><div class="ttdoc">Get gradient of body force term at (Eulerian) position x. Computed via function pointer (if set) or b...</div><div class="ttdef"><b>Definition:</b> <a href="axisym__navier__stokes__elements_8h_source.html#l00347">axisym_navier_stokes_elements.h:347</a></div></div>
<div class="ttc" id="aclassoomph_1_1AxisymmetricNavierStokesEquations_html_a454a2d627bad75944359e90be0a535a5"><div class="ttname"><a href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a454a2d627bad75944359e90be0a535a5">oomph::AxisymmetricNavierStokesEquations::output_fct</a></div><div class="ttdeci">void output_fct(std::ostream &amp;outfile, const unsigned &amp;nplot, FiniteElement::SteadyExactSolutionFctPt exact_soln_pt)</div><div class="ttdoc">Output exact solution specified via function pointer at a given number of plot points....</div><div class="ttdef"><b>Definition:</b> <a href="axisym__navier__stokes__elements_8cc_source.html#l00298">axisym_navier_stokes_elements.cc:298</a></div></div>
<div class="ttc" id="aclassoomph_1_1AxisymmetricNavierStokesEquations_html_a4cf2dc737978f76fc7e0ad6358414f88"><div class="ttname"><a href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a4cf2dc737978f76fc7e0ad6358414f88">oomph::AxisymmetricNavierStokesEquations::viscosity_ratio</a></div><div class="ttdeci">const double &amp; viscosity_ratio() const</div><div class="ttdoc">Viscosity ratio for element: Element's viscosity relative to the viscosity used in the definition of ...</div><div class="ttdef"><b>Definition:</b> <a href="axisym__navier__stokes__elements_8h_source.html#l00533">axisym_navier_stokes_elements.h:533</a></div></div>
<div class="ttc" id="aclassoomph_1_1FiniteElement_html_aa8a201e448a9200af7f87d612ef01227"><div class="ttname"><a href="classoomph_1_1FiniteElement.html#aa8a201e448a9200af7f87d612ef01227">oomph::FiniteElement::J_eulerian_at_knot</a></div><div class="ttdeci">virtual double J_eulerian_at_knot(const unsigned &amp;ipt) const</div><div class="ttdoc">Return the Jacobian of the mapping from local to global coordinates at the ipt-th integration point.</div><div class="ttdef"><b>Definition:</b> <a href="elements_8cc_source.html#l04082">elements.cc:4082</a></div></div>
<div class="ttc" id="aclassoomph_1_1FiniteElement_html_a58a25b6859ddd43b7bfe64a19fee5023"><div class="ttname"><a href="classoomph_1_1FiniteElement.html#a58a25b6859ddd43b7bfe64a19fee5023">oomph::FiniteElement::shape</a></div><div class="ttdeci">virtual void shape(const Vector&lt; double &gt; &amp;s, Shape &amp;psi) const =0</div><div class="ttdoc">Calculate the geometric shape functions at local coordinate s. This function must be overloaded for e...</div></div>
<div class="ttc" id="aclassoomph_1_1AxisymmetricQCrouzeixRaviartElement_html_ae7988679549e63ef87fc3f062fb6a559"><div class="ttname"><a href="classoomph_1_1AxisymmetricQCrouzeixRaviartElement.html#ae7988679549e63ef87fc3f062fb6a559">oomph::AxisymmetricQCrouzeixRaviartElement::required_nvalue</a></div><div class="ttdeci">virtual unsigned required_nvalue(const unsigned &amp;n) const</div><div class="ttdoc">Number of values (pinned or dofs) required at local node n.</div><div class="ttdef"><b>Definition:</b> <a href="axisym__navier__stokes__elements_8cc_source.html#l03517">axisym_navier_stokes_elements.cc:3517</a></div></div>
<div class="ttc" id="acfortran_8h_html_adb50e893b86b3e55e751a42eab3cba82"><div class="ttname"><a href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a></div><div class="ttdeci">cstr elem_len * i</div><div class="ttdef"><b>Definition:</b> <a href="cfortran_8h_source.html#l00603">cfortran.h:603</a></div></div>
<div class="ttc" id="aclassoomph_1_1DenseMatrix_html_a1b425094510d833ffe91920747a0a962"><div class="ttname"><a href="classoomph_1_1DenseMatrix.html#a1b425094510d833ffe91920747a0a962">oomph::DenseMatrix::nrow</a></div><div class="ttdeci">unsigned long nrow() const</div><div class="ttdoc">Return the number of rows of the matrix.</div><div class="ttdef"><b>Definition:</b> <a href="matrices_8h_source.html#l00500">matrices.h:500</a></div></div>
<div class="ttc" id="aclassoomph_1_1AxisymmetricNavierStokesEquations_html_a2b2641a17d3406043cdf535fb6ede367"><div class="ttname"><a href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a2b2641a17d3406043cdf535fb6ede367">oomph::AxisymmetricNavierStokesEquations::re_invfr_pt</a></div><div class="ttdeci">double *&amp; re_invfr_pt()</div><div class="ttdoc">Pointer to global inverse Froude number.</div><div class="ttdef"><b>Definition:</b> <a href="axisym__navier__stokes__elements_8h_source.html#l00510">axisym_navier_stokes_elements.h:510</a></div></div>
<div class="ttc" id="aclassoomph_1_1AxisymmetricNavierStokesEquations_html_afe0c7b607ec3fd03a73b7db4f1fe6252"><div class="ttname"><a href="classoomph_1_1AxisymmetricNavierStokesEquations.html#afe0c7b607ec3fd03a73b7db4f1fe6252">oomph::AxisymmetricNavierStokesEquations::output</a></div><div class="ttdeci">void output(std::ostream &amp;outfile)</div><div class="ttdoc">Output function: x,y,[z],u,v,[w],p in tecplot format. Default number of plot points.</div><div class="ttdef"><b>Definition:</b> <a href="axisym__navier__stokes__elements_8h_source.html#l00760">axisym_navier_stokes_elements.h:760</a></div></div>
<div class="ttc" id="aclassoomph_1_1FiniteElement_html_a3193df31f9ce38e0609d17a8ffb386c6"><div class="ttname"><a href="classoomph_1_1FiniteElement.html#a3193df31f9ce38e0609d17a8ffb386c6">oomph::FiniteElement::tecplot_zone_string</a></div><div class="ttdeci">virtual std::string tecplot_zone_string(const unsigned &amp;nplot) const</div><div class="ttdoc">Return string for tecplot zone header (when plotting nplot points in each &quot;coordinate direction&quot;)</div><div class="ttdef"><b>Definition:</b> <a href="elements_8h_source.html#l03018">elements.h:3018</a></div></div>
<div class="ttc" id="aclassoomph_1_1GeneralisedElement_html_a37204f67b37d212fd170c68d48f6da57"><div class="ttname"><a href="classoomph_1_1GeneralisedElement.html#a37204f67b37d212fd170c68d48f6da57">oomph::GeneralisedElement::ndof</a></div><div class="ttdeci">unsigned ndof() const</div><div class="ttdoc">Return the number of equations/dofs in the element.</div><div class="ttdef"><b>Definition:</b> <a href="elements_8h_source.html#l00830">elements.h:830</a></div></div>
<div class="ttc" id="anamespaceoomph_1_1QuadTreeNames_html_a8954a5947b19986b8c4b755bc7639f7dabc60bec4cc294aa2adf92726c6d6823a"><div class="ttname"><a href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7dabc60bec4cc294aa2adf92726c6d6823a">oomph::QuadTreeNames::N</a></div><div class="ttdeci">@ N</div><div class="ttdef"><b>Definition:</b> <a href="quadtree_8h_source.html#l00056">quadtree.h:56</a></div></div>
<div class="ttc" id="aclassoomph_1_1Node_html_a89175b154594ba5b1a6cdde6f385dc71"><div class="ttname"><a href="classoomph_1_1Node.html#a89175b154594ba5b1a6cdde6f385dc71">oomph::Node::position_time_stepper_pt</a></div><div class="ttdeci">TimeStepper *&amp; position_time_stepper_pt()</div><div class="ttdoc">Return a pointer to the position timestepper.</div><div class="ttdef"><b>Definition:</b> <a href="nodes_8h_source.html#l00964">nodes.h:964</a></div></div>
<div class="ttc" id="aclassoomph_1_1AxisymmetricNavierStokesEquations_html_a8ee03721082e7ca463e79083f4029b24"><div class="ttname"><a href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a8ee03721082e7ca463e79083f4029b24">oomph::AxisymmetricNavierStokesEquations::Default_Physical_Constant_Value</a></div><div class="ttdeci">static double Default_Physical_Constant_Value</div><div class="ttdoc">Static default value for the physical constants (all initialised to zero)</div><div class="ttdef"><b>Definition:</b> <a href="axisym__navier__stokes__elements_8h_source.html#l00227">axisym_navier_stokes_elements.h:227</a></div></div>
<div class="ttc" id="aclassoomph_1_1DShape_html"><div class="ttname"><a href="classoomph_1_1DShape.html">oomph::DShape</a></div><div class="ttdef"><b>Definition:</b> <a href="shape_8h_source.html#l00271">shape.h:271</a></div></div>
<div class="ttc" id="aclassoomph_1_1AxisymmetricNavierStokesEquations_html_a6be05bce8f257044e1bb6929aa5e791e"><div class="ttname"><a href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a6be05bce8f257044e1bb6929aa5e791e">oomph::AxisymmetricNavierStokesEquations::interpolated_u_axi_nst</a></div><div class="ttdeci">void interpolated_u_axi_nst(const Vector&lt; double &gt; &amp;s, Vector&lt; double &gt; &amp;veloc) const</div><div class="ttdoc">Compute vector of FE interpolated velocity u at local coordinate s.</div><div class="ttdef"><b>Definition:</b> <a href="axisym__navier__stokes__elements_8h_source.html#l00900">axisym_navier_stokes_elements.h:900</a></div></div>
<div class="ttc" id="aclassoomph_1_1Data_html_a559dc196abee87cad34d655c8d6dac1e"><div class="ttname"><a href="classoomph_1_1Data.html#a559dc196abee87cad34d655c8d6dac1e">oomph::Data::value_pt</a></div><div class="ttdeci">double * value_pt(const unsigned &amp;i) const</div><div class="ttdoc">Return the pointer to the i-the stored value. Typically this is required when direct access to the st...</div><div class="ttdef"><b>Definition:</b> <a href="nodes_8h_source.html#l00318">nodes.h:318</a></div></div>
<div class="ttc" id="athe__data__structure_8txt_html_af88b2d950fae19ab641bd1690e08445c"><div class="ttname"><a href="the__data__structure_8txt.html#af88b2d950fae19ab641bd1690e08445c">n</a></div><div class="ttdeci">endcode We introduce wrapper functions to access function so that we can formulate The Maths in generic terms Rather than referring to the pressure at node c n</div><div class="ttdef"><b>Definition:</b> <a href="the__data__structure_8txt_source.html#l00582">the_data_structure.txt:582</a></div></div>
<div class="ttc" id="aclassoomph_1_1FiniteElement_html_a5da80bbed97543e586f698251d67941d"><div class="ttname"><a href="classoomph_1_1FiniteElement.html#a5da80bbed97543e586f698251d67941d">oomph::FiniteElement::nodal_local_eqn</a></div><div class="ttdeci">int nodal_local_eqn(const unsigned &amp;n, const unsigned &amp;i) const</div><div class="ttdoc">Return the local equation number corresponding to the i-th value at the n-th local node.</div><div class="ttdef"><b>Definition:</b> <a href="elements_8h_source.html#l01399">elements.h:1399</a></div></div>
<div class="ttc" id="aclassoomph_1_1AxisymmetricNavierStokesEquations_html_a97f46e5472537187107d0454b6013b5f"><div class="ttname"><a href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a97f46e5472537187107d0454b6013b5f">oomph::AxisymmetricNavierStokesEquations::ALE_is_disabled</a></div><div class="ttdeci">bool ALE_is_disabled</div><div class="ttdoc">Boolean flag to indicate if ALE formulation is disabled when the time-derivatives are computed....</div><div class="ttdef"><b>Definition:</b> <a href="axisym__navier__stokes__elements_8h_source.html#l00278">axisym_navier_stokes_elements.h:278</a></div></div>
<div class="ttc" id="aclassoomph_1_1OomphLibWarning_html"><div class="ttname"><a href="classoomph_1_1OomphLibWarning.html">oomph::OomphLibWarning</a></div><div class="ttdef"><b>Definition:</b> <a href="oomph__definitions_8h_source.html#l00262">oomph_definitions.h:262</a></div></div>
<div class="ttc" id="aclassoomph_1_1FiniteElement_html_abdc430bef622e0257397407416e6aac8"><div class="ttname"><a href="classoomph_1_1FiniteElement.html#abdc430bef622e0257397407416e6aac8">oomph::FiniteElement::raw_nodal_value</a></div><div class="ttdeci">double raw_nodal_value(const unsigned &amp;n, const unsigned &amp;i) const</div><div class="ttdoc">Return the i-th value stored at local node n but do NOT take hanging nodes into account.</div><div class="ttdef"><b>Definition:</b> <a href="elements_8h_source.html#l02471">elements.h:2471</a></div></div>
<div class="ttc" id="aclassoomph_1_1GeneralisedElement_html_a3d46b71d27f94aeba21aff1ef84fd0a6"><div class="ttname"><a href="classoomph_1_1GeneralisedElement.html#a3d46b71d27f94aeba21aff1ef84fd0a6">oomph::GeneralisedElement::local_eqn_number</a></div><div class="ttdeci">int local_eqn_number(const unsigned long &amp;ieqn_global) const</div><div class="ttdoc">Return the local equation number corresponding to the ieqn_global-th global equation number....</div><div class="ttdef"><b>Definition:</b> <a href="elements_8h_source.html#l00727">elements.h:727</a></div></div>
<div class="ttc" id="athe__data__structure_8txt_html_a15043ffc2013f4797ce93c4d1cc7a9ba"><div class="ttname"><a href="the__data__structure_8txt.html#a15043ffc2013f4797ce93c4d1cc7a9ba">press</a></div><div class="ttdeci">double press</div><div class="ttdef"><b>Definition:</b> <a href="the__data__structure_8txt_source.html#l00585">the_data_structure.txt:585</a></div></div>
<div class="ttc" id="aclassoomph_1_1Data_html_a5b34970d16205921dca3ada720da8445"><div class="ttname"><a href="classoomph_1_1Data.html#a5b34970d16205921dca3ada720da8445">oomph::Data::time_stepper_pt</a></div><div class="ttdeci">TimeStepper *&amp; time_stepper_pt()</div><div class="ttdoc">Return the pointer to the timestepper.</div><div class="ttdef"><b>Definition:</b> <a href="nodes_8h_source.html#l00242">nodes.h:242</a></div></div>
<div class="ttc" id="aclassoomph_1_1TimeStepper_html_a4cb0aecb044b77ba0553cdd54b586d8a"><div class="ttname"><a href="classoomph_1_1TimeStepper.html#a4cb0aecb044b77ba0553cdd54b586d8a">oomph::TimeStepper::weight</a></div><div class="ttdeci">virtual double weight(const unsigned &amp;i, const unsigned &amp;j) const</div><div class="ttdoc">Access function for j-th weight for the i-th derivative.</div><div class="ttdef"><b>Definition:</b> <a href="timesteppers_8h_source.html#l00553">timesteppers.h:553</a></div></div>
<div class="ttc" id="aclassoomph_1_1AxisymmetricQCrouzeixRaviartElement_html_a83a50021a007f1a932fe841119d93412"><div class="ttname"><a href="classoomph_1_1AxisymmetricQCrouzeixRaviartElement.html#a83a50021a007f1a932fe841119d93412">oomph::AxisymmetricQCrouzeixRaviartElement::get_dof_numbers_for_unknowns</a></div><div class="ttdeci">void get_dof_numbers_for_unknowns(std::list&lt; std::pair&lt; unsigned long, unsigned &gt; &gt; &amp;dof_lookup_list) const</div><div class="ttdoc">Create a list of pairs for all unknowns in this element, so that the first entry in each pair contain...</div><div class="ttdef"><b>Definition:</b> <a href="axisym__navier__stokes__elements_8cc_source.html#l03442">axisym_navier_stokes_elements.cc:3442</a></div></div>
<div class="ttc" id="acfortran_8h_html_a37cd013acc76697829c324bdd8562d82"><div class="ttname"><a href="cfortran_8h.html#a37cd013acc76697829c324bdd8562d82">e</a></div><div class="ttdeci">e</div><div class="ttdef"><b>Definition:</b> <a href="cfortran_8h_source.html#l00571">cfortran.h:571</a></div></div>
<div class="ttc" id="aclassoomph_1_1FiniteElement_html_a28fd5c2d4aeba5ef65bee0e0d72569f5"><div class="ttname"><a href="classoomph_1_1FiniteElement.html#a28fd5c2d4aeba5ef65bee0e0d72569f5">oomph::FiniteElement::nodal_value</a></div><div class="ttdeci">double nodal_value(const unsigned &amp;n, const unsigned &amp;i) const</div><div class="ttdoc">Return the i-th value stored at local node n. Produces suitably interpolated values for hanging nodes...</div><div class="ttdef"><b>Definition:</b> <a href="elements_8h_source.html#l02483">elements.h:2483</a></div></div>
<div class="ttc" id="aclassoomph_1_1Integral_html_ac65335e2aab120b285b3d6c294507b06"><div class="ttname"><a href="classoomph_1_1Integral.html#ac65335e2aab120b285b3d6c294507b06">oomph::Integral::weight</a></div><div class="ttdeci">virtual double weight(const unsigned &amp;i) const =0</div><div class="ttdoc">Return weight of i-th integration point.</div></div>
<div class="ttc" id="aclassoomph_1_1AxisymmetricNavierStokesEquations_html_adf10fc1309b9aeb92dc11be274ae65a2"><div class="ttname"><a href="classoomph_1_1AxisymmetricNavierStokesEquations.html#adf10fc1309b9aeb92dc11be274ae65a2">oomph::AxisymmetricNavierStokesEquations::get_body_force_axi_nst</a></div><div class="ttdeci">virtual void get_body_force_axi_nst(const double &amp;time, const unsigned &amp;ipt, const Vector&lt; double &gt; &amp;s, const Vector&lt; double &gt; &amp;x, Vector&lt; double &gt; &amp;result)</div><div class="ttdoc">Calculate the body force fct at a given time and Eulerian position.</div><div class="ttdef"><b>Definition:</b> <a href="axisym__navier__stokes__elements_8h_source.html#l00325">axisym_navier_stokes_elements.h:325</a></div></div>
<div class="ttc" id="aclassoomph_1_1Shape_html"><div class="ttname"><a href="classoomph_1_1Shape.html">oomph::Shape</a></div><div class="ttdef"><b>Definition:</b> <a href="shape_8h_source.html#l00077">shape.h:77</a></div></div>
<div class="ttc" id="aclassoomph_1_1FiniteElement_html_abe831900a6d6a08ee4a43fd9c07af32e"><div class="ttname"><a href="classoomph_1_1FiniteElement.html#abe831900a6d6a08ee4a43fd9c07af32e">oomph::FiniteElement::raw_nodal_position</a></div><div class="ttdeci">double raw_nodal_position(const unsigned &amp;n, const unsigned &amp;i) const</div><div class="ttdoc">Return the i-th coordinate at local node n. Do not use the hanging node representation....</div><div class="ttdef"><b>Definition:</b> <a href="elements_8cc_source.html#l01655">elements.cc:1655</a></div></div>
<div class="ttc" id="aclassoomph_1_1AxisymmetricNavierStokesEquations_html_a295dab32c432e6f2597db7aa78c306d9"><div class="ttname"><a href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a295dab32c432e6f2597db7aa78c306d9">oomph::AxisymmetricNavierStokesEquations::fill_in_contribution_to_hessian_vector_products</a></div><div class="ttdeci">void fill_in_contribution_to_hessian_vector_products(Vector&lt; double &gt; const &amp;Y, DenseMatrix&lt; double &gt; const &amp;C, DenseMatrix&lt; double &gt; &amp;product)</div><div class="ttdoc">Compute the hessian tensor vector products required to perform continuation of bifurcations analytica...</div><div class="ttdef"><b>Definition:</b> <a href="axisym__navier__stokes__elements_8cc_source.html#l03047">axisym_navier_stokes_elements.cc:3047</a></div></div>
<div class="ttc" id="aclassoomph_1_1AxisymmetricQTaylorHoodElement_html_ad763c91177814d4221ec485b076a38e9"><div class="ttname"><a href="classoomph_1_1AxisymmetricQTaylorHoodElement.html#ad763c91177814d4221ec485b076a38e9">oomph::AxisymmetricQTaylorHoodElement::get_dof_numbers_for_unknowns</a></div><div class="ttdeci">void get_dof_numbers_for_unknowns(std::list&lt; std::pair&lt; unsigned long, unsigned &gt; &gt; &amp;dof_lookup_list) const</div><div class="ttdoc">Create a list of pairs for all unknowns in this element, so that the first entry in each pair contain...</div><div class="ttdef"><b>Definition:</b> <a href="axisym__navier__stokes__elements_8cc_source.html#l03544">axisym_navier_stokes_elements.cc:3544</a></div></div>
<div class="ttc" id="acfortran_8h_html_ab7123126e4885ef647dd9c6e3807a21c"><div class="ttname"><a href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a></div><div class="ttdeci">static char t char * s</div><div class="ttdef"><b>Definition:</b> <a href="cfortran_8h_source.html#l00568">cfortran.h:568</a></div></div>
<div class="ttc" id="aclassoomph_1_1AxisymmetricNavierStokesEquations_html_a19a4b0c9d98bd79212fe8b507d44f7ab"><div class="ttname"><a href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a19a4b0c9d98bd79212fe8b507d44f7ab">oomph::AxisymmetricNavierStokesEquations::fill_in_generic_dresidual_contribution_axi_nst</a></div><div class="ttdeci">virtual void fill_in_generic_dresidual_contribution_axi_nst(double *const &amp;parameter_pt, Vector&lt; double &gt; &amp;dres_dparam, DenseMatrix&lt; double &gt; &amp;djac_dparam, DenseMatrix&lt; double &gt; &amp;dmass_matrix_dparam, unsigned flag)</div><div class="ttdoc">Compute the derivative of residuals for the NavierStokes equations; with respect to a parameeter fla...</div><div class="ttdef"><b>Definition:</b> <a href="axisym__navier__stokes__elements_8cc_source.html#l02358">axisym_navier_stokes_elements.cc:2358</a></div></div>
<div class="ttc" id="aclassoomph_1_1AxisymmetricNavierStokesEquations_html_a30e9502122f5c88cdfb33edb45d88c5f"><div class="ttname"><a href="classoomph_1_1AxisymmetricNavierStokesEquations.html#a30e9502122f5c88cdfb33edb45d88c5f">oomph::AxisymmetricNavierStokesEquations::re_invro</a></div><div class="ttdeci">const double &amp; re_invro() const</div><div class="ttdoc">Global Reynolds number multiplied by inverse Rossby number.</div><div class="ttdef"><b>Definition:</b> <a href="axisym__navier__stokes__elements_8h_source.html#l00513">axisym_navier_stokes_elements.h:513</a></div></div>
<div class="ttc" id="aclassoomph_1_1AxisymmetricQTaylorHoodElement_html_a40720e74e6b8ce8d803ee95d7a6ad119"><div class="ttname"><a href="classoomph_1_1AxisymmetricQTaylorHoodElement.html#a40720e74e6b8ce8d803ee95d7a6ad119">oomph::AxisymmetricQTaylorHoodElement::Pconv</a></div><div class="ttdeci">static const unsigned Pconv[]</div><div class="ttdoc">Static array of ints to hold conversion from pressure node numbers to actual node numbers.</div><div class="ttdef"><b>Definition:</b> <a href="axisym__navier__stokes__elements_8h_source.html#l01548">axisym_navier_stokes_elements.h:1548</a></div></div>
<div class="ttc" id="aclassoomph_1_1AxisymmetricQCrouzeixRaviartElement_html_adc569122e3649deba56231175f3116cf"><div class="ttname"><a href="classoomph_1_1AxisymmetricQCrouzeixRaviartElement.html#adc569122e3649deba56231175f3116cf">oomph::AxisymmetricQCrouzeixRaviartElement::p_local_eqn</a></div><div class="ttdeci">int p_local_eqn(const unsigned &amp;n) const</div><div class="ttdoc">Overload the access function for the pressure's local equation numbers.</div><div class="ttdef"><b>Definition:</b> <a href="axisym__navier__stokes__elements_8h_source.html#l01347">axisym_navier_stokes_elements.h:1347</a></div></div>

    <!-- jQuery for Bootstrap and Doxygen -->
    <script src="../../js/jquery-1.12.0.min.js"></script>
    <!-- Minified boostrap plugins-->
    <script src="../../js/bootstrap.js"></script>
    <!-- Doxygen dependency to add powertips to source code-->
    <script src="../../js/jquery.powertip.min.js"></script>
    <!-- The  following script is generated by doxygen and hides/shows levels in 
         the data structure lists and adds powertips to source code-->
    <script src="../../js/dynsections.js" ></script>
    <!-- add to Doxygen's class names so bootstrap css and js recognises them-->
    <script type="text/javascript">
    $(".contents").addClass("container");
    $(".header").addClass("container");
    $(".navpath").addClass("container");
    $("#navrow3").addClass("container");
    $("#navrow4").addClass("container");
    $(".mlabel").addClass("label");
    $(".mlabel").addClass("label-default");
    $(".memitem").addClass("panel");
    $(".memitem").addClass("panel-info");
    $(".memproto").addClass("panel-heading");
    $(".memdoc").addClass("panel-body");
    </script>
    <footer>
      <div class="container">
        <div class="text-muted" style="float:right;">Generated by <a href="http://www.doxygen.org/index.html">
          <img style="height:18px;" class="footer-img" src="doxygen.png" alt="doxygen"></a> on Fri Jul 9 2021 14:54:12
        </div>
      </div>
    </footer>
</body>
</html>

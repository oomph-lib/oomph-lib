<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
<title>oomph-lib: spacetime_navier_stokes_elements.h Source File</title>
<link rel="apple-touch-icon" sizes="57x57" href="../../figures/apple-touch-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="../../figures/apple-touch-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="../../figures/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="../../figures/apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="../../figures/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="../../figures/apple-touch-icon-120x120.png">
<link rel="icon" type="image/png" href="../../figures/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="../../figures/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="../../figures/favicon-16x16.png" sizes="16x16">
<link rel="manifest" href="../../figures/manifest.json">
<link rel="mask-icon" href="../../figures/safari-pinned-tab.svg" color="#008000">
<link rel="shortcut icon" href="../../figures/favicon.ico">
<meta name="msapplication-TileColor" content="#00a300">
<meta name="msapplication-config" content="../../figures/browserconfig.xml">
<meta name="theme-color" content="#008000">
<link href="http://fonts.googleapis.com/css?family=Open+Sans:400,300,600" rel="stylesheet" type="text/css">
<!-- Doxygen css-->
<!-- <link rel="stylesheet" type="text/css" href="doxygen.css"> -->
<!-- Bootstrap -->
<link href="../../css/bootstrap.css" rel="stylesheet">
<!-- oomph-lib specific overrides -->
<link rel="stylesheet" type="text/css" href="../../css/oomph_header.css">
</head>
<body>
<nav class="navbar navbar-default">
<div class="container">
<div class="container-fluid">
  <!-- Brand and toggle get grouped for better mobile display -->
  <div class="navbar-header">
    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
      <span class="sr-only">Toggle navigation</span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="../../html/index.html"><img alt="oomph-lib" src="../../figures/oomph_logo.png"></a>
  </div>
  <!-- Collect the nav links, forms, and other content for toggling -->
  <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
    <ul class="nav navbar-nav">          
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Documentation <span class="caret"></span></a>
        <ul class="dropdown-menu">
          <li class="dropdown-header">Big picture</li>
          <li><a href="../../../doc/intro/html/index.html">The finite element method</a></li>
          <li><a href="../../../doc/the_data_structure/html/index.html">The data structure</a></li>
          <li><a href="../../../doc/quick_guide/html/index.html">Not-so-quick guide</a></li>
          <li><a href="../../../doc/optimisation/html/index.html">Optimisation</a></li>
          <li><a href="../../../doc/order_of_action_functions/html/index.html">Order of action functions</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Example codes and tutorials</li>
          <li><a href="../../../doc/example_code_list/html/index.html">List of example codes and tutorials</a></li>
          <li><a href="../../../doc/example_code_list/html/index.html#meshes">Meshing</a></li>
          <li><a href="../../../doc/example_code_list/html/index.html#solvers">Solvers</a></li>
          <li><a href="../../../doc/example_code_list/html/index.html#parallel">MPI parallel processing</a></li>
          <li><a href="../../../doc/example_code_list/html/index.html#visualisation">Post-processing/visualisation</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Other</li>
          <li><a href="../../../doc/change_log/html/index.html">Change log</a></li>
          <li><a href="../../../doc/creating_doc/html/index.html">Creating documentation</a></li>
          <li><a href="../../../doc/coding_conventions/html/index.html">Coding conventions</a></li>
          <li><a href="../../../doc/index/html/index.html">Index</a></li>
          <li><a href="../../../doc/FAQ/html/index.html">FAQ</a></li>
        </ul>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Installation<span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../doc/the_distribution/html/index.html">Installation guide</a></li>
            <li><a href="../../../doc/copyright/html/index.html">Copyright</a></li>
          </ul>
        </li>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">About <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../doc/people/html/index.html">People</a></li>            
            <li><a href="../../../doc/contact/html/index.html">Contact/Get involved</a></li>
            <li><a href="../../../doc/publications/html/index.html">Publications</a></li>
            <li><a href="../../../doc/acknowledgements/html/index.html">Acknowledgements</a></li>
            <li><a href="../../../doc/picture_show/index.html">Picture show</a></li>
          </ul>
        </li>
      </li>
    </ul>
    <ul class="nav navbar-nav navbar-right navbar-search">
      <form class="navbar-form" role="search" action="../../../doc/search_results/html/index.html">
        <div class="input-group">
          <input type="text" class="form-control" placeholder="Search" name="q">
          <span class="input-group-btn">
            <button class="btn btn-default" type="submit">Go</button>
          </span>
        </div><!-- /input-group -->
       <!--<div class="form-group">
          <input type="text" class="form-control" placeholder="Search">
        </div>
        <button type="submit" class="btn btn-default">Submit</button>-->
      </form>
    </ul>
  </div><!-- /.navbar-collapse -->
</div><!-- /.container-fluid -->
</div>
</nav>
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_b17d089cb4b77527113043bd41279e98.html">space_time</a></li><li class="navelem"><a class="el" href="dir_273bbe4fe1dad6cf8b4b5072945aaeaf.html">space_time_navier_stokes</a></li><li class="navelem"><a class="el" href="dir_e5874389df1ee882b0f0cd72abf27974.html">archived_discretisations</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">spacetime_navier_stokes_elements.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="spacetime__navier__stokes__elements_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">// LIC// ====================================================================</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">// LIC// This file forms part of oomph-lib, the object-oriented,</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">// LIC// multi-physics finite-element library, available</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">// LIC// at http://www.oomph-lib.org.</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">// LIC//</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">// LIC// Copyright (C) 2006-2021 Matthias Heil and Andrew Hazel</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">// LIC//</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">// LIC// This library is free software; you can redistribute it and/or</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">// LIC// modify it under the terms of the GNU Lesser General Public</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">// LIC// License as published by the Free Software Foundation; either</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">// LIC// version 2.1 of the License, or (at your option) any later version.</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">// LIC//</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">// LIC// This library is distributed in the hope that it will be useful,</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">// LIC// but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">// LIC// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">// LIC// Lesser General Public License for more details.</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">// LIC//</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">// LIC// You should have received a copy of the GNU Lesser General Public</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">// LIC// License along with this library; if not, write to the Free Software</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">// LIC// Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">// LIC// 02110-1301  USA.</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">// LIC//</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">// LIC// The authors may be contacted at oomph-lib@maths.man.ac.uk.</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">// LIC//</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">// LIC//====================================================================</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">// Header file for SpaceTimeNavierStokes elements</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#ifndef OOMPH_SPACETIME_NAVIER_STOKES_ELEMENTS_HEADER</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#define OOMPH_SPACETIME_NAVIER_STOKES_ELEMENTS_HEADER</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160; </div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">// Config header generated by autoconfig</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#ifdef HAVE_CONFIG_H</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#include &lt;oomph-lib-config.h&gt;</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160; </div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment">// Oomph-lib headers</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#include &quot;generic.h&quot;</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160; </div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespaceoomph.html">oomph</a></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;{</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  <span class="comment">//======================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment">  /// Helper class for elements that impose Robin boundary conditions</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment">  /// on pressure advection diffusion problem required by Fp preconditioner</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment">  /// (class used to get around some templating issues)</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment"></span>  <span class="comment">//======================================================================</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  <span class="keyword">class </span>FpPressureAdvDiffRobinBCSpaceTimeElementBase</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    : <span class="keyword">public</span> <span class="keyword">virtual</span> FaceElement</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  {</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  <span class="keyword">public</span>:<span class="comment"></span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment">    /// Constructor</span></div>
<div class="line"><a name="l00050"></a><span class="lineno"><a class="line" href="classoomph_1_1FpPressureAdvDiffRobinBCSpaceTimeElementBase.html#aac1d335c1c7b46382a958598002108c6">   50</a></span>&#160;<span class="comment"></span>    <a class="code" href="classoomph_1_1FpPressureAdvDiffRobinBCSpaceTimeElementBase.html#aac1d335c1c7b46382a958598002108c6">FpPressureAdvDiffRobinBCSpaceTimeElementBase</a>() {}</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment">    /// Empty virtual destructor</span></div>
<div class="line"><a name="l00053"></a><span class="lineno"><a class="line" href="classoomph_1_1FpPressureAdvDiffRobinBCSpaceTimeElementBase.html#a10e4cc67a5eed9f05e53dc75484427ac">   53</a></span>&#160;<span class="comment"></span>    <span class="keyword">virtual</span> <a class="code" href="classoomph_1_1FpPressureAdvDiffRobinBCSpaceTimeElementBase.html#a10e4cc67a5eed9f05e53dc75484427ac">~FpPressureAdvDiffRobinBCSpaceTimeElementBase</a>() {}</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment">    /// \short This function returns the residuals for the traction</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment">    /// function. If compute_jacobian_flag=1 (or 0): do (or don&#39;t) compute</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="comment">    /// the Jacobian as well.</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment"></span>    <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1FpPressureAdvDiffRobinBCSpaceTimeElementBase.html#affbd5a0ddb22c64681bac01fb70307bb">fill_in_generic_residual_contribution_fp_press_adv_diff_robin_bc</a>(</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;      <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; <a class="code" href="the__data__structure_8txt.html#a1400a973def57b85051cfe1070be1810">residuals</a>,</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;      <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a>&amp; jacobian,</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; compute_jacobian_flag) = 0;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;  };</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment">  ///////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment">  ///////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment">  ///////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  <span class="comment">//======================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="comment">  /// A class for elements that allow the imposition of Robin boundary</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="comment">  /// conditions for the pressure advection diffusion problem in the</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="comment">  /// Fp preconditioner.</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="comment">  /// The geometrical information can be read from the FaceGeometry&lt;ELEMENT&gt;</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment">  /// class and and thus, we can be generic enough without the need to have</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="comment">  /// a separate equations class</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="comment"></span>  <span class="comment">//======================================================================</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  <span class="keyword">template</span>&lt;<span class="keyword">class</span> ELEMENT&gt;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  <span class="keyword">class </span>FpPressureAdvDiffRobinBCSpaceTimeElement</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    : <span class="keyword">public</span> <span class="keyword">virtual</span> FaceGeometry&lt;ELEMENT&gt;,</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;      <span class="keyword">public</span> <span class="keyword">virtual</span> FaceElement,</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;      <span class="keyword">public</span> <span class="keyword">virtual</span> FpPressureAdvDiffRobinBCSpaceTimeElementBase</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  {</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;  <span class="keyword">public</span>:<span class="comment"></span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="comment">    /// \short Constructor, which takes a &quot;bulk&quot; element and the value of the</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="comment">    /// index and its limit. Optional boolean flag indicates if it&#39;s called</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="comment">    /// refineable constructor.</span></div>
<div class="line"><a name="l00086"></a><span class="lineno"><a class="line" href="classoomph_1_1FpPressureAdvDiffRobinBCSpaceTimeElement.html#a78b2899448a3f8dd7fecc4a3cbd6ad7c">   86</a></span>&#160;<span class="comment"></span>    <a class="code" href="classoomph_1_1FpPressureAdvDiffRobinBCSpaceTimeElement.html#a78b2899448a3f8dd7fecc4a3cbd6ad7c">FpPressureAdvDiffRobinBCSpaceTimeElement</a>(</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;      <a class="code" href="classoomph_1_1FiniteElement.html">FiniteElement</a>* <span class="keyword">const</span>&amp; element_pt,</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span>&amp; <a class="code" href="classoomph_1_1FaceElement.html#a478d577ac6db67ecc80f1f02ae3ab170">face_index</a>,</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">bool</span>&amp; called_from_refineable_constructor = <span class="keyword">false</span>)</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;      : <a class="code" href="classoomph_1_1FaceGeometry.html">FaceGeometry</a>&lt;ELEMENT&gt;(), <a class="code" href="classoomph_1_1FaceElement.html">FaceElement</a>()</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    {</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;      <span class="comment">// Attach the geometrical information to the element. N.B. This function</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;      <span class="comment">// also assigns nbulk_value from the required_nvalue of the bulk element</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;      element_pt-&gt;<a class="code" href="classoomph_1_1FiniteElement.html#aaf7bead5b462cfd5401d97b3dbdc7af7">build_face_element</a>(<a class="code" href="classoomph_1_1FaceElement.html#a478d577ac6db67ecc80f1f02ae3ab170">face_index</a>, <span class="keyword">this</span>);</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160; </div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;      <span class="comment">// Check that the element is not a refineable 3D element</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;      <span class="keywordflow">if</span> (!called_from_refineable_constructor)</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;      {</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;        <span class="comment">// If it&#39;s a three-dimensional element</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        <span class="keywordflow">if</span> (element_pt-&gt;<a class="code" href="classoomph_1_1FiniteElement.html#a5f8fe59f06da1da9f6b7bbcbdb90ef93">dim</a>() == 3)</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        {</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;          <span class="comment">// Upcast the element to a RefineableElement</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;          <a class="code" href="classoomph_1_1RefineableElement.html">RefineableElement</a>* ref_el_pt =</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;            <span class="keyword">dynamic_cast&lt;</span><a class="code" href="classoomph_1_1RefineableElement.html">RefineableElement</a>*<span class="keyword">&gt;</span>(element_pt);</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160; </div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;          <span class="comment">// Is it actually refineable?</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;          <span class="keywordflow">if</span> (ref_el_pt != 0)</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;          {</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;            <span class="comment">// If it is refineable then check if it has any hanging nodes</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;            <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classoomph_1_1FiniteElement.html#af6bc41bed877f6f9a1705d7d375ddfde">has_hanging_nodes</a>())</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;            {</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;              <span class="comment">// Create an output stream</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;              std::ostringstream error_message_stream;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160; </div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;              <span class="comment">// Create an error message</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;              error_message_stream</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;                &lt;&lt; <span class="stringliteral">&quot;This flux element will not work correctly &quot;</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;                &lt;&lt; <span class="stringliteral">&quot;if nodes are hanging!&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160; </div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;              <span class="comment">// Throw an error message</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;              <span class="keywordflow">throw</span> <a class="code" href="classoomph_1_1OomphLibError.html">OomphLibError</a>(error_message_stream.str(),</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;                                  OOMPH_CURRENT_FUNCTION,</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;                                  OOMPH_EXCEPTION_LOCATION);</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;            }</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;          } <span class="comment">// if (ref_el_pt!=0)</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;        } <span class="comment">// if (element_pt-&gt;dim()==3)</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;      } <span class="comment">// if (!called_from_refineable_constructor)</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    } <span class="comment">// End of FpPressureAdvDiffRobinBCSpaceTimeElement</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160; </div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="comment">    /// Empty destructor</span></div>
<div class="line"><a name="l00134"></a><span class="lineno"><a class="line" href="classoomph_1_1FpPressureAdvDiffRobinBCSpaceTimeElement.html#a81f3c854938a1d179b13798f0fc941d4">  134</a></span>&#160;<span class="comment"></span>    <a class="code" href="classoomph_1_1FpPressureAdvDiffRobinBCSpaceTimeElement.html#a81f3c854938a1d179b13798f0fc941d4">~FpPressureAdvDiffRobinBCSpaceTimeElement</a>() {}</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160; </div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="comment">    /// \short This function returns the residuals for the traction</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="comment">    /// function. flag=1 (or 0): do (or don&#39;t) compute the Jacobian</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="comment">    /// as well.</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="comment"></span>    <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1FpPressureAdvDiffRobinBCSpaceTimeElement.html#a5872f914409c2a251992775d3bad8584">fill_in_generic_residual_contribution_fp_press_adv_diff_robin_bc</a>(</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;      <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; <a class="code" href="the__data__structure_8txt.html#a1400a973def57b85051cfe1070be1810">residuals</a>,</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;      <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a>&amp; jacobian,</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; flag);</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160; </div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="comment">    /// This function returns just the residuals</span></div>
<div class="line"><a name="l00147"></a><span class="lineno"><a class="line" href="classoomph_1_1FpPressureAdvDiffRobinBCSpaceTimeElement.html#a32a31077f457fd6f64084504ec212c8f">  147</a></span>&#160;<span class="comment"></span>    <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1FpPressureAdvDiffRobinBCSpaceTimeElement.html#a32a31077f457fd6f64084504ec212c8f">fill_in_contribution_to_residuals</a>(<a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; <a class="code" href="the__data__structure_8txt.html#a1400a973def57b85051cfe1070be1810">residuals</a>)</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    {</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;      <span class="comment">// Create an output stream</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;      std::ostringstream error_message;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160; </div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;      <span class="comment">// Create an error message</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;      error_message &lt;&lt; <span class="stringliteral">&quot;fill_in_contribution_to_residuals() must not be &quot;</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot;called directly.\nsince it uses the local equation &quot;</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot;numbering of the bulk element\nwhich calls the &quot;</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot;relevant helper function directly.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160; </div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;      <span class="comment">// Throw an error</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;      <span class="keywordflow">throw</span> <a class="code" href="classoomph_1_1OomphLibError.html">OomphLibError</a>(</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;        error_message.str(), OOMPH_CURRENT_FUNCTION, OOMPH_EXCEPTION_LOCATION);</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    } <span class="comment">// End of fill_in_contribution_to_residuals</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160; </div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="comment">    /// This function returns the residuals and the jacobian</span></div>
<div class="line"><a name="l00165"></a><span class="lineno"><a class="line" href="classoomph_1_1FpPressureAdvDiffRobinBCSpaceTimeElement.html#ab40e86a29f6e744e1c452e16a1712508">  165</a></span>&#160;<span class="comment"></span>    <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1FpPressureAdvDiffRobinBCSpaceTimeElement.html#ab40e86a29f6e744e1c452e16a1712508">fill_in_contribution_to_jacobian</a>(<a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; <a class="code" href="the__data__structure_8txt.html#a1400a973def57b85051cfe1070be1810">residuals</a>,</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;                                                 <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a>&amp; jacobian)</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    {</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;      <span class="comment">// Create an output stream</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;      std::ostringstream error_message;</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160; </div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;      <span class="comment">// Create an error message</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;      error_message &lt;&lt; <span class="stringliteral">&quot;fill_in_contribution_to_jacobian() must not be &quot;</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot;called directly.\nsince it uses the local equation &quot;</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot;numbering of the bulk element\nwhich calls the &quot;</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot;relevant helper function directly.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160; </div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;      <span class="comment">// Throw an error</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;      <span class="keywordflow">throw</span> <a class="code" href="classoomph_1_1OomphLibError.html">OomphLibError</a>(</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;        error_message.str(), OOMPH_CURRENT_FUNCTION, OOMPH_EXCEPTION_LOCATION);</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    } <span class="comment">// End of fill_in_contribution_to_jacobian</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160; </div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="comment">    /// Overload the output function</span></div>
<div class="line"><a name="l00184"></a><span class="lineno"><a class="line" href="classoomph_1_1FpPressureAdvDiffRobinBCSpaceTimeElement.html#a236e28f418427994d84dc0d4ce468078">  184</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1FpPressureAdvDiffRobinBCSpaceTimeElement.html#a236e28f418427994d84dc0d4ce468078">output</a>(std::ostream&amp; outfile)</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    {</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;      <span class="comment">// Call the output function from the FiniteElement base class</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;      <a class="code" href="classoomph_1_1FiniteElement.html#a2ad98a3d2ef4999f1bef62c0ff13f2a7">FiniteElement::output</a>(outfile);</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    } <span class="comment">// End of output</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160; </div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="comment">    /// Output function: x,y,[z],u,v,[w],p in tecplot format</span></div>
<div class="line"><a name="l00192"></a><span class="lineno"><a class="line" href="classoomph_1_1FpPressureAdvDiffRobinBCSpaceTimeElement.html#a1231fdc022cff3f147966f019e4bb1c2">  192</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1FpPressureAdvDiffRobinBCSpaceTimeElement.html#a1231fdc022cff3f147966f019e4bb1c2">output</a>(std::ostream&amp; outfile, <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; nplot)</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    {</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;      <span class="comment">// Call the output function from the FiniteElement base class</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;      <a class="code" href="classoomph_1_1FiniteElement.html#a2ad98a3d2ef4999f1bef62c0ff13f2a7">FiniteElement::output</a>(outfile, nplot);</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    } <span class="comment">// End of output</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;  };</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="comment">  ///////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="comment">  ///////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="comment">  ///////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;  <span class="comment">//============================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="comment">  /// Get residuals and Jacobian of Robin boundary conditions in pressure</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="comment">  /// advection diffusion problem in Fp preconditoner</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="comment">  /// NOTE: Care has to be taken here as fluxes are spatially dependent and</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="comment">  /// not temporally dependent but the template elements are space-time</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="comment">  /// elements!</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="comment"></span>  <span class="comment">//============================================================================</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;  <span class="keyword">template</span>&lt;<span class="keyword">class</span> ELEMENT&gt;</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1FpPressureAdvDiffRobinBCSpaceTimeElement.html#a5872f914409c2a251992775d3bad8584">FpPressureAdvDiffRobinBCSpaceTimeElement&lt;ELEMENT&gt;::</a></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<a class="code" href="classoomph_1_1FpPressureAdvDiffRobinBCSpaceTimeElement.html#a5872f914409c2a251992775d3bad8584">    fill_in_generic_residual_contribution_fp_press_adv_diff_robin_bc</a>(</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;      Vector&lt;double&gt;&amp; <a class="code" href="the__data__structure_8txt.html#a1400a973def57b85051cfe1070be1810">residuals</a>,</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;      DenseMatrix&lt;double&gt;&amp; jacobian,</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; flag)</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;  {</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    <span class="comment">// Throw a warning</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    <span class="keywordflow">throw</span> OomphLibError(<span class="stringliteral">&quot;You shouldn&#39;t be using this yet!&quot;</span>,</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;                        OOMPH_CURRENT_FUNCTION,</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;                        OOMPH_EXCEPTION_LOCATION);</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160; </div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    <span class="comment">// Get the dimension of the element</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    <span class="comment">// DRAIG: Should be 2 as bulk (space-time) element is 3D...</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <span class="keywordtype">unsigned</span> my_dim = this-&gt;dim();</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160; </div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <span class="comment">// Storage for local coordinates in FaceElement</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    Vector&lt;double&gt; <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>(my_dim, 0.0);</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160; </div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    <span class="comment">// Storage for local coordinates in the associated bulk element</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    Vector&lt;double&gt; s_bulk(my_dim + 1, 0.0);</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160; </div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    <span class="comment">// Storage for outer unit normal</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    <span class="comment">// DRAIG: Need to be careful here...</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    Vector&lt;double&gt; unit_normal(my_dim + 1, 0.0);</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160; </div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    <span class="comment">// Storage for velocity in bulk element</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    <span class="comment">// DRAIG: Need to be careful here...</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    Vector&lt;double&gt; velocity(my_dim, 0.0);</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160; </div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    <span class="comment">// Set the value of n_intpt</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    <span class="keywordtype">unsigned</span> n_intpt = this-&gt;integral_pt()-&gt;nweight();</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160; </div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <span class="comment">// Integer to store local equation number</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    <span class="keywordtype">int</span> local_eqn = 0;</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160; </div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    <span class="comment">// Integer to store local unknown number</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    <span class="keywordtype">int</span> local_unknown = 0;</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160; </div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <span class="comment">// Get upcast bulk element</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    ELEMENT* bulk_el_pt = <span class="keyword">dynamic_cast&lt;</span>ELEMENT*<span class="keyword">&gt;</span>(this-&gt;bulk_element_pt());</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160; </div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    <span class="comment">// Find out how many pressure dofs there are in the bulk element</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    <span class="keywordtype">unsigned</span> n_pres = bulk_el_pt-&gt;npres_nst();</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160; </div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    <span class="comment">// Get the Reynolds number from the bulk element</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    <span class="keywordtype">double</span> re = bulk_el_pt-&gt;re();</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160; </div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    <span class="comment">// Set up memory for pressure shape functions</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    Shape psip(n_pres);</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160; </div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    <span class="comment">// Set up memory for pressure test functions</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    Shape testp(n_pres);</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160; </div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    <span class="comment">// Loop over the integration points</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> ipt = 0; ipt &lt; n_intpt; ipt++)</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    {</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;      <span class="comment">// Get the integral weight</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;      <span class="keywordtype">double</span> w = this-&gt;integral_pt()-&gt;weight(ipt);</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160; </div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;      <span class="comment">// Assign values of local coordinate in FaceElement</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a> = 0; <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a> &lt; my_dim; <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;      {</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;        <span class="comment">// Get the i-th local coordinate at this knot point</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;        <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] = this-&gt;integral_pt()-&gt;knot(ipt, <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>);</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;      }</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160; </div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;      <span class="comment">// Find corresponding coordinate in the bulk element</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;      s_bulk = this-&gt;local_coordinate_in_bulk(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>);</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160; </div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;      <span class="comment">// Get outer unit normal</span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;      <span class="comment">// DRAIG: Make sure the normal is calculated properly; i.e.</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;      <span class="comment">// the normal needs to be calculated in the spatial direction</span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;      <span class="comment">// and NOT in the temporal direction!!!</span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;      this-&gt;outer_unit_normal(ipt, unit_normal);</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160; </div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;      <span class="comment">// Get velocity in bulk element</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;      bulk_el_pt-&gt;interpolated_u_nst(s_bulk, velocity);</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160; </div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;      <span class="comment">// Get normal component of velocity</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;      <span class="keywordtype">double</span> flux = 0.0;</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160; </div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;      <span class="comment">// Loop over the velocity components</span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a> = 0; <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a> &lt; my_dim; <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;      {</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;        <span class="comment">// Update the flux quantity</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;        flux += velocity[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] * unit_normal[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>];</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;      }</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160; </div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;      <span class="comment">// Modify BC: If outflow (flux&gt;0) apply Neumann condition instead</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;      <span class="keywordflow">if</span> (flux &gt; 0.0)</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;      {</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;        <span class="comment">// Apply no flux condition</span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;        flux = 0.0;</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;      }</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160; </div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;      <span class="comment">// Get the pressure at these local coordinates</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;      <span class="keywordtype">double</span> interpolated_press = bulk_el_pt-&gt;interpolated_p_nst(s_bulk);</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160; </div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;      <span class="comment">// Call the pressure shape and test functions in bulk element</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;      bulk_el_pt-&gt;pshape_nst(s_bulk, psip, testp);</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160; </div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;      <span class="comment">// Find the Jacobian of the mapping within the FaceElement</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;      <span class="keywordtype">double</span> J = this-&gt;J_eulerian(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>);</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160; </div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;      <span class="comment">// Premultiply the weights and the Jacobian</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;      <span class="keywordtype">double</span> <a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a> = w * J;</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160; </div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;      <span class="comment">// Loop over the pressure shape functions in bulk</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;      <span class="comment">// (wasteful but they&#39;ll be zero on the boundary)</span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> l = 0; l &lt; n_pres; l++)</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;      {</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;        <span class="comment">// Get the local equation number associated with this pressure dof</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;        local_eqn = bulk_el_pt-&gt;p_local_eqn(l);</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160; </div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;        <span class="comment">// If it&#39;s not a boundary condition</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;        <span class="keywordflow">if</span> (local_eqn &gt;= 0)</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;        {</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;          <span class="comment">// Update the residuals</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;          <a class="code" href="the__data__structure_8txt.html#a1400a973def57b85051cfe1070be1810">residuals</a>[local_eqn] -= re * flux * interpolated_press * testp[l] * <a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160; </div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;          <span class="comment">// If the Jacobian needs to be computed too</span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;          <span class="keywordflow">if</span> (flag)</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;          {</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;            <span class="comment">// Loop over the shape functions in bulk</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> l2 = 0; l2 &lt; n_pres; l2++)</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;            {</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;              <span class="comment">// Get the equation number associated with this pressure dof</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;              local_unknown = bulk_el_pt-&gt;p_local_eqn(l2);</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160; </div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;              <span class="comment">// If it&#39;s not a boundary condition</span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;              <span class="keywordflow">if</span> (local_unknown &gt;= 0)</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;              {</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;                <span class="comment">// Update the appropriate Jacobian entry</span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;                jacobian(local_eqn, local_unknown) -=</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;                  re * flux * psip[l2] * testp[l] * <a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;              }</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;            } <span class="comment">// for (unsigned l2=0;l2&lt;n_pres;l2++)</span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;          } <span class="comment">// if (flag)</span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;        } <span class="comment">// if (local_eqn&gt;=0)</span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;      } <span class="comment">// for (unsigned l=0;l&lt;n_pres;l++)</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    } <span class="comment">// for (unsigned ipt=0;ipt&lt;n_intpt;ipt++)</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;  } <span class="comment">// End of fill_in_generic_residual_contribution_fp_press_adv_diff_robin_bc</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;<span class="comment">  ///////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;<span class="comment">  ///////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;<span class="comment">  ///////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;  <span class="comment">//======================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;<span class="comment">  /// Template-free base class for Navier-Stokes equations to avoid</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;<span class="comment">  /// casting problems</span></div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="comment"></span>  <span class="comment">//======================================================================</span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;  <span class="keyword">class </span>TemplateFreeSpaceTimeNavierStokesEquationsBase</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    : <span class="keyword">public</span> <span class="keyword">virtual</span> NavierStokesElementWithDiagonalMassMatrices,</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;      <span class="keyword">public</span> <span class="keyword">virtual</span> FiniteElement</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;  {</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;  <span class="keyword">public</span>:<span class="comment"></span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;<span class="comment">    /// Constructor (empty)</span></div>
<div class="line"><a name="l00368"></a><span class="lineno"><a class="line" href="classoomph_1_1TemplateFreeSpaceTimeNavierStokesEquationsBase.html#a9394db2cd4884114c269f27fcd4371d7">  368</a></span>&#160;<span class="comment"></span>    <a class="code" href="classoomph_1_1TemplateFreeSpaceTimeNavierStokesEquationsBase.html#a9394db2cd4884114c269f27fcd4371d7">TemplateFreeSpaceTimeNavierStokesEquationsBase</a>(){};</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160; </div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;<span class="comment">    /// Virtual destructor (empty)</span></div>
<div class="line"><a name="l00372"></a><span class="lineno"><a class="line" href="classoomph_1_1TemplateFreeSpaceTimeNavierStokesEquationsBase.html#ab1b0d29e41018d1c27dfc841e6de8b1d">  372</a></span>&#160;<span class="comment"></span>    <span class="keyword">virtual</span> <a class="code" href="classoomph_1_1TemplateFreeSpaceTimeNavierStokesEquationsBase.html#ab1b0d29e41018d1c27dfc841e6de8b1d">~TemplateFreeSpaceTimeNavierStokesEquationsBase</a>(){};</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160; </div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;<span class="comment">    /// \short Compute the residuals for the associated pressure advection</span></div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;<span class="comment">    /// diffusion problem. Used by the Fp preconditioner.</span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;<span class="comment"></span>    <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1TemplateFreeSpaceTimeNavierStokesEquationsBase.html#ae8c5b20a6fa5f1373fe2b720ba1d321f">fill_in_pressure_advection_diffusion_residuals</a>(</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;      <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; <a class="code" href="the__data__structure_8txt.html#a1400a973def57b85051cfe1070be1810">residuals</a>) = 0;</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160; </div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;<span class="comment">    /// \short Compute the residuals and Jacobian for the associated</span></div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;<span class="comment">    /// pressure advection diffusion problem. Used by the Fp preconditioner.</span></div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;<span class="comment"></span>    <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1TemplateFreeSpaceTimeNavierStokesEquationsBase.html#a41a7caedf1068323325e0c7af21d2a67">fill_in_pressure_advection_diffusion_jacobian</a>(</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;      <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; <a class="code" href="the__data__structure_8txt.html#a1400a973def57b85051cfe1070be1810">residuals</a>, <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a>&amp; jacobian) = 0;</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160; </div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;<span class="comment">    /// \short Return the index at which the pressure is stored if it is</span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;<span class="comment">    /// stored at the nodes. If not stored at the nodes this will return</span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;<span class="comment">    /// a negative number.</span></div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;<span class="comment"></span>    <span class="keyword">virtual</span> <span class="keywordtype">int</span> <a class="code" href="classoomph_1_1TemplateFreeSpaceTimeNavierStokesEquationsBase.html#abf2707dd8f8b4eb0d6b5358d039921e1">p_nodal_index_nst</a>() <span class="keyword">const</span> = 0;</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160; </div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;<span class="comment">    /// \short Access function for the local equation number information for</span></div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;<span class="comment">    /// the pressure.</span></div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;<span class="comment">    /// p_local_eqn[n] = local equation number or &lt; 0 if pinned</span></div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;<span class="comment"></span>    <span class="keyword">virtual</span> <span class="keywordtype">int</span> <a class="code" href="classoomph_1_1TemplateFreeSpaceTimeNavierStokesEquationsBase.html#ac14a23704d1afd41be9be7cee3f75b5d">p_local_eqn</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; <a class="code" href="the__data__structure_8txt.html#af88b2d950fae19ab641bd1690e08445c">n</a>) <span class="keyword">const</span> = 0;</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160; </div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;<span class="comment">    /// \short Global eqn number of pressure dof that&#39;s pinned in pressure</span></div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;<span class="comment">    /// adv diff problem</span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;<span class="comment"></span>    <span class="keyword">virtual</span> <span class="keywordtype">int</span>&amp; <a class="code" href="classoomph_1_1TemplateFreeSpaceTimeNavierStokesEquationsBase.html#afc018b58bca3a36ae7abc7f7d05ff744">pinned_fp_pressure_eqn</a>() = 0;</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160; </div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;<span class="comment">    /// \short Pin all non-pressure dofs and backup eqn numbers of all Data</span></div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;<span class="comment"></span>    <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1TemplateFreeSpaceTimeNavierStokesEquationsBase.html#ad14f587cd6a139bf513a0fb72b8a7d0d">pin_all_non_pressure_dofs</a>(</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;      std::map&lt;<a class="code" href="classoomph_1_1Data.html">Data</a>*, std::vector&lt;int&gt;&gt;&amp; eqn_number_backup) = 0;</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160; </div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;<span class="comment">    /// \short Build FaceElements that apply the Robin boundary condition</span></div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;<span class="comment">    /// to the pressure advection diffusion problem required by</span></div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;<span class="comment">    /// Fp preconditioner</span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;<span class="comment"></span>    <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1TemplateFreeSpaceTimeNavierStokesEquationsBase.html#a154b81d06df3cd89e641dc95b46ef7d8">build_fp_press_adv_diff_robin_bc_element</a>(</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; face_index) = 0;</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160; </div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;<span class="comment">    /// \short Delete the FaceElements that apply the Robin boundary condition</span></div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;<span class="comment">    /// to the pressure advection diffusion problem required by</span></div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;<span class="comment">    /// Fp preconditioner</span></div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;<span class="comment"></span>    <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1TemplateFreeSpaceTimeNavierStokesEquationsBase.html#ad875a36463531c1015a1b40ad074f345">delete_pressure_advection_diffusion_robin_elements</a>() = 0;</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160; </div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;<span class="comment">    /// \short Compute the diagonal of the velocity/pressure mass matrices.</span></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;<span class="comment">    /// If which one=0, both are computed, otherwise only the pressure</span></div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;<span class="comment">    /// (which_one=1) or the velocity mass matrix (which_one=2 -- the</span></div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;<span class="comment">    /// LSC version of the preconditioner only needs that one)</span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;<span class="comment"></span>    <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1TemplateFreeSpaceTimeNavierStokesEquationsBase.html#a0d65b8b47de40a3a41a2c234d6a47718">get_pressure_and_velocity_mass_matrix_diagonal</a>(</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;      <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; press_mass_diag,</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;      <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; veloc_mass_diag,</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; which_one = 0) = 0;</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;  };</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;<span class="comment">  ///////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;<span class="comment">  ///////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;<span class="comment">  ///////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;  <span class="comment">//======================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;<span class="comment">  /// A class for elements that solve the Cartesian Navier-Stokes</span></div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;<span class="comment">  /// equations, templated by the dimension DIM.</span></div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;<span class="comment">  /// This contains the generic maths -- any concrete implementation must</span></div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;<span class="comment">  /// be derived from this.</span></div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;<span class="comment">  ///</span></div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;<span class="comment">  /// We&#39;re solving:</span></div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;<span class="comment">  ///</span></div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;<span class="comment">  ///  \f$ { Re \left( St \frac{\partial u_i}{\partial t}+</span></div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;<span class="comment">  ///              (u_j-u_j^{M}) \frac{\partial u_i}{\partial x_j} \right)=</span></div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;<span class="comment">  ///     -\frac{\partial p}{\partial x_i} -R_\rho B_i(x_j) -</span></div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;<span class="comment">  ///       \frac{Re}{Fr} G_i +</span></div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;<span class="comment">  ///        \frac{\partial }{\partial x_j} \left[  R_\mu \left(</span></div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;<span class="comment">  ///        \frac{\partial u_i}{\partial x_j}+</span></div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;<span class="comment">  ///         \frac{\partial u_j}{\partial x_i} \right) \right] } \f$</span></div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;<span class="comment">  ///</span></div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;<span class="comment">  ///  and</span></div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;<span class="comment">  ///</span></div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;<span class="comment">  ///  \f$ { \frac{\partial u_i}{\partial x_i}=Q } \f$</span></div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;<span class="comment">  ///</span></div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;<span class="comment">  /// We also provide all functions required to use this element</span></div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;<span class="comment">  /// in FSI problems, by deriving it from the FSIFluidElement base</span></div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;<span class="comment">  /// class.</span></div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;<span class="comment">  ///</span></div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;<span class="comment">  /// --------------------</span></div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;<span class="comment">  /// SPACE-TIME ELEMENTS:</span></div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;<span class="comment">  /// --------------------</span></div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;<span class="comment">  /// The space-time extension is written ONLY for the 2D Navier-Stokes</span></div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;<span class="comment">  /// equations. The result is a 3D problem (x,y,t) to be solved on a</span></div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;<span class="comment">  /// 3D mesh. The template parameter DIM now corresponds to the</span></div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;<span class="comment">  /// dimension of the space-time problem (i.e. DIM=3 for the 2D flow).</span></div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;<span class="comment"></span>  <span class="comment">//======================================================================</span></div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;  <span class="keyword">template</span>&lt;<span class="keywordtype">unsigned</span> DIM&gt;</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;  <span class="keyword">class </span>SpaceTimeNavierStokesEquations</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;    : <span class="keyword">public</span> <span class="keyword">virtual</span> FSIFluidElement,</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;      <span class="keyword">public</span> <span class="keyword">virtual</span> TemplateFreeSpaceTimeNavierStokesEquationsBase</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;  {</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;  <span class="keyword">public</span>:<span class="comment"></span></div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;<span class="comment">    /// \short Function pointer to body force function fct(t,x,f(x))</span></div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;<span class="comment">    /// x is a Vector!</span></div>
<div class="line"><a name="l00476"></a><span class="lineno"><a class="line" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a6564a776dce312aad43b9317d7f1373c">  476</a></span>&#160;<span class="comment"></span>    <span class="keyword">typedef</span> void (*<a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a6564a776dce312aad43b9317d7f1373c">NavierStokesBodyForceFctPt</a>)(<span class="keyword">const</span> <span class="keywordtype">double</span>&amp; time,</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;                                               <span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; x,</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;                                               <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; body_force);</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;<span class="comment">    /// \short Function pointer to source function fct(t,x) (x is a Vector!)</span></div>
<div class="line"><a name="l00481"></a><span class="lineno"><a class="line" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a9af90d7010d22eb4a672b79c977774d9">  481</a></span>&#160;<span class="comment"></span>    <span class="keyword">typedef</span> double (*<a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a9af90d7010d22eb4a672b79c977774d9">NavierStokesSourceFctPt</a>)(<span class="keyword">const</span> <span class="keywordtype">double</span>&amp; time,</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;                                              <span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; x);</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;<span class="comment">    /// \short Function pointer to source function fct(x) for the</span></div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;<span class="comment">    /// pressure advection diffusion equation (only used during</span></div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;<span class="comment">    /// validation!). x is a Vector!</span></div>
<div class="line"><a name="l00487"></a><span class="lineno"><a class="line" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#adb897d6391666773c5d5bf22b9d9bc83">  487</a></span>&#160;<span class="comment"></span>    <span class="keyword">typedef</span> double (*<a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#adb897d6391666773c5d5bf22b9d9bc83">NavierStokesPressureAdvDiffSourceFctPt</a>)(</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;      <span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; x);</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160; </div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;  <span class="keyword">private</span>:<span class="comment"></span></div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;<span class="comment">    /// \short Static &quot;magic&quot; number that indicates that the pressure is</span></div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;<span class="comment">    /// not stored at a node</span></div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;<span class="comment"></span>    <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a86f9883b590636180cbf51216d3c5fa8">Pressure_not_stored_at_node</a>;</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;<span class="comment">    /// Static default value for the physical constants (all initialised to</span></div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;<span class="comment">    /// zero)</span></div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;<span class="comment"></span>    <span class="keyword">static</span> <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a559c0593d604a126d32d3b3056b4729d">Default_Physical_Constant_Value</a>;</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;<span class="comment">    /// Static default value for the physical ratios (all are initialised to</span></div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;<span class="comment">    /// one)</span></div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;<span class="comment"></span>    <span class="keyword">static</span> <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#ae66d63f1872a754adc5cd360c039d110">Default_Physical_Ratio_Value</a>;</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;<span class="comment">    /// Static default value for the gravity vector</span></div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;<span class="comment"></span>    <span class="keyword">static</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a9915a850967b024b10d2efeaa79a779b">Default_Gravity_vector</a>;</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160; </div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;  <span class="keyword">protected</span>:</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    <span class="comment">// Physical constants:</span></div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;<span class="comment">    /// \short Pointer to the viscosity ratio (relative to the</span></div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;<span class="comment">    /// viscosity used in the definition of the Reynolds number)</span></div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;<span class="comment"></span>    <span class="keywordtype">double</span>* <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a78df6a6a28df4288cb1d6e8d32a62487">Viscosity_Ratio_pt</a>;</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;<span class="comment">    /// \short Pointer to the density ratio (relative to the density used in the</span></div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;<span class="comment">    /// definition of the Reynolds number)</span></div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;<span class="comment"></span>    <span class="keywordtype">double</span>* <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a51b8eb313bce9abaee4178bb9ad639fa">Density_Ratio_pt</a>;</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160; </div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;    <span class="comment">// Pointers to global physical constants:</span></div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;<span class="comment">    /// Pointer to global Reynolds number</span></div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;<span class="comment"></span>    <span class="keywordtype">double</span>* <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a9148f8b14cbadffb0eda4ccaa81865f4">Re_pt</a>;</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;<span class="comment">    /// Pointer to global Reynolds number x Strouhal number (= Womersley)</span></div>
<div class="line"><a name="l00523"></a><span class="lineno"><a class="line" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a70e895a4a3001c4df3cb3000500a345d">  523</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">double</span>* <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a70e895a4a3001c4df3cb3000500a345d">ReSt_pt</a>;</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;<span class="comment">    /// \short Boolean to indicate whether or not the Strouhal value is</span></div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;<span class="comment">    /// stored as external data (if it&#39;s also an unknown of the problem)</span></div>
<div class="line"><a name="l00527"></a><span class="lineno"><a class="line" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a7002ecb67fc50de0f7824c95353aee2c">  527</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">bool</span> <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a7002ecb67fc50de0f7824c95353aee2c">ReynoldsStrouhal_is_stored_as_external_data</a>;</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;<span class="comment">    /// \short Pointer to global Reynolds number x inverse Froude number</span></div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;<span class="comment">    /// (= Bond number / Capillary number)</span></div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;<span class="comment"></span>    <span class="keywordtype">double</span>* <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a0f17dc6374634209fabff9751a8b4d63">ReInvFr_pt</a>;</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;<span class="comment">    /// Pointer to global gravity Vector</span></div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;<span class="comment"></span>    <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>* <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a54106089fd7fa30326a0d6db8372af17">G_pt</a>;</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;<span class="comment">    /// Pointer to body force function</span></div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;<span class="comment"></span>    <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a6564a776dce312aad43b9317d7f1373c">NavierStokesBodyForceFctPt</a> <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a186af0a617c8c79c1eec6503caf30467">Body_force_fct_pt</a>;</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;<span class="comment">    /// Pointer to volumetric source function</span></div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;<span class="comment"></span>    <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a9af90d7010d22eb4a672b79c977774d9">NavierStokesSourceFctPt</a> <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a9af8a69fe8cb0b1760063a8f7f9c3aa6">Source_fct_pt</a>;</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;<span class="comment">    /// \short Pointer to source function pressure advection diffusion equation</span></div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;<span class="comment">    /// (only to be used during validation)</span></div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;<span class="comment"></span>    <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#adb897d6391666773c5d5bf22b9d9bc83">NavierStokesPressureAdvDiffSourceFctPt</a> <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a32884d8125df9d1a7d49d956cc497175">Press_adv_diff_source_fct_pt</a>;</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;<span class="comment">    /// \short Boolean flag to indicate if ALE formulation is disabled when</span></div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;<span class="comment">    /// time-derivatives are computed. Only set to true if you&#39;re sure</span></div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;<span class="comment">    /// that the mesh is stationary.</span></div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;<span class="comment"></span>    <span class="keywordtype">bool</span> <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#af1918b4d6763e12f550596234c640f2a">ALE_is_disabled</a>;</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;<span class="comment">    /// \short Storage for FaceElements that apply Robin BC for pressure adv</span></div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;<span class="comment">    /// diff equation used in Fp preconditioner.</span></div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;<span class="comment"></span>    <a class="code" href="classoomph_1_1Vector.html">Vector&lt;FpPressureAdvDiffRobinBCSpaceTimeElementBase*&gt;</a></div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;      <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a6d88396b9bb8a88f24f9df1d17e75d0e">Pressure_advection_diffusion_robin_element_pt</a>;</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;<span class="comment">    /// \short Global eqn number of pressure dof that&#39;s pinned in</span></div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;<span class="comment">    /// pressure advection diffusion problem (defaults to -1)</span></div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;<span class="comment"></span>    <span class="keywordtype">int</span> <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a0f24c5d2a7d39dae9512b7792ec19573">Pinned_fp_pressure_eqn</a>;</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;<span class="comment">    /// \short Compute the shape functions and derivatives</span></div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;<span class="comment">    /// w.r.t. global coords at local coordinate s.</span></div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;<span class="comment">    /// Return Jacobian of mapping between local and global coordinates.</span></div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;<span class="comment"></span>    <span class="keyword">virtual</span> <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a2cc20ea6492210b01deccb8d3c5b8dd3">dshape_and_dtest_eulerian_nst</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;                                                 <a class="code" href="classoomph_1_1Shape.html">Shape</a>&amp; psi,</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;                                                 <a class="code" href="classoomph_1_1DShape.html">DShape</a>&amp; dpsidx,</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;                                                 <a class="code" href="classoomph_1_1Shape.html">Shape</a>&amp; test,</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;                                                 <a class="code" href="classoomph_1_1DShape.html">DShape</a>&amp; dtestdx) <span class="keyword">const</span> = 0;</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160; </div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;<span class="comment">    /// \short Compute the shape functions and derivatives</span></div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;<span class="comment">    /// w.r.t. global coords at ipt-th integration point</span></div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;<span class="comment">    /// Return Jacobian of mapping between local and global coordinates.</span></div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;<span class="comment"></span>    <span class="keyword">virtual</span> <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a57dfce9ee414aa4c37d747ff5205a7d0">dshape_and_dtest_eulerian_at_knot_nst</a>(</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; ipt,</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;      <a class="code" href="classoomph_1_1Shape.html">Shape</a>&amp; psi,</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;      <a class="code" href="classoomph_1_1DShape.html">DShape</a>&amp; dpsidx,</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;      <a class="code" href="classoomph_1_1Shape.html">Shape</a>&amp; test,</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;      <a class="code" href="classoomph_1_1DShape.html">DShape</a>&amp; dtestdx) <span class="keyword">const</span> = 0;</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160; </div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;<span class="comment">    /// \short Shape/test functions and derivs w.r.t. to global coords at</span></div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;<span class="comment">    /// integration point ipt; return Jacobian of mapping (J). Also compute</span></div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;<span class="comment">    /// derivatives of dpsidx, dtestdx and J w.r.t. nodal coordinates.</span></div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;<span class="comment"></span>    <span class="keyword">virtual</span> <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a57dfce9ee414aa4c37d747ff5205a7d0">dshape_and_dtest_eulerian_at_knot_nst</a>(</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; ipt,</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;      <a class="code" href="classoomph_1_1Shape.html">Shape</a>&amp; psi,</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;      <a class="code" href="classoomph_1_1DShape.html">DShape</a>&amp; dpsidx,</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;      <a class="code" href="classoomph_1_1RankFourTensor.html">RankFourTensor&lt;double&gt;</a>&amp; d_dpsidx_dX,</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;      <a class="code" href="classoomph_1_1Shape.html">Shape</a>&amp; test,</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;      <a class="code" href="classoomph_1_1DShape.html">DShape</a>&amp; dtestdx,</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;      <a class="code" href="classoomph_1_1RankFourTensor.html">RankFourTensor&lt;double&gt;</a>&amp; d_dtestdx_dX,</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;      <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a>&amp; djacobian_dX) <span class="keyword">const</span> = 0;</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160; </div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;<span class="comment">    /// \short Compute the pressure shape and test functions and derivatives</span></div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;<span class="comment">    /// w.r.t. global coords at local coordinate s.</span></div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;<span class="comment">    /// Return Jacobian of mapping between local and global coordinates.</span></div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;<span class="comment"></span>    <span class="keyword">virtual</span> <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a02ef091fa753293867a8a50af6ada46b">dpshape_and_dptest_eulerian_nst</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;                                                   <a class="code" href="classoomph_1_1Shape.html">Shape</a>&amp; ppsi,</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;                                                   <a class="code" href="classoomph_1_1DShape.html">DShape</a>&amp; dppsidx,</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;                                                   <a class="code" href="classoomph_1_1Shape.html">Shape</a>&amp; ptest,</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;                                                   <a class="code" href="classoomph_1_1DShape.html">DShape</a>&amp; dptestdx) <span class="keyword">const</span> = 0;</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160; </div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;<span class="comment">    /// \short Calculate the body force at a given time and local and/or</span></div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;<span class="comment">    /// Eulerian position. This function is virtual so that it can be</span></div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;<span class="comment">    /// overloaded in multi-physics elements where the body force might</span></div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;<span class="comment">    /// depend on another variable.</span></div>
<div class="line"><a name="l00609"></a><span class="lineno"><a class="line" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a88f21358f5a602481a01c84570892150">  609</a></span>&#160;<span class="comment"></span>    <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a88f21358f5a602481a01c84570892150">get_body_force_nst</a>(<span class="keyword">const</span> <span class="keywordtype">double</span>&amp; time,</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;                                    <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; ipt,</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;                                    <span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;                                    <span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; x,</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;                                    <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; result)</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;    {</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;      <span class="comment">// If a function has not been provided</span></div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a186af0a617c8c79c1eec6503caf30467">Body_force_fct_pt</a> == 0)</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;      {</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;        <span class="comment">// Set the body forces to zero</span></div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;        result.<a class="code" href="classoomph_1_1Vector.html#ad526bb1acccf11b485ebe12c9cde44fd">initialise</a>(0.0);</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;      }</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;      <span class="comment">// If the function pointer is non-zero</span></div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;      {</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;        <span class="comment">// Call the function</span></div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;        (*Body_force_fct_pt)(time, x, result);</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;      } <span class="comment">// if (Body_force_fct_pt!=0)</span></div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;    } <span class="comment">// End of get_body_force_nst</span></div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160; </div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;<span class="comment">    /// Get gradient of body force term at (Eulerian) position x. This function</span></div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;<span class="comment">    /// is virtual to allow overloading in multi-physics problems where</span></div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;<span class="comment">    /// the strength of the source function might be determined by another</span></div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;<span class="comment">    /// system of equations. Computed via function pointer (if set) or by</span></div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;<span class="comment">    /// finite differencing (default)</span></div>
<div class="line"><a name="l00635"></a><span class="lineno"><a class="line" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#ada4e33929cfd12eea638103a37e9f909">  635</a></span>&#160;<span class="comment"></span>    <span class="keyword">inline</span> <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#ada4e33929cfd12eea638103a37e9f909">get_body_force_gradient_nst</a>(</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; time,</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; ipt,</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;      <span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;      <span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; x,</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;      <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a>&amp; d_body_force_dx)</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;    {</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;      <span class="comment">// Reference value</span></div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;      <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> body_force(DIM, 0.0);</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160; </div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;      <span class="comment">// Get the body force vector</span></div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;      <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a88f21358f5a602481a01c84570892150">get_body_force_nst</a>(time, ipt, <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>, x, body_force);</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160; </div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;      <span class="comment">// Get the finite-difference step size</span></div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;      <span class="keywordtype">double</span> eps_fd = <a class="code" href="classoomph_1_1GeneralisedElement.html#a156163c9f6fbd17548a9fa836616d19b">GeneralisedElement::Default_fd_jacobian_step</a>;</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160; </div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;      <span class="comment">// The body force computed at the perturbed coordinates</span></div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;      <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> body_force_pls(DIM, 0.0);</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160; </div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;      <span class="comment">// Copy the (Eulerian) coordinate vector x</span></div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;      <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> x_pls(x);</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160; </div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;      <span class="comment">// Loop over the coordinate directions</span></div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a> = 0; <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a> &lt; DIM; <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;      {</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;        <span class="comment">// Update the i-th entry</span></div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;        x_pls[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] += eps_fd;</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160; </div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;        <span class="comment">// Get the body force at the current time</span></div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;        <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a88f21358f5a602481a01c84570892150">get_body_force_nst</a>(time, ipt, <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>, x_pls, body_force_pls);</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160; </div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;        <span class="comment">// Loop over the coordinate directions</span></div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j = 0; j &lt; DIM; j++)</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;        {</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;          <span class="comment">// Finite-difference the body force derivative</span></div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;          d_body_force_dx(j, <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>) = (body_force_pls[j] - body_force[j]) / eps_fd;</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;        }</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160; </div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;        <span class="comment">// Reset the i-th entry</span></div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;        x_pls[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] = x[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>];</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;      }</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;    } <span class="comment">// End of get_body_force_gradient_nst</span></div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160; </div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;<span class="comment">    /// \short Calculate the source fct at a given time and Eulerian position</span></div>
<div class="line"><a name="l00680"></a><span class="lineno"><a class="line" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#abe13b1cb8754e4fdeaa647b58889ce7a">  680</a></span>&#160;<span class="comment"></span>    <span class="keyword">virtual</span> <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#abe13b1cb8754e4fdeaa647b58889ce7a">get_source_nst</a>(<span class="keyword">const</span> <span class="keywordtype">double</span>&amp; time,</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;                                  <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; ipt,</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;                                  <span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; x)</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;    {</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;      <span class="comment">// If the function pointer is null</span></div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a9af8a69fe8cb0b1760063a8f7f9c3aa6">Source_fct_pt</a> == 0)</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;      {</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;        <span class="comment">// Set the source function value to zero</span></div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;      }</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;      <span class="comment">// Otherwise call the function pointer</span></div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;      {</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;        <span class="comment">// Return the appropriate value</span></div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;        <span class="keywordflow">return</span> (*<a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a9af8a69fe8cb0b1760063a8f7f9c3aa6">Source_fct_pt</a>)(time, x);</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;      }</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;    } <span class="comment">// End of get_source_nst</span></div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160; </div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;<span class="comment">    /// Get gradient of source term at (Eulerian) position x. This function</span></div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;<span class="comment">    /// is virtual to allow overloading in multi-physics problems where the</span></div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;<span class="comment">    /// strength of the source function might be determined by another system</span></div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;<span class="comment">    /// of equations. Computed via function pointer (if set) or by finite</span></div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;<span class="comment">    /// differencing (default)</span></div>
<div class="line"><a name="l00704"></a><span class="lineno"><a class="line" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#ae5fd589366af34e7d1d3a6ffa17a23e5">  704</a></span>&#160;<span class="comment"></span>    <span class="keyword">inline</span> <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#ae5fd589366af34e7d1d3a6ffa17a23e5">get_source_gradient_nst</a>(<span class="keyword">const</span> <span class="keywordtype">double</span>&amp; time,</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;                                                <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; ipt,</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;                                                <span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; x,</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;                                                <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; gradient)</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;    {</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;      <span class="comment">// Reference value</span></div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;      <span class="keywordtype">double</span> source = <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#abe13b1cb8754e4fdeaa647b58889ce7a">get_source_nst</a>(time, ipt, x);</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160; </div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;      <span class="comment">// Get the finite-difference step size</span></div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;      <span class="keywordtype">double</span> eps_fd = <a class="code" href="classoomph_1_1GeneralisedElement.html#a156163c9f6fbd17548a9fa836616d19b">GeneralisedElement::Default_fd_jacobian_step</a>;</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160; </div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;      <span class="comment">// The source function value computed at the perturbed coordinates</span></div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;      <span class="keywordtype">double</span> source_pls = 0.0;</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160; </div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;      <span class="comment">// Copy the (Eulerian) coordinate vector, x</span></div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;      <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> x_pls(x);</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160; </div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;      <span class="comment">// Loop over the coordinate directions</span></div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a> = 0; <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a> &lt; DIM; <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;      {</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;        <span class="comment">// Update the i-th entry</span></div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;        x_pls[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] += eps_fd;</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160; </div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;        <span class="comment">// Get the body force at the current time</span></div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;        source_pls = <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#abe13b1cb8754e4fdeaa647b58889ce7a">get_source_nst</a>(time, ipt, x_pls);</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160; </div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;        <span class="comment">// Loop over the coordinate directions</span></div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j = 0; j &lt; DIM; j++)</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;        {</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;          <span class="comment">// Finite-difference the source function gradient</span></div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;          gradient[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] = (source_pls - source) / eps_fd;</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;        }</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160; </div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;        <span class="comment">// Reset the i-th entry</span></div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;        x_pls[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] = x[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>];</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;      }</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;    } <span class="comment">// End of get_source_gradient_nst</span></div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160; </div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;<span class="comment">    ///\short Compute the residuals for the Navier-Stokes equations.</span></div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;<span class="comment">    /// Flag=1 (or 0): do (or don&#39;t) compute the Jacobian as well.</span></div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;<span class="comment">    /// Flag=2: Fill in mass matrix too.</span></div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;<span class="comment"></span>    <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a99f198e79155480b0d06ad0fa66b027a">fill_in_generic_residual_contribution_nst</a>(</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;      <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; <a class="code" href="the__data__structure_8txt.html#a1400a973def57b85051cfe1070be1810">residuals</a>,</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;      <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a>&amp; jacobian,</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;      <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a>&amp; mass_matrix,</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; flag);</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160; </div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;<span class="comment">    /// \short Compute the residuals for the associated pressure advection</span></div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;<span class="comment">    /// diffusion problem. Used by the Fp preconditioner.</span></div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;<span class="comment">    /// flag=1(or 0): do (or don&#39;t) compute the Jacobian as well.</span></div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;<span class="comment"></span>    <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a6a434922a2d92ec0c12978ba7361971b">fill_in_generic_pressure_advection_diffusion_contribution_nst</a>(</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;      <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; <a class="code" href="the__data__structure_8txt.html#a1400a973def57b85051cfe1070be1810">residuals</a>,</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;      <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a>&amp; jacobian,</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; flag);</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160; </div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;<span class="comment">    ///\short Compute the derivatives of the</span></div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;<span class="comment">    /// residuals for the Navier-Stokes equations with respect to a parameter</span></div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;<span class="comment">    /// Flag=1 (or 0): do (or don&#39;t) compute the Jacobian as well.</span></div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;<span class="comment">    /// Flag=2: Fill in mass matrix too.</span></div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;<span class="comment"></span>    <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a7140c69be3970e645773bb5d6ae41e34">fill_in_generic_dresidual_contribution_nst</a>(</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;      <span class="keywordtype">double</span>* <span class="keyword">const</span>&amp; parameter_pt,</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;      <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; dres_dparam,</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;      <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a>&amp; djac_dparam,</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;      <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a>&amp; dmass_matrix_dparam,</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; flag);</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160; </div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;<span class="comment">    /// \short Compute the hessian tensor vector products required to</span></div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;<span class="comment">    /// perform continuation of bifurcations analytically</span></div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a56d0af18eeafae506578a4182f08f461">fill_in_contribution_to_hessian_vector_products</a>(</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;      <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> <span class="keyword">const</span>&amp; Y,</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;      <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> <span class="keyword">const</span>&amp; C,</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;      <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a>&amp; product);</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160; </div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;  <span class="keyword">public</span>:<span class="comment"></span></div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;<span class="comment">    /// \short Constructor: NULL the body force and source function</span></div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;<span class="comment">    /// and make sure the ALE terms are included by default.</span></div>
<div class="line"><a name="l00784"></a><span class="lineno"><a class="line" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#ab52489186df878709c4402b33aeaaeca">  784</a></span>&#160;<span class="comment"></span>    <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#ab52489186df878709c4402b33aeaaeca">SpaceTimeNavierStokesEquations</a>()</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;      : <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a186af0a617c8c79c1eec6503caf30467">Body_force_fct_pt</a>(0),</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;        <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a9af8a69fe8cb0b1760063a8f7f9c3aa6">Source_fct_pt</a>(0),</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;        <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a32884d8125df9d1a7d49d956cc497175">Press_adv_diff_source_fct_pt</a>(0),</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;        <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#af1918b4d6763e12f550596234c640f2a">ALE_is_disabled</a>(false),</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;        <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a0f24c5d2a7d39dae9512b7792ec19573">Pinned_fp_pressure_eqn</a>(-1)</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;    {</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;      <span class="comment">// Set all the Physical parameter pointers:</span></div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160; </div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;      <span class="comment">// Set the Reynolds number to the value zero</span></div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;      <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a9148f8b14cbadffb0eda4ccaa81865f4">Re_pt</a> = &amp;<a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a559c0593d604a126d32d3b3056b4729d">Default_Physical_Constant_Value</a>;</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160; </div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;      <span class="comment">// Set the Reynolds x Strouhal (= Womersley) number to the value zero</span></div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;      <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a70e895a4a3001c4df3cb3000500a345d">ReSt_pt</a> = &amp;<a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a559c0593d604a126d32d3b3056b4729d">Default_Physical_Constant_Value</a>;</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160; </div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;      <span class="comment">// The Strouhal number (which is a proxy for the period here) is not</span></div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;      <span class="comment">// stored as external data</span></div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;      <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a7002ecb67fc50de0f7824c95353aee2c">ReynoldsStrouhal_is_stored_as_external_data</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160; </div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;      <span class="comment">// Set the Reynolds / Froude value to zero</span></div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;      <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a0f17dc6374634209fabff9751a8b4d63">ReInvFr_pt</a> = &amp;<a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a559c0593d604a126d32d3b3056b4729d">Default_Physical_Constant_Value</a>;</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160; </div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;      <span class="comment">// Set the gravity vector to be the zero vector</span></div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;      <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a54106089fd7fa30326a0d6db8372af17">G_pt</a> = &amp;<a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a9915a850967b024b10d2efeaa79a779b">Default_Gravity_vector</a>;</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160; </div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;      <span class="comment">// Set the Physical ratios:</span></div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160; </div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;      <span class="comment">// Set the viscosity ratio to the value one</span></div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;      <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a78df6a6a28df4288cb1d6e8d32a62487">Viscosity_Ratio_pt</a> = &amp;<a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#ae66d63f1872a754adc5cd360c039d110">Default_Physical_Ratio_Value</a>;</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160; </div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;      <span class="comment">// Set the density ratio to the value one</span></div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;      <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a51b8eb313bce9abaee4178bb9ad639fa">Density_Ratio_pt</a> = &amp;<a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#ae66d63f1872a754adc5cd360c039d110">Default_Physical_Ratio_Value</a>;</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;    }</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;<span class="comment">    /// Vector to decide whether the stress-divergence form is used or not</span></div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;<span class="comment">    /// N.B. This needs to be public so that the intel compiler gets things</span></div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;<span class="comment">    /// correct somehow the access function messes things up when going to</span></div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;<span class="comment">    /// refineable Navier-Stokes</span></div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;<span class="comment"></span>    <span class="keyword">static</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a0d1f70732df8eead86c70e35979ce9c2">Gamma</a>;</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160; </div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;<span class="comment">    /// Function that tells us whether the period is stored as external data</span></div>
<div class="line"><a name="l00826"></a><span class="lineno"><a class="line" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a66088d45fbb45c054632c4e2a677c945">  826</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a66088d45fbb45c054632c4e2a677c945">store_strouhal_as_external_data</a>(<a class="code" href="classoomph_1_1Data.html">Data</a>* strouhal_data_pt)</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;    {</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;      <span class="comment">// Sanity check; make sure it&#39;s not a null pointer</span></div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;      <span class="keywordflow">if</span> (strouhal_data_pt == 0)</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;      {</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;        <span class="comment">// Create an output stream</span></div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;        std::ostringstream error_message_stream;</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160; </div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;        <span class="comment">// Create an error message</span></div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;        error_message_stream</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;User supplied Strouhal number as external data\n&quot;</span></div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;but the pointer provided is a null pointer!&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160; </div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;        <span class="comment">// Throw an error</span></div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="classoomph_1_1OomphLibError.html">OomphLibError</a>(error_message_stream.str(),</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;                            OOMPH_CURRENT_FUNCTION,</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;                            OOMPH_EXCEPTION_LOCATION);</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;      }</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160; </div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;      <span class="comment">// Set the Strouhal value pointer (the Strouhal number is stored as the</span></div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;      <span class="comment">// only piece of internal data in the phase condition element)</span></div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;      this-&gt;<a class="code" href="classoomph_1_1GeneralisedElement.html#afc58b505360aa5d172e50baad9aae46d">add_external_data</a>(strouhal_data_pt);</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160; </div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;      <span class="comment">// Indicate that the Strouhal number is store as external data</span></div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;      <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a7002ecb67fc50de0f7824c95353aee2c">ReynoldsStrouhal_is_stored_as_external_data</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;    } <span class="comment">// End of store_strouhal_as_external_data</span></div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160; </div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160; </div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;    <span class="comment">// Access functions for the physical constants:</span></div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;<span class="comment">    /// Are we storing the Strouhal number as external data?</span></div>
<div class="line"><a name="l00859"></a><span class="lineno"><a class="line" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a89f30496078869e6cb37ccfe372bc624">  859</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">bool</span> <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a89f30496078869e6cb37ccfe372bc624">is_reynolds_strouhal_stored_as_external_data</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;<span class="keyword">    </span>{</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;      <span class="comment">// Return the flags value</span></div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a7002ecb67fc50de0f7824c95353aee2c">ReynoldsStrouhal_is_stored_as_external_data</a>;</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;    } <span class="comment">// End of is_reynolds_strouhal_stored_as_external_data</span></div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160; </div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;<span class="comment">    /// Reynolds number</span></div>
<div class="line"><a name="l00867"></a><span class="lineno"><a class="line" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a5c5bf194c9ec4781afbb77556a605b35">  867</a></span>&#160;<span class="comment"></span>    <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a5c5bf194c9ec4781afbb77556a605b35">re</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;<span class="keyword">    </span>{</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;      <span class="comment">// Use the Reynolds number pointer to get the Reynolds value</span></div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;      <span class="keywordflow">return</span> *<a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a9148f8b14cbadffb0eda4ccaa81865f4">Re_pt</a>;</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;    } <span class="comment">// End of re</span></div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160; </div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;<span class="comment">    /// Pointer to Reynolds number</span></div>
<div class="line"><a name="l00875"></a><span class="lineno"><a class="line" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a8e7f428ab00da109741f910e95d2e4cc">  875</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">double</span>*&amp; <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a8e7f428ab00da109741f910e95d2e4cc">re_pt</a>()</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;    {</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;      <span class="comment">// Return the Reynolds number pointer</span></div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a9148f8b14cbadffb0eda4ccaa81865f4">Re_pt</a>;</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;    } <span class="comment">// End of re_pt</span></div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160; </div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;<span class="comment">    /// ReSt parameter (const. version)</span></div>
<div class="line"><a name="l00883"></a><span class="lineno"><a class="line" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a508bc855045d00877f40da1147c62d7f">  883</a></span>&#160;<span class="comment"></span>    <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a508bc855045d00877f40da1147c62d7f">re_st</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;<span class="keyword">    </span>{</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;      <span class="comment">// If the st is stored as external data</span></div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a7002ecb67fc50de0f7824c95353aee2c">ReynoldsStrouhal_is_stored_as_external_data</a>)</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;      {</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;        <span class="comment">// The index of the external data (which contains the st)</span></div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;        <span class="keywordtype">unsigned</span> data_index = 0;</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160; </div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;        <span class="comment">// The index of the value at which the ReynoldsStrouhal number is stored</span></div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;        <span class="keywordtype">unsigned</span> re_st_index = 0;</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160; </div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;        <span class="comment">// Return the value of the st in the external data</span></div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;        <span class="keywordflow">return</span> *(this-&gt;<a class="code" href="classoomph_1_1GeneralisedElement.html#a3ec4e27a7a3d16122b00e2b5be0d1036">external_data_pt</a>(data_index)-&gt;<a class="code" href="classoomph_1_1Data.html#a559dc196abee87cad34d655c8d6dac1e">value_pt</a>(re_st_index));</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;      }</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;      <span class="comment">// Otherwise the st is just stored as a pointer</span></div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;      {</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;        <span class="comment">// Return the value of St</span></div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;        <span class="keywordflow">return</span> *<a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a70e895a4a3001c4df3cb3000500a345d">ReSt_pt</a>;</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;      }</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;    } <span class="comment">// End of re_st</span></div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160; </div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;<span class="comment">    /// Pointer to Strouhal parameter (const. version)</span></div>
<div class="line"><a name="l00907"></a><span class="lineno"><a class="line" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#ac966383ce1d6eb706a84cfb762cd3c9f">  907</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">double</span>* <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#ac966383ce1d6eb706a84cfb762cd3c9f">re_st_pt</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;<span class="keyword">    </span>{</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;      <span class="comment">// If the strouhal is stored as external data</span></div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a7002ecb67fc50de0f7824c95353aee2c">ReynoldsStrouhal_is_stored_as_external_data</a>)</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;      {</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;        <span class="comment">// The index of the external data (which contains the strouhal)</span></div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;        <span class="keywordtype">unsigned</span> data_index = 0;</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160; </div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;        <span class="comment">// The index of the value at which the ReynoldsStrouhal number is stored</span></div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;        <span class="keywordtype">unsigned</span> re_st_index = 0;</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160; </div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;        <span class="comment">// Return the value of the st in the external data</span></div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;        <span class="keywordflow">return</span> this-&gt;<a class="code" href="classoomph_1_1GeneralisedElement.html#a3ec4e27a7a3d16122b00e2b5be0d1036">external_data_pt</a>(data_index)-&gt;<a class="code" href="classoomph_1_1Data.html#a559dc196abee87cad34d655c8d6dac1e">value_pt</a>(re_st_index);</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;      }</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;      <span class="comment">// Otherwise the strouhal is just stored as a pointer</span></div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;      {</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;        <span class="comment">// Return the value of Strouhal</span></div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a70e895a4a3001c4df3cb3000500a345d">ReSt_pt</a>;</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;      }</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;    } <span class="comment">// End of re_st_pt</span></div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160; </div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;<span class="comment">    /// Pointer to ReSt number (can only assign to private member data)</span></div>
<div class="line"><a name="l00931"></a><span class="lineno"><a class="line" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a07cbd0c6d01a0892851e61a82e0dfafc">  931</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">double</span>*&amp; <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a07cbd0c6d01a0892851e61a82e0dfafc">re_st_pt</a>()</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;    {</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;      <span class="comment">// Return the ReSt number pointer</span></div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a70e895a4a3001c4df3cb3000500a345d">ReSt_pt</a>;</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;    } <span class="comment">// End of st_pt</span></div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160; </div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;<span class="comment">    /// \short Viscosity ratio for element: Element&#39;s viscosity relative to the</span></div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;<span class="comment">    /// viscosity used in the definition of the Reynolds number</span></div>
<div class="line"><a name="l00940"></a><span class="lineno"><a class="line" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#add14a24e5018ce37ec2115ad43cff7f5">  940</a></span>&#160;<span class="comment"></span>    <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#add14a24e5018ce37ec2115ad43cff7f5">viscosity_ratio</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;<span class="keyword">    </span>{</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;      <span class="keywordflow">return</span> *<a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a78df6a6a28df4288cb1d6e8d32a62487">Viscosity_Ratio_pt</a>;</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;    }</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;<span class="comment">    /// Pointer to Viscosity Ratio</span></div>
<div class="line"><a name="l00946"></a><span class="lineno"><a class="line" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#ae7c142695e37e5bce090c7aa7bd1df02">  946</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">double</span>*&amp; <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#ae7c142695e37e5bce090c7aa7bd1df02">viscosity_ratio_pt</a>()</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;    {</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a78df6a6a28df4288cb1d6e8d32a62487">Viscosity_Ratio_pt</a>;</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;    }</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;<span class="comment">    /// \short Density ratio for element: Element&#39;s density relative to the</span></div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;<span class="comment">    ///  viscosity used in the definition of the Reynolds number</span></div>
<div class="line"><a name="l00953"></a><span class="lineno"><a class="line" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a61c38c188cf720f8dbdc39ff608d2f49">  953</a></span>&#160;<span class="comment"></span>    <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a61c38c188cf720f8dbdc39ff608d2f49">density_ratio</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;<span class="keyword">    </span>{</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;      <span class="keywordflow">return</span> *<a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a51b8eb313bce9abaee4178bb9ad639fa">Density_Ratio_pt</a>;</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;    }</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;<span class="comment">    /// Pointer to Density ratio</span></div>
<div class="line"><a name="l00959"></a><span class="lineno"><a class="line" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#aa63da32216268c2c02f0c56de684799a">  959</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">double</span>*&amp; <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#aa63da32216268c2c02f0c56de684799a">density_ratio_pt</a>()</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;    {</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a51b8eb313bce9abaee4178bb9ad639fa">Density_Ratio_pt</a>;</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;    }</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;<span class="comment">    /// Global inverse Froude number</span></div>
<div class="line"><a name="l00965"></a><span class="lineno"><a class="line" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a9e5bcf75cc0136feb9c75cdca9a226cc">  965</a></span>&#160;<span class="comment"></span>    <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a9e5bcf75cc0136feb9c75cdca9a226cc">re_invfr</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;<span class="keyword">    </span>{</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;      <span class="keywordflow">return</span> *<a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a0f17dc6374634209fabff9751a8b4d63">ReInvFr_pt</a>;</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;    }</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;<span class="comment">    /// Pointer to global inverse Froude number</span></div>
<div class="line"><a name="l00971"></a><span class="lineno"><a class="line" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#ae3a8e5382fff21bf62358c1c5dbec337">  971</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">double</span>*&amp; <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#ae3a8e5382fff21bf62358c1c5dbec337">re_invfr_pt</a>()</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;    {</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a0f17dc6374634209fabff9751a8b4d63">ReInvFr_pt</a>;</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;    }</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;<span class="comment">    /// Vector of gravitational components</span></div>
<div class="line"><a name="l00977"></a><span class="lineno"><a class="line" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a7eaf18987c79fe9443d80817ab7946a5">  977</a></span>&#160;<span class="comment"></span>    <span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a7eaf18987c79fe9443d80817ab7946a5">g</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;<span class="keyword">    </span>{</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;      <span class="keywordflow">return</span> *<a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a54106089fd7fa30326a0d6db8372af17">G_pt</a>;</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;    }</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;<span class="comment">    /// Pointer to Vector of gravitational components</span></div>
<div class="line"><a name="l00983"></a><span class="lineno"><a class="line" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#af4fd1cc02fc1ec2e8fc5a7a611433dd5">  983</a></span>&#160;<span class="comment"></span>    <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>*&amp; <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#af4fd1cc02fc1ec2e8fc5a7a611433dd5">g_pt</a>()</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;    {</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a54106089fd7fa30326a0d6db8372af17">G_pt</a>;</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;    }</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;<span class="comment">    /// Access function for the body-force pointer</span></div>
<div class="line"><a name="l00989"></a><span class="lineno"><a class="line" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a04f328da44f58073d590443cfa66ef33">  989</a></span>&#160;<span class="comment"></span>    <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a6564a776dce312aad43b9317d7f1373c">NavierStokesBodyForceFctPt</a>&amp; <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a04f328da44f58073d590443cfa66ef33">body_force_fct_pt</a>()</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;    {</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a186af0a617c8c79c1eec6503caf30467">Body_force_fct_pt</a>;</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;    }</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;<span class="comment">    /// Access function for the body-force pointer. Const version</span></div>
<div class="line"><a name="l00995"></a><span class="lineno"><a class="line" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a54cfa39d206ec21295ef68727986e457">  995</a></span>&#160;<span class="comment"></span>    <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a6564a776dce312aad43b9317d7f1373c">NavierStokesBodyForceFctPt</a> <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a54cfa39d206ec21295ef68727986e457">body_force_fct_pt</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;<span class="keyword">    </span>{</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a186af0a617c8c79c1eec6503caf30467">Body_force_fct_pt</a>;</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;    }</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;<span class="comment">    /// Access function for the source-function pointer</span></div>
<div class="line"><a name="l01001"></a><span class="lineno"><a class="line" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a57c693d76098907b6607e209fb9d66b9"> 1001</a></span>&#160;<span class="comment"></span>    <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a9af90d7010d22eb4a672b79c977774d9">NavierStokesSourceFctPt</a>&amp; <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a57c693d76098907b6607e209fb9d66b9">source_fct_pt</a>()</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;    {</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a9af8a69fe8cb0b1760063a8f7f9c3aa6">Source_fct_pt</a>;</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;    }</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;<span class="comment">    /// Access function for the source-function pointer. Const version</span></div>
<div class="line"><a name="l01007"></a><span class="lineno"><a class="line" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a62bbb12fbdca3282eac98d110c2699ba"> 1007</a></span>&#160;<span class="comment"></span>    <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a9af90d7010d22eb4a672b79c977774d9">NavierStokesSourceFctPt</a> <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a62bbb12fbdca3282eac98d110c2699ba">source_fct_pt</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;<span class="keyword">    </span>{</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a9af8a69fe8cb0b1760063a8f7f9c3aa6">Source_fct_pt</a>;</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;    }</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;<span class="comment">    /// \short Access function for the source-function pointer for pressure</span></div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;<span class="comment">    /// advection diffusion (used for validation only).</span></div>
<div class="line"><a name="l01014"></a><span class="lineno"><a class="line" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a86dbb875cab37d44bfa5a4113915f77a"> 1014</a></span>&#160;<span class="comment"></span>    <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#adb897d6391666773c5d5bf22b9d9bc83">NavierStokesPressureAdvDiffSourceFctPt</a>&amp; <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a86dbb875cab37d44bfa5a4113915f77a">source_fct_for_pressure_adv_diff</a>()</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;    {</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a32884d8125df9d1a7d49d956cc497175">Press_adv_diff_source_fct_pt</a>;</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;    }</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;<span class="comment">    /// \short Access function for the source-function pointer for pressure</span></div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;<span class="comment">    /// advection diffusion  (used for validation only). Const version.</span></div>
<div class="line"><a name="l01021"></a><span class="lineno"><a class="line" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#aa9df5d7cf021441edc90347febe43621"> 1021</a></span>&#160;<span class="comment"></span>    <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#adb897d6391666773c5d5bf22b9d9bc83">NavierStokesPressureAdvDiffSourceFctPt</a> <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#aa9df5d7cf021441edc90347febe43621">source_fct_for_pressure_adv_diff</a>()<span class="keyword"></span></div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;<span class="keyword">      const</span></div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;<span class="keyword">    </span>{</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a32884d8125df9d1a7d49d956cc497175">Press_adv_diff_source_fct_pt</a>;</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;    }</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;<span class="comment">    /// \short Global eqn number of pressure dof that&#39;s pinned in pressure</span></div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;<span class="comment">    /// adv diff problem</span></div>
<div class="line"><a name="l01029"></a><span class="lineno"><a class="line" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a627c81c81889e09c54d3f30684370344"> 1029</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">int</span>&amp; <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a627c81c81889e09c54d3f30684370344">pinned_fp_pressure_eqn</a>()</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;    {</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;      <span class="comment">// Return the appropriate equation number</span></div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a0f24c5d2a7d39dae9512b7792ec19573">Pinned_fp_pressure_eqn</a>;</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;    }</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;<span class="comment">    /// Function to return number of pressure degrees of freedom</span></div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;<span class="comment"></span>    <span class="keyword">virtual</span> <span class="keywordtype">unsigned</span> <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a9484c60ff5a5099f41d277c1d2cf79f4">npres_nst</a>() <span class="keyword">const</span> = 0;</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;<span class="comment">    /// Compute the pressure shape functions at local coordinate s</span></div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;<span class="comment"></span>    <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#abc954710873355daeeb3ef3c9720ab56">pshape_nst</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>, <a class="code" href="classoomph_1_1Shape.html">Shape</a>&amp; psi) <span class="keyword">const</span> = 0;</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;<span class="comment">    /// \short Compute the pressure shape and test functions</span></div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;<span class="comment">    /// at local coordinate s</span></div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;<span class="comment"></span>    <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#abc954710873355daeeb3ef3c9720ab56">pshape_nst</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;                            <a class="code" href="classoomph_1_1Shape.html">Shape</a>&amp; psi,</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;                            <a class="code" href="classoomph_1_1Shape.html">Shape</a>&amp; test) <span class="keyword">const</span> = 0;</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;<span class="comment">    /// \short Velocity i at local node n. Uses suitably interpolated value</span></div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;<span class="comment">    /// for hanging nodes. The use of u_index_nst() permits the use of this</span></div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;<span class="comment">    /// element as the basis for multi-physics elements. The default</span></div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;<span class="comment">    /// is to assume that the i-th velocity component is stored at the</span></div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;<span class="comment">    /// i-th location of the node</span></div>
<div class="line"><a name="l01052"></a><span class="lineno"><a class="line" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#adb7ccce5209462b3a6e9e6abb7379e0e"> 1052</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#adb7ccce5209462b3a6e9e6abb7379e0e">u_nst</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; <a class="code" href="the__data__structure_8txt.html#af88b2d950fae19ab641bd1690e08445c">n</a>, <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>)<span class="keyword"> const</span></div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;<span class="keyword">    </span>{</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classoomph_1_1FiniteElement.html#a28fd5c2d4aeba5ef65bee0e0d72569f5">nodal_value</a>(<a class="code" href="the__data__structure_8txt.html#af88b2d950fae19ab641bd1690e08445c">n</a>, <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#abd193a0c754ddfc7b87ee7ec9f7e7694">u_index_nst</a>(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>));</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;    }</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;<span class="comment">    /// \short Velocity i at local node n at timestep t (t=0: present;</span></div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;<span class="comment">    /// t&gt;0: previous). Uses suitably interpolated value for hanging nodes.</span></div>
<div class="line"><a name="l01059"></a><span class="lineno"><a class="line" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#aa54b4067e393bb34e3c84f7bd5415e45"> 1059</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#aa54b4067e393bb34e3c84f7bd5415e45">u_nst</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; <a class="code" href="cfortran_8h.html#af6f0bd3dc13317f895c91323c25c2b8f">t</a>, <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; <a class="code" href="the__data__structure_8txt.html#af88b2d950fae19ab641bd1690e08445c">n</a>, <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>)<span class="keyword"> const</span></div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;<span class="keyword">    </span>{</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;      <span class="comment">// Since we&#39;re using space-time elements, this only makes sense if t=0</span></div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="cfortran_8h.html#af6f0bd3dc13317f895c91323c25c2b8f">t</a> != 0)</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;      {</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;        <span class="comment">// Throw an error</span></div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="classoomph_1_1OomphLibError.html">OomphLibError</a>(<span class="stringliteral">&quot;Space-time elements cannot have history values!&quot;</span>,</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;                            OOMPH_CURRENT_FUNCTION,</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;                            OOMPH_EXCEPTION_LOCATION);</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;      }</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160; </div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;      <span class="comment">// Return the appropriate nodal value (noting that t=0 here)</span></div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classoomph_1_1FiniteElement.html#a28fd5c2d4aeba5ef65bee0e0d72569f5">nodal_value</a>(<a class="code" href="cfortran_8h.html#af6f0bd3dc13317f895c91323c25c2b8f">t</a>, <a class="code" href="the__data__structure_8txt.html#af88b2d950fae19ab641bd1690e08445c">n</a>, <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#abd193a0c754ddfc7b87ee7ec9f7e7694">u_index_nst</a>(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>));</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;    } <span class="comment">// End of u_nst</span></div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;<span class="comment">    /// \short Return the index at which the i-th unknown velocity component</span></div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;<span class="comment">    /// is stored. The default value, i, is appropriate for single-physics</span></div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;<span class="comment">    /// problems.</span></div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;<span class="comment">    /// In derived multi-physics elements, this function should be overloaded</span></div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;<span class="comment">    /// to reflect the chosen storage scheme. Note that these equations require</span></div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;<span class="comment">    /// that the unknowns are always stored at the same indices at each node.</span></div>
<div class="line"><a name="l01082"></a><span class="lineno"><a class="line" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#abd193a0c754ddfc7b87ee7ec9f7e7694"> 1082</a></span>&#160;<span class="comment"></span>    <span class="keyword">virtual</span> <span class="keyword">inline</span> <span class="keywordtype">unsigned</span> <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#abd193a0c754ddfc7b87ee7ec9f7e7694">u_index_nst</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>)<span class="keyword"> const</span></div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;<span class="keyword">    </span>{</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a> &gt; DIM - 1)</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;      {</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;        <span class="comment">// Create an output stream</span></div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;        std::ostringstream error_message_stream;</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160; </div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;        <span class="comment">// Create an error message</span></div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;        error_message_stream &lt;&lt; <span class="stringliteral">&quot;Input index &quot;</span> &lt;&lt; <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a> &lt;&lt; <span class="stringliteral">&quot; does not correspond &quot;</span></div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;                             &lt;&lt; <span class="stringliteral">&quot;to a velocity component when DIM=&quot;</span> &lt;&lt; DIM</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;                             &lt;&lt; <span class="stringliteral">&quot;!&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160; </div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;        <span class="comment">// Throw an error</span></div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="classoomph_1_1OomphLibError.html">OomphLibError</a>(error_message_stream.str(),</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;                            OOMPH_CURRENT_FUNCTION,</div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;                            OOMPH_EXCEPTION_LOCATION);</div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;      }</div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160; </div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;      <span class="comment">// Return the appropriate entry</span></div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>;</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;    } <span class="comment">// End of u_index_nst</span></div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160; </div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;<span class="comment">    /// Return the number of velocity components (used in</span></div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;<span class="comment">    /// FluidInterfaceElements)</span></div>
<div class="line"><a name="l01109"></a><span class="lineno"><a class="line" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a3e15de0c9f6d885f35906653c34b7697"> 1109</a></span>&#160;<span class="comment"></span>    <span class="keyword">inline</span> <span class="keywordtype">unsigned</span> <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a3e15de0c9f6d885f35906653c34b7697">n_u_nst</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;<span class="keyword">    </span>{</div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;      <span class="comment">// Return the number of equations to solve</span></div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;      <span class="keywordflow">return</span> DIM;</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;    } <span class="comment">// End of n_u_nst</span></div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160; </div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;<span class="comment">    /// \short i-th component of du/dt at local node n.</span></div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;<span class="comment">    /// Uses suitably interpolated value for hanging nodes.</span></div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;<span class="comment">    /// NOTE: This is essentially a wrapper for du_dt_nst()</span></div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;<span class="comment">    /// so it can be called externally.</span></div>
<div class="line"><a name="l01120"></a><span class="lineno"><a class="line" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#aff570df80204a77f5c999573d4f2cb6d"> 1120</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#aff570df80204a77f5c999573d4f2cb6d">get_du_dt</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; <a class="code" href="the__data__structure_8txt.html#af88b2d950fae19ab641bd1690e08445c">n</a>, <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>)<span class="keyword"> const</span></div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;<span class="keyword">    </span>{</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;      <span class="comment">// Return the value calculated by du_dt_vdp</span></div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a543fb6d0eddee513017e3b95c8b2a271">du_dt_nst</a>(<a class="code" href="the__data__structure_8txt.html#af88b2d950fae19ab641bd1690e08445c">n</a>, <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>);</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;    } <span class="comment">// End of get_du_dt</span></div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160; </div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;<span class="comment">    /// \short i-th component of du/dt at local node n.</span></div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;<span class="comment">    /// Uses suitably interpolated value for hanging nodes.</span></div>
<div class="line"><a name="l01129"></a><span class="lineno"><a class="line" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a543fb6d0eddee513017e3b95c8b2a271"> 1129</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a543fb6d0eddee513017e3b95c8b2a271">du_dt_nst</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; <a class="code" href="the__data__structure_8txt.html#af88b2d950fae19ab641bd1690e08445c">n</a>, <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>)<span class="keyword"> const</span></div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;<span class="keyword">    </span>{</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;      <span class="comment">// Storage for the local coordinates</span></div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;      <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>(DIM + 1, 0.0);</div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160; </div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;      <span class="comment">// Get the local coordinate at the n-th node</span></div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;      <a class="code" href="classoomph_1_1FiniteElement.html#a22bc4ee35e4f948d8d7fba18c7b4f4c4">local_coordinate_of_node</a>(<a class="code" href="the__data__structure_8txt.html#af88b2d950fae19ab641bd1690e08445c">n</a>, <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>);</div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160; </div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;      <span class="comment">// Return the interpolated du_i/dt value</span></div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a73ebd4a95b8389225fcc37e0f297ee81">interpolated_du_dt_nst</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>, <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>);</div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;    } <span class="comment">// End of du_dt_nst</span></div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160; </div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;<span class="comment">    /// \short Return FE representation of function value du_i/dt(s) at local</span></div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;<span class="comment">    /// coordinate s</span></div>
<div class="line"><a name="l01144"></a><span class="lineno"><a class="line" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a73ebd4a95b8389225fcc37e0f297ee81"> 1144</a></span>&#160;<span class="comment"></span>    <span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a73ebd4a95b8389225fcc37e0f297ee81">interpolated_du_dt_nst</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,</div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;                                         <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>)<span class="keyword"> const</span></div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;<span class="keyword">    </span>{</div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;      <span class="comment">// Find number of nodes</span></div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;      <span class="keywordtype">unsigned</span> n_node = <a class="code" href="classoomph_1_1FiniteElement.html#a6219ed269a6d89b5aa14659cce48905a">nnode</a>();</div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160; </div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;      <span class="comment">// Local shape function</span></div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;      <a class="code" href="classoomph_1_1Shape.html">Shape</a> psi(n_node);</div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160; </div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;      <span class="comment">// Allocate space for the derivatives of the shape functions</span></div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;      <a class="code" href="classoomph_1_1DShape.html">DShape</a> dpsidx(n_node, DIM + 1);</div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160; </div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;      <span class="comment">// Compute the geometric shape functions and also first derivatives</span></div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;      <span class="comment">// w.r.t. global coordinates at local coordinate s</span></div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;      <a class="code" href="classoomph_1_1FiniteElement.html#a9296c17b134688049256a4bbc886df69">dshape_eulerian</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>, psi, dpsidx);</div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160; </div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;      <span class="comment">// Initialise value of du_i/dt</span></div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;      <span class="keywordtype">double</span> interpolated_dudt = 0.0;</div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160; </div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;      <span class="comment">// Find the index at which the variable is stored</span></div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;      <span class="keywordtype">unsigned</span> u_nodal_index = <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#abd193a0c754ddfc7b87ee7ec9f7e7694">u_index_nst</a>(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>);</div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160; </div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;      <span class="comment">// Loop over the local nodes and sum</span></div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> l = 0; l &lt; n_node; l++)</div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;      {</div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;        <span class="comment">// Update the interpolated du_i/dt value</span></div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;        interpolated_dudt += <a class="code" href="classoomph_1_1FiniteElement.html#a28fd5c2d4aeba5ef65bee0e0d72569f5">nodal_value</a>(l, u_nodal_index) * dpsidx(l, DIM);</div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;      }</div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160; </div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;      <span class="comment">// Return the interpolated du_i/dt value</span></div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;      <span class="keywordflow">return</span> interpolated_dudt;</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;    } <span class="comment">// End of interpolated_du_dt_nst</span></div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160; </div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;<span class="comment">    /// \short Disable ALE, i.e. assert the mesh is not moving -- you do this</span></div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;<span class="comment">    /// at your own risk!</span></div>
<div class="line"><a name="l01180"></a><span class="lineno"><a class="line" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a10b04d829e519097da22821781706632"> 1180</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a10b04d829e519097da22821781706632">disable_ALE</a>()</div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;    {</div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;      <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#af1918b4d6763e12f550596234c640f2a">ALE_is_disabled</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;    } <span class="comment">// End of disable_ALE</span></div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160; </div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;<span class="comment">    /// \short (Re-)enable ALE, i.e. take possible mesh motion into account</span></div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;<span class="comment">    /// when evaluating the time-derivative. Note: By default, ALE is</span></div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;<span class="comment">    /// enabled, at the expense of possibly creating unnecessary work</span></div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;<span class="comment">    /// in problems where the mesh is, in fact, stationary.</span></div>
<div class="line"><a name="l01190"></a><span class="lineno"><a class="line" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#aea9e0a8137ae2d251c8d33a28fbf0579"> 1190</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#aea9e0a8137ae2d251c8d33a28fbf0579">enable_ALE</a>()</div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;    {</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;      <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#af1918b4d6763e12f550596234c640f2a">ALE_is_disabled</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;    } <span class="comment">// End of enable_ALE</span></div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160; </div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;<span class="comment">    /// \short Pressure at local pressure &quot;node&quot; n_p</span></div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;<span class="comment">    /// Uses suitably interpolated value for hanging nodes.</span></div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;<span class="comment"></span>    <span class="keyword">virtual</span> <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a6ef4daae1df889c98d325fa232bb4431">p_nst</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; n_p) <span class="keyword">const</span> = 0;</div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;<span class="comment">    /// \short Pressure at local pressure &quot;node&quot; n_p at time level t</span></div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;<span class="comment"></span>    <span class="keyword">virtual</span> <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a6ef4daae1df889c98d325fa232bb4431">p_nst</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; <a class="code" href="cfortran_8h.html#af6f0bd3dc13317f895c91323c25c2b8f">t</a>, <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; n_p) <span class="keyword">const</span> = 0;</div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;<span class="comment">    /// Pin p_dof-th pressure dof and set it to value specified by p_value.</span></div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;<span class="comment"></span>    <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#ade0310ded6cc0389443fe19e99ca3ea7">fix_pressure</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; p_dof, <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; p_value) = 0;</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;<span class="comment">    /// \short Return the index at which the pressure is stored if it is</span></div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;<span class="comment">    /// stored at the nodes. If not stored at the nodes this will return</span></div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;<span class="comment">    /// a negative number.</span></div>
<div class="line"><a name="l01209"></a><span class="lineno"><a class="line" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a3310817460a8301d3eba3f68a2399a2a"> 1209</a></span>&#160;<span class="comment"></span>    <span class="keyword">virtual</span> <span class="keywordtype">int</span> <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a3310817460a8301d3eba3f68a2399a2a">p_nodal_index_nst</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;<span class="keyword">    </span>{</div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a86f9883b590636180cbf51216d3c5fa8">Pressure_not_stored_at_node</a>;</div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;    }</div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;<span class="comment">    /// Integral of pressure over element</span></div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;<span class="comment"></span>    <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#abb146a5b6d0b34bcb5ca6c43488bf5e0">pressure_integral</a>() <span class="keyword">const</span>;</div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;<span class="comment">    /// \short Return integral of dissipation over element</span></div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;<span class="comment"></span>    <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a8d01f9f1f54ffcea725965ba9282619c">dissipation</a>() <span class="keyword">const</span>;</div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;<span class="comment">    /// \short Return dissipation at local coordinate s</span></div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;<span class="comment"></span>    <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a8d01f9f1f54ffcea725965ba9282619c">dissipation</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>) <span class="keyword">const</span>;</div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;<span class="comment">    /// \short Compute the vorticity vector at local coordinate s</span></div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#ad2ae0b3e641cf2c6233f189d83224e44">get_vorticity</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,</div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;                       <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; vorticity) <span class="keyword">const</span>;</div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;<span class="comment">    /// \short Compute the vorticity vector at local coordinate s</span></div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#ad2ae0b3e641cf2c6233f189d83224e44">get_vorticity</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>, <span class="keywordtype">double</span>&amp; vorticity) <span class="keyword">const</span>;</div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;<span class="comment">    /// \short Get integral of kinetic energy over element</span></div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;<span class="comment"></span>    <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a5c91b059724e42e702420096485e6714">kin_energy</a>() <span class="keyword">const</span>;</div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;<span class="comment">    /// \short Get integral of time derivative of kinetic energy over element</span></div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;<span class="comment"></span>    <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a8b8cc9230e27af177561b3d3b38078c0">d_kin_energy_dt</a>() <span class="keyword">const</span>;</div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;<span class="comment">    /// Strain-rate tensor: 1/2 (du_i/dx_j+du_j/dx_i)</span></div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#ae393d5f751c42290cd0fe90c0337bdbb">strain_rate</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;                     <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a>&amp; <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#ae393d5f751c42290cd0fe90c0337bdbb">strain_rate</a>) <span class="keyword">const</span>;</div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;<span class="comment">    /// \short Compute traction (on the viscous scale) exerted onto</span></div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;<span class="comment">    /// the fluid at local coordinate s. N has to be outer unit normal</span></div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;<span class="comment">    /// to the fluid.</span></div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a12b09fc92074e9b752c408d9896b1efb">get_traction</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;                      <span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; <a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7dabc60bec4cc294aa2adf92726c6d6823a">N</a>,</div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;                      <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; traction);</div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;<span class="comment">    /// \short Compute traction (on the viscous scale) exerted onto</span></div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;<span class="comment">    /// the fluid at local coordinate s, decomposed into pressure and</span></div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;<span class="comment">    /// normal and tangential viscous components.</span></div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;<span class="comment">    /// N has to be outer unit normal to the fluid.</span></div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a12b09fc92074e9b752c408d9896b1efb">get_traction</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;                      <span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; <a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7dabc60bec4cc294aa2adf92726c6d6823a">N</a>,</div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;                      <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; traction_p,</div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;                      <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; traction_visc_n,</div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;                      <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; traction_visc_t);</div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;<span class="comment">    /// \short This implements a pure virtual function defined</span></div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;<span class="comment">    /// in the FSIFluidElement class. The function computes</span></div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;<span class="comment">    /// the traction (on the viscous scale), at the element&#39;s local</span></div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;<span class="comment">    /// coordinate s, that the fluid element exerts onto an adjacent</span></div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;<span class="comment">    /// solid element. The number of arguments is imposed by</span></div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;<span class="comment">    /// the interface defined in the FSIFluidElement -- only the</span></div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;<span class="comment">    /// unit normal N (pointing into the fluid!) is actually used</span></div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;<span class="comment">    /// in the computation.</span></div>
<div class="line"><a name="l01265"></a><span class="lineno"><a class="line" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#aa305847a9a9c2e7acde44333f7d1d3e9"> 1265</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#aa305847a9a9c2e7acde44333f7d1d3e9">get_load</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,</div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;                  <span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; <a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7dabc60bec4cc294aa2adf92726c6d6823a">N</a>,</div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;                  <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; load)</div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;    {</div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;      <span class="comment">// Note: get_traction() computes the traction onto the fluid</span></div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;      <span class="comment">// if N is the outer unit normal onto the fluid; here we&#39;re</span></div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;      <span class="comment">// expecting N to point into the fluid so we&#39;re getting the</span></div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;      <span class="comment">// traction onto the adjacent wall instead!</span></div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;      <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a12b09fc92074e9b752c408d9896b1efb">get_traction</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>, <a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7dabc60bec4cc294aa2adf92726c6d6823a">N</a>, load);</div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;    }</div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;<span class="comment">    /// \short Compute the diagonal of the velocity/pressure mass matrices.</span></div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;<span class="comment">    /// If which one=0, both are computed, otherwise only the pressure</span></div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;<span class="comment">    /// (which_one=1) or the velocity mass matrix (which_one=2 -- the</span></div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;<span class="comment">    /// LSC version of the preconditioner only needs that one)</span></div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a094b18cc4e05a83f4a43798c1ca0d88e">get_pressure_and_velocity_mass_matrix_diagonal</a>(</div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;      <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; press_mass_diag,</div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;      <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; veloc_mass_diag,</div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; which_one = 0);</div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;<span class="comment">    /// \short Number of scalars/fields output by this element. Reimplements</span></div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;<span class="comment">    /// broken virtual function in base class.</span></div>
<div class="line"><a name="l01287"></a><span class="lineno"><a class="line" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#aaab4919eaba2e354fb1b53d866cb0a97"> 1287</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">unsigned</span> <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#aaab4919eaba2e354fb1b53d866cb0a97">nscalar_paraview</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;<span class="keyword">    </span>{</div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;      <span class="comment">// The number of velocity components plus the pressure field</span></div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;      <span class="keywordflow">return</span> DIM + 1;</div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;    }</div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;<span class="comment">    /// \short Write values of the i-th scalar field at the plot points. Needs</span></div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;<span class="comment">    /// to be implemented for each new specific element type.</span></div>
<div class="line"><a name="l01295"></a><span class="lineno"><a class="line" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#af88a97d24d43b8d08db1dbeaad00b647"> 1295</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#af88a97d24d43b8d08db1dbeaad00b647">scalar_value_paraview</a>(std::ofstream&amp; file_out,</div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;                               <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>,</div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;                               <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; nplot)<span class="keyword"> const</span></div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;<span class="keyword">    </span>{</div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;      <span class="comment">// Vector of local coordinates</span></div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;      <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>(DIM + 1, 0.0);</div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160; </div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;      <span class="comment">// How many plot points do we have in total?</span></div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;      <span class="keywordtype">unsigned</span> num_plot_points = <a class="code" href="classoomph_1_1FiniteElement.html#a06d32c85753a1e302c3b345ea27f6c85">nplot_points_paraview</a>(nplot);</div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160; </div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;      <span class="comment">// Loop over plot points</span></div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> iplot = 0; iplot &lt; num_plot_points; iplot++)</div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;      {</div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;        <span class="comment">// Get the local coordinates of the iplot-th plot point</span></div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;        <a class="code" href="classoomph_1_1FiniteElement.html#a82da844fd3ebb2005842464cdc148a03">get_s_plot</a>(iplot, nplot, <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>);</div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160; </div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;        <span class="comment">// Velocities</span></div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a> &lt; DIM)</div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;        {</div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;          <span class="comment">// Output the i-th velocity component</span></div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;          file_out &lt;&lt; <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#ab05a01e85edefd811e44fe480a675ebb">interpolated_u_nst</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>, <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>) &lt;&lt; std::endl;</div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;        }</div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;        <span class="comment">// Pressure</span></div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a> == DIM)</div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;        {</div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;          <span class="comment">// Output the pressure at this point</span></div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;          file_out &lt;&lt; <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a5591b7cb6a6560aec9f7cc058798c63c">interpolated_p_nst</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>) &lt;&lt; std::endl;</div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;        }</div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;        <span class="comment">// Never get here</span></div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;        {</div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;          <span class="comment">// Create an output stream</span></div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;          std::stringstream error_stream;</div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160; </div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;          <span class="comment">// Create the error message</span></div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;          error_stream &lt;&lt; <span class="stringliteral">&quot;These Navier Stokes elements only store &quot;</span> &lt;&lt; DIM + 1</div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;                       &lt;&lt; <span class="stringliteral">&quot; fields, &quot;</span></div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;                       &lt;&lt; <span class="stringliteral">&quot;but i is currently  &quot;</span> &lt;&lt; <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160; </div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;          <span class="comment">// Throw the error message</span></div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;          <span class="keywordflow">throw</span> <a class="code" href="classoomph_1_1OomphLibError.html">OomphLibError</a>(error_stream.str(),</div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;                              OOMPH_CURRENT_FUNCTION,</div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;                              OOMPH_EXCEPTION_LOCATION);</div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;        }</div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;      } <span class="comment">// for (unsigned iplot=0;iplot&lt;num_plot_points;iplot++)</span></div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;    } <span class="comment">// End of scalar_value_paraview</span></div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160; </div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;<span class="comment">    /// \short Write values of the i-th scalar field at the plot points. Needs</span></div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;<span class="comment">    /// to be implemented for each new specific element type.</span></div>
<div class="line"><a name="l01347"></a><span class="lineno"><a class="line" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a9c4931e7df782e6fbea78b5b7701eaeb"> 1347</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a9c4931e7df782e6fbea78b5b7701eaeb">scalar_value_fct_paraview</a>(</div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;      std::ofstream&amp; file_out,</div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>,</div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; nplot,</div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; time,</div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;      <a class="code" href="classoomph_1_1FiniteElement.html#ad4ecf2b61b158a4b4d351a60d23c633e">FiniteElement::UnsteadyExactSolutionFctPt</a> exact_soln_pt)<span class="keyword"> const</span></div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;<span class="keyword">    </span>{</div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a> &gt; DIM)</div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;      {</div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;        <span class="comment">// Create an output stream</span></div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;        std::stringstream error_stream;</div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160; </div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;        <span class="comment">// Create the error message</span></div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;        error_stream &lt;&lt; <span class="stringliteral">&quot;These Navier Stokes elements only store &quot;</span> &lt;&lt; DIM + 1</div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;                     &lt;&lt; <span class="stringliteral">&quot; fields, but i is currently &quot;</span> &lt;&lt; <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160; </div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;        <span class="comment">// Throw the error message</span></div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="classoomph_1_1OomphLibError.html">OomphLibError</a>(</div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;          error_stream.str(), OOMPH_CURRENT_FUNCTION, OOMPH_EXCEPTION_LOCATION);</div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;      }</div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160; </div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;      <span class="comment">// Vector of local coordinates</span></div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;      <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>(DIM + 1, 0.0);</div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160; </div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;      <span class="comment">// Storage for the time value</span></div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;      <span class="keywordtype">double</span> interpolated_t = 0.0;</div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160; </div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;      <span class="comment">// Storage for the spatial coordinates</span></div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;      <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> spatial_coordinates(DIM, 0.0);</div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160; </div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;      <span class="comment">// How many plot points do we have in total?</span></div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;      <span class="keywordtype">unsigned</span> num_plot_points = <a class="code" href="classoomph_1_1FiniteElement.html#a06d32c85753a1e302c3b345ea27f6c85">nplot_points_paraview</a>(nplot);</div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160; </div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;      <span class="comment">// Loop over plot points</span></div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> iplot = 0; iplot &lt; num_plot_points; iplot++)</div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;      {</div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;        <span class="comment">// Get the local coordinates of the iplot-th plot point</span></div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;        <a class="code" href="classoomph_1_1FiniteElement.html#a82da844fd3ebb2005842464cdc148a03">get_s_plot</a>(iplot, nplot, <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>);</div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160; </div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;        <span class="comment">// Loop over the spatial coordinates</span></div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a> = 0; <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a> &lt; DIM; <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;        {</div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;          <span class="comment">// Assign the i-th spatial coordinate</span></div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;          spatial_coordinates[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] = <a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>, <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>);</div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;        }</div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160; </div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;        <span class="comment">// Get the time value</span></div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;        interpolated_t = <a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>, DIM);</div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160; </div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;        <span class="comment">// ------ DRAIG: REMOVE ----------------------------------------</span></div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;        <span class="comment">// Exact solution vector (here it&#39;s simply a scalar)</span></div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;        <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> exact_soln(DIM + 1, 0.0);</div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;        <span class="comment">// DRAIG: Needs to be changed to a Vector of size DIM</span></div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;        <span class="comment">// ------ DRAIG: REMOVE ----------------------------------------</span></div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160; </div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;        <span class="comment">// Get the exact solution at this point</span></div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;        (*exact_soln_pt)(interpolated_t, spatial_coordinates, exact_soln);</div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160; </div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;        <span class="comment">// Output the interpolated solution value</span></div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;        file_out &lt;&lt; exact_soln[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] &lt;&lt; std::endl;</div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;      } <span class="comment">// for (unsigned iplot=0;iplot&lt;num_plot_points;iplot++)</span></div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;    } <span class="comment">// End of scalar_value_fct_paraview</span></div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160; </div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;<span class="comment">    /// \short Name of the i-th scalar field. Default implementation</span></div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;<span class="comment">    /// returns V1 for the first one, V2 for the second etc. Can (should!) be</span></div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;<span class="comment">    /// overloaded with more meaningful names in specific elements.</span></div>
<div class="line"><a name="l01416"></a><span class="lineno"><a class="line" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#afd23eef3de24ed5a454f272358601b6b"> 1416</a></span>&#160;<span class="comment"></span>    <a class="code" href="namespaceoomph_1_1Global__string__for__annotation.html#ac5379de2fa7fe44f2cb31785fc208135">std::string</a> <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#afd23eef3de24ed5a454f272358601b6b">scalar_name_paraview</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>)<span class="keyword"> const</span></div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;<span class="keyword">    </span>{</div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;      <span class="comment">// Velocities</span></div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a> &lt; DIM)</div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;      {</div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;        <span class="comment">// Return the appropriate string for the i-th velocity component</span></div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;        <span class="keywordflow">return</span> <span class="stringliteral">&quot;Velocity &quot;</span> + <a class="code" href="namespaceoomph_1_1StringConversion.html#a9d30fabdc1a0694bdb91dddd2833bbd6">StringConversion::to_string</a>(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>);</div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;      }</div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;      <span class="comment">// Pressure</span></div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a> == DIM)</div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;      {</div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;        <span class="comment">// Return the name for the pressure</span></div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;        <span class="keywordflow">return</span> <span class="stringliteral">&quot;Pressure&quot;</span>;</div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;      }</div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;      <span class="comment">// Never get here</span></div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;      {</div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;        <span class="comment">// Create an output stream</span></div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;        std::stringstream error_stream;</div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160; </div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;        <span class="comment">// Create the error message</span></div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;        error_stream &lt;&lt; <span class="stringliteral">&quot;These Navier Stokes elements only store &quot;</span> &lt;&lt; DIM + 1</div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;                     &lt;&lt; <span class="stringliteral">&quot; fields,\nbut i is currently &quot;</span> &lt;&lt; <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160; </div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;        <span class="comment">// Throw the error message</span></div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="classoomph_1_1OomphLibError.html">OomphLibError</a>(</div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;          error_stream.str(), OOMPH_CURRENT_FUNCTION, OOMPH_EXCEPTION_LOCATION);</div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160; </div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;        <span class="comment">// Dummy return so the compiler doesn&#39;t complain</span></div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;        <span class="keywordflow">return</span> <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;      }</div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;    } <span class="comment">// End of scalar_name_paraview</span></div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160; </div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;<span class="comment">    /// \short Output function: x,y,t,u,v,p in tecplot format. The</span></div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;<span class="comment">    /// default number of plot points is five</span></div>
<div class="line"><a name="l01452"></a><span class="lineno"><a class="line" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a8ad8ed69a1ff73a486d37e2aa5fdb0ad"> 1452</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a8ad8ed69a1ff73a486d37e2aa5fdb0ad">output</a>(std::ostream&amp; outfile)</div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;    {</div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;      <span class="comment">// Set the number of plot points in each direction</span></div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;      <span class="keywordtype">unsigned</span> n_plot = 5;</div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160; </div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;      <span class="comment">// Forward the call to the appropriate output function</span></div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;      <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a8ad8ed69a1ff73a486d37e2aa5fdb0ad">output</a>(outfile, n_plot);</div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;    } <span class="comment">// End of output</span></div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160; </div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;<span class="comment">    /// \short Output function: x,y,[z],u,v,[w],p in tecplot format. Here,</span></div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;<span class="comment">    /// we use n_plot plot points in each coordinate direction</span></div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a8ad8ed69a1ff73a486d37e2aa5fdb0ad">output</a>(std::ostream&amp; outfile, <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; n_plot);</div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160; </div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;<span class="comment">    /// \short C-style output function: x,y,[z],u,v,[w],p in tecplot format. The</span></div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;<span class="comment">    /// default number of plot points is five</span></div>
<div class="line"><a name="l01469"></a><span class="lineno"><a class="line" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a592b8cc9328e9008c2747cc8b68819cf"> 1469</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a592b8cc9328e9008c2747cc8b68819cf">output</a>(FILE* file_pt)</div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;    {</div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;      <span class="comment">// Set the number of plot points in each direction</span></div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;      <span class="keywordtype">unsigned</span> n_plot = 5;</div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160; </div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;      <span class="comment">// Forward the call to the appropriate output function</span></div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;      <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a8ad8ed69a1ff73a486d37e2aa5fdb0ad">output</a>(file_pt, n_plot);</div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;    } <span class="comment">// End of output</span></div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160; </div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;<span class="comment">    /// \short C-style output function: x,y,[z],u,v,[w],p in tecplot format. Use</span></div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;<span class="comment">    /// n_plot points in each coordinate direction</span></div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a8ad8ed69a1ff73a486d37e2aa5fdb0ad">output</a>(FILE* file_pt, <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; n_plot);</div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160; </div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;<span class="comment">    /// \short Full output function:</span></div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;<span class="comment">    /// x,y,[z],u,v,[w],p,du/dt,dv/dt,[dw/dt],dissipation in tecplot format. The</span></div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;<span class="comment">    /// default number of plot points is five</span></div>
<div class="line"><a name="l01487"></a><span class="lineno"><a class="line" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a25ce9aa9fb4a3b05a790f3a8b2d1ba4c"> 1487</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a25ce9aa9fb4a3b05a790f3a8b2d1ba4c">full_output</a>(std::ostream&amp; outfile)</div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;    {</div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;      <span class="comment">// Set the number of plot points in each direction</span></div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;      <span class="keywordtype">unsigned</span> n_plot = 5;</div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160; </div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;      <span class="comment">// Forward the call to the appropriate output function</span></div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;      <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a25ce9aa9fb4a3b05a790f3a8b2d1ba4c">full_output</a>(outfile, n_plot);</div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;    } <span class="comment">// End of full_output</span></div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160; </div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;<span class="comment">    /// \short Full output function:</span></div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;<span class="comment">    /// x,y,t,u,v,p,du/dt,dv/dt,dissipation in tecplot format. Use</span></div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;<span class="comment">    /// n_plot plot points in each coordinate direction</span></div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a25ce9aa9fb4a3b05a790f3a8b2d1ba4c">full_output</a>(std::ostream&amp; outfile, <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; n_plot);</div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160; </div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;<span class="comment">    /// \short Output function: x,y,t,u,v in tecplot format. Use</span></div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;<span class="comment">    /// n_plot points in each coordinate direction at timestep t (t=0:</span></div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;<span class="comment">    /// present; t&gt;0: previous timestep)</span></div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#abef79bee69def157749fcfbcd80306e7">output_veloc</a>(std::ostream&amp; outfile,</div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;                      <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; nplot,</div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;                      <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; <a class="code" href="cfortran_8h.html#af6f0bd3dc13317f895c91323c25c2b8f">t</a>);</div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160; </div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;<span class="comment">    /// \short Output function: x,y,t,omega</span></div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;<span class="comment">    /// in tecplot format. nplot points in each coordinate direction</span></div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#afbeb69aaf848428c93956f31d47f7622">output_vorticity</a>(std::ostream&amp; outfile, <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; nplot);</div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160; </div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;<span class="comment">    /// \short Output exact solution specified via function pointer</span></div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;<span class="comment">    /// at a given number of plot points. Function prints as</span></div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;<span class="comment">    /// many components as are returned in solution Vector</span></div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a396d11f7e8bfb0db458881165b8f7833">output_fct</a>(std::ostream&amp; outfile,</div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;                    <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; nplot,</div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;                    <a class="code" href="classoomph_1_1FiniteElement.html#a690fd33af26cc3e84f39bba6d5a85202">FiniteElement::SteadyExactSolutionFctPt</a> exact_soln_pt);</div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160; </div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;<span class="comment">    /// \short Output exact solution specified via function pointer</span></div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;<span class="comment">    /// at a given time and at a given number of plot points.</span></div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;<span class="comment">    /// Function prints as many components as are returned in solution Vector.</span></div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a396d11f7e8bfb0db458881165b8f7833">output_fct</a>(std::ostream&amp; outfile,</div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;                    <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; nplot,</div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;                    <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; time,</div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;                    <a class="code" href="classoomph_1_1FiniteElement.html#ad4ecf2b61b158a4b4d351a60d23c633e">FiniteElement::UnsteadyExactSolutionFctPt</a> exact_soln_pt);</div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;<span class="comment">    /// \short Validate against exact solution at given time</span></div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;<span class="comment">    /// Solution is provided via function pointer.</span></div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;<span class="comment">    /// Plot at a given number of plot points and compute L2 error</span></div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;<span class="comment">    /// and L2 norm of velocity solution over element</span></div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#ac3914b37e4cc91cbc2e28f7e8a9793cf">compute_error</a>(std::ostream&amp; outfile,</div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;                       <a class="code" href="classoomph_1_1FiniteElement.html#ad4ecf2b61b158a4b4d351a60d23c633e">FiniteElement::UnsteadyExactSolutionFctPt</a> exact_soln_pt,</div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;                       <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; time,</div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;                       <span class="keywordtype">double</span>&amp; error,</div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;                       <span class="keywordtype">double</span>&amp; norm);</div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160; </div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;<span class="comment">    /// Compute the vector norm of the FEM solution</span></div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a34278c0387e27b8adeaec08aa8e03f66">compute_norm</a>(<a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; norm);</div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160; </div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;<span class="comment">    /// \short Validate against exact solution at given time</span></div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;<span class="comment">    /// Solution is provided via function pointer.</span></div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;<span class="comment">    /// Plot at a given number of plot points and compute L2 error</span></div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;<span class="comment">    /// and L2 norm of velocity solution over element</span></div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#ac3914b37e4cc91cbc2e28f7e8a9793cf">compute_error</a>(std::ostream&amp; outfile,</div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;                       <a class="code" href="classoomph_1_1FiniteElement.html#ad4ecf2b61b158a4b4d351a60d23c633e">FiniteElement::UnsteadyExactSolutionFctPt</a> exact_soln_pt,</div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;                       <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; time,</div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;                       <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; error,</div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;                       <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; norm);</div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160; </div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;<span class="comment">    /// \short Validate against exact solution.</span></div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;<span class="comment">    /// Solution is provided via function pointer.</span></div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;<span class="comment">    /// Plot at a given number of plot points and compute L2 error</span></div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;<span class="comment">    /// and L2 norm of velocity solution over element</span></div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#ac3914b37e4cc91cbc2e28f7e8a9793cf">compute_error</a>(std::ostream&amp; outfile,</div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;                       <a class="code" href="classoomph_1_1FiniteElement.html#a690fd33af26cc3e84f39bba6d5a85202">FiniteElement::SteadyExactSolutionFctPt</a> exact_soln_pt,</div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;                       <span class="keywordtype">double</span>&amp; error,</div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;                       <span class="keywordtype">double</span>&amp; norm);</div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160; </div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;<span class="comment">    /// \short Validate against exact solution. Solution is provided via</span></div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;<span class="comment">    /// function pointer. Compute L2 error and L2 norm of velocity solution</span></div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;<span class="comment">    /// over element.</span></div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#ac3914b37e4cc91cbc2e28f7e8a9793cf">compute_error</a>(<a class="code" href="classoomph_1_1FiniteElement.html#ad4ecf2b61b158a4b4d351a60d23c633e">FiniteElement::UnsteadyExactSolutionFctPt</a> exact_soln_pt,</div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;                       <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; time,</div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;                       <span class="keywordtype">double</span>&amp; error,</div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;                       <span class="keywordtype">double</span>&amp; norm);</div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160; </div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;<span class="comment">    /// \short Validate against exact solution. Solution is provided via</span></div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;<span class="comment">    /// function pointer. Compute L2 error and L2 norm of velocity solution</span></div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;<span class="comment">    /// over element.</span></div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#ac3914b37e4cc91cbc2e28f7e8a9793cf">compute_error</a>(<a class="code" href="classoomph_1_1FiniteElement.html#a690fd33af26cc3e84f39bba6d5a85202">FiniteElement::SteadyExactSolutionFctPt</a> exact_soln_pt,</div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;                       <span class="keywordtype">double</span>&amp; error,</div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;                       <span class="keywordtype">double</span>&amp; norm);</div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160; </div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;<span class="comment">    /// Compute the element&#39;s residual Vector</span></div>
<div class="line"><a name="l01586"></a><span class="lineno"><a class="line" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a63751b26f0427c4a09f32c0f49ce410b"> 1586</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a63751b26f0427c4a09f32c0f49ce410b">fill_in_contribution_to_residuals</a>(<a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; <a class="code" href="the__data__structure_8txt.html#a1400a973def57b85051cfe1070be1810">residuals</a>)</div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;    {</div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;      <span class="comment">// Do we want to compute the Jacobian? ANSWER: No!</span></div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;      <span class="keywordtype">unsigned</span> compute_jacobian_flag = 0;</div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160; </div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;      <span class="comment">// Call the generic residuals function using a dummy matrix argument</span></div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;      <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a99f198e79155480b0d06ad0fa66b027a">fill_in_generic_residual_contribution_nst</a>(</div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;        <a class="code" href="the__data__structure_8txt.html#a1400a973def57b85051cfe1070be1810">residuals</a>,</div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;        <a class="code" href="classoomph_1_1GeneralisedElement.html#a4bff11b8ff97aefabb2df41e61e1779f">GeneralisedElement::Dummy_matrix</a>,</div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;        <a class="code" href="classoomph_1_1GeneralisedElement.html#a4bff11b8ff97aefabb2df41e61e1779f">GeneralisedElement::Dummy_matrix</a>,</div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;        compute_jacobian_flag);</div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;    } <span class="comment">// End of fill_in_contribution_to_residuals</span></div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160; </div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;<span class="comment">    ///\short Compute the element&#39;s residual Vector and the jacobian matrix</span></div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;<span class="comment">    /// Virtual function can be overloaded by hanging-node version</span></div>
<div class="line"><a name="l01602"></a><span class="lineno"><a class="line" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#af986024e19c3b5f8c9c880dcea38e7b0"> 1602</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#af986024e19c3b5f8c9c880dcea38e7b0">fill_in_contribution_to_jacobian</a>(<a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; <a class="code" href="the__data__structure_8txt.html#a1400a973def57b85051cfe1070be1810">residuals</a>,</div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;                                          <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a>&amp; jacobian)</div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;    {</div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;      <span class="comment">// Do we want to compute the Jacobian? ANSWER: Yes!</span></div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;      <span class="keywordtype">unsigned</span> compute_jacobian_flag = 1;</div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160; </div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;      <span class="comment">// Call the generic routine with the flag set to 1</span></div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;      <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a99f198e79155480b0d06ad0fa66b027a">fill_in_generic_residual_contribution_nst</a>(</div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;        <a class="code" href="the__data__structure_8txt.html#a1400a973def57b85051cfe1070be1810">residuals</a>,</div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;        jacobian,</div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;        <a class="code" href="classoomph_1_1GeneralisedElement.html#a4bff11b8ff97aefabb2df41e61e1779f">GeneralisedElement::Dummy_matrix</a>,</div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;        compute_jacobian_flag);</div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;    } <span class="comment">// End of fill_in_contribution_to_residuals</span></div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160; </div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;<span class="comment">    /// \short Add the element&#39;s contribution to its residuals vector,</span></div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;<span class="comment">    /// jacobian matrix and mass matrix</span></div>
<div class="line"><a name="l01619"></a><span class="lineno"><a class="line" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a72a0b348de77b1855d47429dd7430682"> 1619</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a72a0b348de77b1855d47429dd7430682">fill_in_contribution_to_jacobian_and_mass_matrix</a>(</div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;      <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; <a class="code" href="the__data__structure_8txt.html#a1400a973def57b85051cfe1070be1810">residuals</a>,</div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;      <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a>&amp; jacobian,</div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;      <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a>&amp; mass_matrix)</div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;    {</div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;      <span class="comment">// Do we want to compute the Jacobian AND mass matrix? ANSWER: Yes!</span></div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;      <span class="keywordtype">unsigned</span> compute_matrices_flag = 2;</div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160; </div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;      <span class="comment">// Call the generic routine with the flag set to 2</span></div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;      <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a99f198e79155480b0d06ad0fa66b027a">fill_in_generic_residual_contribution_nst</a>(</div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;        <a class="code" href="the__data__structure_8txt.html#a1400a973def57b85051cfe1070be1810">residuals</a>, jacobian, mass_matrix, compute_matrices_flag);</div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;    } <span class="comment">// End of fill_in_contribution_to_jacobian_and_mass_matrix</span></div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160; </div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;<span class="comment">    /// Compute the element&#39;s residual Vector (differentiated w.r.t. a</span></div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;<span class="comment">    /// parameter)</span></div>
<div class="line"><a name="l01635"></a><span class="lineno"><a class="line" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a7aeaf71b3ffa04114f9d44f630af84c2"> 1635</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a7aeaf71b3ffa04114f9d44f630af84c2">fill_in_contribution_to_dresiduals_dparameter</a>(</div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;      <span class="keywordtype">double</span>* <span class="keyword">const</span>&amp; parameter_pt, <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; dres_dparam)</div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;    {</div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;      <span class="comment">// Do we want to compute the Jacobian? ANSWER: No!</span></div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;      <span class="keywordtype">unsigned</span> compute_jacobian_flag = 0;</div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160; </div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;      <span class="comment">// Call the generic residuals function using a dummy matrix argument</span></div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;      <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a7140c69be3970e645773bb5d6ae41e34">fill_in_generic_dresidual_contribution_nst</a>(</div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;        parameter_pt,</div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;        dres_dparam,</div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;        <a class="code" href="classoomph_1_1GeneralisedElement.html#a4bff11b8ff97aefabb2df41e61e1779f">GeneralisedElement::Dummy_matrix</a>,</div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;        <a class="code" href="classoomph_1_1GeneralisedElement.html#a4bff11b8ff97aefabb2df41e61e1779f">GeneralisedElement::Dummy_matrix</a>,</div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;        compute_jacobian_flag);</div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;    } <span class="comment">// End of fill_in_contribution_to_dresiduals_dparameter</span></div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160; </div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;<span class="comment">    /// \short Compute the element&#39;s residual Vector and the jacobian matrix</span></div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;<span class="comment">    /// Virtual function can be overloaded by hanging-node version</span></div>
<div class="line"><a name="l01653"></a><span class="lineno"><a class="line" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#ad994654e6b67f8fe23baec0c1a15cac7"> 1653</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#ad994654e6b67f8fe23baec0c1a15cac7">fill_in_contribution_to_djacobian_dparameter</a>(</div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;      <span class="keywordtype">double</span>* <span class="keyword">const</span>&amp; parameter_pt,</div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;      <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; dres_dparam,</div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;      <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a>&amp; djac_dparam)</div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;    {</div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;      <span class="comment">// Do we want to compute the Jacobian? ANSWER: Yes!</span></div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;      <span class="keywordtype">unsigned</span> compute_jacobian_flag = 1;</div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160; </div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;      <span class="comment">// Call the generic routine with the flag set to 1</span></div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;      <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a7140c69be3970e645773bb5d6ae41e34">fill_in_generic_dresidual_contribution_nst</a>(</div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;        parameter_pt,</div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;        dres_dparam,</div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;        djac_dparam,</div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;        <a class="code" href="classoomph_1_1GeneralisedElement.html#a4bff11b8ff97aefabb2df41e61e1779f">GeneralisedElement::Dummy_matrix</a>,</div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;        compute_jacobian_flag);</div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;    } <span class="comment">// End of fill_in_contribution_to_djacobian_dparameter</span></div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160; </div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;<span class="comment">    /// Add the element&#39;s contribution to its residuals vector,</span></div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;<span class="comment">    /// jacobian matrix and mass matrix</span></div>
<div class="line"><a name="l01673"></a><span class="lineno"><a class="line" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#aa8950bfab421438e63717ac8317f6911"> 1673</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#aa8950bfab421438e63717ac8317f6911">fill_in_contribution_to_djacobian_and_dmass_matrix_dparameter</a>(</div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;      <span class="keywordtype">double</span>* <span class="keyword">const</span>&amp; parameter_pt,</div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;      <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; dres_dparam,</div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;      <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a>&amp; djac_dparam,</div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;      <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a>&amp; dmass_matrix_dparam)</div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;    {</div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;      <span class="comment">// Do we want to compute the Jacobian AND mass matrix? ANSWER: Yes!</span></div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;      <span class="keywordtype">unsigned</span> compute_matrices_flag = 2;</div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160; </div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;      <span class="comment">// Call the generic routine with the appropriate flag</span></div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;      <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a7140c69be3970e645773bb5d6ae41e34">fill_in_generic_dresidual_contribution_nst</a>(parameter_pt,</div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;                                                 dres_dparam,</div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;                                                 djac_dparam,</div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;                                                 dmass_matrix_dparam,</div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;                                                 compute_matrices_flag);</div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;    } <span class="comment">// End of fill_in_contribution_to_djacobian_and_dmass_matrix_dparameter</span></div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160; </div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;<span class="comment">    /// \short Compute the residuals for the associated pressure advection</span></div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;<span class="comment">    /// diffusion problem. Used by the Fp preconditioner.</span></div>
<div class="line"><a name="l01693"></a><span class="lineno"><a class="line" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a8ea25af36d4683982003e1e2597d4ca0"> 1693</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a8ea25af36d4683982003e1e2597d4ca0">fill_in_pressure_advection_diffusion_residuals</a>(</div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;      <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; <a class="code" href="the__data__structure_8txt.html#a1400a973def57b85051cfe1070be1810">residuals</a>)</div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;    {</div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;      <span class="comment">// Do we want to compute the Jacobian? ANSWER: No!</span></div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;      <span class="keywordtype">unsigned</span> compute_jacobian_flag = 0;</div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160; </div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;      <span class="comment">// Call the generic routine with the appropriate flag</span></div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;      <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a6a434922a2d92ec0c12978ba7361971b">fill_in_generic_pressure_advection_diffusion_contribution_nst</a>(</div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;        <a class="code" href="the__data__structure_8txt.html#a1400a973def57b85051cfe1070be1810">residuals</a>, <a class="code" href="classoomph_1_1GeneralisedElement.html#a4bff11b8ff97aefabb2df41e61e1779f">GeneralisedElement::Dummy_matrix</a>, compute_jacobian_flag);</div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;    } <span class="comment">// End of fill_in_pressure_advection_diffusion_residuals</span></div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160; </div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;<span class="comment">    /// \short Compute the residuals and Jacobian for the associated</span></div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;<span class="comment">    /// pressure advection diffusion problem. Used by the Fp preconditioner.</span></div>
<div class="line"><a name="l01707"></a><span class="lineno"><a class="line" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a0ba16529bfdadde8c927ac92e2e95941"> 1707</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a0ba16529bfdadde8c927ac92e2e95941">fill_in_pressure_advection_diffusion_jacobian</a>(</div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;      <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; <a class="code" href="the__data__structure_8txt.html#a1400a973def57b85051cfe1070be1810">residuals</a>, <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a>&amp; jacobian)</div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;    {</div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;      <span class="comment">// Do we want to compute the Jacobian? ANSWER: Yes!</span></div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;      <span class="keywordtype">unsigned</span> compute_jacobian_flag = 1;</div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160; </div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;      <span class="comment">// Call the generic routine with the appropriate flag</span></div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;      <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a6a434922a2d92ec0c12978ba7361971b">fill_in_generic_pressure_advection_diffusion_contribution_nst</a>(</div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;        <a class="code" href="the__data__structure_8txt.html#a1400a973def57b85051cfe1070be1810">residuals</a>, jacobian, compute_jacobian_flag);</div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;    } <span class="comment">// End of fill_in_pressure_advection_diffusion_jacobian</span></div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160; </div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;<span class="comment">    /// \short Pin all non-pressure dofs and backup eqn numbers</span></div>
<div class="line"><a name="l01720"></a><span class="lineno"><a class="line" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#aaf9a79f73d7d40142feb4dbf395428da"> 1720</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#aaf9a79f73d7d40142feb4dbf395428da">pin_all_non_pressure_dofs</a>(</div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;      std::map&lt;<a class="code" href="classoomph_1_1Data.html">Data</a>*, std::vector&lt;int&gt;&gt;&amp; eqn_number_backup)</div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;    {</div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;      <span class="comment">// Loop over internal data and pin the values (having established that</span></div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;      <span class="comment">// pressure dofs aren&#39;t amongst those)</span></div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;      <span class="keywordtype">unsigned</span> nint = this-&gt;<a class="code" href="classoomph_1_1GeneralisedElement.html#a6b736de0af4c92831968636479b3480e">ninternal_data</a>();</div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j = 0; j &lt; nint; j++)</div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;      {</div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;        <a class="code" href="classoomph_1_1Data.html">Data</a>* data_pt = this-&gt;<a class="code" href="classoomph_1_1GeneralisedElement.html#a45e32d895d4b3686e0f15fe455f4ed44">internal_data_pt</a>(j);</div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;        <span class="keywordflow">if</span> (eqn_number_backup[data_pt].<a class="code" href="classoomph_1_1FiniteElement.html#a4986a443968d3741fde4d6c6012cd586">size</a>() == 0)</div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;        {</div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;          <span class="keywordtype">unsigned</span> nvalue = data_pt-&gt;<a class="code" href="classoomph_1_1Data.html#a7e67fc78a2e8a2fd6eb75bd292d42ff8">nvalue</a>();</div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;          eqn_number_backup[data_pt].resize(nvalue);</div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a> = 0; <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a> &lt; nvalue; <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;          {</div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;            <span class="comment">// Backup</span></div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;            eqn_number_backup[data_pt][<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] = data_pt-&gt;<a class="code" href="classoomph_1_1Data.html#a13206dcb7a088db0ef845ab71af505d2">eqn_number</a>(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>);</div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160; </div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;            <span class="comment">// Pin everything</span></div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;            data_pt-&gt;<a class="code" href="classoomph_1_1Data.html#a422231c58e423f0b43822827aa334d79">pin</a>(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>);</div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;          }</div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;        }</div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;      }</div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160; </div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;      <span class="comment">// Now deal with nodal values</span></div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;      <span class="keywordtype">unsigned</span> nnod = this-&gt;<a class="code" href="classoomph_1_1FiniteElement.html#a6219ed269a6d89b5aa14659cce48905a">nnode</a>();</div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j = 0; j &lt; nnod; j++)</div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;      {</div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;        <a class="code" href="classoomph_1_1Node.html">Node</a>* nod_pt = this-&gt;<a class="code" href="classoomph_1_1FiniteElement.html#a28ae3eb7760edc5c9d6427611d8e6fb6">node_pt</a>(j);</div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;        <span class="keywordflow">if</span> (eqn_number_backup[nod_pt].<a class="code" href="classoomph_1_1FiniteElement.html#a4986a443968d3741fde4d6c6012cd586">size</a>() == 0)</div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;        {</div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;          <span class="keywordtype">unsigned</span> nvalue = nod_pt-&gt;<a class="code" href="classoomph_1_1Data.html#a7e67fc78a2e8a2fd6eb75bd292d42ff8">nvalue</a>();</div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;          eqn_number_backup[nod_pt].resize(nvalue);</div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a> = 0; <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a> &lt; nvalue; <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;          {</div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;            <span class="comment">// Pin everything apart from the nodal pressure</span></div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;            <span class="comment">// value</span></div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;            <span class="keywordflow">if</span> (<span class="keywordtype">int</span>(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>) != this-&gt;<a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a3310817460a8301d3eba3f68a2399a2a">p_nodal_index_nst</a>())</div>
<div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;            {</div>
<div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;              <span class="comment">// Backup</span></div>
<div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;              eqn_number_backup[nod_pt][<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] = nod_pt-&gt;<a class="code" href="classoomph_1_1Data.html#a13206dcb7a088db0ef845ab71af505d2">eqn_number</a>(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>);</div>
<div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160; </div>
<div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;              <span class="comment">// Pin</span></div>
<div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;              nod_pt-&gt;<a class="code" href="classoomph_1_1Data.html#a422231c58e423f0b43822827aa334d79">pin</a>(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>);</div>
<div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;            }</div>
<div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;            <span class="comment">// Else it&#39;s a pressure value</span></div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;            {</div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;              <span class="comment">// Exclude non-nodal pressure based elements</span></div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;              <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a3310817460a8301d3eba3f68a2399a2a">p_nodal_index_nst</a>() &gt;= 0)</div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;              {</div>
<div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;                <span class="comment">// Backup</span></div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;                eqn_number_backup[nod_pt][<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] = nod_pt-&gt;<a class="code" href="classoomph_1_1Data.html#a13206dcb7a088db0ef845ab71af505d2">eqn_number</a>(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>);</div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;              }</div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;            }</div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;          }</div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160; </div>
<div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160; </div>
<div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;          <span class="comment">// If it&#39;s a solid node deal with its positional data too</span></div>
<div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;          <a class="code" href="classoomph_1_1SolidNode.html">SolidNode</a>* solid_nod_pt = <span class="keyword">dynamic_cast&lt;</span><a class="code" href="classoomph_1_1SolidNode.html">SolidNode</a>*<span class="keyword">&gt;</span>(nod_pt);</div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;          <span class="keywordflow">if</span> (solid_nod_pt != 0)</div>
<div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;          {</div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;            <a class="code" href="classoomph_1_1Data.html">Data</a>* solid_posn_data_pt = solid_nod_pt-&gt;<a class="code" href="classoomph_1_1SolidNode.html#ae9a8abd197728f5555730131fa0f6971">variable_position_pt</a>();</div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;            <span class="keywordflow">if</span> (eqn_number_backup[solid_posn_data_pt].<a class="code" href="classoomph_1_1FiniteElement.html#a4986a443968d3741fde4d6c6012cd586">size</a>() == 0)</div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;            {</div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;              <span class="keywordtype">unsigned</span> nvalue = solid_posn_data_pt-&gt;<a class="code" href="classoomph_1_1Data.html#a7e67fc78a2e8a2fd6eb75bd292d42ff8">nvalue</a>();</div>
<div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;              eqn_number_backup[solid_posn_data_pt].resize(nvalue);</div>
<div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a> = 0; <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a> &lt; nvalue; <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;              {</div>
<div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;                <span class="comment">// Backup</span></div>
<div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;                eqn_number_backup[solid_posn_data_pt][<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] =</div>
<div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;                  solid_posn_data_pt-&gt;<a class="code" href="classoomph_1_1Data.html#a13206dcb7a088db0ef845ab71af505d2">eqn_number</a>(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>);</div>
<div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160; </div>
<div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;                <span class="comment">// Pin</span></div>
<div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;                solid_posn_data_pt-&gt;<a class="code" href="classoomph_1_1Data.html#a422231c58e423f0b43822827aa334d79">pin</a>(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>);</div>
<div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;              }</div>
<div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;            }</div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;          }</div>
<div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;        }</div>
<div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;      }</div>
<div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;    } <span class="comment">// End of pin_all_non_pressure_dofs</span></div>
<div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160; </div>
<div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;<span class="comment">    /// \short Build FaceElements that apply the Robin boundary condition</span></div>
<div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;<span class="comment">    /// to the pressure advection diffusion problem required by</span></div>
<div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;<span class="comment">    /// Fp preconditioner</span></div>
<div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;<span class="comment"></span>    <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#aecc863dbffc26cf2961d7783bb5237c6">build_fp_press_adv_diff_robin_bc_element</a>(</div>
<div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; face_index) = 0;</div>
<div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160; </div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;<span class="comment">    /// \short Output the FaceElements that apply the Robin boundary condition</span></div>
<div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;<span class="comment">    /// to the pressure advection diffusion problem required by</span></div>
<div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;<span class="comment">    /// Fp preconditioner</span></div>
<div class="line"><a name="l01813"></a><span class="lineno"><a class="line" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#ae25ed8682172ec91a8f72787ff98ff9b"> 1813</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#ae25ed8682172ec91a8f72787ff98ff9b">output_pressure_advection_diffusion_robin_elements</a>(</div>
<div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;      std::ostream&amp; outfile)</div>
<div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;    {</div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;      <span class="keywordtype">unsigned</span> nel = <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a6d88396b9bb8a88f24f9df1d17e75d0e">Pressure_advection_diffusion_robin_element_pt</a>.size();</div>
<div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#a37cd013acc76697829c324bdd8562d82">e</a> = 0; <a class="code" href="cfortran_8h.html#a37cd013acc76697829c324bdd8562d82">e</a> &lt; nel; <a class="code" href="cfortran_8h.html#a37cd013acc76697829c324bdd8562d82">e</a>++)</div>
<div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;      {</div>
<div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;        <a class="code" href="classoomph_1_1FaceElement.html">FaceElement</a>* face_el_pt =</div>
<div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;          <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a6d88396b9bb8a88f24f9df1d17e75d0e">Pressure_advection_diffusion_robin_element_pt</a>[<a class="code" href="cfortran_8h.html#a37cd013acc76697829c324bdd8562d82">e</a>];</div>
<div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;        outfile &lt;&lt; <span class="stringliteral">&quot;ZONE&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;        <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> unit_normal(DIM);</div>
<div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;        <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> x(DIM + 1);</div>
<div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;        <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>(DIM);</div>
<div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;        <span class="keywordtype">unsigned</span> <a class="code" href="the__data__structure_8txt.html#af88b2d950fae19ab641bd1690e08445c">n</a> = face_el_pt-&gt;<a class="code" href="classoomph_1_1FiniteElement.html#a751dc02ff1325f799840d79ee415753a">integral_pt</a>()-&gt;<a class="code" href="classoomph_1_1Integral.html#a1a270de9d99a1fcf1d25a6c1017f65fa">nweight</a>();</div>
<div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> ipt = 0; ipt &lt; <a class="code" href="the__data__structure_8txt.html#af88b2d950fae19ab641bd1690e08445c">n</a>; ipt++)</div>
<div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;        {</div>
<div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a> = 0; <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a> &lt; DIM; <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;          {</div>
<div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;            <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] = face_el_pt-&gt;<a class="code" href="classoomph_1_1FiniteElement.html#a751dc02ff1325f799840d79ee415753a">integral_pt</a>()-&gt;<a class="code" href="classoomph_1_1Integral.html#a1a2122f99a87c18649bafdd9ed739758">knot</a>(ipt, <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>);</div>
<div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;          }</div>
<div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;          face_el_pt-&gt;<a class="code" href="classoomph_1_1FaceElement.html#a7aa612fec3604e08344503fbcdc357c8">interpolated_x</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>, x);</div>
<div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;          face_el_pt-&gt;<a class="code" href="classoomph_1_1FaceElement.html#a49cf44d89e80926635d2a26abfbbf3b0">outer_unit_normal</a>(ipt, unit_normal);</div>
<div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a> = 0; <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a> &lt; DIM + 1; <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;          {</div>
<div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;            outfile &lt;&lt; x[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;          }</div>
<div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a> = 0; <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a> &lt; DIM; <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;          {</div>
<div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;            outfile &lt;&lt; unit_normal[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;          }</div>
<div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;          outfile &lt;&lt; std::endl;</div>
<div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;        }</div>
<div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;      }</div>
<div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;    } <span class="comment">// End of output_pressure_advection_diffusion_robin_elements</span></div>
<div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160; </div>
<div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;<span class="comment">    /// \short Delete the FaceElements that apply the Robin boundary condition</span></div>
<div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;<span class="comment">    /// to the pressure advection diffusion problem required by</span></div>
<div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;<span class="comment">    /// Fp preconditioner</span></div>
<div class="line"><a name="l01851"></a><span class="lineno"><a class="line" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a336cd70799bda69ff25579d9e13da56f"> 1851</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a336cd70799bda69ff25579d9e13da56f">delete_pressure_advection_diffusion_robin_elements</a>()</div>
<div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;    {</div>
<div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;      <span class="keywordtype">unsigned</span> nel = <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a6d88396b9bb8a88f24f9df1d17e75d0e">Pressure_advection_diffusion_robin_element_pt</a>.size();</div>
<div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#a37cd013acc76697829c324bdd8562d82">e</a> = 0; <a class="code" href="cfortran_8h.html#a37cd013acc76697829c324bdd8562d82">e</a> &lt; nel; <a class="code" href="cfortran_8h.html#a37cd013acc76697829c324bdd8562d82">e</a>++)</div>
<div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;      {</div>
<div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;        <span class="keyword">delete</span> <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a6d88396b9bb8a88f24f9df1d17e75d0e">Pressure_advection_diffusion_robin_element_pt</a>[<a class="code" href="cfortran_8h.html#a37cd013acc76697829c324bdd8562d82">e</a>];</div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;      }</div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;      <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a6d88396b9bb8a88f24f9df1d17e75d0e">Pressure_advection_diffusion_robin_element_pt</a>.clear();</div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;    } <span class="comment">// End of delete_pressure_advection_diffusion_robin_elements</span></div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160; </div>
<div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;<span class="comment">    /// \short Compute derivatives of elemental residual vector with respect</span></div>
<div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;<span class="comment">    /// to nodal coordinates. Overwrites default implementation in</span></div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;<span class="comment">    /// FiniteElement base class.</span></div>
<div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;<span class="comment">    /// dresidual_dnodal_coordinates(l,i,j)=d res(l) / dX_{ij}</span></div>
<div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;<span class="comment"></span>    <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#ac6317680ee7fcef4a9e353302854413c">get_dresidual_dnodal_coordinates</a>(</div>
<div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;      <a class="code" href="classoomph_1_1RankThreeTensor.html">RankThreeTensor&lt;double&gt;</a>&amp; dresidual_dnodal_coordinates);</div>
<div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160; </div>
<div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;<span class="comment">    /// Compute vector of FE interpolated velocity u at local coordinate s</span></div>
<div class="line"><a name="l01871"></a><span class="lineno"><a class="line" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#ab05a01e85edefd811e44fe480a675ebb"> 1871</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#ab05a01e85edefd811e44fe480a675ebb">interpolated_u_nst</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,</div>
<div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;                            <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; velocity)<span class="keyword"> const</span></div>
<div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;<span class="keyword">    </span>{</div>
<div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;      <span class="comment">// Find the number of nodes</span></div>
<div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;      <span class="keywordtype">unsigned</span> n_node = <a class="code" href="classoomph_1_1FiniteElement.html#a6219ed269a6d89b5aa14659cce48905a">nnode</a>();</div>
<div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160; </div>
<div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;      <span class="comment">// Local shape function</span></div>
<div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;      <a class="code" href="classoomph_1_1Shape.html">Shape</a> psi(n_node);</div>
<div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160; </div>
<div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;      <span class="comment">// Find values of shape function</span></div>
<div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;      <a class="code" href="classoomph_1_1FiniteElement.html#a58a25b6859ddd43b7bfe64a19fee5023">shape</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>, psi);</div>
<div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160; </div>
<div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;      <span class="comment">// Loop over the velocity components</span></div>
<div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a> = 0; <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a> &lt; DIM; <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;      {</div>
<div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;        <span class="comment">// Index at which the nodal value is stored</span></div>
<div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;        <span class="keywordtype">unsigned</span> u_nodal_index = <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#abd193a0c754ddfc7b87ee7ec9f7e7694">u_index_nst</a>(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>);</div>
<div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160; </div>
<div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;        <span class="comment">// Initialise the i-th value of the velocity vector</span></div>
<div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;        velocity[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] = 0.0;</div>
<div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160; </div>
<div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;        <span class="comment">// Loop over the local nodes and sum</span></div>
<div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> l = 0; l &lt; n_node; l++)</div>
<div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;        {</div>
<div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;          <span class="comment">// Update the i-th velocity component approximation</span></div>
<div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;          velocity[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] += <a class="code" href="classoomph_1_1FiniteElement.html#a28fd5c2d4aeba5ef65bee0e0d72569f5">nodal_value</a>(l, u_nodal_index) * psi[l];</div>
<div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;        }</div>
<div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;      } <span class="comment">// for (unsigned i=0;i&lt;DIM;i++)</span></div>
<div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;    } <span class="comment">// End of interpolated_u_nst</span></div>
<div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160; </div>
<div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;<span class="comment">    /// Return FE interpolated velocity u[i] at local coordinate s</span></div>
<div class="line"><a name="l01903"></a><span class="lineno"><a class="line" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a9876971336810a9b786bd4d2dc07f3fe"> 1903</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a9876971336810a9b786bd4d2dc07f3fe">interpolated_u_nst</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>, <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>)<span class="keyword"> const</span></div>
<div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;<span class="keyword">    </span>{</div>
<div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;      <span class="comment">// Find the number of nodes</span></div>
<div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;      <span class="keywordtype">unsigned</span> n_node = <a class="code" href="classoomph_1_1FiniteElement.html#a6219ed269a6d89b5aa14659cce48905a">nnode</a>();</div>
<div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160; </div>
<div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;      <span class="comment">// Local shape function</span></div>
<div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;      <a class="code" href="classoomph_1_1Shape.html">Shape</a> psi(n_node);</div>
<div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160; </div>
<div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;      <span class="comment">// Find values of shape function</span></div>
<div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;      <a class="code" href="classoomph_1_1FiniteElement.html#a58a25b6859ddd43b7bfe64a19fee5023">shape</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>, psi);</div>
<div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160; </div>
<div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;      <span class="comment">// Get nodal index at which i-th velocity is stored</span></div>
<div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;      <span class="keywordtype">unsigned</span> u_nodal_index = <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#abd193a0c754ddfc7b87ee7ec9f7e7694">u_index_nst</a>(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>);</div>
<div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160; </div>
<div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;      <span class="comment">// Initialise value of u</span></div>
<div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;      <span class="keywordtype">double</span> <a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a> = 0.0;</div>
<div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160; </div>
<div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;      <span class="comment">// Loop over the local nodes and sum</span></div>
<div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> l = 0; l &lt; n_node; l++)</div>
<div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;      {</div>
<div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;        <span class="comment">// Update the i-th velocity component approximation</span></div>
<div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;        <a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a> += <a class="code" href="classoomph_1_1FiniteElement.html#a28fd5c2d4aeba5ef65bee0e0d72569f5">nodal_value</a>(l, u_nodal_index) * psi[l];</div>
<div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;      }</div>
<div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160; </div>
<div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;      <span class="comment">// Return the calculated approximation to the i-th velocity component</span></div>
<div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>;</div>
<div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;    } <span class="comment">// End of interpolated_u_nst</span></div>
<div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160; </div>
<div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;<span class="comment">    /// \short Return FE interpolated velocity u[i] at local coordinate s</span></div>
<div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;<span class="comment">    /// time level, t. Purposely broken for space-time elements.</span></div>
<div class="line"><a name="l01934"></a><span class="lineno"><a class="line" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#abf2d3ed63a89a44d045885e0a3db0a2d"> 1934</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#abf2d3ed63a89a44d045885e0a3db0a2d">interpolated_u_nst</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; <a class="code" href="cfortran_8h.html#af6f0bd3dc13317f895c91323c25c2b8f">t</a>,</div>
<div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;                              <span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,</div>
<div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;                              <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>)<span class="keyword"> const</span></div>
<div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;<span class="keyword">    </span>{</div>
<div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;      <span class="comment">// Create an output stream</span></div>
<div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;      std::ostringstream error_message_stream;</div>
<div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160; </div>
<div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;      <span class="comment">// Create an error message</span></div>
<div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;      error_message_stream &lt;&lt; <span class="stringliteral">&quot;This interface doesn&#39;t make sense in &quot;</span></div>
<div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;                           &lt;&lt; <span class="stringliteral">&quot;space-time elements!&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160; </div>
<div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;      <span class="comment">// Throw an error</span></div>
<div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;      <span class="keywordflow">throw</span> <a class="code" href="classoomph_1_1OomphLibError.html">OomphLibError</a>(error_message_stream.str(),</div>
<div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;                          OOMPH_CURRENT_FUNCTION,</div>
<div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;                          OOMPH_EXCEPTION_LOCATION);</div>
<div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;    } <span class="comment">// End of interpolated_u_nst</span></div>
<div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160; </div>
<div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;<span class="comment">    /// \short Compute the derivatives of the i-th component of</span></div>
<div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;<span class="comment">    /// velocity at point s with respect</span></div>
<div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;<span class="comment">    /// to all data that can affect its value. In addition, return the global</span></div>
<div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;<span class="comment">    /// equation numbers corresponding to the data. The function is virtual</span></div>
<div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;<span class="comment">    /// so that it can be overloaded in the refineable version</span></div>
<div class="line"><a name="l01957"></a><span class="lineno"><a class="line" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a0b2453a95e142257c468ec07c65e1414"> 1957</a></span>&#160;<span class="comment"></span>    <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a0b2453a95e142257c468ec07c65e1414">dinterpolated_u_nst_ddata</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,</div>
<div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;                                           <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>,</div>
<div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;                                           <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; du_ddata,</div>
<div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;                                           <a class="code" href="classoomph_1_1Vector.html">Vector&lt;unsigned&gt;</a>&amp; global_eqn_number)</div>
<div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;    {</div>
<div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;      <span class="comment">// Find the number of nodes</span></div>
<div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;      <span class="keywordtype">unsigned</span> n_node = <a class="code" href="classoomph_1_1FiniteElement.html#a6219ed269a6d89b5aa14659cce48905a">nnode</a>();</div>
<div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160; </div>
<div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;      <span class="comment">// Local shape function</span></div>
<div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;      <a class="code" href="classoomph_1_1Shape.html">Shape</a> psi(n_node);</div>
<div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160; </div>
<div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;      <span class="comment">// Find values of shape function</span></div>
<div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;      <a class="code" href="classoomph_1_1FiniteElement.html#a58a25b6859ddd43b7bfe64a19fee5023">shape</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>, psi);</div>
<div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160; </div>
<div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;      <span class="comment">// Get nodal index at which i-th velocity is stored</span></div>
<div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;      <span class="keywordtype">unsigned</span> u_nodal_index = <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#abd193a0c754ddfc7b87ee7ec9f7e7694">u_index_nst</a>(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>);</div>
<div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160; </div>
<div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;      <span class="comment">// Find the number of dofs associated with interpolated u</span></div>
<div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;      <span class="keywordtype">unsigned</span> n_u_dof = 0;</div>
<div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160; </div>
<div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;      <span class="comment">// Loop over the nodes</span></div>
<div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> l = 0; l &lt; n_node; l++)</div>
<div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;      {</div>
<div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;        <span class="comment">// Get the global equation number of the dof</span></div>
<div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;        <span class="keywordtype">int</span> global_eqn = this-&gt;<a class="code" href="classoomph_1_1FiniteElement.html#a28ae3eb7760edc5c9d6427611d8e6fb6">node_pt</a>(l)-&gt;<a class="code" href="classoomph_1_1Data.html#a13206dcb7a088db0ef845ab71af505d2">eqn_number</a>(u_nodal_index);</div>
<div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160; </div>
<div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;        <span class="comment">// If it&#39;s positive add to the count</span></div>
<div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;        <span class="keywordflow">if</span> (global_eqn &gt;= 0)</div>
<div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;        {</div>
<div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;          <span class="comment">// Increment the counter</span></div>
<div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;          n_u_dof++;</div>
<div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;        }</div>
<div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;      } <span class="comment">// End of dinterpolated_u_nst_ddata</span></div>
<div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160; </div>
<div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;      <span class="comment">// Now resize the storage schemes</span></div>
<div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;      du_ddata.resize(n_u_dof, 0.0);</div>
<div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;      global_eqn_number.resize(n_u_dof, 0);</div>
<div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160; </div>
<div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;      <span class="comment">// Loop over th nodes again and set the derivatives</span></div>
<div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;      <span class="keywordtype">unsigned</span> count = 0;</div>
<div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;      <span class="comment">// Loop over the local nodes and sum</span></div>
<div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> l = 0; l &lt; n_node; l++)</div>
<div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;      {</div>
<div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;        <span class="comment">// Get the global equation number</span></div>
<div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;        <span class="keywordtype">int</span> global_eqn = this-&gt;<a class="code" href="classoomph_1_1FiniteElement.html#a28ae3eb7760edc5c9d6427611d8e6fb6">node_pt</a>(l)-&gt;<a class="code" href="classoomph_1_1Data.html#a13206dcb7a088db0ef845ab71af505d2">eqn_number</a>(u_nodal_index);</div>
<div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;        <span class="keywordflow">if</span> (global_eqn &gt;= 0)</div>
<div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;        {</div>
<div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;          <span class="comment">// Set the global equation number</span></div>
<div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;          global_eqn_number[count] = global_eqn;</div>
<div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;          <span class="comment">// Set the derivative with respect to the unknown</span></div>
<div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;          du_ddata[count] = psi[l];</div>
<div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;          <span class="comment">// Increase the counter</span></div>
<div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;          ++count;</div>
<div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;        }</div>
<div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;      }</div>
<div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;    } <span class="comment">// End of dinterpolated_u_nst_ddata</span></div>
<div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160; </div>
<div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;<span class="comment">    /// Return FE interpolated pressure at local coordinate s</span></div>
<div class="line"><a name="l02016"></a><span class="lineno"><a class="line" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a5591b7cb6a6560aec9f7cc058798c63c"> 2016</a></span>&#160;<span class="comment"></span>    <span class="keyword">virtual</span> <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a5591b7cb6a6560aec9f7cc058798c63c">interpolated_p_nst</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>)<span class="keyword"> const</span></div>
<div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;<span class="keyword">    </span>{</div>
<div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;      <span class="comment">// Find number of nodes</span></div>
<div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;      <span class="keywordtype">unsigned</span> n_pres = <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a9484c60ff5a5099f41d277c1d2cf79f4">npres_nst</a>();</div>
<div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;      <span class="comment">// Local shape function</span></div>
<div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;      <a class="code" href="classoomph_1_1Shape.html">Shape</a> psi(n_pres);</div>
<div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;      <span class="comment">// Find values of shape function</span></div>
<div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;      <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#abc954710873355daeeb3ef3c9720ab56">pshape_nst</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>, psi);</div>
<div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160; </div>
<div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;      <span class="comment">// Initialise value of p</span></div>
<div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;      <span class="keywordtype">double</span> interpolated_p = 0.0;</div>
<div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;      <span class="comment">// Loop over the local nodes and sum</span></div>
<div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> l = 0; l &lt; n_pres; l++)</div>
<div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;      {</div>
<div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;        interpolated_p += <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a6ef4daae1df889c98d325fa232bb4431">p_nst</a>(l) * psi[l];</div>
<div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;      }</div>
<div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160; </div>
<div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;      <span class="keywordflow">return</span> (interpolated_p);</div>
<div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;    }</div>
<div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160; </div>
<div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;<span class="comment">    /// Return FE interpolated pressure at local coordinate s at time level t</span></div>
<div class="line"><a name="l02038"></a><span class="lineno"><a class="line" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#afba8c33595dfc9198e991f30767bdc8a"> 2038</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#afba8c33595dfc9198e991f30767bdc8a">interpolated_p_nst</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; <a class="code" href="cfortran_8h.html#af6f0bd3dc13317f895c91323c25c2b8f">t</a>, <span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>)<span class="keyword"> const</span></div>
<div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;<span class="keyword">    </span>{</div>
<div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;      <span class="comment">// Find number of nodes</span></div>
<div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;      <span class="keywordtype">unsigned</span> n_pres = <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a9484c60ff5a5099f41d277c1d2cf79f4">npres_nst</a>();</div>
<div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;      <span class="comment">// Local shape function</span></div>
<div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;      <a class="code" href="classoomph_1_1Shape.html">Shape</a> psi(n_pres);</div>
<div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;      <span class="comment">// Find values of shape function</span></div>
<div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;      <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#abc954710873355daeeb3ef3c9720ab56">pshape_nst</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>, psi);</div>
<div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160; </div>
<div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;      <span class="comment">// Initialise value of p</span></div>
<div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;      <span class="keywordtype">double</span> interpolated_p = 0.0;</div>
<div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;      <span class="comment">// Loop over the local nodes and sum</span></div>
<div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> l = 0; l &lt; n_pres; l++)</div>
<div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;      {</div>
<div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;        interpolated_p += <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a6ef4daae1df889c98d325fa232bb4431">p_nst</a>(<a class="code" href="cfortran_8h.html#af6f0bd3dc13317f895c91323c25c2b8f">t</a>, l) * psi[l];</div>
<div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;      }</div>
<div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160; </div>
<div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;      <span class="keywordflow">return</span> (interpolated_p);</div>
<div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;    }</div>
<div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160; </div>
<div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;<span class="comment">    /// \short Output solution in data vector at local cordinates s:</span></div>
<div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;<span class="comment">    /// x,y,z,u,v,p</span></div>
<div class="line"><a name="l02061"></a><span class="lineno"><a class="line" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a5efa373b087faff024f969e21f928da3"> 2061</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a5efa373b087faff024f969e21f928da3">point_output_data</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>, <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; data)</div>
<div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;    {</div>
<div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;      <span class="comment">// Resize data for values</span></div>
<div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;      data.resize(2 * DIM + 2);</div>
<div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160; </div>
<div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;      <span class="comment">// Write values in the vector</span></div>
<div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a> = 0; <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a> &lt; DIM + 1; <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;      {</div>
<div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;        <span class="comment">// Output the i-th (Eulerian) coordinate at these local coordinates</span></div>
<div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;        data[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] = <a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>, <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>);</div>
<div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;      }</div>
<div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160; </div>
<div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;      <span class="comment">// Write values in the vector</span></div>
<div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a> = 0; <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a> &lt; DIM; <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;      {</div>
<div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;        <span class="comment">// Output the i-th velocity component at these local coordinates</span></div>
<div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;        data[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a> + (DIM + 1)] = this-&gt;<a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#ab05a01e85edefd811e44fe480a675ebb">interpolated_u_nst</a>(s, <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>);</div>
<div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;      }</div>
<div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160; </div>
<div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;      <span class="comment">// Output the pressure field value at these local coordinates</span></div>
<div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;      data[2 * DIM + 1] = this-&gt;<a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a5591b7cb6a6560aec9f7cc058798c63c">interpolated_p_nst</a>(s);</div>
<div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;    } <span class="comment">// End of point_output_data</span></div>
<div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;  };</div>
<div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;<span class="comment">  //////////////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;<span class="comment">  //////////////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;<span class="comment">  //////////////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;  <span class="comment">//=======================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;<span class="comment">  /// Taylor-Hood elements are Navier-Stokes elements with quadratic</span></div>
<div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;<span class="comment">  /// interpolation for velocities and positions and continuous linear</span></div>
<div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;<span class="comment">  /// pressure interpolation. They can be used within oomph-lib&#39;s</span></div>
<div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;<span class="comment">  /// block-preconditioning framework.</span></div>
<div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;<span class="comment"></span>  <span class="comment">//=======================================================================</span></div>
<div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;  <span class="keyword">template</span>&lt;<span class="keywordtype">unsigned</span> DIM&gt;</div>
<div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;  <span class="keyword">class </span>QTaylorHoodSpaceTimeElement</div>
<div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;    : <span class="keyword">public</span> <span class="keyword">virtual</span> QElement&lt;DIM + 1, 3&gt;,</div>
<div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;      <span class="keyword">public</span> <span class="keyword">virtual</span> SpaceTimeNavierStokesEquations&lt;DIM&gt;</div>
<div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;  {</div>
<div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;  <span class="keyword">private</span>:<span class="comment"></span></div>
<div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;<span class="comment">    /// Static array of ints to hold number of variables at node</span></div>
<div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;<span class="comment"></span>    <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <a class="code" href="classoomph_1_1QTaylorHoodSpaceTimeElement.html#a3cf7240121c6a5ec082837b605cb40f2">Initial_Nvalue</a>[];</div>
<div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160; </div>
<div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;  <span class="keyword">protected</span>:<span class="comment"></span></div>
<div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;<span class="comment">    /// \short Static array of ints to hold conversion from pressure</span></div>
<div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;<span class="comment">    /// node numbers to actual node numbers</span></div>
<div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;<span class="comment"></span>    <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <a class="code" href="classoomph_1_1QTaylorHoodSpaceTimeElement.html#a5eaf421b85f9ca1797bfc2532270cac9">Pconv</a>[];</div>
<div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;<span class="comment">    /// \short Velocity shape and test functions and their derivs</span></div>
<div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;<span class="comment">    /// w.r.t. to global coords  at local coordinate s (taken from geometry)</span></div>
<div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;<span class="comment">    /// Return Jacobian of mapping between local and global coordinates.</span></div>
<div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;<span class="comment"></span>    <span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1QTaylorHoodSpaceTimeElement.html#afb98e9674244dcabd34fcedfca0240d5">dshape_and_dtest_eulerian_nst</a>(<span class="keyword">const</span> Vector&lt;double&gt;&amp; <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,</div>
<div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;                                                Shape&amp; psi,</div>
<div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;                                                DShape&amp; dpsidx,</div>
<div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;                                                Shape&amp; test,</div>
<div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;                                                DShape&amp; dtestdx) <span class="keyword">const</span>;</div>
<div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160; </div>
<div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;<span class="comment">    /// \short Velocity shape and test functions and their derivs</span></div>
<div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;<span class="comment">    /// w.r.t. to global coords  at local coordinate s (taken from geometry)</span></div>
<div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;<span class="comment">    /// Return Jacobian of mapping between local and global coordinates.</span></div>
<div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;<span class="comment"></span>    <span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1QTaylorHoodSpaceTimeElement.html#ace7b8ad451c792bf1fe51a19698f10de">dshape_and_dtest_eulerian_at_knot_nst</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; ipt,</div>
<div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;                                                        Shape&amp; psi,</div>
<div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;                                                        DShape&amp; dpsidx,</div>
<div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;                                                        Shape&amp; test,</div>
<div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;                                                        DShape&amp; dtestdx) <span class="keyword">const</span>;</div>
<div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160; </div>
<div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;<span class="comment">    /// \short Shape/test functions and derivs w.r.t. to global coords at</span></div>
<div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;<span class="comment">    /// integration point ipt; return Jacobian of mapping (J). Also compute</span></div>
<div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;<span class="comment">    /// derivatives of dpsidx, dtestdx and J w.r.t. nodal coordinates.</span></div>
<div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;<span class="comment"></span>    <span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1QTaylorHoodSpaceTimeElement.html#ace7b8ad451c792bf1fe51a19698f10de">dshape_and_dtest_eulerian_at_knot_nst</a>(</div>
<div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; ipt,</div>
<div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;      Shape&amp; psi,</div>
<div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;      DShape&amp; dpsidx,</div>
<div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;      RankFourTensor&lt;double&gt;&amp; d_dpsidx_dX,</div>
<div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;      Shape&amp; test,</div>
<div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;      DShape&amp; dtestdx,</div>
<div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;      RankFourTensor&lt;double&gt;&amp; d_dtestdx_dX,</div>
<div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;      DenseMatrix&lt;double&gt;&amp; djacobian_dX) <span class="keyword">const</span>;</div>
<div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160; </div>
<div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;<span class="comment">    /// \short Pressure shape and test functions and their derivs</span></div>
<div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;<span class="comment">    /// w.r.t. to global coords  at local coordinate s (taken from geometry).</span></div>
<div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;<span class="comment">    /// Return Jacobian of mapping between local and global coordinates.</span></div>
<div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;<span class="comment"></span>    <span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1QTaylorHoodSpaceTimeElement.html#ac0fe4b7db0e92afb713bf2398d3ea884">dpshape_and_dptest_eulerian_nst</a>(<span class="keyword">const</span> Vector&lt;double&gt;&amp; <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,</div>
<div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;                                                  Shape&amp; ppsi,</div>
<div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;                                                  DShape&amp; dppsidx,</div>
<div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;                                                  Shape&amp; ptest,</div>
<div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;                                                  DShape&amp; dptestdx) <span class="keyword">const</span>;</div>
<div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160; </div>
<div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;  <span class="keyword">public</span>:<span class="comment"></span></div>
<div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;<span class="comment">    /// Constructor, no internal data points</span></div>
<div class="line"><a name="l02154"></a><span class="lineno"><a class="line" href="classoomph_1_1QTaylorHoodSpaceTimeElement.html#a1a897a60bec577fa25c27d6e152eccfe"> 2154</a></span>&#160;<span class="comment"></span>    <a class="code" href="classoomph_1_1QTaylorHoodSpaceTimeElement.html#a1a897a60bec577fa25c27d6e152eccfe">QTaylorHoodSpaceTimeElement</a>()</div>
<div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;      : <a class="code" href="classoomph_1_1QElement.html">QElement</a>&lt;DIM + 1, 3&gt;(), <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html">SpaceTimeNavierStokesEquations</a>&lt;DIM&gt;()</div>
<div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;    {</div>
<div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;    }</div>
<div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;<span class="comment">    /// \short Number of values (pinned or dofs) required at node n. Can</span></div>
<div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;<span class="comment">    /// be overwritten for hanging node version</span></div>
<div class="line"><a name="l02161"></a><span class="lineno"><a class="line" href="classoomph_1_1QTaylorHoodSpaceTimeElement.html#a7ca4887e4e194347f9283bf3a6bc1c30"> 2161</a></span>&#160;<span class="comment"></span>    <span class="keyword">inline</span> <span class="keyword">virtual</span> <span class="keywordtype">unsigned</span> <a class="code" href="classoomph_1_1QTaylorHoodSpaceTimeElement.html#a7ca4887e4e194347f9283bf3a6bc1c30">required_nvalue</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; <a class="code" href="the__data__structure_8txt.html#af88b2d950fae19ab641bd1690e08445c">n</a>)<span class="keyword"> const</span></div>
<div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;<span class="keyword">    </span>{</div>
<div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;      <span class="comment">// Return the appropriate entry from Initial_Nvalue</span></div>
<div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classoomph_1_1QTaylorHoodSpaceTimeElement.html#a3cf7240121c6a5ec082837b605cb40f2">Initial_Nvalue</a>[<a class="code" href="the__data__structure_8txt.html#af88b2d950fae19ab641bd1690e08445c">n</a>];</div>
<div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;    } <span class="comment">// End of required_nvalue</span></div>
<div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160; </div>
<div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;<span class="comment">    /// Pressure shape functions at local coordinate s</span></div>
<div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;<span class="comment"></span>    <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1QTaylorHoodSpaceTimeElement.html#a48213eb3a18f3f0db23a45635e6d67d0">pshape_nst</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>, <a class="code" href="classoomph_1_1Shape.html">Shape</a>&amp; psi) <span class="keyword">const</span>;</div>
<div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160; </div>
<div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;<span class="comment">    /// Pressure shape and test functions at local coordinte s</span></div>
<div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;<span class="comment"></span>    <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1QTaylorHoodSpaceTimeElement.html#a48213eb3a18f3f0db23a45635e6d67d0">pshape_nst</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,</div>
<div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;                           <a class="code" href="classoomph_1_1Shape.html">Shape</a>&amp; psi,</div>
<div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;                           <a class="code" href="classoomph_1_1Shape.html">Shape</a>&amp; test) <span class="keyword">const</span>;</div>
<div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160; </div>
<div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;<span class="comment">    /// \short Set the value at which the pressure is stored in the nodes</span></div>
<div class="line"><a name="l02179"></a><span class="lineno"><a class="line" href="classoomph_1_1QTaylorHoodSpaceTimeElement.html#a140cfd3ddcbdc3a1fd704a1bbea083cf"> 2179</a></span>&#160;<span class="comment"></span>    <span class="keyword">virtual</span> <span class="keywordtype">int</span> <a class="code" href="classoomph_1_1QTaylorHoodSpaceTimeElement.html#a140cfd3ddcbdc3a1fd704a1bbea083cf">p_nodal_index_nst</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;<span class="keyword">    </span>{</div>
<div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;      <span class="comment">// The pressure is stored straight after the velocity components</span></div>
<div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(DIM);</div>
<div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;    } <span class="comment">// End of p_nodal_index_nst</span></div>
<div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160; </div>
<div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;<span class="comment">    /// Return the local equation numbers for the pressure values.</span></div>
<div class="line"><a name="l02187"></a><span class="lineno"><a class="line" href="classoomph_1_1QTaylorHoodSpaceTimeElement.html#a83f431d9c59396253ff1c58175cc1f68"> 2187</a></span>&#160;<span class="comment"></span>    <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="classoomph_1_1QTaylorHoodSpaceTimeElement.html#a83f431d9c59396253ff1c58175cc1f68">p_local_eqn</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; <a class="code" href="the__data__structure_8txt.html#af88b2d950fae19ab641bd1690e08445c">n</a>)<span class="keyword"> const</span></div>
<div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;<span class="keyword">    </span>{</div>
<div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;      <span class="comment">// Get the local equation number associated with the n-th pressure dof</span></div>
<div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;      <span class="keywordflow">return</span> this-&gt;<a class="code" href="classoomph_1_1FiniteElement.html#a5da80bbed97543e586f698251d67941d">nodal_local_eqn</a>(Pconv[<a class="code" href="the__data__structure_8txt.html#af88b2d950fae19ab641bd1690e08445c">n</a>], <a class="code" href="classoomph_1_1QTaylorHoodSpaceTimeElement.html#a140cfd3ddcbdc3a1fd704a1bbea083cf">p_nodal_index_nst</a>());</div>
<div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;    } <span class="comment">// End of p_local_eqn</span></div>
<div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160; </div>
<div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;<span class="comment">    /// \short Access function for the pressure values at local pressure</span></div>
<div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;<span class="comment">    /// node n_p (const version)</span></div>
<div class="line"><a name="l02196"></a><span class="lineno"><a class="line" href="classoomph_1_1QTaylorHoodSpaceTimeElement.html#a96d9c9568f643e4023f8d8828db834da"> 2196</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1QTaylorHoodSpaceTimeElement.html#a96d9c9568f643e4023f8d8828db834da">p_nst</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; n_p)<span class="keyword"> const</span></div>
<div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;<span class="keyword">    </span>{</div>
<div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;      <span class="comment">// Get the nodal value associated with the n_p-th pressure dof</span></div>
<div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;      <span class="keywordflow">return</span> this-&gt;<a class="code" href="classoomph_1_1FiniteElement.html#a28fd5c2d4aeba5ef65bee0e0d72569f5">nodal_value</a>(Pconv[n_p], this-&gt;<a class="code" href="classoomph_1_1QTaylorHoodSpaceTimeElement.html#a140cfd3ddcbdc3a1fd704a1bbea083cf">p_nodal_index_nst</a>());</div>
<div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;    } <span class="comment">// End of p_nst</span></div>
<div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160; </div>
<div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;<span class="comment">    /// \short Access function for the pressure values at local pressure</span></div>
<div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;<span class="comment">    /// node n_p (const version)</span></div>
<div class="line"><a name="l02205"></a><span class="lineno"><a class="line" href="classoomph_1_1QTaylorHoodSpaceTimeElement.html#a35b0de550910ef4f3730ecb3e7c919e5"> 2205</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1QTaylorHoodSpaceTimeElement.html#a35b0de550910ef4f3730ecb3e7c919e5">p_nst</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; <a class="code" href="cfortran_8h.html#af6f0bd3dc13317f895c91323c25c2b8f">t</a>, <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; n_p)<span class="keyword"> const</span></div>
<div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;<span class="keyword">    </span>{</div>
<div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;      <span class="comment">// Return the pressure value of the n_p-th pressure dof at time-level t</span></div>
<div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;      <span class="keywordflow">return</span> this-&gt;<a class="code" href="classoomph_1_1FiniteElement.html#a28fd5c2d4aeba5ef65bee0e0d72569f5">nodal_value</a>(t, <a class="code" href="classoomph_1_1QTaylorHoodSpaceTimeElement.html#a5eaf421b85f9ca1797bfc2532270cac9">Pconv</a>[n_p], this-&gt;<a class="code" href="classoomph_1_1QTaylorHoodSpaceTimeElement.html#a140cfd3ddcbdc3a1fd704a1bbea083cf">p_nodal_index_nst</a>());</div>
<div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;    } <span class="comment">// End of p_nst</span></div>
<div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160; </div>
<div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;<span class="comment">    /// Return number of pressure values</span></div>
<div class="line"><a name="l02213"></a><span class="lineno"><a class="line" href="classoomph_1_1QTaylorHoodSpaceTimeElement.html#af96b330b72d73e7143509ac05b4b358c"> 2213</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">unsigned</span> <a class="code" href="classoomph_1_1QTaylorHoodSpaceTimeElement.html#af96b330b72d73e7143509ac05b4b358c">npres_nst</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;<span class="keyword">    </span>{</div>
<div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;      <span class="comment">// There are 2^{DIM+1} pressure dofs where DIM is the spatial dimension</span></div>
<div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;      <span class="comment">// (rememebering that these are space-time elements)</span></div>
<div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">static_cast&lt;</span><span class="keywordtype">unsigned</span><span class="keyword">&gt;</span>(pow(2.0, <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(DIM + 1)));</div>
<div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;    } <span class="comment">// End of npres_nst</span></div>
<div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160; </div>
<div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;<span class="comment">    /// Pin p_dof-th pressure dof and set it to value specified by p_value.</span></div>
<div class="line"><a name="l02222"></a><span class="lineno"><a class="line" href="classoomph_1_1QTaylorHoodSpaceTimeElement.html#a5dcdb54f45adb01918aec993d8e22e38"> 2222</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1QTaylorHoodSpaceTimeElement.html#a5dcdb54f45adb01918aec993d8e22e38">fix_pressure</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; p_dof, <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; p_value)</div>
<div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;    {</div>
<div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;      <span class="comment">// Pin the pressure dof</span></div>
<div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;      this-&gt;<a class="code" href="classoomph_1_1FiniteElement.html#a28ae3eb7760edc5c9d6427611d8e6fb6">node_pt</a>(Pconv[p_dof])-&gt;<a class="code" href="classoomph_1_1Data.html#a422231c58e423f0b43822827aa334d79">pin</a>(this-&gt;<a class="code" href="classoomph_1_1QTaylorHoodSpaceTimeElement.html#a140cfd3ddcbdc3a1fd704a1bbea083cf">p_nodal_index_nst</a>());</div>
<div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160; </div>
<div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;      <span class="comment">// Now set its value</span></div>
<div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;      this-&gt;<a class="code" href="classoomph_1_1FiniteElement.html#a28ae3eb7760edc5c9d6427611d8e6fb6">node_pt</a>(Pconv[p_dof])</div>
<div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;        -&gt;<a class="code" href="classoomph_1_1Data.html#a7289ca322725c6fd493970a19474b382">set_value</a>(this-&gt;<a class="code" href="classoomph_1_1QTaylorHoodSpaceTimeElement.html#a140cfd3ddcbdc3a1fd704a1bbea083cf">p_nodal_index_nst</a>(), p_value);</div>
<div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;    } <span class="comment">// End of fix_pressure</span></div>
<div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160; </div>
<div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160;<span class="comment">    /// \short Build FaceElements that apply the Robin boundary condition</span></div>
<div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;<span class="comment">    /// to the pressure advection diffusion problem required by</span></div>
<div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;<span class="comment">    /// Fp preconditioner</span></div>
<div class="line"><a name="l02236"></a><span class="lineno"><a class="line" href="classoomph_1_1QTaylorHoodSpaceTimeElement.html#a99f1990f0b91016e1c578b3f2d19f5d5"> 2236</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1QTaylorHoodSpaceTimeElement.html#a99f1990f0b91016e1c578b3f2d19f5d5">build_fp_press_adv_diff_robin_bc_element</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; face_index)</div>
<div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;    {</div>
<div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;      <span class="comment">// Create a new Robic BC element and add it to the storage</span></div>
<div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;      this-&gt;<a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a6d88396b9bb8a88f24f9df1d17e75d0e">Pressure_advection_diffusion_robin_element_pt</a>.push_back(</div>
<div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;        <span class="keyword">new</span> <a class="code" href="classoomph_1_1FpPressureAdvDiffRobinBCSpaceTimeElement.html">FpPressureAdvDiffRobinBCSpaceTimeElement</a>&lt;</div>
<div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;          <a class="code" href="classoomph_1_1QTaylorHoodSpaceTimeElement.html">QTaylorHoodSpaceTimeElement&lt;DIM&gt;</a>&gt;(<span class="keyword">this</span>, face_index));</div>
<div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;    } <span class="comment">// End of build_fp_press_adv_diff_robin_bc_element</span></div>
<div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160; </div>
<div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;<span class="comment">    /// \short Add to the set \c paired_load_data pairs containing</span></div>
<div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;<span class="comment">    /// - the pointer to a Data object</span></div>
<div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;<span class="comment">    /// and</span></div>
<div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;<span class="comment">    /// - the index of the value in that Data object</span></div>
<div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;<span class="comment">    /// .</span></div>
<div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;<span class="comment">    /// for all values (pressures, velocities) that affect the</span></div>
<div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;<span class="comment">    /// load computed in the \c get_load(...) function.</span></div>
<div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1QTaylorHoodSpaceTimeElement.html#aa2bdb098066efbfa2347d437c79e5864">identify_load_data</a>(</div>
<div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;      std::set&lt;std::pair&lt;Data*, unsigned&gt;&gt;&amp; paired_load_data);</div>
<div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160; </div>
<div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;<span class="comment">    /// \short Add to the set \c paired_pressure_data pairs</span></div>
<div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;<span class="comment">    /// containing</span></div>
<div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;<span class="comment">    /// - the pointer to a Data object</span></div>
<div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;<span class="comment">    /// and</span></div>
<div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;<span class="comment">    /// - the index of the value in that Data object</span></div>
<div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160;<span class="comment">    /// .</span></div>
<div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160;<span class="comment">    /// for all pressure values that affect the</span></div>
<div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160;<span class="comment">    /// load computed in the \c get_load(...) function.</span></div>
<div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1QTaylorHoodSpaceTimeElement.html#ab3431e43e59e435a5bd9d4c892657574">identify_pressure_data</a>(</div>
<div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160;      std::set&lt;std::pair&lt;Data*, unsigned&gt;&gt;&amp; paired_pressure_data);</div>
<div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160; </div>
<div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160;<span class="comment">    /// Redirect output to NavierStokesEquations output</span></div>
<div class="line"><a name="l02269"></a><span class="lineno"><a class="line" href="classoomph_1_1QTaylorHoodSpaceTimeElement.html#a0fa5f52017a6577ef0b50f280ec044d4"> 2269</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1QTaylorHoodSpaceTimeElement.html#a0fa5f52017a6577ef0b50f280ec044d4">output</a>(std::ostream&amp; outfile)</div>
<div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160;    {</div>
<div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;      <span class="comment">// Call the base class implementation</span></div>
<div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;      <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a8ad8ed69a1ff73a486d37e2aa5fdb0ad">SpaceTimeNavierStokesEquations&lt;DIM&gt;::output</a>(outfile);</div>
<div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;    } <span class="comment">// End of output</span></div>
<div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160; </div>
<div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160;<span class="comment">    /// Redirect output to NavierStokesEquations output</span></div>
<div class="line"><a name="l02277"></a><span class="lineno"><a class="line" href="classoomph_1_1QTaylorHoodSpaceTimeElement.html#a734f37204be71a51958da81ecfab0b44"> 2277</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1QTaylorHoodSpaceTimeElement.html#a734f37204be71a51958da81ecfab0b44">output</a>(std::ostream&amp; outfile, <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; nplot)</div>
<div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160;    {</div>
<div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;      <span class="comment">// Call the base class implementation</span></div>
<div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;      <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a8ad8ed69a1ff73a486d37e2aa5fdb0ad">SpaceTimeNavierStokesEquations&lt;DIM&gt;::output</a>(outfile, nplot);</div>
<div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160;    } <span class="comment">// End of output</span></div>
<div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160; </div>
<div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160;<span class="comment">    /// Redirect output to NavierStokesEquations output</span></div>
<div class="line"><a name="l02285"></a><span class="lineno"><a class="line" href="classoomph_1_1QTaylorHoodSpaceTimeElement.html#aeff0bcaa4ac992aa8a8ade46461027e9"> 2285</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1QTaylorHoodSpaceTimeElement.html#aeff0bcaa4ac992aa8a8ade46461027e9">output</a>(FILE* file_pt)</div>
<div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160;    {</div>
<div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160;      <span class="comment">// Call the base class implementation</span></div>
<div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160;      <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a8ad8ed69a1ff73a486d37e2aa5fdb0ad">SpaceTimeNavierStokesEquations&lt;DIM&gt;::output</a>(file_pt);</div>
<div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;    } <span class="comment">// End of output</span></div>
<div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160; </div>
<div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160;<span class="comment">    /// Redirect output to NavierStokesEquations output</span></div>
<div class="line"><a name="l02293"></a><span class="lineno"><a class="line" href="classoomph_1_1QTaylorHoodSpaceTimeElement.html#a17d0d5d02bfbaa5f7fbd37023909be0d"> 2293</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1QTaylorHoodSpaceTimeElement.html#a17d0d5d02bfbaa5f7fbd37023909be0d">output</a>(FILE* file_pt, <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; nplot)</div>
<div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;    {</div>
<div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160;      <span class="comment">// Call the base class implementation</span></div>
<div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160;      <a class="code" href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a8ad8ed69a1ff73a486d37e2aa5fdb0ad">SpaceTimeNavierStokesEquations&lt;DIM&gt;::output</a>(file_pt, nplot);</div>
<div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;    } <span class="comment">// End of output</span></div>
<div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160; </div>
<div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;    <span class="comment">/*</span><span class="comment"></span></div>
<div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;<span class="comment">    /// \short Returns the number of &quot;DOF types&quot; that degrees of freedom</span></div>
<div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160;<span class="comment">    /// in this element are sub-divided into: Velocity and pressure.</span></div>
<div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;<span class="comment"></span>    unsigned ndof_types() const</div>
<div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;    {</div>
<div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;     // There are DIM velocity components and 1 pressure component</div>
<div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160;     return DIM+1;</div>
<div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;    } // End of ndof_types</div>
<div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160; </div>
<div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160;<span class="comment">    /// \short Create a list of pairs for all unknowns in this element,</span></div>
<div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160;<span class="comment">    /// so that the first entry in each pair contains the global equation</span></div>
<div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160;<span class="comment">    /// number of the unknown, while the second one contains the number</span></div>
<div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160;<span class="comment">    /// of the &quot;DOF type&quot; that this unknown is associated with.</span></div>
<div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160;<span class="comment">    /// (Function can obviously only be called if the equation numbering</span></div>
<div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160;<span class="comment">    /// scheme has been set up.) Velocity=0; Pressure=1</span></div>
<div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160;<span class="comment"></span>    void get_dof_numbers_for_unknowns(std::list&lt;std::pair&lt;unsigned long,</div>
<div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160;              unsigned&gt; &gt;&amp; dof_lookup_list) const;</div>
<div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160;    */</div>
<div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160;  };</div>
<div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160; </div>
<div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160;  <span class="comment">// Inline functions:</span></div>
<div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160; </div>
<div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160;  <span class="comment">//==========================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160;<span class="comment">  /// Derivatives of the shape functions and test functions w.r.t to</span></div>
<div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160;<span class="comment">  /// global (Eulerian) coordinates. Return Jacobian of mapping between</span></div>
<div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;<span class="comment">  /// local and global coordinates.</span></div>
<div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;<span class="comment"></span>  <span class="comment">//==========================================================================</span></div>
<div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160;  <span class="keyword">template</span>&lt;<span class="keywordtype">unsigned</span> DIM&gt;</div>
<div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160;  <span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1QTaylorHoodSpaceTimeElement.html#afb98e9674244dcabd34fcedfca0240d5">QTaylorHoodSpaceTimeElement&lt;DIM&gt;::dshape_and_dtest_eulerian_nst</a>(</div>
<div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160;    <span class="keyword">const</span> Vector&lt;double&gt;&amp; <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,</div>
<div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;    Shape&amp; psi,</div>
<div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160;    DShape&amp; dpsidx,</div>
<div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160;    Shape&amp; test,</div>
<div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160;    DShape&amp; dtestdx)<span class="keyword"> const</span></div>
<div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160;    <span class="comment">// Call the geometrical shape functions and derivatives</span></div>
<div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160;    <span class="keywordtype">double</span> J = this-&gt;dshape_eulerian(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>, psi, dpsidx);</div>
<div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160; </div>
<div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;    <span class="comment">// The test functions are equal to the shape functions</span></div>
<div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160;    test = psi;</div>
<div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160; </div>
<div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160;    <span class="comment">// The test function derivatives are equal to the shape function derivatives</span></div>
<div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160;    dtestdx = dpsidx;</div>
<div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160; </div>
<div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160;    <span class="comment">// Return the Jacobian</span></div>
<div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160;    <span class="keywordflow">return</span> J;</div>
<div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160;  } <span class="comment">// End of dshape_and_dtest_eulerian_nst</span></div>
<div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160; </div>
<div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160;  <span class="comment">//==========================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160;<span class="comment">  /// Derivatives of the shape functions and test functions w.r.t to</span></div>
<div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160;<span class="comment">  /// global (Eulerian) coordinates. Return Jacobian of mapping between</span></div>
<div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160;<span class="comment">  /// local and global coordinates.</span></div>
<div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160;<span class="comment"></span>  <span class="comment">//==========================================================================</span></div>
<div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160;  <span class="keyword">template</span>&lt;<span class="keywordtype">unsigned</span> DIM&gt;</div>
<div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160;  <span class="keyword">inline</span> <span class="keywordtype">double</span> QTaylorHoodSpaceTimeElement&lt;</div>
<div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160;    DIM&gt;::dshape_and_dtest_eulerian_at_knot_nst(<span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; ipt,</div>
<div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;                                                Shape&amp; psi,</div>
<div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;                                                DShape&amp; dpsidx,</div>
<div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160;                                                Shape&amp; test,</div>
<div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160;                                                DShape&amp; dtestdx)<span class="keyword"> const</span></div>
<div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160;    <span class="comment">// Call the geometrical shape functions and derivatives</span></div>
<div class="line"><a name="l02362"></a><span class="lineno"> 2362</span>&#160;    <span class="keywordtype">double</span> J = this-&gt;dshape_eulerian_at_knot(ipt, psi, dpsidx);</div>
<div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160; </div>
<div class="line"><a name="l02364"></a><span class="lineno"> 2364</span>&#160;    <span class="comment">// The test functions are equal to the shape functions</span></div>
<div class="line"><a name="l02365"></a><span class="lineno"> 2365</span>&#160;    test = psi;</div>
<div class="line"><a name="l02366"></a><span class="lineno"> 2366</span>&#160; </div>
<div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160;    <span class="comment">// The test function derivatives are equal to the shape function derivatives</span></div>
<div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160;    dtestdx = dpsidx;</div>
<div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160; </div>
<div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160;    <span class="comment">// Return the Jacobian</span></div>
<div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160;    <span class="keywordflow">return</span> J;</div>
<div class="line"><a name="l02372"></a><span class="lineno"> 2372</span>&#160;  } <span class="comment">// End of dshape_and_dtest_eulerian_at_knot_nst</span></div>
<div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160; </div>
<div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160;  <span class="comment">//==========================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l02375"></a><span class="lineno"> 2375</span>&#160;<span class="comment">  /// 2D (in space): Pressure shape and test functions and derivs w.r.t. to</span></div>
<div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160;<span class="comment">  /// Eulerian coordinates. Return Jacobian of mapping between local and</span></div>
<div class="line"><a name="l02377"></a><span class="lineno"> 2377</span>&#160;<span class="comment">  /// global coordinates.</span></div>
<div class="line"><a name="l02378"></a><span class="lineno"> 2378</span>&#160;<span class="comment"></span>  <span class="comment">//==========================================================================</span></div>
<div class="line"><a name="l02379"></a><span class="lineno"> 2379</span>&#160;  <span class="keyword">template</span>&lt;&gt;</div>
<div class="line"><a name="l02380"></a><span class="lineno"><a class="line" href="classoomph_1_1QTaylorHoodSpaceTimeElement.html#a25594603f775ab0fe0d572342600ada3"> 2380</a></span>&#160;  <span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1QTaylorHoodSpaceTimeElement.html#ac0fe4b7db0e92afb713bf2398d3ea884">QTaylorHoodSpaceTimeElement&lt;2&gt;::dpshape_and_dptest_eulerian_nst</a>(</div>
<div class="line"><a name="l02381"></a><span class="lineno"> 2381</span>&#160;    <span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,</div>
<div class="line"><a name="l02382"></a><span class="lineno"> 2382</span>&#160;    <a class="code" href="classoomph_1_1Shape.html">Shape</a>&amp; ppsi,</div>
<div class="line"><a name="l02383"></a><span class="lineno"> 2383</span>&#160;    <a class="code" href="classoomph_1_1DShape.html">DShape</a>&amp; dppsidx,</div>
<div class="line"><a name="l02384"></a><span class="lineno"> 2384</span>&#160;    <a class="code" href="classoomph_1_1Shape.html">Shape</a>&amp; ptest,</div>
<div class="line"><a name="l02385"></a><span class="lineno"> 2385</span>&#160;    <a class="code" href="classoomph_1_1DShape.html">DShape</a>&amp; dptestdx)<span class="keyword"> const</span></div>
<div class="line"><a name="l02386"></a><span class="lineno"> 2386</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l02387"></a><span class="lineno"> 2387</span>&#160;    <span class="comment">// Local storage for the shape function (x-direction)</span></div>
<div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160;    <span class="keywordtype">double</span> psi1[2];</div>
<div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160; </div>
<div class="line"><a name="l02390"></a><span class="lineno"> 2390</span>&#160;    <span class="comment">// Local storage for the shape function (y-direction)</span></div>
<div class="line"><a name="l02391"></a><span class="lineno"> 2391</span>&#160;    <span class="keywordtype">double</span> psi2[2];</div>
<div class="line"><a name="l02392"></a><span class="lineno"> 2392</span>&#160; </div>
<div class="line"><a name="l02393"></a><span class="lineno"> 2393</span>&#160;    <span class="comment">// Local storage for the shape function (z-direction)</span></div>
<div class="line"><a name="l02394"></a><span class="lineno"> 2394</span>&#160;    <span class="keywordtype">double</span> psi3[2];</div>
<div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160; </div>
<div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160;    <span class="comment">// Local storage for the shape function derivatives (x-direction)</span></div>
<div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160;    <span class="keywordtype">double</span> dpsi1[2];</div>
<div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160; </div>
<div class="line"><a name="l02399"></a><span class="lineno"> 2399</span>&#160;    <span class="comment">// Local storage for the test function derivatives (y-direction)</span></div>
<div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160;    <span class="keywordtype">double</span> dpsi2[2];</div>
<div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160; </div>
<div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160;    <span class="comment">// Local storage for the test function derivatives (z-direction)</span></div>
<div class="line"><a name="l02403"></a><span class="lineno"> 2403</span>&#160;    <span class="keywordtype">double</span> dpsi3[2];</div>
<div class="line"><a name="l02404"></a><span class="lineno"> 2404</span>&#160; </div>
<div class="line"><a name="l02405"></a><span class="lineno"> 2405</span>&#160;    <span class="comment">// Call the OneDimensional Shape functions</span></div>
<div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160;    <a class="code" href="namespaceoomph_1_1OneDimLagrange.html#aec7f5263cb672ddfef50bdd3462ada19">OneDimLagrange::shape&lt;2&gt;</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0], psi1);</div>
<div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160; </div>
<div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160;    <span class="comment">// Call the OneDimensional Shape functions</span></div>
<div class="line"><a name="l02409"></a><span class="lineno"> 2409</span>&#160;    <a class="code" href="namespaceoomph_1_1OneDimLagrange.html#aec7f5263cb672ddfef50bdd3462ada19">OneDimLagrange::shape&lt;2&gt;</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1], psi2);</div>
<div class="line"><a name="l02410"></a><span class="lineno"> 2410</span>&#160; </div>
<div class="line"><a name="l02411"></a><span class="lineno"> 2411</span>&#160;    <span class="comment">// Call the OneDimensional Shape functions</span></div>
<div class="line"><a name="l02412"></a><span class="lineno"> 2412</span>&#160;    <a class="code" href="namespaceoomph_1_1OneDimLagrange.html#aec7f5263cb672ddfef50bdd3462ada19">OneDimLagrange::shape&lt;2&gt;</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[2], psi3);</div>
<div class="line"><a name="l02413"></a><span class="lineno"> 2413</span>&#160; </div>
<div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160;    <span class="comment">// Call the OneDimensional Shape functions</span></div>
<div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160;    <a class="code" href="namespaceoomph_1_1OneDimLagrange.html#a956411abc42594a039c368e4ef69f48e">OneDimLagrange::dshape&lt;2&gt;</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0], dpsi1);</div>
<div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160; </div>
<div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160;    <span class="comment">// Call the OneDimensional Shape functions</span></div>
<div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160;    <a class="code" href="namespaceoomph_1_1OneDimLagrange.html#a956411abc42594a039c368e4ef69f48e">OneDimLagrange::dshape&lt;2&gt;</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1], dpsi2);</div>
<div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160; </div>
<div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160;    <span class="comment">// Call the OneDimensional Shape functions</span></div>
<div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160;    <a class="code" href="namespaceoomph_1_1OneDimLagrange.html#a956411abc42594a039c368e4ef69f48e">OneDimLagrange::dshape&lt;2&gt;</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[2], dpsi3);</div>
<div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160; </div>
<div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160;    <span class="comment">//--------------------------------------------------------------------</span></div>
<div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160;    <span class="comment">// Now let&#39;s loop over the nodal points in the element with s1 being</span></div>
<div class="line"><a name="l02425"></a><span class="lineno"> 2425</span>&#160;    <span class="comment">// the &quot;x&quot; coordinate, s2 being the &quot;y&quot; coordinate and s3 being the</span></div>
<div class="line"><a name="l02426"></a><span class="lineno"> 2426</span>&#160;    <span class="comment">// &quot;z&quot; coordinate:</span></div>
<div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160;    <span class="comment">//--------------------------------------------------------------------</span></div>
<div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160;    <span class="comment">// Loop over the points in the z-direction</span></div>
<div class="line"><a name="l02429"></a><span class="lineno"> 2429</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a> = 0; <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a> &lt; 2; <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l02430"></a><span class="lineno"> 2430</span>&#160;    {</div>
<div class="line"><a name="l02431"></a><span class="lineno"> 2431</span>&#160;      <span class="comment">// Loop over the points in the y-direction</span></div>
<div class="line"><a name="l02432"></a><span class="lineno"> 2432</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j = 0; j &lt; 2; j++)</div>
<div class="line"><a name="l02433"></a><span class="lineno"> 2433</span>&#160;      {</div>
<div class="line"><a name="l02434"></a><span class="lineno"> 2434</span>&#160;        <span class="comment">// Loop over the points in the x-direction</span></div>
<div class="line"><a name="l02435"></a><span class="lineno"> 2435</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> k = 0; k &lt; 2; k++)</div>
<div class="line"><a name="l02436"></a><span class="lineno"> 2436</span>&#160;        {</div>
<div class="line"><a name="l02437"></a><span class="lineno"> 2437</span>&#160;          <span class="comment">// Multiply the three 1D functions together to get the 3D function</span></div>
<div class="line"><a name="l02438"></a><span class="lineno"> 2438</span>&#160;          ppsi[4 * <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a> + 2 * j + k] = psi3[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] * psi2[j] * psi1[k];</div>
<div class="line"><a name="l02439"></a><span class="lineno"> 2439</span>&#160; </div>
<div class="line"><a name="l02440"></a><span class="lineno"> 2440</span>&#160;          <span class="comment">// Multiply the appropriate shape and shape function derivatives</span></div>
<div class="line"><a name="l02441"></a><span class="lineno"> 2441</span>&#160;          <span class="comment">// together</span></div>
<div class="line"><a name="l02442"></a><span class="lineno"> 2442</span>&#160;          dppsidx(4 * <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a> + 2 * j + k, 0) = psi3[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] * psi2[j] * dpsi1[k];</div>
<div class="line"><a name="l02443"></a><span class="lineno"> 2443</span>&#160; </div>
<div class="line"><a name="l02444"></a><span class="lineno"> 2444</span>&#160;          <span class="comment">// Multiply the appropriate shape and shape function derivatives</span></div>
<div class="line"><a name="l02445"></a><span class="lineno"> 2445</span>&#160;          <span class="comment">// together</span></div>
<div class="line"><a name="l02446"></a><span class="lineno"> 2446</span>&#160;          dppsidx(4 * <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a> + 2 * j + k, 1) = psi3[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] * dpsi2[j] * psi1[k];</div>
<div class="line"><a name="l02447"></a><span class="lineno"> 2447</span>&#160; </div>
<div class="line"><a name="l02448"></a><span class="lineno"> 2448</span>&#160;          <span class="comment">// Multiply the appropriate shape and shape function derivatives</span></div>
<div class="line"><a name="l02449"></a><span class="lineno"> 2449</span>&#160;          <span class="comment">// together</span></div>
<div class="line"><a name="l02450"></a><span class="lineno"> 2450</span>&#160;          dppsidx(4 * <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a> + 2 * j + k, 2) = dpsi3[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] * psi2[j] * psi1[k];</div>
<div class="line"><a name="l02451"></a><span class="lineno"> 2451</span>&#160;        }</div>
<div class="line"><a name="l02452"></a><span class="lineno"> 2452</span>&#160;      } <span class="comment">// for (unsigned j=0;j&lt;2;j++)</span></div>
<div class="line"><a name="l02453"></a><span class="lineno"> 2453</span>&#160;    } <span class="comment">// for (unsigned i=0;i&lt;2;i++)</span></div>
<div class="line"><a name="l02454"></a><span class="lineno"> 2454</span>&#160; </div>
<div class="line"><a name="l02455"></a><span class="lineno"> 2455</span>&#160;    <span class="comment">// Allocate space for the shape functions</span></div>
<div class="line"><a name="l02456"></a><span class="lineno"> 2456</span>&#160;    <a class="code" href="classoomph_1_1Shape.html">Shape</a> psi(27);</div>
<div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160; </div>
<div class="line"><a name="l02458"></a><span class="lineno"> 2458</span>&#160;    <span class="comment">// Allocate space for the local shape function derivatives</span></div>
<div class="line"><a name="l02459"></a><span class="lineno"> 2459</span>&#160;    <a class="code" href="classoomph_1_1DShape.html">DShape</a> dpsi(27, 3);</div>
<div class="line"><a name="l02460"></a><span class="lineno"> 2460</span>&#160; </div>
<div class="line"><a name="l02461"></a><span class="lineno"> 2461</span>&#160;    <span class="comment">// Get the values of the shape functions and their local derivatives</span></div>
<div class="line"><a name="l02462"></a><span class="lineno"> 2462</span>&#160;    dshape_local(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>, psi, dpsi);</div>
<div class="line"><a name="l02463"></a><span class="lineno"> 2463</span>&#160; </div>
<div class="line"><a name="l02464"></a><span class="lineno"> 2464</span>&#160;    <span class="comment">// Allocate memory for the inverse 3x3 jacobian</span></div>
<div class="line"><a name="l02465"></a><span class="lineno"> 2465</span>&#160;    <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> inverse_jacobian(3);</div>
<div class="line"><a name="l02466"></a><span class="lineno"> 2466</span>&#160; </div>
<div class="line"><a name="l02467"></a><span class="lineno"> 2467</span>&#160;    <span class="comment">// Now calculate the inverse jacobian</span></div>
<div class="line"><a name="l02468"></a><span class="lineno"> 2468</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> det = local_to_eulerian_mapping(dpsi, inverse_jacobian);</div>
<div class="line"><a name="l02469"></a><span class="lineno"> 2469</span>&#160; </div>
<div class="line"><a name="l02470"></a><span class="lineno"> 2470</span>&#160;    <span class="comment">// Now set the values of the derivatives to be derivatives w.r.t. to</span></div>
<div class="line"><a name="l02471"></a><span class="lineno"> 2471</span>&#160;    <span class="comment">// the Eulerian coordinates</span></div>
<div class="line"><a name="l02472"></a><span class="lineno"> 2472</span>&#160;    transform_derivatives(inverse_jacobian, dppsidx);</div>
<div class="line"><a name="l02473"></a><span class="lineno"> 2473</span>&#160; </div>
<div class="line"><a name="l02474"></a><span class="lineno"> 2474</span>&#160;    <span class="comment">// The test functions are equal to the shape functions</span></div>
<div class="line"><a name="l02475"></a><span class="lineno"> 2475</span>&#160;    ptest = ppsi;</div>
<div class="line"><a name="l02476"></a><span class="lineno"> 2476</span>&#160; </div>
<div class="line"><a name="l02477"></a><span class="lineno"> 2477</span>&#160;    <span class="comment">// The test function derivatives are equal to the shape function derivatives</span></div>
<div class="line"><a name="l02478"></a><span class="lineno"> 2478</span>&#160;    dptestdx = dppsidx;</div>
<div class="line"><a name="l02479"></a><span class="lineno"> 2479</span>&#160; </div>
<div class="line"><a name="l02480"></a><span class="lineno"> 2480</span>&#160;    <span class="comment">// Return the determinant of the jacobian</span></div>
<div class="line"><a name="l02481"></a><span class="lineno"> 2481</span>&#160;    <span class="keywordflow">return</span> det;</div>
<div class="line"><a name="l02482"></a><span class="lineno"> 2482</span>&#160;  } <span class="comment">// End of dpshape_and_dptest_eulerian_nst</span></div>
<div class="line"><a name="l02483"></a><span class="lineno"> 2483</span>&#160; </div>
<div class="line"><a name="l02484"></a><span class="lineno"> 2484</span>&#160;  <span class="comment">//==========================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l02485"></a><span class="lineno"> 2485</span>&#160;<span class="comment">  /// 2D (in space):</span></div>
<div class="line"><a name="l02486"></a><span class="lineno"> 2486</span>&#160;<span class="comment">  /// Define the shape functions (psi) and test functions (test) and</span></div>
<div class="line"><a name="l02487"></a><span class="lineno"> 2487</span>&#160;<span class="comment">  /// their derivatives w.r.t. global coordinates (dpsidx and dtestdx)</span></div>
<div class="line"><a name="l02488"></a><span class="lineno"> 2488</span>&#160;<span class="comment">  /// and return Jacobian of mapping (J). Additionally compute the</span></div>
<div class="line"><a name="l02489"></a><span class="lineno"> 2489</span>&#160;<span class="comment">  /// derivatives of dpsidx, dtestdx and J w.r.t. nodal coordinates.</span></div>
<div class="line"><a name="l02490"></a><span class="lineno"> 2490</span>&#160;<span class="comment">  ///</span></div>
<div class="line"><a name="l02491"></a><span class="lineno"> 2491</span>&#160;<span class="comment">  /// Galerkin: Test functions = shape functions</span></div>
<div class="line"><a name="l02492"></a><span class="lineno"> 2492</span>&#160;<span class="comment"></span>  <span class="comment">//==========================================================================</span></div>
<div class="line"><a name="l02493"></a><span class="lineno"> 2493</span>&#160;  <span class="keyword">template</span>&lt;&gt;</div>
<div class="line"><a name="l02494"></a><span class="lineno"> 2494</span>&#160;  <span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1QTaylorHoodSpaceTimeElement.html">QTaylorHoodSpaceTimeElement&lt;2&gt;::</a></div>
<div class="line"><a name="l02495"></a><span class="lineno"><a class="line" href="classoomph_1_1QTaylorHoodSpaceTimeElement.html#af575810460d2a8d3a6eba1460636ece8"> 2495</a></span>&#160;<a class="code" href="classoomph_1_1QTaylorHoodSpaceTimeElement.html">    dshape_and_dtest_eulerian_at_knot_nst</a>(</div>
<div class="line"><a name="l02496"></a><span class="lineno"> 2496</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; ipt,</div>
<div class="line"><a name="l02497"></a><span class="lineno"> 2497</span>&#160;      <a class="code" href="classoomph_1_1Shape.html">Shape</a>&amp; psi,</div>
<div class="line"><a name="l02498"></a><span class="lineno"> 2498</span>&#160;      <a class="code" href="classoomph_1_1DShape.html">DShape</a>&amp; dpsidx,</div>
<div class="line"><a name="l02499"></a><span class="lineno"> 2499</span>&#160;      <a class="code" href="classoomph_1_1RankFourTensor.html">RankFourTensor&lt;double&gt;</a>&amp; d_dpsidx_dX,</div>
<div class="line"><a name="l02500"></a><span class="lineno"> 2500</span>&#160;      <a class="code" href="classoomph_1_1Shape.html">Shape</a>&amp; test,</div>
<div class="line"><a name="l02501"></a><span class="lineno"> 2501</span>&#160;      <a class="code" href="classoomph_1_1DShape.html">DShape</a>&amp; dtestdx,</div>
<div class="line"><a name="l02502"></a><span class="lineno"> 2502</span>&#160;      <a class="code" href="classoomph_1_1RankFourTensor.html">RankFourTensor&lt;double&gt;</a>&amp; d_dtestdx_dX,</div>
<div class="line"><a name="l02503"></a><span class="lineno"> 2503</span>&#160;      <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a>&amp; djacobian_dX)<span class="keyword"> const</span></div>
<div class="line"><a name="l02504"></a><span class="lineno"> 2504</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l02505"></a><span class="lineno"> 2505</span>&#160;    <span class="comment">// Call the geometrical shape functions and derivatives</span></div>
<div class="line"><a name="l02506"></a><span class="lineno"> 2506</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> J = this-&gt;dshape_eulerian_at_knot(</div>
<div class="line"><a name="l02507"></a><span class="lineno"> 2507</span>&#160;      ipt, psi, dpsidx, djacobian_dX, d_dpsidx_dX);</div>
<div class="line"><a name="l02508"></a><span class="lineno"> 2508</span>&#160; </div>
<div class="line"><a name="l02509"></a><span class="lineno"> 2509</span>&#160;    <span class="comment">// Loop over the test functions and derivatives</span></div>
<div class="line"><a name="l02510"></a><span class="lineno"> 2510</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a> = 0; <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a> &lt; 27; <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l02511"></a><span class="lineno"> 2511</span>&#160;    {</div>
<div class="line"><a name="l02512"></a><span class="lineno"> 2512</span>&#160;      <span class="comment">// The test functions are the same as the shape functions</span></div>
<div class="line"><a name="l02513"></a><span class="lineno"> 2513</span>&#160;      test[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] = psi[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>];</div>
<div class="line"><a name="l02514"></a><span class="lineno"> 2514</span>&#160; </div>
<div class="line"><a name="l02515"></a><span class="lineno"> 2515</span>&#160;      <span class="comment">// Loop over the spatial derivatives</span></div>
<div class="line"><a name="l02516"></a><span class="lineno"> 2516</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> k = 0; k &lt; 3; k++)</div>
<div class="line"><a name="l02517"></a><span class="lineno"> 2517</span>&#160;      {</div>
<div class="line"><a name="l02518"></a><span class="lineno"> 2518</span>&#160;        <span class="comment">// Set the test function derivatives to the shape function derivatives</span></div>
<div class="line"><a name="l02519"></a><span class="lineno"> 2519</span>&#160;        dtestdx(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>, k) = dpsidx(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>, k);</div>
<div class="line"><a name="l02520"></a><span class="lineno"> 2520</span>&#160; </div>
<div class="line"><a name="l02521"></a><span class="lineno"> 2521</span>&#160;        <span class="comment">// Loop over the dimensions</span></div>
<div class="line"><a name="l02522"></a><span class="lineno"> 2522</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> p = 0; p &lt; 3; p++)</div>
<div class="line"><a name="l02523"></a><span class="lineno"> 2523</span>&#160;        {</div>
<div class="line"><a name="l02524"></a><span class="lineno"> 2524</span>&#160;          <span class="comment">// Loop over test functions</span></div>
<div class="line"><a name="l02525"></a><span class="lineno"> 2525</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> q = 0; q &lt; 27; q++)</div>
<div class="line"><a name="l02526"></a><span class="lineno"> 2526</span>&#160;          {</div>
<div class="line"><a name="l02527"></a><span class="lineno"> 2527</span>&#160;            <span class="comment">// Set the test function derivatives to the shape function</span></div>
<div class="line"><a name="l02528"></a><span class="lineno"> 2528</span>&#160;            <span class="comment">// derivatives</span></div>
<div class="line"><a name="l02529"></a><span class="lineno"> 2529</span>&#160;            d_dtestdx_dX(p, q, <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>, k) = d_dpsidx_dX(p, q, <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>, k);</div>
<div class="line"><a name="l02530"></a><span class="lineno"> 2530</span>&#160;          }</div>
<div class="line"><a name="l02531"></a><span class="lineno"> 2531</span>&#160;        } <span class="comment">// for (unsigned p=0;p&lt;3;p++)</span></div>
<div class="line"><a name="l02532"></a><span class="lineno"> 2532</span>&#160;      } <span class="comment">// for (unsigned k=0;k&lt;3;k++)</span></div>
<div class="line"><a name="l02533"></a><span class="lineno"> 2533</span>&#160;    } <span class="comment">// for (unsigned i=0;i&lt;27;i++)</span></div>
<div class="line"><a name="l02534"></a><span class="lineno"> 2534</span>&#160; </div>
<div class="line"><a name="l02535"></a><span class="lineno"> 2535</span>&#160;    <span class="comment">// Return the jacobian</span></div>
<div class="line"><a name="l02536"></a><span class="lineno"> 2536</span>&#160;    <span class="keywordflow">return</span> J;</div>
<div class="line"><a name="l02537"></a><span class="lineno"> 2537</span>&#160;  } <span class="comment">// End of dshape_and_dtest_eulerian_at_knot_nst</span></div>
<div class="line"><a name="l02538"></a><span class="lineno"> 2538</span>&#160; </div>
<div class="line"><a name="l02539"></a><span class="lineno"> 2539</span>&#160;  <span class="comment">//==========================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l02540"></a><span class="lineno"> 2540</span>&#160;<span class="comment">  /// 2D (in space):</span></div>
<div class="line"><a name="l02541"></a><span class="lineno"> 2541</span>&#160;<span class="comment">  /// Pressure shape functions</span></div>
<div class="line"><a name="l02542"></a><span class="lineno"> 2542</span>&#160;<span class="comment"></span>  <span class="comment">//==========================================================================</span></div>
<div class="line"><a name="l02543"></a><span class="lineno"> 2543</span>&#160;  <span class="keyword">template</span>&lt;&gt;</div>
<div class="line"><a name="l02544"></a><span class="lineno"><a class="line" href="classoomph_1_1QTaylorHoodSpaceTimeElement.html#a0207839792d31eee1c72b5d387d3c405"> 2544</a></span>&#160;  <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1QTaylorHoodSpaceTimeElement.html">QTaylorHoodSpaceTimeElement&lt;2&gt;::pshape_nst</a>(</div>
<div class="line"><a name="l02545"></a><span class="lineno"> 2545</span>&#160;    <span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>, <a class="code" href="classoomph_1_1Shape.html">Shape</a>&amp; psi)<span class="keyword"> const</span></div>
<div class="line"><a name="l02546"></a><span class="lineno"> 2546</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l02547"></a><span class="lineno"> 2547</span>&#160;    <span class="comment">// Local storage for the shape function value (in the x-direction)</span></div>
<div class="line"><a name="l02548"></a><span class="lineno"> 2548</span>&#160;    <span class="keywordtype">double</span> psi1[2];</div>
<div class="line"><a name="l02549"></a><span class="lineno"> 2549</span>&#160; </div>
<div class="line"><a name="l02550"></a><span class="lineno"> 2550</span>&#160;    <span class="comment">// Local storage for the shape function value (in the y-direction)</span></div>
<div class="line"><a name="l02551"></a><span class="lineno"> 2551</span>&#160;    <span class="keywordtype">double</span> psi2[2];</div>
<div class="line"><a name="l02552"></a><span class="lineno"> 2552</span>&#160; </div>
<div class="line"><a name="l02553"></a><span class="lineno"> 2553</span>&#160;    <span class="comment">// Local storage for the shape function value (in the z-direction)</span></div>
<div class="line"><a name="l02554"></a><span class="lineno"> 2554</span>&#160;    <span class="keywordtype">double</span> psi3[2];</div>
<div class="line"><a name="l02555"></a><span class="lineno"> 2555</span>&#160; </div>
<div class="line"><a name="l02556"></a><span class="lineno"> 2556</span>&#160;    <span class="comment">// Call the OneDimensional Shape functions</span></div>
<div class="line"><a name="l02557"></a><span class="lineno"> 2557</span>&#160;    <a class="code" href="namespaceoomph_1_1OneDimLagrange.html#aec7f5263cb672ddfef50bdd3462ada19">OneDimLagrange::shape&lt;2&gt;</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0], psi1);</div>
<div class="line"><a name="l02558"></a><span class="lineno"> 2558</span>&#160; </div>
<div class="line"><a name="l02559"></a><span class="lineno"> 2559</span>&#160;    <span class="comment">// Call the OneDimensional Shape functions</span></div>
<div class="line"><a name="l02560"></a><span class="lineno"> 2560</span>&#160;    <a class="code" href="namespaceoomph_1_1OneDimLagrange.html#aec7f5263cb672ddfef50bdd3462ada19">OneDimLagrange::shape&lt;2&gt;</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1], psi2);</div>
<div class="line"><a name="l02561"></a><span class="lineno"> 2561</span>&#160; </div>
<div class="line"><a name="l02562"></a><span class="lineno"> 2562</span>&#160;    <span class="comment">// Call the OneDimensional Shape functions</span></div>
<div class="line"><a name="l02563"></a><span class="lineno"> 2563</span>&#160;    <a class="code" href="namespaceoomph_1_1OneDimLagrange.html#aec7f5263cb672ddfef50bdd3462ada19">OneDimLagrange::shape&lt;2&gt;</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[2], psi3);</div>
<div class="line"><a name="l02564"></a><span class="lineno"> 2564</span>&#160; </div>
<div class="line"><a name="l02565"></a><span class="lineno"> 2565</span>&#160;    <span class="comment">//--------------------------------------------------------------------</span></div>
<div class="line"><a name="l02566"></a><span class="lineno"> 2566</span>&#160;    <span class="comment">// Now let&#39;s loop over the nodal points in the element with s1 being</span></div>
<div class="line"><a name="l02567"></a><span class="lineno"> 2567</span>&#160;    <span class="comment">// the &quot;x&quot; coordinate, s2 being the &quot;y&quot; coordinate and s3 being the</span></div>
<div class="line"><a name="l02568"></a><span class="lineno"> 2568</span>&#160;    <span class="comment">// &quot;z&quot; coordinate:</span></div>
<div class="line"><a name="l02569"></a><span class="lineno"> 2569</span>&#160;    <span class="comment">//--------------------------------------------------------------------</span></div>
<div class="line"><a name="l02570"></a><span class="lineno"> 2570</span>&#160;    <span class="comment">// Loop over the points in the z-direction</span></div>
<div class="line"><a name="l02571"></a><span class="lineno"> 2571</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a> = 0; <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a> &lt; 2; <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l02572"></a><span class="lineno"> 2572</span>&#160;    {</div>
<div class="line"><a name="l02573"></a><span class="lineno"> 2573</span>&#160;      <span class="comment">// Loop over the points in the y-direction</span></div>
<div class="line"><a name="l02574"></a><span class="lineno"> 2574</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j = 0; j &lt; 2; j++)</div>
<div class="line"><a name="l02575"></a><span class="lineno"> 2575</span>&#160;      {</div>
<div class="line"><a name="l02576"></a><span class="lineno"> 2576</span>&#160;        <span class="comment">// Loop over the points in the x-direction</span></div>
<div class="line"><a name="l02577"></a><span class="lineno"> 2577</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> k = 0; k &lt; 2; k++)</div>
<div class="line"><a name="l02578"></a><span class="lineno"> 2578</span>&#160;        {</div>
<div class="line"><a name="l02579"></a><span class="lineno"> 2579</span>&#160;          <span class="comment">// Multiply the three 1D functions together to get the 3D function</span></div>
<div class="line"><a name="l02580"></a><span class="lineno"> 2580</span>&#160;          psi[4 * <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a> + 2 * j + k] = psi3[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] * psi2[j] * psi1[k];</div>
<div class="line"><a name="l02581"></a><span class="lineno"> 2581</span>&#160;        }</div>
<div class="line"><a name="l02582"></a><span class="lineno"> 2582</span>&#160;      } <span class="comment">// for (unsigned j=0;j&lt;2;j++)</span></div>
<div class="line"><a name="l02583"></a><span class="lineno"> 2583</span>&#160;    } <span class="comment">// for (unsigned i=0;i&lt;2;i++)</span></div>
<div class="line"><a name="l02584"></a><span class="lineno"> 2584</span>&#160;  } <span class="comment">// End of pshape_nst</span></div>
<div class="line"><a name="l02585"></a><span class="lineno"> 2585</span>&#160; </div>
<div class="line"><a name="l02586"></a><span class="lineno"> 2586</span>&#160; </div>
<div class="line"><a name="l02587"></a><span class="lineno"> 2587</span>&#160;  <span class="comment">//==========================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l02588"></a><span class="lineno"> 2588</span>&#160;<span class="comment">  /// Pressure shape and test functions</span></div>
<div class="line"><a name="l02589"></a><span class="lineno"> 2589</span>&#160;<span class="comment"></span>  <span class="comment">//==========================================================================</span></div>
<div class="line"><a name="l02590"></a><span class="lineno"> 2590</span>&#160;  <span class="keyword">template</span>&lt;<span class="keywordtype">unsigned</span> DIM&gt;</div>
<div class="line"><a name="l02591"></a><span class="lineno"> 2591</span>&#160;  <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1QTaylorHoodSpaceTimeElement.html">QTaylorHoodSpaceTimeElement&lt;DIM&gt;::pshape_nst</a>(</div>
<div class="line"><a name="l02592"></a><span class="lineno"> 2592</span>&#160;    <span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>, <a class="code" href="classoomph_1_1Shape.html">Shape</a>&amp; psi, <a class="code" href="classoomph_1_1Shape.html">Shape</a>&amp; test)<span class="keyword"> const</span></div>
<div class="line"><a name="l02593"></a><span class="lineno"> 2593</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l02594"></a><span class="lineno"> 2594</span>&#160;    <span class="comment">// Call the pressure shape functions</span></div>
<div class="line"><a name="l02595"></a><span class="lineno"> 2595</span>&#160;    this-&gt;pshape_nst(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>, psi);</div>
<div class="line"><a name="l02596"></a><span class="lineno"> 2596</span>&#160; </div>
<div class="line"><a name="l02597"></a><span class="lineno"> 2597</span>&#160;    <span class="comment">// Set the test functions equal to the shape functions</span></div>
<div class="line"><a name="l02598"></a><span class="lineno"> 2598</span>&#160;    test = psi;</div>
<div class="line"><a name="l02599"></a><span class="lineno"> 2599</span>&#160;  } <span class="comment">// End of pshape_nst</span></div>
<div class="line"><a name="l02600"></a><span class="lineno"> 2600</span>&#160; </div>
<div class="line"><a name="l02601"></a><span class="lineno"> 2601</span>&#160; </div>
<div class="line"><a name="l02602"></a><span class="lineno"> 2602</span>&#160;  <span class="comment">//=======================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l02603"></a><span class="lineno"> 2603</span>&#160;<span class="comment">  /// Face geometry of the 2D space-time TaylorHood elements</span></div>
<div class="line"><a name="l02604"></a><span class="lineno"> 2604</span>&#160;<span class="comment"></span>  <span class="comment">//=======================================================================</span></div>
<div class="line"><a name="l02605"></a><span class="lineno"> 2605</span>&#160;  <span class="keyword">template</span>&lt;&gt;</div>
<div class="line"><a name="l02606"></a><span class="lineno"> 2606</span>&#160;  <span class="keyword">class </span>FaceGeometry&lt;QTaylorHoodSpaceTimeElement&lt;2&gt;&gt;</div>
<div class="line"><a name="l02607"></a><span class="lineno"> 2607</span>&#160;    : <span class="keyword">public</span> <span class="keyword">virtual</span> QElement&lt;2, 3&gt;</div>
<div class="line"><a name="l02608"></a><span class="lineno"> 2608</span>&#160;  {</div>
<div class="line"><a name="l02609"></a><span class="lineno"> 2609</span>&#160;  <span class="keyword">public</span>:<span class="comment"></span></div>
<div class="line"><a name="l02610"></a><span class="lineno"> 2610</span>&#160;<span class="comment">    /// Constructor; empty</span></div>
<div class="line"><a name="l02611"></a><span class="lineno"><a class="line" href="classoomph_1_1FaceGeometry_3_01QTaylorHoodSpaceTimeElement_3_012_01_4_01_4.html#a635fb5887b7166b97db99bdf986110ea"> 2611</a></span>&#160;<span class="comment"></span>    <a class="code" href="classoomph_1_1FaceGeometry_3_01QTaylorHoodSpaceTimeElement_3_012_01_4_01_4.html#a635fb5887b7166b97db99bdf986110ea">FaceGeometry</a>() : <a class="code" href="classoomph_1_1QElement.html">QElement</a>&lt;2, 3&gt;() {}</div>
<div class="line"><a name="l02612"></a><span class="lineno"> 2612</span>&#160;  };</div>
<div class="line"><a name="l02613"></a><span class="lineno"> 2613</span>&#160; </div>
<div class="line"><a name="l02614"></a><span class="lineno"> 2614</span>&#160;  <span class="comment">//=======================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l02615"></a><span class="lineno"> 2615</span>&#160;<span class="comment">  /// Face geometry of the face geometry of the 2D Taylor Hood elements</span></div>
<div class="line"><a name="l02616"></a><span class="lineno"> 2616</span>&#160;<span class="comment"></span>  <span class="comment">//=======================================================================</span></div>
<div class="line"><a name="l02617"></a><span class="lineno"> 2617</span>&#160;  <span class="keyword">template</span>&lt;&gt;</div>
<div class="line"><a name="l02618"></a><span class="lineno"> 2618</span>&#160;  <span class="keyword">class </span>FaceGeometry&lt;FaceGeometry&lt;QTaylorHoodSpaceTimeElement&lt;2&gt;&gt;&gt;</div>
<div class="line"><a name="l02619"></a><span class="lineno"> 2619</span>&#160;    : <span class="keyword">public</span> <span class="keyword">virtual</span> QElement&lt;1, 3&gt;</div>
<div class="line"><a name="l02620"></a><span class="lineno"> 2620</span>&#160;  {</div>
<div class="line"><a name="l02621"></a><span class="lineno"> 2621</span>&#160;  <span class="keyword">public</span>:<span class="comment"></span></div>
<div class="line"><a name="l02622"></a><span class="lineno"> 2622</span>&#160;<span class="comment">    /// Constructor; empty</span></div>
<div class="line"><a name="l02623"></a><span class="lineno"><a class="line" href="classoomph_1_1FaceGeometry_3_01FaceGeometry_3_01QTaylorHoodSpaceTimeElement_3_012_01_4_01_4_01_4.html#af2a67e91d650c1a4fb03f7115acd60aa"> 2623</a></span>&#160;<span class="comment"></span>    <a class="code" href="classoomph_1_1FaceGeometry_3_01FaceGeometry_3_01QTaylorHoodSpaceTimeElement_3_012_01_4_01_4_01_4.html#af2a67e91d650c1a4fb03f7115acd60aa">FaceGeometry</a>() : <a class="code" href="classoomph_1_1QElement.html">QElement</a>&lt;1, 3&gt;() {}</div>
<div class="line"><a name="l02624"></a><span class="lineno"> 2624</span>&#160;  };</div>
<div class="line"><a name="l02625"></a><span class="lineno"> 2625</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02626"></a><span class="lineno"> 2626</span>&#160;<span class="comment">  ////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l02627"></a><span class="lineno"> 2627</span>&#160;<span class="comment">  ////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l02628"></a><span class="lineno"> 2628</span>&#160;<span class="comment">  ////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l02629"></a><span class="lineno"> 2629</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02630"></a><span class="lineno"> 2630</span>&#160;  <span class="comment">//==========================================================</span><span class="comment"></span></div>
<div class="line"><a name="l02631"></a><span class="lineno"> 2631</span>&#160;<span class="comment">  /// Taylor Hood upgraded to become projectable</span></div>
<div class="line"><a name="l02632"></a><span class="lineno"> 2632</span>&#160;<span class="comment"></span>  <span class="comment">//==========================================================</span></div>
<div class="line"><a name="l02633"></a><span class="lineno"> 2633</span>&#160;  <span class="keyword">template</span>&lt;<span class="keyword">class</span> TAYLOR_HOOD_ELEMENT&gt;</div>
<div class="line"><a name="l02634"></a><span class="lineno"> 2634</span>&#160;  <span class="keyword">class </span>ProjectableTaylorHoodSpaceTimeElement</div>
<div class="line"><a name="l02635"></a><span class="lineno"> 2635</span>&#160;    : <span class="keyword">public</span> <span class="keyword">virtual</span> ProjectableElement&lt;TAYLOR_HOOD_ELEMENT&gt;</div>
<div class="line"><a name="l02636"></a><span class="lineno"> 2636</span>&#160;  {</div>
<div class="line"><a name="l02637"></a><span class="lineno"> 2637</span>&#160;  <span class="keyword">public</span>:<span class="comment"></span></div>
<div class="line"><a name="l02638"></a><span class="lineno"> 2638</span>&#160;<span class="comment">    /// \short Constructor [this was only required explicitly</span></div>
<div class="line"><a name="l02639"></a><span class="lineno"> 2639</span>&#160;<span class="comment">    /// from gcc 4.5.2 onwards...]</span></div>
<div class="line"><a name="l02640"></a><span class="lineno"><a class="line" href="classoomph_1_1ProjectableTaylorHoodSpaceTimeElement.html#ad5d4fa3306af7f3b79c2fbddde30661b"> 2640</a></span>&#160;<span class="comment"></span>    <a class="code" href="classoomph_1_1ProjectableTaylorHoodSpaceTimeElement.html#ad5d4fa3306af7f3b79c2fbddde30661b">ProjectableTaylorHoodSpaceTimeElement</a>() {}</div>
<div class="line"><a name="l02641"></a><span class="lineno"> 2641</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02642"></a><span class="lineno"> 2642</span>&#160;<span class="comment">    /// \short Specify the values associated with field fld.</span></div>
<div class="line"><a name="l02643"></a><span class="lineno"> 2643</span>&#160;<span class="comment">    /// The information is returned in a vector of pairs which comprise</span></div>
<div class="line"><a name="l02644"></a><span class="lineno"> 2644</span>&#160;<span class="comment">    /// the Data object and the value within it, that correspond to field fld.</span></div>
<div class="line"><a name="l02645"></a><span class="lineno"> 2645</span>&#160;<span class="comment">    /// In the underlying Taylor Hood elements the fld-th velocities are stored</span></div>
<div class="line"><a name="l02646"></a><span class="lineno"> 2646</span>&#160;<span class="comment">    /// at the fld-th value of the nodes; the pressures (the dim-th</span></div>
<div class="line"><a name="l02647"></a><span class="lineno"> 2647</span>&#160;<span class="comment">    /// field) are the dim-th values at the vertex nodes etc.</span></div>
<div class="line"><a name="l02648"></a><span class="lineno"><a class="line" href="classoomph_1_1ProjectableTaylorHoodSpaceTimeElement.html#a8bf43e372cee6badaef9e6aa66b03e21"> 2648</a></span>&#160;<span class="comment"></span>    <a class="code" href="classoomph_1_1Vector.html">Vector&lt;std::pair&lt;Data*, unsigned&gt;</a>&gt; <a class="code" href="classoomph_1_1ProjectableTaylorHoodSpaceTimeElement.html#a8bf43e372cee6badaef9e6aa66b03e21">data_values_of_field</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; fld)</div>
<div class="line"><a name="l02649"></a><span class="lineno"> 2649</span>&#160;    {</div>
<div class="line"><a name="l02650"></a><span class="lineno"> 2650</span>&#160;      <span class="comment">// Create the vector</span></div>
<div class="line"><a name="l02651"></a><span class="lineno"> 2651</span>&#160;      <a class="code" href="classoomph_1_1Vector.html">Vector&lt;std::pair&lt;Data*, unsigned&gt;</a>&gt; data_values;</div>
<div class="line"><a name="l02652"></a><span class="lineno"> 2652</span>&#160; </div>
<div class="line"><a name="l02653"></a><span class="lineno"> 2653</span>&#160;      <span class="comment">// If we&#39;re dealing with the velocity dofs</span></div>
<div class="line"><a name="l02654"></a><span class="lineno"> 2654</span>&#160;      <span class="keywordflow">if</span> (fld &lt; this-&gt;dim() - 1)</div>
<div class="line"><a name="l02655"></a><span class="lineno"> 2655</span>&#160;      {</div>
<div class="line"><a name="l02656"></a><span class="lineno"> 2656</span>&#160;        <span class="comment">// How many nodes in the element?</span></div>
<div class="line"><a name="l02657"></a><span class="lineno"> 2657</span>&#160;        <span class="keywordtype">unsigned</span> nnod = this-&gt;nnode();</div>
<div class="line"><a name="l02658"></a><span class="lineno"> 2658</span>&#160; </div>
<div class="line"><a name="l02659"></a><span class="lineno"> 2659</span>&#160;        <span class="comment">// Loop over all nodes</span></div>
<div class="line"><a name="l02660"></a><span class="lineno"> 2660</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j = 0; j &lt; nnod; j++)</div>
<div class="line"><a name="l02661"></a><span class="lineno"> 2661</span>&#160;        {</div>
<div class="line"><a name="l02662"></a><span class="lineno"> 2662</span>&#160;          <span class="comment">// Add the data value associated with the velocity components</span></div>
<div class="line"><a name="l02663"></a><span class="lineno"> 2663</span>&#160;          data_values.push_back(std::make_pair(this-&gt;node_pt(j), fld));</div>
<div class="line"><a name="l02664"></a><span class="lineno"> 2664</span>&#160;        }</div>
<div class="line"><a name="l02665"></a><span class="lineno"> 2665</span>&#160;      }</div>
<div class="line"><a name="l02666"></a><span class="lineno"> 2666</span>&#160;      <span class="comment">// If we&#39;re dealing with the pressure dof</span></div>
<div class="line"><a name="l02667"></a><span class="lineno"> 2667</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l02668"></a><span class="lineno"> 2668</span>&#160;      {</div>
<div class="line"><a name="l02669"></a><span class="lineno"> 2669</span>&#160;        <span class="comment">// How many pressure dofs are there?</span></div>
<div class="line"><a name="l02670"></a><span class="lineno"> 2670</span>&#160;        <span class="comment">// DRAIG: Shouldn&#39;t there be more?</span></div>
<div class="line"><a name="l02671"></a><span class="lineno"> 2671</span>&#160;        <span class="keywordtype">unsigned</span> Pconv_size = this-&gt;dim();</div>
<div class="line"><a name="l02672"></a><span class="lineno"> 2672</span>&#160; </div>
<div class="line"><a name="l02673"></a><span class="lineno"> 2673</span>&#160;        <span class="comment">// Loop over all vertex nodes</span></div>
<div class="line"><a name="l02674"></a><span class="lineno"> 2674</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j = 0; j &lt; Pconv_size; j++)</div>
<div class="line"><a name="l02675"></a><span class="lineno"> 2675</span>&#160;        {</div>
<div class="line"><a name="l02676"></a><span class="lineno"> 2676</span>&#160;          <span class="comment">// Get the vertex index associated with the j-th pressure dof</span></div>
<div class="line"><a name="l02677"></a><span class="lineno"> 2677</span>&#160;          <span class="keywordtype">unsigned</span> vertex_index = this-&gt;Pconv[j];</div>
<div class="line"><a name="l02678"></a><span class="lineno"> 2678</span>&#160; </div>
<div class="line"><a name="l02679"></a><span class="lineno"> 2679</span>&#160;          <span class="comment">// Add the data value associated with the pressure components</span></div>
<div class="line"><a name="l02680"></a><span class="lineno"> 2680</span>&#160;          data_values.push_back(</div>
<div class="line"><a name="l02681"></a><span class="lineno"> 2681</span>&#160;            std::make_pair(this-&gt;node_pt(vertex_index), fld));</div>
<div class="line"><a name="l02682"></a><span class="lineno"> 2682</span>&#160;        }</div>
<div class="line"><a name="l02683"></a><span class="lineno"> 2683</span>&#160;      } <span class="comment">// if (fld&lt;this-&gt;dim())</span></div>
<div class="line"><a name="l02684"></a><span class="lineno"> 2684</span>&#160; </div>
<div class="line"><a name="l02685"></a><span class="lineno"> 2685</span>&#160;      <span class="comment">// Return the vector</span></div>
<div class="line"><a name="l02686"></a><span class="lineno"> 2686</span>&#160;      <span class="keywordflow">return</span> data_values;</div>
<div class="line"><a name="l02687"></a><span class="lineno"> 2687</span>&#160;    } <span class="comment">// End of data_values_of_field</span></div>
<div class="line"><a name="l02688"></a><span class="lineno"> 2688</span>&#160; </div>
<div class="line"><a name="l02689"></a><span class="lineno"> 2689</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02690"></a><span class="lineno"> 2690</span>&#160;<span class="comment">    /// \short Number of fields to be projected: dim+1, corresponding to</span></div>
<div class="line"><a name="l02691"></a><span class="lineno"> 2691</span>&#160;<span class="comment">    /// velocity components and pressure</span></div>
<div class="line"><a name="l02692"></a><span class="lineno"><a class="line" href="classoomph_1_1ProjectableTaylorHoodSpaceTimeElement.html#a662e3e5663832e82dd995543d06a2ffc"> 2692</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">unsigned</span> <a class="code" href="classoomph_1_1ProjectableTaylorHoodSpaceTimeElement.html#a662e3e5663832e82dd995543d06a2ffc">nfields_for_projection</a>()</div>
<div class="line"><a name="l02693"></a><span class="lineno"> 2693</span>&#160;    {</div>
<div class="line"><a name="l02694"></a><span class="lineno"> 2694</span>&#160;      <span class="comment">// There are dim velocity dofs and 1 pressure dof</span></div>
<div class="line"><a name="l02695"></a><span class="lineno"> 2695</span>&#160;      <span class="keywordflow">return</span> this-&gt;dim();</div>
<div class="line"><a name="l02696"></a><span class="lineno"> 2696</span>&#160;    } <span class="comment">// End of nfields_for_projection</span></div>
<div class="line"><a name="l02697"></a><span class="lineno"> 2697</span>&#160; </div>
<div class="line"><a name="l02698"></a><span class="lineno"> 2698</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02699"></a><span class="lineno"> 2699</span>&#160;<span class="comment">    /// \short Number of history values to be stored for fld-th field. Whatever</span></div>
<div class="line"><a name="l02700"></a><span class="lineno"> 2700</span>&#160;<span class="comment">    /// the timestepper has set up for the velocity components and none for</span></div>
<div class="line"><a name="l02701"></a><span class="lineno"> 2701</span>&#160;<span class="comment">    /// the pressure field. NOTE: The count includes the current value!</span></div>
<div class="line"><a name="l02702"></a><span class="lineno"><a class="line" href="classoomph_1_1ProjectableTaylorHoodSpaceTimeElement.html#ae361a8ca7dffa909f09d34b17bdf5046"> 2702</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">unsigned</span> <a class="code" href="classoomph_1_1ProjectableTaylorHoodSpaceTimeElement.html#ae361a8ca7dffa909f09d34b17bdf5046">nhistory_values_for_projection</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; fld)</div>
<div class="line"><a name="l02703"></a><span class="lineno"> 2703</span>&#160;    {</div>
<div class="line"><a name="l02704"></a><span class="lineno"> 2704</span>&#160;      <span class="comment">// If we&#39;re dealing with the pressure dof</span></div>
<div class="line"><a name="l02705"></a><span class="lineno"> 2705</span>&#160;      <span class="keywordflow">if</span> (fld == this-&gt;dim())</div>
<div class="line"><a name="l02706"></a><span class="lineno"> 2706</span>&#160;      {</div>
<div class="line"><a name="l02707"></a><span class="lineno"> 2707</span>&#160;        <span class="comment">// Pressure doesn&#39;t have history values</span></div>
<div class="line"><a name="l02708"></a><span class="lineno"> 2708</span>&#160;        <span class="keywordflow">return</span> this-&gt;node_pt(0)-&gt;ntstorage();</div>
<div class="line"><a name="l02709"></a><span class="lineno"> 2709</span>&#160;      }</div>
<div class="line"><a name="l02710"></a><span class="lineno"> 2710</span>&#160;      <span class="comment">// If we&#39;re dealing with the velocity dofs</span></div>
<div class="line"><a name="l02711"></a><span class="lineno"> 2711</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l02712"></a><span class="lineno"> 2712</span>&#160;      {</div>
<div class="line"><a name="l02713"></a><span class="lineno"> 2713</span>&#160;        <span class="comment">// The velocity dofs have ntstorage() history values</span></div>
<div class="line"><a name="l02714"></a><span class="lineno"> 2714</span>&#160;        <span class="keywordflow">return</span> this-&gt;node_pt(0)-&gt;ntstorage();</div>
<div class="line"><a name="l02715"></a><span class="lineno"> 2715</span>&#160;      }</div>
<div class="line"><a name="l02716"></a><span class="lineno"> 2716</span>&#160;    } <span class="comment">// End of nhistory_values_for_projection</span></div>
<div class="line"><a name="l02717"></a><span class="lineno"> 2717</span>&#160; </div>
<div class="line"><a name="l02718"></a><span class="lineno"> 2718</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02719"></a><span class="lineno"> 2719</span>&#160;<span class="comment">    /// \short Number of positional history values</span></div>
<div class="line"><a name="l02720"></a><span class="lineno"> 2720</span>&#160;<span class="comment">    /// (Note: count includes current value!)</span></div>
<div class="line"><a name="l02721"></a><span class="lineno"><a class="line" href="classoomph_1_1ProjectableTaylorHoodSpaceTimeElement.html#a8241aafbd16b4e2a50bcb8a1a839f530"> 2721</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">unsigned</span> <a class="code" href="classoomph_1_1ProjectableTaylorHoodSpaceTimeElement.html#a8241aafbd16b4e2a50bcb8a1a839f530">nhistory_values_for_coordinate_projection</a>()</div>
<div class="line"><a name="l02722"></a><span class="lineno"> 2722</span>&#160;    {</div>
<div class="line"><a name="l02723"></a><span class="lineno"> 2723</span>&#160;      <span class="comment">// Return the number of positional history values</span></div>
<div class="line"><a name="l02724"></a><span class="lineno"> 2724</span>&#160;      <span class="keywordflow">return</span> this-&gt;node_pt(0)-&gt;position_time_stepper_pt()-&gt;ntstorage();</div>
<div class="line"><a name="l02725"></a><span class="lineno"> 2725</span>&#160;    } <span class="comment">// End of nhistory_values_for_coordinate_projection</span></div>
<div class="line"><a name="l02726"></a><span class="lineno"> 2726</span>&#160; </div>
<div class="line"><a name="l02727"></a><span class="lineno"> 2727</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02728"></a><span class="lineno"> 2728</span>&#160;<span class="comment">    /// \short Return the Jacobian of the mapping and the shape functions</span></div>
<div class="line"><a name="l02729"></a><span class="lineno"> 2729</span>&#160;<span class="comment">    /// of field fld at local coordinate s</span></div>
<div class="line"><a name="l02730"></a><span class="lineno"><a class="line" href="classoomph_1_1ProjectableTaylorHoodSpaceTimeElement.html#acb335e83a84b752d26c92f5207128bd2"> 2730</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1ProjectableTaylorHoodSpaceTimeElement.html#acb335e83a84b752d26c92f5207128bd2">jacobian_and_shape_of_field</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; fld,</div>
<div class="line"><a name="l02731"></a><span class="lineno"> 2731</span>&#160;                                       <span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,</div>
<div class="line"><a name="l02732"></a><span class="lineno"> 2732</span>&#160;                                       <a class="code" href="classoomph_1_1Shape.html">Shape</a>&amp; psi)</div>
<div class="line"><a name="l02733"></a><span class="lineno"> 2733</span>&#160;    {</div>
<div class="line"><a name="l02734"></a><span class="lineno"> 2734</span>&#160;      <span class="comment">// How many dimensions in this element?</span></div>
<div class="line"><a name="l02735"></a><span class="lineno"> 2735</span>&#160;      <span class="keywordtype">unsigned</span> n_dim = this-&gt;dim();</div>
<div class="line"><a name="l02736"></a><span class="lineno"> 2736</span>&#160; </div>
<div class="line"><a name="l02737"></a><span class="lineno"> 2737</span>&#160;      <span class="comment">// How many nodes in this element?</span></div>
<div class="line"><a name="l02738"></a><span class="lineno"> 2738</span>&#160;      <span class="keywordtype">unsigned</span> n_node = this-&gt;nnode();</div>
<div class="line"><a name="l02739"></a><span class="lineno"> 2739</span>&#160; </div>
<div class="line"><a name="l02740"></a><span class="lineno"> 2740</span>&#160;      <span class="comment">// If we&#39;re on the pressure dof</span></div>
<div class="line"><a name="l02741"></a><span class="lineno"> 2741</span>&#160;      <span class="keywordflow">if</span> (fld == n_dim)</div>
<div class="line"><a name="l02742"></a><span class="lineno"> 2742</span>&#160;      {</div>
<div class="line"><a name="l02743"></a><span class="lineno"> 2743</span>&#160;        <span class="comment">// Call the pressure interpolation function</span></div>
<div class="line"><a name="l02744"></a><span class="lineno"> 2744</span>&#160;        this-&gt;pshape_nst(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>, psi);</div>
<div class="line"><a name="l02745"></a><span class="lineno"> 2745</span>&#160; </div>
<div class="line"><a name="l02746"></a><span class="lineno"> 2746</span>&#160;        <span class="comment">// Allocate space for the pressure shape function</span></div>
<div class="line"><a name="l02747"></a><span class="lineno"> 2747</span>&#160;        <a class="code" href="classoomph_1_1Shape.html">Shape</a> psif(n_node);</div>
<div class="line"><a name="l02748"></a><span class="lineno"> 2748</span>&#160; </div>
<div class="line"><a name="l02749"></a><span class="lineno"> 2749</span>&#160;        <span class="comment">// Allocate space for the pressure test function</span></div>
<div class="line"><a name="l02750"></a><span class="lineno"> 2750</span>&#160;        <a class="code" href="classoomph_1_1Shape.html">Shape</a> testf(n_node);</div>
<div class="line"><a name="l02751"></a><span class="lineno"> 2751</span>&#160; </div>
<div class="line"><a name="l02752"></a><span class="lineno"> 2752</span>&#160;        <span class="comment">// Allocate space for the pressure shape function derivatives</span></div>
<div class="line"><a name="l02753"></a><span class="lineno"> 2753</span>&#160;        <a class="code" href="classoomph_1_1DShape.html">DShape</a> dpsifdx(n_node, n_dim);</div>
<div class="line"><a name="l02754"></a><span class="lineno"> 2754</span>&#160; </div>
<div class="line"><a name="l02755"></a><span class="lineno"> 2755</span>&#160;        <span class="comment">// Allocate space for the pressure test function derivatives</span></div>
<div class="line"><a name="l02756"></a><span class="lineno"> 2756</span>&#160;        <a class="code" href="classoomph_1_1DShape.html">DShape</a> dtestfdx(n_node, n_dim);</div>
<div class="line"><a name="l02757"></a><span class="lineno"> 2757</span>&#160; </div>
<div class="line"><a name="l02758"></a><span class="lineno"> 2758</span>&#160;        <span class="comment">// Calculate the Jacobian of the mapping</span></div>
<div class="line"><a name="l02759"></a><span class="lineno"> 2759</span>&#160;        <span class="keywordtype">double</span> J = this-&gt;dshape_and_dtest_eulerian_nst(</div>
<div class="line"><a name="l02760"></a><span class="lineno"> 2760</span>&#160;          <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>, psif, dpsifdx, testf, dtestfdx);</div>
<div class="line"><a name="l02761"></a><span class="lineno"> 2761</span>&#160; </div>
<div class="line"><a name="l02762"></a><span class="lineno"> 2762</span>&#160;        <span class="comment">// Return the Jacobian</span></div>
<div class="line"><a name="l02763"></a><span class="lineno"> 2763</span>&#160;        <span class="keywordflow">return</span> J;</div>
<div class="line"><a name="l02764"></a><span class="lineno"> 2764</span>&#160;      }</div>
<div class="line"><a name="l02765"></a><span class="lineno"> 2765</span>&#160;      <span class="comment">// If we&#39;re on the velocity components</span></div>
<div class="line"><a name="l02766"></a><span class="lineno"> 2766</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l02767"></a><span class="lineno"> 2767</span>&#160;      {</div>
<div class="line"><a name="l02768"></a><span class="lineno"> 2768</span>&#160;        <span class="comment">// Allocate space for the test functions</span></div>
<div class="line"><a name="l02769"></a><span class="lineno"> 2769</span>&#160;        <a class="code" href="classoomph_1_1Shape.html">Shape</a> testf(n_node);</div>
<div class="line"><a name="l02770"></a><span class="lineno"> 2770</span>&#160; </div>
<div class="line"><a name="l02771"></a><span class="lineno"> 2771</span>&#160;        <span class="comment">// Allocate space for the shape function derivatives</span></div>
<div class="line"><a name="l02772"></a><span class="lineno"> 2772</span>&#160;        <a class="code" href="classoomph_1_1DShape.html">DShape</a> dpsifdx(n_node, n_dim);</div>
<div class="line"><a name="l02773"></a><span class="lineno"> 2773</span>&#160; </div>
<div class="line"><a name="l02774"></a><span class="lineno"> 2774</span>&#160;        <span class="comment">// Allocate space for the test function derivatives</span></div>
<div class="line"><a name="l02775"></a><span class="lineno"> 2775</span>&#160;        <a class="code" href="classoomph_1_1DShape.html">DShape</a> dtestfdx(n_node, n_dim);</div>
<div class="line"><a name="l02776"></a><span class="lineno"> 2776</span>&#160; </div>
<div class="line"><a name="l02777"></a><span class="lineno"> 2777</span>&#160;        <span class="comment">// Calculate the Jacobian of the mapping</span></div>
<div class="line"><a name="l02778"></a><span class="lineno"> 2778</span>&#160;        <span class="keywordtype">double</span> J =</div>
<div class="line"><a name="l02779"></a><span class="lineno"> 2779</span>&#160;          this-&gt;dshape_and_dtest_eulerian_nst(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>, psi, dpsifdx, testf, dtestfdx);</div>
<div class="line"><a name="l02780"></a><span class="lineno"> 2780</span>&#160; </div>
<div class="line"><a name="l02781"></a><span class="lineno"> 2781</span>&#160;        <span class="comment">// Return the Jacobian</span></div>
<div class="line"><a name="l02782"></a><span class="lineno"> 2782</span>&#160;        <span class="keywordflow">return</span> J;</div>
<div class="line"><a name="l02783"></a><span class="lineno"> 2783</span>&#160;      }</div>
<div class="line"><a name="l02784"></a><span class="lineno"> 2784</span>&#160;    } <span class="comment">// End of jacobian_and_shape_of_field</span></div>
<div class="line"><a name="l02785"></a><span class="lineno"> 2785</span>&#160; </div>
<div class="line"><a name="l02786"></a><span class="lineno"> 2786</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02787"></a><span class="lineno"> 2787</span>&#160;<span class="comment">    /// \short Return interpolated field fld at local coordinate s, at time</span></div>
<div class="line"><a name="l02788"></a><span class="lineno"> 2788</span>&#160;<span class="comment">    /// level t (t=0: present; t&gt;0: history values)</span></div>
<div class="line"><a name="l02789"></a><span class="lineno"><a class="line" href="classoomph_1_1ProjectableTaylorHoodSpaceTimeElement.html#a565ba9ed0cf7828d3217111f8c59b489"> 2789</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1ProjectableTaylorHoodSpaceTimeElement.html#a565ba9ed0cf7828d3217111f8c59b489">get_field</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; <a class="code" href="cfortran_8h.html#af6f0bd3dc13317f895c91323c25c2b8f">t</a>,</div>
<div class="line"><a name="l02790"></a><span class="lineno"> 2790</span>&#160;                     <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; fld,</div>
<div class="line"><a name="l02791"></a><span class="lineno"> 2791</span>&#160;                     <span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>)</div>
<div class="line"><a name="l02792"></a><span class="lineno"> 2792</span>&#160;    {</div>
<div class="line"><a name="l02793"></a><span class="lineno"> 2793</span>&#160;      <span class="keywordtype">unsigned</span> n_dim = this-&gt;dim();</div>
<div class="line"><a name="l02794"></a><span class="lineno"> 2794</span>&#160;      <span class="keywordtype">unsigned</span> n_node = this-&gt;nnode();</div>
<div class="line"><a name="l02795"></a><span class="lineno"> 2795</span>&#160; </div>
<div class="line"><a name="l02796"></a><span class="lineno"> 2796</span>&#160;      <span class="comment">// If fld=n_dim, we deal with the pressure</span></div>
<div class="line"><a name="l02797"></a><span class="lineno"> 2797</span>&#160;      <span class="keywordflow">if</span> (fld == n_dim)</div>
<div class="line"><a name="l02798"></a><span class="lineno"> 2798</span>&#160;      {</div>
<div class="line"><a name="l02799"></a><span class="lineno"> 2799</span>&#160;        <span class="keywordflow">return</span> this-&gt;interpolated_p_nst(<a class="code" href="cfortran_8h.html#af6f0bd3dc13317f895c91323c25c2b8f">t</a>, <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>);</div>
<div class="line"><a name="l02800"></a><span class="lineno"> 2800</span>&#160;      }</div>
<div class="line"><a name="l02801"></a><span class="lineno"> 2801</span>&#160;      <span class="comment">// Velocity</span></div>
<div class="line"><a name="l02802"></a><span class="lineno"> 2802</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l02803"></a><span class="lineno"> 2803</span>&#160;      {</div>
<div class="line"><a name="l02804"></a><span class="lineno"> 2804</span>&#160;        <span class="comment">// Find the index at which the variable is stored</span></div>
<div class="line"><a name="l02805"></a><span class="lineno"> 2805</span>&#160;        <span class="keywordtype">unsigned</span> u_nodal_index = this-&gt;u_index_nst(fld);</div>
<div class="line"><a name="l02806"></a><span class="lineno"> 2806</span>&#160; </div>
<div class="line"><a name="l02807"></a><span class="lineno"> 2807</span>&#160;        <span class="comment">// Local shape function</span></div>
<div class="line"><a name="l02808"></a><span class="lineno"> 2808</span>&#160;        <a class="code" href="classoomph_1_1Shape.html">Shape</a> psi(n_node);</div>
<div class="line"><a name="l02809"></a><span class="lineno"> 2809</span>&#160; </div>
<div class="line"><a name="l02810"></a><span class="lineno"> 2810</span>&#160;        <span class="comment">// Find values of shape function</span></div>
<div class="line"><a name="l02811"></a><span class="lineno"> 2811</span>&#160;        this-&gt;<a class="code" href="namespaceoomph_1_1OneDimLagrange.html#a117f8b892dc89989ecdad99ff261e120">shape</a>(s, psi);</div>
<div class="line"><a name="l02812"></a><span class="lineno"> 2812</span>&#160; </div>
<div class="line"><a name="l02813"></a><span class="lineno"> 2813</span>&#160;        <span class="comment">// Initialise value of u</span></div>
<div class="line"><a name="l02814"></a><span class="lineno"> 2814</span>&#160;        <span class="keywordtype">double</span> <a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a> = 0.0;</div>
<div class="line"><a name="l02815"></a><span class="lineno"> 2815</span>&#160; </div>
<div class="line"><a name="l02816"></a><span class="lineno"> 2816</span>&#160;        <span class="comment">// Sum over the local nodes at that time</span></div>
<div class="line"><a name="l02817"></a><span class="lineno"> 2817</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> l = 0; l &lt; n_node; l++)</div>
<div class="line"><a name="l02818"></a><span class="lineno"> 2818</span>&#160;        {</div>
<div class="line"><a name="l02819"></a><span class="lineno"> 2819</span>&#160;          <a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a> += this-&gt;nodal_value(<a class="code" href="cfortran_8h.html#af6f0bd3dc13317f895c91323c25c2b8f">t</a>, l, u_nodal_index) * psi[l];</div>
<div class="line"><a name="l02820"></a><span class="lineno"> 2820</span>&#160;        }</div>
<div class="line"><a name="l02821"></a><span class="lineno"> 2821</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>;</div>
<div class="line"><a name="l02822"></a><span class="lineno"> 2822</span>&#160;      }</div>
<div class="line"><a name="l02823"></a><span class="lineno"> 2823</span>&#160;    }</div>
<div class="line"><a name="l02824"></a><span class="lineno"> 2824</span>&#160; </div>
<div class="line"><a name="l02825"></a><span class="lineno"> 2825</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02826"></a><span class="lineno"> 2826</span>&#160;<span class="comment">    /// Return number of values in field fld</span></div>
<div class="line"><a name="l02827"></a><span class="lineno"><a class="line" href="classoomph_1_1ProjectableTaylorHoodSpaceTimeElement.html#a7ff4171a511f42a9f0648629cf90b25e"> 2827</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">unsigned</span> <a class="code" href="classoomph_1_1ProjectableTaylorHoodSpaceTimeElement.html#a7ff4171a511f42a9f0648629cf90b25e">nvalue_of_field</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; fld)</div>
<div class="line"><a name="l02828"></a><span class="lineno"> 2828</span>&#160;    {</div>
<div class="line"><a name="l02829"></a><span class="lineno"> 2829</span>&#160;      <span class="keywordflow">if</span> (fld == this-&gt;dim())</div>
<div class="line"><a name="l02830"></a><span class="lineno"> 2830</span>&#160;      {</div>
<div class="line"><a name="l02831"></a><span class="lineno"> 2831</span>&#160;        <span class="keywordflow">return</span> this-&gt;npres_nst();</div>
<div class="line"><a name="l02832"></a><span class="lineno"> 2832</span>&#160;      }</div>
<div class="line"><a name="l02833"></a><span class="lineno"> 2833</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l02834"></a><span class="lineno"> 2834</span>&#160;      {</div>
<div class="line"><a name="l02835"></a><span class="lineno"> 2835</span>&#160;        <span class="keywordflow">return</span> this-&gt;nnode();</div>
<div class="line"><a name="l02836"></a><span class="lineno"> 2836</span>&#160;      }</div>
<div class="line"><a name="l02837"></a><span class="lineno"> 2837</span>&#160;    }</div>
<div class="line"><a name="l02838"></a><span class="lineno"> 2838</span>&#160; </div>
<div class="line"><a name="l02839"></a><span class="lineno"> 2839</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02840"></a><span class="lineno"> 2840</span>&#160;<span class="comment">    /// Return local equation number of value j in field fld.</span></div>
<div class="line"><a name="l02841"></a><span class="lineno"><a class="line" href="classoomph_1_1ProjectableTaylorHoodSpaceTimeElement.html#abc5ca8c244aa7f3a6bb68856dab812ba"> 2841</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">int</span> <a class="code" href="classoomph_1_1ProjectableTaylorHoodSpaceTimeElement.html#abc5ca8c244aa7f3a6bb68856dab812ba">local_equation</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; fld, <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; j)</div>
<div class="line"><a name="l02842"></a><span class="lineno"> 2842</span>&#160;    {</div>
<div class="line"><a name="l02843"></a><span class="lineno"> 2843</span>&#160;      <span class="keywordflow">if</span> (fld == this-&gt;dim())</div>
<div class="line"><a name="l02844"></a><span class="lineno"> 2844</span>&#160;      {</div>
<div class="line"><a name="l02845"></a><span class="lineno"> 2845</span>&#160;        <span class="keywordflow">return</span> this-&gt;p_local_eqn(j);</div>
<div class="line"><a name="l02846"></a><span class="lineno"> 2846</span>&#160;      }</div>
<div class="line"><a name="l02847"></a><span class="lineno"> 2847</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l02848"></a><span class="lineno"> 2848</span>&#160;      {</div>
<div class="line"><a name="l02849"></a><span class="lineno"> 2849</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> u_nodal_index = this-&gt;u_index_nst(fld);</div>
<div class="line"><a name="l02850"></a><span class="lineno"> 2850</span>&#160;        <span class="keywordflow">return</span> this-&gt;nodal_local_eqn(j, u_nodal_index);</div>
<div class="line"><a name="l02851"></a><span class="lineno"> 2851</span>&#160;      }</div>
<div class="line"><a name="l02852"></a><span class="lineno"> 2852</span>&#160;    }</div>
<div class="line"><a name="l02853"></a><span class="lineno"> 2853</span>&#160;  };</div>
<div class="line"><a name="l02854"></a><span class="lineno"> 2854</span>&#160; </div>
<div class="line"><a name="l02855"></a><span class="lineno"> 2855</span>&#160; </div>
<div class="line"><a name="l02856"></a><span class="lineno"> 2856</span>&#160;  <span class="comment">//=======================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l02857"></a><span class="lineno"> 2857</span>&#160;<span class="comment">  /// Face geometry for element is the same as that for the underlying</span></div>
<div class="line"><a name="l02858"></a><span class="lineno"> 2858</span>&#160;<span class="comment">  /// wrapped element</span></div>
<div class="line"><a name="l02859"></a><span class="lineno"> 2859</span>&#160;<span class="comment"></span>  <span class="comment">//=======================================================================</span></div>
<div class="line"><a name="l02860"></a><span class="lineno"> 2860</span>&#160;  <span class="keyword">template</span>&lt;<span class="keyword">class</span> ELEMENT&gt;</div>
<div class="line"><a name="l02861"></a><span class="lineno"> 2861</span>&#160;  <span class="keyword">class </span>FaceGeometry&lt;ProjectableTaylorHoodSpaceTimeElement&lt;ELEMENT&gt;&gt;</div>
<div class="line"><a name="l02862"></a><span class="lineno"> 2862</span>&#160;    : <span class="keyword">public</span> <span class="keyword">virtual</span> FaceGeometry&lt;ELEMENT&gt;</div>
<div class="line"><a name="l02863"></a><span class="lineno"> 2863</span>&#160;  {</div>
<div class="line"><a name="l02864"></a><span class="lineno"> 2864</span>&#160;  <span class="keyword">public</span>:</div>
<div class="line"><a name="l02865"></a><span class="lineno"><a class="line" href="classoomph_1_1FaceGeometry_3_01ProjectableTaylorHoodSpaceTimeElement_3_01ELEMENT_01_4_01_4.html#a446b3497a84914c0ef866765ce06c9ba"> 2865</a></span>&#160;    <a class="code" href="classoomph_1_1FaceGeometry_3_01ProjectableTaylorHoodSpaceTimeElement_3_01ELEMENT_01_4_01_4.html#a446b3497a84914c0ef866765ce06c9ba">FaceGeometry</a>() : <a class="code" href="classoomph_1_1FaceGeometry.html">FaceGeometry</a>&lt;ELEMENT&gt;() {}</div>
<div class="line"><a name="l02866"></a><span class="lineno"> 2866</span>&#160;  };</div>
<div class="line"><a name="l02867"></a><span class="lineno"> 2867</span>&#160; </div>
<div class="line"><a name="l02868"></a><span class="lineno"> 2868</span>&#160;  <span class="comment">//=======================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l02869"></a><span class="lineno"> 2869</span>&#160;<span class="comment">  /// Face geometry of the Face Geometry for element is the same as</span></div>
<div class="line"><a name="l02870"></a><span class="lineno"> 2870</span>&#160;<span class="comment">  /// that for the underlying wrapped element</span></div>
<div class="line"><a name="l02871"></a><span class="lineno"> 2871</span>&#160;<span class="comment"></span>  <span class="comment">//=======================================================================</span></div>
<div class="line"><a name="l02872"></a><span class="lineno"> 2872</span>&#160;  <span class="keyword">template</span>&lt;<span class="keyword">class</span> ELEMENT&gt;</div>
<div class="line"><a name="l02873"></a><span class="lineno"> 2873</span>&#160;  <span class="keyword">class </span>FaceGeometry&lt;</div>
<div class="line"><a name="l02874"></a><span class="lineno"> 2874</span>&#160;    FaceGeometry&lt;ProjectableTaylorHoodSpaceTimeElement&lt;ELEMENT&gt;&gt;&gt;</div>
<div class="line"><a name="l02875"></a><span class="lineno"> 2875</span>&#160;    : <span class="keyword">public</span> <span class="keyword">virtual</span> FaceGeometry&lt;FaceGeometry&lt;ELEMENT&gt;&gt;</div>
<div class="line"><a name="l02876"></a><span class="lineno"> 2876</span>&#160;  {</div>
<div class="line"><a name="l02877"></a><span class="lineno"> 2877</span>&#160;  <span class="keyword">public</span>:</div>
<div class="line"><a name="l02878"></a><span class="lineno"><a class="line" href="classoomph_1_1FaceGeometry_3_01FaceGeometry_3_01ProjectableTaylorHoodSpaceTimeElement_3_01ELEMENT_01_4_01_4_01_4.html#af41163fcd9752585093831cd545f1bb4"> 2878</a></span>&#160;    <a class="code" href="classoomph_1_1FaceGeometry_3_01FaceGeometry_3_01ProjectableTaylorHoodSpaceTimeElement_3_01ELEMENT_01_4_01_4_01_4.html#af41163fcd9752585093831cd545f1bb4">FaceGeometry</a>() : <a class="code" href="classoomph_1_1FaceGeometry.html">FaceGeometry</a>&lt;<a class="code" href="classoomph_1_1FaceGeometry.html">FaceGeometry</a>&lt;ELEMENT&gt;&gt;() {}</div>
<div class="line"><a name="l02879"></a><span class="lineno"> 2879</span>&#160;  };</div>
<div class="line"><a name="l02880"></a><span class="lineno"> 2880</span>&#160; </div>
<div class="line"><a name="l02881"></a><span class="lineno"> 2881</span>&#160;} <span class="comment">// End of namespace oomph</span></div>
<div class="line"><a name="l02882"></a><span class="lineno"> 2882</span>&#160; </div>
<div class="line"><a name="l02883"></a><span class="lineno"> 2883</span>&#160;<span class="preprocessor">#endif</span></div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="aclassoomph_1_1SpaceTimeNavierStokesEquations_html_a9915a850967b024b10d2efeaa79a779b"><div class="ttname"><a href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a9915a850967b024b10d2efeaa79a779b">oomph::SpaceTimeNavierStokesEquations::Default_Gravity_vector</a></div><div class="ttdeci">static Vector&lt; double &gt; Default_Gravity_vector</div><div class="ttdoc">Static default value for the gravity vector.</div><div class="ttdef"><b>Definition:</b> <a href="discontinuous__galerkin__equal__order__pressure__spacetime__navier__stokes__elements_8h_source.html#l00504">discontinuous_galerkin_equal_order_pressure_spacetime_navier_stokes_elements.h:504</a></div></div>
<div class="ttc" id="aclassoomph_1_1SpaceTimeNavierStokesEquations_html_a592b8cc9328e9008c2747cc8b68819cf"><div class="ttname"><a href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a592b8cc9328e9008c2747cc8b68819cf">oomph::SpaceTimeNavierStokesEquations::output</a></div><div class="ttdeci">void output(FILE *file_pt)</div><div class="ttdoc">C-style output function: x,y,[z],u,v,[w],p in tecplot format. The default number of plot points is fi...</div><div class="ttdef"><b>Definition:</b> <a href="spacetime__navier__stokes__elements_8h_source.html#l01469">spacetime_navier_stokes_elements.h:1469</a></div></div>
<div class="ttc" id="aclassoomph_1_1SpaceTimeNavierStokesEquations_html_ac6317680ee7fcef4a9e353302854413c"><div class="ttname"><a href="classoomph_1_1SpaceTimeNavierStokesEquations.html#ac6317680ee7fcef4a9e353302854413c">oomph::SpaceTimeNavierStokesEquations::get_dresidual_dnodal_coordinates</a></div><div class="ttdeci">virtual void get_dresidual_dnodal_coordinates(RankThreeTensor&lt; double &gt; &amp;dresidual_dnodal_coordinates)</div><div class="ttdoc">Compute derivatives of elemental residual vector with respect to nodal coordinates....</div><div class="ttdef"><b>Definition:</b> <a href="discontinuous__galerkin__equal__order__pressure__spacetime__navier__stokes__elements_8cc_source.html#l02481">discontinuous_galerkin_equal_order_pressure_spacetime_navier_stokes_elements.cc:2481</a></div></div>
<div class="ttc" id="aclassoomph_1_1RankFourTensor_html"><div class="ttname"><a href="classoomph_1_1RankFourTensor.html">oomph::RankFourTensor</a></div><div class="ttdoc">A Rank 4 Tensor class.</div><div class="ttdef"><b>Definition:</b> <a href="matrices_8h_source.html#l01729">matrices.h:1729</a></div></div>
<div class="ttc" id="aclassoomph_1_1SpaceTimeNavierStokesEquations_html_aa8950bfab421438e63717ac8317f6911"><div class="ttname"><a href="classoomph_1_1SpaceTimeNavierStokesEquations.html#aa8950bfab421438e63717ac8317f6911">oomph::SpaceTimeNavierStokesEquations::fill_in_contribution_to_djacobian_and_dmass_matrix_dparameter</a></div><div class="ttdeci">void fill_in_contribution_to_djacobian_and_dmass_matrix_dparameter(double *const &amp;parameter_pt, Vector&lt; double &gt; &amp;dres_dparam, DenseMatrix&lt; double &gt; &amp;djac_dparam, DenseMatrix&lt; double &gt; &amp;dmass_matrix_dparam)</div><div class="ttdef"><b>Definition:</b> <a href="spacetime__navier__stokes__elements_8h_source.html#l01673">spacetime_navier_stokes_elements.h:1673</a></div></div>
<div class="ttc" id="aclassoomph_1_1SpaceTimeNavierStokesEquations_html_a5c5bf194c9ec4781afbb77556a605b35"><div class="ttname"><a href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a5c5bf194c9ec4781afbb77556a605b35">oomph::SpaceTimeNavierStokesEquations::re</a></div><div class="ttdeci">const double &amp; re() const</div><div class="ttdoc">Reynolds number.</div><div class="ttdef"><b>Definition:</b> <a href="spacetime__navier__stokes__elements_8h_source.html#l00867">spacetime_navier_stokes_elements.h:867</a></div></div>
<div class="ttc" id="aclassoomph_1_1QTaylorHoodSpaceTimeElement_html_a140cfd3ddcbdc3a1fd704a1bbea083cf"><div class="ttname"><a href="classoomph_1_1QTaylorHoodSpaceTimeElement.html#a140cfd3ddcbdc3a1fd704a1bbea083cf">oomph::QTaylorHoodSpaceTimeElement::p_nodal_index_nst</a></div><div class="ttdeci">virtual int p_nodal_index_nst() const</div><div class="ttdoc">Set the value at which the pressure is stored in the nodes.</div><div class="ttdef"><b>Definition:</b> <a href="spacetime__navier__stokes__elements_8h_source.html#l02179">spacetime_navier_stokes_elements.h:2179</a></div></div>
<div class="ttc" id="aclassoomph_1_1SpaceTimeNavierStokesEquations_html_a8e7f428ab00da109741f910e95d2e4cc"><div class="ttname"><a href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a8e7f428ab00da109741f910e95d2e4cc">oomph::SpaceTimeNavierStokesEquations::re_pt</a></div><div class="ttdeci">double *&amp; re_pt()</div><div class="ttdoc">Pointer to Reynolds number.</div><div class="ttdef"><b>Definition:</b> <a href="spacetime__navier__stokes__elements_8h_source.html#l00875">spacetime_navier_stokes_elements.h:875</a></div></div>
<div class="ttc" id="aclassoomph_1_1GeneralisedElement_html_a3ec4e27a7a3d16122b00e2b5be0d1036"><div class="ttname"><a href="classoomph_1_1GeneralisedElement.html#a3ec4e27a7a3d16122b00e2b5be0d1036">oomph::GeneralisedElement::external_data_pt</a></div><div class="ttdeci">Data *&amp; external_data_pt(const unsigned &amp;i)</div><div class="ttdoc">Return a pointer to i-th external data object.</div><div class="ttdef"><b>Definition:</b> <a href="elements_8h_source.html#l00665">elements.h:665</a></div></div>
<div class="ttc" id="aclassoomph_1_1QTaylorHoodSpaceTimeElement_html_a1a897a60bec577fa25c27d6e152eccfe"><div class="ttname"><a href="classoomph_1_1QTaylorHoodSpaceTimeElement.html#a1a897a60bec577fa25c27d6e152eccfe">oomph::QTaylorHoodSpaceTimeElement::QTaylorHoodSpaceTimeElement</a></div><div class="ttdeci">QTaylorHoodSpaceTimeElement()</div><div class="ttdoc">Constructor, no internal data points.</div><div class="ttdef"><b>Definition:</b> <a href="spacetime__navier__stokes__elements_8h_source.html#l02154">spacetime_navier_stokes_elements.h:2154</a></div></div>
<div class="ttc" id="aclassoomph_1_1SpaceTimeNavierStokesEquations_html_aaab4919eaba2e354fb1b53d866cb0a97"><div class="ttname"><a href="classoomph_1_1SpaceTimeNavierStokesEquations.html#aaab4919eaba2e354fb1b53d866cb0a97">oomph::SpaceTimeNavierStokesEquations::nscalar_paraview</a></div><div class="ttdeci">unsigned nscalar_paraview() const</div><div class="ttdoc">Number of scalars/fields output by this element. Reimplements broken virtual function in base class.</div><div class="ttdef"><b>Definition:</b> <a href="spacetime__navier__stokes__elements_8h_source.html#l01287">spacetime_navier_stokes_elements.h:1287</a></div></div>
<div class="ttc" id="aclassoomph_1_1SpaceTimeNavierStokesEquations_html_ab05a01e85edefd811e44fe480a675ebb"><div class="ttname"><a href="classoomph_1_1SpaceTimeNavierStokesEquations.html#ab05a01e85edefd811e44fe480a675ebb">oomph::SpaceTimeNavierStokesEquations::interpolated_u_nst</a></div><div class="ttdeci">void interpolated_u_nst(const Vector&lt; double &gt; &amp;s, Vector&lt; double &gt; &amp;velocity) const</div><div class="ttdoc">Compute vector of FE interpolated velocity u at local coordinate s.</div><div class="ttdef"><b>Definition:</b> <a href="discontinuous__galerkin__equal__order__pressure__spacetime__navier__stokes__elements_8h_source.html#l01898">discontinuous_galerkin_equal_order_pressure_spacetime_navier_stokes_elements.h:1898</a></div></div>
<div class="ttc" id="aclassoomph_1_1SpaceTimeNavierStokesEquations_html_a70e895a4a3001c4df3cb3000500a345d"><div class="ttname"><a href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a70e895a4a3001c4df3cb3000500a345d">oomph::SpaceTimeNavierStokesEquations::ReSt_pt</a></div><div class="ttdeci">double * ReSt_pt</div><div class="ttdoc">Pointer to global Reynolds number x Strouhal number (= Womersley)</div><div class="ttdef"><b>Definition:</b> <a href="spacetime__navier__stokes__elements_8h_source.html#l00523">spacetime_navier_stokes_elements.h:523</a></div></div>
<div class="ttc" id="aclassoomph_1_1SpaceTimeNavierStokesEquations_html_a396d11f7e8bfb0db458881165b8f7833"><div class="ttname"><a href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a396d11f7e8bfb0db458881165b8f7833">oomph::SpaceTimeNavierStokesEquations::output_fct</a></div><div class="ttdeci">void output_fct(std::ostream &amp;outfile, const unsigned &amp;nplot, FiniteElement::SteadyExactSolutionFctPt exact_soln_pt)</div><div class="ttdoc">Output exact solution specified via function pointer at a given number of plot points....</div><div class="ttdef"><b>Definition:</b> <a href="discontinuous__galerkin__equal__order__pressure__spacetime__navier__stokes__elements_8cc_source.html#l00777">discontinuous_galerkin_equal_order_pressure_spacetime_navier_stokes_elements.cc:777</a></div></div>
<div class="ttc" id="aclassoomph_1_1ProjectableTaylorHoodSpaceTimeElement_html_a8bf43e372cee6badaef9e6aa66b03e21"><div class="ttname"><a href="classoomph_1_1ProjectableTaylorHoodSpaceTimeElement.html#a8bf43e372cee6badaef9e6aa66b03e21">oomph::ProjectableTaylorHoodSpaceTimeElement::data_values_of_field</a></div><div class="ttdeci">Vector&lt; std::pair&lt; Data *, unsigned &gt; &gt; data_values_of_field(const unsigned &amp;fld)</div><div class="ttdoc">Specify the values associated with field fld. The information is returned in a vector of pairs which ...</div><div class="ttdef"><b>Definition:</b> <a href="spacetime__navier__stokes__elements_8h_source.html#l02648">spacetime_navier_stokes_elements.h:2648</a></div></div>
<div class="ttc" id="athe__data__structure_8txt_html_a5448c72da3359c7796cf0c5f800732a1"><div class="ttname"><a href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a></div><div class="ttdeci">and code FiniteElement::J_eulerian(...) \endcode returns the Jacobian of the mapping from Eulerian coordinates to local coordinates. - The function \c GeneralisedElement c QElement&lt; 3, 2 &gt; is an node brick element with a trilinear mapping between and global coordinates The dimension and the number of c Nodes must be set by calling the appropriate c set_ functions in the see ref set_commands above The most important member functions implemented at this level include Functions that evaluate the shape in terms of the c FiniteElement s coordinates functions that determine whether a c Node is located at a particular coordinate Output functions that allow the element shapes to be plotted we specify a pointer to a spatial integration the default assignment can be over written at a higher level This is discussed in more detail in a&lt; A HREF=&quot;../../optimisation/html/index.html&quot;&gt; separate document&lt;/A &gt; subsubsection Maths_Element we implement the equations that are represented by the specific element We implement the employing either the geometric shape functions that already exist on or employing additional shape functions defined at this level This allows us to write further member functions such as c interpolated_u(...)</div></div>
<div class="ttc" id="aclassoomph_1_1FaceGeometry_3_01FaceGeometry_3_01ProjectableTaylorHoodSpaceTimeElement_3_01ELEMENT_01_4_01_4_01_4_html_af41163fcd9752585093831cd545f1bb4"><div class="ttname"><a href="classoomph_1_1FaceGeometry_3_01FaceGeometry_3_01ProjectableTaylorHoodSpaceTimeElement_3_01ELEMENT_01_4_01_4_01_4.html#af41163fcd9752585093831cd545f1bb4">oomph::FaceGeometry&lt; FaceGeometry&lt; ProjectableTaylorHoodSpaceTimeElement&lt; ELEMENT &gt; &gt; &gt;::FaceGeometry</a></div><div class="ttdeci">FaceGeometry()</div><div class="ttdef"><b>Definition:</b> <a href="spacetime__navier__stokes__elements_8h_source.html#l02878">spacetime_navier_stokes_elements.h:2878</a></div></div>
<div class="ttc" id="aclassoomph_1_1QTaylorHoodSpaceTimeElement_html_ace7b8ad451c792bf1fe51a19698f10de"><div class="ttname"><a href="classoomph_1_1QTaylorHoodSpaceTimeElement.html#ace7b8ad451c792bf1fe51a19698f10de">oomph::QTaylorHoodSpaceTimeElement::dshape_and_dtest_eulerian_at_knot_nst</a></div><div class="ttdeci">double dshape_and_dtest_eulerian_at_knot_nst(const unsigned &amp;ipt, Shape &amp;psi, DShape &amp;dpsidx, Shape &amp;test, DShape &amp;dtestdx) const</div><div class="ttdoc">Velocity shape and test functions and their derivs w.r.t. to global coords at local coordinate s (tak...</div><div class="ttdef"><b>Definition:</b> <a href="discontinuous__galerkin__equal__order__pressure__spacetime__navier__stokes__elements_8h_source.html#l02485">discontinuous_galerkin_equal_order_pressure_spacetime_navier_stokes_elements.h:2485</a></div></div>
<div class="ttc" id="aclassoomph_1_1SpaceTimeNavierStokesEquations_html_ad994654e6b67f8fe23baec0c1a15cac7"><div class="ttname"><a href="classoomph_1_1SpaceTimeNavierStokesEquations.html#ad994654e6b67f8fe23baec0c1a15cac7">oomph::SpaceTimeNavierStokesEquations::fill_in_contribution_to_djacobian_dparameter</a></div><div class="ttdeci">void fill_in_contribution_to_djacobian_dparameter(double *const &amp;parameter_pt, Vector&lt; double &gt; &amp;dres_dparam, DenseMatrix&lt; double &gt; &amp;djac_dparam)</div><div class="ttdoc">Compute the element's residual Vector and the jacobian matrix Virtual function can be overloaded by h...</div><div class="ttdef"><b>Definition:</b> <a href="spacetime__navier__stokes__elements_8h_source.html#l01653">spacetime_navier_stokes_elements.h:1653</a></div></div>
<div class="ttc" id="aclassoomph_1_1Data_html_a7289ca322725c6fd493970a19474b382"><div class="ttname"><a href="classoomph_1_1Data.html#a7289ca322725c6fd493970a19474b382">oomph::Data::set_value</a></div><div class="ttdeci">void set_value(const unsigned &amp;i, const double &amp;value_)</div><div class="ttdoc">Set the i-th stored data value to specified value. The only reason that we require an explicit set fu...</div><div class="ttdef"><b>Definition:</b> <a href="nodes_8h_source.html#l00277">nodes.h:277</a></div></div>
<div class="ttc" id="aclassoomph_1_1FiniteElement_html_a5f8fe59f06da1da9f6b7bbcbdb90ef93"><div class="ttname"><a href="classoomph_1_1FiniteElement.html#a5f8fe59f06da1da9f6b7bbcbdb90ef93">oomph::FiniteElement::dim</a></div><div class="ttdeci">unsigned dim() const</div><div class="ttdoc">Return the spatial dimension of the element, i.e. the number of local coordinates required to paramet...</div><div class="ttdef"><b>Definition:</b> <a href="elements_8h_source.html#l02628">elements.h:2628</a></div></div>
<div class="ttc" id="aclassoomph_1_1SpaceTimeNavierStokesEquations_html_af986024e19c3b5f8c9c880dcea38e7b0"><div class="ttname"><a href="classoomph_1_1SpaceTimeNavierStokesEquations.html#af986024e19c3b5f8c9c880dcea38e7b0">oomph::SpaceTimeNavierStokesEquations::fill_in_contribution_to_jacobian</a></div><div class="ttdeci">void fill_in_contribution_to_jacobian(Vector&lt; double &gt; &amp;residuals, DenseMatrix&lt; double &gt; &amp;jacobian)</div><div class="ttdoc">Compute the element's residual Vector and the jacobian matrix Virtual function can be overloaded by h...</div><div class="ttdef"><b>Definition:</b> <a href="spacetime__navier__stokes__elements_8h_source.html#l01602">spacetime_navier_stokes_elements.h:1602</a></div></div>
<div class="ttc" id="athe__data__structure_8txt_html_a1400a973def57b85051cfe1070be1810"><div class="ttname"><a href="the__data__structure_8txt.html#a1400a973def57b85051cfe1070be1810">residuals</a></div><div class="ttdeci">endcode The default implementation of c the simplest possible implementation of a new element requires only the specification of c we need to know which c Data affects the residuals(and hence the Jacobian matrix). For a \c GeneralisedElement such \c Data exists in two forms</div></div>
<div class="ttc" id="aclassoomph_1_1SpaceTimeNavierStokesEquations_html_ac966383ce1d6eb706a84cfb762cd3c9f"><div class="ttname"><a href="classoomph_1_1SpaceTimeNavierStokesEquations.html#ac966383ce1d6eb706a84cfb762cd3c9f">oomph::SpaceTimeNavierStokesEquations::re_st_pt</a></div><div class="ttdeci">double * re_st_pt() const</div><div class="ttdoc">Pointer to Strouhal parameter (const. version)</div><div class="ttdef"><b>Definition:</b> <a href="spacetime__navier__stokes__elements_8h_source.html#l00907">spacetime_navier_stokes_elements.h:907</a></div></div>
<div class="ttc" id="aclassoomph_1_1FaceElement_html_a478d577ac6db67ecc80f1f02ae3ab170"><div class="ttname"><a href="classoomph_1_1FaceElement.html#a478d577ac6db67ecc80f1f02ae3ab170">oomph::FaceElement::face_index</a></div><div class="ttdeci">int &amp; face_index()</div><div class="ttdoc">Index of the face (a number that uniquely identifies the face in the element)</div><div class="ttdef"><b>Definition:</b> <a href="elements_8h_source.html#l04692">elements.h:4692</a></div></div>
<div class="ttc" id="aclassoomph_1_1FiniteElement_html_a4986a443968d3741fde4d6c6012cd586"><div class="ttname"><a href="classoomph_1_1FiniteElement.html#a4986a443968d3741fde4d6c6012cd586">oomph::FiniteElement::size</a></div><div class="ttdeci">double size() const</div><div class="ttdef"><b>Definition:</b> <a href="elements_8cc_source.html#l04294">elements.cc:4294</a></div></div>
<div class="ttc" id="aclassoomph_1_1FiniteElement_html_a28ae3eb7760edc5c9d6427611d8e6fb6"><div class="ttname"><a href="classoomph_1_1FiniteElement.html#a28ae3eb7760edc5c9d6427611d8e6fb6">oomph::FiniteElement::node_pt</a></div><div class="ttdeci">Node *&amp; node_pt(const unsigned &amp;n)</div><div class="ttdoc">Return a pointer to the local node n.</div><div class="ttdef"><b>Definition:</b> <a href="elements_8h_source.html#l02192">elements.h:2192</a></div></div>
<div class="ttc" id="aclassoomph_1_1SpaceTimeNavierStokesEquations_html_a86f9883b590636180cbf51216d3c5fa8"><div class="ttname"><a href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a86f9883b590636180cbf51216d3c5fa8">oomph::SpaceTimeNavierStokesEquations::Pressure_not_stored_at_node</a></div><div class="ttdeci">static int Pressure_not_stored_at_node</div><div class="ttdoc">Static &quot;magic&quot; number that indicates that the pressure is not stored at a node.</div><div class="ttdef"><b>Definition:</b> <a href="discontinuous__galerkin__equal__order__pressure__spacetime__navier__stokes__elements_8h_source.html#l00493">discontinuous_galerkin_equal_order_pressure_spacetime_navier_stokes_elements.h:493</a></div></div>
<div class="ttc" id="aclassoomph_1_1SpaceTimeNavierStokesEquations_html_aa9df5d7cf021441edc90347febe43621"><div class="ttname"><a href="classoomph_1_1SpaceTimeNavierStokesEquations.html#aa9df5d7cf021441edc90347febe43621">oomph::SpaceTimeNavierStokesEquations::source_fct_for_pressure_adv_diff</a></div><div class="ttdeci">NavierStokesPressureAdvDiffSourceFctPt source_fct_for_pressure_adv_diff() const</div><div class="ttdoc">Access function for the source-function pointer for pressure advection diffusion (used for validation...</div><div class="ttdef"><b>Definition:</b> <a href="spacetime__navier__stokes__elements_8h_source.html#l01021">spacetime_navier_stokes_elements.h:1021</a></div></div>
<div class="ttc" id="aclassoomph_1_1SpaceTimeNavierStokesEquations_html_abc954710873355daeeb3ef3c9720ab56"><div class="ttname"><a href="classoomph_1_1SpaceTimeNavierStokesEquations.html#abc954710873355daeeb3ef3c9720ab56">oomph::SpaceTimeNavierStokesEquations::pshape_nst</a></div><div class="ttdeci">virtual void pshape_nst(const Vector&lt; double &gt; &amp;s, Shape &amp;psi) const =0</div><div class="ttdoc">Compute the pressure shape functions at local coordinate s.</div></div>
<div class="ttc" id="aclassoomph_1_1SpaceTimeNavierStokesEquations_html_a62bbb12fbdca3282eac98d110c2699ba"><div class="ttname"><a href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a62bbb12fbdca3282eac98d110c2699ba">oomph::SpaceTimeNavierStokesEquations::source_fct_pt</a></div><div class="ttdeci">NavierStokesSourceFctPt source_fct_pt() const</div><div class="ttdoc">Access function for the source-function pointer. Const version.</div><div class="ttdef"><b>Definition:</b> <a href="spacetime__navier__stokes__elements_8h_source.html#l01007">spacetime_navier_stokes_elements.h:1007</a></div></div>
<div class="ttc" id="aclassoomph_1_1QElement_html"><div class="ttname"><a href="classoomph_1_1QElement.html">oomph::QElement</a></div><div class="ttdef"><b>Definition:</b> <a href="Qelements_8h_source.html#l00476">Qelements.h:476</a></div></div>
<div class="ttc" id="aclassoomph_1_1SpaceTimeNavierStokesEquations_html_aff570df80204a77f5c999573d4f2cb6d"><div class="ttname"><a href="classoomph_1_1SpaceTimeNavierStokesEquations.html#aff570df80204a77f5c999573d4f2cb6d">oomph::SpaceTimeNavierStokesEquations::get_du_dt</a></div><div class="ttdeci">double get_du_dt(const unsigned &amp;n, const unsigned &amp;i) const</div><div class="ttdoc">i-th component of du/dt at local node n. Uses suitably interpolated value for hanging nodes....</div><div class="ttdef"><b>Definition:</b> <a href="spacetime__navier__stokes__elements_8h_source.html#l01120">spacetime_navier_stokes_elements.h:1120</a></div></div>
<div class="ttc" id="aclassoomph_1_1FiniteElement_html_aaf7bead5b462cfd5401d97b3dbdc7af7"><div class="ttname"><a href="classoomph_1_1FiniteElement.html#aaf7bead5b462cfd5401d97b3dbdc7af7">oomph::FiniteElement::build_face_element</a></div><div class="ttdeci">virtual void build_face_element(const int &amp;face_index, FaceElement *face_element_pt)</div><div class="ttdoc">Function for building a lower dimensional FaceElement on the specified face of the FiniteElement....</div><div class="ttdef"><b>Definition:</b> <a href="elements_8cc_source.html#l05136">elements.cc:5136</a></div></div>
<div class="ttc" id="aclassoomph_1_1TemplateFreeSpaceTimeNavierStokesEquationsBase_html_ad14f587cd6a139bf513a0fb72b8a7d0d"><div class="ttname"><a href="classoomph_1_1TemplateFreeSpaceTimeNavierStokesEquationsBase.html#ad14f587cd6a139bf513a0fb72b8a7d0d">oomph::TemplateFreeSpaceTimeNavierStokesEquationsBase::pin_all_non_pressure_dofs</a></div><div class="ttdeci">virtual void pin_all_non_pressure_dofs(std::map&lt; Data *, std::vector&lt; int &gt;&gt; &amp;eqn_number_backup)=0</div><div class="ttdoc">Pin all non-pressure dofs and backup eqn numbers of all Data.</div></div>
<div class="ttc" id="aclassoomph_1_1GeneralisedElement_html_a45e32d895d4b3686e0f15fe455f4ed44"><div class="ttname"><a href="classoomph_1_1GeneralisedElement.html#a45e32d895d4b3686e0f15fe455f4ed44">oomph::GeneralisedElement::internal_data_pt</a></div><div class="ttdeci">Data *&amp; internal_data_pt(const unsigned &amp;i)</div><div class="ttdoc">Return a pointer to i-th internal data object.</div><div class="ttdef"><b>Definition:</b> <a href="elements_8h_source.html#l00628">elements.h:628</a></div></div>
<div class="ttc" id="aclassoomph_1_1QTaylorHoodSpaceTimeElement_html_ab3431e43e59e435a5bd9d4c892657574"><div class="ttname"><a href="classoomph_1_1QTaylorHoodSpaceTimeElement.html#ab3431e43e59e435a5bd9d4c892657574">oomph::QTaylorHoodSpaceTimeElement::identify_pressure_data</a></div><div class="ttdeci">void identify_pressure_data(std::set&lt; std::pair&lt; Data *, unsigned &gt;&gt; &amp;paired_pressure_data)</div><div class="ttdoc">Add to the set paired_pressure_data pairs containing.</div><div class="ttdef"><b>Definition:</b> <a href="discontinuous__galerkin__equal__order__pressure__spacetime__navier__stokes__elements_8cc_source.html#l03040">discontinuous_galerkin_equal_order_pressure_spacetime_navier_stokes_elements.cc:3040</a></div></div>
<div class="ttc" id="aclassoomph_1_1FaceGeometry_3_01ProjectableTaylorHoodSpaceTimeElement_3_01ELEMENT_01_4_01_4_html_a446b3497a84914c0ef866765ce06c9ba"><div class="ttname"><a href="classoomph_1_1FaceGeometry_3_01ProjectableTaylorHoodSpaceTimeElement_3_01ELEMENT_01_4_01_4.html#a446b3497a84914c0ef866765ce06c9ba">oomph::FaceGeometry&lt; ProjectableTaylorHoodSpaceTimeElement&lt; ELEMENT &gt; &gt;::FaceGeometry</a></div><div class="ttdeci">FaceGeometry()</div><div class="ttdef"><b>Definition:</b> <a href="spacetime__navier__stokes__elements_8h_source.html#l02865">spacetime_navier_stokes_elements.h:2865</a></div></div>
<div class="ttc" id="aclassoomph_1_1FiniteElement_html"><div class="ttname"><a href="classoomph_1_1FiniteElement.html">oomph::FiniteElement</a></div><div class="ttdoc">A general Finite Element class.</div><div class="ttdef"><b>Definition:</b> <a href="elements_8h_source.html#l01318">elements.h:1318</a></div></div>
<div class="ttc" id="aclassoomph_1_1SpaceTimeNavierStokesEquations_html_a10b04d829e519097da22821781706632"><div class="ttname"><a href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a10b04d829e519097da22821781706632">oomph::SpaceTimeNavierStokesEquations::disable_ALE</a></div><div class="ttdeci">void disable_ALE()</div><div class="ttdoc">Disable ALE, i.e. assert the mesh is not moving  you do this at your own risk!</div><div class="ttdef"><b>Definition:</b> <a href="spacetime__navier__stokes__elements_8h_source.html#l01180">spacetime_navier_stokes_elements.h:1180</a></div></div>
<div class="ttc" id="aclassoomph_1_1OomphLibError_html"><div class="ttname"><a href="classoomph_1_1OomphLibError.html">oomph::OomphLibError</a></div><div class="ttdef"><b>Definition:</b> <a href="oomph__definitions_8h_source.html#l00221">oomph_definitions.h:221</a></div></div>
<div class="ttc" id="aclassoomph_1_1SpaceTimeNavierStokesEquations_html_abb146a5b6d0b34bcb5ca6c43488bf5e0"><div class="ttname"><a href="classoomph_1_1SpaceTimeNavierStokesEquations.html#abb146a5b6d0b34bcb5ca6c43488bf5e0">oomph::SpaceTimeNavierStokesEquations::pressure_integral</a></div><div class="ttdeci">double pressure_integral() const</div><div class="ttdoc">Integral of pressure over element.</div><div class="ttdef"><b>Definition:</b> <a href="discontinuous__galerkin__equal__order__pressure__spacetime__navier__stokes__elements_8cc_source.html#l01765">discontinuous_galerkin_equal_order_pressure_spacetime_navier_stokes_elements.cc:1765</a></div></div>
<div class="ttc" id="aclassoomph_1_1SpaceTimeNavierStokesEquations_html_a04f328da44f58073d590443cfa66ef33"><div class="ttname"><a href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a04f328da44f58073d590443cfa66ef33">oomph::SpaceTimeNavierStokesEquations::body_force_fct_pt</a></div><div class="ttdeci">NavierStokesBodyForceFctPt &amp; body_force_fct_pt()</div><div class="ttdoc">Access function for the body-force pointer.</div><div class="ttdef"><b>Definition:</b> <a href="spacetime__navier__stokes__elements_8h_source.html#l00989">spacetime_navier_stokes_elements.h:989</a></div></div>
<div class="ttc" id="aclassoomph_1_1SpaceTimeNavierStokesEquations_html_a8d01f9f1f54ffcea725965ba9282619c"><div class="ttname"><a href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a8d01f9f1f54ffcea725965ba9282619c">oomph::SpaceTimeNavierStokesEquations::dissipation</a></div><div class="ttdeci">double dissipation() const</div><div class="ttdoc">Return integral of dissipation over element.</div><div class="ttdef"><b>Definition:</b> <a href="discontinuous__galerkin__equal__order__pressure__spacetime__navier__stokes__elements_8cc_source.html#l01305">discontinuous_galerkin_equal_order_pressure_spacetime_navier_stokes_elements.cc:1305</a></div></div>
<div class="ttc" id="aclassoomph_1_1FiniteElement_html_a5a9c1ead9819cd17603096e63087020f"><div class="ttname"><a href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">oomph::FiniteElement::interpolated_x</a></div><div class="ttdeci">virtual double interpolated_x(const Vector&lt; double &gt; &amp;s, const unsigned &amp;i) const</div><div class="ttdoc">Return FE interpolated coordinate x[i] at local coordinate s.</div><div class="ttdef"><b>Definition:</b> <a href="elements_8cc_source.html#l03966">elements.cc:3966</a></div></div>
<div class="ttc" id="aclassoomph_1_1SpaceTimeNavierStokesEquations_html_a9c4931e7df782e6fbea78b5b7701eaeb"><div class="ttname"><a href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a9c4931e7df782e6fbea78b5b7701eaeb">oomph::SpaceTimeNavierStokesEquations::scalar_value_fct_paraview</a></div><div class="ttdeci">void scalar_value_fct_paraview(std::ofstream &amp;file_out, const unsigned &amp;i, const unsigned &amp;nplot, const double &amp;time, FiniteElement::UnsteadyExactSolutionFctPt exact_soln_pt) const</div><div class="ttdoc">Write values of the i-th scalar field at the plot points. Needs to be implemented for each new specif...</div><div class="ttdef"><b>Definition:</b> <a href="spacetime__navier__stokes__elements_8h_source.html#l01347">spacetime_navier_stokes_elements.h:1347</a></div></div>
<div class="ttc" id="aclassoomph_1_1FiniteElement_html_a690fd33af26cc3e84f39bba6d5a85202"><div class="ttname"><a href="classoomph_1_1FiniteElement.html#a690fd33af26cc3e84f39bba6d5a85202">oomph::FiniteElement::SteadyExactSolutionFctPt</a></div><div class="ttdeci">void(* SteadyExactSolutionFctPt)(const Vector&lt; double &gt; &amp;, Vector&lt; double &gt; &amp;)</div><div class="ttdoc">Function pointer for function that computes vector-valued steady &quot;exact solution&quot;  as .</div><div class="ttdef"><b>Definition:</b> <a href="elements_8h_source.html#l01770">elements.h:1770</a></div></div>
<div class="ttc" id="aclassoomph_1_1QTaylorHoodSpaceTimeElement_html_a48213eb3a18f3f0db23a45635e6d67d0"><div class="ttname"><a href="classoomph_1_1QTaylorHoodSpaceTimeElement.html#a48213eb3a18f3f0db23a45635e6d67d0">oomph::QTaylorHoodSpaceTimeElement::pshape_nst</a></div><div class="ttdeci">void pshape_nst(const Vector&lt; double &gt; &amp;s, Shape &amp;psi) const</div><div class="ttdoc">Pressure shape functions at local coordinate s.</div></div>
<div class="ttc" id="aclassoomph_1_1GeneralisedElement_html_a6b736de0af4c92831968636479b3480e"><div class="ttname"><a href="classoomph_1_1GeneralisedElement.html#a6b736de0af4c92831968636479b3480e">oomph::GeneralisedElement::ninternal_data</a></div><div class="ttdeci">unsigned ninternal_data() const</div><div class="ttdoc">Return the number of internal data objects.</div><div class="ttdef"><b>Definition:</b> <a href="elements_8h_source.html#l00829">elements.h:829</a></div></div>
<div class="ttc" id="aclassoomph_1_1SpaceTimeNavierStokesEquations_html_a34278c0387e27b8adeaec08aa8e03f66"><div class="ttname"><a href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a34278c0387e27b8adeaec08aa8e03f66">oomph::SpaceTimeNavierStokesEquations::compute_norm</a></div><div class="ttdeci">void compute_norm(Vector&lt; double &gt; &amp;norm)</div><div class="ttdoc">Compute the vector norm of the FEM solution.</div><div class="ttdef"><b>Definition:</b> <a href="discontinuous__galerkin__equal__order__pressure__spacetime__navier__stokes__elements_8cc_source.html#l00195">discontinuous_galerkin_equal_order_pressure_spacetime_navier_stokes_elements.cc:195</a></div></div>
<div class="ttc" id="aclassoomph_1_1SpaceTimeNavierStokesEquations_html_a56d0af18eeafae506578a4182f08f461"><div class="ttname"><a href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a56d0af18eeafae506578a4182f08f461">oomph::SpaceTimeNavierStokesEquations::fill_in_contribution_to_hessian_vector_products</a></div><div class="ttdeci">void fill_in_contribution_to_hessian_vector_products(Vector&lt; double &gt; const &amp;Y, DenseMatrix&lt; double &gt; const &amp;C, DenseMatrix&lt; double &gt; &amp;product)</div><div class="ttdoc">Compute the hessian tensor vector products required to perform continuation of bifurcations analytica...</div><div class="ttdef"><b>Definition:</b> <a href="discontinuous__galerkin__equal__order__pressure__spacetime__navier__stokes__elements_8cc_source.html#l02462">discontinuous_galerkin_equal_order_pressure_spacetime_navier_stokes_elements.cc:2462</a></div></div>
<div class="ttc" id="aclassoomph_1_1FpPressureAdvDiffRobinBCSpaceTimeElement_html_a81f3c854938a1d179b13798f0fc941d4"><div class="ttname"><a href="classoomph_1_1FpPressureAdvDiffRobinBCSpaceTimeElement.html#a81f3c854938a1d179b13798f0fc941d4">oomph::FpPressureAdvDiffRobinBCSpaceTimeElement::~FpPressureAdvDiffRobinBCSpaceTimeElement</a></div><div class="ttdeci">~FpPressureAdvDiffRobinBCSpaceTimeElement()</div><div class="ttdoc">Empty destructor.</div><div class="ttdef"><b>Definition:</b> <a href="spacetime__navier__stokes__elements_8h_source.html#l00134">spacetime_navier_stokes_elements.h:134</a></div></div>
<div class="ttc" id="aclassoomph_1_1TemplateFreeSpaceTimeNavierStokesEquationsBase_html_a9394db2cd4884114c269f27fcd4371d7"><div class="ttname"><a href="classoomph_1_1TemplateFreeSpaceTimeNavierStokesEquationsBase.html#a9394db2cd4884114c269f27fcd4371d7">oomph::TemplateFreeSpaceTimeNavierStokesEquationsBase::TemplateFreeSpaceTimeNavierStokesEquationsBase</a></div><div class="ttdeci">TemplateFreeSpaceTimeNavierStokesEquationsBase()</div><div class="ttdoc">Constructor (empty)</div><div class="ttdef"><b>Definition:</b> <a href="spacetime__navier__stokes__elements_8h_source.html#l00368">spacetime_navier_stokes_elements.h:368</a></div></div>
<div class="ttc" id="aclassoomph_1_1SpaceTimeNavierStokesEquations_html_a8ea25af36d4683982003e1e2597d4ca0"><div class="ttname"><a href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a8ea25af36d4683982003e1e2597d4ca0">oomph::SpaceTimeNavierStokesEquations::fill_in_pressure_advection_diffusion_residuals</a></div><div class="ttdeci">void fill_in_pressure_advection_diffusion_residuals(Vector&lt; double &gt; &amp;residuals)</div><div class="ttdoc">Compute the residuals for the associated pressure advection diffusion problem. Used by the Fp precond...</div><div class="ttdef"><b>Definition:</b> <a href="spacetime__navier__stokes__elements_8h_source.html#l01693">spacetime_navier_stokes_elements.h:1693</a></div></div>
<div class="ttc" id="aclassoomph_1_1FiniteElement_html_a751dc02ff1325f799840d79ee415753a"><div class="ttname"><a href="classoomph_1_1FiniteElement.html#a751dc02ff1325f799840d79ee415753a">oomph::FiniteElement::integral_pt</a></div><div class="ttdeci">Integral *const  &amp; integral_pt() const</div><div class="ttdoc">Return the pointer to the integration scheme (const version)</div><div class="ttdef"><b>Definition:</b> <a href="elements_8h_source.html#l01980">elements.h:1980</a></div></div>
<div class="ttc" id="aclassoomph_1_1FaceElement_html_a7aa612fec3604e08344503fbcdc357c8"><div class="ttname"><a href="classoomph_1_1FaceElement.html#a7aa612fec3604e08344503fbcdc357c8">oomph::FaceElement::interpolated_x</a></div><div class="ttdeci">double interpolated_x(const Vector&lt; double &gt; &amp;s, const unsigned &amp;i) const</div><div class="ttdoc">Return FE interpolated coordinate x[i] at local coordinate s. Overloaded to get information from bulk...</div><div class="ttdef"><b>Definition:</b> <a href="elements_8h_source.html#l04594">elements.h:4594</a></div></div>
<div class="ttc" id="aclassoomph_1_1Vector_html_ad526bb1acccf11b485ebe12c9cde44fd"><div class="ttname"><a href="classoomph_1_1Vector.html#ad526bb1acccf11b485ebe12c9cde44fd">oomph::Vector::initialise</a></div><div class="ttdeci">void initialise(const _Tp &amp;__value)</div><div class="ttdoc">Iterate over all values and set to the desired value.</div><div class="ttdef"><b>Definition:</b> <a href="Vector_8h_source.html#l00160">Vector.h:160</a></div></div>
<div class="ttc" id="aclassoomph_1_1SpaceTimeNavierStokesEquations_html_a0b2453a95e142257c468ec07c65e1414"><div class="ttname"><a href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a0b2453a95e142257c468ec07c65e1414">oomph::SpaceTimeNavierStokesEquations::dinterpolated_u_nst_ddata</a></div><div class="ttdeci">virtual void dinterpolated_u_nst_ddata(const Vector&lt; double &gt; &amp;s, const unsigned &amp;i, Vector&lt; double &gt; &amp;du_ddata, Vector&lt; unsigned &gt; &amp;global_eqn_number)</div><div class="ttdoc">Compute the derivatives of the i-th component of velocity at point s with respect to all data that ca...</div><div class="ttdef"><b>Definition:</b> <a href="spacetime__navier__stokes__elements_8h_source.html#l01957">spacetime_navier_stokes_elements.h:1957</a></div></div>
<div class="ttc" id="aclassoomph_1_1SpaceTimeNavierStokesEquations_html_a88f21358f5a602481a01c84570892150"><div class="ttname"><a href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a88f21358f5a602481a01c84570892150">oomph::SpaceTimeNavierStokesEquations::get_body_force_nst</a></div><div class="ttdeci">virtual void get_body_force_nst(const double &amp;time, const unsigned &amp;ipt, const Vector&lt; double &gt; &amp;s, const Vector&lt; double &gt; &amp;x, Vector&lt; double &gt; &amp;result)</div><div class="ttdoc">Calculate the body force at a given time and local and/or Eulerian position. This function is virtual...</div><div class="ttdef"><b>Definition:</b> <a href="spacetime__navier__stokes__elements_8h_source.html#l00609">spacetime_navier_stokes_elements.h:609</a></div></div>
<div class="ttc" id="aclassoomph_1_1Data_html"><div class="ttname"><a href="classoomph_1_1Data.html">oomph::Data</a></div><div class="ttdoc">A class that represents a collection of data; each Data object may contain many different individual ...</div><div class="ttdef"><b>Definition:</b> <a href="nodes_8h_source.html#l00085">nodes.h:85</a></div></div>
<div class="ttc" id="aclassoomph_1_1SpaceTimeNavierStokesEquations_html_a7002ecb67fc50de0f7824c95353aee2c"><div class="ttname"><a href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a7002ecb67fc50de0f7824c95353aee2c">oomph::SpaceTimeNavierStokesEquations::ReynoldsStrouhal_is_stored_as_external_data</a></div><div class="ttdeci">bool ReynoldsStrouhal_is_stored_as_external_data</div><div class="ttdoc">Boolean to indicate whether or not the Strouhal value is stored as external data (if it's also an unk...</div><div class="ttdef"><b>Definition:</b> <a href="spacetime__navier__stokes__elements_8h_source.html#l00527">spacetime_navier_stokes_elements.h:527</a></div></div>
<div class="ttc" id="aclassoomph_1_1QTaylorHoodSpaceTimeElement_html_a734f37204be71a51958da81ecfab0b44"><div class="ttname"><a href="classoomph_1_1QTaylorHoodSpaceTimeElement.html#a734f37204be71a51958da81ecfab0b44">oomph::QTaylorHoodSpaceTimeElement::output</a></div><div class="ttdeci">void output(std::ostream &amp;outfile, const unsigned &amp;nplot)</div><div class="ttdoc">Redirect output to NavierStokesEquations output.</div><div class="ttdef"><b>Definition:</b> <a href="spacetime__navier__stokes__elements_8h_source.html#l02277">spacetime_navier_stokes_elements.h:2277</a></div></div>
<div class="ttc" id="aclassoomph_1_1SpaceTimeNavierStokesEquations_html_a3310817460a8301d3eba3f68a2399a2a"><div class="ttname"><a href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a3310817460a8301d3eba3f68a2399a2a">oomph::SpaceTimeNavierStokesEquations::p_nodal_index_nst</a></div><div class="ttdeci">virtual int p_nodal_index_nst() const</div><div class="ttdoc">Return the index at which the pressure is stored if it is stored at the nodes. If not stored at the n...</div><div class="ttdef"><b>Definition:</b> <a href="spacetime__navier__stokes__elements_8h_source.html#l01209">spacetime_navier_stokes_elements.h:1209</a></div></div>
<div class="ttc" id="aclassoomph_1_1SpaceTimeNavierStokesEquations_html_a63751b26f0427c4a09f32c0f49ce410b"><div class="ttname"><a href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a63751b26f0427c4a09f32c0f49ce410b">oomph::SpaceTimeNavierStokesEquations::fill_in_contribution_to_residuals</a></div><div class="ttdeci">void fill_in_contribution_to_residuals(Vector&lt; double &gt; &amp;residuals)</div><div class="ttdoc">Compute the element's residual Vector.</div><div class="ttdef"><b>Definition:</b> <a href="spacetime__navier__stokes__elements_8h_source.html#l01586">spacetime_navier_stokes_elements.h:1586</a></div></div>
<div class="ttc" id="aclassoomph_1_1QTaylorHoodSpaceTimeElement_html_a7ca4887e4e194347f9283bf3a6bc1c30"><div class="ttname"><a href="classoomph_1_1QTaylorHoodSpaceTimeElement.html#a7ca4887e4e194347f9283bf3a6bc1c30">oomph::QTaylorHoodSpaceTimeElement::required_nvalue</a></div><div class="ttdeci">virtual unsigned required_nvalue(const unsigned &amp;n) const</div><div class="ttdoc">Number of values (pinned or dofs) required at node n. Can be overwritten for hanging node version.</div><div class="ttdef"><b>Definition:</b> <a href="spacetime__navier__stokes__elements_8h_source.html#l02161">spacetime_navier_stokes_elements.h:2161</a></div></div>
<div class="ttc" id="aclassoomph_1_1SpaceTimeNavierStokesEquations_html_a5efa373b087faff024f969e21f928da3"><div class="ttname"><a href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a5efa373b087faff024f969e21f928da3">oomph::SpaceTimeNavierStokesEquations::point_output_data</a></div><div class="ttdeci">void point_output_data(const Vector&lt; double &gt; &amp;s, Vector&lt; double &gt; &amp;data)</div><div class="ttdoc">Output solution in data vector at local cordinates s: x,y,z,u,v,p.</div><div class="ttdef"><b>Definition:</b> <a href="spacetime__navier__stokes__elements_8h_source.html#l02061">spacetime_navier_stokes_elements.h:2061</a></div></div>
<div class="ttc" id="aclassoomph_1_1SpaceTimeNavierStokesEquations_html_a7eaf18987c79fe9443d80817ab7946a5"><div class="ttname"><a href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a7eaf18987c79fe9443d80817ab7946a5">oomph::SpaceTimeNavierStokesEquations::g</a></div><div class="ttdeci">const Vector&lt; double &gt; &amp; g() const</div><div class="ttdoc">Vector of gravitational components.</div><div class="ttdef"><b>Definition:</b> <a href="spacetime__navier__stokes__elements_8h_source.html#l00977">spacetime_navier_stokes_elements.h:977</a></div></div>
<div class="ttc" id="aclassoomph_1_1FiniteElement_html_a9296c17b134688049256a4bbc886df69"><div class="ttname"><a href="classoomph_1_1FiniteElement.html#a9296c17b134688049256a4bbc886df69">oomph::FiniteElement::dshape_eulerian</a></div><div class="ttdeci">double dshape_eulerian(const Vector&lt; double &gt; &amp;s, Shape &amp;psi, DShape &amp;dpsidx) const</div><div class="ttdoc">Compute the geometric shape functions and also first derivatives w.r.t. global coordinates at local c...</div><div class="ttdef"><b>Definition:</b> <a href="elements_8cc_source.html#l03302">elements.cc:3302</a></div></div>
<div class="ttc" id="aclassoomph_1_1SpaceTimeNavierStokesEquations_html_ae5fd589366af34e7d1d3a6ffa17a23e5"><div class="ttname"><a href="classoomph_1_1SpaceTimeNavierStokesEquations.html#ae5fd589366af34e7d1d3a6ffa17a23e5">oomph::SpaceTimeNavierStokesEquations::get_source_gradient_nst</a></div><div class="ttdeci">virtual void get_source_gradient_nst(const double &amp;time, const unsigned &amp;ipt, const Vector&lt; double &gt; &amp;x, Vector&lt; double &gt; &amp;gradient)</div><div class="ttdef"><b>Definition:</b> <a href="spacetime__navier__stokes__elements_8h_source.html#l00704">spacetime_navier_stokes_elements.h:704</a></div></div>
<div class="ttc" id="aclassoomph_1_1SpaceTimeNavierStokesEquations_html_ada4e33929cfd12eea638103a37e9f909"><div class="ttname"><a href="classoomph_1_1SpaceTimeNavierStokesEquations.html#ada4e33929cfd12eea638103a37e9f909">oomph::SpaceTimeNavierStokesEquations::get_body_force_gradient_nst</a></div><div class="ttdeci">virtual void get_body_force_gradient_nst(const double &amp;time, const unsigned &amp;ipt, const Vector&lt; double &gt; &amp;s, const Vector&lt; double &gt; &amp;x, DenseMatrix&lt; double &gt; &amp;d_body_force_dx)</div><div class="ttdef"><b>Definition:</b> <a href="spacetime__navier__stokes__elements_8h_source.html#l00635">spacetime_navier_stokes_elements.h:635</a></div></div>
<div class="ttc" id="aclassoomph_1_1FpPressureAdvDiffRobinBCSpaceTimeElement_html_ab40e86a29f6e744e1c452e16a1712508"><div class="ttname"><a href="classoomph_1_1FpPressureAdvDiffRobinBCSpaceTimeElement.html#ab40e86a29f6e744e1c452e16a1712508">oomph::FpPressureAdvDiffRobinBCSpaceTimeElement::fill_in_contribution_to_jacobian</a></div><div class="ttdeci">void fill_in_contribution_to_jacobian(Vector&lt; double &gt; &amp;residuals, DenseMatrix&lt; double &gt; &amp;jacobian)</div><div class="ttdoc">This function returns the residuals and the jacobian.</div><div class="ttdef"><b>Definition:</b> <a href="spacetime__navier__stokes__elements_8h_source.html#l00165">spacetime_navier_stokes_elements.h:165</a></div></div>
<div class="ttc" id="aclassoomph_1_1QTaylorHoodSpaceTimeElement_html_aa2bdb098066efbfa2347d437c79e5864"><div class="ttname"><a href="classoomph_1_1QTaylorHoodSpaceTimeElement.html#aa2bdb098066efbfa2347d437c79e5864">oomph::QTaylorHoodSpaceTimeElement::identify_load_data</a></div><div class="ttdeci">void identify_load_data(std::set&lt; std::pair&lt; Data *, unsigned &gt;&gt; &amp;paired_load_data)</div><div class="ttdoc">Add to the set paired_load_data pairs containing.</div><div class="ttdef"><b>Definition:</b> <a href="discontinuous__galerkin__equal__order__pressure__spacetime__navier__stokes__elements_8cc_source.html#l02998">discontinuous_galerkin_equal_order_pressure_spacetime_navier_stokes_elements.cc:2998</a></div></div>
<div class="ttc" id="aclassoomph_1_1SpaceTimeNavierStokesEquations_html_a72a0b348de77b1855d47429dd7430682"><div class="ttname"><a href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a72a0b348de77b1855d47429dd7430682">oomph::SpaceTimeNavierStokesEquations::fill_in_contribution_to_jacobian_and_mass_matrix</a></div><div class="ttdeci">void fill_in_contribution_to_jacobian_and_mass_matrix(Vector&lt; double &gt; &amp;residuals, DenseMatrix&lt; double &gt; &amp;jacobian, DenseMatrix&lt; double &gt; &amp;mass_matrix)</div><div class="ttdoc">Add the element's contribution to its residuals vector, jacobian matrix and mass matrix.</div><div class="ttdef"><b>Definition:</b> <a href="spacetime__navier__stokes__elements_8h_source.html#l01619">spacetime_navier_stokes_elements.h:1619</a></div></div>
<div class="ttc" id="aclassoomph_1_1GeneralisedElement_html_a156163c9f6fbd17548a9fa836616d19b"><div class="ttname"><a href="classoomph_1_1GeneralisedElement.html#a156163c9f6fbd17548a9fa836616d19b">oomph::GeneralisedElement::Default_fd_jacobian_step</a></div><div class="ttdeci">static double Default_fd_jacobian_step</div><div class="ttdoc">Double used for the default finite difference step in elemental jacobian calculations.</div><div class="ttdef"><b>Definition:</b> <a href="elements_8h_source.html#l01204">elements.h:1204</a></div></div>
<div class="ttc" id="aclassoomph_1_1QTaylorHoodSpaceTimeElement_html_a83f431d9c59396253ff1c58175cc1f68"><div class="ttname"><a href="classoomph_1_1QTaylorHoodSpaceTimeElement.html#a83f431d9c59396253ff1c58175cc1f68">oomph::QTaylorHoodSpaceTimeElement::p_local_eqn</a></div><div class="ttdeci">int p_local_eqn(const unsigned &amp;n) const</div><div class="ttdoc">Return the local equation numbers for the pressure values.</div><div class="ttdef"><b>Definition:</b> <a href="spacetime__navier__stokes__elements_8h_source.html#l02187">spacetime_navier_stokes_elements.h:2187</a></div></div>
<div class="ttc" id="aclassoomph_1_1FpPressureAdvDiffRobinBCSpaceTimeElement_html_a5872f914409c2a251992775d3bad8584"><div class="ttname"><a href="classoomph_1_1FpPressureAdvDiffRobinBCSpaceTimeElement.html#a5872f914409c2a251992775d3bad8584">oomph::FpPressureAdvDiffRobinBCSpaceTimeElement::fill_in_generic_residual_contribution_fp_press_adv_diff_robin_bc</a></div><div class="ttdeci">virtual void fill_in_generic_residual_contribution_fp_press_adv_diff_robin_bc(Vector&lt; double &gt; &amp;residuals, DenseMatrix&lt; double &gt; &amp;jacobian, const unsigned &amp;flag)</div><div class="ttdoc">This function returns the residuals for the traction function. flag=1 (or 0): do (or don't) compute t...</div><div class="ttdef"><b>Definition:</b> <a href="discontinuous__galerkin__equal__order__pressure__spacetime__navier__stokes__elements_8h_source.html#l00212">discontinuous_galerkin_equal_order_pressure_spacetime_navier_stokes_elements.h:212</a></div></div>
<div class="ttc" id="aclassoomph_1_1SpaceTimeNavierStokesEquations_html_a9148f8b14cbadffb0eda4ccaa81865f4"><div class="ttname"><a href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a9148f8b14cbadffb0eda4ccaa81865f4">oomph::SpaceTimeNavierStokesEquations::Re_pt</a></div><div class="ttdeci">double * Re_pt</div><div class="ttdoc">Pointer to global Reynolds number.</div><div class="ttdef"><b>Definition:</b> <a href="discontinuous__galerkin__equal__order__pressure__spacetime__navier__stokes__elements_8h_source.html#l00520">discontinuous_galerkin_equal_order_pressure_spacetime_navier_stokes_elements.h:520</a></div></div>
<div class="ttc" id="aclassoomph_1_1Integral_html_a1a270de9d99a1fcf1d25a6c1017f65fa"><div class="ttname"><a href="classoomph_1_1Integral.html#a1a270de9d99a1fcf1d25a6c1017f65fa">oomph::Integral::nweight</a></div><div class="ttdeci">virtual unsigned nweight() const =0</div><div class="ttdoc">Return the number of integration points of the scheme.</div></div>
<div class="ttc" id="aclassoomph_1_1RankThreeTensor_html"><div class="ttname"><a href="classoomph_1_1RankThreeTensor.html">oomph::RankThreeTensor</a></div><div class="ttdoc">A Rank 3 Tensor class.</div><div class="ttdef"><b>Definition:</b> <a href="matrices_8h_source.html#l01398">matrices.h:1398</a></div></div>
<div class="ttc" id="aclassoomph_1_1FpPressureAdvDiffRobinBCSpaceTimeElementBase_html_aac1d335c1c7b46382a958598002108c6"><div class="ttname"><a href="classoomph_1_1FpPressureAdvDiffRobinBCSpaceTimeElementBase.html#aac1d335c1c7b46382a958598002108c6">oomph::FpPressureAdvDiffRobinBCSpaceTimeElementBase::FpPressureAdvDiffRobinBCSpaceTimeElementBase</a></div><div class="ttdeci">FpPressureAdvDiffRobinBCSpaceTimeElementBase()</div><div class="ttdoc">Constructor.</div><div class="ttdef"><b>Definition:</b> <a href="spacetime__navier__stokes__elements_8h_source.html#l00050">spacetime_navier_stokes_elements.h:50</a></div></div>
<div class="ttc" id="aclassoomph_1_1SpaceTimeNavierStokesEquations_html_a3e15de0c9f6d885f35906653c34b7697"><div class="ttname"><a href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a3e15de0c9f6d885f35906653c34b7697">oomph::SpaceTimeNavierStokesEquations::n_u_nst</a></div><div class="ttdeci">unsigned n_u_nst() const</div><div class="ttdef"><b>Definition:</b> <a href="spacetime__navier__stokes__elements_8h_source.html#l01109">spacetime_navier_stokes_elements.h:1109</a></div></div>
<div class="ttc" id="aclassoomph_1_1SpaceTimeNavierStokesEquations_html_a6ef4daae1df889c98d325fa232bb4431"><div class="ttname"><a href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a6ef4daae1df889c98d325fa232bb4431">oomph::SpaceTimeNavierStokesEquations::p_nst</a></div><div class="ttdeci">virtual double p_nst(const unsigned &amp;n_p) const =0</div><div class="ttdoc">Pressure at local pressure &quot;node&quot; n_p Uses suitably interpolated value for hanging nodes.</div></div>
<div class="ttc" id="aclassoomph_1_1FiniteElement_html_af6bc41bed877f6f9a1705d7d375ddfde"><div class="ttname"><a href="classoomph_1_1FiniteElement.html#af6bc41bed877f6f9a1705d7d375ddfde">oomph::FiniteElement::has_hanging_nodes</a></div><div class="ttdeci">bool has_hanging_nodes() const</div><div class="ttdoc">Return boolean to indicate if any of the element's nodes are geometrically hanging.</div><div class="ttdef"><b>Definition:</b> <a href="elements_8h_source.html#l02487">elements.h:2487</a></div></div>
<div class="ttc" id="aclassoomph_1_1Data_html_a7e67fc78a2e8a2fd6eb75bd292d42ff8"><div class="ttname"><a href="classoomph_1_1Data.html#a7e67fc78a2e8a2fd6eb75bd292d42ff8">oomph::Data::nvalue</a></div><div class="ttdeci">unsigned nvalue() const</div><div class="ttdoc">Return number of values stored in data object (incl pinned ones).</div><div class="ttdef"><b>Definition:</b> <a href="nodes_8h_source.html#l00489">nodes.h:489</a></div></div>
<div class="ttc" id="aclassoomph_1_1SpaceTimeNavierStokesEquations_html_adb897d6391666773c5d5bf22b9d9bc83"><div class="ttname"><a href="classoomph_1_1SpaceTimeNavierStokesEquations.html#adb897d6391666773c5d5bf22b9d9bc83">oomph::SpaceTimeNavierStokesEquations::NavierStokesPressureAdvDiffSourceFctPt</a></div><div class="ttdeci">double(* NavierStokesPressureAdvDiffSourceFctPt)(const Vector&lt; double &gt; &amp;x)</div><div class="ttdoc">Function pointer to source function fct(x) for the pressure advection diffusion equation (only used d...</div><div class="ttdef"><b>Definition:</b> <a href="discontinuous__galerkin__equal__order__pressure__spacetime__navier__stokes__elements_8h_source.html#l00487">discontinuous_galerkin_equal_order_pressure_spacetime_navier_stokes_elements.h:487</a></div></div>
<div class="ttc" id="aclassoomph_1_1DenseMatrix_html"><div class="ttname"><a href="classoomph_1_1DenseMatrix.html">oomph::DenseMatrix&lt; double &gt;</a></div></div>
<div class="ttc" id="aclassoomph_1_1QTaylorHoodSpaceTimeElement_html_a35b0de550910ef4f3730ecb3e7c919e5"><div class="ttname"><a href="classoomph_1_1QTaylorHoodSpaceTimeElement.html#a35b0de550910ef4f3730ecb3e7c919e5">oomph::QTaylorHoodSpaceTimeElement::p_nst</a></div><div class="ttdeci">double p_nst(const unsigned &amp;t, const unsigned &amp;n_p) const</div><div class="ttdoc">Access function for the pressure values at local pressure node n_p (const version)</div><div class="ttdef"><b>Definition:</b> <a href="spacetime__navier__stokes__elements_8h_source.html#l02205">spacetime_navier_stokes_elements.h:2205</a></div></div>
<div class="ttc" id="aclassoomph_1_1SpaceTimeNavierStokesEquations_html_a9af8a69fe8cb0b1760063a8f7f9c3aa6"><div class="ttname"><a href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a9af8a69fe8cb0b1760063a8f7f9c3aa6">oomph::SpaceTimeNavierStokesEquations::Source_fct_pt</a></div><div class="ttdeci">NavierStokesSourceFctPt Source_fct_pt</div><div class="ttdoc">Pointer to volumetric source function.</div><div class="ttdef"><b>Definition:</b> <a href="discontinuous__galerkin__equal__order__pressure__spacetime__navier__stokes__elements_8h_source.html#l00540">discontinuous_galerkin_equal_order_pressure_spacetime_navier_stokes_elements.h:540</a></div></div>
<div class="ttc" id="aclassoomph_1_1FpPressureAdvDiffRobinBCSpaceTimeElement_html_a78b2899448a3f8dd7fecc4a3cbd6ad7c"><div class="ttname"><a href="classoomph_1_1FpPressureAdvDiffRobinBCSpaceTimeElement.html#a78b2899448a3f8dd7fecc4a3cbd6ad7c">oomph::FpPressureAdvDiffRobinBCSpaceTimeElement::FpPressureAdvDiffRobinBCSpaceTimeElement</a></div><div class="ttdeci">FpPressureAdvDiffRobinBCSpaceTimeElement(FiniteElement *const &amp;element_pt, const int &amp;face_index, const bool &amp;called_from_refineable_constructor=false)</div><div class="ttdoc">Constructor, which takes a &quot;bulk&quot; element and the value of the index and its limit....</div><div class="ttdef"><b>Definition:</b> <a href="spacetime__navier__stokes__elements_8h_source.html#l00086">spacetime_navier_stokes_elements.h:86</a></div></div>
<div class="ttc" id="aclassoomph_1_1RefineableElement_html"><div class="ttname"><a href="classoomph_1_1RefineableElement.html">oomph::RefineableElement</a></div><div class="ttdef"><b>Definition:</b> <a href="refineable__elements_8h_source.html#l00096">refineable_elements.h:96</a></div></div>
<div class="ttc" id="aclassoomph_1_1SpaceTimeNavierStokesEquations_html_a0f24c5d2a7d39dae9512b7792ec19573"><div class="ttname"><a href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a0f24c5d2a7d39dae9512b7792ec19573">oomph::SpaceTimeNavierStokesEquations::Pinned_fp_pressure_eqn</a></div><div class="ttdeci">int Pinned_fp_pressure_eqn</div><div class="ttdoc">Global eqn number of pressure dof that's pinned in pressure advection diffusion problem (defaults to ...</div><div class="ttdef"><b>Definition:</b> <a href="discontinuous__galerkin__equal__order__pressure__spacetime__navier__stokes__elements_8h_source.html#l00558">discontinuous_galerkin_equal_order_pressure_spacetime_navier_stokes_elements.h:558</a></div></div>
<div class="ttc" id="aclassoomph_1_1SpaceTimeNavierStokesEquations_html_a5c91b059724e42e702420096485e6714"><div class="ttname"><a href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a5c91b059724e42e702420096485e6714">oomph::SpaceTimeNavierStokesEquations::kin_energy</a></div><div class="ttdeci">double kin_energy() const</div><div class="ttdoc">Get integral of kinetic energy over element.</div><div class="ttdef"><b>Definition:</b> <a href="discontinuous__galerkin__equal__order__pressure__spacetime__navier__stokes__elements_8cc_source.html#l01623">discontinuous_galerkin_equal_order_pressure_spacetime_navier_stokes_elements.cc:1623</a></div></div>
<div class="ttc" id="aclassoomph_1_1SpaceTimeNavierStokesEquations_html_af1918b4d6763e12f550596234c640f2a"><div class="ttname"><a href="classoomph_1_1SpaceTimeNavierStokesEquations.html#af1918b4d6763e12f550596234c640f2a">oomph::SpaceTimeNavierStokesEquations::ALE_is_disabled</a></div><div class="ttdeci">bool ALE_is_disabled</div><div class="ttdoc">Boolean flag to indicate if ALE formulation is disabled when time-derivatives are computed....</div><div class="ttdef"><b>Definition:</b> <a href="discontinuous__galerkin__equal__order__pressure__spacetime__navier__stokes__elements_8h_source.html#l00549">discontinuous_galerkin_equal_order_pressure_spacetime_navier_stokes_elements.h:549</a></div></div>
<div class="ttc" id="aclassoomph_1_1TemplateFreeSpaceTimeNavierStokesEquationsBase_html_a0d65b8b47de40a3a41a2c234d6a47718"><div class="ttname"><a href="classoomph_1_1TemplateFreeSpaceTimeNavierStokesEquationsBase.html#a0d65b8b47de40a3a41a2c234d6a47718">oomph::TemplateFreeSpaceTimeNavierStokesEquationsBase::get_pressure_and_velocity_mass_matrix_diagonal</a></div><div class="ttdeci">virtual void get_pressure_and_velocity_mass_matrix_diagonal(Vector&lt; double &gt; &amp;press_mass_diag, Vector&lt; double &gt; &amp;veloc_mass_diag, const unsigned &amp;which_one=0)=0</div><div class="ttdoc">Compute the diagonal of the velocity/pressure mass matrices. If which one=0, both are computed,...</div></div>
<div class="ttc" id="aclassoomph_1_1SpaceTimeNavierStokesEquations_html_a186af0a617c8c79c1eec6503caf30467"><div class="ttname"><a href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a186af0a617c8c79c1eec6503caf30467">oomph::SpaceTimeNavierStokesEquations::Body_force_fct_pt</a></div><div class="ttdeci">NavierStokesBodyForceFctPt Body_force_fct_pt</div><div class="ttdoc">Pointer to body force function.</div><div class="ttdef"><b>Definition:</b> <a href="discontinuous__galerkin__equal__order__pressure__spacetime__navier__stokes__elements_8h_source.html#l00537">discontinuous_galerkin_equal_order_pressure_spacetime_navier_stokes_elements.h:537</a></div></div>
<div class="ttc" id="aclassoomph_1_1SpaceTimeNavierStokesEquations_html_a094b18cc4e05a83f4a43798c1ca0d88e"><div class="ttname"><a href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a094b18cc4e05a83f4a43798c1ca0d88e">oomph::SpaceTimeNavierStokesEquations::get_pressure_and_velocity_mass_matrix_diagonal</a></div><div class="ttdeci">void get_pressure_and_velocity_mass_matrix_diagonal(Vector&lt; double &gt; &amp;press_mass_diag, Vector&lt; double &gt; &amp;veloc_mass_diag, const unsigned &amp;which_one=0)</div><div class="ttdoc">Compute the diagonal of the velocity/pressure mass matrices. If which one=0, both are computed,...</div><div class="ttdef"><b>Definition:</b> <a href="discontinuous__galerkin__equal__order__pressure__spacetime__navier__stokes__elements_8cc_source.html#l00070">discontinuous_galerkin_equal_order_pressure_spacetime_navier_stokes_elements.cc:70</a></div></div>
<div class="ttc" id="aclassoomph_1_1SpaceTimeNavierStokesEquations_html_ae7c142695e37e5bce090c7aa7bd1df02"><div class="ttname"><a href="classoomph_1_1SpaceTimeNavierStokesEquations.html#ae7c142695e37e5bce090c7aa7bd1df02">oomph::SpaceTimeNavierStokesEquations::viscosity_ratio_pt</a></div><div class="ttdeci">double *&amp; viscosity_ratio_pt()</div><div class="ttdoc">Pointer to Viscosity Ratio.</div><div class="ttdef"><b>Definition:</b> <a href="spacetime__navier__stokes__elements_8h_source.html#l00946">spacetime_navier_stokes_elements.h:946</a></div></div>
<div class="ttc" id="aclassoomph_1_1QTaylorHoodSpaceTimeElement_html_a99f1990f0b91016e1c578b3f2d19f5d5"><div class="ttname"><a href="classoomph_1_1QTaylorHoodSpaceTimeElement.html#a99f1990f0b91016e1c578b3f2d19f5d5">oomph::QTaylorHoodSpaceTimeElement::build_fp_press_adv_diff_robin_bc_element</a></div><div class="ttdeci">void build_fp_press_adv_diff_robin_bc_element(const unsigned &amp;face_index)</div><div class="ttdoc">Build FaceElements that apply the Robin boundary condition to the pressure advection diffusion proble...</div><div class="ttdef"><b>Definition:</b> <a href="spacetime__navier__stokes__elements_8h_source.html#l02236">spacetime_navier_stokes_elements.h:2236</a></div></div>
<div class="ttc" id="aclassoomph_1_1FiniteElement_html_a22bc4ee35e4f948d8d7fba18c7b4f4c4"><div class="ttname"><a href="classoomph_1_1FiniteElement.html#a22bc4ee35e4f948d8d7fba18c7b4f4c4">oomph::FiniteElement::local_coordinate_of_node</a></div><div class="ttdeci">virtual void local_coordinate_of_node(const unsigned &amp;j, Vector&lt; double &gt; &amp;s) const</div><div class="ttdoc">Get local coordinates of node j in the element; vector sets its own size (broken virtual)</div><div class="ttdef"><b>Definition:</b> <a href="elements_8h_source.html#l01859">elements.h:1859</a></div></div>
<div class="ttc" id="aclassoomph_1_1QTaylorHoodSpaceTimeElement_html_afb98e9674244dcabd34fcedfca0240d5"><div class="ttname"><a href="classoomph_1_1QTaylorHoodSpaceTimeElement.html#afb98e9674244dcabd34fcedfca0240d5">oomph::QTaylorHoodSpaceTimeElement::dshape_and_dtest_eulerian_nst</a></div><div class="ttdeci">double dshape_and_dtest_eulerian_nst(const Vector&lt; double &gt; &amp;s, Shape &amp;psi, DShape &amp;dpsidx, Shape &amp;test, DShape &amp;dtestdx) const</div><div class="ttdoc">Velocity shape and test functions and their derivs w.r.t. to global coords at local coordinate s (tak...</div><div class="ttdef"><b>Definition:</b> <a href="discontinuous__galerkin__equal__order__pressure__spacetime__navier__stokes__elements_8h_source.html#l02375">discontinuous_galerkin_equal_order_pressure_spacetime_navier_stokes_elements.h:2375</a></div></div>
<div class="ttc" id="aclassoomph_1_1SpaceTimeNavierStokesEquations_html_a0ba16529bfdadde8c927ac92e2e95941"><div class="ttname"><a href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a0ba16529bfdadde8c927ac92e2e95941">oomph::SpaceTimeNavierStokesEquations::fill_in_pressure_advection_diffusion_jacobian</a></div><div class="ttdeci">void fill_in_pressure_advection_diffusion_jacobian(Vector&lt; double &gt; &amp;residuals, DenseMatrix&lt; double &gt; &amp;jacobian)</div><div class="ttdoc">Compute the residuals and Jacobian for the associated pressure advection diffusion problem....</div><div class="ttdef"><b>Definition:</b> <a href="spacetime__navier__stokes__elements_8h_source.html#l01707">spacetime_navier_stokes_elements.h:1707</a></div></div>
<div class="ttc" id="aclassoomph_1_1TemplateFreeSpaceTimeNavierStokesEquationsBase_html_afc018b58bca3a36ae7abc7f7d05ff744"><div class="ttname"><a href="classoomph_1_1TemplateFreeSpaceTimeNavierStokesEquationsBase.html#afc018b58bca3a36ae7abc7f7d05ff744">oomph::TemplateFreeSpaceTimeNavierStokesEquationsBase::pinned_fp_pressure_eqn</a></div><div class="ttdeci">virtual int &amp; pinned_fp_pressure_eqn()=0</div><div class="ttdoc">Global eqn number of pressure dof that's pinned in pressure adv diff problem.</div></div>
<div class="ttc" id="aclassoomph_1_1FpPressureAdvDiffRobinBCSpaceTimeElement_html"><div class="ttname"><a href="classoomph_1_1FpPressureAdvDiffRobinBCSpaceTimeElement.html">oomph::FpPressureAdvDiffRobinBCSpaceTimeElement</a></div><div class="ttdef"><b>Definition:</b> <a href="discontinuous__galerkin__equal__order__pressure__spacetime__navier__stokes__elements_8h_source.html#l00077">discontinuous_galerkin_equal_order_pressure_spacetime_navier_stokes_elements.h:77</a></div></div>
<div class="ttc" id="aclassoomph_1_1QTaylorHoodSpaceTimeElement_html"><div class="ttname"><a href="classoomph_1_1QTaylorHoodSpaceTimeElement.html">oomph::QTaylorHoodSpaceTimeElement</a></div><div class="ttdef"><b>Definition:</b> <a href="discontinuous__galerkin__equal__order__pressure__spacetime__navier__stokes__elements_8h_source.html#l02123">discontinuous_galerkin_equal_order_pressure_spacetime_navier_stokes_elements.h:2123</a></div></div>
<div class="ttc" id="aclassoomph_1_1SpaceTimeNavierStokesEquations_html_abd193a0c754ddfc7b87ee7ec9f7e7694"><div class="ttname"><a href="classoomph_1_1SpaceTimeNavierStokesEquations.html#abd193a0c754ddfc7b87ee7ec9f7e7694">oomph::SpaceTimeNavierStokesEquations::u_index_nst</a></div><div class="ttdeci">virtual unsigned u_index_nst(const unsigned &amp;i) const</div><div class="ttdoc">Return the index at which the i-th unknown velocity component is stored. The default value,...</div><div class="ttdef"><b>Definition:</b> <a href="discontinuous__galerkin__equal__order__pressure__spacetime__navier__stokes__elements_8h_source.html#l01108">discontinuous_galerkin_equal_order_pressure_spacetime_navier_stokes_elements.h:1108</a></div></div>
<div class="ttc" id="aclassoomph_1_1QTaylorHoodSpaceTimeElement_html_a5dcdb54f45adb01918aec993d8e22e38"><div class="ttname"><a href="classoomph_1_1QTaylorHoodSpaceTimeElement.html#a5dcdb54f45adb01918aec993d8e22e38">oomph::QTaylorHoodSpaceTimeElement::fix_pressure</a></div><div class="ttdeci">void fix_pressure(const unsigned &amp;p_dof, const double &amp;p_value)</div><div class="ttdoc">Pin p_dof-th pressure dof and set it to value specified by p_value.</div><div class="ttdef"><b>Definition:</b> <a href="spacetime__navier__stokes__elements_8h_source.html#l02222">spacetime_navier_stokes_elements.h:2222</a></div></div>
<div class="ttc" id="aclassoomph_1_1SpaceTimeNavierStokesEquations_html_a07cbd0c6d01a0892851e61a82e0dfafc"><div class="ttname"><a href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a07cbd0c6d01a0892851e61a82e0dfafc">oomph::SpaceTimeNavierStokesEquations::re_st_pt</a></div><div class="ttdeci">double *&amp; re_st_pt()</div><div class="ttdoc">Pointer to ReSt number (can only assign to private member data)</div><div class="ttdef"><b>Definition:</b> <a href="spacetime__navier__stokes__elements_8h_source.html#l00931">spacetime_navier_stokes_elements.h:931</a></div></div>
<div class="ttc" id="aclassoomph_1_1SpaceTimeNavierStokesEquations_html_a543fb6d0eddee513017e3b95c8b2a271"><div class="ttname"><a href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a543fb6d0eddee513017e3b95c8b2a271">oomph::SpaceTimeNavierStokesEquations::du_dt_nst</a></div><div class="ttdeci">double du_dt_nst(const unsigned &amp;n, const unsigned &amp;i) const</div><div class="ttdoc">i-th component of du/dt at local node n. Uses suitably interpolated value for hanging nodes.</div><div class="ttdef"><b>Definition:</b> <a href="discontinuous__galerkin__equal__order__pressure__spacetime__navier__stokes__elements_8h_source.html#l01155">discontinuous_galerkin_equal_order_pressure_spacetime_navier_stokes_elements.h:1155</a></div></div>
<div class="ttc" id="acfortran_8h_html_af6f0bd3dc13317f895c91323c25c2b8f"><div class="ttname"><a href="cfortran_8h.html#af6f0bd3dc13317f895c91323c25c2b8f">t</a></div><div class="ttdeci">char t</div><div class="ttdef"><b>Definition:</b> <a href="cfortran_8h_source.html#l00568">cfortran.h:568</a></div></div>
<div class="ttc" id="aclassoomph_1_1ProjectableTaylorHoodSpaceTimeElement_html_acb335e83a84b752d26c92f5207128bd2"><div class="ttname"><a href="classoomph_1_1ProjectableTaylorHoodSpaceTimeElement.html#acb335e83a84b752d26c92f5207128bd2">oomph::ProjectableTaylorHoodSpaceTimeElement::jacobian_and_shape_of_field</a></div><div class="ttdeci">double jacobian_and_shape_of_field(const unsigned &amp;fld, const Vector&lt; double &gt; &amp;s, Shape &amp;psi)</div><div class="ttdoc">Return the Jacobian of the mapping and the shape functions of field fld at local coordinate s.</div><div class="ttdef"><b>Definition:</b> <a href="spacetime__navier__stokes__elements_8h_source.html#l02730">spacetime_navier_stokes_elements.h:2730</a></div></div>
<div class="ttc" id="anamespaceoomph_1_1QuadTreeNames_html_a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6"><div class="ttname"><a href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">oomph::QuadTreeNames::W</a></div><div class="ttdeci">@ W</div><div class="ttdef"><b>Definition:</b> <a href="quadtree_8h_source.html#l00063">quadtree.h:63</a></div></div>
<div class="ttc" id="aclassoomph_1_1SpaceTimeNavierStokesEquations_html_a57c693d76098907b6607e209fb9d66b9"><div class="ttname"><a href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a57c693d76098907b6607e209fb9d66b9">oomph::SpaceTimeNavierStokesEquations::source_fct_pt</a></div><div class="ttdeci">NavierStokesSourceFctPt &amp; source_fct_pt()</div><div class="ttdoc">Access function for the source-function pointer.</div><div class="ttdef"><b>Definition:</b> <a href="spacetime__navier__stokes__elements_8h_source.html#l01001">spacetime_navier_stokes_elements.h:1001</a></div></div>
<div class="ttc" id="aclassoomph_1_1Data_html_a422231c58e423f0b43822827aa334d79"><div class="ttname"><a href="classoomph_1_1Data.html#a422231c58e423f0b43822827aa334d79">oomph::Data::pin</a></div><div class="ttdeci">void pin(const unsigned &amp;i)</div><div class="ttdoc">Pin the i-th stored variable.</div><div class="ttdef"><b>Definition:</b> <a href="nodes_8h_source.html#l00391">nodes.h:391</a></div></div>
<div class="ttc" id="aclassoomph_1_1SpaceTimeNavierStokesEquations_html_a51b8eb313bce9abaee4178bb9ad639fa"><div class="ttname"><a href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a51b8eb313bce9abaee4178bb9ad639fa">oomph::SpaceTimeNavierStokesEquations::Density_Ratio_pt</a></div><div class="ttdeci">double * Density_Ratio_pt</div><div class="ttdoc">Pointer to the density ratio (relative to the density used in the definition of the Reynolds number)</div><div class="ttdef"><b>Definition:</b> <a href="discontinuous__galerkin__equal__order__pressure__spacetime__navier__stokes__elements_8h_source.html#l00515">discontinuous_galerkin_equal_order_pressure_spacetime_navier_stokes_elements.h:515</a></div></div>
<div class="ttc" id="aclassoomph_1_1SpaceTimeNavierStokesEquations_html_ac3914b37e4cc91cbc2e28f7e8a9793cf"><div class="ttname"><a href="classoomph_1_1SpaceTimeNavierStokesEquations.html#ac3914b37e4cc91cbc2e28f7e8a9793cf">oomph::SpaceTimeNavierStokesEquations::compute_error</a></div><div class="ttdeci">void compute_error(std::ostream &amp;outfile, FiniteElement::UnsteadyExactSolutionFctPt exact_soln_pt, const double &amp;time, double &amp;error, double &amp;norm)</div><div class="ttdoc">Validate against exact solution at given time Solution is provided via function pointer....</div><div class="ttdef"><b>Definition:</b> <a href="discontinuous__galerkin__equal__order__pressure__spacetime__navier__stokes__elements_8cc_source.html#l00243">discontinuous_galerkin_equal_order_pressure_spacetime_navier_stokes_elements.cc:243</a></div></div>
<div class="ttc" id="aclassoomph_1_1FiniteElement_html_a82da844fd3ebb2005842464cdc148a03"><div class="ttname"><a href="classoomph_1_1FiniteElement.html#a82da844fd3ebb2005842464cdc148a03">oomph::FiniteElement::get_s_plot</a></div><div class="ttdeci">virtual void get_s_plot(const unsigned &amp;i, const unsigned &amp;nplot, Vector&lt; double &gt; &amp;s, const bool &amp;shifted_to_interior=false) const</div><div class="ttdoc">Get cector of local coordinates of plot point i (when plotting nplot points in each &quot;coordinate direc...</div><div class="ttdef"><b>Definition:</b> <a href="elements_8h_source.html#l03165">elements.h:3165</a></div></div>
<div class="ttc" id="anamespaceoomph_1_1OneDimLagrange_html_a117f8b892dc89989ecdad99ff261e120"><div class="ttname"><a href="namespaceoomph_1_1OneDimLagrange.html#a117f8b892dc89989ecdad99ff261e120">oomph::OneDimLagrange::shape</a></div><div class="ttdeci">void shape(const double &amp;s, double *Psi)</div><div class="ttdoc">Definition for 1D Lagrange shape functions. The value of all the shape functions at the local coordin...</div><div class="ttdef"><b>Definition:</b> <a href="shape_8h_source.html#l00573">shape.h:573</a></div></div>
<div class="ttc" id="aclassoomph_1_1ProjectableTaylorHoodSpaceTimeElement_html_ae361a8ca7dffa909f09d34b17bdf5046"><div class="ttname"><a href="classoomph_1_1ProjectableTaylorHoodSpaceTimeElement.html#ae361a8ca7dffa909f09d34b17bdf5046">oomph::ProjectableTaylorHoodSpaceTimeElement::nhistory_values_for_projection</a></div><div class="ttdeci">unsigned nhistory_values_for_projection(const unsigned &amp;fld)</div><div class="ttdoc">Number of history values to be stored for fld-th field. Whatever the timestepper has set up for the v...</div><div class="ttdef"><b>Definition:</b> <a href="spacetime__navier__stokes__elements_8h_source.html#l02702">spacetime_navier_stokes_elements.h:2702</a></div></div>
<div class="ttc" id="aclassoomph_1_1TemplateFreeSpaceTimeNavierStokesEquationsBase_html_ae8c5b20a6fa5f1373fe2b720ba1d321f"><div class="ttname"><a href="classoomph_1_1TemplateFreeSpaceTimeNavierStokesEquationsBase.html#ae8c5b20a6fa5f1373fe2b720ba1d321f">oomph::TemplateFreeSpaceTimeNavierStokesEquationsBase::fill_in_pressure_advection_diffusion_residuals</a></div><div class="ttdeci">virtual void fill_in_pressure_advection_diffusion_residuals(Vector&lt; double &gt; &amp;residuals)=0</div><div class="ttdoc">Compute the residuals for the associated pressure advection diffusion problem. Used by the Fp precond...</div></div>
<div class="ttc" id="aclassoomph_1_1SpaceTimeNavierStokesEquations_html_abf2d3ed63a89a44d045885e0a3db0a2d"><div class="ttname"><a href="classoomph_1_1SpaceTimeNavierStokesEquations.html#abf2d3ed63a89a44d045885e0a3db0a2d">oomph::SpaceTimeNavierStokesEquations::interpolated_u_nst</a></div><div class="ttdeci">double interpolated_u_nst(const unsigned &amp;t, const Vector&lt; double &gt; &amp;s, const unsigned &amp;i) const</div><div class="ttdoc">Return FE interpolated velocity u[i] at local coordinate s time level, t. Purposely broken for space-...</div><div class="ttdef"><b>Definition:</b> <a href="spacetime__navier__stokes__elements_8h_source.html#l01934">spacetime_navier_stokes_elements.h:1934</a></div></div>
<div class="ttc" id="aclassoomph_1_1SpaceTimeNavierStokesEquations_html_a7aeaf71b3ffa04114f9d44f630af84c2"><div class="ttname"><a href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a7aeaf71b3ffa04114f9d44f630af84c2">oomph::SpaceTimeNavierStokesEquations::fill_in_contribution_to_dresiduals_dparameter</a></div><div class="ttdeci">void fill_in_contribution_to_dresiduals_dparameter(double *const &amp;parameter_pt, Vector&lt; double &gt; &amp;dres_dparam)</div><div class="ttdef"><b>Definition:</b> <a href="spacetime__navier__stokes__elements_8h_source.html#l01635">spacetime_navier_stokes_elements.h:1635</a></div></div>
<div class="ttc" id="aclassoomph_1_1Integral_html_a1a2122f99a87c18649bafdd9ed739758"><div class="ttname"><a href="classoomph_1_1Integral.html#a1a2122f99a87c18649bafdd9ed739758">oomph::Integral::knot</a></div><div class="ttdeci">virtual double knot(const unsigned &amp;i, const unsigned &amp;j) const =0</div><div class="ttdoc">Return local coordinate s[j] of i-th integration point.</div></div>
<div class="ttc" id="aclassoomph_1_1SpaceTimeNavierStokesEquations_html_afba8c33595dfc9198e991f30767bdc8a"><div class="ttname"><a href="classoomph_1_1SpaceTimeNavierStokesEquations.html#afba8c33595dfc9198e991f30767bdc8a">oomph::SpaceTimeNavierStokesEquations::interpolated_p_nst</a></div><div class="ttdeci">double interpolated_p_nst(const unsigned &amp;t, const Vector&lt; double &gt; &amp;s) const</div><div class="ttdoc">Return FE interpolated pressure at local coordinate s at time level t.</div><div class="ttdef"><b>Definition:</b> <a href="spacetime__navier__stokes__elements_8h_source.html#l02038">spacetime_navier_stokes_elements.h:2038</a></div></div>
<div class="ttc" id="aclassoomph_1_1QTaylorHoodSpaceTimeElement_html_af96b330b72d73e7143509ac05b4b358c"><div class="ttname"><a href="classoomph_1_1QTaylorHoodSpaceTimeElement.html#af96b330b72d73e7143509ac05b4b358c">oomph::QTaylorHoodSpaceTimeElement::npres_nst</a></div><div class="ttdeci">unsigned npres_nst() const</div><div class="ttdoc">Return number of pressure values.</div><div class="ttdef"><b>Definition:</b> <a href="spacetime__navier__stokes__elements_8h_source.html#l02213">spacetime_navier_stokes_elements.h:2213</a></div></div>
<div class="ttc" id="aclassoomph_1_1TemplateFreeSpaceTimeNavierStokesEquationsBase_html_ab1b0d29e41018d1c27dfc841e6de8b1d"><div class="ttname"><a href="classoomph_1_1TemplateFreeSpaceTimeNavierStokesEquationsBase.html#ab1b0d29e41018d1c27dfc841e6de8b1d">oomph::TemplateFreeSpaceTimeNavierStokesEquationsBase::~TemplateFreeSpaceTimeNavierStokesEquationsBase</a></div><div class="ttdeci">virtual ~TemplateFreeSpaceTimeNavierStokesEquationsBase()</div><div class="ttdoc">Virtual destructor (empty)</div><div class="ttdef"><b>Definition:</b> <a href="spacetime__navier__stokes__elements_8h_source.html#l00372">spacetime_navier_stokes_elements.h:372</a></div></div>
<div class="ttc" id="aclassoomph_1_1QTaylorHoodSpaceTimeElement_html_a17d0d5d02bfbaa5f7fbd37023909be0d"><div class="ttname"><a href="classoomph_1_1QTaylorHoodSpaceTimeElement.html#a17d0d5d02bfbaa5f7fbd37023909be0d">oomph::QTaylorHoodSpaceTimeElement::output</a></div><div class="ttdeci">void output(FILE *file_pt, const unsigned &amp;nplot)</div><div class="ttdoc">Redirect output to NavierStokesEquations output.</div><div class="ttdef"><b>Definition:</b> <a href="spacetime__navier__stokes__elements_8h_source.html#l02293">spacetime_navier_stokes_elements.h:2293</a></div></div>
<div class="ttc" id="aclassoomph_1_1GeneralisedElement_html_a4bff11b8ff97aefabb2df41e61e1779f"><div class="ttname"><a href="classoomph_1_1GeneralisedElement.html#a4bff11b8ff97aefabb2df41e61e1779f">oomph::GeneralisedElement::Dummy_matrix</a></div><div class="ttdeci">static DenseMatrix&lt; double &gt; Dummy_matrix</div><div class="ttdoc">Empty dense matrix used as a dummy argument to combined residual and jacobian functions in the case w...</div><div class="ttdef"><b>Definition:</b> <a href="elements_8h_source.html#l00227">elements.h:227</a></div></div>
<div class="ttc" id="aclassoomph_1_1ProjectableTaylorHoodSpaceTimeElement_html_ad5d4fa3306af7f3b79c2fbddde30661b"><div class="ttname"><a href="classoomph_1_1ProjectableTaylorHoodSpaceTimeElement.html#ad5d4fa3306af7f3b79c2fbddde30661b">oomph::ProjectableTaylorHoodSpaceTimeElement::ProjectableTaylorHoodSpaceTimeElement</a></div><div class="ttdeci">ProjectableTaylorHoodSpaceTimeElement()</div><div class="ttdoc">Constructor [this was only required explicitly from gcc 4.5.2 onwards...].</div><div class="ttdef"><b>Definition:</b> <a href="spacetime__navier__stokes__elements_8h_source.html#l02640">spacetime_navier_stokes_elements.h:2640</a></div></div>
<div class="ttc" id="aclassoomph_1_1FiniteElement_html_ad4ecf2b61b158a4b4d351a60d23c633e"><div class="ttname"><a href="classoomph_1_1FiniteElement.html#ad4ecf2b61b158a4b4d351a60d23c633e">oomph::FiniteElement::UnsteadyExactSolutionFctPt</a></div><div class="ttdeci">void(* UnsteadyExactSolutionFctPt)(const double &amp;, const Vector&lt; double &gt; &amp;, Vector&lt; double &gt; &amp;)</div><div class="ttdoc">Function pointer for function that computes Vector-valued time-dependent function  as .</div><div class="ttdef"><b>Definition:</b> <a href="elements_8h_source.html#l01776">elements.h:1776</a></div></div>
<div class="ttc" id="aclassoomph_1_1SolidNode_html"><div class="ttname"><a href="classoomph_1_1SolidNode.html">oomph::SolidNode</a></div><div class="ttdoc">A Class for nodes that deform elastically (i.e. position is an unknown in the problem)....</div><div class="ttdef"><b>Definition:</b> <a href="nodes_8h_source.html#l01710">nodes.h:1710</a></div></div>
<div class="ttc" id="aclassoomph_1_1SpaceTimeNavierStokesEquations_html_aa54b4067e393bb34e3c84f7bd5415e45"><div class="ttname"><a href="classoomph_1_1SpaceTimeNavierStokesEquations.html#aa54b4067e393bb34e3c84f7bd5415e45">oomph::SpaceTimeNavierStokesEquations::u_nst</a></div><div class="ttdeci">double u_nst(const unsigned &amp;t, const unsigned &amp;n, const unsigned &amp;i) const</div><div class="ttdoc">Velocity i at local node n at timestep t (t=0: present; t&gt;0: previous). Uses suitably interpolated va...</div><div class="ttdef"><b>Definition:</b> <a href="spacetime__navier__stokes__elements_8h_source.html#l01059">spacetime_navier_stokes_elements.h:1059</a></div></div>
<div class="ttc" id="aclassoomph_1_1SpaceTimeNavierStokesEquations_html_a336cd70799bda69ff25579d9e13da56f"><div class="ttname"><a href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a336cd70799bda69ff25579d9e13da56f">oomph::SpaceTimeNavierStokesEquations::delete_pressure_advection_diffusion_robin_elements</a></div><div class="ttdeci">void delete_pressure_advection_diffusion_robin_elements()</div><div class="ttdoc">Delete the FaceElements that apply the Robin boundary condition to the pressure advection diffusion p...</div><div class="ttdef"><b>Definition:</b> <a href="spacetime__navier__stokes__elements_8h_source.html#l01851">spacetime_navier_stokes_elements.h:1851</a></div></div>
<div class="ttc" id="aclassoomph_1_1SpaceTimeNavierStokesEquations_html_af88a97d24d43b8d08db1dbeaad00b647"><div class="ttname"><a href="classoomph_1_1SpaceTimeNavierStokesEquations.html#af88a97d24d43b8d08db1dbeaad00b647">oomph::SpaceTimeNavierStokesEquations::scalar_value_paraview</a></div><div class="ttdeci">void scalar_value_paraview(std::ofstream &amp;file_out, const unsigned &amp;i, const unsigned &amp;nplot) const</div><div class="ttdoc">Write values of the i-th scalar field at the plot points. Needs to be implemented for each new specif...</div><div class="ttdef"><b>Definition:</b> <a href="spacetime__navier__stokes__elements_8h_source.html#l01295">spacetime_navier_stokes_elements.h:1295</a></div></div>
<div class="ttc" id="aclassoomph_1_1SpaceTimeNavierStokesEquations_html_abe13b1cb8754e4fdeaa647b58889ce7a"><div class="ttname"><a href="classoomph_1_1SpaceTimeNavierStokesEquations.html#abe13b1cb8754e4fdeaa647b58889ce7a">oomph::SpaceTimeNavierStokesEquations::get_source_nst</a></div><div class="ttdeci">virtual double get_source_nst(const double &amp;time, const unsigned &amp;ipt, const Vector&lt; double &gt; &amp;x)</div><div class="ttdoc">Calculate the source fct at a given time and Eulerian position.</div><div class="ttdef"><b>Definition:</b> <a href="spacetime__navier__stokes__elements_8h_source.html#l00680">spacetime_navier_stokes_elements.h:680</a></div></div>
<div class="ttc" id="aclassoomph_1_1SpaceTimeNavierStokesEquations_html_a559c0593d604a126d32d3b3056b4729d"><div class="ttname"><a href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a559c0593d604a126d32d3b3056b4729d">oomph::SpaceTimeNavierStokesEquations::Default_Physical_Constant_Value</a></div><div class="ttdeci">static double Default_Physical_Constant_Value</div><div class="ttdoc">Navier-Stokes equations static data.</div><div class="ttdef"><b>Definition:</b> <a href="discontinuous__galerkin__equal__order__pressure__spacetime__navier__stokes__elements_8h_source.html#l00497">discontinuous_galerkin_equal_order_pressure_spacetime_navier_stokes_elements.h:497</a></div></div>
<div class="ttc" id="anamespaceoomph_1_1OneDimLagrange_html_aec7f5263cb672ddfef50bdd3462ada19"><div class="ttname"><a href="namespaceoomph_1_1OneDimLagrange.html#aec7f5263cb672ddfef50bdd3462ada19">oomph::OneDimLagrange::shape&lt; 2 &gt;</a></div><div class="ttdeci">void shape&lt; 2 &gt;(const double &amp;s, double *Psi)</div><div class="ttdoc">1D shape functions specialised to linear order (2 Nodes)</div><div class="ttdef"><b>Definition:</b> <a href="shape_8h_source.html#l00617">shape.h:617</a></div></div>
<div class="ttc" id="aclassoomph_1_1SpaceTimeNavierStokesEquations_html_aaf9a79f73d7d40142feb4dbf395428da"><div class="ttname"><a href="classoomph_1_1SpaceTimeNavierStokesEquations.html#aaf9a79f73d7d40142feb4dbf395428da">oomph::SpaceTimeNavierStokesEquations::pin_all_non_pressure_dofs</a></div><div class="ttdeci">void pin_all_non_pressure_dofs(std::map&lt; Data *, std::vector&lt; int &gt;&gt; &amp;eqn_number_backup)</div><div class="ttdoc">Pin all non-pressure dofs and backup eqn numbers.</div><div class="ttdef"><b>Definition:</b> <a href="spacetime__navier__stokes__elements_8h_source.html#l01720">spacetime_navier_stokes_elements.h:1720</a></div></div>
<div class="ttc" id="aclassoomph_1_1SpaceTimeNavierStokesEquations_html_a73ebd4a95b8389225fcc37e0f297ee81"><div class="ttname"><a href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a73ebd4a95b8389225fcc37e0f297ee81">oomph::SpaceTimeNavierStokesEquations::interpolated_du_dt_nst</a></div><div class="ttdeci">double interpolated_du_dt_nst(const Vector&lt; double &gt; &amp;s, const unsigned &amp;i) const</div><div class="ttdoc">Return FE representation of function value du_i/dt(s) at local coordinate s.</div><div class="ttdef"><b>Definition:</b> <a href="discontinuous__galerkin__equal__order__pressure__spacetime__navier__stokes__elements_8h_source.html#l01170">discontinuous_galerkin_equal_order_pressure_spacetime_navier_stokes_elements.h:1170</a></div></div>
<div class="ttc" id="anamespaceoomph_html"><div class="ttname"><a href="namespaceoomph.html">oomph</a></div><div class="ttdoc">DRAIG: Change all instances of (SPATIAL_DIM) to (DIM-1).</div><div class="ttdef"><b>Definition:</b> <a href="advection__diffusion__elements_8cc_source.html#l00029">advection_diffusion_elements.cc:29</a></div></div>
<div class="ttc" id="aclassoomph_1_1TemplateFreeSpaceTimeNavierStokesEquationsBase_html_ac14a23704d1afd41be9be7cee3f75b5d"><div class="ttname"><a href="classoomph_1_1TemplateFreeSpaceTimeNavierStokesEquationsBase.html#ac14a23704d1afd41be9be7cee3f75b5d">oomph::TemplateFreeSpaceTimeNavierStokesEquationsBase::p_local_eqn</a></div><div class="ttdeci">virtual int p_local_eqn(const unsigned &amp;n) const =0</div><div class="ttdoc">Access function for the local equation number information for the pressure. p_local_eqn[n] = local eq...</div></div>
<div class="ttc" id="aclassoomph_1_1FiniteElement_html_a6219ed269a6d89b5aa14659cce48905a"><div class="ttname"><a href="classoomph_1_1FiniteElement.html#a6219ed269a6d89b5aa14659cce48905a">oomph::FiniteElement::nnode</a></div><div class="ttdeci">unsigned nnode() const</div><div class="ttdoc">Return the number of nodes.</div><div class="ttdef"><b>Definition:</b> <a href="elements_8h_source.html#l02227">elements.h:2227</a></div></div>
<div class="ttc" id="aclassoomph_1_1Node_html"><div class="ttname"><a href="classoomph_1_1Node.html">oomph::Node</a></div><div class="ttdoc">Nodes are derived from Data, but, in addition, have a definite (Eulerian) position in a space of a gi...</div><div class="ttdef"><b>Definition:</b> <a href="nodes_8h_source.html#l00924">nodes.h:924</a></div></div>
<div class="ttc" id="aclassoomph_1_1SpaceTimeNavierStokesEquations_html_a0f17dc6374634209fabff9751a8b4d63"><div class="ttname"><a href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a0f17dc6374634209fabff9751a8b4d63">oomph::SpaceTimeNavierStokesEquations::ReInvFr_pt</a></div><div class="ttdeci">double * ReInvFr_pt</div><div class="ttdoc">Pointer to global Reynolds number x inverse Froude number (= Bond number / Capillary number)</div><div class="ttdef"><b>Definition:</b> <a href="discontinuous__galerkin__equal__order__pressure__spacetime__navier__stokes__elements_8h_source.html#l00531">discontinuous_galerkin_equal_order_pressure_spacetime_navier_stokes_elements.h:531</a></div></div>
<div class="ttc" id="aclassoomph_1_1SpaceTimeNavierStokesEquations_html_a12b09fc92074e9b752c408d9896b1efb"><div class="ttname"><a href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a12b09fc92074e9b752c408d9896b1efb">oomph::SpaceTimeNavierStokesEquations::get_traction</a></div><div class="ttdeci">void get_traction(const Vector&lt; double &gt; &amp;s, const Vector&lt; double &gt; &amp;N, Vector&lt; double &gt; &amp;traction)</div><div class="ttdoc">Compute traction (on the viscous scale) exerted onto the fluid at local coordinate s....</div><div class="ttdef"><b>Definition:</b> <a href="discontinuous__galerkin__equal__order__pressure__spacetime__navier__stokes__elements_8cc_source.html#l01366">discontinuous_galerkin_equal_order_pressure_spacetime_navier_stokes_elements.cc:1366</a></div></div>
<div class="ttc" id="aclassoomph_1_1SpaceTimeNavierStokesEquations_html_a54cfa39d206ec21295ef68727986e457"><div class="ttname"><a href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a54cfa39d206ec21295ef68727986e457">oomph::SpaceTimeNavierStokesEquations::body_force_fct_pt</a></div><div class="ttdeci">NavierStokesBodyForceFctPt body_force_fct_pt() const</div><div class="ttdoc">Access function for the body-force pointer. Const version.</div><div class="ttdef"><b>Definition:</b> <a href="spacetime__navier__stokes__elements_8h_source.html#l00995">spacetime_navier_stokes_elements.h:995</a></div></div>
<div class="ttc" id="aclassoomph_1_1Vector_html"><div class="ttname"><a href="classoomph_1_1Vector.html">oomph::Vector&lt; double &gt;</a></div></div>
<div class="ttc" id="aclassoomph_1_1SpaceTimeNavierStokesEquations_html_af4fd1cc02fc1ec2e8fc5a7a611433dd5"><div class="ttname"><a href="classoomph_1_1SpaceTimeNavierStokesEquations.html#af4fd1cc02fc1ec2e8fc5a7a611433dd5">oomph::SpaceTimeNavierStokesEquations::g_pt</a></div><div class="ttdeci">Vector&lt; double &gt; *&amp; g_pt()</div><div class="ttdoc">Pointer to Vector of gravitational components.</div><div class="ttdef"><b>Definition:</b> <a href="spacetime__navier__stokes__elements_8h_source.html#l00983">spacetime_navier_stokes_elements.h:983</a></div></div>
<div class="ttc" id="aclassoomph_1_1TemplateFreeSpaceTimeNavierStokesEquationsBase_html_a41a7caedf1068323325e0c7af21d2a67"><div class="ttname"><a href="classoomph_1_1TemplateFreeSpaceTimeNavierStokesEquationsBase.html#a41a7caedf1068323325e0c7af21d2a67">oomph::TemplateFreeSpaceTimeNavierStokesEquationsBase::fill_in_pressure_advection_diffusion_jacobian</a></div><div class="ttdeci">virtual void fill_in_pressure_advection_diffusion_jacobian(Vector&lt; double &gt; &amp;residuals, DenseMatrix&lt; double &gt; &amp;jacobian)=0</div><div class="ttdoc">Compute the residuals and Jacobian for the associated pressure advection diffusion problem....</div></div>
<div class="ttc" id="aclassoomph_1_1FiniteElement_html_a58a25b6859ddd43b7bfe64a19fee5023"><div class="ttname"><a href="classoomph_1_1FiniteElement.html#a58a25b6859ddd43b7bfe64a19fee5023">oomph::FiniteElement::shape</a></div><div class="ttdeci">virtual void shape(const Vector&lt; double &gt; &amp;s, Shape &amp;psi) const =0</div><div class="ttdoc">Calculate the geometric shape functions at local coordinate s. This function must be overloaded for e...</div></div>
<div class="ttc" id="aclassoomph_1_1SpaceTimeNavierStokesEquations_html_ae66d63f1872a754adc5cd360c039d110"><div class="ttname"><a href="classoomph_1_1SpaceTimeNavierStokesEquations.html#ae66d63f1872a754adc5cd360c039d110">oomph::SpaceTimeNavierStokesEquations::Default_Physical_Ratio_Value</a></div><div class="ttdeci">static double Default_Physical_Ratio_Value</div><div class="ttdoc">Navier-Stokes equations static data.</div><div class="ttdef"><b>Definition:</b> <a href="discontinuous__galerkin__equal__order__pressure__spacetime__navier__stokes__elements_8h_source.html#l00501">discontinuous_galerkin_equal_order_pressure_spacetime_navier_stokes_elements.h:501</a></div></div>
<div class="ttc" id="aclassoomph_1_1SpaceTimeNavierStokesEquations_html_ae393d5f751c42290cd0fe90c0337bdbb"><div class="ttname"><a href="classoomph_1_1SpaceTimeNavierStokesEquations.html#ae393d5f751c42290cd0fe90c0337bdbb">oomph::SpaceTimeNavierStokesEquations::strain_rate</a></div><div class="ttdeci">void strain_rate(const Vector&lt; double &gt; &amp;s, DenseMatrix&lt; double &gt; &amp;strain_rate) const</div><div class="ttdoc">Strain-rate tensor: 1/2 (du_i/dx_j+du_j/dx_i)</div><div class="ttdef"><b>Definition:</b> <a href="discontinuous__galerkin__equal__order__pressure__spacetime__navier__stokes__elements_8cc_source.html#l01468">discontinuous_galerkin_equal_order_pressure_spacetime_navier_stokes_elements.cc:1468</a></div></div>
<div class="ttc" id="aclassoomph_1_1SpaceTimeNavierStokesEquations_html_a25ce9aa9fb4a3b05a790f3a8b2d1ba4c"><div class="ttname"><a href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a25ce9aa9fb4a3b05a790f3a8b2d1ba4c">oomph::SpaceTimeNavierStokesEquations::full_output</a></div><div class="ttdeci">void full_output(std::ostream &amp;outfile)</div><div class="ttdoc">Full output function: x,y,[z],u,v,[w],p,du/dt,dv/dt,[dw/dt],dissipation in tecplot format....</div><div class="ttdef"><b>Definition:</b> <a href="spacetime__navier__stokes__elements_8h_source.html#l01487">spacetime_navier_stokes_elements.h:1487</a></div></div>
<div class="ttc" id="aclassoomph_1_1TemplateFreeSpaceTimeNavierStokesEquationsBase_html_ad875a36463531c1015a1b40ad074f345"><div class="ttname"><a href="classoomph_1_1TemplateFreeSpaceTimeNavierStokesEquationsBase.html#ad875a36463531c1015a1b40ad074f345">oomph::TemplateFreeSpaceTimeNavierStokesEquationsBase::delete_pressure_advection_diffusion_robin_elements</a></div><div class="ttdeci">virtual void delete_pressure_advection_diffusion_robin_elements()=0</div><div class="ttdoc">Delete the FaceElements that apply the Robin boundary condition to the pressure advection diffusion p...</div></div>
<div class="ttc" id="acfortran_8h_html_adb50e893b86b3e55e751a42eab3cba82"><div class="ttname"><a href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a></div><div class="ttdeci">cstr elem_len * i</div><div class="ttdef"><b>Definition:</b> <a href="cfortran_8h_source.html#l00603">cfortran.h:603</a></div></div>
<div class="ttc" id="aclassoomph_1_1SpaceTimeNavierStokesEquations_html_a99f198e79155480b0d06ad0fa66b027a"><div class="ttname"><a href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a99f198e79155480b0d06ad0fa66b027a">oomph::SpaceTimeNavierStokesEquations::fill_in_generic_residual_contribution_nst</a></div><div class="ttdeci">virtual void fill_in_generic_residual_contribution_nst(Vector&lt; double &gt; &amp;residuals, DenseMatrix&lt; double &gt; &amp;jacobian, DenseMatrix&lt; double &gt; &amp;mass_matrix, const unsigned &amp;flag)</div><div class="ttdoc">Compute the residuals for the Navier-Stokes equations. Flag=1 (or 0): do (or don't) compute the Jacob...</div><div class="ttdef"><b>Definition:</b> <a href="discontinuous__galerkin__equal__order__pressure__spacetime__navier__stokes__elements_8cc_source.html#l01994">discontinuous_galerkin_equal_order_pressure_spacetime_navier_stokes_elements.cc:1994</a></div></div>
<div class="ttc" id="aclassoomph_1_1QTaylorHoodSpaceTimeElement_html_a5eaf421b85f9ca1797bfc2532270cac9"><div class="ttname"><a href="classoomph_1_1QTaylorHoodSpaceTimeElement.html#a5eaf421b85f9ca1797bfc2532270cac9">oomph::QTaylorHoodSpaceTimeElement::Pconv</a></div><div class="ttdeci">static const unsigned Pconv[]</div><div class="ttdoc">Static array of ints to hold conversion from pressure node numbers to actual node numbers.</div><div class="ttdef"><b>Definition:</b> <a href="discontinuous__galerkin__equal__order__pressure__spacetime__navier__stokes__elements_8h_source.html#l02134">discontinuous_galerkin_equal_order_pressure_spacetime_navier_stokes_elements.h:2134</a></div></div>
<div class="ttc" id="aclassoomph_1_1SpaceTimeNavierStokesEquations_html_a54106089fd7fa30326a0d6db8372af17"><div class="ttname"><a href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a54106089fd7fa30326a0d6db8372af17">oomph::SpaceTimeNavierStokesEquations::G_pt</a></div><div class="ttdeci">Vector&lt; double &gt; * G_pt</div><div class="ttdoc">Pointer to global gravity Vector.</div><div class="ttdef"><b>Definition:</b> <a href="discontinuous__galerkin__equal__order__pressure__spacetime__navier__stokes__elements_8h_source.html#l00534">discontinuous_galerkin_equal_order_pressure_spacetime_navier_stokes_elements.h:534</a></div></div>
<div class="ttc" id="aclassoomph_1_1GeneralisedElement_html_afc58b505360aa5d172e50baad9aae46d"><div class="ttname"><a href="classoomph_1_1GeneralisedElement.html#afc58b505360aa5d172e50baad9aae46d">oomph::GeneralisedElement::add_external_data</a></div><div class="ttdeci">unsigned add_external_data(Data *const &amp;data_pt, const bool &amp;fd=true)</div><div class="ttdef"><b>Definition:</b> <a href="elements_8cc_source.html#l00307">elements.cc:307</a></div></div>
<div class="ttc" id="aclassoomph_1_1SpaceTimeNavierStokesEquations_html_a66088d45fbb45c054632c4e2a677c945"><div class="ttname"><a href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a66088d45fbb45c054632c4e2a677c945">oomph::SpaceTimeNavierStokesEquations::store_strouhal_as_external_data</a></div><div class="ttdeci">void store_strouhal_as_external_data(Data *strouhal_data_pt)</div><div class="ttdoc">Function that tells us whether the period is stored as external data.</div><div class="ttdef"><b>Definition:</b> <a href="spacetime__navier__stokes__elements_8h_source.html#l00826">spacetime_navier_stokes_elements.h:826</a></div></div>
<div class="ttc" id="anamespaceoomph_1_1QuadTreeNames_html_a8954a5947b19986b8c4b755bc7639f7dabc60bec4cc294aa2adf92726c6d6823a"><div class="ttname"><a href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7dabc60bec4cc294aa2adf92726c6d6823a">oomph::QuadTreeNames::N</a></div><div class="ttdeci">@ N</div><div class="ttdef"><b>Definition:</b> <a href="quadtree_8h_source.html#l00060">quadtree.h:60</a></div></div>
<div class="ttc" id="aclassoomph_1_1ProjectableTaylorHoodSpaceTimeElement_html_a662e3e5663832e82dd995543d06a2ffc"><div class="ttname"><a href="classoomph_1_1ProjectableTaylorHoodSpaceTimeElement.html#a662e3e5663832e82dd995543d06a2ffc">oomph::ProjectableTaylorHoodSpaceTimeElement::nfields_for_projection</a></div><div class="ttdeci">unsigned nfields_for_projection()</div><div class="ttdoc">Number of fields to be projected: dim+1, corresponding to velocity components and pressure.</div><div class="ttdef"><b>Definition:</b> <a href="spacetime__navier__stokes__elements_8h_source.html#l02692">spacetime_navier_stokes_elements.h:2692</a></div></div>
<div class="ttc" id="aclassoomph_1_1SpaceTimeNavierStokesEquations_html_a8b8cc9230e27af177561b3d3b38078c0"><div class="ttname"><a href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a8b8cc9230e27af177561b3d3b38078c0">oomph::SpaceTimeNavierStokesEquations::d_kin_energy_dt</a></div><div class="ttdeci">double d_kin_energy_dt() const</div><div class="ttdoc">Get integral of time derivative of kinetic energy over element.</div><div class="ttdef"><b>Definition:</b> <a href="discontinuous__galerkin__equal__order__pressure__spacetime__navier__stokes__elements_8cc_source.html#l01668">discontinuous_galerkin_equal_order_pressure_spacetime_navier_stokes_elements.cc:1668</a></div></div>
<div class="ttc" id="aclassoomph_1_1SpaceTimeNavierStokesEquations_html_adb7ccce5209462b3a6e9e6abb7379e0e"><div class="ttname"><a href="classoomph_1_1SpaceTimeNavierStokesEquations.html#adb7ccce5209462b3a6e9e6abb7379e0e">oomph::SpaceTimeNavierStokesEquations::u_nst</a></div><div class="ttdeci">double u_nst(const unsigned &amp;n, const unsigned &amp;i) const</div><div class="ttdoc">Velocity i at local node n. Uses suitably interpolated value for hanging nodes. The use of u_index_ns...</div><div class="ttdef"><b>Definition:</b> <a href="spacetime__navier__stokes__elements_8h_source.html#l01052">spacetime_navier_stokes_elements.h:1052</a></div></div>
<div class="ttc" id="aclassoomph_1_1FpPressureAdvDiffRobinBCSpaceTimeElementBase_html_affbd5a0ddb22c64681bac01fb70307bb"><div class="ttname"><a href="classoomph_1_1FpPressureAdvDiffRobinBCSpaceTimeElementBase.html#affbd5a0ddb22c64681bac01fb70307bb">oomph::FpPressureAdvDiffRobinBCSpaceTimeElementBase::fill_in_generic_residual_contribution_fp_press_adv_diff_robin_bc</a></div><div class="ttdeci">virtual void fill_in_generic_residual_contribution_fp_press_adv_diff_robin_bc(Vector&lt; double &gt; &amp;residuals, DenseMatrix&lt; double &gt; &amp;jacobian, const unsigned &amp;compute_jacobian_flag)=0</div><div class="ttdoc">This function returns the residuals for the traction function. If compute_jacobian_flag=1 (or 0): do ...</div></div>
<div class="ttc" id="aclassoomph_1_1QTaylorHoodSpaceTimeElement_html_a3cf7240121c6a5ec082837b605cb40f2"><div class="ttname"><a href="classoomph_1_1QTaylorHoodSpaceTimeElement.html#a3cf7240121c6a5ec082837b605cb40f2">oomph::QTaylorHoodSpaceTimeElement::Initial_Nvalue</a></div><div class="ttdeci">static const unsigned Initial_Nvalue[]</div><div class="ttdoc">Static array of ints to hold number of variables at node.</div><div class="ttdef"><b>Definition:</b> <a href="discontinuous__galerkin__equal__order__pressure__spacetime__navier__stokes__elements_8h_source.html#l02129">discontinuous_galerkin_equal_order_pressure_spacetime_navier_stokes_elements.h:2129</a></div></div>
<div class="ttc" id="aclassoomph_1_1Data_html_a13206dcb7a088db0ef845ab71af505d2"><div class="ttname"><a href="classoomph_1_1Data.html#a13206dcb7a088db0ef845ab71af505d2">oomph::Data::eqn_number</a></div><div class="ttdeci">long &amp; eqn_number(const unsigned &amp;i)</div><div class="ttdoc">Return the equation number of the i-th stored variable.</div><div class="ttdef"><b>Definition:</b> <a href="nodes_8h_source.html#l00373">nodes.h:373</a></div></div>
<div class="ttc" id="aclassoomph_1_1FaceGeometry_3_01QTaylorHoodSpaceTimeElement_3_012_01_4_01_4_html_a635fb5887b7166b97db99bdf986110ea"><div class="ttname"><a href="classoomph_1_1FaceGeometry_3_01QTaylorHoodSpaceTimeElement_3_012_01_4_01_4.html#a635fb5887b7166b97db99bdf986110ea">oomph::FaceGeometry&lt; QTaylorHoodSpaceTimeElement&lt; 2 &gt; &gt;::FaceGeometry</a></div><div class="ttdeci">FaceGeometry()</div><div class="ttdoc">Constructor; empty.</div><div class="ttdef"><b>Definition:</b> <a href="spacetime__navier__stokes__elements_8h_source.html#l02611">spacetime_navier_stokes_elements.h:2611</a></div></div>
<div class="ttc" id="aclassoomph_1_1DShape_html"><div class="ttname"><a href="classoomph_1_1DShape.html">oomph::DShape</a></div><div class="ttdef"><b>Definition:</b> <a href="shape_8h_source.html#l00280">shape.h:280</a></div></div>
<div class="ttc" id="aclassoomph_1_1SpaceTimeNavierStokesEquations_html_aea9e0a8137ae2d251c8d33a28fbf0579"><div class="ttname"><a href="classoomph_1_1SpaceTimeNavierStokesEquations.html#aea9e0a8137ae2d251c8d33a28fbf0579">oomph::SpaceTimeNavierStokesEquations::enable_ALE</a></div><div class="ttdeci">void enable_ALE()</div><div class="ttdoc">(Re-)enable ALE, i.e. take possible mesh motion into account when evaluating the time-derivative....</div><div class="ttdef"><b>Definition:</b> <a href="spacetime__navier__stokes__elements_8h_source.html#l01190">spacetime_navier_stokes_elements.h:1190</a></div></div>
<div class="ttc" id="aclassoomph_1_1ProjectableTaylorHoodSpaceTimeElement_html_a8241aafbd16b4e2a50bcb8a1a839f530"><div class="ttname"><a href="classoomph_1_1ProjectableTaylorHoodSpaceTimeElement.html#a8241aafbd16b4e2a50bcb8a1a839f530">oomph::ProjectableTaylorHoodSpaceTimeElement::nhistory_values_for_coordinate_projection</a></div><div class="ttdeci">unsigned nhistory_values_for_coordinate_projection()</div><div class="ttdoc">Number of positional history values (Note: count includes current value!)</div><div class="ttdef"><b>Definition:</b> <a href="spacetime__navier__stokes__elements_8h_source.html#l02721">spacetime_navier_stokes_elements.h:2721</a></div></div>
<div class="ttc" id="aclassoomph_1_1FaceElement_html_a49cf44d89e80926635d2a26abfbbf3b0"><div class="ttname"><a href="classoomph_1_1FaceElement.html#a49cf44d89e80926635d2a26abfbbf3b0">oomph::FaceElement::outer_unit_normal</a></div><div class="ttdeci">void outer_unit_normal(const Vector&lt; double &gt; &amp;s, Vector&lt; double &gt; &amp;unit_normal) const</div><div class="ttdoc">Compute outer unit normal at the specified local coordinate.</div><div class="ttdef"><b>Definition:</b> <a href="elements_8cc_source.html#l06010">elements.cc:6010</a></div></div>
<div class="ttc" id="aclassoomph_1_1SpaceTimeNavierStokesEquations_html_a0d1f70732df8eead86c70e35979ce9c2"><div class="ttname"><a href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a0d1f70732df8eead86c70e35979ce9c2">oomph::SpaceTimeNavierStokesEquations::Gamma</a></div><div class="ttdeci">static Vector&lt; double &gt; Gamma</div><div class="ttdoc">Navier-Stokes equations static data.</div><div class="ttdef"><b>Definition:</b> <a href="discontinuous__galerkin__equal__order__pressure__spacetime__navier__stokes__elements_8h_source.html#l00839">discontinuous_galerkin_equal_order_pressure_spacetime_navier_stokes_elements.h:839</a></div></div>
<div class="ttc" id="aclassoomph_1_1QTaylorHoodSpaceTimeElement_html_a0fa5f52017a6577ef0b50f280ec044d4"><div class="ttname"><a href="classoomph_1_1QTaylorHoodSpaceTimeElement.html#a0fa5f52017a6577ef0b50f280ec044d4">oomph::QTaylorHoodSpaceTimeElement::output</a></div><div class="ttdeci">void output(std::ostream &amp;outfile)</div><div class="ttdoc">Redirect output to NavierStokesEquations output.</div><div class="ttdef"><b>Definition:</b> <a href="spacetime__navier__stokes__elements_8h_source.html#l02269">spacetime_navier_stokes_elements.h:2269</a></div></div>
<div class="ttc" id="aclassoomph_1_1SpaceTimeNavierStokesEquations_html_a6d88396b9bb8a88f24f9df1d17e75d0e"><div class="ttname"><a href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a6d88396b9bb8a88f24f9df1d17e75d0e">oomph::SpaceTimeNavierStokesEquations::Pressure_advection_diffusion_robin_element_pt</a></div><div class="ttdeci">Vector&lt; FpPressureAdvDiffRobinBCSpaceTimeElementBase * &gt; Pressure_advection_diffusion_robin_element_pt</div><div class="ttdoc">Storage for FaceElements that apply Robin BC for pressure adv diff equation used in Fp preconditioner...</div><div class="ttdef"><b>Definition:</b> <a href="discontinuous__galerkin__equal__order__pressure__spacetime__navier__stokes__elements_8h_source.html#l00554">discontinuous_galerkin_equal_order_pressure_spacetime_navier_stokes_elements.h:554</a></div></div>
<div class="ttc" id="aclassoomph_1_1Data_html_a559dc196abee87cad34d655c8d6dac1e"><div class="ttname"><a href="classoomph_1_1Data.html#a559dc196abee87cad34d655c8d6dac1e">oomph::Data::value_pt</a></div><div class="ttdeci">double * value_pt(const unsigned &amp;i) const</div><div class="ttdoc">Return the pointer to the i-the stored value. Typically this is required when direct access to the st...</div><div class="ttdef"><b>Definition:</b> <a href="nodes_8h_source.html#l00330">nodes.h:330</a></div></div>
<div class="ttc" id="aclassoomph_1_1QTaylorHoodSpaceTimeElement_html_aeff0bcaa4ac992aa8a8ade46461027e9"><div class="ttname"><a href="classoomph_1_1QTaylorHoodSpaceTimeElement.html#aeff0bcaa4ac992aa8a8ade46461027e9">oomph::QTaylorHoodSpaceTimeElement::output</a></div><div class="ttdeci">void output(FILE *file_pt)</div><div class="ttdoc">Redirect output to NavierStokesEquations output.</div><div class="ttdef"><b>Definition:</b> <a href="spacetime__navier__stokes__elements_8h_source.html#l02285">spacetime_navier_stokes_elements.h:2285</a></div></div>
<div class="ttc" id="aclassoomph_1_1SpaceTimeNavierStokesEquations_html_add14a24e5018ce37ec2115ad43cff7f5"><div class="ttname"><a href="classoomph_1_1SpaceTimeNavierStokesEquations.html#add14a24e5018ce37ec2115ad43cff7f5">oomph::SpaceTimeNavierStokesEquations::viscosity_ratio</a></div><div class="ttdeci">const double &amp; viscosity_ratio() const</div><div class="ttdoc">Viscosity ratio for element: Element's viscosity relative to the viscosity used in the definition of ...</div><div class="ttdef"><b>Definition:</b> <a href="spacetime__navier__stokes__elements_8h_source.html#l00940">spacetime_navier_stokes_elements.h:940</a></div></div>
<div class="ttc" id="aclassoomph_1_1SpaceTimeNavierStokesEquations_html_a2cc20ea6492210b01deccb8d3c5b8dd3"><div class="ttname"><a href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a2cc20ea6492210b01deccb8d3c5b8dd3">oomph::SpaceTimeNavierStokesEquations::dshape_and_dtest_eulerian_nst</a></div><div class="ttdeci">virtual double dshape_and_dtest_eulerian_nst(const Vector&lt; double &gt; &amp;s, Shape &amp;psi, DShape &amp;dpsidx, Shape &amp;test, DShape &amp;dtestdx) const =0</div><div class="ttdoc">Compute the shape functions and derivatives w.r.t. global coords at local coordinate s....</div></div>
<div class="ttc" id="athe__data__structure_8txt_html_af88b2d950fae19ab641bd1690e08445c"><div class="ttname"><a href="the__data__structure_8txt.html#af88b2d950fae19ab641bd1690e08445c">n</a></div><div class="ttdeci">endcode We introduce wrapper functions to access function so that we can formulate The Maths in generic terms Rather than referring to the pressure at node c n</div><div class="ttdef"><b>Definition:</b> <a href="the__data__structure_8txt_source.html#l00582">the_data_structure.txt:582</a></div></div>
<div class="ttc" id="aclassoomph_1_1FiniteElement_html_a5da80bbed97543e586f698251d67941d"><div class="ttname"><a href="classoomph_1_1FiniteElement.html#a5da80bbed97543e586f698251d67941d">oomph::FiniteElement::nodal_local_eqn</a></div><div class="ttdeci">int nodal_local_eqn(const unsigned &amp;n, const unsigned &amp;i) const</div><div class="ttdoc">Return the local equation number corresponding to the i-th value at the n-th local node.</div><div class="ttdef"><b>Definition:</b> <a href="elements_8h_source.html#l01438">elements.h:1438</a></div></div>
<div class="ttc" id="aclassoomph_1_1TemplateFreeSpaceTimeNavierStokesEquationsBase_html_abf2707dd8f8b4eb0d6b5358d039921e1"><div class="ttname"><a href="classoomph_1_1TemplateFreeSpaceTimeNavierStokesEquationsBase.html#abf2707dd8f8b4eb0d6b5358d039921e1">oomph::TemplateFreeSpaceTimeNavierStokesEquationsBase::p_nodal_index_nst</a></div><div class="ttdeci">virtual int p_nodal_index_nst() const =0</div><div class="ttdoc">Return the index at which the pressure is stored if it is stored at the nodes. If not stored at the n...</div></div>
<div class="ttc" id="aclassoomph_1_1SpaceTimeNavierStokesEquations_html_a6a434922a2d92ec0c12978ba7361971b"><div class="ttname"><a href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a6a434922a2d92ec0c12978ba7361971b">oomph::SpaceTimeNavierStokesEquations::fill_in_generic_pressure_advection_diffusion_contribution_nst</a></div><div class="ttdeci">virtual void fill_in_generic_pressure_advection_diffusion_contribution_nst(Vector&lt; double &gt; &amp;residuals, DenseMatrix&lt; double &gt; &amp;jacobian, const unsigned &amp;flag)</div><div class="ttdoc">Compute the residuals for the associated pressure advection diffusion problem. Used by the Fp precond...</div><div class="ttdef"><b>Definition:</b> <a href="discontinuous__galerkin__equal__order__pressure__spacetime__navier__stokes__elements_8cc_source.html#l01812">discontinuous_galerkin_equal_order_pressure_spacetime_navier_stokes_elements.cc:1812</a></div></div>
<div class="ttc" id="aclassoomph_1_1SpaceTimeNavierStokesEquations_html_a9876971336810a9b786bd4d2dc07f3fe"><div class="ttname"><a href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a9876971336810a9b786bd4d2dc07f3fe">oomph::SpaceTimeNavierStokesEquations::interpolated_u_nst</a></div><div class="ttdeci">double interpolated_u_nst(const Vector&lt; double &gt; &amp;s, const unsigned &amp;i) const</div><div class="ttdoc">Return FE interpolated velocity u[i] at local coordinate s.</div><div class="ttdef"><b>Definition:</b> <a href="spacetime__navier__stokes__elements_8h_source.html#l01903">spacetime_navier_stokes_elements.h:1903</a></div></div>
<div class="ttc" id="aclassoomph_1_1ProjectableTaylorHoodSpaceTimeElement_html_abc5ca8c244aa7f3a6bb68856dab812ba"><div class="ttname"><a href="classoomph_1_1ProjectableTaylorHoodSpaceTimeElement.html#abc5ca8c244aa7f3a6bb68856dab812ba">oomph::ProjectableTaylorHoodSpaceTimeElement::local_equation</a></div><div class="ttdeci">int local_equation(const unsigned &amp;fld, const unsigned &amp;j)</div><div class="ttdoc">Return local equation number of value j in field fld.</div><div class="ttdef"><b>Definition:</b> <a href="spacetime__navier__stokes__elements_8h_source.html#l02841">spacetime_navier_stokes_elements.h:2841</a></div></div>
<div class="ttc" id="aclassoomph_1_1FpPressureAdvDiffRobinBCSpaceTimeElement_html_a32a31077f457fd6f64084504ec212c8f"><div class="ttname"><a href="classoomph_1_1FpPressureAdvDiffRobinBCSpaceTimeElement.html#a32a31077f457fd6f64084504ec212c8f">oomph::FpPressureAdvDiffRobinBCSpaceTimeElement::fill_in_contribution_to_residuals</a></div><div class="ttdeci">void fill_in_contribution_to_residuals(Vector&lt; double &gt; &amp;residuals)</div><div class="ttdoc">This function returns just the residuals.</div><div class="ttdef"><b>Definition:</b> <a href="spacetime__navier__stokes__elements_8h_source.html#l00147">spacetime_navier_stokes_elements.h:147</a></div></div>
<div class="ttc" id="aclassoomph_1_1SpaceTimeNavierStokesEquations_html_a57dfce9ee414aa4c37d747ff5205a7d0"><div class="ttname"><a href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a57dfce9ee414aa4c37d747ff5205a7d0">oomph::SpaceTimeNavierStokesEquations::dshape_and_dtest_eulerian_at_knot_nst</a></div><div class="ttdeci">virtual double dshape_and_dtest_eulerian_at_knot_nst(const unsigned &amp;ipt, Shape &amp;psi, DShape &amp;dpsidx, Shape &amp;test, DShape &amp;dtestdx) const =0</div><div class="ttdoc">Compute the shape functions and derivatives w.r.t. global coords at ipt-th integration point Return J...</div></div>
<div class="ttc" id="aclassoomph_1_1ProjectableTaylorHoodSpaceTimeElement_html_a565ba9ed0cf7828d3217111f8c59b489"><div class="ttname"><a href="classoomph_1_1ProjectableTaylorHoodSpaceTimeElement.html#a565ba9ed0cf7828d3217111f8c59b489">oomph::ProjectableTaylorHoodSpaceTimeElement::get_field</a></div><div class="ttdeci">double get_field(const unsigned &amp;t, const unsigned &amp;fld, const Vector&lt; double &gt; &amp;s)</div><div class="ttdoc">Return interpolated field fld at local coordinate s, at time level t (t=0: present; t&gt;0: history valu...</div><div class="ttdef"><b>Definition:</b> <a href="spacetime__navier__stokes__elements_8h_source.html#l02789">spacetime_navier_stokes_elements.h:2789</a></div></div>
<div class="ttc" id="aclassoomph_1_1SpaceTimeNavierStokesEquations_html_a61c38c188cf720f8dbdc39ff608d2f49"><div class="ttname"><a href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a61c38c188cf720f8dbdc39ff608d2f49">oomph::SpaceTimeNavierStokesEquations::density_ratio</a></div><div class="ttdeci">const double &amp; density_ratio() const</div><div class="ttdoc">Density ratio for element: Element's density relative to the viscosity used in the definition of the ...</div><div class="ttdef"><b>Definition:</b> <a href="spacetime__navier__stokes__elements_8h_source.html#l00953">spacetime_navier_stokes_elements.h:953</a></div></div>
<div class="ttc" id="aclassoomph_1_1SpaceTimeNavierStokesEquations_html_a508bc855045d00877f40da1147c62d7f"><div class="ttname"><a href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a508bc855045d00877f40da1147c62d7f">oomph::SpaceTimeNavierStokesEquations::re_st</a></div><div class="ttdeci">const double &amp; re_st() const</div><div class="ttdoc">ReSt parameter (const. version)</div><div class="ttdef"><b>Definition:</b> <a href="spacetime__navier__stokes__elements_8h_source.html#l00883">spacetime_navier_stokes_elements.h:883</a></div></div>
<div class="ttc" id="aclassoomph_1_1SpaceTimeNavierStokesEquations_html_a78df6a6a28df4288cb1d6e8d32a62487"><div class="ttname"><a href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a78df6a6a28df4288cb1d6e8d32a62487">oomph::SpaceTimeNavierStokesEquations::Viscosity_Ratio_pt</a></div><div class="ttdeci">double * Viscosity_Ratio_pt</div><div class="ttdoc">Pointer to the viscosity ratio (relative to the viscosity used in the definition of the Reynolds numb...</div><div class="ttdef"><b>Definition:</b> <a href="discontinuous__galerkin__equal__order__pressure__spacetime__navier__stokes__elements_8h_source.html#l00511">discontinuous_galerkin_equal_order_pressure_spacetime_navier_stokes_elements.h:511</a></div></div>
<div class="ttc" id="aclassoomph_1_1SpaceTimeNavierStokesEquations_html_aa305847a9a9c2e7acde44333f7d1d3e9"><div class="ttname"><a href="classoomph_1_1SpaceTimeNavierStokesEquations.html#aa305847a9a9c2e7acde44333f7d1d3e9">oomph::SpaceTimeNavierStokesEquations::get_load</a></div><div class="ttdeci">void get_load(const Vector&lt; double &gt; &amp;s, const Vector&lt; double &gt; &amp;N, Vector&lt; double &gt; &amp;load)</div><div class="ttdoc">This implements a pure virtual function defined in the FSIFluidElement class. The function computes t...</div><div class="ttdef"><b>Definition:</b> <a href="spacetime__navier__stokes__elements_8h_source.html#l01265">spacetime_navier_stokes_elements.h:1265</a></div></div>
<div class="ttc" id="aclassoomph_1_1QTaylorHoodSpaceTimeElement_html_a96d9c9568f643e4023f8d8828db834da"><div class="ttname"><a href="classoomph_1_1QTaylorHoodSpaceTimeElement.html#a96d9c9568f643e4023f8d8828db834da">oomph::QTaylorHoodSpaceTimeElement::p_nst</a></div><div class="ttdeci">double p_nst(const unsigned &amp;n_p) const</div><div class="ttdoc">Access function for the pressure values at local pressure node n_p (const version)</div><div class="ttdef"><b>Definition:</b> <a href="spacetime__navier__stokes__elements_8h_source.html#l02196">spacetime_navier_stokes_elements.h:2196</a></div></div>
<div class="ttc" id="aclassoomph_1_1FaceElement_html"><div class="ttname"><a href="classoomph_1_1FaceElement.html">oomph::FaceElement</a></div><div class="ttdef"><b>Definition:</b> <a href="elements_8h_source.html#l04397">elements.h:4397</a></div></div>
<div class="ttc" id="aclassoomph_1_1SpaceTimeNavierStokesEquations_html_ad2ae0b3e641cf2c6233f189d83224e44"><div class="ttname"><a href="classoomph_1_1SpaceTimeNavierStokesEquations.html#ad2ae0b3e641cf2c6233f189d83224e44">oomph::SpaceTimeNavierStokesEquations::get_vorticity</a></div><div class="ttdeci">void get_vorticity(const Vector&lt; double &gt; &amp;s, Vector&lt; double &gt; &amp;vorticity) const</div><div class="ttdoc">Compute the vorticity vector at local coordinate s.</div></div>
<div class="ttc" id="aclassoomph_1_1QTaylorHoodSpaceTimeElement_html_ac0fe4b7db0e92afb713bf2398d3ea884"><div class="ttname"><a href="classoomph_1_1QTaylorHoodSpaceTimeElement.html#ac0fe4b7db0e92afb713bf2398d3ea884">oomph::QTaylorHoodSpaceTimeElement::dpshape_and_dptest_eulerian_nst</a></div><div class="ttdeci">double dpshape_and_dptest_eulerian_nst(const Vector&lt; double &gt; &amp;s, Shape &amp;ppsi, DShape &amp;dppsidx, Shape &amp;ptest, DShape &amp;dptestdx) const</div><div class="ttdoc">Pressure shape and test functions and their derivs w.r.t. to global coords at local coordinate s (tak...</div></div>
<div class="ttc" id="aclassoomph_1_1SpaceTimeNavierStokesEquations_html_a02ef091fa753293867a8a50af6ada46b"><div class="ttname"><a href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a02ef091fa753293867a8a50af6ada46b">oomph::SpaceTimeNavierStokesEquations::dpshape_and_dptest_eulerian_nst</a></div><div class="ttdeci">virtual double dpshape_and_dptest_eulerian_nst(const Vector&lt; double &gt; &amp;s, Shape &amp;ppsi, DShape &amp;dppsidx, Shape &amp;ptest, DShape &amp;dptestdx) const =0</div><div class="ttdoc">Compute the pressure shape and test functions and derivatives w.r.t. global coords at local coordinat...</div></div>
<div class="ttc" id="aclassoomph_1_1SpaceTimeNavierStokesEquations_html_a627c81c81889e09c54d3f30684370344"><div class="ttname"><a href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a627c81c81889e09c54d3f30684370344">oomph::SpaceTimeNavierStokesEquations::pinned_fp_pressure_eqn</a></div><div class="ttdeci">int &amp; pinned_fp_pressure_eqn()</div><div class="ttdoc">Global eqn number of pressure dof that's pinned in pressure adv diff problem.</div><div class="ttdef"><b>Definition:</b> <a href="spacetime__navier__stokes__elements_8h_source.html#l01029">spacetime_navier_stokes_elements.h:1029</a></div></div>
<div class="ttc" id="aclassoomph_1_1SpaceTimeNavierStokesEquations_html_a89f30496078869e6cb37ccfe372bc624"><div class="ttname"><a href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a89f30496078869e6cb37ccfe372bc624">oomph::SpaceTimeNavierStokesEquations::is_reynolds_strouhal_stored_as_external_data</a></div><div class="ttdeci">bool is_reynolds_strouhal_stored_as_external_data() const</div><div class="ttdoc">Are we storing the Strouhal number as external data?</div><div class="ttdef"><b>Definition:</b> <a href="spacetime__navier__stokes__elements_8h_source.html#l00859">spacetime_navier_stokes_elements.h:859</a></div></div>
<div class="ttc" id="aclassoomph_1_1SolidNode_html_ae9a8abd197728f5555730131fa0f6971"><div class="ttname"><a href="classoomph_1_1SolidNode.html#ae9a8abd197728f5555730131fa0f6971">oomph::SolidNode::variable_position_pt</a></div><div class="ttdeci">Data *const  &amp; variable_position_pt() const</div><div class="ttdoc">Pointer to variable_position data (const version)</div><div class="ttdef"><b>Definition:</b> <a href="nodes_8h_source.html#l01796">nodes.h:1796</a></div></div>
<div class="ttc" id="aclassoomph_1_1FiniteElement_html_a2ad98a3d2ef4999f1bef62c0ff13f2a7"><div class="ttname"><a href="classoomph_1_1FiniteElement.html#a2ad98a3d2ef4999f1bef62c0ff13f2a7">oomph::FiniteElement::output</a></div><div class="ttdeci">virtual void output(std::ostream &amp;outfile)</div><div class="ttdoc">Output the element data  typically the values at the nodes in a format suitable for post-processing.</div><div class="ttdef"><b>Definition:</b> <a href="elements_8h_source.html#l03067">elements.h:3067</a></div></div>
<div class="ttc" id="aclassoomph_1_1ProjectableTaylorHoodSpaceTimeElement_html_a7ff4171a511f42a9f0648629cf90b25e"><div class="ttname"><a href="classoomph_1_1ProjectableTaylorHoodSpaceTimeElement.html#a7ff4171a511f42a9f0648629cf90b25e">oomph::ProjectableTaylorHoodSpaceTimeElement::nvalue_of_field</a></div><div class="ttdeci">unsigned nvalue_of_field(const unsigned &amp;fld)</div><div class="ttdoc">Return number of values in field fld.</div><div class="ttdef"><b>Definition:</b> <a href="spacetime__navier__stokes__elements_8h_source.html#l02827">spacetime_navier_stokes_elements.h:2827</a></div></div>
<div class="ttc" id="acfortran_8h_html_a37cd013acc76697829c324bdd8562d82"><div class="ttname"><a href="cfortran_8h.html#a37cd013acc76697829c324bdd8562d82">e</a></div><div class="ttdeci">e</div><div class="ttdef"><b>Definition:</b> <a href="cfortran_8h_source.html#l00571">cfortran.h:571</a></div></div>
<div class="ttc" id="aclassoomph_1_1SpaceTimeNavierStokesEquations_html_a32884d8125df9d1a7d49d956cc497175"><div class="ttname"><a href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a32884d8125df9d1a7d49d956cc497175">oomph::SpaceTimeNavierStokesEquations::Press_adv_diff_source_fct_pt</a></div><div class="ttdeci">NavierStokesPressureAdvDiffSourceFctPt Press_adv_diff_source_fct_pt</div><div class="ttdoc">Pointer to source function pressure advection diffusion equation (only to be used during validation)</div><div class="ttdef"><b>Definition:</b> <a href="discontinuous__galerkin__equal__order__pressure__spacetime__navier__stokes__elements_8h_source.html#l00544">discontinuous_galerkin_equal_order_pressure_spacetime_navier_stokes_elements.h:544</a></div></div>
<div class="ttc" id="aclassoomph_1_1SpaceTimeNavierStokesEquations_html_ab52489186df878709c4402b33aeaaeca"><div class="ttname"><a href="classoomph_1_1SpaceTimeNavierStokesEquations.html#ab52489186df878709c4402b33aeaaeca">oomph::SpaceTimeNavierStokesEquations::SpaceTimeNavierStokesEquations</a></div><div class="ttdeci">SpaceTimeNavierStokesEquations()</div><div class="ttdoc">Constructor: NULL the body force and source function and make sure the ALE terms are included by defa...</div><div class="ttdef"><b>Definition:</b> <a href="spacetime__navier__stokes__elements_8h_source.html#l00784">spacetime_navier_stokes_elements.h:784</a></div></div>
<div class="ttc" id="aclassoomph_1_1SpaceTimeNavierStokesEquations_html_a8ad8ed69a1ff73a486d37e2aa5fdb0ad"><div class="ttname"><a href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a8ad8ed69a1ff73a486d37e2aa5fdb0ad">oomph::SpaceTimeNavierStokesEquations::output</a></div><div class="ttdeci">void output(std::ostream &amp;outfile)</div><div class="ttdoc">Output function: x,y,t,u,v,p in tecplot format. The default number of plot points is five.</div><div class="ttdef"><b>Definition:</b> <a href="spacetime__navier__stokes__elements_8h_source.html#l01452">spacetime_navier_stokes_elements.h:1452</a></div></div>
<div class="ttc" id="aclassoomph_1_1SpaceTimeNavierStokesEquations_html_a86dbb875cab37d44bfa5a4113915f77a"><div class="ttname"><a href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a86dbb875cab37d44bfa5a4113915f77a">oomph::SpaceTimeNavierStokesEquations::source_fct_for_pressure_adv_diff</a></div><div class="ttdeci">NavierStokesPressureAdvDiffSourceFctPt &amp; source_fct_for_pressure_adv_diff()</div><div class="ttdoc">Access function for the source-function pointer for pressure advection diffusion (used for validation...</div><div class="ttdef"><b>Definition:</b> <a href="spacetime__navier__stokes__elements_8h_source.html#l01014">spacetime_navier_stokes_elements.h:1014</a></div></div>
<div class="ttc" id="anamespaceoomph_1_1OneDimLagrange_html_a956411abc42594a039c368e4ef69f48e"><div class="ttname"><a href="namespaceoomph_1_1OneDimLagrange.html#a956411abc42594a039c368e4ef69f48e">oomph::OneDimLagrange::dshape&lt; 2 &gt;</a></div><div class="ttdeci">void dshape&lt; 2 &gt;(const double &amp;s, double *DPsi)</div><div class="ttdoc">Derivatives of 1D shape functions specialised to linear order (2 Nodes)</div><div class="ttdef"><b>Definition:</b> <a href="shape_8h_source.html#l00625">shape.h:625</a></div></div>
<div class="ttc" id="aclassoomph_1_1FiniteElement_html_a28fd5c2d4aeba5ef65bee0e0d72569f5"><div class="ttname"><a href="classoomph_1_1FiniteElement.html#a28fd5c2d4aeba5ef65bee0e0d72569f5">oomph::FiniteElement::nodal_value</a></div><div class="ttdeci">double nodal_value(const unsigned &amp;n, const unsigned &amp;i) const</div><div class="ttdoc">Return the i-th value stored at local node n. Produces suitably interpolated values for hanging nodes...</div><div class="ttdef"><b>Definition:</b> <a href="elements_8h_source.html#l02610">elements.h:2610</a></div></div>
<div class="ttc" id="aclassoomph_1_1SpaceTimeNavierStokesEquations_html_afbeb69aaf848428c93956f31d47f7622"><div class="ttname"><a href="classoomph_1_1SpaceTimeNavierStokesEquations.html#afbeb69aaf848428c93956f31d47f7622">oomph::SpaceTimeNavierStokesEquations::output_vorticity</a></div><div class="ttdeci">void output_vorticity(std::ostream &amp;outfile, const unsigned &amp;nplot)</div><div class="ttdoc">Output function: x,y,t,omega in tecplot format. nplot points in each coordinate direction.</div><div class="ttdef"><b>Definition:</b> <a href="discontinuous__galerkin__equal__order__pressure__spacetime__navier__stokes__elements_8cc_source.html#l01223">discontinuous_galerkin_equal_order_pressure_spacetime_navier_stokes_elements.cc:1223</a></div></div>
<div class="ttc" id="aclassoomph_1_1SpaceTimeNavierStokesEquations_html_a5591b7cb6a6560aec9f7cc058798c63c"><div class="ttname"><a href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a5591b7cb6a6560aec9f7cc058798c63c">oomph::SpaceTimeNavierStokesEquations::interpolated_p_nst</a></div><div class="ttdeci">virtual double interpolated_p_nst(const Vector&lt; double &gt; &amp;s) const</div><div class="ttdoc">Return FE interpolated pressure at local coordinate s.</div><div class="ttdef"><b>Definition:</b> <a href="discontinuous__galerkin__equal__order__pressure__spacetime__navier__stokes__elements_8h_source.html#l02043">discontinuous_galerkin_equal_order_pressure_spacetime_navier_stokes_elements.h:2043</a></div></div>
<div class="ttc" id="aclassoomph_1_1SpaceTimeNavierStokesEquations_html_ae25ed8682172ec91a8f72787ff98ff9b"><div class="ttname"><a href="classoomph_1_1SpaceTimeNavierStokesEquations.html#ae25ed8682172ec91a8f72787ff98ff9b">oomph::SpaceTimeNavierStokesEquations::output_pressure_advection_diffusion_robin_elements</a></div><div class="ttdeci">void output_pressure_advection_diffusion_robin_elements(std::ostream &amp;outfile)</div><div class="ttdoc">Output the FaceElements that apply the Robin boundary condition to the pressure advection diffusion p...</div><div class="ttdef"><b>Definition:</b> <a href="spacetime__navier__stokes__elements_8h_source.html#l01813">spacetime_navier_stokes_elements.h:1813</a></div></div>
<div class="ttc" id="aclassoomph_1_1FiniteElement_html_a06d32c85753a1e302c3b345ea27f6c85"><div class="ttname"><a href="classoomph_1_1FiniteElement.html#a06d32c85753a1e302c3b345ea27f6c85">oomph::FiniteElement::nplot_points_paraview</a></div><div class="ttdeci">virtual unsigned nplot_points_paraview(const unsigned &amp;nplot) const</div><div class="ttdoc">Return the number of actual plot points for paraview plot with parameter nplot. Broken virtual; can b...</div><div class="ttdef"><b>Definition:</b> <a href="elements_8h_source.html#l02879">elements.h:2879</a></div></div>
<div class="ttc" id="aclassoomph_1_1SpaceTimeNavierStokesEquations_html_a9af90d7010d22eb4a672b79c977774d9"><div class="ttname"><a href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a9af90d7010d22eb4a672b79c977774d9">oomph::SpaceTimeNavierStokesEquations::NavierStokesSourceFctPt</a></div><div class="ttdeci">double(* NavierStokesSourceFctPt)(const double &amp;time, const Vector&lt; double &gt; &amp;x)</div><div class="ttdoc">Function pointer to source function fct(t,x) (x is a Vector!)</div><div class="ttdef"><b>Definition:</b> <a href="discontinuous__galerkin__equal__order__pressure__spacetime__navier__stokes__elements_8h_source.html#l00481">discontinuous_galerkin_equal_order_pressure_spacetime_navier_stokes_elements.h:481</a></div></div>
<div class="ttc" id="aclassoomph_1_1Shape_html"><div class="ttname"><a href="classoomph_1_1Shape.html">oomph::Shape</a></div><div class="ttdef"><b>Definition:</b> <a href="shape_8h_source.html#l00075">shape.h:75</a></div></div>
<div class="ttc" id="aclassoomph_1_1SpaceTimeNavierStokesEquations_html"><div class="ttname"><a href="classoomph_1_1SpaceTimeNavierStokesEquations.html">oomph::SpaceTimeNavierStokesEquations</a></div><div class="ttdef"><b>Definition:</b> <a href="discontinuous__galerkin__equal__order__pressure__spacetime__navier__stokes__elements_8h_source.html#l00469">discontinuous_galerkin_equal_order_pressure_spacetime_navier_stokes_elements.h:469</a></div></div>
<div class="ttc" id="aclassoomph_1_1FpPressureAdvDiffRobinBCSpaceTimeElement_html_a1231fdc022cff3f147966f019e4bb1c2"><div class="ttname"><a href="classoomph_1_1FpPressureAdvDiffRobinBCSpaceTimeElement.html#a1231fdc022cff3f147966f019e4bb1c2">oomph::FpPressureAdvDiffRobinBCSpaceTimeElement::output</a></div><div class="ttdeci">void output(std::ostream &amp;outfile, const unsigned &amp;nplot)</div><div class="ttdoc">Output function: x,y,[z],u,v,[w],p in tecplot format.</div><div class="ttdef"><b>Definition:</b> <a href="spacetime__navier__stokes__elements_8h_source.html#l00192">spacetime_navier_stokes_elements.h:192</a></div></div>
<div class="ttc" id="aclassoomph_1_1FpPressureAdvDiffRobinBCSpaceTimeElement_html_a236e28f418427994d84dc0d4ce468078"><div class="ttname"><a href="classoomph_1_1FpPressureAdvDiffRobinBCSpaceTimeElement.html#a236e28f418427994d84dc0d4ce468078">oomph::FpPressureAdvDiffRobinBCSpaceTimeElement::output</a></div><div class="ttdeci">void output(std::ostream &amp;outfile)</div><div class="ttdoc">Overload the output function.</div><div class="ttdef"><b>Definition:</b> <a href="spacetime__navier__stokes__elements_8h_source.html#l00184">spacetime_navier_stokes_elements.h:184</a></div></div>
<div class="ttc" id="aclassoomph_1_1SpaceTimeNavierStokesEquations_html_aa63da32216268c2c02f0c56de684799a"><div class="ttname"><a href="classoomph_1_1SpaceTimeNavierStokesEquations.html#aa63da32216268c2c02f0c56de684799a">oomph::SpaceTimeNavierStokesEquations::density_ratio_pt</a></div><div class="ttdeci">double *&amp; density_ratio_pt()</div><div class="ttdoc">Pointer to Density ratio.</div><div class="ttdef"><b>Definition:</b> <a href="spacetime__navier__stokes__elements_8h_source.html#l00959">spacetime_navier_stokes_elements.h:959</a></div></div>
<div class="ttc" id="aclassoomph_1_1SpaceTimeNavierStokesEquations_html_ae3a8e5382fff21bf62358c1c5dbec337"><div class="ttname"><a href="classoomph_1_1SpaceTimeNavierStokesEquations.html#ae3a8e5382fff21bf62358c1c5dbec337">oomph::SpaceTimeNavierStokesEquations::re_invfr_pt</a></div><div class="ttdeci">double *&amp; re_invfr_pt()</div><div class="ttdoc">Pointer to global inverse Froude number.</div><div class="ttdef"><b>Definition:</b> <a href="spacetime__navier__stokes__elements_8h_source.html#l00971">spacetime_navier_stokes_elements.h:971</a></div></div>
<div class="ttc" id="aclassoomph_1_1SpaceTimeNavierStokesEquations_html_a6564a776dce312aad43b9317d7f1373c"><div class="ttname"><a href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a6564a776dce312aad43b9317d7f1373c">oomph::SpaceTimeNavierStokesEquations::NavierStokesBodyForceFctPt</a></div><div class="ttdeci">void(* NavierStokesBodyForceFctPt)(const double &amp;time, const Vector&lt; double &gt; &amp;x, Vector&lt; double &gt; &amp;body_force)</div><div class="ttdoc">Function pointer to body force function fct(t,x,f(x)) x is a Vector!</div><div class="ttdef"><b>Definition:</b> <a href="discontinuous__galerkin__equal__order__pressure__spacetime__navier__stokes__elements_8h_source.html#l00476">discontinuous_galerkin_equal_order_pressure_spacetime_navier_stokes_elements.h:476</a></div></div>
<div class="ttc" id="aclassoomph_1_1FpPressureAdvDiffRobinBCSpaceTimeElementBase_html_a10e4cc67a5eed9f05e53dc75484427ac"><div class="ttname"><a href="classoomph_1_1FpPressureAdvDiffRobinBCSpaceTimeElementBase.html#a10e4cc67a5eed9f05e53dc75484427ac">oomph::FpPressureAdvDiffRobinBCSpaceTimeElementBase::~FpPressureAdvDiffRobinBCSpaceTimeElementBase</a></div><div class="ttdeci">virtual ~FpPressureAdvDiffRobinBCSpaceTimeElementBase()</div><div class="ttdoc">Empty virtual destructor.</div><div class="ttdef"><b>Definition:</b> <a href="spacetime__navier__stokes__elements_8h_source.html#l00053">spacetime_navier_stokes_elements.h:53</a></div></div>
<div class="ttc" id="aclassoomph_1_1SpaceTimeNavierStokesEquations_html_abef79bee69def157749fcfbcd80306e7"><div class="ttname"><a href="classoomph_1_1SpaceTimeNavierStokesEquations.html#abef79bee69def157749fcfbcd80306e7">oomph::SpaceTimeNavierStokesEquations::output_veloc</a></div><div class="ttdeci">void output_veloc(std::ostream &amp;outfile, const unsigned &amp;nplot, const unsigned &amp;t)</div><div class="ttdoc">Output function: x,y,t,u,v in tecplot format. Use n_plot points in each coordinate direction at times...</div><div class="ttdef"><b>Definition:</b> <a href="discontinuous__galerkin__equal__order__pressure__spacetime__navier__stokes__elements_8cc_source.html#l00928">discontinuous_galerkin_equal_order_pressure_spacetime_navier_stokes_elements.cc:928</a></div></div>
<div class="ttc" id="aclassoomph_1_1SpaceTimeNavierStokesEquations_html_a9e5bcf75cc0136feb9c75cdca9a226cc"><div class="ttname"><a href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a9e5bcf75cc0136feb9c75cdca9a226cc">oomph::SpaceTimeNavierStokesEquations::re_invfr</a></div><div class="ttdeci">const double &amp; re_invfr() const</div><div class="ttdoc">Global inverse Froude number.</div><div class="ttdef"><b>Definition:</b> <a href="spacetime__navier__stokes__elements_8h_source.html#l00965">spacetime_navier_stokes_elements.h:965</a></div></div>
<div class="ttc" id="aclassoomph_1_1SpaceTimeNavierStokesEquations_html_afd23eef3de24ed5a454f272358601b6b"><div class="ttname"><a href="classoomph_1_1SpaceTimeNavierStokesEquations.html#afd23eef3de24ed5a454f272358601b6b">oomph::SpaceTimeNavierStokesEquations::scalar_name_paraview</a></div><div class="ttdeci">std::string scalar_name_paraview(const unsigned &amp;i) const</div><div class="ttdoc">Name of the i-th scalar field. Default implementation returns V1 for the first one,...</div><div class="ttdef"><b>Definition:</b> <a href="spacetime__navier__stokes__elements_8h_source.html#l01416">spacetime_navier_stokes_elements.h:1416</a></div></div>
<div class="ttc" id="acfortran_8h_html_ab7123126e4885ef647dd9c6e3807a21c"><div class="ttname"><a href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a></div><div class="ttdeci">static char t char * s</div><div class="ttdef"><b>Definition:</b> <a href="cfortran_8h_source.html#l00568">cfortran.h:568</a></div></div>
<div class="ttc" id="aclassoomph_1_1SpaceTimeNavierStokesEquations_html_aecc863dbffc26cf2961d7783bb5237c6"><div class="ttname"><a href="classoomph_1_1SpaceTimeNavierStokesEquations.html#aecc863dbffc26cf2961d7783bb5237c6">oomph::SpaceTimeNavierStokesEquations::build_fp_press_adv_diff_robin_bc_element</a></div><div class="ttdeci">virtual void build_fp_press_adv_diff_robin_bc_element(const unsigned &amp;face_index)=0</div><div class="ttdoc">Build FaceElements that apply the Robin boundary condition to the pressure advection diffusion proble...</div></div>
<div class="ttc" id="aclassoomph_1_1SpaceTimeNavierStokesEquations_html_a9484c60ff5a5099f41d277c1d2cf79f4"><div class="ttname"><a href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a9484c60ff5a5099f41d277c1d2cf79f4">oomph::SpaceTimeNavierStokesEquations::npres_nst</a></div><div class="ttdeci">virtual unsigned npres_nst() const =0</div><div class="ttdoc">Function to return number of pressure degrees of freedom.</div></div>
<div class="ttc" id="aclassoomph_1_1FaceGeometry_html"><div class="ttname"><a href="classoomph_1_1FaceGeometry.html">oomph::FaceGeometry</a></div><div class="ttdef"><b>Definition:</b> <a href="elements_8h_source.html#l05063">elements.h:5063</a></div></div>
<div class="ttc" id="aclassoomph_1_1FaceGeometry_3_01FaceGeometry_3_01QTaylorHoodSpaceTimeElement_3_012_01_4_01_4_01_4_html_af2a67e91d650c1a4fb03f7115acd60aa"><div class="ttname"><a href="classoomph_1_1FaceGeometry_3_01FaceGeometry_3_01QTaylorHoodSpaceTimeElement_3_012_01_4_01_4_01_4.html#af2a67e91d650c1a4fb03f7115acd60aa">oomph::FaceGeometry&lt; FaceGeometry&lt; QTaylorHoodSpaceTimeElement&lt; 2 &gt; &gt; &gt;::FaceGeometry</a></div><div class="ttdeci">FaceGeometry()</div><div class="ttdoc">Constructor; empty.</div><div class="ttdef"><b>Definition:</b> <a href="spacetime__navier__stokes__elements_8h_source.html#l02623">spacetime_navier_stokes_elements.h:2623</a></div></div>
<div class="ttc" id="aclassoomph_1_1TemplateFreeSpaceTimeNavierStokesEquationsBase_html_a154b81d06df3cd89e641dc95b46ef7d8"><div class="ttname"><a href="classoomph_1_1TemplateFreeSpaceTimeNavierStokesEquationsBase.html#a154b81d06df3cd89e641dc95b46ef7d8">oomph::TemplateFreeSpaceTimeNavierStokesEquationsBase::build_fp_press_adv_diff_robin_bc_element</a></div><div class="ttdeci">virtual void build_fp_press_adv_diff_robin_bc_element(const unsigned &amp;face_index)=0</div><div class="ttdoc">Build FaceElements that apply the Robin boundary condition to the pressure advection diffusion proble...</div></div>
<div class="ttc" id="aclassoomph_1_1SpaceTimeNavierStokesEquations_html_a7140c69be3970e645773bb5d6ae41e34"><div class="ttname"><a href="classoomph_1_1SpaceTimeNavierStokesEquations.html#a7140c69be3970e645773bb5d6ae41e34">oomph::SpaceTimeNavierStokesEquations::fill_in_generic_dresidual_contribution_nst</a></div><div class="ttdeci">virtual void fill_in_generic_dresidual_contribution_nst(double *const &amp;parameter_pt, Vector&lt; double &gt; &amp;dres_dparam, DenseMatrix&lt; double &gt; &amp;djac_dparam, DenseMatrix&lt; double &gt; &amp;dmass_matrix_dparam, const unsigned &amp;flag)</div><div class="ttdoc">Compute the derivatives of the residuals for the Navier-Stokes equations with respect to a parameter ...</div><div class="ttdef"><b>Definition:</b> <a href="discontinuous__galerkin__equal__order__pressure__spacetime__navier__stokes__elements_8cc_source.html#l02443">discontinuous_galerkin_equal_order_pressure_spacetime_navier_stokes_elements.cc:2443</a></div></div>
<div class="ttc" id="anamespaceoomph_1_1StringConversion_html_a9d30fabdc1a0694bdb91dddd2833bbd6"><div class="ttname"><a href="namespaceoomph_1_1StringConversion.html#a9d30fabdc1a0694bdb91dddd2833bbd6">oomph::StringConversion::to_string</a></div><div class="ttdeci">std::string to_string(T object, unsigned float_precision=8)</div><div class="ttdoc">Conversion function that should work for anything with operator&lt;&lt; defined (at least all basic types).</div><div class="ttdef"><b>Definition:</b> <a href="oomph__utilities_8h_source.html#l00189">oomph_utilities.h:189</a></div></div>
<div class="ttc" id="aclassoomph_1_1SpaceTimeNavierStokesEquations_html_ade0310ded6cc0389443fe19e99ca3ea7"><div class="ttname"><a href="classoomph_1_1SpaceTimeNavierStokesEquations.html#ade0310ded6cc0389443fe19e99ca3ea7">oomph::SpaceTimeNavierStokesEquations::fix_pressure</a></div><div class="ttdeci">virtual void fix_pressure(const unsigned &amp;p_dof, const double &amp;p_value)=0</div><div class="ttdoc">Pin p_dof-th pressure dof and set it to value specified by p_value.</div></div>
<div class="ttc" id="anamespaceoomph_1_1Global__string__for__annotation_html_ac5379de2fa7fe44f2cb31785fc208135"><div class="ttname"><a href="namespaceoomph_1_1Global__string__for__annotation.html#ac5379de2fa7fe44f2cb31785fc208135">oomph::Global_string_for_annotation::string</a></div><div class="ttdeci">std::string string(const unsigned &amp;i)</div><div class="ttdoc">Return the i-th string or &quot;&quot; if the relevant string hasn't been defined.</div><div class="ttdef"><b>Definition:</b> <a href="oomph__definitions_8cc_source.html#l00286">oomph_definitions.cc:286</a></div></div>

    <!-- jQuery for Bootstrap and Doxygen -->
    <script src="../../js/jquery-1.12.0.min.js"></script>
    <!-- Minified boostrap plugins-->
    <script src="../../js/bootstrap.js"></script>
    <!-- Doxygen dependency to add powertips to source code-->
    <script src="../../js/jquery.powertip.min.js"></script>
    <!-- The  following script is generated by doxygen and hides/shows levels in 
         the data structure lists and adds powertips to source code-->
    <script src="../../js/dynsections.js" ></script>
    <!-- add to Doxygen's class names so bootstrap css and js recognises them-->
    <script type="text/javascript">
    $(".contents").addClass("container");
    $(".header").addClass("container");
    $(".navpath").addClass("container");
    $("#navrow3").addClass("container");
    $("#navrow4").addClass("container");
    $(".mlabel").addClass("label");
    $(".mlabel").addClass("label-default");
    $(".memitem").addClass("panel");
    $(".memitem").addClass("panel-info");
    $(".memproto").addClass("panel-heading");
    $(".memdoc").addClass("panel-body");
    </script>
    <footer>
      <div class="container">
        <div class="text-muted" style="float:right;">Generated by <a href="http://www.doxygen.org/index.html">
          <img style="height:18px;" class="footer-img" src="doxygen.png" alt="doxygen"></a> on Fri Aug 27 2021 17:17:55
        </div>
      </div>
    </footer>
</body>
</html>

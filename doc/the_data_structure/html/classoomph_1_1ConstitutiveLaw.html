<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
<title>oomph-lib: oomph::ConstitutiveLaw Class Reference</title>
<link rel="apple-touch-icon" sizes="57x57" href="../../figures/apple-touch-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="../../figures/apple-touch-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="../../figures/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="../../figures/apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="../../figures/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="../../figures/apple-touch-icon-120x120.png">
<link rel="icon" type="image/png" href="../../figures/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="../../figures/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="../../figures/favicon-16x16.png" sizes="16x16">
<link rel="manifest" href="../../figures/manifest.json">
<link rel="mask-icon" href="../../figures/safari-pinned-tab.svg" color="#008000">
<link rel="shortcut icon" href="../../figures/favicon.ico">
<meta name="msapplication-TileColor" content="#00a300">
<meta name="msapplication-config" content="../../figures/browserconfig.xml">
<meta name="theme-color" content="#008000">
<link href="http://fonts.googleapis.com/css?family=Open+Sans:400,300,600" rel="stylesheet" type="text/css">
<!-- Doxygen css-->
<!-- <link rel="stylesheet" type="text/css" href="doxygen.css"> -->
<!-- Bootstrap -->
<link href="../../css/bootstrap.css" rel="stylesheet">
<!-- oomph-lib specific overrides -->
<link rel="stylesheet" type="text/css" href="../../css/oomph_header.css">
</head>
<body>
<nav class="navbar navbar-default">
<div class="container">
<div class="container-fluid">
  <!-- Brand and toggle get grouped for better mobile display -->
  <div class="navbar-header">
    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
      <span class="sr-only">Toggle navigation</span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="../../html/index.html"><img alt="oomph-lib" src="../../figures/oomph_logo.png"></a>
  </div>
  <!-- Collect the nav links, forms, and other content for toggling -->
  <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
    <ul class="nav navbar-nav">          
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Documentation <span class="caret"></span></a>
        <ul class="dropdown-menu">
          <li class="dropdown-header">Big picture</li>
          <li><a href="../../../doc/intro/html/index.html">The finite element method</a></li>
          <li><a href="../../../doc/the_data_structure/html/index.html">The data structure</a></li>
          <li><a href="../../../doc/quick_guide/html/index.html">Not-so-quick guide</a></li>
          <li><a href="../../../doc/optimisation/html/index.html">Optimisation</a></li>
          <li><a href="../../../doc/order_of_action_functions/html/index.html">Order of action functions</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Example codes and tutorials</li>
          <li><a href="../../../doc/example_code_list/html/index.html">List of example codes and tutorials</a></li>
          <li><a href="../../../doc/example_code_list/html/index.html#meshes">Meshing</a></li>
          <li><a href="../../../doc/example_code_list/html/index.html#solvers">Solvers</a></li>
          <li><a href="../../../doc/example_code_list/html/index.html#parallel">MPI parallel processing</a></li>
          <li><a href="../../../doc/example_code_list/html/index.html#visualisation">Post-processing/visualisation</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Other</li>
          <li><a href="../../../doc/change_log/html/index.html">Change log</a></li>
          <li><a href="../../../doc/creating_doc/html/index.html">Creating documentation</a></li>
          <li><a href="../../../doc/coding_conventions/html/index.html">Coding conventions</a></li>
          <li><a href="../../../doc/index/html/index.html">Index</a></li>
          <li><a href="../../../doc/FAQ/html/index.html">FAQ</a></li>
        </ul>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Installation<span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../doc/the_distribution/html/index.html">Installation guide</a></li>
            <li><a href="../../../doc/copyright/html/index.html">Copyright</a></li>
          </ul>
        </li>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">About <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../doc/people/html/index.html">People</a></li>            
            <li><a href="../../../doc/contact/html/index.html">Contact/Get involved</a></li>
            <li><a href="../../../doc/publications/html/index.html">Publications</a></li>
            <li><a href="../../../doc/acknowledgements/html/index.html">Acknowledgements</a></li>
            <li><a href="../../../doc/picture_show/index.html">Picture show</a></li>
          </ul>
        </li>
      </li>
    </ul>
    <ul class="nav navbar-nav navbar-right navbar-search">
      <form class="navbar-form" role="search" action="../../../doc/search_results/html/index.html">
        <div class="input-group">
          <input type="text" class="form-control" placeholder="Search" name="q">
          <span class="input-group-btn">
            <button class="btn btn-default" type="submit">Go</button>
          </span>
        </div><!-- /input-group -->
       <!--<div class="form-group">
          <input type="text" class="form-control" placeholder="Search">
        </div>
        <button type="submit" class="btn btn-default">Submit</button>-->
      </form>
    </ul>
  </div><!-- /.navbar-collapse -->
</div><!-- /.container-fluid -->
</div>
</nav>
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespaceoomph.html">oomph</a></li><li class="navelem"><a class="el" href="classoomph_1_1ConstitutiveLaw.html">ConstitutiveLaw</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="classoomph_1_1ConstitutiveLaw-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">oomph::ConstitutiveLaw Class Reference<span class="mlabels"><span class="mlabel">abstract</span></span></div>  </div>
</div><!--header-->
<div class="contents">

<p>///////////////////////////////////////////////////////////////// /////////////////////////////////////////////////////////////////  
 <a href="classoomph_1_1ConstitutiveLaw.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="constitutive__laws_8h_source.html">constitutive_laws.h</a>&gt;</code></p>
<div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Inheritance diagram for oomph::ConstitutiveLaw:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
 <div class="center">
  <img src="classoomph_1_1ConstitutiveLaw.png" usemap="#oomph::ConstitutiveLaw_map" alt=""/>
  <map id="oomph::ConstitutiveLaw_map" name="oomph::ConstitutiveLaw_map">
<area href="classoomph_1_1GeneralisedHookean.html" title="////////////////////////////////////////////////////////////////////// //////////////////////////////..." alt="oomph::GeneralisedHookean" shape="rect" coords="0,56,314,80"/>
<area href="classoomph_1_1IsotropicStrainEnergyFunctionConstitutiveLaw.html" title="////////////////////////////////////////////////////////////////////// //////////////////////////////..." alt="oomph::IsotropicStrainEnergyFunctionConstitutiveLaw" shape="rect" coords="324,56,638,80"/>
  </map>
</div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a864c36413e8ea31e63552f3db3b97a2f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoomph_1_1ConstitutiveLaw.html#a864c36413e8ea31e63552f3db3b97a2f">ConstitutiveLaw</a> ()</td></tr>
<tr class="memdesc:a864c36413e8ea31e63552f3db3b97a2f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Empty constructor.  <a href="classoomph_1_1ConstitutiveLaw.html#a864c36413e8ea31e63552f3db3b97a2f">More...</a><br /></td></tr>
<tr class="separator:a864c36413e8ea31e63552f3db3b97a2f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa75b88c826723ba090ace39c26da0ae6"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoomph_1_1ConstitutiveLaw.html#aa75b88c826723ba090ace39c26da0ae6">~ConstitutiveLaw</a> ()</td></tr>
<tr class="memdesc:aa75b88c826723ba090ace39c26da0ae6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Empty virtual destructor.  <a href="classoomph_1_1ConstitutiveLaw.html#aa75b88c826723ba090ace39c26da0ae6">More...</a><br /></td></tr>
<tr class="separator:aa75b88c826723ba090ace39c26da0ae6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a93527d910de908035feb8f41b0401065"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoomph_1_1ConstitutiveLaw.html#a93527d910de908035feb8f41b0401065">calculate_second_piola_kirchhoff_stress</a> (const <a class="el" href="classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; double &gt; &amp;g, const <a class="el" href="classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; double &gt; &amp;G, <a class="el" href="classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; double &gt; &amp;sigma)=0</td></tr>
<tr class="memdesc:a93527d910de908035feb8f41b0401065"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the contravariant 2nd Piola Kirchhoff stress tensor. Arguments are the covariant undeformed and deformed metric tensor and the matrix in which to return the stress tensor.  <a href="classoomph_1_1ConstitutiveLaw.html#a93527d910de908035feb8f41b0401065">More...</a><br /></td></tr>
<tr class="separator:a93527d910de908035feb8f41b0401065"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6076752384082cfa3de3e0cf17daa9aa"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoomph_1_1ConstitutiveLaw.html#a6076752384082cfa3de3e0cf17daa9aa">calculate_d_second_piola_kirchhoff_stress_dG</a> (const <a class="el" href="classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; double &gt; &amp;g, const <a class="el" href="classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; double &gt; &amp;G, const <a class="el" href="classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; double &gt; &amp;sigma, <a class="el" href="classoomph_1_1RankFourTensor.html">RankFourTensor</a>&lt; double &gt; &amp;d_sigma_dG, const bool &amp;symmetrize_tensor=true)</td></tr>
<tr class="memdesc:a6076752384082cfa3de3e0cf17daa9aa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the derivatives of the contravariant 2nd Piola Kirchhoff stress tensor with respect to the deformed metric tensor. Arguments are the covariant undeformed and deformed metric tensor, the current value of the stress tensor and the rank four tensor in which to return the derivatives of the stress tensor The default implementation uses finite differences, but can be overloaded for constitutive laws in which an analytic formulation is possible. If the boolean flag symmetrize_tensor is false, only the "upper  triangular" entries of the tensor will be filled in. This is a useful efficiency when using the derivatives in Jacobian calculations.  <a href="classoomph_1_1ConstitutiveLaw.html#a6076752384082cfa3de3e0cf17daa9aa">More...</a><br /></td></tr>
<tr class="separator:a6076752384082cfa3de3e0cf17daa9aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac8178b1b7cd7e6a64942dba9e0997b30"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoomph_1_1ConstitutiveLaw.html#ac8178b1b7cd7e6a64942dba9e0997b30">calculate_second_piola_kirchhoff_stress</a> (const <a class="el" href="classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; double &gt; &amp;g, const <a class="el" href="classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; double &gt; &amp;G, <a class="el" href="classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; double &gt; &amp;sigma_dev, <a class="el" href="classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; double &gt; &amp;G_contra, double &amp;Gdet)</td></tr>
<tr class="memdesc:ac8178b1b7cd7e6a64942dba9e0997b30"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the deviatoric part <img class="formulaInl" alt="$ \overline{ \sigma^{ij}}$" src="form_119.png" width="18" height="13"/> of the contravariant 2nd Piola Kirchhoff stress tensor <img class="formulaInl" alt="$ \sigma^{ij}$" src="form_113.png" width="15" height="11"/>. Also return the contravariant deformed metric tensor and the determinant of the deformed metric tensor. This form is appropriate for truly-incompressible materials for which <img class="formulaInl" alt="$ \sigma^{ij} = - p G^{ij} +\overline{ \sigma^{ij}} $" src="form_120.png" width="99" height="15"/> where the "pressure" <img class="formulaInl" alt="$ p $" src="form_117.png" width="8" height="9"/> is determined by <img class="formulaInl" alt="$ \det G_{ij} - \det g_{ij} = 0 $" src="form_121.png" width="111" height="14"/>.  <a href="classoomph_1_1ConstitutiveLaw.html#ac8178b1b7cd7e6a64942dba9e0997b30">More...</a><br /></td></tr>
<tr class="separator:ac8178b1b7cd7e6a64942dba9e0997b30"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af13f9d05db09870d1b90b7ef389bdb71"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoomph_1_1ConstitutiveLaw.html#af13f9d05db09870d1b90b7ef389bdb71">calculate_d_second_piola_kirchhoff_stress_dG</a> (const <a class="el" href="classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; double &gt; &amp;g, const <a class="el" href="classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; double &gt; &amp;G, const <a class="el" href="classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; double &gt; &amp;sigma, const double &amp;detG, const double &amp;interpolated_solid_p, <a class="el" href="classoomph_1_1RankFourTensor.html">RankFourTensor</a>&lt; double &gt; &amp;d_sigma_dG, <a class="el" href="classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; double &gt; &amp;d_detG_dG, const bool &amp;symmetrize_tensor=true)</td></tr>
<tr class="memdesc:af13f9d05db09870d1b90b7ef389bdb71"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the derivatives of the contravariant 2nd Piola Kirchhoff stress tensor <img class="formulaInl" alt="$ \sigma^{ij}$" src="form_113.png" width="15" height="11"/>. with respect to the deformed metric tensor. Also return the derivatives of the determinant of the deformed metric tensor with respect to the deformed metric tensor. This form is appropriate for truly-incompressible materials. The default implementation uses finite differences for the derivatives that depend on the constitutive law, but not for the derivatives of the determinant, which are generic. / If the boolean flag symmetrize_tensor is false, only the "upper  triangular" entries of the tensor will be filled in. This is a useful efficiency when using the derivatives in Jacobian calculations.  <a href="classoomph_1_1ConstitutiveLaw.html#af13f9d05db09870d1b90b7ef389bdb71">More...</a><br /></td></tr>
<tr class="separator:af13f9d05db09870d1b90b7ef389bdb71"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a26f34355b626bebcad8f498fa5271d20"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoomph_1_1ConstitutiveLaw.html#a26f34355b626bebcad8f498fa5271d20">calculate_second_piola_kirchhoff_stress</a> (const <a class="el" href="classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; double &gt; &amp;g, const <a class="el" href="classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; double &gt; &amp;G, <a class="el" href="classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; double &gt; &amp;sigma_dev, <a class="el" href="classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; double &gt; &amp;Gcontra, double &amp;gen_dil, double &amp;inv_kappa)</td></tr>
<tr class="memdesc:a26f34355b626bebcad8f498fa5271d20"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the deviatoric part of the contravariant 2nd Piola Kirchoff stress tensor. Also return the contravariant deformed metric tensor, the generalised dilatation, <img class="formulaInl" alt="$ d, $" src="form_114.png" width="9" height="13"/> and the inverse of the bulk modulus <img class="formulaInl" alt="$ \kappa$" src="form_115.png" width="8" height="6"/>. This form is appropriate for near-incompressible materials for which <img class="formulaInl" alt="$ \sigma^{ij} = -p G^{ij} + \overline{ \sigma^{ij}} $" src="form_116.png" width="99" height="15"/> where the "pressure" <img class="formulaInl" alt="$ p $" src="form_117.png" width="8" height="9"/> is determined from <img class="formulaInl" alt="$ p / \kappa - d =0 $" src="form_118.png" width="65" height="14"/>.  <a href="classoomph_1_1ConstitutiveLaw.html#a26f34355b626bebcad8f498fa5271d20">More...</a><br /></td></tr>
<tr class="separator:a26f34355b626bebcad8f498fa5271d20"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a4f1bcac8d308d9ad0013ddf5def505"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoomph_1_1ConstitutiveLaw.html#a8a4f1bcac8d308d9ad0013ddf5def505">calculate_d_second_piola_kirchhoff_stress_dG</a> (const <a class="el" href="classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; double &gt; &amp;g, const <a class="el" href="classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; double &gt; &amp;G, const <a class="el" href="classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; double &gt; &amp;sigma, const double &amp;gen_dil, const double &amp;inv_kappa, const double &amp;interpolated_solid_p, <a class="el" href="classoomph_1_1RankFourTensor.html">RankFourTensor</a>&lt; double &gt; &amp;d_sigma_dG, <a class="el" href="classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; double &gt; &amp;d_gen_dil_dG, const bool &amp;symmetrize_tensor=true)</td></tr>
<tr class="memdesc:a8a4f1bcac8d308d9ad0013ddf5def505"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the derivatives of the contravariant 2nd Piola Kirchoff stress tensor with respect to the deformed metric tensor. Also return the derivatives of the generalised dilatation, <img class="formulaInl" alt="$ d, $" src="form_114.png" width="9" height="13"/> with respect to the deformed metric tensor. This form is appropriate for near-incompressible materials. The default implementation uses finite differences. If the boolean flag symmetrize_tensor is false, only the "upper  triangular" entries of the tensor will be filled in. This is a useful efficiency when using the derivatives in Jacobian calculations.  <a href="classoomph_1_1ConstitutiveLaw.html#a8a4f1bcac8d308d9ad0013ddf5def505">More...</a><br /></td></tr>
<tr class="separator:a8a4f1bcac8d308d9ad0013ddf5def505"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a446452158a8ae9fbc3dde4277155f824"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoomph_1_1ConstitutiveLaw.html#a446452158a8ae9fbc3dde4277155f824">requires_incompressibility_constraint</a> ()=0</td></tr>
<tr class="memdesc:a446452158a8ae9fbc3dde4277155f824"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pure virtual function in which the user must declare if the constitutive equation requires an incompressible formulation in which the volume constraint is enforced explicitly. Used as a sanity check in PARANOID mode.  <a href="classoomph_1_1ConstitutiveLaw.html#a446452158a8ae9fbc3dde4277155f824">More...</a><br /></td></tr>
<tr class="separator:a446452158a8ae9fbc3dde4277155f824"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:a73f01e1459e7ba998ef78f7ece6baa37"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoomph_1_1ConstitutiveLaw.html#a73f01e1459e7ba998ef78f7ece6baa37">is_matrix_square</a> (const <a class="el" href="classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; double &gt; &amp;M)</td></tr>
<tr class="memdesc:a73f01e1459e7ba998ef78f7ece6baa37"><td class="mdescLeft">&#160;</td><td class="mdescRight">Test whether a matrix is square.  <a href="classoomph_1_1ConstitutiveLaw.html#a73f01e1459e7ba998ef78f7ece6baa37">More...</a><br /></td></tr>
<tr class="separator:a73f01e1459e7ba998ef78f7ece6baa37"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a89bb96a9b922294509923563a13063"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoomph_1_1ConstitutiveLaw.html#a8a89bb96a9b922294509923563a13063">are_matrices_of_equal_dimensions</a> (const <a class="el" href="classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; double &gt; &amp;M1, const <a class="el" href="classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; double &gt; &amp;M2)</td></tr>
<tr class="memdesc:a8a89bb96a9b922294509923563a13063"><td class="mdescLeft">&#160;</td><td class="mdescRight">Test whether two matrices are of equal dimensions.  <a href="classoomph_1_1ConstitutiveLaw.html#a8a89bb96a9b922294509923563a13063">More...</a><br /></td></tr>
<tr class="separator:a8a89bb96a9b922294509923563a13063"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a01763658a56a962460a80607653a33b4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoomph_1_1ConstitutiveLaw.html#a01763658a56a962460a80607653a33b4">error_checking_in_input</a> (const <a class="el" href="classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; double &gt; &amp;g, const <a class="el" href="classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; double &gt; &amp;G, <a class="el" href="classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; double &gt; &amp;sigma)</td></tr>
<tr class="memdesc:a01763658a56a962460a80607653a33b4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check for errors in the input, i.e. check that the dimensions of the arrays are all consistent.  <a href="classoomph_1_1ConstitutiveLaw.html#a01763658a56a962460a80607653a33b4">More...</a><br /></td></tr>
<tr class="separator:a01763658a56a962460a80607653a33b4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5c188df10b08b340b923c3a733c0d178"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoomph_1_1ConstitutiveLaw.html#a5c188df10b08b340b923c3a733c0d178">calculate_contravariant</a> (const <a class="el" href="classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; double &gt; &amp;Gcov, <a class="el" href="classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; double &gt; &amp;Gcontra)</td></tr>
<tr class="memdesc:a5c188df10b08b340b923c3a733c0d178"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate a contravariant tensor from a covariant tensor, and return the determinant of the covariant tensor.  <a href="classoomph_1_1ConstitutiveLaw.html#a5c188df10b08b340b923c3a733c0d178">More...</a><br /></td></tr>
<tr class="separator:a5c188df10b08b340b923c3a733c0d178"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6dda64e60ed8128cb4603041dc66036f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoomph_1_1ConstitutiveLaw.html#a6dda64e60ed8128cb4603041dc66036f">calculate_d_contravariant_dG</a> (const <a class="el" href="classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; double &gt; &amp;Gcov, <a class="el" href="classoomph_1_1RankFourTensor.html">RankFourTensor</a>&lt; double &gt; &amp;dGcontra_dG, <a class="el" href="classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; double &gt; &amp;d_detG_dG)</td></tr>
<tr class="memdesc:a6dda64e60ed8128cb4603041dc66036f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the derivatives of the contravariant tensor and the derivatives of the determinant of the covariant tensor with respect to the components of the covariant tensor.  <a href="classoomph_1_1ConstitutiveLaw.html#a6dda64e60ed8128cb4603041dc66036f">More...</a><br /></td></tr>
<tr class="separator:a6dda64e60ed8128cb4603041dc66036f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>///////////////////////////////////////////////////////////////// ///////////////////////////////////////////////////////////////// </p>
<p>A class for constitutive laws for elements that solve the equations of solid mechanics based upon the principle of virtual displacements. In that formulation, the information required from a constitutive law is the (2nd Piola-Kirchhoff) stress tensor <img class="formulaInl" alt="$ \sigma^{ij} $" src="form_124.png" width="15" height="11"/> as a function of the (Green) strain <img class="formulaInl" alt="$ \gamma^{ij} $" src="form_125.png" width="16" height="14"/>: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \sigma^{ij} = \sigma^{ij}(\gamma_{ij}). \]" src="form_126.png" width="78" height="16"/>
</p>
<p> The Green strain is defined as </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \gamma_{ij} = \frac{1}{2} (G_{ij} - g_{ij}), \ \ \ \ \ \ \ \ \ \ \ (1) \]" src="form_127.png" width="166" height="26"/>
</p>
<p> where <img class="formulaInl" alt="$G_{ij} $" src="form_128.png" width="18" height="14"/> and <img class="formulaInl" alt="$ g_{ij}$" src="form_129.png" width="15" height="10"/> are the metric tensors in the deformed and undeformed (stress-free) configurations, respectively. A specific <a class="el" href="classoomph_1_1ConstitutiveLaw.html" title="///////////////////////////////////////////////////////////////// ///////////////////////////////////...">ConstitutiveLaw</a> needs to be implement the pure virtual function </p><div class="fragment"><div class="line"><a class="code" href="classoomph_1_1ConstitutiveLaw.html#a93527d910de908035feb8f41b0401065">ConstitutiveLaw::calculate_second_piola_kirchhoff_stress</a>(...)</div>
<div class="ttc" id="aclassoomph_1_1ConstitutiveLaw_html_a93527d910de908035feb8f41b0401065"><div class="ttname"><a href="classoomph_1_1ConstitutiveLaw.html#a93527d910de908035feb8f41b0401065">oomph::ConstitutiveLaw::calculate_second_piola_kirchhoff_stress</a></div><div class="ttdeci">virtual void calculate_second_piola_kirchhoff_stress(const DenseMatrix&lt; double &gt; &amp;g, const DenseMatrix&lt; double &gt; &amp;G, DenseMatrix&lt; double &gt; &amp;sigma)=0</div><div class="ttdoc">Calculate the contravariant 2nd Piola Kirchhoff stress tensor. Arguments are the covariant undeformed...</div></div>
</div><!-- fragment --><p> Equation (1) shows that the strain may be calculated from the undeformed and deformed metric tensors. Frequently, these tensors are also required in the constitutive law itself. To avoid unnecessary re-computation of these quantities, we pass the deformed and undeformed metric tensor to <code>calculate_second_piola_kirchhoff_stress(...)</code> rather than the strain tensor itself.</p>
<p>The functional form of the constitutive equation is different for compressible/incompressible/near-incompressible behaviour and we provide interfaces that are appropriate for all of these cases.</p><ol type="1">
<li><p class="startli"><b>Compressible</b> <b>Behaviour:</b> <br  />
 If the material is compressible, the stress can be computed from the deformed and undeformed metric tensors,</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \sigma^{ij} = \sigma^{ij}(\gamma_{ij}) = \sigma^{ij}\bigg( \frac{1}{2} (G_{ij} - g_{ij})\bigg), \]" src="form_130.png" width="196" height="31"/>
</p>
<p> using the interface </p><div class="fragment"><div class="line"><span class="comment">// 2nd Piola Kirchhoff stress tensor</span></div>
<div class="line">DenseMatrix&lt;double&gt; sigma(DIM,DIM);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Metric tensor in the undeformed (stress-free) configuration</span></div>
<div class="line">DenseMatrix&lt;double&gt; g(DIM,DIM);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Metric tensor in the deformed  configuration</span></div>
<div class="line">DenseMatrix&lt;double&gt; G(DIM,DIM);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Compute stress from the two metric tensors:</span></div>
<div class="line"><a class="code" href="classoomph_1_1ConstitutiveLaw.html#a93527d910de908035feb8f41b0401065">calculate_second_piola_kirchhoff_stress</a>(g,G,sigma);</div>
</div><!-- fragment --><p> <br  />
 <br  />
 <br  />
</p>
</li>
<li><p class="startli"><b>Incompressible</b> <b>Behaviour:</b> <br  />
 If the material is incompressible, its deformation is constrained by the condition that</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \det G_{ij} - \det g_{ij}= 0 \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (2) \]" src="form_131.png" width="191" height="14"/>
</p>
<p> which ensures that the volume of infinitesimal material elements remains constant during the deformation. This condition is typically enforced by a Lagrange multiplier which plays the role of a pressure. In such cases, the stress tensor has form</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \sigma^{ij} = -p G^{ij} + \overline{\sigma}^{ij}\big(\gamma_{kl}\big), \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (3) \]" src="form_132.png" width="214" height="18"/>
</p>
<p> where only the deviatoric part of the stress tensor, <img class="formulaInl" alt="$ \overline{\sigma}^{ij}, $" src="form_133.png" width="20" height="14"/> depends directly on the strain. The pressure <img class="formulaInl" alt="$ p $" src="form_117.png" width="8" height="9"/> needs to be determined independently from (2). Given the deformed and undeformed metric tensors, the computation of the stress tensor <img class="formulaInl" alt="$ \sigma^{ij} $" src="form_124.png" width="15" height="11"/> for an incompressible material therefore requires the computation of the following quantities:</p><ul>
<li>The deviatoric stress <img class="formulaInl" alt="$ \overline{\sigma}^{ij} $" src="form_134.png" width="16" height="11"/></li>
<li>The contravariant deformed metric tensor <img class="formulaInl" alt="$ G^{ij} $" src="form_135.png" width="18" height="11"/></li>
<li>The determinant of the deformed metric tensors, <img class="formulaInl" alt="$ \det G_{ij}, $" src="form_136.png" width="43" height="14"/> which is required in equation (2) whose solution determines the pressure.</li>
</ul>
</li>
</ol>
<p><br  />
 These quantities can be obtained from the following interface <br  />
</p><div class="fragment"><div class="line"><span class="comment">// Deviatoric part of the 2nd Piola Kirchhoff stress tensor</span></div>
<div class="line">DenseMatrix&lt;double&gt; sigma_dev(DIM,DIM);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Metric tensor in the undeformed (stress-free) configuration</span></div>
<div class="line">DenseMatrix&lt;double&gt; g(DIM,DIM);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Metric tensor in the deformed  configuration</span></div>
<div class="line">DenseMatrix&lt;double&gt; G(DIM,DIM);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Determinant of the deformed metric tensor</span></div>
<div class="line"><span class="keywordtype">double</span> Gdet;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Contravariant deformed metric tensor</span></div>
<div class="line">DenseMatrix&lt;double&gt; G_contra(DIM,DIM);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Compute stress from the two metric tensors:</span></div>
<div class="line"><a class="code" href="classoomph_1_1ConstitutiveLaw.html#a93527d910de908035feb8f41b0401065">calculate_second_piola_kirchhoff_stress</a>(g,G,sigma_dev,G_contra,Gdet);</div>
</div><!-- fragment --><p> <br  />
 <br  />
 <br  />
</p><ol type="1">
<li><p class="startli"><b>Nearly</b> <b>Incompressible</b> <b>Behaviour:</b> <br  />
 If the material is nearly incompressible, it is advantageous to split the stress into its deviatoric and hydrostatic parts by writing the constitutive law in the form</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \sigma^{ij} = -p G^{ij} + \overline{\sigma}^{ij}\big(\gamma_{kl}\big), \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (3) \]" src="form_132.png" width="214" height="18"/>
</p>
<p> where the deviatoric part of the stress tensor, <img class="formulaInl" alt="$ \overline{\sigma}^{ij}, $" src="form_133.png" width="20" height="14"/> depends on the strain. This form of the constitutive law is identical to that of the incompressible case and it involves a pressure <img class="formulaInl" alt="$ p $" src="form_117.png" width="8" height="9"/> which needs to be determined from an additional equation. In the incompressible case, this equation was given by the incompressibility constraint (2). Here, we need to augment the constitutive law (3) by a separate equation for the pressure. Generally this takes the form</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ p = - \kappa \ d \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (4) \]" src="form_137.png" width="133" height="14"/>
</p>
<p> where <img class="formulaInl" alt="$ \kappa $" src="form_138.png" width="8" height="6"/> is the "bulk modulus", a material property that needs to be specified by the constitutive law. <img class="formulaInl" alt="$ d $" src="form_139.png" width="6" height="10"/> is the (generalised) dilatation, i.e. the relative change in the volume of an infinitesimal material element (or some suitable generalised quantitiy that is related to it). As the material approaches incompressibility, <img class="formulaInl" alt="$ \kappa \to \infty$" src="form_140.png" width="39" height="8"/>, so that infinitely large pressures would be required to achieve any change in volume. To facilitate the implementation of (4) as the equation for the pressure, we re-write it in the form </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ p \ \frac{1}{\kappa} + d\big(g_{ij},G_{ij}\big) = 0 \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (5) \]" src="form_141.png" width="198" height="26"/>
</p>
<p> which only involves quantities that remain finite as we approach true incompressibility. <br  />
 Given the deformed and undeformed metric tensors, the computation of the stress tensor <img class="formulaInl" alt="$ \sigma^{ij} $" src="form_124.png" width="15" height="11"/> for a nearly incompressible material therefore requires the computation of the following quantities:</p><ul>
<li>The deviatoric stress <img class="formulaInl" alt="$ \overline{\sigma}^{ij} $" src="form_134.png" width="16" height="11"/></li>
<li>The contravariant deformed metric tensor <img class="formulaInl" alt="$ G^{ij} $" src="form_135.png" width="18" height="11"/></li>
<li>The generalised dilatation <img class="formulaInl" alt="$ d $" src="form_139.png" width="6" height="10"/></li>
<li>The inverse of the bulk modulus <img class="formulaInl" alt="$ \kappa $" src="form_138.png" width="8" height="6"/></li>
</ul>
</li>
</ol>
<p><br  />
 These quantities can be obtained from the following interface <br  />
</p><div class="fragment"><div class="line"><span class="comment">// Deviatoric part of the 2nd Piola Kirchhoff stress tensor</span></div>
<div class="line">DenseMatrix&lt;double&gt; sigma_dev(DIM,DIM);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Metric tensor in the undeformed (stress-free) configuration</span></div>
<div class="line">DenseMatrix&lt;double&gt; g(DIM,DIM);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Metric tensor in the deformed  configuration</span></div>
<div class="line">DenseMatrix&lt;double&gt; G(DIM,DIM);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Contravariant deformed metric tensor</span></div>
<div class="line">DenseMatrix&lt;double&gt; G_contra(DIM,DIM);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Inverse of the bulk modulus</span></div>
<div class="line"><span class="keywordtype">double</span> inv_kappa;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Generalised dilatation</span></div>
<div class="line"><span class="keywordtype">double</span> gen_dil;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Compute stress from the two metric tensors:</span></div>
<div class="line"><a class="code" href="classoomph_1_1ConstitutiveLaw.html#a93527d910de908035feb8f41b0401065">calculate_second_piola_kirchhoff_stress</a>(g,G,sigma_dev,G_contra,inv_kappa,gen_dil);</div>
</div><!-- fragment --> 
<p class="definition">Definition at line <a class="el" href="constitutive__laws_8h_source.html#l00470">470</a> of file <a class="el" href="constitutive__laws_8h_source.html">constitutive_laws.h</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a864c36413e8ea31e63552f3db3b97a2f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a864c36413e8ea31e63552f3db3b97a2f">&#9670;&nbsp;</a></span>ConstitutiveLaw()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">oomph::ConstitutiveLaw::ConstitutiveLaw </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Empty constructor. </p>

<p class="definition">Definition at line <a class="el" href="constitutive__laws_8h_source.html#l00501">501</a> of file <a class="el" href="constitutive__laws_8h_source.html">constitutive_laws.h</a>.</p>

</div>
</div>
<a id="aa75b88c826723ba090ace39c26da0ae6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa75b88c826723ba090ace39c26da0ae6">&#9670;&nbsp;</a></span>~ConstitutiveLaw()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual oomph::ConstitutiveLaw::~ConstitutiveLaw </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Empty virtual destructor. </p>

<p class="definition">Definition at line <a class="el" href="constitutive__laws_8h_source.html#l00505">505</a> of file <a class="el" href="constitutive__laws_8h_source.html">constitutive_laws.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a8a89bb96a9b922294509923563a13063"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8a89bb96a9b922294509923563a13063">&#9670;&nbsp;</a></span>are_matrices_of_equal_dimensions()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool oomph::ConstitutiveLaw::are_matrices_of_equal_dimensions </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>M1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>M2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Test whether two matrices are of equal dimensions. </p>
<p>This function is used to check whether matrices are of equal dimension. </p>

<p class="definition">Definition at line <a class="el" href="constitutive__laws_8cc_source.html#l00052">52</a> of file <a class="el" href="constitutive__laws_8cc_source.html">constitutive_laws.cc</a>.</p>

<p class="reference">References <a class="el" href="matrices_8h_source.html#l00491">oomph::DenseMatrix&lt; T &gt;::ncol()</a>, and <a class="el" href="matrices_8h_source.html#l00485">oomph::DenseMatrix&lt; T &gt;::nrow()</a>.</p>

<p class="reference">Referenced by <a class="el" href="constitutive__laws_8cc_source.html#l00113">calculate_contravariant()</a>, <a class="el" href="constitutive__laws_8cc_source.html#l00352">calculate_d_second_piola_kirchhoff_stress_dG()</a>, and <a class="el" href="constitutive__laws_8cc_source.html#l00071">error_checking_in_input()</a>.</p>

</div>
</div>
<a id="a5c188df10b08b340b923c3a733c0d178"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5c188df10b08b340b923c3a733c0d178">&#9670;&nbsp;</a></span>calculate_contravariant()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double oomph::ConstitutiveLaw::calculate_contravariant </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>Gcov</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>Gcontra</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Calculate a contravariant tensor from a covariant tensor, and return the determinant of the covariant tensor. </p>
<p>The function to calculate the contravariant tensor from a covariant one. </p>
<p>Three dimensions</p>

<p class="definition">Definition at line <a class="el" href="constitutive__laws_8cc_source.html#l00113">113</a> of file <a class="el" href="constitutive__laws_8cc_source.html">constitutive_laws.cc</a>.</p>

<p class="reference">References <a class="el" href="constitutive__laws_8cc_source.html#l00052">are_matrices_of_equal_dimensions()</a>, <a class="el" href="constitutive__laws_8cc_source.html#l00036">is_matrix_square()</a>, <a class="el" href="matrices_8h_source.html#l00491">oomph::DenseMatrix&lt; T &gt;::ncol()</a>, and <a class="el" href="oomph__definitions_8cc_source.html#l00286">oomph::Global_string_for_annotation::string()</a>.</p>

<p class="reference">Referenced by <a class="el" href="constitutive__laws_8cc_source.html#l00682">oomph::GeneralisedHookean::calculate_second_piola_kirchhoff_stress()</a>, and <a class="el" href="constitutive__laws_8cc_source.html#l00896">oomph::IsotropicStrainEnergyFunctionConstitutiveLaw::calculate_second_piola_kirchhoff_stress()</a>.</p>

</div>
</div>
<a id="a6dda64e60ed8128cb4603041dc66036f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6dda64e60ed8128cb4603041dc66036f">&#9670;&nbsp;</a></span>calculate_d_contravariant_dG()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::ConstitutiveLaw::calculate_d_contravariant_dG </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>Gcov</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classoomph_1_1RankFourTensor.html">RankFourTensor</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>dGcontra_dG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>d_detG_dG</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Calculate the derivatives of the contravariant tensor and the derivatives of the determinant of the covariant tensor with respect to the components of the covariant tensor. </p>
<p>The function to calculate the derivatives of the contravariant tensor and determinant of covariant tensor with respect to the components of the covariant tensor. </p>
<p>Three dimensions</p>

<p class="definition">Definition at line <a class="el" href="constitutive__laws_8cc_source.html#l00225">225</a> of file <a class="el" href="constitutive__laws_8cc_source.html">constitutive_laws.cc</a>.</p>

<p class="reference">References <a class="el" href="constitutive__laws_8cc_source.html#l00036">is_matrix_square()</a>, <a class="el" href="matrices_8h_source.html#l00491">oomph::DenseMatrix&lt; T &gt;::ncol()</a>, and <a class="el" href="oomph__definitions_8cc_source.html#l00286">oomph::Global_string_for_annotation::string()</a>.</p>

</div>
</div>
<a id="af13f9d05db09870d1b90b7ef389bdb71"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af13f9d05db09870d1b90b7ef389bdb71">&#9670;&nbsp;</a></span>calculate_d_second_piola_kirchhoff_stress_dG() <span class="overload">[1/3]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::ConstitutiveLaw::calculate_d_second_piola_kirchhoff_stress_dG </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>g</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>G</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>sigma</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double &amp;&#160;</td>
          <td class="paramname"><em>detG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double &amp;&#160;</td>
          <td class="paramname"><em>interpolated_solid_p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classoomph_1_1RankFourTensor.html">RankFourTensor</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>d_sigma_dG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>d_detG_dG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool &amp;&#160;</td>
          <td class="paramname"><em>symmetrize_tensor</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Calculate the derivatives of the contravariant 2nd Piola Kirchhoff stress tensor <img class="formulaInl" alt="$ \sigma^{ij}$" src="form_113.png" width="15" height="11"/>. with respect to the deformed metric tensor. Also return the derivatives of the determinant of the deformed metric tensor with respect to the deformed metric tensor. This form is appropriate for truly-incompressible materials. The default implementation uses finite differences for the derivatives that depend on the constitutive law, but not for the derivatives of the determinant, which are generic. / If the boolean flag symmetrize_tensor is false, only the "upper  triangular" entries of the tensor will be filled in. This is a useful efficiency when using the derivatives in Jacobian calculations. </p>
<p>Calculate the derivatives of the contravariant 2nd Piola Kirchhoff stress tensor <img class="formulaInl" alt="$ \sigma^{ij}$" src="form_113.png" width="15" height="11"/>. with respect to the deformed metric tensor. Also return the derivatives of the determinant of the deformed metric tensor with respect to the deformed metric tensor. This form is appropriate for truly-incompressible materials. The default implementation uses finite differences for the derivatives that depend on the constitutive law, but not for the derivatives of the determinant, which are generic. </p>

<p class="definition">Definition at line <a class="el" href="constitutive__laws_8cc_source.html#l00453">453</a> of file <a class="el" href="constitutive__laws_8cc_source.html">constitutive_laws.cc</a>.</p>

<p class="reference">References <a class="el" href="constitutive__laws_8cc_source.html#l00052">are_matrices_of_equal_dimensions()</a>, <a class="el" href="classoomph_1_1ConstitutiveLaw.html#a93527d910de908035feb8f41b0401065">calculate_second_piola_kirchhoff_stress()</a>, <a class="el" href="elements_8h_source.html#l01198">oomph::GeneralisedElement::Default_fd_jacobian_step</a>, <a class="el" href="cfortran_8h_source.html#l00603">i</a>, and <a class="el" href="matrices_8h_source.html#l00491">oomph::DenseMatrix&lt; T &gt;::ncol()</a>.</p>

</div>
</div>
<a id="a8a4f1bcac8d308d9ad0013ddf5def505"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8a4f1bcac8d308d9ad0013ddf5def505">&#9670;&nbsp;</a></span>calculate_d_second_piola_kirchhoff_stress_dG() <span class="overload">[2/3]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::ConstitutiveLaw::calculate_d_second_piola_kirchhoff_stress_dG </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>g</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>G</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>sigma</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double &amp;&#160;</td>
          <td class="paramname"><em>gen_dil</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double &amp;&#160;</td>
          <td class="paramname"><em>inv_kappa</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double &amp;&#160;</td>
          <td class="paramname"><em>interpolated_solid_p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classoomph_1_1RankFourTensor.html">RankFourTensor</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>d_sigma_dG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>d_gen_dil_dG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool &amp;&#160;</td>
          <td class="paramname"><em>symmetrize_tensor</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Calculate the derivatives of the contravariant 2nd Piola Kirchoff stress tensor with respect to the deformed metric tensor. Also return the derivatives of the generalised dilatation, <img class="formulaInl" alt="$ d, $" src="form_114.png" width="9" height="13"/> with respect to the deformed metric tensor. This form is appropriate for near-incompressible materials. The default implementation uses finite differences. If the boolean flag symmetrize_tensor is false, only the "upper  triangular" entries of the tensor will be filled in. This is a useful efficiency when using the derivatives in Jacobian calculations. </p>
<p>Calculate the derivatives of the contravariant 2nd Piola Kirchoff stress tensor with respect to the deformed metric tensor. Also return the derivatives of the generalised dilatation, <img class="formulaInl" alt="$ d, $" src="form_114.png" width="9" height="13"/> with respect to the deformed metric tensor. This form is appropriate for near-incompressible materials. The default implementation uses finite differences. </p>

<p class="definition">Definition at line <a class="el" href="constitutive__laws_8cc_source.html#l00566">566</a> of file <a class="el" href="constitutive__laws_8cc_source.html">constitutive_laws.cc</a>.</p>

<p class="reference">References <a class="el" href="constitutive__laws_8cc_source.html#l00052">are_matrices_of_equal_dimensions()</a>, <a class="el" href="classoomph_1_1ConstitutiveLaw.html#a93527d910de908035feb8f41b0401065">calculate_second_piola_kirchhoff_stress()</a>, <a class="el" href="elements_8h_source.html#l01198">oomph::GeneralisedElement::Default_fd_jacobian_step</a>, <a class="el" href="cfortran_8h_source.html#l00603">i</a>, and <a class="el" href="matrices_8h_source.html#l00491">oomph::DenseMatrix&lt; T &gt;::ncol()</a>.</p>

</div>
</div>
<a id="a6076752384082cfa3de3e0cf17daa9aa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6076752384082cfa3de3e0cf17daa9aa">&#9670;&nbsp;</a></span>calculate_d_second_piola_kirchhoff_stress_dG() <span class="overload">[3/3]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::ConstitutiveLaw::calculate_d_second_piola_kirchhoff_stress_dG </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>g</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>G</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>sigma</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classoomph_1_1RankFourTensor.html">RankFourTensor</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>d_sigma_dG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool &amp;&#160;</td>
          <td class="paramname"><em>symmetrize_tensor</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Calculate the derivatives of the contravariant 2nd Piola Kirchhoff stress tensor with respect to the deformed metric tensor. Arguments are the covariant undeformed and deformed metric tensor, the current value of the stress tensor and the rank four tensor in which to return the derivatives of the stress tensor The default implementation uses finite differences, but can be overloaded for constitutive laws in which an analytic formulation is possible. If the boolean flag symmetrize_tensor is false, only the "upper  triangular" entries of the tensor will be filled in. This is a useful efficiency when using the derivatives in Jacobian calculations. </p>
<p>Calculate the derivatives of the contravariant 2nd Piola Kirchhoff stress tensor with respect to the deformed metric tensor. Arguments are the covariant undeformed and deformed metric tensor and the matrix in which to return the derivatives of the stress tensor The default implementation uses finite differences, but can be overloaded for constitutive laws in which an analytic formulation is possible. </p>

<p class="definition">Definition at line <a class="el" href="constitutive__laws_8cc_source.html#l00352">352</a> of file <a class="el" href="constitutive__laws_8cc_source.html">constitutive_laws.cc</a>.</p>

<p class="reference">References <a class="el" href="constitutive__laws_8cc_source.html#l00052">are_matrices_of_equal_dimensions()</a>, <a class="el" href="classoomph_1_1ConstitutiveLaw.html#a93527d910de908035feb8f41b0401065">calculate_second_piola_kirchhoff_stress()</a>, <a class="el" href="elements_8h_source.html#l01198">oomph::GeneralisedElement::Default_fd_jacobian_step</a>, <a class="el" href="cfortran_8h_source.html#l00603">i</a>, and <a class="el" href="matrices_8h_source.html#l00491">oomph::DenseMatrix&lt; T &gt;::ncol()</a>.</p>

<p class="reference">Referenced by <a class="el" href="solid__elements_8h_source.html#l01177">oomph::PVDEquationsWithPressure&lt; DIM &gt;::get_d_stress_dG_upper()</a>, and <a class="el" href="solid__elements_8h_source.html#l00569">oomph::PVDEquations&lt; DIM &gt;::get_d_stress_dG_upper()</a>.</p>

</div>
</div>
<a id="a93527d910de908035feb8f41b0401065"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a93527d910de908035feb8f41b0401065">&#9670;&nbsp;</a></span>calculate_second_piola_kirchhoff_stress() <span class="overload">[1/3]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void oomph::ConstitutiveLaw::calculate_second_piola_kirchhoff_stress </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>g</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>G</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>sigma</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Calculate the contravariant 2nd Piola Kirchhoff stress tensor. Arguments are the covariant undeformed and deformed metric tensor and the matrix in which to return the stress tensor. </p>

<p>Implemented in <a class="el" href="classoomph_1_1IsotropicStrainEnergyFunctionConstitutiveLaw.html#af6c25617b8be6cc454d6b526ec6121fc">oomph::IsotropicStrainEnergyFunctionConstitutiveLaw</a>, and <a class="el" href="classoomph_1_1GeneralisedHookean.html#a5beca3e59f04d109c394bf9fd24bb7c1">oomph::GeneralisedHookean</a>.</p>

<p class="reference">Referenced by <a class="el" href="constitutive__laws_8cc_source.html#l00352">calculate_d_second_piola_kirchhoff_stress_dG()</a>, <a class="el" href="axisym__solid__elements_8h_source.html#l00066">oomph::AxisymmetricPVDEquations::get_stress()</a>, <a class="el" href="solid__elements_8h_source.html#l00543">oomph::PVDEquations&lt; DIM &gt;::get_stress()</a>, <a class="el" href="axisym__solid__elements_8h_source.html#l00695">oomph::AxisymmetricPVDEquationsWithPressure::get_stress()</a>, and <a class="el" href="solid__elements_8h_source.html#l01145">oomph::PVDEquationsWithPressure&lt; DIM &gt;::get_stress()</a>.</p>

</div>
</div>
<a id="ac8178b1b7cd7e6a64942dba9e0997b30"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac8178b1b7cd7e6a64942dba9e0997b30">&#9670;&nbsp;</a></span>calculate_second_piola_kirchhoff_stress() <span class="overload">[2/3]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void oomph::ConstitutiveLaw::calculate_second_piola_kirchhoff_stress </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>g</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>G</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>sigma_dev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>G_contra</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>Gdet</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Calculate the deviatoric part <img class="formulaInl" alt="$ \overline{ \sigma^{ij}}$" src="form_119.png" width="18" height="13"/> of the contravariant 2nd Piola Kirchhoff stress tensor <img class="formulaInl" alt="$ \sigma^{ij}$" src="form_113.png" width="15" height="11"/>. Also return the contravariant deformed metric tensor and the determinant of the deformed metric tensor. This form is appropriate for truly-incompressible materials for which <img class="formulaInl" alt="$ \sigma^{ij} = - p G^{ij} +\overline{ \sigma^{ij}} $" src="form_120.png" width="99" height="15"/> where the "pressure" <img class="formulaInl" alt="$ p $" src="form_117.png" width="8" height="9"/> is determined by <img class="formulaInl" alt="$ \det G_{ij} - \det g_{ij} = 0 $" src="form_121.png" width="111" height="14"/>. </p>

<p>Reimplemented in <a class="el" href="classoomph_1_1IsotropicStrainEnergyFunctionConstitutiveLaw.html#acf61673ecc4f960fee908378ac48544a">oomph::IsotropicStrainEnergyFunctionConstitutiveLaw</a>, and <a class="el" href="classoomph_1_1GeneralisedHookean.html#a641d0893e485df52b48b15e189a850ed">oomph::GeneralisedHookean</a>.</p>

<p class="definition">Definition at line <a class="el" href="constitutive__laws_8h_source.html#l00547">547</a> of file <a class="el" href="constitutive__laws_8h_source.html">constitutive_laws.h</a>.</p>

</div>
</div>
<a id="a26f34355b626bebcad8f498fa5271d20"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a26f34355b626bebcad8f498fa5271d20">&#9670;&nbsp;</a></span>calculate_second_piola_kirchhoff_stress() <span class="overload">[3/3]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void oomph::ConstitutiveLaw::calculate_second_piola_kirchhoff_stress </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>g</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>G</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>sigma_dev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>Gcontra</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>gen_dil</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>inv_kappa</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Calculate the deviatoric part of the contravariant 2nd Piola Kirchoff stress tensor. Also return the contravariant deformed metric tensor, the generalised dilatation, <img class="formulaInl" alt="$ d, $" src="form_114.png" width="9" height="13"/> and the inverse of the bulk modulus <img class="formulaInl" alt="$ \kappa$" src="form_115.png" width="8" height="6"/>. This form is appropriate for near-incompressible materials for which <img class="formulaInl" alt="$ \sigma^{ij} = -p G^{ij} + \overline{ \sigma^{ij}} $" src="form_116.png" width="99" height="15"/> where the "pressure" <img class="formulaInl" alt="$ p $" src="form_117.png" width="8" height="9"/> is determined from <img class="formulaInl" alt="$ p / \kappa - d =0 $" src="form_118.png" width="65" height="14"/>. </p>

<p>Reimplemented in <a class="el" href="classoomph_1_1IsotropicStrainEnergyFunctionConstitutiveLaw.html#aa45d82d322fda480f88e78cddd557837">oomph::IsotropicStrainEnergyFunctionConstitutiveLaw</a>, and <a class="el" href="classoomph_1_1GeneralisedHookean.html#ad19b5e80755f5d8e5513c4199f62fe03">oomph::GeneralisedHookean</a>.</p>

<p class="definition">Definition at line <a class="el" href="constitutive__laws_8h_source.html#l00592">592</a> of file <a class="el" href="constitutive__laws_8h_source.html">constitutive_laws.h</a>.</p>

</div>
</div>
<a id="a01763658a56a962460a80607653a33b4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a01763658a56a962460a80607653a33b4">&#9670;&nbsp;</a></span>error_checking_in_input()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::ConstitutiveLaw::error_checking_in_input </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>g</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>G</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>sigma</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Check for errors in the input, i.e. check that the dimensions of the arrays are all consistent. </p>
<p>This function is used to provide simple error (bounce) checks on the input to any calculate_second_piola_kirchhoff_stress. </p>

<p class="definition">Definition at line <a class="el" href="constitutive__laws_8cc_source.html#l00071">71</a> of file <a class="el" href="constitutive__laws_8cc_source.html">constitutive_laws.cc</a>.</p>

<p class="reference">References <a class="el" href="constitutive__laws_8cc_source.html#l00052">are_matrices_of_equal_dimensions()</a>, <a class="el" href="constitutive__laws_8cc_source.html#l00036">is_matrix_square()</a>, and <a class="el" href="oomph__definitions_8cc_source.html#l00286">oomph::Global_string_for_annotation::string()</a>.</p>

<p class="reference">Referenced by <a class="el" href="constitutive__laws_8cc_source.html#l00682">oomph::GeneralisedHookean::calculate_second_piola_kirchhoff_stress()</a>, and <a class="el" href="constitutive__laws_8cc_source.html#l00896">oomph::IsotropicStrainEnergyFunctionConstitutiveLaw::calculate_second_piola_kirchhoff_stress()</a>.</p>

</div>
</div>
<a id="a73f01e1459e7ba998ef78f7ece6baa37"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a73f01e1459e7ba998ef78f7ece6baa37">&#9670;&nbsp;</a></span>is_matrix_square()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool oomph::ConstitutiveLaw::is_matrix_square </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>M</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Test whether a matrix is square. </p>
<p>This function is used to check whether a matrix is square. </p>

<p class="definition">Definition at line <a class="el" href="constitutive__laws_8cc_source.html#l00036">36</a> of file <a class="el" href="constitutive__laws_8cc_source.html">constitutive_laws.cc</a>.</p>

<p class="reference">References <a class="el" href="matrices_8h_source.html#l00491">oomph::DenseMatrix&lt; T &gt;::ncol()</a>, and <a class="el" href="matrices_8h_source.html#l00485">oomph::DenseMatrix&lt; T &gt;::nrow()</a>.</p>

<p class="reference">Referenced by <a class="el" href="constitutive__laws_8cc_source.html#l00113">calculate_contravariant()</a>, <a class="el" href="constitutive__laws_8cc_source.html#l00225">calculate_d_contravariant_dG()</a>, and <a class="el" href="constitutive__laws_8cc_source.html#l00071">error_checking_in_input()</a>.</p>

</div>
</div>
<a id="a446452158a8ae9fbc3dde4277155f824"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a446452158a8ae9fbc3dde4277155f824">&#9670;&nbsp;</a></span>requires_incompressibility_constraint()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual bool oomph::ConstitutiveLaw::requires_incompressibility_constraint </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Pure virtual function in which the user must declare if the constitutive equation requires an incompressible formulation in which the volume constraint is enforced explicitly. Used as a sanity check in PARANOID mode. </p>

<p>Implemented in <a class="el" href="classoomph_1_1IsotropicStrainEnergyFunctionConstitutiveLaw.html#a6b9a454988b023a42782f78e4e3eebc4">oomph::IsotropicStrainEnergyFunctionConstitutiveLaw</a>, and <a class="el" href="classoomph_1_1GeneralisedHookean.html#a9ed467d8b7c838cb7fed8c861aa652e9">oomph::GeneralisedHookean</a>.</p>

<p class="reference">Referenced by <a class="el" href="refineable__solid__elements_8cc_source.html#l00038">oomph::RefineablePVDEquations&lt; DIM &gt;::fill_in_generic_contribution_to_residuals_pvd()</a>, <a class="el" href="solid__elements_8cc_source.html#l00179">oomph::PVDEquations&lt; DIM &gt;::fill_in_generic_contribution_to_residuals_pvd()</a>, <a class="el" href="refineable__solid__elements_8cc_source.html#l00676">oomph::RefineablePVDEquationsWithPressure&lt; DIM &gt;::fill_in_generic_residual_contribution_pvd_with_pressure()</a>, and <a class="el" href="solid__elements_8cc_source.html#l01271">oomph::PVDEquationsWithPressure&lt; DIM &gt;::fill_in_generic_residual_contribution_pvd_with_pressure()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="constitutive__laws_8h_source.html">constitutive_laws.h</a></li>
<li><a class="el" href="constitutive__laws_8cc_source.html">constitutive_laws.cc</a></li>
</ul>
</div><!-- contents -->

    <!-- jQuery for Bootstrap and Doxygen -->
    <script src="../../js/jquery-1.12.0.min.js"></script>
    <!-- Minified boostrap plugins-->
    <script src="../../js/bootstrap.js"></script>
    <!-- Doxygen dependency to add powertips to source code-->
    <script src="../../js/jquery.powertip.min.js"></script>
    <!-- The  following script is generated by doxygen and hides/shows levels in 
         the data structure lists and adds powertips to source code-->
    <script src="../../js/dynsections.js" ></script>
    <!-- add to Doxygen's class names so bootstrap css and js recognises them-->
    <script type="text/javascript">
    $(".contents").addClass("container");
    $(".header").addClass("container");
    $(".navpath").addClass("container");
    $("#navrow3").addClass("container");
    $("#navrow4").addClass("container");
    $(".mlabel").addClass("label");
    $(".mlabel").addClass("label-default");
    $(".memitem").addClass("panel");
    $(".memitem").addClass("panel-info");
    $(".memproto").addClass("panel-heading");
    $(".memdoc").addClass("panel-body");
    </script>
    <footer>
      <div class="container">
        <div class="text-muted" style="float:right;">Generated by <a href="http://www.doxygen.org/index.html">
          <img style="height:18px;" class="footer-img" src="doxygen.png" alt="doxygen"></a> on Fri Dec 29 2023 07:53:52
        </div>
      </div>
    </footer>
</body>
</html>

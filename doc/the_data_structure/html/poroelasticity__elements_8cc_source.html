<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
<title>oomph-lib: poroelasticity_elements.cc Source File</title>
<link rel="apple-touch-icon" sizes="57x57" href="../../figures/apple-touch-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="../../figures/apple-touch-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="../../figures/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="../../figures/apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="../../figures/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="../../figures/apple-touch-icon-120x120.png">
<link rel="icon" type="image/png" href="../../figures/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="../../figures/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="../../figures/favicon-16x16.png" sizes="16x16">
<link rel="manifest" href="../../figures/manifest.json">
<link rel="mask-icon" href="../../figures/safari-pinned-tab.svg" color="#008000">
<link rel="shortcut icon" href="../../figures/favicon.ico">
<meta name="msapplication-TileColor" content="#00a300">
<meta name="msapplication-config" content="../../figures/browserconfig.xml">
<meta name="theme-color" content="#008000">
<link href="http://fonts.googleapis.com/css?family=Open+Sans:400,300,600" rel="stylesheet" type="text/css">
<!-- Doxygen css-->
<!-- <link rel="stylesheet" type="text/css" href="doxygen.css"> -->
<!-- Bootstrap -->
<link href="../../css/bootstrap.css" rel="stylesheet">
<!-- oomph-lib specific overrides -->
<link rel="stylesheet" type="text/css" href="../../css/oomph_header.css">
</head>
<body>
<nav class="navbar navbar-default">
<div class="container">
<div class="container-fluid">
  <!-- Brand and toggle get grouped for better mobile display -->
  <div class="navbar-header">
    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
      <span class="sr-only">Toggle navigation</span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="../../html/index.html"><img alt="oomph-lib" src="../../figures/oomph_logo.png"></a>
  </div>
  <!-- Collect the nav links, forms, and other content for toggling -->
  <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
    <ul class="nav navbar-nav">          
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Documentation <span class="caret"></span></a>
        <ul class="dropdown-menu">
          <li class="dropdown-header">Big picture</li>
          <li><a href="../../../doc/intro/html/index.html">The finite element method</a></li>
          <li><a href="../../../doc/the_data_structure/html/index.html">The data structure</a></li>
          <li><a href="../../../doc/quick_guide/html/index.html">Not-so-quick guide</a></li>
          <li><a href="../../../doc/optimisation/html/index.html">Optimisation</a></li>
          <li><a href="../../../doc/order_of_action_functions/html/index.html">Order of action functions</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Example codes and tutorials</li>
          <li><a href="../../../doc/example_code_list/html/index.html">List of example codes and tutorials</a></li>
          <li><a href="../../../doc/example_code_list/html/index.html#meshes">Meshing</a></li>
          <li><a href="../../../doc/example_code_list/html/index.html#solvers">Solvers</a></li>
          <li><a href="../../../doc/example_code_list/html/index.html#parallel">MPI parallel processing</a></li>
          <li><a href="../../../doc/example_code_list/html/index.html#visualisation">Post-processing/visualisation</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Other</li>
          <li><a href="../../../doc/change_log/html/index.html">Change log</a></li>
          <li><a href="../../../doc/creating_doc/html/index.html">Creating documentation</a></li>
          <li><a href="../../../doc/coding_conventions/html/index.html">Coding conventions</a></li>
          <li><a href="../../../doc/index/html/index.html">Index</a></li>
          <li><a href="../../../doc/FAQ/html/index.html">FAQ</a></li>
        </ul>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Get it <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../doc/the_distribution/html/index.html">Installation guide</a></li>
            <li><a href="../../../doc/subversion/html/index.html">Get code from subversion repository</a></li>
            <li><a href="../../../doc/download/html/index.html">Get code as tar file</a></li>
            <li><a href="../../../doc/copyright/html/index.html">Copyright</a></li>
          </ul>
        </li>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">About <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../doc/people/html/index.html">People</a></li>            
            <li><a href="../../../doc/contact/html/index.html">Contact/Get involved</a></li>
            <li><a href="../../../doc/publications/html/index.html">Publications</a></li>
            <li><a href="../../../doc/acknowledgements/html/index.html">Acknowledgements</a></li>
            <li><a href="../../../doc/picture_show/index.html">Picture show</a></li>
          </ul>
        </li>
      </li>
    </ul>
    <ul class="nav navbar-nav navbar-right navbar-search">
      <form class="navbar-form" role="search" action="../../../doc/search_results/html/index.html">
        <div class="input-group">
          <input type="text" class="form-control" placeholder="Search" name="q">
          <span class="input-group-btn">
            <button class="btn btn-default" type="submit">Go</button>
          </span>
        </div><!-- /input-group -->
       <!--<div class="form-group">
          <input type="text" class="form-control" placeholder="Search">
        </div>
        <button type="submit" class="btn btn-default">Submit</button>-->
      </form>
    </ul>
  </div><!-- /.navbar-collapse -->
</div><!-- /.container-fluid -->
</div>
</nav>
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_0a53a29945550ce2ca853010815de2cd.html">poroelasticity</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">poroelasticity_elements.cc</div>  </div>
</div><!--header-->
<div class="contents">
<a href="poroelasticity__elements_8cc.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">//LIC// ====================================================================</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">//LIC// This file forms part of oomph-lib, the object-oriented, </span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">//LIC// multi-physics finite-element library, available </span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">//LIC// at http://www.oomph-lib.org.</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">//LIC// Copyright (C) 2006-2021 Matthias Heil and Andrew Hazel</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">//LIC// This library is free software; you can redistribute it and/or</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">//LIC// modify it under the terms of the GNU Lesser General Public</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">//LIC// License as published by the Free Software Foundation; either</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">//LIC// version 2.1 of the License, or (at your option) any later version.</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">//LIC// This library is distributed in the hope that it will be useful,</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">//LIC// but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">//LIC// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">//LIC// Lesser General Public License for more details.</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">//LIC// You should have received a copy of the GNU Lesser General Public</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">//LIC// License along with this library; if not, write to the Free Software</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">//LIC// Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">//LIC// 02110-1301  USA.</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">//LIC// The authors may be contacted at oomph-lib@maths.man.ac.uk.</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">//LIC//====================================================================</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="poroelasticity__elements_8h.html">poroelasticity_elements.h</a>&quot;</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160; </div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespaceoomph.html">oomph</a></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;{<span class="comment"></span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment"> /// Static default value for timescale ratio (1.0 -- for natural scaling)</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment"></span> <span class="keyword">template</span> &lt;<span class="keywordtype">unsigned</span> DIM&gt;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160; <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1PoroelasticityEquations.html#a932d4122e3719a1aff4e45e186c48001">PoroelasticityEquations&lt;DIM&gt;::Default_lambda_sq_value</a>=1.0;</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment"> /// Static default value for the density ratio</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment"></span> <span class="keyword">template</span> &lt;<span class="keywordtype">unsigned</span> DIM&gt;</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160; <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1PoroelasticityEquations.html#a49c8a61f86e8214878639c5e6c3deb59">PoroelasticityEquations&lt;DIM&gt;::Default_density_ratio_value</a>=1.0;</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment"> /// Static default value for 1/k</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment"></span> <span class="keyword">template</span> &lt;<span class="keywordtype">unsigned</span> DIM&gt;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160; <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1PoroelasticityEquations.html#ac44640ce8b8d6bde48c236edb2f4301a">PoroelasticityEquations&lt;DIM&gt;::Default_k_inv_value</a>=1.0;</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment"> /// Static default value for alpha</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment"></span> <span class="keyword">template</span> &lt;<span class="keywordtype">unsigned</span> DIM&gt;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160; <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1PoroelasticityEquations.html#a965748b26ceb0e5b2277b38eceb00444">PoroelasticityEquations&lt;DIM&gt;::Default_alpha_value</a>=1.0;</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment"> /// Static default value for the porosity</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment"></span> <span class="keyword">template</span> &lt;<span class="keywordtype">unsigned</span> DIM&gt;</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160; <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1PoroelasticityEquations.html#a2bcb2ecdcde79ff04f6abb6c45d9da97">PoroelasticityEquations&lt;DIM&gt;::Default_porosity_value</a>=1.0;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160; </div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160; <span class="comment">//======================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment"> /// Compute the strain tensor at local coordinate s</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment"></span> <span class="comment">//======================================================================</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160; <span class="keyword">template</span>&lt;<span class="keywordtype">unsigned</span> DIM&gt;</div>
<div class="line"><a name="l00054"></a><span class="lineno"><a class="line" href="classoomph_1_1PoroelasticityEquations.html#aea601e7d1bc0757b9effa9dcdbfa0617">   54</a></span>&#160; <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1PoroelasticityEquations.html#aea601e7d1bc0757b9effa9dcdbfa0617">PoroelasticityEquations&lt;DIM&gt;::get_strain</a>(</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;   <span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;   <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> &amp;strain)<span class="keyword"> const</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;   <span class="keywordflow">if</span> ((strain.<a class="code" href="classoomph_1_1DenseMatrix.html#a9937181f1cb4cfaed7aaf3b483c42456">ncol</a>()!=DIM)||(strain.<a class="code" href="classoomph_1_1DenseMatrix.html#a1b425094510d833ffe91920747a0a962">nrow</a>()!=DIM))</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    {</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;     std::ostringstream error_message;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;     error_message &lt;&lt; <span class="stringliteral">&quot;Strain matrix is &quot;</span> &lt;&lt; strain.<a class="code" href="classoomph_1_1DenseMatrix.html#a9937181f1cb4cfaed7aaf3b483c42456">ncol</a>() &lt;&lt; <span class="stringliteral">&quot; x &quot;</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;                   &lt;&lt; strain.<a class="code" href="classoomph_1_1DenseMatrix.html#a1b425094510d833ffe91920747a0a962">nrow</a>() &lt;&lt; <span class="stringliteral">&quot;, but dimension of the equations is &quot;</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;                   &lt;&lt; DIM &lt;&lt; std::endl;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;     <span class="keywordflow">throw</span> <a class="code" href="classoomph_1_1OomphLibError.html">OomphLibError</a>(error_message.str(),</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;                         OOMPH_CURRENT_FUNCTION,</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;                         OOMPH_EXCEPTION_LOCATION);</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    }</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160; </div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;   <span class="comment">/*</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="comment">   //Find out how many position types there are</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="comment">   unsigned n_position_type = this-&gt;nnodal_position_type();</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="comment">   if(n_position_type != 1)</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="comment">    {</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="comment">     throw OomphLibError(</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="comment">      &quot;PoroElasticity is not yet implemented for more than one position type&quot;,</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="comment">      OOMPH_CURRENT_FUNCTION,</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="comment">      OOMPH_EXCEPTION_LOCATION);</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="comment">    }</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="comment">   */</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160; </div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160; </div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;   <span class="comment">//Find out how many nodes there are in the element</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;   <span class="keywordtype">unsigned</span> n_node = nnode();</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160; </div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;   <span class="comment">//Find the indices at which the local velocities are stored</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;   <span class="keywordtype">unsigned</span> u_nodal_index[DIM];</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;DIM;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++) {u_nodal_index[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] = u_index(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>);}</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160; </div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;   <span class="comment">//Set up memory for the shape and derivative functions</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;   <a class="code" href="classoomph_1_1Shape.html">Shape</a> psi(n_node);</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;   <a class="code" href="classoomph_1_1DShape.html">DShape</a> dpsidx(n_node,DIM);</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160; </div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;   <span class="comment">//Call the derivatives of the shape functions</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;   (void) dshape_eulerian(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,psi,dpsidx);</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160; </div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;   <span class="comment">//Calculate interpolated values of the derivative of global position</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;   <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> interpolated_dudx(DIM,DIM,0.0);</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160; </div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;   <span class="comment">//Loop over nodes</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l=0;l&lt;n_node;l++)</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    {</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;     <span class="comment">//Loop over velocity components</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;DIM;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;      {</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;       <span class="comment">//Get the nodal value</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;       <span class="keyword">const</span> <span class="keywordtype">double</span> u_value = this-&gt;nodal_value(l,u_nodal_index[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]);</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160; </div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;       <span class="comment">//Loop over derivative directions</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;       <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> j=0;j&lt;DIM;j++)</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        {</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;         interpolated_dudx(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>,j) += u_value*dpsidx(l,j);</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;        }</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;      }</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    }</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="comment">   ///Now fill in the entries of the strain tensor</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="comment"></span>   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;DIM;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    {</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;     <span class="comment">//Do upper half of matrix</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;     <span class="comment">//Note that j must be signed here for the comparison test to work</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;     <span class="comment">//Also i must be cast to an int</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j=(DIM-1);j&gt;=<span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>);j--)</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;      {</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;       <span class="comment">//Off diagonal terms</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;       <span class="keywordflow">if</span>(<span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>)!=j)</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;        {</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;         strain(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>,j) =</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;          0.5*(interpolated_dudx(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>,j) + interpolated_dudx(j,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>));</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;        }</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;       <span class="comment">//Diagonal terms will including growth factor when it comes back in</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;       <span class="keywordflow">else</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        {</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;         strain(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>) = interpolated_dudx(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>);</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;        }</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;      }</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;     <span class="comment">//Matrix is symmetric so just copy lower half</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j=(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>-1);j&gt;=0;j--)</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;      {</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;       strain(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>,j) = strain(j,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>);</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;      }</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    }</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  }</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160; </div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160; </div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160; </div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160; </div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160; </div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160; <span class="comment">//======================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="comment"> /// Compute the Cauchy stress tensor at local coordinate s for</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="comment"> /// displacement formulation.</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="comment"></span> <span class="comment">//======================================================================</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160; <span class="keyword">template</span>&lt;<span class="keywordtype">unsigned</span> DIM&gt;</div>
<div class="line"><a name="l00156"></a><span class="lineno"><a class="line" href="classoomph_1_1PoroelasticityEquations.html#a4f8cb984e4afa174beca76989299f256">  156</a></span>&#160; <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1PoroelasticityEquations.html#a4f8cb984e4afa174beca76989299f256">PoroelasticityEquations&lt;DIM&gt;::get_stress</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;                                               <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> &amp;stress)<span class="keyword"></span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="keyword">  const</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="keyword"> </span>{</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;  <span class="keywordflow">if</span> ((stress.<a class="code" href="classoomph_1_1DenseMatrix.html#a9937181f1cb4cfaed7aaf3b483c42456">ncol</a>()!=DIM)||(stress.<a class="code" href="classoomph_1_1DenseMatrix.html#a1b425094510d833ffe91920747a0a962">nrow</a>()!=DIM))</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;   {</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    std::ostringstream error_message;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    error_message &lt;&lt; <span class="stringliteral">&quot;Stress matrix is &quot;</span> &lt;&lt; stress.<a class="code" href="classoomph_1_1DenseMatrix.html#a9937181f1cb4cfaed7aaf3b483c42456">ncol</a>() &lt;&lt; <span class="stringliteral">&quot; x &quot;</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;                  &lt;&lt; stress.<a class="code" href="classoomph_1_1DenseMatrix.html#a1b425094510d833ffe91920747a0a962">nrow</a>() &lt;&lt; <span class="stringliteral">&quot;, but dimension of the equations is &quot;</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;                  &lt;&lt; DIM &lt;&lt; std::endl;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="classoomph_1_1OomphLibError.html">OomphLibError</a>(error_message.str(),</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;                        OOMPH_CURRENT_FUNCTION,</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;                        OOMPH_EXCEPTION_LOCATION);</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;   }</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160; </div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;  <span class="comment">// Get strain</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> strain(DIM,DIM);</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  this-&gt;get_strain(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,strain);</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160; </div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;  <span class="comment">// Now fill in the entries of the stress tensor without exploiting</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;  <span class="comment">// symmetry -- sorry too lazy. This fct is only used for</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;  <span class="comment">// postprocessing anyway...</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;DIM;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;   {</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> j=0;j&lt;DIM;j++)</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;     {</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;      stress(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>,j) = 0.0;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> k=0;k&lt;DIM;k++)</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;       {</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> l=0;k&lt;DIM;k++)</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;         {</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;          stress(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>,j)+=this-&gt;<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7da585070bd0e3801c3bbed287ef3c4a265">E</a>(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>,j,k,l)*strain(k,l);</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;         }</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;       }</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;     }</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;   }</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160; }</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160; </div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="comment"> /// \short Performs a div-conserving transformation of the vector basis</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="comment"> /// functions from the reference element to the actual element</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="comment"></span> <span class="keyword">template</span>&lt;<span class="keywordtype">unsigned</span> DIM&gt;</div>
<div class="line"><a name="l00200"></a><span class="lineno"><a class="line" href="classoomph_1_1PoroelasticityEquations.html#a43ab3d7f2f96d78346979b5eb4b2b986">  200</a></span>&#160; <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1PoroelasticityEquations.html#a43ab3d7f2f96d78346979b5eb4b2b986">PoroelasticityEquations&lt;DIM&gt;::transform_basis</a>(</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;   <span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;   <span class="keyword">const</span> <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;q_basis_local,</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;   <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;psi,</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;   <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;dpsi,</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;   <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;q_basis)<span class="keyword"> const</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;   <span class="comment">// Call the (geometric) shape functions and their derivatives</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;   <span class="comment">//(void)this-&gt;dshape_eulerian(s,psi,dpsi);</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;   this-&gt;dshape_local(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,psi,dpsi);</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160; </div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;   <span class="comment">// Storage for the (geometric) jacobian and its inverse</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;   <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> jacobian(DIM), inverse_jacobian(DIM);</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160; </div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;   <span class="comment">// Get the jacobian of the geometric mapping and its determinant</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;   <span class="keywordtype">double</span> det = local_to_eulerian_mapping(dpsi,jacobian,inverse_jacobian);</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160; </div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;   <span class="comment">// Transform the derivative of the geometric basis so that it&#39;s w.r.t.</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;   <span class="comment">// global coordinates</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;   this-&gt;transform_derivatives(inverse_jacobian,dpsi);</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160; </div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;   <span class="comment">// Get the number of computational basis vectors</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_q_basis = this-&gt;nq_basis();</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160; </div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;   <span class="comment">// Loop over the basis vectors</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l=0;l&lt;n_q_basis;l++)</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    {</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;     <span class="comment">// Loop over the spatial components</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;DIM;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;      {</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;       <span class="comment">// Zero the basis</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;       q_basis(l,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>) = 0.0;</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;      }</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    }</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160; </div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;   <span class="comment">// Loop over the spatial components</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;DIM;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    {</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;     <span class="comment">// And again</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> j=0;j&lt;DIM;j++)</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;      {</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;       <span class="comment">// Get the element of the jacobian (must transpose it due to different</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;       <span class="comment">// conventions) and divide by the determinant</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;       <span class="keywordtype">double</span> jac_trans = jacobian(j,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>)/det;</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160; </div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;       <span class="comment">// Loop over the computational basis vectors</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;       <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l=0;l&lt;n_q_basis;l++)</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;        {</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;         <span class="comment">// Apply the appropriate div-conserving mapping</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;         q_basis(l,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>) += jac_trans*q_basis_local(l,j);</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;        }</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;      }</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    }</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160; </div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;   <span class="comment">// Scale the basis by the ratio of the length of the edge to the length of</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;   <span class="comment">// the corresponding edge on the reference element</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;   scale_basis(q_basis);</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160; </div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;   <span class="keywordflow">return</span> det;</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;  }</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="comment"> /// \short Output FE representation of soln: x,y,u1,u2,q1,q2,div_q,p at</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="comment"> /// Nplot^DIM plot points</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="comment"></span> <span class="keyword">template</span>&lt;<span class="keywordtype">unsigned</span> DIM&gt;</div>
<div class="line"><a name="l00264"></a><span class="lineno"><a class="line" href="classoomph_1_1PoroelasticityEquations.html#aa7a99329f02fc199b45e8f1db6b1b0c0">  264</a></span>&#160; <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1PoroelasticityEquations.html#ad5814c1fe98f24ded82b5f9b50fa1fb1">PoroelasticityEquations&lt;DIM&gt;::output</a>(std::ostream &amp;outfile,</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;                                           <span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;nplot)</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;  {</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;   <span class="comment">// Vector of local coordinates</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;   <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>(DIM);</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160; </div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;   <span class="comment">// Tecplot header info</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;   outfile &lt;&lt; tecplot_zone_string(nplot);</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160; </div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;   <span class="comment">// Loop over plot points</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;   <span class="keywordtype">unsigned</span> num_plot_points=nplot_points(nplot);</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160; </div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> iplot=0;iplot&lt;num_plot_points;iplot++)</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    {</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;     <span class="comment">// Get local coordinates of plot point</span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;     get_s_plot(iplot,nplot,<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>);</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160; </div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;     <span class="comment">// Output the components of the position</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;DIM;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;      {</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;       outfile &lt;&lt; interpolated_x(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>) &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;      }</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160; </div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;     <span class="comment">// Output the components of the FE representation of u at s</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;DIM;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;      {</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;       outfile &lt;&lt; <a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>) &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;      }</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160; </div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;     <span class="comment">// Output the components of the FE representation of q at s</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;DIM;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;      {</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;       outfile &lt;&lt; interpolated_q(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>) &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;      }</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160; </div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;     <span class="comment">// Output FE representation of div u at s</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;     outfile &lt;&lt; interpolated_div_q(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>) &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160; </div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;     <span class="comment">// Output FE representation of p at s</span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;     outfile &lt;&lt; interpolated_p(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>) &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160; </div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;     <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_node=this-&gt;nnode();</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160; </div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;     <a class="code" href="classoomph_1_1Shape.html">Shape</a> psi(n_node);</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;     <a class="code" href="namespaceoomph_1_1OneDimLagrange.html#a117f8b892dc89989ecdad99ff261e120">shape</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,psi);</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160; </div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;     <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> interpolated_du_dt(DIM,0.0);</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160; </div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;DIM;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;      {</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;       <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l=0;l&lt;n_node;l++)</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;        {</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;         interpolated_du_dt[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]+=du_dt(l,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>)*psi(l);</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;        }</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;       outfile &lt;&lt; interpolated_du_dt[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;      }</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160; </div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;     <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> interpolated_d2u_dt2(DIM,0.0);</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160; </div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;DIM;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;      {</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;       <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l=0;l&lt;n_node;l++)</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;        {</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;         interpolated_d2u_dt2[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]+=d2u_dt2(l,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>)*psi(l);</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;        }</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;       outfile &lt;&lt; interpolated_d2u_dt2[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;      }</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160; </div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;     <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_q_basis=this-&gt;nq_basis();</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;     <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_q_basis_edge=this-&gt;nq_basis_edge();</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160; </div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;     <a class="code" href="classoomph_1_1Shape.html">Shape</a> q_basis(n_q_basis,DIM), q_basis_local(n_q_basis,DIM);</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;     this-&gt;get_q_basis_local(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,q_basis_local);</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;     (void)this-&gt;transform_basis(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,q_basis_local,psi,q_basis);</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160; </div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;     <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> interpolated_dq_dt(DIM,0.0);</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160; </div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;DIM;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;      {</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;       <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l=0;l&lt;n_q_basis_edge;l++)</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;        {</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;         interpolated_dq_dt[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]+=dq_edge_dt(l)*q_basis(l,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>);</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;        }</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;       <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l=n_q_basis_edge;l&lt;n_q_basis;l++)</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;        {</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;         interpolated_dq_dt[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]+=dq_internal_dt(l-n_q_basis_edge)*q_basis(l,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>);</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;        }</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;       outfile &lt;&lt; interpolated_dq_dt[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;      }</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160; </div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;     outfile &lt;&lt; std::endl;</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    }</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160; </div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;   <span class="comment">// Write tecplot footer (e.g. FE connectivity lists)</span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;   this-&gt;write_tecplot_zone_footer(outfile,nplot);</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;  }</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="comment"> /// \short Output FE representation of exact soln: x,y,u1,u2,q1,q2,div_q,p at</span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;<span class="comment"> /// Nplot^DIM plot points</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;<span class="comment"></span> <span class="keyword">template</span>&lt;<span class="keywordtype">unsigned</span> DIM&gt;</div>
<div class="line"><a name="l00364"></a><span class="lineno"><a class="line" href="classoomph_1_1PoroelasticityEquations.html#a11af50ce3426539de63b8efe57a5fa4c">  364</a></span>&#160; <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1PoroelasticityEquations.html#a11af50ce3426539de63b8efe57a5fa4c">PoroelasticityEquations&lt;DIM&gt;::output_fct</a>(</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;   std::ostream &amp;outfile,</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;nplot,</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;   <a class="code" href="classoomph_1_1FiniteElement.html#a690fd33af26cc3e84f39bba6d5a85202">FiniteElement::SteadyExactSolutionFctPt</a> exact_soln_pt)</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;  {</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;   <span class="comment">// Vector of local coordinates</span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;   <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>(DIM);</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160; </div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;   <span class="comment">// Vector for coordintes</span></div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;   <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> x(DIM);</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160; </div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;   <span class="comment">// Tecplot header info</span></div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;   outfile &lt;&lt; this-&gt;tecplot_zone_string(nplot);</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160; </div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;   <span class="comment">// Exact solution Vector</span></div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;   <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> exact_soln(2*DIM+2);</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160; </div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;   <span class="comment">// Loop over plot points</span></div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;   <span class="keywordtype">unsigned</span> num_plot_points=this-&gt;nplot_points(nplot);</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160; </div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> iplot=0;iplot&lt;num_plot_points;iplot++)</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    {</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;     <span class="comment">// Get local coordinates of plot point</span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;     this-&gt;get_s_plot(iplot,nplot,<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>);</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160; </div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;     <span class="comment">// Get x position as Vector</span></div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;     this-&gt;interpolated_x(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,x);</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160; </div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;     <span class="comment">// Get exact solution at this point</span></div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;     (*exact_soln_pt)(x,exact_soln);</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160; </div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;     <span class="comment">// Output x,y,q_exact,p_exact,div_q_exact</span></div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;DIM;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;      {</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;       outfile &lt;&lt; x[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;      }</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;2*DIM+2;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;      {</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;       outfile &lt;&lt; exact_soln[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;      }</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;     outfile &lt;&lt; std::endl;</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    }</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160; </div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;   <span class="comment">// Write tecplot footer (e.g. FE connectivity lists)</span></div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;   this-&gt;write_tecplot_zone_footer(outfile,nplot);</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;  }</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;<span class="comment"> /// \short Output FE representation of exact soln: x,y,u1,u2,div_q,p at</span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;<span class="comment"> /// Nplot^DIM plot points. Unsteady version</span></div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;<span class="comment"></span> <span class="keyword">template</span>&lt;<span class="keywordtype">unsigned</span> DIM&gt;</div>
<div class="line"><a name="l00414"></a><span class="lineno"><a class="line" href="classoomph_1_1PoroelasticityEquations.html#af6ff5d6c420bb061faab9faedfa02938">  414</a></span>&#160; <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1PoroelasticityEquations.html#a11af50ce3426539de63b8efe57a5fa4c">PoroelasticityEquations&lt;DIM&gt;::output_fct</a>(</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;   std::ostream &amp;outfile,</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;nplot,</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">double</span> &amp;time,</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;   <a class="code" href="classoomph_1_1FiniteElement.html#ad4ecf2b61b158a4b4d351a60d23c633e">FiniteElement::UnsteadyExactSolutionFctPt</a> exact_soln_pt)</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;  {</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;   <span class="comment">// Vector of local coordinates</span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;   <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>(DIM);</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160; </div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;   <span class="comment">// Vector for coordintes</span></div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;   <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> x(DIM);</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160; </div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;   <span class="comment">// Tecplot header info</span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;   outfile &lt;&lt; this-&gt;tecplot_zone_string(nplot);</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160; </div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;   <span class="comment">// Exact solution Vector</span></div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;   <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> exact_soln(2*DIM+2);</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160; </div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;   <span class="comment">// Loop over plot points</span></div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;   <span class="keywordtype">unsigned</span> num_plot_points=this-&gt;nplot_points(nplot);</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160; </div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> iplot=0;iplot&lt;num_plot_points;iplot++)</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    {</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;     <span class="comment">// Get local coordinates of plot point</span></div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;     this-&gt;get_s_plot(iplot,nplot,<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>);</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160; </div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;     <span class="comment">// Get x position as Vector</span></div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;     this-&gt;interpolated_x(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,x);</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160; </div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;     <span class="comment">// Get exact solution at this point</span></div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;     (*exact_soln_pt)(time,x,exact_soln);</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160; </div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;     <span class="comment">// Output x,y,q_exact,p_exact,div_q_exact</span></div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;DIM;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;      {</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;       outfile &lt;&lt; x[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;      }</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;2*DIM+2;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;      {</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;       outfile &lt;&lt; exact_soln[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;      }</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;     outfile &lt;&lt; std::endl;</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    }</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160; </div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;   <span class="comment">// Write tecplot footer (e.g. FE connectivity lists)</span></div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;   this-&gt;write_tecplot_zone_footer(outfile,nplot);</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;  }</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;<span class="comment"> /// \short Compute the error between the FE solution and the exact solution</span></div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;<span class="comment"> /// using the H(div) norm for q and L^2 norm for u and p</span></div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;<span class="comment"></span> <span class="keyword">template</span>&lt;<span class="keywordtype">unsigned</span> DIM&gt;</div>
<div class="line"><a name="l00465"></a><span class="lineno"><a class="line" href="classoomph_1_1PoroelasticityEquations.html#a9ad9413383820342f2c5a967c4bf4e94">  465</a></span>&#160; <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1PoroelasticityEquations.html#a9ad9413383820342f2c5a967c4bf4e94">PoroelasticityEquations&lt;DIM&gt;::compute_error</a>(</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;   std::ostream &amp;outfile,</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;   <a class="code" href="classoomph_1_1FiniteElement.html#a690fd33af26cc3e84f39bba6d5a85202">FiniteElement::SteadyExactSolutionFctPt</a> exact_soln_pt,</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;   <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; error,</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;   <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; norm)</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;  {</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;3;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    {</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;     error[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]=0.0;</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;     norm[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]=0.0;</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    }</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160; </div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;   <span class="comment">// Vector of local coordinates</span></div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;   <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>(DIM);</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160; </div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;   <span class="comment">// Vector for coordinates</span></div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;   <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> x(DIM);</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160; </div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;   <span class="comment">// Set the value of n_intpt</span></div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;   <span class="keywordtype">unsigned</span> n_intpt = this-&gt;integral_pt()-&gt;nweight();</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160; </div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;   outfile &lt;&lt; <span class="stringliteral">&quot;ZONE&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160; </div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;   <span class="comment">// Exact solution Vector (u,v,[w])</span></div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;   <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> exact_soln(2*DIM+2);</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160; </div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;   <span class="comment">// Loop over the integration points</span></div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> ipt=0;ipt&lt;n_intpt;ipt++)</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    {</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;     <span class="comment">// Assign values of s</span></div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;DIM;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;      {</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;       <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] = this-&gt;integral_pt()-&gt;knot(ipt,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>);</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;      }</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160; </div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;     <span class="comment">// Get the integral weight</span></div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;     <span class="keywordtype">double</span> w = this-&gt;integral_pt()-&gt;weight(ipt);</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160; </div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;     <span class="comment">// Get jacobian of mapping</span></div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;     <span class="keywordtype">double</span> J=this-&gt;J_eulerian(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>);</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160; </div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;     <span class="comment">// Premultiply the weights and the Jacobian</span></div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;     <span class="keywordtype">double</span> <a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a> = w*J;</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160; </div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;     <span class="comment">// Get x position as Vector</span></div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;     this-&gt;interpolated_x(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,x);</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160; </div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;     <span class="comment">// Get exact solution at this point</span></div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;     (*exact_soln_pt)(x,exact_soln);</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160; </div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;     <span class="comment">// Displacement error</span></div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;DIM;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;      {</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;       norm[0]+=exact_soln[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]*exact_soln[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;       <span class="comment">// Error due to q_i</span></div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;       error[0]+=(exact_soln[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]-this-&gt;<a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>(s,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>))*</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;                 (exact_soln[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]-this-&gt;<a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>(s,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>))*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;      }</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160; </div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;     <span class="comment">// Flux error</span></div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;DIM;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;      {</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;       norm[1]+=exact_soln[DIM+<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]*exact_soln[DIM+<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;       <span class="comment">// Error due to q_i</span></div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;       error[1]+=(exact_soln[DIM+<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]-this-&gt;interpolated_q(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>))*</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;                 (exact_soln[DIM+<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]-this-&gt;interpolated_q(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>))*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;      }</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160; </div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;     <span class="comment">// Flux divergence error</span></div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;     norm[1]+=exact_soln[2*DIM]*exact_soln[2*DIM]*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;     error[1]+=(exact_soln[2*DIM]-interpolated_div_q(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>))*</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;               (exact_soln[2*DIM]-interpolated_div_q(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>))*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160; </div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;     <span class="comment">// Pressure error</span></div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;     norm[2]+=exact_soln[2*DIM+1]*exact_soln[2*DIM+1]*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;     error[2]+=(exact_soln[2*DIM+1]-this-&gt;interpolated_p(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>))*</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;               (exact_soln[2*DIM+1]-this-&gt;interpolated_p(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>))*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160; </div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;     <span class="comment">// Output x,y,[z]</span></div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;DIM;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;      {</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;       outfile &lt;&lt; x[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;      }</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160; </div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;     <span class="comment">// Output u_1_error,u_2_error,...</span></div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;DIM;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;      {</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;       outfile &lt;&lt; exact_soln[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]-this-&gt;<a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>(s,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>) &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;      }</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160; </div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;     <span class="comment">// Output q_1_error,q_2_error,...</span></div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;DIM;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;      {</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;       outfile &lt;&lt; exact_soln[DIM+<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]-this-&gt;interpolated_q(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>) &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;      }</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160; </div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;     <span class="comment">// Output p_error</span></div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;     outfile &lt;&lt; exact_soln[2*DIM+1]-this-&gt;interpolated_p(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>) &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160; </div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;     outfile &lt;&lt; std::endl;</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;    }</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;  }</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;<span class="comment"> /// \short Compute the error between the FE solution and the exact solution</span></div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;<span class="comment"> /// using the H(div) norm for u and L^2 norm for p. Unsteady version</span></div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;<span class="comment"></span> <span class="keyword">template</span>&lt;<span class="keywordtype">unsigned</span> DIM&gt;</div>
<div class="line"><a name="l00571"></a><span class="lineno"><a class="line" href="classoomph_1_1PoroelasticityEquations.html#acc847138fbcb1833934129ef676e03a9">  571</a></span>&#160; <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1PoroelasticityEquations.html#a9ad9413383820342f2c5a967c4bf4e94">PoroelasticityEquations&lt;DIM&gt;::compute_error</a>(</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;   std::ostream &amp;outfile,</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;   <a class="code" href="classoomph_1_1FiniteElement.html#ad4ecf2b61b158a4b4d351a60d23c633e">FiniteElement::UnsteadyExactSolutionFctPt</a> exact_soln_pt,</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">double</span> &amp;time,</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;   <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; error,</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;   <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; norm)</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;  {</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;3;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;    {</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;     error[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]=0.0;</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;     norm[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]=0.0;</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;    }</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160; </div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;   <span class="comment">// Vector of local coordinates</span></div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;   <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>(DIM);</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160; </div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;   <span class="comment">// Vector for coordinates</span></div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;   <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> x(DIM);</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160; </div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;   <span class="comment">// Set the value of n_intpt</span></div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;   <span class="keywordtype">unsigned</span> n_intpt = this-&gt;integral_pt()-&gt;nweight();</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160; </div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;   outfile &lt;&lt; <span class="stringliteral">&quot;ZONE&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160; </div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;   <span class="comment">// Exact solution Vector (u,v,[w])</span></div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;   <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> exact_soln(2*DIM+2);</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160; </div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;   <span class="comment">// Loop over the integration points</span></div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> ipt=0;ipt&lt;n_intpt;ipt++)</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;    {</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;     <span class="comment">// Assign values of s</span></div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;DIM;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;      {</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;       <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] = this-&gt;integral_pt()-&gt;knot(ipt,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>);</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;      }</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160; </div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;     <span class="comment">// Get the integral weight</span></div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;     <span class="keywordtype">double</span> w = this-&gt;integral_pt()-&gt;weight(ipt);</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160; </div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;     <span class="comment">// Get jacobian of mapping</span></div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;     <span class="keywordtype">double</span> J=this-&gt;J_eulerian(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>);</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160; </div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;     <span class="comment">// Premultiply the weights and the Jacobian</span></div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;     <span class="keywordtype">double</span> <a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a> = w*J;</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160; </div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;     <span class="comment">// Get x position as Vector</span></div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;     this-&gt;interpolated_x(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,x);</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160; </div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;     <span class="comment">// Get exact solution at this point</span></div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;     (*exact_soln_pt)(time,x,exact_soln);</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160; </div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;     <span class="comment">// Displacement error</span></div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;DIM;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;      {</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;       norm[0]+=exact_soln[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]*exact_soln[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;       <span class="comment">// Error due to q_i</span></div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;       error[0]+=(exact_soln[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]-this-&gt;<a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>(s,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>))*</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;                 (exact_soln[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]-this-&gt;<a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>(s,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>))*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;      }</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160; </div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;     <span class="comment">// Flux error</span></div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;DIM;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;      {</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;       norm[1]+=exact_soln[DIM+<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]*exact_soln[DIM+<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;       <span class="comment">// Error due to q_i</span></div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;       error[1]+=(exact_soln[DIM+<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]-this-&gt;interpolated_q(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>))*</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;                 (exact_soln[DIM+<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]-this-&gt;interpolated_q(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>))*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;      }</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160; </div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;     <span class="comment">// Flux divergence error</span></div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;     norm[1]+=exact_soln[2*DIM]*exact_soln[2*DIM]*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;     error[1]+=(exact_soln[2*DIM]-interpolated_div_q(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>))*</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;               (exact_soln[2*DIM]-interpolated_div_q(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>))*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160; </div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;     <span class="comment">// Pressure error</span></div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;     norm[2]+=exact_soln[2*DIM+1]*exact_soln[2*DIM+1]*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;     error[2]+=(exact_soln[2*DIM+1]-this-&gt;interpolated_p(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>))*</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;               (exact_soln[2*DIM+1]-this-&gt;interpolated_p(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>))*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160; </div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;     <span class="comment">// Output x,y,[z]</span></div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;DIM;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;      {</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;       outfile &lt;&lt; x[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;      }</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160; </div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;     <span class="comment">// Output u_1_error,u_2_error,...</span></div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;DIM;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;      {</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;       outfile &lt;&lt; exact_soln[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]-this-&gt;<a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>(s,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>) &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;      }</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160; </div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;     <span class="comment">// Output q_1_error,q_2_error,...</span></div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;DIM;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;      {</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;       outfile &lt;&lt; exact_soln[DIM+<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]-this-&gt;interpolated_q(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>) &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;      }</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160; </div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;     <span class="comment">// Output p_error</span></div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;     outfile &lt;&lt; exact_soln[2*DIM+1]-this-&gt;interpolated_p(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>) &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160; </div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;     outfile &lt;&lt; std::endl;</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;    }</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;  }</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;<span class="comment"> /// Fill in residuals and, if flag==true, jacobian</span></div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;<span class="comment"></span> <span class="keyword">template</span>&lt;<span class="keywordtype">unsigned</span> DIM&gt;</div>
<div class="line"><a name="l00677"></a><span class="lineno"><a class="line" href="classoomph_1_1PoroelasticityEquations.html#a50bcb2f690fb903504c03ea1cc747477">  677</a></span>&#160; <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1PoroelasticityEquations.html#a50bcb2f690fb903504c03ea1cc747477">PoroelasticityEquations&lt;DIM&gt;::fill_in_generic_residual_contribution</a>(</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;   <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;<a class="code" href="the__data__structure_8txt.html#a1400a973def57b85051cfe1070be1810">residuals</a>,</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;   <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> &amp;jacobian,</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;   <span class="keywordtype">bool</span> flag)</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;  {</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;   <span class="comment">// Get the number of geometric nodes, total number of basis functions,</span></div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;   <span class="comment">// and number of edges basis functions</span></div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_node = nnode();</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_q_basis = nq_basis();</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_q_basis_edge = nq_basis_edge();</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_p_basis = np_basis();</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160; </div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;   <span class="comment">// Storage for the geometric and computational bases and the test functions</span></div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;   <a class="code" href="classoomph_1_1Shape.html">Shape</a> psi(n_node),</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;         u_basis(n_node), u_test(n_node),</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;         q_basis(n_q_basis,DIM), q_test(n_q_basis,DIM),</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;         p_basis(n_p_basis), p_test(n_p_basis),</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;         div_q_basis_ds(n_q_basis), div_q_test_ds(n_q_basis);</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160; </div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;   <a class="code" href="classoomph_1_1DShape.html">DShape</a> dpsidx(n_node,DIM), du_basis_dx(n_node,DIM), du_test_dx(n_node,DIM);</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160; </div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;   <span class="comment">// Get the number of integration points</span></div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;   <span class="keywordtype">unsigned</span> n_intpt = integral_pt()-&gt;nweight();</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160; </div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;   <span class="comment">// Storage for the local coordinates</span></div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;   <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>(DIM);</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160; </div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;   <span class="comment">// Storage for the elasticity source function</span></div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;   <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> f_solid(DIM);</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160; </div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;   <span class="comment">// Storage for the source function</span></div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;   <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> f_fluid(DIM);</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160; </div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;   <span class="comment">// Storage for the mass source function</span></div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;   <span class="keywordtype">double</span> mass_source_local;</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160; </div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;   <span class="comment">// Storage for Lambda_sq</span></div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;   <span class="keywordtype">double</span> lambda_sq = this-&gt;lambda_sq();</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160; </div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;   <span class="comment">// Get the value of 1/k</span></div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;   <span class="keywordtype">double</span> k_inv = this-&gt;k_inv();</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160; </div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;   <span class="comment">// Get the value of alpha</span></div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;   <span class="keywordtype">double</span> alpha = this-&gt;alpha();</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160; </div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;   <span class="comment">// Get the value of the porosity</span></div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;   <span class="keywordtype">double</span> porosity = this-&gt;porosity();</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160; </div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;   <span class="comment">// Get the density ratio</span></div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;   <span class="keywordtype">double</span> density_ratio = this-&gt;density_ratio();</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160; </div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;   <span class="comment">// Precompute the ratio of fluid density to combined density</span></div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;   <span class="keywordtype">double</span> rho_f_over_rho = density_ratio/(1+porosity*(density_ratio-1));</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160; </div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;   <span class="comment">// Get continuous time from timestepper of first node</span></div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;   <span class="keywordtype">double</span> time=node_pt(0)-&gt;time_stepper_pt()-&gt;time_pt()-&gt;time();</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160; </div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;   <span class="comment">// Local equation and unknown numbers</span></div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;   <span class="keywordtype">int</span> local_eqn = 0, local_unknown = 0;</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160; </div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;   <span class="comment">// Loop over the integration points</span></div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> ipt=0;ipt&lt;n_intpt;ipt++)</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;    {</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;     <span class="comment">// Find the local coordinates at the integration point</span></div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;DIM;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++) { <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] = integral_pt()-&gt;knot(ipt,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>); }</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160; </div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;     <span class="comment">// Get the weight of the intetgration point</span></div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;     <span class="keywordtype">double</span> w = integral_pt()-&gt;weight(ipt);</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160; </div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;     <span class="comment">// Call the basis functions and test functions and get the</span></div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;     <span class="comment">// (geometric) jacobian of the current element</span></div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;     <span class="keywordtype">double</span> J =</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;      shape_basis_test_local_at_knot(</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;        ipt,psi,dpsidx,</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;        u_basis,u_test,</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;        du_basis_dx,du_test_dx,</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;        q_basis,q_test,</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;        p_basis,p_test,</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;        div_q_basis_ds,div_q_test_ds);</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160; </div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;     <span class="comment">// Storage for interpolated values</span></div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;     <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> interpolated_x(DIM,0.0);</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;     <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> <a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>(DIM,0.0);</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;     <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> interpolated_du_dx(DIM,DIM,0.0);</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;     <span class="keywordtype">double</span> interpolated_div_du_dt_dx=0.0;</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;     <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> interpolated_d2u_dt2(DIM,0.0);</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;     <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> interpolated_q(DIM,0.0);</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;     <span class="keywordtype">double</span> interpolated_div_q_ds=0.0;</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;     <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> interpolated_dq_dt(DIM,0.0);</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;     <span class="keywordtype">double</span> interpolated_p=0.0;</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160; </div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;     <span class="comment">// loop over the vector basis functions to find interpolated x</span></div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l=0;l&lt;n_node;l++)</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;      {</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;       <span class="comment">// Loop over the geometric basis functions</span></div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;       <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;DIM;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;        {</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;         interpolated_x[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] += nodal_position(l,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>)*psi(l);</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160; </div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;         interpolated_d2u_dt2[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] += this-&gt;d2u_dt2(l,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>)*u_basis(l);</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160; </div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;         <span class="comment">//Get the nodal displacements</span></div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;         <span class="keyword">const</span> <span class="keywordtype">double</span> u_value = this-&gt;raw_nodal_value(l,u_index(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>));</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;         <a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] += u_value*u_basis(l);</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160; </div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;         <span class="comment">//Loop over derivative directions</span></div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;         <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> j=0;j&lt;DIM;j++)</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;          {</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;           interpolated_du_dx(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>,j) += u_value*du_basis_dx(l,j);</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;          }</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160; </div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;         <span class="comment">// divergence of the time derivative of the solid displacement</span></div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;         interpolated_div_du_dt_dx += this-&gt;du_dt(l,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>)*du_basis_dx(l,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>);</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;        }</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;      }</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160; </div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;     <span class="comment">// loop over the nodes and use the geometric basis functions to find the</span></div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;     <span class="comment">// interpolated flux and its time derivative</span></div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;DIM;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;      {</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;       <span class="comment">// Loop over the edge basis vectors</span></div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;       <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l=0;l&lt;n_q_basis_edge;l++)</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;        {</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;         interpolated_q[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] += q_edge(l)*q_basis(l,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>);</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;         interpolated_dq_dt[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] += dq_edge_dt(l)*q_basis(l,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>);</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;        }</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;       <span class="comment">// Loop over the internal basis vectors</span></div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;       <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l=n_q_basis_edge;l&lt;n_q_basis;l++)</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;        {</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;         interpolated_q[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] += q_internal(l-n_q_basis_edge)*q_basis(l,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>);</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;         interpolated_dq_dt[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] += dq_internal_dt(l-n_q_basis_edge)*q_basis(l,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>);</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;        }</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;      }</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160; </div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;     <span class="comment">// loop over the pressure basis and find the interpolated pressure</span></div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l=0;l&lt;n_p_basis;l++)</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;      {</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;       interpolated_p += p_value(l)*p_basis(l);</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;      }</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160; </div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;     <span class="comment">// loop over the u edge divergence basis and the u internal divergence</span></div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;     <span class="comment">// basis to find interpolated div u</span></div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l=0;l&lt;n_q_basis_edge;l++)</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;      {</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;       interpolated_div_q_ds += q_edge(l)*div_q_basis_ds(l);</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;      }</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l=n_q_basis_edge;l&lt;n_q_basis;l++)</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;      {</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;       interpolated_div_q_ds += q_internal(l-n_q_basis_edge)*div_q_basis_ds(l);</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;      }</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160; </div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;     <span class="comment">// Get the solid forcing</span></div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;     this-&gt;force_solid(time,interpolated_x,f_solid);</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160; </div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;     <span class="comment">// Get the fluid forcing</span></div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;     this-&gt;force_fluid(time,interpolated_x,f_fluid);</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160; </div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;     <span class="comment">// Get the mass source function</span></div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;     this-&gt;mass_source(time,interpolated_x,mass_source_local);</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160; </div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;     <span class="comment">//Premultiply the weights and the Jacobian</span></div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;     <span class="keywordtype">double</span> <a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a> = w*J;</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160; </div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;     <span class="comment">// Linear elasticity:</span></div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160; </div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l=0;l&lt;n_node;l++)</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;      {</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;       <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>=0;<a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>&lt;DIM;<a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>++)</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;        {</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;         local_eqn = this-&gt;nodal_local_eqn(l,u_index(<a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>));</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160; </div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;         <span class="keywordflow">if</span>(local_eqn&gt;=0)</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;          {</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;           <a class="code" href="the__data__structure_8txt.html#a1400a973def57b85051cfe1070be1810">residuals</a>[local_eqn] +=</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;            (lambda_sq*(interpolated_d2u_dt2[<a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>]</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;                        +rho_f_over_rho*interpolated_dq_dt[<a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>]</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;                       )</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;             -f_solid[<a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>]</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;            )*u_test(l)*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160; </div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;           <span class="comment">// Stress term</span></div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;           <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> b=0;b&lt;DIM;b++)</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;            {</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;             <span class="keywordflow">if</span>(<a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>==b)</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;              {</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;               <a class="code" href="the__data__structure_8txt.html#a1400a973def57b85051cfe1070be1810">residuals</a>[local_eqn] -= alpha*interpolated_p*du_test_dx(l,b)*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;              }</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160; </div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;             <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> c=0;c&lt;DIM;c++)</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;              {</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;               <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> d=0;d&lt;DIM;d++)</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;                {</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;                 <span class="comment">//Add the stress terms to the residuals</span></div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;                 <a class="code" href="the__data__structure_8txt.html#a1400a973def57b85051cfe1070be1810">residuals</a>[local_eqn] +=</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;                  this-&gt;<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7da585070bd0e3801c3bbed287ef3c4a265">E</a>(a,b,c,d)*interpolated_du_dx(c,d)*du_test_dx(l,b)*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;                }</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;              }</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;            }</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;           <span class="comment">// Jacobian entries</span></div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;           <span class="keywordflow">if</span>(flag)</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;            {</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;             <span class="comment">// d(u_eqn_l,a)/d(U_l2,c)</span></div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;             <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l2=0;l2&lt;n_node;l2++)</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;              {</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;               <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> c=0;c&lt;DIM;c++)</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;                {</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;                 local_unknown=this-&gt;nodal_local_eqn(l2,u_index(c));</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;                 <span class="keywordflow">if</span>(local_unknown&gt;=0)</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;                  {</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;                   <span class="keywordflow">if</span>(<a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>==c)</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;                    {</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;                     jacobian(local_eqn,local_unknown)+=</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;                      lambda_sq*</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;                      this-&gt;node_pt(l2)-&gt;time_stepper_pt()-&gt;weight(2,0)*</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;                      u_basis(l2)*u_test(l)*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;                    }</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160; </div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;                   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> b=0;b&lt;DIM;b++)</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;                    {</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;                     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> d=0;d&lt;DIM;d++)</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;                      {</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;                       jacobian(local_eqn,local_unknown)+=</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;                        this-&gt;<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7da585070bd0e3801c3bbed287ef3c4a265">E</a>(a,b,c,d)*du_basis_dx(l2,d)*du_test_dx(l,b)*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;                      }</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;                    }</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;                  }</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;                }</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;              }</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160; </div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;             <span class="comment">// d(u_eqn_l,a)/d(Q_l2)</span></div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;             <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l2=0;l2&lt;n_q_basis;l2++)</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;              {</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;               <a class="code" href="classoomph_1_1TimeStepper.html">TimeStepper</a>* timestepper_pt=0;</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160; </div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;               <span class="keywordflow">if</span>(l2&lt;n_q_basis_edge)</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;                {</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;                 local_unknown=q_edge_local_eqn(l2);</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;                 timestepper_pt=</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;                  this-&gt;node_pt(q_edge_node_number(l2))-&gt;time_stepper_pt();</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;                }</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;               <span class="keywordflow">else</span> <span class="comment">// n_q_basis_edge &lt;= l &lt; n_basis</span></div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;                {</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;                 local_unknown=q_internal_local_eqn(l2-n_q_basis_edge);</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;                 timestepper_pt=</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;                  this-&gt;internal_data_pt(q_internal_index())-&gt;time_stepper_pt();</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;                }</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160; </div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;               <span class="keywordflow">if</span>(local_unknown&gt;=0)</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;                {</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;                 jacobian(local_eqn,local_unknown)+=</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;                  lambda_sq*rho_f_over_rho*timestepper_pt-&gt;<a class="code" href="classoomph_1_1TimeStepper.html#a4cb0aecb044b77ba0553cdd54b586d8a">weight</a>(1,0)*</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;                  q_basis(l2,<a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>)*u_test(l)*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;                }</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;              }</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160; </div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;             <span class="comment">// d(u_eqn_l,a)/d(P_l2)</span></div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;             <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l2=0;l2&lt;n_p_basis;l2++)</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;              {</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;               local_unknown=p_local_eqn(l2);</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;               <span class="keywordflow">if</span>(local_unknown&gt;=0)</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;                {</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;                 jacobian(local_eqn,local_unknown)-=</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;                  alpha*p_basis(l2)*du_test_dx(l,<a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>)*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;                }</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;              }</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;            } <span class="comment">// End of Jacobian entries</span></div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;          } <span class="comment">// End of if not boundary condition</span></div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;        } <span class="comment">// End of loop over dimensions</span></div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;      } <span class="comment">// End of loop over u test functions</span></div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160; </div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160; </div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;     <span class="comment">// Darcy:</span></div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;     <span class="comment">// Loop over the test functions</span></div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l=0;l&lt;n_q_basis;l++)</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;      {</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;       <span class="keywordflow">if</span>(l&lt;n_q_basis_edge)</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;        {</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;         local_eqn = q_edge_local_eqn(l);</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;        }</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;       <span class="keywordflow">else</span> <span class="comment">// n_q_basis_edge &lt;= l &lt; n_basis</span></div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;        {</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;         local_eqn = q_internal_local_eqn(l-n_q_basis_edge);</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;        }</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160; </div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;       <span class="comment">// If it&#39;s not a boundary condition</span></div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;       <span class="keywordflow">if</span>(local_eqn&gt;=0)</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;        {</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;         <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;DIM;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;          {</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;           <a class="code" href="the__data__structure_8txt.html#a1400a973def57b85051cfe1070be1810">residuals</a>[local_eqn] +=</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;            (k_inv*interpolated_q[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;             -rho_f_over_rho*f_fluid[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;             +rho_f_over_rho*lambda_sq*(interpolated_d2u_dt2[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;                                        +(1.0/porosity)*interpolated_dq_dt[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;                                       )</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;            )*q_test(l,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>)*w*J;</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;          }</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160; </div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;         <span class="comment">// deliberately no jacobian factor in this integral</span></div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;         <a class="code" href="the__data__structure_8txt.html#a1400a973def57b85051cfe1070be1810">residuals</a>[local_eqn] -= (interpolated_p*div_q_test_ds(l))*w;</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160; </div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;         <span class="comment">// Jacobian entries</span></div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;         <span class="keywordflow">if</span>(flag)</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;          {</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;           <span class="comment">// d(q_eqn_l)/d(U_l2,c)</span></div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;           <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l2=0;l2&lt;n_node;l2++)</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;            {</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;             <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> c=0;c&lt;DIM;c++)</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;              {</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;               local_unknown=this-&gt;nodal_local_eqn(l2,u_index(c));</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;               <span class="keywordflow">if</span>(local_unknown&gt;=0)</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;                {</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;                 jacobian(local_eqn,local_unknown)+=</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;                  rho_f_over_rho*lambda_sq*</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;                  this-&gt;node_pt(l2)-&gt;time_stepper_pt()-&gt;weight(2,0)*</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;                  u_basis(l2)*q_test(l,c)*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;                }</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;              }</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;            }</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160; </div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;           <span class="comment">// d(q_eqn_l)/d(Q_l2)</span></div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;           <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l2=0;l2&lt;n_q_basis;l2++)</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;            {</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;             <a class="code" href="classoomph_1_1TimeStepper.html">TimeStepper</a>* timestepper_pt=0;</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160; </div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;             <span class="keywordflow">if</span>(l2&lt;n_q_basis_edge)</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;              {</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;               local_unknown=q_edge_local_eqn(l2);</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;               timestepper_pt=</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;                this-&gt;node_pt(q_edge_node_number(l2))-&gt;time_stepper_pt();</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;              }</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;             <span class="keywordflow">else</span> <span class="comment">// n_q_basis_edge &lt;= l &lt; n_basis</span></div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;              {</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;               local_unknown=q_internal_local_eqn(l2-n_q_basis_edge);</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;               timestepper_pt=</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;                this-&gt;internal_data_pt(q_internal_index())-&gt;time_stepper_pt();</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;              }</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160; </div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;             <span class="keywordflow">if</span>(local_unknown&gt;=0)</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;              {</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;               <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> c=0;c&lt;DIM;c++)</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;                {</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;                 jacobian(local_eqn,local_unknown)+=</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;                  q_basis(l2,c)*q_test(l,c)*</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;                  (k_inv+</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;                   rho_f_over_rho*lambda_sq*</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;                   timestepper_pt-&gt;<a class="code" href="classoomph_1_1TimeStepper.html#a4cb0aecb044b77ba0553cdd54b586d8a">weight</a>(1,0)/porosity)*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;                }</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;              }</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;            }</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160; </div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;           <span class="comment">// d(q_eqn_l)/d(P_l2)</span></div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;           <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l2=0;l2&lt;n_p_basis;l2++)</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;            {</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;             local_unknown=p_local_eqn(l2);</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160; </div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;             <span class="comment">// deliberately no jacobian factor in this term</span></div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;             jacobian(local_eqn,local_unknown)-=</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;              p_basis(l2)*div_q_test_ds(l)*w;</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;            }</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;          } <span class="comment">// End of Jacobian entries</span></div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;        } <span class="comment">// End of if not boundary condition</span></div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;      } <span class="comment">// End of loop over q test functions</span></div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160; </div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;     <span class="comment">// loop over pressure test functions</span></div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l=0;l&lt;n_p_basis;l++)</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;      {</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;       <span class="comment">// get the local equation number</span></div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;       local_eqn=p_local_eqn(l);</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160; </div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;       <span class="comment">// If it&#39;s not a boundary condition</span></div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;       <span class="keywordflow">if</span>(local_eqn&gt;=0)</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;        {</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;         <span class="comment">// solid divergence term</span></div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;         <a class="code" href="the__data__structure_8txt.html#a1400a973def57b85051cfe1070be1810">residuals</a>[local_eqn]+=alpha*interpolated_div_du_dt_dx*p_test(l)*w*J;</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;         <span class="comment">// fluid divergence term - deliberately no jacobian factor in this term</span></div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;         <a class="code" href="the__data__structure_8txt.html#a1400a973def57b85051cfe1070be1810">residuals</a>[local_eqn]+=interpolated_div_q_ds*p_test(l)*w;</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;         <span class="comment">// mass source term</span></div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;         <a class="code" href="the__data__structure_8txt.html#a1400a973def57b85051cfe1070be1810">residuals</a>[local_eqn]-=mass_source_local*p_test(l)*w*J;</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160; </div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;         <span class="comment">// Jacobian entries</span></div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;         <span class="keywordflow">if</span>(flag)</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;          {</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;           <span class="comment">// d(p_eqn_l)/d(U_l2,c)</span></div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;           <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l2=0;l2&lt;n_node;l2++)</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;            {</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;             <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> c=0;c&lt;DIM;c++)</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;              {</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;               local_unknown=this-&gt;nodal_local_eqn(l2,u_index(c));</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160; </div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;               <span class="keywordflow">if</span>(local_unknown&gt;=0)</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;                {</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;                 jacobian(local_eqn,local_unknown)+=</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;                  alpha*this-&gt;node_pt(l2)-&gt;time_stepper_pt()-&gt;weight(1,0)*</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;                  du_basis_dx(l2,c)*p_test(l)*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;                }</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;              }</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;            }</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160; </div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;           <span class="comment">// d(p_eqn_l)/d(Q_l2)</span></div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;           <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l2=0;l2&lt;n_q_basis;l2++)</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;            {</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;             <span class="keywordflow">if</span>(l2&lt;n_q_basis_edge)</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;              {</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;               local_unknown=q_edge_local_eqn(l2);</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;              }</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;             <span class="keywordflow">else</span> <span class="comment">// n_q_basis_edge &lt;= l &lt; n_basis</span></div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;              {</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;               local_unknown=q_internal_local_eqn(l2-n_q_basis_edge);</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;              }</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160; </div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;             <span class="keywordflow">if</span>(local_unknown&gt;=0)</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;              {</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;               jacobian(local_eqn,local_unknown)+=</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;                p_test(l)*div_q_basis_ds(l2)*w;</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;              }</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;            }</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;          } <span class="comment">// End of Jacobian entries</span></div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;        } <span class="comment">// End of if not boundary condition</span></div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;      } <span class="comment">// End of loop over p test functions</span></div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;    } <span class="comment">// End of loop over integration points</span></div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;  }</div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160; </div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160; <span class="comment">// Force building of templates</span></div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160; <span class="keyword">template</span> <span class="keyword">class </span><a class="code" href="classoomph_1_1PoroelasticityEquations.html">PoroelasticityEquations&lt;2&gt;</a>;</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160; </div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;} <span class="comment">// End of oomph namespace</span></div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160; </div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="athe__data__structure_8txt_html_a5448c72da3359c7796cf0c5f800732a1"><div class="ttname"><a href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a></div><div class="ttdeci">and code FiniteElement::J_eulerian(...) \endcode returns the Jacobian of the mapping from Eulerian coordinates to local coordinates. - The function \c GeneralisedElement c QElement&lt; 3, 2 &gt; is an node brick element with a trilinear mapping between and global coordinates The dimension and the number of c Nodes must be set by calling the appropriate c set_ functions in the see ref set_commands above The most important member functions implemented at this level include Functions that evaluate the shape in terms of the c FiniteElement s coordinates functions that determine whether a c Node is located at a particular coordinate Output functions that allow the element shapes to be plotted we specify a pointer to a spatial integration the default assignment can be over written at a higher level This is discussed in more detail in a&lt; A HREF=&quot;../../optimisation/html/index.html&quot;&gt; separate document&lt;/A &gt; subsubsection Maths_Element we implement the equations that are represented by the specific element We implement the employing either the geometric shape functions that already exist on or employing additional shape functions defined at this level This allows us to write further member functions such as c interpolated_u(...)</div></div>
<div class="ttc" id="athe__data__structure_8txt_html_a1400a973def57b85051cfe1070be1810"><div class="ttname"><a href="the__data__structure_8txt.html#a1400a973def57b85051cfe1070be1810">residuals</a></div><div class="ttdeci">endcode The default implementation of c the simplest possible implementation of a new element requires only the specification of c we need to know which c Data affects the residuals(and hence the Jacobian matrix). For a \c GeneralisedElement such \c Data exists in two forms</div></div>
<div class="ttc" id="anamespaceoomph_1_1QuadTreeNames_html_a8954a5947b19986b8c4b755bc7639f7da585070bd0e3801c3bbed287ef3c4a265"><div class="ttname"><a href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7da585070bd0e3801c3bbed287ef3c4a265">oomph::QuadTreeNames::E</a></div><div class="ttdeci">@ E</div><div class="ttdef"><b>Definition:</b> <a href="quadtree_8h_source.html#l00056">quadtree.h:56</a></div></div>
<div class="ttc" id="aclassoomph_1_1PoroelasticityEquations_html_a11af50ce3426539de63b8efe57a5fa4c"><div class="ttname"><a href="classoomph_1_1PoroelasticityEquations.html#a11af50ce3426539de63b8efe57a5fa4c">oomph::PoroelasticityEquations::output_fct</a></div><div class="ttdeci">void output_fct(std::ostream &amp;outfile, const unsigned &amp;nplot, FiniteElement::SteadyExactSolutionFctPt exact_soln_pt)</div><div class="ttdoc">Output FE representation of exact soln: x,y,u1,u2,div_q,p at Nplot^DIM plot points.</div><div class="ttdef"><b>Definition:</b> <a href="poroelasticity__elements_8cc_source.html#l00364">poroelasticity_elements.cc:364</a></div></div>
<div class="ttc" id="aclassoomph_1_1OomphLibError_html"><div class="ttname"><a href="classoomph_1_1OomphLibError.html">oomph::OomphLibError</a></div><div class="ttdef"><b>Definition:</b> <a href="oomph__definitions_8h_source.html#l00225">oomph_definitions.h:225</a></div></div>
<div class="ttc" id="aclassoomph_1_1FiniteElement_html_a690fd33af26cc3e84f39bba6d5a85202"><div class="ttname"><a href="classoomph_1_1FiniteElement.html#a690fd33af26cc3e84f39bba6d5a85202">oomph::FiniteElement::SteadyExactSolutionFctPt</a></div><div class="ttdeci">void(* SteadyExactSolutionFctPt)(const Vector&lt; double &gt; &amp;, Vector&lt; double &gt; &amp;)</div><div class="ttdoc">Function pointer for function that computes vector-valued steady &quot;exact solution&quot;  as .</div><div class="ttdef"><b>Definition:</b> <a href="elements_8h_source.html#l01736">elements.h:1736</a></div></div>
<div class="ttc" id="aclassoomph_1_1PoroelasticityEquations_html_a43ab3d7f2f96d78346979b5eb4b2b986"><div class="ttname"><a href="classoomph_1_1PoroelasticityEquations.html#a43ab3d7f2f96d78346979b5eb4b2b986">oomph::PoroelasticityEquations::transform_basis</a></div><div class="ttdeci">double transform_basis(const Vector&lt; double &gt; &amp;s, const Shape &amp;q_basis_local, Shape &amp;psi, DShape &amp;dpsi, Shape &amp;q_basis) const</div><div class="ttdoc">Performs a div-conserving transformation of the vector basis functions from the reference element to ...</div><div class="ttdef"><b>Definition:</b> <a href="poroelasticity__elements_8cc_source.html#l00200">poroelasticity_elements.cc:200</a></div></div>
<div class="ttc" id="aclassoomph_1_1PoroelasticityEquations_html_a2bcb2ecdcde79ff04f6abb6c45d9da97"><div class="ttname"><a href="classoomph_1_1PoroelasticityEquations.html#a2bcb2ecdcde79ff04f6abb6c45d9da97">oomph::PoroelasticityEquations::Default_porosity_value</a></div><div class="ttdeci">static double Default_porosity_value</div><div class="ttdoc">Static default value for the porosity.</div><div class="ttdef"><b>Definition:</b> <a href="poroelasticity__elements_8h_source.html#l00780">poroelasticity_elements.h:780</a></div></div>
<div class="ttc" id="aclassoomph_1_1PoroelasticityEquations_html_a932d4122e3719a1aff4e45e186c48001"><div class="ttname"><a href="classoomph_1_1PoroelasticityEquations.html#a932d4122e3719a1aff4e45e186c48001">oomph::PoroelasticityEquations::Default_lambda_sq_value</a></div><div class="ttdeci">static double Default_lambda_sq_value</div><div class="ttdoc">Static default value for timescale ratio (1.0  for natural scaling)</div><div class="ttdef"><b>Definition:</b> <a href="poroelasticity__elements_8h_source.html#l00768">poroelasticity_elements.h:768</a></div></div>
<div class="ttc" id="aclassoomph_1_1PoroelasticityEquations_html_a50bcb2f690fb903504c03ea1cc747477"><div class="ttname"><a href="classoomph_1_1PoroelasticityEquations.html#a50bcb2f690fb903504c03ea1cc747477">oomph::PoroelasticityEquations::fill_in_generic_residual_contribution</a></div><div class="ttdeci">virtual void fill_in_generic_residual_contribution(Vector&lt; double &gt; &amp;residuals, DenseMatrix&lt; double &gt; &amp;jacobian, bool flag)</div><div class="ttdoc">Fill in residuals and, if flag==true, jacobian.</div><div class="ttdef"><b>Definition:</b> <a href="poroelasticity__elements_8cc_source.html#l00677">poroelasticity_elements.cc:677</a></div></div>
<div class="ttc" id="aclassoomph_1_1DenseMatrix_html_a9937181f1cb4cfaed7aaf3b483c42456"><div class="ttname"><a href="classoomph_1_1DenseMatrix.html#a9937181f1cb4cfaed7aaf3b483c42456">oomph::DenseMatrix::ncol</a></div><div class="ttdeci">unsigned long ncol() const</div><div class="ttdoc">Return the number of columns of the matrix.</div><div class="ttdef"><b>Definition:</b> <a href="matrices_8h_source.html#l00503">matrices.h:503</a></div></div>
<div class="ttc" id="aclassoomph_1_1DenseMatrix_html"><div class="ttname"><a href="classoomph_1_1DenseMatrix.html">oomph::DenseMatrix&lt; double &gt;</a></div></div>
<div class="ttc" id="aclassoomph_1_1PoroelasticityEquations_html_a965748b26ceb0e5b2277b38eceb00444"><div class="ttname"><a href="classoomph_1_1PoroelasticityEquations.html#a965748b26ceb0e5b2277b38eceb00444">oomph::PoroelasticityEquations::Default_alpha_value</a></div><div class="ttdeci">static double Default_alpha_value</div><div class="ttdoc">Static default value for alpha.</div><div class="ttdef"><b>Definition:</b> <a href="poroelasticity__elements_8h_source.html#l00777">poroelasticity_elements.h:777</a></div></div>
<div class="ttc" id="anamespaceoomph_1_1QuadTreeNames_html_a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6"><div class="ttname"><a href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">oomph::QuadTreeNames::W</a></div><div class="ttdeci">@ W</div><div class="ttdef"><b>Definition:</b> <a href="quadtree_8h_source.html#l00056">quadtree.h:56</a></div></div>
<div class="ttc" id="aclassoomph_1_1PoroelasticityEquations_html_a9ad9413383820342f2c5a967c4bf4e94"><div class="ttname"><a href="classoomph_1_1PoroelasticityEquations.html#a9ad9413383820342f2c5a967c4bf4e94">oomph::PoroelasticityEquations::compute_error</a></div><div class="ttdeci">void compute_error(std::ostream &amp;outfile, FiniteElement::SteadyExactSolutionFctPt exact_soln_pt, Vector&lt; double &gt; &amp;error, Vector&lt; double &gt; &amp;norm)</div><div class="ttdoc">Compute the error between the FE solution and the exact solution using the H(div) norm for q and L^2 ...</div><div class="ttdef"><b>Definition:</b> <a href="poroelasticity__elements_8cc_source.html#l00465">poroelasticity_elements.cc:465</a></div></div>
<div class="ttc" id="aclassoomph_1_1PoroelasticityEquations_html_ad5814c1fe98f24ded82b5f9b50fa1fb1"><div class="ttname"><a href="classoomph_1_1PoroelasticityEquations.html#ad5814c1fe98f24ded82b5f9b50fa1fb1">oomph::PoroelasticityEquations::output</a></div><div class="ttdeci">void output(std::ostream &amp;outfile)</div><div class="ttdoc">Output with default number of plot points.</div><div class="ttdef"><b>Definition:</b> <a href="poroelasticity__elements_8h_source.html#l00660">poroelasticity_elements.h:660</a></div></div>
<div class="ttc" id="anamespaceoomph_1_1OneDimLagrange_html_a117f8b892dc89989ecdad99ff261e120"><div class="ttname"><a href="namespaceoomph_1_1OneDimLagrange.html#a117f8b892dc89989ecdad99ff261e120">oomph::OneDimLagrange::shape</a></div><div class="ttdeci">void shape(const double &amp;s, double *Psi)</div><div class="ttdoc">Definition for 1D Lagrange shape functions. The value of all the shape functions at the local coordin...</div><div class="ttdef"><b>Definition:</b> <a href="shape_8h_source.html#l00545">shape.h:545</a></div></div>
<div class="ttc" id="aclassoomph_1_1TimeStepper_html"><div class="ttname"><a href="classoomph_1_1TimeStepper.html">oomph::TimeStepper</a></div><div class="ttdoc">Base class for time-stepping schemes. Timestepper provides an approximation of the temporal derivativ...</div><div class="ttdef"><b>Definition:</b> <a href="timesteppers_8h_source.html#l00215">timesteppers.h:215</a></div></div>
<div class="ttc" id="aclassoomph_1_1PoroelasticityEquations_html_ac44640ce8b8d6bde48c236edb2f4301a"><div class="ttname"><a href="classoomph_1_1PoroelasticityEquations.html#ac44640ce8b8d6bde48c236edb2f4301a">oomph::PoroelasticityEquations::Default_k_inv_value</a></div><div class="ttdeci">static double Default_k_inv_value</div><div class="ttdoc">Static default value for 1/k.</div><div class="ttdef"><b>Definition:</b> <a href="poroelasticity__elements_8h_source.html#l00774">poroelasticity_elements.h:774</a></div></div>
<div class="ttc" id="aclassoomph_1_1FiniteElement_html_ad4ecf2b61b158a4b4d351a60d23c633e"><div class="ttname"><a href="classoomph_1_1FiniteElement.html#ad4ecf2b61b158a4b4d351a60d23c633e">oomph::FiniteElement::UnsteadyExactSolutionFctPt</a></div><div class="ttdeci">void(* UnsteadyExactSolutionFctPt)(const double &amp;, const Vector&lt; double &gt; &amp;, Vector&lt; double &gt; &amp;)</div><div class="ttdoc">Function pointer for function that computes Vector-valued time-dependent function  as .</div><div class="ttdef"><b>Definition:</b> <a href="elements_8h_source.html#l01742">elements.h:1742</a></div></div>
<div class="ttc" id="anamespaceoomph_html"><div class="ttname"><a href="namespaceoomph.html">oomph</a></div><div class="ttdoc">DRAIG: Change all instances of (SPATIAL_DIM) to (DIM-1).</div><div class="ttdef"><b>Definition:</b> <a href="advection__diffusion__elements_8cc_source.html#l00029">advection_diffusion_elements.cc:29</a></div></div>
<div class="ttc" id="aclassoomph_1_1PoroelasticityEquations_html_aea601e7d1bc0757b9effa9dcdbfa0617"><div class="ttname"><a href="classoomph_1_1PoroelasticityEquations.html#aea601e7d1bc0757b9effa9dcdbfa0617">oomph::PoroelasticityEquations::get_strain</a></div><div class="ttdeci">void get_strain(const Vector&lt; double &gt; &amp;s, DenseMatrix&lt; double &gt; &amp;strain) const</div><div class="ttdoc">Return the strain tensor.</div><div class="ttdef"><b>Definition:</b> <a href="poroelasticity__elements_8cc_source.html#l00054">poroelasticity_elements.cc:54</a></div></div>
<div class="ttc" id="aclassoomph_1_1Vector_html"><div class="ttname"><a href="classoomph_1_1Vector.html">oomph::Vector&lt; double &gt;</a></div></div>
<div class="ttc" id="aclassoomph_1_1PoroelasticityEquations_html_a49c8a61f86e8214878639c5e6c3deb59"><div class="ttname"><a href="classoomph_1_1PoroelasticityEquations.html#a49c8a61f86e8214878639c5e6c3deb59">oomph::PoroelasticityEquations::Default_density_ratio_value</a></div><div class="ttdeci">static double Default_density_ratio_value</div><div class="ttdoc">Static default value for the density ratio.</div><div class="ttdef"><b>Definition:</b> <a href="poroelasticity__elements_8h_source.html#l00771">poroelasticity_elements.h:771</a></div></div>
<div class="ttc" id="acfortran_8h_html_adb50e893b86b3e55e751a42eab3cba82"><div class="ttname"><a href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a></div><div class="ttdeci">cstr elem_len * i</div><div class="ttdef"><b>Definition:</b> <a href="cfortran_8h_source.html#l00603">cfortran.h:603</a></div></div>
<div class="ttc" id="aclassoomph_1_1DenseMatrix_html_a1b425094510d833ffe91920747a0a962"><div class="ttname"><a href="classoomph_1_1DenseMatrix.html#a1b425094510d833ffe91920747a0a962">oomph::DenseMatrix::nrow</a></div><div class="ttdeci">unsigned long nrow() const</div><div class="ttdoc">Return the number of rows of the matrix.</div><div class="ttdef"><b>Definition:</b> <a href="matrices_8h_source.html#l00500">matrices.h:500</a></div></div>
<div class="ttc" id="aclassoomph_1_1DShape_html"><div class="ttname"><a href="classoomph_1_1DShape.html">oomph::DShape</a></div><div class="ttdef"><b>Definition:</b> <a href="shape_8h_source.html#l00271">shape.h:271</a></div></div>
<div class="ttc" id="aclassoomph_1_1PoroelasticityEquations_html_a4f8cb984e4afa174beca76989299f256"><div class="ttname"><a href="classoomph_1_1PoroelasticityEquations.html#a4f8cb984e4afa174beca76989299f256">oomph::PoroelasticityEquations::get_stress</a></div><div class="ttdeci">void get_stress(const Vector&lt; double &gt; &amp;s, DenseMatrix&lt; double &gt; &amp;sigma) const</div><div class="ttdoc">Return the Cauchy stress tensor, as calculated from the elasticity tensor at specified local coordina...</div><div class="ttdef"><b>Definition:</b> <a href="poroelasticity__elements_8cc_source.html#l00156">poroelasticity_elements.cc:156</a></div></div>
<div class="ttc" id="aclassoomph_1_1TimeStepper_html_a4cb0aecb044b77ba0553cdd54b586d8a"><div class="ttname"><a href="classoomph_1_1TimeStepper.html#a4cb0aecb044b77ba0553cdd54b586d8a">oomph::TimeStepper::weight</a></div><div class="ttdeci">virtual double weight(const unsigned &amp;i, const unsigned &amp;j) const</div><div class="ttdoc">Access function for j-th weight for the i-th derivative.</div><div class="ttdef"><b>Definition:</b> <a href="timesteppers_8h_source.html#l00553">timesteppers.h:553</a></div></div>
<div class="ttc" id="aclassoomph_1_1PoroelasticityEquations_html"><div class="ttname"><a href="classoomph_1_1PoroelasticityEquations.html">oomph::PoroelasticityEquations&lt; 2 &gt;</a></div></div>
<div class="ttc" id="athe__data__structure_8txt_html_a26a1818885f7aebd0129ce36f6d391e8"><div class="ttname"><a href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a></div><div class="ttdeci">often abbreviated as dof b History b history values are but b not b the values at previous timesteps b Pinned c c c Mesh and c Problem subsection data Data The most elementary data structure in c oomph lib is c these values fall into two and those that must be determined as part of the solution c Data stores a value a double precision number the values of the unknowns are determined by the solution of a system of algebraic equations The solution of this system usually requires a(linear) numbering of the unknowns and associated equations. Hence</div></div>
<div class="ttc" id="aclassoomph_1_1Shape_html"><div class="ttname"><a href="classoomph_1_1Shape.html">oomph::Shape</a></div><div class="ttdef"><b>Definition:</b> <a href="shape_8h_source.html#l00077">shape.h:77</a></div></div>
<div class="ttc" id="acfortran_8h_html_ab7123126e4885ef647dd9c6e3807a21c"><div class="ttname"><a href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a></div><div class="ttdeci">static char t char * s</div><div class="ttdef"><b>Definition:</b> <a href="cfortran_8h_source.html#l00568">cfortran.h:568</a></div></div>
<div class="ttc" id="aporoelasticity__elements_8h_html"><div class="ttname"><a href="poroelasticity__elements_8h.html">poroelasticity_elements.h</a></div></div>

    <!-- jQuery for Bootstrap and Doxygen -->
    <script src="../../js/jquery-1.12.0.min.js"></script>
    <!-- Minified boostrap plugins-->
    <script src="../../js/bootstrap.js"></script>
    <!-- Doxygen dependency to add powertips to source code-->
    <script src="../../js/jquery.powertip.min.js"></script>
    <!-- The  following script is generated by doxygen and hides/shows levels in 
         the data structure lists and adds powertips to source code-->
    <script src="../../js/dynsections.js" ></script>
    <!-- add to Doxygen's class names so bootstrap css and js recognises them-->
    <script type="text/javascript">
    $(".contents").addClass("container");
    $(".header").addClass("container");
    $(".navpath").addClass("container");
    $("#navrow3").addClass("container");
    $("#navrow4").addClass("container");
    $(".mlabel").addClass("label");
    $(".mlabel").addClass("label-default");
    $(".memitem").addClass("panel");
    $(".memitem").addClass("panel-info");
    $(".memproto").addClass("panel-heading");
    $(".memdoc").addClass("panel-body");
    </script>
    <footer>
      <div class="container">
        <div class="text-muted" style="float:right;">Generated by <a href="http://www.doxygen.org/index.html">
          <img style="height:18px;" class="footer-img" src="doxygen.png" alt="doxygen"></a> on Wed Jul 21 2021 19:03:44
        </div>
      </div>
    </footer>
</body>
</html>

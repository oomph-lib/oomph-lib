<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
<title>oomph-lib: Subparametric_Telements.h Source File</title>
<link rel="apple-touch-icon" sizes="57x57" href="../../figures/apple-touch-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="../../figures/apple-touch-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="../../figures/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="../../figures/apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="../../figures/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="../../figures/apple-touch-icon-120x120.png">
<link rel="icon" type="image/png" href="../../figures/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="../../figures/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="../../figures/favicon-16x16.png" sizes="16x16">
<link rel="manifest" href="../../figures/manifest.json">
<link rel="mask-icon" href="../../figures/safari-pinned-tab.svg" color="#008000">
<link rel="shortcut icon" href="../../figures/favicon.ico">
<meta name="msapplication-TileColor" content="#00a300">
<meta name="msapplication-config" content="../../figures/browserconfig.xml">
<meta name="theme-color" content="#008000">
<link href="http://fonts.googleapis.com/css?family=Open+Sans:400,300,600" rel="stylesheet" type="text/css">
<!-- Doxygen css-->
<!-- <link rel="stylesheet" type="text/css" href="doxygen.css"> -->
<!-- Bootstrap -->
<link href="../../css/bootstrap.css" rel="stylesheet">
<!-- oomph-lib specific overrides -->
<link rel="stylesheet" type="text/css" href="../../css/oomph_header.css">
</head>
<body>
<nav class="navbar navbar-default">
<div class="container">
<div class="container-fluid">
  <!-- Brand and toggle get grouped for better mobile display -->
  <div class="navbar-header">
    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
      <span class="sr-only">Toggle navigation</span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="../../html/index.html"><img alt="oomph-lib" src="../../figures/oomph_logo.png"></a>
  </div>
  <!-- Collect the nav links, forms, and other content for toggling -->
  <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
    <ul class="nav navbar-nav">          
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Documentation <span class="caret"></span></a>
        <ul class="dropdown-menu">
          <li class="dropdown-header">Big picture</li>
          <li><a href="../../../doc/intro/html/index.html">The finite element method</a></li>
          <li><a href="../../../doc/the_data_structure/html/index.html">The data structure</a></li>
          <li><a href="../../../doc/quick_guide/html/index.html">Not-so-quick guide</a></li>
          <li><a href="../../../doc/optimisation/html/index.html">Optimisation</a></li>
          <li><a href="../../../doc/order_of_action_functions/html/index.html">Order of action functions</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Example codes and tutorials</li>
          <li><a href="../../../doc/example_code_list/html/index.html">List of example codes and tutorials</a></li>
          <li><a href="../../../doc/example_code_list/html/index.html#meshes">Meshing</a></li>
          <li><a href="../../../doc/example_code_list/html/index.html#solvers">Solvers</a></li>
          <li><a href="../../../doc/example_code_list/html/index.html#parallel">MPI parallel processing</a></li>
          <li><a href="../../../doc/example_code_list/html/index.html#visualisation">Post-processing/visualisation</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Other</li>
          <li><a href="../../../doc/change_log/html/index.html">Change log</a></li>
          <li><a href="../../../doc/creating_doc/html/index.html">Creating documentation</a></li>
          <li><a href="../../../doc/coding_conventions/html/index.html">Coding conventions</a></li>
          <li><a href="../../../doc/index/html/index.html">Index</a></li>
          <li><a href="../../../doc/FAQ/html/index.html">FAQ</a></li>
        </ul>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Get it <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../doc/the_distribution/html/index.html">Installation guide</a></li>
            <li><a href="../../../doc/subversion/html/index.html">Get code from subversion repository</a></li>
            <li><a href="../../../doc/download/html/index.html">Get code as tar file</a></li>
            <li><a href="../../../doc/copyright/html/index.html">Copyright</a></li>
          </ul>
        </li>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">About <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../doc/people/html/index.html">People</a></li>            
            <li><a href="../../../doc/contact/html/index.html">Contact/Get involved</a></li>
            <li><a href="../../../doc/publications/html/index.html">Publications</a></li>
            <li><a href="../../../doc/acknowledgements/html/index.html">Acknowledgements</a></li>
            <li><a href="../../../doc/picture_show/index.html">Picture show</a></li>
          </ul>
        </li>
      </li>
    </ul>
    <ul class="nav navbar-nav navbar-right navbar-search">
      <form class="navbar-form" role="search" action="../../../doc/search_results/html/index.html">
        <div class="input-group">
          <input type="text" class="form-control" placeholder="Search" name="q">
          <span class="input-group-btn">
            <button class="btn btn-default" type="submit">Go</button>
          </span>
        </div><!-- /input-group -->
       <!--<div class="form-group">
          <input type="text" class="form-control" placeholder="Search">
        </div>
        <button type="submit" class="btn btn-default">Submit</button>-->
      </form>
    </ul>
  </div><!-- /.navbar-collapse -->
</div><!-- /.container-fluid -->
</div>
</nav>
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_4075b182e53a3873a42d885f4e1e98c4.html">generic</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Subparametric_Telements.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="Subparametric__Telements_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">//LIC// ====================================================================</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">//LIC// This file forms part of oomph-lib, the object-oriented, </span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">//LIC// multi-physics finite-element library, available </span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">//LIC// at http://www.oomph-lib.org.</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">//LIC// Copyright (C) 2006-2021 Matthias Heil and Andrew Hazel</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">//LIC// This library is free software; you can redistribute it and/or</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">//LIC// modify it under the terms of the GNU Lesser General Public</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">//LIC// License as published by the Free Software Foundation; either</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">//LIC// version 2.1 of the License, or (at your option) any later version.</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">//LIC// This library is distributed in the hope that it will be useful,</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">//LIC// but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">//LIC// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">//LIC// Lesser General Public License for more details.</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">//LIC// You should have received a copy of the GNU Lesser General Public</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">//LIC// License along with this library; if not, write to the Free Software</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">//LIC// Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">//LIC// 02110-1301  USA.</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">//LIC// The authors may be contacted at oomph-lib@maths.man.ac.uk.</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">//LIC//====================================================================</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">//Header functions for classes that define Subparametric_Telements</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#ifndef OOMPH_SUBPARAMETRIC_TELEMENT_HEADER</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#define OOMPH_SUBPARAMETRIC_TELEMENT_HEADER</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160; </div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">// Config header generated by autoconfig</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#ifdef HAVE_CONFIG_H</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">  #include &lt;oomph-lib-config.h&gt;</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160; </div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#include &quot;mpi.h&quot;</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160; </div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment">//oomph-lib headers</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Vector_8h.html">Vector.h</a>&quot;</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="shape_8h.html">shape.h</a>&quot;</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="integral_8h.html">integral.h</a>&quot;</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="elements_8h.html">elements.h</a>&quot;</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Telements_8h.html">Telements.h</a>&quot;</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160; </div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespaceoomph.html">oomph</a></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;{</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment">///////////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment">///////////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment">///////////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment">/// BellElementShape</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment">///////////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment">///////////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment">//========================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="comment">/// A class for Bell triangular shape function with 3 vertex nodes and</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment">/// WITHOUT 3 middle-side node</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment"></span><span class="comment">//========================================================================</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="keyword">template</span>&lt;<span class="keywordtype">unsigned</span> DIM&gt;</div>
<div class="line"><a name="l00061"></a><span class="lineno"><a class="line" href="classoomph_1_1BellElementShape.html">   61</a></span>&#160; <span class="keyword">class </span><a class="code" href="classoomph_1_1BellElementShape.html">BellElementShape</a> { };</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160; </div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="keyword">template</span>&lt;&gt;</div>
<div class="line"><a name="l00064"></a><span class="lineno"><a class="line" href="classoomph_1_1BellElementShape_3_012_01_4.html">   64</a></span>&#160; <span class="keyword">class </span><a class="code" href="classoomph_1_1BellElementShape.html">BellElementShape</a>&lt;2&gt;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160; {</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;   <span class="keyword">public</span>:</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment">//=======================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment">/// Return local coordinates of node j</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="comment"></span><span class="comment">//=======================================================================</span></div>
<div class="line"><a name="l00070"></a><span class="lineno"><a class="line" href="classoomph_1_1BellElementShape_3_012_01_4.html#ad9b2789592d62d6d08c121d795921dd8">   70</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1BellElementShape_3_012_01_4.html#ad9b2789592d62d6d08c121d795921dd8">local_coordinate_of_node</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; j,</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;                                <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>)<span class="keyword"> const</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="keyword">   </span>{</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <span class="keywordflow">switch</span> (j)</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;     {</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;     <span class="keywordflow">case</span> 0:</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;      <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]=1.0;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;      <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]=0.0;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;      </div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;     <span class="keywordflow">case</span> 1:</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;      <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]=0.0;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;      <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]=1.0;</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;      </div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;     <span class="keywordflow">case</span> 2:</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;      <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]=0.0;</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;      <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]=0.0;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;      </div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;     <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;      std::ostringstream error_message;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;      error_message &lt;&lt; <span class="stringliteral">&quot;Element only has three nodes; called with node number &quot;</span> </div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;                    &lt;&lt; j &lt;&lt; std::endl;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;      </div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;      <span class="keywordflow">throw</span> <a class="code" href="classoomph_1_1OomphLibError.html">OomphLibError</a>(error_message.str(),</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;                          <span class="stringliteral">&quot;BellElement::local_coordinate_of_node()&quot;</span>,</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;                          OOMPH_EXCEPTION_LOCATION);</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;     }</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;   }</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;   </div>
<div class="line"><a name="l00101"></a><span class="lineno"><a class="line" href="classoomph_1_1BellElementShape_3_012_01_4.html#a9bdd842366843435658f1f4dea5b8121">  101</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1BellElementShape_3_012_01_4.html#a9bdd842366843435658f1f4dea5b8121">Bshape</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>, <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;psi, <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> &amp;<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>)<span class="keyword"> const</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="keyword">   </span>{</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <span class="comment">//---------------------------------------------</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <span class="comment">// the mapping to physical coordinates </span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <span class="comment">//----------------------------------------------</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> phi(2);</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    phi[0] = <a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(2,0) + (<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(0,0) - <a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(2,0))*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0] + (<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(1,0) - <a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(2,0))*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1];</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    phi[1] = <a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(2,1) + (<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(0,1) - <a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(2,1))*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0] + (<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(1,1) - <a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(2,1))*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1];</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    </div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <span class="keywordtype">double</span> A = ( (<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(1,0)*<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(2,1)-<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(2,0)*<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(1,1)) - (<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(0,0)*<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(2,1)-<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(2,0)*<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(0,1)) + (<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(0,0)*<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(1,1)-<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(1,0)*<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(0,1)))/2.0;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    <span class="keywordtype">double</span> A0 = ( (<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(1,0)*<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(2,1)-<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(2,0)*<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(1,1)) - (phi[0]*<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(2,1)-<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(2,0)*phi[1]) + (phi[0]*<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(1,1)-<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(1,0)*phi[1]))/2.0;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <span class="keywordtype">double</span> A1 = ( (phi[0]*<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(2,1)-<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(2,0)*phi[1]) - (<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(0,0)*<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(2,1)-<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(2,0)*<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(0,1)) + (<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(0,0)*phi[1]-phi[0]*<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(0,1)))/2.0;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    <span class="keywordtype">double</span> A2 = ( (<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(1,0)*phi[1]-phi[0]*<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(1,1)) - (<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(0,0)*phi[1]-phi[0]*<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(0,1)) + (<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(0,0)*<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(1,1)-<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(1,0)*<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(0,1)))/2.0;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    <span class="comment">// assigned area coordinates</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> xi(3);</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    xi[0] = A0/A;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    xi[1] = A1/A;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    xi[2] = A2/A;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160; </div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> b(3);</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> c(3);</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> lamb(3);</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> lamb_p(3);</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> pp(2);</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> <a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>(2),cc(2);</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    </div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <span class="comment">//compute for b and c</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    b[1] = <a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(0,0)-<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(2,0);</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    b[2] = <a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(1,0)-<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(0,0);</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    b[0] = <a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(2,0)-<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(1,0);</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160; </div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    c[1] = <a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(2,1)-<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(0,1);</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    c[2] = <a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(0,1)-<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(1,1);</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    c[0] = <a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(1,1)-<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(2,1);</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    </div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    <span class="comment">//compute for a point of perpendicular</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    <span class="comment">// on the edge opposite to node0 (top vertex)</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> v(2);</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    v[0] = (<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(2,0)-<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(1,0));</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    v[1] = (<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(2,1)-<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(1,1));</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    <span class="keywordtype">double</span> m = v[1]/v[0];</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    <a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>[0] = <a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(1,0);</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>[1] = <a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(1,1);</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    cc[0] = <a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(0,0);</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    cc[1] = <a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(0,1);</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <span class="keywordflow">if</span>(v[0]==0)</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;     {</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;      m = v[0]/v[1];</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;      pp[1] = ( v[0]*m*<a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>[1] + v[1]*cc[1] - v[0]*<a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>[0] + v[0]*cc[0] )/((v[0]*m)+v[1]);</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;      pp[0] = (pp[1]-<a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>[1])*m + <a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>[0];</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;     }</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;     {</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;      pp[0] = (v[1]*m*<a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>[0] + v[1]*cc[1] - v[1]*<a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>[1] + v[0]*cc[0])/(v[1]*m+v[0]);</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;      pp[1] = m*(pp[0]-<a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>[0]) + <a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>[1];</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;     }</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <span class="keywordtype">double</span> l = sqrt(v[0]*v[0] + v[1]*v[1]);</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <span class="keywordtype">double</span> l1 = sqrt( (pp[0]-<a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>[0])*(pp[0]-<a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>[0]) + (pp[1]-<a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>[1])*(pp[1]-<a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>[1]));</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    lamb_p[0] = l1/l;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    lamb[0] = 1-lamb_p[0];</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    </div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <span class="comment">// on the edge opposite to node1</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    v[0] = (<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(0,0)-<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(2,0));</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    v[1] = (<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(0,1)-<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(2,1));</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    m = v[1]/v[0];</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>[0] = <a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(2,0);</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>[1] = <a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(2,1);</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    cc[0] = <a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(1,0);</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    cc[1] = <a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(1,1);</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <span class="keywordflow">if</span>(v[0]==0)</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;     {</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;      m = v[0]/v[1];</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;      pp[1] = ( v[0]*m*<a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>[1] + v[1]*cc[1] - v[0]*<a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>[0] + v[0]*cc[0] )/((v[0]*m)+v[1]);</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;      pp[0] = (pp[1]-<a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>[1])*m + <a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>[0];</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;     }</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;     {</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;      pp[0] = (v[1]*m*<a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>[0] + v[1]*cc[1] - v[1]*<a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>[1] + v[0]*cc[0])/(v[1]*m+v[0]);</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;      pp[1] = m*(pp[0]-<a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>[0]) + <a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>[1];</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;     }</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    l = sqrt(v[0]*v[0] + v[1]*v[1]);</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    l1 = sqrt( (pp[0]-<a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>[0])*(pp[0]-<a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>[0]) + (pp[1]-<a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>[1])*(pp[1]-<a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>[1]));</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    lamb_p[1] = l1/l;</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    lamb[1] = 1-lamb_p[1];</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    </div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    <span class="comment">// on the edge opposite to node2 (right bottom)</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    v[0] = (<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(1,0)-<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(0,0));</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    v[1] = (<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(1,1)-<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(0,1));</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    m = v[1]/v[0];</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>[0] = <a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(0,0);</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    <a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>[1] = <a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(0,1);</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    cc[0] = <a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(2,0);</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    cc[1] = <a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(2,1);</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <span class="keywordflow">if</span>(v[0]==0)</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;     {</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;      m = v[0]/v[1];</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;      pp[1] = ( v[0]*m*<a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>[1] + v[1]*cc[1] - v[0]*<a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>[0] + v[0]*cc[0] )/((v[0]*m)+v[1]);</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;      pp[0] = (pp[1]-<a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>[1])*m + <a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>[0];</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;     }</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;     {</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;      pp[0] = (v[1]*m*<a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>[0] + v[1]*cc[1] - v[1]*<a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>[1] + v[0]*cc[0])/(v[1]*m+v[0]);</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;      pp[1] = m*(pp[0]-<a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>[0]) + <a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>[1];</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;     }</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    l = sqrt(v[0]*v[0] + v[1]*v[1]);</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    l1 = sqrt( (pp[0]-<a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>[0])*(pp[0]-<a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>[0]) + (pp[1]-<a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>[1])*(pp[1]-<a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>[1]));</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    lamb_p[2] = l1/l;</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    lamb[2] = 1-lamb_p[2];</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160; </div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    <span class="comment">// define shape functions that associated to dofs at node 0</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    psi(0,0) = xi[0]*xi[0]*xi[0]*xi[0]*xi[0] +5.0*xi[0]*xi[0]*xi[0]*xi[0]*(xi[1]+xi[2]) + 10.0*xi[0]*xi[0]*xi[0]*(xi[1]+xi[2])*(xi[1]+xi[2])</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;     +30.0*xi[0]*xi[0]*xi[1]*xi[2]*(lamb[2]*xi[1] + lamb_p[1]*xi[2]);</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    psi(0,1) = 3.0*b[0]*xi[0]*xi[0]*xi[1]*xi[2]*(xi[1]-xi[2]) +  xi[0]*xi[0]*xi[0]*(b[2]*xi[1] -b[1]*xi[2])*(xi[0] + 4.0*xi[1] + 4*xi[2])</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;     + 15*xi[0]*xi[0]*xi[1]*xi[2]*(b[2]*lamb[2]*xi[1] - b[1]*lamb_p[1]*xi[2]);</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    psi(0,2) =  -3.0*c[0]*xi[0]*xi[0]*xi[1]*xi[2]*(xi[1]-xi[2]) - xi[0]*xi[0]*xi[0]*(c[2]*xi[1] - c[1]*xi[2])*(xi[0] + 4.0*xi[1] + 4.0*xi[2])</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;     -15.0*xi[0]*xi[0]*xi[1]*xi[2]*(c[2]*lamb[2]*xi[1] -c[1]*lamb_p[1]*xi[2]);</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    psi(0,3) = 1.0/2.0*xi[0]*xi[0]*xi[0]*(b[2]*b[2]*xi[1]*xi[1] + b[1]*b[1]*xi[2]*xi[2]) + xi[0]*xi[0]*xi[1]*xi[2]*(-b[1]*b[2]*xi[0] + b[2]*b[0]*xi[1] + b[0]*b[1]*xi[2])</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;     + 5.0/2.0*xi[0]*xi[0]*xi[1]*xi[2]*(b[2]*b[2]*lamb[2]*xi[1] + b[1]*b[1]*lamb_p[1]*xi[2]);</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    psi(0,4) = 1.0/2.0*xi[0]*xi[0]*xi[0]*(c[2]*c[2]*xi[1]*xi[1] + c[1]*c[1]*xi[2]*xi[2]) + xi[0]*xi[0]*xi[1]*xi[2]*(-c[1]*c[2]*xi[0] + c[2]*c[0]*xi[1] + c[0]*c[1]*xi[2])</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;     + 5.0/2.0*xi[0]*xi[0]*xi[1]*xi[2]*(c[2]*c[2]*lamb[2]*xi[1] + c[1]*c[1]*lamb_p[1]*xi[2]);</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    psi(0,5) = b[0]*c[0]*xi[0]*xi[0]*xi[1]*xi[2]*(xi[0] + xi[1] + xi[2]) + b[1]*c[1]*xi[0]*xi[0]*xi[2]*(xi[1]*xi[2] - xi[2]*xi[0] - xi[0]*xi[1] - xi[1]*xi[1])</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;     + b[2]*c[2]*xi[0]*xi[0]*xi[1]*(xi[1]*xi[2] - xi[2]*xi[0] -xi[0]*xi[1] - xi[2]*xi[2]) - 5.0*xi[0]*xi[0]*xi[1]*xi[2]*(b[1]*c[1]*lamb_p[1]*xi[2] + b[2]*c[2]*lamb[2]*xi[1]);</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160; </div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <span class="comment">// define shape functions that associated to dofs at node 1</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    psi(1,0) = xi[1]*xi[1]*xi[1]*xi[1]*xi[1] +5.0*xi[1]*xi[1]*xi[1]*xi[1]*(xi[2]+xi[0]) + 10.0*xi[1]*xi[1]*xi[1]*(xi[2]+xi[0])*(xi[2]+xi[0])</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;     +30.0*xi[1]*xi[1]*xi[2]*xi[0]*(lamb[0]*xi[2] + lamb_p[2]*xi[0]);</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    psi(1,1) = 3.0*b[1]*xi[1]*xi[1]*xi[2]*xi[0]*(xi[2]-xi[0]) +  xi[1]*xi[1]*xi[1]*(b[0]*xi[2] -b[2]*xi[0])*(xi[1] + 4.0*xi[2] + 4*xi[0])</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;     + 15*xi[1]*xi[1]*xi[2]*xi[0]*(b[0]*lamb[0]*xi[2] - b[2]*lamb_p[2]*xi[0]);</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    psi(1,2) =  -3.0*c[1]*xi[1]*xi[1]*xi[2]*xi[0]*(xi[2]-xi[0]) - xi[1]*xi[1]*xi[1]*(c[0]*xi[2] - c[2]*xi[0])*(xi[1] + 4.0*xi[2] + 4.0*xi[0])</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;     -15.0*xi[1]*xi[1]*xi[2]*xi[0]*(c[0]*lamb[0]*xi[2] -c[2]*lamb_p[2]*xi[0]);</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    psi(1,3) = 1.0/2.0*xi[1]*xi[1]*xi[1]*(b[0]*b[0]*xi[2]*xi[2] + b[2]*b[2]*xi[0]*xi[0]) + xi[1]*xi[1]*xi[2]*xi[0]*(-b[2]*b[0]*xi[1] + b[0]*b[1]*xi[2] + b[1]*b[2]*xi[0])</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;     + 5.0/2.0*xi[1]*xi[1]*xi[2]*xi[0]*(b[0]*b[0]*lamb[0]*xi[2] + b[2]*b[2]*lamb_p[2]*xi[0]);</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    psi(1,4) = 1.0/2.0*xi[1]*xi[1]*xi[1]*(c[0]*c[0]*xi[2]*xi[2] + c[2]*c[2]*xi[0]*xi[0]) + xi[1]*xi[1]*xi[2]*xi[0]*(-c[2]*c[0]*xi[1] + c[0]*c[1]*xi[2] + c[1]*c[2]*xi[0])</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;     + 5.0/2.0*xi[1]*xi[1]*xi[2]*xi[0]*(c[0]*c[0]*lamb[0]*xi[2] + c[2]*c[2]*lamb_p[2]*xi[0]);</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    psi(1,5) = b[1]*c[1]*xi[1]*xi[1]*xi[2]*xi[0]*(xi[1] + xi[2] + xi[0]) + b[2]*c[2]*xi[1]*xi[1]*xi[0]*(xi[2]*xi[0] - xi[0]*xi[1] - xi[1]*xi[2] - xi[2]*xi[2])</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;     + b[0]*c[0]*xi[1]*xi[1]*xi[2]*(xi[2]*xi[0] - xi[0]*xi[1] -xi[1]*xi[2] - xi[0]*xi[0]) - 5.0*xi[1]*xi[1]*xi[2]*xi[0]*(b[2]*c[2]*lamb_p[2]*xi[0] + b[0]*c[0]*lamb[0]*xi[2]);</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160; </div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    <span class="comment">// define shape functions that associated to dofs at node 2</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    psi(2,0) = xi[2]*xi[2]*xi[2]*xi[2]*xi[2] +5.0*xi[2]*xi[2]*xi[2]*xi[2]*(xi[0]+xi[1]) + 10.0*xi[2]*xi[2]*xi[2]*(xi[0]+xi[1])*(xi[0]+xi[1])</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;     +30.0*xi[2]*xi[2]*xi[0]*xi[1]*(lamb[1]*xi[0] + lamb_p[0]*xi[1]);</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    psi(2,1) = 3.0*b[2]*xi[2]*xi[2]*xi[0]*xi[1]*(xi[0]-xi[1]) +  xi[2]*xi[2]*xi[2]*(b[1]*xi[0] -b[0]*xi[1])*(xi[2] + 4.0*xi[0] + 4*xi[1])</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;     + 15*xi[2]*xi[2]*xi[0]*xi[1]*(b[1]*lamb[1]*xi[0] - b[0]*lamb_p[0]*xi[1]);</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    psi(2,2) =  -3.0*c[2]*xi[2]*xi[2]*xi[0]*xi[1]*(xi[0]-xi[1]) - xi[2]*xi[2]*xi[2]*(c[1]*xi[0] - c[0]*xi[1])*(xi[2] + 4.0*xi[0] + 4.0*xi[1])</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;     -15.0*xi[2]*xi[2]*xi[0]*xi[1]*(c[1]*lamb[1]*xi[0] -c[0]*lamb_p[0]*xi[1]);</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    psi(2,3) = 1.0/2.0*xi[2]*xi[2]*xi[2]*(b[1]*b[1]*xi[0]*xi[0] + b[0]*b[0]*xi[1]*xi[1]) + xi[2]*xi[2]*xi[0]*xi[1]*(-b[0]*b[1]*xi[2] + b[1]*b[2]*xi[0] + b[2]*b[0]*xi[1])</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;     + 5.0/2.0*xi[2]*xi[2]*xi[0]*xi[1]*(b[1]*b[1]*lamb[1]*xi[0] + b[0]*b[0]*lamb_p[0]*xi[1]);</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    psi(2,4) = 1.0/2.0*xi[2]*xi[2]*xi[2]*(c[1]*c[1]*xi[0]*xi[0] + c[0]*c[0]*xi[1]*xi[1]) + xi[2]*xi[2]*xi[0]*xi[1]*(-c[0]*c[1]*xi[2] + c[1]*c[2]*xi[0] + c[2]*c[0]*xi[1])</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;     + 5.0/2.0*xi[2]*xi[2]*xi[0]*xi[1]*(c[1]*c[1]*lamb[1]*xi[0] + c[0]*c[0]*lamb_p[0]*xi[1]);</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    psi(2,5) = b[2]*c[2]*xi[2]*xi[2]*xi[0]*xi[1]*(xi[2] + xi[0] + xi[1]) + b[0]*c[0]*xi[2]*xi[2]*xi[1]*(xi[0]*xi[1] - xi[1]*xi[2] - xi[2]*xi[0] - xi[0]*xi[0])</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;     + b[1]*c[1]*xi[2]*xi[2]*xi[0]*(xi[0]*xi[1] - xi[1]*xi[2] -xi[2]*xi[0] - xi[1]*xi[1]) - 5.0*xi[2]*xi[2]*xi[0]*xi[1]*(b[0]*c[0]*lamb_p[0]*xi[1] + b[1]*c[1]*lamb[1]*xi[0]);</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;   </div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;   }</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160; </div>
<div class="line"><a name="l00254"></a><span class="lineno"><a class="line" href="classoomph_1_1BellElementShape_3_012_01_4.html#abca489dcf440f32fc0b2c17577d65440">  254</a></span>&#160;   <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1BellElementShape_3_012_01_4.html#abca489dcf440f32fc0b2c17577d65440">dBshape_local</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>, <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;psi, <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;dpsids, <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> &amp;<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>)<span class="keyword"> const</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;<span class="keyword">   </span>{</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    <span class="comment">// assign for shape functions</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    Bshape(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,psi,<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>);</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    <span class="comment">//---------------------------------------------</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    <span class="comment">// the mapping to physical coordinates </span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    <span class="comment">//----------------------------------------------</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> phi(2);</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    phi[0] = <a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(2,0) + (<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(0,0) - <a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(2,0))*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0] + (<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(1,0) - <a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(2,0))*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1];</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    phi[1] = <a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(2,1) + (<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(0,1) - <a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(2,1))*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0] + (<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(1,1) - <a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(2,1))*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1];</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    </div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    <span class="keywordtype">double</span> A = ( (<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(1,0)*<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(2,1)-<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(2,0)*<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(1,1)) - (<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(0,0)*<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(2,1)-<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(2,0)*<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(0,1)) + (<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(0,0)*<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(1,1)-<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(1,0)*<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(0,1)))/2.0;</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    <span class="keywordtype">double</span> A0, A1, A2;</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    A0 = ( (<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(1,0)*<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(2,1)-<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(2,0)*<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(1,1)) - (phi[0]*<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(2,1)-<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(2,0)*phi[1]) + (phi[0]*<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(1,1)-<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(1,0)*phi[1]))/2.0;</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    A1 = ( (phi[0]*<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(2,1)-<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(2,0)*phi[1]) - (<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(0,0)*<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(2,1)-<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(2,0)*<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(0,1)) + (<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(0,0)*phi[1]-phi[0]*<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(0,1)))/2.0;</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    A2 = ( (<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(1,0)*phi[1]-phi[0]*<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(1,1)) - (<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(0,0)*phi[1]-phi[0]*<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(0,1)) + (<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(0,0)*<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(1,1)-<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(1,0)*<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(0,1)))/2.0;</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    </div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    <span class="comment">// assigned area coordinates</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> xi(3);</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    xi[0] = A0/A;</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    xi[1] = A1/A;</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    xi[2] = A2/A;</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160; </div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> b(3);</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> c(3);</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> lamb(3);</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> lamb_p(3);</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> pp(2);</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> <a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>(2),cc(2);</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    </div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    <span class="comment">//compute for b and c</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    b[1] = <a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(0,0)-<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(2,0);</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    b[2] = <a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(1,0)-<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(0,0);</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    b[0] = <a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(2,0)-<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(1,0);</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160; </div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    c[1] = <a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(2,1)-<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(0,1);</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    c[2] = <a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(0,1)-<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(1,1);</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    c[0] = <a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(1,1)-<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(2,1);</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    </div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    <span class="comment">//compute for a point of perpendicular</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    <span class="comment">// on the edge opposite to node0 (top vertex)</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> v(2);</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    v[0] = (<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(2,0)-<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(1,0));</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    v[1] = (<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(2,1)-<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(1,1));</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    <span class="keywordtype">double</span> m = v[1]/v[0];</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    <a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>[0] = <a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(1,0);</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    <a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>[1] = <a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(1,1);</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    cc[0] = <a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(0,0);</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    cc[1] = <a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(0,1);</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    <span class="keywordflow">if</span>(v[0]==0)</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;     {</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;      m = v[0]/v[1];</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;      pp[1] = ( v[0]*m*<a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>[1] + v[1]*cc[1] - v[0]*<a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>[0] + v[0]*cc[0] )/((v[0]*m)+v[1]);</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;      pp[0] = (pp[1]-<a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>[1])*m + <a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>[0];</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;     }</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;     {</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;      pp[0] = (v[1]*m*<a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>[0] + v[1]*cc[1] - v[1]*<a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>[1] + v[0]*cc[0])/(v[1]*m+v[0]);</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;      pp[1] = m*(pp[0]-<a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>[0]) + <a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>[1];</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;     }</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    <span class="keywordtype">double</span> l = sqrt(v[0]*v[0] + v[1]*v[1]);</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    <span class="keywordtype">double</span> l1 = sqrt( (pp[0]-<a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>[0])*(pp[0]-<a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>[0]) + (pp[1]-<a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>[1])*(pp[1]-<a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>[1]));</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    lamb_p[0] = l1/l;</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    lamb[0] = 1-lamb_p[0];</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    </div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    <span class="comment">// on the edge opposite to node1</span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    v[0] = (<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(0,0)-<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(2,0));</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    v[1] = (<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(0,1)-<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(2,1));</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    m = v[1]/v[0];</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    <a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>[0] = <a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(2,0);</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    <a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>[1] = <a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(2,1);</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    cc[0] = <a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(1,0);</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    cc[1] = <a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(1,1);</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    <span class="keywordflow">if</span>(v[0]==0)</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;     {</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;      m = v[0]/v[1];</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;      pp[1] = ( v[0]*m*<a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>[1] + v[1]*cc[1] - v[0]*<a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>[0] + v[0]*cc[0] )/((v[0]*m)+v[1]);</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;      pp[0] = (pp[1]-<a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>[1])*m + <a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>[0];</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;     }</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;     {</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;      pp[0] = (v[1]*m*<a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>[0] + v[1]*cc[1] - v[1]*<a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>[1] + v[0]*cc[0])/(v[1]*m+v[0]);</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;      pp[1] = m*(pp[0]-<a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>[0]) + <a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>[1];</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;     }</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    l = sqrt(v[0]*v[0] + v[1]*v[1]);</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    l1 = sqrt( (pp[0]-<a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>[0])*(pp[0]-<a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>[0]) + (pp[1]-<a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>[1])*(pp[1]-<a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>[1]));</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    lamb_p[1] = l1/l;</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    lamb[1] = 1-lamb_p[1];</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    </div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    <span class="comment">// on the edge opposite to node2 (right bottom)</span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    v[0] = (<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(1,0)-<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(0,0));</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    v[1] = (<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(1,1)-<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(0,1));</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    m = v[1]/v[0];</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    <a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>[0] = <a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(0,0);</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    <a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>[1] = <a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(0,1);</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    cc[0] = <a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(2,0);</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    cc[1] = <a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(2,1);</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    <span class="keywordflow">if</span>(v[0]==0)</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;     {</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;      m = v[0]/v[1];</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;      pp[1] = ( v[0]*m*<a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>[1] + v[1]*cc[1] - v[0]*<a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>[0] + v[0]*cc[0] )/((v[0]*m)+v[1]);</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;      pp[0] = (pp[1]-<a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>[1])*m + <a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>[0];</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;     }</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;     {</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;      pp[0] = (v[1]*m*<a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>[0] + v[1]*cc[1] - v[1]*<a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>[1] + v[0]*cc[0])/(v[1]*m+v[0]);</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;      pp[1] = m*(pp[0]-<a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>[0]) + <a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>[1];</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;     }</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    l = sqrt(v[0]*v[0] + v[1]*v[1]);</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    l1 = sqrt( (pp[0]-<a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>[0])*(pp[0]-<a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>[0]) + (pp[1]-<a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>[1])*(pp[1]-<a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>[1]));</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    lamb_p[2] = l1/l;</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    lamb[2] = 1-lamb_p[2];</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    </div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;   </div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> dxids0(3,0.0);</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> dxids1(3,0.0);</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;     </div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    dxids0[0] = c[0]/A/2.0;</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    dxids0[1] = c[1]/A/2.0;</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    dxids0[2] = c[2]/A/2.0;</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    </div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    dxids1[0] = b[0]/A/2.0;</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    dxids1[1] = b[1]/A/2.0;</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    dxids1[2] = b[2]/A/2.0;</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    </div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    <a class="code" href="classoomph_1_1DShape.html">DShape</a> psi1(3,6,3);</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    <span class="comment">// define dshape functions that associated to dofs at node 0</span></div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    psi1(0,0,0) = 5.0*xi[0]*xi[0]*xi[0]*xi[0] + 5.0*4.0*xi[0]*xi[0]*xi[0]*(xi[1]+xi[2]) + 10.0*3.0*xi[0]*xi[0]*(xi[1]+xi[2])*(xi[1]+xi[2])</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;     +30.0*2.0*xi[0]*xi[1]*xi[2]*(lamb[2]*xi[1] + lamb_p[1]*xi[2]);</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    psi1(0,1,0) = 3.0*b[0]*2.0*xi[0]*xi[1]*xi[2]*(xi[1]-xi[2]) +  3.0*xi[0]*xi[0]*(b[2]*xi[1] -b[1]*xi[2])*(xi[0] + 4.0*xi[1] + 4.0*xi[2]) </div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;     + xi[0]*xi[0]*xi[0]*(b[2]*xi[1] -b[1]*xi[2]) + 15*2.0*xi[0]*xi[1]*xi[2]*(b[2]*lamb[2]*xi[1] - b[1]*lamb_p[1]*xi[2]);</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    psi1(0,2,0) = -3.0*c[0]*2.0*xi[0]*xi[1]*xi[2]*(xi[1]-xi[2]) - 3.0*xi[0]*xi[0]*(c[2]*xi[1] - c[1]*xi[2])*(xi[0] + 4.0*xi[1] + 4.0*xi[2]) - xi[0]*xi[0]*xi[0]*(c[2]*xi[1] - c[1]*xi[2]) </div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;     -15.0*2.0*xi[0]*xi[1]*xi[2]*(c[2]*lamb[2]*xi[1] -c[1]*lamb_p[1]*xi[2]);</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    psi1(0,3,0) = 1.0/2.0*3.0*xi[0]*xi[0]*(b[2]*b[2]*xi[1]*xi[1] + b[1]*b[1]*xi[2]*xi[2]) + 2.0*xi[0]*xi[1]*xi[2]*(-b[1]*b[2]*xi[0] + b[2]*b[0]*xi[1] + b[0]*b[1]*xi[2])</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;     + 5.0/2.0*2.0*xi[0]*xi[1]*xi[2]*(b[2]*b[2]*lamb[2]*xi[1] + b[1]*b[1]*lamb_p[1]*xi[2]) + xi[0]*xi[0]*xi[1]*xi[2]*(-b[1]*b[2]);</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    psi1(0,4,0) = 1.0/2.0*3.0*xi[0]*xi[0]*(c[2]*c[2]*xi[1]*xi[1] + c[1]*c[1]*xi[2]*xi[2]) + 2.0*xi[0]*xi[1]*xi[2]*(-c[1]*c[2]*xi[0] + c[2]*c[0]*xi[1] + c[0]*c[1]*xi[2])</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;     + 5.0/2.0*2.0*xi[0]*xi[1]*xi[2]*(c[2]*c[2]*lamb[2]*xi[1] + c[1]*c[1]*lamb_p[1]*xi[2])+ xi[0]*xi[0]*xi[1]*xi[2]*(-c[1]*c[2]);</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    psi1(0,5,0) = b[0]*c[0]*2.0*xi[0]*xi[1]*xi[2]*(xi[0] + xi[1] + xi[2]) + b[0]*c[0]*xi[0]*xi[0]*xi[1]*xi[2] + b[1]*c[1]*2.0*xi[0]*xi[2]*(xi[1]*xi[2] - xi[2]*xi[0] - xi[0]*xi[1] - xi[1]*xi[1]) </div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;     + b[1]*c[1]*xi[0]*xi[0]*xi[2]*(-xi[1] - xi[2]) + b[2]*c[2]*2.0*xi[0]*xi[1]*(xi[1]*xi[2] - xi[2]*xi[0] -xi[0]*xi[1] - xi[2]*xi[2]) </div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;     + b[2]*c[2]*xi[0]*xi[0]*xi[1]*(-xi[2]-xi[1]) - 5.0*2.0*xi[0]*xi[1]*xi[2]*(b[1]*c[1]*lamb_p[1]*xi[2] + b[2]*c[2]*lamb[2]*xi[1]);</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    </div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    psi1(0,0,1) = 5.0*xi[0]*xi[0]*xi[0]*xi[0] + 10.0*xi[0]*xi[0]*xi[0]*2.0*(xi[1]+xi[2])</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;     +30.0*xi[0]*xi[0]*xi[2]*(lamb[2]*xi[1] + lamb_p[1]*xi[2])+30.0*xi[0]*xi[0]*xi[1]*xi[2]*(lamb[2]);</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    psi1(0,1,1) = 3.0*b[0]*xi[0]*xi[0]*xi[2]*(xi[1]-xi[2])+ 3.0*b[0]*xi[0]*xi[0]*xi[1]*xi[2] + xi[0]*xi[0]*xi[0]*(b[2])*(xi[0] + 4.0*xi[1] + 4*xi[2])</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;     + xi[0]*xi[0]*xi[0]*(b[2]*xi[1] -b[1]*xi[2])*(4.0) + 15*xi[0]*xi[0]*xi[2]*(b[2]*lamb[2]*xi[1] - b[1]*lamb_p[1]*xi[2]) +15*xi[0]*xi[0]*xi[1]*xi[2]*(b[2]*lamb[2]);</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    psi1(0,2,1) = -3.0*c[0]*xi[0]*xi[0]*xi[2]*(xi[1]-xi[2]) - 3.0*c[0]*xi[0]*xi[0]*xi[1]*xi[2] - xi[0]*xi[0]*xi[0]*(c[2]*xi[1] - c[1]*xi[2])*(4.0) - xi[0]*xi[0]*xi[0]*(c[2])*(xi[0] + 4.0*xi[1] + 4.0*xi[2]) -15.0*xi[0]*xi[0]*xi[1]*xi[2]*(c[2]*lamb[2])</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;     -15.0*xi[0]*xi[0]*xi[2]*(c[2]*lamb[2]*xi[1] -c[1]*lamb_p[1]*xi[2]);</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    psi1(0,3,1) = 1.0/2.0*xi[0]*xi[0]*xi[0]*(b[2]*b[2]*2.0*xi[1]) + xi[0]*xi[0]*xi[1]*xi[2]*(b[2]*b[0]) + xi[0]*xi[0]*xi[2]*(-b[1]*b[2]*xi[0] + b[2]*b[0]*xi[1] + b[0]*b[1]*xi[2])  + 5.0/2.0*xi[0]*xi[0]*xi[1]*xi[2]*(b[2]*b[2]*lamb[2]) + 5.0/2.0*xi[0]*xi[0]*xi[2]*(b[2]*b[2]*lamb[2]*xi[1] + b[1]*b[1]*lamb_p[1]*xi[2]);</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    psi1(0,4,1) = 1.0/2.0*xi[0]*xi[0]*xi[0]*(c[2]*c[2]*2.0*xi[1]) + xi[0]*xi[0]*xi[1]*xi[2]*(c[2]*c[0]) + xi[0]*xi[0]*xi[2]*(-c[1]*c[2]*xi[0] + c[2]*c[0]*xi[1] + c[0]*c[1]*xi[2])+ 5.0/2.0*xi[0]*xi[0]*xi[1]*xi[2]*(c[2]*c[2]*lamb[2])  + 5.0/2.0*xi[0]*xi[0]*xi[2]*(c[2]*c[2]*lamb[2]*xi[1] + c[1]*c[1]*lamb_p[1]*xi[2]);</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    psi1(0,5,1) = b[0]*c[0]*xi[0]*xi[0]*xi[1]*xi[2] + b[0]*c[0]*xi[0]*xi[0]*xi[2]*(xi[0] + xi[1] + xi[2]) + b[1]*c[1]*xi[0]*xi[0]*xi[2]*(xi[2] - xi[0] - 2.0*xi[1])</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;     + b[2]*c[2]*xi[0]*xi[0]*(xi[1]*xi[2] - xi[2]*xi[0] -xi[0]*xi[1] - xi[2]*xi[2]) + b[2]*c[2]*xi[0]*xi[0]*xi[1]*(xi[2]-xi[0]) - 5.0*xi[0]*xi[0]*xi[2]*(b[1]*c[1]*lamb_p[1]*xi[2] + b[2]*c[2]*lamb[2]*xi[1])</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;     - 5.0*xi[0]*xi[0]*xi[1]*xi[2]*(b[2]*c[2]*lamb[2]);</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160; </div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    psi1(0,0,2) = 5.0*xi[0]*xi[0]*xi[0]*xi[0] + 10.0*xi[0]*xi[0]*xi[0]*2.0*(xi[1]+xi[2])</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;     +30.0*xi[0]*xi[0]*xi[1]*xi[2]*(lamb_p[1])  +30.0*xi[0]*xi[0]*xi[1]*(lamb[2]*xi[1] + lamb_p[1]*xi[2]);</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    psi1(0,1,2) = 3.0*b[0]*xi[0]*xi[0]*xi[1]*xi[2]*(-1.0) + 3.0*b[0]*xi[0]*xi[0]*xi[1]*(xi[1]-xi[2]) +  xi[0]*xi[0]*xi[0]*(b[2]*xi[1] -b[1]*xi[2])*( 4.0)+  xi[0]*xi[0]*xi[0]*(-b[1])*(xi[0] + 4.0*xi[1] + 4*xi[2]) + 15*xi[0]*xi[0]*xi[1]*xi[2]*(- b[1]*lamb_p[1])</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;     + 15*xi[0]*xi[0]*xi[1]*(b[2]*lamb[2]*xi[1] - b[1]*lamb_p[1]*xi[2]);</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    psi1(0,2,2) =  -3.0*c[0]*xi[0]*xi[0]*xi[1]*xi[2]*(-1.0) +  -3.0*c[0]*xi[0]*xi[0]*xi[1]*(xi[1]-xi[2]) - xi[0]*xi[0]*xi[0]*(c[2]*xi[1] - c[1]*xi[2])*( 4.0) - xi[0]*xi[0]*xi[0]*(-1.0*c[1])*(xi[0] + 4.0*xi[1] + 4.0*xi[2]) -15.0*xi[0]*xi[0]*xi[1]*xi[2]*( -1.0*c[1]*lamb_p[1]) -15.0*xi[0]*xi[0]*xi[1]*(c[2]*lamb[2]*xi[1] -c[1]*lamb_p[1]*xi[2]);</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    psi1(0,3,2) = 1.0/2.0*xi[0]*xi[0]*xi[0]*(b[1]*b[1]*2.0*xi[2]) + xi[0]*xi[0]*xi[1]*xi[2]*( b[0]*b[1]) + xi[0]*xi[0]*xi[1]*(-b[1]*b[2]*xi[0] + b[2]*b[0]*xi[1] + b[0]*b[1]*xi[2]) + 5.0/2.0*xi[0]*xi[0]*xi[1]*xi[2]*( b[1]*b[1]*lamb_p[1])+ 5.0/2.0*xi[0]*xi[0]*xi[1]*(b[2]*b[2]*lamb[2]*xi[1] + b[1]*b[1]*lamb_p[1]*xi[2]);</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    psi1(0,4,2) = 1.0/2.0*xi[0]*xi[0]*xi[0]*(c[1]*c[1]*2.0*xi[2]) + xi[0]*xi[0]*xi[1]*xi[2]*(c[0]*c[1]) + xi[0]*xi[0]*xi[1]*(-c[1]*c[2]*xi[0] + c[2]*c[0]*xi[1] + c[0]*c[1]*xi[2])  + 5.0/2.0*xi[0]*xi[0]*xi[1]*xi[2]*(c[1]*c[1]*lamb_p[1]) + 5.0/2.0*xi[0]*xi[0]*xi[1]*(c[2]*c[2]*lamb[2]*xi[1] + c[1]*c[1]*lamb_p[1]*xi[2]);</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    psi1(0,5,2) = b[0]*c[0]*xi[0]*xi[0]*xi[1]*xi[2] + b[0]*c[0]*xi[0]*xi[0]*xi[1]*(xi[0] + xi[1] + xi[2]) + b[1]*c[1]*xi[0]*xi[0]*xi[2]*(xi[1] - xi[0]) + b[1]*c[1]*xi[0]*xi[0]*(xi[1]*xi[2] - xi[2]*xi[0] - xi[0]*xi[1] - xi[1]*xi[1]) + b[2]*c[2]*xi[0]*xi[0]*xi[1]*(xi[1] - xi[0] - 2.0*xi[2]) - 5.0*xi[0]*xi[0]*xi[1]*xi[2]*(b[1]*c[1]*lamb_p[1])</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;     - 5.0*xi[0]*xi[0]*xi[1]*(b[1]*c[1]*lamb_p[1]*xi[2] + b[2]*c[2]*lamb[2]*xi[1]);</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    </div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    <span class="comment">// by chain rule, we can obtain dshape wrt s0 at node0</span></div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    dpsids(0,0,0) = psi1(0,0,0)*dxids0[0] + psi1(0,0,1)*dxids0[1] + psi1(0,0,2)*dxids0[2];</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    dpsids(0,1,0) = psi1(0,1,0)*dxids0[0] + psi1(0,1,1)*dxids0[1] + psi1(0,1,2)*dxids0[2];</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    dpsids(0,2,0) = psi1(0,2,0)*dxids0[0] + psi1(0,2,1)*dxids0[1] + psi1(0,2,2)*dxids0[2];</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    dpsids(0,3,0) = psi1(0,3,0)*dxids0[0] + psi1(0,3,1)*dxids0[1] + psi1(0,3,2)*dxids0[2];</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    dpsids(0,4,0) = psi1(0,4,0)*dxids0[0] + psi1(0,4,1)*dxids0[1] + psi1(0,4,2)*dxids0[2];</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    dpsids(0,5,0) = psi1(0,5,0)*dxids0[0] + psi1(0,5,1)*dxids0[1] + psi1(0,5,2)*dxids0[2];</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    </div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    <span class="comment">// by chain rule, we can obtain dshape wrt s1 at node0</span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    dpsids(0,0,1) = psi1(0,0,0)*dxids1[0] + psi1(0,0,1)*dxids1[1] + psi1(0,0,2)*dxids1[2];</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    dpsids(0,1,1) = psi1(0,1,0)*dxids1[0] + psi1(0,1,1)*dxids1[1] + psi1(0,1,2)*dxids1[2];</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    dpsids(0,2,1) = psi1(0,2,0)*dxids1[0] + psi1(0,2,1)*dxids1[1] + psi1(0,2,2)*dxids1[2];</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    dpsids(0,3,1) = psi1(0,3,0)*dxids1[0] + psi1(0,3,1)*dxids1[1] + psi1(0,3,2)*dxids1[2];</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    dpsids(0,4,1) = psi1(0,4,0)*dxids1[0] + psi1(0,4,1)*dxids1[1] + psi1(0,4,2)*dxids1[2];</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    dpsids(0,5,1) = psi1(0,5,0)*dxids1[0] + psi1(0,5,1)*dxids1[1] + psi1(0,5,2)*dxids1[2];</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    <span class="comment">//-------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    <span class="comment">// define shape functions that associated to dofs at node 1</span></div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    <span class="comment">// wrt area coordinate 1</span></div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    psi1(1,0,1) = 5.0*xi[1]*xi[1]*xi[1]*xi[1] +5.0*4.0*xi[1]*xi[1]*xi[1]*(xi[2]+xi[0]) + 10.0*3.0*xi[1]*xi[1]*(xi[2]+xi[0])*(xi[2]+xi[0]) +30.0*2.0*xi[1]*xi[2]*xi[0]*(lamb[0]*xi[2] + lamb_p[2]*xi[0]);</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    psi1(1,1,1) = 3.0*b[1]*2.0*xi[1]*xi[2]*xi[0]*(xi[2]-xi[0]) +   3.0*xi[1]*xi[1]*(b[0]*xi[2] -b[2]*xi[0])*(xi[1] + 4.0*xi[2] + 4.0*xi[0]) +xi[1]*xi[1]*xi[1]*(b[0]*xi[2] -b[2]*xi[0]) + 15*2.0*xi[1]*xi[2]*xi[0]*(b[0]*lamb[0]*xi[2] - b[2]*lamb_p[2]*xi[0]);</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    psi1(1,2,1) = -3.0*c[1]*2.0*xi[1]*xi[2]*xi[0]*(xi[2]-xi[0]) - 3.0*xi[1]*xi[1]*(c[0]*xi[2] -c[2]*xi[0])*(xi[1] + 4.0*xi[2] + 4.0*xi[0]) - xi[1]*xi[1]*xi[1]*(c[0]*xi[2] -c[2]*xi[0]) -15.0*2.0*xi[1]*xi[2]*xi[0]*(c[0]*lamb[0]*xi[2] -c[2]*lamb_p[2]*xi[0]);</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    psi1(1,3,1) = 1.0/2.0*3.0*xi[1]*xi[1]*(b[0]*b[0]*xi[2]*xi[2] + b[2]*b[2]*xi[0]*xi[0]) + 2.0*xi[1]*xi[2]*xi[0]*(-b[2]*b[0]*xi[1] + b[0]*b[1]*xi[2] + b[1]*b[2]*xi[0]) + 5.0/2.0*2.0*xi[1]*xi[2]*xi[0]*(b[0]*b[0]*lamb[0]*xi[2] + b[2]*b[2]*lamb_p[2]*xi[0]) + xi[1]*xi[1]*xi[2]*xi[0]*(-b[2])*b[0];</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    psi1(1,4,1) = 1.0/2.0*3.0*xi[1]*xi[1]*(c[0]*c[0]*xi[2]*xi[2] + c[2]*c[2]*xi[0]*xi[0]) + 2.0*xi[1]*xi[2]*xi[0]*(-c[2]*c[0]*xi[1] + c[0]*c[1]*xi[2] + c[1]*c[2]*xi[0])</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;     + 5.0/2.0*2.0*xi[1]*xi[2]*xi[0]*(c[0]*c[0]*lamb[0]*xi[2] + c[2]*c[2]*lamb_p[2]*xi[0])+ xi[1]*xi[1]*xi[2]*xi[0]*(-c[2])*c[0];</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    psi1(1,5,1) = b[1]*c[1]*2.0*xi[1]*xi[2]*xi[0]*(xi[1] + xi[2] + xi[0]) + b[1]*c[1]*xi[1]*xi[1]*xi[2]*xi[0] + b[2]*c[2]*2.0*xi[1]*xi[0]*(xi[2]*xi[0] - xi[0]*xi[1] - xi[1]*xi[2] - xi[2]*xi[2]) + b[2]*c[2]*xi[1]*xi[1]*xi[0]*(-xi[2] - xi[0]) + b[0]*c[0]*2.0*xi[1]*xi[2]*(xi[2]*xi[0] - xi[0]*xi[1] -xi[1]*xi[2] - xi[0]*xi[0]) + b[0]*c[0]*xi[1]*xi[1]*xi[2]*(- xi[0]-xi[2]) - 5.0*2.0*xi[1]*xi[2]*xi[0]*(b[2]*c[2]*lamb_p[2]*xi[0] + b[0]*c[0]*lamb[0]*xi[2]);</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;    </div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    <span class="comment">// wrt area coordinate2</span></div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    psi1(1,0,2) = 5.0*xi[1]*xi[1]*xi[1]*xi[1] + 10.0*xi[1]*xi[1]*xi[1]*2.0*(xi[2]+xi[0])+30.0*xi[1]*xi[1]*xi[0]*(lamb[0]*xi[2] + lamb_p[2]*xi[0]) +30.0*xi[1]*xi[1]*xi[2]*xi[0]*(lamb[0]);</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    psi1(1,1,2) = 3.0*b[1]*xi[1]*xi[1]*xi[0]*(xi[2]-xi[0])+ 3.0*b[1]*xi[1]*xi[1]*xi[2]*xi[0] +  xi[1]*xi[1]*xi[1]*(b[0])*(xi[1] + 4.0*xi[2] + 4.0*xi[0])+  xi[1]*xi[1]*xi[1]*(b[0]*xi[2] -b[2]*xi[0])*(4.0) + 15.0*xi[1]*xi[1]*xi[0]*(b[0]*lamb[0]*xi[2] - b[2]*lamb_p[2]*xi[0]) + 15*xi[1]*xi[1]*xi[2]*xi[0]*(b[0]*lamb[0]);</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    psi1(1,2,2) =  -3.0*c[1]*xi[1]*xi[1]*xi[2]*xi[0] + -3.0*c[1]*xi[1]*xi[1]*xi[0]*(xi[2]-xi[0]) - xi[1]*xi[1]*xi[1]*(c[0]*xi[2] - c[2]*xi[0])*(4.0) - xi[1]*xi[1]*xi[1]*(c[0])*(xi[1] + 4.0*xi[2] + 4.0*xi[0]) -15.0*xi[1]*xi[1]*xi[2]*xi[0]*(c[0]*lamb[0]) - 15.0*xi[1]*xi[1]*xi[0]*(c[0]*lamb[0]*xi[2] -c[2]*lamb_p[2]*xi[0]);</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    psi1(1,3,2) = 1.0/2.0*xi[1]*xi[1]*xi[1]*(b[0]*b[0]*2.0*xi[2]) + xi[1]*xi[1]*xi[2]*xi[0]*(b[0]*b[1]) + xi[1]*xi[1]*xi[0]*(-b[2]*b[0]*xi[1] + b[0]*b[1]*xi[2] + b[1]*b[2]*xi[0])  + 5.0/2.0*xi[1]*xi[1]*xi[2]*xi[0]*(b[0]*b[0]*lamb[0]) + 5.0/2.0*xi[1]*xi[1]*xi[0]*(b[0]*b[0]*lamb[0]*xi[2] + b[2]*b[2]*lamb_p[2]*xi[0]);</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    psi1(1,4,2) = 1.0/2.0*xi[1]*xi[1]*xi[1]*(c[0]*c[0]*2.0*xi[2]) + xi[1]*xi[1]*xi[2]*xi[0]*(c[0]*c[1]) + xi[1]*xi[1]*xi[0]*(-c[2]*c[0]*xi[1] + c[0]*c[1]*xi[2] + c[1]*c[2]*xi[0])+ 5.0/2.0*xi[1]*xi[1]*xi[2]*xi[0]*(c[0]*c[0]*lamb[0])  + 5.0/2.0*xi[1]*xi[1]*xi[0]*(c[0]*c[0]*lamb[0]*xi[2] + c[2]*c[2]*lamb_p[2]*xi[0]);</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    psi1(1,5,2) = b[1]*c[1]*xi[1]*xi[1]*xi[2]*xi[0] + b[1]*c[1]*xi[1]*xi[1]*xi[0]*(xi[1] + xi[2] + xi[0]) + b[2]*c[2]*xi[1]*xi[1]*xi[0]*(xi[0] - xi[1] - 2.0*xi[2])</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;     + b[0]*c[0]*xi[1]*xi[1]*xi[2]*(xi[0] -xi[1]) + b[0]*c[0]*xi[1]*xi[1]*(xi[2]*xi[0] - xi[0]*xi[1] -xi[1]*xi[2] - xi[0]*xi[0]) - 5.0*xi[1]*xi[1]*xi[2]*xi[0]*( b[0]*c[0]*lamb[0]) - 5.0*xi[1]*xi[1]*xi[0]*(b[2]*c[2]*lamb_p[2]*xi[0] + b[0]*c[0]*lamb[0]*xi[2]);</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;     </div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    <span class="comment">// wrt area coordinate0</span></div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    psi1(1,0,0) = 5.0*xi[1]*xi[1]*xi[1]*xi[1] + 10.0*xi[1]*xi[1]*xi[1]*2.0*(xi[2]+xi[0]) + 30.0*xi[1]*xi[1]*xi[2]*xi[0]*(lamb_p[2])+ 30.0*xi[1]*xi[1]*xi[2]*(lamb[0]*xi[2] + lamb_p[2]*xi[0]);</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    psi1(1,1,0) = -3.0*b[1]*xi[1]*xi[1]*xi[2]*xi[0] + 3.0*b[1]*xi[1]*xi[1]*xi[2]*(xi[2]-xi[0]) +  xi[1]*xi[1]*xi[1]*(b[0]*xi[2] -b[2]*xi[0])*(4.0) + xi[1]*xi[1]*xi[1]*(-b[2])*(xi[1] + 4.0*xi[2] + 4.0*xi[0]) - 15*xi[1]*xi[1]*xi[2]*xi[0]*(b[2]*lamb_p[2]) + 15*xi[1]*xi[1]*xi[2]*(b[0]*lamb[0]*xi[2] - b[2]*lamb_p[2]*xi[0]);</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    psi1(1,2,0) =  3.0*c[1]*xi[1]*xi[1]*xi[2]*xi[0] - 3.0*c[1]*xi[1]*xi[1]*xi[2]*(xi[2]-xi[0]) -  xi[1]*xi[1]*xi[1]*(c[0]*xi[2] -c[2]*xi[0])*(4.0) - xi[1]*xi[1]*xi[1]*(-c[2])*(xi[1] + 4.0*xi[2] + 4.0*xi[0]) + 15.0*xi[1]*xi[1]*xi[2]*xi[0]*(c[2]*lamb_p[2]) -15.0*xi[1]*xi[1]*xi[2]*(c[0]*lamb[0]*xi[2] -c[2]*lamb_p[2]*xi[0]);</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    psi1(1,3,0) = 1.0/2.0*xi[1]*xi[1]*xi[1]*(b[2]*b[2]*2.0*xi[0]) + xi[1]*xi[1]*xi[2]*xi[0]*(b[1]*b[2]) + xi[1]*xi[1]*xi[2]*(-b[2]*b[0]*xi[1] + b[0]*b[1]*xi[2] + b[1]*b[2]*xi[0]) + 5.0/2.0*xi[1]*xi[1]*xi[2]*xi[0]*( b[2]*b[2]*lamb_p[2])+ 5.0/2.0*xi[1]*xi[1]*xi[2]*(b[0]*b[0]*lamb[0]*xi[2] + b[2]*b[2]*lamb_p[2]*xi[0]);</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    psi1(1,4,0) = 1.0/2.0*xi[1]*xi[1]*xi[1]*(c[2]*c[2]*2.0*xi[0]) + xi[1]*xi[1]*xi[2]*xi[0]*(c[1]*c[2]) + xi[1]*xi[1]*xi[2]*(-c[2]*c[0]*xi[1] + c[0]*c[1]*xi[2] + c[1]*c[2]*xi[0])  + 5.0/2.0*xi[1]*xi[1]*xi[2]*xi[0]*(c[2]*c[2]*lamb_p[2]) + 5.0/2.0*xi[1]*xi[1]*xi[2]*(c[0]*c[0]*lamb[0]*xi[2] + c[2]*c[2]*lamb_p[2]*xi[0]);</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    psi1(1,5,0) = b[1]*c[1]*xi[1]*xi[1]*xi[2]*xi[0] + b[1]*c[1]*xi[1]*xi[1]*xi[2]*(xi[1] + xi[2] + xi[0]) + b[2]*c[2]*xi[1]*xi[1]*xi[0]*(xi[2] - xi[1])  + b[2]*c[2]*xi[1]*xi[1]*(xi[2]*xi[0] - xi[0]*xi[1] - xi[1]*xi[2] - xi[2]*xi[2]) + b[0]*c[0]*xi[1]*xi[1]*xi[2]*(xi[2] - xi[1] - 2.0*xi[0]) - 5.0*xi[1]*xi[1]*xi[2]*xi[0]*(b[2]*c[2]*lamb_p[2]) - 5.0*xi[1]*xi[1]*xi[2]*(b[2]*c[2]*lamb_p[2]*xi[0] + b[0]*c[0]*lamb[0]*xi[2]);</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    <span class="comment">//--------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    <span class="comment">// by chain rule, we can obtain dshape wrt s0 at node1</span></div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;    dpsids(1,0,0) = psi1(1,0,0)*dxids0[0] + psi1(1,0,1)*dxids0[1] + psi1(1,0,2)*dxids0[2];</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    dpsids(1,1,0) = psi1(1,1,0)*dxids0[0] + psi1(1,1,1)*dxids0[1] + psi1(1,1,2)*dxids0[2];</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    dpsids(1,2,0) = psi1(1,2,0)*dxids0[0] + psi1(1,2,1)*dxids0[1] + psi1(1,2,2)*dxids0[2];</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    dpsids(1,3,0) = psi1(1,3,0)*dxids0[0] + psi1(1,3,1)*dxids0[1] + psi1(1,3,2)*dxids0[2];</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    dpsids(1,4,0) = psi1(1,4,0)*dxids0[0] + psi1(1,4,1)*dxids0[1] + psi1(1,4,2)*dxids0[2];</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    dpsids(1,5,0) = psi1(1,5,0)*dxids0[0] + psi1(1,5,1)*dxids0[1] + psi1(1,5,2)*dxids0[2];</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    </div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    <span class="comment">// by chain rule, we can obtain dshape wrt s1 at node1</span></div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    dpsids(1,0,1) = psi1(1,0,0)*dxids1[0] + psi1(1,0,1)*dxids1[1] + psi1(1,0,2)*dxids1[2];</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;    dpsids(1,1,1) = psi1(1,1,0)*dxids1[0] + psi1(1,1,1)*dxids1[1] + psi1(1,1,2)*dxids1[2];</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;    dpsids(1,2,1) = psi1(1,2,0)*dxids1[0] + psi1(1,2,1)*dxids1[1] + psi1(1,2,2)*dxids1[2];</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    dpsids(1,3,1) = psi1(1,3,0)*dxids1[0] + psi1(1,3,1)*dxids1[1] + psi1(1,3,2)*dxids1[2];</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    dpsids(1,4,1) = psi1(1,4,0)*dxids1[0] + psi1(1,4,1)*dxids1[1] + psi1(1,4,2)*dxids1[2];</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;    dpsids(1,5,1) = psi1(1,5,0)*dxids1[0] + psi1(1,5,1)*dxids1[1] + psi1(1,5,2)*dxids1[2];</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    <span class="comment">//-------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    <span class="comment">// define shape functions that associated to dofs at node 2</span></div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    <span class="comment">// wrt area coordinate0</span></div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    psi1(2,0,0) = 5.0*xi[2]*xi[2]*xi[2]*xi[2] + 10.0*xi[2]*xi[2]*xi[2]*2.0*(xi[0]+xi[1]) + 30.0*xi[2]*xi[2]*xi[1]*(lamb[1]*xi[0] + lamb_p[0]*xi[1]) </div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;     +30.0*xi[2]*xi[2]*xi[0]*xi[1]*(lamb[1]);</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    psi1(2,1,0)= 3.0*b[2]*xi[2]*xi[2]*xi[1]*(xi[0]-xi[1]) + 3.0*b[2]*xi[2]*xi[2]*xi[0]*xi[1] +   xi[2]*xi[2]*xi[2]*(b[1])*(xi[2] + 4.0*xi[0] + 4.0*xi[1])+  xi[2]*xi[2]*xi[2]*(b[1]*xi[0] -b[0]*xi[1])*(4.0) + 15.0*xi[2]*xi[2]*xi[1]*(b[1]*lamb[1]*xi[0] - b[0]*lamb_p[0]*xi[1]) + 15.0*xi[2]*xi[2]*xi[0]*xi[1]*(b[1]*lamb[1]);</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    psi1(2,2,0) =  -3.0*c[2]*xi[2]*xi[2]*xi[0]*xi[1] + -3.0*c[2]*xi[2]*xi[2]*xi[1]*(xi[0]-xi[1]) - xi[2]*xi[2]*xi[2]*(c[1]*xi[0] - c[0]*xi[1])*(4.0) - xi[2]*xi[2]*xi[2]*(c[1])*(xi[2] + 4.0*xi[0] + 4.0*xi[1]) -15.0*xi[2]*xi[2]*xi[0]*xi[1]*(c[1]*lamb[1])</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;     -15.0*xi[2]*xi[2]*xi[1]*(c[1]*lamb[1]*xi[0] -c[0]*lamb_p[0]*xi[1]);</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    psi1(2,3,0) = 1.0/2.0*xi[2]*xi[2]*xi[2]*(b[1]*b[1]*2.0*xi[0]) + xi[2]*xi[2]*xi[0]*xi[1]*(b[1]*b[2]) + xi[2]*xi[2]*xi[1]*(-b[0]*b[1]*xi[2] + b[1]*b[2]*xi[0] + b[2]*b[0]*xi[1])  + 5.0/2.0*xi[2]*xi[2]*xi[0]*xi[1]*(b[1]*b[1]*lamb[1]) + 5.0/2.0*xi[2]*xi[2]*xi[1]*(b[1]*b[1]*lamb[1]*xi[0] + b[0]*b[0]*lamb_p[0]*xi[1]);</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    psi1(2,4,0) = 1.0/2.0*xi[2]*xi[2]*xi[2]*(c[1]*c[1]*2.0*xi[0]) + xi[2]*xi[2]*xi[0]*xi[1]*( c[1]*c[2]) + xi[2]*xi[2]*xi[1]*(-c[0]*c[1]*xi[2] + c[1]*c[2]*xi[0] + c[2]*c[0]*xi[1])+ 5.0/2.0*xi[2]*xi[2]*xi[0]*xi[1]*(c[1]*c[1]*lamb[1])  + 5.0/2.0*xi[2]*xi[2]*xi[1]*(c[1]*c[1]*lamb[1]*xi[0] + c[0]*c[0]*lamb_p[0]*xi[1]);</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    psi1(2,5,0) = b[2]*c[2]*xi[2]*xi[2]*xi[0]*xi[1] + b[2]*c[2]*xi[2]*xi[2]*xi[1]*(xi[2] + xi[0] + xi[1]) + b[0]*c[0]*xi[2]*xi[2]*xi[1]*(xi[1] - xi[2] - 2.0*xi[0])</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;     + b[1]*c[1]*xi[2]*xi[2]*xi[0]*(xi[1] -xi[2]) + b[1]*c[1]*xi[2]*xi[2]*(xi[0]*xi[1] - xi[1]*xi[2] -xi[2]*xi[0] - xi[1]*xi[1]) - 5.0*xi[2]*xi[2]*xi[0]*xi[1]*( b[1]*c[1]*lamb[1]) - 5.0*xi[2]*xi[2]*xi[1]*(b[0]*c[0]*lamb_p[0]*xi[1] + b[1]*c[1]*lamb[1]*xi[0]);</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    </div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    <span class="comment">// wrt area coordinate1</span></div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    psi1(2,0,1) = 5.0*xi[2]*xi[2]*xi[2]*xi[2] + 10.0*xi[2]*xi[2]*xi[2]*2.0*(xi[0]+xi[1]) +30.0*xi[2]*xi[2]*xi[0]*xi[1]*(lamb_p[0])  +30.0*xi[2]*xi[2]*xi[0]*(lamb[1]*xi[0] + lamb_p[0]*xi[1]);</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    psi1(2,1,1) = 3.0*b[2]*xi[2]*xi[2]*xi[0]*xi[1]*(-1.0) + 3.0*b[2]*xi[2]*xi[2]*xi[0]*(xi[0]-xi[1])+  xi[2]*xi[2]*xi[2]*(-b[0])*(xi[2] + 4.0*xi[0] + 4.0*xi[1])+   xi[2]*xi[2]*xi[2]*(b[1]*xi[0] -b[0]*xi[1])*(4.0)+ 15*xi[2]*xi[2]*xi[0]*(b[1]*lamb[1]*xi[0] - b[0]*lamb_p[0]*xi[1]) + 15.0*xi[2]*xi[2]*xi[0]*xi[1]*(-b[0]*lamb_p[0]);</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;    psi1(2,2,1) =  -3.0*c[2]*xi[2]*xi[2]*xi[0]*xi[1]*(-1.0) +  -3.0*c[2]*xi[2]*xi[2]*xi[0]*(xi[0]-xi[1]) - xi[2]*xi[2]*xi[2]*(c[1]*xi[0] - c[0]*xi[1])*(4.0) - xi[2]*xi[2]*xi[2]*(-1.0*c[0])*(xi[2] + 4.0*xi[0] + 4.0*xi[1]) -15.0*xi[2]*xi[2]*xi[0]*xi[1]*( -1.0*c[0]*lamb_p[0]) -15.0*xi[2]*xi[2]*xi[0]*(c[1]*lamb[1]*xi[0] -c[0]*lamb_p[0]*xi[1]);</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    psi1(2,3,1) = 1.0/2.0*xi[2]*xi[2]*xi[2]*(b[0]*b[0]*2.0*xi[1]) + xi[2]*xi[2]*xi[0]*xi[1]*( b[2]*b[0]) + xi[2]*xi[2]*xi[0]*(-b[0]*b[1]*xi[2] + b[1]*b[2]*xi[0] + b[2]*b[0]*xi[1]) + 5.0/2.0*xi[2]*xi[2]*xi[0]*xi[1]*( b[0]*b[0]*lamb_p[0])+ 5.0/2.0*xi[2]*xi[2]*xi[0]*(b[1]*b[1]*lamb[1]*xi[0] + b[0]*b[0]*lamb_p[0]*xi[1]);</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    psi1(2,4,1) = 1.0/2.0*xi[2]*xi[2]*xi[2]*(c[0]*c[0]*2.0*xi[1]) + xi[2]*xi[2]*xi[0]*xi[1]*(c[2]*c[0]) + xi[2]*xi[2]*xi[0]*(-c[0]*c[1]*xi[2] + c[1]*c[2]*xi[0] + c[2]*c[0]*xi[1])  + 5.0/2.0*xi[2]*xi[2]*xi[0]*xi[1]*(c[0]*c[0]*lamb_p[0]) + 5.0/2.0*xi[2]*xi[2]*xi[0]*(c[1]*c[1]*lamb[1]*xi[0] + c[0]*c[0]*lamb_p[0]*xi[1]);</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    psi1(2,5,1) = b[2]*c[2]*xi[2]*xi[2]*xi[0]*xi[1] + b[2]*c[2]*xi[2]*xi[2]*xi[0]*(xi[2] + xi[0] + xi[1]) + b[0]*c[0]*xi[2]*xi[2]*xi[1]*(xi[0] - xi[2]) + b[0]*c[0]*xi[2]*xi[2]*(xi[0]*xi[1] - xi[1]*xi[2] - xi[2]*xi[0] - xi[0]*xi[0]) + b[1]*c[1]*xi[2]*xi[2]*xi[0]*(xi[0] - xi[2] - 2.0*xi[1]) - 5.0*xi[2]*xi[2]*xi[0]*xi[1]*(b[0]*c[0]*lamb_p[0]) - 5.0*xi[2]*xi[2]*xi[0]*(b[0]*c[0]*lamb_p[0]*xi[1] + b[1]*c[1]*lamb[1]*xi[0]);</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    </div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    <span class="comment">// wrt area coordinate2</span></div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    psi1(2,0,2) = 5.0*xi[2]*xi[2]*xi[2]*xi[2] +5.0*4.0*xi[2]*xi[2]*xi[2]*(xi[0]+xi[1]) + 10.0*3.0*xi[2]*xi[2]*(xi[0]+xi[1])*(xi[0]+xi[1])</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;     +30.0*2.0*xi[2]*xi[0]*xi[1]*(lamb[1]*xi[0] + lamb_p[0]*xi[1]);</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    psi1(2,1,2) = 3.0*b[2]*2.0*xi[2]*xi[0]*xi[1]*(xi[0]-xi[1]) +  3.0*xi[2]*xi[2]*(b[1]*xi[0] -b[0]*xi[1])*(xi[2] + 4.0*xi[0] + 4.0*xi[1]) + xi[2]*xi[2]*xi[2]*(b[1]*xi[0] -b[0]*xi[1]) + 15*2.0*xi[2]*xi[0]*xi[1]*(b[1]*lamb[1]*xi[0] - b[0]*lamb_p[0]*xi[1]);</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    psi1(2,2,2) = -3.0*c[2]*2.0*xi[2]*xi[0]*xi[1]*(xi[0]-xi[1]) - 3.0*xi[2]*xi[2]*(c[1]*xi[0] -c[0]*xi[1])*(xi[2] + 4.0*xi[0] + 4.0*xi[1]) - xi[2]*xi[2]*xi[2]*(c[1]*xi[0] -c[0]*xi[1]) -15.0*2.0*xi[2]*xi[0]*xi[1]*(c[1]*lamb[1]*xi[0] -c[0]*lamb_p[0]*xi[1]);</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;    psi1(2,3,2) = 1.0/2.0*3.0*xi[2]*xi[2]*(b[1]*b[1]*xi[0]*xi[0] + b[0]*b[0]*xi[1]*xi[1]) + 2.0*xi[2]*xi[0]*xi[1]*(-b[0]*b[1]*xi[2] + b[1]*b[2]*xi[0] + b[2]*b[0]*xi[1])</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;     + 5.0/2.0*2.0*xi[2]*xi[0]*xi[1]*(b[1]*b[1]*lamb[1]*xi[0] + b[0]*b[0]*lamb_p[0]*xi[1]) + xi[2]*xi[2]*xi[0]*xi[1]*(-b[0])*b[1];</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;    psi1(2,4,2) =  1.0/2.0*3.0*xi[2]*xi[2]*(c[1]*c[1]*xi[0]*xi[0] + c[0]*c[0]*xi[1]*xi[1]) + 2.0*xi[2]*xi[0]*xi[1]*(-c[0]*c[1]*xi[2] + c[1]*c[2]*xi[0] + c[2]*c[0]*xi[1])</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;     + 5.0/2.0*2.0*xi[2]*xi[0]*xi[1]*(c[1]*c[1]*lamb[1]*xi[0] + c[0]*c[0]*lamb_p[0]*xi[1])+ xi[2]*xi[2]*xi[0]*xi[1]*(-c[0]*c[1]);</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;    psi1(2,5,2) = b[2]*c[2]*2.0*xi[2]*xi[0]*xi[1]*(xi[2] + xi[0] + xi[1]) + b[2]*c[2]*xi[2]*xi[2]*xi[0]*xi[1] + b[0]*c[0]*2.0*xi[2]*xi[1]*(xi[0]*xi[1] - xi[1]*xi[2] - xi[2]*xi[0] - xi[0]*xi[0]) + b[0]*c[0]*xi[2]*xi[2]*xi[1]*(-xi[0] - xi[1]) + b[1]*c[1]*2.0*xi[2]*xi[0]*(xi[0]*xi[1] - xi[1]*xi[2] -xi[2]*xi[0] - xi[1]*xi[1]) + b[1]*c[1]*xi[2]*xi[2]*xi[0]*(- xi[1]-xi[0]) - 5.0*2.0*xi[2]*xi[0]*xi[1]*(b[0]*c[0]*lamb_p[0]*xi[1] + b[1]*c[1]*lamb[1]*xi[0]);</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    </div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    <span class="comment">// by chain rule, we can obtain dshape wrt s0 at node2</span></div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    dpsids(2,0,0) = psi1(2,0,0)*dxids0[0] + psi1(2,0,1)*dxids0[1] + psi1(2,0,2)*dxids0[2];</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;    dpsids(2,1,0) = psi1(2,1,0)*dxids0[0] + psi1(2,1,1)*dxids0[1] + psi1(2,1,2)*dxids0[2];</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    dpsids(2,2,0) = psi1(2,2,0)*dxids0[0] + psi1(2,2,1)*dxids0[1] + psi1(2,2,2)*dxids0[2];</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;    dpsids(2,3,0) = psi1(2,3,0)*dxids0[0] + psi1(2,3,1)*dxids0[1] + psi1(2,3,2)*dxids0[2];</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;    dpsids(2,4,0) = psi1(2,4,0)*dxids0[0] + psi1(2,4,1)*dxids0[1] + psi1(2,4,2)*dxids0[2];</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;    dpsids(2,5,0) = psi1(2,5,0)*dxids0[0] + psi1(2,5,1)*dxids0[1] + psi1(2,5,2)*dxids0[2];</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;    </div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;    <span class="comment">// by chain rule, we can obtain dshape wrt s1 at node2</span></div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    dpsids(2,0,1) = psi1(2,0,0)*dxids1[0] + psi1(2,0,1)*dxids1[1] + psi1(2,0,2)*dxids1[2];</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;    dpsids(2,1,1) = psi1(2,1,0)*dxids1[0] + psi1(2,1,1)*dxids1[1] + psi1(2,1,2)*dxids1[2];</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;    dpsids(2,2,1) = psi1(2,2,0)*dxids1[0] + psi1(2,2,1)*dxids1[1] + psi1(2,2,2)*dxids1[2];</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;    dpsids(2,3,1) = psi1(2,3,0)*dxids1[0] + psi1(2,3,1)*dxids1[1] + psi1(2,3,2)*dxids1[2];</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    dpsids(2,4,1) = psi1(2,4,0)*dxids1[0] + psi1(2,4,1)*dxids1[1] + psi1(2,4,2)*dxids1[2];</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;    dpsids(2,5,1) = psi1(2,5,0)*dxids1[0] + psi1(2,5,1)*dxids1[1] + psi1(2,5,2)*dxids1[2];</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;   }</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160; </div>
<div class="line"><a name="l00524"></a><span class="lineno"><a class="line" href="classoomph_1_1BellElementShape_3_012_01_4.html#a691a47683df33de15960e804474fc03e">  524</a></span>&#160;   <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1BellElementShape_3_012_01_4.html#a691a47683df33de15960e804474fc03e">d2Bshape_local</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>, <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;psi, <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;dpsids, <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;d2psids, <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> &amp;<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>)<span class="keyword"> const</span></div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;<span class="keyword">   </span>{</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;    <span class="comment">// assign for dshape functions</span></div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;    dBshape_local(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,psi,dpsids,<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>);</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;    <span class="comment">//---------------------------------------------</span></div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;    <span class="comment">// the mapping to physical coordinates </span></div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    <span class="comment">//----------------------------------------------</span></div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;    <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> phi(2);</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;    phi[0] = <a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(2,0) + (<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(0,0) - <a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(2,0))*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0] + (<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(1,0) - <a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(2,0))*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1];</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;    phi[1] = <a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(2,1) + (<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(0,1) - <a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(2,1))*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0] + (<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(1,1) - <a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(2,1))*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1];</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    </div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;    <span class="keywordtype">double</span> A = ( (<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(1,0)*<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(2,1)-<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(2,0)*<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(1,1)) - (<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(0,0)*<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(2,1)-<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(2,0)*<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(0,1)) + (<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(0,0)*<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(1,1)-<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(1,0)*<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(0,1)))/2.0;</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;    <span class="keywordtype">double</span> A0, A1, A2;</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;    A0 = ( (<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(1,0)*<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(2,1)-<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(2,0)*<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(1,1)) - (phi[0]*<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(2,1)-<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(2,0)*phi[1]) + (phi[0]*<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(1,1)-<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(1,0)*phi[1]))/2.0;</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;    A1 = ( (phi[0]*<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(2,1)-<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(2,0)*phi[1]) - (<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(0,0)*<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(2,1)-<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(2,0)*<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(0,1)) + (<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(0,0)*phi[1]-phi[0]*<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(0,1)))/2.0;</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;    A2 = ( (<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(1,0)*phi[1]-phi[0]*<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(1,1)) - (<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(0,0)*phi[1]-phi[0]*<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(0,1)) + (<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(0,0)*<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(1,1)-<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(1,0)*<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(0,1)))/2.0;</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;    </div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;    <span class="comment">// assigned area coordinates</span></div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;    <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> xi(3);</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;    xi[0] = A0/A;</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;    xi[1] = A1/A;</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;    xi[2] = A2/A;</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;    </div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;    <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> b(3);</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;    <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> c(3);</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;    <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> lamb(3);</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;    <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> lamb_p(3);</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;    <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> pp(2);</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;    <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> <a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>(2),cc(2);</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;    </div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;    <span class="comment">//compute for b and c</span></div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;    b[1] = <a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(0,0)-<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(2,0);</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;    b[2] = <a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(1,0)-<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(0,0);</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;    b[0] = <a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(2,0)-<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(1,0);</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160; </div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;    c[1] = <a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(2,1)-<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(0,1);</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;    c[2] = <a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(0,1)-<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(1,1);</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;    c[0] = <a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(1,1)-<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(2,1);</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;     </div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;    <span class="comment">//compute for a point of perpendicular</span></div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;    <span class="comment">// on the edge opposite to node0 (top vertex)</span></div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;    <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> v(2);</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;    v[0] = (<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(2,0)-<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(1,0));</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;    v[1] = (<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(2,1)-<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(1,1));</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;    <span class="keywordtype">double</span> m = v[1]/v[0];</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;    <a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>[0] = <a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(1,0);</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;    <a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>[1] = <a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(1,1);</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;    cc[0] = <a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(0,0);</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;    cc[1] = <a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(0,1);</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    <span class="keywordflow">if</span>(v[0]==0)</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;     {</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;      m = v[0]/v[1];</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;      pp[1] = ( v[0]*m*<a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>[1] + v[1]*cc[1] - v[0]*<a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>[0] + v[0]*cc[0] )/((v[0]*m)+v[1]);</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;      pp[0] = (pp[1]-<a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>[1])*m + <a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>[0];</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;     }</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;     {</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;      pp[0] = (v[1]*m*<a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>[0] + v[1]*cc[1] - v[1]*<a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>[1] + v[0]*cc[0])/(v[1]*m+v[0]);</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;      pp[1] = m*(pp[0]-<a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>[0]) + <a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>[1];</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;     }</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;    <span class="keywordtype">double</span> l = sqrt(v[0]*v[0] + v[1]*v[1]);</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;    <span class="keywordtype">double</span> l1 = sqrt( (pp[0]-<a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>[0])*(pp[0]-<a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>[0]) + (pp[1]-<a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>[1])*(pp[1]-<a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>[1]));</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;    lamb_p[0] = l1/l;</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;    lamb[0] = 1-lamb_p[0];</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;    </div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;    <span class="comment">// on the edge opposite to node1</span></div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;    v[0] = (<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(0,0)-<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(2,0));</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;    v[1] = (<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(0,1)-<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(2,1));</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;    m = v[1]/v[0];</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;    <a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>[0] = <a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(2,0);</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;    <a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>[1] = <a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(2,1);</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;    cc[0] = <a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(1,0);</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;    cc[1] = <a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(1,1);</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;    <span class="keywordflow">if</span>(v[0]==0)</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;     {</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;      m = v[0]/v[1];</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;      pp[1] = ( v[0]*m*<a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>[1] + v[1]*cc[1] - v[0]*<a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>[0] + v[0]*cc[0] )/((v[0]*m)+v[1]);</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;      pp[0] = (pp[1]-<a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>[1])*m + <a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>[0];</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;     }</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;     {</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;      pp[0] = (v[1]*m*<a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>[0] + v[1]*cc[1] - v[1]*<a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>[1] + v[0]*cc[0])/(v[1]*m+v[0]);</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;      pp[1] = m*(pp[0]-<a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>[0]) + <a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>[1];</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;     }</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;    l = sqrt(v[0]*v[0] + v[1]*v[1]);</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;    l1 = sqrt( (pp[0]-<a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>[0])*(pp[0]-<a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>[0]) + (pp[1]-<a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>[1])*(pp[1]-<a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>[1]));</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;    lamb_p[1] = l1/l;</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;    lamb[1] = 1-lamb_p[1];</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;    </div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;    <span class="comment">// on the edge opposite to node2 (right bottom)</span></div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;    v[0] = (<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(1,0)-<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(0,0));</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;    v[1] = (<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(1,1)-<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(0,1));</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;    m = v[1]/v[0];</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;    <a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>[0] = <a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(0,0);</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;    <a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>[1] = <a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(0,1);</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;    cc[0] = <a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(2,0);</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;    cc[1] = <a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(2,1);</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;    <span class="keywordflow">if</span>(v[0]==0)</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;     {</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;      m = v[0]/v[1];</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;      pp[1] = ( v[0]*m*<a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>[1] + v[1]*cc[1] - v[0]*<a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>[0] + v[0]*cc[0] )/((v[0]*m)+v[1]);</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;      pp[0] = (pp[1]-<a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>[1])*m + <a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>[0];</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;     }</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;     {</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;      pp[0] = (v[1]*m*<a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>[0] + v[1]*cc[1] - v[1]*<a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>[1] + v[0]*cc[0])/(v[1]*m+v[0]);</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;      pp[1] = m*(pp[0]-<a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>[0]) + <a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>[1];</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;     }</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;    l = sqrt(v[0]*v[0] + v[1]*v[1]);</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;    l1 = sqrt( (pp[0]-<a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>[0])*(pp[0]-<a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>[0]) + (pp[1]-<a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>[1])*(pp[1]-<a class="code" href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a>[1]));</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;    lamb_p[2] = l1/l;</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;    lamb[2] = 1-lamb_p[2];</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;    </div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;    <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> dxids0(3,0.0);</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;    <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> dxids1(3,0.0);</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;   </div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;    dxids0[0] = c[0]/A/2.0;</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;    dxids0[1] = c[1]/A/2.0;</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;    dxids0[2] = c[2]/A/2.0;</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;    </div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;    dxids1[0] = b[0]/A/2.0;</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;    dxids1[1] = b[1]/A/2.0;</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;    dxids1[2] = b[2]/A/2.0;</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160; </div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;    <span class="comment">//------------------------------------------------------------------</span></div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;    <a class="code" href="classoomph_1_1DShape.html">DShape</a> psi2(3,6,6);</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;    </div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;    <span class="comment">//------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;    <span class="comment">// compute for all second derivatives at node 0</span></div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;    <span class="comment">//------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;    <span class="comment">// compute for the second derivatives wrt area coordinate0</span></div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;    psi2(0,0,0) = 5.0*4.0*xi[0]*xi[0]*xi[0] +5.0*4.0*3.0*xi[0]*xi[0]*(xi[1]+xi[2]) + 10.0*3.0*2.0*xi[0]*(xi[1]+xi[2])*(xi[1]+xi[2]) +30.0*2.0*xi[1]*xi[2]*(lamb[2]*xi[1] + lamb_p[1]*xi[2]);</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;    psi2(0,1,0) = 3.0*b[0]*2.0*xi[1]*xi[2]*(xi[1]-xi[2]) +  3.0*2.0*xi[0]*(b[2]*xi[1] -b[1]*xi[2])*(xi[0] + 4.0*xi[1] + 4.0*xi[2]) + 6.0*xi[0]*xi[0]*(b[2]*xi[1] -b[1]*xi[2]) + 15*2.0*xi[1]*xi[2]*(b[2]*lamb[2]*xi[1] - b[1]*lamb_p[1]*xi[2]);</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;    psi2(0,2,0) = -6.0*c[0]*xi[1]*xi[2]*(xi[1]-xi[2]) - 3.0*2.0*xi[0]*(c[2]*xi[1] -c[1]*xi[2])*(xi[0] + 4.0*xi[1] + 4.0*xi[2]) - 6.0*xi[0]*xi[0]*(c[2]*xi[1] -c[1]*xi[2]) -15.0*2.0*xi[1]*xi[2]*(c[2]*lamb[2]*xi[1] -c[1]*lamb_p[1]*xi[2]);</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;    psi2(0,3,0) = 3.0*xi[0]*(b[2]*b[2]*xi[1]*xi[1] + b[1]*b[1]*xi[2]*xi[2]) + 2.0*xi[1]*xi[2]*(-b[1]*b[2]*xi[0] + b[2]*b[0]*xi[1] + b[0]*b[1]*xi[2]) - 4.0*xi[0]*xi[1]*xi[2]*(b[1]*b[2])</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;     + 5.0*xi[1]*xi[2]*(b[2]*b[2]*lamb[2]*xi[1] + b[1]*b[1]*lamb_p[1]*xi[2]);</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;    psi2(0,4,0) = 3.0*xi[0]*(c[2]*c[2]*xi[1]*xi[1] + c[1]*c[1]*xi[2]*xi[2]) + 2.0*xi[1]*xi[2]*(-c[1]*c[2]*xi[0] + c[2]*c[0]*xi[1] + c[0]*c[1]*xi[2]) - 4.0*xi[0]*xi[1]*xi[2]*(c[1]*c[2]) + 5.0*xi[1]*xi[2]*(c[2]*c[2]*lamb[2]*xi[1] + c[1]*c[1]*lamb_p[1]*xi[2]);</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;    psi2(0,5,0) = b[0]*c[0]*2.0*xi[1]*xi[2]*(xi[0] + xi[1] + xi[2]) + b[0]*c[0]*2.0*xi[0]*xi[1]*xi[2] + b[0]*c[0]*2.0*xi[0]*xi[1]*xi[2] + b[1]*c[1]*2.0*xi[2]*(xi[1]*xi[2] - xi[2]*xi[0] - xi[0]*xi[1] - xi[1]*xi[1]) - b[1]*c[1]*4.0*xi[0]*xi[2]*(xi[2] +xi[1]) + b[2]*c[2]*2.0*xi[1]*(xi[1]*xi[2] - xi[2]*xi[0] -xi[0]*xi[1] - xi[2]*xi[2]) - b[2]*c[2]*4.0*xi[0]*xi[1]*(xi[2]+xi[1]) - 5.0*2.0*xi[1]*xi[2]*(b[1]*c[1]*lamb_p[1]*xi[2] + b[2]*c[2]*lamb[2]*xi[1]);</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;    </div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;    <span class="comment">// compute for the second derivative wrt area coordinate1</span></div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;    psi2(0,0,1) = 10.0*xi[0]*xi[0]*xi[0]*2.0 + 30.0*xi[0]*xi[0]*xi[2]*(lamb[2]) + 30.0*xi[0]*xi[0]*xi[2]*(lamb[2]);</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;    psi2(0,1,1) = 3.0*b[0]*xi[0]*xi[0]*xi[2] + 3.0*b[0]*xi[0]*xi[0]*xi[2] + xi[0]*xi[0]*xi[0]*(b[2])*(4.0) + xi[0]*xi[0]*xi[0]*(b[2])*(4.0) + 15*xi[0]*xi[0]*xi[2]*(b[2]*lamb[2]) + 15*xi[0]*xi[0]*xi[2]*(b[2]*lamb[2]);</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;    psi2(0,2,1) = -6.0*c[0]*xi[0]*xi[0]*xi[2] - 8.0*xi[0]*xi[0]*xi[0]*(c[2]) - 30.0*xi[0]*xi[0]*xi[2]*(c[2]*lamb[2]);</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;    psi2(0,3,1) = xi[0]*xi[0]*xi[0]*(b[2]*b[2]) + 2.0*xi[0]*xi[0]*xi[2]*(b[2]*b[0]) + 5.0*xi[0]*xi[0]*xi[2]*(b[2]*b[2]*lamb[2]);</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;    psi2(0,4,1) = xi[0]*xi[0]*xi[0]*(c[2]*c[2]) + 2.0*xi[0]*xi[0]*xi[2]*(c[2]*c[0]) + 5.0*xi[0]*xi[0]*xi[2]*(c[2]*c[2]*lamb[2]);</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;    psi2(0,5,1) = b[0]*c[0]*xi[0]*xi[0]*xi[2] + b[0]*c[0]*xi[0]*xi[0]*xi[2] - 2.0*b[1]*c[1]*xi[0]*xi[0]*xi[2] - 2.0*b[2]*c[2]*xi[0]*xi[0]*(xi[0]-xi[2])- 10.0*xi[0]*xi[0]*xi[2]*(b[2]*c[2]*lamb[2]);</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;     </div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;    <span class="comment">// compute for the second derivative wrt area coordinate2</span></div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;    psi2(0,0,2) = 10.0*xi[0]*xi[0]*xi[0]*2.0 + 30.0*xi[0]*xi[0]*xi[1]*(lamb_p[1])  +30.0*xi[0]*xi[0]*xi[1]*(lamb_p[1]);</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;    psi2(0,1,2) = -6.0*b[0]*xi[0]*xi[0]*xi[1] -  8.0*xi[0]*xi[0]*xi[0]*(b[1]) - 30.0*xi[0]*xi[0]*xi[1]*(b[1]*lamb_p[1]);</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;    psi2(0,2,2) =  6.0*c[0]*xi[0]*xi[0]*xi[1] +  8.0*xi[0]*xi[0]*xi[0]*(c[1]) + 30.0*xi[0]*xi[0]*xi[1]*(c[1]*lamb_p[1]);</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;    psi2(0,3,2) = xi[0]*xi[0]*xi[0]*(b[1]*b[1]) + 2.0*xi[0]*xi[0]*xi[1]*(b[0]*b[1]) + 5.0*xi[0]*xi[0]*xi[1]*(b[1]*b[1]*lamb_p[1]);</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;    psi2(0,4,2) = xi[0]*xi[0]*xi[0]*(c[1]*c[1]) + 2.0*xi[0]*xi[0]*xi[1]*(c[0]*c[1]) + 5.0*xi[0]*xi[0]*xi[1]*(c[1]*c[1]*lamb_p[1]);</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;    psi2(0,5,2) = b[0]*c[0]*xi[0]*xi[0]*xi[1] + b[0]*c[0]*xi[0]*xi[0]*xi[1] + b[1]*c[1]*xi[0]*xi[0]*(xi[1] - xi[0]) + b[1]*c[1]*xi[0]*xi[0]*(xi[1]- xi[0]) + b[2]*c[2]*xi[0]*xi[0]*xi[1]*(-2.0) - 5.0*xi[0]*xi[0]*xi[1]*(b[1]*c[1]*lamb_p[1]) - 5.0*xi[0]*xi[0]*xi[1]*(b[1]*c[1]*lamb_p[1]); </div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;     </div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;    <span class="comment">// compute for the mixed-derivative wrt area coordinate0 and 1</span></div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;    psi2(0,0,3) = 5.0*4.0*xi[0]*xi[0]*xi[0] + 10.0*3.0*xi[0]*xi[0]*2.0*(xi[1]+xi[2]) + 30.0*2.0*xi[0]*xi[2]*(lamb[2]*xi[1] + lamb_p[1]*xi[2]) + 30.0*2.0*xi[0]*xi[1]*xi[2]*(lamb[2]);</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;    psi2(0,1,3) = 3.0*b[0]*2.0*xi[0]*xi[2]*(xi[1]-xi[2]) + 3.0*b[0]*2.0*xi[0]*xi[1]*xi[2] +  3.0*xi[0]*xi[0]*(b[2])*(xi[0] + 4.0*xi[1] + 4.0*xi[2]) </div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;     +  3.0*xi[0]*xi[0]*(b[2]*xi[1] -b[1]*xi[2])*(4.0) + xi[0]*xi[0]*xi[0]*(b[2]) + 15*2.0*xi[0]*xi[2]*(b[2]*lamb[2]*xi[1] - b[1]*lamb_p[1]*xi[2]) + 15*2.0*xi[0]*xi[1]*xi[2]*(b[2]*lamb[2]);</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;    psi2(0,2,3) = -3.0*c[0]*2.0*xi[0]*xi[2]*(xi[1]-xi[2]) -3.0*c[0]*2.0*xi[0]*xi[1]*xi[2] - 3.0*xi[0]*xi[0]*(c[2])*(xi[0] + 4.0*xi[1] + 4.0*xi[2]) - 3.0*xi[0]*xi[0]*(c[2]*xi[1] -c[1]*xi[2])*(4.0) </div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;     - xi[0]*xi[0]*xi[0]*(c[2]) -15.0*2.0*xi[0]*xi[2]*(c[2]*lamb[2]*xi[1] -c[1]*lamb_p[1]*xi[2]) -15.0*2.0*xi[0]*xi[1]*xi[2]*(c[2]*lamb[2]);</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;    psi2(0,3,3) =  3.0*xi[0]*xi[0]*(b[2]*b[2]*xi[1]) + 2.0*xi[0]*xi[2]*(-b[1]*b[2]*xi[0] + b[2]*b[0]*xi[1] + b[0]*b[1]*xi[2]) + 2.0*xi[0]*xi[1]*xi[2]*(b[2]*b[0])</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;     + 5.0/2.0*2.0*xi[0]*xi[2]*(b[2]*b[2]*lamb[2]*xi[1] + b[1]*b[1]*lamb_p[1]*xi[2])+ 5.0/2.0*2.0*xi[0]*xi[1]*xi[2]*(b[2]*b[2]*lamb[2]) + xi[0]*xi[0]*xi[2]*(-b[1])*b[2];</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;    psi2(0,4,3) = 3.0*xi[0]*xi[0]*(c[2]*c[2]*xi[1]) + 2.0*xi[0]*xi[2]*(-c[1]*c[2]*xi[0] + c[2]*c[0]*xi[1] + c[0]*c[1]*xi[2]) + 2.0*xi[0]*xi[1]*xi[2]*(c[2]*c[0]) + 5.0*xi[0]*xi[2]*(c[2]*c[2]*lamb[2]*xi[1] + c[1]*c[1]*lamb_p[1]*xi[2]) + 5.0*xi[0]*xi[1]*xi[2]*(c[2]*c[2]*lamb[2])+ xi[0]*xi[0]*xi[2]*(-c[1])*c[2];</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;    psi2(0,5,3) = b[0]*c[0]*2.0*xi[0]*xi[2]*(xi[0] + xi[1] + xi[2]) + b[0]*c[0]*2.0*xi[0]*xi[1]*xi[2] + b[0]*c[0]*xi[0]*xi[0]*xi[2] + b[1]*c[1]*2.0*xi[0]*xi[2]*(xi[2] - xi[0] - 2.0*xi[1]) + b[1]*c[1]*xi[0]*xi[0]*xi[2]*(-1.0) + b[2]*c[2]*2.0*xi[0]*(xi[1]*xi[2] - xi[2]*xi[0] -xi[0]*xi[1] - xi[2]*xi[2])+ b[2]*c[2]*2.0*xi[0]*xi[1]*(xi[2]-xi[0]) + b[2]*c[2]*xi[0]*xi[0]*(-xi[2]-xi[1]) + b[2]*c[2]*xi[0]*xi[0]*xi[1]*(-1.0) - 5.0*2.0*xi[0]*xi[2]*(b[1]*c[1]*lamb_p[1]*xi[2] + b[2]*c[2]*lamb[2]*xi[1])- 5.0*2.0*xi[0]*xi[1]*xi[2]*(b[2]*c[2]*lamb[2]);</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;    </div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;    <span class="comment">// compute for the mixed-derivative wrt area coordinate0 and 2</span></div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;    psi2(0,0,4) = 5.0*4.0*xi[0]*xi[0]*xi[0] + 10.0*3.0*xi[0]*xi[0]*2.0*(xi[1]+xi[2]) + 30.0*2.0*xi[0]*xi[1]*(lamb[2]*xi[1] + lamb_p[1]*xi[2]) + 30.0*2.0*xi[0]*xi[1]*xi[2]*(lamb_p[1]);</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;    psi2(0,1,4) = 3.0*b[0]*2.0*xi[0]*xi[1]*(xi[1]-xi[2]) + 3.0*b[0]*2.0*xi[0]*xi[1]*xi[2]*(-1.0) -  3.0*xi[0]*xi[0]*(b[1])*(xi[0] + 4.0*xi[1] + 4.0*xi[2])  </div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;     +  3.0*xi[0]*xi[0]*(b[2]*xi[1] -b[1]*xi[2])*(4.0) + xi[0]*xi[0]*xi[0]*(-b[1]) + 15*2.0*xi[0]*xi[1]*(b[2]*lamb[2]*xi[1] - b[1]*lamb_p[1]*xi[2])</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;     - 15*2.0*xi[0]*xi[1]*xi[2]*(b[1]*lamb_p[1]);</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;    psi2(0,2,4) = -3.0*c[0]*2.0*xi[0]*xi[1]*(xi[1]-xi[2]) + 3.0*c[0]*2.0*xi[0]*xi[1]*xi[2] + 3.0*xi[0]*xi[0]*(c[1])*(xi[0] + 4.0*xi[1] + 4.0*xi[2])  </div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;     - 3.0*xi[0]*xi[0]*(c[2]*xi[1] -c[1]*xi[2])*(4.0) + xi[0]*xi[0]*xi[0]*(c[1]) - 15.0*2.0*xi[0]*xi[1]*(c[2]*lamb[2]*xi[1] -c[1]*lamb_p[1]*xi[2]) </div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;     + 15.0*2.0*xi[0]*xi[1]*xi[2]*(c[1]*lamb_p[1]);</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;    psi2(0,3,4) = 3.0*xi[0]*xi[0]*(b[1]*b[1]*xi[2]) + 2.0*xi[0]*xi[1]*(-b[1]*b[2]*xi[0] + b[2]*b[0]*xi[1] + b[0]*b[1]*xi[2])</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;     + 2.0*xi[0]*xi[1]*xi[2]*(b[0]*b[1]) + 5.0/2.0*2.0*xi[0]*xi[1]*(b[2]*b[2]*lamb[2]*xi[1] + b[1]*b[1]*lamb_p[1]*xi[2]) + 5.0/2.0*2.0*xi[0]*xi[1]*xi[2]*(b[1]*b[1]*lamb_p[1]) + xi[0]*xi[0]*xi[1]*(-b[1])*b[2];</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;    psi2(0,4,4) = 3.0*xi[0]*xi[0]*(c[1]*c[1]*xi[2]) + 2.0*xi[0]*xi[1]*(-c[1]*c[2]*xi[0] + c[2]*c[0]*xi[1] + c[0]*c[1]*xi[2])  + 2.0*xi[0]*xi[1]*xi[2]*(c[0]*c[1]) + 5.0*xi[0]*xi[1]*(c[2]*c[2]*lamb[2]*xi[1] + c[1]*c[1]*lamb_p[1]*xi[2]) + 5.0*xi[0]*xi[1]*xi[2]*(c[1]*c[1]*lamb_p[1]) - xi[0]*xi[0]*xi[1]*(c[1])*c[2];</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;    psi2(0,5,4) = b[0]*c[0]*2.0*xi[0]*xi[1]*xi[2] + b[0]*c[0]*2.0*xi[0]*xi[1]*(xi[0] + xi[1] + xi[2]) + b[0]*c[0]*xi[0]*xi[0]*xi[1] + b[1]*c[1]*2.0*xi[0]*(xi[1]*xi[2] - xi[2]*xi[0] - xi[0]*xi[1] - xi[1]*xi[1]) </div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;     + b[1]*c[1]*2.0*xi[0]*xi[2]*(xi[1]- xi[0]) + b[1]*c[1]*xi[0]*xi[0]*(-xi[1] - xi[2])+ b[1]*c[1]*xi[0]*xi[0]*xi[2]*(-1.0)</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;     + b[2]*c[2]*2.0*xi[0]*xi[1]*(xi[1]-xi[0]- 2.0*xi[2]) + b[2]*c[2]*xi[0]*xi[0]*xi[1]*(-1.0)- 5.0*2.0*xi[0]*xi[1]*(b[1]*c[1]*lamb_p[1]*xi[2] + b[2]*c[2]*lamb[2]*xi[1]) - 5.0*2.0*xi[0]*xi[1]*xi[2]*(b[1]*c[1]*lamb_p[1]);</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;    </div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;     <span class="comment">// compute for the mixed-derivative wrt area coordinate1 and 2</span></div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;    psi2(0,0,5) =  10.0*xi[0]*xi[0]*xi[0]*2.0 + 30.0*xi[0]*xi[0]*(lamb[2]*xi[1] + lamb_p[1]*xi[2]) + 30.0*xi[0]*xi[0]*xi[2]*(lamb_p[1]) + 30.0*xi[0]*xi[0]*xi[1]*(lamb[2]);</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;    psi2(0,1,5) = 3.0*b[0]*xi[0]*xi[0]*(xi[1]-xi[2]) - 3.0*b[0]*xi[0]*xi[0]*xi[2] + 3.0*b[0]*xi[0]*xi[0]*xi[1] + xi[0]*xi[0]*xi[0]*(-b[1])*(4.0)  +  xi[0]*xi[0]*xi[0]*(b[2])*(4.0)+ 15*xi[0]*xi[0]*(b[2]*lamb[2]*xi[1] - b[1]*lamb_p[1]*xi[2])+ 15*xi[0]*xi[0]*xi[2]*(-b[1]*lamb_p[1]) +15*xi[0]*xi[0]*xi[1]*(b[2]*lamb[2]);</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;    psi2(0,2,5) = -3.0*c[0]*xi[0]*xi[0]*xi[1] + 3.0*c[0]*xi[0]*xi[0]*xi[2] - 3.0*c[0]*xi[0]*xi[0]*(xi[1]-xi[2]) + xi[0]*xi[0]*xi[0]*(c[1])*(4.0) - xi[0]*xi[0]*xi[0]*(c[2])*(4.0) -15.0*xi[0]*xi[0]*xi[1]*(c[2]*lamb[2])</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;    + 15.0*xi[0]*xi[0]*xi[2]*(c[1]*lamb_p[1]) - 15.0*xi[0]*xi[0]*(c[2]*lamb[2]*xi[1] -c[1]*lamb_p[1]*xi[2]);</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;    psi2(0,3,5) =  xi[0]*xi[0]*xi[2]*(b[0]*b[1]) + xi[0]*xi[0]*(-b[1]*b[2]*xi[0] + b[2]*b[0]*xi[1] + b[0]*b[1]*xi[2]) + xi[0]*xi[0]*xi[1]*(b[2]*b[0]) + 5.0/2.0*xi[0]*xi[0]*xi[2]*(b[1]*b[1]*lamb_p[1]) + 5.0/2.0*xi[0]*xi[0]*(b[2]*b[2]*lamb[2]*xi[1] + b[1]*b[1]*lamb_p[1]*xi[2])+ 5.0/2.0*xi[0]*xi[0]*xi[1]*(b[2]*b[2]*lamb[2]);</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;    psi2(0,4,5) =  xi[0]*xi[0]*xi[1]*(c[2]*c[0]) + xi[0]*xi[0]*(-c[1]*c[2]*xi[0] + c[2]*c[0]*xi[1] + c[0]*c[1]*xi[2]) + xi[0]*xi[0]*xi[2]*(c[0]*c[1]) + 5.0/2.0*xi[0]*xi[0]*xi[1]*(c[2]*c[2]*lamb[2]) + 5.0/2.0*xi[0]*xi[0]*(c[2]*c[2]*lamb[2]*xi[1] + c[1]*c[1]*lamb_p[1]*xi[2]) + 5.0/2.0*xi[0]*xi[0]*xi[2]*(c[1]*c[1]*lamb_p[1]);</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;    psi2(0,5,5) = b[0]*c[0]*xi[0]*xi[0]*xi[1]+ b[0]*c[0]*xi[0]*xi[0]*(xi[0] + xi[1] + xi[2])  + b[0]*c[0]*xi[0]*xi[0]*xi[2] + b[1]*c[1]*xi[0]*xi[0]*(xi[2] - xi[0] - 2.0*xi[1]) </div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;     + b[1]*c[1]*xi[0]*xi[0]*xi[2] + b[2]*c[2]*xi[0]*xi[0]*(xi[1]-xi[0]-2.0*xi[2]) + b[2]*c[2]*xi[0]*xi[0]*xi[1] - 5.0*xi[0]*xi[0]*(b[1]*c[1]*lamb_p[1]*xi[2] + b[2]*c[2]*lamb[2]*xi[1]) </div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;     - 5.0*xi[0]*xi[0]*xi[2]*(b[1]*c[1]*lamb_p[1]) - 5.0*xi[0]*xi[0]*xi[1]*(b[2]*c[2]*lamb[2]);</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160; </div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;    <span class="comment">// by chain rule, we can obtain d2shape wrt s0s0 at node0</span></div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;    d2psids(0,0,0) = (psi2(0,0,0)*dxids0[0] + psi2(0,0,3)*dxids0[1] + psi2(0,0,4)*dxids0[2])*dxids0[0] + </div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;                     (psi2(0,0,3)*dxids0[0] + psi2(0,0,1)*dxids0[1] + psi2(0,0,5)*dxids0[2])*dxids0[1] + </div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;                     (psi2(0,0,4)*dxids0[0] + psi2(0,0,5)*dxids0[1] + psi2(0,0,2)*dxids0[2])*dxids0[2];</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;    d2psids(0,1,0) = (psi2(0,1,0)*dxids0[0] + psi2(0,1,3)*dxids0[1] + psi2(0,1,4)*dxids0[2])*dxids0[0] + </div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;                     (psi2(0,1,3)*dxids0[0] + psi2(0,1,1)*dxids0[1] + psi2(0,1,5)*dxids0[2])*dxids0[1] + </div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;                     (psi2(0,1,4)*dxids0[0] + psi2(0,1,5)*dxids0[1] + psi2(0,1,2)*dxids0[2])*dxids0[2];</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;    d2psids(0,2,0) = (psi2(0,2,0)*dxids0[0] + psi2(0,2,3)*dxids0[1] + psi2(0,2,4)*dxids0[2])*dxids0[0] + </div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;                     (psi2(0,2,3)*dxids0[0] + psi2(0,2,1)*dxids0[1] + psi2(0,2,5)*dxids0[2])*dxids0[1] + </div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;                     (psi2(0,2,4)*dxids0[0] + psi2(0,2,5)*dxids0[1] + psi2(0,2,2)*dxids0[2])*dxids0[2];</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;    d2psids(0,3,0) = (psi2(0,3,0)*dxids0[0] + psi2(0,3,3)*dxids0[1] + psi2(0,3,4)*dxids0[2])*dxids0[0] + </div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;                     (psi2(0,3,3)*dxids0[0] + psi2(0,3,1)*dxids0[1] + psi2(0,3,5)*dxids0[2])*dxids0[1] + </div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;                     (psi2(0,3,4)*dxids0[0] + psi2(0,3,5)*dxids0[1] + psi2(0,3,2)*dxids0[2])*dxids0[2];</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;    d2psids(0,4,0) = (psi2(0,4,0)*dxids0[0] + psi2(0,4,3)*dxids0[1] + psi2(0,4,4)*dxids0[2])*dxids0[0] + </div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;                     (psi2(0,4,3)*dxids0[0] + psi2(0,4,1)*dxids0[1] + psi2(0,4,5)*dxids0[2])*dxids0[1] + </div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;                     (psi2(0,4,4)*dxids0[0] + psi2(0,4,5)*dxids0[1] + psi2(0,4,2)*dxids0[2])*dxids0[2];</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;    d2psids(0,5,0) = (psi2(0,5,0)*dxids0[0] + psi2(0,5,3)*dxids0[1] + psi2(0,5,4)*dxids0[2])*dxids0[0] + </div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;                     (psi2(0,5,3)*dxids0[0] + psi2(0,5,1)*dxids0[1] + psi2(0,5,5)*dxids0[2])*dxids0[1] + </div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;                     (psi2(0,5,4)*dxids0[0] + psi2(0,5,5)*dxids0[1] + psi2(0,5,2)*dxids0[2])*dxids0[2];</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;                     </div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;    <span class="comment">// by chain rule, we can obtain d2shape wrt s1s1 at node0</span></div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;    d2psids(0,0,1) = (psi2(0,0,0)*dxids1[0] + psi2(0,0,3)*dxids1[1] + psi2(0,0,4)*dxids1[2])*dxids1[0] + </div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;                     (psi2(0,0,3)*dxids1[0] + psi2(0,0,1)*dxids1[1] + psi2(0,0,5)*dxids1[2])*dxids1[1] + </div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;                     (psi2(0,0,4)*dxids1[0] + psi2(0,0,5)*dxids1[1] + psi2(0,0,2)*dxids1[2])*dxids1[2];</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;    d2psids(0,1,1) = (psi2(0,1,0)*dxids1[0] + psi2(0,1,3)*dxids1[1] + psi2(0,1,4)*dxids1[2])*dxids1[0] + </div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;                     (psi2(0,1,3)*dxids1[0] + psi2(0,1,1)*dxids1[1] + psi2(0,1,5)*dxids1[2])*dxids1[1] + </div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;                     (psi2(0,1,4)*dxids1[0] + psi2(0,1,5)*dxids1[1] + psi2(0,1,2)*dxids1[2])*dxids1[2];</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;    d2psids(0,2,1) = (psi2(0,2,0)*dxids1[0] + psi2(0,2,3)*dxids1[1] + psi2(0,2,4)*dxids1[2])*dxids1[0] + </div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;                     (psi2(0,2,3)*dxids1[0] + psi2(0,2,1)*dxids1[1] + psi2(0,2,5)*dxids1[2])*dxids1[1] + </div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;                     (psi2(0,2,4)*dxids1[0] + psi2(0,2,5)*dxids1[1] + psi2(0,2,2)*dxids1[2])*dxids1[2];</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;    d2psids(0,3,1) = (psi2(0,3,0)*dxids1[0] + psi2(0,3,3)*dxids1[1] + psi2(0,3,4)*dxids1[2])*dxids1[0] + </div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;                     (psi2(0,3,3)*dxids1[0] + psi2(0,3,1)*dxids1[1] + psi2(0,3,5)*dxids1[2])*dxids1[1] + </div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;                     (psi2(0,3,4)*dxids1[0] + psi2(0,3,5)*dxids1[1] + psi2(0,3,2)*dxids1[2])*dxids1[2];</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;    d2psids(0,4,1) = (psi2(0,4,0)*dxids1[0] + psi2(0,4,3)*dxids1[1] + psi2(0,4,4)*dxids1[2])*dxids1[0] + </div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;                     (psi2(0,4,3)*dxids1[0] + psi2(0,4,1)*dxids1[1] + psi2(0,4,5)*dxids1[2])*dxids1[1] + </div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;                     (psi2(0,4,4)*dxids1[0] + psi2(0,4,5)*dxids1[1] + psi2(0,4,2)*dxids1[2])*dxids1[2];</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;    d2psids(0,5,1) = (psi2(0,5,0)*dxids1[0] + psi2(0,5,3)*dxids1[1] + psi2(0,5,4)*dxids1[2])*dxids1[0] + </div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;                     (psi2(0,5,3)*dxids1[0] + psi2(0,5,1)*dxids1[1] + psi2(0,5,5)*dxids1[2])*dxids1[1] + </div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;                     (psi2(0,5,4)*dxids1[0] + psi2(0,5,5)*dxids1[1] + psi2(0,5,2)*dxids1[2])*dxids1[2];</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;                     </div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;    <span class="comment">// by chain rule, we can obtain d2shape wrt s0s1 at node0</span></div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;    d2psids(0,0,2) = (psi2(0,0,0)*dxids0[0] + psi2(0,0,3)*dxids0[1] + psi2(0,0,4)*dxids0[2])*dxids1[0] + </div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;                     (psi2(0,0,3)*dxids0[0] + psi2(0,0,1)*dxids0[1] + psi2(0,0,5)*dxids0[2])*dxids1[1] + </div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;                     (psi2(0,0,4)*dxids0[0] + psi2(0,0,5)*dxids0[1] + psi2(0,0,2)*dxids0[2])*dxids1[2];</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;    d2psids(0,1,2) = (psi2(0,1,0)*dxids0[0] + psi2(0,1,3)*dxids0[1] + psi2(0,1,4)*dxids0[2])*dxids1[0] + </div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;                     (psi2(0,1,3)*dxids0[0] + psi2(0,1,1)*dxids0[1] + psi2(0,1,5)*dxids0[2])*dxids1[1] + </div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;                     (psi2(0,1,4)*dxids0[0] + psi2(0,1,5)*dxids0[1] + psi2(0,1,2)*dxids0[2])*dxids1[2];</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;    d2psids(0,2,2) = (psi2(0,2,0)*dxids0[0] + psi2(0,2,3)*dxids0[1] + psi2(0,2,4)*dxids0[2])*dxids1[0] + </div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;                     (psi2(0,2,3)*dxids0[0] + psi2(0,2,1)*dxids0[1] + psi2(0,2,5)*dxids0[2])*dxids1[1] + </div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;                     (psi2(0,2,4)*dxids0[0] + psi2(0,2,5)*dxids0[1] + psi2(0,2,2)*dxids0[2])*dxids1[2];</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;    d2psids(0,3,2) = (psi2(0,3,0)*dxids0[0] + psi2(0,3,3)*dxids0[1] + psi2(0,3,4)*dxids0[2])*dxids1[0] + </div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;                     (psi2(0,3,3)*dxids0[0] + psi2(0,3,1)*dxids0[1] + psi2(0,3,5)*dxids0[2])*dxids1[1] + </div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;                     (psi2(0,3,4)*dxids0[0] + psi2(0,3,5)*dxids0[1] + psi2(0,3,2)*dxids0[2])*dxids1[2];</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;    d2psids(0,4,2) = (psi2(0,4,0)*dxids0[0] + psi2(0,4,3)*dxids0[1] + psi2(0,4,4)*dxids0[2])*dxids1[0] + </div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;                     (psi2(0,4,3)*dxids0[0] + psi2(0,4,1)*dxids0[1] + psi2(0,4,5)*dxids0[2])*dxids1[1] + </div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;                     (psi2(0,4,4)*dxids0[0] + psi2(0,4,5)*dxids0[1] + psi2(0,4,2)*dxids0[2])*dxids1[2];</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;    d2psids(0,5,2) = (psi2(0,5,0)*dxids0[0] + psi2(0,5,3)*dxids0[1] + psi2(0,5,4)*dxids0[2])*dxids1[0] + </div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;                     (psi2(0,5,3)*dxids0[0] + psi2(0,5,1)*dxids0[1] + psi2(0,5,5)*dxids0[2])*dxids1[1] + </div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;                     (psi2(0,5,4)*dxids0[0] + psi2(0,5,5)*dxids0[1] + psi2(0,5,2)*dxids0[2])*dxids1[2];</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;    <span class="comment">//-------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;    <span class="comment">// compute for all second derivatives at node 1</span></div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;    <span class="comment">//------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;    <span class="comment">// compute for the second derivatives wrt area coordinate1 </span></div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;    psi2(1,0,1) = 5.0*4.0*xi[1]*xi[1]*xi[1] +5.0*4.0*3.0*xi[1]*xi[1]*(xi[2]+xi[0]) + 10.0*3.0*2.0*xi[1]*(xi[2]+xi[0])*(xi[2]+xi[0]) +30.0*2.0*xi[2]*xi[0]*(lamb[0]*xi[2] + lamb_p[2]*xi[0]);</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;    psi2(1,1,1) = 3.0*b[1]*2.0*xi[2]*xi[0]*(xi[2]-xi[0]) +  3.0*2.0*xi[1]*(b[0]*xi[2] -b[2]*xi[0])*(xi[1] + 4.0*xi[2] + 4.0*xi[0])+ 3.0*xi[1]*xi[1]*(b[0]*xi[2] -b[2]*xi[0]) + 3.0*xi[1]*xi[1]*(b[0]*xi[2] -b[2]*xi[0]) + 15*2.0*xi[2]*xi[0]*(b[0]*lamb[0]*xi[2] - b[2]*lamb_p[2]*xi[0]);</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;    psi2(1,2,1) = -3.0*c[1]*2.0*xi[2]*xi[0]*(xi[2]-xi[0]) - 3.0*2.0*xi[1]*(c[0]*xi[2] -c[2]*xi[0])*(xi[1] + 4.0*xi[2] + 4.0*xi[0]) - 3.0*xi[1]*xi[1]*(c[0]*xi[2] -c[2]*xi[0]) - 3.0*xi[1]*xi[1]*(c[0]*xi[2] -c[2]*xi[0]) -15.0*2.0*xi[2]*xi[0]*(c[0]*lamb[0]*xi[2] -c[2]*lamb_p[2]*xi[0]);</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;    psi2(1,3,1) = 1.0/2.0*3.0*2.0*xi[1]*(b[0]*b[0]*xi[2]*xi[2] + b[2]*b[2]*xi[0]*xi[0]) + 2.0*xi[2]*xi[0]*(-b[2]*b[0]*xi[1] + b[0]*b[1]*xi[2] + b[1]*b[2]*xi[0]) - 4.0*xi[1]*xi[2]*xi[0]*(b[2]*b[0])+ 5.0*xi[2]*xi[0]*(b[0]*b[0]*lamb[0]*xi[2] + b[2]*b[2]*lamb_p[2]*xi[0]);</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;    psi2(1,4,1) = 1.0/2.0*3.0*2.0*xi[1]*(c[0]*c[0]*xi[2]*xi[2] + c[2]*c[2]*xi[0]*xi[0]) + 2.0*xi[2]*xi[0]*(-c[2]*c[0]*xi[1] + c[0]*c[1]*xi[2] + c[1]*c[2]*xi[0]) - 4.0*xi[1]*xi[2]*xi[0]*(c[2]*c[0])+ 5.0*xi[2]*xi[0]*(c[0]*c[0]*lamb[0]*xi[2] + c[2]*c[2]*lamb_p[2]*xi[0]);</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;    psi2(1,5,1) = b[1]*c[1]*2.0*xi[2]*xi[0]*(xi[1] + xi[2] + xi[0]) + b[1]*c[1]*2.0*xi[1]*xi[2]*xi[0] + b[1]*c[1]*2.0*xi[1]*xi[2]*xi[0] + b[2]*c[2]*2.0*xi[0]*(xi[2]*xi[0] - xi[0]*xi[1] - xi[1]*xi[2] - xi[2]*xi[2]) - 4.0*b[2]*c[2]*xi[1]*xi[0]*(xi[0]+xi[2]) + b[0]*c[0]*2.0*xi[2]*(xi[2]*xi[0] - xi[0]*xi[1] -xi[1]*xi[2] - xi[0]*xi[0]) - 4.0*b[0]*c[0]*2.0*xi[1]*xi[2]*(xi[0]+xi[2]) - 5.0*2.0*xi[2]*xi[0]*(b[2]*c[2]*lamb_p[2]*xi[0] + b[0]*c[0]*lamb[0]*xi[2]);</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;     </div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;    <span class="comment">// compute for the second derivatives wrt area coordinate2</span></div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;    psi2(1,0,2) = 10.0*xi[1]*xi[1]*xi[1]*2.0 +30.0*xi[1]*xi[1]*xi[0]*(lamb[0]) +30.0*xi[1]*xi[1]*xi[0]*(lamb[0]);</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;    psi2(1,1,2) = 3.0*b[1]*xi[1]*xi[1]*xi[0]+ 3.0*b[1]*xi[1]*xi[1]*xi[0] +  xi[1]*xi[1]*xi[1]*(b[0])*(4.0)+  xi[1]*xi[1]*xi[1]*(b[0])*(4.0)+ 15*xi[1]*xi[1]*xi[0]*(b[0]*lamb[0]) + 15*xi[1]*xi[1]*xi[0]*(b[0]*lamb[0]);</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;    psi2(1,2,2) =  -3.0*c[1]*xi[1]*xi[1]*xi[0]- 3.0*c[1]*xi[1]*xi[1]*xi[0]- xi[1]*xi[1]*xi[1]*(c[0])*(4.0) - xi[1]*xi[1]*xi[1]*(c[0])*(4.0) -15.0*xi[1]*xi[1]*xi[0]*(c[0]*lamb[0])-15.0*xi[1]*xi[1]*xi[0]*(c[0]*lamb[0]);</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;    psi2(1,3,2) = 1.0/2.0*xi[1]*xi[1]*xi[1]*(b[0]*b[0]*2.0) + xi[1]*xi[1]*xi[0]*(b[0]*b[1]) + xi[1]*xi[1]*xi[0]*(b[0]*b[1]) + 5.0*xi[1]*xi[1]*xi[0]*(b[0]*b[0]*lamb[0]);</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;    psi2(1,4,2) = 1.0/2.0*xi[1]*xi[1]*xi[1]*(c[0]*c[0]*2.0) + xi[1]*xi[1]*xi[0]*(c[0]*c[1]) + xi[1]*xi[1]*xi[0]*(c[0]*c[1]) + 5.0*xi[1]*xi[1]*xi[0]*(c[0]*c[0]*lamb[0]);</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;    psi2(1,5,2) = b[1]*c[1]*xi[1]*xi[1]*xi[0] + b[1]*c[1]*xi[1]*xi[1]*xi[0] + b[2]*c[2]*xi[1]*xi[1]*xi[0]*(-2.0) + b[0]*c[0]*xi[1]*xi[1]*(xi[0]-xi[1]) + b[0]*c[0]*xi[1]*xi[1]*(xi[0]-xi[1]) - 5.0*xi[1]*xi[1]*xi[0]*( b[0]*c[0]*lamb[0]) - 5.0*xi[1]*xi[1]*xi[0]*(b[0]*c[0]*lamb[0]);</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;     </div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;    <span class="comment">// compute for the second derivatives wrt area coordinate0</span></div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;    psi2(1,0,0) = 10.0*xi[1]*xi[1]*xi[1]*2.0 +30.0*xi[1]*xi[1]*xi[2]*(lamb_p[2])  +30.0*xi[1]*xi[1]*xi[2]*(lamb_p[2]);</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;    psi2(1,1,0) =  -6.0*b[1]*xi[1]*xi[1]*xi[2] +  xi[1]*xi[1]*xi[1]*(-b[2])*( 4.0)+  xi[1]*xi[1]*xi[1]*(-b[2])*(4.0) - 30*xi[1]*xi[1]*xi[2]*(b[2]*lamb_p[2]);</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;    psi2(1,2,0) =  3.0*c[1]*xi[1]*xi[1]*xi[2] +  3.0*c[1]*xi[1]*xi[1]*xi[2] + xi[1]*xi[1]*xi[1]*(c[2])*(4.0) + xi[1]*xi[1]*xi[1]*(c[2])*(4.0) + 30.0*xi[1]*xi[1]*xi[2]*(c[2]*lamb_p[2]);</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;    psi2(1,3,0) = xi[1]*xi[1]*xi[1]*(b[2]*b[2]) + 2.0*xi[1]*xi[1]*xi[2]*(b[1]*b[2]) + 5.0*xi[1]*xi[1]*xi[2]*(b[2]*b[2]*lamb_p[2]);</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;    psi2(1,4,0) = xi[1]*xi[1]*xi[1]*(c[2]*c[2]) + 2.0*xi[1]*xi[1]*xi[2]*(c[1]*c[2]) + 5.0*xi[1]*xi[1]*xi[2]*(c[2]*c[2]*lamb_p[2]);</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;    psi2(1,5,0) = 2.0*b[1]*c[1]*xi[1]*xi[1]*xi[2] + b[2]*c[2]*xi[1]*xi[1]*(xi[2] - xi[1]) + b[2]*c[2]*xi[1]*xi[1]*(xi[2]- xi[1]) + b[0]*c[0]*xi[1]*xi[1]*xi[2]*(-2.0) - 5.0*xi[1]*xi[1]*xi[2]*(b[2]*c[2]*lamb_p[2]) - 5.0*xi[1]*xi[1]*xi[2]*(b[2]*c[2]*lamb_p[2]);</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;    </div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;    <span class="comment">// compute for the second derivatives wrt area coordinate0 and 1</span></div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;    psi2(1,0,3) = 5.0*4.0*xi[1]*xi[1]*xi[1] + 10.0*3.0*xi[1]*xi[1]*2.0*(xi[2]+xi[0])+ 30.0*2.0*xi[1]*xi[2]*xi[0]*(lamb_p[2])+30.0*2.0*xi[1]*xi[2]*(lamb[0]*xi[2] + lamb_p[2]*xi[0]);</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;    psi2(1,1,3) = 3.0*b[1]*2.0*xi[1]*xi[2]*(xi[2]-xi[0]) + 3.0*b[1]*2.0*xi[1]*xi[2]*xi[0]*(-1.0)+  3.0*xi[1]*xi[1]*(-b[2])*(xi[1] + 4.0*xi[2] + 4.0*xi[0]) + 3.0*xi[1]*xi[1]*(b[0]*xi[2] -b[2]*xi[0])*(4.0) + xi[1]*xi[1]*xi[1]*(-b[2]) + 15*2.0*xi[1]*xi[2]*(b[0]*lamb[0]*xi[2] - b[2]*lamb_p[2]*xi[0])+ 15*2.0*xi[1]*xi[2]*xi[0]*(-b[2]*lamb_p[2]);</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;    psi2(1,2,3) = 3.0*c[1]*2.0*xi[1]*xi[2]*xi[0]  -3.0*c[1]*2.0*xi[1]*xi[2]*(xi[2]-xi[0]) - 3.0*xi[1]*xi[1]*(c[0]*xi[2] - c[2]*xi[0])*(4.0) + 3.0*xi[1]*xi[1]*(c[2])*(xi[1] + 4.0*xi[2] + 4.0*xi[0]) + xi[1]*xi[1]*xi[1]*(c[2])  + 15.0*2.0*xi[1]*xi[2]*xi[0]*(c[2]*lamb_p[2]) - 15.0*2.0*xi[1]*xi[2]*(c[0]*lamb[0]*xi[2] -c[2]*lamb_p[2]*xi[0]);</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;    psi2(1,3,3) = 3.0*xi[1]*xi[1]*(b[2]*b[2]*xi[0]) + 2.0*xi[1]*xi[2]*(-b[2]*b[0]*xi[1] + b[0]*b[1]*xi[2] + b[1]*b[2]*xi[0])+ 2.0*xi[1]*xi[2]*xi[0]*(b[1]*b[2]) + 5.0/2.0*2.0*xi[1]*xi[2]*(b[0]*b[0]*lamb[0]*xi[2] + b[2]*b[2]*lamb_p[2]*xi[0])+ 5.0/2.0*2.0*xi[1]*xi[2]*xi[0]*(b[2]*b[2]*lamb_p[2]) + xi[1]*xi[1]*xi[2]*(-b[2])*b[0];</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;    psi2(1,4,3) = 3.0*xi[1]*xi[1]*(c[2]*c[2]*xi[0]) + 2.0*xi[1]*xi[2]*(-c[2]*c[0]*xi[1] + c[0]*c[1]*xi[2] + c[1]*c[2]*xi[0]) + 2.0*xi[1]*xi[2]*xi[0]*(c[1]*c[2])+ 5.0/2.0*2.0*xi[1]*xi[2]*(c[0]*c[0]*lamb[0]*xi[2] + c[2]*c[2]*lamb_p[2]*xi[0])+ 5.0/2.0*2.0*xi[1]*xi[2]*xi[0]*(c[2]*c[2]*lamb_p[2])+ xi[1]*xi[1]*xi[2]*(-c[2])*c[0];</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;    psi2(1,5,3) = b[1]*c[1]*2.0*xi[1]*xi[2]*xi[0] + b[1]*c[1]*2.0*xi[1]*xi[2]*(xi[1] + xi[2] + xi[0]) + b[1]*c[1]*xi[1]*xi[1]*xi[2] + b[2]*c[2]*2.0*xi[1]*(xi[2]*xi[0] - xi[0]*xi[1] - xi[1]*xi[2] - xi[2]*xi[2]) + b[2]*c[2]*2.0*xi[1]*xi[0]*(xi[2]- xi[1]) + b[2]*c[2]*xi[1]*xi[1]*(-xi[2] - xi[0])+ b[2]*c[2]*xi[1]*xi[1]*xi[0]*(-1.0)</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;     + b[0]*c[0]*2.0*xi[1]*xi[2]*(xi[2]-xi[1]- 2.0*xi[0]) + b[0]*c[0]*xi[1]*xi[1]*xi[2]*(-1.0)- 5.0*2.0*xi[1]*xi[2]*(b[2]*c[2]*lamb_p[2]*xi[0] + b[0]*c[0]*lamb[0]*xi[2]) - 5.0*2.0*xi[1]*xi[2]*xi[0]*(b[2]*c[2]*lamb_p[2]);</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;   </div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;    <span class="comment">// compute for the second derivatives wrt area coordinate0 and 2</span></div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;    psi2(1,0,4) = 10.0*xi[1]*xi[1]*xi[1]*2.0 + 30.0*xi[1]*xi[1]*(lamb[0]*xi[2] + lamb_p[2]*xi[0])  +30.0*xi[1]*xi[1]*xi[0]*(lamb_p[2]) + 30.0*xi[1]*xi[1]*xi[2]*(lamb[0]);</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;    psi2(1,1,4) = 3.0*b[1]*xi[1]*xi[1]*(xi[2]-xi[0]) + 3.0*b[1]*xi[1]*xi[1]*xi[0]*(-1.0)+ 3.0*b[1]*xi[1]*xi[1]*xi[2] +  xi[1]*xi[1]*xi[1]*(-b[2])*(4.0)+  xi[1]*xi[1]*xi[1]*(b[0])*(4.0)  + 15*xi[1]*xi[1]*(b[0]*lamb[0]*xi[2] - b[2]*lamb_p[2]*xi[0]) + 15*xi[1]*xi[1]*xi[0]*(-b[2]*lamb_p[2]) + 15*xi[1]*xi[1]*xi[2]*(b[0]*lamb[0]);</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;    psi2(1,2,4) = 3.0*c[1]*xi[1]*xi[1]*xi[0]  - 3.0*c[1]*xi[1]*xi[1]*(xi[2]-xi[0]) - 3.0*c[1]*xi[1]*xi[1]*xi[2] - xi[1]*xi[1]*xi[1]*(c[0])*(4.0) + 4.0*xi[1]*xi[1]*xi[1]*(c[2]) + 15.0*xi[1]*xi[1]*xi[0]*(c[2]*lamb_p[2]) - 15.0*xi[1]*xi[1]*(c[0]*lamb[0]*xi[2] -c[2]*lamb_p[2]*xi[0]) -15.0*xi[1]*xi[1]*xi[2]*(c[0]*lamb[0]);</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;    psi2(1,3,4) =  xi[1]*xi[1]*xi[0]*(b[1]*b[2]) + xi[1]*xi[1]*(-b[2]*b[0]*xi[1] + b[0]*b[1]*xi[2] + b[1]*b[2]*xi[0]) + xi[1]*xi[1]*xi[2]*(b[0]*b[1]) + 5.0/2.0*xi[1]*xi[1]*xi[0]*(b[2]*b[2]*lamb_p[2]) + 5.0/2.0*xi[1]*xi[1]*(b[0]*b[0]*lamb[0]*xi[2] + b[2]*b[2]*lamb_p[2]*xi[0]) + 5.0/2.0*xi[1]*xi[1]*xi[2]*(b[0]*b[0]*lamb[0]);</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;    psi2(1,4,4) =  xi[1]*xi[1]*xi[2]*(c[0]*c[1]) + xi[1]*xi[1]*(-c[2]*c[0]*xi[1] + c[0]*c[1]*xi[2] + c[1]*c[2]*xi[0])+ xi[1]*xi[1]*xi[0]*(c[1]*c[2]) + 5.0/2.0*xi[1]*xi[1]*xi[2]*(c[0]*c[0]*lamb[0]) + 5.0/2.0*xi[1]*xi[1]*(c[0]*c[0]*lamb[0]*xi[2] + c[2]*c[2]*lamb_p[2]*xi[0]) + 5.0/2.0*xi[1]*xi[1]*xi[0]*(c[2]*c[2]*lamb_p[2]);</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;    psi2(1,5,4) = b[1]*c[1]*xi[1]*xi[1]*xi[2]+ b[1]*c[1]*xi[1]*xi[1]*(xi[1] + xi[2] + xi[0]) + b[1]*c[1]*xi[1]*xi[1]*xi[0] + b[2]*c[2]*xi[1]*xi[1]*(xi[0] - xi[1] - 2.0*xi[2]) + b[2]*c[2]*xi[1]*xi[1]*xi[0] + b[0]*c[0]*xi[1]*xi[1]*xi[2] + b[0]*c[0]*xi[1]*xi[1]*(xi[2]- xi[1] - 2.0*xi[0]) - 5.0*xi[1]*xi[1]*xi[2]*(b[0]*c[0]*lamb[0])- 5.0*xi[1]*xi[1]*(b[2]*c[2]*lamb_p[2]*xi[0] + b[0]*c[0]*lamb[0]*xi[2]) - 5.0*xi[1]*xi[1]*xi[0]*(b[2]*c[2]*lamb_p[2]);</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;  </div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;    <span class="comment">// compute for the second derivatives wrt area coordinate1 and 2</span></div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;    psi2(1,0,5) = 5.0*4.0*xi[1]*xi[1]*xi[1] + 10.0*3.0*xi[1]*xi[1]*2.0*(xi[2]+xi[0]) +30.0*2.0*xi[1]*xi[0]*(lamb[0]*xi[2] + lamb_p[2]*xi[0]) + 30.0*2.0*xi[1]*xi[2]*xi[0]*(lamb[0]);</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;    psi2(1,1,5) = 3.0*b[1]*2.0*xi[1]*xi[0]*(xi[2]-xi[0])+ 3.0*b[1]*2.0*xi[1]*xi[2]*xi[0] +  3.0*xi[1]*xi[1]*(b[0])*(xi[1] + 4.0*xi[2] + 4.0*xi[0]) + 3.0*xi[1]*xi[1]*(b[0]*xi[2] -b[2]*xi[0])*(4.0) + xi[1]*xi[1]*xi[1]*(b[0])+ 15*2.0*xi[1]*xi[0]*(b[0]*lamb[0]*xi[2] - b[2]*lamb_p[2]*xi[0]) + 15*2.0*xi[1]*xi[2]*xi[0]*(b[0]*lamb[0]);</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;    psi2(1,2,5) = -3.0*c[1]*2.0*xi[1]*xi[0]*(xi[2]-xi[0]) -3.0*c[1]*2.0*xi[1]*xi[2]*xi[0] - 3.0*xi[1]*xi[1]*(c[0])*(xi[1] + 4.0*xi[2] + 4.0*xi[0]) - 3.0*xi[1]*xi[1]*(c[0]*xi[2] -c[2]*xi[0])*(4.0) - xi[1]*xi[1]*xi[1]*(c[0]) -15.0*2.0*xi[1]*xi[0]*(c[0]*lamb[0]*xi[2] -c[2]*lamb_p[2]*xi[0]) -15.0*2.0*xi[1]*xi[2]*xi[0]*(c[0]*lamb[0]);</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;    psi2(1,3,5) = 3.0*xi[1]*xi[1]*(b[0]*b[0]*xi[2]) + 2.0*xi[1]*xi[0]*(-b[2]*b[0]*xi[1] + b[0]*b[1]*xi[2] + b[1]*b[2]*xi[0]) + 2.0*xi[1]*xi[2]*xi[0]*(b[0]*b[1]) + 5.0/2.0*2.0*xi[1]*xi[0]*(b[0]*b[0]*lamb[0]*xi[2] + b[2]*b[2]*lamb_p[2]*xi[0])+ 5.0/2.0*2.0*xi[1]*xi[2]*xi[0]*(b[0]*b[0]*lamb[0]) + xi[1]*xi[1]*xi[0]*(-b[2])*b[0];</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;    psi2(1,4,5) = 3.0*xi[1]*xi[1]*(c[0]*c[0]*xi[2]) + 2.0*xi[1]*xi[0]*(-c[2]*c[0]*xi[1] + c[0]*c[1]*xi[2] + c[1]*c[2]*xi[0]) + 2.0*xi[1]*xi[2]*xi[0]*(c[0]*c[1]) + 5.0/2.0*2.0*xi[1]*xi[0]*(c[0]*c[0]*lamb[0]*xi[2] + c[2]*c[2]*lamb_p[2]*xi[0])+ 5.0/2.0*2.0*xi[1]*xi[2]*xi[0]*(c[0]*c[0]*lamb[0])+ xi[1]*xi[1]*xi[0]*(-c[2])*c[0];</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;    psi2(1,5,5) = b[1]*c[1]*2.0*xi[1]*xi[0]*(xi[1] + xi[2] + xi[0]) + b[1]*c[1]*2.0*xi[1]*xi[2]*xi[0] + b[1]*c[1]*xi[1]*xi[1]*xi[0] + b[2]*c[2]*2.0*xi[1]*xi[0]*(xi[0] - xi[1] - 2.0*xi[2]) + b[2]*c[2]*xi[1]*xi[1]*xi[0]*(-1.0) + b[0]*c[0]*2.0*xi[1]*(xi[2]*xi[0] - xi[0]*xi[1] -xi[1]*xi[2] - xi[0]*xi[0]) + b[0]*c[0]*2.0*xi[1]*xi[2]*(xi[0] -xi[1]) + b[0]*c[0]*xi[1]*xi[1]*(- xi[0]-xi[2]) + b[0]*c[0]*xi[1]*xi[1]*xi[2]*(-1.0) - 5.0*2.0*xi[1]*xi[0]*(b[2]*c[2]*lamb_p[2]*xi[0] + b[0]*c[0]*lamb[0]*xi[2]) - 5.0*2.0*xi[1]*xi[2]*xi[0]*(b[0]*c[0]*lamb[0]);</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;  </div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;    <span class="comment">// by chain rule, we can obtain d2shape wrt s0s0 at node1</span></div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;    d2psids(1,0,0) = (psi2(1,0,0)*dxids0[0] + psi2(1,0,3)*dxids0[1] + psi2(1,0,4)*dxids0[2])*dxids0[0] + </div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;                     (psi2(1,0,3)*dxids0[0] + psi2(1,0,1)*dxids0[1] + psi2(1,0,5)*dxids0[2])*dxids0[1] + </div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;                     (psi2(1,0,4)*dxids0[0] + psi2(1,0,5)*dxids0[1] + psi2(1,0,2)*dxids0[2])*dxids0[2];</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;    d2psids(1,1,0) = (psi2(1,1,0)*dxids0[0] + psi2(1,1,3)*dxids0[1] + psi2(1,1,4)*dxids0[2])*dxids0[0] + </div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;                     (psi2(1,1,3)*dxids0[0] + psi2(1,1,1)*dxids0[1] + psi2(1,1,5)*dxids0[2])*dxids0[1] + </div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;                     (psi2(1,1,4)*dxids0[0] + psi2(1,1,5)*dxids0[1] + psi2(1,1,2)*dxids0[2])*dxids0[2];</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;    d2psids(1,2,0) = (psi2(1,2,0)*dxids0[0] + psi2(1,2,3)*dxids0[1] + psi2(1,2,4)*dxids0[2])*dxids0[0] + </div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;                     (psi2(1,2,3)*dxids0[0] + psi2(1,2,1)*dxids0[1] + psi2(1,2,5)*dxids0[2])*dxids0[1] + </div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;                     (psi2(1,2,4)*dxids0[0] + psi2(1,2,5)*dxids0[1] + psi2(1,2,2)*dxids0[2])*dxids0[2];</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;    d2psids(1,3,0) = (psi2(1,3,0)*dxids0[0] + psi2(1,3,3)*dxids0[1] + psi2(1,3,4)*dxids0[2])*dxids0[0] + </div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;                     (psi2(1,3,3)*dxids0[0] + psi2(1,3,1)*dxids0[1] + psi2(1,3,5)*dxids0[2])*dxids0[1] + </div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;                     (psi2(1,3,4)*dxids0[0] + psi2(1,3,5)*dxids0[1] + psi2(1,3,2)*dxids0[2])*dxids0[2];</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;    d2psids(1,4,0) = (psi2(1,4,0)*dxids0[0] + psi2(1,4,3)*dxids0[1] + psi2(1,4,4)*dxids0[2])*dxids0[0] + </div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;                     (psi2(1,4,3)*dxids0[0] + psi2(1,4,1)*dxids0[1] + psi2(1,4,5)*dxids0[2])*dxids0[1] + </div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;                     (psi2(1,4,4)*dxids0[0] + psi2(1,4,5)*dxids0[1] + psi2(1,4,2)*dxids0[2])*dxids0[2];</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;    d2psids(1,5,0) = (psi2(1,5,0)*dxids0[0] + psi2(1,5,3)*dxids0[1] + psi2(1,5,4)*dxids0[2])*dxids0[0] + </div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;                     (psi2(1,5,3)*dxids0[0] + psi2(1,5,1)*dxids0[1] + psi2(1,5,5)*dxids0[2])*dxids0[1] + </div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;                     (psi2(1,5,4)*dxids0[0] + psi2(1,5,5)*dxids0[1] + psi2(1,5,2)*dxids0[2])*dxids0[2];</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;                     </div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;    <span class="comment">// by chain rule, we can obtain d2shape wrt s1s1 at node1</span></div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;    d2psids(1,0,1) = (psi2(1,0,0)*dxids1[0] + psi2(1,0,3)*dxids1[1] + psi2(1,0,4)*dxids1[2])*dxids1[0] + </div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;                     (psi2(1,0,3)*dxids1[0] + psi2(1,0,1)*dxids1[1] + psi2(1,0,5)*dxids1[2])*dxids1[1] + </div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;                     (psi2(1,0,4)*dxids1[0] + psi2(1,0,5)*dxids1[1] + psi2(1,0,2)*dxids1[2])*dxids1[2];</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;    d2psids(1,1,1) = (psi2(1,1,0)*dxids1[0] + psi2(1,1,3)*dxids1[1] + psi2(1,1,4)*dxids1[2])*dxids1[0] + </div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;                     (psi2(1,1,3)*dxids1[0] + psi2(1,1,1)*dxids1[1] + psi2(1,1,5)*dxids1[2])*dxids1[1] + </div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;                     (psi2(1,1,4)*dxids1[0] + psi2(1,1,5)*dxids1[1] + psi2(1,1,2)*dxids1[2])*dxids1[2];</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;    d2psids(1,2,1) = (psi2(1,2,0)*dxids1[0] + psi2(1,2,3)*dxids1[1] + psi2(1,2,4)*dxids1[2])*dxids1[0] + </div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;                     (psi2(1,2,3)*dxids1[0] + psi2(1,2,1)*dxids1[1] + psi2(1,2,5)*dxids1[2])*dxids1[1] + </div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;                     (psi2(1,2,4)*dxids1[0] + psi2(1,2,5)*dxids1[1] + psi2(1,2,2)*dxids1[2])*dxids1[2];</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;    d2psids(1,3,1) = (psi2(1,3,0)*dxids1[0] + psi2(1,3,3)*dxids1[1] + psi2(1,3,4)*dxids1[2])*dxids1[0] + </div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;                     (psi2(1,3,3)*dxids1[0] + psi2(1,3,1)*dxids1[1] + psi2(1,3,5)*dxids1[2])*dxids1[1] + </div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;                     (psi2(1,3,4)*dxids1[0] + psi2(1,3,5)*dxids1[1] + psi2(1,3,2)*dxids1[2])*dxids1[2];</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;    d2psids(1,4,1) = (psi2(1,4,0)*dxids1[0] + psi2(1,4,3)*dxids1[1] + psi2(1,4,4)*dxids1[2])*dxids1[0] + </div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;                     (psi2(1,4,3)*dxids1[0] + psi2(1,4,1)*dxids1[1] + psi2(1,4,5)*dxids1[2])*dxids1[1] + </div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;                     (psi2(1,4,4)*dxids1[0] + psi2(1,4,5)*dxids1[1] + psi2(1,4,2)*dxids1[2])*dxids1[2];</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;    d2psids(1,5,1) = (psi2(1,5,0)*dxids1[0] + psi2(1,5,3)*dxids1[1] + psi2(1,5,4)*dxids1[2])*dxids1[0] + </div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;                     (psi2(1,5,3)*dxids1[0] + psi2(1,5,1)*dxids1[1] + psi2(1,5,5)*dxids1[2])*dxids1[1] + </div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;                     (psi2(1,5,4)*dxids1[0] + psi2(1,5,5)*dxids1[1] + psi2(1,5,2)*dxids1[2])*dxids1[2];</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;    </div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;    <span class="comment">// by chain rule, we can obtain d2shape wrt s0s1 at node1</span></div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;    d2psids(1,0,2) = (psi2(1,0,0)*dxids0[0] + psi2(1,0,3)*dxids0[1] + psi2(1,0,4)*dxids0[2])*dxids1[0] + </div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;                     (psi2(1,0,3)*dxids0[0] + psi2(1,0,1)*dxids0[1] + psi2(1,0,5)*dxids0[2])*dxids1[1] + </div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;                     (psi2(1,0,4)*dxids0[0] + psi2(1,0,5)*dxids0[1] + psi2(1,0,2)*dxids0[2])*dxids1[2];</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;    d2psids(1,1,2) = (psi2(1,1,0)*dxids0[0] + psi2(1,1,3)*dxids0[1] + psi2(1,1,4)*dxids0[2])*dxids1[0] + </div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;                     (psi2(1,1,3)*dxids0[0] + psi2(1,1,1)*dxids0[1] + psi2(1,1,5)*dxids0[2])*dxids1[1] + </div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;                     (psi2(1,1,4)*dxids0[0] + psi2(1,1,5)*dxids0[1] + psi2(1,1,2)*dxids0[2])*dxids1[2];</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;    d2psids(1,2,2) = (psi2(1,2,0)*dxids0[0] + psi2(1,2,3)*dxids0[1] + psi2(1,2,4)*dxids0[2])*dxids1[0] + </div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;                     (psi2(1,2,3)*dxids0[0] + psi2(1,2,1)*dxids0[1] + psi2(1,2,5)*dxids0[2])*dxids1[1] + </div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;                     (psi2(1,2,4)*dxids0[0] + psi2(1,2,5)*dxids0[1] + psi2(1,2,2)*dxids0[2])*dxids1[2];</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;    d2psids(1,3,2) = (psi2(1,3,0)*dxids0[0] + psi2(1,3,3)*dxids0[1] + psi2(1,3,4)*dxids0[2])*dxids1[0] + </div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;                     (psi2(1,3,3)*dxids0[0] + psi2(1,3,1)*dxids0[1] + psi2(1,3,5)*dxids0[2])*dxids1[1] + </div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;                     (psi2(1,3,4)*dxids0[0] + psi2(1,3,5)*dxids0[1] + psi2(1,3,2)*dxids0[2])*dxids1[2];</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;    d2psids(1,4,2) = (psi2(1,4,0)*dxids0[0] + psi2(1,4,3)*dxids0[1] + psi2(1,4,4)*dxids0[2])*dxids1[0] + </div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;                     (psi2(1,4,3)*dxids0[0] + psi2(1,4,1)*dxids0[1] + psi2(1,4,5)*dxids0[2])*dxids1[1] + </div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;                     (psi2(1,4,4)*dxids0[0] + psi2(1,4,5)*dxids0[1] + psi2(1,4,2)*dxids0[2])*dxids1[2];</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;    d2psids(1,5,2) = (psi2(1,5,0)*dxids0[0] + psi2(1,5,3)*dxids0[1] + psi2(1,5,4)*dxids0[2])*dxids1[0] + </div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;                     (psi2(1,5,3)*dxids0[0] + psi2(1,5,1)*dxids0[1] + psi2(1,5,5)*dxids0[2])*dxids1[1] + </div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;                     (psi2(1,5,4)*dxids0[0] + psi2(1,5,5)*dxids0[1] + psi2(1,5,2)*dxids0[2])*dxids1[2];</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;    <span class="comment">//-------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;    <span class="comment">// compute for all second derivatives at node 2</span></div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;    <span class="comment">//------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;    <span class="comment">// compute for the second derivatives wrt area coordinate2</span></div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;    psi2(2,0,2) = 5.0*4.0*xi[2]*xi[2]*xi[2] +5.0*4.0*3.0*xi[2]*xi[2]*(xi[0]+xi[1]) + 10.0*3.0*2.0*xi[2]*(xi[0]+xi[1])*(xi[0]+xi[1]) + 30.0*2.0*xi[0]*xi[1]*(lamb[1]*xi[0] + lamb_p[0]*xi[1]);</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;    psi2(2,1,2) =  3.0*b[2]*2.0*xi[0]*xi[1]*(xi[0]-xi[1]) +  6.0*xi[2]*xi[2]*(b[1]*xi[0] - b[0]*xi[1]) + 30.0*xi[0]*xi[1]*(b[1]*lamb[1]*xi[0] - b[0]*lamb_p[0]*xi[1]) +  3.0*2.0*xi[2]*(b[1]*xi[0] -b[0]*xi[1])*(xi[2] + 4.0*xi[0] + 4*xi[1]);</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;    psi2(2,2,2) = -3.0*c[2]*2.0*xi[0]*xi[1]*(xi[0]-xi[1]) - 3.0*2.0*xi[2]*(c[1]*xi[0] -c[0]*xi[1])*(xi[2] + 4.0*xi[0] + 4.0*xi[1]) - 6.0*xi[2]*xi[2]*(c[1]*xi[0] -c[0]*xi[1]) -15.0*2.0*xi[0]*xi[1]*(c[1]*lamb[1]*xi[0] -c[0]*lamb_p[0]*xi[1]);</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;    psi2(2,3,2) = 1.0/2.0*3.0*2.0*xi[2]*(b[1]*b[1]*xi[0]*xi[0] + b[0]*b[0]*xi[1]*xi[1]) + 2.0*xi[0]*xi[1]*(-b[0]*b[1]*xi[2] + b[1]*b[2]*xi[0] + b[2]*b[0]*xi[1]) + 2.0*xi[2]*xi[0]*xi[1]*(-b[0]*b[1])</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;     + 5.0/2.0*2.0*xi[0]*xi[1]*(b[1]*b[1]*lamb[1]*xi[0] + b[0]*b[0]*lamb_p[0]*xi[1]) + 2.0*xi[2]*xi[0]*xi[1]*(-b[0])*b[1];</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;    psi2(2,4,2) = 1.0/2.0*3.0*2.0*xi[2]*(c[1]*c[1]*xi[0]*xi[0] + c[0]*c[0]*xi[1]*xi[1]) + 2.0*xi[0]*xi[1]*(-c[0]*c[1]*xi[2] + c[1]*c[2]*xi[0] + c[2]*c[0]*xi[1]) + 2.0*xi[2]*xi[0]*xi[1]*(-c[0]*c[1])</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;     + 5.0/2.0*2.0*xi[0]*xi[1]*(c[1]*c[1]*lamb[1]*xi[0] + c[0]*c[0]*lamb_p[0]*xi[1])+ 2.0*xi[2]*xi[0]*xi[1]*(-c[0])*c[1];</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;    psi2(2,5,2) = b[2]*c[2]*2.0*xi[0]*xi[1]*(xi[2] + xi[0] + xi[1]) + b[2]*c[2]*2.0*xi[2]*xi[0]*xi[1] + b[2]*c[2]*2.0*xi[2]*xi[0]*xi[1] + b[0]*c[0]*2.0*xi[1]*(xi[0]*xi[1] - xi[1]*xi[2] - xi[2]*xi[0] - xi[0]*xi[0]) + b[0]*c[0]*2.0*xi[2]*xi[1]*(-1.0*xi[1] - 1.0*xi[0]) + b[0]*c[0]*2.0*xi[2]*xi[1]*(-xi[0] - xi[1])</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;     + b[1]*c[1]*2.0*xi[0]*(xi[0]*xi[1] - xi[1]*xi[2] -xi[2]*xi[0] - xi[1]*xi[1]) + b[1]*c[1]*2.0*xi[2]*xi[0]*(-xi[1] -xi[0])+ b[1]*c[1]*2.0*xi[2]*xi[0]*(- xi[1]-xi[0]) - 5.0*2.0*xi[0]*xi[1]*(b[0]*c[0]*lamb_p[0]*xi[1] + b[1]*c[1]*lamb[1]*xi[0]);</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;     </div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;    <span class="comment">// compute for the second derivatives wrt area coordinate0</span></div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;    psi2(2,0,0) = 10.0*xi[2]*xi[2]*xi[2]*2.0 + 60.0*xi[2]*xi[2]*xi[1]*(lamb[1]);</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;    psi2(2,1,0) = 6.0*b[2]*xi[2]*xi[2]*xi[1] +  xi[2]*xi[2]*xi[2]*(b[1])*(8.0)   + 30*xi[2]*xi[2]*xi[1]*(b[1]*lamb[1]);</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;    psi2(2,2,0) =-6.0*c[2]*xi[2]*xi[2]*xi[1] -  xi[2]*xi[2]*xi[2]*(c[1])*(8.0)   - 30.0*xi[2]*xi[2]*xi[1]*(c[1]*lamb[1]);</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;    psi2(2,3,0) = 1.0/2.0*xi[2]*xi[2]*xi[2]*(b[1]*b[1]*2.0) + xi[2]*xi[2]*xi[1]*(b[1]*b[2]) + xi[2]*xi[2]*xi[1]*(b[1]*b[2])  + 5.0/2.0*xi[2]*xi[2]*xi[1]*(b[1]*b[1]*lamb[1]) + 5.0/2.0*xi[2]*xi[2]*xi[1]*(b[1]*b[1]*lamb[1]);</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;    psi2(2,4,0) = 1.0/2.0*xi[2]*xi[2]*xi[2]*(c[1]*c[1]*2.0) + xi[2]*xi[2]*xi[1]*( c[1]*c[2]) + xi[2]*xi[2]*xi[1]*(c[1]*c[2])+ 5.0/2.0*xi[2]*xi[2]*xi[1]*(c[1]*c[1]*lamb[1])  + 5.0/2.0*xi[2]*xi[2]*xi[1]*(c[1]*c[1]*lamb[1]);</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;    psi2(2,5,0) = b[2]*c[2]*xi[2]*xi[2]*xi[1] + b[2]*c[2]*xi[2]*xi[2]*xi[1] + b[0]*c[0]*xi[2]*xi[2]*xi[1]*(-2.0)</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;     + b[1]*c[1]*xi[2]*xi[2]*(xi[1] -xi[2]) + b[1]*c[1]*xi[2]*xi[2]*(xi[1] -xi[2]) - 5.0*xi[2]*xi[2]*xi[1]*( b[1]*c[1]*lamb[1]) - 5.0*xi[2]*xi[2]*xi[1]*(b[1]*c[1]*lamb[1]);</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;     </div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;    <span class="comment">// compute for the second derivatives wrt area coordinate1</span></div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;    psi2(2,0,1) = 10.0*xi[2]*xi[2]*xi[2]*2.0 +30.0*xi[2]*xi[2]*xi[0]*(lamb_p[0])  +30.0*xi[2]*xi[2]*xi[0]*(lamb_p[0]);</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;    psi2(2,1,1) = -30.0*b[0]*lamb_p[0]*xi[0]*xi[2]*xi[2] - 6.0*b[2]*xi[2]*xi[2]*xi[0] -  xi[2]*xi[2]*xi[2]*(b[0])*(8.0);</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;    psi2(2,2,1) =  6.0*c[2]*xi[2]*xi[2]*xi[0] + xi[2]*xi[2]*xi[2]*(c[0])*(8.0)  + 30.0*xi[2]*xi[2]*xi[0]*(c[0]*lamb_p[0]);</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;    psi2(2,3,1) = 1.0/2.0*xi[2]*xi[2]*xi[2]*(b[0]*b[0]*2.0) + xi[2]*xi[2]*xi[0]*( b[2]*b[0]) + xi[2]*xi[2]*xi[0]*(b[2]*b[0]) + 5.0/2.0*xi[2]*xi[2]*xi[0]*( b[0]*b[0]*lamb_p[0])+ 5.0/2.0*xi[2]*xi[2]*xi[0]*(b[0]*b[0]*lamb_p[0]);</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;    psi2(2,4,1) = 1.0/2.0*xi[2]*xi[2]*xi[2]*(c[0]*c[0]*2.0) + xi[2]*xi[2]*xi[0]*(c[2]*c[0]) + xi[2]*xi[2]*xi[0]*(c[2]*c[0])  + 5.0/2.0*xi[2]*xi[2]*xi[0]*(c[0]*c[0]*lamb_p[0]) + 5.0/2.0*xi[2]*xi[2]*xi[0]*(c[0]*c[0]*lamb_p[0]);</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;    psi2(2,5,1) = b[2]*c[2]*xi[2]*xi[2]*xi[0] + b[2]*c[2]*xi[2]*xi[2]*xi[0] + b[0]*c[0]*xi[2]*xi[2]*(xi[0] - xi[2]) + b[0]*c[0]*xi[2]*xi[2]*(xi[0]- xi[2]) + b[1]*c[1]*xi[2]*xi[2]*xi[0]*(-2.0) - 5.0*xi[2]*xi[2]*xi[0]*(b[0]*c[0]*lamb_p[0]) - 5.0*xi[2]*xi[2]*xi[0]*(b[0]*c[0]*lamb_p[0]);</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;      </div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;    <span class="comment">// compute for the second derivatives wrt area coordinate0 and 1</span></div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;    psi2(2,0,3) = 10.0*xi[2]*xi[2]*xi[2]*2.0 + 30.0*xi[2]*xi[2]*(lamb[1]*xi[0] + lamb_p[0]*xi[1]) + 30.0*xi[2]*xi[2]*xi[0]*(lamb[1]) + 30.0*xi[2]*xi[2]*xi[1]*(lamb_p[0]);</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;    psi2(2,1,3) = 3.0*b[2]*xi[2]*xi[2]*(xi[0]-xi[1])-3.0*b[2]*xi[2]*xi[2]*xi[1] + 3.0*b[2]*xi[2]*xi[2]*xi[0] +  xi[2]*xi[2]*xi[2]*(b[1])*(4.0)+  xi[2]*xi[2]*xi[2]*(-b[0])*(4.0) + 15*xi[2]*xi[2]*(b[1]*lamb[1]*xi[0] - b[0]*lamb_p[0]*xi[1]) + 15*xi[2]*xi[2]*xi[1]*(-b[0]*lamb_p[0]) + 15*xi[2]*xi[2]*xi[0]*(b[1]*lamb[1]);</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;    psi2(2,2,3) =  -3.0*c[2]*xi[2]*xi[2]*xi[0] + -3.0*c[2]*xi[2]*xi[2]*(xi[0]-xi[1])+ 3.0*c[2]*xi[2]*xi[2]*xi[1] + xi[2]*xi[2]*xi[2]*(c[0])*(4.0) - xi[2]*xi[2]*xi[2]*(c[1])*(4.0) - 15.0*xi[2]*xi[2]*xi[0]*(c[1]*lamb[1]) - 15.0*xi[2]*xi[2]*(c[1]*lamb[1]*xi[0] -c[0]*lamb_p[0]*xi[1]) + 15.0*xi[2]*xi[2]*xi[1]*(c[0]*lamb_p[0]);</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;    psi2(2,3,3) =  xi[2]*xi[2]*xi[0]*(b[1]*b[2])  + xi[2]*xi[2]*(-b[0]*b[1]*xi[2] + b[1]*b[2]*xi[0] + b[2]*b[0]*xi[1]) + xi[2]*xi[2]*xi[1]*(b[2]*b[0]) + 5.0/2.0*xi[2]*xi[2]*xi[0]*(b[1]*b[1]*lamb[1]) + 5.0/2.0*xi[2]*xi[2]*(b[1]*b[1]*lamb[1]*xi[0] + b[0]*b[0]*lamb_p[0]*xi[1]) + 5.0/2.0*xi[2]*xi[2]*xi[1]*( b[0]*b[0]*lamb_p[0]);</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;    psi2(2,4,3) =  xi[2]*xi[2]*xi[0]*(c[1]*c[2]) + xi[2]*xi[2]*(-c[0]*c[1]*xi[2] + c[1]*c[2]*xi[0] + c[2]*c[0]*xi[1]) + xi[2]*xi[2]*xi[1]*(c[2]*c[0])+ 5.0/2.0*xi[2]*xi[2]*xi[0]*(c[1]*c[1]*lamb[1])  + 5.0/2.0*xi[2]*xi[2]*(c[1]*c[1]*lamb[1]*xi[0] + c[0]*c[0]*lamb_p[0]*xi[1]) + 5.0/2.0*xi[2]*xi[2]*xi[1]*(c[0]*c[0]*lamb_p[0]);</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;    psi2(2,5,3) = b[2]*c[2]*xi[2]*xi[2]*xi[0] + b[2]*c[2]*xi[2]*xi[2]*(xi[2] + xi[0] + xi[1])+ b[2]*c[2]*xi[2]*xi[2]*xi[1] + b[0]*c[0]*xi[2]*xi[2]*(xi[1] - xi[2] - 2.0*xi[0])+ b[0]*c[0]*xi[2]*xi[2]*xi[1] + b[1]*c[1]*xi[2]*xi[2]*xi[0] + b[1]*c[1]*xi[2]*xi[2]*(xi[0] - xi[2] - 2.0*xi[1]) - 5.0*xi[2]*xi[2]*xi[0]*( b[1]*c[1]*lamb[1]) - 5.0*xi[2]*xi[2]*(b[0]*c[0]*lamb_p[0]*xi[1] + b[1]*c[1]*lamb[1]*xi[0]) - 5.0*xi[2]*xi[2]*xi[1]*(b[0]*c[0]*lamb_p[0]);</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;    </div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;    <span class="comment">// compute for the second derivatives wrt area coordinate0 and 2</span></div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;    psi2(2,0,4) = 5.0*4.0*xi[2]*xi[2]*xi[2] + 10.0*3.0*xi[2]*xi[2]*2.0*(xi[0]+xi[1]) + 30.0*2.0*xi[2]*xi[1]*(lamb[1]*xi[0] + lamb_p[0]*xi[1]) + 30.0*2.0*xi[2]*xi[0]*xi[1]*(lamb[1]);</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;    psi2(2,1,4) = 3.0*b[2]*2.0*xi[2]*xi[1]*(xi[0]-xi[1]) + 3.0*b[2]*2.0*xi[2]*xi[0]*xi[1] +  3.0*xi[2]*xi[2]*(b[1])*(xi[2] + 4.0*xi[0] + 4.0*xi[1])+  xi[2]*xi[2]*xi[2]*(b[1]) + 12.0*xi[2]*xi[2]*(b[1]*xi[0] - b[0]*xi[1]) + 15*2.0*xi[2]*xi[1]*(b[1]*lamb[1]*xi[0] - b[0]*lamb_p[0]*xi[1]) + 15*2.0*xi[2]*xi[0]*xi[1]*(b[1]*lamb[1]);</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;    psi2(2,2,4) = -3.0*c[2]*2.0*xi[2]*xi[1]*(xi[0]-xi[1]) -3.0*c[2]*2.0*xi[2]*xi[0]*xi[1] - 3.0*xi[2]*xi[2]*(c[1])*(xi[2] + 4.0*xi[0] + 4.0*xi[1]) - 3.0*xi[2]*xi[2]*(c[1]*xi[0] -c[0]*xi[1])*(4.0) - xi[2]*xi[2]*xi[2]*(c[1]) -15.0*2.0*xi[2]*xi[1]*(c[1]*lamb[1]*xi[0] -c[0]*lamb_p[0]*xi[1]) -15.0*2.0*xi[2]*xi[0]*xi[1]*(c[1]*lamb[1]);</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;    psi2(2,3,4) = 1.0/2.0*3.0*xi[2]*xi[2]*(b[1]*b[1]*2.0*xi[0]) + 2.0*xi[2]*xi[1]*(-b[0]*b[1]*xi[2] + b[1]*b[2]*xi[0] + b[2]*b[0]*xi[1]) + 2.0*xi[2]*xi[0]*xi[1]*(b[1]*b[2])</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;     + 5.0/2.0*2.0*xi[2]*xi[1]*(b[1]*b[1]*lamb[1]*xi[0] + b[0]*b[0]*lamb_p[0]*xi[1])+ 5.0/2.0*2.0*xi[2]*xi[0]*xi[1]*(b[1]*b[1]*lamb[1]) + xi[2]*xi[2]*xi[1]*(-b[0])*b[1];</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;    psi2(2,4,4) = 1.0/2.0*3.0*xi[2]*xi[2]*(c[1]*c[1]*2.0*xi[0]) + 2.0*xi[2]*xi[1]*(-c[0]*c[1]*xi[2] + c[1]*c[2]*xi[0] + c[2]*c[0]*xi[1]) + 2.0*xi[2]*xi[0]*xi[1]*(c[1]*c[2])</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;     + 5.0/2.0*2.0*xi[2]*xi[1]*(c[1]*c[1]*lamb[1]*xi[0] + c[0]*c[0]*lamb_p[0]*xi[1])+ 5.0/2.0*2.0*xi[2]*xi[0]*xi[1]*(c[1]*c[1]*lamb[1])+ xi[2]*xi[2]*xi[1]*(-c[0])*c[1];</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;    psi2(2,5,4) = b[2]*c[2]*2.0*xi[2]*xi[1]*(xi[2] + xi[0] + xi[1]) + b[2]*c[2]*2.0*xi[2]*xi[0]*xi[1] + b[2]*c[2]*xi[2]*xi[2]*xi[1] + b[0]*c[0]*2.0*xi[2]*xi[1]*(xi[1] - xi[2] - 2.0*xi[0]) + b[0]*c[0]*xi[2]*xi[2]*xi[1]*(-1.0) + b[1]*c[1]*2.0*xi[2]*(xi[0]*xi[1] - xi[1]*xi[2] -xi[2]*xi[0] - xi[1]*xi[1])+ b[1]*c[1]*2.0*xi[2]*xi[0]*(xi[1] -xi[2]) + b[1]*c[1]*xi[2]*xi[2]*(- xi[1]-xi[0])+ b[1]*c[1]*xi[2]*xi[2]*xi[0]*(-1.0) - 5.0*2.0*xi[2]*xi[1]*(b[0]*c[0]*lamb_p[0]*xi[1] + b[1]*c[1]*lamb[1]*xi[0])- 5.0*2.0*xi[2]*xi[0]*xi[1]*(b[1]*c[1]*lamb[1]);</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;    </div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;    <span class="comment">// compute for the second derivatives wrt area coordinate1 and 2</span></div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;    psi2(2,0,5) = 5.0*4.0*xi[2]*xi[2]*xi[2] + 10.0*3.0*xi[2]*xi[2]*2.0*(xi[0]+xi[1]) + 30.0*2.0*xi[2]*xi[0]*(lamb[1]*xi[0] + lamb_p[0]*xi[1]) + 60.0*lamb_p[0]*xi[0]*xi[1]*xi[2];</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;    psi2(2,1,5) = 3.0*b[2]*2.0*xi[2]*xi[0]*xi[1]*(-1.0) + 3.0*b[2]*2.0*xi[2]*xi[0]*(xi[0]-xi[1]) + 12.0*xi[2]*xi[2]*(b[1]*xi[0] -b[0]*xi[1])+  3.0*xi[2]*xi[2]*(-b[0])*(xi[2] + 4.0*xi[0] + 4*xi[1])+  xi[2]*xi[2]*xi[2]*(-b[0]) +  15*2.0*xi[2]*xi[0]*xi[1]*(- b[0]*lamb_p[0]) + 15*2.0*xi[2]*xi[0]*(b[1]*lamb[1]*xi[0] - b[0]*lamb_p[0]*xi[1]);</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;    psi2(2,2,5) =  3.0*c[2]*2.0*xi[2]*xi[0]*xi[1] +  -3.0*c[2]*2.0*xi[2]*xi[0]*(xi[0]-xi[1]) - 3.0*xi[2]*xi[2]*(c[1]*xi[0] - c[0]*xi[1])*( 4.0) + 3.0*xi[2]*xi[2]*(c[0])*(xi[2] + 4.0*xi[0] + 4.0*xi[1]) + xi[2]*xi[2]*xi[2]*(c[0]) + 15.0*2.0*xi[2]*xi[0]*xi[1]*(c[0]*lamb_p[0]) -15.0*2.0*xi[2]*xi[0]*(c[1]*lamb[1]*xi[0] -c[0]*lamb_p[0]*xi[1]);</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;    psi2(2,3,5) = 1.0/2.0*3.0*xi[2]*xi[2]*(b[0]*b[0]*2.0*xi[1]) + 2.0*xi[2]*xi[0]*xi[1]*( b[2]*b[0]) + 2.0*xi[2]*xi[0]*(-b[0]*b[1]*xi[2] + b[1]*b[2]*xi[0] + b[2]*b[0]*xi[1])+ xi[2]*xi[2]*xi[0]*(-b[0]*b[1]) + 5.0/2.0*2.0*xi[2]*xi[0]*xi[1]*( b[0]*b[0]*lamb_p[0])+ 5.0/2.0*2.0*xi[2]*xi[0]*(b[1]*b[1]*lamb[1]*xi[0] + b[0]*b[0]*lamb_p[0]*xi[1]);</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;    psi2(2,4,5) = 3.0*xi[2]*xi[2]*(c[0]*c[0]*xi[1]) + 2.0*xi[2]*xi[0]*xi[1]*(c[2]*c[0]) + 2.0*xi[2]*xi[0]*(-c[0]*c[1]*xi[2] + c[1]*c[2]*xi[0] + c[2]*c[0]*xi[1]) + xi[2]*xi[2]*xi[0]*(-c[0]*c[1])  + 5.0/2.0*2.0*xi[2]*xi[0]*xi[1]*(c[0]*c[0]*lamb_p[0]) + 5.0/2.0*2.0*xi[2]*xi[0]*(c[1]*c[1]*lamb[1]*xi[0] + c[0]*c[0]*lamb_p[0]*xi[1]);</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;    psi2(2,5,5) = b[2]*c[2]*2.0*xi[2]*xi[0]*xi[1] + b[2]*c[2]*2.0*xi[2]*xi[0]*(xi[2] + xi[0] + xi[1]) + b[2]*c[2]*xi[2]*xi[2]*xi[0] + b[0]*c[0]*xi[2]*xi[2]*xi[1]*(-1.0)+ b[0]*c[0]*2.0*xi[2]*xi[1]*(xi[0] - xi[2]) + b[0]*c[0]*2.0*xi[2]*(xi[0]*xi[1] - xi[1]*xi[2] - xi[2]*xi[0] - xi[0]*xi[0]) + b[0]*c[0]*xi[2]*xi[2]*( -xi[1] -xi[0]) + b[1]*c[1]*2.0*xi[2]*xi[0]*(xi[0] - xi[2] - 2.0*xi[1]) + b[1]*c[1]*xi[2]*xi[2]*xi[0]*(-1.0) - 5.0*2.0*xi[2]*xi[0]*xi[1]*(b[0]*c[0]*lamb_p[0]) - 5.0*2.0*xi[2]*xi[0]*(b[0]*c[0]*lamb_p[0]*xi[1] + b[1]*c[1]*lamb[1]*xi[0]);</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160; </div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;    <span class="comment">// by chain rule, we can obtain d2shape wrt s0s0 at node2</span></div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;    d2psids(2,0,0) = (psi2(2,0,0)*dxids0[0] + psi2(2,0,3)*dxids0[1] + psi2(2,0,4)*dxids0[2])*dxids0[0] + </div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;                     (psi2(2,0,3)*dxids0[0] + psi2(2,0,1)*dxids0[1] + psi2(2,0,5)*dxids0[2])*dxids0[1] + </div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;                     (psi2(2,0,4)*dxids0[0] + psi2(2,0,5)*dxids0[1] + psi2(2,0,2)*dxids0[2])*dxids0[2];</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;    d2psids(2,1,0) = (psi2(2,1,0)*dxids0[0] + psi2(2,1,3)*dxids0[1] + psi2(2,1,4)*dxids0[2])*dxids0[0] + </div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;                     (psi2(2,1,3)*dxids0[0] + psi2(2,1,1)*dxids0[1] + psi2(2,1,5)*dxids0[2])*dxids0[1] + </div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;                     (psi2(2,1,4)*dxids0[0] + psi2(2,1,5)*dxids0[1] + psi2(2,1,2)*dxids0[2])*dxids0[2];</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;    d2psids(2,2,0) = (psi2(2,2,0)*dxids0[0] + psi2(2,2,3)*dxids0[1] + psi2(2,2,4)*dxids0[2])*dxids0[0] + </div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;                     (psi2(2,2,3)*dxids0[0] + psi2(2,2,1)*dxids0[1] + psi2(2,2,5)*dxids0[2])*dxids0[1] + </div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;                     (psi2(2,2,4)*dxids0[0] + psi2(2,2,5)*dxids0[1] + psi2(2,2,2)*dxids0[2])*dxids0[2];</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;    d2psids(2,3,0) = (psi2(2,3,0)*dxids0[0] + psi2(2,3,3)*dxids0[1] + psi2(2,3,4)*dxids0[2])*dxids0[0] + </div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;                     (psi2(2,3,3)*dxids0[0] + psi2(2,3,1)*dxids0[1] + psi2(2,3,5)*dxids0[2])*dxids0[1] + </div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;                     (psi2(2,3,4)*dxids0[0] + psi2(2,3,5)*dxids0[1] + psi2(2,3,2)*dxids0[2])*dxids0[2];</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;    d2psids(2,4,0) = (psi2(2,4,0)*dxids0[0] + psi2(2,4,3)*dxids0[1] + psi2(2,4,4)*dxids0[2])*dxids0[0] + </div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;                     (psi2(2,4,3)*dxids0[0] + psi2(2,4,1)*dxids0[1] + psi2(2,4,5)*dxids0[2])*dxids0[1] + </div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;                     (psi2(2,4,4)*dxids0[0] + psi2(2,4,5)*dxids0[1] + psi2(2,4,2)*dxids0[2])*dxids0[2];</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;    d2psids(2,5,0) = (psi2(2,5,0)*dxids0[0] + psi2(2,5,3)*dxids0[1] + psi2(2,5,4)*dxids0[2])*dxids0[0] + </div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;                     (psi2(2,5,3)*dxids0[0] + psi2(2,5,1)*dxids0[1] + psi2(2,5,5)*dxids0[2])*dxids0[1] + </div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;                     (psi2(2,5,4)*dxids0[0] + psi2(2,5,5)*dxids0[1] + psi2(2,5,2)*dxids0[2])*dxids0[2];</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;    </div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;    <span class="comment">// by chain rule, we can obtain d2shape wrt s1s1 at node2</span></div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;    d2psids(2,0,1) = (psi2(2,0,0)*dxids1[0] + psi2(2,0,3)*dxids1[1] + psi2(2,0,4)*dxids1[2])*dxids1[0] + </div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;                     (psi2(2,0,3)*dxids1[0] + psi2(2,0,1)*dxids1[1] + psi2(2,0,5)*dxids1[2])*dxids1[1] + </div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;                     (psi2(2,0,4)*dxids1[0] + psi2(2,0,5)*dxids1[1] + psi2(2,0,2)*dxids1[2])*dxids1[2];</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;    d2psids(2,1,1) = (psi2(2,1,0)*dxids1[0] + psi2(2,1,3)*dxids1[1] + psi2(2,1,4)*dxids1[2])*dxids1[0] + </div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;                     (psi2(2,1,3)*dxids1[0] + psi2(2,1,1)*dxids1[1] + psi2(2,1,5)*dxids1[2])*dxids1[1] + </div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;                     (psi2(2,1,4)*dxids1[0] + psi2(2,1,5)*dxids1[1] + psi2(2,1,2)*dxids1[2])*dxids1[2];</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;    d2psids(2,2,1) = (psi2(2,2,0)*dxids1[0] + psi2(2,2,3)*dxids1[1] + psi2(2,2,4)*dxids1[2])*dxids1[0] + </div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;                     (psi2(2,2,3)*dxids1[0] + psi2(2,2,1)*dxids1[1] + psi2(2,2,5)*dxids1[2])*dxids1[1] + </div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;                     (psi2(2,2,4)*dxids1[0] + psi2(2,2,5)*dxids1[1] + psi2(2,2,2)*dxids1[2])*dxids1[2];</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;    d2psids(2,3,1) = (psi2(2,3,0)*dxids1[0] + psi2(2,3,3)*dxids1[1] + psi2(2,3,4)*dxids1[2])*dxids1[0] + </div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;                     (psi2(2,3,3)*dxids1[0] + psi2(2,3,1)*dxids1[1] + psi2(2,3,5)*dxids1[2])*dxids1[1] + </div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;                     (psi2(2,3,4)*dxids1[0] + psi2(2,3,5)*dxids1[1] + psi2(2,3,2)*dxids1[2])*dxids1[2];</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;    d2psids(2,4,1) = (psi2(2,4,0)*dxids1[0] + psi2(2,4,3)*dxids1[1] + psi2(2,4,4)*dxids1[2])*dxids1[0] + </div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;                     (psi2(2,4,3)*dxids1[0] + psi2(2,4,1)*dxids1[1] + psi2(2,4,5)*dxids1[2])*dxids1[1] + </div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;                     (psi2(2,4,4)*dxids1[0] + psi2(2,4,5)*dxids1[1] + psi2(2,4,2)*dxids1[2])*dxids1[2];</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;    d2psids(2,5,1) = (psi2(2,5,0)*dxids1[0] + psi2(2,5,3)*dxids1[1] + psi2(2,5,4)*dxids1[2])*dxids1[0] + </div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;                     (psi2(2,5,3)*dxids1[0] + psi2(2,5,1)*dxids1[1] + psi2(2,5,5)*dxids1[2])*dxids1[1] + </div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;                     (psi2(2,5,4)*dxids1[0] + psi2(2,5,5)*dxids1[1] + psi2(2,5,2)*dxids1[2])*dxids1[2];</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160; </div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;    <span class="comment">// by chain rule, we can obtain d2shape wrt s0s1 at node2</span></div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;    d2psids(2,0,2) = (psi2(2,0,0)*dxids0[0] + psi2(2,0,3)*dxids0[1] + psi2(2,0,4)*dxids0[2])*dxids1[0] + </div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;                     (psi2(2,0,3)*dxids0[0] + psi2(2,0,1)*dxids0[1] + psi2(2,0,5)*dxids0[2])*dxids1[1] + </div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;                     (psi2(2,0,4)*dxids0[0] + psi2(2,0,5)*dxids0[1] + psi2(2,0,2)*dxids0[2])*dxids1[2];</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;    d2psids(2,1,2) = (psi2(2,1,0)*dxids0[0] + psi2(2,1,3)*dxids0[1] + psi2(2,1,4)*dxids0[2])*dxids1[0] + </div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;                     (psi2(2,1,3)*dxids0[0] + psi2(2,1,1)*dxids0[1] + psi2(2,1,5)*dxids0[2])*dxids1[1] + </div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;                     (psi2(2,1,4)*dxids0[0] + psi2(2,1,5)*dxids0[1] + psi2(2,1,2)*dxids0[2])*dxids1[2];</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;    d2psids(2,2,2) = (psi2(2,2,0)*dxids0[0] + psi2(2,2,3)*dxids0[1] + psi2(2,2,4)*dxids0[2])*dxids1[0] + </div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;                     (psi2(2,2,3)*dxids0[0] + psi2(2,2,1)*dxids0[1] + psi2(2,2,5)*dxids0[2])*dxids1[1] + </div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;                     (psi2(2,2,4)*dxids0[0] + psi2(2,2,5)*dxids0[1] + psi2(2,2,2)*dxids0[2])*dxids1[2];</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;    d2psids(2,3,2) = (psi2(2,3,0)*dxids0[0] + psi2(2,3,3)*dxids0[1] + psi2(2,3,4)*dxids0[2])*dxids1[0] + </div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;                     (psi2(2,3,3)*dxids0[0] + psi2(2,3,1)*dxids0[1] + psi2(2,3,5)*dxids0[2])*dxids1[1] + </div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;                     (psi2(2,3,4)*dxids0[0] + psi2(2,3,5)*dxids0[1] + psi2(2,3,2)*dxids0[2])*dxids1[2];</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;    d2psids(2,4,2) = (psi2(2,4,0)*dxids0[0] + psi2(2,4,3)*dxids0[1] + psi2(2,4,4)*dxids0[2])*dxids1[0] + </div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;                     (psi2(2,4,3)*dxids0[0] + psi2(2,4,1)*dxids0[1] + psi2(2,4,5)*dxids0[2])*dxids1[1] + </div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;                     (psi2(2,4,4)*dxids0[0] + psi2(2,4,5)*dxids0[1] + psi2(2,4,2)*dxids0[2])*dxids1[2];</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;    d2psids(2,5,2) = (psi2(2,5,0)*dxids0[0] + psi2(2,5,3)*dxids0[1] + psi2(2,5,4)*dxids0[2])*dxids1[0] + </div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;                     (psi2(2,5,3)*dxids0[0] + psi2(2,5,1)*dxids0[1] + psi2(2,5,5)*dxids0[2])*dxids1[1] + </div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;                     (psi2(2,5,4)*dxids0[0] + psi2(2,5,5)*dxids0[1] + psi2(2,5,2)*dxids0[2])*dxids1[2];  </div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;   } </div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160; };</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;<span class="comment">///////////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;<span class="comment">///////////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;<span class="comment"></span><span class="comment">// C1CurvedElementsShape</span><span class="comment"></span></div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;<span class="comment">///////////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;<span class="comment">///////////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;<span class="comment"></span><span class="comment">//========================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;<span class="comment">/// A class for Linear triangular shape function with 3 vertex nodes</span></div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;<span class="comment"></span><span class="comment">//========================================================================</span></div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;<span class="keyword">template</span>&lt;<span class="keywordtype">unsigned</span> DIM&gt;</div>
<div class="line"><a name="l01014"></a><span class="lineno"><a class="line" href="classoomph_1_1LinearTElement.html"> 1014</a></span>&#160; <span class="keyword">class </span><a class="code" href="classoomph_1_1LinearTElement.html">LinearTElement</a> { };</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160; </div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;<span class="keyword">template</span>&lt;&gt;</div>
<div class="line"><a name="l01017"></a><span class="lineno"><a class="line" href="classoomph_1_1LinearTElement_3_012_01_4.html"> 1017</a></span>&#160; <span class="keyword">class </span><a class="code" href="classoomph_1_1LinearTElement.html">LinearTElement</a>&lt;2&gt;</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160; {</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;   <span class="keyword">public</span>:</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;<span class="comment">//=======================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;<span class="comment">/// Return local coordinates of node j</span></div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;<span class="comment"></span><span class="comment">//=======================================================================</span></div>
<div class="line"><a name="l01023"></a><span class="lineno"><a class="line" href="classoomph_1_1LinearTElement_3_012_01_4.html#a0f45d00770d1c86cb2eb65d747b5cba3"> 1023</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1LinearTElement_3_012_01_4.html#a0f45d00770d1c86cb2eb65d747b5cba3">local_coordinate_of_node</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; j,</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;                                <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>)<span class="keyword"> const</span></div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;<span class="keyword">   </span>{</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;    <span class="keywordflow">switch</span> (j)</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;     {</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;     <span class="keywordflow">case</span> 0:</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;      <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]=1.0;</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;      <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]=0.0;</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;      </div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;     <span class="keywordflow">case</span> 1:</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;      <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]=0.0;</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;      <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]=1.0;</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;      </div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;     <span class="keywordflow">case</span> 2:</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;      <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]=0.0;</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;      <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]=0.0;</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;      </div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;     <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;      std::ostringstream error_message;</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;      error_message &lt;&lt; <span class="stringliteral">&quot;Element only has three nodes; called with node number &quot;</span> </div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;                    &lt;&lt; j &lt;&lt; std::endl;</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;      </div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;      <span class="keywordflow">throw</span> <a class="code" href="classoomph_1_1OomphLibError.html">OomphLibError</a>(error_message.str(),</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;                          <span class="stringliteral">&quot;TElement::local_coordinate_of_node()&quot;</span>,</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;                          OOMPH_EXCEPTION_LOCATION);</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;     }</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;   }</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160; </div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160; </div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;<span class="comment">//=======================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;<span class="comment">/// Shape function for specific TElement&lt;2,2&gt;</span></div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;<span class="comment"></span><span class="comment">//=======================================================================</span></div>
<div class="line"><a name="l01058"></a><span class="lineno"><a class="line" href="classoomph_1_1LinearTElement_3_012_01_4.html#ab20729d302959a5d81e0dfa8b3f4b9e5"> 1058</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1LinearTElement_3_012_01_4.html#ab20729d302959a5d81e0dfa8b3f4b9e5">Lshape</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>, <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;psi)<span class="keyword"> const</span></div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;<span class="keyword">   </span>{</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;    psi[0] = <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0];</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;    psi[1] = <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1];</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;    psi[2] = 1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1];</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;   }</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;  </div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160; </div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;<span class="comment">//=======================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;<span class="comment">/// Derivatives of shape functions for specific TElement&lt;2,2&gt;</span></div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;<span class="comment"></span><span class="comment">//=======================================================================</span></div>
<div class="line"><a name="l01069"></a><span class="lineno"><a class="line" href="classoomph_1_1LinearTElement_3_012_01_4.html#a25953f47a9f66aaa947cba3c667f0ef2"> 1069</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1LinearTElement_3_012_01_4.html#a25953f47a9f66aaa947cba3c667f0ef2">dLshape_local</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;                    <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;psi, <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;dpsids)<span class="keyword"> const</span></div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;<span class="keyword">   </span>{</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;    this-&gt;Lshape(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>, psi);</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;    </div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;    <span class="comment">// Derivatives</span></div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;    dpsids(0,0) = 1.0;</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;    dpsids(0,1) = 0.0;</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;    dpsids(1,0) = 0.0;</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;    dpsids(1,1) = 1.0;</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;    dpsids(2,0) = -1.0;</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;    dpsids(2,1) = -1.0;</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;   }</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;  </div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;  </div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;<span class="comment">//=======================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;<span class="comment">/// Second derivatives of shape functions for specific TElement&lt;2,2&gt;:</span></div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;<span class="comment"> /// d2psids(i,0) = \f$ \partial^2 \psi_j / \partial s_0^2 \f$ \n</span></div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;<span class="comment"> /// d2psids(i,1) = \f$ \partial^2 \psi_j / \partial s_1^2 \f$ \n</span></div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;<span class="comment"> /// d2psids(i,2) = \f$ \partial^2 \psi_j / \partial s_0 \partial s_1 \f$ \n</span></div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;<span class="comment"></span><span class="comment">//=======================================================================</span></div>
<div class="line"><a name="l01090"></a><span class="lineno"><a class="line" href="classoomph_1_1LinearTElement_3_012_01_4.html#a0deccf130233fc497906f9b48608045e"> 1090</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1LinearTElement_3_012_01_4.html#a0deccf130233fc497906f9b48608045e">d2Lshape_local</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>, </div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;                     <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;psi, </div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;                     <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;dpsids, </div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;                     <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;d2psids)<span class="keyword"> const</span></div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;<span class="keyword">   </span>{</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;    this-&gt;dLshape_local(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>, psi,dpsids);</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;    </div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;3;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;     {</div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;      d2psids(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>,0) = 0.0;</div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;      d2psids(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>,1) = 0.0;</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;      d2psids(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>,2) = 0.0;</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;     }</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;   }</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160; };</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160; </div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;<span class="comment">//=====================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;<span class="comment">/// Define integration schemes that are required to exactly integrate</span></div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;<span class="comment">/// the mass matrices of the bubble-enriched elements. The enrichement</span></div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;<span class="comment">/// increases the polynomial order which means that higher-order Gauss</span></div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;<span class="comment">/// rules must be used.</span></div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;<span class="comment"></span><span class="comment">//====================================================================</span></div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;<span class="keyword">template</span>&lt;<span class="keywordtype">unsigned</span> DIM, <span class="keywordtype">unsigned</span> NNODE_1D&gt;</div>
<div class="line"><a name="l01113"></a><span class="lineno"><a class="line" href="classoomph_1_1CurvedTGauss.html"> 1113</a></span>&#160; <span class="keyword">class </span><a class="code" href="classoomph_1_1CurvedTGauss.html">CurvedTGauss</a></div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;{</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;};</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160; </div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;<span class="comment">//====================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;<span class="comment">///Specialisation for two-dimensional elements, in which the highest</span></div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;<span class="comment">///order polynomial is cubic, so we need the integration scheme</span></div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;<span class="comment">///for the unenriched cubic element</span></div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;<span class="comment"></span><span class="comment">//====================================================================== </span></div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;<span class="keyword">template</span>&lt;&gt;</div>
<div class="line"><a name="l01123"></a><span class="lineno"><a class="line" href="classoomph_1_1CurvedTGauss_3_012_00_012_01_4.html"> 1123</a></span>&#160;<span class="keyword">class </span><a class="code" href="classoomph_1_1CurvedTGauss.html">CurvedTGauss</a>&lt;2,2&gt; : <span class="keyword">public</span> <a class="code" href="classoomph_1_1TGauss.html">TGauss</a>&lt;2,4&gt;</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;{</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;  <span class="keyword">public</span>:</div>
<div class="line"><a name="l01126"></a><span class="lineno"><a class="line" href="classoomph_1_1CurvedTGauss_3_012_00_012_01_4.html#af5146d11a77146251cdcf69f22a6d029"> 1126</a></span>&#160;  <a class="code" href="classoomph_1_1CurvedTGauss_3_012_00_012_01_4.html#af5146d11a77146251cdcf69f22a6d029">CurvedTGauss</a>() : <a class="code" href="classoomph_1_1TGauss.html">TGauss</a>&lt;2,4&gt;() {}</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;};</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160; </div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;<span class="comment">//========================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;<span class="comment">/// A class for subparametric shape functions of </span></div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;<span class="comment">/// a curved triangular element with 3 vertex nodes</span></div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;<span class="comment">/// Affine mapping is used when dealing with a straight-boundary element</span></div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;<span class="comment">/// Nonlinear mapping is used when dealing with a curved-boundary element</span></div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;<span class="comment">/// Note that a cubic-Hermite polynomial is employed to approximate a</span></div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;<span class="comment">/// curved boundary</span></div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;<span class="comment"></span><span class="comment">//========================================================================</span></div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;<span class="keyword">template</span>&lt;<span class="keywordtype">unsigned</span> DIM&gt;</div>
<div class="line"><a name="l01138"></a><span class="lineno"><a class="line" href="classoomph_1_1GeometricTElement.html"> 1138</a></span>&#160; <span class="keyword">class </span><a class="code" href="classoomph_1_1GeometricTElement.html">GeometricTElement</a>{};</div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160; </div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;<span class="keyword">template</span>&lt;&gt;</div>
<div class="line"><a name="l01141"></a><span class="lineno"><a class="line" href="classoomph_1_1GeometricTElement_3_012_01_4.html"> 1141</a></span>&#160; <span class="keyword">class </span><a class="code" href="classoomph_1_1GeometricTElement.html">GeometricTElement</a>&lt;2&gt;</div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160; {</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;   <span class="keyword">public</span>:</div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;<span class="comment">//=======================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;<span class="comment">/// Return local coordinates of node j</span></div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;<span class="comment"></span><span class="comment">//=======================================================================</span></div>
<div class="line"><a name="l01147"></a><span class="lineno"><a class="line" href="classoomph_1_1GeometricTElement_3_012_01_4.html#aeabbac1b1c1fe3019eee0040f162990e"> 1147</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1GeometricTElement_3_012_01_4.html#aeabbac1b1c1fe3019eee0040f162990e">local_coordinate_of_node</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; j,</div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;                                <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>)<span class="keyword"> const</span></div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;<span class="keyword">   </span>{</div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;    <span class="keywordflow">switch</span> (j)</div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;     {</div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;     <span class="keywordflow">case</span> 0:</div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;      <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]=1.0;</div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;      <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]=0.0;</div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;      </div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;     <span class="keywordflow">case</span> 1:</div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;      <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]=0.0;</div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;      <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]=1.0;</div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;      </div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;     <span class="keywordflow">case</span> 2:</div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;      <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]=0.0;</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;      <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]=0.0;</div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;      </div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;     <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;      std::ostringstream error_message;</div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;      error_message &lt;&lt; <span class="stringliteral">&quot;Element only has three nodes; called with node number &quot;</span> </div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;                    &lt;&lt; j &lt;&lt; std::endl;</div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;      </div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;      <span class="keywordflow">throw</span> <a class="code" href="classoomph_1_1OomphLibError.html">OomphLibError</a>(error_message.str(),</div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;                          <span class="stringliteral">&quot;GeometricTElement::local_coordinate_of_node()&quot;</span>,</div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;                          OOMPH_EXCEPTION_LOCATION);</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;     }</div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;   }</div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;<span class="comment">//=======================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;<span class="comment">/// Geometric interpolation for specific C1CurvedElement&lt;&gt;</span></div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;<span class="comment">/// This function return the physical coordinates at the local coordinate s</span></div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;<span class="comment">/// rather than a value of shape function at the local coordinate s</span></div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;<span class="comment"></span><span class="comment">//=======================================================================</span></div>
<div class="line"><a name="l01182"></a><span class="lineno"><a class="line" href="classoomph_1_1GeometricTElement_3_012_01_4.html#a8e6bab8c2bd951889894b3a08b796207"> 1182</a></span>&#160;   <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1GeometricTElement_3_012_01_4.html#a8e6bab8c2bd951889894b3a08b796207">Lshape</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>, <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;psi, <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;phi, <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> &amp;<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>,</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;                    <span class="keywordtype">unsigned</span> &amp;bd_element, <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> &amp;bd_position, <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;x)<span class="keyword"> const</span></div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;<span class="keyword">   </span>{</div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;    <span class="comment">// assign shape functions to the interior elements</span></div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;    psi[0] = <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0];</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;    psi[1] = <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1];</div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;    psi[2] = 1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1];</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;    </div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;    <span class="comment">// assign shape functions to the boundary elements</span></div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;    <span class="keywordtype">double</span> angle_1 = atan2(bd_position(0,1),bd_position(0,0));</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;    <span class="keywordtype">double</span> angle_2 = atan2(bd_position(1,1),bd_position(1,0));</div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;    <span class="keywordtype">double</span> angle_min=0.0;</div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;    <span class="keywordtype">double</span> angle_max=0.0;</div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;    </div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;    <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> p(3,2);</div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;    <span class="keywordflow">if</span>(angle_1 &lt; angle_2)</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;     {</div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;      angle_min = angle_1;</div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;      angle_max = angle_2;</div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;      </div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;      p(0,0) = bd_position(0,0); </div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;      p(0,1) = bd_position(0,1);</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;      </div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;      p(1,0) = bd_position(1,0); </div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;      p(1,1) = bd_position(1,1);</div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;     }</div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(angle_1 &gt; angle_2)</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;     {</div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;      angle_min = angle_2;</div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;      angle_max = angle_1;</div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;      </div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;      p(0,0) = bd_position(1,0); </div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;      p(0,1) = bd_position(1,1);</div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;      </div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;      p(1,0) = bd_position(0,0); </div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;      p(1,1) = bd_position(0,1);</div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;     }</div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;      </div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;    <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> b_fn_derivative_min(2), b_fn_derivative_max(2);</div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;    b_fn_derivative_min[0] = -1.0*sin(angle_min);</div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;    b_fn_derivative_min[1] = cos(angle_min);</div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;    b_fn_derivative_max[0] = -1.0*sin(angle_max);</div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;    b_fn_derivative_max[1] = cos(angle_max);</div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;    </div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;    <span class="comment">// compute the physical coordinates at the local coordinate s</span></div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;    <span class="keywordflow">if</span>(bd_element == 0)</div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;     {</div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;      phi[0] = <a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(2,0) + (<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(0,0) - <a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(2,0))*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0] + (<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(1,0) - <a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(2,0))*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1];</div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;      phi[1] = <a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(2,1) + (<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(0,1) - <a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(2,1))*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0] + (<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(1,1) - <a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(2,1))*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1];</div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;     }</div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;     {</div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;      <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> psi_h(2);</div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;2;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;       {</div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;        <span class="comment">// polynomial of degree 3 to approximate boundary</span></div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;            psi_h[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] = ( (2.0*(p(1,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>)-p(0,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>))-(angle_max-angle_min)*(b_fn_derivative_min[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]+b_fn_derivative_max[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]))*(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]) + (angle_max-angle_min)*(b_fn_derivative_min[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]-b_fn_derivative_max[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]) );</div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;        phi[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] = x[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] + (p(0,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>) - x[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>])*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0] + (p(1,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>) - x[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>])*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1] + 1.0/2.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*psi_h[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>];</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;       }</div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;     }</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;   }</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;  </div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160; </div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;<span class="comment">//=======================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;<span class="comment">/// Derivatives of Geometric interpolation for specific C1CurvedElement&lt;&gt;</span></div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;<span class="comment">/// This function return the derivatives of physical coordinates at </span></div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;<span class="comment">/// the local coordinate s rather than a value of the derivatives of </span></div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;<span class="comment">/// shape function at the local coordinate s</span></div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;<span class="comment"></span><span class="comment">//=======================================================================</span></div>
<div class="line"><a name="l01251"></a><span class="lineno"><a class="line" href="classoomph_1_1GeometricTElement_3_012_01_4.html#a3ab2648ee1e98ad31c5246a8bd189556"> 1251</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1GeometricTElement_3_012_01_4.html#a3ab2648ee1e98ad31c5246a8bd189556">dLshape_local</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;                    <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;psi, <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;dpsids, <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;phi, <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;dphids, <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> &amp;<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>,</div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;                     <span class="keywordtype">unsigned</span> &amp;bd_element, <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> &amp;bd_position, <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;x)<span class="keyword"> const</span></div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;<span class="keyword">   </span>{</div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;    this-&gt;Lshape(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,psi,phi,<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>,bd_element,bd_position,x);</div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;    <span class="comment">// Derivatives</span></div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;    dpsids(0,0) = 1.0;</div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;    dpsids(0,1) = 0.0;</div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;    dpsids(1,0) = 0.0;</div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;    dpsids(1,1) = 1.0;</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;    dpsids(2,0) = -1.0;</div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;    dpsids(2,1) = -1.0;</div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;    </div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;    <span class="keywordtype">double</span> angle_1 = atan2(bd_position(0,1),bd_position(0,0));</div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;    <span class="keywordtype">double</span> angle_2 = atan2(bd_position(1,1),bd_position(1,0));</div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;    <span class="keywordtype">double</span> angle_min=0.0;</div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;    <span class="keywordtype">double</span> angle_max=0.0;</div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;    </div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;    <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> p(3,2);</div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;    <span class="keywordflow">if</span>(angle_1 &lt; angle_2)</div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;     {</div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;      angle_min = angle_1;</div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;      angle_max = angle_2;</div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;      </div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;      p(0,0) = bd_position(0,0); </div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;      p(0,1) = bd_position(0,1);</div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;      </div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;      p(1,0) = bd_position(1,0); </div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;      p(1,1) = bd_position(1,1);</div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;     }</div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(angle_1 &gt; angle_2)</div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;     {</div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;      angle_min = angle_2;</div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;      angle_max = angle_1;</div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;      </div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;      p(0,0) = bd_position(1,0); </div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;      p(0,1) = bd_position(1,1);</div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;      </div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;      p(1,0) = bd_position(0,0); </div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;      p(1,1) = bd_position(0,1);</div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;     }</div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;      </div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;    <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> b_fn_derivative_min(2), b_fn_derivative_max(2);</div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;    b_fn_derivative_min[0] = -1.0*sin(angle_min);</div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;    b_fn_derivative_min[1] = cos(angle_min);</div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;    b_fn_derivative_max[0] = -1.0*sin(angle_max);</div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;    b_fn_derivative_max[1] = cos(angle_max);</div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;    </div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;    <span class="comment">// compute shape functions</span></div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;    <span class="keywordflow">if</span>(bd_element == 0)</div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;     {</div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;      dphids(0,0) = <a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(0,0) - <a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(2,0);</div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;      dphids(0,1) = <a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(1,0) - <a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(2,0);</div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;      dphids(1,0) = <a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(0,1) - <a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(2,1);</div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;      dphids(1,1) = <a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(1,1) - <a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>(2,1);</div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;     }</div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;     {</div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;      <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> psi_h(2);</div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;2;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;       {</div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;        psi_h[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] = ( (2.0*(p(1,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>)-p(0,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>))-(angle_max-angle_min)*(b_fn_derivative_min[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]+b_fn_derivative_max[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]))*(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]) + (angle_max-angle_min)*(b_fn_derivative_min[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]-b_fn_derivative_max[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]) ); </div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;       }</div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;      <span class="comment">// compute shape functions derivatives</span></div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;      <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> dpsi_h(2,2);</div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;2;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;       {</div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;        dpsi_h(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>,0) = (2.0*(p(1,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>)-p(0,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>))-(angle_max-angle_min)*(b_fn_derivative_min[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]+b_fn_derivative_max[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]))*(-1.0);</div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;        dpsi_h(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>,1) = (2.0*(p(1,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>)-p(0,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>))-(angle_max-angle_min)*(b_fn_derivative_min[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]+b_fn_derivative_max[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]));</div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;       }</div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;2;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;       {</div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;        dphids(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>,0) = p(0,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>) - x[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] + 1.0/2.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*dpsi_h(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>,0) + psi_h[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]/2.0 ;</div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;        dphids(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>,1) = p(1,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>) - x[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] + 1.0/2.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*dpsi_h(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>,1) + psi_h[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]/2.0 ;</div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;       }</div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;     }</div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;   }</div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;  </div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;<span class="comment">//=======================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;<span class="comment">/// Second derivatives of Geometric interpolation for </span></div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;<span class="comment">/// specific C1CurvedElement&lt;&gt;:</span></div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;<span class="comment">/// This function return the second-order derivatives of physical coordinates at </span></div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;<span class="comment">/// the local coordinate s rather than a value of the second-order derivatives of </span></div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;<span class="comment">/// shape function at the local coordinate s</span></div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;<span class="comment">///=======================================================================</span></div>
<div class="line"><a name="l01336"></a><span class="lineno"><a class="line" href="classoomph_1_1GeometricTElement_3_012_01_4.html#ab842b93f817d9b14c133d555bec8c373"> 1336</a></span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1GeometricTElement_3_012_01_4.html#ab842b93f817d9b14c133d555bec8c373">d2Lshape_local</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>, </div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;                     <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;psi, </div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;                     <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;dpsids, </div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;                     <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;d2psids,</div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;                     <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;phi, </div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;                     <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;dphids, </div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;                     <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;d2phids,</div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;                     <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> &amp;<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>,</div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;                     <span class="keywordtype">unsigned</span> &amp;bd_element, </div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;                     <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> &amp;bd_position,</div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;                     <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;x)<span class="keyword"> const</span></div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;<span class="keyword">   </span>{</div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;    this-&gt;dLshape_local(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,psi,dpsids,phi,dphids,<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>,bd_element,bd_position,x);</div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;    <span class="comment">// 2nd Derivatives</span></div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;3;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;     {</div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;      d2psids(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>,0) = 0.0;</div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;      d2psids(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>,1) = 0.0;</div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;      d2psids(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>,2) = 0.0;</div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;     }</div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;    <span class="keywordtype">double</span> angle_1 = atan2(bd_position(0,1),bd_position(0,0));</div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;    <span class="keywordtype">double</span> angle_2 = atan2(bd_position(1,1),bd_position(1,0));</div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;    <span class="keywordtype">double</span> angle_min=0.0;</div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;    <span class="keywordtype">double</span> angle_max=0.0;</div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;    </div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;    <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> p(3,2);</div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;    <span class="keywordflow">if</span>(angle_1 &lt; angle_2)</div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;     {</div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;      angle_min = angle_1;</div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;      angle_max = angle_2;</div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;      </div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;      p(0,0) = bd_position(0,0); </div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;      p(0,1) = bd_position(0,1);</div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;      </div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;      p(1,0) = bd_position(1,0); </div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;      p(1,1) = bd_position(1,1);</div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;     }</div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(angle_1 &gt; angle_2)</div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;     {</div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;      angle_min = angle_2;</div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;      angle_max = angle_1;</div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;      </div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;      p(0,0) = bd_position(1,0); </div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;      p(0,1) = bd_position(1,1);</div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;      </div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;      p(1,0) = bd_position(0,0); </div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;      p(1,1) = bd_position(0,1);</div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;     }</div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;    </div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;    <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> b_fn_derivative_min(2), b_fn_derivative_max(2);</div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;    b_fn_derivative_min[0] = -1.0*sin(angle_min);</div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;    b_fn_derivative_min[1] = cos(angle_min);</div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;    b_fn_derivative_max[0] = -1.0*sin(angle_max);</div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;    b_fn_derivative_max[1] = cos(angle_max);</div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;    </div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;    <span class="comment">// compute the 2nd-order of derivatives of the  physical coordinates</span></div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;    <span class="keywordflow">if</span>(bd_element == 0)</div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;     {</div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;2;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;       {</div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;        d2phids(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>,0) = 0.0;</div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;        d2phids(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>,1) = 0.0;</div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;        d2phids(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>,2) = 0.0;</div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;       }</div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;     }</div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;     {</div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;      <span class="comment">// compute the 2nd-order derivatives of the physical coordinates</span></div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;      <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> psi_h(2);</div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;      <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> dpsi_h(2,2), d2psi_h(2,3);</div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;      </div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;2;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;       {</div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;        psi_h[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] = ( (2.0*(p(1,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>)-p(0,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>))-(angle_max-angle_min)*(b_fn_derivative_min[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]+b_fn_derivative_max[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]))*(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]) + (angle_max-angle_min)*(b_fn_derivative_min[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]-b_fn_derivative_max[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]) );</div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;       }</div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;      </div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;2;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;       {</div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;        dpsi_h(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>,0) = (2.0*(p(1,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>)-p(0,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>))-(angle_max-angle_min)*(b_fn_derivative_min[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]+b_fn_derivative_max[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]))*(-1.0);</div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;        dpsi_h(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>,1) = (2.0*(p(1,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>)-p(0,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>))-(angle_max-angle_min)*(b_fn_derivative_min[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]+b_fn_derivative_max[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]));</div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;       }</div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;      </div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;2;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;       {</div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;        d2psi_h(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>,0) = 0.0;</div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;        d2psi_h(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>,1) = 0.0;</div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;        d2psi_h(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>,2) = 0.0;</div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;       }</div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;      </div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;2;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;       {</div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;        d2phids(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>,0) = 1.0/2.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*d2psi_h(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>,0) + dpsi_h(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>,0)*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]/2.0 + 1.0/2.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*dpsi_h(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>,0);</div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;        d2phids(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>,1) = 1.0/2.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*d2psi_h(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>,1) + 1.0/2.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*dpsi_h(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>,1) + 1.0/2.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*dpsi_h(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>,1);</div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;        d2phids(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>,2) = 1.0/2.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*d2psi_h(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>,2) + 1.0/2.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*dpsi_h(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>,0) + psi_h[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]/2.0 + dpsi_h(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>,1)*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]/2.0;</div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;       }</div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;     }</div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;   }</div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160; };</div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160; </div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;<span class="comment">//========================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;<span class="comment">/// A class for C1-curved triangular shape function with 3 vertex nodes and</span></div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;<span class="comment">/// 3 middle-side node</span></div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;<span class="comment"></span><span class="comment">//========================================================================</span></div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;<span class="keyword">template</span>&lt;<span class="keywordtype">unsigned</span> DIM, <span class="keywordtype">unsigned</span> NNODE_1D&gt;</div>
<div class="line"><a name="l01440"></a><span class="lineno"><a class="line" href="classoomph_1_1C1CurvedElementShape.html"> 1440</a></span>&#160; <span class="keyword">class </span><a class="code" href="classoomph_1_1C1CurvedElementShape.html">C1CurvedElementShape</a> { };</div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160; </div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160; <span class="keyword">template</span>&lt;<span class="keywordtype">unsigned</span> NNODE_1D&gt;</div>
<div class="line"><a name="l01443"></a><span class="lineno"><a class="line" href="classoomph_1_1C1CurvedElementShape_3_012_00_01NNODE__1D_01_4.html"> 1443</a></span>&#160; <span class="keyword">class </span><a class="code" href="classoomph_1_1C1CurvedElementShape.html">C1CurvedElementShape</a>&lt;2,NNODE_1D&gt;</div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160; {</div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160; <span class="keyword">public</span>:</div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160; <span class="comment">//=======================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;<span class="comment"> /// Return local coordinates of node j</span></div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;<span class="comment"></span> <span class="comment">//=======================================================================</span></div>
<div class="line"><a name="l01449"></a><span class="lineno"><a class="line" href="classoomph_1_1C1CurvedElementShape_3_012_00_01NNODE__1D_01_4.html#af67d209a5cf65825e78389318dc395e6"> 1449</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1C1CurvedElementShape_3_012_00_01NNODE__1D_01_4.html#af67d209a5cf65825e78389318dc395e6">local_coordinate_of_node</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; j,</div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;                                <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>)<span class="keyword"> const</span></div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;<span class="keyword">   </span>{</div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;    <span class="keywordflow">if</span>(NNODE_1D == 2)                                </div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;     {</div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;       <span class="keywordflow">switch</span> (j)</div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;        {</div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;        <span class="keywordflow">case</span> 0:</div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;         <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]=1.0;</div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;         <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]=0.0;</div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;         <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160; </div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;        <span class="keywordflow">case</span> 1:</div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;         <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]=0.0;</div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;         <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]=1.0;</div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;         <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160; </div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;        <span class="keywordflow">case</span> 2:</div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;         <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]=0.0;</div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;         <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]=0.0;</div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;         <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160; </div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;        <span class="keywordflow">case</span> 3:</div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;         <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]=1.0/2.0;</div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;         <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]=1.0/4.0;</div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;         <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160; </div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;        <span class="keywordflow">case</span> 4:</div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;         <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]=1.0/4.0;</div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;         <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]=1.0/2.0;</div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;         <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160; </div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;        <span class="keywordflow">case</span> 5:</div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;         <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]=1.0/4.0;</div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;         <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]=1.0/4.0;</div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;         <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160; </div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;        <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;         std::ostringstream error_message;</div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;         error_message &lt;&lt; <span class="stringliteral">&quot;Element only has three vertices and three internal nodes; called with node number &quot;</span></div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;                       &lt;&lt; j &lt;&lt; std::endl;</div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160; </div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;         <span class="keywordflow">throw</span> <a class="code" href="classoomph_1_1OomphLibError.html">OomphLibError</a>(error_message.str(),</div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;                             <span class="stringliteral">&quot;CurvedTElement::local_coordinate_of_node()&quot;</span>,</div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;                             OOMPH_EXCEPTION_LOCATION);</div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;        }      </div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;     }</div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;     </div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(NNODE_1D == 3)                                </div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;     {</div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;       <span class="keywordflow">switch</span> (j)</div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;        {</div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;        <span class="keywordflow">case</span> 0:</div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;         <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]=1.0;</div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;         <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]=0.0;</div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;         <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160; </div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;        <span class="keywordflow">case</span> 1:</div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;         <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]=0.0;</div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;         <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]=1.0;</div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;         <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160; </div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;        <span class="keywordflow">case</span> 2:</div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;         <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]=0.0;</div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;         <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]=0.0;</div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;         <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160; </div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;        <span class="keywordflow">case</span> 3:</div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;         <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]=0.5;</div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;         <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]=0.5;</div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;         <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160; </div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;        <span class="keywordflow">case</span> 4:</div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;         <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]=0.0;</div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;         <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]=0.5;</div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;         <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160; </div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;        <span class="keywordflow">case</span> 5:</div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;         <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]=0.5;</div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;         <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]=0.0;</div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;         <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;          </div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;        <span class="keywordflow">case</span> 6:</div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;         <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]=1.0/2.0;</div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;         <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]=1.0/4.0;</div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;         <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160; </div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;        <span class="keywordflow">case</span> 7:</div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;         <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]=1.0/4.0;</div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;         <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]=1.0/2.0;</div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;         <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160; </div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;        <span class="keywordflow">case</span> 8:</div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;         <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]=1.0/4.0;</div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;         <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]=1.0/4.0;</div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;         <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160; </div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;        <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;         std::ostringstream error_message;</div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;         error_message &lt;&lt; <span class="stringliteral">&quot;Element has maximum of six nodes and three internal nodes; called with node number &quot;</span></div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;                       &lt;&lt; j &lt;&lt; std::endl;</div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160; </div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;         <span class="keywordflow">throw</span> <a class="code" href="classoomph_1_1OomphLibError.html">OomphLibError</a>(error_message.str(),</div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;                             <span class="stringliteral">&quot;CurvedTElement::local_coordinate_of_node()&quot;</span>,</div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;                             OOMPH_EXCEPTION_LOCATION);</div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;        }      </div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;     }</div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;   }</div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;<span class="comment">  ///============================================================</span></div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;<span class="comment">  /// compute for the set of value in the reference triangle</span></div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;<span class="comment">  ///============================================================</span></div>
<div class="line"><a name="l01561"></a><span class="lineno"><a class="line" href="classoomph_1_1C1CurvedElementShape_3_012_00_01NNODE__1D_01_4.html#a40cd0a35dbc0402d7161f58c69d059b5"> 1561</a></span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1C1CurvedElementShape_3_012_00_01NNODE__1D_01_4.html#a40cd0a35dbc0402d7161f58c69d059b5">set_of_value</a>(<a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> &amp;<a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a51292b8e4d96f2bb9f0d6bb0340d1620">D</a>, <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> &amp;<a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a43c804e2bcf9862a4bf629d5f01761e8">B</a>, <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> &amp;<a class="code" href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a>,</div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;                    <span class="keywordtype">unsigned</span> &amp;bd_element, <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> &amp;bd_position, <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;x)<span class="keyword"> const</span></div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;<span class="keyword">   </span>{</div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;    <span class="keywordtype">double</span> angle_1 = atan2(bd_position(0,1),bd_position(0,0));</div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;    <span class="keywordtype">double</span> angle_2 = atan2(bd_position(1,1),bd_position(1,0));</div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;    <span class="keywordtype">double</span> angle_min=0.0;</div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;    <span class="keywordtype">double</span> angle_max=0.0;</div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;    </div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;    <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> p(3,2);</div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;    <span class="keywordflow">if</span>(angle_1 &lt; angle_2)</div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;     {</div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;      angle_min = angle_1;</div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;      angle_max = angle_2;</div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;      </div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;      p(0,0) = bd_position(0,0); </div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;      p(0,1) = bd_position(0,1);</div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;      </div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;      p(1,0) = bd_position(1,0); </div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;      p(1,1) = bd_position(1,1);</div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;     }</div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(angle_1 &gt; angle_2)</div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;     {</div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;      angle_min = angle_2;</div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;      angle_max = angle_1;</div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;      </div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;      p(0,0) = bd_position(1,0); </div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;      p(0,1) = bd_position(1,1);</div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;      </div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;      p(1,0) = bd_position(0,0); </div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;      p(1,1) = bd_position(0,1);</div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;     }</div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;    p(2,0) = x[0];</div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;    p(2,1) = x[1];</div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160; </div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;    <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> fn_derivative1(2), fn_derivative2(2);</div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;    fn_derivative1[0] = (angle_max-angle_min)*-1.0*sin(angle_min);</div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;    fn_derivative1[1] = (angle_max-angle_min)*-1.0*sin(angle_max);</div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;    fn_derivative2[0] = (angle_max-angle_min)*cos(angle_min);</div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;    fn_derivative2[1] = (angle_max-angle_min)*cos(angle_max);</div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;    </div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;    <span class="comment">// compute for the transformation matrix D from global to local coordinates</span></div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;    <span class="comment">//initialise the matrix first</span></div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;21;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;     {</div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> j=0;j&lt;21;j++)</div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;       {</div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;        <a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a51292b8e4d96f2bb9f0d6bb0340d1620">D</a>(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>,j) = 0.0;</div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;       }</div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;     }</div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;    <span class="keywordtype">double</span> x31, x23, x13, x32, y13 ,y31, y32, y23;</div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;    x31 = p(2,0)-p(0,0);</div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;    y31 = p(2,1)-p(0,1);</div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;    x32 = p(2,0)-p(1,0);</div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;    y32 = p(2,1)-p(1,1);</div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;    x23 = p(1,0)-p(2,0);</div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;    y23 = p(1,1)-p(2,1);</div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;    x13 = p(0,0)-p(2,0);</div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;    y13 = p(0,1)-p(2,1);</div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;    </div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;    <span class="comment">// assign values to the matrix D</span></div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;    <a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a51292b8e4d96f2bb9f0d6bb0340d1620">D</a>(0,0) = 1.0;</div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;    <a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a51292b8e4d96f2bb9f0d6bb0340d1620">D</a>(1,1) = 1.0;</div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;    <a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a51292b8e4d96f2bb9f0d6bb0340d1620">D</a>(2,2) = 1.0;</div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;    <a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a51292b8e4d96f2bb9f0d6bb0340d1620">D</a>(3+0,3+0)=x31;</div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;    <a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a51292b8e4d96f2bb9f0d6bb0340d1620">D</a>(3+0,3+1)=fn_derivative1[0];</div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;    <a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a51292b8e4d96f2bb9f0d6bb0340d1620">D</a>(3+1,3+0)=y31;</div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;    <a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a51292b8e4d96f2bb9f0d6bb0340d1620">D</a>(3+1,3+1)=fn_derivative2[0];</div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;    <span class="comment">// define submatrix d2</span></div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;    <a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a51292b8e4d96f2bb9f0d6bb0340d1620">D</a>(5+0,5+0)=-1.0*fn_derivative1[1];</div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;    <a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a51292b8e4d96f2bb9f0d6bb0340d1620">D</a>(5+0,5+1)=x32;</div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;    <a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a51292b8e4d96f2bb9f0d6bb0340d1620">D</a>(5+1,5+0)=-1.0*fn_derivative2[1];</div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;    <a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a51292b8e4d96f2bb9f0d6bb0340d1620">D</a>(5+1,5+1)=y32;</div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;    <span class="comment">// define submatrix d3</span></div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;    <a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a51292b8e4d96f2bb9f0d6bb0340d1620">D</a>(7+0,7+0)=x23;</div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;    <a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a51292b8e4d96f2bb9f0d6bb0340d1620">D</a>(7+0,7+1)=x13;</div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;    <a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a51292b8e4d96f2bb9f0d6bb0340d1620">D</a>(7+1,7+0)=y23;</div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;    <a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a51292b8e4d96f2bb9f0d6bb0340d1620">D</a>(7+1,7+1)=y13;</div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;    <span class="comment">// define submatrix d4</span></div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;    <a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a51292b8e4d96f2bb9f0d6bb0340d1620">D</a>(9+0,9+0)=x31*x31;</div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;    <a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a51292b8e4d96f2bb9f0d6bb0340d1620">D</a>(9+0,9+1)=fn_derivative1[0]*fn_derivative1[0];</div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;    <a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a51292b8e4d96f2bb9f0d6bb0340d1620">D</a>(9+0,9+6)=x32*x32;</div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;    <a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a51292b8e4d96f2bb9f0d6bb0340d1620">D</a>(9+1,9+0)=2.0*x31*y31;</div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;    <a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a51292b8e4d96f2bb9f0d6bb0340d1620">D</a>(9+1,9+1)=2.0*fn_derivative1[0]*fn_derivative2[0];</div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;    <a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a51292b8e4d96f2bb9f0d6bb0340d1620">D</a>(9+1,9+6)=2.0*x32*y32;</div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;    <a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a51292b8e4d96f2bb9f0d6bb0340d1620">D</a>(9+2,9+0)=y31*y31;</div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;    <a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a51292b8e4d96f2bb9f0d6bb0340d1620">D</a>(9+2,9+1)=fn_derivative2[0]*fn_derivative2[0];</div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;    <a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a51292b8e4d96f2bb9f0d6bb0340d1620">D</a>(9+2,9+6)=y32*y32;</div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;    <a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a51292b8e4d96f2bb9f0d6bb0340d1620">D</a>(9+3,9+2)=fn_derivative1[1]*fn_derivative1[1];</div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;    <a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a51292b8e4d96f2bb9f0d6bb0340d1620">D</a>(9+3,9+3)=x32*x32;</div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;    <a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a51292b8e4d96f2bb9f0d6bb0340d1620">D</a>(9+3,9+7)=x31*x31;</div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;    <a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a51292b8e4d96f2bb9f0d6bb0340d1620">D</a>(9+4,9+2)=2.0*fn_derivative1[1]*fn_derivative2[1];</div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;    <a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a51292b8e4d96f2bb9f0d6bb0340d1620">D</a>(9+4,9+3)=2.0*x32*y32;</div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;    <a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a51292b8e4d96f2bb9f0d6bb0340d1620">D</a>(9+4,9+7)=2.0*x31*y31;</div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;    <a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a51292b8e4d96f2bb9f0d6bb0340d1620">D</a>(9+5,9+2)=fn_derivative2[1]*fn_derivative2[1];</div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;    <a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a51292b8e4d96f2bb9f0d6bb0340d1620">D</a>(9+5,9+3)=y32*y32;</div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;    <a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a51292b8e4d96f2bb9f0d6bb0340d1620">D</a>(9+5,9+7)=y31*y31;</div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;    <a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a51292b8e4d96f2bb9f0d6bb0340d1620">D</a>(9+6,9+4)=x32*x32;</div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;    <a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a51292b8e4d96f2bb9f0d6bb0340d1620">D</a>(9+6,9+5)=x31*x31;</div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;    <a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a51292b8e4d96f2bb9f0d6bb0340d1620">D</a>(9+6,9+8)=fn_derivative1[0]*fn_derivative1[1];</div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;    <a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a51292b8e4d96f2bb9f0d6bb0340d1620">D</a>(9+7,9+4)=2.0*x32*y32;</div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;    <a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a51292b8e4d96f2bb9f0d6bb0340d1620">D</a>(9+7,9+5)=2.0*x31*y31;</div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;    <a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a51292b8e4d96f2bb9f0d6bb0340d1620">D</a>(9+7,9+8)=fn_derivative1[0]*fn_derivative2[1]+fn_derivative2[0]*fn_derivative1[1];</div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;    <a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a51292b8e4d96f2bb9f0d6bb0340d1620">D</a>(9+8,9+4)=y32*y32;</div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;    <a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a51292b8e4d96f2bb9f0d6bb0340d1620">D</a>(9+8,9+5)=y31*y31;</div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;    <a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a51292b8e4d96f2bb9f0d6bb0340d1620">D</a>(9+8,9+8)=fn_derivative2[0]*fn_derivative2[1];</div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;    </div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;    <a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a51292b8e4d96f2bb9f0d6bb0340d1620">D</a>(18,18) = 1.0;</div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;    <a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a51292b8e4d96f2bb9f0d6bb0340d1620">D</a>(19,19) = 1.0;</div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;    <a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a51292b8e4d96f2bb9f0d6bb0340d1620">D</a>(20,20) = 1.0;</div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;    <span class="comment">//assign  the matrix of transformation from the dofs on curved element to the dofs on reference element</span></div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;    <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> Bt(36,21);</div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;    <span class="comment">//Initialize the matrix </span></div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;36;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;     {</div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> j=0;j&lt;21;j++)</div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;       {</div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;        Bt(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>,j) = 0.0;</div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;       }</div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;     }</div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;    <span class="comment">// submatrix b1</span></div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;    Bt(0,0)=1.0;</div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;    Bt(1,1)=1.0;</div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;    Bt(2,2)=1.0;</div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;    <span class="comment">// submatrix b2</span></div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;    Bt(3+0,3+0)=-1.0;</div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;    Bt(3+1,3+0)=-1.0;</div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;    Bt(3+1,3+1)=1.0;</div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;    Bt(3+2,3+2)=1.0;</div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;    Bt(3+2,3+3)=-1.0;</div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;    Bt(3+3,3+3)=-1.0;</div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;    Bt(3+4,3+5)=1.0;</div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;    Bt(3+5,3+4)=1.0;</div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;    <span class="comment">// submatrix b3</span></div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;    <span class="keywordtype">double</span> a1, a2, aa1, aa2, b1, b2, bb1, bb2, c1, c2, cc1, cc2;</div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;    <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> A1(2), A2(2), B1(2), B2(2), C1(2), C2(2);</div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;2;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;     {</div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;      A1[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] = p(2,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>)-p(0,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>); </div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;      B2[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] = p(2,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>)-p(1,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>);</div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;      C1[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] = p(1,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>)-p(2,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>);</div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;      C2[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] = p(0,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>)-p(2,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>);</div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;     }</div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;    A2[0] = (angle_max-angle_min)*-1.0*sin(angle_min);</div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;    A2[1] = (angle_max-angle_min)*cos(angle_min);</div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;    B1[0] = -1.0*(angle_max-angle_min)*-1.0*sin(angle_max);</div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;    B1[1] = -1.0*(angle_max-angle_min)*cos(angle_max);</div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;    <span class="keywordtype">double</span> B2xA2, A1xA2, A1xB2, B1xA2, A1xB1, B1xA1, A2xB2, B1xB2;</div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;    B2xA2 = B2[0]*A2[1]-B2[1]*A2[0];</div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;    A1xA2 = A1[0]*A2[1]-A1[1]*A2[0]; </div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;    A1xB2 = A1[0]*B2[1]-A1[1]*B2[0];</div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;    B1xA2 = B1[0]*A2[1]-B1[1]*A2[0];</div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;    A1xB1 = A1[0]*B1[1]-A1[1]*B1[0];</div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;    A2xB2 = A2[0]*B2[1]-A2[1]*B2[0];</div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;    B1xA1 = B1[0]*A1[1]-B1[1]*A1[0];</div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;    B1xB2 = B1[0]*B2[1]-B1[1]*B2[0];</div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;    a1 = B2xA2/A1xA2 - 1.0;</div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;    a2 = A1xB2/A1xA2;</div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;    aa1 = -1.0*B1xA2/A1xA2;</div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;    aa2 = -1.0*A1xB1/A1xA2;</div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;    b1 = A1xB2/B1xB2;</div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;    b2 = B1xA1/B1xB2 - 1.0;</div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;    bb1 = A2xB2/B1xB2;</div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;    bb2 = B1xA2/B1xB2;</div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;    c1 = -1.0/a2;</div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;    c2 = -1.0*bb1/b1;</div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;    cc1 = aa2/a2;</div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;    cc2 = -1.0/b1;</div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;   </div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;    Bt(9+1,3+0)=2.0*a1+aa1/2.0;</div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;    Bt(9+2,3+0)=-1.0*(2.0*a1+aa1);</div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;    Bt(9+1,3+1)=3.0/2.0+2.0*a2+aa2/2.0;</div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;    Bt(9+2,3+1)=-1.0*(1.0+2.0*a2+aa2);</div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;    Bt(9+3,3+2)=-1.0*(1.0+2.0*b1-bb1);</div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;    Bt(9+4,3+2)=3.0/2.0+2.0*b1-bb1/2.0;</div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;    Bt(9+3,3+3)=-1.0*(2.0*b2-bb2);</div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;    Bt(9+4,3+3)=2.0*b2-bb2/2.0;</div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;    Bt(9+7,3+4)=(c1+cc1)/2.0;</div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;    Bt(9+7,3+5)=(c2+cc2)/2.0;</div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160; </div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;    Bt(9+0,9+0)=1.0;</div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;    Bt(9+1,9+0)=1.0+(1.0+a1)/(2.0*a2);</div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;    Bt(9+2,9+0)=1.0+(1.0+a1)/(a2);</div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;    Bt(9+1,9+1)=(a2)/(2.0*(1.0+a1));</div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;    Bt(9+2,9+1)=1.0+(a2)/(1.0+a1);</div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;    Bt(9+3,9+2)=1.0+(b1)/(1.0+b2);</div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;    Bt(9+4,9+2)=(b1)/(2.0*(1.0+b2));</div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;    Bt(9+3,9+3)=1.0+(1.0+b2)/(b1);</div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;    Bt(9+4,9+3)=1.0+(1.0+b2)/(2.0*b1);</div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;    Bt(9+5,9+3)=1.0;</div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;    Bt(9+7,9+4)=-1.0*(c1*cc1)/(c1*cc2+c2*cc1);</div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;    Bt(9+8,9+4)=1.0;</div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;    Bt(9+6,9+5)=1.0;</div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;    Bt(9+7,9+5)=-1.0*(c2*cc2)/(c1*cc2+c2*cc1);</div>
<div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;    Bt(9+1,9+6)=(-1.0)/(2.0*a2*(1.0+a1));</div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;    Bt(9+2,9+6)=(-1.0)/(a2*(1.0+a1));</div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;    Bt(9+3,9+7)=(-1.0)/(b1*(1.0+b2));</div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;    Bt(9+4,9+7)=(-1.0)/(2.0*b1*(1.0+b2));</div>
<div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;    Bt(9+7,9+8)=(-1.0)/(c1*cc2+c2*cc1);</div>
<div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;    </div>
<div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;    <span class="keywordtype">double</span> ata1, ata2;</div>
<div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;    <span class="comment">// assign the points of perpendicular for the sides a1a3 nd a2a3</span></div>
<div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;    <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> s1(2), s2(2);</div>
<div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;    <span class="comment">// find the point that the point a1(on the boundary) is perpendicular to the vector a2a3</span></div>
<div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;    <span class="keywordtype">double</span> m = (p(1,1) - p(2,1))/(p(1,0) - p(2,0));</div>
<div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;    <span class="keywordtype">double</span> k = p(2,1) - m*p(2,0);</div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;    s1[0] = ( (p(1,0) - p(2,0))*p(0,0) + (p(1,1) - p(2,1))*(p(0,1)-k) )/((p(1,0) - p(2,0)) + (p(1,1) - p(2,1))*m);</div>
<div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;    s1[1] = m*s1[0] + k;</div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;    </div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;    <span class="keywordflow">if</span>((p(1,0) - p(2,0))==0)</div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;     {</div>
<div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;      m = (p(1,0) - p(2,0))/(p(1,1) - p(2,1));</div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;      k = p(2,0) - m*p(2,1);</div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;      s1[1] = ( (p(1,0) - p(2,0))*(p(0,0)-k) + (p(1,1) - p(2,1))*(p(0,1)) )/((p(1,0) - p(2,0))*m + (p(1,1) - p(2,1)));</div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;      s1[0] = m*s1[1] + k;</div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;     }</div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160; </div>
<div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;    <span class="comment">// find the point that the point a2(on the boundary) is perpendicular to the vector a1a3</span></div>
<div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;    m = (p(0,1) - p(2,1))/(p(0,0) - p(2,0));</div>
<div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;    k = p(2,1) - m*p(2,0);</div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;    s2[0] = ( (p(0,0) - p(2,0))*p(1,0) + (p(0,1) - p(2,1))*(p(1,1)-k) )/((p(0,0) - p(2,0)) + (p(0,1) - p(2,1))*m);</div>
<div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;    s2[1] = m*s2[0] + k;</div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;    </div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;    <span class="keywordflow">if</span>((p(0,0) - p(2,0))==0)</div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;     {</div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;      m = (p(0,0) - p(2,0))/(p(0,1) - p(2,1));</div>
<div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;      k = p(2,0) - m*p(2,1);</div>
<div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;      s2[1] = ( (p(0,0) - p(2,0))*(p(1,0)-k) + (p(0,1) - p(2,1))*(p(1,1)) )/((p(0,0) - p(2,0))*m + (p(0,1) - p(2,1)));</div>
<div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;      s2[0] = m*s2[1] + k;</div>
<div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;     }</div>
<div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;    </div>
<div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;    <span class="keywordtype">double</span> len1, len2, len3;</div>
<div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;    len1 = sqrt((p(1,0)-p(2,0))*(p(1,0)-p(2,0)) + (p(1,1)-p(2,1))*(p(1,1)-p(2,1)) );</div>
<div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;    len2 = sqrt((p(0,0)-p(2,0))*(p(0,0)-p(2,0)) + (p(0,1)-p(2,1))*(p(0,1)-p(2,1)) );</div>
<div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;    len3 = sqrt((p(1,0)-p(0,0))*(p(1,0)-p(0,0)) + (p(1,1)-p(0,1))*(p(1,1)-p(0,1)) );</div>
<div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;    ata1 = (len3*len3-len2*len2)/(len1*len1);</div>
<div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;    ata2 = (len1*len1-len3*len3)/(len2*len2);</div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;    </div>
<div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;    <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> F1(21,0.0), F2(21,0.0), F3(21,0.0), H1(21,0.0), H2(21,0.0), H3(21,0.0);</div>
<div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;    <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> F1_div(21,2,0.0), F2_div(21,2,0.0);</div>
<div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;    <span class="comment">//Initialize the Vectors</span></div>
<div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;21;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;     {</div>
<div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;      F1[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] = 0.0;</div>
<div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;      F2[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] = 0.0;</div>
<div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;      F3[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] = 0.0;</div>
<div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;      H1[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] = 0.0;</div>
<div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;      H2[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] = 0.0;</div>
<div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;      H3[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] = 0.0;</div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> j=0;j&lt;2;j++)</div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;       {</div>
<div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;        F1_div(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>,j) = 0;</div>
<div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;        F2_div(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>,j) = 0;</div>
<div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;       }</div>
<div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;     }</div>
<div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;    <span class="keywordtype">double</span> e1,e2,f1,f2;</div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="namespaceoomph_1_1VectorHelpers.html#af92401cf726dc1712b7fb861b8416e69">magnitude</a>;</div>
<div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;    <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> <a class="code" href="cfortran_8h.html#af6f0bd3dc13317f895c91323c25c2b8f">t</a>(2,0.0),aa(2,0.0),<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>(2,0.0);</div>
<div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160; </div>
<div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;    <a class="code" href="cfortran_8h.html#af6f0bd3dc13317f895c91323c25c2b8f">t</a>[0] = p(2,0)-p(0,0) + 1.0/4.0*(p(0,0)-p(1,0))+1.0/8.0*(angle_max-angle_min)*(-3.0*sin(angle_max)+sin(angle_min));</div>
<div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;    <a class="code" href="cfortran_8h.html#af6f0bd3dc13317f895c91323c25c2b8f">t</a>[1] = p(2,1)-p(0,1) + 1.0/4.0*(p(0,1)-p(1,1))+1.0/8.0*(angle_max-angle_min)*(3.0*cos(angle_max)-cos(angle_min));</div>
<div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;    <a class="code" href="namespaceoomph_1_1VectorHelpers.html#af92401cf726dc1712b7fb861b8416e69">magnitude</a> = sqrt((p(1,0)-p(2,0))*(p(1,0)-p(2,0)) + (p(1,1)-p(2,1))*(p(1,1)-p(2,1)));</div>
<div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;    aa[0] = (p(1,0)-p(2,0))/(<a class="code" href="namespaceoomph_1_1VectorHelpers.html#af92401cf726dc1712b7fb861b8416e69">magnitude</a>*<a class="code" href="namespaceoomph_1_1VectorHelpers.html#af92401cf726dc1712b7fb861b8416e69">magnitude</a>);</div>
<div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;    aa[1] = (p(1,1)-p(2,1))/(<a class="code" href="namespaceoomph_1_1VectorHelpers.html#af92401cf726dc1712b7fb861b8416e69">magnitude</a>*<a class="code" href="namespaceoomph_1_1VectorHelpers.html#af92401cf726dc1712b7fb861b8416e69">magnitude</a>);</div>
<div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;    e1 = (<a class="code" href="cfortran_8h.html#af6f0bd3dc13317f895c91323c25c2b8f">t</a>[0]*aa[0] + <a class="code" href="cfortran_8h.html#af6f0bd3dc13317f895c91323c25c2b8f">t</a>[1]*aa[1]);</div>
<div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;    </div>
<div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;    <a class="code" href="namespaceoomph_1_1VectorHelpers.html#af92401cf726dc1712b7fb861b8416e69">magnitude</a> = sqrt((p(0,0)-s1[0])*(p(0,0)-s1[0]) + (p(0,1)-s1[1])*(p(0,1)-s1[1]));</div>
<div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;    aa[0] = (p(0,0)-s1[0])/(<a class="code" href="namespaceoomph_1_1VectorHelpers.html#af92401cf726dc1712b7fb861b8416e69">magnitude</a>*<a class="code" href="namespaceoomph_1_1VectorHelpers.html#af92401cf726dc1712b7fb861b8416e69">magnitude</a>);</div>
<div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;    aa[1] = (p(0,1)-s1[1])/(<a class="code" href="namespaceoomph_1_1VectorHelpers.html#af92401cf726dc1712b7fb861b8416e69">magnitude</a>*<a class="code" href="namespaceoomph_1_1VectorHelpers.html#af92401cf726dc1712b7fb861b8416e69">magnitude</a>);</div>
<div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;    e2 = (<a class="code" href="cfortran_8h.html#af6f0bd3dc13317f895c91323c25c2b8f">t</a>[0]*aa[0] + <a class="code" href="cfortran_8h.html#af6f0bd3dc13317f895c91323c25c2b8f">t</a>[1]*aa[1]);</div>
<div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;    </div>
<div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;    <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1] = 1.0/2.0;</div>
<div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;    F2_div(1,1) = 5.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*6.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]-4.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*15.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]+3.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*10.0;</div>
<div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;    F2_div(2,1) = (1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1])*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1])*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1])*(12.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]+3.0)-3.0*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1])*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1])*(6.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]+3.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]+1.0);</div>
<div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;    F2_div(6,1) = <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1])*(-3.0)+(4.0-3.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1])*(-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]+3.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]));</div>
<div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;    F2_div(7,1) = <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1])*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1])*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1])*3.0 + ( -3.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1])*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]) + (1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1])*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1])*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]) )*(1.0+3.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]);</div>
<div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;    F2_div(12,1) = -1.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1])+3.0/2.0*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1])*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1])*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1];</div>
<div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;    F2_div(13,1) = -3.0/2.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1])*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]) + 1.0/2.0*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1])*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1])*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1])*2.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1];</div>
<div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;    </div>
<div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;    <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1] = 1.0/2.0;</div>
<div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;    H2[5] = -1.0*b1*(3.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]-2.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]);</div>
<div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;    H2[6] = -1.0/2.0*(2.0*b2+1.0+ata1)*(3.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]-2.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]);</div>
<div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;    H2[7] = -1.0/2.0*(1.0-ata1)*(1.0-3.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]+2.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]);</div>
<div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;    H2[8] = (1.0-3.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]+2.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]);</div>
<div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;    H2[11] = -1.0/2.0*((b1*b1)/(1.0+b2))*(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]);</div>
<div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;    H2[12] = 1.0/2.0*(b2+ata1)*(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]);</div>
<div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;    H2[13] = -1.0/2.0*( (2.0*c1*cc1)/(c1*cc2+c2*cc1) +1.0-ata1)*(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]-2.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]+<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]);</div>
<div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;    H2[14] = -1.0*((c2*cc2)/(c1*cc2+c2*cc1))*(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]-2.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]+<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]);</div>
<div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;    H2[16] = 1.0/2.0*(1.0/(1.0+b2))*(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]);</div>
<div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;    H2[17] = ((-1.0)/(c1*cc2+c2*cc1))*(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]-2.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]+<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]);</div>
<div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160; </div>
<div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;21;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;     {</div>
<div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;      Bt(18,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>) = e1*F2_div(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>,1)+e2*H2[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>];</div>
<div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;     }</div>
<div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;     </div>
<div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;    <a class="code" href="cfortran_8h.html#af6f0bd3dc13317f895c91323c25c2b8f">t</a>[0] = p(2,0)-p(1,0) + 1.0/4.0*(p(1,0)-p(0,0))-1.0/8.0*(angle_max-angle_min)*(-3.0*sin(angle_min)+sin(angle_max));</div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;    <a class="code" href="cfortran_8h.html#af6f0bd3dc13317f895c91323c25c2b8f">t</a>[1] = p(2,1)-p(1,1) + 1.0/4.0*(p(1,1)-p(0,1))-1.0/8.0*(angle_max-angle_min)*(3.0*cos(angle_min)-cos(angle_max));</div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;    <a class="code" href="namespaceoomph_1_1VectorHelpers.html#af92401cf726dc1712b7fb861b8416e69">magnitude</a> = sqrt((p(0,0)-p(2,0))*(p(0,0)-p(2,0)) + (p(0,1)-p(2,1))*(p(0,1)-p(2,1)));</div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;    aa[0] = (p(0,0)-p(2,0))/(<a class="code" href="namespaceoomph_1_1VectorHelpers.html#af92401cf726dc1712b7fb861b8416e69">magnitude</a>*<a class="code" href="namespaceoomph_1_1VectorHelpers.html#af92401cf726dc1712b7fb861b8416e69">magnitude</a>);</div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;    aa[1] = (p(0,1)-p(2,1))/(<a class="code" href="namespaceoomph_1_1VectorHelpers.html#af92401cf726dc1712b7fb861b8416e69">magnitude</a>*<a class="code" href="namespaceoomph_1_1VectorHelpers.html#af92401cf726dc1712b7fb861b8416e69">magnitude</a>);</div>
<div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;    f1 = (<a class="code" href="cfortran_8h.html#af6f0bd3dc13317f895c91323c25c2b8f">t</a>[0]*aa[0] + <a class="code" href="cfortran_8h.html#af6f0bd3dc13317f895c91323c25c2b8f">t</a>[1]*aa[1]);</div>
<div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;    </div>
<div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;    <a class="code" href="namespaceoomph_1_1VectorHelpers.html#af92401cf726dc1712b7fb861b8416e69">magnitude</a> = sqrt((p(1,0)-s2[0])*(p(1,0)-s2[0]) + (p(1,1)-s2[1])*(p(1,1)-s2[1]));</div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;    aa[0] = (p(1,0)-s2[0])/(<a class="code" href="namespaceoomph_1_1VectorHelpers.html#af92401cf726dc1712b7fb861b8416e69">magnitude</a>*<a class="code" href="namespaceoomph_1_1VectorHelpers.html#af92401cf726dc1712b7fb861b8416e69">magnitude</a>);</div>
<div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;    aa[1] = (p(1,1)-s2[1])/(<a class="code" href="namespaceoomph_1_1VectorHelpers.html#af92401cf726dc1712b7fb861b8416e69">magnitude</a>*<a class="code" href="namespaceoomph_1_1VectorHelpers.html#af92401cf726dc1712b7fb861b8416e69">magnitude</a>);</div>
<div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;    f2 = (<a class="code" href="cfortran_8h.html#af6f0bd3dc13317f895c91323c25c2b8f">t</a>[0]*aa[0] + <a class="code" href="cfortran_8h.html#af6f0bd3dc13317f895c91323c25c2b8f">t</a>[1]*aa[1]);</div>
<div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;    </div>
<div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;    <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0] = 1.0/2.0;</div>
<div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;    F1_div(0,0) = 5.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*6.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]-4.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*15.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]+3.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*10.0;</div>
<div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;    F1_div(2,0) = (1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0])*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0])*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0])*(12.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]+3.0)-3.0*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0])*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0])*(6.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]+3.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]+1.0);</div>
<div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;    F1_div(3,0) = <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0])*(-3.0)+(4.0-3.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0])*(-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]+3.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]));</div>
<div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;    F1_div(8,0) = <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0])*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0])*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0])*3.0+(-3.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0])*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0])+(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0])*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0])*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]))*(1.0+3.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]);</div>
<div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;    F1_div(9,0) = -1.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0])+3.0/2.0*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0])*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0])*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0];</div>
<div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;    F1_div(14,0) = -3.0/2.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0])*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]) + 1.0/2.0*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0])*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0])*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0])*2.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0];</div>
<div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160; </div>
<div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;    <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0] = 1.0/2.0;</div>
<div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;    H1[3] = -1.0/2.0*(1.0-ata2+2.0*a1)*(3.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]-2.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]);</div>
<div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;    H1[4] = -1.0*a2*(3.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]-2.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]);</div>
<div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;    H1[7] = 1.0-3.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]+2.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0];</div>
<div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;    H1[8] = -1.0/2.0*(1.0+ata2)*(1.0-3.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]+2.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]);</div>
<div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;    H1[9] = 1.0/2.0*(a1-ata2)*(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]);</div>
<div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;    H1[10] = -1.0/2.0*(a2*a2/(1.0+a1))*(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]);</div>
<div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;    H1[13] = ((-1.0*c1*cc1)/(c1*cc2+c2*cc1))*(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]-2.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]+<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]);</div>
<div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;    H1[14] = -1.0*( 1.0/2.0*(1.0+ata2)+(c2*cc2/(c1*cc2+c2*cc1)) )*(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]-2.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]+<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]);</div>
<div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;    H1[15] = (<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0])/(2.0*(1.0+a1));</div>
<div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;    H1[17] = -1.0/(c1*cc2+c2*cc1)*(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]-2.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]+<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]);</div>
<div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160; </div>
<div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;21;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;     {</div>
<div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;      Bt(19,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>) = f1*F1_div(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>,0)+f2*H1[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>];</div>
<div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;     }</div>
<div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;    </div>
<div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;    <span class="keywordtype">double</span> A = a1 + 1.0/2.0*aa1;</div>
<div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;    <span class="keywordtype">double</span> BB = a2 + 1.0/2.0*aa2;</div>
<div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;    <span class="keywordtype">double</span> C = 2.0*b1-bb1;</div>
<div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7da585070bd0e3801c3bbed287ef3c4a265">E</a> = 2.0*b2-bb2;</div>
<div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;    <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0] = 1.0/2.0;</div>
<div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;    H3[3] = (3.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]-2.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]) - A*(-1.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]+<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]);</div>
<div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;    H3[4] = -1.0/2.0*(3.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]-2.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]) - (BB+1.0/2.0)*(-1.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]+<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]);</div>
<div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;    H3[5] = -1.0/2.0*(1.0-3.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]+2.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]) + 1.0/2.0*(C+1.0)*(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]-2.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]+<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]);</div>
<div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;    H3[6] = (1.0-3.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]+2.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]) + 1.0/2.0*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7da585070bd0e3801c3bbed287ef3c4a265">E</a>*(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]-2.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]+<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]);</div>
<div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;    H3[9] = (1.0+a1)/(2.0*a2)*(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]);</div>
<div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;    H3[10] = 1.0/2.0*(1.0+ a2/(1.0+a1))*(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]);</div>
<div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;    H3[11] = -1.0/2.0*(1.0+ b1/(1.0+b2) )*(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]-2.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]+<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]);</div>
<div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;    H3[12] = -1.0*(1.0+b2)/(2.0*b1)*(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]-2.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]+<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]);</div>
<div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;    H3[15] = -1.0/(2.0*(1.0+a1)*a2)*(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]);</div>
<div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;    H3[16] = 1.0/(2.0*b1*(1.0+b2))*(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]-2.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]+<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]);</div>
<div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160; </div>
<div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;21;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;     {</div>
<div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;      Bt(20,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>) = -1.0*sqrt(2.0)*H3[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>];</div>
<div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;     }</div>
<div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160; </div>
<div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;    <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1] = 3.0/4.0;</div>
<div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;    F2[1] = <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*(6.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]-15.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]+10.0);</div>
<div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;    F2[2] = (1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1])*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1])*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1])*(6.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]+3.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]+1.0);</div>
<div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;    F2[6] = <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1])*(4.0-3.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]);</div>
<div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;    F2[7] = <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1])*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1])*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1])*(1.0+3.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]);</div>
<div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;    F2[12] = 1.0/2.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1])*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]);</div>
<div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;    F2[13] = 1.0/2.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1])*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1])*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]);</div>
<div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;21;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;     {</div>
<div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;      Bt(21,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>) = F2[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>];</div>
<div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;     }</div>
<div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;      </div>
<div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;    <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1] = 1.0/4.0;</div>
<div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;    F2[1] = <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*(6.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]-15.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]+10.0);</div>
<div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;    F2[2] = (1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1])*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1])*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1])*(6.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]+3.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]+1.0);</div>
<div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;    F2[6] = <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1])*(4.0-3.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]);</div>
<div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;    F2[7] = <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1])*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1])*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1])*(1.0+3.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]);</div>
<div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;    F2[12] = 1.0/2.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1])*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]);</div>
<div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;    F2[13] = 1.0/2.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1])*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1])*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]);</div>
<div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;21;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;     {</div>
<div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;      Bt(22,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>) = F2[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>];</div>
<div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;     }</div>
<div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160; </div>
<div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;    <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0] = 1.0/4.0;</div>
<div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;    F1[0] = <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*(6.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]-15.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]+10.0);</div>
<div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;    F1[2] = (1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0])*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0])*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0])*(6.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]+3.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]+1.0);</div>
<div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;    F1[3] = <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0])*(4.0-3.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]);</div>
<div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;    F1[8] = <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0])*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0])*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0])*(1.0+3.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]);</div>
<div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;    F1[9] = 1.0/2.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0])*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]);</div>
<div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;    F1[14] = 1.0/2.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0])*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0])*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]);</div>
<div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;21;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;     {</div>
<div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;      Bt(23,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>) = F1[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>];</div>
<div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;     }</div>
<div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;    </div>
<div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;    <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0] = 3.0/4.0;</div>
<div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;    F1[0] = <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*(6.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]-15.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]+10.0);</div>
<div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;    F1[2] = (1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0])*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0])*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0])*(6.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]+3.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]+1.0);</div>
<div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;    F1[3] = <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0])*(4.0-3.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]);</div>
<div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;    F1[8] = <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0])*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0])*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0])*(1.0+3.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]);</div>
<div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;    F1[9] = 1.0/2.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0])*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]);</div>
<div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;    F1[14] = 1.0/2.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0])*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0])*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]);</div>
<div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;21;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;     {</div>
<div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;      Bt(24,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>) = F1[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>];</div>
<div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;     }</div>
<div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160; </div>
<div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;    <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0] = 3.0/4.0;</div>
<div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;    F3[0] = <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*(6.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]-15.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]+10.0);</div>
<div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;    F3[1] = (1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0])*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0])*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0])*(6.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]+3.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]+1.0);</div>
<div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;    F3[3] = -1.0*(3.0*a1+aa1)*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0])*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]);</div>
<div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;    F3[4] = <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0])*(2.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]-(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0])*(3.0*a2+aa2));</div>
<div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;    F3[5] = <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0])*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0])*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0])*(1.0+<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*(3.0*b1-bb1));</div>
<div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;    F3[6] = -1.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0])*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0])*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0])*(3.0*b2-bb2);</div>
<div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;    F3[10] = 1.0/2.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0])*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]);</div>
<div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;    F3[11] = 1.0/2.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0])*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0])*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]);</div>
<div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;21;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;     {</div>
<div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;      Bt(25,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>) = F3[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>];</div>
<div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;     }</div>
<div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;    </div>
<div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;    <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0] = 1.0/4.0;</div>
<div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;    F3[0] = <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*(6.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]-15.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]+10.0);</div>
<div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;    F3[1] = (1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0])*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0])*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0])*(6.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]+3.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]+1.0);</div>
<div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;    F3[3] = -1.0*(3.0*a1+aa1)*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0])*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]);</div>
<div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;    F3[4] = <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0])*(2.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]-(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0])*(3.0*a2+aa2));</div>
<div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;    F3[5] = <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0])*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0])*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0])*(1.0+<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*(3.0*b1-bb1));</div>
<div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;    F3[6] = -1.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0])*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0])*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0])*(3.0*b2-bb2);</div>
<div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;    F3[10] = 1.0/2.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0])*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]);</div>
<div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;    F3[11] = 1.0/2.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0])*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0])*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]);</div>
<div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;21;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;     {</div>
<div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;      Bt(26,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>) = F3[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>];</div>
<div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;     }</div>
<div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160; </div>
<div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;    <span class="keywordtype">double</span> g1,g2,h1,h2,k1,k2,j1,j2;</div>
<div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;    <a class="code" href="cfortran_8h.html#af6f0bd3dc13317f895c91323c25c2b8f">t</a>[0] = p(0,0)-p(2,0) + 9.0/16.0*(p(1,0)-p(0,0))+3.0/32.0*(angle_max-angle_min)*(-sin(angle_min)+7.0*sin(angle_max));</div>
<div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;    <a class="code" href="cfortran_8h.html#af6f0bd3dc13317f895c91323c25c2b8f">t</a>[1] = p(0,1)-p(2,1) + 9.0/16.0*(p(1,1)-p(0,1))+3.0/32.0*(angle_max-angle_min)*(cos(angle_min)-7.0*cos(angle_max));</div>
<div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;    <a class="code" href="namespaceoomph_1_1VectorHelpers.html#af92401cf726dc1712b7fb861b8416e69">magnitude</a> = sqrt((p(1,0)-p(2,0))*(p(1,0)-p(2,0)) + (p(1,1)-p(2,1))*(p(1,1)-p(2,1)));</div>
<div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;    aa[0] = (p(1,0)-p(2,0))/(<a class="code" href="namespaceoomph_1_1VectorHelpers.html#af92401cf726dc1712b7fb861b8416e69">magnitude</a>*<a class="code" href="namespaceoomph_1_1VectorHelpers.html#af92401cf726dc1712b7fb861b8416e69">magnitude</a>);</div>
<div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;    aa[1] = (p(1,1)-p(2,1))/(<a class="code" href="namespaceoomph_1_1VectorHelpers.html#af92401cf726dc1712b7fb861b8416e69">magnitude</a>*<a class="code" href="namespaceoomph_1_1VectorHelpers.html#af92401cf726dc1712b7fb861b8416e69">magnitude</a>);</div>
<div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;    g1 = -1.0*(<a class="code" href="cfortran_8h.html#af6f0bd3dc13317f895c91323c25c2b8f">t</a>[0]*aa[0] + <a class="code" href="cfortran_8h.html#af6f0bd3dc13317f895c91323c25c2b8f">t</a>[1]*aa[1]);</div>
<div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;    </div>
<div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;    <a class="code" href="namespaceoomph_1_1VectorHelpers.html#af92401cf726dc1712b7fb861b8416e69">magnitude</a> = sqrt((p(0,0)-s1[0])*(p(0,0)-s1[0]) + (p(0,1)-s1[1])*(p(0,1)-s1[1]));</div>
<div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;    aa[0] = (p(0,0)-s1[0])/(<a class="code" href="namespaceoomph_1_1VectorHelpers.html#af92401cf726dc1712b7fb861b8416e69">magnitude</a>*<a class="code" href="namespaceoomph_1_1VectorHelpers.html#af92401cf726dc1712b7fb861b8416e69">magnitude</a>);</div>
<div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;    aa[1] = (p(0,1)-s1[1])/(<a class="code" href="namespaceoomph_1_1VectorHelpers.html#af92401cf726dc1712b7fb861b8416e69">magnitude</a>*<a class="code" href="namespaceoomph_1_1VectorHelpers.html#af92401cf726dc1712b7fb861b8416e69">magnitude</a>);</div>
<div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;    g2 = -1.0*(<a class="code" href="cfortran_8h.html#af6f0bd3dc13317f895c91323c25c2b8f">t</a>[0]*aa[0] + <a class="code" href="cfortran_8h.html#af6f0bd3dc13317f895c91323c25c2b8f">t</a>[1]*aa[1]);</div>
<div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;    </div>
<div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;    <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1] = 3.0/4.0;</div>
<div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;    F2_div(1,1) = 5.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*6.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]-4.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*15.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]+3.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*10.0;</div>
<div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;    F2_div(2,1) = (1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1])*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1])*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1])*(12.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]+3.0)-3.0*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1])*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1])*(6.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]+3.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]+1.0);</div>
<div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;    F2_div(6,1) = <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1])*(-3.0)+(4.0-3.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1])*(-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]+3.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]));</div>
<div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;    F2_div(7,1) = <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1])*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1])*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1])*3.0+(-3.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1])*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1])+(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1])*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1])*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]))*(1.0+3.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]);</div>
<div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;    F2_div(12,1) = -1.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1])+3.0/2.0*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1])*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1])*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1];</div>
<div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;    F2_div(13,1) = -3.0/2.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1])*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]) + 1.0/2.0*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1])*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1])*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1])*2.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1];</div>
<div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;    </div>
<div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;    <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1] = 3.0/4.0;</div>
<div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;    H2[5] = -1.0*b1*(3.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]-2.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]);</div>
<div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;    H2[6] = -1.0/2.0*(2.0*b2+1.0+ata1)*(3.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]-2.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]);</div>
<div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;    H2[7] = -1.0/2.0*(1.0-ata1)*(1.0-3.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]+2.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]);</div>
<div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;    H2[8] = (1.0-3.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]+2.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]);</div>
<div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;    H2[11] = -1.0/2.0*((b1*b1)/(1.0+b2))*(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]);</div>
<div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;    H2[12] = 1.0/2.0*(b2+ata1)*(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]);</div>
<div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;    H2[13] = -1.0/2.0*( (2.0*c1*cc1)/(c1*cc2+c2*cc1) +1.0-ata1)*(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]-2.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]+<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]);</div>
<div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;    H2[14] = -1.0*((c2*cc2)/(c1*cc2+c2*cc1))*(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]-2.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]+<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]);</div>
<div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;    H2[16] = 1.0/2.0*(1.0/(1.0+b2))*(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]);</div>
<div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;    H2[17] = ((-1.0)/(c1*cc2+c2*cc1))*(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]-2.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]+<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]);</div>
<div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;21;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;     {</div>
<div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;      Bt(27,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>) = g1*F2_div(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>,1)+g2*H2[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>];</div>
<div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;     }</div>
<div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;     </div>
<div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;    <a class="code" href="cfortran_8h.html#af6f0bd3dc13317f895c91323c25c2b8f">t</a>[0] = p(0,0)-p(2,0) + 1.0/16.0*(p(1,0)-p(0,0))+1.0/32.0*(angle_max-angle_min)*(-3.0*sin(angle_min)+5.0*sin(angle_max));</div>
<div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;    <a class="code" href="cfortran_8h.html#af6f0bd3dc13317f895c91323c25c2b8f">t</a>[1] = p(0,1)-p(2,1) + 1.0/16.0*(p(1,1)-p(0,1))+1.0/32.0*(angle_max-angle_min)*(3.0*cos(angle_min)-5.0*cos(angle_max));</div>
<div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;    <a class="code" href="namespaceoomph_1_1VectorHelpers.html#af92401cf726dc1712b7fb861b8416e69">magnitude</a> = sqrt((p(1,0)-p(2,0))*(p(1,0)-p(2,0)) + (p(1,1)-p(2,1))*(p(1,1)-p(2,1)));</div>
<div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;    aa[0] = (p(1,0)-p(2,0))/(<a class="code" href="namespaceoomph_1_1VectorHelpers.html#af92401cf726dc1712b7fb861b8416e69">magnitude</a>*<a class="code" href="namespaceoomph_1_1VectorHelpers.html#af92401cf726dc1712b7fb861b8416e69">magnitude</a>);</div>
<div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;    aa[1] = (p(1,1)-p(2,1))/(<a class="code" href="namespaceoomph_1_1VectorHelpers.html#af92401cf726dc1712b7fb861b8416e69">magnitude</a>*<a class="code" href="namespaceoomph_1_1VectorHelpers.html#af92401cf726dc1712b7fb861b8416e69">magnitude</a>);</div>
<div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;    h1 = -1.0*(<a class="code" href="cfortran_8h.html#af6f0bd3dc13317f895c91323c25c2b8f">t</a>[0]*aa[0] + <a class="code" href="cfortran_8h.html#af6f0bd3dc13317f895c91323c25c2b8f">t</a>[1]*aa[1]);</div>
<div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;    </div>
<div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;    <a class="code" href="namespaceoomph_1_1VectorHelpers.html#af92401cf726dc1712b7fb861b8416e69">magnitude</a> = sqrt((p(0,0)-s1[0])*(p(0,0)-s1[0]) + (p(0,1)-s1[1])*(p(0,1)-s1[1]));</div>
<div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;    aa[0] = (p(0,0)-s1[0])/(<a class="code" href="namespaceoomph_1_1VectorHelpers.html#af92401cf726dc1712b7fb861b8416e69">magnitude</a>*<a class="code" href="namespaceoomph_1_1VectorHelpers.html#af92401cf726dc1712b7fb861b8416e69">magnitude</a>);</div>
<div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;    aa[1] = (p(0,1)-s1[1])/(<a class="code" href="namespaceoomph_1_1VectorHelpers.html#af92401cf726dc1712b7fb861b8416e69">magnitude</a>*<a class="code" href="namespaceoomph_1_1VectorHelpers.html#af92401cf726dc1712b7fb861b8416e69">magnitude</a>);</div>
<div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;    h2 = -1.0*(<a class="code" href="cfortran_8h.html#af6f0bd3dc13317f895c91323c25c2b8f">t</a>[0]*aa[0] + <a class="code" href="cfortran_8h.html#af6f0bd3dc13317f895c91323c25c2b8f">t</a>[1]*aa[1]);</div>
<div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;    </div>
<div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;    <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1] = 1.0/4.0;</div>
<div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;    F2_div(1,1) = 5.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*6.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]-4.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*15.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]+3.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*10.0;</div>
<div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;    F2_div(2,1) = (1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1])*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1])*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1])*(12.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]+3.0)-3.0*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1])*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1])*(6.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]+3.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]+1.0);</div>
<div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;    F2_div(6,1) = <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1])*(-3.0)+(4.0-3.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1])*(-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]+3.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]));</div>
<div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;    F2_div(7,1) = <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1])*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1])*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1])*3.0+(-3.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1])*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1])+(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1])*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1])*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]))*(1.0+3.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]);</div>
<div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;    F2_div(12,1) = -1.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1])+3.0/2.0*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1])*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1])*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1];</div>
<div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;    F2_div(13,1) = -3.0/2.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1])*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]) + 1.0/2.0*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1])*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1])*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1])*2.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1];</div>
<div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;    </div>
<div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;    <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1] = 1.0/4.0;</div>
<div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;    H2[5] = -1.0*b1*(3.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]-2.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]);</div>
<div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;    H2[6] = -1.0/2.0*(2.0*b2+1.0+ata1)*(3.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]-2.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]);</div>
<div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;    H2[7] = -1.0/2.0*(1.0-ata1)*(1.0-3.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]+2.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]);</div>
<div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;    H2[8] = (1.0-3.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]+2.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]);</div>
<div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;    H2[11] = -1.0/2.0*((b1*b1)/(1.0+b2))*(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]);</div>
<div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;    H2[12] = 1.0/2.0*(b2+ata1)*(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]);</div>
<div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;    H2[13] = -1.0/2.0*( (2.0*c1*cc1)/(c1*cc2+c2*cc1) +1.0-ata1)*(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]-2.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]+<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]);</div>
<div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;    H2[14] = -1.0*((c2*cc2)/(c1*cc2+c2*cc1))*(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]-2.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]+<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]);</div>
<div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;    H2[16] = 1.0/2.0*(1.0/(1.0+b2))*(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]);</div>
<div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;    H2[17] = ((-1.0)/(c1*cc2+c2*cc1))*(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]-2.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]+<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]);</div>
<div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160; </div>
<div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;21;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;     {</div>
<div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;      Bt(28,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>) = h1*F2_div(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>,1)+h2*H2[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>];</div>
<div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;     }</div>
<div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;     </div>
<div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;    <a class="code" href="cfortran_8h.html#af6f0bd3dc13317f895c91323c25c2b8f">t</a>[0] = p(1,0)-p(2,0) + 1.0/16.0*(p(0,0)-p(1,0))-1.0/32.0*(angle_max-angle_min)*(-3.0*sin(angle_max)+5.0*sin(angle_min));</div>
<div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;    <a class="code" href="cfortran_8h.html#af6f0bd3dc13317f895c91323c25c2b8f">t</a>[1] = p(1,1)-p(2,1) + 1.0/16.0*(p(0,1)-p(1,1))-1.0/32.0*(angle_max-angle_min)*(3.0*cos(angle_max)-5.0*cos(angle_min));</div>
<div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;    <a class="code" href="namespaceoomph_1_1VectorHelpers.html#af92401cf726dc1712b7fb861b8416e69">magnitude</a> = sqrt((p(0,0)-p(2,0))*(p(0,0)-p(2,0)) + (p(0,1)-p(2,1))*(p(0,1)-p(2,1)));</div>
<div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;    aa[0] = (p(0,0)-p(2,0))/(<a class="code" href="namespaceoomph_1_1VectorHelpers.html#af92401cf726dc1712b7fb861b8416e69">magnitude</a>*<a class="code" href="namespaceoomph_1_1VectorHelpers.html#af92401cf726dc1712b7fb861b8416e69">magnitude</a>);</div>
<div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;    aa[1] = (p(0,1)-p(2,1))/(<a class="code" href="namespaceoomph_1_1VectorHelpers.html#af92401cf726dc1712b7fb861b8416e69">magnitude</a>*<a class="code" href="namespaceoomph_1_1VectorHelpers.html#af92401cf726dc1712b7fb861b8416e69">magnitude</a>);</div>
<div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;    j1 = -1.0*(<a class="code" href="cfortran_8h.html#af6f0bd3dc13317f895c91323c25c2b8f">t</a>[0]*aa[0] + <a class="code" href="cfortran_8h.html#af6f0bd3dc13317f895c91323c25c2b8f">t</a>[1]*aa[1]);</div>
<div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;    </div>
<div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;    <a class="code" href="namespaceoomph_1_1VectorHelpers.html#af92401cf726dc1712b7fb861b8416e69">magnitude</a> = sqrt((p(1,0)-s2[0])*(p(1,0)-s2[0]) + (p(1,1)-s2[1])*(p(1,1)-s2[1]));</div>
<div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;    aa[0] = (p(1,0)-s2[0])/(<a class="code" href="namespaceoomph_1_1VectorHelpers.html#af92401cf726dc1712b7fb861b8416e69">magnitude</a>*<a class="code" href="namespaceoomph_1_1VectorHelpers.html#af92401cf726dc1712b7fb861b8416e69">magnitude</a>);</div>
<div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;    aa[1] = (p(1,1)-s2[1])/(<a class="code" href="namespaceoomph_1_1VectorHelpers.html#af92401cf726dc1712b7fb861b8416e69">magnitude</a>*<a class="code" href="namespaceoomph_1_1VectorHelpers.html#af92401cf726dc1712b7fb861b8416e69">magnitude</a>);</div>
<div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;    j2 = -1.0*(<a class="code" href="cfortran_8h.html#af6f0bd3dc13317f895c91323c25c2b8f">t</a>[0]*aa[0] + <a class="code" href="cfortran_8h.html#af6f0bd3dc13317f895c91323c25c2b8f">t</a>[1]*aa[1]);</div>
<div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;    </div>
<div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;    <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0] = 1.0/4.0;</div>
<div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;    F1_div(0,0) = 5.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*6.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]-4.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*15.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]+3.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*10.0;</div>
<div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;    F1_div(2,0) = (1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0])*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0])*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0])*(12.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]+3.0)-3.0*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0])*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0])*(6.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]+3.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]+1.0);</div>
<div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;    F1_div(3,0) = <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0])*(-3.0)+(4.0-3.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0])*(-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]+3.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]));</div>
<div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;    F1_div(8,0) = <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0])*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0])*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0])*3.0+(-3.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0])*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0])+(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0])*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0])*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]))*(1.0+3.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]);</div>
<div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;    F1_div(9,0) = -1.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0])+3.0/2.0*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0])*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0])*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0];</div>
<div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;    F1_div(14,0) = -3.0/2.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0])*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]) + 1.0/2.0*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0])*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0])*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0])*2.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0];</div>
<div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;    <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0] = 1.0/4.0;</div>
<div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;    H1[3] = -1.0/2.0*(1.0-ata2+2.0*a1)*(3.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]-2.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]);</div>
<div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;    H1[4] = -1.0*a2*(3.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]-2.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]);</div>
<div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;    H1[7] = 1.0-3.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]+2.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0];</div>
<div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;    H1[8] = -1.0/2.0*(1.0+ata2)*(1.0-3.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]+2.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]);</div>
<div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;    H1[9] = 1.0/2.0*(a1-ata2)*(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]);</div>
<div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;    H1[10] = -1.0/2.0*(a2*a2/(1.0+a1))*(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]);</div>
<div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;    H1[13] = ((-1.0*c1*cc1)/(c1*cc2+c2*cc1))*(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]-2.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]+<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]);</div>
<div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;    H1[14] = -1.0*( 1.0/2.0*(1.0+ata2)+(c2*cc2/(c1*cc2+c2*cc1)) )*(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]-2.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]+<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]);</div>
<div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;    H1[15] = (<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0])/(2.0*(1.0+a1));</div>
<div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;    H1[17] = -1.0/(c1*cc2+c2*cc1)*(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]-2.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]+<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]);</div>
<div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;21;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;     {</div>
<div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;      Bt(29,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>) = j1*F1_div(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>,0)+j2*H1[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>];</div>
<div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;     }</div>
<div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;    </div>
<div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;    <a class="code" href="cfortran_8h.html#af6f0bd3dc13317f895c91323c25c2b8f">t</a>[0] = p(1,0)-p(2,0) + 9.0/16.0*(p(0,0)-p(1,0))-3.0/32.0*(angle_max-angle_min)*(-sin(angle_max)+7.0*sin(angle_min));</div>
<div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;    <a class="code" href="cfortran_8h.html#af6f0bd3dc13317f895c91323c25c2b8f">t</a>[1] = p(1,1)-p(2,1) + 9.0/16.0*(p(0,1)-p(1,1))-3.0/32.0*(angle_max-angle_min)*(cos(angle_max)-7.0*cos(angle_min));</div>
<div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;    <a class="code" href="namespaceoomph_1_1VectorHelpers.html#af92401cf726dc1712b7fb861b8416e69">magnitude</a> = sqrt((p(0,0)-p(2,0))*(p(0,0)-p(2,0)) + (p(0,1)-p(2,1))*(p(0,1)-p(2,1)));</div>
<div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;    aa[0] = (p(0,0)-p(2,0))/(<a class="code" href="namespaceoomph_1_1VectorHelpers.html#af92401cf726dc1712b7fb861b8416e69">magnitude</a>*<a class="code" href="namespaceoomph_1_1VectorHelpers.html#af92401cf726dc1712b7fb861b8416e69">magnitude</a>);</div>
<div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;    aa[1] = (p(0,1)-p(2,1))/(<a class="code" href="namespaceoomph_1_1VectorHelpers.html#af92401cf726dc1712b7fb861b8416e69">magnitude</a>*<a class="code" href="namespaceoomph_1_1VectorHelpers.html#af92401cf726dc1712b7fb861b8416e69">magnitude</a>);</div>
<div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;    k1 = -1.0*(<a class="code" href="cfortran_8h.html#af6f0bd3dc13317f895c91323c25c2b8f">t</a>[0]*aa[0] + <a class="code" href="cfortran_8h.html#af6f0bd3dc13317f895c91323c25c2b8f">t</a>[1]*aa[1]);</div>
<div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;    </div>
<div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;    <a class="code" href="namespaceoomph_1_1VectorHelpers.html#af92401cf726dc1712b7fb861b8416e69">magnitude</a> = sqrt((p(1,0)-s2[0])*(p(1,0)-s2[0]) + (p(1,1)-s2[1])*(p(1,1)-s2[1]));</div>
<div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;    aa[0] = (p(1,0)-s2[0])/(<a class="code" href="namespaceoomph_1_1VectorHelpers.html#af92401cf726dc1712b7fb861b8416e69">magnitude</a>*<a class="code" href="namespaceoomph_1_1VectorHelpers.html#af92401cf726dc1712b7fb861b8416e69">magnitude</a>);</div>
<div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;    aa[1] = (p(1,1)-s2[1])/(<a class="code" href="namespaceoomph_1_1VectorHelpers.html#af92401cf726dc1712b7fb861b8416e69">magnitude</a>*<a class="code" href="namespaceoomph_1_1VectorHelpers.html#af92401cf726dc1712b7fb861b8416e69">magnitude</a>);</div>
<div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;    k2 = -1.0*(<a class="code" href="cfortran_8h.html#af6f0bd3dc13317f895c91323c25c2b8f">t</a>[0]*aa[0] + <a class="code" href="cfortran_8h.html#af6f0bd3dc13317f895c91323c25c2b8f">t</a>[1]*aa[1]);</div>
<div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;    </div>
<div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;    <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0] = 3.0/4.0;</div>
<div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;    F1_div(0,0) = 5.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*6.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]-4.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*15.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]+3.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*10.0;</div>
<div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;    F1_div(2,0) = (1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0])*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0])*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0])*(12.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]+3.0)-3.0*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0])*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0])*(6.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]+3.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]+1.0);</div>
<div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;    F1_div(3,0) = <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0])*(-3.0)+(4.0-3.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0])*(-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]+3.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]));</div>
<div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;    F1_div(8,0) = <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0])*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0])*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0])*3.0+(-3.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0])*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0])+(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0])*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0])*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]))*(1.0+3.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]);</div>
<div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;    F1_div(9,0) = -1.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0])+3.0/2.0*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0])*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0])*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0];</div>
<div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;    F1_div(14,0) = -3.0/2.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0])*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]) + 1.0/2.0*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0])*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0])*(1.0-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0])*2.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0];</div>
<div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;    </div>
<div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;    <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0] = 3.0/4.0;</div>
<div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;    H1[3] = -1.0/2.0*(1.0-ata2+2.0*a1)*(3.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]-2.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]);</div>
<div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;    H1[4] = -1.0*a2*(3.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]-2.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]);</div>
<div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;    H1[7] = 1.0-3.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]+2.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0];</div>
<div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;    H1[8] = -1.0/2.0*(1.0+ata2)*(1.0-3.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]+2.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]);</div>
<div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;    H1[9] = 1.0/2.0*(a1-ata2)*(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]);</div>
<div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;    H1[10] = -1.0/2.0*(a2*a2/(1.0+a1))*(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]);</div>
<div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;    H1[13] = ((-1.0*c1*cc1)/(c1*cc2+c2*cc1))*(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]-2.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]+<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]);</div>
<div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;    H1[14] = -1.0*( 1.0/2.0*(1.0+ata2)+(c2*cc2/(c1*cc2+c2*cc1)) )*(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]-2.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]+<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]);</div>
<div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;    H1[15] = (<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0])/(2.0*(1.0+a1));</div>
<div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;    H1[17] = -1.0/(c1*cc2+c2*cc1)*(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]-2.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]+<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]);</div>
<div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;21;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;     {</div>
<div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;      Bt(30,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>) = k1*F1_div(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>,0)+k2*H1[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>];</div>
<div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;     }</div>
<div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;    </div>
<div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;    <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0] = 3.0/4.0;</div>
<div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;    H3[3] = (3.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]-2.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]) - A*(-1.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]+<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]);</div>
<div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;    H3[4] = -1.0/2.0*(3.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]-2.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]) - (BB+1.0/2.0)*(-1.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]+<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]);</div>
<div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;    H3[5] = -1.0/2.0*(1.0-3.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]+2.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]) + 1.0/2.0*(C+1.0)*(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]-2.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]+<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]);</div>
<div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;    H3[6] = (1.0-3.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]+2.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]) + 1.0/2.0*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7da585070bd0e3801c3bbed287ef3c4a265">E</a>*(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]-2.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]+<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]);</div>
<div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;    H3[9] = (1.0+a1)/(2.0*a2)*(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]);</div>
<div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;    H3[10] = 1.0/2.0*(1.0+ a2/(1.0+a1))*(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]);</div>
<div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;    H3[11] = -1.0/2.0*(1.0+ b1/(1.0+b2) )*(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]-2.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]+<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]);</div>
<div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;    H3[12] = -1.0*(1.0+b2)/(2.0*b1)*(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]-2.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]+<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]);</div>
<div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;    H3[15] = -1.0/(2.0*(1.0+a1)*a2)*(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]);</div>
<div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;    H3[16] = 1.0/(2.0*b1*(1.0+b2))*(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]-2.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]+<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]);</div>
<div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160; </div>
<div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;21;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;21;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;     {</div>
<div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;      Bt(31,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>) = -1.0*sqrt(2.0)*H3[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>];</div>
<div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;     }</div>
<div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;    </div>
<div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;    <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0] = 1.0/4.0;</div>
<div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;    H3[3] = (3.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]-2.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]) - A*(-1.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]+<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]);</div>
<div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;    H3[4] = -1.0/2.0*(3.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]-2.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]) - (BB+1.0/2.0)*(-1.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]+<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]);</div>
<div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;    H3[5] = -1.0/2.0*(1.0-3.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]+2.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]) + 1.0/2.0*(C+1.0)*(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]-2.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]+<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]);</div>
<div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;    H3[6] = (1.0-3.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]+2.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]) + 1.0/2.0*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7da585070bd0e3801c3bbed287ef3c4a265">E</a>*(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]-2.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]+<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]);</div>
<div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;    H3[9] = (1.0+a1)/(2.0*a2)*(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]);</div>
<div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;    H3[10] = 1.0/2.0*(1.0+ a2/(1.0+a1))*(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]);</div>
<div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;    H3[11] = -1.0/2.0*(1.0+ b1/(1.0+b2) )*(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]-2.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]+<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]);</div>
<div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;    H3[12] = -1.0*(1.0+b2)/(2.0*b1)*(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]-2.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]+<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]);</div>
<div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;    H3[15] = -1.0/(2.0*(1.0+a1)*a2)*(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]-<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]);</div>
<div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;    H3[16] = 1.0/(2.0*b1*(1.0+b2))*(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]-2.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]+<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]);</div>
<div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160; </div>
<div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;21;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;     {</div>
<div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;      Bt(32,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>) = -1.0*sqrt(2.0)*H3[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>];</div>
<div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;     }</div>
<div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;    <span class="comment">// submatrix b7</span></div>
<div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;    Bt(33,18)=1.0;</div>
<div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;    Bt(34,19)=1.0;</div>
<div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;    Bt(35,20)=1.0;</div>
<div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;21;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;     {</div>
<div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> j=0;j&lt;36;j++)</div>
<div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;       {</div>
<div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;        <a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a43c804e2bcf9862a4bf629d5f01761e8">B</a>(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>,j) = Bt(j,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>);</div>
<div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;       }            </div>
<div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;     }</div>
<div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;   }</div>
<div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;<span class="comment"> ///=========================================================================</span></div>
<div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;<span class="comment"> /// Compute C1-curved shape functions at the local coordinate s</span></div>
<div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;<span class="comment"> ///========================================================================</span></div>
<div class="line"><a name="l02185"></a><span class="lineno"><a class="line" href="classoomph_1_1C1CurvedElementShape_3_012_00_01NNODE__1D_01_4.html#a3f5542eebff8cce73b2a6cd0487fa9b7"> 2185</a></span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1C1CurvedElementShape_3_012_00_01NNODE__1D_01_4.html#a3f5542eebff8cce73b2a6cd0487fa9b7">Cshape</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>, <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;psi_curve)<span class="keyword"> const</span></div>
<div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;   <span class="comment">// get basis</span></div>
<div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;   <a class="code" href="classoomph_1_1Shape.html">Shape</a> basis(36);</div>
<div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;   basis_curve(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,basis);</div>
<div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;   <span class="comment">// get coefficient of the basis polynomial</span></div>
<div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;   <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> A(36,36);</div>
<div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;   get_coefficient(A);</div>
<div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160; </div>
<div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;   <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> psi(36,0.0);</div>
<div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;36;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;    {</div>
<div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> j=0;j&lt;36;j++)</div>
<div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;      {</div>
<div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;       psi[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] += A(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>,j)*basis[j];</div>
<div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;      }</div>
<div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;    }</div>
<div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;36;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;    {</div>
<div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;     psi_curve[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] = psi[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>];</div>
<div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;    }</div>
<div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;  }</div>
<div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;<span class="comment"> ///=========================================================================</span></div>
<div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;<span class="comment"> /// Compute the derivatives of C1-curved shape functions at the local </span></div>
<div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;<span class="comment"> /// coordinate s</span></div>
<div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;<span class="comment"> ///=========================================================================</span></div>
<div class="line"><a name="l02212"></a><span class="lineno"><a class="line" href="classoomph_1_1C1CurvedElementShape_3_012_00_01NNODE__1D_01_4.html#aa2eae369074920a107f6117b3b152520"> 2212</a></span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1C1CurvedElementShape_3_012_00_01NNODE__1D_01_4.html#aa2eae369074920a107f6117b3b152520">dCshape_local</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>, <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;psi_curve, <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;dpsi_curve)<span class="keyword"> const </span></div>
<div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;   Cshape(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,psi_curve);</div>
<div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;   <span class="comment">// get dbasis</span></div>
<div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;   <a class="code" href="classoomph_1_1Shape.html">Shape</a> basis(36);</div>
<div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;   <a class="code" href="classoomph_1_1DShape.html">DShape</a> dbasis(36,2);</div>
<div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;   dbasis_local_curve(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,basis,dbasis);</div>
<div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;   <span class="comment">// get coefficient of the basis polynomial</span></div>
<div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;   <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> A(36,36);</div>
<div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;   get_coefficient(A);</div>
<div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;   <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> dpsi(36,2,0.0);</div>
<div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;36;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;    {</div>
<div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> j=0;j&lt;36;j++)</div>
<div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;      {</div>
<div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;       <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> k=0;k&lt;2;k++)</div>
<div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;        {</div>
<div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;         dpsi(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>,k) += A(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>,j)*dbasis(j,k);</div>
<div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;        }</div>
<div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;      }</div>
<div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160;    }</div>
<div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;36;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;    {</div>
<div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> k=0;k&lt;2;k++)</div>
<div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;      {</div>
<div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;       dpsi_curve(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>,k) = dpsi(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>,k);</div>
<div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;      }</div>
<div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;    }</div>
<div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;  }</div>
<div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;<span class="comment"> ///=========================================================================</span></div>
<div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;<span class="comment"> /// Compute the second-order derivatives of C1-curved shape functions  </span></div>
<div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;<span class="comment"> /// at the local coordinate s</span></div>
<div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;<span class="comment"> ///=========================================================================</span></div>
<div class="line"><a name="l02246"></a><span class="lineno"><a class="line" href="classoomph_1_1C1CurvedElementShape_3_012_00_01NNODE__1D_01_4.html#ae39e21f6c15e0544355c7b1119631409"> 2246</a></span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1C1CurvedElementShape_3_012_00_01NNODE__1D_01_4.html#ae39e21f6c15e0544355c7b1119631409">d2Cshape_local</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>, <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;psi_curve, <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;dpsi_curve, <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;d2psi_curve)<span class="keyword"> const</span></div>
<div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;   dCshape_local(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,psi_curve,dpsi_curve);</div>
<div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160; </div>
<div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;   <span class="comment">// get d2basis</span></div>
<div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;   <a class="code" href="classoomph_1_1Shape.html">Shape</a> basis(36);</div>
<div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;   <a class="code" href="classoomph_1_1DShape.html">DShape</a> dbasis(36,2), d2basis(36,3);</div>
<div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;   d2basis_local_curve(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,basis,dbasis,d2basis);</div>
<div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;   <span class="comment">// get coefficient of the basis polynomial</span></div>
<div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;   <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> A(36,36,0.0);</div>
<div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;   get_coefficient(A);</div>
<div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;   <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> d2psi(36,3,0.0);</div>
<div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;36;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;    {</div>
<div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> j=0;j&lt;36;j++)</div>
<div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160;      {</div>
<div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160;       <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> k=0;k&lt;3;k++)</div>
<div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160;        {</div>
<div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160;         d2psi(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>,k) += A(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>,j)*d2basis(j,k);</div>
<div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160;        }</div>
<div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160;      }</div>
<div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160;    }</div>
<div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;36;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160;    {</div>
<div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> k=0;k&lt;3;k++)</div>
<div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;      {</div>
<div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;       d2psi_curve(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>,k) = d2psi(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>,k);</div>
<div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;      }</div>
<div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160;    }</div>
<div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;  }</div>
<div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160;<span class="comment"> ///=========================================================================</span></div>
<div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160;<span class="comment"> /// Compute coefficients of the bases of the C1-curved shape functions </span></div>
<div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;<span class="comment"> ///=========================================================================</span></div>
<div class="line"><a name="l02280"></a><span class="lineno"><a class="line" href="classoomph_1_1C1CurvedElementShape_3_012_00_01NNODE__1D_01_4.html#a3029475256dcd92737fd5a3e01e5eb53"> 2280</a></span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1C1CurvedElementShape_3_012_00_01NNODE__1D_01_4.html#a3029475256dcd92737fd5a3e01e5eb53">get_coefficient</a>(<a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> &amp;A)<span class="keyword"> const</span></div>
<div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160;   <span class="comment">// initialize the matrix A</span></div>
<div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;36;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160;    {</div>
<div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> j=0;j&lt;36;j++)</div>
<div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160;      {A(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>,j)=0.0;}</div>
<div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160;    }</div>
<div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160;   <span class="comment">// 1</span></div>
<div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;   A(1,0) = 6496.0/27.0;</div>
<div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160;   A(1,2) = 55376.0/27.0;</div>
<div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160;   A(1,3) = 15296.0/3.0;</div>
<div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160;   A(1,4) = 86464.0/27.0;</div>
<div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160;   A(1,5) = 464.0/3.0;</div>
<div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;   A(1,8) = -6896.0/9.0;</div>
<div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160;   A(1,10) = -136424.0/27.0;</div>
<div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160;   A(1,11) = -187040.0/27.0;</div>
<div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;   A(1,12) = -27880.0/27.0;</div>
<div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;   A(1,15) = 7750.0/9.0;</div>
<div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;   A(1,17) = 98371.0/27.0;</div>
<div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;   A(1,18) = 41027.0/27.0;</div>
<div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160;   A(1,21) = -10501.0/27.0;</div>
<div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;   A(1,23) = -17323.0/27.0;</div>
<div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;   A(1,26) = 490.0/9.0;</div>
<div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;   A(0,2) = 464.0/3.0;</div>
<div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160;   A(0,3) = 86464.0/27.0;</div>
<div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;   A(0,4) = 15296.0/3.0;</div>
<div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160;   A(0,5) = 55376.0/27.0;</div>
<div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;   A(0,7) = 6496.0/27.0;</div>
<div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160;   A(0,10) = -27880.0/27.0;</div>
<div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160;   A(0,11) = -187040.0/27.0;</div>
<div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160;   A(0,12) = -136424.0/27.0;</div>
<div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160;   A(0,14) = -6896.0/9.0;</div>
<div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160;   A(0,17) = 41027.0/27.0;</div>
<div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160;   A(0,18) = 98371.0/27.0;</div>
<div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160;   A(0,20) = 7750.0/9.00;</div>
<div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160;   A(0,23) = -17323.0/27.0;</div>
<div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160;   A(0,25) = -10501.0/27.0;</div>
<div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160;   A(0,29) = 490.00/9.0;</div>
<div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160;   A(2,0) = -6496.00/27.0;</div>
<div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160;   A(2,2) = 14176.00/27.00;</div>
<div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160;   A(2,3) = -2944.00/27.00;</div>
<div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160;   A(2,4) = -2944.00/27.00;</div>
<div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160;   A(2,5) = 14176.00/27.00;</div>
<div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160;   A(2,7) = -6496.00/27.00;</div>
<div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;   A(2,8) = 24784.00/27.00;</div>
<div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;   A(2,10) = -5680.00/27.00;</div>
<div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160;   A(2,11) = 12736.00/9.00;</div>
<div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160;   A(2,12) = -5680.00/27.00;</div>
<div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160;   A(2,14) = 24784.00/27.00;</div>
<div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;   A(2,15) = -11846.00/9.00;</div>
<div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160;   A(2,17) = -26758.00/27.00;</div>
<div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160;   A(2,18) = -26758.00/27.00;</div>
<div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160;   A(2,20) = -11846.00/9.00;</div>
<div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160;   A(2,21) = 22789.00/27.00;</div>
<div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160;   A(2,23) = 18262.00/27.00;</div>
<div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160;   A(2,25) = 22789.00/27.00;</div>
<div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160;   A(2,26) = -5566.00/27.00;</div>
<div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;   A(2,29) = -5566.00/27.00;</div>
<div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160;   A(2,35) = 1.00;</div>
<div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160;   A(6,0) = -400.00/9.00;</div>
<div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160;   A(6,2) = -3080.00/9.00;</div>
<div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160;   A(6,3) = -816.00;</div>
<div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160;   A(6,4) = -4496.00/9.00;</div>
<div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160;   A(6,5) = -232.00/9.00;</div>
<div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160;   A(6,8) = 416.00/3.00;</div>
<div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160;   A(6,10) = 7448.00/9.00;</div>
<div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160;   A(6,11) = 9872.00/9.00;</div>
<div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160;   A(6,12) = 1472.00/9.00;</div>
<div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160;   A(6,15) = -457.00/3.00;</div>
<div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160;   A(6,17) = -1177.00/2.00;</div>
<div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160;   A(6,18) = -4337.00/18.00;</div>
<div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160;   A(6,21) = 607.00/9.00;</div>
<div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160;   A(6,23) = 619.00/6.00;</div>
<div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160;   A(6,26) = -28.00/3.00;</div>
<div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160;   A(5,1) = -896.00/9.00;</div>
<div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;   A(5,2) = -392.00/9.00;</div>
<div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;   A(5,3) = 2384.00/9.00;</div>
<div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160;   A(5,4) = 2512.00/9.00;</div>
<div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160;   A(5,5) = 232.00/9.00;</div>
<div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160;   A(5,9) = 2336.00/9.00;</div>
<div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160;   A(5,10) = -8.00/9.00;</div>
<div class="line"><a name="l02362"></a><span class="lineno"> 2362</span>&#160;   A(5,11) = -3920.00/9.00;</div>
<div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160;   A(5,12) = -976.00/9.00;</div>
<div class="line"><a name="l02364"></a><span class="lineno"> 2364</span>&#160;   A(5,16) = -2104.00/9.00;</div>
<div class="line"><a name="l02365"></a><span class="lineno"> 2365</span>&#160;   A(5,17) = 123.00/2.00;</div>
<div class="line"><a name="l02366"></a><span class="lineno"> 2366</span>&#160;   A(5,18) = 1981.00/18.00;</div>
<div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160;   A(5,22) = 766.00/9.00;</div>
<div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160;   A(5,23) = -307.00/18.00;</div>
<div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160;   A(5,27) = -31.00/3.00;</div>
<div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160;   A(4,2) = 232.00/9.00;</div>
<div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160;   A(4,3) = 2512.00/9.00;</div>
<div class="line"><a name="l02372"></a><span class="lineno"> 2372</span>&#160;   A(4,4) = 2384.00/9.00;</div>
<div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160;   A(4,5) = -392.00/9.00;</div>
<div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160;   A(4,6) = -896.00/9.00;</div>
<div class="line"><a name="l02375"></a><span class="lineno"> 2375</span>&#160;   A(4,10) = -976.00/9.00;</div>
<div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160;   A(4,11) = -3920.00/9.00;</div>
<div class="line"><a name="l02377"></a><span class="lineno"> 2377</span>&#160;   A(4,12) = -8.00/9.00;</div>
<div class="line"><a name="l02378"></a><span class="lineno"> 2378</span>&#160;   A(4,13) = 2336.00/9.00;</div>
<div class="line"><a name="l02379"></a><span class="lineno"> 2379</span>&#160;   A(4,17) = 1981.00/18.00;</div>
<div class="line"><a name="l02380"></a><span class="lineno"> 2380</span>&#160;   A(4,18) = 123.00/2.00;</div>
<div class="line"><a name="l02381"></a><span class="lineno"> 2381</span>&#160;   A(4,19) = -2104.00/9.00;</div>
<div class="line"><a name="l02382"></a><span class="lineno"> 2382</span>&#160;   A(4,23) = -307.00/18.00;</div>
<div class="line"><a name="l02383"></a><span class="lineno"> 2383</span>&#160;   A(4,24) = 766.00/9.00;</div>
<div class="line"><a name="l02384"></a><span class="lineno"> 2384</span>&#160;   A(4,28) = -31.00/3.00;</div>
<div class="line"><a name="l02385"></a><span class="lineno"> 2385</span>&#160;   A(3,2) = -232.00/9.00;</div>
<div class="line"><a name="l02386"></a><span class="lineno"> 2386</span>&#160;   A(3,3) = -4496.00/9.00;</div>
<div class="line"><a name="l02387"></a><span class="lineno"> 2387</span>&#160;   A(3,4) = -816.00;</div>
<div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160;   A(3,5) = -3080.00/9.00;</div>
<div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160;   A(3,7) = -400.00/9.00;</div>
<div class="line"><a name="l02390"></a><span class="lineno"> 2390</span>&#160;   <span class="comment">//------- 2</span></div>
<div class="line"><a name="l02391"></a><span class="lineno"> 2391</span>&#160;   A(3,10) = 1472.00/9.00;</div>
<div class="line"><a name="l02392"></a><span class="lineno"> 2392</span>&#160;   A(3,11) = 9872.00/9.00;</div>
<div class="line"><a name="l02393"></a><span class="lineno"> 2393</span>&#160;   A(3,12) = 7448.00/9.00;</div>
<div class="line"><a name="l02394"></a><span class="lineno"> 2394</span>&#160;   A(3,14) = 416.00/3.00;</div>
<div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160;   A(3,17) = -4337.00/18.00;</div>
<div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160;   A(3,18) = -1177.00/2.00;</div>
<div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160;   A(3,20) = -457.00/3.00;</div>
<div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160;   A(3,23) = 619.00/6.00;</div>
<div class="line"><a name="l02399"></a><span class="lineno"> 2399</span>&#160;   A(3,25) = 607.00/9.00;</div>
<div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160;   A(3,29) = -28.00/3.00;</div>
<div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160;   A(8,0) = -400.00/9.00;</div>
<div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160;   A(8,2) = 1456.00/9.00;</div>
<div class="line"><a name="l02403"></a><span class="lineno"> 2403</span>&#160;   A(8,3) = -992.00/9.00;</div>
<div class="line"><a name="l02404"></a><span class="lineno"> 2404</span>&#160;   A(8,4) = -5248.00/9.00;</div>
<div class="line"><a name="l02405"></a><span class="lineno"> 2405</span>&#160;   A(8,5) = -4096.00/9.00;</div>
<div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160;   A(8,6) = -896.00/9.00;</div>
<div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160;   A(8,8) = 1552.00/9.00;</div>
<div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160;   A(8,10) = -464.00/3.00;</div>
<div class="line"><a name="l02409"></a><span class="lineno"> 2409</span>&#160;   A(8,11) = 2464.00/3.00;</div>
<div class="line"><a name="l02410"></a><span class="lineno"> 2410</span>&#160;   A(8,12) = 3424.00/3.00;</div>
<div class="line"><a name="l02411"></a><span class="lineno"> 2411</span>&#160;   A(8,13) = 3040.00/9.00;</div>
<div class="line"><a name="l02412"></a><span class="lineno"> 2412</span>&#160;   A(8,15) = -761.00/3.00;</div>
<div class="line"><a name="l02413"></a><span class="lineno"> 2413</span>&#160;   A(8,17) = -1831.00/9.00;</div>
<div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160;   A(8,18) = -938.00;</div>
<div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160;   A(8,19) = -1288.00/3.00;</div>
<div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160;   A(8,21) = 1528.00/9.00;</div>
<div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160;   A(8,23) = 2266.00/9.00;</div>
<div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160;   A(8,24) = 2210.00/9.00;</div>
<div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160;   A(8,26) = -406.00/9.00;</div>
<div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160;   A(8,28) = -499.00/9.00;</div>
<div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160;   A(8,33) = 1.00;</div>
<div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160;   A(7,1) = -896.00/9.00;</div>
<div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160;   A(7,2) = -4096.00/9.00;</div>
<div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160;   A(7,3) = -5248.00/9.00;</div>
<div class="line"><a name="l02425"></a><span class="lineno"> 2425</span>&#160;   A(7,4) = -992.00/9.00;</div>
<div class="line"><a name="l02426"></a><span class="lineno"> 2426</span>&#160;   A(7,5) = 1456.00/9.00;</div>
<div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160;   A(7,7) = -400.00/9.00;</div>
<div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160;   A(7,9) = 3040.00/9.00;</div>
<div class="line"><a name="l02429"></a><span class="lineno"> 2429</span>&#160;   A(7,10) = 3424.00/3.00;</div>
<div class="line"><a name="l02430"></a><span class="lineno"> 2430</span>&#160;   A(7,11) = 2464.00/3.00;</div>
<div class="line"><a name="l02431"></a><span class="lineno"> 2431</span>&#160;   A(7,12) = -464.00/3.00;</div>
<div class="line"><a name="l02432"></a><span class="lineno"> 2432</span>&#160;   A(7,14) = 1552.00/9.00;</div>
<div class="line"><a name="l02433"></a><span class="lineno"> 2433</span>&#160;   A(7,16) = -1288.00/3.00;</div>
<div class="line"><a name="l02434"></a><span class="lineno"> 2434</span>&#160;   A(7,17) = -938.00;</div>
<div class="line"><a name="l02435"></a><span class="lineno"> 2435</span>&#160;   A(7,18) = -1831.00/9.00;</div>
<div class="line"><a name="l02436"></a><span class="lineno"> 2436</span>&#160;   A(7,20) = -761.00/3.00;</div>
<div class="line"><a name="l02437"></a><span class="lineno"> 2437</span>&#160;   A(7,22) = 2210.00/9.00;</div>
<div class="line"><a name="l02438"></a><span class="lineno"> 2438</span>&#160;   A(7,23) = 2266.00/9.00;</div>
<div class="line"><a name="l02439"></a><span class="lineno"> 2439</span>&#160;   A(7,25) = 1528.00/9.00;</div>
<div class="line"><a name="l02440"></a><span class="lineno"> 2440</span>&#160;   A(7,27) = -499.00/9.00;</div>
<div class="line"><a name="l02441"></a><span class="lineno"> 2441</span>&#160;   A(7,29) = -406.00/9.00;</div>
<div class="line"><a name="l02442"></a><span class="lineno"> 2442</span>&#160;   A(7,34) = 1.00;</div>
<div class="line"><a name="l02443"></a><span class="lineno"> 2443</span>&#160;   A(14,0) = 8.00/3.00;</div>
<div class="line"><a name="l02444"></a><span class="lineno"> 2444</span>&#160;   A(14,2) = 52.00/3.00;</div>
<div class="line"><a name="l02445"></a><span class="lineno"> 2445</span>&#160;   A(14,3) = 40.00;</div>
<div class="line"><a name="l02446"></a><span class="lineno"> 2446</span>&#160;   A(14,4) = 24.00;</div>
<div class="line"><a name="l02447"></a><span class="lineno"> 2447</span>&#160;   A(14,5) = 4.00/3.00;</div>
<div class="line"><a name="l02448"></a><span class="lineno"> 2448</span>&#160;   A(14,8) = -8.00;</div>
<div class="line"><a name="l02449"></a><span class="lineno"> 2449</span>&#160;   A(14,10) = -124.00/3.00;</div>
<div class="line"><a name="l02450"></a><span class="lineno"> 2450</span>&#160;   A(14,11) = -160.00/3.00;</div>
<div class="line"><a name="l02451"></a><span class="lineno"> 2451</span>&#160;   A(14,12) = -8.00;</div>
<div class="line"><a name="l02452"></a><span class="lineno"> 2452</span>&#160;   A(14,15) = 17.00/2.00;</div>
<div class="line"><a name="l02453"></a><span class="lineno"> 2453</span>&#160;   A(14,17) = 349.00/12.00;</div>
<div class="line"><a name="l02454"></a><span class="lineno"> 2454</span>&#160;   A(14,18) = 47.00/4.00;</div>
<div class="line"><a name="l02455"></a><span class="lineno"> 2455</span>&#160;   A(14,21) = -11.00/3.00;</div>
<div class="line"><a name="l02456"></a><span class="lineno"> 2456</span>&#160;   A(14,23) = -61.00/12.00;</div>
<div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160;   A(14,26) = 1.00/2.00;</div>
<div class="line"><a name="l02458"></a><span class="lineno"> 2458</span>&#160;   A(13,1) = 32.00/3.00;</div>
<div class="line"><a name="l02459"></a><span class="lineno"> 2459</span>&#160;   A(13,2) = 8.00/3.00;</div>
<div class="line"><a name="l02460"></a><span class="lineno"> 2460</span>&#160;   A(13,3) = -80.00/3.00;</div>
<div class="line"><a name="l02461"></a><span class="lineno"> 2461</span>&#160;   A(13,4) = -80.00/3.00;</div>
<div class="line"><a name="l02462"></a><span class="lineno"> 2462</span>&#160;   A(13,5) = -8.00/3.00;</div>
<div class="line"><a name="l02463"></a><span class="lineno"> 2463</span>&#160;   A(13,9) = -80.00/3.00;</div>
<div class="line"><a name="l02464"></a><span class="lineno"> 2464</span>&#160;   A(13,10) = 8.00/3.00;</div>
<div class="line"><a name="l02465"></a><span class="lineno"> 2465</span>&#160;   A(13,11) = 128.00/3.00;</div>
<div class="line"><a name="l02466"></a><span class="lineno"> 2466</span>&#160;   A(13,12) = 32.00/3.00;</div>
<div class="line"><a name="l02467"></a><span class="lineno"> 2467</span>&#160;   A(13,16) = 70.00/3.0;</div>
<div class="line"><a name="l02468"></a><span class="lineno"> 2468</span>&#160;   A(13,17) = -43.0/6.0;</div>
<div class="line"><a name="l02469"></a><span class="lineno"> 2469</span>&#160;   A(13,18) = -65.0/6.0;</div>
<div class="line"><a name="l02470"></a><span class="lineno"> 2470</span>&#160;   A(13,22) = -25.0/3.0;</div>
<div class="line"><a name="l02471"></a><span class="lineno"> 2471</span>&#160;   A(13,23) = 11.0/6.0;</div>
<div class="line"><a name="l02472"></a><span class="lineno"> 2472</span>&#160;   A(13,27) = 1.0;</div>
<div class="line"><a name="l02473"></a><span class="lineno"> 2473</span>&#160;   A(12,2) = 4.0;</div>
<div class="line"><a name="l02474"></a><span class="lineno"> 2474</span>&#160;   A(12,3) = 40.0/3.0;</div>
<div class="line"><a name="l02475"></a><span class="lineno"> 2475</span>&#160;   A(12,4) = 40.0/3.0;</div>
<div class="line"><a name="l02476"></a><span class="lineno"> 2476</span>&#160;   A(12,5) = 4.0/3.0;</div>
<div class="line"><a name="l02477"></a><span class="lineno"> 2477</span>&#160;   A(12,10) = -28.0/3.0;</div>
<div class="line"><a name="l02478"></a><span class="lineno"> 2478</span>&#160;   A(12,11) = -64.0/3.0;</div>
<div class="line"><a name="l02479"></a><span class="lineno"> 2479</span>&#160;   A(12,12) = -16.0/3.0;</div>
<div class="line"><a name="l02480"></a><span class="lineno"> 2480</span>&#160;   A(12,17) = 29.0/4.0;</div>
<div class="line"><a name="l02481"></a><span class="lineno"> 2481</span>&#160;   A(12,18) = 65.0/12.0;</div>
<div class="line"><a name="l02482"></a><span class="lineno"> 2482</span>&#160;   A(12,23) = -17.0/12.0;</div>
<div class="line"><a name="l02483"></a><span class="lineno"> 2483</span>&#160;   A(11,2) = 4.0/3.0;</div>
<div class="line"><a name="l02484"></a><span class="lineno"> 2484</span>&#160;   A(11,3) = 40.0/3.0;</div>
<div class="line"><a name="l02485"></a><span class="lineno"> 2485</span>&#160;   A(11,4) = 40.0/3.0;</div>
<div class="line"><a name="l02486"></a><span class="lineno"> 2486</span>&#160;   A(11,5) = 4.0;</div>
<div class="line"><a name="l02487"></a><span class="lineno"> 2487</span>&#160;   A(11,10) = -16.0/3.0;</div>
<div class="line"><a name="l02488"></a><span class="lineno"> 2488</span>&#160;   A(11,11) = -64.0/3.0;</div>
<div class="line"><a name="l02489"></a><span class="lineno"> 2489</span>&#160;   A(11,12) = -28.0/3.0;</div>
<div class="line"><a name="l02490"></a><span class="lineno"> 2490</span>&#160;   A(11,17) = 65.0/12.0;</div>
<div class="line"><a name="l02491"></a><span class="lineno"> 2491</span>&#160;   A(11,18) = 29.0/4.0;</div>
<div class="line"><a name="l02492"></a><span class="lineno"> 2492</span>&#160;   A(11,23) = -17.0/12.0;</div>
<div class="line"><a name="l02493"></a><span class="lineno"> 2493</span>&#160;   <span class="comment">//------- 3</span></div>
<div class="line"><a name="l02494"></a><span class="lineno"> 2494</span>&#160;   A(10,2) = -8.0/3.0;</div>
<div class="line"><a name="l02495"></a><span class="lineno"> 2495</span>&#160;   A(10,3) = -80.0/3.0;</div>
<div class="line"><a name="l02496"></a><span class="lineno"> 2496</span>&#160;   A(10,4) = -80.0/3.0;</div>
<div class="line"><a name="l02497"></a><span class="lineno"> 2497</span>&#160;   A(10,5) = 8.0/3.0;</div>
<div class="line"><a name="l02498"></a><span class="lineno"> 2498</span>&#160;   A(10,6) = 32.0/3.0;</div>
<div class="line"><a name="l02499"></a><span class="lineno"> 2499</span>&#160;   A(10,10) = 32.0/3.0;</div>
<div class="line"><a name="l02500"></a><span class="lineno"> 2500</span>&#160;   A(10,11) = 128.0/3.0;</div>
<div class="line"><a name="l02501"></a><span class="lineno"> 2501</span>&#160;   A(10,12) = 8.0/3.0;</div>
<div class="line"><a name="l02502"></a><span class="lineno"> 2502</span>&#160;   A(10,13) = -80.0/3.0;</div>
<div class="line"><a name="l02503"></a><span class="lineno"> 2503</span>&#160;   A(10,17) = -65.0/6.0;</div>
<div class="line"><a name="l02504"></a><span class="lineno"> 2504</span>&#160;   A(10,18) = -43.0/6.0;</div>
<div class="line"><a name="l02505"></a><span class="lineno"> 2505</span>&#160;   A(10,19) = 70.0/3.0;</div>
<div class="line"><a name="l02506"></a><span class="lineno"> 2506</span>&#160;   A(10,23) = 11.0/6.0;</div>
<div class="line"><a name="l02507"></a><span class="lineno"> 2507</span>&#160;   A(10,24) = -25.0/3.0;</div>
<div class="line"><a name="l02508"></a><span class="lineno"> 2508</span>&#160;   A(10,28) = 1.0;</div>
<div class="line"><a name="l02509"></a><span class="lineno"> 2509</span>&#160;   A(9,2) = 4.0/3.0;</div>
<div class="line"><a name="l02510"></a><span class="lineno"> 2510</span>&#160;   A(9,3) = 24.0;</div>
<div class="line"><a name="l02511"></a><span class="lineno"> 2511</span>&#160;   A(9,4) = 40.0;</div>
<div class="line"><a name="l02512"></a><span class="lineno"> 2512</span>&#160;   A(9,5) = 52.0/3.0;</div>
<div class="line"><a name="l02513"></a><span class="lineno"> 2513</span>&#160;   A(9,7) = 8.0/3.0;</div>
<div class="line"><a name="l02514"></a><span class="lineno"> 2514</span>&#160;   A(9,10) = -8.0;</div>
<div class="line"><a name="l02515"></a><span class="lineno"> 2515</span>&#160;   A(9,11) = -160.0/3.0;</div>
<div class="line"><a name="l02516"></a><span class="lineno"> 2516</span>&#160;   A(9,12) = -124.0/3.0;</div>
<div class="line"><a name="l02517"></a><span class="lineno"> 2517</span>&#160;   A(9,14) = -8.0;</div>
<div class="line"><a name="l02518"></a><span class="lineno"> 2518</span>&#160;   A(9,17) = 47.0/4.0;</div>
<div class="line"><a name="l02519"></a><span class="lineno"> 2519</span>&#160;   A(9,18) = 349.0/12.0;</div>
<div class="line"><a name="l02520"></a><span class="lineno"> 2520</span>&#160;   A(9,20) = 17.0/2.0;</div>
<div class="line"><a name="l02521"></a><span class="lineno"> 2521</span>&#160;   A(9,23) = -61.0/12.0;</div>
<div class="line"><a name="l02522"></a><span class="lineno"> 2522</span>&#160;   A(9,25) = -11.0/3.0;</div>
<div class="line"><a name="l02523"></a><span class="lineno"> 2523</span>&#160;   A(9,29) = 1.0/2.0;</div>
<div class="line"><a name="l02524"></a><span class="lineno"> 2524</span>&#160;   A(17,0) = -8.0/3.0;</div>
<div class="line"><a name="l02525"></a><span class="lineno"> 2525</span>&#160;   A(17,2) = 56.0/3.0;</div>
<div class="line"><a name="l02526"></a><span class="lineno"> 2526</span>&#160;   A(17,3) = 80.0/3.0;</div>
<div class="line"><a name="l02527"></a><span class="lineno"> 2527</span>&#160;   A(17,4) = 32.0/3.0;</div>
<div class="line"><a name="l02528"></a><span class="lineno"> 2528</span>&#160;   A(17,8) = 32.0/3.0;</div>
<div class="line"><a name="l02529"></a><span class="lineno"> 2529</span>&#160;   A(17,10) = -40.0;</div>
<div class="line"><a name="l02530"></a><span class="lineno"> 2530</span>&#160;   A(17,11) = -32.0;</div>
<div class="line"><a name="l02531"></a><span class="lineno"> 2531</span>&#160;   A(17,12) = -8.0/3.0;</div>
<div class="line"><a name="l02532"></a><span class="lineno"> 2532</span>&#160;   A(17,15) = -33.0/2.0;</div>
<div class="line"><a name="l02533"></a><span class="lineno"> 2533</span>&#160;   A(17,17) = 51.0/2.0;</div>
<div class="line"><a name="l02534"></a><span class="lineno"> 2534</span>&#160;   A(17,18) = 19.0/3.0;</div>
<div class="line"><a name="l02535"></a><span class="lineno"> 2535</span>&#160;   A(17,21) = 73.0/6.0;</div>
<div class="line"><a name="l02536"></a><span class="lineno"> 2536</span>&#160;   A(17,23) = -25.0/6.0;</div>
<div class="line"><a name="l02537"></a><span class="lineno"> 2537</span>&#160;   A(17,26) = -25.0/6.0;</div>
<div class="line"><a name="l02538"></a><span class="lineno"> 2538</span>&#160;   A(17,30) = 1.0/2.0;</div>
<div class="line"><a name="l02539"></a><span class="lineno"> 2539</span>&#160;   A(16,1) = -32.0/3.0;</div>
<div class="line"><a name="l02540"></a><span class="lineno"> 2540</span>&#160;   A(16,2) = -160.0/3.0;</div>
<div class="line"><a name="l02541"></a><span class="lineno"> 2541</span>&#160;   A(16,3) = -320.0/3.0;</div>
<div class="line"><a name="l02542"></a><span class="lineno"> 2542</span>&#160;   A(16,4) = -320.0/3.0;</div>
<div class="line"><a name="l02543"></a><span class="lineno"> 2543</span>&#160;   A(16,5) = -160.0/3.0;</div>
<div class="line"><a name="l02544"></a><span class="lineno"> 2544</span>&#160;   A(16,6) = -32.0/3.0;</div>
<div class="line"><a name="l02545"></a><span class="lineno"> 2545</span>&#160;   A(16,9) = 112.0/3.0;</div>
<div class="line"><a name="l02546"></a><span class="lineno"> 2546</span>&#160;   A(16,10) = 448.0/3.0;</div>
<div class="line"><a name="l02547"></a><span class="lineno"> 2547</span>&#160;   A(16,11) = 224.0;</div>
<div class="line"><a name="l02548"></a><span class="lineno"> 2548</span>&#160;   A(16,12) = 448.0/3.0;</div>
<div class="line"><a name="l02549"></a><span class="lineno"> 2549</span>&#160;   A(16,13) = 112.0/3.0;</div>
<div class="line"><a name="l02550"></a><span class="lineno"> 2550</span>&#160;   A(16,16) = -50.0;</div>
<div class="line"><a name="l02551"></a><span class="lineno"> 2551</span>&#160;   A(16,17) = -150.0;</div>
<div class="line"><a name="l02552"></a><span class="lineno"> 2552</span>&#160;   A(16,18) = -150.0;</div>
<div class="line"><a name="l02553"></a><span class="lineno"> 2553</span>&#160;   A(16,19) = -50.0;</div>
<div class="line"><a name="l02554"></a><span class="lineno"> 2554</span>&#160;   A(16,22) = 95.0/3.0;</div>
<div class="line"><a name="l02555"></a><span class="lineno"> 2555</span>&#160;   A(16,23) = 190.0/3.0;</div>
<div class="line"><a name="l02556"></a><span class="lineno"> 2556</span>&#160;   A(16,24) = 95.0/3.0;</div>
<div class="line"><a name="l02557"></a><span class="lineno"> 2557</span>&#160;   A(16,27) = -28.0/3.0;</div>
<div class="line"><a name="l02558"></a><span class="lineno"> 2558</span>&#160;   A(16,28) = -28.0/3.0;</div>
<div class="line"><a name="l02559"></a><span class="lineno"> 2559</span>&#160;   A(16,31) = 1.0;</div>
<div class="line"><a name="l02560"></a><span class="lineno"> 2560</span>&#160;   A(15,3) = 32.0/3.0;</div>
<div class="line"><a name="l02561"></a><span class="lineno"> 2561</span>&#160;   A(15,4) = 80.0/3.0;</div>
<div class="line"><a name="l02562"></a><span class="lineno"> 2562</span>&#160;   A(15,5) = 56.0/3.0;</div>
<div class="line"><a name="l02563"></a><span class="lineno"> 2563</span>&#160;   A(15,7) = -8.0/3.0;</div>
<div class="line"><a name="l02564"></a><span class="lineno"> 2564</span>&#160;   A(15,10) = -8.0/3.0;</div>
<div class="line"><a name="l02565"></a><span class="lineno"> 2565</span>&#160;   A(15,11) = -32.0;</div>
<div class="line"><a name="l02566"></a><span class="lineno"> 2566</span>&#160;   A(15,12) = -40.0;</div>
<div class="line"><a name="l02567"></a><span class="lineno"> 2567</span>&#160;   A(15,14) = 32.0/3.0;</div>
<div class="line"><a name="l02568"></a><span class="lineno"> 2568</span>&#160;   A(15,17) = 19.0/3.0;</div>
<div class="line"><a name="l02569"></a><span class="lineno"> 2569</span>&#160;   A(15,18) = 51.0/2.0;</div>
<div class="line"><a name="l02570"></a><span class="lineno"> 2570</span>&#160;   A(15,20) = -33.0/2.0;</div>
<div class="line"><a name="l02571"></a><span class="lineno"> 2571</span>&#160;   A(15,23) = -25.0/6.0;</div>
<div class="line"><a name="l02572"></a><span class="lineno"> 2572</span>&#160;   A(15,25) = 73.0/6.0;</div>
<div class="line"><a name="l02573"></a><span class="lineno"> 2573</span>&#160;   A(15,29) = -25.0/6.0;</div>
<div class="line"><a name="l02574"></a><span class="lineno"> 2574</span>&#160;   A(15,32) = 1.0/2.0;</div>
<div class="line"><a name="l02575"></a><span class="lineno"> 2575</span>&#160;   A(19,3) = 256.0;</div>
<div class="line"><a name="l02576"></a><span class="lineno"> 2576</span>&#160;   A(19,4) = 768.0;</div>
<div class="line"><a name="l02577"></a><span class="lineno"> 2577</span>&#160;   A(19,5) = 768.0;</div>
<div class="line"><a name="l02578"></a><span class="lineno"> 2578</span>&#160;   A(19,6) = 256.0;</div>
<div class="line"><a name="l02579"></a><span class="lineno"> 2579</span>&#160;   A(19,10) = -64.0;</div>
<div class="line"><a name="l02580"></a><span class="lineno"> 2580</span>&#160;   A(19,11) = -896.0;</div>
<div class="line"><a name="l02581"></a><span class="lineno"> 2581</span>&#160;   A(19,12) = -1600.0;</div>
<div class="line"><a name="l02582"></a><span class="lineno"> 2582</span>&#160;   A(19,13) = -768.0;</div>
<div class="line"><a name="l02583"></a><span class="lineno"> 2583</span>&#160;   A(19,17) = 176.0;</div>
<div class="line"><a name="l02584"></a><span class="lineno"> 2584</span>&#160;   A(19,18) = 992.0;</div>
<div class="line"><a name="l02585"></a><span class="lineno"> 2585</span>&#160;   A(19,19) = 816.0;</div>
<div class="line"><a name="l02586"></a><span class="lineno"> 2586</span>&#160;   A(19,23) = -160.0;</div>
<div class="line"><a name="l02587"></a><span class="lineno"> 2587</span>&#160;   A(19,24) = -352.0;</div>
<div class="line"><a name="l02588"></a><span class="lineno"> 2588</span>&#160;   A(19,28) = 48.0;</div>
<div class="line"><a name="l02589"></a><span class="lineno"> 2589</span>&#160;   A(18,1) = 256.0;</div>
<div class="line"><a name="l02590"></a><span class="lineno"> 2590</span>&#160;   A(18,2) = 768.0;</div>
<div class="line"><a name="l02591"></a><span class="lineno"> 2591</span>&#160;   A(18,3) = 768.0;</div>
<div class="line"><a name="l02592"></a><span class="lineno"> 2592</span>&#160;   A(18,4) = 256.0;</div>
<div class="line"><a name="l02593"></a><span class="lineno"> 2593</span>&#160;   A(18,9) = -768.0;</div>
<div class="line"><a name="l02594"></a><span class="lineno"> 2594</span>&#160;   A(18,10) =-1600.0;</div>
<div class="line"><a name="l02595"></a><span class="lineno"> 2595</span>&#160;   A(18,11) = -896.0;</div>
<div class="line"><a name="l02596"></a><span class="lineno"> 2596</span>&#160; </div>
<div class="line"><a name="l02597"></a><span class="lineno"> 2597</span>&#160;   <span class="comment">//--------- 4</span></div>
<div class="line"><a name="l02598"></a><span class="lineno"> 2598</span>&#160;   A(18,12) = -64.0;</div>
<div class="line"><a name="l02599"></a><span class="lineno"> 2599</span>&#160;   A(18,16) = 816.0;</div>
<div class="line"><a name="l02600"></a><span class="lineno"> 2600</span>&#160;   A(18,17) = 992.0;</div>
<div class="line"><a name="l02601"></a><span class="lineno"> 2601</span>&#160;   A(18,18) = 176.0;</div>
<div class="line"><a name="l02602"></a><span class="lineno"> 2602</span>&#160;   A(18,22) = -352.0;</div>
<div class="line"><a name="l02603"></a><span class="lineno"> 2603</span>&#160;   A(18,23) = -160.0;</div>
<div class="line"><a name="l02604"></a><span class="lineno"> 2604</span>&#160;   A(18,27) = 48.0;</div>
<div class="line"><a name="l02605"></a><span class="lineno"> 2605</span>&#160;   A(20,3) = 128.0*sqrt(2.0);</div>
<div class="line"><a name="l02606"></a><span class="lineno"> 2606</span>&#160;   A(20,4) = 128.0*sqrt(2.0);</div>
<div class="line"><a name="l02607"></a><span class="lineno"> 2607</span>&#160;   A(20,10) = -32.0*sqrt(2.0);</div>
<div class="line"><a name="l02608"></a><span class="lineno"> 2608</span>&#160;   A(20,11) = -192.0*sqrt(2.0);</div>
<div class="line"><a name="l02609"></a><span class="lineno"> 2609</span>&#160;   A(20,12) = -32.0*sqrt(2.0);</div>
<div class="line"><a name="l02610"></a><span class="lineno"> 2610</span>&#160;   A(20,17) = 40.0*sqrt(2.0);</div>
<div class="line"><a name="l02611"></a><span class="lineno"> 2611</span>&#160;   A(20,18) = 40.0*sqrt(2.0);</div>
<div class="line"><a name="l02612"></a><span class="lineno"> 2612</span>&#160;   A(20,23) = -8.0*sqrt(2.0);</div>
<div class="line"><a name="l02613"></a><span class="lineno"> 2613</span>&#160;   A(24,3) = -65536.0/27.0;</div>
<div class="line"><a name="l02614"></a><span class="lineno"> 2614</span>&#160;   A(24,4) = -114688.0/27.0;</div>
<div class="line"><a name="l02615"></a><span class="lineno"> 2615</span>&#160;   A(24,5) = -40960.0/27.0;</div>
<div class="line"><a name="l02616"></a><span class="lineno"> 2616</span>&#160;   A(24,7) = -8192.0/27.0;</div>
<div class="line"><a name="l02617"></a><span class="lineno"> 2617</span>&#160;   A(24,10) = 16384.0/27.0;</div>
<div class="line"><a name="l02618"></a><span class="lineno"> 2618</span>&#160;   A(24,11) = 53248./9.0;</div>
<div class="line"><a name="l02619"></a><span class="lineno"> 2619</span>&#160;   A(24,12) = 38912.0/9.0;</div>
<div class="line"><a name="l02620"></a><span class="lineno"> 2620</span>&#160;   A(24,14) = 26624.0/27.0;</div>
<div class="line"><a name="l02621"></a><span class="lineno"> 2621</span>&#160;   A(24,17) = -32768.0/27.0;</div>
<div class="line"><a name="l02622"></a><span class="lineno"> 2622</span>&#160;   A(24,18) = -10240.0/3.0;</div>
<div class="line"><a name="l02623"></a><span class="lineno"> 2623</span>&#160;   A(24,20) = -10240.0/9.0;</div>
<div class="line"><a name="l02624"></a><span class="lineno"> 2624</span>&#160;   A(24,23) = 16384.0/27.0;</div>
<div class="line"><a name="l02625"></a><span class="lineno"> 2625</span>&#160;   A(24,25) = 14336.0/27.0;</div>
<div class="line"><a name="l02626"></a><span class="lineno"> 2626</span>&#160;   A(24,29) = -2048.0/27.0;</div>
<div class="line"><a name="l02627"></a><span class="lineno"> 2627</span>&#160;   A(23,2) = 53248.0/27.0;</div>
<div class="line"><a name="l02628"></a><span class="lineno"> 2628</span>&#160;   A(23,3) = 40960.0/9.0;</div>
<div class="line"><a name="l02629"></a><span class="lineno"> 2629</span>&#160;   A(23,4) = 69632.0/27.0;</div>
<div class="line"><a name="l02630"></a><span class="lineno"> 2630</span>&#160;   A(23,5) = -8192.0/27.0;</div>
<div class="line"><a name="l02631"></a><span class="lineno"> 2631</span>&#160;   A(23,7) = 8192.0/27.0;</div>
<div class="line"><a name="l02632"></a><span class="lineno"> 2632</span>&#160;   A(23,10) = -48128.0/9.0;</div>
<div class="line"><a name="l02633"></a><span class="lineno"> 2633</span>&#160;   A(23,11) = -22528.0/3.0;</div>
<div class="line"><a name="l02634"></a><span class="lineno"> 2634</span>&#160;   A(23,12) = -1024.0;</div>
<div class="line"><a name="l02635"></a><span class="lineno"> 2635</span>&#160;   A(23,14) = -10240.0/9.0;</div>
<div class="line"><a name="l02636"></a><span class="lineno"> 2636</span>&#160;   A(23,17) = 14336.0/3.0;</div>
<div class="line"><a name="l02637"></a><span class="lineno"> 2637</span>&#160;   A(23,18) = 8192.0/3.0;</div>
<div class="line"><a name="l02638"></a><span class="lineno"> 2638</span>&#160;   A(23,20) = 14336.0/9.0;</div>
<div class="line"><a name="l02639"></a><span class="lineno"> 2639</span>&#160;   A(23,23) = -37888.0/27.0;</div>
<div class="line"><a name="l02640"></a><span class="lineno"> 2640</span>&#160;   A(23,25) = -26624.0/27.0;</div>
<div class="line"><a name="l02641"></a><span class="lineno"> 2641</span>&#160;   A(23,29) = 2048.0/9.0;</div>
<div class="line"><a name="l02642"></a><span class="lineno"> 2642</span>&#160;   A(22,0) = 8192.0/27.0;</div>
<div class="line"><a name="l02643"></a><span class="lineno"> 2643</span>&#160;   A(22,2) = -8192.0/27.0;</div>
<div class="line"><a name="l02644"></a><span class="lineno"> 2644</span>&#160;   A(22,3) = 69632.0/27.0;</div>
<div class="line"><a name="l02645"></a><span class="lineno"> 2645</span>&#160;   A(22,4) = 40960.0/9.0;</div>
<div class="line"><a name="l02646"></a><span class="lineno"> 2646</span>&#160;   A(22,5) = 53248.0/27.0;</div>
<div class="line"><a name="l02647"></a><span class="lineno"> 2647</span>&#160;   A(22,8) = -10240.0/9.0;</div>
<div class="line"><a name="l02648"></a><span class="lineno"> 2648</span>&#160;   A(22,10) = -1024.0;</div>
<div class="line"><a name="l02649"></a><span class="lineno"> 2649</span>&#160;   A(22,11) = -22528.0/3.0;</div>
<div class="line"><a name="l02650"></a><span class="lineno"> 2650</span>&#160;   A(22,12) = -48128.0/9.0;</div>
<div class="line"><a name="l02651"></a><span class="lineno"> 2651</span>&#160;   A(22,15) = 14336.0/9.0;</div>
<div class="line"><a name="l02652"></a><span class="lineno"> 2652</span>&#160;   A(22,17) = 8192.0/3.0;</div>
<div class="line"><a name="l02653"></a><span class="lineno"> 2653</span>&#160;   A(22,18) = 14336.0/3.0;</div>
<div class="line"><a name="l02654"></a><span class="lineno"> 2654</span>&#160;   A(22,21) = -26624.0/27.0;</div>
<div class="line"><a name="l02655"></a><span class="lineno"> 2655</span>&#160;   A(22,23) = -37888.0/27.0;</div>
<div class="line"><a name="l02656"></a><span class="lineno"> 2656</span>&#160;   A(22,26) = 2048.0/9.0;</div>
<div class="line"><a name="l02657"></a><span class="lineno"> 2657</span>&#160;   A(21,0) = -8192.0/27.0;</div>
<div class="line"><a name="l02658"></a><span class="lineno"> 2658</span>&#160;   A(21,2) = -40960.0/27.0;</div>
<div class="line"><a name="l02659"></a><span class="lineno"> 2659</span>&#160;   A(21,3) = -114688.0/27.0;</div>
<div class="line"><a name="l02660"></a><span class="lineno"> 2660</span>&#160;   A(21,4) = -65536.0/27.0;</div>
<div class="line"><a name="l02661"></a><span class="lineno"> 2661</span>&#160;   A(21,8) = 26624.0/27.0;</div>
<div class="line"><a name="l02662"></a><span class="lineno"> 2662</span>&#160;   A(21,10) = 38912.0/9.0;</div>
<div class="line"><a name="l02663"></a><span class="lineno"> 2663</span>&#160;   A(21,11) = 53248.0/9.0;</div>
<div class="line"><a name="l02664"></a><span class="lineno"> 2664</span>&#160;   A(21,12) = 16384.0/27.0;</div>
<div class="line"><a name="l02665"></a><span class="lineno"> 2665</span>&#160;   A(21,15) = -10240.0/9.0;</div>
<div class="line"><a name="l02666"></a><span class="lineno"> 2666</span>&#160;   A(21,17) = -10240.0/3.0;</div>
<div class="line"><a name="l02667"></a><span class="lineno"> 2667</span>&#160;   A(21,18) = -32768.0/27.0;</div>
<div class="line"><a name="l02668"></a><span class="lineno"> 2668</span>&#160;   A(21,21) = 14336.0/27.0;</div>
<div class="line"><a name="l02669"></a><span class="lineno"> 2669</span>&#160;   A(21,23) = 16384.0/27.0;</div>
<div class="line"><a name="l02670"></a><span class="lineno"> 2670</span>&#160;   A(21,26) = -2048.0/27.0;</div>
<div class="line"><a name="l02671"></a><span class="lineno"> 2671</span>&#160;   A(26,2) = -71680.0/27.0;</div>
<div class="line"><a name="l02672"></a><span class="lineno"> 2672</span>&#160;   A(26,3) = -145408.0/27.0;</div>
<div class="line"><a name="l02673"></a><span class="lineno"> 2673</span>&#160;   A(26,4) = -88064.0/27.0;</div>
<div class="line"><a name="l02674"></a><span class="lineno"> 2674</span>&#160;   A(26,5) = -2048.0/9.0;</div>
<div class="line"><a name="l02675"></a><span class="lineno"> 2675</span>&#160;   A(26,10) = 150016.0/27.0;</div>
<div class="line"><a name="l02676"></a><span class="lineno"> 2676</span>&#160;   A(26,11) = 183296.0/27.0;</div>
<div class="line"><a name="l02677"></a><span class="lineno"> 2677</span>&#160;   A(26,12) = 31232.0/27.0;</div>
<div class="line"><a name="l02678"></a><span class="lineno"> 2678</span>&#160;   A(26,17) = -94208.0/27.0;</div>
<div class="line"><a name="l02679"></a><span class="lineno"> 2679</span>&#160;   A(26,18) = -40960.0/27.0;</div>
<div class="line"><a name="l02680"></a><span class="lineno"> 2680</span>&#160;   A(26,23) = 15872.0/27.0;</div>
<div class="line"><a name="l02681"></a><span class="lineno"> 2681</span>&#160;   A(25,2) = -2048.0/9.0;</div>
<div class="line"><a name="l02682"></a><span class="lineno"> 2682</span>&#160;   A(25,3) = -88064.0/27.0;</div>
<div class="line"><a name="l02683"></a><span class="lineno"> 2683</span>&#160;   A(25,4) = -145408.0/27.0;</div>
<div class="line"><a name="l02684"></a><span class="lineno"> 2684</span>&#160;   A(25,5) = -71680.0/27.0;</div>
<div class="line"><a name="l02685"></a><span class="lineno"> 2685</span>&#160;   A(25,10) = 31232.0/27.0;</div>
<div class="line"><a name="l02686"></a><span class="lineno"> 2686</span>&#160;   A(25,11) = 183296.0/27.0;</div>
<div class="line"><a name="l02687"></a><span class="lineno"> 2687</span>&#160;   A(25,12) = 150016.0/27.0;</div>
<div class="line"><a name="l02688"></a><span class="lineno"> 2688</span>&#160;   A(25,17) = -40960.0/27.0;</div>
<div class="line"><a name="l02689"></a><span class="lineno"> 2689</span>&#160;   A(25,18) = -94208.0/27.0;</div>
<div class="line"><a name="l02690"></a><span class="lineno"> 2690</span>&#160;   A(25,23) = 15872.0/27.0;</div>
<div class="line"><a name="l02691"></a><span class="lineno"> 2691</span>&#160;   A(30,4) = -2048.0/9.0;</div>
<div class="line"><a name="l02692"></a><span class="lineno"> 2692</span>&#160;   A(30,5) = -4096.0/9.0;</div>
<div class="line"><a name="l02693"></a><span class="lineno"> 2693</span>&#160;   A(30,6) = -2048.0/9.0;</div>
<div class="line"><a name="l02694"></a><span class="lineno"> 2694</span>&#160;   A(30,11) = 512.0/3.0;</div>
<div class="line"><a name="l02695"></a><span class="lineno"> 2695</span>&#160;   A(30,12) = 7168.0/9.0;</div>
<div class="line"><a name="l02696"></a><span class="lineno"> 2696</span>&#160;   A(30,13) = 5632.0/9.0;</div>
<div class="line"><a name="l02697"></a><span class="lineno"> 2697</span>&#160;   A(30,17) = -256.0/9.0;</div>
<div class="line"><a name="l02698"></a><span class="lineno"> 2698</span>&#160;   A(30,18) = -3584.0/9.0;</div>
<div class="line"><a name="l02699"></a><span class="lineno"> 2699</span>&#160;   A(30,19) = -1792.0/3.0;</div>
<div class="line"><a name="l02700"></a><span class="lineno"> 2700</span>&#160; </div>
<div class="line"><a name="l02701"></a><span class="lineno"> 2701</span>&#160;   <span class="comment">//-------- 5</span></div>
<div class="line"><a name="l02702"></a><span class="lineno"> 2702</span>&#160;   A(30,23) = 512.0/9.0;</div>
<div class="line"><a name="l02703"></a><span class="lineno"> 2703</span>&#160;   A(30,24) = 2048.0/9.0;</div>
<div class="line"><a name="l02704"></a><span class="lineno"> 2704</span>&#160;   A(30,28) = -256.0/9.0;</div>
<div class="line"><a name="l02705"></a><span class="lineno"> 2705</span>&#160;   A(29,2) = -2048.0/9.0;</div>
<div class="line"><a name="l02706"></a><span class="lineno"> 2706</span>&#160;   A(29,3) = -8192.0/9.0;</div>
<div class="line"><a name="l02707"></a><span class="lineno"> 2707</span>&#160;   A(29,4) = -4096.0/3.0;</div>
<div class="line"><a name="l02708"></a><span class="lineno"> 2708</span>&#160;   A(29,5) = -8192.0/9.0;</div>
<div class="line"><a name="l02709"></a><span class="lineno"> 2709</span>&#160;   A(29,6) = -2048.0/9.0;</div>
<div class="line"><a name="l02710"></a><span class="lineno"> 2710</span>&#160;   A(29,10) = 6656.0/9.0;</div>
<div class="line"><a name="l02711"></a><span class="lineno"> 2711</span>&#160;   A(29,11) = 6656.0/3.0;</div>
<div class="line"><a name="l02712"></a><span class="lineno"> 2712</span>&#160;   A(29,12) = 6656.0/3.0;</div>
<div class="line"><a name="l02713"></a><span class="lineno"> 2713</span>&#160;   A(29,13) = 6656.0/9.0;</div>
<div class="line"><a name="l02714"></a><span class="lineno"> 2714</span>&#160;   A(29,17) = -7936.0/9.0;</div>
<div class="line"><a name="l02715"></a><span class="lineno"> 2715</span>&#160;   A(29,18) = -15872.0/9.0;</div>
<div class="line"><a name="l02716"></a><span class="lineno"> 2716</span>&#160;   A(29,19) = -7936.0/9.0;</div>
<div class="line"><a name="l02717"></a><span class="lineno"> 2717</span>&#160;   A(29,23) = 4096.0/9.0;</div>
<div class="line"><a name="l02718"></a><span class="lineno"> 2718</span>&#160;   A(29,24) = 4096.0/9.0;</div>
<div class="line"><a name="l02719"></a><span class="lineno"> 2719</span>&#160;   A(29,28) = -256.0/3.0;</div>
<div class="line"><a name="l02720"></a><span class="lineno"> 2720</span>&#160;   A(28,1) = -2048.0/9.0;</div>
<div class="line"><a name="l02721"></a><span class="lineno"> 2721</span>&#160;   A(28,2) = -8192.0/9.0;</div>
<div class="line"><a name="l02722"></a><span class="lineno"> 2722</span>&#160;   A(28,3) = -4096.0/3.0;</div>
<div class="line"><a name="l02723"></a><span class="lineno"> 2723</span>&#160;   A(28,4) = -8192.0/9.0;</div>
<div class="line"><a name="l02724"></a><span class="lineno"> 2724</span>&#160;   A(28,5) = -2048.0/9.0;</div>
<div class="line"><a name="l02725"></a><span class="lineno"> 2725</span>&#160;   A(28,9) = 6656.0/9.0;</div>
<div class="line"><a name="l02726"></a><span class="lineno"> 2726</span>&#160;   A(28,10) = 6656.0/3.0;</div>
<div class="line"><a name="l02727"></a><span class="lineno"> 2727</span>&#160;   A(28,11) = 6656.0/3.0;</div>
<div class="line"><a name="l02728"></a><span class="lineno"> 2728</span>&#160;   A(28,12) = 6656.0/9.0;</div>
<div class="line"><a name="l02729"></a><span class="lineno"> 2729</span>&#160;   A(28,16) = -7936.0/9.0;</div>
<div class="line"><a name="l02730"></a><span class="lineno"> 2730</span>&#160;   A(28,17) = -15872.0/9.0;</div>
<div class="line"><a name="l02731"></a><span class="lineno"> 2731</span>&#160;   A(28,18) = -7936.0/9.0;</div>
<div class="line"><a name="l02732"></a><span class="lineno"> 2732</span>&#160;   A(28,22) = 4096.0/9.0;</div>
<div class="line"><a name="l02733"></a><span class="lineno"> 2733</span>&#160;   A(28,23) = 4096.0/9.0;</div>
<div class="line"><a name="l02734"></a><span class="lineno"> 2734</span>&#160;   A(28,27) = -256.0/3.0;</div>
<div class="line"><a name="l02735"></a><span class="lineno"> 2735</span>&#160;   A(27,1) = -2048.0/9.0;</div>
<div class="line"><a name="l02736"></a><span class="lineno"> 2736</span>&#160;   A(27,2) = -4096.0/9.0;</div>
<div class="line"><a name="l02737"></a><span class="lineno"> 2737</span>&#160;   A(27,3) = -2048.0/9.0;</div>
<div class="line"><a name="l02738"></a><span class="lineno"> 2738</span>&#160;   A(27,9) = 5632.0/9.0;</div>
<div class="line"><a name="l02739"></a><span class="lineno"> 2739</span>&#160;   A(27,10) = 7168.0/9.0;</div>
<div class="line"><a name="l02740"></a><span class="lineno"> 2740</span>&#160;   A(27,11) = 512.0/3.0;</div>
<div class="line"><a name="l02741"></a><span class="lineno"> 2741</span>&#160;   A(27,16) = -1792.0/3.0;</div>
<div class="line"><a name="l02742"></a><span class="lineno"> 2742</span>&#160;   A(27,17) = -3584.0/9.0;</div>
<div class="line"><a name="l02743"></a><span class="lineno"> 2743</span>&#160;   A(27,18) = -256.0/9.0;</div>
<div class="line"><a name="l02744"></a><span class="lineno"> 2744</span>&#160;   A(27,22) = 2048.0/9.0;</div>
<div class="line"><a name="l02745"></a><span class="lineno"> 2745</span>&#160;   A(27,23) = 512.0/9.0;</div>
<div class="line"><a name="l02746"></a><span class="lineno"> 2746</span>&#160;   A(27,27) = -256.0/9.0;</div>
<div class="line"><a name="l02747"></a><span class="lineno"> 2747</span>&#160;   A(32,2) = 1024.0*sqrt(2.0)/9.0;</div>
<div class="line"><a name="l02748"></a><span class="lineno"> 2748</span>&#160;   A(32,3) = 1024.0*sqrt(2.0)/9.0;</div>
<div class="line"><a name="l02749"></a><span class="lineno"> 2749</span>&#160;   A(32,10) = -1792.0*sqrt(2.0)/9.0;</div>
<div class="line"><a name="l02750"></a><span class="lineno"> 2750</span>&#160;   A(32,11) = -256.0*sqrt(2.0)/3.0;</div>
<div class="line"><a name="l02751"></a><span class="lineno"> 2751</span>&#160;   A(32,17) = 896*sqrt(2.0)/9.0;</div>
<div class="line"><a name="l02752"></a><span class="lineno"> 2752</span>&#160;   A(32,18) = 128.0*sqrt(2.0)/9.0;</div>
<div class="line"><a name="l02753"></a><span class="lineno"> 2753</span>&#160;   A(32,23) = -128.0*sqrt(2.0)/9.0;</div>
<div class="line"><a name="l02754"></a><span class="lineno"> 2754</span>&#160;   A(31,4) = 1024.0*sqrt(2.0)/9.0;</div>
<div class="line"><a name="l02755"></a><span class="lineno"> 2755</span>&#160;   A(31,5) = 1024.0*sqrt(2.0)/9.0;</div>
<div class="line"><a name="l02756"></a><span class="lineno"> 2756</span>&#160;   A(31,11) = -256.0*sqrt(2.0)/3.0;</div>
<div class="line"><a name="l02757"></a><span class="lineno"> 2757</span>&#160;   A(31,12) = -1792.0*sqrt(2.0)/9.0;</div>
<div class="line"><a name="l02758"></a><span class="lineno"> 2758</span>&#160;   A(31,17) = 128.0*sqrt(2.0)/9.0;</div>
<div class="line"><a name="l02759"></a><span class="lineno"> 2759</span>&#160;   A(31,18) = 896.0*sqrt(2.0)/9.0;</div>
<div class="line"><a name="l02760"></a><span class="lineno"> 2760</span>&#160;   A(31,23) = -128.0*sqrt(2.0)/9.0;</div>
<div class="line"><a name="l02761"></a><span class="lineno"> 2761</span>&#160;   A(34,2) = 4096.0;</div>
<div class="line"><a name="l02762"></a><span class="lineno"> 2762</span>&#160;   A(34,3) = 8192.0;</div>
<div class="line"><a name="l02763"></a><span class="lineno"> 2763</span>&#160;   A(34,4) = 4096.0;</div>
<div class="line"><a name="l02764"></a><span class="lineno"> 2764</span>&#160;   A(34,10) = -9216.0;</div>
<div class="line"><a name="l02765"></a><span class="lineno"> 2765</span>&#160;   A(34,11) = -10240.0;</div>
<div class="line"><a name="l02766"></a><span class="lineno"> 2766</span>&#160;   A(34,12) = -1024.0;</div>
<div class="line"><a name="l02767"></a><span class="lineno"> 2767</span>&#160;   A(34,17) = 6144.0;</div>
<div class="line"><a name="l02768"></a><span class="lineno"> 2768</span>&#160;   A(34,18) = 2048.0;</div>
<div class="line"><a name="l02769"></a><span class="lineno"> 2769</span>&#160;   A(34,23) = -1024.0;</div>
<div class="line"><a name="l02770"></a><span class="lineno"> 2770</span>&#160;   A(33,3) = 4096.0;</div>
<div class="line"><a name="l02771"></a><span class="lineno"> 2771</span>&#160;   A(33,4) = 8192.0;</div>
<div class="line"><a name="l02772"></a><span class="lineno"> 2772</span>&#160;   A(33,5) = 4096.0;</div>
<div class="line"><a name="l02773"></a><span class="lineno"> 2773</span>&#160;   A(33,10) = -1024.0;</div>
<div class="line"><a name="l02774"></a><span class="lineno"> 2774</span>&#160;   A(33,11) = -10240.0;</div>
<div class="line"><a name="l02775"></a><span class="lineno"> 2775</span>&#160;   A(33,12) = -9216.0;</div>
<div class="line"><a name="l02776"></a><span class="lineno"> 2776</span>&#160;   A(33,17) = 2048.0;</div>
<div class="line"><a name="l02777"></a><span class="lineno"> 2777</span>&#160;   A(33,18) = 6144.0;</div>
<div class="line"><a name="l02778"></a><span class="lineno"> 2778</span>&#160;   A(33,23) = -1024.0;</div>
<div class="line"><a name="l02779"></a><span class="lineno"> 2779</span>&#160;   A(35,2) = -4096.0;</div>
<div class="line"><a name="l02780"></a><span class="lineno"> 2780</span>&#160;   A(35,3) = -12288.0;</div>
<div class="line"><a name="l02781"></a><span class="lineno"> 2781</span>&#160;   A(35,4) = -12288.0;</div>
<div class="line"><a name="l02782"></a><span class="lineno"> 2782</span>&#160;   A(35,5) = -4096.0;</div>
<div class="line"><a name="l02783"></a><span class="lineno"> 2783</span>&#160;   A(35,10) = 11264.0;</div>
<div class="line"><a name="l02784"></a><span class="lineno"> 2784</span>&#160;   A(35,11) = 22528.0;</div>
<div class="line"><a name="l02785"></a><span class="lineno"> 2785</span>&#160;   A(35,12) = 11264.0;</div>
<div class="line"><a name="l02786"></a><span class="lineno"> 2786</span>&#160;   A(35,17) = -10240.0;</div>
<div class="line"><a name="l02787"></a><span class="lineno"> 2787</span>&#160;   A(35,18) = -10240.0;</div>
<div class="line"><a name="l02788"></a><span class="lineno"> 2788</span>&#160;   A(35,23) = 3072.0;</div>
<div class="line"><a name="l02789"></a><span class="lineno"> 2789</span>&#160;  }</div>
<div class="line"><a name="l02790"></a><span class="lineno"> 2790</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l02791"></a><span class="lineno"> 2791</span>&#160;<span class="comment"> ///=========================================================================</span></div>
<div class="line"><a name="l02792"></a><span class="lineno"> 2792</span>&#160;<span class="comment"> /// Bases of the C1-curved shape functions: </span></div>
<div class="line"><a name="l02793"></a><span class="lineno"> 2793</span>&#160;<span class="comment"> /// it is a complete polynomial of degree 7</span></div>
<div class="line"><a name="l02794"></a><span class="lineno"> 2794</span>&#160;<span class="comment"> ///=========================================================================</span></div>
<div class="line"><a name="l02795"></a><span class="lineno"><a class="line" href="classoomph_1_1C1CurvedElementShape_3_012_00_01NNODE__1D_01_4.html#ac1c436b2c6f49da2e0503ac4a746ba8b"> 2795</a></span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1C1CurvedElementShape_3_012_00_01NNODE__1D_01_4.html#ac1c436b2c6f49da2e0503ac4a746ba8b">basis_curve</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>, <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;psi_curve)<span class="keyword"> const</span></div>
<div class="line"><a name="l02796"></a><span class="lineno"> 2796</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l02797"></a><span class="lineno"> 2797</span>&#160;   <span class="comment">//Get the shape function and derivatives</span></div>
<div class="line"><a name="l02798"></a><span class="lineno"> 2798</span>&#160;   psi_curve[7] = <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0];</div>
<div class="line"><a name="l02799"></a><span class="lineno"> 2799</span>&#160;   psi_curve[6] = <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1];</div>
<div class="line"><a name="l02800"></a><span class="lineno"> 2800</span>&#160;   psi_curve[5] = <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1];</div>
<div class="line"><a name="l02801"></a><span class="lineno"> 2801</span>&#160;   psi_curve[4] = <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1];</div>
<div class="line"><a name="l02802"></a><span class="lineno"> 2802</span>&#160;   psi_curve[3] = <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1];</div>
<div class="line"><a name="l02803"></a><span class="lineno"> 2803</span>&#160;   psi_curve[2] = <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1];</div>
<div class="line"><a name="l02804"></a><span class="lineno"> 2804</span>&#160;   psi_curve[1] = <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1];</div>
<div class="line"><a name="l02805"></a><span class="lineno"> 2805</span>&#160;   psi_curve[0] = <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1];</div>
<div class="line"><a name="l02806"></a><span class="lineno"> 2806</span>&#160;   psi_curve[14] = <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0];</div>
<div class="line"><a name="l02807"></a><span class="lineno"> 2807</span>&#160;   psi_curve[13] = <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1];</div>
<div class="line"><a name="l02808"></a><span class="lineno"> 2808</span>&#160;   psi_curve[12] = <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1];</div>
<div class="line"><a name="l02809"></a><span class="lineno"> 2809</span>&#160;   psi_curve[11] = <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1];</div>
<div class="line"><a name="l02810"></a><span class="lineno"> 2810</span>&#160;   psi_curve[10] = <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1];</div>
<div class="line"><a name="l02811"></a><span class="lineno"> 2811</span>&#160;   psi_curve[9] = <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1];</div>
<div class="line"><a name="l02812"></a><span class="lineno"> 2812</span>&#160;   psi_curve[8] = <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1];</div>
<div class="line"><a name="l02813"></a><span class="lineno"> 2813</span>&#160;   psi_curve[20] = <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0];</div>
<div class="line"><a name="l02814"></a><span class="lineno"> 2814</span>&#160;   psi_curve[19] = <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1];</div>
<div class="line"><a name="l02815"></a><span class="lineno"> 2815</span>&#160;   psi_curve[18] = <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1];</div>
<div class="line"><a name="l02816"></a><span class="lineno"> 2816</span>&#160;   psi_curve[17] = <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1];</div>
<div class="line"><a name="l02817"></a><span class="lineno"> 2817</span>&#160;   psi_curve[16] = <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1];</div>
<div class="line"><a name="l02818"></a><span class="lineno"> 2818</span>&#160;   psi_curve[15] = <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1];</div>
<div class="line"><a name="l02819"></a><span class="lineno"> 2819</span>&#160;   psi_curve[25] = <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0];</div>
<div class="line"><a name="l02820"></a><span class="lineno"> 2820</span>&#160;   psi_curve[24] = <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1];</div>
<div class="line"><a name="l02821"></a><span class="lineno"> 2821</span>&#160;   psi_curve[23] = <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1];</div>
<div class="line"><a name="l02822"></a><span class="lineno"> 2822</span>&#160;   psi_curve[22] = <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1];</div>
<div class="line"><a name="l02823"></a><span class="lineno"> 2823</span>&#160;   psi_curve[21] = <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1];</div>
<div class="line"><a name="l02824"></a><span class="lineno"> 2824</span>&#160;   psi_curve[29] = <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0];</div>
<div class="line"><a name="l02825"></a><span class="lineno"> 2825</span>&#160;   psi_curve[28] = <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1];</div>
<div class="line"><a name="l02826"></a><span class="lineno"> 2826</span>&#160;   psi_curve[27] = <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1];</div>
<div class="line"><a name="l02827"></a><span class="lineno"> 2827</span>&#160;   psi_curve[26] = <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1];</div>
<div class="line"><a name="l02828"></a><span class="lineno"> 2828</span>&#160;   psi_curve[32] = <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0];</div>
<div class="line"><a name="l02829"></a><span class="lineno"> 2829</span>&#160;   psi_curve[31] = <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1];</div>
<div class="line"><a name="l02830"></a><span class="lineno"> 2830</span>&#160;   psi_curve[30] = <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1];</div>
<div class="line"><a name="l02831"></a><span class="lineno"> 2831</span>&#160;   psi_curve[34] = <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0];</div>
<div class="line"><a name="l02832"></a><span class="lineno"> 2832</span>&#160;   psi_curve[33] = <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1];</div>
<div class="line"><a name="l02833"></a><span class="lineno"> 2833</span>&#160;   psi_curve[35] = 1.0;</div>
<div class="line"><a name="l02834"></a><span class="lineno"> 2834</span>&#160;  }</div>
<div class="line"><a name="l02835"></a><span class="lineno"> 2835</span>&#160;   <span class="comment"></span></div>
<div class="line"><a name="l02836"></a><span class="lineno"> 2836</span>&#160;<span class="comment"> ///=========================================================================</span></div>
<div class="line"><a name="l02837"></a><span class="lineno"> 2837</span>&#160;<span class="comment"> /// Derivatives of bases of the C1-curved shape functions</span></div>
<div class="line"><a name="l02838"></a><span class="lineno"> 2838</span>&#160;<span class="comment"> /// it is a complete polynomial of degree 7</span></div>
<div class="line"><a name="l02839"></a><span class="lineno"> 2839</span>&#160;<span class="comment"> ///=========================================================================</span></div>
<div class="line"><a name="l02840"></a><span class="lineno"><a class="line" href="classoomph_1_1C1CurvedElementShape_3_012_00_01NNODE__1D_01_4.html#ab40b2d47f321db5868443846290c2744"> 2840</a></span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1C1CurvedElementShape_3_012_00_01NNODE__1D_01_4.html#ab40b2d47f321db5868443846290c2744">dbasis_local_curve</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>, <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;psi_curve, <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;dpsi_curve)<span class="keyword"> const</span></div>
<div class="line"><a name="l02841"></a><span class="lineno"> 2841</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l02842"></a><span class="lineno"> 2842</span>&#160;   basis_curve(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,psi_curve);</div>
<div class="line"><a name="l02843"></a><span class="lineno"> 2843</span>&#160; </div>
<div class="line"><a name="l02844"></a><span class="lineno"> 2844</span>&#160;   <span class="comment">//Get the shape function and derivatives</span></div>
<div class="line"><a name="l02845"></a><span class="lineno"> 2845</span>&#160;   dpsi_curve(7,0) = 7.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0];</div>
<div class="line"><a name="l02846"></a><span class="lineno"> 2846</span>&#160;   dpsi_curve(6,0) = 6.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1];</div>
<div class="line"><a name="l02847"></a><span class="lineno"> 2847</span>&#160;   dpsi_curve(5,0) = 5.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1];</div>
<div class="line"><a name="l02848"></a><span class="lineno"> 2848</span>&#160;   dpsi_curve(4,0) = 4.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1];</div>
<div class="line"><a name="l02849"></a><span class="lineno"> 2849</span>&#160;   dpsi_curve(3,0) = 3.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1];</div>
<div class="line"><a name="l02850"></a><span class="lineno"> 2850</span>&#160;   dpsi_curve(2,0) = 2.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1];</div>
<div class="line"><a name="l02851"></a><span class="lineno"> 2851</span>&#160;   dpsi_curve(1,0) = 1.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1];</div>
<div class="line"><a name="l02852"></a><span class="lineno"> 2852</span>&#160;   dpsi_curve(0,0) = 0.0;</div>
<div class="line"><a name="l02853"></a><span class="lineno"> 2853</span>&#160;   dpsi_curve(14,0) = 6.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0];</div>
<div class="line"><a name="l02854"></a><span class="lineno"> 2854</span>&#160;   dpsi_curve(13,0) = 5.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1];</div>
<div class="line"><a name="l02855"></a><span class="lineno"> 2855</span>&#160;   dpsi_curve(12,0) = 4.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1];</div>
<div class="line"><a name="l02856"></a><span class="lineno"> 2856</span>&#160;   dpsi_curve(11,0) = 3.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1];</div>
<div class="line"><a name="l02857"></a><span class="lineno"> 2857</span>&#160;   dpsi_curve(10,0) = 2.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1];</div>
<div class="line"><a name="l02858"></a><span class="lineno"> 2858</span>&#160;   dpsi_curve(9,0) = 1.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1];</div>
<div class="line"><a name="l02859"></a><span class="lineno"> 2859</span>&#160;   dpsi_curve(8,0) = 0.0;</div>
<div class="line"><a name="l02860"></a><span class="lineno"> 2860</span>&#160;   dpsi_curve(20,0) = 5.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0];</div>
<div class="line"><a name="l02861"></a><span class="lineno"> 2861</span>&#160;   dpsi_curve(19,0) = 4.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1];</div>
<div class="line"><a name="l02862"></a><span class="lineno"> 2862</span>&#160;   dpsi_curve(18,0) = 3.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1];</div>
<div class="line"><a name="l02863"></a><span class="lineno"> 2863</span>&#160;   dpsi_curve(17,0) = 2.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1];</div>
<div class="line"><a name="l02864"></a><span class="lineno"> 2864</span>&#160;   dpsi_curve(16,0) = 1.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1];</div>
<div class="line"><a name="l02865"></a><span class="lineno"> 2865</span>&#160;   dpsi_curve(15,0) = 0.0;</div>
<div class="line"><a name="l02866"></a><span class="lineno"> 2866</span>&#160;   dpsi_curve(25,0) = 4.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0];</div>
<div class="line"><a name="l02867"></a><span class="lineno"> 2867</span>&#160;   dpsi_curve(24,0) = 3.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1];</div>
<div class="line"><a name="l02868"></a><span class="lineno"> 2868</span>&#160;   dpsi_curve(23,0) = 2.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1];</div>
<div class="line"><a name="l02869"></a><span class="lineno"> 2869</span>&#160;   dpsi_curve(22,0) = 1.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1];</div>
<div class="line"><a name="l02870"></a><span class="lineno"> 2870</span>&#160;   dpsi_curve(21,0) = 0.0;</div>
<div class="line"><a name="l02871"></a><span class="lineno"> 2871</span>&#160;   dpsi_curve(29,0) = 3.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0];</div>
<div class="line"><a name="l02872"></a><span class="lineno"> 2872</span>&#160;   dpsi_curve(28,0) = 2.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1];</div>
<div class="line"><a name="l02873"></a><span class="lineno"> 2873</span>&#160;   dpsi_curve(27,0) = 1.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1];</div>
<div class="line"><a name="l02874"></a><span class="lineno"> 2874</span>&#160;   dpsi_curve(26,0) = 0.0;</div>
<div class="line"><a name="l02875"></a><span class="lineno"> 2875</span>&#160;   dpsi_curve(32,0) = 2.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0];</div>
<div class="line"><a name="l02876"></a><span class="lineno"> 2876</span>&#160;   dpsi_curve(31,0) = 1.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1];</div>
<div class="line"><a name="l02877"></a><span class="lineno"> 2877</span>&#160;   dpsi_curve(30,0) = 0.0;</div>
<div class="line"><a name="l02878"></a><span class="lineno"> 2878</span>&#160;   dpsi_curve(34,0) = 1.0;</div>
<div class="line"><a name="l02879"></a><span class="lineno"> 2879</span>&#160;   dpsi_curve(33,0) = 0.0;</div>
<div class="line"><a name="l02880"></a><span class="lineno"> 2880</span>&#160;   dpsi_curve(35,0) = 0.0;</div>
<div class="line"><a name="l02881"></a><span class="lineno"> 2881</span>&#160;   </div>
<div class="line"><a name="l02882"></a><span class="lineno"> 2882</span>&#160;   dpsi_curve(7,1) = 0.0;</div>
<div class="line"><a name="l02883"></a><span class="lineno"> 2883</span>&#160;   dpsi_curve(6,1) = <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*1.0;</div>
<div class="line"><a name="l02884"></a><span class="lineno"> 2884</span>&#160;   dpsi_curve(5,1) = <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*2.0;</div>
<div class="line"><a name="l02885"></a><span class="lineno"> 2885</span>&#160;   dpsi_curve(4,1) = <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*3.0;</div>
<div class="line"><a name="l02886"></a><span class="lineno"> 2886</span>&#160;   dpsi_curve(3,1) = <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*4.0;</div>
<div class="line"><a name="l02887"></a><span class="lineno"> 2887</span>&#160;   dpsi_curve(2,1) = <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*5.0;</div>
<div class="line"><a name="l02888"></a><span class="lineno"> 2888</span>&#160;   dpsi_curve(1,1) = <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*6.0;</div>
<div class="line"><a name="l02889"></a><span class="lineno"> 2889</span>&#160;   dpsi_curve(0,1) = <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*7.0;</div>
<div class="line"><a name="l02890"></a><span class="lineno"> 2890</span>&#160;   dpsi_curve(14,1) = 0.0;</div>
<div class="line"><a name="l02891"></a><span class="lineno"> 2891</span>&#160;   dpsi_curve(13,1) = <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*1.0;</div>
<div class="line"><a name="l02892"></a><span class="lineno"> 2892</span>&#160;   dpsi_curve(12,1) = <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*2.0;</div>
<div class="line"><a name="l02893"></a><span class="lineno"> 2893</span>&#160;   dpsi_curve(11,1) = <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*3.0;</div>
<div class="line"><a name="l02894"></a><span class="lineno"> 2894</span>&#160;   dpsi_curve(10,1) = <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*4.0;</div>
<div class="line"><a name="l02895"></a><span class="lineno"> 2895</span>&#160;   dpsi_curve(9,1) = <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*5.0;</div>
<div class="line"><a name="l02896"></a><span class="lineno"> 2896</span>&#160;   dpsi_curve(8,1) = <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*6.0;</div>
<div class="line"><a name="l02897"></a><span class="lineno"> 2897</span>&#160;   dpsi_curve(20,1) = 0.0;</div>
<div class="line"><a name="l02898"></a><span class="lineno"> 2898</span>&#160;   dpsi_curve(19,1) = <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*1.0;</div>
<div class="line"><a name="l02899"></a><span class="lineno"> 2899</span>&#160;   dpsi_curve(18,1) = <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*2.0;</div>
<div class="line"><a name="l02900"></a><span class="lineno"> 2900</span>&#160;   dpsi_curve(17,1) = <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*3.0;</div>
<div class="line"><a name="l02901"></a><span class="lineno"> 2901</span>&#160;   dpsi_curve(16,1) = <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*4.0;</div>
<div class="line"><a name="l02902"></a><span class="lineno"> 2902</span>&#160;   dpsi_curve(15,1) = <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*5.0;</div>
<div class="line"><a name="l02903"></a><span class="lineno"> 2903</span>&#160;   dpsi_curve(25,1) = 0.0;</div>
<div class="line"><a name="l02904"></a><span class="lineno"> 2904</span>&#160;   dpsi_curve(24,1) = <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*1.0;</div>
<div class="line"><a name="l02905"></a><span class="lineno"> 2905</span>&#160;   dpsi_curve(23,1) = <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*2.0;</div>
<div class="line"><a name="l02906"></a><span class="lineno"> 2906</span>&#160;   dpsi_curve(22,1) = <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*3.0;</div>
<div class="line"><a name="l02907"></a><span class="lineno"> 2907</span>&#160;   dpsi_curve(21,1) = <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*4.0;</div>
<div class="line"><a name="l02908"></a><span class="lineno"> 2908</span>&#160;   dpsi_curve(29,1) = 0.0;</div>
<div class="line"><a name="l02909"></a><span class="lineno"> 2909</span>&#160;   dpsi_curve(28,1) = <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*1.0;</div>
<div class="line"><a name="l02910"></a><span class="lineno"> 2910</span>&#160;   dpsi_curve(27,1) = <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*2.0;</div>
<div class="line"><a name="l02911"></a><span class="lineno"> 2911</span>&#160;   dpsi_curve(26,1) = <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*3.0;</div>
<div class="line"><a name="l02912"></a><span class="lineno"> 2912</span>&#160;   dpsi_curve(32,1) = 0.0;</div>
<div class="line"><a name="l02913"></a><span class="lineno"> 2913</span>&#160;   dpsi_curve(31,1) = <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*1.0;</div>
<div class="line"><a name="l02914"></a><span class="lineno"> 2914</span>&#160;   dpsi_curve(30,1) = <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*2.0;</div>
<div class="line"><a name="l02915"></a><span class="lineno"> 2915</span>&#160;   dpsi_curve(34,1) = 0.0;</div>
<div class="line"><a name="l02916"></a><span class="lineno"> 2916</span>&#160;   dpsi_curve(33,1) = 1.0;</div>
<div class="line"><a name="l02917"></a><span class="lineno"> 2917</span>&#160;   dpsi_curve(35,1) = 0.0;</div>
<div class="line"><a name="l02918"></a><span class="lineno"> 2918</span>&#160;  }</div>
<div class="line"><a name="l02919"></a><span class="lineno"> 2919</span>&#160;  <span class="comment"></span></div>
<div class="line"><a name="l02920"></a><span class="lineno"> 2920</span>&#160;<span class="comment"> ///=========================================================================</span></div>
<div class="line"><a name="l02921"></a><span class="lineno"> 2921</span>&#160;<span class="comment"> /// The second derivatived of bases of the C1-curved shape functions</span></div>
<div class="line"><a name="l02922"></a><span class="lineno"> 2922</span>&#160;<span class="comment"> /// it is a complete polynomial of degree 7</span></div>
<div class="line"><a name="l02923"></a><span class="lineno"> 2923</span>&#160;<span class="comment"> ///=========================================================================</span></div>
<div class="line"><a name="l02924"></a><span class="lineno"><a class="line" href="classoomph_1_1C1CurvedElementShape_3_012_00_01NNODE__1D_01_4.html#a929507d3ddca39a6e27105b959853d84"> 2924</a></span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1C1CurvedElementShape_3_012_00_01NNODE__1D_01_4.html#a929507d3ddca39a6e27105b959853d84">d2basis_local_curve</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>, <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;psi_curve, <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;dpsi_curve, <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;d2psi_curve)<span class="keyword"> const</span></div>
<div class="line"><a name="l02925"></a><span class="lineno"> 2925</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l02926"></a><span class="lineno"> 2926</span>&#160;   dbasis_local_curve(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,psi_curve,dpsi_curve);</div>
<div class="line"><a name="l02927"></a><span class="lineno"> 2927</span>&#160;   <span class="comment">//Get the shape function and derivatives</span></div>
<div class="line"><a name="l02928"></a><span class="lineno"> 2928</span>&#160;   d2psi_curve(7,0) = 7.0*6.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0];</div>
<div class="line"><a name="l02929"></a><span class="lineno"> 2929</span>&#160;   d2psi_curve(6,0) = 6.0*5.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1];</div>
<div class="line"><a name="l02930"></a><span class="lineno"> 2930</span>&#160;   d2psi_curve(5,0) = 5.0*4.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1];</div>
<div class="line"><a name="l02931"></a><span class="lineno"> 2931</span>&#160;   d2psi_curve(4,0) = 4.0*3.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1];</div>
<div class="line"><a name="l02932"></a><span class="lineno"> 2932</span>&#160;   d2psi_curve(3,0) = 3.0*2.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1];</div>
<div class="line"><a name="l02933"></a><span class="lineno"> 2933</span>&#160;   d2psi_curve(2,0) = 2.0*1.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1];</div>
<div class="line"><a name="l02934"></a><span class="lineno"> 2934</span>&#160;   d2psi_curve(1,0) = 0.0;</div>
<div class="line"><a name="l02935"></a><span class="lineno"> 2935</span>&#160;   d2psi_curve(0,0) = 0.0;</div>
<div class="line"><a name="l02936"></a><span class="lineno"> 2936</span>&#160;   d2psi_curve(14,0) = 6.0*5.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0];</div>
<div class="line"><a name="l02937"></a><span class="lineno"> 2937</span>&#160;   d2psi_curve(13,0) = 5.0*4.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1];</div>
<div class="line"><a name="l02938"></a><span class="lineno"> 2938</span>&#160;   d2psi_curve(12,0) = 4.0*3.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1];</div>
<div class="line"><a name="l02939"></a><span class="lineno"> 2939</span>&#160;   d2psi_curve(11,0) = 3.0*2.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1];</div>
<div class="line"><a name="l02940"></a><span class="lineno"> 2940</span>&#160;   d2psi_curve(10,0) = 2.0*1.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1];</div>
<div class="line"><a name="l02941"></a><span class="lineno"> 2941</span>&#160;   d2psi_curve(9,0) = 0.0;</div>
<div class="line"><a name="l02942"></a><span class="lineno"> 2942</span>&#160;   d2psi_curve(8,0) = 0.0;</div>
<div class="line"><a name="l02943"></a><span class="lineno"> 2943</span>&#160;   d2psi_curve(20,0) = 5.0*4.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0];</div>
<div class="line"><a name="l02944"></a><span class="lineno"> 2944</span>&#160;   d2psi_curve(19,0) = 4.0*3.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1];</div>
<div class="line"><a name="l02945"></a><span class="lineno"> 2945</span>&#160;   d2psi_curve(18,0) = 3.0*2.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1];</div>
<div class="line"><a name="l02946"></a><span class="lineno"> 2946</span>&#160;   d2psi_curve(17,0) = 2.0*1.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1];</div>
<div class="line"><a name="l02947"></a><span class="lineno"> 2947</span>&#160;   d2psi_curve(16,0) = 0.0;</div>
<div class="line"><a name="l02948"></a><span class="lineno"> 2948</span>&#160;   d2psi_curve(15,0) = 0.0;</div>
<div class="line"><a name="l02949"></a><span class="lineno"> 2949</span>&#160;   d2psi_curve(25,0) = 4.0*3.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0];</div>
<div class="line"><a name="l02950"></a><span class="lineno"> 2950</span>&#160;   d2psi_curve(24,0) = 3.0*2.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1];</div>
<div class="line"><a name="l02951"></a><span class="lineno"> 2951</span>&#160;   d2psi_curve(23,0) = 2.0*1.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1];</div>
<div class="line"><a name="l02952"></a><span class="lineno"> 2952</span>&#160;   d2psi_curve(22,0) = 0.0;</div>
<div class="line"><a name="l02953"></a><span class="lineno"> 2953</span>&#160;   d2psi_curve(21,0) = 0.0;</div>
<div class="line"><a name="l02954"></a><span class="lineno"> 2954</span>&#160;   d2psi_curve(29,0) = 3.0*2.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0];</div>
<div class="line"><a name="l02955"></a><span class="lineno"> 2955</span>&#160;   d2psi_curve(28,0) = 2.0*1.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1];</div>
<div class="line"><a name="l02956"></a><span class="lineno"> 2956</span>&#160;   d2psi_curve(27,0) = 0.0;</div>
<div class="line"><a name="l02957"></a><span class="lineno"> 2957</span>&#160;   d2psi_curve(26,0) = 0.0;</div>
<div class="line"><a name="l02958"></a><span class="lineno"> 2958</span>&#160;   d2psi_curve(32,0) = 2.0*1.0;</div>
<div class="line"><a name="l02959"></a><span class="lineno"> 2959</span>&#160;   d2psi_curve(31,0) = 0.0;</div>
<div class="line"><a name="l02960"></a><span class="lineno"> 2960</span>&#160;   d2psi_curve(30,0) = 0.0;</div>
<div class="line"><a name="l02961"></a><span class="lineno"> 2961</span>&#160;   d2psi_curve(34,0) = 0.0;</div>
<div class="line"><a name="l02962"></a><span class="lineno"> 2962</span>&#160;   d2psi_curve(33,0) = 0.0;</div>
<div class="line"><a name="l02963"></a><span class="lineno"> 2963</span>&#160;   d2psi_curve(35,0) = 0.0;</div>
<div class="line"><a name="l02964"></a><span class="lineno"> 2964</span>&#160; </div>
<div class="line"><a name="l02965"></a><span class="lineno"> 2965</span>&#160;   d2psi_curve(7,1) = 0.0;</div>
<div class="line"><a name="l02966"></a><span class="lineno"> 2966</span>&#160;   d2psi_curve(6,1) = 0.0;</div>
<div class="line"><a name="l02967"></a><span class="lineno"> 2967</span>&#160;   d2psi_curve(5,1) = <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*1.0*2.0;</div>
<div class="line"><a name="l02968"></a><span class="lineno"> 2968</span>&#160;   d2psi_curve(4,1) = <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*2.0*3.0;</div>
<div class="line"><a name="l02969"></a><span class="lineno"> 2969</span>&#160;   d2psi_curve(3,1) = <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*3.0*4.0;</div>
<div class="line"><a name="l02970"></a><span class="lineno"> 2970</span>&#160;   d2psi_curve(2,1) = <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*4.0*5.0;</div>
<div class="line"><a name="l02971"></a><span class="lineno"> 2971</span>&#160;   d2psi_curve(1,1) = <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*5.0*6.0;</div>
<div class="line"><a name="l02972"></a><span class="lineno"> 2972</span>&#160;   d2psi_curve(0,1) = <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*6.0*7.0;</div>
<div class="line"><a name="l02973"></a><span class="lineno"> 2973</span>&#160;   d2psi_curve(14,1) = 0.0;</div>
<div class="line"><a name="l02974"></a><span class="lineno"> 2974</span>&#160;   d2psi_curve(13,1) = 0.0;</div>
<div class="line"><a name="l02975"></a><span class="lineno"> 2975</span>&#160;   d2psi_curve(12,1) = <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*1.0*2.0;</div>
<div class="line"><a name="l02976"></a><span class="lineno"> 2976</span>&#160;   d2psi_curve(11,1) = <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*2.0*3.0;</div>
<div class="line"><a name="l02977"></a><span class="lineno"> 2977</span>&#160;   d2psi_curve(10,1) = <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*3.0*4.0;</div>
<div class="line"><a name="l02978"></a><span class="lineno"> 2978</span>&#160;   d2psi_curve(9,1) = <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*4.0*5.0;</div>
<div class="line"><a name="l02979"></a><span class="lineno"> 2979</span>&#160;   d2psi_curve(8,1) = <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*5.0*6.0;</div>
<div class="line"><a name="l02980"></a><span class="lineno"> 2980</span>&#160;   d2psi_curve(20,1) = 0.0;</div>
<div class="line"><a name="l02981"></a><span class="lineno"> 2981</span>&#160;   d2psi_curve(19,1) = 0.0;</div>
<div class="line"><a name="l02982"></a><span class="lineno"> 2982</span>&#160;   d2psi_curve(18,1) = <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*1.0*2.0;</div>
<div class="line"><a name="l02983"></a><span class="lineno"> 2983</span>&#160;   d2psi_curve(17,1) = <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*2.0*3.0;</div>
<div class="line"><a name="l02984"></a><span class="lineno"> 2984</span>&#160;   d2psi_curve(16,1) = <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*3.0*4.0;</div>
<div class="line"><a name="l02985"></a><span class="lineno"> 2985</span>&#160;   d2psi_curve(15,1) = <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*4.0*5.0;</div>
<div class="line"><a name="l02986"></a><span class="lineno"> 2986</span>&#160;   d2psi_curve(25,1) = 0.0;</div>
<div class="line"><a name="l02987"></a><span class="lineno"> 2987</span>&#160;   d2psi_curve(24,1) = 0.0;</div>
<div class="line"><a name="l02988"></a><span class="lineno"> 2988</span>&#160;   d2psi_curve(23,1) = <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*1.0*2.0;</div>
<div class="line"><a name="l02989"></a><span class="lineno"> 2989</span>&#160;   d2psi_curve(22,1) = <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*2.0*3.0;</div>
<div class="line"><a name="l02990"></a><span class="lineno"> 2990</span>&#160;   d2psi_curve(21,1) = <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*3.0*4.0;</div>
<div class="line"><a name="l02991"></a><span class="lineno"> 2991</span>&#160;   d2psi_curve(29,1) = 0.0;</div>
<div class="line"><a name="l02992"></a><span class="lineno"> 2992</span>&#160;   d2psi_curve(28,1) = 0.0;</div>
<div class="line"><a name="l02993"></a><span class="lineno"> 2993</span>&#160;   d2psi_curve(27,1) = <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*1.0*2.0;</div>
<div class="line"><a name="l02994"></a><span class="lineno"> 2994</span>&#160;   d2psi_curve(26,1) = <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*2.0*3.0;</div>
<div class="line"><a name="l02995"></a><span class="lineno"> 2995</span>&#160;   d2psi_curve(32,1) = 0.0;</div>
<div class="line"><a name="l02996"></a><span class="lineno"> 2996</span>&#160;   d2psi_curve(31,1) = 0.0;</div>
<div class="line"><a name="l02997"></a><span class="lineno"> 2997</span>&#160;   d2psi_curve(30,1) = 1.0*2.0;</div>
<div class="line"><a name="l02998"></a><span class="lineno"> 2998</span>&#160;   d2psi_curve(34,1) = 0.0;</div>
<div class="line"><a name="l02999"></a><span class="lineno"> 2999</span>&#160;   d2psi_curve(33,1) = 0.0;</div>
<div class="line"><a name="l03000"></a><span class="lineno"> 3000</span>&#160;   d2psi_curve(35,1) = 0.0;</div>
<div class="line"><a name="l03001"></a><span class="lineno"> 3001</span>&#160; </div>
<div class="line"><a name="l03002"></a><span class="lineno"> 3002</span>&#160;   d2psi_curve(7,2) = 0.0;</div>
<div class="line"><a name="l03003"></a><span class="lineno"> 3003</span>&#160;   d2psi_curve(6,2) = 6.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*1.0;</div>
<div class="line"><a name="l03004"></a><span class="lineno"> 3004</span>&#160;   d2psi_curve(5,2) = 5.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*2.0;</div>
<div class="line"><a name="l03005"></a><span class="lineno"> 3005</span>&#160;   d2psi_curve(4,2) = 4.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*3.0;</div>
<div class="line"><a name="l03006"></a><span class="lineno"> 3006</span>&#160;   d2psi_curve(3,2) = 3.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*4.0;</div>
<div class="line"><a name="l03007"></a><span class="lineno"> 3007</span>&#160;   d2psi_curve(2,2) = 2.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*5.0;</div>
<div class="line"><a name="l03008"></a><span class="lineno"> 3008</span>&#160;   d2psi_curve(1,2) = <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*6.0;</div>
<div class="line"><a name="l03009"></a><span class="lineno"> 3009</span>&#160;   d2psi_curve(0,2) = 0.0;</div>
<div class="line"><a name="l03010"></a><span class="lineno"> 3010</span>&#160;   d2psi_curve(14,2) = 0.0;</div>
<div class="line"><a name="l03011"></a><span class="lineno"> 3011</span>&#160;   d2psi_curve(13,2) = 5.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*1.0;</div>
<div class="line"><a name="l03012"></a><span class="lineno"> 3012</span>&#160;   d2psi_curve(12,2) = 4.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*2.0;</div>
<div class="line"><a name="l03013"></a><span class="lineno"> 3013</span>&#160;   d2psi_curve(11,2) = 3.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*3.0;</div>
<div class="line"><a name="l03014"></a><span class="lineno"> 3014</span>&#160;   d2psi_curve(10,2) = 2.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*4.0;</div>
<div class="line"><a name="l03015"></a><span class="lineno"> 3015</span>&#160;   d2psi_curve(9,2) = <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*5.0;</div>
<div class="line"><a name="l03016"></a><span class="lineno"> 3016</span>&#160;   d2psi_curve(8,2) = 0.0;</div>
<div class="line"><a name="l03017"></a><span class="lineno"> 3017</span>&#160;   d2psi_curve(20,2) = 0.0;</div>
<div class="line"><a name="l03018"></a><span class="lineno"> 3018</span>&#160;   d2psi_curve(19,2) = 4.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*1.0;</div>
<div class="line"><a name="l03019"></a><span class="lineno"> 3019</span>&#160;   d2psi_curve(18,2) = 3.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*2.0;</div>
<div class="line"><a name="l03020"></a><span class="lineno"> 3020</span>&#160;   d2psi_curve(17,2) = 2.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*3.0;</div>
<div class="line"><a name="l03021"></a><span class="lineno"> 3021</span>&#160;   d2psi_curve(16,2) = <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*4.0;</div>
<div class="line"><a name="l03022"></a><span class="lineno"> 3022</span>&#160;   d2psi_curve(15,2) = 0.0;</div>
<div class="line"><a name="l03023"></a><span class="lineno"> 3023</span>&#160;   d2psi_curve(25,2) = 0.0;</div>
<div class="line"><a name="l03024"></a><span class="lineno"> 3024</span>&#160;   d2psi_curve(24,2) = 3.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*1.0;</div>
<div class="line"><a name="l03025"></a><span class="lineno"> 3025</span>&#160;   d2psi_curve(23,2) = 2.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*2.0;</div>
<div class="line"><a name="l03026"></a><span class="lineno"> 3026</span>&#160;   d2psi_curve(22,2) = <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*3.0;</div>
<div class="line"><a name="l03027"></a><span class="lineno"> 3027</span>&#160;   d2psi_curve(21,2) = 0.0;</div>
<div class="line"><a name="l03028"></a><span class="lineno"> 3028</span>&#160;   d2psi_curve(29,2) = 0.0;</div>
<div class="line"><a name="l03029"></a><span class="lineno"> 3029</span>&#160;   d2psi_curve(28,2) = 2.0*<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[0]*1.0;</div>
<div class="line"><a name="l03030"></a><span class="lineno"> 3030</span>&#160;   d2psi_curve(27,2) = <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[1]*2.0;</div>
<div class="line"><a name="l03031"></a><span class="lineno"> 3031</span>&#160;   d2psi_curve(26,2) = 0.0;</div>
<div class="line"><a name="l03032"></a><span class="lineno"> 3032</span>&#160;   d2psi_curve(32,2) = 0.0;</div>
<div class="line"><a name="l03033"></a><span class="lineno"> 3033</span>&#160;   d2psi_curve(31,2) = 1.0;</div>
<div class="line"><a name="l03034"></a><span class="lineno"> 3034</span>&#160;   d2psi_curve(30,2) = 0.0;</div>
<div class="line"><a name="l03035"></a><span class="lineno"> 3035</span>&#160;   d2psi_curve(34,2) = 0.0;</div>
<div class="line"><a name="l03036"></a><span class="lineno"> 3036</span>&#160;   d2psi_curve(33,2) = 0.0;</div>
<div class="line"><a name="l03037"></a><span class="lineno"> 3037</span>&#160;   d2psi_curve(35,2) = 0.0;</div>
<div class="line"><a name="l03038"></a><span class="lineno"> 3038</span>&#160;  }</div>
<div class="line"><a name="l03039"></a><span class="lineno"> 3039</span>&#160; };</div>
<div class="line"><a name="l03040"></a><span class="lineno"> 3040</span>&#160; </div>
<div class="line"><a name="l03041"></a><span class="lineno"> 3041</span>&#160;<span class="comment">//========================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l03042"></a><span class="lineno"> 3042</span>&#160;<span class="comment">/// Empty base class for the subparametric Bellelements (created so that </span></div>
<div class="line"><a name="l03043"></a><span class="lineno"> 3043</span>&#160;<span class="comment">/// we can use dynamic_cast&lt;&gt;() to figure out if a an element</span></div>
<div class="line"><a name="l03044"></a><span class="lineno"> 3044</span>&#160;<span class="comment">/// is a C1Curvedelement). This element is sub-parametric which means</span></div>
<div class="line"><a name="l03045"></a><span class="lineno"> 3045</span>&#160;<span class="comment">/// the geometry will be parametrised by the linear Lagrange functions,</span></div>
<div class="line"><a name="l03046"></a><span class="lineno"> 3046</span>&#160;<span class="comment">/// while unknowns will be parametrised by two kinds of shape functions</span></div>
<div class="line"><a name="l03047"></a><span class="lineno"> 3047</span>&#160;<span class="comment">/// basis : denotes C1-interpolations for c1-variables</span></div>
<div class="line"><a name="l03048"></a><span class="lineno"> 3048</span>&#160;<span class="comment">/// basis_c0 : denotes C0-interpolations for c0-variables</span></div>
<div class="line"><a name="l03049"></a><span class="lineno"> 3049</span>&#160;<span class="comment"></span><span class="comment">//========================================================================</span></div>
<div class="line"><a name="l03050"></a><span class="lineno"> 3050</span>&#160; </div>
<div class="line"><a name="l03051"></a><span class="lineno"> 3051</span>&#160;<span class="keyword">template</span>&lt;<span class="keywordtype">unsigned</span> NNODE_1D&gt;</div>
<div class="line"><a name="l03052"></a><span class="lineno"><a class="line" href="classoomph_1_1BellElementBase.html"> 3052</a></span>&#160;<span class="keyword">class </span><a class="code" href="classoomph_1_1BellElementBase.html">BellElementBase</a>: <span class="keyword">public</span> <span class="keyword">virtual</span> <a class="code" href="classoomph_1_1FiniteElement.html">FiniteElement</a></div>
<div class="line"><a name="l03053"></a><span class="lineno"> 3053</span>&#160;{</div>
<div class="line"><a name="l03054"></a><span class="lineno"> 3054</span>&#160;<span class="keyword">public</span>:<span class="comment"></span></div>
<div class="line"><a name="l03055"></a><span class="lineno"> 3055</span>&#160;<span class="comment">  ///\short  Constructor: Call constructors for FiniteElement </span></div>
<div class="line"><a name="l03056"></a><span class="lineno"><a class="line" href="classoomph_1_1BellElementBase.html#a79c5e60fb98c9e69b096ed84b3430376"> 3056</a></span>&#160;<span class="comment"></span>  <a class="code" href="classoomph_1_1BellElementBase.html#a79c5e60fb98c9e69b096ed84b3430376">BellElementBase</a>() : <a class="code" href="classoomph_1_1FiniteElement.html">FiniteElement</a>(){}</div>
<div class="line"><a name="l03057"></a><span class="lineno"> 3057</span>&#160; </div>
<div class="line"><a name="l03058"></a><span class="lineno"> 3058</span>&#160; </div>
<div class="line"><a name="l03059"></a><span class="lineno"><a class="line" href="classoomph_1_1BellElementBase.html#aee9266910010dcfca375fe0de13c17bb"> 3059</a></span>&#160; <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1BellElementBase.html#aee9266910010dcfca375fe0de13c17bb">basis</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>, <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;psi)<span class="keyword"> const</span></div>
<div class="line"><a name="l03060"></a><span class="lineno"> 3060</span>&#160;<span class="keyword">  </span>{}</div>
<div class="line"><a name="l03061"></a><span class="lineno"> 3061</span>&#160; </div>
<div class="line"><a name="l03062"></a><span class="lineno"> 3062</span>&#160; </div>
<div class="line"><a name="l03063"></a><span class="lineno"><a class="line" href="classoomph_1_1BellElementBase.html#a02f75fd57e4f6329a4b551df3d3c81eb"> 3063</a></span>&#160; <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1BellElementBase.html#a02f75fd57e4f6329a4b551df3d3c81eb">dbasis_local</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>, <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;psi,</div>
<div class="line"><a name="l03064"></a><span class="lineno"> 3064</span>&#160;                            <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;dpsids)<span class="keyword"> const</span></div>
<div class="line"><a name="l03065"></a><span class="lineno"> 3065</span>&#160;<span class="keyword">  </span>{}</div>
<div class="line"><a name="l03066"></a><span class="lineno"> 3066</span>&#160; </div>
<div class="line"><a name="l03067"></a><span class="lineno"><a class="line" href="classoomph_1_1BellElementBase.html#ac6c1add4a996cf149da6c85ee3f4b637"> 3067</a></span>&#160; <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1BellElementBase.html#ac6c1add4a996cf149da6c85ee3f4b637">d2basis_local</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>, </div>
<div class="line"><a name="l03068"></a><span class="lineno"> 3068</span>&#160;                             <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;psi, </div>
<div class="line"><a name="l03069"></a><span class="lineno"> 3069</span>&#160;                             <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;dpsids,</div>
<div class="line"><a name="l03070"></a><span class="lineno"> 3070</span>&#160;                             <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;d2psids)<span class="keyword"> const</span></div>
<div class="line"><a name="l03071"></a><span class="lineno"> 3071</span>&#160;<span class="keyword">  </span>{}</div>
<div class="line"><a name="l03072"></a><span class="lineno"> 3072</span>&#160; </div>
<div class="line"><a name="l03073"></a><span class="lineno"><a class="line" href="classoomph_1_1BellElementBase.html#a2c9a75b9d07c0aa569ba24d2b3228800"> 3073</a></span>&#160; <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1BellElementBase.html#a2c9a75b9d07c0aa569ba24d2b3228800">basis_c0</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>, <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;psi)<span class="keyword"> const</span></div>
<div class="line"><a name="l03074"></a><span class="lineno"> 3074</span>&#160;<span class="keyword">  </span>{}</div>
<div class="line"><a name="l03075"></a><span class="lineno"> 3075</span>&#160; </div>
<div class="line"><a name="l03076"></a><span class="lineno"> 3076</span>&#160; </div>
<div class="line"><a name="l03077"></a><span class="lineno"><a class="line" href="classoomph_1_1BellElementBase.html#ae863013db88be8402457a77eb5d5862f"> 3077</a></span>&#160; <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1BellElementBase.html#ae863013db88be8402457a77eb5d5862f">dbasis_c0_local</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>, <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;psi,</div>
<div class="line"><a name="l03078"></a><span class="lineno"> 3078</span>&#160;                            <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;dpsids)<span class="keyword"> const</span></div>
<div class="line"><a name="l03079"></a><span class="lineno"> 3079</span>&#160;<span class="keyword">  </span>{}</div>
<div class="line"><a name="l03080"></a><span class="lineno"> 3080</span>&#160; </div>
<div class="line"><a name="l03081"></a><span class="lineno"><a class="line" href="classoomph_1_1BellElementBase.html#aa9db3995e26ddee02bdae16dae111c03"> 3081</a></span>&#160; <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1BellElementBase.html#aa9db3995e26ddee02bdae16dae111c03">d2basis_c0_local</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>, </div>
<div class="line"><a name="l03082"></a><span class="lineno"> 3082</span>&#160;                             <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;psi, </div>
<div class="line"><a name="l03083"></a><span class="lineno"> 3083</span>&#160;                             <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;dpsids,</div>
<div class="line"><a name="l03084"></a><span class="lineno"> 3084</span>&#160;                             <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;d2psids)<span class="keyword"> const</span></div>
<div class="line"><a name="l03085"></a><span class="lineno"> 3085</span>&#160;<span class="keyword">  </span>{}</div>
<div class="line"><a name="l03086"></a><span class="lineno"> 3086</span>&#160; </div>
<div class="line"><a name="l03087"></a><span class="lineno"><a class="line" href="classoomph_1_1BellElementBase.html#a76ddb90394c979f9967e8fd068bdf220"> 3087</a></span>&#160; <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1BellElementBase.html#a76ddb90394c979f9967e8fd068bdf220">test</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>, <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;phi)<span class="keyword"> const</span></div>
<div class="line"><a name="l03088"></a><span class="lineno"> 3088</span>&#160;<span class="keyword">  </span>{}</div>
<div class="line"><a name="l03089"></a><span class="lineno"> 3089</span>&#160; </div>
<div class="line"><a name="l03090"></a><span class="lineno"> 3090</span>&#160; </div>
<div class="line"><a name="l03091"></a><span class="lineno"><a class="line" href="classoomph_1_1BellElementBase.html#aab180be9cd6347005c5505bedf673db2"> 3091</a></span>&#160; <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1BellElementBase.html#aab180be9cd6347005c5505bedf673db2">dtest_local</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>, <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;phi,</div>
<div class="line"><a name="l03092"></a><span class="lineno"> 3092</span>&#160;                            <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;dphids)<span class="keyword"> const</span></div>
<div class="line"><a name="l03093"></a><span class="lineno"> 3093</span>&#160;<span class="keyword">  </span>{}</div>
<div class="line"><a name="l03094"></a><span class="lineno"> 3094</span>&#160; </div>
<div class="line"><a name="l03095"></a><span class="lineno"><a class="line" href="classoomph_1_1BellElementBase.html#ae576f35c4faeeed475dff67a8b31ac37"> 3095</a></span>&#160; <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1BellElementBase.html#ae576f35c4faeeed475dff67a8b31ac37">d2test_local</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>, </div>
<div class="line"><a name="l03096"></a><span class="lineno"> 3096</span>&#160;                             <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;phi, </div>
<div class="line"><a name="l03097"></a><span class="lineno"> 3097</span>&#160;                             <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;dphids,</div>
<div class="line"><a name="l03098"></a><span class="lineno"> 3098</span>&#160;                             <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;d2phids)<span class="keyword"> const</span></div>
<div class="line"><a name="l03099"></a><span class="lineno"> 3099</span>&#160;<span class="keyword">  </span>{}</div>
<div class="line"><a name="l03100"></a><span class="lineno"> 3100</span>&#160; </div>
<div class="line"><a name="l03101"></a><span class="lineno"> 3101</span>&#160; </div>
<div class="line"><a name="l03102"></a><span class="lineno"> 3102</span>&#160; <span class="comment">//=========================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l03103"></a><span class="lineno"> 3103</span>&#160;<span class="comment"> /// \short Return the C1-basis function stored at the ipt-th integration</span></div>
<div class="line"><a name="l03104"></a><span class="lineno"> 3104</span>&#160;<span class="comment"> /// point.</span></div>
<div class="line"><a name="l03105"></a><span class="lineno"> 3105</span>&#160;<span class="comment"></span> <span class="comment">//=========================================================================</span></div>
<div class="line"><a name="l03106"></a><span class="lineno"><a class="line" href="classoomph_1_1BellElementBase.html#af00e238530de6269b51b57a4357d1dd6"> 3106</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1BellElementBase.html#af00e238530de6269b51b57a4357d1dd6">basis_at_knot</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;ipt, <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;psi)<span class="keyword"> const</span></div>
<div class="line"><a name="l03107"></a><span class="lineno"> 3107</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l03108"></a><span class="lineno"> 3108</span>&#160;   <span class="comment">//Find the dimension of the element</span></div>
<div class="line"><a name="l03109"></a><span class="lineno"> 3109</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> el_dim = <a class="code" href="classoomph_1_1FiniteElement.html#a5f8fe59f06da1da9f6b7bbcbdb90ef93">dim</a>();</div>
<div class="line"><a name="l03110"></a><span class="lineno"> 3110</span>&#160;   <span class="comment">//Storage for the local coordinates of the integration point</span></div>
<div class="line"><a name="l03111"></a><span class="lineno"> 3111</span>&#160;   <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>(el_dim); </div>
<div class="line"><a name="l03112"></a><span class="lineno"> 3112</span>&#160;   <span class="comment">//Set the local coordinate</span></div>
<div class="line"><a name="l03113"></a><span class="lineno"> 3113</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;el_dim;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++) {<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] = <a class="code" href="classoomph_1_1FiniteElement.html#a79f1710873332823c47023d370f0596b">integral_pt</a>()-&gt;<a class="code" href="classoomph_1_1Integral.html#a1a2122f99a87c18649bafdd9ed739758">knot</a>(ipt,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>);}</div>
<div class="line"><a name="l03114"></a><span class="lineno"> 3114</span>&#160;   <span class="comment">//Get the shape function</span></div>
<div class="line"><a name="l03115"></a><span class="lineno"> 3115</span>&#160;   <a class="code" href="classoomph_1_1BellElementBase.html#aee9266910010dcfca375fe0de13c17bb">basis</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,psi);</div>
<div class="line"><a name="l03116"></a><span class="lineno"> 3116</span>&#160;  }</div>
<div class="line"><a name="l03117"></a><span class="lineno"> 3117</span>&#160;  </div>
<div class="line"><a name="l03118"></a><span class="lineno"> 3118</span>&#160;  <span class="comment">//=========================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l03119"></a><span class="lineno"> 3119</span>&#160;<span class="comment"> /// \short Return the C1-basis function and its derivatives w.r.t. the global</span></div>
<div class="line"><a name="l03120"></a><span class="lineno"> 3120</span>&#160;<span class="comment"> /// coordinates at the ipt-th integration point.</span></div>
<div class="line"><a name="l03121"></a><span class="lineno"> 3121</span>&#160;<span class="comment"></span> <span class="comment">//=========================================================================</span></div>
<div class="line"><a name="l03122"></a><span class="lineno"><a class="line" href="classoomph_1_1BellElementBase.html#a795fca0c9cfa01bf6f966f4f0a69b312"> 3122</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1BellElementBase.html#a795fca0c9cfa01bf6f966f4f0a69b312">dbasis_local_at_knot</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;ipt, <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;psi,</div>
<div class="line"><a name="l03123"></a><span class="lineno"> 3123</span>&#160;                                           <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;dpsids)<span class="keyword"> const</span></div>
<div class="line"><a name="l03124"></a><span class="lineno"> 3124</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l03125"></a><span class="lineno"> 3125</span>&#160;   <span class="comment">//Find the dimension of the element</span></div>
<div class="line"><a name="l03126"></a><span class="lineno"> 3126</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> el_dim = <a class="code" href="classoomph_1_1FiniteElement.html#a5f8fe59f06da1da9f6b7bbcbdb90ef93">dim</a>();</div>
<div class="line"><a name="l03127"></a><span class="lineno"> 3127</span>&#160;   <span class="comment">//Storage for the local coordinates of the integration point</span></div>
<div class="line"><a name="l03128"></a><span class="lineno"> 3128</span>&#160;   <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>(el_dim); </div>
<div class="line"><a name="l03129"></a><span class="lineno"> 3129</span>&#160;   <span class="comment">//Set the local coordinate</span></div>
<div class="line"><a name="l03130"></a><span class="lineno"> 3130</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;el_dim;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++) {<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] = <a class="code" href="classoomph_1_1FiniteElement.html#a79f1710873332823c47023d370f0596b">integral_pt</a>()-&gt;<a class="code" href="classoomph_1_1Integral.html#a1a2122f99a87c18649bafdd9ed739758">knot</a>(ipt,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>);}</div>
<div class="line"><a name="l03131"></a><span class="lineno"> 3131</span>&#160; </div>
<div class="line"><a name="l03132"></a><span class="lineno"> 3132</span>&#160;   <span class="comment">//Get the shape function and derivatives</span></div>
<div class="line"><a name="l03133"></a><span class="lineno"> 3133</span>&#160;   <a class="code" href="classoomph_1_1BellElementBase.html#a02f75fd57e4f6329a4b551df3d3c81eb">dbasis_local</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,psi,dpsids);</div>
<div class="line"><a name="l03134"></a><span class="lineno"> 3134</span>&#160;  }</div>
<div class="line"><a name="l03135"></a><span class="lineno"> 3135</span>&#160; </div>
<div class="line"><a name="l03136"></a><span class="lineno"> 3136</span>&#160; <span class="comment">//=========================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l03137"></a><span class="lineno"> 3137</span>&#160;<span class="comment"> /// Calculate the C1-basis function and its first and second derivatives </span></div>
<div class="line"><a name="l03138"></a><span class="lineno"> 3138</span>&#160;<span class="comment"> /// w.r.t. global coordinates at the ipt-th integration point.</span></div>
<div class="line"><a name="l03139"></a><span class="lineno"> 3139</span>&#160;<span class="comment"> /// \n\n Numbering:</span></div>
<div class="line"><a name="l03140"></a><span class="lineno"> 3140</span>&#160;<span class="comment"></span> <span class="comment">//=========================================================================</span></div>
<div class="line"><a name="l03141"></a><span class="lineno"><a class="line" href="classoomph_1_1BellElementBase.html#ae5a43211398722298cf88ded87dee6ab"> 3141</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1BellElementBase.html#ae5a43211398722298cf88ded87dee6ab">d2basis_local_at_knot</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;ipt, <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;psi, </div>
<div class="line"><a name="l03142"></a><span class="lineno"> 3142</span>&#160;                                            <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;dpsids, <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;d2psids)<span class="keyword"> </span></div>
<div class="line"><a name="l03143"></a><span class="lineno"> 3143</span>&#160;<span class="keyword">   const</span></div>
<div class="line"><a name="l03144"></a><span class="lineno"> 3144</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l03145"></a><span class="lineno"> 3145</span>&#160;   <span class="comment">//Find the dimension of the element</span></div>
<div class="line"><a name="l03146"></a><span class="lineno"> 3146</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> el_dim = <a class="code" href="classoomph_1_1FiniteElement.html#a5f8fe59f06da1da9f6b7bbcbdb90ef93">dim</a>();</div>
<div class="line"><a name="l03147"></a><span class="lineno"> 3147</span>&#160;   <span class="comment">//Storage for the local coordinates of the integration point</span></div>
<div class="line"><a name="l03148"></a><span class="lineno"> 3148</span>&#160;   <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>(el_dim); </div>
<div class="line"><a name="l03149"></a><span class="lineno"> 3149</span>&#160;   <span class="comment">//Set the local coordinate</span></div>
<div class="line"><a name="l03150"></a><span class="lineno"> 3150</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;el_dim;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++) {<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] = <a class="code" href="classoomph_1_1FiniteElement.html#a79f1710873332823c47023d370f0596b">integral_pt</a>()-&gt;<a class="code" href="classoomph_1_1Integral.html#a1a2122f99a87c18649bafdd9ed739758">knot</a>(ipt,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>);}</div>
<div class="line"><a name="l03151"></a><span class="lineno"> 3151</span>&#160; </div>
<div class="line"><a name="l03152"></a><span class="lineno"> 3152</span>&#160;   <span class="comment">//Get the shape function and first and second derivatives</span></div>
<div class="line"><a name="l03153"></a><span class="lineno"> 3153</span>&#160;   <a class="code" href="classoomph_1_1BellElementBase.html#ac6c1add4a996cf149da6c85ee3f4b637">d2basis_local</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,psi,dpsids,d2psids);   </div>
<div class="line"><a name="l03154"></a><span class="lineno"> 3154</span>&#160;  }</div>
<div class="line"><a name="l03155"></a><span class="lineno"> 3155</span>&#160; </div>
<div class="line"><a name="l03156"></a><span class="lineno"> 3156</span>&#160;   <span class="comment">//=========================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l03157"></a><span class="lineno"> 3157</span>&#160;<span class="comment"> /// \short Return the C0-basis function stored at the ipt-th integration</span></div>
<div class="line"><a name="l03158"></a><span class="lineno"> 3158</span>&#160;<span class="comment"> /// point.</span></div>
<div class="line"><a name="l03159"></a><span class="lineno"> 3159</span>&#160;<span class="comment"></span> <span class="comment">//=========================================================================</span></div>
<div class="line"><a name="l03160"></a><span class="lineno"><a class="line" href="classoomph_1_1BellElementBase.html#a0952ed8fcba04688fdf895dc25bb8c30"> 3160</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1BellElementBase.html#a0952ed8fcba04688fdf895dc25bb8c30">basis_c0_at_knot</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;ipt, <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;psi)<span class="keyword"> const</span></div>
<div class="line"><a name="l03161"></a><span class="lineno"> 3161</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l03162"></a><span class="lineno"> 3162</span>&#160;   <span class="comment">//Find the dimension of the element</span></div>
<div class="line"><a name="l03163"></a><span class="lineno"> 3163</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> el_dim = <a class="code" href="classoomph_1_1FiniteElement.html#a5f8fe59f06da1da9f6b7bbcbdb90ef93">dim</a>();</div>
<div class="line"><a name="l03164"></a><span class="lineno"> 3164</span>&#160;   <span class="comment">//Storage for the local coordinates of the integration point</span></div>
<div class="line"><a name="l03165"></a><span class="lineno"> 3165</span>&#160;   <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>(el_dim); </div>
<div class="line"><a name="l03166"></a><span class="lineno"> 3166</span>&#160;   <span class="comment">//Set the local coordinate</span></div>
<div class="line"><a name="l03167"></a><span class="lineno"> 3167</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;el_dim;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++) {<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] = <a class="code" href="classoomph_1_1FiniteElement.html#a79f1710873332823c47023d370f0596b">integral_pt</a>()-&gt;<a class="code" href="classoomph_1_1Integral.html#a1a2122f99a87c18649bafdd9ed739758">knot</a>(ipt,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>);}</div>
<div class="line"><a name="l03168"></a><span class="lineno"> 3168</span>&#160;   <span class="comment">//Get the shape function</span></div>
<div class="line"><a name="l03169"></a><span class="lineno"> 3169</span>&#160;   <a class="code" href="classoomph_1_1BellElementBase.html#a2c9a75b9d07c0aa569ba24d2b3228800">basis_c0</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,psi);</div>
<div class="line"><a name="l03170"></a><span class="lineno"> 3170</span>&#160;  }</div>
<div class="line"><a name="l03171"></a><span class="lineno"> 3171</span>&#160;  </div>
<div class="line"><a name="l03172"></a><span class="lineno"> 3172</span>&#160;  <span class="comment">//=========================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l03173"></a><span class="lineno"> 3173</span>&#160;<span class="comment"> /// \short Return the C0-basis function and its derivatives w.r.t. the local</span></div>
<div class="line"><a name="l03174"></a><span class="lineno"> 3174</span>&#160;<span class="comment"> /// coordinates at the ipt-th integration point.</span></div>
<div class="line"><a name="l03175"></a><span class="lineno"> 3175</span>&#160;<span class="comment"></span> <span class="comment">//=========================================================================</span></div>
<div class="line"><a name="l03176"></a><span class="lineno"><a class="line" href="classoomph_1_1BellElementBase.html#a1d20473bb357a28c9aeea91454b4c959"> 3176</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1BellElementBase.html#a1d20473bb357a28c9aeea91454b4c959">dbasis_c0_local_at_knot</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;ipt, <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;psi,</div>
<div class="line"><a name="l03177"></a><span class="lineno"> 3177</span>&#160;                                           <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;dpsids)<span class="keyword"> const</span></div>
<div class="line"><a name="l03178"></a><span class="lineno"> 3178</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l03179"></a><span class="lineno"> 3179</span>&#160;   <span class="comment">//Find the dimension of the element</span></div>
<div class="line"><a name="l03180"></a><span class="lineno"> 3180</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> el_dim = <a class="code" href="classoomph_1_1FiniteElement.html#a5f8fe59f06da1da9f6b7bbcbdb90ef93">dim</a>();</div>
<div class="line"><a name="l03181"></a><span class="lineno"> 3181</span>&#160;   <span class="comment">//Storage for the local coordinates of the integration point</span></div>
<div class="line"><a name="l03182"></a><span class="lineno"> 3182</span>&#160;   <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>(el_dim); </div>
<div class="line"><a name="l03183"></a><span class="lineno"> 3183</span>&#160;   <span class="comment">//Set the local coordinate</span></div>
<div class="line"><a name="l03184"></a><span class="lineno"> 3184</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;el_dim;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++) {<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] = <a class="code" href="classoomph_1_1FiniteElement.html#a79f1710873332823c47023d370f0596b">integral_pt</a>()-&gt;<a class="code" href="classoomph_1_1Integral.html#a1a2122f99a87c18649bafdd9ed739758">knot</a>(ipt,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>);}</div>
<div class="line"><a name="l03185"></a><span class="lineno"> 3185</span>&#160;   <span class="comment">//Get the shape function and derivatives</span></div>
<div class="line"><a name="l03186"></a><span class="lineno"> 3186</span>&#160;   </div>
<div class="line"><a name="l03187"></a><span class="lineno"> 3187</span>&#160;   <a class="code" href="classoomph_1_1BellElementBase.html#ae863013db88be8402457a77eb5d5862f">dbasis_c0_local</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,psi,dpsids);</div>
<div class="line"><a name="l03188"></a><span class="lineno"> 3188</span>&#160;   </div>
<div class="line"><a name="l03189"></a><span class="lineno"> 3189</span>&#160;  }</div>
<div class="line"><a name="l03190"></a><span class="lineno"> 3190</span>&#160; </div>
<div class="line"><a name="l03191"></a><span class="lineno"> 3191</span>&#160; <span class="comment">//=========================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l03192"></a><span class="lineno"> 3192</span>&#160;<span class="comment"> /// Calculate the C0-basis function and its first and second derivatives </span></div>
<div class="line"><a name="l03193"></a><span class="lineno"> 3193</span>&#160;<span class="comment"> /// w.r.t. local coordinates at the ipt-th integration point.</span></div>
<div class="line"><a name="l03194"></a><span class="lineno"> 3194</span>&#160;<span class="comment"> /// \n\n Numbering:</span></div>
<div class="line"><a name="l03195"></a><span class="lineno"> 3195</span>&#160;<span class="comment"></span> <span class="comment">//=========================================================================</span></div>
<div class="line"><a name="l03196"></a><span class="lineno"><a class="line" href="classoomph_1_1BellElementBase.html#ac452af5196c5a49040a2d6ab871a1284"> 3196</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1BellElementBase.html#ac452af5196c5a49040a2d6ab871a1284">d2basis_c0_local_at_knot</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;ipt, <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;psi, </div>
<div class="line"><a name="l03197"></a><span class="lineno"> 3197</span>&#160;                                            <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;dpsids, <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;d2psids)<span class="keyword"> </span></div>
<div class="line"><a name="l03198"></a><span class="lineno"> 3198</span>&#160;<span class="keyword">   const</span></div>
<div class="line"><a name="l03199"></a><span class="lineno"> 3199</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l03200"></a><span class="lineno"> 3200</span>&#160;   <span class="comment">//Find the dimension of the element</span></div>
<div class="line"><a name="l03201"></a><span class="lineno"> 3201</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> el_dim = <a class="code" href="classoomph_1_1FiniteElement.html#a5f8fe59f06da1da9f6b7bbcbdb90ef93">dim</a>();</div>
<div class="line"><a name="l03202"></a><span class="lineno"> 3202</span>&#160;   <span class="comment">//Storage for the local coordinates of the integration point</span></div>
<div class="line"><a name="l03203"></a><span class="lineno"> 3203</span>&#160;   <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>(el_dim); </div>
<div class="line"><a name="l03204"></a><span class="lineno"> 3204</span>&#160;   <span class="comment">//Set the local coordinate</span></div>
<div class="line"><a name="l03205"></a><span class="lineno"> 3205</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;el_dim;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++) {<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] = <a class="code" href="classoomph_1_1FiniteElement.html#a79f1710873332823c47023d370f0596b">integral_pt</a>()-&gt;<a class="code" href="classoomph_1_1Integral.html#a1a2122f99a87c18649bafdd9ed739758">knot</a>(ipt,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>);}</div>
<div class="line"><a name="l03206"></a><span class="lineno"> 3206</span>&#160;   <span class="comment">//Get the shape function and first and second derivatives</span></div>
<div class="line"><a name="l03207"></a><span class="lineno"> 3207</span>&#160;   <a class="code" href="classoomph_1_1BellElementBase.html#aa9db3995e26ddee02bdae16dae111c03">d2basis_c0_local</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,psi,dpsids,d2psids);</div>
<div class="line"><a name="l03208"></a><span class="lineno"> 3208</span>&#160;   </div>
<div class="line"><a name="l03209"></a><span class="lineno"> 3209</span>&#160;  }</div>
<div class="line"><a name="l03210"></a><span class="lineno"> 3210</span>&#160; </div>
<div class="line"><a name="l03211"></a><span class="lineno"> 3211</span>&#160; <span class="comment">//=========================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l03212"></a><span class="lineno"> 3212</span>&#160;<span class="comment"> /// \short Return the test function stored at the ipt-th integration</span></div>
<div class="line"><a name="l03213"></a><span class="lineno"> 3213</span>&#160;<span class="comment"> /// point.</span></div>
<div class="line"><a name="l03214"></a><span class="lineno"> 3214</span>&#160;<span class="comment"></span> <span class="comment">//=========================================================================</span></div>
<div class="line"><a name="l03215"></a><span class="lineno"><a class="line" href="classoomph_1_1BellElementBase.html#aa838429de6549ebb7b9c6d47b17b7859"> 3215</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1BellElementBase.html#aa838429de6549ebb7b9c6d47b17b7859">test_at_knot</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;ipt, <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;phi)<span class="keyword"> const</span></div>
<div class="line"><a name="l03216"></a><span class="lineno"> 3216</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l03217"></a><span class="lineno"> 3217</span>&#160;   <span class="comment">//Find the dimension of the element</span></div>
<div class="line"><a name="l03218"></a><span class="lineno"> 3218</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> el_dim = <a class="code" href="classoomph_1_1FiniteElement.html#a5f8fe59f06da1da9f6b7bbcbdb90ef93">dim</a>();</div>
<div class="line"><a name="l03219"></a><span class="lineno"> 3219</span>&#160;   <span class="comment">//Storage for the local coordinates of the integration point</span></div>
<div class="line"><a name="l03220"></a><span class="lineno"> 3220</span>&#160;   <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>(el_dim); </div>
<div class="line"><a name="l03221"></a><span class="lineno"> 3221</span>&#160;   <span class="comment">//Set the local coordinate</span></div>
<div class="line"><a name="l03222"></a><span class="lineno"> 3222</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;el_dim;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++) {<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] = <a class="code" href="classoomph_1_1FiniteElement.html#a79f1710873332823c47023d370f0596b">integral_pt</a>()-&gt;<a class="code" href="classoomph_1_1Integral.html#a1a2122f99a87c18649bafdd9ed739758">knot</a>(ipt,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>);}</div>
<div class="line"><a name="l03223"></a><span class="lineno"> 3223</span>&#160;   <span class="comment">//Get the shape function</span></div>
<div class="line"><a name="l03224"></a><span class="lineno"> 3224</span>&#160;   <a class="code" href="classoomph_1_1BellElementBase.html#a76ddb90394c979f9967e8fd068bdf220">test</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,phi);</div>
<div class="line"><a name="l03225"></a><span class="lineno"> 3225</span>&#160;  }</div>
<div class="line"><a name="l03226"></a><span class="lineno"> 3226</span>&#160;  </div>
<div class="line"><a name="l03227"></a><span class="lineno"> 3227</span>&#160;  <span class="comment">//=========================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l03228"></a><span class="lineno"> 3228</span>&#160;<span class="comment"> /// \short Return the test function and its derivatives w.r.t. the local</span></div>
<div class="line"><a name="l03229"></a><span class="lineno"> 3229</span>&#160;<span class="comment"> /// coordinates at the ipt-th integration point.</span></div>
<div class="line"><a name="l03230"></a><span class="lineno"> 3230</span>&#160;<span class="comment"></span> <span class="comment">//=========================================================================</span></div>
<div class="line"><a name="l03231"></a><span class="lineno"><a class="line" href="classoomph_1_1BellElementBase.html#a5ca86e4bbc0c1c0df2554e02669a0949"> 3231</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1BellElementBase.html#a5ca86e4bbc0c1c0df2554e02669a0949">dtest_local_at_knot</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;ipt, <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;phi,</div>
<div class="line"><a name="l03232"></a><span class="lineno"> 3232</span>&#160;                                           <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;dphids)<span class="keyword"> const</span></div>
<div class="line"><a name="l03233"></a><span class="lineno"> 3233</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l03234"></a><span class="lineno"> 3234</span>&#160;   <span class="comment">//Find the dimension of the element</span></div>
<div class="line"><a name="l03235"></a><span class="lineno"> 3235</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> el_dim = <a class="code" href="classoomph_1_1FiniteElement.html#a5f8fe59f06da1da9f6b7bbcbdb90ef93">dim</a>();</div>
<div class="line"><a name="l03236"></a><span class="lineno"> 3236</span>&#160;   <span class="comment">//Storage for the local coordinates of the integration point</span></div>
<div class="line"><a name="l03237"></a><span class="lineno"> 3237</span>&#160;   <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>(el_dim); </div>
<div class="line"><a name="l03238"></a><span class="lineno"> 3238</span>&#160;   <span class="comment">//Set the local coordinate</span></div>
<div class="line"><a name="l03239"></a><span class="lineno"> 3239</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;el_dim;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++) {<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] = <a class="code" href="classoomph_1_1FiniteElement.html#a79f1710873332823c47023d370f0596b">integral_pt</a>()-&gt;<a class="code" href="classoomph_1_1Integral.html#a1a2122f99a87c18649bafdd9ed739758">knot</a>(ipt,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>);}</div>
<div class="line"><a name="l03240"></a><span class="lineno"> 3240</span>&#160;   <span class="comment">//Get the shape function and derivatives</span></div>
<div class="line"><a name="l03241"></a><span class="lineno"> 3241</span>&#160;   <a class="code" href="classoomph_1_1BellElementBase.html#aab180be9cd6347005c5505bedf673db2">dtest_local</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,phi,dphids);</div>
<div class="line"><a name="l03242"></a><span class="lineno"> 3242</span>&#160;  }</div>
<div class="line"><a name="l03243"></a><span class="lineno"> 3243</span>&#160; </div>
<div class="line"><a name="l03244"></a><span class="lineno"> 3244</span>&#160; <span class="comment">//=========================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l03245"></a><span class="lineno"> 3245</span>&#160;<span class="comment"> /// Calculate the test function and its first and second derivatives </span></div>
<div class="line"><a name="l03246"></a><span class="lineno"> 3246</span>&#160;<span class="comment"> /// w.r.t. local coordinates at the ipt-th integration point.</span></div>
<div class="line"><a name="l03247"></a><span class="lineno"> 3247</span>&#160;<span class="comment"> /// \n\n Numbering:</span></div>
<div class="line"><a name="l03248"></a><span class="lineno"> 3248</span>&#160;<span class="comment"></span> <span class="comment">//=========================================================================</span></div>
<div class="line"><a name="l03249"></a><span class="lineno"><a class="line" href="classoomph_1_1BellElementBase.html#acad63d477784e6b88b92804b0f1b375e"> 3249</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1BellElementBase.html#acad63d477784e6b88b92804b0f1b375e">d2test_local_at_knot</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;ipt, <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;phi, </div>
<div class="line"><a name="l03250"></a><span class="lineno"> 3250</span>&#160;                                            <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;dphids, <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;d2phids)<span class="keyword"> </span></div>
<div class="line"><a name="l03251"></a><span class="lineno"> 3251</span>&#160;<span class="keyword">   const</span></div>
<div class="line"><a name="l03252"></a><span class="lineno"> 3252</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l03253"></a><span class="lineno"> 3253</span>&#160;   <span class="comment">//Find the dimension of the element</span></div>
<div class="line"><a name="l03254"></a><span class="lineno"> 3254</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> el_dim = <a class="code" href="classoomph_1_1FiniteElement.html#a5f8fe59f06da1da9f6b7bbcbdb90ef93">dim</a>();</div>
<div class="line"><a name="l03255"></a><span class="lineno"> 3255</span>&#160;   <span class="comment">//Storage for the local coordinates of the integration point</span></div>
<div class="line"><a name="l03256"></a><span class="lineno"> 3256</span>&#160;   <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>(el_dim); </div>
<div class="line"><a name="l03257"></a><span class="lineno"> 3257</span>&#160;   <span class="comment">//Set the local coordinate</span></div>
<div class="line"><a name="l03258"></a><span class="lineno"> 3258</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;el_dim;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++) {<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] = <a class="code" href="classoomph_1_1FiniteElement.html#a79f1710873332823c47023d370f0596b">integral_pt</a>()-&gt;<a class="code" href="classoomph_1_1Integral.html#a1a2122f99a87c18649bafdd9ed739758">knot</a>(ipt,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>);}</div>
<div class="line"><a name="l03259"></a><span class="lineno"> 3259</span>&#160;   <span class="comment">//Get the shape function and first and second derivatives</span></div>
<div class="line"><a name="l03260"></a><span class="lineno"> 3260</span>&#160;   <a class="code" href="classoomph_1_1BellElementBase.html#ae576f35c4faeeed475dff67a8b31ac37">d2test_local</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,phi,dphids,d2phids);</div>
<div class="line"><a name="l03261"></a><span class="lineno"> 3261</span>&#160;  }</div>
<div class="line"><a name="l03262"></a><span class="lineno"> 3262</span>&#160;  </div>
<div class="line"><a name="l03263"></a><span class="lineno"> 3263</span>&#160;  <span class="comment">//=========================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l03264"></a><span class="lineno"> 3264</span>&#160;<span class="comment">  /// \short Compute the curved-element shape functions and also</span></div>
<div class="line"><a name="l03265"></a><span class="lineno"> 3265</span>&#160;<span class="comment">  /// first derivatives w.r.t. local coordinates at local coordinate s;</span></div>
<div class="line"><a name="l03266"></a><span class="lineno"> 3266</span>&#160;<span class="comment">  /// Returns Jacobian of mapping from global to local coordinates.</span></div>
<div class="line"><a name="l03267"></a><span class="lineno"> 3267</span>&#160;<span class="comment">  /// Most general form of the function, but may be over-loaded, if desired</span></div>
<div class="line"><a name="l03268"></a><span class="lineno"> 3268</span>&#160;<span class="comment"></span>  <span class="comment">//=========================================================================</span></div>
<div class="line"><a name="l03269"></a><span class="lineno"><a class="line" href="classoomph_1_1BellElementBase.html#a27559cf4dd3cb50a84dfe40378c9c453"> 3269</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1BellElementBase.html#a27559cf4dd3cb50a84dfe40378c9c453">dbasis_c0_eulerian</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>, </div>
<div class="line"><a name="l03270"></a><span class="lineno"> 3270</span>&#160;                                        <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;psi,</div>
<div class="line"><a name="l03271"></a><span class="lineno"> 3271</span>&#160;                                        <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;dpsi)<span class="keyword"> const</span></div>
<div class="line"><a name="l03272"></a><span class="lineno"> 3272</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l03273"></a><span class="lineno"> 3273</span>&#160;   <span class="comment">//Find the element dimension</span></div>
<div class="line"><a name="l03274"></a><span class="lineno"> 3274</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> el_dim = <a class="code" href="classoomph_1_1FiniteElement.html#a5f8fe59f06da1da9f6b7bbcbdb90ef93">dim</a>();</div>
<div class="line"><a name="l03275"></a><span class="lineno"> 3275</span>&#160;   <span class="comment">//Get the values of the shape functions and their local derivatives</span></div>
<div class="line"><a name="l03276"></a><span class="lineno"> 3276</span>&#160;   <span class="comment">//Temporarily stored in dpsi</span></div>
<div class="line"><a name="l03277"></a><span class="lineno"> 3277</span>&#160;   <a class="code" href="classoomph_1_1BellElementBase.html#ae863013db88be8402457a77eb5d5862f">dbasis_c0_local</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,psi,dpsi);</div>
<div class="line"><a name="l03278"></a><span class="lineno"> 3278</span>&#160;   </div>
<div class="line"><a name="l03279"></a><span class="lineno"> 3279</span>&#160;    <span class="comment">// assign shape functions for geometry</span></div>
<div class="line"><a name="l03280"></a><span class="lineno"> 3280</span>&#160;   <span class="keywordtype">unsigned</span> n_node = 3;</div>
<div class="line"><a name="l03281"></a><span class="lineno"> 3281</span>&#160;   <a class="code" href="classoomph_1_1Shape.html">Shape</a> psi_x(n_node);</div>
<div class="line"><a name="l03282"></a><span class="lineno"> 3282</span>&#160;   <a class="code" href="classoomph_1_1DShape.html">DShape</a> dpsi_x(n_node,2);</div>
<div class="line"><a name="l03283"></a><span class="lineno"> 3283</span>&#160;   <a class="code" href="classoomph_1_1DShape.html">DShape</a> d2psi_x(n_node,3);</div>
<div class="line"><a name="l03284"></a><span class="lineno"> 3284</span>&#160;   </div>
<div class="line"><a name="l03285"></a><span class="lineno"> 3285</span>&#160;   <a class="code" href="classoomph_1_1FiniteElement.html#a53e5051582d9da07b9d35da9debd0cd7">d2shape_local</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,psi_x,dpsi_x,d2psi_x);</div>
<div class="line"><a name="l03286"></a><span class="lineno"> 3286</span>&#160;   </div>
<div class="line"><a name="l03287"></a><span class="lineno"> 3287</span>&#160;   <span class="comment">//Allocate memory for the jacobian and inverse jacobian </span></div>
<div class="line"><a name="l03288"></a><span class="lineno"> 3288</span>&#160;   <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> jacobian(el_dim), inverse_jacobian(el_dim);</div>
<div class="line"><a name="l03289"></a><span class="lineno"> 3289</span>&#160; </div>
<div class="line"><a name="l03290"></a><span class="lineno"> 3290</span>&#160;   <span class="comment">//Calculate the jacobian and inverse jacobian</span></div>
<div class="line"><a name="l03291"></a><span class="lineno"> 3291</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">double</span> det = this-&gt;<a class="code" href="classoomph_1_1BellElementBase.html#a17c3c26035cb8f8696073b97dabbe392">local_to_eulerian_mapping2</a>(dpsi_x,jacobian,inverse_jacobian);</div>
<div class="line"><a name="l03292"></a><span class="lineno"> 3292</span>&#160; </div>
<div class="line"><a name="l03293"></a><span class="lineno"> 3293</span>&#160;   <span class="comment">//Now set the values of the derivatives to be dpsidx</span></div>
<div class="line"><a name="l03294"></a><span class="lineno"> 3294</span>&#160;   <a class="code" href="classoomph_1_1FiniteElement.html#a2c2f243c9f450c4023e5aa4246facd20">transform_derivatives</a>(inverse_jacobian,dpsi);</div>
<div class="line"><a name="l03295"></a><span class="lineno"> 3295</span>&#160; </div>
<div class="line"><a name="l03296"></a><span class="lineno"> 3296</span>&#160;   <span class="comment">//Return the determinant of the jacobian</span></div>
<div class="line"><a name="l03297"></a><span class="lineno"> 3297</span>&#160;   <span class="keywordflow">return</span> det;</div>
<div class="line"><a name="l03298"></a><span class="lineno"> 3298</span>&#160;  }</div>
<div class="line"><a name="l03299"></a><span class="lineno"> 3299</span>&#160; </div>
<div class="line"><a name="l03300"></a><span class="lineno"> 3300</span>&#160;  <span class="comment">//===========================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l03301"></a><span class="lineno"> 3301</span>&#160;<span class="comment">  /// \short Compute the c0-basis functions and also first</span></div>
<div class="line"><a name="l03302"></a><span class="lineno"> 3302</span>&#160;<span class="comment">  /// and second derivatives w.r.t. local coordinates at ipt-th integration</span></div>
<div class="line"><a name="l03303"></a><span class="lineno"> 3303</span>&#160;<span class="comment">  /// point</span></div>
<div class="line"><a name="l03304"></a><span class="lineno"> 3304</span>&#160;<span class="comment"></span>  <span class="comment">//===========================================================================</span></div>
<div class="line"><a name="l03305"></a><span class="lineno"><a class="line" href="classoomph_1_1BellElementBase.html#ac975de34dadf1e1409bb022af6ed1b1d"> 3305</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1BellElementBase.html#ac975de34dadf1e1409bb022af6ed1b1d">d2basis_c0_eulerian</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>, <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;psi, </div>
<div class="line"><a name="l03306"></a><span class="lineno"> 3306</span>&#160;                                      <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;dpsi, </div>
<div class="line"><a name="l03307"></a><span class="lineno"> 3307</span>&#160;                                      <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;d2psi)<span class="keyword"> const</span></div>
<div class="line"><a name="l03308"></a><span class="lineno"> 3308</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l03309"></a><span class="lineno"> 3309</span>&#160;   <span class="comment">//Find the element dimension</span></div>
<div class="line"><a name="l03310"></a><span class="lineno"> 3310</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> el_dim = <a class="code" href="classoomph_1_1FiniteElement.html#a5f8fe59f06da1da9f6b7bbcbdb90ef93">dim</a>();</div>
<div class="line"><a name="l03311"></a><span class="lineno"> 3311</span>&#160;   <span class="comment">//Find the number of second derivatives required</span></div>
<div class="line"><a name="l03312"></a><span class="lineno"> 3312</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_deriv = <a class="code" href="classoomph_1_1FiniteElement.html#ad1600b17efbe61db27a4c622af1f28cf">N2deriv</a>[el_dim];</div>
<div class="line"><a name="l03313"></a><span class="lineno"> 3313</span>&#160;   <span class="comment">//Get the values of the shape function and local derivatives for unknowns</span></div>
<div class="line"><a name="l03314"></a><span class="lineno"> 3314</span>&#160;   <a class="code" href="classoomph_1_1BellElementBase.html#aa9db3995e26ddee02bdae16dae111c03">d2basis_c0_local</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,psi,dpsi,d2psi);</div>
<div class="line"><a name="l03315"></a><span class="lineno"> 3315</span>&#160;     </div>
<div class="line"><a name="l03316"></a><span class="lineno"> 3316</span>&#160;   <span class="comment">// assign shape functions for geometry</span></div>
<div class="line"><a name="l03317"></a><span class="lineno"> 3317</span>&#160;   <span class="keywordtype">unsigned</span> n_node = 3;</div>
<div class="line"><a name="l03318"></a><span class="lineno"> 3318</span>&#160;   <a class="code" href="classoomph_1_1Shape.html">Shape</a> psi_x(n_node);</div>
<div class="line"><a name="l03319"></a><span class="lineno"> 3319</span>&#160;   <a class="code" href="classoomph_1_1DShape.html">DShape</a> dpsi_x(n_node,2);</div>
<div class="line"><a name="l03320"></a><span class="lineno"> 3320</span>&#160;   <a class="code" href="classoomph_1_1DShape.html">DShape</a> d2psi_x(n_node,3);</div>
<div class="line"><a name="l03321"></a><span class="lineno"> 3321</span>&#160;   </div>
<div class="line"><a name="l03322"></a><span class="lineno"> 3322</span>&#160;   <a class="code" href="classoomph_1_1FiniteElement.html#a53e5051582d9da07b9d35da9debd0cd7">d2shape_local</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,psi_x,dpsi_x,d2psi_x);</div>
<div class="line"><a name="l03323"></a><span class="lineno"> 3323</span>&#160;   </div>
<div class="line"><a name="l03324"></a><span class="lineno"> 3324</span>&#160;   <span class="comment">//Allocate memory for the jacobian and inverse jacobian </span></div>
<div class="line"><a name="l03325"></a><span class="lineno"> 3325</span>&#160;   <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> jacobian(el_dim), inverse_jacobian(el_dim);</div>
<div class="line"><a name="l03326"></a><span class="lineno"> 3326</span>&#160; </div>
<div class="line"><a name="l03327"></a><span class="lineno"> 3327</span>&#160;   <span class="comment">//Calculate the jacobian and inverse jacobian</span></div>
<div class="line"><a name="l03328"></a><span class="lineno"> 3328</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">double</span> det = <a class="code" href="classoomph_1_1BellElementBase.html#a17c3c26035cb8f8696073b97dabbe392">local_to_eulerian_mapping2</a>(dpsi_x,jacobian,inverse_jacobian);</div>
<div class="line"><a name="l03329"></a><span class="lineno"> 3329</span>&#160; </div>
<div class="line"><a name="l03330"></a><span class="lineno"> 3330</span>&#160;   <span class="comment">//Allocate memory for the jacobian of second derivatives</span></div>
<div class="line"><a name="l03331"></a><span class="lineno"> 3331</span>&#160;   <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> jacobian2(n_deriv,el_dim,0.0);</div>
<div class="line"><a name="l03332"></a><span class="lineno"> 3332</span>&#160; </div>
<div class="line"><a name="l03333"></a><span class="lineno"> 3333</span>&#160;   <span class="comment">//Assemble the jacobian of second derivatives</span></div>
<div class="line"><a name="l03334"></a><span class="lineno"> 3334</span>&#160;   <a class="code" href="classoomph_1_1BellElementBase.html#abd5f258248221f2f564c87ced9e0a83e">myassemble_local_to_eulerian_jacobian2</a>(d2psi_x,jacobian2);  </div>
<div class="line"><a name="l03335"></a><span class="lineno"> 3335</span>&#160; </div>
<div class="line"><a name="l03336"></a><span class="lineno"> 3336</span>&#160;   <span class="comment">//Now set the value of the derivatives</span></div>
<div class="line"><a name="l03337"></a><span class="lineno"> 3337</span>&#160;   <a class="code" href="classoomph_1_1FiniteElement.html#ab2c61e830b834bbd1159c679b1c093ba">transform_second_derivatives</a>(jacobian,inverse_jacobian,jacobian2,dpsi,d2psi);</div>
<div class="line"><a name="l03338"></a><span class="lineno"> 3338</span>&#160; </div>
<div class="line"><a name="l03339"></a><span class="lineno"> 3339</span>&#160;   <span class="comment">//Return the determinant of the jacobian</span></div>
<div class="line"><a name="l03340"></a><span class="lineno"> 3340</span>&#160;   <span class="keywordflow">return</span> det;</div>
<div class="line"><a name="l03341"></a><span class="lineno"> 3341</span>&#160;  }</div>
<div class="line"><a name="l03342"></a><span class="lineno"> 3342</span>&#160; </div>
<div class="line"><a name="l03343"></a><span class="lineno"> 3343</span>&#160;  <span class="comment">//=========================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l03344"></a><span class="lineno"> 3344</span>&#160;<span class="comment">  /// \short Compute the c1-basis functions and also</span></div>
<div class="line"><a name="l03345"></a><span class="lineno"> 3345</span>&#160;<span class="comment">  /// first derivatives w.r.t. global coordinates at local coordinate s;</span></div>
<div class="line"><a name="l03346"></a><span class="lineno"> 3346</span>&#160;<span class="comment">  /// Returns Jacobian of mapping from global to local coordinates.</span></div>
<div class="line"><a name="l03347"></a><span class="lineno"> 3347</span>&#160;<span class="comment">  /// Most general form of the function, but may be over-loaded, if desired</span></div>
<div class="line"><a name="l03348"></a><span class="lineno"> 3348</span>&#160;<span class="comment"></span>  <span class="comment">//=========================================================================</span></div>
<div class="line"><a name="l03349"></a><span class="lineno"><a class="line" href="classoomph_1_1BellElementBase.html#a3264c8f4cac79ac554015658e1074dbc"> 3349</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1BellElementBase.html#a3264c8f4cac79ac554015658e1074dbc">dbasis_eulerian</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>, </div>
<div class="line"><a name="l03350"></a><span class="lineno"> 3350</span>&#160;                                        <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;psi,</div>
<div class="line"><a name="l03351"></a><span class="lineno"> 3351</span>&#160;                                        <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;dpsi)<span class="keyword"> const</span></div>
<div class="line"><a name="l03352"></a><span class="lineno"> 3352</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l03353"></a><span class="lineno"> 3353</span>&#160;   <span class="comment">//Find the element dimension</span></div>
<div class="line"><a name="l03354"></a><span class="lineno"> 3354</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> el_dim = <a class="code" href="classoomph_1_1FiniteElement.html#a5f8fe59f06da1da9f6b7bbcbdb90ef93">dim</a>();</div>
<div class="line"><a name="l03355"></a><span class="lineno"> 3355</span>&#160;   <span class="comment">//Get the values of the shape functions and their local derivatives</span></div>
<div class="line"><a name="l03356"></a><span class="lineno"> 3356</span>&#160;   <span class="comment">//Temporarily stored in dpsi</span></div>
<div class="line"><a name="l03357"></a><span class="lineno"> 3357</span>&#160;   <a class="code" href="classoomph_1_1BellElementBase.html#a02f75fd57e4f6329a4b551df3d3c81eb">dbasis_local</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,psi,dpsi);</div>
<div class="line"><a name="l03358"></a><span class="lineno"> 3358</span>&#160;   </div>
<div class="line"><a name="l03359"></a><span class="lineno"> 3359</span>&#160;    <span class="comment">// assign shape functions for geometry</span></div>
<div class="line"><a name="l03360"></a><span class="lineno"> 3360</span>&#160;   <span class="keywordtype">unsigned</span> n_node = 3;</div>
<div class="line"><a name="l03361"></a><span class="lineno"> 3361</span>&#160;   <a class="code" href="classoomph_1_1Shape.html">Shape</a> psi_x(n_node);</div>
<div class="line"><a name="l03362"></a><span class="lineno"> 3362</span>&#160;   <a class="code" href="classoomph_1_1DShape.html">DShape</a> dpsi_x(n_node,2);</div>
<div class="line"><a name="l03363"></a><span class="lineno"> 3363</span>&#160;   <a class="code" href="classoomph_1_1DShape.html">DShape</a> d2psi_x(n_node,3);</div>
<div class="line"><a name="l03364"></a><span class="lineno"> 3364</span>&#160;   </div>
<div class="line"><a name="l03365"></a><span class="lineno"> 3365</span>&#160;   <a class="code" href="classoomph_1_1FiniteElement.html#a53e5051582d9da07b9d35da9debd0cd7">d2shape_local</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,psi_x,dpsi_x,d2psi_x);</div>
<div class="line"><a name="l03366"></a><span class="lineno"> 3366</span>&#160;   </div>
<div class="line"><a name="l03367"></a><span class="lineno"> 3367</span>&#160;   <span class="comment">//Allocate memory for the jacobian and inverse jacobian </span></div>
<div class="line"><a name="l03368"></a><span class="lineno"> 3368</span>&#160;   <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> jacobian(el_dim), inverse_jacobian(el_dim);</div>
<div class="line"><a name="l03369"></a><span class="lineno"> 3369</span>&#160; </div>
<div class="line"><a name="l03370"></a><span class="lineno"> 3370</span>&#160;   <span class="comment">//Calculate the jacobian and inverse jacobian</span></div>
<div class="line"><a name="l03371"></a><span class="lineno"> 3371</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">double</span> det = this-&gt;<a class="code" href="classoomph_1_1BellElementBase.html#a17c3c26035cb8f8696073b97dabbe392">local_to_eulerian_mapping2</a>(dpsi_x,jacobian,inverse_jacobian);</div>
<div class="line"><a name="l03372"></a><span class="lineno"> 3372</span>&#160;   </div>
<div class="line"><a name="l03373"></a><span class="lineno"> 3373</span>&#160;   <span class="comment">//Return the determinant of the jacobian</span></div>
<div class="line"><a name="l03374"></a><span class="lineno"> 3374</span>&#160;   <span class="keywordflow">return</span> det;</div>
<div class="line"><a name="l03375"></a><span class="lineno"> 3375</span>&#160;  }</div>
<div class="line"><a name="l03376"></a><span class="lineno"> 3376</span>&#160; </div>
<div class="line"><a name="l03377"></a><span class="lineno"> 3377</span>&#160;  <span class="comment">//===========================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l03378"></a><span class="lineno"> 3378</span>&#160;<span class="comment">  /// \short Compute the c1-basis functions and also first</span></div>
<div class="line"><a name="l03379"></a><span class="lineno"> 3379</span>&#160;<span class="comment">  /// and second derivatives w.r.t. global coordinates at ipt-th integration</span></div>
<div class="line"><a name="l03380"></a><span class="lineno"> 3380</span>&#160;<span class="comment">  /// point</span></div>
<div class="line"><a name="l03381"></a><span class="lineno"> 3381</span>&#160;<span class="comment"></span>  <span class="comment">//===========================================================================</span></div>
<div class="line"><a name="l03382"></a><span class="lineno"><a class="line" href="classoomph_1_1BellElementBase.html#af6a719134aecd142c6a9667607993171"> 3382</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1BellElementBase.html#af6a719134aecd142c6a9667607993171">d2basis_eulerian</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>, <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;psi, </div>
<div class="line"><a name="l03383"></a><span class="lineno"> 3383</span>&#160;                                      <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;dpsi, </div>
<div class="line"><a name="l03384"></a><span class="lineno"> 3384</span>&#160;                                      <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;d2psi)<span class="keyword"> const</span></div>
<div class="line"><a name="l03385"></a><span class="lineno"> 3385</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l03386"></a><span class="lineno"> 3386</span>&#160;   <span class="comment">//Find the element dimension</span></div>
<div class="line"><a name="l03387"></a><span class="lineno"> 3387</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> el_dim = <a class="code" href="classoomph_1_1FiniteElement.html#a5f8fe59f06da1da9f6b7bbcbdb90ef93">dim</a>();</div>
<div class="line"><a name="l03388"></a><span class="lineno"> 3388</span>&#160;   <span class="comment">//Find the number of second derivatives required</span></div>
<div class="line"><a name="l03389"></a><span class="lineno"> 3389</span>&#160;   <span class="comment">//const unsigned n_deriv = N2deriv[el_dim];</span></div>
<div class="line"><a name="l03390"></a><span class="lineno"> 3390</span>&#160;   <span class="comment">//Get the values of the shape function and local derivatives for unknowns</span></div>
<div class="line"><a name="l03391"></a><span class="lineno"> 3391</span>&#160;   <a class="code" href="classoomph_1_1BellElementBase.html#ac6c1add4a996cf149da6c85ee3f4b637">d2basis_local</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,psi,dpsi,d2psi);</div>
<div class="line"><a name="l03392"></a><span class="lineno"> 3392</span>&#160;     </div>
<div class="line"><a name="l03393"></a><span class="lineno"> 3393</span>&#160;   <span class="comment">// assign shape functions for geometry</span></div>
<div class="line"><a name="l03394"></a><span class="lineno"> 3394</span>&#160;   <span class="keywordtype">unsigned</span> n_node = 3;</div>
<div class="line"><a name="l03395"></a><span class="lineno"> 3395</span>&#160;   <a class="code" href="classoomph_1_1Shape.html">Shape</a> psi_x(n_node);</div>
<div class="line"><a name="l03396"></a><span class="lineno"> 3396</span>&#160;   <a class="code" href="classoomph_1_1DShape.html">DShape</a> dpsi_x(n_node,2);</div>
<div class="line"><a name="l03397"></a><span class="lineno"> 3397</span>&#160;   <a class="code" href="classoomph_1_1DShape.html">DShape</a> d2psi_x(n_node,3);</div>
<div class="line"><a name="l03398"></a><span class="lineno"> 3398</span>&#160;   </div>
<div class="line"><a name="l03399"></a><span class="lineno"> 3399</span>&#160;   <a class="code" href="classoomph_1_1FiniteElement.html#a53e5051582d9da07b9d35da9debd0cd7">d2shape_local</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,psi_x,dpsi_x,d2psi_x);</div>
<div class="line"><a name="l03400"></a><span class="lineno"> 3400</span>&#160;   </div>
<div class="line"><a name="l03401"></a><span class="lineno"> 3401</span>&#160;   <span class="comment">//Allocate memory for the jacobian and inverse jacobian </span></div>
<div class="line"><a name="l03402"></a><span class="lineno"> 3402</span>&#160;   <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> jacobian(el_dim), inverse_jacobian(el_dim);</div>
<div class="line"><a name="l03403"></a><span class="lineno"> 3403</span>&#160;   </div>
<div class="line"><a name="l03404"></a><span class="lineno"> 3404</span>&#160;   <span class="comment">//Calculate the jacobian and inverse jacobian</span></div>
<div class="line"><a name="l03405"></a><span class="lineno"> 3405</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">double</span> det = <a class="code" href="classoomph_1_1BellElementBase.html#a17c3c26035cb8f8696073b97dabbe392">local_to_eulerian_mapping2</a>(dpsi_x,jacobian,inverse_jacobian);</div>
<div class="line"><a name="l03406"></a><span class="lineno"> 3406</span>&#160;   </div>
<div class="line"><a name="l03407"></a><span class="lineno"> 3407</span>&#160;   <span class="comment">//Return the determinant of the jacobian</span></div>
<div class="line"><a name="l03408"></a><span class="lineno"> 3408</span>&#160;   <span class="keywordflow">return</span> det;</div>
<div class="line"><a name="l03409"></a><span class="lineno"> 3409</span>&#160;  }</div>
<div class="line"><a name="l03410"></a><span class="lineno"> 3410</span>&#160;  </div>
<div class="line"><a name="l03411"></a><span class="lineno"> 3411</span>&#160;  <span class="comment">//=========================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l03412"></a><span class="lineno"> 3412</span>&#160;<span class="comment">  /// Calculate the c0-shape function and its first-order derivatives </span></div>
<div class="line"><a name="l03413"></a><span class="lineno"> 3413</span>&#160;<span class="comment">  /// w.r.t. local coordinates at the ipt-th integration point.</span></div>
<div class="line"><a name="l03414"></a><span class="lineno"> 3414</span>&#160;<span class="comment">  /// \n\n Numbering:</span></div>
<div class="line"><a name="l03415"></a><span class="lineno"> 3415</span>&#160;<span class="comment"></span>  <span class="comment">//=========================================================================</span></div>
<div class="line"><a name="l03416"></a><span class="lineno"> 3416</span>&#160; </div>
<div class="line"><a name="l03417"></a><span class="lineno"><a class="line" href="classoomph_1_1BellElementBase.html#ade54f5038bd917ff2a4c636e066db00e"> 3417</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1BellElementBase.html#ade54f5038bd917ff2a4c636e066db00e">dshape_and_dtest_eulerian_at_knot</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;ipt, <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;psi, <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;dpsi, <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;<a class="code" href="classoomph_1_1BellElementBase.html#a76ddb90394c979f9967e8fd068bdf220">test</a>, <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;dtest)<span class="keyword"></span></div>
<div class="line"><a name="l03418"></a><span class="lineno"> 3418</span>&#160;<span class="keyword">   const </span></div>
<div class="line"><a name="l03419"></a><span class="lineno"> 3419</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l03420"></a><span class="lineno"> 3420</span>&#160;    <span class="comment">//Find the element dimension</span></div>
<div class="line"><a name="l03421"></a><span class="lineno"> 3421</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> el_dim = <a class="code" href="classoomph_1_1FiniteElement.html#a5f8fe59f06da1da9f6b7bbcbdb90ef93">dim</a>();</div>
<div class="line"><a name="l03422"></a><span class="lineno"> 3422</span>&#160; </div>
<div class="line"><a name="l03423"></a><span class="lineno"> 3423</span>&#160;   <span class="comment">//Get the values of the c0-shape function for c0-unknowns</span></div>
<div class="line"><a name="l03424"></a><span class="lineno"> 3424</span>&#160;   <span class="comment">//and local derivatives </span></div>
<div class="line"><a name="l03425"></a><span class="lineno"> 3425</span>&#160;   <span class="comment">//Temporarily store it in dpsi</span></div>
<div class="line"><a name="l03426"></a><span class="lineno"> 3426</span>&#160;   <a class="code" href="classoomph_1_1BellElementBase.html#a1d20473bb357a28c9aeea91454b4c959">dbasis_c0_local_at_knot</a>(ipt,psi,dpsi);</div>
<div class="line"><a name="l03427"></a><span class="lineno"> 3427</span>&#160;   </div>
<div class="line"><a name="l03428"></a><span class="lineno"> 3428</span>&#160;   <span class="comment">// assign shape functions for geometry -&gt; linear Lagrange</span></div>
<div class="line"><a name="l03429"></a><span class="lineno"> 3429</span>&#160;   <span class="keywordtype">unsigned</span> n_node = 3;</div>
<div class="line"><a name="l03430"></a><span class="lineno"> 3430</span>&#160;   <a class="code" href="classoomph_1_1Shape.html">Shape</a> psi_x(n_node);</div>
<div class="line"><a name="l03431"></a><span class="lineno"> 3431</span>&#160;   <a class="code" href="classoomph_1_1DShape.html">DShape</a> dpsi_x(n_node,2);</div>
<div class="line"><a name="l03432"></a><span class="lineno"> 3432</span>&#160;   <a class="code" href="classoomph_1_1FiniteElement.html#a2214ae814100dcbb553ac97cf243dcfe">dshape_local_at_knot</a>(ipt,psi_x,dpsi_x);</div>
<div class="line"><a name="l03433"></a><span class="lineno"> 3433</span>&#160;   </div>
<div class="line"><a name="l03434"></a><span class="lineno"> 3434</span>&#160;   <span class="comment">// assign test function</span></div>
<div class="line"><a name="l03435"></a><span class="lineno"> 3435</span>&#160;   <a class="code" href="classoomph_1_1BellElementBase.html#a5ca86e4bbc0c1c0df2554e02669a0949">dtest_local_at_knot</a>(ipt,<a class="code" href="classoomph_1_1BellElementBase.html#a76ddb90394c979f9967e8fd068bdf220">test</a>,dtest);</div>
<div class="line"><a name="l03436"></a><span class="lineno"> 3436</span>&#160;   </div>
<div class="line"><a name="l03437"></a><span class="lineno"> 3437</span>&#160;   <span class="comment">//Allocate memory for the inverse jacobian</span></div>
<div class="line"><a name="l03438"></a><span class="lineno"> 3438</span>&#160;   <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> inverse_jacobian(el_dim);</div>
<div class="line"><a name="l03439"></a><span class="lineno"> 3439</span>&#160;   <span class="comment">//Now calculate the inverse jacobian</span></div>
<div class="line"><a name="l03440"></a><span class="lineno"> 3440</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">double</span> det = <a class="code" href="classoomph_1_1BellElementBase.html#a17c3c26035cb8f8696073b97dabbe392">local_to_eulerian_mapping2</a>(dpsi_x,inverse_jacobian);</div>
<div class="line"><a name="l03441"></a><span class="lineno"> 3441</span>&#160;   </div>
<div class="line"><a name="l03442"></a><span class="lineno"> 3442</span>&#160;   <span class="comment">//Now set the values of the derivatives to dpsidx</span></div>
<div class="line"><a name="l03443"></a><span class="lineno"> 3443</span>&#160;   <a class="code" href="classoomph_1_1FiniteElement.html#a2c2f243c9f450c4023e5aa4246facd20">transform_derivatives</a>(inverse_jacobian,dpsi);</div>
<div class="line"><a name="l03444"></a><span class="lineno"> 3444</span>&#160;   </div>
<div class="line"><a name="l03445"></a><span class="lineno"> 3445</span>&#160;   <span class="comment">//Return the determinant of the jacobian</span></div>
<div class="line"><a name="l03446"></a><span class="lineno"> 3446</span>&#160;   <span class="keywordflow">return</span> det;</div>
<div class="line"><a name="l03447"></a><span class="lineno"> 3447</span>&#160;  }</div>
<div class="line"><a name="l03448"></a><span class="lineno"> 3448</span>&#160; </div>
<div class="line"><a name="l03449"></a><span class="lineno"> 3449</span>&#160;  <span class="comment">//===========================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l03450"></a><span class="lineno"> 3450</span>&#160;<span class="comment">  /// \short Compute the c1-shape functions and also first and second </span></div>
<div class="line"><a name="l03451"></a><span class="lineno"> 3451</span>&#160;<span class="comment">  /// derivatives w.r.t. global coordinates at ipt-th integration points</span></div>
<div class="line"><a name="l03452"></a><span class="lineno"> 3452</span>&#160;<span class="comment">  /// Returns Jacobian of mapping from global to local coordinates.</span></div>
<div class="line"><a name="l03453"></a><span class="lineno"> 3453</span>&#160;<span class="comment"></span>  <span class="comment">//===========================================================================</span></div>
<div class="line"><a name="l03454"></a><span class="lineno"><a class="line" href="classoomph_1_1BellElementBase.html#a8bf466c908c0c3cf661229429961d5d0"> 3454</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1BellElementBase.html#a8bf466c908c0c3cf661229429961d5d0">d2shape_and_d2test_eulerian_at_knot</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;ipt, </div>
<div class="line"><a name="l03455"></a><span class="lineno"> 3455</span>&#160;                                                 <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;psi, </div>
<div class="line"><a name="l03456"></a><span class="lineno"> 3456</span>&#160;                                                 <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;dpsi, </div>
<div class="line"><a name="l03457"></a><span class="lineno"> 3457</span>&#160;                                                 <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;d2psi,</div>
<div class="line"><a name="l03458"></a><span class="lineno"> 3458</span>&#160;                                                 <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;<a class="code" href="classoomph_1_1BellElementBase.html#a76ddb90394c979f9967e8fd068bdf220">test</a>, </div>
<div class="line"><a name="l03459"></a><span class="lineno"> 3459</span>&#160;                                                 <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;dtest, </div>
<div class="line"><a name="l03460"></a><span class="lineno"> 3460</span>&#160;                                                 <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;d2test)<span class="keyword"> const</span></div>
<div class="line"><a name="l03461"></a><span class="lineno"> 3461</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l03462"></a><span class="lineno"> 3462</span>&#160;   <span class="comment">//Find the element dimension</span></div>
<div class="line"><a name="l03463"></a><span class="lineno"> 3463</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> el_dim = <a class="code" href="classoomph_1_1FiniteElement.html#a5f8fe59f06da1da9f6b7bbcbdb90ef93">dim</a>();</div>
<div class="line"><a name="l03464"></a><span class="lineno"> 3464</span>&#160;   </div>
<div class="line"><a name="l03465"></a><span class="lineno"> 3465</span>&#160;   <span class="comment">//Get the values of the shape function and local derivatives for unknowns</span></div>
<div class="line"><a name="l03466"></a><span class="lineno"> 3466</span>&#160;   <a class="code" href="classoomph_1_1BellElementBase.html#ae5a43211398722298cf88ded87dee6ab">d2basis_local_at_knot</a>(ipt,psi,dpsi,d2psi);</div>
<div class="line"><a name="l03467"></a><span class="lineno"> 3467</span>&#160;   </div>
<div class="line"><a name="l03468"></a><span class="lineno"> 3468</span>&#160;   <span class="comment">// assign shape functions for geometry</span></div>
<div class="line"><a name="l03469"></a><span class="lineno"> 3469</span>&#160;   <span class="keywordtype">unsigned</span> n_node = <a class="code" href="classoomph_1_1FiniteElement.html#a6219ed269a6d89b5aa14659cce48905a">nnode</a>();</div>
<div class="line"><a name="l03470"></a><span class="lineno"> 3470</span>&#160;   <a class="code" href="classoomph_1_1Shape.html">Shape</a> psi_x(n_node);</div>
<div class="line"><a name="l03471"></a><span class="lineno"> 3471</span>&#160;   <a class="code" href="classoomph_1_1DShape.html">DShape</a> dpsi_x(n_node,2);</div>
<div class="line"><a name="l03472"></a><span class="lineno"> 3472</span>&#160;   <a class="code" href="classoomph_1_1DShape.html">DShape</a> d2psi_x(n_node,3);</div>
<div class="line"><a name="l03473"></a><span class="lineno"> 3473</span>&#160;   <a class="code" href="classoomph_1_1FiniteElement.html#a2214ae814100dcbb553ac97cf243dcfe">dshape_local_at_knot</a>(ipt,psi_x,dpsi_x);</div>
<div class="line"><a name="l03474"></a><span class="lineno"> 3474</span>&#160; </div>
<div class="line"><a name="l03475"></a><span class="lineno"> 3475</span>&#160;   <span class="comment">// assign for test function</span></div>
<div class="line"><a name="l03476"></a><span class="lineno"> 3476</span>&#160;   <a class="code" href="classoomph_1_1BellElementBase.html#acad63d477784e6b88b92804b0f1b375e">d2test_local_at_knot</a>(ipt,<a class="code" href="classoomph_1_1BellElementBase.html#a76ddb90394c979f9967e8fd068bdf220">test</a>,dtest,d2test);</div>
<div class="line"><a name="l03477"></a><span class="lineno"> 3477</span>&#160;   </div>
<div class="line"><a name="l03478"></a><span class="lineno"> 3478</span>&#160;   <span class="comment">//Allocate memory for the jacobian and inverse jacobian </span></div>
<div class="line"><a name="l03479"></a><span class="lineno"> 3479</span>&#160;   <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> jacobian(el_dim), inverse_jacobian(el_dim);</div>
<div class="line"><a name="l03480"></a><span class="lineno"> 3480</span>&#160; </div>
<div class="line"><a name="l03481"></a><span class="lineno"> 3481</span>&#160;   <span class="comment">//Calculate the jacobian and inverse jacobian</span></div>
<div class="line"><a name="l03482"></a><span class="lineno"> 3482</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">double</span> det = <a class="code" href="classoomph_1_1BellElementBase.html#a17c3c26035cb8f8696073b97dabbe392">local_to_eulerian_mapping2</a>(dpsi_x,jacobian,inverse_jacobian);</div>
<div class="line"><a name="l03483"></a><span class="lineno"> 3483</span>&#160; </div>
<div class="line"><a name="l03484"></a><span class="lineno"> 3484</span>&#160;   <span class="comment">//Return the determinant of the mapping</span></div>
<div class="line"><a name="l03485"></a><span class="lineno"> 3485</span>&#160;   <span class="keywordflow">return</span> det;</div>
<div class="line"><a name="l03486"></a><span class="lineno"> 3486</span>&#160;  }</div>
<div class="line"><a name="l03487"></a><span class="lineno"> 3487</span>&#160; </div>
<div class="line"><a name="l03488"></a><span class="lineno"> 3488</span>&#160;  <span class="comment">//===========================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l03489"></a><span class="lineno"> 3489</span>&#160;<span class="comment">  /// \short Calculate the mapping from local to Eulerian coordinates,</span></div>
<div class="line"><a name="l03490"></a><span class="lineno"> 3490</span>&#160;<span class="comment">  /// given the derivatives of the shape functions w.r.t. local coordinates,</span></div>
<div class="line"><a name="l03491"></a><span class="lineno"> 3491</span>&#160;<span class="comment">  /// Return only the determinant of the jacobian and the inverse of the</span></div>
<div class="line"><a name="l03492"></a><span class="lineno"> 3492</span>&#160;<span class="comment">  /// mapping (ds/dx).</span></div>
<div class="line"><a name="l03493"></a><span class="lineno"> 3493</span>&#160;<span class="comment"></span>  <span class="comment">//===========================================================================</span></div>
<div class="line"><a name="l03494"></a><span class="lineno"><a class="line" href="classoomph_1_1BellElementBase.html#a17c3c26035cb8f8696073b97dabbe392"> 3494</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1BellElementBase.html#a17c3c26035cb8f8696073b97dabbe392">local_to_eulerian_mapping2</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;dpsids,</div>
<div class="line"><a name="l03495"></a><span class="lineno"> 3495</span>&#160;                                   <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> &amp;inverse_jacobian)<span class="keyword"> const</span></div>
<div class="line"><a name="l03496"></a><span class="lineno"> 3496</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l03497"></a><span class="lineno"> 3497</span>&#160;   <span class="comment">//Find the dimension of the element</span></div>
<div class="line"><a name="l03498"></a><span class="lineno"> 3498</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> el_dim = <a class="code" href="classoomph_1_1FiniteElement.html#a5f8fe59f06da1da9f6b7bbcbdb90ef93">dim</a>();</div>
<div class="line"><a name="l03499"></a><span class="lineno"> 3499</span>&#160;   <span class="comment">//Assign memory for the jacobian</span></div>
<div class="line"><a name="l03500"></a><span class="lineno"> 3500</span>&#160;   <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> jacobian(el_dim);</div>
<div class="line"><a name="l03501"></a><span class="lineno"> 3501</span>&#160;   <span class="comment">//Calculate the jacobian and inverse</span></div>
<div class="line"><a name="l03502"></a><span class="lineno"> 3502</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="classoomph_1_1BellElementBase.html#a17c3c26035cb8f8696073b97dabbe392">local_to_eulerian_mapping2</a>(dpsids,jacobian,inverse_jacobian);</div>
<div class="line"><a name="l03503"></a><span class="lineno"> 3503</span>&#160;  }</div>
<div class="line"><a name="l03504"></a><span class="lineno"> 3504</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l03505"></a><span class="lineno"> 3505</span>&#160;<span class="comment"> ///////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l03506"></a><span class="lineno"><a class="line" href="classoomph_1_1BellElementBase.html#a20792e4f9ae0fcfadc406c4fca5ca0f6"> 3506</a></span>&#160;<span class="comment"></span> <span class="keyword">virtual</span> <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1BellElementBase.html#a20792e4f9ae0fcfadc406c4fca5ca0f6">local_to_eulerian_mapping2</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;dpsids,</div>
<div class="line"><a name="l03507"></a><span class="lineno"> 3507</span>&#160;                                           <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> &amp;jacobian,</div>
<div class="line"><a name="l03508"></a><span class="lineno"> 3508</span>&#160;                                           <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> &amp;inverse_jacobian)<span class="keyword"> const</span></div>
<div class="line"><a name="l03509"></a><span class="lineno"> 3509</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l03510"></a><span class="lineno"> 3510</span>&#160;    <span class="comment">//Assemble the jacobian</span></div>
<div class="line"><a name="l03511"></a><span class="lineno"> 3511</span>&#160;    <span class="comment">//Locally cache the elemental dimension</span></div>
<div class="line"><a name="l03512"></a><span class="lineno"> 3512</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> el_dim = <a class="code" href="classoomph_1_1FiniteElement.html#a5f8fe59f06da1da9f6b7bbcbdb90ef93">dim</a>();</div>
<div class="line"><a name="l03513"></a><span class="lineno"> 3513</span>&#160;   <span class="comment">//The number of shape functions must be equal to the number</span></div>
<div class="line"><a name="l03514"></a><span class="lineno"> 3514</span>&#160;   <span class="comment">//of nodes (by definition)</span></div>
<div class="line"><a name="l03515"></a><span class="lineno"> 3515</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_shape = 3;</div>
<div class="line"><a name="l03516"></a><span class="lineno"> 3516</span>&#160;   <span class="comment">//The number of shape function types must be equal to the number</span></div>
<div class="line"><a name="l03517"></a><span class="lineno"> 3517</span>&#160;   <span class="comment">//of nodal position types (by definition)</span></div>
<div class="line"><a name="l03518"></a><span class="lineno"> 3518</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_shape_type = 1;</div>
<div class="line"><a name="l03519"></a><span class="lineno"> 3519</span>&#160;  </div>
<div class="line"><a name="l03520"></a><span class="lineno"> 3520</span>&#160;   <span class="comment">//Loop over the rows of the jacobian</span></div>
<div class="line"><a name="l03521"></a><span class="lineno"> 3521</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;el_dim;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l03522"></a><span class="lineno"> 3522</span>&#160;    {</div>
<div class="line"><a name="l03523"></a><span class="lineno"> 3523</span>&#160;     <span class="comment">//Loop over the columns of the jacobian</span></div>
<div class="line"><a name="l03524"></a><span class="lineno"> 3524</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> j=0;j&lt;el_dim;j++)</div>
<div class="line"><a name="l03525"></a><span class="lineno"> 3525</span>&#160;      {</div>
<div class="line"><a name="l03526"></a><span class="lineno"> 3526</span>&#160;       <span class="comment">//Zero the entry</span></div>
<div class="line"><a name="l03527"></a><span class="lineno"> 3527</span>&#160;       jacobian(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>,j) = 0.0;</div>
<div class="line"><a name="l03528"></a><span class="lineno"> 3528</span>&#160;       <span class="comment">//Loop over the shape functions</span></div>
<div class="line"><a name="l03529"></a><span class="lineno"> 3529</span>&#160;       <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l=0;l&lt;n_shape;l++)</div>
<div class="line"><a name="l03530"></a><span class="lineno"> 3530</span>&#160;        {</div>
<div class="line"><a name="l03531"></a><span class="lineno"> 3531</span>&#160;         <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> k=0;k&lt;n_shape_type;k++)</div>
<div class="line"><a name="l03532"></a><span class="lineno"> 3532</span>&#160;          {</div>
<div class="line"><a name="l03533"></a><span class="lineno"> 3533</span>&#160;           <span class="comment">//Jacobian is dx_j/ds_i, which is represented by the sum</span></div>
<div class="line"><a name="l03534"></a><span class="lineno"> 3534</span>&#160;           <span class="comment">//over the dpsi/ds_i of the nodal points X j</span></div>
<div class="line"><a name="l03535"></a><span class="lineno"> 3535</span>&#160;           <span class="comment">//Call the Non-hanging version of positions</span></div>
<div class="line"><a name="l03536"></a><span class="lineno"> 3536</span>&#160;           <span class="comment">//This is overloaded in refineable elements</span></div>
<div class="line"><a name="l03537"></a><span class="lineno"> 3537</span>&#160;           jacobian(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>,j) += <a class="code" href="classoomph_1_1FiniteElement.html#add91f6d02c8819cf778bc76afb4f03d1">raw_nodal_position_gen</a>(l,k,j)*dpsids(l,k,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>);</div>
<div class="line"><a name="l03538"></a><span class="lineno"> 3538</span>&#160;          }</div>
<div class="line"><a name="l03539"></a><span class="lineno"> 3539</span>&#160;        }</div>
<div class="line"><a name="l03540"></a><span class="lineno"> 3540</span>&#160;      }</div>
<div class="line"><a name="l03541"></a><span class="lineno"> 3541</span>&#160;    }</div>
<div class="line"><a name="l03542"></a><span class="lineno"> 3542</span>&#160;  </div>
<div class="line"><a name="l03543"></a><span class="lineno"> 3543</span>&#160;   <span class="comment">//Invert the jacobian (use the template-free interface)</span></div>
<div class="line"><a name="l03544"></a><span class="lineno"> 3544</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="classoomph_1_1FiniteElement.html#a42c86a7628fee00d3a9d35b935b29e48">invert_jacobian_mapping</a>(jacobian,inverse_jacobian);</div>
<div class="line"><a name="l03545"></a><span class="lineno"> 3545</span>&#160;  }</div>
<div class="line"><a name="l03546"></a><span class="lineno"> 3546</span>&#160; </div>
<div class="line"><a name="l03547"></a><span class="lineno"> 3547</span>&#160; <span class="comment">//========================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l03548"></a><span class="lineno"> 3548</span>&#160;<span class="comment"> /// \short Calculate the Jacobian of the mapping between local and global</span></div>
<div class="line"><a name="l03549"></a><span class="lineno"> 3549</span>&#160;<span class="comment"> /// coordinates at the position s</span></div>
<div class="line"><a name="l03550"></a><span class="lineno"> 3550</span>&#160;<span class="comment"></span> <span class="comment">//========================================================================</span></div>
<div class="line"><a name="l03551"></a><span class="lineno"><a class="line" href="classoomph_1_1BellElementBase.html#ae19c2d108290a6d46d6453ea324820f6"> 3551</a></span>&#160; <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1BellElementBase.html#ae19c2d108290a6d46d6453ea324820f6">J_eulerian1</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>)<span class="keyword"> const</span></div>
<div class="line"><a name="l03552"></a><span class="lineno"> 3552</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l03553"></a><span class="lineno"> 3553</span>&#160;   <span class="comment">//Find the number of nodes and position types</span></div>
<div class="line"><a name="l03554"></a><span class="lineno"> 3554</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_node = 3;</div>
<div class="line"><a name="l03555"></a><span class="lineno"> 3555</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_position_type = 1;</div>
<div class="line"><a name="l03556"></a><span class="lineno"> 3556</span>&#160;   <span class="comment">//Find the dimension of the node and element</span></div>
<div class="line"><a name="l03557"></a><span class="lineno"> 3557</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_dim_node = <a class="code" href="classoomph_1_1FiniteElement.html#ab6602b43c3a2f1a5e48729b0b23c0d91">nodal_dimension</a>();</div>
<div class="line"><a name="l03558"></a><span class="lineno"> 3558</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_dim_element = <a class="code" href="classoomph_1_1FiniteElement.html#a5f8fe59f06da1da9f6b7bbcbdb90ef93">dim</a>();</div>
<div class="line"><a name="l03559"></a><span class="lineno"> 3559</span>&#160;   </div>
<div class="line"><a name="l03560"></a><span class="lineno"> 3560</span>&#160;   </div>
<div class="line"><a name="l03561"></a><span class="lineno"> 3561</span>&#160;   <span class="comment">//Set up dummy memory for the shape functions</span></div>
<div class="line"><a name="l03562"></a><span class="lineno"> 3562</span>&#160;   <a class="code" href="classoomph_1_1Shape.html">Shape</a> psi(n_node,n_position_type);</div>
<div class="line"><a name="l03563"></a><span class="lineno"> 3563</span>&#160;   <a class="code" href="classoomph_1_1DShape.html">DShape</a> dpsids(n_node,n_position_type,n_dim_element);</div>
<div class="line"><a name="l03564"></a><span class="lineno"> 3564</span>&#160;   <span class="comment">//Get the shape functions and local derivatives</span></div>
<div class="line"><a name="l03565"></a><span class="lineno"> 3565</span>&#160;   this-&gt;<a class="code" href="classoomph_1_1FiniteElement.html#a9db1456b827131c21a991ac9fedf4b0c">dshape_local</a>(s,psi,dpsids);</div>
<div class="line"><a name="l03566"></a><span class="lineno"> 3566</span>&#160;   </div>
<div class="line"><a name="l03567"></a><span class="lineno"> 3567</span>&#160;   <span class="comment">//Right calculate the base vectors</span></div>
<div class="line"><a name="l03568"></a><span class="lineno"> 3568</span>&#160;   <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> interpolated_G(n_dim_element,n_dim_node);</div>
<div class="line"><a name="l03569"></a><span class="lineno"> 3569</span>&#160;   </div>
<div class="line"><a name="l03570"></a><span class="lineno"> 3570</span>&#160;   <span class="comment">//Loop over the dimensions and compute the entries of the </span></div>
<div class="line"><a name="l03571"></a><span class="lineno"> 3571</span>&#160;   <span class="comment">//base vector matrix</span></div>
<div class="line"><a name="l03572"></a><span class="lineno"> 3572</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;n_dim_element;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l03573"></a><span class="lineno"> 3573</span>&#160;    {</div>
<div class="line"><a name="l03574"></a><span class="lineno"> 3574</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> j=0;j&lt;n_dim_node;j++)</div>
<div class="line"><a name="l03575"></a><span class="lineno"> 3575</span>&#160;      {</div>
<div class="line"><a name="l03576"></a><span class="lineno"> 3576</span>&#160;       <span class="comment">//Initialise the j-th component of the i-th base vector to zero</span></div>
<div class="line"><a name="l03577"></a><span class="lineno"> 3577</span>&#160;       interpolated_G(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>,j) = 0.0;</div>
<div class="line"><a name="l03578"></a><span class="lineno"> 3578</span>&#160;       <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l=0;l&lt;n_node;l++)</div>
<div class="line"><a name="l03579"></a><span class="lineno"> 3579</span>&#160;        {</div>
<div class="line"><a name="l03580"></a><span class="lineno"> 3580</span>&#160;         <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> k=0;k&lt;n_position_type;k++)</div>
<div class="line"><a name="l03581"></a><span class="lineno"> 3581</span>&#160;          {</div>
<div class="line"><a name="l03582"></a><span class="lineno"> 3582</span>&#160;           interpolated_G(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>,j) += <a class="code" href="classoomph_1_1FiniteElement.html#add91f6d02c8819cf778bc76afb4f03d1">raw_nodal_position_gen</a>(l,k,j)*dpsids(l,k,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>);</div>
<div class="line"><a name="l03583"></a><span class="lineno"> 3583</span>&#160;          }</div>
<div class="line"><a name="l03584"></a><span class="lineno"> 3584</span>&#160;        }</div>
<div class="line"><a name="l03585"></a><span class="lineno"> 3585</span>&#160;      }</div>
<div class="line"><a name="l03586"></a><span class="lineno"> 3586</span>&#160;    }</div>
<div class="line"><a name="l03587"></a><span class="lineno"> 3587</span>&#160; </div>
<div class="line"><a name="l03588"></a><span class="lineno"> 3588</span>&#160;   <span class="comment">//Calculate the metric tensor of the element</span></div>
<div class="line"><a name="l03589"></a><span class="lineno"> 3589</span>&#160;   <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> G(n_dim_element);</div>
<div class="line"><a name="l03590"></a><span class="lineno"> 3590</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;n_dim_element;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l03591"></a><span class="lineno"> 3591</span>&#160;    {</div>
<div class="line"><a name="l03592"></a><span class="lineno"> 3592</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> j=0;j&lt;n_dim_element;j++)</div>
<div class="line"><a name="l03593"></a><span class="lineno"> 3593</span>&#160;      {</div>
<div class="line"><a name="l03594"></a><span class="lineno"> 3594</span>&#160;       <span class="comment">//Initialise to zero</span></div>
<div class="line"><a name="l03595"></a><span class="lineno"> 3595</span>&#160;       G(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>,j) = 0.0;</div>
<div class="line"><a name="l03596"></a><span class="lineno"> 3596</span>&#160;       <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> k=0;k&lt;n_dim_node;k++) </div>
<div class="line"><a name="l03597"></a><span class="lineno"> 3597</span>&#160;        {</div>
<div class="line"><a name="l03598"></a><span class="lineno"> 3598</span>&#160;         G(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>,j) += interpolated_G(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>,k)*interpolated_G(j,k);</div>
<div class="line"><a name="l03599"></a><span class="lineno"> 3599</span>&#160;        }</div>
<div class="line"><a name="l03600"></a><span class="lineno"> 3600</span>&#160;      }</div>
<div class="line"><a name="l03601"></a><span class="lineno"> 3601</span>&#160;    }</div>
<div class="line"><a name="l03602"></a><span class="lineno"> 3602</span>&#160;   </div>
<div class="line"><a name="l03603"></a><span class="lineno"> 3603</span>&#160;   <span class="comment">//Calculate the determinant of the metric tensor</span></div>
<div class="line"><a name="l03604"></a><span class="lineno"> 3604</span>&#160;   <span class="keywordtype">double</span> det = 0.0;</div>
<div class="line"><a name="l03605"></a><span class="lineno"> 3605</span>&#160;   <span class="keywordflow">switch</span>(n_dim_element)</div>
<div class="line"><a name="l03606"></a><span class="lineno"> 3606</span>&#160;    {</div>
<div class="line"><a name="l03607"></a><span class="lineno"> 3607</span>&#160;    <span class="keywordflow">case</span> 0:</div>
<div class="line"><a name="l03608"></a><span class="lineno"> 3608</span>&#160;     <span class="keywordflow">throw</span> <a class="code" href="classoomph_1_1OomphLibError.html">OomphLibError</a>(<span class="stringliteral">&quot;Cannot calculate J_eulerian() for point element\n&quot;</span>,</div>
<div class="line"><a name="l03609"></a><span class="lineno"> 3609</span>&#160;                         <span class="stringliteral">&quot;FiniteElement::J_eulerian()&quot;</span>,</div>
<div class="line"><a name="l03610"></a><span class="lineno"> 3610</span>&#160;                         OOMPH_EXCEPTION_LOCATION);</div>
<div class="line"><a name="l03611"></a><span class="lineno"> 3611</span>&#160;     <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03612"></a><span class="lineno"> 3612</span>&#160;    <span class="keywordflow">case</span> 1:</div>
<div class="line"><a name="l03613"></a><span class="lineno"> 3613</span>&#160;     det = G(0,0);</div>
<div class="line"><a name="l03614"></a><span class="lineno"> 3614</span>&#160;     <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03615"></a><span class="lineno"> 3615</span>&#160;    <span class="keywordflow">case</span> 2:</div>
<div class="line"><a name="l03616"></a><span class="lineno"> 3616</span>&#160;     det = G(0,0)*G(1,1) - G(0,1)*G(1,0);</div>
<div class="line"><a name="l03617"></a><span class="lineno"> 3617</span>&#160;     <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03618"></a><span class="lineno"> 3618</span>&#160;    <span class="keywordflow">case</span> 3:</div>
<div class="line"><a name="l03619"></a><span class="lineno"> 3619</span>&#160;     det = G(0,0)*G(1,1)*G(2,2) + G(0,1)*G(1,2)*G(2,0) + G(0,2)*G(1,0)*G(2,1)</div>
<div class="line"><a name="l03620"></a><span class="lineno"> 3620</span>&#160;      - G(0,0)*G(1,2)*G(2,1) - G(0,1)*G(1,0)*G(2,2) - G(0,2)*G(1,1)*G(2,0);</div>
<div class="line"><a name="l03621"></a><span class="lineno"> 3621</span>&#160;     <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03622"></a><span class="lineno"> 3622</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l03623"></a><span class="lineno"> 3623</span>&#160;     <a class="code" href="namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;More than 3 dimensions in J_eulerian()&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l03624"></a><span class="lineno"> 3624</span>&#160;     <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03625"></a><span class="lineno"> 3625</span>&#160;    }</div>
<div class="line"><a name="l03626"></a><span class="lineno"> 3626</span>&#160;   </div>
<div class="line"><a name="l03627"></a><span class="lineno"> 3627</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l03628"></a><span class="lineno"> 3628</span>&#160;   <a class="code" href="classoomph_1_1FiniteElement.html#a524acd2f6d25d55806b7050032ee6330">check_jacobian</a>(det);</div>
<div class="line"><a name="l03629"></a><span class="lineno"> 3629</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03630"></a><span class="lineno"> 3630</span>&#160;   </div>
<div class="line"><a name="l03631"></a><span class="lineno"> 3631</span>&#160;   <span class="comment">//Return the Jacobian (square-root of the determinant of the metric tensor)</span></div>
<div class="line"><a name="l03632"></a><span class="lineno"> 3632</span>&#160;   <span class="keywordflow">return</span> sqrt(det);</div>
<div class="line"><a name="l03633"></a><span class="lineno"> 3633</span>&#160;   </div>
<div class="line"><a name="l03634"></a><span class="lineno"> 3634</span>&#160;  }</div>
<div class="line"><a name="l03635"></a><span class="lineno"> 3635</span>&#160; </div>
<div class="line"><a name="l03636"></a><span class="lineno"> 3636</span>&#160; <span class="comment">//=========================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l03637"></a><span class="lineno"> 3637</span>&#160;<span class="comment"> /// Internal function that is used to assemble the jacobian of second</span></div>
<div class="line"><a name="l03638"></a><span class="lineno"> 3638</span>&#160;<span class="comment"> /// derivatives of the the mapping from local coordinates (s) to the </span></div>
<div class="line"><a name="l03639"></a><span class="lineno"> 3639</span>&#160;<span class="comment"> /// eulerian coordinates (x), given the second derivatives of the </span></div>
<div class="line"><a name="l03640"></a><span class="lineno"> 3640</span>&#160;<span class="comment"> /// shape functions. </span></div>
<div class="line"><a name="l03641"></a><span class="lineno"> 3641</span>&#160;<span class="comment"></span> <span class="comment">//=========================================================================</span></div>
<div class="line"><a name="l03642"></a><span class="lineno"><a class="line" href="classoomph_1_1BellElementBase.html#abd5f258248221f2f564c87ced9e0a83e"> 3642</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1BellElementBase.html#abd5f258248221f2f564c87ced9e0a83e">myassemble_local_to_eulerian_jacobian2</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;d2psids,</div>
<div class="line"><a name="l03643"></a><span class="lineno"> 3643</span>&#160;                                       <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> &amp;jacobian2)<span class="keyword"> const</span></div>
<div class="line"><a name="l03644"></a><span class="lineno"> 3644</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l03645"></a><span class="lineno"> 3645</span>&#160;   <span class="comment">//Find the the dimension of the element</span></div>
<div class="line"><a name="l03646"></a><span class="lineno"> 3646</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> el_dim = <a class="code" href="classoomph_1_1FiniteElement.html#a5f8fe59f06da1da9f6b7bbcbdb90ef93">dim</a>();</div>
<div class="line"><a name="l03647"></a><span class="lineno"> 3647</span>&#160;   <span class="comment">//Find the number of shape functions and shape functions types</span></div>
<div class="line"><a name="l03648"></a><span class="lineno"> 3648</span>&#160;   <span class="comment">//Must be equal to the number of nodes and their position types</span></div>
<div class="line"><a name="l03649"></a><span class="lineno"> 3649</span>&#160;   <span class="comment">//by the definition of the shape function.</span></div>
<div class="line"><a name="l03650"></a><span class="lineno"> 3650</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_shape = 3;</div>
<div class="line"><a name="l03651"></a><span class="lineno"> 3651</span>&#160;   <span class="keywordtype">unsigned</span> n_shape_type = 1;</div>
<div class="line"><a name="l03652"></a><span class="lineno"> 3652</span>&#160;   <span class="comment">//Find the number of second derivatives</span></div>
<div class="line"><a name="l03653"></a><span class="lineno"> 3653</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_row = <a class="code" href="classoomph_1_1FiniteElement.html#ad1600b17efbe61db27a4c622af1f28cf">N2deriv</a>[el_dim];</div>
<div class="line"><a name="l03654"></a><span class="lineno"> 3654</span>&#160;   <span class="comment">//Assemble the &quot;jacobian&quot; (d^2 x_j/ds_i^2) for second derivatives of </span></div>
<div class="line"><a name="l03655"></a><span class="lineno"> 3655</span>&#160;   <span class="comment">//shape functions</span></div>
<div class="line"><a name="l03656"></a><span class="lineno"> 3656</span>&#160;   <span class="comment">//Loop over the rows (number of second derivatives)</span></div>
<div class="line"><a name="l03657"></a><span class="lineno"> 3657</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;n_row;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l03658"></a><span class="lineno"> 3658</span>&#160;    {</div>
<div class="line"><a name="l03659"></a><span class="lineno"> 3659</span>&#160;     <span class="comment">//Loop over the columns (element dimension</span></div>
<div class="line"><a name="l03660"></a><span class="lineno"> 3660</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> j=0;j&lt;el_dim;j++)</div>
<div class="line"><a name="l03661"></a><span class="lineno"> 3661</span>&#160;      {</div>
<div class="line"><a name="l03662"></a><span class="lineno"> 3662</span>&#160;       <span class="comment">//Zero the entry</span></div>
<div class="line"><a name="l03663"></a><span class="lineno"> 3663</span>&#160;       jacobian2(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>,j) = 0.0;</div>
<div class="line"><a name="l03664"></a><span class="lineno"> 3664</span>&#160;       <span class="comment">//Loop over the shape functions</span></div>
<div class="line"><a name="l03665"></a><span class="lineno"> 3665</span>&#160;       <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l=0;l&lt;n_shape;l++)</div>
<div class="line"><a name="l03666"></a><span class="lineno"> 3666</span>&#160;        {</div>
<div class="line"><a name="l03667"></a><span class="lineno"> 3667</span>&#160;         <span class="comment">//Loop over the shape function types</span></div>
<div class="line"><a name="l03668"></a><span class="lineno"> 3668</span>&#160;         <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> k=0;k&lt;n_shape_type;k++)</div>
<div class="line"><a name="l03669"></a><span class="lineno"> 3669</span>&#160;          {</div>
<div class="line"><a name="l03670"></a><span class="lineno"> 3670</span>&#160;           <span class="comment">//Add the terms to the jacobian entry</span></div>
<div class="line"><a name="l03671"></a><span class="lineno"> 3671</span>&#160;           <span class="comment">//Call the Non-hanging version of positions</span></div>
<div class="line"><a name="l03672"></a><span class="lineno"> 3672</span>&#160;           <span class="comment">//This is overloaded in refineable elements</span></div>
<div class="line"><a name="l03673"></a><span class="lineno"> 3673</span>&#160;           jacobian2(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>,j) += <a class="code" href="classoomph_1_1FiniteElement.html#add91f6d02c8819cf778bc76afb4f03d1">raw_nodal_position_gen</a>(l,k,j)*d2psids(l,k,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>);</div>
<div class="line"><a name="l03674"></a><span class="lineno"> 3674</span>&#160;          }</div>
<div class="line"><a name="l03675"></a><span class="lineno"> 3675</span>&#160;        }</div>
<div class="line"><a name="l03676"></a><span class="lineno"> 3676</span>&#160;      }</div>
<div class="line"><a name="l03677"></a><span class="lineno"> 3677</span>&#160;    }</div>
<div class="line"><a name="l03678"></a><span class="lineno"> 3678</span>&#160;  }</div>
<div class="line"><a name="l03679"></a><span class="lineno"> 3679</span>&#160; </div>
<div class="line"><a name="l03680"></a><span class="lineno"> 3680</span>&#160; <span class="comment">//=======================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l03681"></a><span class="lineno"> 3681</span>&#160;<span class="comment"> /// Return FE interpolated position x[] at local coordinate s as Vector</span></div>
<div class="line"><a name="l03682"></a><span class="lineno"> 3682</span>&#160;<span class="comment"></span> <span class="comment">// (using linear Lagrange interpolation)</span></div>
<div class="line"><a name="l03683"></a><span class="lineno"> 3683</span>&#160; <span class="comment">//=======================================================================</span></div>
<div class="line"><a name="l03684"></a><span class="lineno"><a class="line" href="classoomph_1_1BellElementBase.html#a4dfe41d9fa313dcc843d17144c553190"> 3684</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1BellElementBase.html#a4dfe41d9fa313dcc843d17144c553190">my_interpolated_x</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>, <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;x)<span class="keyword"></span></div>
<div class="line"><a name="l03685"></a><span class="lineno"> 3685</span>&#160;<span class="keyword">   const</span></div>
<div class="line"><a name="l03686"></a><span class="lineno"> 3686</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l03687"></a><span class="lineno"> 3687</span>&#160;   <span class="comment">//Find the number of nodes</span></div>
<div class="line"><a name="l03688"></a><span class="lineno"> 3688</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_node = 3;</div>
<div class="line"><a name="l03689"></a><span class="lineno"> 3689</span>&#160;   <span class="comment">//Find the number of positional types</span></div>
<div class="line"><a name="l03690"></a><span class="lineno"> 3690</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_position_type = 1;</div>
<div class="line"><a name="l03691"></a><span class="lineno"> 3691</span>&#160;   </div>
<div class="line"><a name="l03692"></a><span class="lineno"> 3692</span>&#160;   <span class="comment">//Find the dimension stored in the node</span></div>
<div class="line"><a name="l03693"></a><span class="lineno"> 3693</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> nodal_dim = <a class="code" href="classoomph_1_1FiniteElement.html#ab6602b43c3a2f1a5e48729b0b23c0d91">nodal_dimension</a>();</div>
<div class="line"><a name="l03694"></a><span class="lineno"> 3694</span>&#160;   </div>
<div class="line"><a name="l03695"></a><span class="lineno"> 3695</span>&#160;   <span class="comment">//Assign storage for the local shape function</span></div>
<div class="line"><a name="l03696"></a><span class="lineno"> 3696</span>&#160;   <a class="code" href="classoomph_1_1Shape.html">Shape</a> psi(n_node);</div>
<div class="line"><a name="l03697"></a><span class="lineno"> 3697</span>&#160;   <span class="comment">//Find the values of shape function</span></div>
<div class="line"><a name="l03698"></a><span class="lineno"> 3698</span>&#160;   <a class="code" href="classoomph_1_1FiniteElement.html#a58a25b6859ddd43b7bfe64a19fee5023">shape</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,psi);</div>
<div class="line"><a name="l03699"></a><span class="lineno"> 3699</span>&#160;   </div>
<div class="line"><a name="l03700"></a><span class="lineno"> 3700</span>&#160;   <span class="comment">//Loop over the dimensions</span></div>
<div class="line"><a name="l03701"></a><span class="lineno"> 3701</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;nodal_dim;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l03702"></a><span class="lineno"> 3702</span>&#160;    {</div>
<div class="line"><a name="l03703"></a><span class="lineno"> 3703</span>&#160;     <span class="comment">//Initilialise value of x[i] to zero</span></div>
<div class="line"><a name="l03704"></a><span class="lineno"> 3704</span>&#160;     x[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] = 0.0;</div>
<div class="line"><a name="l03705"></a><span class="lineno"> 3705</span>&#160;     <span class="comment">//Loop over the local nodes</span></div>
<div class="line"><a name="l03706"></a><span class="lineno"> 3706</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l=0;l&lt;n_node;l++) </div>
<div class="line"><a name="l03707"></a><span class="lineno"> 3707</span>&#160;      {</div>
<div class="line"><a name="l03708"></a><span class="lineno"> 3708</span>&#160;       <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> k=0;k&lt;n_position_type;k++)</div>
<div class="line"><a name="l03709"></a><span class="lineno"> 3709</span>&#160;        {</div>
<div class="line"><a name="l03710"></a><span class="lineno"> 3710</span>&#160;         x[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] += <a class="code" href="classoomph_1_1FiniteElement.html#a61c5f4b9a62607313692d713bf95edc5">nodal_position_gen</a>(l,k,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>)*psi[l];</div>
<div class="line"><a name="l03711"></a><span class="lineno"> 3711</span>&#160;        }</div>
<div class="line"><a name="l03712"></a><span class="lineno"> 3712</span>&#160;      }</div>
<div class="line"><a name="l03713"></a><span class="lineno"> 3713</span>&#160;    }</div>
<div class="line"><a name="l03714"></a><span class="lineno"> 3714</span>&#160;  }</div>
<div class="line"><a name="l03715"></a><span class="lineno"> 3715</span>&#160;};</div>
<div class="line"><a name="l03716"></a><span class="lineno"> 3716</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l03717"></a><span class="lineno"> 3717</span>&#160;<span class="comment">/////////////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l03718"></a><span class="lineno"> 3718</span>&#160;<span class="comment">/// General BellElement class  ///</span></div>
<div class="line"><a name="l03719"></a><span class="lineno"> 3719</span>&#160;<span class="comment">/// Empty, just establishes the template parameters</span></div>
<div class="line"><a name="l03720"></a><span class="lineno"> 3720</span>&#160;<span class="comment">/////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l03721"></a><span class="lineno"> 3721</span>&#160;<span class="comment"></span><span class="keyword">template</span>&lt;<span class="keywordtype">unsigned</span> DIM, <span class="keywordtype">unsigned</span> NNODE_1D&gt;</div>
<div class="line"><a name="l03722"></a><span class="lineno"><a class="line" href="classoomph_1_1BellElement.html"> 3722</a></span>&#160; <span class="keyword">class </span><a class="code" href="classoomph_1_1BellElement.html">BellElement</a> : <span class="keyword">public</span> <span class="keyword">virtual</span> <a class="code" href="classoomph_1_1BellElementBase.html">BellElementBase</a>&lt;NNODE_1D&gt;, <span class="keyword">public</span> <span class="keyword">virtual</span> <a class="code" href="classoomph_1_1TElement.html">TElement</a>&lt;DIM,NNODE_1D&gt;, <span class="keyword">public</span> <span class="keyword">virtual</span> <a class="code" href="classoomph_1_1BellElementShape.html">BellElementShape</a>&lt;DIM&gt;, <span class="keyword">public</span> <span class="keyword">virtual</span> <a class="code" href="classoomph_1_1LinearTElement.html">LinearTElement</a>&lt;DIM&gt;</div>
<div class="line"><a name="l03723"></a><span class="lineno"> 3723</span>&#160;{ </div>
<div class="line"><a name="l03724"></a><span class="lineno"> 3724</span>&#160; public :</div>
<div class="line"><a name="l03725"></a><span class="lineno"> 3725</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l03726"></a><span class="lineno"> 3726</span>&#160;<span class="comment"> ///\short  Constructor: Call constructors for BellElement </span></div>
<div class="line"><a name="l03727"></a><span class="lineno"><a class="line" href="classoomph_1_1BellElement.html#aa5c3a8bc5c7b87ce5ee6fdb6b4281180"> 3727</a></span>&#160;<span class="comment"></span>  <a class="code" href="classoomph_1_1BellElement.html#aa5c3a8bc5c7b87ce5ee6fdb6b4281180">BellElement</a>() : <a class="code" href="classoomph_1_1BellElementBase.html">BellElementBase</a>&lt;NNODE_1D&gt;(), <a class="code" href="classoomph_1_1TElement.html">TElement</a>&lt;DIM,NNODE_1D&gt;(), <a class="code" href="classoomph_1_1BellElementShape.html">BellElementShape</a>&lt;DIM&gt;(), <a class="code" href="classoomph_1_1LinearTElement.html">LinearTElement</a>&lt;DIM&gt;()</div>
<div class="line"><a name="l03728"></a><span class="lineno"> 3728</span>&#160;  {</div>
<div class="line"><a name="l03729"></a><span class="lineno"> 3729</span>&#160;   <span class="comment">//Set the number of types required to interpolate the coordinate</span></div>
<div class="line"><a name="l03730"></a><span class="lineno"> 3730</span>&#160;   this-&gt;<a class="code" href="classoomph_1_1FiniteElement.html#a28916ab3a512b5329e016d90450eb66a">set_nnodal_position_type</a>(6);</div>
<div class="line"><a name="l03731"></a><span class="lineno"> 3731</span>&#160;   <a class="code" href="classoomph_1_1TGauss_3_012_00_014_01_4.html">TGauss&lt;2,4&gt;</a>* new_integral_pt = <span class="keyword">new</span> <a class="code" href="classoomph_1_1TGauss_3_012_00_014_01_4.html">TGauss&lt;2,4&gt;</a>;</div>
<div class="line"><a name="l03732"></a><span class="lineno"> 3732</span>&#160;   this-&gt;<a class="code" href="classoomph_1_1FiniteElement.html#ac80983f27f5bcbc08e2eeb6e4d03698b">set_integration_scheme</a>(new_integral_pt);</div>
<div class="line"><a name="l03733"></a><span class="lineno"> 3733</span>&#160;  }</div>
<div class="line"><a name="l03734"></a><span class="lineno"> 3734</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l03735"></a><span class="lineno"> 3735</span>&#160;<span class="comment"> /// Broken copy constructor</span></div>
<div class="line"><a name="l03736"></a><span class="lineno"><a class="line" href="classoomph_1_1BellElement.html#aa6f76e5cba1c201863b6d45693629c2f"> 3736</a></span>&#160;<span class="comment"></span> <a class="code" href="classoomph_1_1BellElement.html#aa6f76e5cba1c201863b6d45693629c2f">BellElement</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1BellElement.html">BellElement</a>&amp;) </div>
<div class="line"><a name="l03737"></a><span class="lineno"> 3737</span>&#160;  { </div>
<div class="line"><a name="l03738"></a><span class="lineno"> 3738</span>&#160;   <a class="code" href="namespaceoomph_1_1BrokenCopy.html#a7e5cd7fda8b8c790003151bee77a84ac">BrokenCopy::broken_copy</a>(<span class="stringliteral">&quot;BellElement&quot;</span>);</div>
<div class="line"><a name="l03739"></a><span class="lineno"> 3739</span>&#160;  } </div>
<div class="line"><a name="l03740"></a><span class="lineno"> 3740</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l03741"></a><span class="lineno"> 3741</span>&#160;<span class="comment"> /// Broken assignment operator</span></div>
<div class="line"><a name="l03742"></a><span class="lineno"><a class="line" href="classoomph_1_1BellElement.html#a60d06c5a989f698d550368e30760c004"> 3742</a></span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1BellElement.html#a60d06c5a989f698d550368e30760c004">operator=</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1BellElement.html">BellElement</a>&amp;) </div>
<div class="line"><a name="l03743"></a><span class="lineno"> 3743</span>&#160;  {</div>
<div class="line"><a name="l03744"></a><span class="lineno"> 3744</span>&#160;   <a class="code" href="namespaceoomph_1_1BrokenCopy.html#a32dc384e671e786bac0c67cbff701f45">BrokenCopy::broken_assign</a>(<span class="stringliteral">&quot;BellElement&quot;</span>);</div>
<div class="line"><a name="l03745"></a><span class="lineno"> 3745</span>&#160;  }</div>
<div class="line"><a name="l03746"></a><span class="lineno"> 3746</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l03747"></a><span class="lineno"> 3747</span>&#160;<span class="comment"> /// Calculate the geometric shape functions at local coordinate s</span></div>
<div class="line"><a name="l03748"></a><span class="lineno"><a class="line" href="classoomph_1_1BellElement.html#adcf9c26fca0f635473b1f0a0ff45e47d"> 3748</a></span>&#160;<span class="comment"></span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1BellElement.html#adcf9c26fca0f635473b1f0a0ff45e47d">shape</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>, <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;psi)<span class="keyword"> const</span></div>
<div class="line"><a name="l03749"></a><span class="lineno"> 3749</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l03750"></a><span class="lineno"> 3750</span>&#160;   <a class="code" href="classoomph_1_1LinearTElement.html">LinearTElement&lt;2&gt;::Lshape</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,psi);</div>
<div class="line"><a name="l03751"></a><span class="lineno"> 3751</span>&#160;  }</div>
<div class="line"><a name="l03752"></a><span class="lineno"> 3752</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l03753"></a><span class="lineno"> 3753</span>&#160;<span class="comment"> /// \short Compute the geometric shape functions and </span></div>
<div class="line"><a name="l03754"></a><span class="lineno"> 3754</span>&#160;<span class="comment"> /// derivatives w.r.t. local coordinates at local coordinate s</span></div>
<div class="line"><a name="l03755"></a><span class="lineno"><a class="line" href="classoomph_1_1BellElement.html#a3aba354751518a5f1bfe95c531e3d464"> 3755</a></span>&#160;<span class="comment"></span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1BellElement.html#a3aba354751518a5f1bfe95c531e3d464">dshape_local</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>, <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;psi, </div>
<div class="line"><a name="l03756"></a><span class="lineno"> 3756</span>&#160;                          <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;dpsids)<span class="keyword"> const</span></div>
<div class="line"><a name="l03757"></a><span class="lineno"> 3757</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l03758"></a><span class="lineno"> 3758</span>&#160;   <a class="code" href="classoomph_1_1LinearTElement.html">LinearTElement&lt;2&gt;::dLshape_local</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,psi,dpsids);</div>
<div class="line"><a name="l03759"></a><span class="lineno"> 3759</span>&#160;  }</div>
<div class="line"><a name="l03760"></a><span class="lineno"> 3760</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l03761"></a><span class="lineno"> 3761</span>&#160;<span class="comment"> /// \short Computer the geometric shape functions, derivatives and</span></div>
<div class="line"><a name="l03762"></a><span class="lineno"> 3762</span>&#160;<span class="comment"> /// second derivatives w.r.t local coordinates at local coordinate s \n</span></div>
<div class="line"><a name="l03763"></a><span class="lineno"> 3763</span>&#160;<span class="comment"> /// d2psids(i,0) = \f$ \partial^2 \psi_j / \partial s_0^2 \f$ \n</span></div>
<div class="line"><a name="l03764"></a><span class="lineno"> 3764</span>&#160;<span class="comment"> /// d2psids(i,1) = \f$ \partial^2 \psi_j / \partial s_1^2 \f$ \n</span></div>
<div class="line"><a name="l03765"></a><span class="lineno"> 3765</span>&#160;<span class="comment"> /// d2psids(i,2) = \f$ \partial^2 \psi_j / \partial s_0 \partial s_1 \f$ \n</span></div>
<div class="line"><a name="l03766"></a><span class="lineno"><a class="line" href="classoomph_1_1BellElement.html#a60c49217f94a452387d83a521c681d01"> 3766</a></span>&#160;<span class="comment"></span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1BellElement.html#a60c49217f94a452387d83a521c681d01">d2shape_local</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>, <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;psi, </div>
<div class="line"><a name="l03767"></a><span class="lineno"> 3767</span>&#160;                           <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;dpsids, <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;d2psids)<span class="keyword"> const</span></div>
<div class="line"><a name="l03768"></a><span class="lineno"> 3768</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l03769"></a><span class="lineno"> 3769</span>&#160;   <a class="code" href="classoomph_1_1LinearTElement.html">LinearTElement&lt;2&gt;::d2Lshape_local</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,psi,dpsids,d2psids);</div>
<div class="line"><a name="l03770"></a><span class="lineno"> 3770</span>&#160;  }</div>
<div class="line"><a name="l03771"></a><span class="lineno"> 3771</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l03772"></a><span class="lineno"> 3772</span>&#160;<span class="comment"> /// Calculate the c1-basis functions at local coordinate s</span></div>
<div class="line"><a name="l03773"></a><span class="lineno"><a class="line" href="classoomph_1_1BellElement.html#a31a6dfd140d030104094a333d4331dbc"> 3773</a></span>&#160;<span class="comment"></span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1BellElement.html#a31a6dfd140d030104094a333d4331dbc">basis</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>, <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;psi)<span class="keyword"> const</span></div>
<div class="line"><a name="l03774"></a><span class="lineno"> 3774</span>&#160;<span class="keyword">  </span>{<span class="comment"></span></div>
<div class="line"><a name="l03775"></a><span class="lineno"> 3775</span>&#160;<span class="comment">   /// Number of nodes along each element edge</span></div>
<div class="line"><a name="l03776"></a><span class="lineno"> 3776</span>&#160;<span class="comment"></span>   <span class="keywordtype">unsigned</span> n_node = 3;</div>
<div class="line"><a name="l03777"></a><span class="lineno"> 3777</span>&#160;   </div>
<div class="line"><a name="l03778"></a><span class="lineno"> 3778</span>&#160;   <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> node_position(n_node,DIM);</div>
<div class="line"><a name="l03779"></a><span class="lineno"> 3779</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l=0;l&lt;n_node;l++)</div>
<div class="line"><a name="l03780"></a><span class="lineno"> 3780</span>&#160;    {</div>
<div class="line"><a name="l03781"></a><span class="lineno"> 3781</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> k=0;k&lt;1;k++)</div>
<div class="line"><a name="l03782"></a><span class="lineno"> 3782</span>&#160;      {</div>
<div class="line"><a name="l03783"></a><span class="lineno"> 3783</span>&#160;       <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> j=0;j&lt;DIM;j++)</div>
<div class="line"><a name="l03784"></a><span class="lineno"> 3784</span>&#160;        {</div>
<div class="line"><a name="l03785"></a><span class="lineno"> 3785</span>&#160;         node_position(l,j) = this-&gt;<a class="code" href="classoomph_1_1FiniteElement.html#add91f6d02c8819cf778bc76afb4f03d1">raw_nodal_position_gen</a>(l,k,j);</div>
<div class="line"><a name="l03786"></a><span class="lineno"> 3786</span>&#160;        }</div>
<div class="line"><a name="l03787"></a><span class="lineno"> 3787</span>&#160;      }</div>
<div class="line"><a name="l03788"></a><span class="lineno"> 3788</span>&#160;    }</div>
<div class="line"><a name="l03789"></a><span class="lineno"> 3789</span>&#160;   <a class="code" href="classoomph_1_1BellElementShape.html">BellElementShape&lt;2&gt;::Bshape</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,psi,node_position);</div>
<div class="line"><a name="l03790"></a><span class="lineno"> 3790</span>&#160;  }</div>
<div class="line"><a name="l03791"></a><span class="lineno"> 3791</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l03792"></a><span class="lineno"> 3792</span>&#160;<span class="comment"> /// \short Compute the c1-basis functions and </span></div>
<div class="line"><a name="l03793"></a><span class="lineno"> 3793</span>&#160;<span class="comment"> /// derivatives w.r.t. global coordinates at local coordinate s</span></div>
<div class="line"><a name="l03794"></a><span class="lineno"><a class="line" href="classoomph_1_1BellElement.html#aeeceae57e24c50d838e993fd92c8bc68"> 3794</a></span>&#160;<span class="comment"></span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1BellElement.html#aeeceae57e24c50d838e993fd92c8bc68">dbasis_local</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>, <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;psi, </div>
<div class="line"><a name="l03795"></a><span class="lineno"> 3795</span>&#160;                          <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;dpsids)<span class="keyword"> const</span></div>
<div class="line"><a name="l03796"></a><span class="lineno"> 3796</span>&#160;<span class="keyword">  </span>{<span class="comment"></span></div>
<div class="line"><a name="l03797"></a><span class="lineno"> 3797</span>&#160;<span class="comment">   /// Number of nodes along each element edge</span></div>
<div class="line"><a name="l03798"></a><span class="lineno"> 3798</span>&#160;<span class="comment"></span>   <span class="keywordtype">unsigned</span> n_node = 3;</div>
<div class="line"><a name="l03799"></a><span class="lineno"> 3799</span>&#160;   </div>
<div class="line"><a name="l03800"></a><span class="lineno"> 3800</span>&#160;   <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> node_position(3,DIM);</div>
<div class="line"><a name="l03801"></a><span class="lineno"> 3801</span>&#160;   </div>
<div class="line"><a name="l03802"></a><span class="lineno"> 3802</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l=0;l&lt;n_node;l++)</div>
<div class="line"><a name="l03803"></a><span class="lineno"> 3803</span>&#160;    {</div>
<div class="line"><a name="l03804"></a><span class="lineno"> 3804</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> k=0;k&lt;1;k++)</div>
<div class="line"><a name="l03805"></a><span class="lineno"> 3805</span>&#160;      {</div>
<div class="line"><a name="l03806"></a><span class="lineno"> 3806</span>&#160;       <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> j=0;j&lt;DIM;j++)</div>
<div class="line"><a name="l03807"></a><span class="lineno"> 3807</span>&#160;        {</div>
<div class="line"><a name="l03808"></a><span class="lineno"> 3808</span>&#160;         node_position(l,j) = this-&gt;<a class="code" href="classoomph_1_1FiniteElement.html#add91f6d02c8819cf778bc76afb4f03d1">raw_nodal_position_gen</a>(l,k,j);</div>
<div class="line"><a name="l03809"></a><span class="lineno"> 3809</span>&#160;        }</div>
<div class="line"><a name="l03810"></a><span class="lineno"> 3810</span>&#160;      }</div>
<div class="line"><a name="l03811"></a><span class="lineno"> 3811</span>&#160;    }</div>
<div class="line"><a name="l03812"></a><span class="lineno"> 3812</span>&#160;   <a class="code" href="classoomph_1_1BellElementShape.html">BellElementShape&lt;2&gt;::dBshape_local</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,psi,dpsids,node_position);</div>
<div class="line"><a name="l03813"></a><span class="lineno"> 3813</span>&#160;  }</div>
<div class="line"><a name="l03814"></a><span class="lineno"> 3814</span>&#160;  <span class="comment"></span></div>
<div class="line"><a name="l03815"></a><span class="lineno"> 3815</span>&#160;<span class="comment">  /// \short Compute the c1-basis functions and </span></div>
<div class="line"><a name="l03816"></a><span class="lineno"> 3816</span>&#160;<span class="comment"> /// derivatives w.r.t. global coordinates at local coordinate s</span></div>
<div class="line"><a name="l03817"></a><span class="lineno"><a class="line" href="classoomph_1_1BellElement.html#a58254e48913aa6428db33338b010a911"> 3817</a></span>&#160;<span class="comment"></span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1BellElement.html#a58254e48913aa6428db33338b010a911">d2basis_local</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>, <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;psi, </div>
<div class="line"><a name="l03818"></a><span class="lineno"> 3818</span>&#160;                          <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;dpsids, <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;d2psids)<span class="keyword"> const</span></div>
<div class="line"><a name="l03819"></a><span class="lineno"> 3819</span>&#160;<span class="keyword">  </span>{<span class="comment"></span></div>
<div class="line"><a name="l03820"></a><span class="lineno"> 3820</span>&#160;<span class="comment">   /// Number of nodes along each element edge</span></div>
<div class="line"><a name="l03821"></a><span class="lineno"> 3821</span>&#160;<span class="comment"></span>   <span class="keywordtype">unsigned</span> n_node = 3;</div>
<div class="line"><a name="l03822"></a><span class="lineno"> 3822</span>&#160;   <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> node_position(3,DIM);</div>
<div class="line"><a name="l03823"></a><span class="lineno"> 3823</span>&#160;   </div>
<div class="line"><a name="l03824"></a><span class="lineno"> 3824</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l=0;l&lt;n_node;l++)</div>
<div class="line"><a name="l03825"></a><span class="lineno"> 3825</span>&#160;    {</div>
<div class="line"><a name="l03826"></a><span class="lineno"> 3826</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> k=0;k&lt;1;k++)</div>
<div class="line"><a name="l03827"></a><span class="lineno"> 3827</span>&#160;      {</div>
<div class="line"><a name="l03828"></a><span class="lineno"> 3828</span>&#160;       <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> j=0;j&lt;DIM;j++)</div>
<div class="line"><a name="l03829"></a><span class="lineno"> 3829</span>&#160;        {</div>
<div class="line"><a name="l03830"></a><span class="lineno"> 3830</span>&#160;         node_position(l,j) = this-&gt;<a class="code" href="classoomph_1_1FiniteElement.html#add91f6d02c8819cf778bc76afb4f03d1">raw_nodal_position_gen</a>(l,k,j);</div>
<div class="line"><a name="l03831"></a><span class="lineno"> 3831</span>&#160;        }</div>
<div class="line"><a name="l03832"></a><span class="lineno"> 3832</span>&#160;      }</div>
<div class="line"><a name="l03833"></a><span class="lineno"> 3833</span>&#160;    }</div>
<div class="line"><a name="l03834"></a><span class="lineno"> 3834</span>&#160;   <a class="code" href="classoomph_1_1BellElementShape.html">BellElementShape&lt;2&gt;::d2Bshape_local</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,psi,dpsids,d2psids,node_position);</div>
<div class="line"><a name="l03835"></a><span class="lineno"> 3835</span>&#160;  }</div>
<div class="line"><a name="l03836"></a><span class="lineno"> 3836</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l03837"></a><span class="lineno"> 3837</span>&#160;<span class="comment"> /// Calculate the c0-basis functions at local coordinate s</span></div>
<div class="line"><a name="l03838"></a><span class="lineno"><a class="line" href="classoomph_1_1BellElement.html#ad99554f0767e1d82e371ebce2219521b"> 3838</a></span>&#160;<span class="comment"></span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1BellElement.html#ad99554f0767e1d82e371ebce2219521b">basis_c0</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>, <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;psi)<span class="keyword"> const</span></div>
<div class="line"><a name="l03839"></a><span class="lineno"> 3839</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l03840"></a><span class="lineno"> 3840</span>&#160;   <a class="code" href="namespaceoomph_1_1OneDimLagrange.html#a117f8b892dc89989ecdad99ff261e120">TElementShape&lt;2,NNODE_1D&gt;::shape</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,psi);</div>
<div class="line"><a name="l03841"></a><span class="lineno"> 3841</span>&#160;  }</div>
<div class="line"><a name="l03842"></a><span class="lineno"> 3842</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l03843"></a><span class="lineno"> 3843</span>&#160;<span class="comment"> /// \short Compute the c0-basis functions and </span></div>
<div class="line"><a name="l03844"></a><span class="lineno"> 3844</span>&#160;<span class="comment"> /// derivatives w.r.t. local coordinates at local coordinate s</span></div>
<div class="line"><a name="l03845"></a><span class="lineno"><a class="line" href="classoomph_1_1BellElement.html#a3a7b703738e3de182b26b299626d869a"> 3845</a></span>&#160;<span class="comment"></span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1BellElement.html#a3a7b703738e3de182b26b299626d869a">dbasis_c0_local</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>, <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;psi, </div>
<div class="line"><a name="l03846"></a><span class="lineno"> 3846</span>&#160;                          <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;dpsids)<span class="keyword"> const</span></div>
<div class="line"><a name="l03847"></a><span class="lineno"> 3847</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l03848"></a><span class="lineno"> 3848</span>&#160;   <a class="code" href="classoomph_1_1TElementShape.html">TElementShape&lt;2,NNODE_1D&gt;::dshape_local</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,psi,dpsids);</div>
<div class="line"><a name="l03849"></a><span class="lineno"> 3849</span>&#160;  }</div>
<div class="line"><a name="l03850"></a><span class="lineno"> 3850</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l03851"></a><span class="lineno"> 3851</span>&#160;<span class="comment"> /// \short Computer the c0-basis functions, derivatives and</span></div>
<div class="line"><a name="l03852"></a><span class="lineno"> 3852</span>&#160;<span class="comment"> /// second derivatives w.r.t local coordinates at local coordinate s \n</span></div>
<div class="line"><a name="l03853"></a><span class="lineno"> 3853</span>&#160;<span class="comment"> /// d2psids(i,0) = \f$ \partial^2 \psi_j / \partial s_0^2 \f$ \n</span></div>
<div class="line"><a name="l03854"></a><span class="lineno"> 3854</span>&#160;<span class="comment"> /// d2psids(i,1) = \f$ \partial^2 \psi_j / \partial s_1^2 \f$ \n</span></div>
<div class="line"><a name="l03855"></a><span class="lineno"> 3855</span>&#160;<span class="comment"> /// d2psids(i,2) = \f$ \partial^2 \psi_j / \partial s_0 \partial s_1 \f$ \n</span></div>
<div class="line"><a name="l03856"></a><span class="lineno"><a class="line" href="classoomph_1_1BellElement.html#a23f34f6479128e7e8c694fbcb72aae78"> 3856</a></span>&#160;<span class="comment"></span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1BellElement.html#a23f34f6479128e7e8c694fbcb72aae78">d2basis_c0_local</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>, <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;psi, </div>
<div class="line"><a name="l03857"></a><span class="lineno"> 3857</span>&#160;                           <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;dpsids, <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;d2psids)<span class="keyword"> const</span></div>
<div class="line"><a name="l03858"></a><span class="lineno"> 3858</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l03859"></a><span class="lineno"> 3859</span>&#160;   <a class="code" href="classoomph_1_1TElementShape.html">TElementShape&lt;2,NNODE_1D&gt;::d2shape_local</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,psi,dpsids,d2psids);</div>
<div class="line"><a name="l03860"></a><span class="lineno"> 3860</span>&#160;  }</div>
<div class="line"><a name="l03861"></a><span class="lineno"> 3861</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l03862"></a><span class="lineno"> 3862</span>&#160;<span class="comment"> /// Calculate the test functions at local coordinate s</span></div>
<div class="line"><a name="l03863"></a><span class="lineno"><a class="line" href="classoomph_1_1BellElement.html#a99afdb504fee71cb9c557ecb5069cd95"> 3863</a></span>&#160;<span class="comment"></span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1BellElement.html#a99afdb504fee71cb9c557ecb5069cd95">test</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>, <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;psi)<span class="keyword"> const</span></div>
<div class="line"><a name="l03864"></a><span class="lineno"> 3864</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l03865"></a><span class="lineno"> 3865</span>&#160;   <a class="code" href="namespaceoomph_1_1OneDimLagrange.html#a117f8b892dc89989ecdad99ff261e120">TElementShape&lt;2,NNODE_1D&gt;::shape</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,psi);</div>
<div class="line"><a name="l03866"></a><span class="lineno"> 3866</span>&#160;  }</div>
<div class="line"><a name="l03867"></a><span class="lineno"> 3867</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l03868"></a><span class="lineno"> 3868</span>&#160;<span class="comment"> /// \short Compute the  test functions and </span></div>
<div class="line"><a name="l03869"></a><span class="lineno"> 3869</span>&#160;<span class="comment"> /// derivatives w.r.t. local coordinates at local coordinate s</span></div>
<div class="line"><a name="l03870"></a><span class="lineno"><a class="line" href="classoomph_1_1BellElement.html#ae0b6d4d44df8a05a9dd1b8709c9f0247"> 3870</a></span>&#160;<span class="comment"></span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1BellElement.html#ae0b6d4d44df8a05a9dd1b8709c9f0247">dtest_local</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>, <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;psi, </div>
<div class="line"><a name="l03871"></a><span class="lineno"> 3871</span>&#160;                          <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;dpsids)<span class="keyword"> const</span></div>
<div class="line"><a name="l03872"></a><span class="lineno"> 3872</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l03873"></a><span class="lineno"> 3873</span>&#160;   <a class="code" href="classoomph_1_1TElementShape.html">TElementShape&lt;2,NNODE_1D&gt;::dshape_local</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,psi,dpsids);</div>
<div class="line"><a name="l03874"></a><span class="lineno"> 3874</span>&#160;  }</div>
<div class="line"><a name="l03875"></a><span class="lineno"> 3875</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l03876"></a><span class="lineno"> 3876</span>&#160;<span class="comment"> /// \short Computer the test functions, derivatives and</span></div>
<div class="line"><a name="l03877"></a><span class="lineno"> 3877</span>&#160;<span class="comment"> /// second derivatives w.r.t local coordinates at local coordinate s \n</span></div>
<div class="line"><a name="l03878"></a><span class="lineno"> 3878</span>&#160;<span class="comment"> /// d2psids(i,0) = \f$ \partial^2 \psi_j / \partial s_0^2 \f$ \n</span></div>
<div class="line"><a name="l03879"></a><span class="lineno"> 3879</span>&#160;<span class="comment"> /// d2psids(i,1) = \f$ \partial^2 \psi_j / \partial s_1^2 \f$ \n</span></div>
<div class="line"><a name="l03880"></a><span class="lineno"> 3880</span>&#160;<span class="comment"> /// d2psids(i,2) = \f$ \partial^2 \psi_j / \partial s_0 \partial s_1 \f$ \n</span></div>
<div class="line"><a name="l03881"></a><span class="lineno"><a class="line" href="classoomph_1_1BellElement.html#a2d7e1df2f16e344721161ac2de099483"> 3881</a></span>&#160;<span class="comment"></span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1BellElement.html#a2d7e1df2f16e344721161ac2de099483">d2test_local</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>, <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;psi, </div>
<div class="line"><a name="l03882"></a><span class="lineno"> 3882</span>&#160;                           <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;dpsids, <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;d2psids)<span class="keyword"> const</span></div>
<div class="line"><a name="l03883"></a><span class="lineno"> 3883</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l03884"></a><span class="lineno"> 3884</span>&#160;   <a class="code" href="classoomph_1_1TElementShape.html">TElementShape&lt;2,NNODE_1D&gt;::d2shape_local</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,psi,dpsids,d2psids);</div>
<div class="line"><a name="l03885"></a><span class="lineno"> 3885</span>&#160;  }</div>
<div class="line"><a name="l03886"></a><span class="lineno"> 3886</span>&#160; </div>
<div class="line"><a name="l03887"></a><span class="lineno"> 3887</span>&#160;};</div>
<div class="line"><a name="l03888"></a><span class="lineno"> 3888</span>&#160; </div>
<div class="line"><a name="l03889"></a><span class="lineno"> 3889</span>&#160; </div>
<div class="line"><a name="l03890"></a><span class="lineno"> 3890</span>&#160;<span class="comment">//========================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l03891"></a><span class="lineno"> 3891</span>&#160;<span class="comment">/// Empty base class for C1Curvedelements (created so that </span></div>
<div class="line"><a name="l03892"></a><span class="lineno"> 3892</span>&#160;<span class="comment">/// we can use dynamic_cast&lt;&gt;() to figure out if a an element</span></div>
<div class="line"><a name="l03893"></a><span class="lineno"> 3893</span>&#160;<span class="comment">/// is a C1Curvedelement). This element is sup-parametric</span></div>
<div class="line"><a name="l03894"></a><span class="lineno"> 3894</span>&#160;<span class="comment">/// Note that this type of element carries three kinds of shape functions</span></div>
<div class="line"><a name="l03895"></a><span class="lineno"> 3895</span>&#160;<span class="comment">/// shape_straight : denotes C1-shape functions for straight-edged triangle</span></div>
<div class="line"><a name="l03896"></a><span class="lineno"> 3896</span>&#160;<span class="comment">/// shape_curve : denotes C1-shape functions for curve-edged triangle</span></div>
<div class="line"><a name="l03897"></a><span class="lineno"> 3897</span>&#160;<span class="comment">/// shape_geom : denotes C0-shape functions for geometry</span></div>
<div class="line"><a name="l03898"></a><span class="lineno"> 3898</span>&#160;<span class="comment"></span><span class="comment">//========================================================================</span></div>
<div class="line"><a name="l03899"></a><span class="lineno"> 3899</span>&#160;<span class="keyword">template</span>&lt;<span class="keywordtype">unsigned</span> NNODE_1D&gt;</div>
<div class="line"><a name="l03900"></a><span class="lineno"><a class="line" href="classoomph_1_1C1CurvedElementBase.html"> 3900</a></span>&#160;<span class="keyword">class </span><a class="code" href="classoomph_1_1C1CurvedElementBase.html">C1CurvedElementBase</a>: <span class="keyword">public</span> <span class="keyword">virtual</span> <a class="code" href="classoomph_1_1FiniteElement.html">FiniteElement</a></div>
<div class="line"><a name="l03901"></a><span class="lineno"> 3901</span>&#160;{</div>
<div class="line"><a name="l03902"></a><span class="lineno"> 3902</span>&#160;<span class="keyword">public</span>:<span class="comment"></span></div>
<div class="line"><a name="l03903"></a><span class="lineno"> 3903</span>&#160;<span class="comment">  ///\short  Constructor: Call constructors for FiniteElement </span></div>
<div class="line"><a name="l03904"></a><span class="lineno"><a class="line" href="classoomph_1_1C1CurvedElementBase.html#acf744418145e719529ce0f09746976d3"> 3904</a></span>&#160;<span class="comment"></span>  <a class="code" href="classoomph_1_1C1CurvedElementBase.html#acf744418145e719529ce0f09746976d3">C1CurvedElementBase</a>() : <a class="code" href="classoomph_1_1FiniteElement.html">FiniteElement</a>(){}</div>
<div class="line"><a name="l03905"></a><span class="lineno"><a class="line" href="classoomph_1_1C1CurvedElementBase.html#a4735f6f63d4e545608bf485c7168e251"> 3905</a></span>&#160; <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1C1CurvedElementBase.html#a4735f6f63d4e545608bf485c7168e251">get_value_transform_matrix</a>(<a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> &amp;<a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a51292b8e4d96f2bb9f0d6bb0340d1620">D</a>, <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> &amp;<a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a43c804e2bcf9862a4bf629d5f01761e8">B</a>, <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> &amp;node_position, </div>
<div class="line"><a name="l03906"></a><span class="lineno"> 3906</span>&#160;                                          <span class="keywordtype">unsigned</span> &amp;bd_element, <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> &amp;bd_node_position, <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;x)<span class="keyword"> const</span></div>
<div class="line"><a name="l03907"></a><span class="lineno"> 3907</span>&#160;<span class="keyword">  </span>{}</div>
<div class="line"><a name="l03908"></a><span class="lineno"> 3908</span>&#160; </div>
<div class="line"><a name="l03909"></a><span class="lineno"><a class="line" href="classoomph_1_1C1CurvedElementBase.html#ada5b9e50a71fd3e9d3975c78b5c3ed52"> 3909</a></span>&#160; <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1C1CurvedElementBase.html#ada5b9e50a71fd3e9d3975c78b5c3ed52">classify_boundary_node</a>(<a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> &amp;node_position,<span class="keywordtype">unsigned</span> &amp;bd_element, </div>
<div class="line"><a name="l03910"></a><span class="lineno"> 3910</span>&#160;                                     <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> &amp;bd_node_position, <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;x)<span class="keyword"> const</span></div>
<div class="line"><a name="l03911"></a><span class="lineno"> 3911</span>&#160;<span class="keyword">  </span>{}</div>
<div class="line"><a name="l03912"></a><span class="lineno"> 3912</span>&#160; </div>
<div class="line"><a name="l03913"></a><span class="lineno"><a class="line" href="classoomph_1_1C1CurvedElementBase.html#a256c9d25d9f4c9067914b39d1cc4c6fa"> 3913</a></span>&#160; <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1C1CurvedElementBase.html#a256c9d25d9f4c9067914b39d1cc4c6fa">basis_straight</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>, <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;psi)<span class="keyword"> const</span></div>
<div class="line"><a name="l03914"></a><span class="lineno"> 3914</span>&#160;<span class="keyword">  </span>{}</div>
<div class="line"><a name="l03915"></a><span class="lineno"> 3915</span>&#160; </div>
<div class="line"><a name="l03916"></a><span class="lineno"> 3916</span>&#160; </div>
<div class="line"><a name="l03917"></a><span class="lineno"><a class="line" href="classoomph_1_1C1CurvedElementBase.html#a284de72597bf65588e53eb0b4516fa0b"> 3917</a></span>&#160; <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1C1CurvedElementBase.html#a284de72597bf65588e53eb0b4516fa0b">dbasis_local_straight</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>, <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;psi,</div>
<div class="line"><a name="l03918"></a><span class="lineno"> 3918</span>&#160;                            <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;dpsids)<span class="keyword"> const</span></div>
<div class="line"><a name="l03919"></a><span class="lineno"> 3919</span>&#160;<span class="keyword">  </span>{}</div>
<div class="line"><a name="l03920"></a><span class="lineno"> 3920</span>&#160; </div>
<div class="line"><a name="l03921"></a><span class="lineno"><a class="line" href="classoomph_1_1C1CurvedElementBase.html#a5d919ef0eef6ae6477642b3dcd1196df"> 3921</a></span>&#160; <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1C1CurvedElementBase.html#a5d919ef0eef6ae6477642b3dcd1196df">d2basis_local_straight</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>, </div>
<div class="line"><a name="l03922"></a><span class="lineno"> 3922</span>&#160;                             <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;psi, </div>
<div class="line"><a name="l03923"></a><span class="lineno"> 3923</span>&#160;                             <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;dpsids,</div>
<div class="line"><a name="l03924"></a><span class="lineno"> 3924</span>&#160;                             <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;d2psids)<span class="keyword"> const</span></div>
<div class="line"><a name="l03925"></a><span class="lineno"> 3925</span>&#160;<span class="keyword">  </span>{}</div>
<div class="line"><a name="l03926"></a><span class="lineno"> 3926</span>&#160; </div>
<div class="line"><a name="l03927"></a><span class="lineno"><a class="line" href="classoomph_1_1C1CurvedElementBase.html#ae8b0385cfb2eeeb2e17916d76d1e439e"> 3927</a></span>&#160; <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1C1CurvedElementBase.html#ae8b0385cfb2eeeb2e17916d76d1e439e">shape_geom</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>, <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;psi, <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;phi)<span class="keyword"> const</span></div>
<div class="line"><a name="l03928"></a><span class="lineno"> 3928</span>&#160;<span class="keyword">  </span>{}</div>
<div class="line"><a name="l03929"></a><span class="lineno"> 3929</span>&#160; </div>
<div class="line"><a name="l03930"></a><span class="lineno"> 3930</span>&#160; </div>
<div class="line"><a name="l03931"></a><span class="lineno"><a class="line" href="classoomph_1_1C1CurvedElementBase.html#a73eff2b9d4873234465778f53bbeaec8"> 3931</a></span>&#160; <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1C1CurvedElementBase.html#a73eff2b9d4873234465778f53bbeaec8">dshape_local_geom</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>, <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;psi,</div>
<div class="line"><a name="l03932"></a><span class="lineno"> 3932</span>&#160;                            <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;dpsids, <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;phi,</div>
<div class="line"><a name="l03933"></a><span class="lineno"> 3933</span>&#160;                            <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;dphids)<span class="keyword"> const</span></div>
<div class="line"><a name="l03934"></a><span class="lineno"> 3934</span>&#160;<span class="keyword">  </span>{}</div>
<div class="line"><a name="l03935"></a><span class="lineno"> 3935</span>&#160; </div>
<div class="line"><a name="l03936"></a><span class="lineno"><a class="line" href="classoomph_1_1C1CurvedElementBase.html#abafd0a405e40d018020dbffe49cf7258"> 3936</a></span>&#160; <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1C1CurvedElementBase.html#abafd0a405e40d018020dbffe49cf7258">d2shape_local_geom</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>, </div>
<div class="line"><a name="l03937"></a><span class="lineno"> 3937</span>&#160;                             <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;psi, </div>
<div class="line"><a name="l03938"></a><span class="lineno"> 3938</span>&#160;                             <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;dpsids,</div>
<div class="line"><a name="l03939"></a><span class="lineno"> 3939</span>&#160;                             <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;d2psids,</div>
<div class="line"><a name="l03940"></a><span class="lineno"> 3940</span>&#160;                             <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;phi, </div>
<div class="line"><a name="l03941"></a><span class="lineno"> 3941</span>&#160;                             <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;dphids,</div>
<div class="line"><a name="l03942"></a><span class="lineno"> 3942</span>&#160;                             <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;d2phids)<span class="keyword"> const</span></div>
<div class="line"><a name="l03943"></a><span class="lineno"> 3943</span>&#160;<span class="keyword">  </span>{}</div>
<div class="line"><a name="l03944"></a><span class="lineno"> 3944</span>&#160; </div>
<div class="line"><a name="l03945"></a><span class="lineno"><a class="line" href="classoomph_1_1C1CurvedElementBase.html#a9aca3e797997aeb999987b6f69c31320"> 3945</a></span>&#160; <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1C1CurvedElementBase.html#a9aca3e797997aeb999987b6f69c31320">basis_curve</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>, <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;psi)<span class="keyword"> const</span></div>
<div class="line"><a name="l03946"></a><span class="lineno"> 3946</span>&#160;<span class="keyword">  </span>{}</div>
<div class="line"><a name="l03947"></a><span class="lineno"> 3947</span>&#160; </div>
<div class="line"><a name="l03948"></a><span class="lineno"> 3948</span>&#160; </div>
<div class="line"><a name="l03949"></a><span class="lineno"><a class="line" href="classoomph_1_1C1CurvedElementBase.html#a819553bb577933323c1e9c7943d04cad"> 3949</a></span>&#160; <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1C1CurvedElementBase.html#a819553bb577933323c1e9c7943d04cad">dbasis_local_curve</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>, <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;psi,</div>
<div class="line"><a name="l03950"></a><span class="lineno"> 3950</span>&#160;                            <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;dpsids)<span class="keyword"> const</span></div>
<div class="line"><a name="l03951"></a><span class="lineno"> 3951</span>&#160;<span class="keyword">  </span>{}</div>
<div class="line"><a name="l03952"></a><span class="lineno"> 3952</span>&#160; </div>
<div class="line"><a name="l03953"></a><span class="lineno"><a class="line" href="classoomph_1_1C1CurvedElementBase.html#a7bcb3462fd699a3b3f6a8336ec8ed62e"> 3953</a></span>&#160; <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1C1CurvedElementBase.html#a7bcb3462fd699a3b3f6a8336ec8ed62e">d2basis_local_curve</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>, </div>
<div class="line"><a name="l03954"></a><span class="lineno"> 3954</span>&#160;                             <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;psi, </div>
<div class="line"><a name="l03955"></a><span class="lineno"> 3955</span>&#160;                             <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;dpsids,</div>
<div class="line"><a name="l03956"></a><span class="lineno"> 3956</span>&#160;                             <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;d2psids)<span class="keyword"> const</span></div>
<div class="line"><a name="l03957"></a><span class="lineno"> 3957</span>&#160;<span class="keyword">  </span>{}</div>
<div class="line"><a name="l03958"></a><span class="lineno"> 3958</span>&#160; </div>
<div class="line"><a name="l03959"></a><span class="lineno"><a class="line" href="classoomph_1_1C1CurvedElementBase.html#af8dc76a0a5b61c9995e172007b96a3bd"> 3959</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1C1CurvedElementBase.html#af8dc76a0a5b61c9995e172007b96a3bd">basis_c0</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>, <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;psi)<span class="keyword"> const</span></div>
<div class="line"><a name="l03960"></a><span class="lineno"> 3960</span>&#160;<span class="keyword">  </span>{}</div>
<div class="line"><a name="l03961"></a><span class="lineno"> 3961</span>&#160; </div>
<div class="line"><a name="l03962"></a><span class="lineno"> 3962</span>&#160; </div>
<div class="line"><a name="l03963"></a><span class="lineno"><a class="line" href="classoomph_1_1C1CurvedElementBase.html#aea6eaf2184fb2ebe373b10e0e700caf3"> 3963</a></span>&#160; <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1C1CurvedElementBase.html#aea6eaf2184fb2ebe373b10e0e700caf3">dbasis_c0_local</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>, <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;psi,</div>
<div class="line"><a name="l03964"></a><span class="lineno"> 3964</span>&#160;                            <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;dpsids)<span class="keyword"> const</span></div>
<div class="line"><a name="l03965"></a><span class="lineno"> 3965</span>&#160;<span class="keyword">  </span>{}</div>
<div class="line"><a name="l03966"></a><span class="lineno"> 3966</span>&#160; </div>
<div class="line"><a name="l03967"></a><span class="lineno"><a class="line" href="classoomph_1_1C1CurvedElementBase.html#a72e258f980ba1f790e1ba0bc4ec6ef0a"> 3967</a></span>&#160; <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1C1CurvedElementBase.html#a72e258f980ba1f790e1ba0bc4ec6ef0a">d2basis_c0_local</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>, </div>
<div class="line"><a name="l03968"></a><span class="lineno"> 3968</span>&#160;                             <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;psi, </div>
<div class="line"><a name="l03969"></a><span class="lineno"> 3969</span>&#160;                             <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;dpsids,</div>
<div class="line"><a name="l03970"></a><span class="lineno"> 3970</span>&#160;                             <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;d2psids)<span class="keyword"> const</span></div>
<div class="line"><a name="l03971"></a><span class="lineno"> 3971</span>&#160;<span class="keyword">  </span>{}</div>
<div class="line"><a name="l03972"></a><span class="lineno"> 3972</span>&#160; </div>
<div class="line"><a name="l03973"></a><span class="lineno"> 3973</span>&#160; </div>
<div class="line"><a name="l03974"></a><span class="lineno"><a class="line" href="classoomph_1_1C1CurvedElementBase.html#aa953e1d89a6c059ac89c972feb0aea74"> 3974</a></span>&#160; <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1C1CurvedElementBase.html#aa953e1d89a6c059ac89c972feb0aea74">test</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>, <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;phi)<span class="keyword"> const</span></div>
<div class="line"><a name="l03975"></a><span class="lineno"> 3975</span>&#160;<span class="keyword">  </span>{}</div>
<div class="line"><a name="l03976"></a><span class="lineno"> 3976</span>&#160; </div>
<div class="line"><a name="l03977"></a><span class="lineno"> 3977</span>&#160; </div>
<div class="line"><a name="l03978"></a><span class="lineno"><a class="line" href="classoomph_1_1C1CurvedElementBase.html#a49a851713b2d274f14602f05733470fa"> 3978</a></span>&#160; <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1C1CurvedElementBase.html#a49a851713b2d274f14602f05733470fa">dtest_local</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>, <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;phi,</div>
<div class="line"><a name="l03979"></a><span class="lineno"> 3979</span>&#160;                            <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;dphids)<span class="keyword"> const</span></div>
<div class="line"><a name="l03980"></a><span class="lineno"> 3980</span>&#160;<span class="keyword">  </span>{}</div>
<div class="line"><a name="l03981"></a><span class="lineno"> 3981</span>&#160; </div>
<div class="line"><a name="l03982"></a><span class="lineno"><a class="line" href="classoomph_1_1C1CurvedElementBase.html#aedb2b90914f244cd86b2565a658cb9eb"> 3982</a></span>&#160; <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1C1CurvedElementBase.html#aedb2b90914f244cd86b2565a658cb9eb">d2test_local</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>, </div>
<div class="line"><a name="l03983"></a><span class="lineno"> 3983</span>&#160;                             <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;phi, </div>
<div class="line"><a name="l03984"></a><span class="lineno"> 3984</span>&#160;                             <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;dphids,</div>
<div class="line"><a name="l03985"></a><span class="lineno"> 3985</span>&#160;                             <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;d2phids)<span class="keyword"> const</span></div>
<div class="line"><a name="l03986"></a><span class="lineno"> 3986</span>&#160;<span class="keyword">  </span>{}</div>
<div class="line"><a name="l03987"></a><span class="lineno"> 3987</span>&#160; </div>
<div class="line"><a name="l03988"></a><span class="lineno"> 3988</span>&#160; </div>
<div class="line"><a name="l03989"></a><span class="lineno"> 3989</span>&#160;  <span class="comment">//=========================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l03990"></a><span class="lineno"> 3990</span>&#160;<span class="comment">  /// \short Return the c1-shape function associated with a straight-sided </span></div>
<div class="line"><a name="l03991"></a><span class="lineno"> 3991</span>&#160;<span class="comment"> /// boundary stored at the ipt-th integration point.</span></div>
<div class="line"><a name="l03992"></a><span class="lineno"> 3992</span>&#160;<span class="comment"></span> <span class="comment">//=========================================================================</span></div>
<div class="line"><a name="l03993"></a><span class="lineno"><a class="line" href="classoomph_1_1C1CurvedElementBase.html#a5b3e87cecd6887bfc7bcae8f52ebe9e4"> 3993</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1C1CurvedElementBase.html#a5b3e87cecd6887bfc7bcae8f52ebe9e4">basis_at_knot_straight</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;ipt, <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;psi)<span class="keyword"> const</span></div>
<div class="line"><a name="l03994"></a><span class="lineno"> 3994</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l03995"></a><span class="lineno"> 3995</span>&#160;   <span class="comment">//Find the dimension of the element</span></div>
<div class="line"><a name="l03996"></a><span class="lineno"> 3996</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> el_dim = <a class="code" href="classoomph_1_1FiniteElement.html#a5f8fe59f06da1da9f6b7bbcbdb90ef93">dim</a>();</div>
<div class="line"><a name="l03997"></a><span class="lineno"> 3997</span>&#160;   <span class="comment">//Storage for the local coordinates of the integration point</span></div>
<div class="line"><a name="l03998"></a><span class="lineno"> 3998</span>&#160;   <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>(el_dim); </div>
<div class="line"><a name="l03999"></a><span class="lineno"> 3999</span>&#160;   <span class="comment">//Set the local coordinate</span></div>
<div class="line"><a name="l04000"></a><span class="lineno"> 4000</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;el_dim;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++) {<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] = <a class="code" href="classoomph_1_1FiniteElement.html#a79f1710873332823c47023d370f0596b">integral_pt</a>()-&gt;<a class="code" href="classoomph_1_1Integral.html#a1a2122f99a87c18649bafdd9ed739758">knot</a>(ipt,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>);}</div>
<div class="line"><a name="l04001"></a><span class="lineno"> 4001</span>&#160;   <span class="comment">//Get the shape function</span></div>
<div class="line"><a name="l04002"></a><span class="lineno"> 4002</span>&#160;   <a class="code" href="classoomph_1_1C1CurvedElementBase.html#a256c9d25d9f4c9067914b39d1cc4c6fa">basis_straight</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,psi);</div>
<div class="line"><a name="l04003"></a><span class="lineno"> 4003</span>&#160;  }</div>
<div class="line"><a name="l04004"></a><span class="lineno"> 4004</span>&#160;  </div>
<div class="line"><a name="l04005"></a><span class="lineno"> 4005</span>&#160;  <span class="comment">//=========================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l04006"></a><span class="lineno"> 4006</span>&#160;<span class="comment"> /// \short Return the c1-shape function associated with a straight-sided </span></div>
<div class="line"><a name="l04007"></a><span class="lineno"> 4007</span>&#160;<span class="comment"> /// boundary and its derivatives w.r.t. the global</span></div>
<div class="line"><a name="l04008"></a><span class="lineno"> 4008</span>&#160;<span class="comment"> /// coordinates at the ipt-th integration point.</span></div>
<div class="line"><a name="l04009"></a><span class="lineno"> 4009</span>&#160;<span class="comment"></span> <span class="comment">//=========================================================================</span></div>
<div class="line"><a name="l04010"></a><span class="lineno"><a class="line" href="classoomph_1_1C1CurvedElementBase.html#a74fedb14f6c859fdc0d0c37d77f63963"> 4010</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1C1CurvedElementBase.html#a74fedb14f6c859fdc0d0c37d77f63963">dbasis_local_at_knot_straight</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;ipt, <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;psi,</div>
<div class="line"><a name="l04011"></a><span class="lineno"> 4011</span>&#160;                                           <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;dpsids)<span class="keyword"> const</span></div>
<div class="line"><a name="l04012"></a><span class="lineno"> 4012</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l04013"></a><span class="lineno"> 4013</span>&#160;   <span class="comment">//Find the dimension of the element</span></div>
<div class="line"><a name="l04014"></a><span class="lineno"> 4014</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> el_dim = <a class="code" href="classoomph_1_1FiniteElement.html#a5f8fe59f06da1da9f6b7bbcbdb90ef93">dim</a>();</div>
<div class="line"><a name="l04015"></a><span class="lineno"> 4015</span>&#160;   <span class="comment">//Storage for the local coordinates of the integration point</span></div>
<div class="line"><a name="l04016"></a><span class="lineno"> 4016</span>&#160;   <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>(el_dim); </div>
<div class="line"><a name="l04017"></a><span class="lineno"> 4017</span>&#160;   <span class="comment">//Set the local coordinate</span></div>
<div class="line"><a name="l04018"></a><span class="lineno"> 4018</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;el_dim;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++) {<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] = <a class="code" href="classoomph_1_1FiniteElement.html#a79f1710873332823c47023d370f0596b">integral_pt</a>()-&gt;<a class="code" href="classoomph_1_1Integral.html#a1a2122f99a87c18649bafdd9ed739758">knot</a>(ipt,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>);}</div>
<div class="line"><a name="l04019"></a><span class="lineno"> 4019</span>&#160;   <span class="comment">//Get the shape function and derivatives</span></div>
<div class="line"><a name="l04020"></a><span class="lineno"> 4020</span>&#160;   <a class="code" href="classoomph_1_1C1CurvedElementBase.html#a284de72597bf65588e53eb0b4516fa0b">dbasis_local_straight</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,psi,dpsids);</div>
<div class="line"><a name="l04021"></a><span class="lineno"> 4021</span>&#160;   </div>
<div class="line"><a name="l04022"></a><span class="lineno"> 4022</span>&#160;  }</div>
<div class="line"><a name="l04023"></a><span class="lineno"> 4023</span>&#160; </div>
<div class="line"><a name="l04024"></a><span class="lineno"> 4024</span>&#160; <span class="comment">//=========================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l04025"></a><span class="lineno"> 4025</span>&#160;<span class="comment"> /// Calculate the c1-shape function associated with a straight-sided </span></div>
<div class="line"><a name="l04026"></a><span class="lineno"> 4026</span>&#160;<span class="comment"> /// boundary and its first and second derivatives </span></div>
<div class="line"><a name="l04027"></a><span class="lineno"> 4027</span>&#160;<span class="comment"> /// w.r.t. global coordinates at the ipt-th integration point.</span></div>
<div class="line"><a name="l04028"></a><span class="lineno"> 4028</span>&#160;<span class="comment"> /// \n\n Numbering:</span></div>
<div class="line"><a name="l04029"></a><span class="lineno"> 4029</span>&#160;<span class="comment"></span> <span class="comment">//=========================================================================</span></div>
<div class="line"><a name="l04030"></a><span class="lineno"><a class="line" href="classoomph_1_1C1CurvedElementBase.html#a103822347941f4ac149d86066ca121a1"> 4030</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1C1CurvedElementBase.html#a103822347941f4ac149d86066ca121a1">d2basis_local_at_knot_straight</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;ipt, <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;psi, </div>
<div class="line"><a name="l04031"></a><span class="lineno"> 4031</span>&#160;                                            <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;dpsids, <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;d2psids)<span class="keyword"> </span></div>
<div class="line"><a name="l04032"></a><span class="lineno"> 4032</span>&#160;<span class="keyword">   const</span></div>
<div class="line"><a name="l04033"></a><span class="lineno"> 4033</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l04034"></a><span class="lineno"> 4034</span>&#160;   <span class="comment">//Find the dimension of the element</span></div>
<div class="line"><a name="l04035"></a><span class="lineno"> 4035</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> el_dim = <a class="code" href="classoomph_1_1FiniteElement.html#a5f8fe59f06da1da9f6b7bbcbdb90ef93">dim</a>();</div>
<div class="line"><a name="l04036"></a><span class="lineno"> 4036</span>&#160;   <span class="comment">//Storage for the local coordinates of the integration point</span></div>
<div class="line"><a name="l04037"></a><span class="lineno"> 4037</span>&#160;   <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>(el_dim); </div>
<div class="line"><a name="l04038"></a><span class="lineno"> 4038</span>&#160;   <span class="comment">//Set the local coordinate</span></div>
<div class="line"><a name="l04039"></a><span class="lineno"> 4039</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;el_dim;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++) {<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] = <a class="code" href="classoomph_1_1FiniteElement.html#a79f1710873332823c47023d370f0596b">integral_pt</a>()-&gt;<a class="code" href="classoomph_1_1Integral.html#a1a2122f99a87c18649bafdd9ed739758">knot</a>(ipt,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>);}</div>
<div class="line"><a name="l04040"></a><span class="lineno"> 4040</span>&#160;   <span class="comment">//Get the shape function and first and second derivatives</span></div>
<div class="line"><a name="l04041"></a><span class="lineno"> 4041</span>&#160;   <a class="code" href="classoomph_1_1C1CurvedElementBase.html#a5d919ef0eef6ae6477642b3dcd1196df">d2basis_local_straight</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,psi,dpsids,d2psids);</div>
<div class="line"><a name="l04042"></a><span class="lineno"> 4042</span>&#160;   </div>
<div class="line"><a name="l04043"></a><span class="lineno"> 4043</span>&#160;  }</div>
<div class="line"><a name="l04044"></a><span class="lineno"> 4044</span>&#160; </div>
<div class="line"><a name="l04045"></a><span class="lineno"> 4045</span>&#160; <span class="comment">//=========================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l04046"></a><span class="lineno"> 4046</span>&#160;<span class="comment"> /// \short Return the c1-shape function  associated with a curvilinear </span></div>
<div class="line"><a name="l04047"></a><span class="lineno"> 4047</span>&#160;<span class="comment"> /// boundary stored at the ipt-th integration point.</span></div>
<div class="line"><a name="l04048"></a><span class="lineno"> 4048</span>&#160;<span class="comment"></span> <span class="comment">//=========================================================================</span></div>
<div class="line"><a name="l04049"></a><span class="lineno"><a class="line" href="classoomph_1_1C1CurvedElementBase.html#a849f18e06c42052a964fc6ee499b3c94"> 4049</a></span>&#160; <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1C1CurvedElementBase.html#a849f18e06c42052a964fc6ee499b3c94">basis_at_knot_curve</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;ipt, <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;psi)<span class="keyword"> const</span></div>
<div class="line"><a name="l04050"></a><span class="lineno"> 4050</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l04051"></a><span class="lineno"> 4051</span>&#160;   <span class="comment">//Find the dimension of the element</span></div>
<div class="line"><a name="l04052"></a><span class="lineno"> 4052</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> el_dim = <a class="code" href="classoomph_1_1FiniteElement.html#a5f8fe59f06da1da9f6b7bbcbdb90ef93">dim</a>();</div>
<div class="line"><a name="l04053"></a><span class="lineno"> 4053</span>&#160;   <span class="comment">//Storage for the local coordinates of the integration point</span></div>
<div class="line"><a name="l04054"></a><span class="lineno"> 4054</span>&#160;   <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>(el_dim); </div>
<div class="line"><a name="l04055"></a><span class="lineno"> 4055</span>&#160;   <span class="comment">//Set the local coordinate</span></div>
<div class="line"><a name="l04056"></a><span class="lineno"> 4056</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;el_dim;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++) {<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] = <a class="code" href="classoomph_1_1FiniteElement.html#a79f1710873332823c47023d370f0596b">integral_pt</a>()-&gt;<a class="code" href="classoomph_1_1Integral.html#a1a2122f99a87c18649bafdd9ed739758">knot</a>(ipt,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>);}</div>
<div class="line"><a name="l04057"></a><span class="lineno"> 4057</span>&#160;   <span class="comment">//Get the shape function</span></div>
<div class="line"><a name="l04058"></a><span class="lineno"> 4058</span>&#160;   <a class="code" href="classoomph_1_1C1CurvedElementBase.html#a9aca3e797997aeb999987b6f69c31320">basis_curve</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,psi);</div>
<div class="line"><a name="l04059"></a><span class="lineno"> 4059</span>&#160;  }</div>
<div class="line"><a name="l04060"></a><span class="lineno"> 4060</span>&#160;  </div>
<div class="line"><a name="l04061"></a><span class="lineno"> 4061</span>&#160; <span class="comment">//=========================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l04062"></a><span class="lineno"> 4062</span>&#160;<span class="comment"> /// Return the c1-shape function associated with a curvilinear boundary </span></div>
<div class="line"><a name="l04063"></a><span class="lineno"> 4063</span>&#160;<span class="comment"> /// and its derivatives w.r.t. the local coordinates at the ipt-th </span></div>
<div class="line"><a name="l04064"></a><span class="lineno"> 4064</span>&#160;<span class="comment"> /// integration point.</span></div>
<div class="line"><a name="l04065"></a><span class="lineno"> 4065</span>&#160;<span class="comment"></span> <span class="comment">//=========================================================================</span></div>
<div class="line"><a name="l04066"></a><span class="lineno"><a class="line" href="classoomph_1_1C1CurvedElementBase.html#a834ee576efd64a3b9f70f6b0be1f26b9"> 4066</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1C1CurvedElementBase.html#a834ee576efd64a3b9f70f6b0be1f26b9">dbasis_local_at_knot_curve</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;ipt, <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;psi,</div>
<div class="line"><a name="l04067"></a><span class="lineno"> 4067</span>&#160;                                           <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;dpsids)<span class="keyword"> const</span></div>
<div class="line"><a name="l04068"></a><span class="lineno"> 4068</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l04069"></a><span class="lineno"> 4069</span>&#160;   <span class="comment">//Find the dimension of the element</span></div>
<div class="line"><a name="l04070"></a><span class="lineno"> 4070</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> el_dim = <a class="code" href="classoomph_1_1FiniteElement.html#a5f8fe59f06da1da9f6b7bbcbdb90ef93">dim</a>();</div>
<div class="line"><a name="l04071"></a><span class="lineno"> 4071</span>&#160;   <span class="comment">//Storage for the local coordinates of the integration point</span></div>
<div class="line"><a name="l04072"></a><span class="lineno"> 4072</span>&#160;   <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>(el_dim); </div>
<div class="line"><a name="l04073"></a><span class="lineno"> 4073</span>&#160;   <span class="comment">//Set the local coordinate</span></div>
<div class="line"><a name="l04074"></a><span class="lineno"> 4074</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;el_dim;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++) {<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] = <a class="code" href="classoomph_1_1FiniteElement.html#a79f1710873332823c47023d370f0596b">integral_pt</a>()-&gt;<a class="code" href="classoomph_1_1Integral.html#a1a2122f99a87c18649bafdd9ed739758">knot</a>(ipt,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>);}</div>
<div class="line"><a name="l04075"></a><span class="lineno"> 4075</span>&#160;   <span class="comment">//Get the shape function and derivatives</span></div>
<div class="line"><a name="l04076"></a><span class="lineno"> 4076</span>&#160;   <a class="code" href="classoomph_1_1C1CurvedElementBase.html#a819553bb577933323c1e9c7943d04cad">dbasis_local_curve</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,psi,dpsids);</div>
<div class="line"><a name="l04077"></a><span class="lineno"> 4077</span>&#160;  }</div>
<div class="line"><a name="l04078"></a><span class="lineno"> 4078</span>&#160; </div>
<div class="line"><a name="l04079"></a><span class="lineno"> 4079</span>&#160; <span class="comment">//=========================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l04080"></a><span class="lineno"> 4080</span>&#160;<span class="comment"> /// Calculate the c1-shape function associated with a curvilinear boundary </span></div>
<div class="line"><a name="l04081"></a><span class="lineno"> 4081</span>&#160;<span class="comment"> /// and its first and second derivatives w.r.t. local coordinates at the </span></div>
<div class="line"><a name="l04082"></a><span class="lineno"> 4082</span>&#160;<span class="comment"> /// ipt-th integration point.</span></div>
<div class="line"><a name="l04083"></a><span class="lineno"> 4083</span>&#160;<span class="comment"> /// \n\n Numbering:</span></div>
<div class="line"><a name="l04084"></a><span class="lineno"> 4084</span>&#160;<span class="comment"></span> <span class="comment">//=========================================================================</span></div>
<div class="line"><a name="l04085"></a><span class="lineno"><a class="line" href="classoomph_1_1C1CurvedElementBase.html#a3062f4ef25e52d39a9b9ced665a361d0"> 4085</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1C1CurvedElementBase.html#a3062f4ef25e52d39a9b9ced665a361d0">d2basis_local_at_knot_curve</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;ipt, <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;psi, </div>
<div class="line"><a name="l04086"></a><span class="lineno"> 4086</span>&#160;                                            <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;dpsids, <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;d2psids)<span class="keyword"> </span></div>
<div class="line"><a name="l04087"></a><span class="lineno"> 4087</span>&#160;<span class="keyword">   const</span></div>
<div class="line"><a name="l04088"></a><span class="lineno"> 4088</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l04089"></a><span class="lineno"> 4089</span>&#160;   <span class="comment">//Find the dimension of the element</span></div>
<div class="line"><a name="l04090"></a><span class="lineno"> 4090</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> el_dim = <a class="code" href="classoomph_1_1FiniteElement.html#a5f8fe59f06da1da9f6b7bbcbdb90ef93">dim</a>();</div>
<div class="line"><a name="l04091"></a><span class="lineno"> 4091</span>&#160;   <span class="comment">//Storage for the local coordinates of the integration point</span></div>
<div class="line"><a name="l04092"></a><span class="lineno"> 4092</span>&#160;   <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>(el_dim); </div>
<div class="line"><a name="l04093"></a><span class="lineno"> 4093</span>&#160;   <span class="comment">//Set the local coordinate</span></div>
<div class="line"><a name="l04094"></a><span class="lineno"> 4094</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;el_dim;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++) {<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] = <a class="code" href="classoomph_1_1FiniteElement.html#a79f1710873332823c47023d370f0596b">integral_pt</a>()-&gt;<a class="code" href="classoomph_1_1Integral.html#a1a2122f99a87c18649bafdd9ed739758">knot</a>(ipt,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>);}</div>
<div class="line"><a name="l04095"></a><span class="lineno"> 4095</span>&#160;   <span class="comment">//Get the shape function and first and second derivatives</span></div>
<div class="line"><a name="l04096"></a><span class="lineno"> 4096</span>&#160;   <a class="code" href="classoomph_1_1C1CurvedElementBase.html#a7bcb3462fd699a3b3f6a8336ec8ed62e">d2basis_local_curve</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,psi,dpsids,d2psids);  </div>
<div class="line"><a name="l04097"></a><span class="lineno"> 4097</span>&#160;  }</div>
<div class="line"><a name="l04098"></a><span class="lineno"> 4098</span>&#160; </div>
<div class="line"><a name="l04099"></a><span class="lineno"> 4099</span>&#160;  <span class="comment">//=========================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l04100"></a><span class="lineno"> 4100</span>&#160;<span class="comment">  /// \short Return the c0-shape function stored at the ipt-th integration</span></div>
<div class="line"><a name="l04101"></a><span class="lineno"> 4101</span>&#160;<span class="comment"> /// point.</span></div>
<div class="line"><a name="l04102"></a><span class="lineno"> 4102</span>&#160;<span class="comment"></span> <span class="comment">//=========================================================================</span></div>
<div class="line"><a name="l04103"></a><span class="lineno"><a class="line" href="classoomph_1_1C1CurvedElementBase.html#a8f49d1ed702baf3693960c5d278d1495"> 4103</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1C1CurvedElementBase.html#a8f49d1ed702baf3693960c5d278d1495">basis_c0_at_knot</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;ipt, <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;psi)<span class="keyword"> const</span></div>
<div class="line"><a name="l04104"></a><span class="lineno"> 4104</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l04105"></a><span class="lineno"> 4105</span>&#160;   <span class="comment">//Find the dimension of the element</span></div>
<div class="line"><a name="l04106"></a><span class="lineno"> 4106</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> el_dim = <a class="code" href="classoomph_1_1FiniteElement.html#a5f8fe59f06da1da9f6b7bbcbdb90ef93">dim</a>();</div>
<div class="line"><a name="l04107"></a><span class="lineno"> 4107</span>&#160;   <span class="comment">//Storage for the local coordinates of the integration point</span></div>
<div class="line"><a name="l04108"></a><span class="lineno"> 4108</span>&#160;   <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>(el_dim); </div>
<div class="line"><a name="l04109"></a><span class="lineno"> 4109</span>&#160;   <span class="comment">//Set the local coordinate</span></div>
<div class="line"><a name="l04110"></a><span class="lineno"> 4110</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;el_dim;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++) {<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] = <a class="code" href="classoomph_1_1FiniteElement.html#a79f1710873332823c47023d370f0596b">integral_pt</a>()-&gt;<a class="code" href="classoomph_1_1Integral.html#a1a2122f99a87c18649bafdd9ed739758">knot</a>(ipt,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>);}</div>
<div class="line"><a name="l04111"></a><span class="lineno"> 4111</span>&#160;   <span class="comment">//Get the shape function</span></div>
<div class="line"><a name="l04112"></a><span class="lineno"> 4112</span>&#160;   <a class="code" href="classoomph_1_1C1CurvedElementBase.html#af8dc76a0a5b61c9995e172007b96a3bd">basis_c0</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,psi);</div>
<div class="line"><a name="l04113"></a><span class="lineno"> 4113</span>&#160;  }</div>
<div class="line"><a name="l04114"></a><span class="lineno"> 4114</span>&#160;  </div>
<div class="line"><a name="l04115"></a><span class="lineno"> 4115</span>&#160;  <span class="comment">//=========================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l04116"></a><span class="lineno"> 4116</span>&#160;<span class="comment"> /// \short Return the c0-shape function and its derivatives w.r.t. the local</span></div>
<div class="line"><a name="l04117"></a><span class="lineno"> 4117</span>&#160;<span class="comment"> /// coordinates at the ipt-th integration point.</span></div>
<div class="line"><a name="l04118"></a><span class="lineno"> 4118</span>&#160;<span class="comment"></span> <span class="comment">//=========================================================================</span></div>
<div class="line"><a name="l04119"></a><span class="lineno"><a class="line" href="classoomph_1_1C1CurvedElementBase.html#a3c986f9ab0c04b4d7a8ca2ae39c37902"> 4119</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1C1CurvedElementBase.html#a3c986f9ab0c04b4d7a8ca2ae39c37902">dbasis_c0_local_at_knot</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;ipt, <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;psi,</div>
<div class="line"><a name="l04120"></a><span class="lineno"> 4120</span>&#160;                                           <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;dpsids)<span class="keyword"> const</span></div>
<div class="line"><a name="l04121"></a><span class="lineno"> 4121</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l04122"></a><span class="lineno"> 4122</span>&#160;   <span class="comment">//Find the dimension of the element</span></div>
<div class="line"><a name="l04123"></a><span class="lineno"> 4123</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> el_dim = <a class="code" href="classoomph_1_1FiniteElement.html#a5f8fe59f06da1da9f6b7bbcbdb90ef93">dim</a>();</div>
<div class="line"><a name="l04124"></a><span class="lineno"> 4124</span>&#160;   <span class="comment">//Storage for the local coordinates of the integration point</span></div>
<div class="line"><a name="l04125"></a><span class="lineno"> 4125</span>&#160;   <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>(el_dim); </div>
<div class="line"><a name="l04126"></a><span class="lineno"> 4126</span>&#160;   <span class="comment">//Set the local coordinate</span></div>
<div class="line"><a name="l04127"></a><span class="lineno"> 4127</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;el_dim;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++) {<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] = <a class="code" href="classoomph_1_1FiniteElement.html#a79f1710873332823c47023d370f0596b">integral_pt</a>()-&gt;<a class="code" href="classoomph_1_1Integral.html#a1a2122f99a87c18649bafdd9ed739758">knot</a>(ipt,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>);}</div>
<div class="line"><a name="l04128"></a><span class="lineno"> 4128</span>&#160;   <span class="comment">//Get the shape function and derivatives</span></div>
<div class="line"><a name="l04129"></a><span class="lineno"> 4129</span>&#160;   <a class="code" href="classoomph_1_1C1CurvedElementBase.html#aea6eaf2184fb2ebe373b10e0e700caf3">dbasis_c0_local</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,psi,dpsids);   </div>
<div class="line"><a name="l04130"></a><span class="lineno"> 4130</span>&#160;  }</div>
<div class="line"><a name="l04131"></a><span class="lineno"> 4131</span>&#160; </div>
<div class="line"><a name="l04132"></a><span class="lineno"> 4132</span>&#160; <span class="comment">//=========================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l04133"></a><span class="lineno"> 4133</span>&#160;<span class="comment"> /// Calculate the c0-shape function and its first and second derivatives </span></div>
<div class="line"><a name="l04134"></a><span class="lineno"> 4134</span>&#160;<span class="comment"> /// w.r.t. local coordinates at the ipt-th integration point.</span></div>
<div class="line"><a name="l04135"></a><span class="lineno"> 4135</span>&#160;<span class="comment"> /// \n\n Numbering:</span></div>
<div class="line"><a name="l04136"></a><span class="lineno"> 4136</span>&#160;<span class="comment"></span> <span class="comment">//=========================================================================</span></div>
<div class="line"><a name="l04137"></a><span class="lineno"><a class="line" href="classoomph_1_1C1CurvedElementBase.html#a77dd032b44618de5e12187e88a1c7007"> 4137</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1C1CurvedElementBase.html#a77dd032b44618de5e12187e88a1c7007">d2basis_c0_local_at_knot</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;ipt, <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;psi, </div>
<div class="line"><a name="l04138"></a><span class="lineno"> 4138</span>&#160;                                            <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;dpsids, <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;d2psids)<span class="keyword"> </span></div>
<div class="line"><a name="l04139"></a><span class="lineno"> 4139</span>&#160;<span class="keyword">   const</span></div>
<div class="line"><a name="l04140"></a><span class="lineno"> 4140</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l04141"></a><span class="lineno"> 4141</span>&#160;   <span class="comment">//Find the dimension of the element</span></div>
<div class="line"><a name="l04142"></a><span class="lineno"> 4142</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> el_dim = <a class="code" href="classoomph_1_1FiniteElement.html#a5f8fe59f06da1da9f6b7bbcbdb90ef93">dim</a>();</div>
<div class="line"><a name="l04143"></a><span class="lineno"> 4143</span>&#160;   <span class="comment">//Storage for the local coordinates of the integration point</span></div>
<div class="line"><a name="l04144"></a><span class="lineno"> 4144</span>&#160;   <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>(el_dim); </div>
<div class="line"><a name="l04145"></a><span class="lineno"> 4145</span>&#160;   <span class="comment">//Set the local coordinate</span></div>
<div class="line"><a name="l04146"></a><span class="lineno"> 4146</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;el_dim;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++) {<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] = <a class="code" href="classoomph_1_1FiniteElement.html#a79f1710873332823c47023d370f0596b">integral_pt</a>()-&gt;<a class="code" href="classoomph_1_1Integral.html#a1a2122f99a87c18649bafdd9ed739758">knot</a>(ipt,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>);}</div>
<div class="line"><a name="l04147"></a><span class="lineno"> 4147</span>&#160;   <span class="comment">//Get the shape function and first and second derivatives</span></div>
<div class="line"><a name="l04148"></a><span class="lineno"> 4148</span>&#160;   <a class="code" href="classoomph_1_1C1CurvedElementBase.html#a72e258f980ba1f790e1ba0bc4ec6ef0a">d2basis_c0_local</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,psi,dpsids,d2psids);  </div>
<div class="line"><a name="l04149"></a><span class="lineno"> 4149</span>&#160;  }</div>
<div class="line"><a name="l04150"></a><span class="lineno"> 4150</span>&#160; </div>
<div class="line"><a name="l04151"></a><span class="lineno"> 4151</span>&#160; <span class="comment">//=========================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l04152"></a><span class="lineno"> 4152</span>&#160;<span class="comment"> /// \short Return the geometric shape function stored at the ipt-th integration</span></div>
<div class="line"><a name="l04153"></a><span class="lineno"> 4153</span>&#160;<span class="comment"> /// point.</span></div>
<div class="line"><a name="l04154"></a><span class="lineno"> 4154</span>&#160;<span class="comment"></span> <span class="comment">//=========================================================================</span></div>
<div class="line"><a name="l04155"></a><span class="lineno"><a class="line" href="classoomph_1_1C1CurvedElementBase.html#a297ab604e37d625a8d78f9411326650b"> 4155</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1C1CurvedElementBase.html#a297ab604e37d625a8d78f9411326650b">shape_at_knot_geom</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;ipt, <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;psi, <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;phi)<span class="keyword"> const</span></div>
<div class="line"><a name="l04156"></a><span class="lineno"> 4156</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l04157"></a><span class="lineno"> 4157</span>&#160;   <span class="comment">//Find the dimension of the element</span></div>
<div class="line"><a name="l04158"></a><span class="lineno"> 4158</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> el_dim = <a class="code" href="classoomph_1_1FiniteElement.html#a5f8fe59f06da1da9f6b7bbcbdb90ef93">dim</a>();</div>
<div class="line"><a name="l04159"></a><span class="lineno"> 4159</span>&#160;   <span class="comment">//Storage for the local coordinates of the integration point</span></div>
<div class="line"><a name="l04160"></a><span class="lineno"> 4160</span>&#160;   <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>(el_dim); </div>
<div class="line"><a name="l04161"></a><span class="lineno"> 4161</span>&#160;   <span class="comment">//Set the local coordinate</span></div>
<div class="line"><a name="l04162"></a><span class="lineno"> 4162</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;el_dim;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++) {<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] = <a class="code" href="classoomph_1_1FiniteElement.html#a79f1710873332823c47023d370f0596b">integral_pt</a>()-&gt;<a class="code" href="classoomph_1_1Integral.html#a1a2122f99a87c18649bafdd9ed739758">knot</a>(ipt,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>);}</div>
<div class="line"><a name="l04163"></a><span class="lineno"> 4163</span>&#160;   <span class="comment">//Get the shape function</span></div>
<div class="line"><a name="l04164"></a><span class="lineno"> 4164</span>&#160;   <a class="code" href="classoomph_1_1C1CurvedElementBase.html#ae8b0385cfb2eeeb2e17916d76d1e439e">shape_geom</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,psi,phi);</div>
<div class="line"><a name="l04165"></a><span class="lineno"> 4165</span>&#160;  }</div>
<div class="line"><a name="l04166"></a><span class="lineno"> 4166</span>&#160;  </div>
<div class="line"><a name="l04167"></a><span class="lineno"> 4167</span>&#160; <span class="comment">//=========================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l04168"></a><span class="lineno"> 4168</span>&#160;<span class="comment"> /// \short Return the geometric shape function and its derivatives w.r.t. the local</span></div>
<div class="line"><a name="l04169"></a><span class="lineno"> 4169</span>&#160;<span class="comment"> /// coordinates at the ipt-th integration point.</span></div>
<div class="line"><a name="l04170"></a><span class="lineno"> 4170</span>&#160;<span class="comment"></span> <span class="comment">//=========================================================================</span></div>
<div class="line"><a name="l04171"></a><span class="lineno"><a class="line" href="classoomph_1_1C1CurvedElementBase.html#a2cd586d0a06b6dcff44487da273b3642"> 4171</a></span>&#160; <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1C1CurvedElementBase.html#a2cd586d0a06b6dcff44487da273b3642">dshape_local_at_knot_geom</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;ipt, <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;psi,</div>
<div class="line"><a name="l04172"></a><span class="lineno"> 4172</span>&#160;                            <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;dpsids, <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;phi,</div>
<div class="line"><a name="l04173"></a><span class="lineno"> 4173</span>&#160;                            <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;dphids)<span class="keyword"> const</span></div>
<div class="line"><a name="l04174"></a><span class="lineno"> 4174</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l04175"></a><span class="lineno"> 4175</span>&#160;   <span class="comment">//Find the dimension of the element</span></div>
<div class="line"><a name="l04176"></a><span class="lineno"> 4176</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> el_dim = <a class="code" href="classoomph_1_1FiniteElement.html#a5f8fe59f06da1da9f6b7bbcbdb90ef93">dim</a>();</div>
<div class="line"><a name="l04177"></a><span class="lineno"> 4177</span>&#160;   <span class="comment">//Storage for the local coordinates of the integration point</span></div>
<div class="line"><a name="l04178"></a><span class="lineno"> 4178</span>&#160;   <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>(el_dim); </div>
<div class="line"><a name="l04179"></a><span class="lineno"> 4179</span>&#160;   <span class="comment">//Set the local coordinate</span></div>
<div class="line"><a name="l04180"></a><span class="lineno"> 4180</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;el_dim;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++) {<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] = <a class="code" href="classoomph_1_1FiniteElement.html#a79f1710873332823c47023d370f0596b">integral_pt</a>()-&gt;<a class="code" href="classoomph_1_1Integral.html#a1a2122f99a87c18649bafdd9ed739758">knot</a>(ipt,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>);}</div>
<div class="line"><a name="l04181"></a><span class="lineno"> 4181</span>&#160;   <span class="comment">//Get the shape function and derivatives</span></div>
<div class="line"><a name="l04182"></a><span class="lineno"> 4182</span>&#160;   </div>
<div class="line"><a name="l04183"></a><span class="lineno"> 4183</span>&#160;   <a class="code" href="classoomph_1_1C1CurvedElementBase.html#a73eff2b9d4873234465778f53bbeaec8">dshape_local_geom</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,psi,dpsids,phi,dphids);</div>
<div class="line"><a name="l04184"></a><span class="lineno"> 4184</span>&#160;  }</div>
<div class="line"><a name="l04185"></a><span class="lineno"> 4185</span>&#160; </div>
<div class="line"><a name="l04186"></a><span class="lineno"> 4186</span>&#160; <span class="comment">//=========================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l04187"></a><span class="lineno"> 4187</span>&#160;<span class="comment"> /// Calculate the geometric shape function and its first and second derivatives </span></div>
<div class="line"><a name="l04188"></a><span class="lineno"> 4188</span>&#160;<span class="comment"> /// w.r.t. local coordinates at the ipt-th integration point.</span></div>
<div class="line"><a name="l04189"></a><span class="lineno"> 4189</span>&#160;<span class="comment"> /// \n\n Numbering:</span></div>
<div class="line"><a name="l04190"></a><span class="lineno"> 4190</span>&#160;<span class="comment"></span> <span class="comment">//=========================================================================</span></div>
<div class="line"><a name="l04191"></a><span class="lineno"><a class="line" href="classoomph_1_1C1CurvedElementBase.html#afa7d51d3ec5a690371ee392a0ec98ba9"> 4191</a></span>&#160; <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1C1CurvedElementBase.html#afa7d51d3ec5a690371ee392a0ec98ba9">d2shape_local_at_knot_geom</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;ipt, <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;psi, </div>
<div class="line"><a name="l04192"></a><span class="lineno"> 4192</span>&#160;                             <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;dpsids, <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;d2psids, <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;phi, </div>
<div class="line"><a name="l04193"></a><span class="lineno"> 4193</span>&#160;                             <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;dphids, <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;d2phids)<span class="keyword"> </span></div>
<div class="line"><a name="l04194"></a><span class="lineno"> 4194</span>&#160;<span class="keyword">  const</span></div>
<div class="line"><a name="l04195"></a><span class="lineno"> 4195</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l04196"></a><span class="lineno"> 4196</span>&#160;   <span class="comment">//Find the dimension of the element</span></div>
<div class="line"><a name="l04197"></a><span class="lineno"> 4197</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> el_dim = <a class="code" href="classoomph_1_1FiniteElement.html#a5f8fe59f06da1da9f6b7bbcbdb90ef93">dim</a>();</div>
<div class="line"><a name="l04198"></a><span class="lineno"> 4198</span>&#160;   <span class="comment">//Storage for the local coordinates of the integration point</span></div>
<div class="line"><a name="l04199"></a><span class="lineno"> 4199</span>&#160;   <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>(el_dim); </div>
<div class="line"><a name="l04200"></a><span class="lineno"> 4200</span>&#160;   <span class="comment">//Set the local coordinate</span></div>
<div class="line"><a name="l04201"></a><span class="lineno"> 4201</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;el_dim;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++) {<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] = <a class="code" href="classoomph_1_1FiniteElement.html#a79f1710873332823c47023d370f0596b">integral_pt</a>()-&gt;<a class="code" href="classoomph_1_1Integral.html#a1a2122f99a87c18649bafdd9ed739758">knot</a>(ipt,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>);}</div>
<div class="line"><a name="l04202"></a><span class="lineno"> 4202</span>&#160;   <span class="comment">//Get the shape function and first and second derivatives</span></div>
<div class="line"><a name="l04203"></a><span class="lineno"> 4203</span>&#160;   <a class="code" href="classoomph_1_1C1CurvedElementBase.html#abafd0a405e40d018020dbffe49cf7258">d2shape_local_geom</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,psi,dpsids,d2psids,phi,dphids,d2phids);</div>
<div class="line"><a name="l04204"></a><span class="lineno"> 4204</span>&#160;  }</div>
<div class="line"><a name="l04205"></a><span class="lineno"> 4205</span>&#160; </div>
<div class="line"><a name="l04206"></a><span class="lineno"> 4206</span>&#160; <span class="comment">//=========================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l04207"></a><span class="lineno"> 4207</span>&#160;<span class="comment"> /// \short Return the test function stored at the ipt-th integration</span></div>
<div class="line"><a name="l04208"></a><span class="lineno"> 4208</span>&#160;<span class="comment"> /// point.</span></div>
<div class="line"><a name="l04209"></a><span class="lineno"> 4209</span>&#160;<span class="comment"></span> <span class="comment">//=========================================================================</span></div>
<div class="line"><a name="l04210"></a><span class="lineno"><a class="line" href="classoomph_1_1C1CurvedElementBase.html#ab259c76f5ec2f076324127a7e64cccc3"> 4210</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1C1CurvedElementBase.html#ab259c76f5ec2f076324127a7e64cccc3">test_at_knot</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;ipt, <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;phi)<span class="keyword"> const</span></div>
<div class="line"><a name="l04211"></a><span class="lineno"> 4211</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l04212"></a><span class="lineno"> 4212</span>&#160;   <span class="comment">//Find the dimension of the element</span></div>
<div class="line"><a name="l04213"></a><span class="lineno"> 4213</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> el_dim = <a class="code" href="classoomph_1_1FiniteElement.html#a5f8fe59f06da1da9f6b7bbcbdb90ef93">dim</a>();</div>
<div class="line"><a name="l04214"></a><span class="lineno"> 4214</span>&#160;   <span class="comment">//Storage for the local coordinates of the integration point</span></div>
<div class="line"><a name="l04215"></a><span class="lineno"> 4215</span>&#160;   <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>(el_dim); </div>
<div class="line"><a name="l04216"></a><span class="lineno"> 4216</span>&#160;   <span class="comment">//Set the local coordinate</span></div>
<div class="line"><a name="l04217"></a><span class="lineno"> 4217</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;el_dim;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++) {<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] = <a class="code" href="classoomph_1_1FiniteElement.html#a79f1710873332823c47023d370f0596b">integral_pt</a>()-&gt;<a class="code" href="classoomph_1_1Integral.html#a1a2122f99a87c18649bafdd9ed739758">knot</a>(ipt,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>);}</div>
<div class="line"><a name="l04218"></a><span class="lineno"> 4218</span>&#160;   <span class="comment">//Get the shape function</span></div>
<div class="line"><a name="l04219"></a><span class="lineno"> 4219</span>&#160;   <a class="code" href="classoomph_1_1C1CurvedElementBase.html#aa953e1d89a6c059ac89c972feb0aea74">test</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,phi);</div>
<div class="line"><a name="l04220"></a><span class="lineno"> 4220</span>&#160;  }</div>
<div class="line"><a name="l04221"></a><span class="lineno"> 4221</span>&#160;  </div>
<div class="line"><a name="l04222"></a><span class="lineno"> 4222</span>&#160;  <span class="comment">//=========================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l04223"></a><span class="lineno"> 4223</span>&#160;<span class="comment"> /// \short Return the test function and its derivatives w.r.t. the local</span></div>
<div class="line"><a name="l04224"></a><span class="lineno"> 4224</span>&#160;<span class="comment"> /// coordinates at the ipt-th integration point.</span></div>
<div class="line"><a name="l04225"></a><span class="lineno"> 4225</span>&#160;<span class="comment"></span> <span class="comment">//=========================================================================</span></div>
<div class="line"><a name="l04226"></a><span class="lineno"><a class="line" href="classoomph_1_1C1CurvedElementBase.html#a5fcabaae9a008bf601ed01b81e2ee735"> 4226</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1C1CurvedElementBase.html#a5fcabaae9a008bf601ed01b81e2ee735">dtest_local_at_knot</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;ipt, <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;phi,</div>
<div class="line"><a name="l04227"></a><span class="lineno"> 4227</span>&#160;                                           <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;dphids)<span class="keyword"> const</span></div>
<div class="line"><a name="l04228"></a><span class="lineno"> 4228</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l04229"></a><span class="lineno"> 4229</span>&#160;   <span class="comment">//Find the dimension of the element</span></div>
<div class="line"><a name="l04230"></a><span class="lineno"> 4230</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> el_dim = <a class="code" href="classoomph_1_1FiniteElement.html#a5f8fe59f06da1da9f6b7bbcbdb90ef93">dim</a>();</div>
<div class="line"><a name="l04231"></a><span class="lineno"> 4231</span>&#160;   <span class="comment">//Storage for the local coordinates of the integration point</span></div>
<div class="line"><a name="l04232"></a><span class="lineno"> 4232</span>&#160;   <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>(el_dim); </div>
<div class="line"><a name="l04233"></a><span class="lineno"> 4233</span>&#160;   <span class="comment">//Set the local coordinate</span></div>
<div class="line"><a name="l04234"></a><span class="lineno"> 4234</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;el_dim;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++) {<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] = <a class="code" href="classoomph_1_1FiniteElement.html#a79f1710873332823c47023d370f0596b">integral_pt</a>()-&gt;<a class="code" href="classoomph_1_1Integral.html#a1a2122f99a87c18649bafdd9ed739758">knot</a>(ipt,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>);}</div>
<div class="line"><a name="l04235"></a><span class="lineno"> 4235</span>&#160;   <span class="comment">//Get the shape function and derivatives</span></div>
<div class="line"><a name="l04236"></a><span class="lineno"> 4236</span>&#160;   <a class="code" href="classoomph_1_1C1CurvedElementBase.html#a49a851713b2d274f14602f05733470fa">dtest_local</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,phi,dphids);</div>
<div class="line"><a name="l04237"></a><span class="lineno"> 4237</span>&#160;  }</div>
<div class="line"><a name="l04238"></a><span class="lineno"> 4238</span>&#160; </div>
<div class="line"><a name="l04239"></a><span class="lineno"> 4239</span>&#160; <span class="comment">//=========================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l04240"></a><span class="lineno"> 4240</span>&#160;<span class="comment"> /// Calculate the test function and its first and second derivatives </span></div>
<div class="line"><a name="l04241"></a><span class="lineno"> 4241</span>&#160;<span class="comment"> /// w.r.t. local coordinates at the ipt-th integration point.</span></div>
<div class="line"><a name="l04242"></a><span class="lineno"> 4242</span>&#160;<span class="comment"> /// \n\n Numbering:</span></div>
<div class="line"><a name="l04243"></a><span class="lineno"> 4243</span>&#160;<span class="comment"></span> <span class="comment">//=========================================================================</span></div>
<div class="line"><a name="l04244"></a><span class="lineno"><a class="line" href="classoomph_1_1C1CurvedElementBase.html#a2134f74d95690ebefe22339cd0041a8e"> 4244</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1C1CurvedElementBase.html#a2134f74d95690ebefe22339cd0041a8e">d2test_local_at_knot</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;ipt, <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;phi, </div>
<div class="line"><a name="l04245"></a><span class="lineno"> 4245</span>&#160;                                            <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;dphids, <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;d2phids)<span class="keyword"> </span></div>
<div class="line"><a name="l04246"></a><span class="lineno"> 4246</span>&#160;<span class="keyword">   const</span></div>
<div class="line"><a name="l04247"></a><span class="lineno"> 4247</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l04248"></a><span class="lineno"> 4248</span>&#160;   <span class="comment">//Find the dimension of the element</span></div>
<div class="line"><a name="l04249"></a><span class="lineno"> 4249</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> el_dim = <a class="code" href="classoomph_1_1FiniteElement.html#a5f8fe59f06da1da9f6b7bbcbdb90ef93">dim</a>();</div>
<div class="line"><a name="l04250"></a><span class="lineno"> 4250</span>&#160;   <span class="comment">//Storage for the local coordinates of the integration point</span></div>
<div class="line"><a name="l04251"></a><span class="lineno"> 4251</span>&#160;   <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>(el_dim); </div>
<div class="line"><a name="l04252"></a><span class="lineno"> 4252</span>&#160;   <span class="comment">//Set the local coordinate</span></div>
<div class="line"><a name="l04253"></a><span class="lineno"> 4253</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;el_dim;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++) {<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] = <a class="code" href="classoomph_1_1FiniteElement.html#a79f1710873332823c47023d370f0596b">integral_pt</a>()-&gt;<a class="code" href="classoomph_1_1Integral.html#a1a2122f99a87c18649bafdd9ed739758">knot</a>(ipt,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>);}</div>
<div class="line"><a name="l04254"></a><span class="lineno"> 4254</span>&#160;   <span class="comment">//Get the shape function and first and second derivatives</span></div>
<div class="line"><a name="l04255"></a><span class="lineno"> 4255</span>&#160;   <a class="code" href="classoomph_1_1C1CurvedElementBase.html#aedb2b90914f244cd86b2565a658cb9eb">d2test_local</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,phi,dphids,d2phids);</div>
<div class="line"><a name="l04256"></a><span class="lineno"> 4256</span>&#160;  }</div>
<div class="line"><a name="l04257"></a><span class="lineno"> 4257</span>&#160;  </div>
<div class="line"><a name="l04258"></a><span class="lineno"> 4258</span>&#160;  <span class="comment">//=========================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l04259"></a><span class="lineno"> 4259</span>&#160;<span class="comment"> /// Calculate the shape function and its first and second derivatives </span></div>
<div class="line"><a name="l04260"></a><span class="lineno"> 4260</span>&#160;<span class="comment"> /// w.r.t. local coordinates at the ipt-th integration point.</span></div>
<div class="line"><a name="l04261"></a><span class="lineno"> 4261</span>&#160;<span class="comment"> /// \n\n Numbering:</span></div>
<div class="line"><a name="l04262"></a><span class="lineno"> 4262</span>&#160;<span class="comment"></span> <span class="comment">//=========================================================================</span></div>
<div class="line"><a name="l04263"></a><span class="lineno"><a class="line" href="classoomph_1_1C1CurvedElementBase.html#a6411596e17d98cdd0691b6de6e5319d5"> 4263</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1C1CurvedElementBase.html#a6411596e17d98cdd0691b6de6e5319d5">dshape_and_dtest_eulerian_at_knot</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;ipt, <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;psi, <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;dpsi, <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;<a class="code" href="classoomph_1_1C1CurvedElementBase.html#aa953e1d89a6c059ac89c972feb0aea74">test</a>, <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;dtest)<span class="keyword"></span></div>
<div class="line"><a name="l04264"></a><span class="lineno"> 4264</span>&#160;<span class="keyword">   const </span></div>
<div class="line"><a name="l04265"></a><span class="lineno"> 4265</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l04266"></a><span class="lineno"> 4266</span>&#160; </div>
<div class="line"><a name="l04267"></a><span class="lineno"> 4267</span>&#160;    <span class="comment">//Find the element dimension</span></div>
<div class="line"><a name="l04268"></a><span class="lineno"> 4268</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> el_dim = <a class="code" href="classoomph_1_1FiniteElement.html#a5f8fe59f06da1da9f6b7bbcbdb90ef93">dim</a>();</div>
<div class="line"><a name="l04269"></a><span class="lineno"> 4269</span>&#160;   <span class="comment">//Get the values of the shape function and local derivatives</span></div>
<div class="line"><a name="l04270"></a><span class="lineno"> 4270</span>&#160;   <span class="comment">//Temporarily store it in dpsi</span></div>
<div class="line"><a name="l04271"></a><span class="lineno"> 4271</span>&#160;   <span class="comment">// assign shape functions for unknowns</span></div>
<div class="line"><a name="l04272"></a><span class="lineno"> 4272</span>&#160;   <a class="code" href="classoomph_1_1FiniteElement.html#a2214ae814100dcbb553ac97cf243dcfe">dshape_local_at_knot</a>(ipt,psi,dpsi);</div>
<div class="line"><a name="l04273"></a><span class="lineno"> 4273</span>&#160;   </div>
<div class="line"><a name="l04274"></a><span class="lineno"> 4274</span>&#160;   <span class="comment">// assign shape functions for geometry -&gt; Lagrange family</span></div>
<div class="line"><a name="l04275"></a><span class="lineno"> 4275</span>&#160;   <span class="keywordtype">unsigned</span> n_node = 3;</div>
<div class="line"><a name="l04276"></a><span class="lineno"> 4276</span>&#160;   <a class="code" href="classoomph_1_1Shape.html">Shape</a> psi_x(n_node);</div>
<div class="line"><a name="l04277"></a><span class="lineno"> 4277</span>&#160;   <a class="code" href="classoomph_1_1DShape.html">DShape</a> dpsi_x(n_node,2);</div>
<div class="line"><a name="l04278"></a><span class="lineno"> 4278</span>&#160;   <a class="code" href="classoomph_1_1Shape.html">Shape</a> phi(2);</div>
<div class="line"><a name="l04279"></a><span class="lineno"> 4279</span>&#160;   <a class="code" href="classoomph_1_1DShape.html">DShape</a> dphi(2,2);</div>
<div class="line"><a name="l04280"></a><span class="lineno"> 4280</span>&#160;   </div>
<div class="line"><a name="l04281"></a><span class="lineno"> 4281</span>&#160;   <span class="comment">// assign &#39;linear&#39; shape function to geometry</span></div>
<div class="line"><a name="l04282"></a><span class="lineno"> 4282</span>&#160;   <a class="code" href="classoomph_1_1C1CurvedElementBase.html#a2cd586d0a06b6dcff44487da273b3642">dshape_local_at_knot_geom</a>(ipt,psi_x,dpsi_x,phi,dphi);</div>
<div class="line"><a name="l04283"></a><span class="lineno"> 4283</span>&#160; </div>
<div class="line"><a name="l04284"></a><span class="lineno"> 4284</span>&#160;   <span class="comment">// assign test function</span></div>
<div class="line"><a name="l04285"></a><span class="lineno"> 4285</span>&#160;   <a class="code" href="classoomph_1_1C1CurvedElementBase.html#a5fcabaae9a008bf601ed01b81e2ee735">dtest_local_at_knot</a>(ipt,<a class="code" href="classoomph_1_1C1CurvedElementBase.html#aa953e1d89a6c059ac89c972feb0aea74">test</a>,dtest);</div>
<div class="line"><a name="l04286"></a><span class="lineno"> 4286</span>&#160; </div>
<div class="line"><a name="l04287"></a><span class="lineno"> 4287</span>&#160;   <span class="comment">//Allocate memory for the inverse jacobian</span></div>
<div class="line"><a name="l04288"></a><span class="lineno"> 4288</span>&#160;   <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> jacobian(el_dim), inverse_jacobian(el_dim);</div>
<div class="line"><a name="l04289"></a><span class="lineno"> 4289</span>&#160; </div>
<div class="line"><a name="l04290"></a><span class="lineno"> 4290</span>&#160;   <span class="comment">//Now calculate the inverse jacobian</span></div>
<div class="line"><a name="l04291"></a><span class="lineno"> 4291</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">double</span> det = <a class="code" href="classoomph_1_1C1CurvedElementBase.html#a8152ea7e16851b419f1036911f35dbee">local_to_eulerian_mapping2</a>(dpsi_x,dphi,jacobian,inverse_jacobian);</div>
<div class="line"><a name="l04292"></a><span class="lineno"> 4292</span>&#160;   </div>
<div class="line"><a name="l04293"></a><span class="lineno"> 4293</span>&#160;   <span class="comment">//Now set the values of the derivatives to dpsidx</span></div>
<div class="line"><a name="l04294"></a><span class="lineno"> 4294</span>&#160;   <a class="code" href="classoomph_1_1FiniteElement.html#a2c2f243c9f450c4023e5aa4246facd20">transform_derivatives</a>(inverse_jacobian,dpsi);</div>
<div class="line"><a name="l04295"></a><span class="lineno"> 4295</span>&#160;   </div>
<div class="line"><a name="l04296"></a><span class="lineno"> 4296</span>&#160;   <span class="comment">//Return the determinant of the jacobian</span></div>
<div class="line"><a name="l04297"></a><span class="lineno"> 4297</span>&#160;   <span class="keywordflow">return</span> det;</div>
<div class="line"><a name="l04298"></a><span class="lineno"> 4298</span>&#160;  }</div>
<div class="line"><a name="l04299"></a><span class="lineno"> 4299</span>&#160; </div>
<div class="line"><a name="l04300"></a><span class="lineno"> 4300</span>&#160;  <span class="comment">//===========================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l04301"></a><span class="lineno"> 4301</span>&#160;<span class="comment">  /// \short Compute the  c1-shape functions that associated with the straight-</span></div>
<div class="line"><a name="l04302"></a><span class="lineno"> 4302</span>&#160;<span class="comment">  /// boundary element and also first and second derivatives w.r.t. global </span></div>
<div class="line"><a name="l04303"></a><span class="lineno"> 4303</span>&#160;<span class="comment">  /// coordinates at ipt-th integration point</span></div>
<div class="line"><a name="l04304"></a><span class="lineno"> 4304</span>&#160;<span class="comment">  /// Returns Jacobian of mapping from global to local coordinates.</span></div>
<div class="line"><a name="l04305"></a><span class="lineno"> 4305</span>&#160;<span class="comment"></span>  <span class="comment">//===========================================================================</span></div>
<div class="line"><a name="l04306"></a><span class="lineno"><a class="line" href="classoomph_1_1C1CurvedElementBase.html#a758d1f61da5c350b194b3421d30f394d"> 4306</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1C1CurvedElementBase.html#a758d1f61da5c350b194b3421d30f394d">d2shape_and_d2test_eulerian_at_knot</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;ipt, </div>
<div class="line"><a name="l04307"></a><span class="lineno"> 4307</span>&#160;                                                 <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;psi, </div>
<div class="line"><a name="l04308"></a><span class="lineno"> 4308</span>&#160;                                                 <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;dpsi, </div>
<div class="line"><a name="l04309"></a><span class="lineno"> 4309</span>&#160;                                                 <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;d2psi,</div>
<div class="line"><a name="l04310"></a><span class="lineno"> 4310</span>&#160;                                                 <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;<a class="code" href="classoomph_1_1C1CurvedElementBase.html#aa953e1d89a6c059ac89c972feb0aea74">test</a>, </div>
<div class="line"><a name="l04311"></a><span class="lineno"> 4311</span>&#160;                                                 <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;dtest, </div>
<div class="line"><a name="l04312"></a><span class="lineno"> 4312</span>&#160;                                                 <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;d2test)<span class="keyword"> const</span></div>
<div class="line"><a name="l04313"></a><span class="lineno"> 4313</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l04314"></a><span class="lineno"> 4314</span>&#160;   <span class="comment">//Find the values of the indices of the shape functions</span></div>
<div class="line"><a name="l04315"></a><span class="lineno"> 4315</span>&#160;   <span class="comment">//Locally cached</span></div>
<div class="line"><a name="l04316"></a><span class="lineno"> 4316</span>&#160;   <span class="comment">//Find the element dimension</span></div>
<div class="line"><a name="l04317"></a><span class="lineno"> 4317</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> el_dim = <a class="code" href="classoomph_1_1FiniteElement.html#a5f8fe59f06da1da9f6b7bbcbdb90ef93">dim</a>();</div>
<div class="line"><a name="l04318"></a><span class="lineno"> 4318</span>&#160;   <span class="comment">//Get the values of the shape function and local derivatives for unknowns</span></div>
<div class="line"><a name="l04319"></a><span class="lineno"> 4319</span>&#160;   <a class="code" href="classoomph_1_1C1CurvedElementBase.html#a103822347941f4ac149d86066ca121a1">d2basis_local_at_knot_straight</a>(ipt,psi,dpsi,d2psi);</div>
<div class="line"><a name="l04320"></a><span class="lineno"> 4320</span>&#160; </div>
<div class="line"><a name="l04321"></a><span class="lineno"> 4321</span>&#160;   <span class="comment">// assign shape functions for geometry</span></div>
<div class="line"><a name="l04322"></a><span class="lineno"> 4322</span>&#160;   <span class="keywordtype">unsigned</span> n_node = 3;</div>
<div class="line"><a name="l04323"></a><span class="lineno"> 4323</span>&#160;   <a class="code" href="classoomph_1_1Shape.html">Shape</a> psi_x(n_node);</div>
<div class="line"><a name="l04324"></a><span class="lineno"> 4324</span>&#160;   <a class="code" href="classoomph_1_1DShape.html">DShape</a> dpsi_x(n_node,2);</div>
<div class="line"><a name="l04325"></a><span class="lineno"> 4325</span>&#160;   <a class="code" href="classoomph_1_1DShape.html">DShape</a> d2psi_x(n_node,3);</div>
<div class="line"><a name="l04326"></a><span class="lineno"> 4326</span>&#160;   <a class="code" href="classoomph_1_1Shape.html">Shape</a> phi(2);</div>
<div class="line"><a name="l04327"></a><span class="lineno"> 4327</span>&#160;   <a class="code" href="classoomph_1_1DShape.html">DShape</a> dphi(2,2);</div>
<div class="line"><a name="l04328"></a><span class="lineno"> 4328</span>&#160;   <a class="code" href="classoomph_1_1DShape.html">DShape</a> d2phi(2,3);</div>
<div class="line"><a name="l04329"></a><span class="lineno"> 4329</span>&#160;   <a class="code" href="classoomph_1_1C1CurvedElementBase.html#afa7d51d3ec5a690371ee392a0ec98ba9">d2shape_local_at_knot_geom</a>(ipt,psi_x,dpsi_x,d2psi_x,phi,dphi,d2phi);</div>
<div class="line"><a name="l04330"></a><span class="lineno"> 4330</span>&#160; </div>
<div class="line"><a name="l04331"></a><span class="lineno"> 4331</span>&#160;   <span class="comment">// assign for test function</span></div>
<div class="line"><a name="l04332"></a><span class="lineno"> 4332</span>&#160;   <a class="code" href="classoomph_1_1C1CurvedElementBase.html#a2134f74d95690ebefe22339cd0041a8e">d2test_local_at_knot</a>(ipt,<a class="code" href="classoomph_1_1C1CurvedElementBase.html#aa953e1d89a6c059ac89c972feb0aea74">test</a>,dtest,d2test);</div>
<div class="line"><a name="l04333"></a><span class="lineno"> 4333</span>&#160;   </div>
<div class="line"><a name="l04334"></a><span class="lineno"> 4334</span>&#160;   <span class="comment">//Allocate memory for the jacobian and inverse jacobian </span></div>
<div class="line"><a name="l04335"></a><span class="lineno"> 4335</span>&#160;   <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> jacobian(el_dim), inverse_jacobian(el_dim);</div>
<div class="line"><a name="l04336"></a><span class="lineno"> 4336</span>&#160; </div>
<div class="line"><a name="l04337"></a><span class="lineno"> 4337</span>&#160;   <span class="comment">//Calculate the jacobian and inverse jacobian</span></div>
<div class="line"><a name="l04338"></a><span class="lineno"> 4338</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">double</span> det = <a class="code" href="classoomph_1_1C1CurvedElementBase.html#a8152ea7e16851b419f1036911f35dbee">local_to_eulerian_mapping2</a>(dpsi_x,dphi,jacobian,inverse_jacobian);</div>
<div class="line"><a name="l04339"></a><span class="lineno"> 4339</span>&#160; </div>
<div class="line"><a name="l04340"></a><span class="lineno"> 4340</span>&#160;   <span class="comment">//Return the determinant of the mapping</span></div>
<div class="line"><a name="l04341"></a><span class="lineno"> 4341</span>&#160;   <span class="keywordflow">return</span> det;</div>
<div class="line"><a name="l04342"></a><span class="lineno"> 4342</span>&#160;  }</div>
<div class="line"><a name="l04343"></a><span class="lineno"> 4343</span>&#160; </div>
<div class="line"><a name="l04344"></a><span class="lineno"> 4344</span>&#160;  <span class="comment">//===========================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l04345"></a><span class="lineno"> 4345</span>&#160;<span class="comment">  /// \short Calculate the mapping from local to Eulerian coordinates,</span></div>
<div class="line"><a name="l04346"></a><span class="lineno"> 4346</span>&#160;<span class="comment">  /// given the derivatives of the shape functions w.r.t. local coordinates,</span></div>
<div class="line"><a name="l04347"></a><span class="lineno"> 4347</span>&#160;<span class="comment">  /// Return only the determinant of the jacobian and the inverse of the</span></div>
<div class="line"><a name="l04348"></a><span class="lineno"> 4348</span>&#160;<span class="comment">  /// mapping (ds/dx).</span></div>
<div class="line"><a name="l04349"></a><span class="lineno"> 4349</span>&#160;<span class="comment"></span>  <span class="comment">//===========================================================================</span></div>
<div class="line"><a name="l04350"></a><span class="lineno"><a class="line" href="classoomph_1_1C1CurvedElementBase.html#a8152ea7e16851b419f1036911f35dbee"> 4350</a></span>&#160; <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1C1CurvedElementBase.html#a8152ea7e16851b419f1036911f35dbee">local_to_eulerian_mapping2</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;dpsids, <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;dphids,</div>
<div class="line"><a name="l04351"></a><span class="lineno"> 4351</span>&#160;                                   <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> &amp;inverse_jacobian)<span class="keyword"> const</span></div>
<div class="line"><a name="l04352"></a><span class="lineno"> 4352</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l04353"></a><span class="lineno"> 4353</span>&#160;   <span class="comment">//Find the dimension of the element</span></div>
<div class="line"><a name="l04354"></a><span class="lineno"> 4354</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> el_dim = <a class="code" href="classoomph_1_1FiniteElement.html#a5f8fe59f06da1da9f6b7bbcbdb90ef93">dim</a>();</div>
<div class="line"><a name="l04355"></a><span class="lineno"> 4355</span>&#160;   <span class="comment">//Assign memory for the jacobian</span></div>
<div class="line"><a name="l04356"></a><span class="lineno"> 4356</span>&#160;   <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> jacobian(el_dim);</div>
<div class="line"><a name="l04357"></a><span class="lineno"> 4357</span>&#160;   <span class="comment">//Calculate the jacobian and inverse</span></div>
<div class="line"><a name="l04358"></a><span class="lineno"> 4358</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="classoomph_1_1C1CurvedElementBase.html#a8152ea7e16851b419f1036911f35dbee">local_to_eulerian_mapping2</a>(dpsids,dphids,jacobian,inverse_jacobian);</div>
<div class="line"><a name="l04359"></a><span class="lineno"> 4359</span>&#160;  }</div>
<div class="line"><a name="l04360"></a><span class="lineno"> 4360</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l04361"></a><span class="lineno"> 4361</span>&#160;<span class="comment">  ///////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l04362"></a><span class="lineno"><a class="line" href="classoomph_1_1C1CurvedElementBase.html#a850d39886cc45f812ea16e4f10fcf930"> 4362</a></span>&#160;<span class="comment"></span> <span class="keyword">virtual</span> <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1C1CurvedElementBase.html#a850d39886cc45f812ea16e4f10fcf930">local_to_eulerian_mapping2</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;dpsids,</div>
<div class="line"><a name="l04363"></a><span class="lineno"> 4363</span>&#160;                                           <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;dphids,</div>
<div class="line"><a name="l04364"></a><span class="lineno"> 4364</span>&#160;                                           <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> &amp;jacobian,</div>
<div class="line"><a name="l04365"></a><span class="lineno"> 4365</span>&#160;                                           <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> &amp;inverse_jacobian)<span class="keyword"> const</span></div>
<div class="line"><a name="l04366"></a><span class="lineno"> 4366</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l04367"></a><span class="lineno"> 4367</span>&#160;    <span class="comment">//Assemble the jacobian</span></div>
<div class="line"><a name="l04368"></a><span class="lineno"> 4368</span>&#160;    <span class="comment">//Locally cache the elemental dimension</span></div>
<div class="line"><a name="l04369"></a><span class="lineno"> 4369</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> el_dim = <a class="code" href="classoomph_1_1FiniteElement.html#a5f8fe59f06da1da9f6b7bbcbdb90ef93">dim</a>();</div>
<div class="line"><a name="l04370"></a><span class="lineno"> 4370</span>&#160;   </div>
<div class="line"><a name="l04371"></a><span class="lineno"> 4371</span>&#160;   <span class="comment">//Loop over the rows of the jacobian</span></div>
<div class="line"><a name="l04372"></a><span class="lineno"> 4372</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;el_dim;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l04373"></a><span class="lineno"> 4373</span>&#160;    {</div>
<div class="line"><a name="l04374"></a><span class="lineno"> 4374</span>&#160;     <span class="comment">//Loop over the columns of the jacobian</span></div>
<div class="line"><a name="l04375"></a><span class="lineno"> 4375</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> j=0;j&lt;el_dim;j++)</div>
<div class="line"><a name="l04376"></a><span class="lineno"> 4376</span>&#160;      {</div>
<div class="line"><a name="l04377"></a><span class="lineno"> 4377</span>&#160;       <span class="comment">//Zero the entry</span></div>
<div class="line"><a name="l04378"></a><span class="lineno"> 4378</span>&#160;       jacobian(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>,j) = 0.0;</div>
<div class="line"><a name="l04379"></a><span class="lineno"> 4379</span>&#160;       jacobian(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>,j) = dphids(j,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>);</div>
<div class="line"><a name="l04380"></a><span class="lineno"> 4380</span>&#160;      }</div>
<div class="line"><a name="l04381"></a><span class="lineno"> 4381</span>&#160;    } </div>
<div class="line"><a name="l04382"></a><span class="lineno"> 4382</span>&#160;   <span class="comment">//Invert the jacobian (use the template-free interface)</span></div>
<div class="line"><a name="l04383"></a><span class="lineno"> 4383</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="classoomph_1_1FiniteElement.html#a42c86a7628fee00d3a9d35b935b29e48">invert_jacobian_mapping</a>(jacobian,inverse_jacobian);</div>
<div class="line"><a name="l04384"></a><span class="lineno"> 4384</span>&#160;  }</div>
<div class="line"><a name="l04385"></a><span class="lineno"> 4385</span>&#160; </div>
<div class="line"><a name="l04386"></a><span class="lineno"> 4386</span>&#160; <span class="comment">//=========================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l04387"></a><span class="lineno"> 4387</span>&#160;<span class="comment"> /// Internal function that is used to assemble the jacobian of second</span></div>
<div class="line"><a name="l04388"></a><span class="lineno"> 4388</span>&#160;<span class="comment"> /// derivatives of the the mapping from local coordinates (s) to the </span></div>
<div class="line"><a name="l04389"></a><span class="lineno"> 4389</span>&#160;<span class="comment"> /// eulerian coordinates (x), given the second derivatives of the </span></div>
<div class="line"><a name="l04390"></a><span class="lineno"> 4390</span>&#160;<span class="comment"> /// shape functions. </span></div>
<div class="line"><a name="l04391"></a><span class="lineno"> 4391</span>&#160;<span class="comment"></span> <span class="comment">//=========================================================================</span></div>
<div class="line"><a name="l04392"></a><span class="lineno"><a class="line" href="classoomph_1_1C1CurvedElementBase.html#a5c56b56c6c246769b0b5fd3f20253ffe"> 4392</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1C1CurvedElementBase.html#a5c56b56c6c246769b0b5fd3f20253ffe">myassemble_local_to_eulerian_jacobian2</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;d2psids,</div>
<div class="line"><a name="l04393"></a><span class="lineno"> 4393</span>&#160;                                       <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> &amp;jacobian2)<span class="keyword"> const</span></div>
<div class="line"><a name="l04394"></a><span class="lineno"> 4394</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l04395"></a><span class="lineno"> 4395</span>&#160;   <span class="comment">//Find the the dimension of the element</span></div>
<div class="line"><a name="l04396"></a><span class="lineno"> 4396</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> el_dim = <a class="code" href="classoomph_1_1FiniteElement.html#a5f8fe59f06da1da9f6b7bbcbdb90ef93">dim</a>();</div>
<div class="line"><a name="l04397"></a><span class="lineno"> 4397</span>&#160;   <span class="comment">//Find the number of second derivatives</span></div>
<div class="line"><a name="l04398"></a><span class="lineno"> 4398</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_row = <a class="code" href="classoomph_1_1FiniteElement.html#ad1600b17efbe61db27a4c622af1f28cf">N2deriv</a>[el_dim];</div>
<div class="line"><a name="l04399"></a><span class="lineno"> 4399</span>&#160;   <span class="comment">//Assemble the &quot;jacobian&quot; (d^2 x_j/ds_i^2) for second derivatives of </span></div>
<div class="line"><a name="l04400"></a><span class="lineno"> 4400</span>&#160;   <span class="comment">//shape functions</span></div>
<div class="line"><a name="l04401"></a><span class="lineno"> 4401</span>&#160;   <span class="comment">//Loop over the rows (number of second derivatives)</span></div>
<div class="line"><a name="l04402"></a><span class="lineno"> 4402</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;n_row;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l04403"></a><span class="lineno"> 4403</span>&#160;    {</div>
<div class="line"><a name="l04404"></a><span class="lineno"> 4404</span>&#160;     <span class="comment">//Loop over the columns (element dimension</span></div>
<div class="line"><a name="l04405"></a><span class="lineno"> 4405</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> j=0;j&lt;el_dim;j++)</div>
<div class="line"><a name="l04406"></a><span class="lineno"> 4406</span>&#160;      {</div>
<div class="line"><a name="l04407"></a><span class="lineno"> 4407</span>&#160;       <span class="comment">//Zero the entry</span></div>
<div class="line"><a name="l04408"></a><span class="lineno"> 4408</span>&#160;       jacobian2(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>,j) = 0.0;</div>
<div class="line"><a name="l04409"></a><span class="lineno"> 4409</span>&#160;       jacobian2(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>,j) = d2psids(j,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>);</div>
<div class="line"><a name="l04410"></a><span class="lineno"> 4410</span>&#160;      }</div>
<div class="line"><a name="l04411"></a><span class="lineno"> 4411</span>&#160;    }</div>
<div class="line"><a name="l04412"></a><span class="lineno"> 4412</span>&#160;  }</div>
<div class="line"><a name="l04413"></a><span class="lineno"> 4413</span>&#160; </div>
<div class="line"><a name="l04414"></a><span class="lineno"> 4414</span>&#160; <span class="comment">//=======================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l04415"></a><span class="lineno"> 4415</span>&#160;<span class="comment"> /// Return FE interpolated position x[] at local coordinate s as Vector</span></div>
<div class="line"><a name="l04416"></a><span class="lineno"> 4416</span>&#160;<span class="comment"></span> <span class="comment">// (using Hermite interpolation)</span></div>
<div class="line"><a name="l04417"></a><span class="lineno"> 4417</span>&#160; <span class="comment">//=======================================================================</span></div>
<div class="line"><a name="l04418"></a><span class="lineno"><a class="line" href="classoomph_1_1C1CurvedElementBase.html#af16c55258f87849a452de6e38c13a366"> 4418</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1C1CurvedElementBase.html#af16c55258f87849a452de6e38c13a366">my_interpolated_x</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>, <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;x)<span class="keyword"></span></div>
<div class="line"><a name="l04419"></a><span class="lineno"> 4419</span>&#160;<span class="keyword">   const</span></div>
<div class="line"><a name="l04420"></a><span class="lineno"> 4420</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l04421"></a><span class="lineno"> 4421</span>&#160;   <span class="comment">//Find the number of nodes</span></div>
<div class="line"><a name="l04422"></a><span class="lineno"> 4422</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_node = 3;</div>
<div class="line"><a name="l04423"></a><span class="lineno"> 4423</span>&#160;   <span class="comment">//Assign storage for the local shape function</span></div>
<div class="line"><a name="l04424"></a><span class="lineno"> 4424</span>&#160;   <a class="code" href="classoomph_1_1Shape.html">Shape</a> psi(n_node);</div>
<div class="line"><a name="l04425"></a><span class="lineno"> 4425</span>&#160;   <a class="code" href="classoomph_1_1Shape.html">Shape</a> phi(2);</div>
<div class="line"><a name="l04426"></a><span class="lineno"> 4426</span>&#160;   <span class="comment">//Find the values of shape function</span></div>
<div class="line"><a name="l04427"></a><span class="lineno"> 4427</span>&#160;   <a class="code" href="classoomph_1_1C1CurvedElementBase.html#ae8b0385cfb2eeeb2e17916d76d1e439e">shape_geom</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,psi,phi);</div>
<div class="line"><a name="l04428"></a><span class="lineno"> 4428</span>&#160;   </div>
<div class="line"><a name="l04429"></a><span class="lineno"> 4429</span>&#160;   x[0] = phi[0];</div>
<div class="line"><a name="l04430"></a><span class="lineno"> 4430</span>&#160;   x[1] = phi[1];</div>
<div class="line"><a name="l04431"></a><span class="lineno"> 4431</span>&#160;  }</div>
<div class="line"><a name="l04432"></a><span class="lineno"> 4432</span>&#160;  </div>
<div class="line"><a name="l04433"></a><span class="lineno"> 4433</span>&#160; <span class="comment">//========================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l04434"></a><span class="lineno"> 4434</span>&#160;<span class="comment"> /// \short Calculate the Jacobian of the mapping between local and global</span></div>
<div class="line"><a name="l04435"></a><span class="lineno"> 4435</span>&#160;<span class="comment"> /// coordinates at the position s</span></div>
<div class="line"><a name="l04436"></a><span class="lineno"> 4436</span>&#160;<span class="comment"></span> <span class="comment">//========================================================================</span></div>
<div class="line"><a name="l04437"></a><span class="lineno"><a class="line" href="classoomph_1_1C1CurvedElementBase.html#af8d7bb2e120f655629419f7627d95602"> 4437</a></span>&#160; <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1C1CurvedElementBase.html#af8d7bb2e120f655629419f7627d95602">J_eulerian1</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>)<span class="keyword"> const</span></div>
<div class="line"><a name="l04438"></a><span class="lineno"> 4438</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l04439"></a><span class="lineno"> 4439</span>&#160;    <span class="comment">//Find the number of nodes and position types</span></div>
<div class="line"><a name="l04440"></a><span class="lineno"> 4440</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_node = 3;</div>
<div class="line"><a name="l04441"></a><span class="lineno"> 4441</span>&#160;   <span class="comment">//Find the dimension of the node and element</span></div>
<div class="line"><a name="l04442"></a><span class="lineno"> 4442</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_dim_node = this-&gt;<a class="code" href="classoomph_1_1FiniteElement.html#ab6602b43c3a2f1a5e48729b0b23c0d91">nodal_dimension</a>();</div>
<div class="line"><a name="l04443"></a><span class="lineno"> 4443</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_dim_element = this-&gt;<a class="code" href="classoomph_1_1FiniteElement.html#a5f8fe59f06da1da9f6b7bbcbdb90ef93">dim</a>();</div>
<div class="line"><a name="l04444"></a><span class="lineno"> 4444</span>&#160; </div>
<div class="line"><a name="l04445"></a><span class="lineno"> 4445</span>&#160;   <span class="comment">//Set up dummy memory for the shape functions</span></div>
<div class="line"><a name="l04446"></a><span class="lineno"> 4446</span>&#160;   <span class="comment">// compute the jacobian of mapping matrix</span></div>
<div class="line"><a name="l04447"></a><span class="lineno"> 4447</span>&#160;   <a class="code" href="classoomph_1_1Shape.html">Shape</a> psi(n_node), phi(2);</div>
<div class="line"><a name="l04448"></a><span class="lineno"> 4448</span>&#160;   <a class="code" href="classoomph_1_1DShape.html">DShape</a> dpsids(n_node,n_dim_element), dphi(2,2);</div>
<div class="line"><a name="l04449"></a><span class="lineno"> 4449</span>&#160;   <span class="comment">//Get the shape functions and local derivatives for geometry</span></div>
<div class="line"><a name="l04450"></a><span class="lineno"> 4450</span>&#160;   this-&gt;<a class="code" href="classoomph_1_1C1CurvedElementBase.html#a73eff2b9d4873234465778f53bbeaec8">dshape_local_geom</a>(s,psi,dpsids,phi,dphi);</div>
<div class="line"><a name="l04451"></a><span class="lineno"> 4451</span>&#160;   </div>
<div class="line"><a name="l04452"></a><span class="lineno"> 4452</span>&#160;   <span class="comment">//Right calculate the base vectors</span></div>
<div class="line"><a name="l04453"></a><span class="lineno"> 4453</span>&#160;   <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> interpolated_G(n_dim_element,n_dim_node);</div>
<div class="line"><a name="l04454"></a><span class="lineno"> 4454</span>&#160;   </div>
<div class="line"><a name="l04455"></a><span class="lineno"> 4455</span>&#160;   <span class="comment">//Loop over the dimensions and compute the entries of the </span></div>
<div class="line"><a name="l04456"></a><span class="lineno"> 4456</span>&#160;   <span class="comment">//base vector matrix</span></div>
<div class="line"><a name="l04457"></a><span class="lineno"> 4457</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;n_dim_element;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l04458"></a><span class="lineno"> 4458</span>&#160;    {</div>
<div class="line"><a name="l04459"></a><span class="lineno"> 4459</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> j=0;j&lt;n_dim_node;j++)</div>
<div class="line"><a name="l04460"></a><span class="lineno"> 4460</span>&#160;      {</div>
<div class="line"><a name="l04461"></a><span class="lineno"> 4461</span>&#160;       interpolated_G(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>,j) = dphi(j,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>);</div>
<div class="line"><a name="l04462"></a><span class="lineno"> 4462</span>&#160;      }</div>
<div class="line"><a name="l04463"></a><span class="lineno"> 4463</span>&#160;    }</div>
<div class="line"><a name="l04464"></a><span class="lineno"> 4464</span>&#160;  </div>
<div class="line"><a name="l04465"></a><span class="lineno"> 4465</span>&#160;   <span class="comment">//Calculate the metric tensor of the element</span></div>
<div class="line"><a name="l04466"></a><span class="lineno"> 4466</span>&#160;   <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> G(n_dim_element);</div>
<div class="line"><a name="l04467"></a><span class="lineno"> 4467</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;n_dim_element;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l04468"></a><span class="lineno"> 4468</span>&#160;    {</div>
<div class="line"><a name="l04469"></a><span class="lineno"> 4469</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> j=0;j&lt;n_dim_element;j++)</div>
<div class="line"><a name="l04470"></a><span class="lineno"> 4470</span>&#160;      {</div>
<div class="line"><a name="l04471"></a><span class="lineno"> 4471</span>&#160;       <span class="comment">//Initialise to zero</span></div>
<div class="line"><a name="l04472"></a><span class="lineno"> 4472</span>&#160;       G(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>,j) = 0.0;</div>
<div class="line"><a name="l04473"></a><span class="lineno"> 4473</span>&#160;       <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> k=0;k&lt;n_dim_node;k++) </div>
<div class="line"><a name="l04474"></a><span class="lineno"> 4474</span>&#160;        {</div>
<div class="line"><a name="l04475"></a><span class="lineno"> 4475</span>&#160;         G(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>,j) += interpolated_G(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>,k)*interpolated_G(j,k);</div>
<div class="line"><a name="l04476"></a><span class="lineno"> 4476</span>&#160;        }</div>
<div class="line"><a name="l04477"></a><span class="lineno"> 4477</span>&#160;      }</div>
<div class="line"><a name="l04478"></a><span class="lineno"> 4478</span>&#160;    }</div>
<div class="line"><a name="l04479"></a><span class="lineno"> 4479</span>&#160; </div>
<div class="line"><a name="l04480"></a><span class="lineno"> 4480</span>&#160;   <span class="comment">//Calculate the determinant of the metric tensor</span></div>
<div class="line"><a name="l04481"></a><span class="lineno"> 4481</span>&#160;   <span class="keywordtype">double</span> det = 0.0;</div>
<div class="line"><a name="l04482"></a><span class="lineno"> 4482</span>&#160;   <span class="keywordflow">switch</span>(n_dim_element)</div>
<div class="line"><a name="l04483"></a><span class="lineno"> 4483</span>&#160;    {</div>
<div class="line"><a name="l04484"></a><span class="lineno"> 4484</span>&#160;    <span class="keywordflow">case</span> 0:</div>
<div class="line"><a name="l04485"></a><span class="lineno"> 4485</span>&#160;     <span class="keywordflow">throw</span> <a class="code" href="classoomph_1_1OomphLibError.html">OomphLibError</a>(<span class="stringliteral">&quot;Cannot calculate J_eulerian() for point element\n&quot;</span>,</div>
<div class="line"><a name="l04486"></a><span class="lineno"> 4486</span>&#160;                         <span class="stringliteral">&quot;FiniteElement::J_eulerian()&quot;</span>,</div>
<div class="line"><a name="l04487"></a><span class="lineno"> 4487</span>&#160;                         OOMPH_EXCEPTION_LOCATION);</div>
<div class="line"><a name="l04488"></a><span class="lineno"> 4488</span>&#160;     <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04489"></a><span class="lineno"> 4489</span>&#160;    <span class="keywordflow">case</span> 1:</div>
<div class="line"><a name="l04490"></a><span class="lineno"> 4490</span>&#160;     det = G(0,0);</div>
<div class="line"><a name="l04491"></a><span class="lineno"> 4491</span>&#160;     <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04492"></a><span class="lineno"> 4492</span>&#160;    <span class="keywordflow">case</span> 2:</div>
<div class="line"><a name="l04493"></a><span class="lineno"> 4493</span>&#160;     det = G(0,0)*G(1,1) - G(0,1)*G(1,0);</div>
<div class="line"><a name="l04494"></a><span class="lineno"> 4494</span>&#160;     <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04495"></a><span class="lineno"> 4495</span>&#160;    <span class="keywordflow">case</span> 3:</div>
<div class="line"><a name="l04496"></a><span class="lineno"> 4496</span>&#160;     det = G(0,0)*G(1,1)*G(2,2) + G(0,1)*G(1,2)*G(2,0) + G(0,2)*G(1,0)*G(2,1)</div>
<div class="line"><a name="l04497"></a><span class="lineno"> 4497</span>&#160;      - G(0,0)*G(1,2)*G(2,1) - G(0,1)*G(1,0)*G(2,2) - G(0,2)*G(1,1)*G(2,0);</div>
<div class="line"><a name="l04498"></a><span class="lineno"> 4498</span>&#160;     <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04499"></a><span class="lineno"> 4499</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l04500"></a><span class="lineno"> 4500</span>&#160;     <a class="code" href="namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;More than 3 dimensions in J_eulerian()&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l04501"></a><span class="lineno"> 4501</span>&#160;     <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04502"></a><span class="lineno"> 4502</span>&#160;    }</div>
<div class="line"><a name="l04503"></a><span class="lineno"> 4503</span>&#160; </div>
<div class="line"><a name="l04504"></a><span class="lineno"> 4504</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l04505"></a><span class="lineno"> 4505</span>&#160;   this-&gt;<a class="code" href="classoomph_1_1FiniteElement.html#a524acd2f6d25d55806b7050032ee6330">check_jacobian</a>(det);</div>
<div class="line"><a name="l04506"></a><span class="lineno"> 4506</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l04507"></a><span class="lineno"> 4507</span>&#160;   </div>
<div class="line"><a name="l04508"></a><span class="lineno"> 4508</span>&#160;   <span class="comment">//Return the Jacobian (square-root of the determinant of the metric tensor)</span></div>
<div class="line"><a name="l04509"></a><span class="lineno"> 4509</span>&#160;   <span class="keywordflow">return</span> det; </div>
<div class="line"><a name="l04510"></a><span class="lineno"> 4510</span>&#160;  }</div>
<div class="line"><a name="l04511"></a><span class="lineno"> 4511</span>&#160;  </div>
<div class="line"><a name="l04512"></a><span class="lineno"> 4512</span>&#160;  <span class="comment">// =======================================================================</span></div>
<div class="line"><a name="l04513"></a><span class="lineno"> 4513</span>&#160;  <span class="comment">// Check whether this element is a boundary element or not</span></div>
<div class="line"><a name="l04514"></a><span class="lineno"> 4514</span>&#160;  <span class="comment">//========================================================================</span></div>
<div class="line"><a name="l04515"></a><span class="lineno"><a class="line" href="classoomph_1_1C1CurvedElementBase.html#a819873b0790335875e6c009d63615464"> 4515</a></span>&#160; <span class="keywordtype">unsigned</span> <a class="code" href="classoomph_1_1C1CurvedElementBase.html#a819873b0790335875e6c009d63615464">is_boundary_element</a>()<span class="keyword">const</span></div>
<div class="line"><a name="l04516"></a><span class="lineno"> 4516</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l04517"></a><span class="lineno"> 4517</span>&#160;   <span class="keywordtype">unsigned</span> n_node = 3;</div>
<div class="line"><a name="l04518"></a><span class="lineno"> 4518</span>&#160;   <span class="keywordtype">int</span> count=0;</div>
<div class="line"><a name="l04519"></a><span class="lineno"> 4519</span>&#160;   <span class="comment">// check whether this element is on boundary or not</span></div>
<div class="line"><a name="l04520"></a><span class="lineno"> 4520</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;n_node;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l04521"></a><span class="lineno"> 4521</span>&#160;    {</div>
<div class="line"><a name="l04522"></a><span class="lineno"> 4522</span>&#160;     <span class="comment">// check whether this node is on 1st boundary (curve boundary)</span></div>
<div class="line"><a name="l04523"></a><span class="lineno"> 4523</span>&#160;     <span class="keywordtype">bool</span> bd_node1 = <a class="code" href="classoomph_1_1FiniteElement.html#ace0e7fb72a805b5c2c600347bfae7a9b">node_pt</a>(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>)-&gt;<a class="code" href="classoomph_1_1Node.html#a2ca215e42116ee8a2acc7d6a35e37788">is_on_boundary</a>(1);</div>
<div class="line"><a name="l04524"></a><span class="lineno"> 4524</span>&#160;     <span class="keywordflow">if</span>(bd_node1==1)</div>
<div class="line"><a name="l04525"></a><span class="lineno"> 4525</span>&#160;      {</div>
<div class="line"><a name="l04526"></a><span class="lineno"> 4526</span>&#160;       count += 1;</div>
<div class="line"><a name="l04527"></a><span class="lineno"> 4527</span>&#160;      }</div>
<div class="line"><a name="l04528"></a><span class="lineno"> 4528</span>&#160;    }</div>
<div class="line"><a name="l04529"></a><span class="lineno"> 4529</span>&#160;   <span class="keywordtype">unsigned</span> bd_element;</div>
<div class="line"><a name="l04530"></a><span class="lineno"> 4530</span>&#160;   <span class="keywordflow">if</span>(count == 2)</div>
<div class="line"><a name="l04531"></a><span class="lineno"> 4531</span>&#160;    {</div>
<div class="line"><a name="l04532"></a><span class="lineno"> 4532</span>&#160;     bd_element = 1;</div>
<div class="line"><a name="l04533"></a><span class="lineno"> 4533</span>&#160;    }          </div>
<div class="line"><a name="l04534"></a><span class="lineno"> 4534</span>&#160;   <span class="keywordflow">else</span></div>
<div class="line"><a name="l04535"></a><span class="lineno"> 4535</span>&#160;    {</div>
<div class="line"><a name="l04536"></a><span class="lineno"> 4536</span>&#160;     bd_element = 0;           </div>
<div class="line"><a name="l04537"></a><span class="lineno"> 4537</span>&#160;    }</div>
<div class="line"><a name="l04538"></a><span class="lineno"> 4538</span>&#160;   <span class="keywordflow">return</span> bd_element;</div>
<div class="line"><a name="l04539"></a><span class="lineno"> 4539</span>&#160;   }</div>
<div class="line"><a name="l04540"></a><span class="lineno"> 4540</span>&#160; </div>
<div class="line"><a name="l04541"></a><span class="lineno"> 4541</span>&#160; <span class="comment">//=========================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l04542"></a><span class="lineno"> 4542</span>&#160;<span class="comment"> /// \short Compute the c0-shape functions and also</span></div>
<div class="line"><a name="l04543"></a><span class="lineno"> 4543</span>&#160;<span class="comment"> /// first derivatives w.r.t. global coordinates at local coordinate s;</span></div>
<div class="line"><a name="l04544"></a><span class="lineno"> 4544</span>&#160;<span class="comment"> /// Returns Jacobian of mapping from global to local coordinates.</span></div>
<div class="line"><a name="l04545"></a><span class="lineno"> 4545</span>&#160;<span class="comment"> /// Most general form of the function, but may be over-loaded, if desired</span></div>
<div class="line"><a name="l04546"></a><span class="lineno"> 4546</span>&#160;<span class="comment"></span> <span class="comment">//=========================================================================</span></div>
<div class="line"><a name="l04547"></a><span class="lineno"><a class="line" href="classoomph_1_1C1CurvedElementBase.html#a48932300808586ba1773a54a6ed768e4"> 4547</a></span>&#160; <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1C1CurvedElementBase.html#a48932300808586ba1773a54a6ed768e4">dbasis_c0_eulerian</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>, </div>
<div class="line"><a name="l04548"></a><span class="lineno"> 4548</span>&#160;                           <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;psi,</div>
<div class="line"><a name="l04549"></a><span class="lineno"> 4549</span>&#160;                           <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;dpsi)<span class="keyword"> const</span></div>
<div class="line"><a name="l04550"></a><span class="lineno"> 4550</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l04551"></a><span class="lineno"> 4551</span>&#160;   <span class="comment">//Find the element dimension</span></div>
<div class="line"><a name="l04552"></a><span class="lineno"> 4552</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> el_dim = <a class="code" href="classoomph_1_1FiniteElement.html#a5f8fe59f06da1da9f6b7bbcbdb90ef93">dim</a>();</div>
<div class="line"><a name="l04553"></a><span class="lineno"> 4553</span>&#160;   <span class="comment">//Get the values of the shape functions and their local derivatives</span></div>
<div class="line"><a name="l04554"></a><span class="lineno"> 4554</span>&#160;   <span class="comment">//Temporarily stored in dpsi</span></div>
<div class="line"><a name="l04555"></a><span class="lineno"> 4555</span>&#160;   <a class="code" href="classoomph_1_1C1CurvedElementBase.html#aea6eaf2184fb2ebe373b10e0e700caf3">dbasis_c0_local</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,psi,dpsi);</div>
<div class="line"><a name="l04556"></a><span class="lineno"> 4556</span>&#160;   </div>
<div class="line"><a name="l04557"></a><span class="lineno"> 4557</span>&#160;    <span class="comment">// assign shape functions for geometry</span></div>
<div class="line"><a name="l04558"></a><span class="lineno"> 4558</span>&#160;   <span class="keywordtype">unsigned</span> n_node = 3;</div>
<div class="line"><a name="l04559"></a><span class="lineno"> 4559</span>&#160;   <a class="code" href="classoomph_1_1Shape.html">Shape</a> psi_x(n_node);</div>
<div class="line"><a name="l04560"></a><span class="lineno"> 4560</span>&#160;   <a class="code" href="classoomph_1_1DShape.html">DShape</a> dpsi_x(n_node,2);</div>
<div class="line"><a name="l04561"></a><span class="lineno"> 4561</span>&#160;   <a class="code" href="classoomph_1_1DShape.html">DShape</a> d2psi_x(n_node,3);</div>
<div class="line"><a name="l04562"></a><span class="lineno"> 4562</span>&#160;   <a class="code" href="classoomph_1_1Shape.html">Shape</a> phi(2);</div>
<div class="line"><a name="l04563"></a><span class="lineno"> 4563</span>&#160;   <a class="code" href="classoomph_1_1DShape.html">DShape</a> dphi(2,2);</div>
<div class="line"><a name="l04564"></a><span class="lineno"> 4564</span>&#160;   <a class="code" href="classoomph_1_1DShape.html">DShape</a> d2phi(2,3);</div>
<div class="line"><a name="l04565"></a><span class="lineno"> 4565</span>&#160;   <a class="code" href="classoomph_1_1C1CurvedElementBase.html#abafd0a405e40d018020dbffe49cf7258">d2shape_local_geom</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,psi_x,dpsi_x,d2psi_x,phi,dphi,d2phi);</div>
<div class="line"><a name="l04566"></a><span class="lineno"> 4566</span>&#160;   </div>
<div class="line"><a name="l04567"></a><span class="lineno"> 4567</span>&#160;   <span class="comment">//Allocate memory for the jacobian and inverse jacobian </span></div>
<div class="line"><a name="l04568"></a><span class="lineno"> 4568</span>&#160;   <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> jacobian(el_dim), inverse_jacobian(el_dim);</div>
<div class="line"><a name="l04569"></a><span class="lineno"> 4569</span>&#160;   <span class="comment">//Calculate the jacobian and inverse jacobian</span></div>
<div class="line"><a name="l04570"></a><span class="lineno"> 4570</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">double</span> det = this-&gt;<a class="code" href="classoomph_1_1C1CurvedElementBase.html#a8152ea7e16851b419f1036911f35dbee">local_to_eulerian_mapping2</a>(dpsi_x,dphi,jacobian,inverse_jacobian);</div>
<div class="line"><a name="l04571"></a><span class="lineno"> 4571</span>&#160;   <span class="comment">//Now set the values of the derivatives to be dpsidx</span></div>
<div class="line"><a name="l04572"></a><span class="lineno"> 4572</span>&#160;   <a class="code" href="classoomph_1_1FiniteElement.html#a2c2f243c9f450c4023e5aa4246facd20">transform_derivatives</a>(inverse_jacobian,dpsi);</div>
<div class="line"><a name="l04573"></a><span class="lineno"> 4573</span>&#160;   <span class="comment">//Return the determinant of the jacobian</span></div>
<div class="line"><a name="l04574"></a><span class="lineno"> 4574</span>&#160;   <span class="keywordflow">return</span> det;</div>
<div class="line"><a name="l04575"></a><span class="lineno"> 4575</span>&#160;  }</div>
<div class="line"><a name="l04576"></a><span class="lineno"> 4576</span>&#160; </div>
<div class="line"><a name="l04577"></a><span class="lineno"> 4577</span>&#160;  <span class="comment">//=========================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l04578"></a><span class="lineno"> 4578</span>&#160;<span class="comment"> /// \short Compute the c0-shape functions and also the first and the</span></div>
<div class="line"><a name="l04579"></a><span class="lineno"> 4579</span>&#160;<span class="comment"> /// second derivatives w.r.t.global coordinates at local coordinate s;</span></div>
<div class="line"><a name="l04580"></a><span class="lineno"> 4580</span>&#160;<span class="comment"> /// Returns Jacobian of mapping from global to local coordinates.</span></div>
<div class="line"><a name="l04581"></a><span class="lineno"> 4581</span>&#160;<span class="comment"> /// Most general form of the function, but may be over-loaded, if desired</span></div>
<div class="line"><a name="l04582"></a><span class="lineno"> 4582</span>&#160;<span class="comment"></span> <span class="comment">//=========================================================================</span></div>
<div class="line"><a name="l04583"></a><span class="lineno"><a class="line" href="classoomph_1_1C1CurvedElementBase.html#ad4a034b3edc770df5b37cf8a15595fd8"> 4583</a></span>&#160; <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1C1CurvedElementBase.html#ad4a034b3edc770df5b37cf8a15595fd8">d2basis_c0_eulerian</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>, </div>
<div class="line"><a name="l04584"></a><span class="lineno"> 4584</span>&#160;                           <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;psi,</div>
<div class="line"><a name="l04585"></a><span class="lineno"> 4585</span>&#160;                           <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;dpsi,</div>
<div class="line"><a name="l04586"></a><span class="lineno"> 4586</span>&#160;                           <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;d2psi)<span class="keyword"> const</span></div>
<div class="line"><a name="l04587"></a><span class="lineno"> 4587</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l04588"></a><span class="lineno"> 4588</span>&#160;   <span class="comment">//Find the element dimension</span></div>
<div class="line"><a name="l04589"></a><span class="lineno"> 4589</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> el_dim = <a class="code" href="classoomph_1_1FiniteElement.html#a5f8fe59f06da1da9f6b7bbcbdb90ef93">dim</a>();</div>
<div class="line"><a name="l04590"></a><span class="lineno"> 4590</span>&#160;   <span class="comment">//Find the number of second derivatives required</span></div>
<div class="line"><a name="l04591"></a><span class="lineno"> 4591</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_deriv = <a class="code" href="classoomph_1_1FiniteElement.html#ad1600b17efbe61db27a4c622af1f28cf">N2deriv</a>[el_dim];</div>
<div class="line"><a name="l04592"></a><span class="lineno"> 4592</span>&#160;   <span class="comment">//Get the values of the shape function and local derivatives for unknowns</span></div>
<div class="line"><a name="l04593"></a><span class="lineno"> 4593</span>&#160;   <a class="code" href="classoomph_1_1C1CurvedElementBase.html#a72e258f980ba1f790e1ba0bc4ec6ef0a">d2basis_c0_local</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,psi,dpsi,d2psi);</div>
<div class="line"><a name="l04594"></a><span class="lineno"> 4594</span>&#160;     </div>
<div class="line"><a name="l04595"></a><span class="lineno"> 4595</span>&#160;   <span class="comment">// assign shape functions for geometry</span></div>
<div class="line"><a name="l04596"></a><span class="lineno"> 4596</span>&#160;   <span class="keywordtype">unsigned</span> n_node = 3;</div>
<div class="line"><a name="l04597"></a><span class="lineno"> 4597</span>&#160;   <a class="code" href="classoomph_1_1Shape.html">Shape</a> psi_x(n_node);</div>
<div class="line"><a name="l04598"></a><span class="lineno"> 4598</span>&#160;   <a class="code" href="classoomph_1_1DShape.html">DShape</a> dpsi_x(n_node,2);</div>
<div class="line"><a name="l04599"></a><span class="lineno"> 4599</span>&#160;   <a class="code" href="classoomph_1_1DShape.html">DShape</a> d2psi_x(n_node,3);</div>
<div class="line"><a name="l04600"></a><span class="lineno"> 4600</span>&#160;   <a class="code" href="classoomph_1_1Shape.html">Shape</a> phi(2);</div>
<div class="line"><a name="l04601"></a><span class="lineno"> 4601</span>&#160;   <a class="code" href="classoomph_1_1DShape.html">DShape</a> dphi(2,2);</div>
<div class="line"><a name="l04602"></a><span class="lineno"> 4602</span>&#160;   <a class="code" href="classoomph_1_1DShape.html">DShape</a> d2phi(2,3);</div>
<div class="line"><a name="l04603"></a><span class="lineno"> 4603</span>&#160;   <a class="code" href="classoomph_1_1C1CurvedElementBase.html#abafd0a405e40d018020dbffe49cf7258">d2shape_local_geom</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,psi_x,dpsi_x,d2psi_x,phi,dphi,d2phi);</div>
<div class="line"><a name="l04604"></a><span class="lineno"> 4604</span>&#160;   </div>
<div class="line"><a name="l04605"></a><span class="lineno"> 4605</span>&#160;   <span class="comment">//Allocate memory for the jacobian and inverse jacobian </span></div>
<div class="line"><a name="l04606"></a><span class="lineno"> 4606</span>&#160;   <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> jacobian(el_dim), inverse_jacobian(el_dim);</div>
<div class="line"><a name="l04607"></a><span class="lineno"> 4607</span>&#160;   <span class="comment">//Calculate the jacobian and inverse jacobian</span></div>
<div class="line"><a name="l04608"></a><span class="lineno"> 4608</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">double</span> det = <a class="code" href="classoomph_1_1C1CurvedElementBase.html#a8152ea7e16851b419f1036911f35dbee">local_to_eulerian_mapping2</a>(dpsi_x,dphi,jacobian,inverse_jacobian);</div>
<div class="line"><a name="l04609"></a><span class="lineno"> 4609</span>&#160;   <span class="comment">//Allocate memory for the jacobian of second derivatives</span></div>
<div class="line"><a name="l04610"></a><span class="lineno"> 4610</span>&#160;   <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> jacobian2(n_deriv,el_dim,0.0);</div>
<div class="line"><a name="l04611"></a><span class="lineno"> 4611</span>&#160;   <span class="comment">//Assemble the jacobian of second derivatives</span></div>
<div class="line"><a name="l04612"></a><span class="lineno"> 4612</span>&#160;   <a class="code" href="classoomph_1_1C1CurvedElementBase.html#a5c56b56c6c246769b0b5fd3f20253ffe">myassemble_local_to_eulerian_jacobian2</a>(d2phi,jacobian2);  </div>
<div class="line"><a name="l04613"></a><span class="lineno"> 4613</span>&#160;   <span class="comment">//Now set the value of the derivatives</span></div>
<div class="line"><a name="l04614"></a><span class="lineno"> 4614</span>&#160;   <a class="code" href="classoomph_1_1FiniteElement.html#ab2c61e830b834bbd1159c679b1c093ba">transform_second_derivatives</a>(jacobian,inverse_jacobian,jacobian2,dpsi,d2psi);</div>
<div class="line"><a name="l04615"></a><span class="lineno"> 4615</span>&#160;   <span class="comment">//Return the determinant of the jacobian</span></div>
<div class="line"><a name="l04616"></a><span class="lineno"> 4616</span>&#160;   <span class="keywordflow">return</span> det;</div>
<div class="line"><a name="l04617"></a><span class="lineno"> 4617</span>&#160;  }</div>
<div class="line"><a name="l04618"></a><span class="lineno"> 4618</span>&#160; </div>
<div class="line"><a name="l04619"></a><span class="lineno"> 4619</span>&#160; <span class="comment">//=========================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l04620"></a><span class="lineno"> 4620</span>&#160;<span class="comment"> /// \short Compute the curved-element shape functions and also</span></div>
<div class="line"><a name="l04621"></a><span class="lineno"> 4621</span>&#160;<span class="comment"> /// first derivatives w.r.t. global coordinates at local coordinate s;</span></div>
<div class="line"><a name="l04622"></a><span class="lineno"> 4622</span>&#160;<span class="comment"> /// Returns Jacobian of mapping from global to local coordinates.</span></div>
<div class="line"><a name="l04623"></a><span class="lineno"> 4623</span>&#160;<span class="comment"> /// Most general form of the function, but may be over-loaded, if desired</span></div>
<div class="line"><a name="l04624"></a><span class="lineno"> 4624</span>&#160;<span class="comment"></span> <span class="comment">//=========================================================================</span></div>
<div class="line"><a name="l04625"></a><span class="lineno"><a class="line" href="classoomph_1_1C1CurvedElementBase.html#aa13f07f1ec64a996149ab7c9e10378a0"> 4625</a></span>&#160; <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1C1CurvedElementBase.html#aa13f07f1ec64a996149ab7c9e10378a0">dbasis_eulerian_curve</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>, </div>
<div class="line"><a name="l04626"></a><span class="lineno"> 4626</span>&#160;                              <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;psi,</div>
<div class="line"><a name="l04627"></a><span class="lineno"> 4627</span>&#160;                              <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;dpsi)<span class="keyword"> const</span></div>
<div class="line"><a name="l04628"></a><span class="lineno"> 4628</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l04629"></a><span class="lineno"> 4629</span>&#160;   <span class="comment">//Find the element dimension</span></div>
<div class="line"><a name="l04630"></a><span class="lineno"> 4630</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> el_dim = <a class="code" href="classoomph_1_1FiniteElement.html#a5f8fe59f06da1da9f6b7bbcbdb90ef93">dim</a>();</div>
<div class="line"><a name="l04631"></a><span class="lineno"> 4631</span>&#160;   <span class="comment">//Get the values of the shape functions and their local derivatives</span></div>
<div class="line"><a name="l04632"></a><span class="lineno"> 4632</span>&#160;   <span class="comment">//Temporarily stored in dpsi</span></div>
<div class="line"><a name="l04633"></a><span class="lineno"> 4633</span>&#160;   <a class="code" href="classoomph_1_1C1CurvedElementBase.html#a819553bb577933323c1e9c7943d04cad">dbasis_local_curve</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,psi,dpsi);</div>
<div class="line"><a name="l04634"></a><span class="lineno"> 4634</span>&#160;   </div>
<div class="line"><a name="l04635"></a><span class="lineno"> 4635</span>&#160;    <span class="comment">// assign shape functions for geometry</span></div>
<div class="line"><a name="l04636"></a><span class="lineno"> 4636</span>&#160;   <span class="keywordtype">unsigned</span> n_node = 3;</div>
<div class="line"><a name="l04637"></a><span class="lineno"> 4637</span>&#160;   <a class="code" href="classoomph_1_1Shape.html">Shape</a> psi_x(n_node);</div>
<div class="line"><a name="l04638"></a><span class="lineno"> 4638</span>&#160;   <a class="code" href="classoomph_1_1DShape.html">DShape</a> dpsi_x(n_node,2);</div>
<div class="line"><a name="l04639"></a><span class="lineno"> 4639</span>&#160;   <a class="code" href="classoomph_1_1DShape.html">DShape</a> d2psi_x(n_node,3);</div>
<div class="line"><a name="l04640"></a><span class="lineno"> 4640</span>&#160;   <a class="code" href="classoomph_1_1Shape.html">Shape</a> phi(2);</div>
<div class="line"><a name="l04641"></a><span class="lineno"> 4641</span>&#160;   <a class="code" href="classoomph_1_1DShape.html">DShape</a> dphi(2,2);</div>
<div class="line"><a name="l04642"></a><span class="lineno"> 4642</span>&#160;   <a class="code" href="classoomph_1_1DShape.html">DShape</a> d2phi(2,3);</div>
<div class="line"><a name="l04643"></a><span class="lineno"> 4643</span>&#160;   <a class="code" href="classoomph_1_1C1CurvedElementBase.html#abafd0a405e40d018020dbffe49cf7258">d2shape_local_geom</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,psi_x,dpsi_x,d2psi_x,phi,dphi,d2phi);</div>
<div class="line"><a name="l04644"></a><span class="lineno"> 4644</span>&#160;   </div>
<div class="line"><a name="l04645"></a><span class="lineno"> 4645</span>&#160;   <span class="comment">//Allocate memory for the jacobian and inverse jacobian </span></div>
<div class="line"><a name="l04646"></a><span class="lineno"> 4646</span>&#160;   <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> jacobian(el_dim), inverse_jacobian(el_dim);</div>
<div class="line"><a name="l04647"></a><span class="lineno"> 4647</span>&#160;   <span class="comment">//Calculate the jacobian and inverse jacobian</span></div>
<div class="line"><a name="l04648"></a><span class="lineno"> 4648</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">double</span> det = this-&gt;<a class="code" href="classoomph_1_1C1CurvedElementBase.html#a8152ea7e16851b419f1036911f35dbee">local_to_eulerian_mapping2</a>(dpsi_x,dphi,jacobian,inverse_jacobian);</div>
<div class="line"><a name="l04649"></a><span class="lineno"> 4649</span>&#160;   <span class="comment">//Now set the values of the derivatives to be dpsidx</span></div>
<div class="line"><a name="l04650"></a><span class="lineno"> 4650</span>&#160;   <a class="code" href="classoomph_1_1FiniteElement.html#a2c2f243c9f450c4023e5aa4246facd20">transform_derivatives</a>(inverse_jacobian,dpsi);</div>
<div class="line"><a name="l04651"></a><span class="lineno"> 4651</span>&#160;   <span class="comment">//Return the determinant of the jacobian</span></div>
<div class="line"><a name="l04652"></a><span class="lineno"> 4652</span>&#160;   <span class="keywordflow">return</span> det;</div>
<div class="line"><a name="l04653"></a><span class="lineno"> 4653</span>&#160;  }</div>
<div class="line"><a name="l04654"></a><span class="lineno"> 4654</span>&#160; </div>
<div class="line"><a name="l04655"></a><span class="lineno"> 4655</span>&#160;  <span class="comment">//===========================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l04656"></a><span class="lineno"> 4656</span>&#160;<span class="comment">  /// \short Compute the cuved-element shape functions and also first</span></div>
<div class="line"><a name="l04657"></a><span class="lineno"> 4657</span>&#160;<span class="comment">  /// and second derivatives w.r.t. global coordinates at ipt-th integration</span></div>
<div class="line"><a name="l04658"></a><span class="lineno"> 4658</span>&#160;<span class="comment">  /// point</span></div>
<div class="line"><a name="l04659"></a><span class="lineno"> 4659</span>&#160;<span class="comment"></span>  <span class="comment">//===========================================================================</span></div>
<div class="line"><a name="l04660"></a><span class="lineno"><a class="line" href="classoomph_1_1C1CurvedElementBase.html#aca6c4b025f8368574a277266d3b9ae14"> 4660</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1C1CurvedElementBase.html#aca6c4b025f8368574a277266d3b9ae14">d2basis_eulerian_curve</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>, <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;psi, </div>
<div class="line"><a name="l04661"></a><span class="lineno"> 4661</span>&#160;                                      <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;dpsi, </div>
<div class="line"><a name="l04662"></a><span class="lineno"> 4662</span>&#160;                                      <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;d2psi)<span class="keyword"> const</span></div>
<div class="line"><a name="l04663"></a><span class="lineno"> 4663</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l04664"></a><span class="lineno"> 4664</span>&#160;   <span class="comment">//Find the element dimension</span></div>
<div class="line"><a name="l04665"></a><span class="lineno"> 4665</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> el_dim = <a class="code" href="classoomph_1_1FiniteElement.html#a5f8fe59f06da1da9f6b7bbcbdb90ef93">dim</a>();</div>
<div class="line"><a name="l04666"></a><span class="lineno"> 4666</span>&#160;   <span class="comment">//Find the number of second derivatives required</span></div>
<div class="line"><a name="l04667"></a><span class="lineno"> 4667</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_deriv = <a class="code" href="classoomph_1_1FiniteElement.html#ad1600b17efbe61db27a4c622af1f28cf">N2deriv</a>[el_dim];</div>
<div class="line"><a name="l04668"></a><span class="lineno"> 4668</span>&#160;   <span class="comment">//Get the values of the shape function and local derivatives for unknowns</span></div>
<div class="line"><a name="l04669"></a><span class="lineno"> 4669</span>&#160;   <a class="code" href="classoomph_1_1C1CurvedElementBase.html#a7bcb3462fd699a3b3f6a8336ec8ed62e">d2basis_local_curve</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,psi,dpsi,d2psi);</div>
<div class="line"><a name="l04670"></a><span class="lineno"> 4670</span>&#160;     </div>
<div class="line"><a name="l04671"></a><span class="lineno"> 4671</span>&#160;   <span class="comment">// assign shape functions for geometry</span></div>
<div class="line"><a name="l04672"></a><span class="lineno"> 4672</span>&#160;   <span class="keywordtype">unsigned</span> n_node = 3;</div>
<div class="line"><a name="l04673"></a><span class="lineno"> 4673</span>&#160;   <a class="code" href="classoomph_1_1Shape.html">Shape</a> psi_x(n_node);</div>
<div class="line"><a name="l04674"></a><span class="lineno"> 4674</span>&#160;   <a class="code" href="classoomph_1_1DShape.html">DShape</a> dpsi_x(n_node,2);</div>
<div class="line"><a name="l04675"></a><span class="lineno"> 4675</span>&#160;   <a class="code" href="classoomph_1_1DShape.html">DShape</a> d2psi_x(n_node,3);</div>
<div class="line"><a name="l04676"></a><span class="lineno"> 4676</span>&#160;   <a class="code" href="classoomph_1_1Shape.html">Shape</a> phi(2);</div>
<div class="line"><a name="l04677"></a><span class="lineno"> 4677</span>&#160;   <a class="code" href="classoomph_1_1DShape.html">DShape</a> dphi(2,2);</div>
<div class="line"><a name="l04678"></a><span class="lineno"> 4678</span>&#160;   <a class="code" href="classoomph_1_1DShape.html">DShape</a> d2phi(2,3);</div>
<div class="line"><a name="l04679"></a><span class="lineno"> 4679</span>&#160;   <a class="code" href="classoomph_1_1C1CurvedElementBase.html#abafd0a405e40d018020dbffe49cf7258">d2shape_local_geom</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,psi_x,dpsi_x,d2psi_x,phi,dphi,d2phi);</div>
<div class="line"><a name="l04680"></a><span class="lineno"> 4680</span>&#160;   </div>
<div class="line"><a name="l04681"></a><span class="lineno"> 4681</span>&#160;   <span class="comment">//Allocate memory for the jacobian and inverse jacobian </span></div>
<div class="line"><a name="l04682"></a><span class="lineno"> 4682</span>&#160;   <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> jacobian(el_dim), inverse_jacobian(el_dim);</div>
<div class="line"><a name="l04683"></a><span class="lineno"> 4683</span>&#160;   <span class="comment">//Calculate the jacobian and inverse jacobian</span></div>
<div class="line"><a name="l04684"></a><span class="lineno"> 4684</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">double</span> det = <a class="code" href="classoomph_1_1C1CurvedElementBase.html#a8152ea7e16851b419f1036911f35dbee">local_to_eulerian_mapping2</a>(dpsi_x,dphi,jacobian,inverse_jacobian);</div>
<div class="line"><a name="l04685"></a><span class="lineno"> 4685</span>&#160;   <span class="comment">//Allocate memory for the jacobian of second derivatives</span></div>
<div class="line"><a name="l04686"></a><span class="lineno"> 4686</span>&#160;   <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> jacobian2(n_deriv,el_dim,0.0);</div>
<div class="line"><a name="l04687"></a><span class="lineno"> 4687</span>&#160;   <span class="comment">//Assemble the jacobian of second derivatives</span></div>
<div class="line"><a name="l04688"></a><span class="lineno"> 4688</span>&#160;   <a class="code" href="classoomph_1_1C1CurvedElementBase.html#a5c56b56c6c246769b0b5fd3f20253ffe">myassemble_local_to_eulerian_jacobian2</a>(d2phi,jacobian2);  </div>
<div class="line"><a name="l04689"></a><span class="lineno"> 4689</span>&#160;   <span class="comment">//Now set the value of the derivatives</span></div>
<div class="line"><a name="l04690"></a><span class="lineno"> 4690</span>&#160;   <a class="code" href="classoomph_1_1FiniteElement.html#ab2c61e830b834bbd1159c679b1c093ba">transform_second_derivatives</a>(jacobian,inverse_jacobian,jacobian2,dpsi,d2psi);</div>
<div class="line"><a name="l04691"></a><span class="lineno"> 4691</span>&#160;   <span class="comment">//Return the determinant of the jacobian</span></div>
<div class="line"><a name="l04692"></a><span class="lineno"> 4692</span>&#160;   <span class="keywordflow">return</span> det;</div>
<div class="line"><a name="l04693"></a><span class="lineno"> 4693</span>&#160;  }</div>
<div class="line"><a name="l04694"></a><span class="lineno"> 4694</span>&#160; </div>
<div class="line"><a name="l04695"></a><span class="lineno"> 4695</span>&#160; <span class="comment">//=======================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l04696"></a><span class="lineno"> 4696</span>&#160;<span class="comment"> /// Return raw nodal value for nodes specified on the reference triangle</span></div>
<div class="line"><a name="l04697"></a><span class="lineno"> 4697</span>&#160;<span class="comment"></span> <span class="comment">//=======================================================================</span></div>
<div class="line"><a name="l04698"></a><span class="lineno"><a class="line" href="classoomph_1_1C1CurvedElementBase.html#ab7e659908f8da866873b8b0a46519c61"> 4698</a></span>&#160; <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1C1CurvedElementBase.html#ab7e659908f8da866873b8b0a46519c61">get_nodal_value_curve1</a>(<a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;u_value,  <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> &amp;M) </div>
<div class="line"><a name="l04699"></a><span class="lineno"> 4699</span>&#160;  {</div>
<div class="line"><a name="l04700"></a><span class="lineno"> 4700</span>&#160;   <span class="comment">// assign degrees of freedom to the reference element</span></div>
<div class="line"><a name="l04701"></a><span class="lineno"> 4701</span>&#160;   <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> <a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a51292b8e4d96f2bb9f0d6bb0340d1620">D</a>(21,21), <a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a43c804e2bcf9862a4bf629d5f01761e8">B</a>(21,36);</div>
<div class="line"><a name="l04702"></a><span class="lineno"> 4702</span>&#160;   <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> temp(21,0.0);</div>
<div class="line"><a name="l04703"></a><span class="lineno"> 4703</span>&#160;   <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> <a class="code" href="classoomph_1_1FiniteElement.html#a1d33f53e2b2813fba8a0e8b458bf2047">position</a>(3,2);</div>
<div class="line"><a name="l04704"></a><span class="lineno"> 4704</span>&#160;   <span class="keywordtype">unsigned</span> bd_element;</div>
<div class="line"><a name="l04705"></a><span class="lineno"> 4705</span>&#160;   <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> bd_position(20,2);</div>
<div class="line"><a name="l04706"></a><span class="lineno"> 4706</span>&#160;   <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> x(2);</div>
<div class="line"><a name="l04707"></a><span class="lineno"> 4707</span>&#160;   </div>
<div class="line"><a name="l04708"></a><span class="lineno"> 4708</span>&#160;   <span class="comment">// Get the nodal values of the unknown</span></div>
<div class="line"><a name="l04709"></a><span class="lineno"> 4709</span>&#160;   <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> <a class="code" href="the__data__structure_8txt.html#a3b0d20781021ec2f0e788713f8b0fec8">value</a>(21);</div>
<div class="line"><a name="l04710"></a><span class="lineno"> 4710</span>&#160;  </div>
<div class="line"><a name="l04711"></a><span class="lineno"> 4711</span>&#160;   <a class="code" href="the__data__structure_8txt.html#a3b0d20781021ec2f0e788713f8b0fec8">value</a>[0] = <a class="code" href="classoomph_1_1FiniteElement.html#abdc430bef622e0257397407416e6aac8">raw_nodal_value</a>(0,0);</div>
<div class="line"><a name="l04712"></a><span class="lineno"> 4712</span>&#160;   <a class="code" href="the__data__structure_8txt.html#a3b0d20781021ec2f0e788713f8b0fec8">value</a>[1] = <a class="code" href="classoomph_1_1FiniteElement.html#abdc430bef622e0257397407416e6aac8">raw_nodal_value</a>(1,0);</div>
<div class="line"><a name="l04713"></a><span class="lineno"> 4713</span>&#160;   <a class="code" href="the__data__structure_8txt.html#a3b0d20781021ec2f0e788713f8b0fec8">value</a>[2] = <a class="code" href="classoomph_1_1FiniteElement.html#abdc430bef622e0257397407416e6aac8">raw_nodal_value</a>(2,0);</div>
<div class="line"><a name="l04714"></a><span class="lineno"> 4714</span>&#160;   <a class="code" href="the__data__structure_8txt.html#a3b0d20781021ec2f0e788713f8b0fec8">value</a>[3] = <a class="code" href="classoomph_1_1FiniteElement.html#abdc430bef622e0257397407416e6aac8">raw_nodal_value</a>(0,1);</div>
<div class="line"><a name="l04715"></a><span class="lineno"> 4715</span>&#160;   <a class="code" href="the__data__structure_8txt.html#a3b0d20781021ec2f0e788713f8b0fec8">value</a>[4] = <a class="code" href="classoomph_1_1FiniteElement.html#abdc430bef622e0257397407416e6aac8">raw_nodal_value</a>(0,2);</div>
<div class="line"><a name="l04716"></a><span class="lineno"> 4716</span>&#160;   <a class="code" href="the__data__structure_8txt.html#a3b0d20781021ec2f0e788713f8b0fec8">value</a>[5] = <a class="code" href="classoomph_1_1FiniteElement.html#abdc430bef622e0257397407416e6aac8">raw_nodal_value</a>(1,1);</div>
<div class="line"><a name="l04717"></a><span class="lineno"> 4717</span>&#160;   <a class="code" href="the__data__structure_8txt.html#a3b0d20781021ec2f0e788713f8b0fec8">value</a>[6] = <a class="code" href="classoomph_1_1FiniteElement.html#abdc430bef622e0257397407416e6aac8">raw_nodal_value</a>(1,2);</div>
<div class="line"><a name="l04718"></a><span class="lineno"> 4718</span>&#160;   <a class="code" href="the__data__structure_8txt.html#a3b0d20781021ec2f0e788713f8b0fec8">value</a>[7] = <a class="code" href="classoomph_1_1FiniteElement.html#abdc430bef622e0257397407416e6aac8">raw_nodal_value</a>(2,1);</div>
<div class="line"><a name="l04719"></a><span class="lineno"> 4719</span>&#160;   <a class="code" href="the__data__structure_8txt.html#a3b0d20781021ec2f0e788713f8b0fec8">value</a>[8] = <a class="code" href="classoomph_1_1FiniteElement.html#abdc430bef622e0257397407416e6aac8">raw_nodal_value</a>(2,2);</div>
<div class="line"><a name="l04720"></a><span class="lineno"> 4720</span>&#160;   <a class="code" href="the__data__structure_8txt.html#a3b0d20781021ec2f0e788713f8b0fec8">value</a>[9] = <a class="code" href="classoomph_1_1FiniteElement.html#abdc430bef622e0257397407416e6aac8">raw_nodal_value</a>(0,3);</div>
<div class="line"><a name="l04721"></a><span class="lineno"> 4721</span>&#160;   <a class="code" href="the__data__structure_8txt.html#a3b0d20781021ec2f0e788713f8b0fec8">value</a>[10] = <a class="code" href="classoomph_1_1FiniteElement.html#abdc430bef622e0257397407416e6aac8">raw_nodal_value</a>(0,5);</div>
<div class="line"><a name="l04722"></a><span class="lineno"> 4722</span>&#160;   <a class="code" href="the__data__structure_8txt.html#a3b0d20781021ec2f0e788713f8b0fec8">value</a>[11] = <a class="code" href="classoomph_1_1FiniteElement.html#abdc430bef622e0257397407416e6aac8">raw_nodal_value</a>(0,4);</div>
<div class="line"><a name="l04723"></a><span class="lineno"> 4723</span>&#160;   <a class="code" href="the__data__structure_8txt.html#a3b0d20781021ec2f0e788713f8b0fec8">value</a>[12] = <a class="code" href="classoomph_1_1FiniteElement.html#abdc430bef622e0257397407416e6aac8">raw_nodal_value</a>(1,3);</div>
<div class="line"><a name="l04724"></a><span class="lineno"> 4724</span>&#160;   <a class="code" href="the__data__structure_8txt.html#a3b0d20781021ec2f0e788713f8b0fec8">value</a>[13] = <a class="code" href="classoomph_1_1FiniteElement.html#abdc430bef622e0257397407416e6aac8">raw_nodal_value</a>(1,5);</div>
<div class="line"><a name="l04725"></a><span class="lineno"> 4725</span>&#160;   <a class="code" href="the__data__structure_8txt.html#a3b0d20781021ec2f0e788713f8b0fec8">value</a>[14] = <a class="code" href="classoomph_1_1FiniteElement.html#abdc430bef622e0257397407416e6aac8">raw_nodal_value</a>(1,4);</div>
<div class="line"><a name="l04726"></a><span class="lineno"> 4726</span>&#160;   <a class="code" href="the__data__structure_8txt.html#a3b0d20781021ec2f0e788713f8b0fec8">value</a>[15] = <a class="code" href="classoomph_1_1FiniteElement.html#abdc430bef622e0257397407416e6aac8">raw_nodal_value</a>(2,3);</div>
<div class="line"><a name="l04727"></a><span class="lineno"> 4727</span>&#160;   <a class="code" href="the__data__structure_8txt.html#a3b0d20781021ec2f0e788713f8b0fec8">value</a>[16] = <a class="code" href="classoomph_1_1FiniteElement.html#abdc430bef622e0257397407416e6aac8">raw_nodal_value</a>(2,5);</div>
<div class="line"><a name="l04728"></a><span class="lineno"> 4728</span>&#160;   <a class="code" href="the__data__structure_8txt.html#a3b0d20781021ec2f0e788713f8b0fec8">value</a>[17] = <a class="code" href="classoomph_1_1FiniteElement.html#abdc430bef622e0257397407416e6aac8">raw_nodal_value</a>(2,4); </div>
<div class="line"><a name="l04729"></a><span class="lineno"> 4729</span>&#160;   <a class="code" href="the__data__structure_8txt.html#a3b0d20781021ec2f0e788713f8b0fec8">value</a>[18] = <a class="code" href="classoomph_1_1FiniteElement.html#abdc430bef622e0257397407416e6aac8">raw_nodal_value</a>(3,0);</div>
<div class="line"><a name="l04730"></a><span class="lineno"> 4730</span>&#160;   <a class="code" href="the__data__structure_8txt.html#a3b0d20781021ec2f0e788713f8b0fec8">value</a>[19] = <a class="code" href="classoomph_1_1FiniteElement.html#abdc430bef622e0257397407416e6aac8">raw_nodal_value</a>(4,0);</div>
<div class="line"><a name="l04731"></a><span class="lineno"> 4731</span>&#160;   <a class="code" href="the__data__structure_8txt.html#a3b0d20781021ec2f0e788713f8b0fec8">value</a>[20] = <a class="code" href="classoomph_1_1FiniteElement.html#abdc430bef622e0257397407416e6aac8">raw_nodal_value</a>(5,0);</div>
<div class="line"><a name="l04732"></a><span class="lineno"> 4732</span>&#160;  </div>
<div class="line"><a name="l04733"></a><span class="lineno"> 4733</span>&#160;   <span class="comment">// Transformation metrix associating nodal values between the reference </span></div>
<div class="line"><a name="l04734"></a><span class="lineno"> 4734</span>&#160;   <span class="comment">// and the physical curved triangle</span></div>
<div class="line"><a name="l04735"></a><span class="lineno"> 4735</span>&#160;   <a class="code" href="classoomph_1_1C1CurvedElementBase.html#a4735f6f63d4e545608bf485c7168e251">get_value_transform_matrix</a>(<a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a51292b8e4d96f2bb9f0d6bb0340d1620">D</a>,<a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a43c804e2bcf9862a4bf629d5f01761e8">B</a>,<a class="code" href="classoomph_1_1FiniteElement.html#a1d33f53e2b2813fba8a0e8b458bf2047">position</a>,bd_element,bd_position,x);</div>
<div class="line"><a name="l04736"></a><span class="lineno"> 4736</span>&#160;   </div>
<div class="line"><a name="l04737"></a><span class="lineno"> 4737</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;21;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l04738"></a><span class="lineno"> 4738</span>&#160;    {</div>
<div class="line"><a name="l04739"></a><span class="lineno"> 4739</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> j=0;j&lt;36;j++)</div>
<div class="line"><a name="l04740"></a><span class="lineno"> 4740</span>&#160;      {</div>
<div class="line"><a name="l04741"></a><span class="lineno"> 4741</span>&#160;       <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> k=0;k&lt;21;k++)</div>
<div class="line"><a name="l04742"></a><span class="lineno"> 4742</span>&#160;        {</div>
<div class="line"><a name="l04743"></a><span class="lineno"> 4743</span>&#160;         M(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>,j) += <a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a51292b8e4d96f2bb9f0d6bb0340d1620">D</a>(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>,k)*<a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a43c804e2bcf9862a4bf629d5f01761e8">B</a>(k,j);</div>
<div class="line"><a name="l04744"></a><span class="lineno"> 4744</span>&#160;        }</div>
<div class="line"><a name="l04745"></a><span class="lineno"> 4745</span>&#160;      }</div>
<div class="line"><a name="l04746"></a><span class="lineno"> 4746</span>&#160;    }</div>
<div class="line"><a name="l04747"></a><span class="lineno"> 4747</span>&#160; </div>
<div class="line"><a name="l04748"></a><span class="lineno"> 4748</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;21;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l04749"></a><span class="lineno"> 4749</span>&#160;    {</div>
<div class="line"><a name="l04750"></a><span class="lineno"> 4750</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> j=0;j&lt;21;j++)</div>
<div class="line"><a name="l04751"></a><span class="lineno"> 4751</span>&#160;      {</div>
<div class="line"><a name="l04752"></a><span class="lineno"> 4752</span>&#160;       <span class="comment">// get values wrt local coordinates</span></div>
<div class="line"><a name="l04753"></a><span class="lineno"> 4753</span>&#160;       temp[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] += <a class="code" href="the__data__structure_8txt.html#a3b0d20781021ec2f0e788713f8b0fec8">value</a>[j]*<a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a51292b8e4d96f2bb9f0d6bb0340d1620">D</a>(j,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>);</div>
<div class="line"><a name="l04754"></a><span class="lineno"> 4754</span>&#160;      }</div>
<div class="line"><a name="l04755"></a><span class="lineno"> 4755</span>&#160;    }</div>
<div class="line"><a name="l04756"></a><span class="lineno"> 4756</span>&#160;   </div>
<div class="line"><a name="l04757"></a><span class="lineno"> 4757</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;36;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l04758"></a><span class="lineno"> 4758</span>&#160;    {</div>
<div class="line"><a name="l04759"></a><span class="lineno"> 4759</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> j=0;j&lt;21;j++)</div>
<div class="line"><a name="l04760"></a><span class="lineno"> 4760</span>&#160;      {</div>
<div class="line"><a name="l04761"></a><span class="lineno"> 4761</span>&#160;       u_value[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] += temp[j]*<a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a43c804e2bcf9862a4bf629d5f01761e8">B</a>(j,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>);</div>
<div class="line"><a name="l04762"></a><span class="lineno"> 4762</span>&#160;      }</div>
<div class="line"><a name="l04763"></a><span class="lineno"> 4763</span>&#160;    }</div>
<div class="line"><a name="l04764"></a><span class="lineno"> 4764</span>&#160;  }</div>
<div class="line"><a name="l04765"></a><span class="lineno"> 4765</span>&#160; </div>
<div class="line"><a name="l04766"></a><span class="lineno"> 4766</span>&#160; <span class="comment">//=======================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l04767"></a><span class="lineno"> 4767</span>&#160;<span class="comment"> /// Return raw nodal equations for nodes specified on the curved triangle</span></div>
<div class="line"><a name="l04768"></a><span class="lineno"> 4768</span>&#160;<span class="comment"> ///  This function will be employed for the post-permutation as</span></div>
<div class="line"><a name="l04769"></a><span class="lineno"> 4769</span>&#160;<span class="comment"> /// the nodal values defined on the element doesn&#39;t match with the defined </span></div>
<div class="line"><a name="l04770"></a><span class="lineno"> 4770</span>&#160;<span class="comment"> /// shape functions</span></div>
<div class="line"><a name="l04771"></a><span class="lineno"> 4771</span>&#160;<span class="comment"></span> <span class="comment">//=======================================================================</span></div>
<div class="line"><a name="l04772"></a><span class="lineno"><a class="line" href="classoomph_1_1C1CurvedElementBase.html#aee42a8d77efc26f00b8d13337f9fb4f4"> 4772</a></span>&#160; <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1C1CurvedElementBase.html#aee42a8d77efc26f00b8d13337f9fb4f4">get_nodal_eqn_curve</a>(<a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;int&gt;</a> &amp;nodal_eqn) </div>
<div class="line"><a name="l04773"></a><span class="lineno"> 4773</span>&#160;  {</div>
<div class="line"><a name="l04774"></a><span class="lineno"> 4774</span>&#160;   <span class="comment">// assign degrees of freedom to the reference element</span></div>
<div class="line"><a name="l04775"></a><span class="lineno"> 4775</span>&#160;   <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> <a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a51292b8e4d96f2bb9f0d6bb0340d1620">D</a>(21,21), <a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a43c804e2bcf9862a4bf629d5f01761e8">B</a>(21,36);</div>
<div class="line"><a name="l04776"></a><span class="lineno"> 4776</span>&#160;   <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> <a class="code" href="classoomph_1_1FiniteElement.html#a1d33f53e2b2813fba8a0e8b458bf2047">position</a>(3,2);</div>
<div class="line"><a name="l04777"></a><span class="lineno"> 4777</span>&#160;   <span class="keywordtype">unsigned</span> bd_element;</div>
<div class="line"><a name="l04778"></a><span class="lineno"> 4778</span>&#160;   <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> bd_position(20,2);</div>
<div class="line"><a name="l04779"></a><span class="lineno"> 4779</span>&#160;   <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> x(2);</div>
<div class="line"><a name="l04780"></a><span class="lineno"> 4780</span>&#160;   <span class="keywordtype">unsigned</span> n_position_type = 6;</div>
<div class="line"><a name="l04781"></a><span class="lineno"> 4781</span>&#160;   </div>
<div class="line"><a name="l04782"></a><span class="lineno"> 4782</span>&#160;   <span class="comment">// Get nodal values at nodes on the reference element</span></div>
<div class="line"><a name="l04783"></a><span class="lineno"> 4783</span>&#160;   <a class="code" href="classoomph_1_1C1CurvedElementBase.html#a4735f6f63d4e545608bf485c7168e251">get_value_transform_matrix</a>(<a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a51292b8e4d96f2bb9f0d6bb0340d1620">D</a>,<a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a43c804e2bcf9862a4bf629d5f01761e8">B</a>,<a class="code" href="classoomph_1_1FiniteElement.html#a1d33f53e2b2813fba8a0e8b458bf2047">position</a>,bd_element,bd_position,x);</div>
<div class="line"><a name="l04784"></a><span class="lineno"> 4784</span>&#160;   </div>
<div class="line"><a name="l04785"></a><span class="lineno"> 4785</span>&#160;   <span class="keywordtype">double</span> angle_1 = atan(bd_position(0,1)/bd_position(0,0));</div>
<div class="line"><a name="l04786"></a><span class="lineno"> 4786</span>&#160;   <span class="keywordtype">double</span> angle_2 = atan(bd_position(1,1)/bd_position(1,0));</div>
<div class="line"><a name="l04787"></a><span class="lineno"> 4787</span>&#160;   <span class="keywordflow">if</span>(angle_1 &gt; angle_2)</div>
<div class="line"><a name="l04788"></a><span class="lineno"> 4788</span>&#160;    {</div>
<div class="line"><a name="l04789"></a><span class="lineno"> 4789</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> k=0;k&lt;n_position_type;k++)</div>
<div class="line"><a name="l04790"></a><span class="lineno"> 4790</span>&#160;      {</div>
<div class="line"><a name="l04791"></a><span class="lineno"> 4791</span>&#160;       <span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a> = 2+k;</div>
<div class="line"><a name="l04792"></a><span class="lineno"> 4792</span>&#160;       nodal_eqn(0,k) = <a class="code" href="classoomph_1_1FiniteElement.html#a5da80bbed97543e586f698251d67941d">nodal_local_eqn</a>(2,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>);</div>
<div class="line"><a name="l04793"></a><span class="lineno"> 4793</span>&#160;       nodal_eqn(1,k) = <a class="code" href="classoomph_1_1FiniteElement.html#a5da80bbed97543e586f698251d67941d">nodal_local_eqn</a>(0,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>);</div>
<div class="line"><a name="l04794"></a><span class="lineno"> 4794</span>&#160;       nodal_eqn(2,k) = <a class="code" href="classoomph_1_1FiniteElement.html#a5da80bbed97543e586f698251d67941d">nodal_local_eqn</a>(1,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>);</div>
<div class="line"><a name="l04795"></a><span class="lineno"> 4795</span>&#160;       nodal_eqn(3,k) = <a class="code" href="classoomph_1_1FiniteElement.html#a5da80bbed97543e586f698251d67941d">nodal_local_eqn</a>(5,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>);</div>
<div class="line"><a name="l04796"></a><span class="lineno"> 4796</span>&#160;       nodal_eqn(4,k) = <a class="code" href="classoomph_1_1FiniteElement.html#a5da80bbed97543e586f698251d67941d">nodal_local_eqn</a>(3,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>);</div>
<div class="line"><a name="l04797"></a><span class="lineno"> 4797</span>&#160;       nodal_eqn(5,k) = <a class="code" href="classoomph_1_1FiniteElement.html#a5da80bbed97543e586f698251d67941d">nodal_local_eqn</a>(4,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>);</div>
<div class="line"><a name="l04798"></a><span class="lineno"> 4798</span>&#160;       nodal_eqn(<a class="code" href="classoomph_1_1FiniteElement.html#a6219ed269a6d89b5aa14659cce48905a">nnode</a>()-3,k) = <a class="code" href="classoomph_1_1FiniteElement.html#a5da80bbed97543e586f698251d67941d">nodal_local_eqn</a>(<a class="code" href="classoomph_1_1FiniteElement.html#a6219ed269a6d89b5aa14659cce48905a">nnode</a>()-3,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>);</div>
<div class="line"><a name="l04799"></a><span class="lineno"> 4799</span>&#160;       nodal_eqn(<a class="code" href="classoomph_1_1FiniteElement.html#a6219ed269a6d89b5aa14659cce48905a">nnode</a>()-2,k) = <a class="code" href="classoomph_1_1FiniteElement.html#a5da80bbed97543e586f698251d67941d">nodal_local_eqn</a>(<a class="code" href="classoomph_1_1FiniteElement.html#a6219ed269a6d89b5aa14659cce48905a">nnode</a>()-2,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>);</div>
<div class="line"><a name="l04800"></a><span class="lineno"> 4800</span>&#160;       nodal_eqn(<a class="code" href="classoomph_1_1FiniteElement.html#a6219ed269a6d89b5aa14659cce48905a">nnode</a>()-1,k) = <a class="code" href="classoomph_1_1FiniteElement.html#a5da80bbed97543e586f698251d67941d">nodal_local_eqn</a>(<a class="code" href="classoomph_1_1FiniteElement.html#a6219ed269a6d89b5aa14659cce48905a">nnode</a>()-1,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>);</div>
<div class="line"><a name="l04801"></a><span class="lineno"> 4801</span>&#160;      }</div>
<div class="line"><a name="l04802"></a><span class="lineno"> 4802</span>&#160;    }</div>
<div class="line"><a name="l04803"></a><span class="lineno"> 4803</span>&#160;   <span class="keywordflow">else</span> <span class="keywordflow">if</span>(angle_1 &lt; angle_2)</div>
<div class="line"><a name="l04804"></a><span class="lineno"> 4804</span>&#160;    {</div>
<div class="line"><a name="l04805"></a><span class="lineno"> 4805</span>&#160;     <span class="keywordflow">if</span>(<a class="code" href="classoomph_1_1FiniteElement.html#a1d33f53e2b2813fba8a0e8b458bf2047">position</a>(0,0)==bd_position(0,0) &amp;&amp; <a class="code" href="classoomph_1_1FiniteElement.html#a1d33f53e2b2813fba8a0e8b458bf2047">position</a>(0,1)==bd_position(0,1))</div>
<div class="line"><a name="l04806"></a><span class="lineno"> 4806</span>&#160;      {</div>
<div class="line"><a name="l04807"></a><span class="lineno"> 4807</span>&#160;       <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> k=0;k&lt;n_position_type;k++)</div>
<div class="line"><a name="l04808"></a><span class="lineno"> 4808</span>&#160;        {</div>
<div class="line"><a name="l04809"></a><span class="lineno"> 4809</span>&#160;         nodal_eqn(0,k) = <a class="code" href="classoomph_1_1FiniteElement.html#a5da80bbed97543e586f698251d67941d">nodal_local_eqn</a>(0,2+k);</div>
<div class="line"><a name="l04810"></a><span class="lineno"> 4810</span>&#160;         nodal_eqn(1,k) = <a class="code" href="classoomph_1_1FiniteElement.html#a5da80bbed97543e586f698251d67941d">nodal_local_eqn</a>(1,2+k);</div>
<div class="line"><a name="l04811"></a><span class="lineno"> 4811</span>&#160;         nodal_eqn(2,k) = <a class="code" href="classoomph_1_1FiniteElement.html#a5da80bbed97543e586f698251d67941d">nodal_local_eqn</a>(2,2+k);</div>
<div class="line"><a name="l04812"></a><span class="lineno"> 4812</span>&#160;         nodal_eqn(3,k) = <a class="code" href="classoomph_1_1FiniteElement.html#a5da80bbed97543e586f698251d67941d">nodal_local_eqn</a>(3,2+k);</div>
<div class="line"><a name="l04813"></a><span class="lineno"> 4813</span>&#160;         nodal_eqn(4,k) = <a class="code" href="classoomph_1_1FiniteElement.html#a5da80bbed97543e586f698251d67941d">nodal_local_eqn</a>(4,2+k);</div>
<div class="line"><a name="l04814"></a><span class="lineno"> 4814</span>&#160;         nodal_eqn(5,k) = <a class="code" href="classoomph_1_1FiniteElement.html#a5da80bbed97543e586f698251d67941d">nodal_local_eqn</a>(5,2+k);</div>
<div class="line"><a name="l04815"></a><span class="lineno"> 4815</span>&#160;         nodal_eqn(<a class="code" href="classoomph_1_1FiniteElement.html#a6219ed269a6d89b5aa14659cce48905a">nnode</a>()-3,k) = <a class="code" href="classoomph_1_1FiniteElement.html#a5da80bbed97543e586f698251d67941d">nodal_local_eqn</a>(<a class="code" href="classoomph_1_1FiniteElement.html#a6219ed269a6d89b5aa14659cce48905a">nnode</a>()-2,2+k);</div>
<div class="line"><a name="l04816"></a><span class="lineno"> 4816</span>&#160;         nodal_eqn(<a class="code" href="classoomph_1_1FiniteElement.html#a6219ed269a6d89b5aa14659cce48905a">nnode</a>()-2,k) = <a class="code" href="classoomph_1_1FiniteElement.html#a5da80bbed97543e586f698251d67941d">nodal_local_eqn</a>(<a class="code" href="classoomph_1_1FiniteElement.html#a6219ed269a6d89b5aa14659cce48905a">nnode</a>()-1,2+k);</div>
<div class="line"><a name="l04817"></a><span class="lineno"> 4817</span>&#160;         nodal_eqn(<a class="code" href="classoomph_1_1FiniteElement.html#a6219ed269a6d89b5aa14659cce48905a">nnode</a>()-1,k) = <a class="code" href="classoomph_1_1FiniteElement.html#a5da80bbed97543e586f698251d67941d">nodal_local_eqn</a>(<a class="code" href="classoomph_1_1FiniteElement.html#a6219ed269a6d89b5aa14659cce48905a">nnode</a>()-3,2+k);</div>
<div class="line"><a name="l04818"></a><span class="lineno"> 4818</span>&#160;        }</div>
<div class="line"><a name="l04819"></a><span class="lineno"> 4819</span>&#160;      }</div>
<div class="line"><a name="l04820"></a><span class="lineno"> 4820</span>&#160;     <span class="keywordflow">else</span> </div>
<div class="line"><a name="l04821"></a><span class="lineno"> 4821</span>&#160;      {</div>
<div class="line"><a name="l04822"></a><span class="lineno"> 4822</span>&#160;       <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> k=0;k&lt;n_position_type;k++)</div>
<div class="line"><a name="l04823"></a><span class="lineno"> 4823</span>&#160;        {</div>
<div class="line"><a name="l04824"></a><span class="lineno"> 4824</span>&#160;         nodal_eqn(0,k) = <a class="code" href="classoomph_1_1FiniteElement.html#a5da80bbed97543e586f698251d67941d">nodal_local_eqn</a>(1,2+k);</div>
<div class="line"><a name="l04825"></a><span class="lineno"> 4825</span>&#160;         nodal_eqn(1,k) = <a class="code" href="classoomph_1_1FiniteElement.html#a5da80bbed97543e586f698251d67941d">nodal_local_eqn</a>(2,2+k);</div>
<div class="line"><a name="l04826"></a><span class="lineno"> 4826</span>&#160;         nodal_eqn(2,k) = <a class="code" href="classoomph_1_1FiniteElement.html#a5da80bbed97543e586f698251d67941d">nodal_local_eqn</a>(0,2+k);</div>
<div class="line"><a name="l04827"></a><span class="lineno"> 4827</span>&#160;         nodal_eqn(3,k) = <a class="code" href="classoomph_1_1FiniteElement.html#a5da80bbed97543e586f698251d67941d">nodal_local_eqn</a>(4,2+k);</div>
<div class="line"><a name="l04828"></a><span class="lineno"> 4828</span>&#160;         nodal_eqn(4,k) = <a class="code" href="classoomph_1_1FiniteElement.html#a5da80bbed97543e586f698251d67941d">nodal_local_eqn</a>(5,2+k);</div>
<div class="line"><a name="l04829"></a><span class="lineno"> 4829</span>&#160;         nodal_eqn(5,k) = <a class="code" href="classoomph_1_1FiniteElement.html#a5da80bbed97543e586f698251d67941d">nodal_local_eqn</a>(3,2+k);</div>
<div class="line"><a name="l04830"></a><span class="lineno"> 4830</span>&#160;         nodal_eqn(<a class="code" href="classoomph_1_1FiniteElement.html#a6219ed269a6d89b5aa14659cce48905a">nnode</a>()-3,k) = <a class="code" href="classoomph_1_1FiniteElement.html#a5da80bbed97543e586f698251d67941d">nodal_local_eqn</a>(<a class="code" href="classoomph_1_1FiniteElement.html#a6219ed269a6d89b5aa14659cce48905a">nnode</a>()-1,2+k);</div>
<div class="line"><a name="l04831"></a><span class="lineno"> 4831</span>&#160;         nodal_eqn(<a class="code" href="classoomph_1_1FiniteElement.html#a6219ed269a6d89b5aa14659cce48905a">nnode</a>()-2,k) = <a class="code" href="classoomph_1_1FiniteElement.html#a5da80bbed97543e586f698251d67941d">nodal_local_eqn</a>(<a class="code" href="classoomph_1_1FiniteElement.html#a6219ed269a6d89b5aa14659cce48905a">nnode</a>()-3,2+k);</div>
<div class="line"><a name="l04832"></a><span class="lineno"> 4832</span>&#160;         nodal_eqn(<a class="code" href="classoomph_1_1FiniteElement.html#a6219ed269a6d89b5aa14659cce48905a">nnode</a>()-1,k) = <a class="code" href="classoomph_1_1FiniteElement.html#a5da80bbed97543e586f698251d67941d">nodal_local_eqn</a>(<a class="code" href="classoomph_1_1FiniteElement.html#a6219ed269a6d89b5aa14659cce48905a">nnode</a>()-2,2+k);</div>
<div class="line"><a name="l04833"></a><span class="lineno"> 4833</span>&#160;        }</div>
<div class="line"><a name="l04834"></a><span class="lineno"> 4834</span>&#160;      }</div>
<div class="line"><a name="l04835"></a><span class="lineno"> 4835</span>&#160;    }</div>
<div class="line"><a name="l04836"></a><span class="lineno"> 4836</span>&#160;  }</div>
<div class="line"><a name="l04837"></a><span class="lineno"> 4837</span>&#160; </div>
<div class="line"><a name="l04838"></a><span class="lineno"> 4838</span>&#160; <span class="comment">//=======================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l04839"></a><span class="lineno"> 4839</span>&#160;<span class="comment"> /// Return FE interpolated value u[] at local coordinate s as Vector</span></div>
<div class="line"><a name="l04840"></a><span class="lineno"> 4840</span>&#160;<span class="comment"> /// using Bell interpolations for the straight-edges triangle</span></div>
<div class="line"><a name="l04841"></a><span class="lineno"> 4841</span>&#160;<span class="comment"> /// using C1-curved interpolations for the curve-edges triangle</span></div>
<div class="line"><a name="l04842"></a><span class="lineno"> 4842</span>&#160;<span class="comment"></span> <span class="comment">// This one is for the pre-permutation</span></div>
<div class="line"><a name="l04843"></a><span class="lineno"> 4843</span>&#160; <span class="comment">//=======================================================================</span></div>
<div class="line"><a name="l04844"></a><span class="lineno"><a class="line" href="classoomph_1_1C1CurvedElementBase.html#a909d924bec591390020dbcfe5c0d3e0e"> 4844</a></span>&#160; <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1C1CurvedElementBase.html#a909d924bec591390020dbcfe5c0d3e0e">my_interpolated_u_normal1</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>, <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;<a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>, <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> &amp;interpolated_dudxi, <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> &amp;interpolated_d2udxi, <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> &amp;M) </div>
<div class="line"><a name="l04845"></a><span class="lineno"> 4845</span>&#160;  {</div>
<div class="line"><a name="l04846"></a><span class="lineno"> 4846</span>&#160;   <span class="comment">// To check whether this element is on the boundary</span></div>
<div class="line"><a name="l04847"></a><span class="lineno"> 4847</span>&#160;   <span class="keywordtype">unsigned</span> bd_element = <a class="code" href="classoomph_1_1C1CurvedElementBase.html#a819873b0790335875e6c009d63615464">is_boundary_element</a>();</div>
<div class="line"><a name="l04848"></a><span class="lineno"> 4848</span>&#160;   <span class="comment">//Find the number of positional types</span></div>
<div class="line"><a name="l04849"></a><span class="lineno"> 4849</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_position_type = <a class="code" href="classoomph_1_1FiniteElement.html#a36f4cb7569a545a9d93b66e6ee03cc91">nnodal_position_type</a>();</div>
<div class="line"><a name="l04850"></a><span class="lineno"> 4850</span>&#160;   <span class="keywordflow">if</span>(bd_element==0)</div>
<div class="line"><a name="l04851"></a><span class="lineno"> 4851</span>&#160;    {</div>
<div class="line"><a name="l04852"></a><span class="lineno"> 4852</span>&#160;     <span class="comment">//Assign storage for the local shape function</span></div>
<div class="line"><a name="l04853"></a><span class="lineno"> 4853</span>&#160;     <a class="code" href="classoomph_1_1Shape.html">Shape</a> psi(3,6);</div>
<div class="line"><a name="l04854"></a><span class="lineno"> 4854</span>&#160;     <a class="code" href="classoomph_1_1DShape.html">DShape</a> dpsi(3,6,2), d2psi(3,6,3);</div>
<div class="line"><a name="l04855"></a><span class="lineno"> 4855</span>&#160;     </div>
<div class="line"><a name="l04856"></a><span class="lineno"> 4856</span>&#160;     <span class="comment">//Assign shape functions and their derivatives</span></div>
<div class="line"><a name="l04857"></a><span class="lineno"> 4857</span>&#160;     <a class="code" href="classoomph_1_1C1CurvedElementBase.html#a5d919ef0eef6ae6477642b3dcd1196df">d2basis_local_straight</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,psi,dpsi,d2psi);</div>
<div class="line"><a name="l04858"></a><span class="lineno"> 4858</span>&#160;     </div>
<div class="line"><a name="l04859"></a><span class="lineno"> 4859</span>&#160;     <span class="comment">// Loop over nodes</span></div>
<div class="line"><a name="l04860"></a><span class="lineno"> 4860</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l=0;l&lt;3;l++) </div>
<div class="line"><a name="l04861"></a><span class="lineno"> 4861</span>&#160;      {</div>
<div class="line"><a name="l04862"></a><span class="lineno"> 4862</span>&#160;       <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> k=0;k&lt;n_position_type;k++)</div>
<div class="line"><a name="l04863"></a><span class="lineno"> 4863</span>&#160;        {</div>
<div class="line"><a name="l04864"></a><span class="lineno"> 4864</span>&#160;         <span class="comment">//Get the nodal value of the unknown</span></div>
<div class="line"><a name="l04865"></a><span class="lineno"> 4865</span>&#160;         <span class="keywordtype">double</span> u_val = <a class="code" href="classoomph_1_1FiniteElement.html#abdc430bef622e0257397407416e6aac8">raw_nodal_value</a>(l,k);</div>
<div class="line"><a name="l04866"></a><span class="lineno"> 4866</span>&#160;         <a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>[0] += u_val*psi(l,k);</div>
<div class="line"><a name="l04867"></a><span class="lineno"> 4867</span>&#160;         </div>
<div class="line"><a name="l04868"></a><span class="lineno"> 4868</span>&#160;         <span class="comment">// Loop over directions</span></div>
<div class="line"><a name="l04869"></a><span class="lineno"> 4869</span>&#160;         <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> j=0;j&lt;2;j++)</div>
<div class="line"><a name="l04870"></a><span class="lineno"> 4870</span>&#160;          {</div>
<div class="line"><a name="l04871"></a><span class="lineno"> 4871</span>&#160;           interpolated_dudxi(0,j) += u_val*dpsi(l,k,j);</div>
<div class="line"><a name="l04872"></a><span class="lineno"> 4872</span>&#160;          }</div>
<div class="line"><a name="l04873"></a><span class="lineno"> 4873</span>&#160;         <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> j=0;j&lt;3;j++)</div>
<div class="line"><a name="l04874"></a><span class="lineno"> 4874</span>&#160;          {</div>
<div class="line"><a name="l04875"></a><span class="lineno"> 4875</span>&#160;           interpolated_d2udxi(0,j) += u_val*d2psi(l,k,j);</div>
<div class="line"><a name="l04876"></a><span class="lineno"> 4876</span>&#160;          }</div>
<div class="line"><a name="l04877"></a><span class="lineno"> 4877</span>&#160;        }</div>
<div class="line"><a name="l04878"></a><span class="lineno"> 4878</span>&#160;      }</div>
<div class="line"><a name="l04879"></a><span class="lineno"> 4879</span>&#160;    }  </div>
<div class="line"><a name="l04880"></a><span class="lineno"> 4880</span>&#160;   <span class="comment">// if it is the boundary element</span></div>
<div class="line"><a name="l04881"></a><span class="lineno"> 4881</span>&#160;   <span class="keywordflow">else</span> <span class="keywordflow">if</span>(bd_element==1)</div>
<div class="line"><a name="l04882"></a><span class="lineno"> 4882</span>&#160;    {  </div>
<div class="line"><a name="l04883"></a><span class="lineno"> 4883</span>&#160;     <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> u_value(36,0.0);</div>
<div class="line"><a name="l04884"></a><span class="lineno"> 4884</span>&#160;     <span class="comment">// Get nodal values at nodes on the reference element</span></div>
<div class="line"><a name="l04885"></a><span class="lineno"> 4885</span>&#160;     <a class="code" href="classoomph_1_1C1CurvedElementBase.html#ab7e659908f8da866873b8b0a46519c61">get_nodal_value_curve1</a>(u_value,M);</div>
<div class="line"><a name="l04886"></a><span class="lineno"> 4886</span>&#160; </div>
<div class="line"><a name="l04887"></a><span class="lineno"> 4887</span>&#160;     <span class="comment">// Assign storage for the local shape functio to a curved element</span></div>
<div class="line"><a name="l04888"></a><span class="lineno"> 4888</span>&#160;     <a class="code" href="classoomph_1_1Shape.html">Shape</a> psi_curve(36),basis(36);</div>
<div class="line"><a name="l04889"></a><span class="lineno"> 4889</span>&#160;     <a class="code" href="classoomph_1_1DShape.html">DShape</a> dpsi_curve(36,2), d2psi_curve(36,3), dbasis(36,2), d2basis(36,3);</div>
<div class="line"><a name="l04890"></a><span class="lineno"> 4890</span>&#160; </div>
<div class="line"><a name="l04891"></a><span class="lineno"> 4891</span>&#160;     <span class="comment">// derivative have to be wrt global coor.</span></div>
<div class="line"><a name="l04892"></a><span class="lineno"> 4892</span>&#160;     <a class="code" href="classoomph_1_1C1CurvedElementBase.html#aca6c4b025f8368574a277266d3b9ae14">d2basis_eulerian_curve</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,psi_curve,dpsi_curve,d2psi_curve); </div>
<div class="line"><a name="l04893"></a><span class="lineno"> 4893</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;36;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++) </div>
<div class="line"><a name="l04894"></a><span class="lineno"> 4894</span>&#160;      {</div>
<div class="line"><a name="l04895"></a><span class="lineno"> 4895</span>&#160;       <a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>[0] += u_value[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]*psi_curve[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>];</div>
<div class="line"><a name="l04896"></a><span class="lineno"> 4896</span>&#160;       <span class="comment">// Loop over directions</span></div>
<div class="line"><a name="l04897"></a><span class="lineno"> 4897</span>&#160;       <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> j=0;j&lt;2;j++)</div>
<div class="line"><a name="l04898"></a><span class="lineno"> 4898</span>&#160;        {</div>
<div class="line"><a name="l04899"></a><span class="lineno"> 4899</span>&#160;         interpolated_dudxi(0,j) += u_value[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]*dpsi_curve(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>,j);</div>
<div class="line"><a name="l04900"></a><span class="lineno"> 4900</span>&#160;        }</div>
<div class="line"><a name="l04901"></a><span class="lineno"> 4901</span>&#160;       <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> j=0;j&lt;3;j++)</div>
<div class="line"><a name="l04902"></a><span class="lineno"> 4902</span>&#160;        {</div>
<div class="line"><a name="l04903"></a><span class="lineno"> 4903</span>&#160;         interpolated_d2udxi(0,j) += u_value[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]*d2psi_curve(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>,j);</div>
<div class="line"><a name="l04904"></a><span class="lineno"> 4904</span>&#160;        }</div>
<div class="line"><a name="l04905"></a><span class="lineno"> 4905</span>&#160;      }</div>
<div class="line"><a name="l04906"></a><span class="lineno"> 4906</span>&#160;    }</div>
<div class="line"><a name="l04907"></a><span class="lineno"> 4907</span>&#160;  }</div>
<div class="line"><a name="l04908"></a><span class="lineno"> 4908</span>&#160; </div>
<div class="line"><a name="l04909"></a><span class="lineno"> 4909</span>&#160; <span class="comment">//=======================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l04910"></a><span class="lineno"> 4910</span>&#160;<span class="comment"> /// Return FE interpolated value u[] at local coordinate s as Vector</span></div>
<div class="line"><a name="l04911"></a><span class="lineno"> 4911</span>&#160;<span class="comment"> /// using Bell interpolations for the straight-edges triangle</span></div>
<div class="line"><a name="l04912"></a><span class="lineno"> 4912</span>&#160;<span class="comment"> /// using C1-curved interpolations for the curve-edges triangle</span></div>
<div class="line"><a name="l04913"></a><span class="lineno"> 4913</span>&#160;<span class="comment"></span> <span class="comment">// This one is for post-permutation</span></div>
<div class="line"><a name="l04914"></a><span class="lineno"> 4914</span>&#160; <span class="comment">//=======================================================================</span></div>
<div class="line"><a name="l04915"></a><span class="lineno"><a class="line" href="classoomph_1_1C1CurvedElementBase.html#af66c0d5584a7789b4fe63316331dc50d"> 4915</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1C1CurvedElementBase.html#af66c0d5584a7789b4fe63316331dc50d">my_interpolated_u_normal</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>, <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;<a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>, <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> &amp;interpolated_dudxi, <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> &amp;interpolated_d2udxi)<span class="keyword"></span></div>
<div class="line"><a name="l04916"></a><span class="lineno"> 4916</span>&#160;<span class="keyword">   const</span></div>
<div class="line"><a name="l04917"></a><span class="lineno"> 4917</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l04918"></a><span class="lineno"> 4918</span>&#160;   <span class="comment">// To check whether this element is on the boundary</span></div>
<div class="line"><a name="l04919"></a><span class="lineno"> 4919</span>&#160;   <span class="keywordtype">unsigned</span> bd_element = <a class="code" href="classoomph_1_1C1CurvedElementBase.html#a819873b0790335875e6c009d63615464">is_boundary_element</a>();</div>
<div class="line"><a name="l04920"></a><span class="lineno"> 4920</span>&#160;   </div>
<div class="line"><a name="l04921"></a><span class="lineno"> 4921</span>&#160;   <span class="comment">//Find the number of positional types</span></div>
<div class="line"><a name="l04922"></a><span class="lineno"> 4922</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_position_type = <a class="code" href="classoomph_1_1FiniteElement.html#a36f4cb7569a545a9d93b66e6ee03cc91">nnodal_position_type</a>();</div>
<div class="line"><a name="l04923"></a><span class="lineno"> 4923</span>&#160;  </div>
<div class="line"><a name="l04924"></a><span class="lineno"> 4924</span>&#160;   <span class="keywordflow">if</span>(bd_element==0)</div>
<div class="line"><a name="l04925"></a><span class="lineno"> 4925</span>&#160;    {</div>
<div class="line"><a name="l04926"></a><span class="lineno"> 4926</span>&#160;     <span class="comment">//Assign storage for the local shape function</span></div>
<div class="line"><a name="l04927"></a><span class="lineno"> 4927</span>&#160;     <a class="code" href="classoomph_1_1Shape.html">Shape</a> psi(3,6);</div>
<div class="line"><a name="l04928"></a><span class="lineno"> 4928</span>&#160;     <a class="code" href="classoomph_1_1DShape.html">DShape</a> dpsi(3,6,2), d2psi(3,6,3);</div>
<div class="line"><a name="l04929"></a><span class="lineno"> 4929</span>&#160;     <span class="comment">//Assign shape functions and their derivatives</span></div>
<div class="line"><a name="l04930"></a><span class="lineno"> 4930</span>&#160;     <a class="code" href="classoomph_1_1C1CurvedElementBase.html#a5d919ef0eef6ae6477642b3dcd1196df">d2basis_local_straight</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,psi,dpsi,d2psi);</div>
<div class="line"><a name="l04931"></a><span class="lineno"> 4931</span>&#160;   </div>
<div class="line"><a name="l04932"></a><span class="lineno"> 4932</span>&#160;     <span class="comment">// Loop over nodes</span></div>
<div class="line"><a name="l04933"></a><span class="lineno"> 4933</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l=0;l&lt;3;l++) </div>
<div class="line"><a name="l04934"></a><span class="lineno"> 4934</span>&#160;      {</div>
<div class="line"><a name="l04935"></a><span class="lineno"> 4935</span>&#160;       <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> k=0;k&lt;n_position_type;k++)</div>
<div class="line"><a name="l04936"></a><span class="lineno"> 4936</span>&#160;        {</div>
<div class="line"><a name="l04937"></a><span class="lineno"> 4937</span>&#160;         <span class="comment">//Get the nodal value of the poisson unknown</span></div>
<div class="line"><a name="l04938"></a><span class="lineno"> 4938</span>&#160;         <span class="keywordtype">double</span> u_val = <a class="code" href="classoomph_1_1FiniteElement.html#abdc430bef622e0257397407416e6aac8">raw_nodal_value</a>(l,2+k);</div>
<div class="line"><a name="l04939"></a><span class="lineno"> 4939</span>&#160;         <a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>[0] += u_val*psi(l,k);</div>
<div class="line"><a name="l04940"></a><span class="lineno"> 4940</span>&#160;         <span class="comment">// Loop over directions</span></div>
<div class="line"><a name="l04941"></a><span class="lineno"> 4941</span>&#160;         <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> j=0;j&lt;2;j++)</div>
<div class="line"><a name="l04942"></a><span class="lineno"> 4942</span>&#160;          {</div>
<div class="line"><a name="l04943"></a><span class="lineno"> 4943</span>&#160;           interpolated_dudxi(0,j) += u_val*dpsi(l,k,j);</div>
<div class="line"><a name="l04944"></a><span class="lineno"> 4944</span>&#160;          }</div>
<div class="line"><a name="l04945"></a><span class="lineno"> 4945</span>&#160;         <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> j=0;j&lt;3;j++)</div>
<div class="line"><a name="l04946"></a><span class="lineno"> 4946</span>&#160;          {</div>
<div class="line"><a name="l04947"></a><span class="lineno"> 4947</span>&#160;           interpolated_d2udxi(0,j) += u_val*d2psi(l,k,j);</div>
<div class="line"><a name="l04948"></a><span class="lineno"> 4948</span>&#160;          }</div>
<div class="line"><a name="l04949"></a><span class="lineno"> 4949</span>&#160;        }</div>
<div class="line"><a name="l04950"></a><span class="lineno"> 4950</span>&#160;      }</div>
<div class="line"><a name="l04951"></a><span class="lineno"> 4951</span>&#160;    }  </div>
<div class="line"><a name="l04952"></a><span class="lineno"> 4952</span>&#160;   <span class="comment">// if it is the boundary element</span></div>
<div class="line"><a name="l04953"></a><span class="lineno"> 4953</span>&#160;   <span class="keywordflow">else</span> <span class="keywordflow">if</span>(bd_element==1)</div>
<div class="line"><a name="l04954"></a><span class="lineno"> 4954</span>&#160;    {</div>
<div class="line"><a name="l04955"></a><span class="lineno"> 4955</span>&#160;     <span class="comment">// assign degrees of freedom to the reference element</span></div>
<div class="line"><a name="l04956"></a><span class="lineno"> 4956</span>&#160;     <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> <a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a51292b8e4d96f2bb9f0d6bb0340d1620">D</a>(21,21), <a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a43c804e2bcf9862a4bf629d5f01761e8">B</a>(21,36);</div>
<div class="line"><a name="l04957"></a><span class="lineno"> 4957</span>&#160;     <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> temp(21,0.0);</div>
<div class="line"><a name="l04958"></a><span class="lineno"> 4958</span>&#160;     <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> u_value(36,0.0);</div>
<div class="line"><a name="l04959"></a><span class="lineno"> 4959</span>&#160;     <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> <a class="code" href="classoomph_1_1FiniteElement.html#a1d33f53e2b2813fba8a0e8b458bf2047">position</a>(3,2);</div>
<div class="line"><a name="l04960"></a><span class="lineno"> 4960</span>&#160;     <span class="keywordtype">unsigned</span> bd_element;</div>
<div class="line"><a name="l04961"></a><span class="lineno"> 4961</span>&#160;     <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> bd_position(20,2);</div>
<div class="line"><a name="l04962"></a><span class="lineno"> 4962</span>&#160;     <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> x(2);</div>
<div class="line"><a name="l04963"></a><span class="lineno"> 4963</span>&#160;     <span class="comment">// Get nodal values at nodes on the reference element</span></div>
<div class="line"><a name="l04964"></a><span class="lineno"> 4964</span>&#160;     <a class="code" href="classoomph_1_1C1CurvedElementBase.html#a4735f6f63d4e545608bf485c7168e251">get_value_transform_matrix</a>(<a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a51292b8e4d96f2bb9f0d6bb0340d1620">D</a>,<a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a43c804e2bcf9862a4bf629d5f01761e8">B</a>,<a class="code" href="classoomph_1_1FiniteElement.html#a1d33f53e2b2813fba8a0e8b458bf2047">position</a>,bd_element,bd_position,x);</div>
<div class="line"><a name="l04965"></a><span class="lineno"> 4965</span>&#160; </div>
<div class="line"><a name="l04966"></a><span class="lineno"> 4966</span>&#160;     <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> <a class="code" href="the__data__structure_8txt.html#a3b0d20781021ec2f0e788713f8b0fec8">value</a>(21);</div>
<div class="line"><a name="l04967"></a><span class="lineno"> 4967</span>&#160;    </div>
<div class="line"><a name="l04968"></a><span class="lineno"> 4968</span>&#160;     <span class="keywordtype">double</span> angle_1 = atan(bd_position(0,1)/bd_position(0,0));</div>
<div class="line"><a name="l04969"></a><span class="lineno"> 4969</span>&#160;     <span class="keywordtype">double</span> angle_2 = atan(bd_position(1,1)/bd_position(1,0));</div>
<div class="line"><a name="l04970"></a><span class="lineno"> 4970</span>&#160;     <span class="keywordflow">if</span>(angle_1 &gt; angle_2)</div>
<div class="line"><a name="l04971"></a><span class="lineno"> 4971</span>&#160;      {</div>
<div class="line"><a name="l04972"></a><span class="lineno"> 4972</span>&#160;       <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> <a class="code" href="classoomph_1_1FiniteElement.html#a28fd5c2d4aeba5ef65bee0e0d72569f5">nodal_value</a>(3,n_position_type);</div>
<div class="line"><a name="l04973"></a><span class="lineno"> 4973</span>&#160;       <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> k=0;k&lt;n_position_type;k++)</div>
<div class="line"><a name="l04974"></a><span class="lineno"> 4974</span>&#160;        {</div>
<div class="line"><a name="l04975"></a><span class="lineno"> 4975</span>&#160;         <a class="code" href="classoomph_1_1FiniteElement.html#a28fd5c2d4aeba5ef65bee0e0d72569f5">nodal_value</a>(0,k) = <a class="code" href="classoomph_1_1FiniteElement.html#abdc430bef622e0257397407416e6aac8">raw_nodal_value</a>(2,2+k);</div>
<div class="line"><a name="l04976"></a><span class="lineno"> 4976</span>&#160;         <a class="code" href="classoomph_1_1FiniteElement.html#a28fd5c2d4aeba5ef65bee0e0d72569f5">nodal_value</a>(1,k) = <a class="code" href="classoomph_1_1FiniteElement.html#abdc430bef622e0257397407416e6aac8">raw_nodal_value</a>(0,2+k);</div>
<div class="line"><a name="l04977"></a><span class="lineno"> 4977</span>&#160;         <a class="code" href="classoomph_1_1FiniteElement.html#a28fd5c2d4aeba5ef65bee0e0d72569f5">nodal_value</a>(2,k) = <a class="code" href="classoomph_1_1FiniteElement.html#abdc430bef622e0257397407416e6aac8">raw_nodal_value</a>(1,2+k);</div>
<div class="line"><a name="l04978"></a><span class="lineno"> 4978</span>&#160;        }</div>
<div class="line"><a name="l04979"></a><span class="lineno"> 4979</span>&#160;       <a class="code" href="the__data__structure_8txt.html#a3b0d20781021ec2f0e788713f8b0fec8">value</a>[0] = <a class="code" href="classoomph_1_1FiniteElement.html#a28fd5c2d4aeba5ef65bee0e0d72569f5">nodal_value</a>(0,0);</div>
<div class="line"><a name="l04980"></a><span class="lineno"> 4980</span>&#160;       <a class="code" href="the__data__structure_8txt.html#a3b0d20781021ec2f0e788713f8b0fec8">value</a>[1] = <a class="code" href="classoomph_1_1FiniteElement.html#a28fd5c2d4aeba5ef65bee0e0d72569f5">nodal_value</a>(1,0);</div>
<div class="line"><a name="l04981"></a><span class="lineno"> 4981</span>&#160;       <a class="code" href="the__data__structure_8txt.html#a3b0d20781021ec2f0e788713f8b0fec8">value</a>[2] = <a class="code" href="classoomph_1_1FiniteElement.html#a28fd5c2d4aeba5ef65bee0e0d72569f5">nodal_value</a>(2,0);</div>
<div class="line"><a name="l04982"></a><span class="lineno"> 4982</span>&#160;       <a class="code" href="the__data__structure_8txt.html#a3b0d20781021ec2f0e788713f8b0fec8">value</a>[3] = <a class="code" href="classoomph_1_1FiniteElement.html#a28fd5c2d4aeba5ef65bee0e0d72569f5">nodal_value</a>(0,1);</div>
<div class="line"><a name="l04983"></a><span class="lineno"> 4983</span>&#160;       <a class="code" href="the__data__structure_8txt.html#a3b0d20781021ec2f0e788713f8b0fec8">value</a>[4] = <a class="code" href="classoomph_1_1FiniteElement.html#a28fd5c2d4aeba5ef65bee0e0d72569f5">nodal_value</a>(0,2);</div>
<div class="line"><a name="l04984"></a><span class="lineno"> 4984</span>&#160;       <a class="code" href="the__data__structure_8txt.html#a3b0d20781021ec2f0e788713f8b0fec8">value</a>[5] = <a class="code" href="classoomph_1_1FiniteElement.html#a28fd5c2d4aeba5ef65bee0e0d72569f5">nodal_value</a>(1,1);</div>
<div class="line"><a name="l04985"></a><span class="lineno"> 4985</span>&#160;       <a class="code" href="the__data__structure_8txt.html#a3b0d20781021ec2f0e788713f8b0fec8">value</a>[6] = <a class="code" href="classoomph_1_1FiniteElement.html#a28fd5c2d4aeba5ef65bee0e0d72569f5">nodal_value</a>(1,2);</div>
<div class="line"><a name="l04986"></a><span class="lineno"> 4986</span>&#160;       <a class="code" href="the__data__structure_8txt.html#a3b0d20781021ec2f0e788713f8b0fec8">value</a>[7] = <a class="code" href="classoomph_1_1FiniteElement.html#a28fd5c2d4aeba5ef65bee0e0d72569f5">nodal_value</a>(2,1);</div>
<div class="line"><a name="l04987"></a><span class="lineno"> 4987</span>&#160;       <a class="code" href="the__data__structure_8txt.html#a3b0d20781021ec2f0e788713f8b0fec8">value</a>[8] = <a class="code" href="classoomph_1_1FiniteElement.html#a28fd5c2d4aeba5ef65bee0e0d72569f5">nodal_value</a>(2,2);</div>
<div class="line"><a name="l04988"></a><span class="lineno"> 4988</span>&#160;       <a class="code" href="the__data__structure_8txt.html#a3b0d20781021ec2f0e788713f8b0fec8">value</a>[9] = <a class="code" href="classoomph_1_1FiniteElement.html#a28fd5c2d4aeba5ef65bee0e0d72569f5">nodal_value</a>(0,3);</div>
<div class="line"><a name="l04989"></a><span class="lineno"> 4989</span>&#160;       <a class="code" href="the__data__structure_8txt.html#a3b0d20781021ec2f0e788713f8b0fec8">value</a>[10] = <a class="code" href="classoomph_1_1FiniteElement.html#a28fd5c2d4aeba5ef65bee0e0d72569f5">nodal_value</a>(0,5);</div>
<div class="line"><a name="l04990"></a><span class="lineno"> 4990</span>&#160;       <a class="code" href="the__data__structure_8txt.html#a3b0d20781021ec2f0e788713f8b0fec8">value</a>[11] = <a class="code" href="classoomph_1_1FiniteElement.html#a28fd5c2d4aeba5ef65bee0e0d72569f5">nodal_value</a>(0,4);</div>
<div class="line"><a name="l04991"></a><span class="lineno"> 4991</span>&#160;       <a class="code" href="the__data__structure_8txt.html#a3b0d20781021ec2f0e788713f8b0fec8">value</a>[12] = <a class="code" href="classoomph_1_1FiniteElement.html#a28fd5c2d4aeba5ef65bee0e0d72569f5">nodal_value</a>(1,3);</div>
<div class="line"><a name="l04992"></a><span class="lineno"> 4992</span>&#160;       <a class="code" href="the__data__structure_8txt.html#a3b0d20781021ec2f0e788713f8b0fec8">value</a>[13] = <a class="code" href="classoomph_1_1FiniteElement.html#a28fd5c2d4aeba5ef65bee0e0d72569f5">nodal_value</a>(1,5);</div>
<div class="line"><a name="l04993"></a><span class="lineno"> 4993</span>&#160;       <a class="code" href="the__data__structure_8txt.html#a3b0d20781021ec2f0e788713f8b0fec8">value</a>[14] = <a class="code" href="classoomph_1_1FiniteElement.html#a28fd5c2d4aeba5ef65bee0e0d72569f5">nodal_value</a>(1,4);</div>
<div class="line"><a name="l04994"></a><span class="lineno"> 4994</span>&#160;       <a class="code" href="the__data__structure_8txt.html#a3b0d20781021ec2f0e788713f8b0fec8">value</a>[15] = <a class="code" href="classoomph_1_1FiniteElement.html#a28fd5c2d4aeba5ef65bee0e0d72569f5">nodal_value</a>(2,3);</div>
<div class="line"><a name="l04995"></a><span class="lineno"> 4995</span>&#160;       <a class="code" href="the__data__structure_8txt.html#a3b0d20781021ec2f0e788713f8b0fec8">value</a>[16] = <a class="code" href="classoomph_1_1FiniteElement.html#a28fd5c2d4aeba5ef65bee0e0d72569f5">nodal_value</a>(2,5);</div>
<div class="line"><a name="l04996"></a><span class="lineno"> 4996</span>&#160;       <a class="code" href="the__data__structure_8txt.html#a3b0d20781021ec2f0e788713f8b0fec8">value</a>[17] = <a class="code" href="classoomph_1_1FiniteElement.html#a28fd5c2d4aeba5ef65bee0e0d72569f5">nodal_value</a>(2,4);</div>
<div class="line"><a name="l04997"></a><span class="lineno"> 4997</span>&#160;       <a class="code" href="the__data__structure_8txt.html#a3b0d20781021ec2f0e788713f8b0fec8">value</a>[18] = <a class="code" href="classoomph_1_1FiniteElement.html#abdc430bef622e0257397407416e6aac8">raw_nodal_value</a>(<a class="code" href="classoomph_1_1FiniteElement.html#a6219ed269a6d89b5aa14659cce48905a">nnode</a>()-3,2+0);</div>
<div class="line"><a name="l04998"></a><span class="lineno"> 4998</span>&#160;       <a class="code" href="the__data__structure_8txt.html#a3b0d20781021ec2f0e788713f8b0fec8">value</a>[19] = <a class="code" href="classoomph_1_1FiniteElement.html#abdc430bef622e0257397407416e6aac8">raw_nodal_value</a>(<a class="code" href="classoomph_1_1FiniteElement.html#a6219ed269a6d89b5aa14659cce48905a">nnode</a>()-2,2+0);</div>
<div class="line"><a name="l04999"></a><span class="lineno"> 4999</span>&#160;       <a class="code" href="the__data__structure_8txt.html#a3b0d20781021ec2f0e788713f8b0fec8">value</a>[20] = <a class="code" href="classoomph_1_1FiniteElement.html#abdc430bef622e0257397407416e6aac8">raw_nodal_value</a>(<a class="code" href="classoomph_1_1FiniteElement.html#a6219ed269a6d89b5aa14659cce48905a">nnode</a>()-1,2+0);</div>
<div class="line"><a name="l05000"></a><span class="lineno"> 5000</span>&#160;      }</div>
<div class="line"><a name="l05001"></a><span class="lineno"> 5001</span>&#160;     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(angle_1 &lt; angle_2)</div>
<div class="line"><a name="l05002"></a><span class="lineno"> 5002</span>&#160;      {</div>
<div class="line"><a name="l05003"></a><span class="lineno"> 5003</span>&#160;       <span class="keywordflow">if</span>(<a class="code" href="classoomph_1_1FiniteElement.html#a1d33f53e2b2813fba8a0e8b458bf2047">position</a>(0,0)==bd_position(0,0) &amp;&amp; <a class="code" href="classoomph_1_1FiniteElement.html#a1d33f53e2b2813fba8a0e8b458bf2047">position</a>(0,1)==bd_position(0,1))</div>
<div class="line"><a name="l05004"></a><span class="lineno"> 5004</span>&#160;        {</div>
<div class="line"><a name="l05005"></a><span class="lineno"> 5005</span>&#160;         <a class="code" href="the__data__structure_8txt.html#a3b0d20781021ec2f0e788713f8b0fec8">value</a>[0] = <a class="code" href="classoomph_1_1FiniteElement.html#abdc430bef622e0257397407416e6aac8">raw_nodal_value</a>(0,2+0);</div>
<div class="line"><a name="l05006"></a><span class="lineno"> 5006</span>&#160;         <a class="code" href="the__data__structure_8txt.html#a3b0d20781021ec2f0e788713f8b0fec8">value</a>[1] = <a class="code" href="classoomph_1_1FiniteElement.html#abdc430bef622e0257397407416e6aac8">raw_nodal_value</a>(1,2+0);</div>
<div class="line"><a name="l05007"></a><span class="lineno"> 5007</span>&#160;         <a class="code" href="the__data__structure_8txt.html#a3b0d20781021ec2f0e788713f8b0fec8">value</a>[2] = <a class="code" href="classoomph_1_1FiniteElement.html#abdc430bef622e0257397407416e6aac8">raw_nodal_value</a>(2,2+0);</div>
<div class="line"><a name="l05008"></a><span class="lineno"> 5008</span>&#160;         <a class="code" href="the__data__structure_8txt.html#a3b0d20781021ec2f0e788713f8b0fec8">value</a>[3] = <a class="code" href="classoomph_1_1FiniteElement.html#abdc430bef622e0257397407416e6aac8">raw_nodal_value</a>(0,2+1);</div>
<div class="line"><a name="l05009"></a><span class="lineno"> 5009</span>&#160;         <a class="code" href="the__data__structure_8txt.html#a3b0d20781021ec2f0e788713f8b0fec8">value</a>[4] = <a class="code" href="classoomph_1_1FiniteElement.html#abdc430bef622e0257397407416e6aac8">raw_nodal_value</a>(0,2+2);</div>
<div class="line"><a name="l05010"></a><span class="lineno"> 5010</span>&#160;         <a class="code" href="the__data__structure_8txt.html#a3b0d20781021ec2f0e788713f8b0fec8">value</a>[5] = <a class="code" href="classoomph_1_1FiniteElement.html#abdc430bef622e0257397407416e6aac8">raw_nodal_value</a>(1,2+1);</div>
<div class="line"><a name="l05011"></a><span class="lineno"> 5011</span>&#160;         <a class="code" href="the__data__structure_8txt.html#a3b0d20781021ec2f0e788713f8b0fec8">value</a>[6] = <a class="code" href="classoomph_1_1FiniteElement.html#abdc430bef622e0257397407416e6aac8">raw_nodal_value</a>(1,2+2);</div>
<div class="line"><a name="l05012"></a><span class="lineno"> 5012</span>&#160;         <a class="code" href="the__data__structure_8txt.html#a3b0d20781021ec2f0e788713f8b0fec8">value</a>[7] = <a class="code" href="classoomph_1_1FiniteElement.html#abdc430bef622e0257397407416e6aac8">raw_nodal_value</a>(2,2+1);</div>
<div class="line"><a name="l05013"></a><span class="lineno"> 5013</span>&#160;         <a class="code" href="the__data__structure_8txt.html#a3b0d20781021ec2f0e788713f8b0fec8">value</a>[8] = <a class="code" href="classoomph_1_1FiniteElement.html#abdc430bef622e0257397407416e6aac8">raw_nodal_value</a>(2,2+2);</div>
<div class="line"><a name="l05014"></a><span class="lineno"> 5014</span>&#160;         <a class="code" href="the__data__structure_8txt.html#a3b0d20781021ec2f0e788713f8b0fec8">value</a>[9] = <a class="code" href="classoomph_1_1FiniteElement.html#abdc430bef622e0257397407416e6aac8">raw_nodal_value</a>(0,2+3);</div>
<div class="line"><a name="l05015"></a><span class="lineno"> 5015</span>&#160;         <a class="code" href="the__data__structure_8txt.html#a3b0d20781021ec2f0e788713f8b0fec8">value</a>[10] = <a class="code" href="classoomph_1_1FiniteElement.html#abdc430bef622e0257397407416e6aac8">raw_nodal_value</a>(0,2+5);</div>
<div class="line"><a name="l05016"></a><span class="lineno"> 5016</span>&#160;         <a class="code" href="the__data__structure_8txt.html#a3b0d20781021ec2f0e788713f8b0fec8">value</a>[11] = <a class="code" href="classoomph_1_1FiniteElement.html#abdc430bef622e0257397407416e6aac8">raw_nodal_value</a>(0,2+4);</div>
<div class="line"><a name="l05017"></a><span class="lineno"> 5017</span>&#160;         <a class="code" href="the__data__structure_8txt.html#a3b0d20781021ec2f0e788713f8b0fec8">value</a>[12] = <a class="code" href="classoomph_1_1FiniteElement.html#abdc430bef622e0257397407416e6aac8">raw_nodal_value</a>(1,2+3);</div>
<div class="line"><a name="l05018"></a><span class="lineno"> 5018</span>&#160;         <a class="code" href="the__data__structure_8txt.html#a3b0d20781021ec2f0e788713f8b0fec8">value</a>[13] = <a class="code" href="classoomph_1_1FiniteElement.html#abdc430bef622e0257397407416e6aac8">raw_nodal_value</a>(1,2+5);</div>
<div class="line"><a name="l05019"></a><span class="lineno"> 5019</span>&#160;         <a class="code" href="the__data__structure_8txt.html#a3b0d20781021ec2f0e788713f8b0fec8">value</a>[14] = <a class="code" href="classoomph_1_1FiniteElement.html#abdc430bef622e0257397407416e6aac8">raw_nodal_value</a>(1,2+4);</div>
<div class="line"><a name="l05020"></a><span class="lineno"> 5020</span>&#160;         <a class="code" href="the__data__structure_8txt.html#a3b0d20781021ec2f0e788713f8b0fec8">value</a>[15] = <a class="code" href="classoomph_1_1FiniteElement.html#abdc430bef622e0257397407416e6aac8">raw_nodal_value</a>(2,2+3);</div>
<div class="line"><a name="l05021"></a><span class="lineno"> 5021</span>&#160;         <a class="code" href="the__data__structure_8txt.html#a3b0d20781021ec2f0e788713f8b0fec8">value</a>[16] = <a class="code" href="classoomph_1_1FiniteElement.html#abdc430bef622e0257397407416e6aac8">raw_nodal_value</a>(2,2+5);</div>
<div class="line"><a name="l05022"></a><span class="lineno"> 5022</span>&#160;         <a class="code" href="the__data__structure_8txt.html#a3b0d20781021ec2f0e788713f8b0fec8">value</a>[17] = <a class="code" href="classoomph_1_1FiniteElement.html#abdc430bef622e0257397407416e6aac8">raw_nodal_value</a>(2,2+4);</div>
<div class="line"><a name="l05023"></a><span class="lineno"> 5023</span>&#160;         <a class="code" href="the__data__structure_8txt.html#a3b0d20781021ec2f0e788713f8b0fec8">value</a>[18] = <a class="code" href="classoomph_1_1FiniteElement.html#abdc430bef622e0257397407416e6aac8">raw_nodal_value</a>(<a class="code" href="classoomph_1_1FiniteElement.html#a6219ed269a6d89b5aa14659cce48905a">nnode</a>()-2,2+0);</div>
<div class="line"><a name="l05024"></a><span class="lineno"> 5024</span>&#160;         <a class="code" href="the__data__structure_8txt.html#a3b0d20781021ec2f0e788713f8b0fec8">value</a>[19] = <a class="code" href="classoomph_1_1FiniteElement.html#abdc430bef622e0257397407416e6aac8">raw_nodal_value</a>(<a class="code" href="classoomph_1_1FiniteElement.html#a6219ed269a6d89b5aa14659cce48905a">nnode</a>()-1,2+0);</div>
<div class="line"><a name="l05025"></a><span class="lineno"> 5025</span>&#160;         <a class="code" href="the__data__structure_8txt.html#a3b0d20781021ec2f0e788713f8b0fec8">value</a>[20] = <a class="code" href="classoomph_1_1FiniteElement.html#abdc430bef622e0257397407416e6aac8">raw_nodal_value</a>(<a class="code" href="classoomph_1_1FiniteElement.html#a6219ed269a6d89b5aa14659cce48905a">nnode</a>()-3,2+0);</div>
<div class="line"><a name="l05026"></a><span class="lineno"> 5026</span>&#160;        }</div>
<div class="line"><a name="l05027"></a><span class="lineno"> 5027</span>&#160;       <span class="keywordflow">else</span> </div>
<div class="line"><a name="l05028"></a><span class="lineno"> 5028</span>&#160;        {</div>
<div class="line"><a name="l05029"></a><span class="lineno"> 5029</span>&#160;         <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> <a class="code" href="classoomph_1_1FiniteElement.html#a28fd5c2d4aeba5ef65bee0e0d72569f5">nodal_value</a>(3,n_position_type);</div>
<div class="line"><a name="l05030"></a><span class="lineno"> 5030</span>&#160;         <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> k=0;k&lt;n_position_type;k++)</div>
<div class="line"><a name="l05031"></a><span class="lineno"> 5031</span>&#160;          {</div>
<div class="line"><a name="l05032"></a><span class="lineno"> 5032</span>&#160;           <a class="code" href="classoomph_1_1FiniteElement.html#a28fd5c2d4aeba5ef65bee0e0d72569f5">nodal_value</a>(2,k) = <a class="code" href="classoomph_1_1FiniteElement.html#abdc430bef622e0257397407416e6aac8">raw_nodal_value</a>(0,2+k);</div>
<div class="line"><a name="l05033"></a><span class="lineno"> 5033</span>&#160;           <a class="code" href="classoomph_1_1FiniteElement.html#a28fd5c2d4aeba5ef65bee0e0d72569f5">nodal_value</a>(0,k) = <a class="code" href="classoomph_1_1FiniteElement.html#abdc430bef622e0257397407416e6aac8">raw_nodal_value</a>(1,2+k);</div>
<div class="line"><a name="l05034"></a><span class="lineno"> 5034</span>&#160;           <a class="code" href="classoomph_1_1FiniteElement.html#a28fd5c2d4aeba5ef65bee0e0d72569f5">nodal_value</a>(1,k) = <a class="code" href="classoomph_1_1FiniteElement.html#abdc430bef622e0257397407416e6aac8">raw_nodal_value</a>(2,2+k);</div>
<div class="line"><a name="l05035"></a><span class="lineno"> 5035</span>&#160;          }</div>
<div class="line"><a name="l05036"></a><span class="lineno"> 5036</span>&#160;         <a class="code" href="the__data__structure_8txt.html#a3b0d20781021ec2f0e788713f8b0fec8">value</a>[0] = <a class="code" href="classoomph_1_1FiniteElement.html#a28fd5c2d4aeba5ef65bee0e0d72569f5">nodal_value</a>(0,0);</div>
<div class="line"><a name="l05037"></a><span class="lineno"> 5037</span>&#160;         <a class="code" href="the__data__structure_8txt.html#a3b0d20781021ec2f0e788713f8b0fec8">value</a>[1] = <a class="code" href="classoomph_1_1FiniteElement.html#a28fd5c2d4aeba5ef65bee0e0d72569f5">nodal_value</a>(1,0);</div>
<div class="line"><a name="l05038"></a><span class="lineno"> 5038</span>&#160;         <a class="code" href="the__data__structure_8txt.html#a3b0d20781021ec2f0e788713f8b0fec8">value</a>[2] = <a class="code" href="classoomph_1_1FiniteElement.html#a28fd5c2d4aeba5ef65bee0e0d72569f5">nodal_value</a>(2,0);</div>
<div class="line"><a name="l05039"></a><span class="lineno"> 5039</span>&#160;         <a class="code" href="the__data__structure_8txt.html#a3b0d20781021ec2f0e788713f8b0fec8">value</a>[3] = <a class="code" href="classoomph_1_1FiniteElement.html#a28fd5c2d4aeba5ef65bee0e0d72569f5">nodal_value</a>(0,1);</div>
<div class="line"><a name="l05040"></a><span class="lineno"> 5040</span>&#160;         <a class="code" href="the__data__structure_8txt.html#a3b0d20781021ec2f0e788713f8b0fec8">value</a>[4] = <a class="code" href="classoomph_1_1FiniteElement.html#a28fd5c2d4aeba5ef65bee0e0d72569f5">nodal_value</a>(0,2);</div>
<div class="line"><a name="l05041"></a><span class="lineno"> 5041</span>&#160;         <a class="code" href="the__data__structure_8txt.html#a3b0d20781021ec2f0e788713f8b0fec8">value</a>[5] = <a class="code" href="classoomph_1_1FiniteElement.html#a28fd5c2d4aeba5ef65bee0e0d72569f5">nodal_value</a>(1,1);</div>
<div class="line"><a name="l05042"></a><span class="lineno"> 5042</span>&#160;         <a class="code" href="the__data__structure_8txt.html#a3b0d20781021ec2f0e788713f8b0fec8">value</a>[6] = <a class="code" href="classoomph_1_1FiniteElement.html#a28fd5c2d4aeba5ef65bee0e0d72569f5">nodal_value</a>(1,2);</div>
<div class="line"><a name="l05043"></a><span class="lineno"> 5043</span>&#160;         <a class="code" href="the__data__structure_8txt.html#a3b0d20781021ec2f0e788713f8b0fec8">value</a>[7] = <a class="code" href="classoomph_1_1FiniteElement.html#a28fd5c2d4aeba5ef65bee0e0d72569f5">nodal_value</a>(2,1);</div>
<div class="line"><a name="l05044"></a><span class="lineno"> 5044</span>&#160;         <a class="code" href="the__data__structure_8txt.html#a3b0d20781021ec2f0e788713f8b0fec8">value</a>[8] = <a class="code" href="classoomph_1_1FiniteElement.html#a28fd5c2d4aeba5ef65bee0e0d72569f5">nodal_value</a>(2,2);</div>
<div class="line"><a name="l05045"></a><span class="lineno"> 5045</span>&#160;         <a class="code" href="the__data__structure_8txt.html#a3b0d20781021ec2f0e788713f8b0fec8">value</a>[9] = <a class="code" href="classoomph_1_1FiniteElement.html#a28fd5c2d4aeba5ef65bee0e0d72569f5">nodal_value</a>(0,3);</div>
<div class="line"><a name="l05046"></a><span class="lineno"> 5046</span>&#160;         <a class="code" href="the__data__structure_8txt.html#a3b0d20781021ec2f0e788713f8b0fec8">value</a>[10] = <a class="code" href="classoomph_1_1FiniteElement.html#a28fd5c2d4aeba5ef65bee0e0d72569f5">nodal_value</a>(0,5);</div>
<div class="line"><a name="l05047"></a><span class="lineno"> 5047</span>&#160;         <a class="code" href="the__data__structure_8txt.html#a3b0d20781021ec2f0e788713f8b0fec8">value</a>[11] = <a class="code" href="classoomph_1_1FiniteElement.html#a28fd5c2d4aeba5ef65bee0e0d72569f5">nodal_value</a>(0,4);</div>
<div class="line"><a name="l05048"></a><span class="lineno"> 5048</span>&#160;         <a class="code" href="the__data__structure_8txt.html#a3b0d20781021ec2f0e788713f8b0fec8">value</a>[12] = <a class="code" href="classoomph_1_1FiniteElement.html#a28fd5c2d4aeba5ef65bee0e0d72569f5">nodal_value</a>(1,3);</div>
<div class="line"><a name="l05049"></a><span class="lineno"> 5049</span>&#160;         <a class="code" href="the__data__structure_8txt.html#a3b0d20781021ec2f0e788713f8b0fec8">value</a>[13] = <a class="code" href="classoomph_1_1FiniteElement.html#a28fd5c2d4aeba5ef65bee0e0d72569f5">nodal_value</a>(1,5);</div>
<div class="line"><a name="l05050"></a><span class="lineno"> 5050</span>&#160;         <a class="code" href="the__data__structure_8txt.html#a3b0d20781021ec2f0e788713f8b0fec8">value</a>[14] = <a class="code" href="classoomph_1_1FiniteElement.html#a28fd5c2d4aeba5ef65bee0e0d72569f5">nodal_value</a>(1,4);</div>
<div class="line"><a name="l05051"></a><span class="lineno"> 5051</span>&#160;         <a class="code" href="the__data__structure_8txt.html#a3b0d20781021ec2f0e788713f8b0fec8">value</a>[15] = <a class="code" href="classoomph_1_1FiniteElement.html#a28fd5c2d4aeba5ef65bee0e0d72569f5">nodal_value</a>(2,3);</div>
<div class="line"><a name="l05052"></a><span class="lineno"> 5052</span>&#160;         <a class="code" href="the__data__structure_8txt.html#a3b0d20781021ec2f0e788713f8b0fec8">value</a>[16] = <a class="code" href="classoomph_1_1FiniteElement.html#a28fd5c2d4aeba5ef65bee0e0d72569f5">nodal_value</a>(2,5);</div>
<div class="line"><a name="l05053"></a><span class="lineno"> 5053</span>&#160;         <a class="code" href="the__data__structure_8txt.html#a3b0d20781021ec2f0e788713f8b0fec8">value</a>[17] = <a class="code" href="classoomph_1_1FiniteElement.html#a28fd5c2d4aeba5ef65bee0e0d72569f5">nodal_value</a>(2,4);</div>
<div class="line"><a name="l05054"></a><span class="lineno"> 5054</span>&#160;         <a class="code" href="the__data__structure_8txt.html#a3b0d20781021ec2f0e788713f8b0fec8">value</a>[18] = <a class="code" href="classoomph_1_1FiniteElement.html#abdc430bef622e0257397407416e6aac8">raw_nodal_value</a>(<a class="code" href="classoomph_1_1FiniteElement.html#a6219ed269a6d89b5aa14659cce48905a">nnode</a>()-1,2+0);</div>
<div class="line"><a name="l05055"></a><span class="lineno"> 5055</span>&#160;         <a class="code" href="the__data__structure_8txt.html#a3b0d20781021ec2f0e788713f8b0fec8">value</a>[19] = <a class="code" href="classoomph_1_1FiniteElement.html#abdc430bef622e0257397407416e6aac8">raw_nodal_value</a>(<a class="code" href="classoomph_1_1FiniteElement.html#a6219ed269a6d89b5aa14659cce48905a">nnode</a>()-3,2+0);</div>
<div class="line"><a name="l05056"></a><span class="lineno"> 5056</span>&#160;         <a class="code" href="the__data__structure_8txt.html#a3b0d20781021ec2f0e788713f8b0fec8">value</a>[20] = <a class="code" href="classoomph_1_1FiniteElement.html#abdc430bef622e0257397407416e6aac8">raw_nodal_value</a>(<a class="code" href="classoomph_1_1FiniteElement.html#a6219ed269a6d89b5aa14659cce48905a">nnode</a>()-2,2+0);</div>
<div class="line"><a name="l05057"></a><span class="lineno"> 5057</span>&#160;        }</div>
<div class="line"><a name="l05058"></a><span class="lineno"> 5058</span>&#160;      }</div>
<div class="line"><a name="l05059"></a><span class="lineno"> 5059</span>&#160;     </div>
<div class="line"><a name="l05060"></a><span class="lineno"> 5060</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;21;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l05061"></a><span class="lineno"> 5061</span>&#160;      {</div>
<div class="line"><a name="l05062"></a><span class="lineno"> 5062</span>&#160;       <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> j=0;j&lt;21;j++)</div>
<div class="line"><a name="l05063"></a><span class="lineno"> 5063</span>&#160;        {</div>
<div class="line"><a name="l05064"></a><span class="lineno"> 5064</span>&#160;         <span class="comment">// get values wrt local coordinates</span></div>
<div class="line"><a name="l05065"></a><span class="lineno"> 5065</span>&#160;         temp[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] += <a class="code" href="the__data__structure_8txt.html#a3b0d20781021ec2f0e788713f8b0fec8">value</a>[j]*<a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a51292b8e4d96f2bb9f0d6bb0340d1620">D</a>(j,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>);</div>
<div class="line"><a name="l05066"></a><span class="lineno"> 5066</span>&#160;        }</div>
<div class="line"><a name="l05067"></a><span class="lineno"> 5067</span>&#160;      }</div>
<div class="line"><a name="l05068"></a><span class="lineno"> 5068</span>&#160;     </div>
<div class="line"><a name="l05069"></a><span class="lineno"> 5069</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;36;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l05070"></a><span class="lineno"> 5070</span>&#160;      {</div>
<div class="line"><a name="l05071"></a><span class="lineno"> 5071</span>&#160;       <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> j=0;j&lt;21;j++)</div>
<div class="line"><a name="l05072"></a><span class="lineno"> 5072</span>&#160;        {</div>
<div class="line"><a name="l05073"></a><span class="lineno"> 5073</span>&#160;         u_value[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] += temp[j]*<a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a43c804e2bcf9862a4bf629d5f01761e8">B</a>(j,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>);</div>
<div class="line"><a name="l05074"></a><span class="lineno"> 5074</span>&#160;        }</div>
<div class="line"><a name="l05075"></a><span class="lineno"> 5075</span>&#160;      }</div>
<div class="line"><a name="l05076"></a><span class="lineno"> 5076</span>&#160;     </div>
<div class="line"><a name="l05077"></a><span class="lineno"> 5077</span>&#160;     <span class="comment">// Assign storage for the local shape functio to a curved element</span></div>
<div class="line"><a name="l05078"></a><span class="lineno"> 5078</span>&#160;     <a class="code" href="classoomph_1_1Shape.html">Shape</a> psi_curve(36),basis(36);</div>
<div class="line"><a name="l05079"></a><span class="lineno"> 5079</span>&#160;     <a class="code" href="classoomph_1_1DShape.html">DShape</a> dpsi_curve(36,2), d2psi_curve(36,3), dbasis(36,2), d2basis(36,3);</div>
<div class="line"><a name="l05080"></a><span class="lineno"> 5080</span>&#160;     <span class="comment">// derivative have to be wrt global coor.</span></div>
<div class="line"><a name="l05081"></a><span class="lineno"> 5081</span>&#160;     <a class="code" href="classoomph_1_1C1CurvedElementBase.html#aca6c4b025f8368574a277266d3b9ae14">d2basis_eulerian_curve</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,psi_curve,dpsi_curve,d2psi_curve); </div>
<div class="line"><a name="l05082"></a><span class="lineno"> 5082</span>&#160;         </div>
<div class="line"><a name="l05083"></a><span class="lineno"> 5083</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;36;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++) </div>
<div class="line"><a name="l05084"></a><span class="lineno"> 5084</span>&#160;      {</div>
<div class="line"><a name="l05085"></a><span class="lineno"> 5085</span>&#160;       <a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>[0] += u_value[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]*psi_curve[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>];</div>
<div class="line"><a name="l05086"></a><span class="lineno"> 5086</span>&#160;       <span class="comment">// Loop over directions</span></div>
<div class="line"><a name="l05087"></a><span class="lineno"> 5087</span>&#160;       <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> j=0;j&lt;2;j++)</div>
<div class="line"><a name="l05088"></a><span class="lineno"> 5088</span>&#160;        {</div>
<div class="line"><a name="l05089"></a><span class="lineno"> 5089</span>&#160;         interpolated_dudxi(0,j) += u_value[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]*dpsi_curve(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>,j);</div>
<div class="line"><a name="l05090"></a><span class="lineno"> 5090</span>&#160;        }</div>
<div class="line"><a name="l05091"></a><span class="lineno"> 5091</span>&#160;       <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> j=0;j&lt;3;j++)</div>
<div class="line"><a name="l05092"></a><span class="lineno"> 5092</span>&#160;        {</div>
<div class="line"><a name="l05093"></a><span class="lineno"> 5093</span>&#160;         interpolated_d2udxi(0,j) += u_value[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]*d2psi_curve(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>,j);</div>
<div class="line"><a name="l05094"></a><span class="lineno"> 5094</span>&#160;        }</div>
<div class="line"><a name="l05095"></a><span class="lineno"> 5095</span>&#160;      }</div>
<div class="line"><a name="l05096"></a><span class="lineno"> 5096</span>&#160;    } </div>
<div class="line"><a name="l05097"></a><span class="lineno"> 5097</span>&#160;  }</div>
<div class="line"><a name="l05098"></a><span class="lineno"> 5098</span>&#160; </div>
<div class="line"><a name="l05099"></a><span class="lineno"> 5099</span>&#160; <span class="comment">//=======================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l05100"></a><span class="lineno"> 5100</span>&#160;<span class="comment"> /// Return FE interpolated value u[] at local coordinate s as Vector</span></div>
<div class="line"><a name="l05101"></a><span class="lineno"> 5101</span>&#160;<span class="comment"></span> <span class="comment">// (using Lagrange interpolations)</span></div>
<div class="line"><a name="l05102"></a><span class="lineno"> 5102</span>&#160; <span class="comment">//=======================================================================</span></div>
<div class="line"><a name="l05103"></a><span class="lineno"><a class="line" href="classoomph_1_1C1CurvedElementBase.html#ac6b4ddc3a10424d88e278c1e260b5a10"> 5103</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1C1CurvedElementBase.html#ac6b4ddc3a10424d88e278c1e260b5a10">my_interpolated_u_tangential</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>, <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;<a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>, <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> &amp;interpolated_dudxi)<span class="keyword"></span></div>
<div class="line"><a name="l05104"></a><span class="lineno"> 5104</span>&#160;<span class="keyword">   const</span></div>
<div class="line"><a name="l05105"></a><span class="lineno"> 5105</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l05106"></a><span class="lineno"> 5106</span>&#160;   <span class="keywordtype">unsigned</span> n_node = <a class="code" href="classoomph_1_1FiniteElement.html#a6219ed269a6d89b5aa14659cce48905a">nnode</a>()-3;</div>
<div class="line"><a name="l05107"></a><span class="lineno"> 5107</span>&#160; </div>
<div class="line"><a name="l05108"></a><span class="lineno"> 5108</span>&#160;   <span class="comment">//Local shape function</span></div>
<div class="line"><a name="l05109"></a><span class="lineno"> 5109</span>&#160;   <a class="code" href="classoomph_1_1Shape.html">Shape</a> psi(n_node);</div>
<div class="line"><a name="l05110"></a><span class="lineno"> 5110</span>&#160;   <a class="code" href="classoomph_1_1DShape.html">DShape</a> dpsi(n_node,2);</div>
<div class="line"><a name="l05111"></a><span class="lineno"> 5111</span>&#160;   this-&gt;<a class="code" href="classoomph_1_1C1CurvedElementBase.html#a48932300808586ba1773a54a6ed768e4">dbasis_c0_eulerian</a>(s,psi,dpsi);</div>
<div class="line"><a name="l05112"></a><span class="lineno"> 5112</span>&#160; </div>
<div class="line"><a name="l05113"></a><span class="lineno"> 5113</span>&#160;   <span class="comment">//Interpolated in tangential direction</span></div>
<div class="line"><a name="l05114"></a><span class="lineno"> 5114</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l=0;l&lt;n_node;l++) </div>
<div class="line"><a name="l05115"></a><span class="lineno"> 5115</span>&#160;    {</div>
<div class="line"><a name="l05116"></a><span class="lineno"> 5116</span>&#160;     <a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>[0] += this-&gt;<a class="code" href="classoomph_1_1FiniteElement.html#abdc430bef622e0257397407416e6aac8">raw_nodal_value</a>(l,0)*psi[l];</div>
<div class="line"><a name="l05117"></a><span class="lineno"> 5117</span>&#160;     <a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>[1] += this-&gt;<a class="code" href="classoomph_1_1FiniteElement.html#abdc430bef622e0257397407416e6aac8">raw_nodal_value</a>(l,1)*psi[l]; </div>
<div class="line"><a name="l05118"></a><span class="lineno"> 5118</span>&#160;     <span class="comment">// Loop over directions</span></div>
<div class="line"><a name="l05119"></a><span class="lineno"> 5119</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> j=0;j&lt;2;j++)</div>
<div class="line"><a name="l05120"></a><span class="lineno"> 5120</span>&#160;      {</div>
<div class="line"><a name="l05121"></a><span class="lineno"> 5121</span>&#160;       interpolated_dudxi(0,j) += this-&gt;<a class="code" href="classoomph_1_1FiniteElement.html#abdc430bef622e0257397407416e6aac8">raw_nodal_value</a>(l,0)*dpsi(l,j);</div>
<div class="line"><a name="l05122"></a><span class="lineno"> 5122</span>&#160;       interpolated_dudxi(1,j) += this-&gt;<a class="code" href="classoomph_1_1FiniteElement.html#abdc430bef622e0257397407416e6aac8">raw_nodal_value</a>(l,1)*dpsi(l,j);</div>
<div class="line"><a name="l05123"></a><span class="lineno"> 5123</span>&#160;      } </div>
<div class="line"><a name="l05124"></a><span class="lineno"> 5124</span>&#160;    }</div>
<div class="line"><a name="l05125"></a><span class="lineno"> 5125</span>&#160;  }</div>
<div class="line"><a name="l05126"></a><span class="lineno"> 5126</span>&#160; </div>
<div class="line"><a name="l05127"></a><span class="lineno"> 5127</span>&#160;};</div>
<div class="line"><a name="l05128"></a><span class="lineno"> 5128</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l05129"></a><span class="lineno"> 5129</span>&#160;<span class="comment">/////////////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l05130"></a><span class="lineno"> 5130</span>&#160;<span class="comment">/// General C1CurvedElement class  ///</span></div>
<div class="line"><a name="l05131"></a><span class="lineno"> 5131</span>&#160;<span class="comment">/// Empty, just establishes the template parameters</span></div>
<div class="line"><a name="l05132"></a><span class="lineno"> 5132</span>&#160;<span class="comment">/////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l05133"></a><span class="lineno"> 5133</span>&#160;<span class="comment"></span><span class="keyword">template</span>&lt;<span class="keywordtype">unsigned</span> DIM, <span class="keywordtype">unsigned</span> NNODE_1D&gt;</div>
<div class="line"><a name="l05134"></a><span class="lineno"><a class="line" href="classoomph_1_1C1CurvedElement.html"> 5134</a></span>&#160;<span class="keyword">class </span><a class="code" href="classoomph_1_1C1CurvedElement.html">C1CurvedElement</a> {};</div>
<div class="line"><a name="l05135"></a><span class="lineno"> 5135</span>&#160; </div>
<div class="line"><a name="l05136"></a><span class="lineno"> 5136</span>&#160;<span class="comment">//=======================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l05137"></a><span class="lineno"> 5137</span>&#160;<span class="comment">/// C1CurvedElement elements, specialised to two spatial dimensions</span></div>
<div class="line"><a name="l05138"></a><span class="lineno"> 5138</span>&#160;<span class="comment"></span><span class="comment">//=======================================================================</span></div>
<div class="line"><a name="l05139"></a><span class="lineno"> 5139</span>&#160;<span class="keyword">template</span>&lt;<span class="keywordtype">unsigned</span> NNODE_1D&gt;</div>
<div class="line"><a name="l05140"></a><span class="lineno"><a class="line" href="classoomph_1_1C1CurvedElement_3_012_00_01NNODE__1D_01_4.html"> 5140</a></span>&#160;<span class="keyword">class </span><a class="code" href="classoomph_1_1C1CurvedElement.html">C1CurvedElement</a>&lt;2,NNODE_1D&gt; : <span class="keyword">public</span> <span class="keyword">virtual</span> <a class="code" href="classoomph_1_1C1CurvedElementBase.html">C1CurvedElementBase</a>&lt;NNODE_1D&gt;, <span class="keyword">public</span> <span class="keyword">virtual</span> <a class="code" href="classoomph_1_1TElement.html">TElement</a>&lt;2,NNODE_1D&gt;, <span class="keyword">public</span> <span class="keyword">virtual</span> <a class="code" href="classoomph_1_1GeometricTElement.html">GeometricTElement</a>&lt;2&gt;, <span class="keyword">public</span> <span class="keyword">virtual</span> <a class="code" href="classoomph_1_1C1CurvedElementShape.html">C1CurvedElementShape</a>&lt;2,NNODE_1D&gt;, <span class="keyword">public</span> <span class="keyword">virtual</span> <a class="code" href="classoomph_1_1BellElementShape.html">BellElementShape</a>&lt;2&gt;</div>
<div class="line"><a name="l05141"></a><span class="lineno"> 5141</span>&#160;{</div>
<div class="line"><a name="l05142"></a><span class="lineno"> 5142</span>&#160; <span class="keyword">private</span>:<span class="comment"></span></div>
<div class="line"><a name="l05143"></a><span class="lineno"> 5143</span>&#160;<span class="comment"> /// Nodal translation scheme for use when generating face elements</span></div>
<div class="line"><a name="l05144"></a><span class="lineno"><a class="line" href="classoomph_1_1C1CurvedElement_3_012_00_01NNODE__1D_01_4.html#a7af342e536c2474e8377eab50c29415a"> 5144</a></span>&#160;<span class="comment"></span> <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> NodeOnFace[3][NNODE_1D];</div>
<div class="line"><a name="l05145"></a><span class="lineno"> 5145</span>&#160; </div>
<div class="line"><a name="l05146"></a><span class="lineno"> 5146</span>&#160; public :</div>
<div class="line"><a name="l05147"></a><span class="lineno"> 5147</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l05148"></a><span class="lineno"> 5148</span>&#160;<span class="comment"> ///\short  Constructor: Call constructors for C1CurvedElement </span></div>
<div class="line"><a name="l05149"></a><span class="lineno"><a class="line" href="classoomph_1_1C1CurvedElement_3_012_00_01NNODE__1D_01_4.html#a4e389db9bdba834069675c79661e15fc"> 5149</a></span>&#160;<span class="comment"></span> <a class="code" href="classoomph_1_1C1CurvedElement_3_012_00_01NNODE__1D_01_4.html#a4e389db9bdba834069675c79661e15fc">C1CurvedElement</a>() : <a class="code" href="classoomph_1_1C1CurvedElementBase.html">C1CurvedElementBase</a>&lt;NNODE_1D&gt;(), <a class="code" href="classoomph_1_1TElement.html">TElement</a>&lt;2,NNODE_1D&gt;(), </div>
<div class="line"><a name="l05150"></a><span class="lineno"> 5150</span>&#160;  <a class="code" href="classoomph_1_1GeometricTElement.html">GeometricTElement</a>&lt;2&gt;(), <a class="code" href="classoomph_1_1C1CurvedElementShape.html">C1CurvedElementShape</a>&lt;2,NNODE_1D&gt;(),<a class="code" href="classoomph_1_1BellElementShape.html">BellElementShape</a>&lt;2&gt;()</div>
<div class="line"><a name="l05151"></a><span class="lineno"> 5151</span>&#160;  {</div>
<div class="line"><a name="l05152"></a><span class="lineno"> 5152</span>&#160;   <span class="comment">// Number of nodes</span></div>
<div class="line"><a name="l05153"></a><span class="lineno"> 5153</span>&#160;   <span class="keywordflow">switch</span> (NNODE_1D)</div>
<div class="line"><a name="l05154"></a><span class="lineno"> 5154</span>&#160;    {</div>
<div class="line"><a name="l05155"></a><span class="lineno"> 5155</span>&#160;    <span class="keywordflow">case</span> 2:</div>
<div class="line"><a name="l05156"></a><span class="lineno"> 5156</span>&#160;    <span class="keywordflow">case</span> 3:</div>
<div class="line"><a name="l05157"></a><span class="lineno"> 5157</span>&#160;     <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05158"></a><span class="lineno"> 5158</span>&#160;     </div>
<div class="line"><a name="l05159"></a><span class="lineno"> 5159</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l05160"></a><span class="lineno"> 5160</span>&#160;     <a class="code" href="namespaceoomph_1_1Global__string__for__annotation.html#ac5379de2fa7fe44f2cb31785fc208135">std::string</a> error_message =</div>
<div class="line"><a name="l05161"></a><span class="lineno"> 5161</span>&#160;      <span class="stringliteral">&quot;Triangles are currently only implemented for\n&quot;</span>;</div>
<div class="line"><a name="l05162"></a><span class="lineno"> 5162</span>&#160;     error_message +=</div>
<div class="line"><a name="l05163"></a><span class="lineno"> 5163</span>&#160;      <span class="stringliteral">&quot;three vertices and three internal nodes, i.e. NNODE_1D=2,3 only\n&quot;</span>;</div>
<div class="line"><a name="l05164"></a><span class="lineno"> 5164</span>&#160;     </div>
<div class="line"><a name="l05165"></a><span class="lineno"> 5165</span>&#160;     <span class="keywordflow">throw</span> <a class="code" href="classoomph_1_1OomphLibError.html">OomphLibError</a>(error_message,</div>
<div class="line"><a name="l05166"></a><span class="lineno"> 5166</span>&#160;                         <span class="stringliteral">&quot;CurvedTElement::CurvedTElement()&quot;</span>,</div>
<div class="line"><a name="l05167"></a><span class="lineno"> 5167</span>&#160;                         OOMPH_EXCEPTION_LOCATION);</div>
<div class="line"><a name="l05168"></a><span class="lineno"> 5168</span>&#160;    }</div>
<div class="line"><a name="l05169"></a><span class="lineno"> 5169</span>&#160; </div>
<div class="line"><a name="l05170"></a><span class="lineno"> 5170</span>&#160;   <span class="comment">// Set the number of nodes</span></div>
<div class="line"><a name="l05171"></a><span class="lineno"> 5171</span>&#160;   <span class="keywordtype">unsigned</span> n_node = (NNODE_1D*(NNODE_1D+1))/2 + 3;</div>
<div class="line"><a name="l05172"></a><span class="lineno"> 5172</span>&#160;   this-&gt;set_n_node(n_node);</div>
<div class="line"><a name="l05173"></a><span class="lineno"> 5173</span>&#160;   <span class="comment">// Set the elemental and nodal dimension</span></div>
<div class="line"><a name="l05174"></a><span class="lineno"> 5174</span>&#160;   this-&gt;set_dimension(2);</div>
<div class="line"><a name="l05175"></a><span class="lineno"> 5175</span>&#160;   <span class="comment">//Set the number of types required to interpolate the coordinate</span></div>
<div class="line"><a name="l05176"></a><span class="lineno"> 5176</span>&#160;   this-&gt;set_nnodal_position_type(6);</div>
<div class="line"><a name="l05177"></a><span class="lineno"> 5177</span>&#160;   <a class="code" href="classoomph_1_1TGauss_3_012_00_015_01_4.html">TGauss&lt;2,5&gt;</a>* new_integral_pt = <span class="keyword">new</span> <a class="code" href="classoomph_1_1TGauss_3_012_00_015_01_4.html">TGauss&lt;2,5&gt;</a>;</div>
<div class="line"><a name="l05178"></a><span class="lineno"> 5178</span>&#160;   this-&gt;set_integration_scheme(new_integral_pt); </div>
<div class="line"><a name="l05179"></a><span class="lineno"> 5179</span>&#160;  }</div>
<div class="line"><a name="l05180"></a><span class="lineno"> 5180</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l05181"></a><span class="lineno"> 5181</span>&#160;<span class="comment"> /// Broken copy constructor</span></div>
<div class="line"><a name="l05182"></a><span class="lineno"><a class="line" href="classoomph_1_1C1CurvedElement_3_012_00_01NNODE__1D_01_4.html#a0d00b19541ec32162c0d096fef8fcf74"> 5182</a></span>&#160;<span class="comment"></span> <a class="code" href="classoomph_1_1C1CurvedElement_3_012_00_01NNODE__1D_01_4.html#a0d00b19541ec32162c0d096fef8fcf74">C1CurvedElement</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1C1CurvedElement.html">C1CurvedElement</a>&amp;) </div>
<div class="line"><a name="l05183"></a><span class="lineno"> 5183</span>&#160;  { </div>
<div class="line"><a name="l05184"></a><span class="lineno"> 5184</span>&#160;   <a class="code" href="namespaceoomph_1_1BrokenCopy.html#a7e5cd7fda8b8c790003151bee77a84ac">BrokenCopy::broken_copy</a>(<span class="stringliteral">&quot;C1CurvedElement&quot;</span>);</div>
<div class="line"><a name="l05185"></a><span class="lineno"> 5185</span>&#160;  } </div>
<div class="line"><a name="l05186"></a><span class="lineno"> 5186</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l05187"></a><span class="lineno"> 5187</span>&#160;<span class="comment"> /// Broken assignment operator</span></div>
<div class="line"><a name="l05188"></a><span class="lineno"><a class="line" href="classoomph_1_1C1CurvedElement_3_012_00_01NNODE__1D_01_4.html#a2c69150bcb82422fb38db3eeea3b0606"> 5188</a></span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1C1CurvedElement_3_012_00_01NNODE__1D_01_4.html#a2c69150bcb82422fb38db3eeea3b0606">operator=</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1C1CurvedElement.html">C1CurvedElement</a>&amp;) </div>
<div class="line"><a name="l05189"></a><span class="lineno"> 5189</span>&#160;  {</div>
<div class="line"><a name="l05190"></a><span class="lineno"> 5190</span>&#160;   <a class="code" href="namespaceoomph_1_1BrokenCopy.html#a32dc384e671e786bac0c67cbff701f45">BrokenCopy::broken_assign</a>(<span class="stringliteral">&quot;C1CurvedElement&quot;</span>);</div>
<div class="line"><a name="l05191"></a><span class="lineno"> 5191</span>&#160;  }<span class="comment"></span></div>
<div class="line"><a name="l05192"></a><span class="lineno"> 5192</span>&#160;<span class="comment"> /// Destructor</span></div>
<div class="line"><a name="l05193"></a><span class="lineno"><a class="line" href="classoomph_1_1C1CurvedElement_3_012_00_01NNODE__1D_01_4.html#a32a0cf8b60d16d887d5fc3ed261c2147"> 5193</a></span>&#160;<span class="comment"></span> <a class="code" href="classoomph_1_1C1CurvedElement_3_012_00_01NNODE__1D_01_4.html#a32a0cf8b60d16d887d5fc3ed261c2147">~C1CurvedElement</a>() {}</div>
<div class="line"><a name="l05194"></a><span class="lineno"> 5194</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l05195"></a><span class="lineno"> 5195</span>&#160;<span class="comment"> /// Number of nodes along each element edge</span></div>
<div class="line"><a name="l05196"></a><span class="lineno"><a class="line" href="classoomph_1_1C1CurvedElement_3_012_00_01NNODE__1D_01_4.html#a3e7e8460e53e261ff68ac58ea57dfc87"> 5196</a></span>&#160;<span class="comment"></span> <span class="keywordtype">unsigned</span> <a class="code" href="classoomph_1_1C1CurvedElement_3_012_00_01NNODE__1D_01_4.html#a3e7e8460e53e261ff68ac58ea57dfc87">nnode_1d</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> NNODE_1D;}</div>
<div class="line"><a name="l05197"></a><span class="lineno"> 5197</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l05198"></a><span class="lineno"> 5198</span>&#160;<span class="comment"> /// \short Number of vertex nodes in the element: One more</span></div>
<div class="line"><a name="l05199"></a><span class="lineno"> 5199</span>&#160;<span class="comment"> /// than spatial dimension</span></div>
<div class="line"><a name="l05200"></a><span class="lineno"><a class="line" href="classoomph_1_1C1CurvedElement_3_012_00_01NNODE__1D_01_4.html#abc52b97fb811db2bdb58661442dbffdf"> 5200</a></span>&#160;<span class="comment"></span> <span class="keywordtype">unsigned</span> <a class="code" href="classoomph_1_1C1CurvedElement_3_012_00_01NNODE__1D_01_4.html#abc52b97fb811db2bdb58661442dbffdf">nvertex_node</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> 3;}</div>
<div class="line"><a name="l05201"></a><span class="lineno"> 5201</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l05202"></a><span class="lineno"> 5202</span>&#160;<span class="comment"> /// Number of internal nodes </span></div>
<div class="line"><a name="l05203"></a><span class="lineno"><a class="line" href="classoomph_1_1C1CurvedElement_3_012_00_01NNODE__1D_01_4.html#a038bf547d8348358f795f52cd3b7fb99"> 5203</a></span>&#160;<span class="comment"></span> <span class="keywordtype">unsigned</span> <a class="code" href="classoomph_1_1C1CurvedElement_3_012_00_01NNODE__1D_01_4.html#a038bf547d8348358f795f52cd3b7fb99">ninternal_node</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> 3;}</div>
<div class="line"><a name="l05204"></a><span class="lineno"> 5204</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l05205"></a><span class="lineno"> 5205</span>&#160;<span class="comment"> /// \short Pointer to the j-th vertex node in the element</span></div>
<div class="line"><a name="l05206"></a><span class="lineno"><a class="line" href="classoomph_1_1C1CurvedElement_3_012_00_01NNODE__1D_01_4.html#a0fe82acd4ccebb368f96c657927063c8"> 5206</a></span>&#160;<span class="comment"></span> <a class="code" href="classoomph_1_1Node.html">Node</a>* <a class="code" href="classoomph_1_1C1CurvedElement_3_012_00_01NNODE__1D_01_4.html#a0fe82acd4ccebb368f96c657927063c8">vertex_node_pt</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; j)<span class="keyword"> const</span></div>
<div class="line"><a name="l05207"></a><span class="lineno"> 5207</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l05208"></a><span class="lineno"> 5208</span>&#160;   <span class="comment">// Vertex nodes come first:</span></div>
<div class="line"><a name="l05209"></a><span class="lineno"> 5209</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l05210"></a><span class="lineno"> 5210</span>&#160;   <span class="keywordflow">if</span> (j&gt;2)</div>
<div class="line"><a name="l05211"></a><span class="lineno"> 5211</span>&#160;    {</div>
<div class="line"><a name="l05212"></a><span class="lineno"> 5212</span>&#160;     std::ostringstream error_message;</div>
<div class="line"><a name="l05213"></a><span class="lineno"> 5213</span>&#160;     error_message </div>
<div class="line"><a name="l05214"></a><span class="lineno"> 5214</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;Element only has three vertex nodes; called with node number &quot;</span> </div>
<div class="line"><a name="l05215"></a><span class="lineno"> 5215</span>&#160;      &lt;&lt; j &lt;&lt; std::endl;     </div>
<div class="line"><a name="l05216"></a><span class="lineno"> 5216</span>&#160;     <span class="keywordflow">throw</span> <a class="code" href="classoomph_1_1OomphLibError.html">OomphLibError</a>(error_message.str(),</div>
<div class="line"><a name="l05217"></a><span class="lineno"> 5217</span>&#160;                         <span class="stringliteral">&quot;TElement::vertex_node_pt()&quot;</span>,</div>
<div class="line"><a name="l05218"></a><span class="lineno"> 5218</span>&#160;                         OOMPH_EXCEPTION_LOCATION);</div>
<div class="line"><a name="l05219"></a><span class="lineno"> 5219</span>&#160;    }</div>
<div class="line"><a name="l05220"></a><span class="lineno"> 5220</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l05221"></a><span class="lineno"> 5221</span>&#160;   <span class="keywordflow">return</span> this-&gt;node_pt(j);</div>
<div class="line"><a name="l05222"></a><span class="lineno"> 5222</span>&#160;  }</div>
<div class="line"><a name="l05223"></a><span class="lineno"> 5223</span>&#160; </div>
<div class="line"><a name="l05224"></a><span class="lineno"> 5224</span>&#160; <span class="comment">// Classify nodes on the element: boundary nodes and non-boundary nodes</span></div>
<div class="line"><a name="l05225"></a><span class="lineno"><a class="line" href="classoomph_1_1C1CurvedElement_3_012_00_01NNODE__1D_01_4.html#ab7642a52d95f8b554f614b6fc5710a35"> 5225</a></span>&#160; <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1C1CurvedElement_3_012_00_01NNODE__1D_01_4.html#ab7642a52d95f8b554f614b6fc5710a35">classify_boundary_node</a>(<a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> &amp;node_position,</div>
<div class="line"><a name="l05226"></a><span class="lineno"> 5226</span>&#160;                                    <span class="keywordtype">unsigned</span> &amp;bd_element, <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> &amp;bd_node_position, <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;x)<span class="keyword"> const</span></div>
<div class="line"><a name="l05227"></a><span class="lineno"> 5227</span>&#160;<span class="keyword">  </span>{<span class="comment"></span></div>
<div class="line"><a name="l05228"></a><span class="lineno"> 5228</span>&#160;<span class="comment">   /// Number of nodes along each element edge: Just for the three vertices not the internal points</span></div>
<div class="line"><a name="l05229"></a><span class="lineno"> 5229</span>&#160;<span class="comment"></span>   <span class="keywordtype">unsigned</span> n_node = 3;<span class="comment"></span></div>
<div class="line"><a name="l05230"></a><span class="lineno"> 5230</span>&#160;<span class="comment">   /// Loop over vertices</span></div>
<div class="line"><a name="l05231"></a><span class="lineno"> 5231</span>&#160;<span class="comment"></span>   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l=0;l&lt;n_node;l++)</div>
<div class="line"><a name="l05232"></a><span class="lineno"> 5232</span>&#160;    {</div>
<div class="line"><a name="l05233"></a><span class="lineno"> 5233</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> k=0;k&lt;1;k++)</div>
<div class="line"><a name="l05234"></a><span class="lineno"> 5234</span>&#160;      {</div>
<div class="line"><a name="l05235"></a><span class="lineno"> 5235</span>&#160;       <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> j=0;j&lt;2;j++)</div>
<div class="line"><a name="l05236"></a><span class="lineno"> 5236</span>&#160;        {</div>
<div class="line"><a name="l05237"></a><span class="lineno"> 5237</span>&#160;         node_position(l,j) = this-&gt;raw_nodal_position_gen(l,k,j);</div>
<div class="line"><a name="l05238"></a><span class="lineno"> 5238</span>&#160;        }</div>
<div class="line"><a name="l05239"></a><span class="lineno"> 5239</span>&#160;      }</div>
<div class="line"><a name="l05240"></a><span class="lineno"> 5240</span>&#160;    }</div>
<div class="line"><a name="l05241"></a><span class="lineno"> 5241</span>&#160;   </div>
<div class="line"><a name="l05242"></a><span class="lineno"> 5242</span>&#160;   <span class="keywordtype">int</span> count=0;</div>
<div class="line"><a name="l05243"></a><span class="lineno"> 5243</span>&#160;     </div>
<div class="line"><a name="l05244"></a><span class="lineno"> 5244</span>&#160;   <span class="comment">// check whether this element is on boundary or not</span></div>
<div class="line"><a name="l05245"></a><span class="lineno"> 5245</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;n_node;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l05246"></a><span class="lineno"> 5246</span>&#160;    {</div>
<div class="line"><a name="l05247"></a><span class="lineno"> 5247</span>&#160;     <span class="comment">// check whether this node is on 1st boundary (curve boundary)</span></div>
<div class="line"><a name="l05248"></a><span class="lineno"> 5248</span>&#160;     <span class="keywordtype">bool</span> bd_node1 = this-&gt;node_pt(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>)-&gt;is_on_boundary(1);</div>
<div class="line"><a name="l05249"></a><span class="lineno"> 5249</span>&#160;     <span class="keywordflow">if</span>(bd_node1==1)</div>
<div class="line"><a name="l05250"></a><span class="lineno"> 5250</span>&#160;      {</div>
<div class="line"><a name="l05251"></a><span class="lineno"> 5251</span>&#160;       count += 1;</div>
<div class="line"><a name="l05252"></a><span class="lineno"> 5252</span>&#160;       <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> k=0;k&lt;1;k++)</div>
<div class="line"><a name="l05253"></a><span class="lineno"> 5253</span>&#160;        {</div>
<div class="line"><a name="l05254"></a><span class="lineno"> 5254</span>&#160;         <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> j=0;j&lt;2;j++)</div>
<div class="line"><a name="l05255"></a><span class="lineno"> 5255</span>&#160;          {</div>
<div class="line"><a name="l05256"></a><span class="lineno"> 5256</span>&#160;           bd_node_position(count-1,j) = this-&gt;raw_nodal_position_gen(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>,k,j);</div>
<div class="line"><a name="l05257"></a><span class="lineno"> 5257</span>&#160;          }</div>
<div class="line"><a name="l05258"></a><span class="lineno"> 5258</span>&#160;        }</div>
<div class="line"><a name="l05259"></a><span class="lineno"> 5259</span>&#160;      }</div>
<div class="line"><a name="l05260"></a><span class="lineno"> 5260</span>&#160;     <span class="keywordflow">else</span></div>
<div class="line"><a name="l05261"></a><span class="lineno"> 5261</span>&#160;      {</div>
<div class="line"><a name="l05262"></a><span class="lineno"> 5262</span>&#160;       <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> k=0;k&lt;1;k++)</div>
<div class="line"><a name="l05263"></a><span class="lineno"> 5263</span>&#160;        {</div>
<div class="line"><a name="l05264"></a><span class="lineno"> 5264</span>&#160;         <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> j=0;j&lt;2;j++)</div>
<div class="line"><a name="l05265"></a><span class="lineno"> 5265</span>&#160;          {</div>
<div class="line"><a name="l05266"></a><span class="lineno"> 5266</span>&#160;           x[j] = this-&gt;raw_nodal_position_gen(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>,k,j);</div>
<div class="line"><a name="l05267"></a><span class="lineno"> 5267</span>&#160;          }</div>
<div class="line"><a name="l05268"></a><span class="lineno"> 5268</span>&#160;        }</div>
<div class="line"><a name="l05269"></a><span class="lineno"> 5269</span>&#160;      }</div>
<div class="line"><a name="l05270"></a><span class="lineno"> 5270</span>&#160;    }</div>
<div class="line"><a name="l05271"></a><span class="lineno"> 5271</span>&#160;   <span class="keywordflow">if</span>(count == 2)<span class="comment">// this case is a boundary element</span></div>
<div class="line"><a name="l05272"></a><span class="lineno"> 5272</span>&#160;    {</div>
<div class="line"><a name="l05273"></a><span class="lineno"> 5273</span>&#160;     bd_element = 1;</div>
<div class="line"><a name="l05274"></a><span class="lineno"> 5274</span>&#160;    }          </div>
<div class="line"><a name="l05275"></a><span class="lineno"> 5275</span>&#160;   <span class="keywordflow">else</span></div>
<div class="line"><a name="l05276"></a><span class="lineno"> 5276</span>&#160;    {</div>
<div class="line"><a name="l05277"></a><span class="lineno"> 5277</span>&#160;     bd_element = 0;           </div>
<div class="line"><a name="l05278"></a><span class="lineno"> 5278</span>&#160;    }               </div>
<div class="line"><a name="l05279"></a><span class="lineno"> 5279</span>&#160;  }</div>
<div class="line"><a name="l05280"></a><span class="lineno"> 5280</span>&#160; </div>
<div class="line"><a name="l05281"></a><span class="lineno"> 5281</span>&#160; <span class="comment">// assign the set of value for a curved element</span></div>
<div class="line"><a name="l05282"></a><span class="lineno"><a class="line" href="classoomph_1_1C1CurvedElement_3_012_00_01NNODE__1D_01_4.html#a4cb17f4e7f9253ff739a6102f1f39158"> 5282</a></span>&#160; <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1C1CurvedElement_3_012_00_01NNODE__1D_01_4.html#a4cb17f4e7f9253ff739a6102f1f39158">get_value_transform_matrix</a>(<a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> &amp;<a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a51292b8e4d96f2bb9f0d6bb0340d1620">D</a>, <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> &amp;<a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a43c804e2bcf9862a4bf629d5f01761e8">B</a>, <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> &amp;node_position,</div>
<div class="line"><a name="l05283"></a><span class="lineno"> 5283</span>&#160;                                          <span class="keywordtype">unsigned</span> &amp;bd_element, <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> &amp;bd_node_position, <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;x)<span class="keyword"> const</span></div>
<div class="line"><a name="l05284"></a><span class="lineno"> 5284</span>&#160;<span class="keyword">  </span>{<span class="comment"></span></div>
<div class="line"><a name="l05285"></a><span class="lineno"> 5285</span>&#160;<span class="comment">   /// classify nodes in the element</span></div>
<div class="line"><a name="l05286"></a><span class="lineno"> 5286</span>&#160;<span class="comment"></span>   classify_boundary_node(node_position,bd_element,bd_node_position,x);<span class="comment"></span></div>
<div class="line"><a name="l05287"></a><span class="lineno"> 5287</span>&#160;<span class="comment">   /// compute the set of value of degree of freedom</span></div>
<div class="line"><a name="l05288"></a><span class="lineno"> 5288</span>&#160;<span class="comment"></span>   <a class="code" href="classoomph_1_1C1CurvedElementShape.html">C1CurvedElementShape&lt;2,NNODE_1D&gt;::set_of_value</a>(<a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a51292b8e4d96f2bb9f0d6bb0340d1620">D</a>,<a class="code" href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a43c804e2bcf9862a4bf629d5f01761e8">B</a>,node_position,bd_element,bd_node_position,x); </div>
<div class="line"><a name="l05289"></a><span class="lineno"> 5289</span>&#160;  }</div>
<div class="line"><a name="l05290"></a><span class="lineno"> 5290</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l05291"></a><span class="lineno"> 5291</span>&#160;<span class="comment"> /// Return local coordinates of node j</span></div>
<div class="line"><a name="l05292"></a><span class="lineno"><a class="line" href="classoomph_1_1C1CurvedElement_3_012_00_01NNODE__1D_01_4.html#a155a6dffffa34a092753697098bafb57"> 5292</a></span>&#160;<span class="comment"></span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1C1CurvedElement_3_012_00_01NNODE__1D_01_4.html#a155a6dffffa34a092753697098bafb57">local_coordinate_of_node</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; j,<a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>)<span class="keyword"> const</span></div>
<div class="line"><a name="l05293"></a><span class="lineno"> 5293</span>&#160;<span class="keyword">  </span>{<a class="code" href="classoomph_1_1C1CurvedElementShape.html">C1CurvedElementShape&lt;2,NNODE_1D&gt;::local_coordinate_of_node</a>(j,<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>);}</div>
<div class="line"><a name="l05294"></a><span class="lineno"> 5294</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l05295"></a><span class="lineno"> 5295</span>&#160;<span class="comment"> /// Calculate the c1-shape functions associated with a straight-sided </span></div>
<div class="line"><a name="l05296"></a><span class="lineno"> 5296</span>&#160;<span class="comment"> /// boundary at local coordinate s</span></div>
<div class="line"><a name="l05297"></a><span class="lineno"><a class="line" href="classoomph_1_1C1CurvedElement_3_012_00_01NNODE__1D_01_4.html#a68d0f04ce0ead20ed00c0925e2ac89db"> 5297</a></span>&#160;<span class="comment"></span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1C1CurvedElement_3_012_00_01NNODE__1D_01_4.html#a68d0f04ce0ead20ed00c0925e2ac89db">basis_straight</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>, <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;psi)<span class="keyword"> const</span></div>
<div class="line"><a name="l05298"></a><span class="lineno"> 5298</span>&#160;<span class="keyword">  </span>{<span class="comment"></span></div>
<div class="line"><a name="l05299"></a><span class="lineno"> 5299</span>&#160;<span class="comment">   /// classify nodes in the element</span></div>
<div class="line"><a name="l05300"></a><span class="lineno"> 5300</span>&#160;<span class="comment"></span>   <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> node_position(3,2);</div>
<div class="line"><a name="l05301"></a><span class="lineno"> 5301</span>&#160;   <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> bd_node_position(20,2);</div>
<div class="line"><a name="l05302"></a><span class="lineno"> 5302</span>&#160;   <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> x(2);</div>
<div class="line"><a name="l05303"></a><span class="lineno"> 5303</span>&#160;   <span class="keywordtype">unsigned</span> bd_element;</div>
<div class="line"><a name="l05304"></a><span class="lineno"> 5304</span>&#160;   classify_boundary_node(node_position,bd_element,bd_node_position,x);</div>
<div class="line"><a name="l05305"></a><span class="lineno"> 5305</span>&#160;   <a class="code" href="classoomph_1_1BellElementShape.html">BellElementShape&lt;2&gt;::Bshape</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,psi,node_position);</div>
<div class="line"><a name="l05306"></a><span class="lineno"> 5306</span>&#160;  }</div>
<div class="line"><a name="l05307"></a><span class="lineno"> 5307</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l05308"></a><span class="lineno"> 5308</span>&#160;<span class="comment"> /// \short Compute the c1-shape functions associated with a straight-sided </span></div>
<div class="line"><a name="l05309"></a><span class="lineno"> 5309</span>&#160;<span class="comment"> /// boundary and derivatives w.r.t. global coordinates at local coordinate s</span></div>
<div class="line"><a name="l05310"></a><span class="lineno"><a class="line" href="classoomph_1_1C1CurvedElement_3_012_00_01NNODE__1D_01_4.html#af4a862475f941e4bc210e8e366d5dffc"> 5310</a></span>&#160;<span class="comment"></span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1C1CurvedElement_3_012_00_01NNODE__1D_01_4.html#af4a862475f941e4bc210e8e366d5dffc">dbasis_local_straight</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>, <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;psi, </div>
<div class="line"><a name="l05311"></a><span class="lineno"> 5311</span>&#160;                          <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;dpsids)<span class="keyword"> const</span></div>
<div class="line"><a name="l05312"></a><span class="lineno"> 5312</span>&#160;<span class="keyword">  </span>{<span class="comment"></span></div>
<div class="line"><a name="l05313"></a><span class="lineno"> 5313</span>&#160;<span class="comment">   /// classify nodes in the element</span></div>
<div class="line"><a name="l05314"></a><span class="lineno"> 5314</span>&#160;<span class="comment"></span>   <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> node_position(3,2);</div>
<div class="line"><a name="l05315"></a><span class="lineno"> 5315</span>&#160;   <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> bd_node_position(20,2);</div>
<div class="line"><a name="l05316"></a><span class="lineno"> 5316</span>&#160;   <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> x(2);</div>
<div class="line"><a name="l05317"></a><span class="lineno"> 5317</span>&#160;   <span class="keywordtype">unsigned</span> bd_element;</div>
<div class="line"><a name="l05318"></a><span class="lineno"> 5318</span>&#160;   classify_boundary_node(node_position,bd_element,bd_node_position,x);</div>
<div class="line"><a name="l05319"></a><span class="lineno"> 5319</span>&#160;   <a class="code" href="classoomph_1_1BellElementShape.html">BellElementShape&lt;2&gt;::dBshape_local</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,psi,dpsids,node_position);</div>
<div class="line"><a name="l05320"></a><span class="lineno"> 5320</span>&#160;  }</div>
<div class="line"><a name="l05321"></a><span class="lineno"> 5321</span>&#160;  <span class="comment"></span></div>
<div class="line"><a name="l05322"></a><span class="lineno"> 5322</span>&#160;<span class="comment">  /// \short Compute the c1-shape functions associated with a straight-sided </span></div>
<div class="line"><a name="l05323"></a><span class="lineno"> 5323</span>&#160;<span class="comment"> /// boundary and derivatives w.r.t. global coordinates at local coordinate s</span></div>
<div class="line"><a name="l05324"></a><span class="lineno"><a class="line" href="classoomph_1_1C1CurvedElement_3_012_00_01NNODE__1D_01_4.html#a4fc4db790fca7513a3e8ceb0a7a61507"> 5324</a></span>&#160;<span class="comment"></span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1C1CurvedElement_3_012_00_01NNODE__1D_01_4.html#a4fc4db790fca7513a3e8ceb0a7a61507">d2basis_local_straight</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>, <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;psi, </div>
<div class="line"><a name="l05325"></a><span class="lineno"> 5325</span>&#160;                          <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;dpsids, <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;d2psids)<span class="keyword"> const</span></div>
<div class="line"><a name="l05326"></a><span class="lineno"> 5326</span>&#160;<span class="keyword">  </span>{<span class="comment"></span></div>
<div class="line"><a name="l05327"></a><span class="lineno"> 5327</span>&#160;<span class="comment">   /// classify nodes in the element</span></div>
<div class="line"><a name="l05328"></a><span class="lineno"> 5328</span>&#160;<span class="comment"></span>   <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> node_position(3,2);</div>
<div class="line"><a name="l05329"></a><span class="lineno"> 5329</span>&#160;   <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> bd_node_position(20,2);</div>
<div class="line"><a name="l05330"></a><span class="lineno"> 5330</span>&#160;   <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> x(2);</div>
<div class="line"><a name="l05331"></a><span class="lineno"> 5331</span>&#160;   <span class="keywordtype">unsigned</span> bd_element;</div>
<div class="line"><a name="l05332"></a><span class="lineno"> 5332</span>&#160;   classify_boundary_node(node_position,bd_element,bd_node_position,x);</div>
<div class="line"><a name="l05333"></a><span class="lineno"> 5333</span>&#160;   <a class="code" href="classoomph_1_1BellElementShape.html">BellElementShape&lt;2&gt;::d2Bshape_local</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,psi,dpsids,d2psids,node_position);</div>
<div class="line"><a name="l05334"></a><span class="lineno"> 5334</span>&#160;  }</div>
<div class="line"><a name="l05335"></a><span class="lineno"> 5335</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l05336"></a><span class="lineno"> 5336</span>&#160;<span class="comment"> /// Calculate the c1-shape functions associated with a curved-sided </span></div>
<div class="line"><a name="l05337"></a><span class="lineno"> 5337</span>&#160;<span class="comment"> /// boundary at local coordinate s</span></div>
<div class="line"><a name="l05338"></a><span class="lineno"><a class="line" href="classoomph_1_1C1CurvedElement_3_012_00_01NNODE__1D_01_4.html#a97e774d78da4118400b554ddf59fdbeb"> 5338</a></span>&#160;<span class="comment"></span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1C1CurvedElement_3_012_00_01NNODE__1D_01_4.html#a97e774d78da4118400b554ddf59fdbeb">basis_curve</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>, <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;psi)<span class="keyword"> const</span></div>
<div class="line"><a name="l05339"></a><span class="lineno"> 5339</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l05340"></a><span class="lineno"> 5340</span>&#160;   <a class="code" href="classoomph_1_1C1CurvedElementShape.html">C1CurvedElementShape&lt;2,NNODE_1D&gt;::Cshape</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,psi); </div>
<div class="line"><a name="l05341"></a><span class="lineno"> 5341</span>&#160;  }</div>
<div class="line"><a name="l05342"></a><span class="lineno"> 5342</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l05343"></a><span class="lineno"> 5343</span>&#160;<span class="comment"> /// \short Compute the c1-shape functions associated with a curved-sided </span></div>
<div class="line"><a name="l05344"></a><span class="lineno"> 5344</span>&#160;<span class="comment"> /// boundary and derivatives w.r.t. local coordinates at local coordinate s</span></div>
<div class="line"><a name="l05345"></a><span class="lineno"><a class="line" href="classoomph_1_1C1CurvedElement_3_012_00_01NNODE__1D_01_4.html#acf9269ed50d607b0bd52efcca1848040"> 5345</a></span>&#160;<span class="comment"></span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1C1CurvedElement_3_012_00_01NNODE__1D_01_4.html#acf9269ed50d607b0bd52efcca1848040">dbasis_local_curve</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>, <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;psi, </div>
<div class="line"><a name="l05346"></a><span class="lineno"> 5346</span>&#160;                          <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;dpsids)<span class="keyword"> const</span></div>
<div class="line"><a name="l05347"></a><span class="lineno"> 5347</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l05348"></a><span class="lineno"> 5348</span>&#160;   <a class="code" href="classoomph_1_1C1CurvedElementShape.html">C1CurvedElementShape&lt;2,NNODE_1D&gt;::dCshape_local</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,psi,dpsids);</div>
<div class="line"><a name="l05349"></a><span class="lineno"> 5349</span>&#160;  }</div>
<div class="line"><a name="l05350"></a><span class="lineno"> 5350</span>&#160;  <span class="comment"></span></div>
<div class="line"><a name="l05351"></a><span class="lineno"> 5351</span>&#160;<span class="comment">  /// \short Compute the c1-shape functions associated with a curved-sided </span></div>
<div class="line"><a name="l05352"></a><span class="lineno"> 5352</span>&#160;<span class="comment"> /// boundary and derivatives w.r.t. local coordinates at local coordinate s</span></div>
<div class="line"><a name="l05353"></a><span class="lineno"><a class="line" href="classoomph_1_1C1CurvedElement_3_012_00_01NNODE__1D_01_4.html#aa0473d19ec3717e1628e85206497bb75"> 5353</a></span>&#160;<span class="comment"></span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1C1CurvedElement_3_012_00_01NNODE__1D_01_4.html#aa0473d19ec3717e1628e85206497bb75">d2basis_local_curve</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>, <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;psi, </div>
<div class="line"><a name="l05354"></a><span class="lineno"> 5354</span>&#160;                          <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;dpsids, <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;d2psids)<span class="keyword"> const</span></div>
<div class="line"><a name="l05355"></a><span class="lineno"> 5355</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l05356"></a><span class="lineno"> 5356</span>&#160;   <a class="code" href="classoomph_1_1C1CurvedElementShape.html">C1CurvedElementShape&lt;2,NNODE_1D&gt;::d2Cshape_local</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,psi,dpsids,d2psids);</div>
<div class="line"><a name="l05357"></a><span class="lineno"> 5357</span>&#160;  }</div>
<div class="line"><a name="l05358"></a><span class="lineno"> 5358</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l05359"></a><span class="lineno"> 5359</span>&#160;<span class="comment"> /// Calculate the linear shape functions at local coordinate s</span></div>
<div class="line"><a name="l05360"></a><span class="lineno"><a class="line" href="classoomph_1_1C1CurvedElement_3_012_00_01NNODE__1D_01_4.html#ab90480a9e420ce7507931376fca7dbba"> 5360</a></span>&#160;<span class="comment"></span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1C1CurvedElement_3_012_00_01NNODE__1D_01_4.html#ab90480a9e420ce7507931376fca7dbba">shape_geom</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>, <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;psi, <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;phi)<span class="keyword"> const</span></div>
<div class="line"><a name="l05361"></a><span class="lineno"> 5361</span>&#160;<span class="keyword">  </span>{<span class="comment"></span></div>
<div class="line"><a name="l05362"></a><span class="lineno"> 5362</span>&#160;<span class="comment">   /// classify nodes in the element</span></div>
<div class="line"><a name="l05363"></a><span class="lineno"> 5363</span>&#160;<span class="comment"></span>   <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> node_position(3,2);</div>
<div class="line"><a name="l05364"></a><span class="lineno"> 5364</span>&#160;   <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> bd_node_position(20,2);</div>
<div class="line"><a name="l05365"></a><span class="lineno"> 5365</span>&#160;   <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> x(2);</div>
<div class="line"><a name="l05366"></a><span class="lineno"> 5366</span>&#160;   <span class="keywordtype">unsigned</span> bd_element;</div>
<div class="line"><a name="l05367"></a><span class="lineno"> 5367</span>&#160;   classify_boundary_node(node_position,bd_element,bd_node_position,x);</div>
<div class="line"><a name="l05368"></a><span class="lineno"> 5368</span>&#160;   <span class="comment">// Calculate the geometric shape functions at local coordinate s</span></div>
<div class="line"><a name="l05369"></a><span class="lineno"> 5369</span>&#160;   <a class="code" href="classoomph_1_1GeometricTElement.html">GeometricTElement&lt;2&gt;::Lshape</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,psi,phi,node_position,bd_element,bd_node_position,x);</div>
<div class="line"><a name="l05370"></a><span class="lineno"> 5370</span>&#160;  }</div>
<div class="line"><a name="l05371"></a><span class="lineno"> 5371</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l05372"></a><span class="lineno"> 5372</span>&#160;<span class="comment"> /// \short Compute the linear functions and </span></div>
<div class="line"><a name="l05373"></a><span class="lineno"> 5373</span>&#160;<span class="comment"> /// derivatives w.r.t. local coordinates at local coordinate s</span></div>
<div class="line"><a name="l05374"></a><span class="lineno"><a class="line" href="classoomph_1_1C1CurvedElement_3_012_00_01NNODE__1D_01_4.html#ad7457d81744bbb7596ce70f7d1b576ce"> 5374</a></span>&#160;<span class="comment"></span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1C1CurvedElement_3_012_00_01NNODE__1D_01_4.html#ad7457d81744bbb7596ce70f7d1b576ce">dshape_local_geom</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>, <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;psi, </div>
<div class="line"><a name="l05375"></a><span class="lineno"> 5375</span>&#160;                          <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;dpsids, <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;phi, </div>
<div class="line"><a name="l05376"></a><span class="lineno"> 5376</span>&#160;                          <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;dphids)<span class="keyword"> const</span></div>
<div class="line"><a name="l05377"></a><span class="lineno"> 5377</span>&#160;<span class="keyword">  </span>{<span class="comment"></span></div>
<div class="line"><a name="l05378"></a><span class="lineno"> 5378</span>&#160;<span class="comment">   /// classify nodes in the element</span></div>
<div class="line"><a name="l05379"></a><span class="lineno"> 5379</span>&#160;<span class="comment"></span>   <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> node_position(3,2);</div>
<div class="line"><a name="l05380"></a><span class="lineno"> 5380</span>&#160;   <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> bd_node_position(20,2);</div>
<div class="line"><a name="l05381"></a><span class="lineno"> 5381</span>&#160;   <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> x(2);</div>
<div class="line"><a name="l05382"></a><span class="lineno"> 5382</span>&#160;   <span class="keywordtype">unsigned</span> bd_element;</div>
<div class="line"><a name="l05383"></a><span class="lineno"> 5383</span>&#160;   classify_boundary_node(node_position,bd_element,bd_node_position,x);</div>
<div class="line"><a name="l05384"></a><span class="lineno"> 5384</span>&#160;   <a class="code" href="classoomph_1_1GeometricTElement.html">GeometricTElement&lt;2&gt;::dLshape_local</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,psi,dpsids,phi,dphids,node_position,bd_element,bd_node_position,x);</div>
<div class="line"><a name="l05385"></a><span class="lineno"> 5385</span>&#160;  }</div>
<div class="line"><a name="l05386"></a><span class="lineno"> 5386</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l05387"></a><span class="lineno"> 5387</span>&#160;<span class="comment"> /// \short Compute the linear functions and </span></div>
<div class="line"><a name="l05388"></a><span class="lineno"> 5388</span>&#160;<span class="comment"> /// derivatives w.r.t. local coordinates at local coordinate s</span></div>
<div class="line"><a name="l05389"></a><span class="lineno"><a class="line" href="classoomph_1_1C1CurvedElement_3_012_00_01NNODE__1D_01_4.html#a075b64b7a480cf9839ae308764c5f355"> 5389</a></span>&#160;<span class="comment"></span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1C1CurvedElement_3_012_00_01NNODE__1D_01_4.html#a075b64b7a480cf9839ae308764c5f355">d2shape_local_geom</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>, <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;psi, </div>
<div class="line"><a name="l05390"></a><span class="lineno"> 5390</span>&#160;                          <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;dpsids, <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;d2psids, <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;phi, </div>
<div class="line"><a name="l05391"></a><span class="lineno"> 5391</span>&#160;                          <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;dphids, <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;d2phids)<span class="keyword"> const</span></div>
<div class="line"><a name="l05392"></a><span class="lineno"> 5392</span>&#160;<span class="keyword">  </span>{<span class="comment"></span></div>
<div class="line"><a name="l05393"></a><span class="lineno"> 5393</span>&#160;<span class="comment">   /// classify nodes in the element</span></div>
<div class="line"><a name="l05394"></a><span class="lineno"> 5394</span>&#160;<span class="comment"></span>   <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> node_position(3,2);</div>
<div class="line"><a name="l05395"></a><span class="lineno"> 5395</span>&#160;   <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> bd_node_position(20,2);</div>
<div class="line"><a name="l05396"></a><span class="lineno"> 5396</span>&#160;   <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> x(2);</div>
<div class="line"><a name="l05397"></a><span class="lineno"> 5397</span>&#160;   <span class="keywordtype">unsigned</span> bd_element;</div>
<div class="line"><a name="l05398"></a><span class="lineno"> 5398</span>&#160;   classify_boundary_node(node_position,bd_element,bd_node_position,x);</div>
<div class="line"><a name="l05399"></a><span class="lineno"> 5399</span>&#160;   <a class="code" href="classoomph_1_1GeometricTElement.html">GeometricTElement&lt;2&gt;::d2Lshape_local</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,psi,dpsids,d2psids,phi,dphids,d2phids,node_position,bd_element,bd_node_position,x);</div>
<div class="line"><a name="l05400"></a><span class="lineno"> 5400</span>&#160;  }</div>
<div class="line"><a name="l05401"></a><span class="lineno"> 5401</span>&#160;  <span class="comment"></span></div>
<div class="line"><a name="l05402"></a><span class="lineno"> 5402</span>&#160;<span class="comment"> /// Calculate the c0-shape functions at local coordinate s</span></div>
<div class="line"><a name="l05403"></a><span class="lineno"><a class="line" href="classoomph_1_1C1CurvedElement_3_012_00_01NNODE__1D_01_4.html#a88435c4bcf40bbe214598d76c88b49fc"> 5403</a></span>&#160;<span class="comment"></span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1C1CurvedElement_3_012_00_01NNODE__1D_01_4.html#a88435c4bcf40bbe214598d76c88b49fc">basis_c0</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>, <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;psi)<span class="keyword"> const</span></div>
<div class="line"><a name="l05404"></a><span class="lineno"> 5404</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l05405"></a><span class="lineno"> 5405</span>&#160;   <a class="code" href="namespaceoomph_1_1OneDimLagrange.html#a117f8b892dc89989ecdad99ff261e120">TElementShape&lt;2,NNODE_1D&gt;::shape</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,psi);</div>
<div class="line"><a name="l05406"></a><span class="lineno"> 5406</span>&#160;  }</div>
<div class="line"><a name="l05407"></a><span class="lineno"> 5407</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l05408"></a><span class="lineno"> 5408</span>&#160;<span class="comment"> /// \short Compute the c0-shape functions and </span></div>
<div class="line"><a name="l05409"></a><span class="lineno"> 5409</span>&#160;<span class="comment"> /// derivatives w.r.t. local coordinates at local coordinate s</span></div>
<div class="line"><a name="l05410"></a><span class="lineno"><a class="line" href="classoomph_1_1C1CurvedElement_3_012_00_01NNODE__1D_01_4.html#a51fd0d8ec09057548696aa99562b9f5a"> 5410</a></span>&#160;<span class="comment"></span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1C1CurvedElement_3_012_00_01NNODE__1D_01_4.html#a51fd0d8ec09057548696aa99562b9f5a">dbasis_c0_local</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>, <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;psi, </div>
<div class="line"><a name="l05411"></a><span class="lineno"> 5411</span>&#160;                          <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;dpsids)<span class="keyword"> const</span></div>
<div class="line"><a name="l05412"></a><span class="lineno"> 5412</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l05413"></a><span class="lineno"> 5413</span>&#160;   <a class="code" href="classoomph_1_1TElementShape.html">TElementShape&lt;2,NNODE_1D&gt;::dshape_local</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,psi,dpsids);</div>
<div class="line"><a name="l05414"></a><span class="lineno"> 5414</span>&#160;  }</div>
<div class="line"><a name="l05415"></a><span class="lineno"> 5415</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l05416"></a><span class="lineno"> 5416</span>&#160;<span class="comment"> /// \short Computer the c0-shape functions, derivatives and</span></div>
<div class="line"><a name="l05417"></a><span class="lineno"> 5417</span>&#160;<span class="comment"> /// second derivatives w.r.t local coordinates at local coordinate s \n</span></div>
<div class="line"><a name="l05418"></a><span class="lineno"> 5418</span>&#160;<span class="comment"> /// d2psids(i,0) = \f$ \partial^2 \psi_j / \partial s_0^2 \f$ \n</span></div>
<div class="line"><a name="l05419"></a><span class="lineno"> 5419</span>&#160;<span class="comment"> /// d2psids(i,1) = \f$ \partial^2 \psi_j / \partial s_1^2 \f$ \n</span></div>
<div class="line"><a name="l05420"></a><span class="lineno"> 5420</span>&#160;<span class="comment"> /// d2psids(i,2) = \f$ \partial^2 \psi_j / \partial s_0 \partial s_1 \f$ \n</span></div>
<div class="line"><a name="l05421"></a><span class="lineno"><a class="line" href="classoomph_1_1C1CurvedElement_3_012_00_01NNODE__1D_01_4.html#a878207a94d904e0d954a45de2a626a0e"> 5421</a></span>&#160;<span class="comment"></span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1C1CurvedElement_3_012_00_01NNODE__1D_01_4.html#a878207a94d904e0d954a45de2a626a0e">d2basis_c0_local</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>, <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;psi, </div>
<div class="line"><a name="l05422"></a><span class="lineno"> 5422</span>&#160;                           <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;dpsids, <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;d2psids)<span class="keyword"> const</span></div>
<div class="line"><a name="l05423"></a><span class="lineno"> 5423</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l05424"></a><span class="lineno"> 5424</span>&#160;   <a class="code" href="classoomph_1_1TElementShape.html">TElementShape&lt;2,NNODE_1D&gt;::d2shape_local</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,psi,dpsids,d2psids);</div>
<div class="line"><a name="l05425"></a><span class="lineno"> 5425</span>&#160;  }</div>
<div class="line"><a name="l05426"></a><span class="lineno"> 5426</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l05427"></a><span class="lineno"> 5427</span>&#160;<span class="comment"> /// Calculate the test functions at local coordinate s</span></div>
<div class="line"><a name="l05428"></a><span class="lineno"><a class="line" href="classoomph_1_1C1CurvedElement_3_012_00_01NNODE__1D_01_4.html#ae6c5bb18e4448678ba6f8d52fe146181"> 5428</a></span>&#160;<span class="comment"></span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1C1CurvedElement_3_012_00_01NNODE__1D_01_4.html#ae6c5bb18e4448678ba6f8d52fe146181">test</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>, <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;psi)<span class="keyword"> const</span></div>
<div class="line"><a name="l05429"></a><span class="lineno"> 5429</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l05430"></a><span class="lineno"> 5430</span>&#160;   <a class="code" href="namespaceoomph_1_1OneDimLagrange.html#a117f8b892dc89989ecdad99ff261e120">TElementShape&lt;2,NNODE_1D&gt;::shape</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,psi);</div>
<div class="line"><a name="l05431"></a><span class="lineno"> 5431</span>&#160;  }</div>
<div class="line"><a name="l05432"></a><span class="lineno"> 5432</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l05433"></a><span class="lineno"> 5433</span>&#160;<span class="comment"> /// \short Compute the  test functions and </span></div>
<div class="line"><a name="l05434"></a><span class="lineno"> 5434</span>&#160;<span class="comment"> /// derivatives w.r.t. local coordinates at local coordinate s</span></div>
<div class="line"><a name="l05435"></a><span class="lineno"><a class="line" href="classoomph_1_1C1CurvedElement_3_012_00_01NNODE__1D_01_4.html#a584224d462537606568ccc4fd6d0b21a"> 5435</a></span>&#160;<span class="comment"></span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1C1CurvedElement_3_012_00_01NNODE__1D_01_4.html#a584224d462537606568ccc4fd6d0b21a">dtest_local</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>, <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;psi, </div>
<div class="line"><a name="l05436"></a><span class="lineno"> 5436</span>&#160;                          <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;dpsids)<span class="keyword"> const</span></div>
<div class="line"><a name="l05437"></a><span class="lineno"> 5437</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l05438"></a><span class="lineno"> 5438</span>&#160;   <a class="code" href="classoomph_1_1TElementShape.html">TElementShape&lt;2,NNODE_1D&gt;::dshape_local</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,psi,dpsids);</div>
<div class="line"><a name="l05439"></a><span class="lineno"> 5439</span>&#160;  }</div>
<div class="line"><a name="l05440"></a><span class="lineno"> 5440</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l05441"></a><span class="lineno"> 5441</span>&#160;<span class="comment"> /// \short Computer the geometric shape functions, derivatives and</span></div>
<div class="line"><a name="l05442"></a><span class="lineno"> 5442</span>&#160;<span class="comment"> /// second derivatives w.r.t local coordinates at local coordinate s \n</span></div>
<div class="line"><a name="l05443"></a><span class="lineno"> 5443</span>&#160;<span class="comment"> /// d2psids(i,0) = \f$ \partial^2 \psi_j / \partial s_0^2 \f$ \n</span></div>
<div class="line"><a name="l05444"></a><span class="lineno"> 5444</span>&#160;<span class="comment"> /// d2psids(i,1) = \f$ \partial^2 \psi_j / \partial s_1^2 \f$ \n</span></div>
<div class="line"><a name="l05445"></a><span class="lineno"> 5445</span>&#160;<span class="comment"> /// d2psids(i,2) = \f$ \partial^2 \psi_j / \partial s_0 \partial s_1 \f$ \n</span></div>
<div class="line"><a name="l05446"></a><span class="lineno"><a class="line" href="classoomph_1_1C1CurvedElement_3_012_00_01NNODE__1D_01_4.html#a17db4cc4715be25a4492c4569d4a8f41"> 5446</a></span>&#160;<span class="comment"></span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1C1CurvedElement_3_012_00_01NNODE__1D_01_4.html#a17db4cc4715be25a4492c4569d4a8f41">d2test_local</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>, <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;psi, </div>
<div class="line"><a name="l05447"></a><span class="lineno"> 5447</span>&#160;                           <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;dpsids, <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;d2psids)<span class="keyword"> const</span></div>
<div class="line"><a name="l05448"></a><span class="lineno"> 5448</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l05449"></a><span class="lineno"> 5449</span>&#160;   <a class="code" href="classoomph_1_1TElementShape.html">TElementShape&lt;2,NNODE_1D&gt;::d2shape_local</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,psi,dpsids,d2psids);</div>
<div class="line"><a name="l05450"></a><span class="lineno"> 5450</span>&#160;  }</div>
<div class="line"><a name="l05451"></a><span class="lineno"> 5451</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l05452"></a><span class="lineno"> 5452</span>&#160;<span class="comment"> /// \short Build the lower-dimensional FaceElement (an element of type</span></div>
<div class="line"><a name="l05453"></a><span class="lineno"> 5453</span>&#160;<span class="comment"> /// SolidTElement&lt;1,NNODE_1D&gt;). The face index takes three possible values:</span></div>
<div class="line"><a name="l05454"></a><span class="lineno"> 5454</span>&#160;<span class="comment"> /// 0 (Left)         s[0] = 0.0</span></div>
<div class="line"><a name="l05455"></a><span class="lineno"> 5455</span>&#160;<span class="comment"> /// 1 (Bottom)       s[1] = 0.0</span></div>
<div class="line"><a name="l05456"></a><span class="lineno"> 5456</span>&#160;<span class="comment"> /// 2 (Sloping face) s[0] = 1.0 - s[1]</span></div>
<div class="line"><a name="l05457"></a><span class="lineno"> 5457</span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> build_face_element(<span class="keyword">const</span> <span class="keywordtype">int</span> &amp;face_index,</div>
<div class="line"><a name="l05458"></a><span class="lineno"> 5458</span>&#160;                                <a class="code" href="classoomph_1_1FaceElement.html">FaceElement</a>* face_element_pt);</div>
<div class="line"><a name="l05459"></a><span class="lineno"> 5459</span>&#160; </div>
<div class="line"><a name="l05460"></a><span class="lineno"> 5460</span>&#160;};</div>
<div class="line"><a name="l05461"></a><span class="lineno"> 5461</span>&#160; </div>
<div class="line"><a name="l05462"></a><span class="lineno"> 5462</span>&#160;<span class="comment">//===========================================================</span><span class="comment"></span></div>
<div class="line"><a name="l05463"></a><span class="lineno"> 5463</span>&#160;<span class="comment">/// Function to setup geometrical information for lower-dimensional</span></div>
<div class="line"><a name="l05464"></a><span class="lineno"> 5464</span>&#160;<span class="comment">/// FaceElements (which are of type TElement&lt;1,NNODE_1D&gt;).</span></div>
<div class="line"><a name="l05465"></a><span class="lineno"> 5465</span>&#160;<span class="comment"></span><span class="comment">//===========================================================</span></div>
<div class="line"><a name="l05466"></a><span class="lineno"> 5466</span>&#160;<span class="keyword">template</span>&lt;<span class="keywordtype">unsigned</span> NNODE_1D&gt;</div>
<div class="line"><a name="l05467"></a><span class="lineno"> 5467</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classoomph_1_1C1CurvedElement_3_012_00_01NNODE__1D_01_4.html#abbf443d8eed21f53dc7d4734d19859d7">C1CurvedElement&lt;2,NNODE_1D&gt;::</a></div>
<div class="line"><a name="l05468"></a><span class="lineno"><a class="line" href="classoomph_1_1C1CurvedElement_3_012_00_01NNODE__1D_01_4.html#abbf443d8eed21f53dc7d4734d19859d7"> 5468</a></span>&#160;<a class="code" href="classoomph_1_1C1CurvedElement_3_012_00_01NNODE__1D_01_4.html#abbf443d8eed21f53dc7d4734d19859d7">build_face_element</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> &amp;face_index, <a class="code" href="classoomph_1_1FaceElement.html">FaceElement</a> *face_element_pt)</div>
<div class="line"><a name="l05469"></a><span class="lineno"> 5469</span>&#160;{</div>
<div class="line"><a name="l05470"></a><span class="lineno"> 5470</span>&#160; <span class="comment">//Build the standard non-solid FaceElement</span></div>
<div class="line"><a name="l05471"></a><span class="lineno"> 5471</span>&#160; <a class="code" href="classoomph_1_1TElement.html">TElement&lt;2,NNODE_1D&gt;::build_face_element</a>(face_index,face_element_pt);</div>
<div class="line"><a name="l05472"></a><span class="lineno"> 5472</span>&#160;}</div>
<div class="line"><a name="l05473"></a><span class="lineno"> 5473</span>&#160; </div>
<div class="line"><a name="l05474"></a><span class="lineno"> 5474</span>&#160;<span class="comment">//=======================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l05475"></a><span class="lineno"> 5475</span>&#160;<span class="comment">/// Face geometry for the 2D C1CurvedElement elements is exactly</span></div>
<div class="line"><a name="l05476"></a><span class="lineno"> 5476</span>&#160;<span class="comment">/// the same as for the corresponding TElement. The spatial </span></div>
<div class="line"><a name="l05477"></a><span class="lineno"> 5477</span>&#160;<span class="comment">/// dimension of the face elements is one lower than that of the</span></div>
<div class="line"><a name="l05478"></a><span class="lineno"> 5478</span>&#160;<span class="comment">/// bulk element but they have the same number of points</span></div>
<div class="line"><a name="l05479"></a><span class="lineno"> 5479</span>&#160;<span class="comment">/// along their 1D edges.</span></div>
<div class="line"><a name="l05480"></a><span class="lineno"> 5480</span>&#160;<span class="comment"></span><span class="comment">//=======================================================================</span></div>
<div class="line"><a name="l05481"></a><span class="lineno"> 5481</span>&#160;<span class="keyword">template</span>&lt;<span class="keywordtype">unsigned</span> NNODE_1D&gt;</div>
<div class="line"><a name="l05482"></a><span class="lineno"><a class="line" href="classoomph_1_1FaceGeometry_3_01C1CurvedElement_3_012_00_01NNODE__1D_01_4_01_4.html"> 5482</a></span>&#160;<span class="keyword">class </span><a class="code" href="classoomph_1_1FaceGeometry.html">FaceGeometry</a>&lt;<a class="code" href="classoomph_1_1C1CurvedElement.html">C1CurvedElement</a>&lt;2,NNODE_1D&gt; &gt;: </div>
<div class="line"><a name="l05483"></a><span class="lineno"> 5483</span>&#160;<span class="keyword">public</span> <span class="keyword">virtual</span> <a class="code" href="classoomph_1_1TElement.html">TElement</a>&lt;1,NNODE_1D&gt;</div>
<div class="line"><a name="l05484"></a><span class="lineno"> 5484</span>&#160;{</div>
<div class="line"><a name="l05485"></a><span class="lineno"> 5485</span>&#160; </div>
<div class="line"><a name="l05486"></a><span class="lineno"> 5486</span>&#160;  <span class="keyword">public</span>:</div>
<div class="line"><a name="l05487"></a><span class="lineno"> 5487</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l05488"></a><span class="lineno"> 5488</span>&#160;<span class="comment"> /// \short Constructor: Call the constructor for the</span></div>
<div class="line"><a name="l05489"></a><span class="lineno"> 5489</span>&#160;<span class="comment"> /// appropriate lower-dimensional QElement</span></div>
<div class="line"><a name="l05490"></a><span class="lineno"><a class="line" href="classoomph_1_1FaceGeometry_3_01C1CurvedElement_3_012_00_01NNODE__1D_01_4_01_4.html#a72bc38ac6bbdedd73cb1956781f9d49d"> 5490</a></span>&#160;<span class="comment"></span> <a class="code" href="classoomph_1_1FaceGeometry_3_01C1CurvedElement_3_012_00_01NNODE__1D_01_4_01_4.html#a72bc38ac6bbdedd73cb1956781f9d49d">FaceGeometry</a>() : <a class="code" href="classoomph_1_1TElement.html">TElement</a>&lt;1,NNODE_1D&gt;() {}</div>
<div class="line"><a name="l05491"></a><span class="lineno"> 5491</span>&#160; </div>
<div class="line"><a name="l05492"></a><span class="lineno"> 5492</span>&#160;};</div>
<div class="line"><a name="l05493"></a><span class="lineno"> 5493</span>&#160; </div>
<div class="line"><a name="l05494"></a><span class="lineno"> 5494</span>&#160; </div>
<div class="line"><a name="l05495"></a><span class="lineno"> 5495</span>&#160;}</div>
<div class="line"><a name="l05496"></a><span class="lineno"> 5496</span>&#160;<span class="preprocessor">#endif</span></div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="aTelements_8h_html"><div class="ttname"><a href="Telements_8h.html">Telements.h</a></div></div>
<div class="ttc" id="aclassoomph_1_1C1CurvedElement_3_012_00_01NNODE__1D_01_4_html_a0d00b19541ec32162c0d096fef8fcf74"><div class="ttname"><a href="classoomph_1_1C1CurvedElement_3_012_00_01NNODE__1D_01_4.html#a0d00b19541ec32162c0d096fef8fcf74">oomph::C1CurvedElement&lt; 2, NNODE_1D &gt;::C1CurvedElement</a></div><div class="ttdeci">C1CurvedElement(const C1CurvedElement &amp;)</div><div class="ttdoc">Broken copy constructor.</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l05182">Subparametric_Telements.h:5182</a></div></div>
<div class="ttc" id="aclassoomph_1_1FiniteElement_html_a61c5f4b9a62607313692d713bf95edc5"><div class="ttname"><a href="classoomph_1_1FiniteElement.html#a61c5f4b9a62607313692d713bf95edc5">oomph::FiniteElement::nodal_position_gen</a></div><div class="ttdeci">double nodal_position_gen(const unsigned &amp;n, const unsigned &amp;k, const unsigned &amp;i) const</div><div class="ttdoc">Return the value of the k-th type of the i-th positional variable at the local node n.</div><div class="ttdef"><b>Definition:</b> <a href="elements_8h_source.html#l02262">elements.h:2262</a></div></div>
<div class="ttc" id="aclassoomph_1_1C1CurvedElement_3_012_00_01NNODE__1D_01_4_html_a68d0f04ce0ead20ed00c0925e2ac89db"><div class="ttname"><a href="classoomph_1_1C1CurvedElement_3_012_00_01NNODE__1D_01_4.html#a68d0f04ce0ead20ed00c0925e2ac89db">oomph::C1CurvedElement&lt; 2, NNODE_1D &gt;::basis_straight</a></div><div class="ttdeci">void basis_straight(const Vector&lt; double &gt; &amp;s, Shape &amp;psi) const</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l05297">Subparametric_Telements.h:5297</a></div></div>
<div class="ttc" id="anamespaceoomph_html_aec474227917784dc0a255faf289cfc16"><div class="ttname"><a href="namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph::oomph_info</a></div><div class="ttdeci">OomphInfo oomph_info</div><div class="ttdef"><b>Definition:</b> <a href="oomph__definitions_8cc_source.html#l00322">oomph_definitions.cc:322</a></div></div>
<div class="ttc" id="ashape_8h_html"><div class="ttname"><a href="shape_8h.html">shape.h</a></div></div>
<div class="ttc" id="aclassoomph_1_1C1CurvedElementBase_html_a5fcabaae9a008bf601ed01b81e2ee735"><div class="ttname"><a href="classoomph_1_1C1CurvedElementBase.html#a5fcabaae9a008bf601ed01b81e2ee735">oomph::C1CurvedElementBase::dtest_local_at_knot</a></div><div class="ttdeci">void dtest_local_at_knot(const unsigned &amp;ipt, Shape &amp;phi, DShape &amp;dphids) const</div><div class="ttdoc">Return the test function and its derivatives w.r.t. the local coordinates at the ipt-th integration p...</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l04226">Subparametric_Telements.h:4226</a></div></div>
<div class="ttc" id="aclassoomph_1_1C1CurvedElementBase_html"><div class="ttname"><a href="classoomph_1_1C1CurvedElementBase.html">oomph::C1CurvedElementBase</a></div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l03900">Subparametric_Telements.h:3900</a></div></div>
<div class="ttc" id="aclassoomph_1_1C1CurvedElementBase_html_a834ee576efd64a3b9f70f6b0be1f26b9"><div class="ttname"><a href="classoomph_1_1C1CurvedElementBase.html#a834ee576efd64a3b9f70f6b0be1f26b9">oomph::C1CurvedElementBase::dbasis_local_at_knot_curve</a></div><div class="ttdeci">void dbasis_local_at_knot_curve(const unsigned &amp;ipt, Shape &amp;psi, DShape &amp;dpsids) const</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l04066">Subparametric_Telements.h:4066</a></div></div>
<div class="ttc" id="aclassoomph_1_1C1CurvedElement_3_012_00_01NNODE__1D_01_4_html_af4a862475f941e4bc210e8e366d5dffc"><div class="ttname"><a href="classoomph_1_1C1CurvedElement_3_012_00_01NNODE__1D_01_4.html#af4a862475f941e4bc210e8e366d5dffc">oomph::C1CurvedElement&lt; 2, NNODE_1D &gt;::dbasis_local_straight</a></div><div class="ttdeci">void dbasis_local_straight(const Vector&lt; double &gt; &amp;s, Shape &amp;psi, DShape &amp;dpsids) const</div><div class="ttdoc">Compute the c1-shape functions associated with a straight-sided boundary and derivatives w....</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l05310">Subparametric_Telements.h:5310</a></div></div>
<div class="ttc" id="aclassoomph_1_1FiniteElement_html_ace0e7fb72a805b5c2c600347bfae7a9b"><div class="ttname"><a href="classoomph_1_1FiniteElement.html#ace0e7fb72a805b5c2c600347bfae7a9b">oomph::FiniteElement::node_pt</a></div><div class="ttdeci">Node *&amp; node_pt(const unsigned &amp;n)</div><div class="ttdoc">Return a pointer to the local node n.</div><div class="ttdef"><b>Definition:</b> <a href="elements_8h_source.html#l02122">elements.h:2122</a></div></div>
<div class="ttc" id="aclassoomph_1_1CurvedTGauss_3_012_00_012_01_4_html_af5146d11a77146251cdcf69f22a6d029"><div class="ttname"><a href="classoomph_1_1CurvedTGauss_3_012_00_012_01_4.html#af5146d11a77146251cdcf69f22a6d029">oomph::CurvedTGauss&lt; 2, 2 &gt;::CurvedTGauss</a></div><div class="ttdeci">CurvedTGauss()</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l01126">Subparametric_Telements.h:1126</a></div></div>
<div class="ttc" id="aclassoomph_1_1C1CurvedElementBase_html_aca6c4b025f8368574a277266d3b9ae14"><div class="ttname"><a href="classoomph_1_1C1CurvedElementBase.html#aca6c4b025f8368574a277266d3b9ae14">oomph::C1CurvedElementBase::d2basis_eulerian_curve</a></div><div class="ttdeci">double d2basis_eulerian_curve(const Vector&lt; double &gt; &amp;s, Shape &amp;psi, DShape &amp;dpsi, DShape &amp;d2psi) const</div><div class="ttdoc">Compute the cuved-element shape functions and also first and second derivatives w....</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l04660">Subparametric_Telements.h:4660</a></div></div>
<div class="ttc" id="aclassoomph_1_1C1CurvedElement_3_012_00_01NNODE__1D_01_4_html_a32a0cf8b60d16d887d5fc3ed261c2147"><div class="ttname"><a href="classoomph_1_1C1CurvedElement_3_012_00_01NNODE__1D_01_4.html#a32a0cf8b60d16d887d5fc3ed261c2147">oomph::C1CurvedElement&lt; 2, NNODE_1D &gt;::~C1CurvedElement</a></div><div class="ttdeci">~C1CurvedElement()</div><div class="ttdoc">Destructor.</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l05193">Subparametric_Telements.h:5193</a></div></div>
<div class="ttc" id="aclassoomph_1_1C1CurvedElementBase_html_ada5b9e50a71fd3e9d3975c78b5c3ed52"><div class="ttname"><a href="classoomph_1_1C1CurvedElementBase.html#ada5b9e50a71fd3e9d3975c78b5c3ed52">oomph::C1CurvedElementBase::classify_boundary_node</a></div><div class="ttdeci">virtual void classify_boundary_node(DenseMatrix&lt; double &gt; &amp;node_position, unsigned &amp;bd_element, DenseMatrix&lt; double &gt; &amp;bd_node_position, Vector&lt; double &gt; &amp;x) const</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l03909">Subparametric_Telements.h:3909</a></div></div>
<div class="ttc" id="aclassoomph_1_1C1CurvedElementBase_html_afa7d51d3ec5a690371ee392a0ec98ba9"><div class="ttname"><a href="classoomph_1_1C1CurvedElementBase.html#afa7d51d3ec5a690371ee392a0ec98ba9">oomph::C1CurvedElementBase::d2shape_local_at_knot_geom</a></div><div class="ttdeci">void d2shape_local_at_knot_geom(const unsigned &amp;ipt, Shape &amp;psi, DShape &amp;dpsids, DShape &amp;d2psids, Shape &amp;phi, DShape &amp;dphids, DShape &amp;d2phids) const</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l04191">Subparametric_Telements.h:4191</a></div></div>
<div class="ttc" id="aclassoomph_1_1LinearTElement_3_012_01_4_html_a0f45d00770d1c86cb2eb65d747b5cba3"><div class="ttname"><a href="classoomph_1_1LinearTElement_3_012_01_4.html#a0f45d00770d1c86cb2eb65d747b5cba3">oomph::LinearTElement&lt; 2 &gt;::local_coordinate_of_node</a></div><div class="ttdeci">void local_coordinate_of_node(const unsigned &amp;j, Vector&lt; double &gt; &amp;s) const</div><div class="ttdoc">Return local coordinates of node j.</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l01023">Subparametric_Telements.h:1023</a></div></div>
<div class="ttc" id="aclassoomph_1_1GeometricTElement_3_012_01_4_html_ab842b93f817d9b14c133d555bec8c373"><div class="ttname"><a href="classoomph_1_1GeometricTElement_3_012_01_4.html#ab842b93f817d9b14c133d555bec8c373">oomph::GeometricTElement&lt; 2 &gt;::d2Lshape_local</a></div><div class="ttdeci">void d2Lshape_local(const Vector&lt; double &gt; &amp;s, Shape &amp;psi, DShape &amp;dpsids, DShape &amp;d2psids, Shape &amp;phi, DShape &amp;dphids, DShape &amp;d2phids, DenseMatrix&lt; double &gt; &amp;position, unsigned &amp;bd_element, DenseMatrix&lt; double &gt; &amp;bd_position, Vector&lt; double &gt; &amp;x) const</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l01336">Subparametric_Telements.h:1336</a></div></div>
<div class="ttc" id="athe__data__structure_8txt_html_a5448c72da3359c7796cf0c5f800732a1"><div class="ttname"><a href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a></div><div class="ttdeci">and code FiniteElement::J_eulerian(...) \endcode returns the Jacobian of the mapping from Eulerian coordinates to local coordinates. - The function \c GeneralisedElement c QElement&lt; 3, 2 &gt; is an node brick element with a trilinear mapping between and global coordinates The dimension and the number of c Nodes must be set by calling the appropriate c set_ functions in the see ref set_commands above The most important member functions implemented at this level include Functions that evaluate the shape in terms of the c FiniteElement s coordinates functions that determine whether a c Node is located at a particular coordinate Output functions that allow the element shapes to be plotted we specify a pointer to a spatial integration the default assignment can be over written at a higher level This is discussed in more detail in a&lt; A HREF=&quot;../../optimisation/html/index.html&quot;&gt; separate document&lt;/A &gt; subsubsection Maths_Element we implement the equations that are represented by the specific element We implement the employing either the geometric shape functions that already exist on or employing additional shape functions defined at this level This allows us to write further member functions such as c interpolated_u(...)</div></div>
<div class="ttc" id="aclassoomph_1_1C1CurvedElement_3_012_00_01NNODE__1D_01_4_html_acf9269ed50d607b0bd52efcca1848040"><div class="ttname"><a href="classoomph_1_1C1CurvedElement_3_012_00_01NNODE__1D_01_4.html#acf9269ed50d607b0bd52efcca1848040">oomph::C1CurvedElement&lt; 2, NNODE_1D &gt;::dbasis_local_curve</a></div><div class="ttdeci">void dbasis_local_curve(const Vector&lt; double &gt; &amp;s, Shape &amp;psi, DShape &amp;dpsids) const</div><div class="ttdoc">Compute the c1-shape functions associated with a curved-sided boundary and derivatives w....</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l05345">Subparametric_Telements.h:5345</a></div></div>
<div class="ttc" id="aclassoomph_1_1FiniteElement_html_a2214ae814100dcbb553ac97cf243dcfe"><div class="ttname"><a href="classoomph_1_1FiniteElement.html#a2214ae814100dcbb553ac97cf243dcfe">oomph::FiniteElement::dshape_local_at_knot</a></div><div class="ttdeci">virtual void dshape_local_at_knot(const unsigned &amp;ipt, Shape &amp;psi, DShape &amp;dpsids) const</div><div class="ttdoc">Return the geometric shape function and its derivative w.r.t. the local coordinates at the ipt-th int...</div><div class="ttdef"><b>Definition:</b> <a href="elements_8cc_source.html#l03172">elements.cc:3172</a></div></div>
<div class="ttc" id="aVector_8h_html"><div class="ttname"><a href="Vector_8h.html">Vector.h</a></div></div>
<div class="ttc" id="aclassoomph_1_1BellElementBase_html_a3264c8f4cac79ac554015658e1074dbc"><div class="ttname"><a href="classoomph_1_1BellElementBase.html#a3264c8f4cac79ac554015658e1074dbc">oomph::BellElementBase::dbasis_eulerian</a></div><div class="ttdeci">double dbasis_eulerian(const Vector&lt; double &gt; &amp;s, Shape &amp;psi, DShape &amp;dpsi) const</div><div class="ttdoc">Compute the c1-basis functions and also first derivatives w.r.t. global coordinates at local coordina...</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l03349">Subparametric_Telements.h:3349</a></div></div>
<div class="ttc" id="aclassoomph_1_1BellElementBase_html_af6a719134aecd142c6a9667607993171"><div class="ttname"><a href="classoomph_1_1BellElementBase.html#af6a719134aecd142c6a9667607993171">oomph::BellElementBase::d2basis_eulerian</a></div><div class="ttdeci">double d2basis_eulerian(const Vector&lt; double &gt; &amp;s, Shape &amp;psi, DShape &amp;dpsi, DShape &amp;d2psi) const</div><div class="ttdoc">Compute the c1-basis functions and also first and second derivatives w.r.t. global coordinates at ipt...</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l03382">Subparametric_Telements.h:3382</a></div></div>
<div class="ttc" id="aclassoomph_1_1C1CurvedElementBase_html_a3c986f9ab0c04b4d7a8ca2ae39c37902"><div class="ttname"><a href="classoomph_1_1C1CurvedElementBase.html#a3c986f9ab0c04b4d7a8ca2ae39c37902">oomph::C1CurvedElementBase::dbasis_c0_local_at_knot</a></div><div class="ttdeci">void dbasis_c0_local_at_knot(const unsigned &amp;ipt, Shape &amp;psi, DShape &amp;dpsids) const</div><div class="ttdoc">Return the c0-shape function and its derivatives w.r.t. the local coordinates at the ipt-th integrati...</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l04119">Subparametric_Telements.h:4119</a></div></div>
<div class="ttc" id="aclassoomph_1_1TElement_html"><div class="ttname"><a href="classoomph_1_1TElement.html">oomph::TElement</a></div><div class="ttdef"><b>Definition:</b> <a href="Telements_8h_source.html#l01239">Telements.h:1239</a></div></div>
<div class="ttc" id="aclassoomph_1_1FiniteElement_html_a5f8fe59f06da1da9f6b7bbcbdb90ef93"><div class="ttname"><a href="classoomph_1_1FiniteElement.html#a5f8fe59f06da1da9f6b7bbcbdb90ef93">oomph::FiniteElement::dim</a></div><div class="ttdeci">unsigned dim() const</div><div class="ttdoc">Return the spatial dimension of the element, i.e. the number of local coordinates required to paramet...</div><div class="ttdef"><b>Definition:</b> <a href="elements_8h_source.html#l02495">elements.h:2495</a></div></div>
<div class="ttc" id="aclassoomph_1_1FiniteElement_html_add91f6d02c8819cf778bc76afb4f03d1"><div class="ttname"><a href="classoomph_1_1FiniteElement.html#add91f6d02c8819cf778bc76afb4f03d1">oomph::FiniteElement::raw_nodal_position_gen</a></div><div class="ttdeci">double raw_nodal_position_gen(const unsigned &amp;n, const unsigned &amp;k, const unsigned &amp;i) const</div><div class="ttdoc">Return the value of the k-th type of the i-th positional variable at the local node n....</div><div class="ttdef"><b>Definition:</b> <a href="elements_8h_source.html#l02206">elements.h:2206</a></div></div>
<div class="ttc" id="aclassoomph_1_1BellElement_html_a99afdb504fee71cb9c557ecb5069cd95"><div class="ttname"><a href="classoomph_1_1BellElement.html#a99afdb504fee71cb9c557ecb5069cd95">oomph::BellElement::test</a></div><div class="ttdeci">void test(const Vector&lt; double &gt; &amp;s, Shape &amp;psi) const</div><div class="ttdoc">Calculate the test functions at local coordinate s.</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l03863">Subparametric_Telements.h:3863</a></div></div>
<div class="ttc" id="aclassoomph_1_1TGauss_3_012_00_014_01_4_html"><div class="ttname"><a href="classoomph_1_1TGauss_3_012_00_014_01_4.html">oomph::TGauss&lt; 2, 4 &gt;</a></div><div class="ttdef"><b>Definition:</b> <a href="integral_8h_source.html#l00960">integral.h:960</a></div></div>
<div class="ttc" id="anamespaceoomph_1_1QuadTreeNames_html_a8954a5947b19986b8c4b755bc7639f7da585070bd0e3801c3bbed287ef3c4a265"><div class="ttname"><a href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7da585070bd0e3801c3bbed287ef3c4a265">oomph::QuadTreeNames::E</a></div><div class="ttdeci">@ E</div><div class="ttdef"><b>Definition:</b> <a href="quadtree_8h_source.html#l00056">quadtree.h:56</a></div></div>
<div class="ttc" id="aclassoomph_1_1BellElementBase_html_ade54f5038bd917ff2a4c636e066db00e"><div class="ttname"><a href="classoomph_1_1BellElementBase.html#ade54f5038bd917ff2a4c636e066db00e">oomph::BellElementBase::dshape_and_dtest_eulerian_at_knot</a></div><div class="ttdeci">double dshape_and_dtest_eulerian_at_knot(const unsigned &amp;ipt, Shape &amp;psi, DShape &amp;dpsi, Shape &amp;test, DShape &amp;dtest) const</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l03417">Subparametric_Telements.h:3417</a></div></div>
<div class="ttc" id="aclassoomph_1_1C1CurvedElementBase_html_aa953e1d89a6c059ac89c972feb0aea74"><div class="ttname"><a href="classoomph_1_1C1CurvedElementBase.html#aa953e1d89a6c059ac89c972feb0aea74">oomph::C1CurvedElementBase::test</a></div><div class="ttdeci">virtual void test(const Vector&lt; double &gt; &amp;s, Shape &amp;phi) const</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l03974">Subparametric_Telements.h:3974</a></div></div>
<div class="ttc" id="aclassoomph_1_1C1CurvedElementShape_3_012_00_01NNODE__1D_01_4_html_ae39e21f6c15e0544355c7b1119631409"><div class="ttname"><a href="classoomph_1_1C1CurvedElementShape_3_012_00_01NNODE__1D_01_4.html#ae39e21f6c15e0544355c7b1119631409">oomph::C1CurvedElementShape&lt; 2, NNODE_1D &gt;::d2Cshape_local</a></div><div class="ttdeci">void d2Cshape_local(const Vector&lt; double &gt; &amp;s, Shape &amp;psi_curve, DShape &amp;dpsi_curve, DShape &amp;d2psi_curve) const</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l02246">Subparametric_Telements.h:2246</a></div></div>
<div class="ttc" id="aclassoomph_1_1C1CurvedElementBase_html_a6411596e17d98cdd0691b6de6e5319d5"><div class="ttname"><a href="classoomph_1_1C1CurvedElementBase.html#a6411596e17d98cdd0691b6de6e5319d5">oomph::C1CurvedElementBase::dshape_and_dtest_eulerian_at_knot</a></div><div class="ttdeci">double dshape_and_dtest_eulerian_at_knot(const unsigned &amp;ipt, Shape &amp;psi, DShape &amp;dpsi, Shape &amp;test, DShape &amp;dtest) const</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l04263">Subparametric_Telements.h:4263</a></div></div>
<div class="ttc" id="aclassoomph_1_1BellElement_html_ae0b6d4d44df8a05a9dd1b8709c9f0247"><div class="ttname"><a href="classoomph_1_1BellElement.html#ae0b6d4d44df8a05a9dd1b8709c9f0247">oomph::BellElement::dtest_local</a></div><div class="ttdeci">void dtest_local(const Vector&lt; double &gt; &amp;s, Shape &amp;psi, DShape &amp;dpsids) const</div><div class="ttdoc">Compute the test functions and derivatives w.r.t. local coordinates at local coordinate s.</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l03870">Subparametric_Telements.h:3870</a></div></div>
<div class="ttc" id="aclassoomph_1_1BellElement_html_adcf9c26fca0f635473b1f0a0ff45e47d"><div class="ttname"><a href="classoomph_1_1BellElement.html#adcf9c26fca0f635473b1f0a0ff45e47d">oomph::BellElement::shape</a></div><div class="ttdeci">void shape(const Vector&lt; double &gt; &amp;s, Shape &amp;psi) const</div><div class="ttdoc">Calculate the geometric shape functions at local coordinate s.</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l03748">Subparametric_Telements.h:3748</a></div></div>
<div class="ttc" id="aclassoomph_1_1BellElementBase_html_aee9266910010dcfca375fe0de13c17bb"><div class="ttname"><a href="classoomph_1_1BellElementBase.html#aee9266910010dcfca375fe0de13c17bb">oomph::BellElementBase::basis</a></div><div class="ttdeci">virtual void basis(const Vector&lt; double &gt; &amp;s, Shape &amp;psi) const</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l03059">Subparametric_Telements.h:3059</a></div></div>
<div class="ttc" id="aclassoomph_1_1C1CurvedElementBase_html_af66c0d5584a7789b4fe63316331dc50d"><div class="ttname"><a href="classoomph_1_1C1CurvedElementBase.html#af66c0d5584a7789b4fe63316331dc50d">oomph::C1CurvedElementBase::my_interpolated_u_normal</a></div><div class="ttdeci">void my_interpolated_u_normal(const Vector&lt; double &gt; s, Vector&lt; double &gt; &amp;interpolated_u, DenseMatrix&lt; double &gt; &amp;interpolated_dudxi, DenseMatrix&lt; double &gt; &amp;interpolated_d2udxi) const</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l04915">Subparametric_Telements.h:4915</a></div></div>
<div class="ttc" id="aclassoomph_1_1FiniteElement_html"><div class="ttname"><a href="classoomph_1_1FiniteElement.html">oomph::FiniteElement</a></div><div class="ttdoc">A general Finite Element class.</div><div class="ttdef"><b>Definition:</b> <a href="elements_8h_source.html#l01287">elements.h:1287</a></div></div>
<div class="ttc" id="aclassoomph_1_1OomphLibError_html"><div class="ttname"><a href="classoomph_1_1OomphLibError.html">oomph::OomphLibError</a></div><div class="ttdef"><b>Definition:</b> <a href="oomph__definitions_8h_source.html#l00225">oomph_definitions.h:225</a></div></div>
<div class="ttc" id="aclassoomph_1_1BellElement_html_ad99554f0767e1d82e371ebce2219521b"><div class="ttname"><a href="classoomph_1_1BellElement.html#ad99554f0767e1d82e371ebce2219521b">oomph::BellElement::basis_c0</a></div><div class="ttdeci">void basis_c0(const Vector&lt; double &gt; &amp;s, Shape &amp;psi) const</div><div class="ttdoc">Calculate the c0-basis functions at local coordinate s.</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l03838">Subparametric_Telements.h:3838</a></div></div>
<div class="ttc" id="aclassoomph_1_1BellElement_html"><div class="ttname"><a href="classoomph_1_1BellElement.html">oomph::BellElement</a></div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l03722">Subparametric_Telements.h:3722</a></div></div>
<div class="ttc" id="aclassoomph_1_1TGauss_html"><div class="ttname"><a href="classoomph_1_1TGauss.html">oomph::TGauss</a></div><div class="ttdef"><b>Definition:</b> <a href="integral_8h_source.html#l00664">integral.h:664</a></div></div>
<div class="ttc" id="aclassoomph_1_1BellElement_html_a60d06c5a989f698d550368e30760c004"><div class="ttname"><a href="classoomph_1_1BellElement.html#a60d06c5a989f698d550368e30760c004">oomph::BellElement::operator=</a></div><div class="ttdeci">void operator=(const BellElement &amp;)</div><div class="ttdoc">Broken assignment operator.</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l03742">Subparametric_Telements.h:3742</a></div></div>
<div class="ttc" id="aclassoomph_1_1FiniteElement_html_a9db1456b827131c21a991ac9fedf4b0c"><div class="ttname"><a href="classoomph_1_1FiniteElement.html#a9db1456b827131c21a991ac9fedf4b0c">oomph::FiniteElement::dshape_local</a></div><div class="ttdeci">virtual void dshape_local(const Vector&lt; double &gt; &amp;s, Shape &amp;psi, DShape &amp;dpsids) const</div><div class="ttdoc">Function to compute the geometric shape functions and derivatives w.r.t. local coordinates at local c...</div><div class="ttdef"><b>Definition:</b> <a href="elements_8h_source.html#l01935">elements.h:1935</a></div></div>
<div class="ttc" id="aclassoomph_1_1GeometricTElement_3_012_01_4_html_aeabbac1b1c1fe3019eee0040f162990e"><div class="ttname"><a href="classoomph_1_1GeometricTElement_3_012_01_4.html#aeabbac1b1c1fe3019eee0040f162990e">oomph::GeometricTElement&lt; 2 &gt;::local_coordinate_of_node</a></div><div class="ttdeci">void local_coordinate_of_node(const unsigned &amp;j, Vector&lt; double &gt; &amp;s) const</div><div class="ttdoc">Return local coordinates of node j.</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l01147">Subparametric_Telements.h:1147</a></div></div>
<div class="ttc" id="aclassoomph_1_1C1CurvedElementBase_html_a9aca3e797997aeb999987b6f69c31320"><div class="ttname"><a href="classoomph_1_1C1CurvedElementBase.html#a9aca3e797997aeb999987b6f69c31320">oomph::C1CurvedElementBase::basis_curve</a></div><div class="ttdeci">virtual void basis_curve(const Vector&lt; double &gt; &amp;s, Shape &amp;psi) const</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l03945">Subparametric_Telements.h:3945</a></div></div>
<div class="ttc" id="aclassoomph_1_1C1CurvedElementBase_html_ae8b0385cfb2eeeb2e17916d76d1e439e"><div class="ttname"><a href="classoomph_1_1C1CurvedElementBase.html#ae8b0385cfb2eeeb2e17916d76d1e439e">oomph::C1CurvedElementBase::shape_geom</a></div><div class="ttdeci">virtual void shape_geom(const Vector&lt; double &gt; &amp;s, Shape &amp;psi, Shape &amp;phi) const</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l03927">Subparametric_Telements.h:3927</a></div></div>
<div class="ttc" id="aclassoomph_1_1C1CurvedElementShape_3_012_00_01NNODE__1D_01_4_html_a3f5542eebff8cce73b2a6cd0487fa9b7"><div class="ttname"><a href="classoomph_1_1C1CurvedElementShape_3_012_00_01NNODE__1D_01_4.html#a3f5542eebff8cce73b2a6cd0487fa9b7">oomph::C1CurvedElementShape&lt; 2, NNODE_1D &gt;::Cshape</a></div><div class="ttdeci">void Cshape(const Vector&lt; double &gt; &amp;s, Shape &amp;psi_curve) const</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l02185">Subparametric_Telements.h:2185</a></div></div>
<div class="ttc" id="aclassoomph_1_1C1CurvedElementBase_html_a8152ea7e16851b419f1036911f35dbee"><div class="ttname"><a href="classoomph_1_1C1CurvedElementBase.html#a8152ea7e16851b419f1036911f35dbee">oomph::C1CurvedElementBase::local_to_eulerian_mapping2</a></div><div class="ttdeci">double local_to_eulerian_mapping2(const DShape &amp;dpsids, DShape &amp;dphids, DenseMatrix&lt; double &gt; &amp;inverse_jacobian) const</div><div class="ttdoc">Calculate the mapping from local to Eulerian coordinates, given the derivatives of the shape function...</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l04350">Subparametric_Telements.h:4350</a></div></div>
<div class="ttc" id="aclassoomph_1_1BellElementBase_html_a4dfe41d9fa313dcc843d17144c553190"><div class="ttname"><a href="classoomph_1_1BellElementBase.html#a4dfe41d9fa313dcc843d17144c553190">oomph::BellElementBase::my_interpolated_x</a></div><div class="ttdeci">void my_interpolated_x(const Vector&lt; double &gt; &amp;s, Vector&lt; double &gt; &amp;x) const</div><div class="ttdoc">Return FE interpolated position x[] at local coordinate s as Vector.</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l03684">Subparametric_Telements.h:3684</a></div></div>
<div class="ttc" id="aclassoomph_1_1C1CurvedElementBase_html_a819553bb577933323c1e9c7943d04cad"><div class="ttname"><a href="classoomph_1_1C1CurvedElementBase.html#a819553bb577933323c1e9c7943d04cad">oomph::C1CurvedElementBase::dbasis_local_curve</a></div><div class="ttdeci">virtual void dbasis_local_curve(const Vector&lt; double &gt; &amp;s, Shape &amp;psi, DShape &amp;dpsids) const</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l03949">Subparametric_Telements.h:3949</a></div></div>
<div class="ttc" id="athe__data__structure_8txt_html_aecdcb19250d339765d0095e975875b2a"><div class="ttname"><a href="the__data__structure_8txt.html#aecdcb19250d339765d0095e975875b2a">position</a></div><div class="ttdeci">c Data can also store a certain number of c Data stores a pointer to a c TimeStepper whose member functions relate the history values to the values time derivatives pointer based read write access to the c Data values is provided by the functions code and by code Data::value_pt(t, i) \endcode which returns a pointer to the \c t -th history value associated with value \c i. Read-only access is also provided by the functions \code Data and its time dependent counterpart code whereas the values associated with t correspond to history values In many but this is not guaranteed See the section ref timestepping for further details subsection nodes Nodes In FE all c Nodes in a finite element mesh have c Data associated with them c Nodes are therefore derived from c but also store a spatial position</div><div class="ttdef"><b>Definition:</b> <a href="the__data__structure_8txt_source.html#l00148">the_data_structure.txt:148</a></div></div>
<div class="ttc" id="aclassoomph_1_1C1CurvedElement_3_012_00_01NNODE__1D_01_4_html_abbf443d8eed21f53dc7d4734d19859d7"><div class="ttname"><a href="classoomph_1_1C1CurvedElement_3_012_00_01NNODE__1D_01_4.html#abbf443d8eed21f53dc7d4734d19859d7">oomph::C1CurvedElement&lt; 2, NNODE_1D &gt;::build_face_element</a></div><div class="ttdeci">void build_face_element(const int &amp;face_index, FaceElement *face_element_pt)</div><div class="ttdoc">Build the lower-dimensional FaceElement (an element of type SolidTElement&lt;1,NNODE_1D&gt;)....</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l05468">Subparametric_Telements.h:5468</a></div></div>
<div class="ttc" id="aclassoomph_1_1BellElement_html_a23f34f6479128e7e8c694fbcb72aae78"><div class="ttname"><a href="classoomph_1_1BellElement.html#a23f34f6479128e7e8c694fbcb72aae78">oomph::BellElement::d2basis_c0_local</a></div><div class="ttdeci">void d2basis_c0_local(const Vector&lt; double &gt; &amp;s, Shape &amp;psi, DShape &amp;dpsids, DShape &amp;d2psids) const</div><div class="ttdoc">Computer the c0-basis functions, derivatives and second derivatives w.r.t local coordinates at local ...</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l03856">Subparametric_Telements.h:3856</a></div></div>
<div class="ttc" id="aclassoomph_1_1GeometricTElement_3_012_01_4_html_a8e6bab8c2bd951889894b3a08b796207"><div class="ttname"><a href="classoomph_1_1GeometricTElement_3_012_01_4.html#a8e6bab8c2bd951889894b3a08b796207">oomph::GeometricTElement&lt; 2 &gt;::Lshape</a></div><div class="ttdeci">void Lshape(const Vector&lt; double &gt; &amp;s, Shape &amp;psi, Shape &amp;phi, DenseMatrix&lt; double &gt; &amp;position, unsigned &amp;bd_element, DenseMatrix&lt; double &gt; &amp;bd_position, Vector&lt; double &gt; &amp;x) const</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l01182">Subparametric_Telements.h:1182</a></div></div>
<div class="ttc" id="aclassoomph_1_1C1CurvedElementBase_html_a103822347941f4ac149d86066ca121a1"><div class="ttname"><a href="classoomph_1_1C1CurvedElementBase.html#a103822347941f4ac149d86066ca121a1">oomph::C1CurvedElementBase::d2basis_local_at_knot_straight</a></div><div class="ttdeci">void d2basis_local_at_knot_straight(const unsigned &amp;ipt, Shape &amp;psi, DShape &amp;dpsids, DShape &amp;d2psids) const</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l04030">Subparametric_Telements.h:4030</a></div></div>
<div class="ttc" id="aclassoomph_1_1C1CurvedElementBase_html_a4735f6f63d4e545608bf485c7168e251"><div class="ttname"><a href="classoomph_1_1C1CurvedElementBase.html#a4735f6f63d4e545608bf485c7168e251">oomph::C1CurvedElementBase::get_value_transform_matrix</a></div><div class="ttdeci">virtual void get_value_transform_matrix(DenseMatrix&lt; double &gt; &amp;D, DenseMatrix&lt; double &gt; &amp;B, DenseMatrix&lt; double &gt; &amp;node_position, unsigned &amp;bd_element, DenseMatrix&lt; double &gt; &amp;bd_node_position, Vector&lt; double &gt; &amp;x) const</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l03905">Subparametric_Telements.h:3905</a></div></div>
<div class="ttc" id="aclassoomph_1_1C1CurvedElement_3_012_00_01NNODE__1D_01_4_html_ad7457d81744bbb7596ce70f7d1b576ce"><div class="ttname"><a href="classoomph_1_1C1CurvedElement_3_012_00_01NNODE__1D_01_4.html#ad7457d81744bbb7596ce70f7d1b576ce">oomph::C1CurvedElement&lt; 2, NNODE_1D &gt;::dshape_local_geom</a></div><div class="ttdeci">void dshape_local_geom(const Vector&lt; double &gt; &amp;s, Shape &amp;psi, DShape &amp;dpsids, Shape &amp;phi, DShape &amp;dphids) const</div><div class="ttdoc">Compute the linear functions and derivatives w.r.t. local coordinates at local coordinate s.</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l05374">Subparametric_Telements.h:5374</a></div></div>
<div class="ttc" id="aclassoomph_1_1BellElementBase_html_a02f75fd57e4f6329a4b551df3d3c81eb"><div class="ttname"><a href="classoomph_1_1BellElementBase.html#a02f75fd57e4f6329a4b551df3d3c81eb">oomph::BellElementBase::dbasis_local</a></div><div class="ttdeci">virtual void dbasis_local(const Vector&lt; double &gt; &amp;s, Shape &amp;psi, DShape &amp;dpsids) const</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l03063">Subparametric_Telements.h:3063</a></div></div>
<div class="ttc" id="aclassoomph_1_1C1CurvedElementShape_3_012_00_01NNODE__1D_01_4_html_ab40b2d47f321db5868443846290c2744"><div class="ttname"><a href="classoomph_1_1C1CurvedElementShape_3_012_00_01NNODE__1D_01_4.html#ab40b2d47f321db5868443846290c2744">oomph::C1CurvedElementShape&lt; 2, NNODE_1D &gt;::dbasis_local_curve</a></div><div class="ttdeci">void dbasis_local_curve(const Vector&lt; double &gt; &amp;s, Shape &amp;psi_curve, DShape &amp;dpsi_curve) const</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l02840">Subparametric_Telements.h:2840</a></div></div>
<div class="ttc" id="aclassoomph_1_1BellElementBase_html_aa9db3995e26ddee02bdae16dae111c03"><div class="ttname"><a href="classoomph_1_1BellElementBase.html#aa9db3995e26ddee02bdae16dae111c03">oomph::BellElementBase::d2basis_c0_local</a></div><div class="ttdeci">virtual void d2basis_c0_local(const Vector&lt; double &gt; &amp;s, Shape &amp;psi, DShape &amp;dpsids, DShape &amp;d2psids) const</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l03081">Subparametric_Telements.h:3081</a></div></div>
<div class="ttc" id="aclassoomph_1_1C1CurvedElementBase_html_a256c9d25d9f4c9067914b39d1cc4c6fa"><div class="ttname"><a href="classoomph_1_1C1CurvedElementBase.html#a256c9d25d9f4c9067914b39d1cc4c6fa">oomph::C1CurvedElementBase::basis_straight</a></div><div class="ttdeci">virtual void basis_straight(const Vector&lt; double &gt; &amp;s, Shape &amp;psi) const</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l03913">Subparametric_Telements.h:3913</a></div></div>
<div class="ttc" id="aclassoomph_1_1BellElementBase_html_a2c9a75b9d07c0aa569ba24d2b3228800"><div class="ttname"><a href="classoomph_1_1BellElementBase.html#a2c9a75b9d07c0aa569ba24d2b3228800">oomph::BellElementBase::basis_c0</a></div><div class="ttdeci">virtual void basis_c0(const Vector&lt; double &gt; &amp;s, Shape &amp;psi) const</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l03073">Subparametric_Telements.h:3073</a></div></div>
<div class="ttc" id="aclassoomph_1_1C1CurvedElement_3_012_00_01NNODE__1D_01_4_html_abc52b97fb811db2bdb58661442dbffdf"><div class="ttname"><a href="classoomph_1_1C1CurvedElement_3_012_00_01NNODE__1D_01_4.html#abc52b97fb811db2bdb58661442dbffdf">oomph::C1CurvedElement&lt; 2, NNODE_1D &gt;::nvertex_node</a></div><div class="ttdeci">unsigned nvertex_node() const</div><div class="ttdoc">Number of vertex nodes in the element: One more than spatial dimension.</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l05200">Subparametric_Telements.h:5200</a></div></div>
<div class="ttc" id="aclassoomph_1_1C1CurvedElementBase_html_af8d7bb2e120f655629419f7627d95602"><div class="ttname"><a href="classoomph_1_1C1CurvedElementBase.html#af8d7bb2e120f655629419f7627d95602">oomph::C1CurvedElementBase::J_eulerian1</a></div><div class="ttdeci">double J_eulerian1(const Vector&lt; double &gt; &amp;s) const</div><div class="ttdoc">Calculate the Jacobian of the mapping between local and global coordinates at the position s.</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l04437">Subparametric_Telements.h:4437</a></div></div>
<div class="ttc" id="aclassoomph_1_1BellElementBase_html_ac452af5196c5a49040a2d6ab871a1284"><div class="ttname"><a href="classoomph_1_1BellElementBase.html#ac452af5196c5a49040a2d6ab871a1284">oomph::BellElementBase::d2basis_c0_local_at_knot</a></div><div class="ttdeci">void d2basis_c0_local_at_knot(const unsigned &amp;ipt, Shape &amp;psi, DShape &amp;dpsids, DShape &amp;d2psids) const</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l03196">Subparametric_Telements.h:3196</a></div></div>
<div class="ttc" id="aclassoomph_1_1BellElementShape_3_012_01_4_html_abca489dcf440f32fc0b2c17577d65440"><div class="ttname"><a href="classoomph_1_1BellElementShape_3_012_01_4.html#abca489dcf440f32fc0b2c17577d65440">oomph::BellElementShape&lt; 2 &gt;::dBshape_local</a></div><div class="ttdeci">void dBshape_local(const Vector&lt; double &gt; &amp;s, Shape &amp;psi, DShape &amp;dpsids, DenseMatrix&lt; double &gt; &amp;position) const</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l00254">Subparametric_Telements.h:254</a></div></div>
<div class="ttc" id="aclassoomph_1_1C1CurvedElementShape_3_012_00_01NNODE__1D_01_4_html_a3029475256dcd92737fd5a3e01e5eb53"><div class="ttname"><a href="classoomph_1_1C1CurvedElementShape_3_012_00_01NNODE__1D_01_4.html#a3029475256dcd92737fd5a3e01e5eb53">oomph::C1CurvedElementShape&lt; 2, NNODE_1D &gt;::get_coefficient</a></div><div class="ttdeci">void get_coefficient(DenseMatrix&lt; double &gt; &amp;A) const</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l02280">Subparametric_Telements.h:2280</a></div></div>
<div class="ttc" id="aclassoomph_1_1FiniteElement_html_ad1600b17efbe61db27a4c622af1f28cf"><div class="ttname"><a href="classoomph_1_1FiniteElement.html#ad1600b17efbe61db27a4c622af1f28cf">oomph::FiniteElement::N2deriv</a></div><div class="ttdeci">static const unsigned N2deriv[]</div><div class="ttdoc">Static array that holds the number of second derivatives as a function of the dimension of the elemen...</div><div class="ttdef"><b>Definition:</b> <a href="elements_8h_source.html#l01453">elements.h:1453</a></div></div>
<div class="ttc" id="aclassoomph_1_1C1CurvedElementBase_html_a850d39886cc45f812ea16e4f10fcf930"><div class="ttname"><a href="classoomph_1_1C1CurvedElementBase.html#a850d39886cc45f812ea16e4f10fcf930">oomph::C1CurvedElementBase::local_to_eulerian_mapping2</a></div><div class="ttdeci">virtual double local_to_eulerian_mapping2(const DShape &amp;dpsids, DShape &amp;dphids, DenseMatrix&lt; double &gt; &amp;jacobian, DenseMatrix&lt; double &gt; &amp;inverse_jacobian) const</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l04362">Subparametric_Telements.h:4362</a></div></div>
<div class="ttc" id="aclassoomph_1_1LinearTElement_3_012_01_4_html_a0deccf130233fc497906f9b48608045e"><div class="ttname"><a href="classoomph_1_1LinearTElement_3_012_01_4.html#a0deccf130233fc497906f9b48608045e">oomph::LinearTElement&lt; 2 &gt;::d2Lshape_local</a></div><div class="ttdeci">void d2Lshape_local(const Vector&lt; double &gt; &amp;s, Shape &amp;psi, DShape &amp;dpsids, DShape &amp;d2psids) const</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l01090">Subparametric_Telements.h:1090</a></div></div>
<div class="ttc" id="aclassoomph_1_1C1CurvedElement_3_012_00_01NNODE__1D_01_4_html_a0fe82acd4ccebb368f96c657927063c8"><div class="ttname"><a href="classoomph_1_1C1CurvedElement_3_012_00_01NNODE__1D_01_4.html#a0fe82acd4ccebb368f96c657927063c8">oomph::C1CurvedElement&lt; 2, NNODE_1D &gt;::vertex_node_pt</a></div><div class="ttdeci">Node * vertex_node_pt(const unsigned &amp;j) const</div><div class="ttdoc">Pointer to the j-th vertex node in the element.</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l05206">Subparametric_Telements.h:5206</a></div></div>
<div class="ttc" id="aclassoomph_1_1FiniteElement_html_a524acd2f6d25d55806b7050032ee6330"><div class="ttname"><a href="classoomph_1_1FiniteElement.html#a524acd2f6d25d55806b7050032ee6330">oomph::FiniteElement::check_jacobian</a></div><div class="ttdeci">void check_jacobian(const double &amp;jacobian) const</div><div class="ttdoc">Helper function used to check for singular or negative Jacobians in the transform from local to globa...</div><div class="ttdef"><b>Definition:</b> <a href="elements_8cc_source.html#l01720">elements.cc:1720</a></div></div>
<div class="ttc" id="aclassoomph_1_1FiniteElement_html_a42c86a7628fee00d3a9d35b935b29e48"><div class="ttname"><a href="classoomph_1_1FiniteElement.html#a42c86a7628fee00d3a9d35b935b29e48">oomph::FiniteElement::invert_jacobian_mapping</a></div><div class="ttdeci">virtual double invert_jacobian_mapping(const DenseMatrix&lt; double &gt; &amp;jacobian, DenseMatrix&lt; double &gt; &amp;inverse_jacobian) const</div><div class="ttdoc">A template-free interface that takes the matrix passed as jacobian and return its inverse in inverse_...</div><div class="ttdef"><b>Definition:</b> <a href="elements_8cc_source.html#l02135">elements.cc:2135</a></div></div>
<div class="ttc" id="aclassoomph_1_1BellElementBase_html_a8bf466c908c0c3cf661229429961d5d0"><div class="ttname"><a href="classoomph_1_1BellElementBase.html#a8bf466c908c0c3cf661229429961d5d0">oomph::BellElementBase::d2shape_and_d2test_eulerian_at_knot</a></div><div class="ttdeci">double d2shape_and_d2test_eulerian_at_knot(const unsigned &amp;ipt, Shape &amp;psi, DShape &amp;dpsi, DShape &amp;d2psi, Shape &amp;test, DShape &amp;dtest, DShape &amp;d2test) const</div><div class="ttdoc">Compute the c1-shape functions and also first and second derivatives w.r.t. global coordinates at ipt...</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l03454">Subparametric_Telements.h:3454</a></div></div>
<div class="ttc" id="aclassoomph_1_1BellElement_html_a58254e48913aa6428db33338b010a911"><div class="ttname"><a href="classoomph_1_1BellElement.html#a58254e48913aa6428db33338b010a911">oomph::BellElement::d2basis_local</a></div><div class="ttdeci">void d2basis_local(const Vector&lt; double &gt; &amp;s, Shape &amp;psi, DShape &amp;dpsids, DShape &amp;d2psids) const</div><div class="ttdoc">Compute the c1-basis functions and</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l03817">Subparametric_Telements.h:3817</a></div></div>
<div class="ttc" id="aclassoomph_1_1LinearTElement_html"><div class="ttname"><a href="classoomph_1_1LinearTElement.html">oomph::LinearTElement</a></div><div class="ttdoc">A class for Linear triangular shape function with 3 vertex nodes.</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l01014">Subparametric_Telements.h:1014</a></div></div>
<div class="ttc" id="aclassoomph_1_1C1CurvedElementBase_html_ac6b4ddc3a10424d88e278c1e260b5a10"><div class="ttname"><a href="classoomph_1_1C1CurvedElementBase.html#ac6b4ddc3a10424d88e278c1e260b5a10">oomph::C1CurvedElementBase::my_interpolated_u_tangential</a></div><div class="ttdeci">void my_interpolated_u_tangential(const Vector&lt; double &gt; s, Vector&lt; double &gt; &amp;interpolated_u, DenseMatrix&lt; double &gt; &amp;interpolated_dudxi) const</div><div class="ttdoc">Return FE interpolated value u[] at local coordinate s as Vector.</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l05103">Subparametric_Telements.h:5103</a></div></div>
<div class="ttc" id="aclassoomph_1_1C1CurvedElementBase_html_ab259c76f5ec2f076324127a7e64cccc3"><div class="ttname"><a href="classoomph_1_1C1CurvedElementBase.html#ab259c76f5ec2f076324127a7e64cccc3">oomph::C1CurvedElementBase::test_at_knot</a></div><div class="ttdeci">void test_at_knot(const unsigned &amp;ipt, Shape &amp;phi) const</div><div class="ttdoc">Return the test function stored at the ipt-th integration point.</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l04210">Subparametric_Telements.h:4210</a></div></div>
<div class="ttc" id="aclassoomph_1_1C1CurvedElementBase_html_a48932300808586ba1773a54a6ed768e4"><div class="ttname"><a href="classoomph_1_1C1CurvedElementBase.html#a48932300808586ba1773a54a6ed768e4">oomph::C1CurvedElementBase::dbasis_c0_eulerian</a></div><div class="ttdeci">double dbasis_c0_eulerian(const Vector&lt; double &gt; &amp;s, Shape &amp;psi, DShape &amp;dpsi) const</div><div class="ttdoc">Compute the c0-shape functions and also first derivatives w.r.t. global coordinates at local coordina...</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l04547">Subparametric_Telements.h:4547</a></div></div>
<div class="ttc" id="aclassoomph_1_1C1CurvedElementBase_html_a49a851713b2d274f14602f05733470fa"><div class="ttname"><a href="classoomph_1_1C1CurvedElementBase.html#a49a851713b2d274f14602f05733470fa">oomph::C1CurvedElementBase::dtest_local</a></div><div class="ttdeci">virtual void dtest_local(const Vector&lt; double &gt; &amp;s, Shape &amp;phi, DShape &amp;dphids) const</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l03978">Subparametric_Telements.h:3978</a></div></div>
<div class="ttc" id="aclassoomph_1_1FiniteElement_html_a28916ab3a512b5329e016d90450eb66a"><div class="ttname"><a href="classoomph_1_1FiniteElement.html#a28916ab3a512b5329e016d90450eb66a">oomph::FiniteElement::set_nnodal_position_type</a></div><div class="ttdeci">void set_nnodal_position_type(const unsigned &amp;nposition_type)</div><div class="ttdoc">Set the number of types required to interpolate the coordinate.</div><div class="ttdef"><b>Definition:</b> <a href="elements_8h_source.html#l01368">elements.h:1368</a></div></div>
<div class="ttc" id="aclassoomph_1_1BellElementBase_html_af00e238530de6269b51b57a4357d1dd6"><div class="ttname"><a href="classoomph_1_1BellElementBase.html#af00e238530de6269b51b57a4357d1dd6">oomph::BellElementBase::basis_at_knot</a></div><div class="ttdeci">void basis_at_knot(const unsigned &amp;ipt, Shape &amp;psi) const</div><div class="ttdoc">Return the C1-basis function stored at the ipt-th integration point.</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l03106">Subparametric_Telements.h:3106</a></div></div>
<div class="ttc" id="aclassoomph_1_1DenseMatrix_html"><div class="ttname"><a href="classoomph_1_1DenseMatrix.html">oomph::DenseMatrix&lt; double &gt;</a></div></div>
<div class="ttc" id="aclassoomph_1_1C1CurvedElement_3_012_00_01NNODE__1D_01_4_html_a3e7e8460e53e261ff68ac58ea57dfc87"><div class="ttname"><a href="classoomph_1_1C1CurvedElement_3_012_00_01NNODE__1D_01_4.html#a3e7e8460e53e261ff68ac58ea57dfc87">oomph::C1CurvedElement&lt; 2, NNODE_1D &gt;::nnode_1d</a></div><div class="ttdeci">unsigned nnode_1d() const</div><div class="ttdoc">Number of nodes along each element edge.</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l05196">Subparametric_Telements.h:5196</a></div></div>
<div class="ttc" id="aclassoomph_1_1BellElementBase_html_acad63d477784e6b88b92804b0f1b375e"><div class="ttname"><a href="classoomph_1_1BellElementBase.html#acad63d477784e6b88b92804b0f1b375e">oomph::BellElementBase::d2test_local_at_knot</a></div><div class="ttdeci">void d2test_local_at_knot(const unsigned &amp;ipt, Shape &amp;phi, DShape &amp;dphids, DShape &amp;d2phids) const</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l03249">Subparametric_Telements.h:3249</a></div></div>
<div class="ttc" id="aclassoomph_1_1C1CurvedElement_3_012_00_01NNODE__1D_01_4_html_a2c69150bcb82422fb38db3eeea3b0606"><div class="ttname"><a href="classoomph_1_1C1CurvedElement_3_012_00_01NNODE__1D_01_4.html#a2c69150bcb82422fb38db3eeea3b0606">oomph::C1CurvedElement&lt; 2, NNODE_1D &gt;::operator=</a></div><div class="ttdeci">void operator=(const C1CurvedElement &amp;)</div><div class="ttdoc">Broken assignment operator.</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l05188">Subparametric_Telements.h:5188</a></div></div>
<div class="ttc" id="aclassoomph_1_1C1CurvedElementBase_html_af8dc76a0a5b61c9995e172007b96a3bd"><div class="ttname"><a href="classoomph_1_1C1CurvedElementBase.html#af8dc76a0a5b61c9995e172007b96a3bd">oomph::C1CurvedElementBase::basis_c0</a></div><div class="ttdeci">virtual void basis_c0(const Vector&lt; double &gt; &amp;s, Shape &amp;psi) const</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l03959">Subparametric_Telements.h:3959</a></div></div>
<div class="ttc" id="aclassoomph_1_1C1CurvedElementBase_html_a72e258f980ba1f790e1ba0bc4ec6ef0a"><div class="ttname"><a href="classoomph_1_1C1CurvedElementBase.html#a72e258f980ba1f790e1ba0bc4ec6ef0a">oomph::C1CurvedElementBase::d2basis_c0_local</a></div><div class="ttdeci">virtual void d2basis_c0_local(const Vector&lt; double &gt; &amp;s, Shape &amp;psi, DShape &amp;dpsids, DShape &amp;d2psids) const</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l03967">Subparametric_Telements.h:3967</a></div></div>
<div class="ttc" id="aclassoomph_1_1BellElementBase_html_aab180be9cd6347005c5505bedf673db2"><div class="ttname"><a href="classoomph_1_1BellElementBase.html#aab180be9cd6347005c5505bedf673db2">oomph::BellElementBase::dtest_local</a></div><div class="ttdeci">virtual void dtest_local(const Vector&lt; double &gt; &amp;s, Shape &amp;phi, DShape &amp;dphids) const</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l03091">Subparametric_Telements.h:3091</a></div></div>
<div class="ttc" id="aclassoomph_1_1TGauss_3_012_00_015_01_4_html"><div class="ttname"><a href="classoomph_1_1TGauss_3_012_00_015_01_4.html">oomph::TGauss&lt; 2, 5 &gt;</a></div><div class="ttdef"><b>Definition:</b> <a href="integral_8h_source.html#l01142">integral.h:1142</a></div></div>
<div class="ttc" id="aclassoomph_1_1BellElementBase_html_ae863013db88be8402457a77eb5d5862f"><div class="ttname"><a href="classoomph_1_1BellElementBase.html#ae863013db88be8402457a77eb5d5862f">oomph::BellElementBase::dbasis_c0_local</a></div><div class="ttdeci">virtual void dbasis_c0_local(const Vector&lt; double &gt; &amp;s, Shape &amp;psi, DShape &amp;dpsids) const</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l03077">Subparametric_Telements.h:3077</a></div></div>
<div class="ttc" id="aclassoomph_1_1BellElementBase_html_a76ddb90394c979f9967e8fd068bdf220"><div class="ttname"><a href="classoomph_1_1BellElementBase.html#a76ddb90394c979f9967e8fd068bdf220">oomph::BellElementBase::test</a></div><div class="ttdeci">virtual void test(const Vector&lt; double &gt; &amp;s, Shape &amp;phi) const</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l03087">Subparametric_Telements.h:3087</a></div></div>
<div class="ttc" id="aclassoomph_1_1C1CurvedElement_3_012_00_01NNODE__1D_01_4_html_a155a6dffffa34a092753697098bafb57"><div class="ttname"><a href="classoomph_1_1C1CurvedElement_3_012_00_01NNODE__1D_01_4.html#a155a6dffffa34a092753697098bafb57">oomph::C1CurvedElement&lt; 2, NNODE_1D &gt;::local_coordinate_of_node</a></div><div class="ttdeci">void local_coordinate_of_node(const unsigned &amp;j, Vector&lt; double &gt; &amp;s) const</div><div class="ttdoc">Return local coordinates of node j.</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l05292">Subparametric_Telements.h:5292</a></div></div>
<div class="ttc" id="aclassoomph_1_1C1CurvedElement_3_012_00_01NNODE__1D_01_4_html_a4cb17f4e7f9253ff739a6102f1f39158"><div class="ttname"><a href="classoomph_1_1C1CurvedElement_3_012_00_01NNODE__1D_01_4.html#a4cb17f4e7f9253ff739a6102f1f39158">oomph::C1CurvedElement&lt; 2, NNODE_1D &gt;::get_value_transform_matrix</a></div><div class="ttdeci">void get_value_transform_matrix(DenseMatrix&lt; double &gt; &amp;D, DenseMatrix&lt; double &gt; &amp;B, DenseMatrix&lt; double &gt; &amp;node_position, unsigned &amp;bd_element, DenseMatrix&lt; double &gt; &amp;bd_node_position, Vector&lt; double &gt; &amp;x) const</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l05282">Subparametric_Telements.h:5282</a></div></div>
<div class="ttc" id="aclassoomph_1_1C1CurvedElementBase_html_a849f18e06c42052a964fc6ee499b3c94"><div class="ttname"><a href="classoomph_1_1C1CurvedElementBase.html#a849f18e06c42052a964fc6ee499b3c94">oomph::C1CurvedElementBase::basis_at_knot_curve</a></div><div class="ttdeci">void basis_at_knot_curve(const unsigned &amp;ipt, Shape &amp;psi) const</div><div class="ttdoc">Return the c1-shape function associated with a curvilinear boundary stored at the ipt-th integration ...</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l04049">Subparametric_Telements.h:4049</a></div></div>
<div class="ttc" id="aclassoomph_1_1FiniteElement_html_a53e5051582d9da07b9d35da9debd0cd7"><div class="ttname"><a href="classoomph_1_1FiniteElement.html#a53e5051582d9da07b9d35da9debd0cd7">oomph::FiniteElement::d2shape_local</a></div><div class="ttdeci">virtual void d2shape_local(const Vector&lt; double &gt; &amp;s, Shape &amp;psi, DShape &amp;dpsids, DShape &amp;d2psids) const</div><div class="ttdoc">Function to compute the geometric shape functions and also first and second derivatives w....</div><div class="ttdef"><b>Definition:</b> <a href="elements_8h_source.html#l01968">elements.h:1968</a></div></div>
<div class="ttc" id="aelements_8h_html"><div class="ttname"><a href="elements_8h.html">elements.h</a></div></div>
<div class="ttc" id="aclassoomph_1_1BellElementShape_3_012_01_4_html_a691a47683df33de15960e804474fc03e"><div class="ttname"><a href="classoomph_1_1BellElementShape_3_012_01_4.html#a691a47683df33de15960e804474fc03e">oomph::BellElementShape&lt; 2 &gt;::d2Bshape_local</a></div><div class="ttdeci">void d2Bshape_local(const Vector&lt; double &gt; &amp;s, Shape &amp;psi, DShape &amp;dpsids, DShape &amp;d2psids, DenseMatrix&lt; double &gt; &amp;position) const</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l00524">Subparametric_Telements.h:524</a></div></div>
<div class="ttc" id="aclassoomph_1_1BellElementShape_3_012_01_4_html_a9bdd842366843435658f1f4dea5b8121"><div class="ttname"><a href="classoomph_1_1BellElementShape_3_012_01_4.html#a9bdd842366843435658f1f4dea5b8121">oomph::BellElementShape&lt; 2 &gt;::Bshape</a></div><div class="ttdeci">void Bshape(const Vector&lt; double &gt; &amp;s, Shape &amp;psi, DenseMatrix&lt; double &gt; &amp;position) const</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l00101">Subparametric_Telements.h:101</a></div></div>
<div class="ttc" id="acfortran_8h_html_af6f0bd3dc13317f895c91323c25c2b8f"><div class="ttname"><a href="cfortran_8h.html#af6f0bd3dc13317f895c91323c25c2b8f">t</a></div><div class="ttdeci">char t</div><div class="ttdef"><b>Definition:</b> <a href="cfortran_8h_source.html#l00568">cfortran.h:568</a></div></div>
<div class="ttc" id="aclassoomph_1_1C1CurvedElementBase_html_a5b3e87cecd6887bfc7bcae8f52ebe9e4"><div class="ttname"><a href="classoomph_1_1C1CurvedElementBase.html#a5b3e87cecd6887bfc7bcae8f52ebe9e4">oomph::C1CurvedElementBase::basis_at_knot_straight</a></div><div class="ttdeci">void basis_at_knot_straight(const unsigned &amp;ipt, Shape &amp;psi) const</div><div class="ttdoc">Return the c1-shape function associated with a straight-sided</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l03993">Subparametric_Telements.h:3993</a></div></div>
<div class="ttc" id="aclassoomph_1_1BellElement_html_a60c49217f94a452387d83a521c681d01"><div class="ttname"><a href="classoomph_1_1BellElement.html#a60c49217f94a452387d83a521c681d01">oomph::BellElement::d2shape_local</a></div><div class="ttdeci">void d2shape_local(const Vector&lt; double &gt; &amp;s, Shape &amp;psi, DShape &amp;dpsids, DShape &amp;d2psids) const</div><div class="ttdoc">Computer the geometric shape functions, derivatives and second derivatives w.r.t local coordinates at...</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l03766">Subparametric_Telements.h:3766</a></div></div>
<div class="ttc" id="aclassoomph_1_1C1CurvedElementBase_html_a284de72597bf65588e53eb0b4516fa0b"><div class="ttname"><a href="classoomph_1_1C1CurvedElementBase.html#a284de72597bf65588e53eb0b4516fa0b">oomph::C1CurvedElementBase::dbasis_local_straight</a></div><div class="ttdeci">virtual void dbasis_local_straight(const Vector&lt; double &gt; &amp;s, Shape &amp;psi, DShape &amp;dpsids) const</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l03917">Subparametric_Telements.h:3917</a></div></div>
<div class="ttc" id="aintegral_8h_html"><div class="ttname"><a href="integral_8h.html">integral.h</a></div></div>
<div class="ttc" id="aclassoomph_1_1BellElementBase_html"><div class="ttname"><a href="classoomph_1_1BellElementBase.html">oomph::BellElementBase</a></div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l03052">Subparametric_Telements.h:3052</a></div></div>
<div class="ttc" id="aclassoomph_1_1BellElementBase_html_a0952ed8fcba04688fdf895dc25bb8c30"><div class="ttname"><a href="classoomph_1_1BellElementBase.html#a0952ed8fcba04688fdf895dc25bb8c30">oomph::BellElementBase::basis_c0_at_knot</a></div><div class="ttdeci">void basis_c0_at_knot(const unsigned &amp;ipt, Shape &amp;psi) const</div><div class="ttdoc">Return the C0-basis function stored at the ipt-th integration point.</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l03160">Subparametric_Telements.h:3160</a></div></div>
<div class="ttc" id="anamespaceoomph_1_1BrokenCopy_html_a7e5cd7fda8b8c790003151bee77a84ac"><div class="ttname"><a href="namespaceoomph_1_1BrokenCopy.html#a7e5cd7fda8b8c790003151bee77a84ac">oomph::BrokenCopy::broken_copy</a></div><div class="ttdeci">void broken_copy(const std::string &amp;class_name)</div><div class="ttdoc">Issue error message and terminate execution.</div><div class="ttdef"><b>Definition:</b> <a href="oomph__utilities_8cc_source.html#l00214">oomph_utilities.cc:214</a></div></div>
<div class="ttc" id="athe__data__structure_8txt_html_a3b0d20781021ec2f0e788713f8b0fec8"><div class="ttname"><a href="the__data__structure_8txt.html#a3b0d20781021ec2f0e788713f8b0fec8">value</a></div><div class="ttdeci">often abbreviated as dof b History b value</div><div class="ttdef"><b>Definition:</b> <a href="the__data__structure_8txt_source.html#l00044">the_data_structure.txt:44</a></div></div>
<div class="ttc" id="anamespaceoomph_1_1OcTreeNames_html_ae7e7e58298b85825061eeff362656c40a43c804e2bcf9862a4bf629d5f01761e8"><div class="ttname"><a href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a43c804e2bcf9862a4bf629d5f01761e8">oomph::OcTreeNames::B</a></div><div class="ttdeci">@ B</div><div class="ttdef"><b>Definition:</b> <a href="octree_8h_source.html#l00055">octree.h:55</a></div></div>
<div class="ttc" id="anamespaceoomph_1_1OneDimLagrange_html_a117f8b892dc89989ecdad99ff261e120"><div class="ttname"><a href="namespaceoomph_1_1OneDimLagrange.html#a117f8b892dc89989ecdad99ff261e120">oomph::OneDimLagrange::shape</a></div><div class="ttdeci">void shape(const double &amp;s, double *Psi)</div><div class="ttdoc">Definition for 1D Lagrange shape functions. The value of all the shape functions at the local coordin...</div><div class="ttdef"><b>Definition:</b> <a href="shape_8h_source.html#l00545">shape.h:545</a></div></div>
<div class="ttc" id="aclassoomph_1_1C1CurvedElement_html"><div class="ttname"><a href="classoomph_1_1C1CurvedElement.html">oomph::C1CurvedElement</a></div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l05134">Subparametric_Telements.h:5134</a></div></div>
<div class="ttc" id="aclassoomph_1_1C1CurvedElement_3_012_00_01NNODE__1D_01_4_html_a878207a94d904e0d954a45de2a626a0e"><div class="ttname"><a href="classoomph_1_1C1CurvedElement_3_012_00_01NNODE__1D_01_4.html#a878207a94d904e0d954a45de2a626a0e">oomph::C1CurvedElement&lt; 2, NNODE_1D &gt;::d2basis_c0_local</a></div><div class="ttdeci">void d2basis_c0_local(const Vector&lt; double &gt; &amp;s, Shape &amp;psi, DShape &amp;dpsids, DShape &amp;d2psids) const</div><div class="ttdoc">Computer the c0-shape functions, derivatives and second derivatives w.r.t local coordinates at local ...</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l05421">Subparametric_Telements.h:5421</a></div></div>
<div class="ttc" id="aclassoomph_1_1C1CurvedElementBase_html_a8f49d1ed702baf3693960c5d278d1495"><div class="ttname"><a href="classoomph_1_1C1CurvedElementBase.html#a8f49d1ed702baf3693960c5d278d1495">oomph::C1CurvedElementBase::basis_c0_at_knot</a></div><div class="ttdeci">void basis_c0_at_knot(const unsigned &amp;ipt, Shape &amp;psi) const</div><div class="ttdoc">Return the c0-shape function stored at the ipt-th integration.</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l04103">Subparametric_Telements.h:4103</a></div></div>
<div class="ttc" id="aclassoomph_1_1FiniteElement_html_ac80983f27f5bcbc08e2eeb6e4d03698b"><div class="ttname"><a href="classoomph_1_1FiniteElement.html#ac80983f27f5bcbc08e2eeb6e4d03698b">oomph::FiniteElement::set_integration_scheme</a></div><div class="ttdeci">virtual void set_integration_scheme(Integral *const &amp;integral_pt)</div><div class="ttdoc">Set the spatial integration scheme.</div><div class="ttdef"><b>Definition:</b> <a href="elements_8cc_source.html#l03146">elements.cc:3146</a></div></div>
<div class="ttc" id="aclassoomph_1_1C1CurvedElementShape_3_012_00_01NNODE__1D_01_4_html_af67d209a5cf65825e78389318dc395e6"><div class="ttname"><a href="classoomph_1_1C1CurvedElementShape_3_012_00_01NNODE__1D_01_4.html#af67d209a5cf65825e78389318dc395e6">oomph::C1CurvedElementShape&lt; 2, NNODE_1D &gt;::local_coordinate_of_node</a></div><div class="ttdeci">void local_coordinate_of_node(const unsigned &amp;j, Vector&lt; double &gt; &amp;s) const</div><div class="ttdoc">Return local coordinates of node j.</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l01449">Subparametric_Telements.h:1449</a></div></div>
<div class="ttc" id="aclassoomph_1_1BellElementBase_html_ac6c1add4a996cf149da6c85ee3f4b637"><div class="ttname"><a href="classoomph_1_1BellElementBase.html#ac6c1add4a996cf149da6c85ee3f4b637">oomph::BellElementBase::d2basis_local</a></div><div class="ttdeci">virtual void d2basis_local(const Vector&lt; double &gt; &amp;s, Shape &amp;psi, DShape &amp;dpsids, DShape &amp;d2psids) const</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l03067">Subparametric_Telements.h:3067</a></div></div>
<div class="ttc" id="aclassoomph_1_1BellElementBase_html_a5ca86e4bbc0c1c0df2554e02669a0949"><div class="ttname"><a href="classoomph_1_1BellElementBase.html#a5ca86e4bbc0c1c0df2554e02669a0949">oomph::BellElementBase::dtest_local_at_knot</a></div><div class="ttdeci">void dtest_local_at_knot(const unsigned &amp;ipt, Shape &amp;phi, DShape &amp;dphids) const</div><div class="ttdoc">Return the test function and its derivatives w.r.t. the local coordinates at the ipt-th integration p...</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l03231">Subparametric_Telements.h:3231</a></div></div>
<div class="ttc" id="anamespaceoomph_1_1OcTreeNames_html_ae7e7e58298b85825061eeff362656c40a51292b8e4d96f2bb9f0d6bb0340d1620"><div class="ttname"><a href="namespaceoomph_1_1OcTreeNames.html#ae7e7e58298b85825061eeff362656c40a51292b8e4d96f2bb9f0d6bb0340d1620">oomph::OcTreeNames::D</a></div><div class="ttdeci">@ D</div><div class="ttdef"><b>Definition:</b> <a href="octree_8h_source.html#l00055">octree.h:55</a></div></div>
<div class="ttc" id="aclassoomph_1_1Integral_html_a1a2122f99a87c18649bafdd9ed739758"><div class="ttname"><a href="classoomph_1_1Integral.html#a1a2122f99a87c18649bafdd9ed739758">oomph::Integral::knot</a></div><div class="ttdeci">virtual double knot(const unsigned &amp;i, const unsigned &amp;j) const =0</div><div class="ttdoc">Return local coordinate s[j] of i-th integration point.</div></div>
<div class="ttc" id="aclassoomph_1_1BellElementBase_html_a79c5e60fb98c9e69b096ed84b3430376"><div class="ttname"><a href="classoomph_1_1BellElementBase.html#a79c5e60fb98c9e69b096ed84b3430376">oomph::BellElementBase::BellElementBase</a></div><div class="ttdeci">BellElementBase()</div><div class="ttdoc">Constructor: Call constructors for FiniteElement.</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l03056">Subparametric_Telements.h:3056</a></div></div>
<div class="ttc" id="aclassoomph_1_1C1CurvedElementShape_3_012_00_01NNODE__1D_01_4_html_a40cd0a35dbc0402d7161f58c69d059b5"><div class="ttname"><a href="classoomph_1_1C1CurvedElementShape_3_012_00_01NNODE__1D_01_4.html#a40cd0a35dbc0402d7161f58c69d059b5">oomph::C1CurvedElementShape&lt; 2, NNODE_1D &gt;::set_of_value</a></div><div class="ttdeci">void set_of_value(DenseMatrix&lt; double &gt; &amp;D, DenseMatrix&lt; double &gt; &amp;B, DenseMatrix&lt; double &gt; &amp;position, unsigned &amp;bd_element, DenseMatrix&lt; double &gt; &amp;bd_position, Vector&lt; double &gt; &amp;x) const</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l01561">Subparametric_Telements.h:1561</a></div></div>
<div class="ttc" id="aclassoomph_1_1BellElementBase_html_a795fca0c9cfa01bf6f966f4f0a69b312"><div class="ttname"><a href="classoomph_1_1BellElementBase.html#a795fca0c9cfa01bf6f966f4f0a69b312">oomph::BellElementBase::dbasis_local_at_knot</a></div><div class="ttdeci">void dbasis_local_at_knot(const unsigned &amp;ipt, Shape &amp;psi, DShape &amp;dpsids) const</div><div class="ttdoc">Return the C1-basis function and its derivatives w.r.t. the global coordinates at the ipt-th integrat...</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l03122">Subparametric_Telements.h:3122</a></div></div>
<div class="ttc" id="aclassoomph_1_1FiniteElement_html_a79f1710873332823c47023d370f0596b"><div class="ttname"><a href="classoomph_1_1FiniteElement.html#a79f1710873332823c47023d370f0596b">oomph::FiniteElement::integral_pt</a></div><div class="ttdeci">Integral *const &amp; integral_pt() const</div><div class="ttdoc">Return the pointer to the integration scheme (const version)</div><div class="ttdef"><b>Definition:</b> <a href="elements_8h_source.html#l01921">elements.h:1921</a></div></div>
<div class="ttc" id="aclassoomph_1_1C1CurvedElementBase_html_a74fedb14f6c859fdc0d0c37d77f63963"><div class="ttname"><a href="classoomph_1_1C1CurvedElementBase.html#a74fedb14f6c859fdc0d0c37d77f63963">oomph::C1CurvedElementBase::dbasis_local_at_knot_straight</a></div><div class="ttdeci">void dbasis_local_at_knot_straight(const unsigned &amp;ipt, Shape &amp;psi, DShape &amp;dpsids) const</div><div class="ttdoc">Return the c1-shape function associated with a straight-sided boundary and its derivatives w....</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l04010">Subparametric_Telements.h:4010</a></div></div>
<div class="ttc" id="aclassoomph_1_1BellElement_html_a2d7e1df2f16e344721161ac2de099483"><div class="ttname"><a href="classoomph_1_1BellElement.html#a2d7e1df2f16e344721161ac2de099483">oomph::BellElement::d2test_local</a></div><div class="ttdeci">void d2test_local(const Vector&lt; double &gt; &amp;s, Shape &amp;psi, DShape &amp;dpsids, DShape &amp;d2psids) const</div><div class="ttdoc">Computer the test functions, derivatives and second derivatives w.r.t local coordinates at local coor...</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l03881">Subparametric_Telements.h:3881</a></div></div>
<div class="ttc" id="aclassoomph_1_1C1CurvedElement_3_012_00_01NNODE__1D_01_4_html_ab90480a9e420ce7507931376fca7dbba"><div class="ttname"><a href="classoomph_1_1C1CurvedElement_3_012_00_01NNODE__1D_01_4.html#ab90480a9e420ce7507931376fca7dbba">oomph::C1CurvedElement&lt; 2, NNODE_1D &gt;::shape_geom</a></div><div class="ttdeci">void shape_geom(const Vector&lt; double &gt; &amp;s, Shape &amp;psi, Shape &amp;phi) const</div><div class="ttdoc">Calculate the linear shape functions at local coordinate s.</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l05360">Subparametric_Telements.h:5360</a></div></div>
<div class="ttc" id="aclassoomph_1_1C1CurvedElementBase_html_abafd0a405e40d018020dbffe49cf7258"><div class="ttname"><a href="classoomph_1_1C1CurvedElementBase.html#abafd0a405e40d018020dbffe49cf7258">oomph::C1CurvedElementBase::d2shape_local_geom</a></div><div class="ttdeci">virtual void d2shape_local_geom(const Vector&lt; double &gt; &amp;s, Shape &amp;psi, DShape &amp;dpsids, DShape &amp;d2psids, Shape &amp;phi, DShape &amp;dphids, DShape &amp;d2phids) const</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l03936">Subparametric_Telements.h:3936</a></div></div>
<div class="ttc" id="aclassoomph_1_1C1CurvedElement_3_012_00_01NNODE__1D_01_4_html_ae6c5bb18e4448678ba6f8d52fe146181"><div class="ttname"><a href="classoomph_1_1C1CurvedElement_3_012_00_01NNODE__1D_01_4.html#ae6c5bb18e4448678ba6f8d52fe146181">oomph::C1CurvedElement&lt; 2, NNODE_1D &gt;::test</a></div><div class="ttdeci">void test(const Vector&lt; double &gt; &amp;s, Shape &amp;psi) const</div><div class="ttdoc">Calculate the test functions at local coordinate s.</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l05428">Subparametric_Telements.h:5428</a></div></div>
<div class="ttc" id="aclassoomph_1_1BellElement_html_aa5c3a8bc5c7b87ce5ee6fdb6b4281180"><div class="ttname"><a href="classoomph_1_1BellElement.html#aa5c3a8bc5c7b87ce5ee6fdb6b4281180">oomph::BellElement::BellElement</a></div><div class="ttdeci">BellElement()</div><div class="ttdoc">Constructor: Call constructors for BellElement.</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l03727">Subparametric_Telements.h:3727</a></div></div>
<div class="ttc" id="aclassoomph_1_1C1CurvedElementBase_html_af16c55258f87849a452de6e38c13a366"><div class="ttname"><a href="classoomph_1_1C1CurvedElementBase.html#af16c55258f87849a452de6e38c13a366">oomph::C1CurvedElementBase::my_interpolated_x</a></div><div class="ttdeci">void my_interpolated_x(const Vector&lt; double &gt; &amp;s, Vector&lt; double &gt; &amp;x) const</div><div class="ttdoc">Return FE interpolated position x[] at local coordinate s as Vector.</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l04418">Subparametric_Telements.h:4418</a></div></div>
<div class="ttc" id="aclassoomph_1_1C1CurvedElementBase_html_a2134f74d95690ebefe22339cd0041a8e"><div class="ttname"><a href="classoomph_1_1C1CurvedElementBase.html#a2134f74d95690ebefe22339cd0041a8e">oomph::C1CurvedElementBase::d2test_local_at_knot</a></div><div class="ttdeci">void d2test_local_at_knot(const unsigned &amp;ipt, Shape &amp;phi, DShape &amp;dphids, DShape &amp;d2phids) const</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l04244">Subparametric_Telements.h:4244</a></div></div>
<div class="ttc" id="anamespaceoomph_html"><div class="ttname"><a href="namespaceoomph.html">oomph</a></div><div class="ttdoc">DRAIG: Change all instances of (SPATIAL_DIM) to (DIM-1).</div><div class="ttdef"><b>Definition:</b> <a href="advection__diffusion__elements_8cc_source.html#l00029">advection_diffusion_elements.cc:29</a></div></div>
<div class="ttc" id="aclassoomph_1_1FiniteElement_html_a6219ed269a6d89b5aa14659cce48905a"><div class="ttname"><a href="classoomph_1_1FiniteElement.html#a6219ed269a6d89b5aa14659cce48905a">oomph::FiniteElement::nnode</a></div><div class="ttdeci">unsigned nnode() const</div><div class="ttdoc">Return the number of nodes.</div><div class="ttdef"><b>Definition:</b> <a href="elements_8h_source.html#l02159">elements.h:2159</a></div></div>
<div class="ttc" id="aclassoomph_1_1Node_html"><div class="ttname"><a href="classoomph_1_1Node.html">oomph::Node</a></div><div class="ttdoc">Nodes are derived from Data, but, in addition, have a definite (Eulerian) position in a space of a gi...</div><div class="ttdef"><b>Definition:</b> <a href="nodes_8h_source.html#l00847">nodes.h:847</a></div></div>
<div class="ttc" id="aclassoomph_1_1C1CurvedElementShape_3_012_00_01NNODE__1D_01_4_html_aa2eae369074920a107f6117b3b152520"><div class="ttname"><a href="classoomph_1_1C1CurvedElementShape_3_012_00_01NNODE__1D_01_4.html#aa2eae369074920a107f6117b3b152520">oomph::C1CurvedElementShape&lt; 2, NNODE_1D &gt;::dCshape_local</a></div><div class="ttdeci">void dCshape_local(const Vector&lt; double &gt; &amp;s, Shape &amp;psi_curve, DShape &amp;dpsi_curve) const</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l02212">Subparametric_Telements.h:2212</a></div></div>
<div class="ttc" id="aclassoomph_1_1Vector_html"><div class="ttname"><a href="classoomph_1_1Vector.html">oomph::Vector&lt; double &gt;</a></div></div>
<div class="ttc" id="aclassoomph_1_1Node_html_a2ca215e42116ee8a2acc7d6a35e37788"><div class="ttname"><a href="classoomph_1_1Node.html#a2ca215e42116ee8a2acc7d6a35e37788">oomph::Node::is_on_boundary</a></div><div class="ttdeci">virtual bool is_on_boundary() const</div><div class="ttdoc">Test whether the Node lies on a boundary. The &quot;bulk&quot; Node cannot lie on a boundary,...</div><div class="ttdef"><b>Definition:</b> <a href="nodes_8h_source.html#l01285">nodes.h:1285</a></div></div>
<div class="ttc" id="aclassoomph_1_1C1CurvedElementBase_html_a758d1f61da5c350b194b3421d30f394d"><div class="ttname"><a href="classoomph_1_1C1CurvedElementBase.html#a758d1f61da5c350b194b3421d30f394d">oomph::C1CurvedElementBase::d2shape_and_d2test_eulerian_at_knot</a></div><div class="ttdeci">double d2shape_and_d2test_eulerian_at_knot(const unsigned &amp;ipt, Shape &amp;psi, DShape &amp;dpsi, DShape &amp;d2psi, Shape &amp;test, DShape &amp;dtest, DShape &amp;d2test) const</div><div class="ttdoc">Compute the c1-shape functions that associated with the straight- boundary element and also first and...</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l04306">Subparametric_Telements.h:4306</a></div></div>
<div class="ttc" id="aclassoomph_1_1C1CurvedElement_3_012_00_01NNODE__1D_01_4_html_a17db4cc4715be25a4492c4569d4a8f41"><div class="ttname"><a href="classoomph_1_1C1CurvedElement_3_012_00_01NNODE__1D_01_4.html#a17db4cc4715be25a4492c4569d4a8f41">oomph::C1CurvedElement&lt; 2, NNODE_1D &gt;::d2test_local</a></div><div class="ttdeci">void d2test_local(const Vector&lt; double &gt; &amp;s, Shape &amp;psi, DShape &amp;dpsids, DShape &amp;d2psids) const</div><div class="ttdoc">Computer the geometric shape functions, derivatives and second derivatives w.r.t local coordinates at...</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l05446">Subparametric_Telements.h:5446</a></div></div>
<div class="ttc" id="aclassoomph_1_1C1CurvedElement_3_012_00_01NNODE__1D_01_4_html_a4fc4db790fca7513a3e8ceb0a7a61507"><div class="ttname"><a href="classoomph_1_1C1CurvedElement_3_012_00_01NNODE__1D_01_4.html#a4fc4db790fca7513a3e8ceb0a7a61507">oomph::C1CurvedElement&lt; 2, NNODE_1D &gt;::d2basis_local_straight</a></div><div class="ttdeci">void d2basis_local_straight(const Vector&lt; double &gt; &amp;s, Shape &amp;psi, DShape &amp;dpsids, DShape &amp;d2psids) const</div><div class="ttdoc">Compute the c1-shape functions associated with a straight-sided</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l05324">Subparametric_Telements.h:5324</a></div></div>
<div class="ttc" id="aclassoomph_1_1FiniteElement_html_a58a25b6859ddd43b7bfe64a19fee5023"><div class="ttname"><a href="classoomph_1_1FiniteElement.html#a58a25b6859ddd43b7bfe64a19fee5023">oomph::FiniteElement::shape</a></div><div class="ttdeci">virtual void shape(const Vector&lt; double &gt; &amp;s, Shape &amp;psi) const =0</div><div class="ttdoc">Calculate the geometric shape functions at local coordinate s. This function must be overloaded for e...</div></div>
<div class="ttc" id="aclassoomph_1_1C1CurvedElement_3_012_00_01NNODE__1D_01_4_html_aa0473d19ec3717e1628e85206497bb75"><div class="ttname"><a href="classoomph_1_1C1CurvedElement_3_012_00_01NNODE__1D_01_4.html#aa0473d19ec3717e1628e85206497bb75">oomph::C1CurvedElement&lt; 2, NNODE_1D &gt;::d2basis_local_curve</a></div><div class="ttdeci">void d2basis_local_curve(const Vector&lt; double &gt; &amp;s, Shape &amp;psi, DShape &amp;dpsids, DShape &amp;d2psids) const</div><div class="ttdoc">Compute the c1-shape functions associated with a curved-sided</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l05353">Subparametric_Telements.h:5353</a></div></div>
<div class="ttc" id="aclassoomph_1_1BellElement_html_aa6f76e5cba1c201863b6d45693629c2f"><div class="ttname"><a href="classoomph_1_1BellElement.html#aa6f76e5cba1c201863b6d45693629c2f">oomph::BellElement::BellElement</a></div><div class="ttdeci">BellElement(const BellElement &amp;)</div><div class="ttdoc">Broken copy constructor.</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l03736">Subparametric_Telements.h:3736</a></div></div>
<div class="ttc" id="acfortran_8h_html_adb50e893b86b3e55e751a42eab3cba82"><div class="ttname"><a href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a></div><div class="ttdeci">cstr elem_len * i</div><div class="ttdef"><b>Definition:</b> <a href="cfortran_8h_source.html#l00603">cfortran.h:603</a></div></div>
<div class="ttc" id="aclassoomph_1_1C1CurvedElement_3_012_00_01NNODE__1D_01_4_html_a4e389db9bdba834069675c79661e15fc"><div class="ttname"><a href="classoomph_1_1C1CurvedElement_3_012_00_01NNODE__1D_01_4.html#a4e389db9bdba834069675c79661e15fc">oomph::C1CurvedElement&lt; 2, NNODE_1D &gt;::C1CurvedElement</a></div><div class="ttdeci">C1CurvedElement()</div><div class="ttdoc">Constructor: Call constructors for C1CurvedElement.</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l05149">Subparametric_Telements.h:5149</a></div></div>
<div class="ttc" id="aclassoomph_1_1FiniteElement_html_ab2c61e830b834bbd1159c679b1c093ba"><div class="ttname"><a href="classoomph_1_1FiniteElement.html#ab2c61e830b834bbd1159c679b1c093ba">oomph::FiniteElement::transform_second_derivatives</a></div><div class="ttdeci">virtual void transform_second_derivatives(const DenseMatrix&lt; double &gt; &amp;jacobian, const DenseMatrix&lt; double &gt; &amp;inverse_jacobian, const DenseMatrix&lt; double &gt; &amp;jacobian2, DShape &amp;dbasis, DShape &amp;d2basis) const</div><div class="ttdoc">Convert derivatives and second derivatives w.r.t. local coordiantes to derivatives and second derivat...</div><div class="ttdef"><b>Definition:</b> <a href="elements_8cc_source.html#l03055">elements.cc:3055</a></div></div>
<div class="ttc" id="aclassoomph_1_1TElementShape_html"><div class="ttname"><a href="classoomph_1_1TElementShape.html">oomph::TElementShape</a></div><div class="ttdef"><b>Definition:</b> <a href="Telements_8h_source.html#l00230">Telements.h:230</a></div></div>
<div class="ttc" id="aclassoomph_1_1C1CurvedElement_3_012_00_01NNODE__1D_01_4_html_a584224d462537606568ccc4fd6d0b21a"><div class="ttname"><a href="classoomph_1_1C1CurvedElement_3_012_00_01NNODE__1D_01_4.html#a584224d462537606568ccc4fd6d0b21a">oomph::C1CurvedElement&lt; 2, NNODE_1D &gt;::dtest_local</a></div><div class="ttdeci">void dtest_local(const Vector&lt; double &gt; &amp;s, Shape &amp;psi, DShape &amp;dpsids) const</div><div class="ttdoc">Compute the test functions and derivatives w.r.t. local coordinates at local coordinate s.</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l05435">Subparametric_Telements.h:5435</a></div></div>
<div class="ttc" id="aclassoomph_1_1FiniteElement_html_a2c2f243c9f450c4023e5aa4246facd20"><div class="ttname"><a href="classoomph_1_1FiniteElement.html#a2c2f243c9f450c4023e5aa4246facd20">oomph::FiniteElement::transform_derivatives</a></div><div class="ttdeci">virtual void transform_derivatives(const DenseMatrix&lt; double &gt; &amp;inverse_jacobian, DShape &amp;dbasis) const</div><div class="ttdoc">Convert derivative w.r.t.local coordinates to derivatives w.r.t the coordinates used to assemble the ...</div><div class="ttdef"><b>Definition:</b> <a href="elements_8cc_source.html#l02760">elements.cc:2760</a></div></div>
<div class="ttc" id="aclassoomph_1_1C1CurvedElementBase_html_aea6eaf2184fb2ebe373b10e0e700caf3"><div class="ttname"><a href="classoomph_1_1C1CurvedElementBase.html#aea6eaf2184fb2ebe373b10e0e700caf3">oomph::C1CurvedElementBase::dbasis_c0_local</a></div><div class="ttdeci">virtual void dbasis_c0_local(const Vector&lt; double &gt; &amp;s, Shape &amp;psi, DShape &amp;dpsids) const</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l03963">Subparametric_Telements.h:3963</a></div></div>
<div class="ttc" id="aclassoomph_1_1C1CurvedElementBase_html_a819873b0790335875e6c009d63615464"><div class="ttname"><a href="classoomph_1_1C1CurvedElementBase.html#a819873b0790335875e6c009d63615464">oomph::C1CurvedElementBase::is_boundary_element</a></div><div class="ttdeci">unsigned is_boundary_element() const</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l04515">Subparametric_Telements.h:4515</a></div></div>
<div class="ttc" id="aclassoomph_1_1DShape_html"><div class="ttname"><a href="classoomph_1_1DShape.html">oomph::DShape</a></div><div class="ttdef"><b>Definition:</b> <a href="shape_8h_source.html#l00271">shape.h:271</a></div></div>
<div class="ttc" id="aclassoomph_1_1FaceGeometry_3_01C1CurvedElement_3_012_00_01NNODE__1D_01_4_01_4_html_a72bc38ac6bbdedd73cb1956781f9d49d"><div class="ttname"><a href="classoomph_1_1FaceGeometry_3_01C1CurvedElement_3_012_00_01NNODE__1D_01_4_01_4.html#a72bc38ac6bbdedd73cb1956781f9d49d">oomph::FaceGeometry&lt; C1CurvedElement&lt; 2, NNODE_1D &gt; &gt;::FaceGeometry</a></div><div class="ttdeci">FaceGeometry()</div><div class="ttdoc">Constructor: Call the constructor for the appropriate lower-dimensional QElement.</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l05490">Subparametric_Telements.h:5490</a></div></div>
<div class="ttc" id="aclassoomph_1_1BellElementBase_html_a27559cf4dd3cb50a84dfe40378c9c453"><div class="ttname"><a href="classoomph_1_1BellElementBase.html#a27559cf4dd3cb50a84dfe40378c9c453">oomph::BellElementBase::dbasis_c0_eulerian</a></div><div class="ttdeci">double dbasis_c0_eulerian(const Vector&lt; double &gt; &amp;s, Shape &amp;psi, DShape &amp;dpsi) const</div><div class="ttdoc">Compute the curved-element shape functions and also first derivatives w.r.t. local coordinates at loc...</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l03269">Subparametric_Telements.h:3269</a></div></div>
<div class="ttc" id="aclassoomph_1_1BellElementBase_html_ae576f35c4faeeed475dff67a8b31ac37"><div class="ttname"><a href="classoomph_1_1BellElementBase.html#ae576f35c4faeeed475dff67a8b31ac37">oomph::BellElementBase::d2test_local</a></div><div class="ttdeci">virtual void d2test_local(const Vector&lt; double &gt; &amp;s, Shape &amp;phi, DShape &amp;dphids, DShape &amp;d2phids) const</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l03095">Subparametric_Telements.h:3095</a></div></div>
<div class="ttc" id="aclassoomph_1_1BellElementBase_html_a1d20473bb357a28c9aeea91454b4c959"><div class="ttname"><a href="classoomph_1_1BellElementBase.html#a1d20473bb357a28c9aeea91454b4c959">oomph::BellElementBase::dbasis_c0_local_at_knot</a></div><div class="ttdeci">void dbasis_c0_local_at_knot(const unsigned &amp;ipt, Shape &amp;psi, DShape &amp;dpsids) const</div><div class="ttdoc">Return the C0-basis function and its derivatives w.r.t. the local coordinates at the ipt-th integrati...</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l03176">Subparametric_Telements.h:3176</a></div></div>
<div class="ttc" id="aclassoomph_1_1C1CurvedElementBase_html_a73eff2b9d4873234465778f53bbeaec8"><div class="ttname"><a href="classoomph_1_1C1CurvedElementBase.html#a73eff2b9d4873234465778f53bbeaec8">oomph::C1CurvedElementBase::dshape_local_geom</a></div><div class="ttdeci">virtual void dshape_local_geom(const Vector&lt; double &gt; &amp;s, Shape &amp;psi, DShape &amp;dpsids, Shape &amp;phi, DShape &amp;dphids) const</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l03931">Subparametric_Telements.h:3931</a></div></div>
<div class="ttc" id="aclassoomph_1_1BellElement_html_aeeceae57e24c50d838e993fd92c8bc68"><div class="ttname"><a href="classoomph_1_1BellElement.html#aeeceae57e24c50d838e993fd92c8bc68">oomph::BellElement::dbasis_local</a></div><div class="ttdeci">void dbasis_local(const Vector&lt; double &gt; &amp;s, Shape &amp;psi, DShape &amp;dpsids) const</div><div class="ttdoc">Compute the c1-basis functions and derivatives w.r.t. global coordinates at local coordinate s.</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l03794">Subparametric_Telements.h:3794</a></div></div>
<div class="ttc" id="aclassoomph_1_1BellElementBase_html_abd5f258248221f2f564c87ced9e0a83e"><div class="ttname"><a href="classoomph_1_1BellElementBase.html#abd5f258248221f2f564c87ced9e0a83e">oomph::BellElementBase::myassemble_local_to_eulerian_jacobian2</a></div><div class="ttdeci">void myassemble_local_to_eulerian_jacobian2(const DShape &amp;d2psids, DenseMatrix&lt; double &gt; &amp;jacobian2) const</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l03642">Subparametric_Telements.h:3642</a></div></div>
<div class="ttc" id="aclassoomph_1_1C1CurvedElementShape_3_012_00_01NNODE__1D_01_4_html_a929507d3ddca39a6e27105b959853d84"><div class="ttname"><a href="classoomph_1_1C1CurvedElementShape_3_012_00_01NNODE__1D_01_4.html#a929507d3ddca39a6e27105b959853d84">oomph::C1CurvedElementShape&lt; 2, NNODE_1D &gt;::d2basis_local_curve</a></div><div class="ttdeci">void d2basis_local_curve(const Vector&lt; double &gt; &amp;s, Shape &amp;psi_curve, DShape &amp;dpsi_curve, DShape &amp;d2psi_curve) const</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l02924">Subparametric_Telements.h:2924</a></div></div>
<div class="ttc" id="aclassoomph_1_1FiniteElement_html_a36f4cb7569a545a9d93b66e6ee03cc91"><div class="ttname"><a href="classoomph_1_1FiniteElement.html#a36f4cb7569a545a9d93b66e6ee03cc91">oomph::FiniteElement::nnodal_position_type</a></div><div class="ttdeci">unsigned nnodal_position_type() const</div><div class="ttdoc">Return the number of coordinate types that the element requires to interpolate the geometry between t...</div><div class="ttdef"><b>Definition:</b> <a href="elements_8h_source.html#l02365">elements.h:2365</a></div></div>
<div class="ttc" id="aclassoomph_1_1C1CurvedElement_3_012_00_01NNODE__1D_01_4_html_ab7642a52d95f8b554f614b6fc5710a35"><div class="ttname"><a href="classoomph_1_1C1CurvedElement_3_012_00_01NNODE__1D_01_4.html#ab7642a52d95f8b554f614b6fc5710a35">oomph::C1CurvedElement&lt; 2, NNODE_1D &gt;::classify_boundary_node</a></div><div class="ttdeci">void classify_boundary_node(DenseMatrix&lt; double &gt; &amp;node_position, unsigned &amp;bd_element, DenseMatrix&lt; double &gt; &amp;bd_node_position, Vector&lt; double &gt; &amp;x) const</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l05225">Subparametric_Telements.h:5225</a></div></div>
<div class="ttc" id="aclassoomph_1_1BellElementShape_html"><div class="ttname"><a href="classoomph_1_1BellElementShape.html">oomph::BellElementShape</a></div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l00061">Subparametric_Telements.h:61</a></div></div>
<div class="ttc" id="aclassoomph_1_1GeometricTElement_3_012_01_4_html_a3ab2648ee1e98ad31c5246a8bd189556"><div class="ttname"><a href="classoomph_1_1GeometricTElement_3_012_01_4.html#a3ab2648ee1e98ad31c5246a8bd189556">oomph::GeometricTElement&lt; 2 &gt;::dLshape_local</a></div><div class="ttdeci">void dLshape_local(const Vector&lt; double &gt; &amp;s, Shape &amp;psi, DShape &amp;dpsids, Shape &amp;phi, DShape &amp;dphids, DenseMatrix&lt; double &gt; &amp;position, unsigned &amp;bd_element, DenseMatrix&lt; double &gt; &amp;bd_position, Vector&lt; double &gt; &amp;x) const</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l01251">Subparametric_Telements.h:1251</a></div></div>
<div class="ttc" id="aclassoomph_1_1FiniteElement_html_a5da80bbed97543e586f698251d67941d"><div class="ttname"><a href="classoomph_1_1FiniteElement.html#a5da80bbed97543e586f698251d67941d">oomph::FiniteElement::nodal_local_eqn</a></div><div class="ttdeci">int nodal_local_eqn(const unsigned &amp;n, const unsigned &amp;i) const</div><div class="ttdoc">Return the local equation number corresponding to the i-th value at the n-th local node.</div><div class="ttdef"><b>Definition:</b> <a href="elements_8h_source.html#l01399">elements.h:1399</a></div></div>
<div class="ttc" id="aclassoomph_1_1FiniteElement_html_ab6602b43c3a2f1a5e48729b0b23c0d91"><div class="ttname"><a href="classoomph_1_1FiniteElement.html#ab6602b43c3a2f1a5e48729b0b23c0d91">oomph::FiniteElement::nodal_dimension</a></div><div class="ttdeci">unsigned nodal_dimension() const</div><div class="ttdoc">Return the required Eulerian dimension of the nodes in this element.</div><div class="ttdef"><b>Definition:</b> <a href="elements_8h_source.html#l02383">elements.h:2383</a></div></div>
<div class="ttc" id="aclassoomph_1_1BellElementBase_html_a17c3c26035cb8f8696073b97dabbe392"><div class="ttname"><a href="classoomph_1_1BellElementBase.html#a17c3c26035cb8f8696073b97dabbe392">oomph::BellElementBase::local_to_eulerian_mapping2</a></div><div class="ttdeci">double local_to_eulerian_mapping2(const DShape &amp;dpsids, DenseMatrix&lt; double &gt; &amp;inverse_jacobian) const</div><div class="ttdoc">Calculate the mapping from local to Eulerian coordinates, given the derivatives of the shape function...</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l03494">Subparametric_Telements.h:3494</a></div></div>
<div class="ttc" id="aclassoomph_1_1C1CurvedElementBase_html_a7bcb3462fd699a3b3f6a8336ec8ed62e"><div class="ttname"><a href="classoomph_1_1C1CurvedElementBase.html#a7bcb3462fd699a3b3f6a8336ec8ed62e">oomph::C1CurvedElementBase::d2basis_local_curve</a></div><div class="ttdeci">virtual void d2basis_local_curve(const Vector&lt; double &gt; &amp;s, Shape &amp;psi, DShape &amp;dpsids, DShape &amp;d2psids) const</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l03953">Subparametric_Telements.h:3953</a></div></div>
<div class="ttc" id="aclassoomph_1_1C1CurvedElementBase_html_acf744418145e719529ce0f09746976d3"><div class="ttname"><a href="classoomph_1_1C1CurvedElementBase.html#acf744418145e719529ce0f09746976d3">oomph::C1CurvedElementBase::C1CurvedElementBase</a></div><div class="ttdeci">C1CurvedElementBase()</div><div class="ttdoc">Constructor: Call constructors for FiniteElement.</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l03904">Subparametric_Telements.h:3904</a></div></div>
<div class="ttc" id="aclassoomph_1_1C1CurvedElementBase_html_ab7e659908f8da866873b8b0a46519c61"><div class="ttname"><a href="classoomph_1_1C1CurvedElementBase.html#ab7e659908f8da866873b8b0a46519c61">oomph::C1CurvedElementBase::get_nodal_value_curve1</a></div><div class="ttdeci">void get_nodal_value_curve1(Vector&lt; double &gt; &amp;u_value, DenseMatrix&lt; double &gt; &amp;M)</div><div class="ttdoc">Return raw nodal value for nodes specified on the reference triangle.</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l04698">Subparametric_Telements.h:4698</a></div></div>
<div class="ttc" id="aclassoomph_1_1FiniteElement_html_abdc430bef622e0257397407416e6aac8"><div class="ttname"><a href="classoomph_1_1FiniteElement.html#abdc430bef622e0257397407416e6aac8">oomph::FiniteElement::raw_nodal_value</a></div><div class="ttdeci">double raw_nodal_value(const unsigned &amp;n, const unsigned &amp;i) const</div><div class="ttdoc">Return the i-th value stored at local node n but do NOT take hanging nodes into account.</div><div class="ttdef"><b>Definition:</b> <a href="elements_8h_source.html#l02471">elements.h:2471</a></div></div>
<div class="ttc" id="aclassoomph_1_1C1CurvedElementBase_html_a2cd586d0a06b6dcff44487da273b3642"><div class="ttname"><a href="classoomph_1_1C1CurvedElementBase.html#a2cd586d0a06b6dcff44487da273b3642">oomph::C1CurvedElementBase::dshape_local_at_knot_geom</a></div><div class="ttdeci">void dshape_local_at_knot_geom(const unsigned &amp;ipt, Shape &amp;psi, DShape &amp;dpsids, Shape &amp;phi, DShape &amp;dphids) const</div><div class="ttdoc">Return the geometric shape function and its derivatives w.r.t. the local coordinates at the ipt-th in...</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l04171">Subparametric_Telements.h:4171</a></div></div>
<div class="ttc" id="aclassoomph_1_1C1CurvedElementBase_html_a5c56b56c6c246769b0b5fd3f20253ffe"><div class="ttname"><a href="classoomph_1_1C1CurvedElementBase.html#a5c56b56c6c246769b0b5fd3f20253ffe">oomph::C1CurvedElementBase::myassemble_local_to_eulerian_jacobian2</a></div><div class="ttdeci">void myassemble_local_to_eulerian_jacobian2(const DShape &amp;d2psids, DenseMatrix&lt; double &gt; &amp;jacobian2) const</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l04392">Subparametric_Telements.h:4392</a></div></div>
<div class="ttc" id="aclassoomph_1_1C1CurvedElement_3_012_00_01NNODE__1D_01_4_html_a075b64b7a480cf9839ae308764c5f355"><div class="ttname"><a href="classoomph_1_1C1CurvedElement_3_012_00_01NNODE__1D_01_4.html#a075b64b7a480cf9839ae308764c5f355">oomph::C1CurvedElement&lt; 2, NNODE_1D &gt;::d2shape_local_geom</a></div><div class="ttdeci">void d2shape_local_geom(const Vector&lt; double &gt; &amp;s, Shape &amp;psi, DShape &amp;dpsids, DShape &amp;d2psids, Shape &amp;phi, DShape &amp;dphids, DShape &amp;d2phids) const</div><div class="ttdoc">Compute the linear functions and derivatives w.r.t. local coordinates at local coordinate s.</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l05389">Subparametric_Telements.h:5389</a></div></div>
<div class="ttc" id="aclassoomph_1_1C1CurvedElementBase_html_a297ab604e37d625a8d78f9411326650b"><div class="ttname"><a href="classoomph_1_1C1CurvedElementBase.html#a297ab604e37d625a8d78f9411326650b">oomph::C1CurvedElementBase::shape_at_knot_geom</a></div><div class="ttdeci">void shape_at_knot_geom(const unsigned &amp;ipt, Shape &amp;psi, Shape &amp;phi) const</div><div class="ttdoc">Return the geometric shape function stored at the ipt-th integration point.</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l04155">Subparametric_Telements.h:4155</a></div></div>
<div class="ttc" id="aclassoomph_1_1C1CurvedElementBase_html_aee42a8d77efc26f00b8d13337f9fb4f4"><div class="ttname"><a href="classoomph_1_1C1CurvedElementBase.html#aee42a8d77efc26f00b8d13337f9fb4f4">oomph::C1CurvedElementBase::get_nodal_eqn_curve</a></div><div class="ttdeci">void get_nodal_eqn_curve(DenseMatrix&lt; int &gt; &amp;nodal_eqn)</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l04772">Subparametric_Telements.h:4772</a></div></div>
<div class="ttc" id="aclassoomph_1_1C1CurvedElementBase_html_a77dd032b44618de5e12187e88a1c7007"><div class="ttname"><a href="classoomph_1_1C1CurvedElementBase.html#a77dd032b44618de5e12187e88a1c7007">oomph::C1CurvedElementBase::d2basis_c0_local_at_knot</a></div><div class="ttdeci">void d2basis_c0_local_at_knot(const unsigned &amp;ipt, Shape &amp;psi, DShape &amp;dpsids, DShape &amp;d2psids) const</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l04137">Subparametric_Telements.h:4137</a></div></div>
<div class="ttc" id="aclassoomph_1_1BellElementShape_3_012_01_4_html_ad9b2789592d62d6d08c121d795921dd8"><div class="ttname"><a href="classoomph_1_1BellElementShape_3_012_01_4.html#ad9b2789592d62d6d08c121d795921dd8">oomph::BellElementShape&lt; 2 &gt;::local_coordinate_of_node</a></div><div class="ttdeci">void local_coordinate_of_node(const unsigned &amp;j, Vector&lt; double &gt; &amp;s) const</div><div class="ttdoc">Return local coordinates of node j.</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l00070">Subparametric_Telements.h:70</a></div></div>
<div class="ttc" id="aclassoomph_1_1BellElement_html_a31a6dfd140d030104094a333d4331dbc"><div class="ttname"><a href="classoomph_1_1BellElement.html#a31a6dfd140d030104094a333d4331dbc">oomph::BellElement::basis</a></div><div class="ttdeci">void basis(const Vector&lt; double &gt; &amp;s, Shape &amp;psi) const</div><div class="ttdoc">Calculate the c1-basis functions at local coordinate s.</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l03773">Subparametric_Telements.h:3773</a></div></div>
<div class="ttc" id="aclassoomph_1_1LinearTElement_3_012_01_4_html_a25953f47a9f66aaa947cba3c667f0ef2"><div class="ttname"><a href="classoomph_1_1LinearTElement_3_012_01_4.html#a25953f47a9f66aaa947cba3c667f0ef2">oomph::LinearTElement&lt; 2 &gt;::dLshape_local</a></div><div class="ttdeci">void dLshape_local(const Vector&lt; double &gt; &amp;s, Shape &amp;psi, DShape &amp;dpsids) const</div><div class="ttdoc">Derivatives of shape functions for specific TElement&lt;2,2&gt;</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l01069">Subparametric_Telements.h:1069</a></div></div>
<div class="ttc" id="aclassoomph_1_1C1CurvedElementBase_html_aedb2b90914f244cd86b2565a658cb9eb"><div class="ttname"><a href="classoomph_1_1C1CurvedElementBase.html#aedb2b90914f244cd86b2565a658cb9eb">oomph::C1CurvedElementBase::d2test_local</a></div><div class="ttdeci">virtual void d2test_local(const Vector&lt; double &gt; &amp;s, Shape &amp;phi, DShape &amp;dphids, DShape &amp;d2phids) const</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l03982">Subparametric_Telements.h:3982</a></div></div>
<div class="ttc" id="aclassoomph_1_1BellElementBase_html_a20792e4f9ae0fcfadc406c4fca5ca0f6"><div class="ttname"><a href="classoomph_1_1BellElementBase.html#a20792e4f9ae0fcfadc406c4fca5ca0f6">oomph::BellElementBase::local_to_eulerian_mapping2</a></div><div class="ttdeci">virtual double local_to_eulerian_mapping2(const DShape &amp;dpsids, DenseMatrix&lt; double &gt; &amp;jacobian, DenseMatrix&lt; double &gt; &amp;inverse_jacobian) const</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l03506">Subparametric_Telements.h:3506</a></div></div>
<div class="ttc" id="aclassoomph_1_1FaceElement_html"><div class="ttname"><a href="classoomph_1_1FaceElement.html">oomph::FaceElement</a></div><div class="ttdef"><b>Definition:</b> <a href="elements_8h_source.html#l04215">elements.h:4215</a></div></div>
<div class="ttc" id="aclassoomph_1_1C1CurvedElementShape_3_012_00_01NNODE__1D_01_4_html_ac1c436b2c6f49da2e0503ac4a746ba8b"><div class="ttname"><a href="classoomph_1_1C1CurvedElementShape_3_012_00_01NNODE__1D_01_4.html#ac1c436b2c6f49da2e0503ac4a746ba8b">oomph::C1CurvedElementShape&lt; 2, NNODE_1D &gt;::basis_curve</a></div><div class="ttdeci">void basis_curve(const Vector&lt; double &gt; &amp;s, Shape &amp;psi_curve) const</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l02795">Subparametric_Telements.h:2795</a></div></div>
<div class="ttc" id="aclassoomph_1_1C1CurvedElement_3_012_00_01NNODE__1D_01_4_html_a038bf547d8348358f795f52cd3b7fb99"><div class="ttname"><a href="classoomph_1_1C1CurvedElement_3_012_00_01NNODE__1D_01_4.html#a038bf547d8348358f795f52cd3b7fb99">oomph::C1CurvedElement&lt; 2, NNODE_1D &gt;::ninternal_node</a></div><div class="ttdeci">unsigned ninternal_node() const</div><div class="ttdoc">Number of internal nodes.</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l05203">Subparametric_Telements.h:5203</a></div></div>
<div class="ttc" id="aclassoomph_1_1C1CurvedElementBase_html_aa13f07f1ec64a996149ab7c9e10378a0"><div class="ttname"><a href="classoomph_1_1C1CurvedElementBase.html#aa13f07f1ec64a996149ab7c9e10378a0">oomph::C1CurvedElementBase::dbasis_eulerian_curve</a></div><div class="ttdeci">double dbasis_eulerian_curve(const Vector&lt; double &gt; &amp;s, Shape &amp;psi, DShape &amp;dpsi) const</div><div class="ttdoc">Compute the curved-element shape functions and also first derivatives w.r.t. global coordinates at lo...</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l04625">Subparametric_Telements.h:4625</a></div></div>
<div class="ttc" id="aclassoomph_1_1CurvedTGauss_html"><div class="ttname"><a href="classoomph_1_1CurvedTGauss.html">oomph::CurvedTGauss</a></div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l01113">Subparametric_Telements.h:1113</a></div></div>
<div class="ttc" id="aclassoomph_1_1BellElementBase_html_aa838429de6549ebb7b9c6d47b17b7859"><div class="ttname"><a href="classoomph_1_1BellElementBase.html#aa838429de6549ebb7b9c6d47b17b7859">oomph::BellElementBase::test_at_knot</a></div><div class="ttdeci">void test_at_knot(const unsigned &amp;ipt, Shape &amp;phi) const</div><div class="ttdoc">Return the test function stored at the ipt-th integration point.</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l03215">Subparametric_Telements.h:3215</a></div></div>
<div class="ttc" id="aclassoomph_1_1LinearTElement_3_012_01_4_html_ab20729d302959a5d81e0dfa8b3f4b9e5"><div class="ttname"><a href="classoomph_1_1LinearTElement_3_012_01_4.html#ab20729d302959a5d81e0dfa8b3f4b9e5">oomph::LinearTElement&lt; 2 &gt;::Lshape</a></div><div class="ttdeci">void Lshape(const Vector&lt; double &gt; &amp;s, Shape &amp;psi) const</div><div class="ttdoc">Shape function for specific TElement&lt;2,2&gt;</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l01058">Subparametric_Telements.h:1058</a></div></div>
<div class="ttc" id="aclassoomph_1_1BellElementBase_html_ac975de34dadf1e1409bb022af6ed1b1d"><div class="ttname"><a href="classoomph_1_1BellElementBase.html#ac975de34dadf1e1409bb022af6ed1b1d">oomph::BellElementBase::d2basis_c0_eulerian</a></div><div class="ttdeci">double d2basis_c0_eulerian(const Vector&lt; double &gt; &amp;s, Shape &amp;psi, DShape &amp;dpsi, DShape &amp;d2psi) const</div><div class="ttdoc">Compute the c0-basis functions and also first and second derivatives w.r.t. local coordinates at ipt-...</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l03305">Subparametric_Telements.h:3305</a></div></div>
<div class="ttc" id="aclassoomph_1_1C1CurvedElement_3_012_00_01NNODE__1D_01_4_html_a97e774d78da4118400b554ddf59fdbeb"><div class="ttname"><a href="classoomph_1_1C1CurvedElement_3_012_00_01NNODE__1D_01_4.html#a97e774d78da4118400b554ddf59fdbeb">oomph::C1CurvedElement&lt; 2, NNODE_1D &gt;::basis_curve</a></div><div class="ttdeci">void basis_curve(const Vector&lt; double &gt; &amp;s, Shape &amp;psi) const</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l05338">Subparametric_Telements.h:5338</a></div></div>
<div class="ttc" id="aclassoomph_1_1FiniteElement_html_a28fd5c2d4aeba5ef65bee0e0d72569f5"><div class="ttname"><a href="classoomph_1_1FiniteElement.html#a28fd5c2d4aeba5ef65bee0e0d72569f5">oomph::FiniteElement::nodal_value</a></div><div class="ttdeci">double nodal_value(const unsigned &amp;n, const unsigned &amp;i) const</div><div class="ttdoc">Return the i-th value stored at local node n. Produces suitably interpolated values for hanging nodes...</div><div class="ttdef"><b>Definition:</b> <a href="elements_8h_source.html#l02483">elements.h:2483</a></div></div>
<div class="ttc" id="aclassoomph_1_1BellElement_html_a3a7b703738e3de182b26b299626d869a"><div class="ttname"><a href="classoomph_1_1BellElement.html#a3a7b703738e3de182b26b299626d869a">oomph::BellElement::dbasis_c0_local</a></div><div class="ttdeci">void dbasis_c0_local(const Vector&lt; double &gt; &amp;s, Shape &amp;psi, DShape &amp;dpsids) const</div><div class="ttdoc">Compute the c0-basis functions and derivatives w.r.t. local coordinates at local coordinate s.</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l03845">Subparametric_Telements.h:3845</a></div></div>
<div class="ttc" id="aclassoomph_1_1C1CurvedElementBase_html_ad4a034b3edc770df5b37cf8a15595fd8"><div class="ttname"><a href="classoomph_1_1C1CurvedElementBase.html#ad4a034b3edc770df5b37cf8a15595fd8">oomph::C1CurvedElementBase::d2basis_c0_eulerian</a></div><div class="ttdeci">double d2basis_c0_eulerian(const Vector&lt; double &gt; &amp;s, Shape &amp;psi, DShape &amp;dpsi, DShape &amp;d2psi) const</div><div class="ttdoc">Compute the c0-shape functions and also the first and the second derivatives w.r.t....</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l04583">Subparametric_Telements.h:4583</a></div></div>
<div class="ttc" id="athe__data__structure_8txt_html_a26a1818885f7aebd0129ce36f6d391e8"><div class="ttname"><a href="the__data__structure_8txt.html#a26a1818885f7aebd0129ce36f6d391e8">a</a></div><div class="ttdeci">often abbreviated as dof b History b history values are but b not b the values at previous timesteps b Pinned c c c Mesh and c Problem subsection data Data The most elementary data structure in c oomph lib is c these values fall into two and those that must be determined as part of the solution c Data stores a value a double precision number the values of the unknowns are determined by the solution of a system of algebraic equations The solution of this system usually requires a(linear) numbering of the unknowns and associated equations. Hence</div></div>
<div class="ttc" id="aclassoomph_1_1BellElementBase_html_ae19c2d108290a6d46d6453ea324820f6"><div class="ttname"><a href="classoomph_1_1BellElementBase.html#ae19c2d108290a6d46d6453ea324820f6">oomph::BellElementBase::J_eulerian1</a></div><div class="ttdeci">double J_eulerian1(const Vector&lt; double &gt; &amp;s) const</div><div class="ttdoc">Calculate the Jacobian of the mapping between local and global coordinates at the position s.</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l03551">Subparametric_Telements.h:3551</a></div></div>
<div class="ttc" id="aclassoomph_1_1Shape_html"><div class="ttname"><a href="classoomph_1_1Shape.html">oomph::Shape</a></div><div class="ttdef"><b>Definition:</b> <a href="shape_8h_source.html#l00077">shape.h:77</a></div></div>
<div class="ttc" id="aclassoomph_1_1FiniteElement_html_a1d33f53e2b2813fba8a0e8b458bf2047"><div class="ttname"><a href="classoomph_1_1FiniteElement.html#a1d33f53e2b2813fba8a0e8b458bf2047">oomph::FiniteElement::position</a></div><div class="ttdeci">void position(const Vector&lt; double &gt; &amp;zeta, Vector&lt; double &gt; &amp;r) const</div><div class="ttdoc">Return the parametrised position of the FiniteElement in its incarnation as a GeomObject,...</div><div class="ttdef"><b>Definition:</b> <a href="elements_8h_source.html#l02548">elements.h:2548</a></div></div>
<div class="ttc" id="aclassoomph_1_1C1CurvedElement_3_012_00_01NNODE__1D_01_4_html_a51fd0d8ec09057548696aa99562b9f5a"><div class="ttname"><a href="classoomph_1_1C1CurvedElement_3_012_00_01NNODE__1D_01_4.html#a51fd0d8ec09057548696aa99562b9f5a">oomph::C1CurvedElement&lt; 2, NNODE_1D &gt;::dbasis_c0_local</a></div><div class="ttdeci">void dbasis_c0_local(const Vector&lt; double &gt; &amp;s, Shape &amp;psi, DShape &amp;dpsids) const</div><div class="ttdoc">Compute the c0-shape functions and derivatives w.r.t. local coordinates at local coordinate s.</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l05410">Subparametric_Telements.h:5410</a></div></div>
<div class="ttc" id="aclassoomph_1_1BellElementBase_html_ae5a43211398722298cf88ded87dee6ab"><div class="ttname"><a href="classoomph_1_1BellElementBase.html#ae5a43211398722298cf88ded87dee6ab">oomph::BellElementBase::d2basis_local_at_knot</a></div><div class="ttdeci">void d2basis_local_at_knot(const unsigned &amp;ipt, Shape &amp;psi, DShape &amp;dpsids, DShape &amp;d2psids) const</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l03141">Subparametric_Telements.h:3141</a></div></div>
<div class="ttc" id="anamespaceoomph_1_1VectorHelpers_html_af92401cf726dc1712b7fb861b8416e69"><div class="ttname"><a href="namespaceoomph_1_1VectorHelpers.html#af92401cf726dc1712b7fb861b8416e69">oomph::VectorHelpers::magnitude</a></div><div class="ttdeci">double magnitude(const Vector&lt; double &gt; &amp;a)</div><div class="ttdoc">Get the magnitude of a vector.</div><div class="ttdef"><b>Definition:</b> <a href="Vector_8h_source.html#l00297">Vector.h:297</a></div></div>
<div class="ttc" id="aclassoomph_1_1BellElement_html_a3aba354751518a5f1bfe95c531e3d464"><div class="ttname"><a href="classoomph_1_1BellElement.html#a3aba354751518a5f1bfe95c531e3d464">oomph::BellElement::dshape_local</a></div><div class="ttdeci">void dshape_local(const Vector&lt; double &gt; &amp;s, Shape &amp;psi, DShape &amp;dpsids) const</div><div class="ttdoc">Compute the geometric shape functions and derivatives w.r.t. local coordinates at local coordinate s.</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l03755">Subparametric_Telements.h:3755</a></div></div>
<div class="ttc" id="aclassoomph_1_1GeometricTElement_html"><div class="ttname"><a href="classoomph_1_1GeometricTElement.html">oomph::GeometricTElement</a></div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l01138">Subparametric_Telements.h:1138</a></div></div>
<div class="ttc" id="acfortran_8h_html_ab7123126e4885ef647dd9c6e3807a21c"><div class="ttname"><a href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a></div><div class="ttdeci">static char t char * s</div><div class="ttdef"><b>Definition:</b> <a href="cfortran_8h_source.html#l00568">cfortran.h:568</a></div></div>
<div class="ttc" id="aclassoomph_1_1FaceGeometry_html"><div class="ttname"><a href="classoomph_1_1FaceGeometry.html">oomph::FaceGeometry</a></div><div class="ttdef"><b>Definition:</b> <a href="elements_8h_source.html#l04837">elements.h:4837</a></div></div>
<div class="ttc" id="anamespaceoomph_1_1BrokenCopy_html_a32dc384e671e786bac0c67cbff701f45"><div class="ttname"><a href="namespaceoomph_1_1BrokenCopy.html#a32dc384e671e786bac0c67cbff701f45">oomph::BrokenCopy::broken_assign</a></div><div class="ttdeci">void broken_assign(const std::string &amp;class_name)</div><div class="ttdoc">Issue error message and terminate execution.</div><div class="ttdef"><b>Definition:</b> <a href="oomph__utilities_8cc_source.html#l00197">oomph_utilities.cc:197</a></div></div>
<div class="ttc" id="aclassoomph_1_1C1CurvedElement_3_012_00_01NNODE__1D_01_4_html_a88435c4bcf40bbe214598d76c88b49fc"><div class="ttname"><a href="classoomph_1_1C1CurvedElement_3_012_00_01NNODE__1D_01_4.html#a88435c4bcf40bbe214598d76c88b49fc">oomph::C1CurvedElement&lt; 2, NNODE_1D &gt;::basis_c0</a></div><div class="ttdeci">void basis_c0(const Vector&lt; double &gt; &amp;s, Shape &amp;psi) const</div><div class="ttdoc">Calculate the c0-shape functions at local coordinate s.</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l05403">Subparametric_Telements.h:5403</a></div></div>
<div class="ttc" id="aclassoomph_1_1C1CurvedElementBase_html_a3062f4ef25e52d39a9b9ced665a361d0"><div class="ttname"><a href="classoomph_1_1C1CurvedElementBase.html#a3062f4ef25e52d39a9b9ced665a361d0">oomph::C1CurvedElementBase::d2basis_local_at_knot_curve</a></div><div class="ttdeci">void d2basis_local_at_knot_curve(const unsigned &amp;ipt, Shape &amp;psi, DShape &amp;dpsids, DShape &amp;d2psids) const</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l04085">Subparametric_Telements.h:4085</a></div></div>
<div class="ttc" id="aclassoomph_1_1C1CurvedElementBase_html_a909d924bec591390020dbcfe5c0d3e0e"><div class="ttname"><a href="classoomph_1_1C1CurvedElementBase.html#a909d924bec591390020dbcfe5c0d3e0e">oomph::C1CurvedElementBase::my_interpolated_u_normal1</a></div><div class="ttdeci">void my_interpolated_u_normal1(const Vector&lt; double &gt; s, Vector&lt; double &gt; &amp;interpolated_u, DenseMatrix&lt; double &gt; &amp;interpolated_dudxi, DenseMatrix&lt; double &gt; &amp;interpolated_d2udxi, DenseMatrix&lt; double &gt; &amp;M)</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l04844">Subparametric_Telements.h:4844</a></div></div>
<div class="ttc" id="aclassoomph_1_1C1CurvedElementShape_html"><div class="ttname"><a href="classoomph_1_1C1CurvedElementShape.html">oomph::C1CurvedElementShape</a></div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l01440">Subparametric_Telements.h:1440</a></div></div>
<div class="ttc" id="anamespaceoomph_1_1Global__string__for__annotation_html_ac5379de2fa7fe44f2cb31785fc208135"><div class="ttname"><a href="namespaceoomph_1_1Global__string__for__annotation.html#ac5379de2fa7fe44f2cb31785fc208135">oomph::Global_string_for_annotation::string</a></div><div class="ttdeci">std::string string(const unsigned &amp;i)</div><div class="ttdoc">Return the i-th string or &quot;&quot; if the relevant string hasn't been defined.</div><div class="ttdef"><b>Definition:</b> <a href="oomph__definitions_8cc_source.html#l00289">oomph_definitions.cc:289</a></div></div>
<div class="ttc" id="aclassoomph_1_1C1CurvedElementBase_html_a5d919ef0eef6ae6477642b3dcd1196df"><div class="ttname"><a href="classoomph_1_1C1CurvedElementBase.html#a5d919ef0eef6ae6477642b3dcd1196df">oomph::C1CurvedElementBase::d2basis_local_straight</a></div><div class="ttdeci">virtual void d2basis_local_straight(const Vector&lt; double &gt; &amp;s, Shape &amp;psi, DShape &amp;dpsids, DShape &amp;d2psids) const</div><div class="ttdef"><b>Definition:</b> <a href="Subparametric__Telements_8h_source.html#l03921">Subparametric_Telements.h:3921</a></div></div>

    <!-- jQuery for Bootstrap and Doxygen -->
    <script src="../../js/jquery-1.12.0.min.js"></script>
    <!-- Minified boostrap plugins-->
    <script src="../../js/bootstrap.js"></script>
    <!-- Doxygen dependency to add powertips to source code-->
    <script src="../../js/jquery.powertip.min.js"></script>
    <!-- The  following script is generated by doxygen and hides/shows levels in 
         the data structure lists and adds powertips to source code-->
    <script src="../../js/dynsections.js" ></script>
    <!-- add to Doxygen's class names so bootstrap css and js recognises them-->
    <script type="text/javascript">
    $(".contents").addClass("container");
    $(".header").addClass("container");
    $(".navpath").addClass("container");
    $("#navrow3").addClass("container");
    $("#navrow4").addClass("container");
    $(".mlabel").addClass("label");
    $(".mlabel").addClass("label-default");
    $(".memitem").addClass("panel");
    $(".memitem").addClass("panel-info");
    $(".memproto").addClass("panel-heading");
    $(".memdoc").addClass("panel-body");
    </script>
    <footer>
      <div class="container">
        <div class="text-muted" style="float:right;">Generated by <a href="http://www.doxygen.org/index.html">
          <img style="height:18px;" class="footer-img" src="doxygen.png" alt="doxygen"></a> on Fri Jul 23 2021 08:29:54
        </div>
      </div>
    </footer>
</body>
</html>

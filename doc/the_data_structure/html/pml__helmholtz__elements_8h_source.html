<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
<title>oomph-lib: pml_helmholtz_elements.h Source File</title>
<link rel="apple-touch-icon" sizes="57x57" href="../../figures/apple-touch-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="../../figures/apple-touch-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="../../figures/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="../../figures/apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="../../figures/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="../../figures/apple-touch-icon-120x120.png">
<link rel="icon" type="image/png" href="../../figures/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="../../figures/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="../../figures/favicon-16x16.png" sizes="16x16">
<link rel="manifest" href="../../figures/manifest.json">
<link rel="mask-icon" href="../../figures/safari-pinned-tab.svg" color="#008000">
<link rel="shortcut icon" href="../../figures/favicon.ico">
<meta name="msapplication-TileColor" content="#00a300">
<meta name="msapplication-config" content="../../figures/browserconfig.xml">
<meta name="theme-color" content="#008000">
<link href="http://fonts.googleapis.com/css?family=Open+Sans:400,300,600" rel="stylesheet" type="text/css">
<!-- Doxygen css-->
<!-- <link rel="stylesheet" type="text/css" href="doxygen.css"> -->
<!-- Bootstrap -->
<link href="../../css/bootstrap.css" rel="stylesheet">
<!-- oomph-lib specific overrides -->
<link rel="stylesheet" type="text/css" href="../../css/oomph_header.css">
</head>
<body>
<nav class="navbar navbar-default">
<div class="container">
<div class="container-fluid">
  <!-- Brand and toggle get grouped for better mobile display -->
  <div class="navbar-header">
    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
      <span class="sr-only">Toggle navigation</span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="../../html/index.html"><img alt="oomph-lib" src="../../figures/oomph_logo.png"></a>
  </div>
  <!-- Collect the nav links, forms, and other content for toggling -->
  <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
    <ul class="nav navbar-nav">          
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Documentation <span class="caret"></span></a>
        <ul class="dropdown-menu">
          <li class="dropdown-header">Big picture</li>
          <li><a href="../../../doc/intro/html/index.html">The finite element method</a></li>
          <li><a href="../../../doc/the_data_structure/html/index.html">The data structure</a></li>
          <li><a href="../../../doc/quick_guide/html/index.html">Not-so-quick guide</a></li>
          <li><a href="../../../doc/optimisation/html/index.html">Optimisation</a></li>
          <li><a href="../../../doc/order_of_action_functions/html/index.html">Order of action functions</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Example codes and tutorials</li>
          <li><a href="../../../doc/example_code_list/html/index.html">List of example codes and tutorials</a></li>
          <li><a href="../../../doc/example_code_list/html/index.html#meshes">Meshing</a></li>
          <li><a href="../../../doc/example_code_list/html/index.html#solvers">Solvers</a></li>
          <li><a href="../../../doc/example_code_list/html/index.html#parallel">MPI parallel processing</a></li>
          <li><a href="../../../doc/example_code_list/html/index.html#visualisation">Post-processing/visualisation</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Other</li>
          <li><a href="../../../doc/change_log/html/index.html">Change log</a></li>
          <li><a href="../../../doc/creating_doc/html/index.html">Creating documentation</a></li>
          <li><a href="../../../doc/coding_conventions/html/index.html">Coding conventions</a></li>
          <li><a href="../../../doc/index/html/index.html">Index</a></li>
          <li><a href="../../../doc/FAQ/html/index.html">FAQ</a></li>
        </ul>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Get it <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../doc/the_distribution/html/index.html">Installation guide</a></li>
            <li><a href="../../../doc/subversion/html/index.html">Get code from subversion repository</a></li>
            <li><a href="../../../doc/download/html/index.html">Get code as tar file</a></li>
            <li><a href="../../../doc/copyright/html/index.html">Copyright</a></li>
          </ul>
        </li>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">About <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../doc/people/html/index.html">People</a></li>            
            <li><a href="../../../doc/contact/html/index.html">Contact/Get involved</a></li>
            <li><a href="../../../doc/publications/html/index.html">Publications</a></li>
            <li><a href="../../../doc/acknowledgements/html/index.html">Acknowledgements</a></li>
            <li><a href="../../../doc/picture_show/index.html">Picture show</a></li>
          </ul>
        </li>
      </li>
    </ul>
    <ul class="nav navbar-nav navbar-right navbar-search">
      <form class="navbar-form" role="search" action="../../../doc/search_results/html/index.html">
        <div class="input-group">
          <input type="text" class="form-control" placeholder="Search" name="q">
          <span class="input-group-btn">
            <button class="btn btn-default" type="submit">Go</button>
          </span>
        </div><!-- /input-group -->
       <!--<div class="form-group">
          <input type="text" class="form-control" placeholder="Search">
        </div>
        <button type="submit" class="btn btn-default">Submit</button>-->
      </form>
    </ul>
  </div><!-- /.navbar-collapse -->
</div><!-- /.container-fluid -->
</div>
</nav>
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_f91b99f32b5db7fde0dd60e1bea0b41d.html">pml_helmholtz</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">pml_helmholtz_elements.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="pml__helmholtz__elements_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">//LIC// ====================================================================</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">//LIC// This file forms part of oomph-lib, the object-oriented, </span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">//LIC// multi-physics finite-element library, available </span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">//LIC// at http://www.oomph-lib.org.</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">//LIC// Copyright (C) 2006-2021 Matthias Heil and Andrew Hazel</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">//LIC// This library is free software; you can redistribute it and/or</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">//LIC// modify it under the terms of the GNU Lesser General Public</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">//LIC// License as published by the Free Software Foundation; either</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">//LIC// version 2.1 of the License, or (at your option) any later version.</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">//LIC// This library is distributed in the hope that it will be useful,</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">//LIC// but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">//LIC// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">//LIC// Lesser General Public License for more details.</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">//LIC// You should have received a copy of the GNU Lesser General Public</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">//LIC// License along with this library; if not, write to the Free Software</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">//LIC// Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">//LIC// 02110-1301  USA.</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">//LIC// The authors may be contacted at oomph-lib@maths.man.ac.uk.</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">//LIC//====================================================================</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">//Header file for Helmholtz elements</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#ifndef OOMPH_PML_HELMHOLTZ_ELEMENTS_HEADER</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#define OOMPH_PML_HELMHOLTZ_ELEMENTS_HEADER</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160; </div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160; </div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment">// Config header generated by autoconfig</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#ifdef HAVE_CONFIG_H</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#include &lt;oomph-lib-config.h&gt;</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160; </div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#include &quot;math.h&quot;</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="preprocessor">#include &lt;complex&gt;</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160; </div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment">//OOMPH-LIB headers</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="preprocessor">#include &quot;../generic/nodes.h&quot;</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="preprocessor">#include &quot;../generic/Qelements.h&quot;</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="preprocessor">#include &quot;../generic/oomph_utilities.h&quot;</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="preprocessor">#include &quot;../generic/pml_meshes.h&quot;</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="preprocessor">#include &quot;../generic/projection.h&quot;</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="preprocessor">#include &quot;../generic/pml_mapping_functions.h&quot;</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespaceoomph.html">oomph</a></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;{</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160; </div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment">//=============================================================</span><span class="comment"></span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment">/// A class for all isoparametric elements that solve the</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment">/// Helmholtz equations with pml capabilities.</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="comment">/// This contains the generic maths. Shape functions, geometric</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment">/// mapping etc. must get implemented in derived class.</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment"></span><span class="comment">//=============================================================</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160; <span class="keyword">template</span> &lt;<span class="keywordtype">unsigned</span> DIM&gt;</div>
<div class="line"><a name="l00061"></a><span class="lineno"><a class="line" href="classoomph_1_1PMLHelmholtzEquations.html">   61</a></span>&#160; <span class="keyword">class </span><a class="code" href="classoomph_1_1PMLHelmholtzEquations.html">PMLHelmholtzEquations</a> :</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;  <span class="keyword">public</span> <span class="keyword">virtual</span> <a class="code" href="classoomph_1_1PMLElementBase.html">PMLElementBase</a>&lt;DIM&gt;,</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  <span class="keyword">public</span> <span class="keyword">virtual</span> <a class="code" href="classoomph_1_1FiniteElement.html">FiniteElement</a></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160; {</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160; <span class="keyword">public</span>:</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment">  /// \short Function pointer to source function fct(x,f(x)) --</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment">  /// x is a Vector!</span></div>
<div class="line"><a name="l00069"></a><span class="lineno"><a class="line" href="classoomph_1_1PMLHelmholtzEquations.html#a9316a71cecd3c6c26ee6ab273800d3ec">   69</a></span>&#160;<span class="comment"></span>  <span class="keyword">typedef</span> void (*<a class="code" href="classoomph_1_1PMLHelmholtzEquations.html#a9316a71cecd3c6c26ee6ab273800d3ec">PMLHelmholtzSourceFctPt</a>)(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; x,</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;                                          std::complex&lt;double&gt;&amp; f);</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="comment">  /// Constructor</span></div>
<div class="line"><a name="l00073"></a><span class="lineno"><a class="line" href="classoomph_1_1PMLHelmholtzEquations.html#a90b8967699246bffa58aaf21de5a561e">   73</a></span>&#160;<span class="comment"></span>  <a class="code" href="classoomph_1_1PMLHelmholtzEquations.html#a90b8967699246bffa58aaf21de5a561e">PMLHelmholtzEquations</a>() : <a class="code" href="classoomph_1_1PMLHelmholtzEquations.html#a069e4a1971a30829c8eabc8527aa663f">Source_fct_pt</a>(0),</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;                            <a class="code" href="classoomph_1_1PMLHelmholtzEquations.html#aa4ea2eb142d7db69206d66415bc673ee">K_squared_pt</a>(0)</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;   {</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    <span class="comment">// Provide pointer to static method (Save memory)</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    <a class="code" href="classoomph_1_1PMLHelmholtzEquations.html#a1f2e029596dae700c376fe6a9b2d4223">Pml_mapping_pt</a> = &amp;<a class="code" href="classoomph_1_1PMLHelmholtzEquations.html#a8d5428a705d254ffb7e448cac84538ba">PMLHelmholtzEquations::Default_pml_mapping</a>;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <a class="code" href="classoomph_1_1PMLHelmholtzEquations.html#a9cf611c517509c8b2bc5c76d89d3da91">Alpha_pt</a> = &amp;<a class="code" href="classoomph_1_1PMLHelmholtzEquations.html#ade525679c4e2d4ad0ba128008cf8e4f0">Default_Physical_Constant_Value</a>;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;   }</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160; </div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment">  /// Broken copy constructor</span></div>
<div class="line"><a name="l00083"></a><span class="lineno"><a class="line" href="classoomph_1_1PMLHelmholtzEquations.html#a8a428d379ececc74c03bf2a5e12538a5">   83</a></span>&#160;<span class="comment"></span>  <a class="code" href="classoomph_1_1PMLHelmholtzEquations.html#a8a428d379ececc74c03bf2a5e12538a5">PMLHelmholtzEquations</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1PMLHelmholtzEquations.html">PMLHelmholtzEquations</a>&amp; dummy)</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;   {</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    <a class="code" href="namespaceoomph_1_1BrokenCopy.html#a7e5cd7fda8b8c790003151bee77a84ac">BrokenCopy::broken_copy</a>(<span class="stringliteral">&quot;PMLHelmholtzEquations&quot;</span>);</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;   }</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="comment">  /// Broken assignment operator</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="comment"></span><span class="comment">//Commented out broken assignment operator because this can lead to a conflict warning</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="comment">//when used in the virtual inheritence hierarchy. Essentially the compiler doesn&#39;t</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="comment">//realise that two separate implementations of the broken function are the same and so,</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="comment">//quite rightly, it shouts.</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  <span class="comment">/*void operator=(const PMLHelmholtzEquations&amp;)</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="comment">    {</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="comment">    BrokenCopy::broken_assign(&quot;PMLHelmholtzEquations&quot;);</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment">    }*/</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="comment">  /// \short Return the index at which the unknown value</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="comment">  /// is stored.</span></div>
<div class="line"><a name="l00100"></a><span class="lineno"><a class="line" href="classoomph_1_1PMLHelmholtzEquations.html#a2a36f64af504f8836aff147c455f31ac">  100</a></span>&#160;<span class="comment"></span>  <span class="keyword">virtual</span> <span class="keyword">inline</span> std::complex&lt;unsigned&gt; <a class="code" href="classoomph_1_1PMLHelmholtzEquations.html#a2a36f64af504f8836aff147c455f31ac">u_index_helmholtz</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="keyword">   </span>{<span class="keywordflow">return</span> std::complex&lt;unsigned&gt;(0,1);}</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="comment">  /// Get pointer to k_squared</span></div>
<div class="line"><a name="l00104"></a><span class="lineno"><a class="line" href="classoomph_1_1PMLHelmholtzEquations.html#aa9470aba0c301c8d98281cd3a7bf046e">  104</a></span>&#160;<span class="comment"></span>  <span class="keywordtype">double</span>*&amp; <a class="code" href="classoomph_1_1PMLHelmholtzEquations.html#aa9470aba0c301c8d98281cd3a7bf046e">k_squared_pt</a>(){ <span class="keywordflow">return</span> <a class="code" href="classoomph_1_1PMLHelmholtzEquations.html#aa4ea2eb142d7db69206d66415bc673ee">K_squared_pt</a>; }</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160; </div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="comment">  /// Get the square of wavenumber</span></div>
<div class="line"><a name="l00108"></a><span class="lineno"><a class="line" href="classoomph_1_1PMLHelmholtzEquations.html#a401e24e48170bd25d6b035a577f3cc62">  108</a></span>&#160;<span class="comment"></span>  <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1PMLHelmholtzEquations.html#a401e24e48170bd25d6b035a577f3cc62">k_squared</a>()</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;   {</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classoomph_1_1PMLHelmholtzEquations.html#aa4ea2eb142d7db69206d66415bc673ee">K_squared_pt</a>==0)</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    {</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;     <span class="keywordflow">throw</span> <a class="code" href="classoomph_1_1OomphLibError.html">OomphLibError</a>(</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;      <span class="stringliteral">&quot;Please set pointer to k_squared using access fct to pointer!&quot;</span>,</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;      OOMPH_CURRENT_FUNCTION,</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;      OOMPH_EXCEPTION_LOCATION);</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    }</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    <span class="keywordflow">return</span> *<a class="code" href="classoomph_1_1PMLHelmholtzEquations.html#aa4ea2eb142d7db69206d66415bc673ee">K_squared_pt</a>;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;   }</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="comment">  /// Alpha, wavenumber complex shift</span></div>
<div class="line"><a name="l00123"></a><span class="lineno"><a class="line" href="classoomph_1_1PMLHelmholtzEquations.html#ab1a6fa3fb13973c597e8faeb1ff4b2e1">  123</a></span>&#160;<span class="comment"></span>  <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; <a class="code" href="classoomph_1_1PMLHelmholtzEquations.html#ab1a6fa3fb13973c597e8faeb1ff4b2e1">alpha</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> *<a class="code" href="classoomph_1_1PMLHelmholtzEquations.html#a9cf611c517509c8b2bc5c76d89d3da91">Alpha_pt</a>;}</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="comment">/// Pointer to Alpha, wavenumber complex shift</span></div>
<div class="line"><a name="l00126"></a><span class="lineno"><a class="line" href="classoomph_1_1PMLHelmholtzEquations.html#a69c8bd10c24571e4058d081ae43dc449">  126</a></span>&#160;<span class="comment"></span>  <span class="keywordtype">double</span>* &amp;<a class="code" href="classoomph_1_1PMLHelmholtzEquations.html#a69c8bd10c24571e4058d081ae43dc449">alpha_pt</a>() {<span class="keywordflow">return</span> <a class="code" href="classoomph_1_1PMLHelmholtzEquations.html#a9cf611c517509c8b2bc5c76d89d3da91">Alpha_pt</a>;}</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160; </div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="comment">  /// \short Number of scalars/fields output by this element. Reimplements</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="comment">  /// broken virtual function in base class.</span></div>
<div class="line"><a name="l00131"></a><span class="lineno"><a class="line" href="classoomph_1_1PMLHelmholtzEquations.html#ad01f5a39cc376ab238d2443e39732bcb">  131</a></span>&#160;<span class="comment"></span>  <span class="keywordtype">unsigned</span> <a class="code" href="classoomph_1_1PMLHelmholtzEquations.html#ad01f5a39cc376ab238d2443e39732bcb">nscalar_paraview</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="keyword">   </span>{</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <span class="keywordflow">return</span> 2;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;   }</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="comment">  /// \short Write values of the i-th scalar field at the plot points. Needs</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="comment">  /// to be implemented for each new specific element type.</span></div>
<div class="line"><a name="l00138"></a><span class="lineno"><a class="line" href="classoomph_1_1PMLHelmholtzEquations.html#ae660ab230566958c73f12eecd494364f">  138</a></span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1PMLHelmholtzEquations.html#ae660ab230566958c73f12eecd494364f">scalar_value_paraview</a>(std::ofstream&amp; file_out,</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;                             <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>,</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;                             <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; nplot)<span class="keyword"> const</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="keyword">   </span>{</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160; </div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <span class="comment">//Vector of local coordinates</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>(DIM);</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160; </div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <span class="comment">// Loop over plot points</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <span class="keywordtype">unsigned</span> num_plot_points=<a class="code" href="classoomph_1_1FiniteElement.html#a06d32c85753a1e302c3b345ea27f6c85">nplot_points_paraview</a>(nplot);</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> iplot=0;iplot&lt;num_plot_points;iplot++)</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    {</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;     <span class="comment">// Get local coordinates of plot point</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;     <a class="code" href="classoomph_1_1FiniteElement.html#a82da844fd3ebb2005842464cdc148a03">get_s_plot</a>(iplot,nplot,<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>);</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;     std::complex&lt;double&gt; <a class="code" href="the__data__structure_8txt.html#aaa5287b1cf3ca06b3f413cb95bd1ec60">u</a>(<a class="code" href="classoomph_1_1PMLHelmholtzEquations.html#abe36a7e5ce224ac04cfb745b278da301">interpolated_u_pml_helmholtz</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>));</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160; </div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;     <span class="comment">// Paraview need to ouput the fields separately so it loops through all</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;     <span class="comment">// the elements twice</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;     <span class="keywordflow">switch</span>(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>)</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;     {</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;      <span class="comment">// Real part first</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;     <span class="keywordflow">case</span> 0:</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;      file_out &lt;&lt; <a class="code" href="the__data__structure_8txt.html#aaa5287b1cf3ca06b3f413cb95bd1ec60">u</a>.real() &lt;&lt; std::endl;</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160; </div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;      <span class="comment">// Imaginary part second</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;     <span class="keywordflow">case</span> 1:</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;      file_out &lt;&lt; <a class="code" href="the__data__structure_8txt.html#aaa5287b1cf3ca06b3f413cb95bd1ec60">u</a>.imag() &lt;&lt; std::endl;</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160; </div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;      <span class="comment">// Never get here</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;     <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;      std::stringstream error_stream;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;      error_stream</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;       &lt;&lt; <span class="stringliteral">&quot;PML Helmholtz elements only store 2 fields (real and imaginary) &quot;</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;       &lt;&lt; <span class="stringliteral">&quot;so i must be 0 or 1 rather &quot;</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;       &lt;&lt; <span class="stringliteral">&quot;than &quot;</span> &lt;&lt; <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;      <span class="keywordflow">throw</span> <a class="code" href="classoomph_1_1OomphLibError.html">OomphLibError</a>(</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;       error_stream.str(),</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;       OOMPH_CURRENT_FUNCTION,</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;       OOMPH_EXCEPTION_LOCATION);</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160; </div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;     }</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    }</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;   }</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<span class="comment">  /// \short Write values of the i-th scalar field at the plot points. Needs</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<span class="comment">  /// to be implemented for each new specific element type.</span></div>
<div class="line"><a name="l00189"></a><span class="lineno"><a class="line" href="classoomph_1_1PMLHelmholtzEquations.html#a644da4b6bf85b4df7bfcf69beacca3f7">  189</a></span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1PMLHelmholtzEquations.html#a644da4b6bf85b4df7bfcf69beacca3f7">scalar_value_fct_paraview</a>(std::ofstream&amp; file_out,</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;                                 <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>,</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;                                 <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; nplot,</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;                                 <a class="code" href="classoomph_1_1FiniteElement.html#a690fd33af26cc3e84f39bba6d5a85202">FiniteElement::SteadyExactSolutionFctPt</a></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;                                 exact_soln_pt)<span class="keyword"> const</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="keyword">   </span>{</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <span class="comment">//Vector of local coordinates</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>(DIM);</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160; </div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    <span class="comment">// Vector for coordinates</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> x(DIM);</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160; </div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    <span class="comment">// Exact solution Vector</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> exact_soln(2);</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160; </div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    <span class="comment">// Loop over plot points</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <span class="keywordtype">unsigned</span> num_plot_points=<a class="code" href="classoomph_1_1FiniteElement.html#a06d32c85753a1e302c3b345ea27f6c85">nplot_points_paraview</a>(nplot);</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> iplot=0;iplot&lt;num_plot_points;iplot++)</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    {</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;     <span class="comment">// Get local coordinates of plot point</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;     <a class="code" href="classoomph_1_1FiniteElement.html#a82da844fd3ebb2005842464cdc148a03">get_s_plot</a>(iplot,nplot,<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>);</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;     </div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;     <span class="comment">// Get x position as Vector</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;     <a class="code" href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">interpolated_x</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,x);</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;   </div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;     <span class="comment">// Get exact solution at this point</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;     (*exact_soln_pt)(x,exact_soln);</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160; </div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;     <span class="comment">// Paraview need to output the fields separately so it loops through all</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;     <span class="comment">// the elements twice</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;     <span class="keywordflow">switch</span>(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>)</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;     {</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;      <span class="comment">// Real part first</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;     <span class="keywordflow">case</span> 0:</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;      file_out &lt;&lt; exact_soln[0] &lt;&lt; std::endl;</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160; </div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;      <span class="comment">// Imaginary part second</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;     <span class="keywordflow">case</span> 1:</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;      file_out &lt;&lt; exact_soln[1] &lt;&lt; std::endl;</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160; </div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;      <span class="comment">// Never get here</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;     <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;      std::stringstream error_stream;</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;      error_stream</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;       &lt;&lt; <span class="stringliteral">&quot;PML Helmholtz elements only store 2 fields (real and imaginary) &quot;</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;       &lt;&lt; <span class="stringliteral">&quot;so i must be 0 or 1 rather &quot;</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;       &lt;&lt; <span class="stringliteral">&quot;than &quot;</span> &lt;&lt; <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;      <span class="keywordflow">throw</span> <a class="code" href="classoomph_1_1OomphLibError.html">OomphLibError</a>(</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;       error_stream.str(),</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;       OOMPH_CURRENT_FUNCTION,</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;       OOMPH_EXCEPTION_LOCATION);</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160; </div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;     }</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    }</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;   }</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;  <span class="comment"></span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;<span class="comment">  /// \short Name of the i-th scalar field. Default implementation</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;<span class="comment">  /// returns V1 for the first one, V2 for the second etc. Can (should!)</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;<span class="comment">  /// be overloaded with more meaningful names in specific elements.</span></div>
<div class="line"><a name="l00253"></a><span class="lineno"><a class="line" href="classoomph_1_1PMLHelmholtzEquations.html#a3ad0d6e6a8750200e9802b1f32aec11b">  253</a></span>&#160;<span class="comment"></span>  <a class="code" href="namespaceoomph_1_1Global__string__for__annotation.html#ac5379de2fa7fe44f2cb31785fc208135">std::string</a> <a class="code" href="classoomph_1_1PMLHelmholtzEquations.html#a3ad0d6e6a8750200e9802b1f32aec11b">scalar_name_paraview</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>)<span class="keyword"> const</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;<span class="keyword">   </span>{</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    <span class="keywordflow">switch</span>(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>)</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    {</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    <span class="keywordflow">case</span> 0:</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;     <span class="keywordflow">return</span> <span class="stringliteral">&quot;Real part&quot;</span>;</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;     <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160; </div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    <span class="keywordflow">case</span> 1:</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;     <span class="keywordflow">return</span> <span class="stringliteral">&quot;Imaginary part&quot;</span>;</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;     <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160; </div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;     <span class="comment">// Never get here</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;     std::stringstream error_stream;</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;     error_stream</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;PML Helmholtz elements only store 2 fields (real and imaginary) &quot;</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;so i must be 0 or 1 rather &quot;</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;than &quot;</span> &lt;&lt; <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;     <span class="keywordflow">throw</span> <a class="code" href="classoomph_1_1OomphLibError.html">OomphLibError</a>(</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;      error_stream.str(),</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;      OOMPH_CURRENT_FUNCTION,</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;      OOMPH_EXCEPTION_LOCATION);</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160; </div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;     <span class="comment">// Dummy return for the default statement</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;     <span class="keywordflow">return</span> <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;     <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    }</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;   }</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;<span class="comment">  /// Output with default number of plot points</span></div>
<div class="line"><a name="l00286"></a><span class="lineno"><a class="line" href="classoomph_1_1PMLHelmholtzEquations.html#a1b6f4cae7b6ee3a1cce7253912b1acb0">  286</a></span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1PMLHelmholtzEquations.html#a1b6f4cae7b6ee3a1cce7253912b1acb0">output</a>(std::ostream &amp;outfile)</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;   {</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_plot=5;</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    <a class="code" href="classoomph_1_1PMLHelmholtzEquations.html#a1b6f4cae7b6ee3a1cce7253912b1acb0">output</a>(outfile,n_plot);</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;   }</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<span class="comment">  /// \short Output FE representation of soln: x,y,u_re,u_im or</span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<span class="comment">  /// x,y,z,u_re,u_im at  n_plot^DIM plot points</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1PMLHelmholtzEquations.html#a1b6f4cae7b6ee3a1cce7253912b1acb0">output</a>(std::ostream &amp;outfile, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;n_plot);</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160; </div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="comment">/// Output function for real part of full time-dependent solution</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;<span class="comment">/// constructed by adding the scattered field</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="comment">///  u = Re( (u_r +i u_i) exp(-i omega t)</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;<span class="comment">/// at phase angle omega t = phi computed here, to the corresponding</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="comment">/// incoming wave specified via the function pointer.</span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span>  <a class="code" href="classoomph_1_1PMLHelmholtzEquations.html#af69f13a00113d097075285db5f12feeb">output_total_real</a>(</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;   std::ostream &amp;outfile,</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;   <a class="code" href="classoomph_1_1FiniteElement.html#a690fd33af26cc3e84f39bba6d5a85202">FiniteElement::SteadyExactSolutionFctPt</a> incoming_wave_fct_pt,</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; phi,</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;nplot);</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160; </div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;<span class="comment">  /// \short Output function for real part of full time-dependent solution</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;<span class="comment">  /// u = Re( (u_r +i u_i) exp(-i omega t))</span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;<span class="comment">  /// at phase angle omega t = phi.</span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<span class="comment">  /// x,y,u   or    x,y,z,u at n_plot plot points in each coordinate</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="comment">  /// direction</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1PMLHelmholtzEquations.html#a88ca4602a7152f1723ba85be0fc8eaf6">output_real</a>(std::ostream &amp;outfile, <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; phi,</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;                   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;n_plot);</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="comment">  /// \short Output function for imaginary part of full time-dependent solution</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;<span class="comment">  /// u = Im( (u_r +i u_i) exp(-i omega t) )</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;<span class="comment">  /// at phase angle omega t = phi.</span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;<span class="comment">  /// x,y,u   or    x,y,z,u at n_plot plot points in each coordinate</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;<span class="comment">  /// direction</span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1PMLHelmholtzEquations.html#ade29ee33fc008a0ff318f34f43014724">output_imag</a>(std::ostream &amp;outfile, <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; phi,</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;                   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;n_plot);</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;<span class="comment">  /// C_style output with default number of plot points</span></div>
<div class="line"><a name="l00326"></a><span class="lineno"><a class="line" href="classoomph_1_1PMLHelmholtzEquations.html#a8ac463e252c5d20255e810e52f32c6ef">  326</a></span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1PMLHelmholtzEquations.html#a8ac463e252c5d20255e810e52f32c6ef">output</a>(FILE* file_pt)</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;   {</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_plot=5;</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    <a class="code" href="classoomph_1_1PMLHelmholtzEquations.html#a1b6f4cae7b6ee3a1cce7253912b1acb0">output</a>(file_pt,n_plot);</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;   }</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;<span class="comment">  /// \short C-style output FE representation of soln: x,y,u_re,u_im or</span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;<span class="comment">  /// x,y,z,u_re,u_im at  n_plot^DIM plot points</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1PMLHelmholtzEquations.html#a1b6f4cae7b6ee3a1cce7253912b1acb0">output</a>(FILE* file_pt, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;n_plot);</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;<span class="comment">  /// Output exact soln: x,y,u_re_exact,u_im_exact</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;<span class="comment">  /// or x,y,z,u_re_exact,u_im_exact at n_plot^DIM plot points</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1PMLHelmholtzEquations.html#ae56afa0bfd1de461e033a7ecc5a4f895">output_fct</a>(std::ostream &amp;outfile, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;n_plot,</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;                  <a class="code" href="classoomph_1_1FiniteElement.html#a690fd33af26cc3e84f39bba6d5a85202">FiniteElement::SteadyExactSolutionFctPt</a> exact_soln_pt);</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;<span class="comment">  /// \short Output exact soln: (dummy time-dependent version to</span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;<span class="comment">  /// keep intel compiler happy)</span></div>
<div class="line"><a name="l00343"></a><span class="lineno"><a class="line" href="classoomph_1_1PMLHelmholtzEquations.html#a2aabee86a58b5d985a34c9d5c6988306">  343</a></span>&#160;<span class="comment"></span>  <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1PMLHelmholtzEquations.html#a2aabee86a58b5d985a34c9d5c6988306">output_fct</a>(std::ostream &amp;outfile, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;n_plot,</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;                          <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; time,</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;                          <a class="code" href="classoomph_1_1FiniteElement.html#ad4ecf2b61b158a4b4d351a60d23c633e">FiniteElement::UnsteadyExactSolutionFctPt</a></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;                          exact_soln_pt)</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;   {</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="classoomph_1_1OomphLibError.html">OomphLibError</a>(</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;     <span class="stringliteral">&quot;There is no time-dependent output_fct() for PMLHelmholtz elements.&quot;</span>,</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;     OOMPH_CURRENT_FUNCTION,</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;     OOMPH_EXCEPTION_LOCATION);</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;   }</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160; </div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160; </div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;<span class="comment">  /// \short Output function for real part of full time-dependent fct</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;<span class="comment">  /// u = Re( (u_r +i u_i) exp(-i omega t)</span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;<span class="comment">  /// at phase angle omega t = phi.</span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;<span class="comment">  /// x,y,u   or    x,y,z,u at n_plot plot points in each coordinate</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;<span class="comment">  /// direction</span></div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1PMLHelmholtzEquations.html#af590f98d401b50f72b67ef7f0813fe7f">output_real_fct</a>(std::ostream &amp;outfile,</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;                       <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; phi,</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;                       <span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;n_plot,</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;                       <a class="code" href="classoomph_1_1FiniteElement.html#a690fd33af26cc3e84f39bba6d5a85202">FiniteElement::SteadyExactSolutionFctPt</a> exact_soln_pt);</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;<span class="comment">  /// \short Output function for imaginary part of full time-dependent fct</span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;<span class="comment">  /// u = Im( (u_r +i u_i) exp(-i omega t))</span></div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;<span class="comment">  /// at phase angle omega t = phi.</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;<span class="comment">  /// x,y,u   or    x,y,z,u at n_plot plot points in each coordinate</span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;<span class="comment">  /// direction</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1PMLHelmholtzEquations.html#a8290cabe737e4260a58ff7feb087023c">output_imag_fct</a>(std::ostream &amp;outfile,</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;                       <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; phi,</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;                       <span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;n_plot,</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;                       <a class="code" href="classoomph_1_1FiniteElement.html#a690fd33af26cc3e84f39bba6d5a85202">FiniteElement::SteadyExactSolutionFctPt</a> exact_soln_pt);</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160; </div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;<span class="comment">  /// Get error against and norm of exact solution</span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1PMLHelmholtzEquations.html#ab2fa1d02ac3fa90ba66b76f868e0d3b4">compute_error</a>(std::ostream &amp;outfile,</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;                     <a class="code" href="classoomph_1_1FiniteElement.html#a690fd33af26cc3e84f39bba6d5a85202">FiniteElement::SteadyExactSolutionFctPt</a> exact_soln_pt,</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;                     <span class="keywordtype">double</span>&amp; error, <span class="keywordtype">double</span>&amp; norm);</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160; </div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;<span class="comment">  /// Dummy, time dependent error checker</span></div>
<div class="line"><a name="l00384"></a><span class="lineno"><a class="line" href="classoomph_1_1PMLHelmholtzEquations.html#a1312be0dbd1bc6a2499c4928c8ea152b">  384</a></span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1PMLHelmholtzEquations.html#a1312be0dbd1bc6a2499c4928c8ea152b">compute_error</a>(std::ostream &amp;outfile,</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;                     <a class="code" href="classoomph_1_1FiniteElement.html#ad4ecf2b61b158a4b4d351a60d23c633e">FiniteElement::UnsteadyExactSolutionFctPt</a> exact_soln_pt,</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;                     <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; time, <span class="keywordtype">double</span>&amp; error, <span class="keywordtype">double</span>&amp; norm)</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;   {</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="classoomph_1_1OomphLibError.html">OomphLibError</a>(</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;     <span class="stringliteral">&quot;There is no time-dependent compute_error() for PMLHelmholtz elements.&quot;</span>,</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;     OOMPH_CURRENT_FUNCTION,</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;     OOMPH_EXCEPTION_LOCATION);</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;   }</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160; </div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;<span class="comment">  /// Compute norm of fe solution</span></div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1PMLHelmholtzEquations.html#a6c26381bc4aab3ff5a4e059989778128">compute_norm</a>(<span class="keywordtype">double</span>&amp; norm);</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;<span class="comment">  /// Access function: Pointer to source function</span></div>
<div class="line"><a name="l00399"></a><span class="lineno"><a class="line" href="classoomph_1_1PMLHelmholtzEquations.html#a27edadffabd4df1cdfd0560e0c526882">  399</a></span>&#160;<span class="comment"></span>  <a class="code" href="classoomph_1_1PMLHelmholtzEquations.html#a9316a71cecd3c6c26ee6ab273800d3ec">PMLHelmholtzSourceFctPt</a>&amp; <a class="code" href="classoomph_1_1PMLHelmholtzEquations.html#a27edadffabd4df1cdfd0560e0c526882">source_fct_pt</a>() {<span class="keywordflow">return</span> <a class="code" href="classoomph_1_1PMLHelmholtzEquations.html#a069e4a1971a30829c8eabc8527aa663f">Source_fct_pt</a>;}</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;<span class="comment">  /// Access function: Pointer to source function. Const version</span></div>
<div class="line"><a name="l00402"></a><span class="lineno"><a class="line" href="classoomph_1_1PMLHelmholtzEquations.html#a482d11f6ad579f71a796ffc077b0ee81">  402</a></span>&#160;<span class="comment"></span>  <a class="code" href="classoomph_1_1PMLHelmholtzEquations.html#a9316a71cecd3c6c26ee6ab273800d3ec">PMLHelmholtzSourceFctPt</a> <a class="code" href="classoomph_1_1PMLHelmholtzEquations.html#a482d11f6ad579f71a796ffc077b0ee81">source_fct_pt</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> <a class="code" href="classoomph_1_1PMLHelmholtzEquations.html#a069e4a1971a30829c8eabc8527aa663f">Source_fct_pt</a>;}</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160; </div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;<span class="comment">  /// Get source term at (Eulerian) position x. This function is</span></div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;<span class="comment">  /// virtual to allow overloading in multi-physics problems where</span></div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;<span class="comment">  /// the strength of the source function might be determined by</span></div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;<span class="comment">  /// another system of equations.</span></div>
<div class="line"><a name="l00409"></a><span class="lineno"><a class="line" href="classoomph_1_1PMLHelmholtzEquations.html#a1f4dad243537bdf8d02340dfdb7612bb">  409</a></span>&#160;<span class="comment"></span>  <span class="keyword">inline</span> <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1PMLHelmholtzEquations.html#a1f4dad243537bdf8d02340dfdb7612bb">get_source_helmholtz</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; ipt,</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;                                           <span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; x,</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;                                           std::complex&lt;double&gt;&amp; source)<span class="keyword"> const</span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;<span class="keyword">   </span>{</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    <span class="comment">//If no source function has been set, return zero</span></div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="classoomph_1_1PMLHelmholtzEquations.html#a069e4a1971a30829c8eabc8527aa663f">Source_fct_pt</a>==0)</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    {</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;     source = std::complex&lt;double&gt;(0.0,0.0);</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    }</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    {</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;     <span class="comment">// Get source strength</span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;     (*Source_fct_pt)(x,source);</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    }</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;   }</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;<span class="comment">  /// \short Pure virtual function in which we specify the</span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;<span class="comment">  /// values to be pinned (and set to zero) on the outer edge of</span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;<span class="comment">  /// the pml layer. All of them! Vector is resized internally.</span></div>
<div class="line"><a name="l00428"></a><span class="lineno"><a class="line" href="classoomph_1_1PMLHelmholtzEquations.html#a08c72ef039f4dd155df7bc660554c666">  428</a></span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1PMLHelmholtzEquations.html#a08c72ef039f4dd155df7bc660554c666">values_to_be_pinned_on_outer_pml_boundary</a>(<a class="code" href="classoomph_1_1Vector.html">Vector&lt;unsigned&gt;</a>&amp;</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;                                                 values_to_pin)</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;   {</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    values_to_pin.resize(2);</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160; </div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    values_to_pin[0]=0;</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    values_to_pin[1]=1;</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;   }</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160; </div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;<span class="comment">  /// Get flux: flux[i] = du/dx_i for real and imag part</span></div>
<div class="line"><a name="l00439"></a><span class="lineno"><a class="line" href="classoomph_1_1PMLHelmholtzEquations.html#ae7fc8ea11298122c8c30be76b8398ad5">  439</a></span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1PMLHelmholtzEquations.html#ae7fc8ea11298122c8c30be76b8398ad5">get_flux</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;                <a class="code" href="classoomph_1_1Vector.html">Vector</a>&lt;std::complex &lt;double&gt; &gt;&amp; flux)<span class="keyword"> const</span></div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;<span class="keyword">   </span>{</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;    <span class="comment">//Find out how many nodes there are in the element</span></div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_node = <a class="code" href="classoomph_1_1FiniteElement.html#a6219ed269a6d89b5aa14659cce48905a">nnode</a>();</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160; </div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160; </div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    <span class="comment">//Set up memory for the shape and test functions</span></div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    <a class="code" href="classoomph_1_1Shape.html">Shape</a> psi(n_node);</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    <a class="code" href="classoomph_1_1DShape.html">DShape</a> dpsidx(n_node,DIM);</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160; </div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    <span class="comment">//Call the derivatives of the shape and test functions</span></div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    <a class="code" href="classoomph_1_1FiniteElement.html#a9296c17b134688049256a4bbc886df69">dshape_eulerian</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,psi,dpsidx);</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160; </div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    <span class="comment">//Initialise to zero</span></div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    <span class="keyword">const</span> std::complex&lt;double&gt; zero(0.0,0.0);</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> j=0;j&lt;DIM;j++)</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    {</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;     flux[j] = zero;</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    }</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160; </div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    <span class="comment">// Loop over nodes</span></div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l=0;l&lt;n_node;l++)</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    {</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;     <span class="comment">//Cache the complex value of the unknown</span></div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;     <span class="keyword">const</span> std::complex&lt;double&gt; u_value(</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;      this-&gt;<a class="code" href="classoomph_1_1FiniteElement.html#a28fd5c2d4aeba5ef65bee0e0d72569f5">nodal_value</a>(l,<a class="code" href="classoomph_1_1PMLHelmholtzEquations.html#a2a36f64af504f8836aff147c455f31ac">u_index_helmholtz</a>().real()),</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;      this-&gt;<a class="code" href="classoomph_1_1FiniteElement.html#a28fd5c2d4aeba5ef65bee0e0d72569f5">nodal_value</a>(l,<a class="code" href="classoomph_1_1PMLHelmholtzEquations.html#a2a36f64af504f8836aff147c455f31ac">u_index_helmholtz</a>().imag()));</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;     <span class="comment">//Loop over derivative directions</span></div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> j=0;j&lt;DIM;j++)</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;     {</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;      flux[j] += u_value*dpsidx(l,j);</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;     }</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    }</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;   }</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160; </div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;<span class="comment">  /// Add the element&#39;s contribution to its residual vector (wrapper)</span></div>
<div class="line"><a name="l00477"></a><span class="lineno"><a class="line" href="classoomph_1_1PMLHelmholtzEquations.html#a8ee852e8cde8c0f6a399bfc53bb7ad92">  477</a></span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1PMLHelmholtzEquations.html#a8ee852e8cde8c0f6a399bfc53bb7ad92">fill_in_contribution_to_residuals</a>(<a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;<a class="code" href="the__data__structure_8txt.html#a1400a973def57b85051cfe1070be1810">residuals</a>)</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;   {</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    <span class="comment">//Call the generic residuals function with flag set to 0</span></div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    <span class="comment">//using a dummy matrix argument</span></div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    <a class="code" href="classoomph_1_1PMLHelmholtzEquations.html#a11b6be67faf29eaf1f20405e43c4afe9">fill_in_generic_residual_contribution_helmholtz</a>(</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;     <a class="code" href="the__data__structure_8txt.html#a1400a973def57b85051cfe1070be1810">residuals</a>,<a class="code" href="classoomph_1_1GeneralisedElement.html#a4bff11b8ff97aefabb2df41e61e1779f">GeneralisedElement::Dummy_matrix</a>,0);</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;   }</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160; </div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;<span class="comment">  /// \short Add the element&#39;s contribution to its residual vector and</span></div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;<span class="comment">  /// element Jacobian matrix (wrapper)</span></div>
<div class="line"><a name="l00488"></a><span class="lineno"><a class="line" href="classoomph_1_1PMLHelmholtzEquations.html#a0036936eb0f4f683d91aa6dbd76c9900">  488</a></span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1PMLHelmholtzEquations.html#a0036936eb0f4f683d91aa6dbd76c9900">fill_in_contribution_to_jacobian</a>(<a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;<a class="code" href="the__data__structure_8txt.html#a1400a973def57b85051cfe1070be1810">residuals</a>,</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;                                        <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> &amp;jacobian)</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;   {</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;    <span class="comment">//Call the generic routine with the flag set to 1</span></div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    <a class="code" href="classoomph_1_1PMLHelmholtzEquations.html#a11b6be67faf29eaf1f20405e43c4afe9">fill_in_generic_residual_contribution_helmholtz</a>(<a class="code" href="the__data__structure_8txt.html#a1400a973def57b85051cfe1070be1810">residuals</a>,jacobian,1);</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;   }</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160; </div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160; </div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;<span class="comment">  /// \short Return FE representation of function value u_helmholtz(s)</span></div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;<span class="comment">  /// at local coordinate s</span></div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;<span class="comment"></span>  <span class="keyword">inline</span> std::complex&lt;double&gt;</div>
<div class="line"><a name="l00500"></a><span class="lineno"><a class="line" href="classoomph_1_1PMLHelmholtzEquations.html#abe36a7e5ce224ac04cfb745b278da301">  500</a></span>&#160;  <a class="code" href="classoomph_1_1PMLHelmholtzEquations.html#abe36a7e5ce224ac04cfb745b278da301">interpolated_u_pml_helmholtz</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>)<span class="keyword"> const</span></div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;<span class="keyword">   </span>{</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    <span class="comment">//Find number of nodes</span></div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_node = <a class="code" href="classoomph_1_1FiniteElement.html#a6219ed269a6d89b5aa14659cce48905a">nnode</a>();</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160; </div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;    <span class="comment">//Local shape function</span></div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    <a class="code" href="classoomph_1_1Shape.html">Shape</a> psi(n_node);</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160; </div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    <span class="comment">//Find values of shape function</span></div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;    <a class="code" href="classoomph_1_1FiniteElement.html#a58a25b6859ddd43b7bfe64a19fee5023">shape</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,psi);</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160; </div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;    <span class="comment">//Initialise value of u</span></div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;    std::complex&lt;double&gt; <a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>(0.0,0.0);</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160; </div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;    <span class="comment">//Get the index at which the helmholtz unknown is stored</span></div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> u_nodal_index_real = <a class="code" href="classoomph_1_1PMLHelmholtzEquations.html#a2a36f64af504f8836aff147c455f31ac">u_index_helmholtz</a>().real();</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> u_nodal_index_imag = <a class="code" href="classoomph_1_1PMLHelmholtzEquations.html#a2a36f64af504f8836aff147c455f31ac">u_index_helmholtz</a>().imag();</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160; </div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;    <span class="comment">//Loop over the local nodes and sum</span></div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l=0;l&lt;n_node;l++)</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    {</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;     <span class="comment">//Make a temporary complex number from the stored data</span></div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;     <span class="keyword">const</span> std::complex&lt;double&gt; u_value(</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;      this-&gt;<a class="code" href="classoomph_1_1FiniteElement.html#a28fd5c2d4aeba5ef65bee0e0d72569f5">nodal_value</a>(l,u_nodal_index_real),</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;      this-&gt;<a class="code" href="classoomph_1_1FiniteElement.html#a28fd5c2d4aeba5ef65bee0e0d72569f5">nodal_value</a>(l,u_nodal_index_imag));</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;     <span class="comment">//Add to the interpolated value</span></div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;     <a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a> += u_value*psi[l];</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;    }</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>;</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;   }</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160; </div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;<span class="comment">  /// \short Self-test: Return 0 for OK</span></div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;<span class="comment"></span>  <span class="keywordtype">unsigned</span> <a class="code" href="classoomph_1_1PMLHelmholtzEquations.html#aea8423961cbcc8db267399364f9f8433">self_test</a>();</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160; </div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;<span class="comment">/// \short Compute pml coefficients at position x and integration point ipt.</span></div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;<span class="comment">/// pml_laplace_factor is used in the residual contribution from the laplace</span></div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;<span class="comment">/// operator, similarly pml_k_squared_factor is used in the contribution from</span></div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;<span class="comment">/// the k^2 of the Helmholtz operator.</span></div>
<div class="line"><a name="l00540"></a><span class="lineno"><a class="line" href="classoomph_1_1PMLHelmholtzEquations.html#a42f1a2b82fe37e76fb037a06e71f1082">  540</a></span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1PMLHelmholtzEquations.html#a42f1a2b82fe37e76fb037a06e71f1082">compute_pml_coefficients</a>(</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; ipt,</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;   <span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; x,</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;   <a class="code" href="classoomph_1_1Vector.html">Vector</a>&lt; std::complex&lt;double&gt; &gt;&amp; pml_laplace_factor,</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;   std::complex&lt;double&gt;&amp; pml_k_squared_factor)</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;   {</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;<span class="comment">    /// Vector which points from the inner boundary to x</span></div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;<span class="comment"></span>    <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> nu(DIM);</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> k=0; k&lt;DIM; k++)</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;    {</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;     nu[k] = x[k] - this-&gt;<a class="code" href="classoomph_1_1PMLElementBase.html#a952ab0485b0834249e5eac1e8448f43f">Pml_inner_boundary</a>[k];</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;    }</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;<span class="comment">    /// Vector which points from the inner boundary to the edge of the boundary</span></div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;<span class="comment"></span>    <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> pml_width(DIM);</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> k=0; k&lt;DIM; k++)</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;    {</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;     pml_width[k] = this-&gt;<a class="code" href="classoomph_1_1PMLElementBase.html#a7f3365fcb393848b926a836e10a3a288">Pml_outer_boundary</a>[k] - this-&gt;<a class="code" href="classoomph_1_1PMLElementBase.html#a952ab0485b0834249e5eac1e8448f43f">Pml_inner_boundary</a>[k];</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;    }</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160; </div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;    <span class="comment">// Declare gamma_i vectors of complex numbers for PML weights</span></div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;    <a class="code" href="classoomph_1_1Vector.html">Vector&lt;std::complex&lt;double&gt;</a> &gt; pml_gamma(DIM);</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160; </div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;    <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classoomph_1_1PMLElementBase.html#a0b0e980998764978801a1f0463a31989">Pml_is_enabled</a>)</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;    {</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;     <span class="comment">// Cache k_squared to pass into mapping function</span></div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;     <span class="keywordtype">double</span> k_squared_local = <a class="code" href="classoomph_1_1PMLHelmholtzEquations.html#a401e24e48170bd25d6b035a577f3cc62">k_squared</a>();</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160; </div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> k=0; k&lt;DIM; k++) {</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;      <span class="comment">// If PML is enabled in the respective direction</span></div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;      <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classoomph_1_1PMLElementBase.html#a5e460c58f3fe82696004d21e3f713d73">Pml_direction_active</a>[k])</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;      {</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;       pml_gamma[k] = <a class="code" href="classoomph_1_1PMLHelmholtzEquations.html#a1f2e029596dae700c376fe6a9b2d4223">Pml_mapping_pt</a>-&gt;<a class="code" href="classoomph_1_1PMLMapping.html#a4402061fe7e7b8a1d7a53f990c9a22fb">gamma</a>(nu[k],pml_width[k],</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;                                            k_squared_local,<a class="code" href="classoomph_1_1PMLHelmholtzEquations.html#ab1a6fa3fb13973c597e8faeb1ff4b2e1">alpha</a>());</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;      }</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;      {</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;       pml_gamma[k] = 1.0;</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;      }</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;     }</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;<span class="comment">     /// \short  for 2D, in order:</span></div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;<span class="comment">     /// g_y/g_x, g_x/g_y for Laplace bit and g_x*g_y for Helmholtz bit</span></div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;<span class="comment">     /// for 3D, in order: g_y*g_x/g_x, g*x*g_z/g_y, g_x*g_y/g_z for Laplace bit</span></div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;<span class="comment">     /// and g_x*g_y*g_z for Helmholtz bit</span></div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;<span class="comment"></span>     <span class="keywordflow">if</span> (DIM == 2)</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;     {</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;      pml_laplace_factor[0] = pml_gamma[1] / pml_gamma[0];</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;      pml_laplace_factor[1] = pml_gamma[0] / pml_gamma[1];</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;      pml_k_squared_factor = pml_gamma[0] * pml_gamma[1];</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;     }</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;     <span class="keywordflow">else</span> <span class="comment">// if (DIM == 3)</span></div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;     {</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;      pml_laplace_factor[0] = pml_gamma[1] * pml_gamma[2] / pml_gamma[0];</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;      pml_laplace_factor[1] = pml_gamma[0] * pml_gamma[2] / pml_gamma[1];</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;      pml_laplace_factor[2] = pml_gamma[0] * pml_gamma[1] / pml_gamma[2];</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;      pml_k_squared_factor = pml_gamma[0] * pml_gamma[1] * pml_gamma[2];</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;     }</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160; </div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;    }</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;    {<span class="comment"></span></div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;<span class="comment">     /// \short The weights all default to 1.0 as if the propagation</span></div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;<span class="comment">     /// medium is the physical domain</span></div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;<span class="comment"></span>     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> k=0; k&lt;DIM; k++)</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;     {</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;      pml_laplace_factor[k] = std::complex&lt;double&gt; (1.0,0.0);</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;     }</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160; </div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;     pml_k_squared_factor = std::complex&lt;double&gt; (1.0,0.0);</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;    }</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160; </div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;   }</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;<span class="comment">  /// Return a pointer to the PML Mapping object</span></div>
<div class="line"><a name="l00616"></a><span class="lineno"><a class="line" href="classoomph_1_1PMLHelmholtzEquations.html#a156959a72a8a67eccd1b9adf1c888b3e">  616</a></span>&#160;<span class="comment"></span>  <a class="code" href="classoomph_1_1PMLMapping.html">PMLMapping</a>* &amp;<a class="code" href="classoomph_1_1PMLHelmholtzEquations.html#a156959a72a8a67eccd1b9adf1c888b3e">pml_mapping_pt</a>() {<span class="keywordflow">return</span> <a class="code" href="classoomph_1_1PMLHelmholtzEquations.html#a1f2e029596dae700c376fe6a9b2d4223">Pml_mapping_pt</a>;}</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;<span class="comment">  /// Return a pointer to the PML Mapping object (const version)</span></div>
<div class="line"><a name="l00619"></a><span class="lineno"><a class="line" href="classoomph_1_1PMLHelmholtzEquations.html#aa03e7e88993070afa6d3fcf9a01cc5d9">  619</a></span>&#160;<span class="comment"></span>  <a class="code" href="classoomph_1_1PMLMapping.html">PMLMapping</a>* <span class="keyword">const</span> &amp;<a class="code" href="classoomph_1_1PMLHelmholtzEquations.html#aa03e7e88993070afa6d3fcf9a01cc5d9">pml_mapping_pt</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> <a class="code" href="classoomph_1_1PMLHelmholtzEquations.html#a1f2e029596dae700c376fe6a9b2d4223">Pml_mapping_pt</a>;}</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;<span class="comment">  /// Static so that the class doesn&#39;t need to instantiate a new default</span></div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;<span class="comment">  /// everytime it uses it</span></div>
<div class="line"><a name="l00623"></a><span class="lineno"><a class="line" href="classoomph_1_1PMLHelmholtzEquations.html#a8d5428a705d254ffb7e448cac84538ba">  623</a></span>&#160;<span class="comment"></span>  <span class="keyword">static</span> <a class="code" href="classoomph_1_1BermudezPMLMapping.html">BermudezPMLMapping</a> <a class="code" href="classoomph_1_1PMLHelmholtzEquations.html#a8d5428a705d254ffb7e448cac84538ba">Default_pml_mapping</a>;</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;<span class="comment">  /// \short The number of &quot;DOF types&quot; that degrees of freedom in this element</span></div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;<span class="comment">  /// are sub-divided into: real and imaginary part</span></div>
<div class="line"><a name="l00627"></a><span class="lineno"><a class="line" href="classoomph_1_1PMLHelmholtzEquations.html#a9894f96deeea40768c047978674e72e9">  627</a></span>&#160;<span class="comment"></span>  <span class="keywordtype">unsigned</span> <a class="code" href="classoomph_1_1PMLHelmholtzEquations.html#a9894f96deeea40768c047978674e72e9">ndof_types</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;<span class="keyword">   </span>{</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;    <span class="keywordflow">return</span> 2;</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;   }</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;<span class="comment">  /// \short Create a list of pairs for all unknowns in this element,</span></div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;<span class="comment">  /// so that the first entry in each pair contains the global equation</span></div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;<span class="comment">  /// number of the unknown, while the second one contains the number</span></div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;<span class="comment">  /// of the &quot;DOF type&quot; that this unknown is associated with.</span></div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;<span class="comment">  /// (Function can obviously only be called if the equation numbering</span></div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;<span class="comment">  /// scheme has been set up.) Real=0; Imag=1</span></div>
<div class="line"><a name="l00638"></a><span class="lineno"><a class="line" href="classoomph_1_1PMLHelmholtzEquations.html#a9756e606bfd0be5ff36f463d1de09b90">  638</a></span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1PMLHelmholtzEquations.html#a9756e606bfd0be5ff36f463d1de09b90">get_dof_numbers_for_unknowns</a>(</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;   std::list&lt;std::pair&lt;unsigned long,unsigned&gt; &gt;&amp; dof_lookup_list)<span class="keyword"> const</span></div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;<span class="keyword">   </span>{</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;    <span class="comment">// temporary pair (used to store dof lookup prior to being added to list)</span></div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;    std::pair&lt;unsigned,unsigned&gt; dof_lookup;</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160; </div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;    <span class="comment">// number of nodes</span></div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;    <span class="keywordtype">unsigned</span> n_node = this-&gt;<a class="code" href="classoomph_1_1FiniteElement.html#a6219ed269a6d89b5aa14659cce48905a">nnode</a>();</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160; </div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;    <span class="comment">// loop over the nodes</span></div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="the__data__structure_8txt.html#af88b2d950fae19ab641bd1690e08445c">n</a> = 0; <a class="code" href="the__data__structure_8txt.html#af88b2d950fae19ab641bd1690e08445c">n</a> &lt; n_node; <a class="code" href="the__data__structure_8txt.html#af88b2d950fae19ab641bd1690e08445c">n</a>++)</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;    {</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;     <span class="comment">// determine local eqn number for real part</span></div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;     <span class="keywordtype">int</span> <a class="code" href="classoomph_1_1GeneralisedElement.html#a3d46b71d27f94aeba21aff1ef84fd0a6">local_eqn_number</a> =</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;      this-&gt;<a class="code" href="classoomph_1_1FiniteElement.html#a5da80bbed97543e586f698251d67941d">nodal_local_eqn</a>(<a class="code" href="the__data__structure_8txt.html#af88b2d950fae19ab641bd1690e08445c">n</a>, <a class="code" href="classoomph_1_1PMLHelmholtzEquations.html#a2a36f64af504f8836aff147c455f31ac">u_index_helmholtz</a>().real());</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160; </div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;     <span class="comment">// ignore pinned values</span></div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;     <span class="keywordflow">if</span> (<a class="code" href="classoomph_1_1GeneralisedElement.html#a3d46b71d27f94aeba21aff1ef84fd0a6">local_eqn_number</a> &gt;= 0)</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;     {</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;      <span class="comment">// store dof lookup in temporary pair: First entry in pair</span></div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;      <span class="comment">// is global equation number; second entry is dof type</span></div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;      dof_lookup.first = this-&gt;<a class="code" href="classoomph_1_1GeneralisedElement.html#a37ac5a1d5234fa931ab710c0c74d55d2">eqn_number</a>(local_eqn_number);</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;      dof_lookup.second = 0;</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160; </div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;      <span class="comment">// add to list</span></div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;      dof_lookup_list.push_front(dof_lookup);</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;     }</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160; </div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;     <span class="comment">// determine local eqn number for imag part</span></div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;     <a class="code" href="classoomph_1_1GeneralisedElement.html#a3d46b71d27f94aeba21aff1ef84fd0a6">local_eqn_number</a> =</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;      this-&gt;<a class="code" href="classoomph_1_1FiniteElement.html#a5da80bbed97543e586f698251d67941d">nodal_local_eqn</a>(<a class="code" href="the__data__structure_8txt.html#af88b2d950fae19ab641bd1690e08445c">n</a>, <a class="code" href="classoomph_1_1PMLHelmholtzEquations.html#a2a36f64af504f8836aff147c455f31ac">u_index_helmholtz</a>().imag());</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160; </div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;     <span class="comment">// ignore pinned values</span></div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;     <span class="keywordflow">if</span> (<a class="code" href="classoomph_1_1GeneralisedElement.html#a3d46b71d27f94aeba21aff1ef84fd0a6">local_eqn_number</a> &gt;= 0)</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;     {</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;      <span class="comment">// store dof lookup in temporary pair: First entry in pair</span></div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;      <span class="comment">// is global equation number; second entry is dof type</span></div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;      dof_lookup.first = this-&gt;<a class="code" href="classoomph_1_1GeneralisedElement.html#a37ac5a1d5234fa931ab710c0c74d55d2">eqn_number</a>(local_eqn_number);</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;      dof_lookup.second = 1;</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160; </div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;      <span class="comment">// add to list</span></div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;      dof_lookup_list.push_front(dof_lookup);</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;     }</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;    }</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;   }</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160; </div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160; </div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160; <span class="keyword">protected</span>:</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;<span class="comment">  /// \short Shape/test functions and derivs w.r.t. to global coords at</span></div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;<span class="comment">  /// local coord. s; return  Jacobian of mapping</span></div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;<span class="comment"></span>  <span class="keyword">virtual</span> <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1PMLHelmholtzEquations.html#a2f7c4305049616d71efba341cb9f2074">dshape_and_dtest_eulerian_helmholtz</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;                                                     <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;psi,</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;                                                     <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;dpsidx, <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;test,</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;                                                     <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;dtestdx) <span class="keyword">const</span>=0;</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160; </div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;<span class="comment">  /// \short Shape/test functions and derivs w.r.t. to global coords at</span></div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;<span class="comment">  /// integration point ipt; return  Jacobian of mapping</span></div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;<span class="comment"></span>  <span class="keyword">virtual</span> <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1PMLHelmholtzEquations.html#a184e425cb3444c8b600fafd20538d5e8">dshape_and_dtest_eulerian_at_knot_helmholtz</a>(</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;ipt,</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;   <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;psi,</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;   <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;dpsidx,</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;   <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;test,</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;   <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;dtestdx) <span class="keyword">const</span>=0;</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;<span class="comment">  /// \short Compute element residual Vector only (if flag=and/or element</span></div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;<span class="comment">  /// Jacobian matrix</span></div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;<span class="comment"></span>  <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1PMLHelmholtzEquations.html#a11b6be67faf29eaf1f20405e43c4afe9">fill_in_generic_residual_contribution_helmholtz</a>(</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;   <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;<a class="code" href="the__data__structure_8txt.html#a1400a973def57b85051cfe1070be1810">residuals</a>, <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> &amp;jacobian,</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; flag);</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;<span class="comment">  /// Pointer to wavenumber complex shift</span></div>
<div class="line"><a name="l00711"></a><span class="lineno"><a class="line" href="classoomph_1_1PMLHelmholtzEquations.html#a9cf611c517509c8b2bc5c76d89d3da91">  711</a></span>&#160;<span class="comment"></span>  <span class="keywordtype">double</span> *<a class="code" href="classoomph_1_1PMLHelmholtzEquations.html#a9cf611c517509c8b2bc5c76d89d3da91">Alpha_pt</a>;</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;<span class="comment">  /// Pointer to source function:</span></div>
<div class="line"><a name="l00714"></a><span class="lineno"><a class="line" href="classoomph_1_1PMLHelmholtzEquations.html#a069e4a1971a30829c8eabc8527aa663f">  714</a></span>&#160;<span class="comment"></span>  <a class="code" href="classoomph_1_1PMLHelmholtzEquations.html#a9316a71cecd3c6c26ee6ab273800d3ec">PMLHelmholtzSourceFctPt</a> <a class="code" href="classoomph_1_1PMLHelmholtzEquations.html#a069e4a1971a30829c8eabc8527aa663f">Source_fct_pt</a>;</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;<span class="comment">  /// Pointer to wave number (must be set!)</span></div>
<div class="line"><a name="l00717"></a><span class="lineno"><a class="line" href="classoomph_1_1PMLHelmholtzEquations.html#aa4ea2eb142d7db69206d66415bc673ee">  717</a></span>&#160;<span class="comment"></span>  <span class="keywordtype">double</span>* <a class="code" href="classoomph_1_1PMLHelmholtzEquations.html#aa4ea2eb142d7db69206d66415bc673ee">K_squared_pt</a>;</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;<span class="comment">  /// Pointer to class which holds the pml mapping function, also known as gamma</span></div>
<div class="line"><a name="l00720"></a><span class="lineno"><a class="line" href="classoomph_1_1PMLHelmholtzEquations.html#a1f2e029596dae700c376fe6a9b2d4223">  720</a></span>&#160;<span class="comment"></span>  <a class="code" href="classoomph_1_1PMLMapping.html">PMLMapping</a>* <a class="code" href="classoomph_1_1PMLHelmholtzEquations.html#a1f2e029596dae700c376fe6a9b2d4223">Pml_mapping_pt</a>;</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;<span class="comment">  /// Static default value for the physical constants (initialised to zero)</span></div>
<div class="line"><a name="l00723"></a><span class="lineno"><a class="line" href="classoomph_1_1PMLHelmholtzEquations.html#ade525679c4e2d4ad0ba128008cf8e4f0">  723</a></span>&#160;<span class="comment"></span>  <span class="keyword">static</span> <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1PMLHelmholtzEquations.html#ade525679c4e2d4ad0ba128008cf8e4f0">Default_Physical_Constant_Value</a>;</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160; </div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160; };</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160; </div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;<span class="comment">///////////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;<span class="comment">///////////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;<span class="comment">///////////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160; </div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160; </div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;<span class="comment">//======================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;<span class="comment">/// \short QPMLHelmholtzElement elements are linear/quadrilateral/</span></div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;<span class="comment">/// brick-shaped PMLHelmholtz elements with isoparametric</span></div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;<span class="comment">/// interpolation for the function.</span></div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;<span class="comment"></span><span class="comment">//======================================================================</span></div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160; <span class="keyword">template</span> &lt;<span class="keywordtype">unsigned</span> DIM, <span class="keywordtype">unsigned</span> NNODE_1D&gt;</div>
<div class="line"><a name="l00740"></a><span class="lineno"><a class="line" href="classoomph_1_1QPMLHelmholtzElement.html">  740</a></span>&#160; <span class="keyword">class </span><a class="code" href="classoomph_1_1QPMLHelmholtzElement.html">QPMLHelmholtzElement</a> : <span class="keyword">public</span> <span class="keyword">virtual</span> <a class="code" href="classoomph_1_1QElement.html">QElement</a>&lt;DIM,NNODE_1D&gt;,</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;                              <span class="keyword">public</span> <span class="keyword">virtual</span> <a class="code" href="classoomph_1_1PMLHelmholtzEquations.html">PMLHelmholtzEquations</a>&lt;DIM&gt;</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160; {</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160; </div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160; <span class="keyword">private</span>:</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;<span class="comment">  /// \short Static int that holds the number of variables at</span></div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;<span class="comment">  /// nodes: always the same</span></div>
<div class="line"><a name="l00748"></a><span class="lineno"><a class="line" href="classoomph_1_1QPMLHelmholtzElement.html#a243a9941c4268cd9d1d947ad08e9cddf">  748</a></span>&#160;<span class="comment"></span>  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <a class="code" href="classoomph_1_1QPMLHelmholtzElement.html#a243a9941c4268cd9d1d947ad08e9cddf">Initial_Nvalue</a>;</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160; </div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160; <span class="keyword">public</span>:</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160; </div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;<span class="comment">  ///\short  Constructor: Call constructors for QElement and</span></div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;<span class="comment">  /// PMLHelmholtz equations</span></div>
<div class="line"><a name="l00755"></a><span class="lineno"><a class="line" href="classoomph_1_1QPMLHelmholtzElement.html#a63cb39a7b1bd6e381fe837086d42316a">  755</a></span>&#160;<span class="comment"></span>  <a class="code" href="classoomph_1_1QPMLHelmholtzElement.html#a63cb39a7b1bd6e381fe837086d42316a">QPMLHelmholtzElement</a>() :</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;   <a class="code" href="classoomph_1_1QElement.html">QElement</a>&lt;DIM,NNODE_1D&gt;(), <a class="code" href="classoomph_1_1PMLHelmholtzEquations.html">PMLHelmholtzEquations</a>&lt;DIM&gt;()</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;   {}</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;<span class="comment">  /// Broken copy constructor</span></div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;<span class="comment"></span>  <a class="code" href="classoomph_1_1QPMLHelmholtzElement.html#a63cb39a7b1bd6e381fe837086d42316a">QPMLHelmholtzElement</a></div>
<div class="line"><a name="l00761"></a><span class="lineno"><a class="line" href="classoomph_1_1QPMLHelmholtzElement.html#a733a6bb7282fa7703ed2ae402b677f7b">  761</a></span>&#160;  (<span class="keyword">const</span> <a class="code" href="classoomph_1_1QPMLHelmholtzElement.html">QPMLHelmholtzElement&lt;DIM,NNODE_1D&gt;</a>&amp; dummy)</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;   {</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;    <a class="code" href="namespaceoomph_1_1BrokenCopy.html#a7e5cd7fda8b8c790003151bee77a84ac">BrokenCopy::broken_copy</a>(<span class="stringliteral">&quot;QPMLHelmholtzElement&quot;</span>);</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;   }</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;<span class="comment">  /// Broken assignment operator</span></div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;<span class="comment"></span>  <span class="comment">/*void operator=(const QPMLHelmholtzElement&lt;DIM,NNODE_1D&gt;&amp;)</span></div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;<span class="comment">    {</span></div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;<span class="comment">    BrokenCopy::broken_assign(&quot;QPMLHelmholtzElement&quot;);</span></div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;<span class="comment">    }*/</span></div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160; </div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;<span class="comment">  /// \short  Required  # of `values&#39; (pinned or dofs)</span></div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;<span class="comment">  /// at node n</span></div>
<div class="line"><a name="l00775"></a><span class="lineno"><a class="line" href="classoomph_1_1QPMLHelmholtzElement.html#a951f66c2e2286d54068ceb4e70f4cf1b">  775</a></span>&#160;<span class="comment"></span>  <span class="keyword">inline</span> <span class="keywordtype">unsigned</span> <a class="code" href="classoomph_1_1QPMLHelmholtzElement.html#a951f66c2e2286d54068ceb4e70f4cf1b">required_nvalue</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;<a class="code" href="the__data__structure_8txt.html#af88b2d950fae19ab641bd1690e08445c">n</a>)<span class="keyword"> const</span></div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;<span class="keyword">   </span>{<span class="keywordflow">return</span> <a class="code" href="classoomph_1_1QPMLHelmholtzElement.html#a243a9941c4268cd9d1d947ad08e9cddf">Initial_Nvalue</a>;}</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;<span class="comment">  /// \short Output function:</span></div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;<span class="comment">  ///  x,y,u   or    x,y,z,u</span></div>
<div class="line"><a name="l00780"></a><span class="lineno"><a class="line" href="classoomph_1_1QPMLHelmholtzElement.html#ab8c2433419a29ea74346fe35072d6933">  780</a></span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1QPMLHelmholtzElement.html#ab8c2433419a29ea74346fe35072d6933">output</a>(std::ostream &amp;outfile)</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;   {<a class="code" href="classoomph_1_1PMLHelmholtzEquations.html#a1b6f4cae7b6ee3a1cce7253912b1acb0">PMLHelmholtzEquations&lt;DIM&gt;::output</a>(outfile);}</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160; </div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;<span class="comment">  ///  \short Output function:</span></div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;<span class="comment">  ///   x,y,u   or    x,y,z,u at n_plot^DIM plot points</span></div>
<div class="line"><a name="l00786"></a><span class="lineno"><a class="line" href="classoomph_1_1QPMLHelmholtzElement.html#a72fce9b0be92c83f0741cec44176f4ef">  786</a></span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1QPMLHelmholtzElement.html#a72fce9b0be92c83f0741cec44176f4ef">output</a>(std::ostream &amp;outfile, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;n_plot)</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;   {<a class="code" href="classoomph_1_1PMLHelmholtzEquations.html#a1b6f4cae7b6ee3a1cce7253912b1acb0">PMLHelmholtzEquations&lt;DIM&gt;::output</a>(outfile,n_plot);}</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;<span class="comment">  /// \short Output function for real part of full time-dependent solution</span></div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;<span class="comment">  /// u = Re( (u_r +i u_i) exp(-i omega t)</span></div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;<span class="comment">  /// at phase angle omega t = phi.</span></div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;<span class="comment">  /// x,y,u   or    x,y,z,u at n_plot plot points in each coordinate</span></div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;<span class="comment">  /// direction</span></div>
<div class="line"><a name="l00794"></a><span class="lineno"><a class="line" href="classoomph_1_1QPMLHelmholtzElement.html#a3abd5007b3b32a8bad25dd3b1121fb80">  794</a></span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1QPMLHelmholtzElement.html#a3abd5007b3b32a8bad25dd3b1121fb80">output_real</a>(std::ostream &amp;outfile, <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; phi,</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;                   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;n_plot)</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;   {<a class="code" href="classoomph_1_1PMLHelmholtzEquations.html#a88ca4602a7152f1723ba85be0fc8eaf6">PMLHelmholtzEquations&lt;DIM&gt;::output_real</a>(outfile,phi,n_plot);}</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;<span class="comment">  /// \short Output function for imaginary part of full time-dependent solution</span></div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;<span class="comment">  /// u = Im( (u_r +i u_i) exp(-i omega t))</span></div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;<span class="comment">  /// at phase angle omega t = phi.</span></div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;<span class="comment">  /// x,y,u   or    x,y,z,u at n_plot plot points in each coordinate</span></div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;<span class="comment">  /// direction</span></div>
<div class="line"><a name="l00803"></a><span class="lineno"><a class="line" href="classoomph_1_1QPMLHelmholtzElement.html#a436860ac0bf4df77d0359cd9edea4b18">  803</a></span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1QPMLHelmholtzElement.html#a436860ac0bf4df77d0359cd9edea4b18">output_imag</a>(std::ostream &amp;outfile, <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; phi,</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;                   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;n_plot)</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;   {<a class="code" href="classoomph_1_1PMLHelmholtzEquations.html#ade29ee33fc008a0ff318f34f43014724">PMLHelmholtzEquations&lt;DIM&gt;::output_imag</a>(outfile,phi,n_plot);}</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160; </div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;<span class="comment">  /// \short C-style output function:</span></div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;<span class="comment">  ///  x,y,u   or    x,y,z,u</span></div>
<div class="line"><a name="l00810"></a><span class="lineno"><a class="line" href="classoomph_1_1QPMLHelmholtzElement.html#a37929db1002d8628c4da96be8b9dde96">  810</a></span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1QPMLHelmholtzElement.html#a37929db1002d8628c4da96be8b9dde96">output</a>(FILE* file_pt)</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;   {<a class="code" href="classoomph_1_1PMLHelmholtzEquations.html#a1b6f4cae7b6ee3a1cce7253912b1acb0">PMLHelmholtzEquations&lt;DIM&gt;::output</a>(file_pt);}</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160; </div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;<span class="comment">  ///  \short C-style output function:</span></div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;<span class="comment">  ///   x,y,u   or    x,y,z,u at n_plot^DIM plot points</span></div>
<div class="line"><a name="l00816"></a><span class="lineno"><a class="line" href="classoomph_1_1QPMLHelmholtzElement.html#a2d0d6f63dd0b16bbe7c43c8cae73d4b5">  816</a></span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1QPMLHelmholtzElement.html#a2d0d6f63dd0b16bbe7c43c8cae73d4b5">output</a>(FILE* file_pt, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;n_plot)</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;   {<a class="code" href="classoomph_1_1PMLHelmholtzEquations.html#a1b6f4cae7b6ee3a1cce7253912b1acb0">PMLHelmholtzEquations&lt;DIM&gt;::output</a>(file_pt,n_plot);}</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160; </div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;<span class="comment">  /// \short Output function for an exact solution:</span></div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;<span class="comment">  ///  x,y,u_exact   or    x,y,z,u_exact at n_plot^DIM plot points</span></div>
<div class="line"><a name="l00822"></a><span class="lineno"><a class="line" href="classoomph_1_1QPMLHelmholtzElement.html#aa61e5de6798f150e1dc720a955944b86">  822</a></span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1QPMLHelmholtzElement.html#aa61e5de6798f150e1dc720a955944b86">output_fct</a>(std::ostream &amp;outfile, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;n_plot,</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;                  <a class="code" href="classoomph_1_1FiniteElement.html#a690fd33af26cc3e84f39bba6d5a85202">FiniteElement::SteadyExactSolutionFctPt</a> exact_soln_pt)</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;   {<a class="code" href="classoomph_1_1PMLHelmholtzEquations.html#ae56afa0bfd1de461e033a7ecc5a4f895">PMLHelmholtzEquations&lt;DIM&gt;::output_fct</a>(outfile,</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;                                           n_plot,</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;                                           exact_soln_pt);}</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160; </div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;<span class="comment">  /// \short Output function for real part of full time-dependent fct</span></div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;<span class="comment">  /// u = Re( (u_r +i u_i) exp(-i omega t)</span></div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;<span class="comment">  /// at phase angle omega t = phi.</span></div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;<span class="comment">  /// x,y,u   or    x,y,z,u at n_plot plot points in each coordinate</span></div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;<span class="comment">  /// direction</span></div>
<div class="line"><a name="l00834"></a><span class="lineno"><a class="line" href="classoomph_1_1QPMLHelmholtzElement.html#a76aeac6f55eb83e97fd862d7bc581477">  834</a></span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1QPMLHelmholtzElement.html#a76aeac6f55eb83e97fd862d7bc581477">output_real_fct</a>(std::ostream &amp;outfile,</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;                       <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; phi,</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;                       <span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;n_plot,</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;                       <a class="code" href="classoomph_1_1FiniteElement.html#a690fd33af26cc3e84f39bba6d5a85202">FiniteElement::SteadyExactSolutionFctPt</a> exact_soln_pt)</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;   {</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;    <a class="code" href="classoomph_1_1PMLHelmholtzEquations.html#af590f98d401b50f72b67ef7f0813fe7f">PMLHelmholtzEquations&lt;DIM&gt;::output_real_fct</a>(outfile,</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;                                                phi,</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;                                                n_plot,</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;                                                exact_soln_pt);</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;   }</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;<span class="comment">  /// \short Output function for imaginary part of full time-dependent fct</span></div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;<span class="comment">  /// u = Im( (u_r +i u_i) exp(-i omega t))</span></div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;<span class="comment">  /// at phase angle omega t = phi.</span></div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;<span class="comment">  /// x,y,u   or    x,y,z,u at n_plot plot points in each coordinate</span></div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;<span class="comment">  /// direction</span></div>
<div class="line"><a name="l00850"></a><span class="lineno"><a class="line" href="classoomph_1_1QPMLHelmholtzElement.html#ad63b4b8965a17ea8f5df8e6ec6d5ce9b">  850</a></span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1QPMLHelmholtzElement.html#ad63b4b8965a17ea8f5df8e6ec6d5ce9b">output_imag_fct</a>(std::ostream &amp;outfile,</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;                       <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; phi,</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;                       <span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;n_plot,</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;                       <a class="code" href="classoomph_1_1FiniteElement.html#a690fd33af26cc3e84f39bba6d5a85202">FiniteElement::SteadyExactSolutionFctPt</a> exact_soln_pt)</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;   {</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;    <a class="code" href="classoomph_1_1PMLHelmholtzEquations.html#a8290cabe737e4260a58ff7feb087023c">PMLHelmholtzEquations&lt;DIM&gt;::output_imag_fct</a>(outfile,</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;                                                phi,</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;                                                n_plot,</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;                                                exact_soln_pt);</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;   }</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160; </div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;<span class="comment">  /// \short Output function for a time-dependent exact solution.</span></div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;<span class="comment">  ///  x,y,u_exact   or    x,y,z,u_exact at n_plot^DIM plot points</span></div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;<span class="comment">  /// (Calls the steady version)</span></div>
<div class="line"><a name="l00865"></a><span class="lineno"><a class="line" href="classoomph_1_1QPMLHelmholtzElement.html#a11cffc61d0cf6cac32ffb004d26d836c">  865</a></span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1QPMLHelmholtzElement.html#a11cffc61d0cf6cac32ffb004d26d836c">output_fct</a>(std::ostream &amp;outfile, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;n_plot,</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;                  <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; time,</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;                  <a class="code" href="classoomph_1_1FiniteElement.html#ad4ecf2b61b158a4b4d351a60d23c633e">FiniteElement::UnsteadyExactSolutionFctPt</a> exact_soln_pt)</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;   {<a class="code" href="classoomph_1_1PMLHelmholtzEquations.html#ae56afa0bfd1de461e033a7ecc5a4f895">PMLHelmholtzEquations&lt;DIM&gt;::output_fct</a>(outfile,</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;                                           n_plot,</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;                                           time,</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;                                           exact_soln_pt);}</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160; </div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160; <span class="keyword">protected</span>:</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;<span class="comment">/// Shape, test functions &amp; derivs. w.r.t. to global coords. Return Jacobian.</span></div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;<span class="comment"></span>  <span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1QPMLHelmholtzElement.html#a6d39a3233c4b8b25ce007d7650421287">dshape_and_dtest_eulerian_helmholtz</a>(</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;   <span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>, <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;psi, <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;dpsidx,</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;   <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;test, <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;dtestdx) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160; </div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;<span class="comment">  /// \short Shape, test functions &amp; derivs. w.r.t. to global coords. at</span></div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;<span class="comment">  /// integration point ipt. Return Jacobian.</span></div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;<span class="comment"></span>  <span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1QPMLHelmholtzElement.html#a478b379a92507b5ddf6de3ff91257695">dshape_and_dtest_eulerian_at_knot_helmholtz</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; ipt,</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;                                                            <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;psi,</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;                                                            <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;dpsidx,</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;                                                            <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;test,</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;                                                            <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;dtestdx)</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;   <span class="keyword">const</span>;</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160; </div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160; };</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160; </div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160; </div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160; </div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160; </div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;<span class="comment">//Inline functions:</span></div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160; </div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160; </div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;<span class="comment">//======================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;<span class="comment">/// Define the shape functions and test functions and derivatives</span></div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;<span class="comment">/// w.r.t. global coordinates and return Jacobian of mapping.</span></div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;<span class="comment">/// Galerkin: Test functions = shape functions</span></div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;<span class="comment"></span><span class="comment">//======================================================================</span></div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160; <span class="keyword">template</span>&lt;<span class="keywordtype">unsigned</span> DIM, <span class="keywordtype">unsigned</span> NNODE_1D&gt;</div>
<div class="line"><a name="l00905"></a><span class="lineno"><a class="line" href="classoomph_1_1QPMLHelmholtzElement.html#a6d39a3233c4b8b25ce007d7650421287">  905</a></span>&#160; <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1QPMLHelmholtzElement.html#a6d39a3233c4b8b25ce007d7650421287">QPMLHelmholtzElement&lt;DIM,NNODE_1D&gt;::dshape_and_dtest_eulerian_helmholtz</a>(</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;  <span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;  <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;psi,</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;  <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;dpsidx,</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;  <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;test,</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;  <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;dtestdx)<span class="keyword"> const</span></div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;<span class="keyword"> </span>{</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;  <span class="comment">//Call the geometrical shape functions and derivatives</span></div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> J = this-&gt;dshape_eulerian(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,psi,dpsidx);</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160; </div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;  <span class="comment">//Set the test functions equal to the shape functions</span></div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;  test = psi;</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;  dtestdx= dpsidx;</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160; </div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;  <span class="comment">//Return the jacobian</span></div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;  <span class="keywordflow">return</span> J;</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160; }</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160; </div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160; </div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160; </div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160; </div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;<span class="comment">//======================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;<span class="comment">/// Define the shape functions and test functions and derivatives</span></div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;<span class="comment">/// w.r.t. global coordinates and return Jacobian of mapping.</span></div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;<span class="comment">/// Galerkin: Test functions = shape functions</span></div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;<span class="comment"></span><span class="comment">//======================================================================</span></div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160; <span class="keyword">template</span>&lt;<span class="keywordtype">unsigned</span> DIM, <span class="keywordtype">unsigned</span> NNODE_1D&gt;</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160; <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1QPMLHelmholtzElement.html#a478b379a92507b5ddf6de3ff91257695">QPMLHelmholtzElement&lt;DIM,NNODE_1D&gt;::</a></div>
<div class="line"><a name="l00934"></a><span class="lineno"><a class="line" href="classoomph_1_1QPMLHelmholtzElement.html#a478b379a92507b5ddf6de3ff91257695">  934</a></span>&#160;<a class="code" href="classoomph_1_1QPMLHelmholtzElement.html#a478b379a92507b5ddf6de3ff91257695"> dshape_and_dtest_eulerian_at_knot_helmholtz</a>(</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;ipt,</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;  <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;psi,</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;  <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;dpsidx,</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;  <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;test,</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;  <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;dtestdx)<span class="keyword"> const</span></div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;<span class="keyword"> </span>{</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;  <span class="comment">//Call the geometrical shape functions and derivatives</span></div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> J = this-&gt;dshape_eulerian_at_knot(ipt,psi,dpsidx);</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160; </div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;  <span class="comment">//Set the pointers of the test functions</span></div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;  test = psi;</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;  dtestdx = dpsidx;</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160; </div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;  <span class="comment">//Return the jacobian</span></div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;  <span class="keywordflow">return</span> J;</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160; }</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160; </div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160; </div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;<span class="comment">//=======================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;<span class="comment">/// Face geometry for the QPMLHelmholtzElement elements: The spatial</span></div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;<span class="comment">/// dimension of the face elements is one lower than that of the</span></div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;<span class="comment">/// bulk element but they have the same number of points</span></div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;<span class="comment">/// along their 1D edges.</span></div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;<span class="comment"></span><span class="comment">//=======================================================================</span></div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160; <span class="keyword">template</span>&lt;<span class="keywordtype">unsigned</span> DIM, <span class="keywordtype">unsigned</span> NNODE_1D&gt;</div>
<div class="line"><a name="l00965"></a><span class="lineno"><a class="line" href="classoomph_1_1FaceGeometry_3_01QPMLHelmholtzElement_3_01DIM_00_01NNODE__1D_01_4_01_4.html">  965</a></span>&#160; <span class="keyword">class </span><a class="code" href="classoomph_1_1FaceGeometry.html">FaceGeometry</a>&lt;<a class="code" href="classoomph_1_1QPMLHelmholtzElement.html">QPMLHelmholtzElement</a>&lt;DIM,NNODE_1D&gt; &gt;:</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;  <span class="keyword">public</span> <span class="keyword">virtual</span> <a class="code" href="classoomph_1_1QElement.html">QElement</a>&lt;DIM-1,NNODE_1D&gt;</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160; {</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160; </div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160; <span class="keyword">public</span>:</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;<span class="comment">  /// \short Constructor: Call the constructor for the</span></div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;<span class="comment">  /// appropriate lower-dimensional QElement</span></div>
<div class="line"><a name="l00973"></a><span class="lineno"><a class="line" href="classoomph_1_1FaceGeometry_3_01QPMLHelmholtzElement_3_01DIM_00_01NNODE__1D_01_4_01_4.html#ae2c09ca30f694a462a56b47ff6913398">  973</a></span>&#160;<span class="comment"></span>  <a class="code" href="classoomph_1_1FaceGeometry_3_01QPMLHelmholtzElement_3_01DIM_00_01NNODE__1D_01_4_01_4.html#ae2c09ca30f694a462a56b47ff6913398">FaceGeometry</a>() : <a class="code" href="classoomph_1_1QElement.html">QElement</a>&lt;DIM-1,NNODE_1D&gt;() {}</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160; </div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160; };</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160; </div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;<span class="comment">//=======================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;<span class="comment">/// Face geometry for the 1D QPMLHelmholtzElement elements:</span></div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;<span class="comment">/// Point elements</span></div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;<span class="comment"></span><span class="comment">//=======================================================================</span></div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160; <span class="keyword">template</span>&lt;<span class="keywordtype">unsigned</span> NNODE_1D&gt;</div>
<div class="line"><a name="l00987"></a><span class="lineno"><a class="line" href="classoomph_1_1FaceGeometry_3_01QPMLHelmholtzElement_3_011_00_01NNODE__1D_01_4_01_4.html">  987</a></span>&#160; <span class="keyword">class </span><a class="code" href="classoomph_1_1FaceGeometry.html">FaceGeometry</a>&lt;<a class="code" href="classoomph_1_1QPMLHelmholtzElement.html">QPMLHelmholtzElement</a>&lt;1,NNODE_1D&gt; &gt;:</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;  <span class="keyword">public</span> <span class="keyword">virtual</span> <a class="code" href="classoomph_1_1PointElement.html">PointElement</a></div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160; {</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160; </div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160; <span class="keyword">public</span>:</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;<span class="comment">  /// \short Constructor: Call the constructor for the</span></div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;<span class="comment">  /// appropriate lower-dimensional QElement</span></div>
<div class="line"><a name="l00995"></a><span class="lineno"><a class="line" href="classoomph_1_1FaceGeometry_3_01QPMLHelmholtzElement_3_011_00_01NNODE__1D_01_4_01_4.html#a8656bdcb771bb955fb1dd67eb1849d67">  995</a></span>&#160;<span class="comment"></span>  <a class="code" href="classoomph_1_1FaceGeometry_3_01QPMLHelmholtzElement_3_011_00_01NNODE__1D_01_4_01_4.html#a8656bdcb771bb955fb1dd67eb1849d67">FaceGeometry</a>() : <a class="code" href="classoomph_1_1PointElement.html">PointElement</a>() {}</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160; </div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160; };</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160; </div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160; </div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;<span class="comment">//==========================================================</span><span class="comment"></span></div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;<span class="comment">/// PMLHelmholtz upgraded to become projectable</span></div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;<span class="comment"></span><span class="comment">//==========================================================</span></div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160; <span class="keyword">template</span>&lt;<span class="keyword">class</span> HELMHOLTZ_ELEMENT&gt;</div>
<div class="line"><a name="l01009"></a><span class="lineno"><a class="line" href="classoomph_1_1ProjectablePMLHelmholtzElement.html"> 1009</a></span>&#160; <span class="keyword">class </span><a class="code" href="classoomph_1_1ProjectablePMLHelmholtzElement.html">ProjectablePMLHelmholtzElement</a> :</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;  <span class="keyword">public</span> <span class="keyword">virtual</span> <a class="code" href="classoomph_1_1ProjectableElement.html">ProjectableElement</a>&lt;HELMHOLTZ_ELEMENT&gt;</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160; {</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160; </div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160; <span class="keyword">public</span>:</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160; </div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;<span class="comment">  /// \short Constructor [this was only required explicitly</span></div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;<span class="comment">  /// from gcc 4.5.2 onwards...]</span></div>
<div class="line"><a name="l01018"></a><span class="lineno"><a class="line" href="classoomph_1_1ProjectablePMLHelmholtzElement.html#a005f750d15074893d3ac428b49f2318d"> 1018</a></span>&#160;<span class="comment"></span>  <a class="code" href="classoomph_1_1ProjectablePMLHelmholtzElement.html#a005f750d15074893d3ac428b49f2318d">ProjectablePMLHelmholtzElement</a>(){}</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;<span class="comment">  /// \short Specify the values associated with field fld.</span></div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;<span class="comment">  /// The information is returned in a vector of pairs which comprise</span></div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;<span class="comment">  /// the Data object and the value within it, that correspond to field fld.</span></div>
<div class="line"><a name="l01023"></a><span class="lineno"><a class="line" href="classoomph_1_1ProjectablePMLHelmholtzElement.html#a7bae5d4f8a8716c9db2119094f9f08bc"> 1023</a></span>&#160;<span class="comment"></span>  <a class="code" href="classoomph_1_1Vector.html">Vector&lt;std::pair&lt;Data*,unsigned&gt;</a> &gt; <a class="code" href="classoomph_1_1ProjectablePMLHelmholtzElement.html#a7bae5d4f8a8716c9db2119094f9f08bc">data_values_of_field</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; fld)</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;   {</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160; </div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;    <span class="keywordflow">if</span> (fld&gt;1)</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;    {</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;     std::stringstream error_stream;</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;     error_stream</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;PMLHelmholtz elements only store 2 fields so fld = &quot;</span></div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;      &lt;&lt; fld &lt;&lt; <span class="stringliteral">&quot; is illegal \n&quot;</span>;</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;     <span class="keywordflow">throw</span> <a class="code" href="classoomph_1_1OomphLibError.html">OomphLibError</a>(</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;      error_stream.str(),</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;      OOMPH_CURRENT_FUNCTION,</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;      OOMPH_EXCEPTION_LOCATION);</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;    }</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160; </div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;    <span class="comment">// Create the vector</span></div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;    <span class="keywordtype">unsigned</span> nnod=this-&gt;<a class="code" href="classoomph_1_1FiniteElement.html#a6219ed269a6d89b5aa14659cce48905a">nnode</a>();</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;    <a class="code" href="classoomph_1_1Vector.html">Vector&lt;std::pair&lt;Data*,unsigned&gt;</a> &gt; data_values(nnod);</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160; </div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;    <span class="comment">// Loop over all nodes</span></div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j=0;j&lt;nnod;j++)</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;    {</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;     <span class="comment">// Add the data value associated field: The node itself</span></div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;     data_values[j]=std::make_pair(this-&gt;<a class="code" href="classoomph_1_1FiniteElement.html#ace0e7fb72a805b5c2c600347bfae7a9b">node_pt</a>(j),fld);</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;    }</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160; </div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;    <span class="comment">// Return the vector</span></div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;    <span class="keywordflow">return</span> data_values;</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;   }</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;<span class="comment">  /// \short Number of fields to be projected: 2 (real and imag part)</span></div>
<div class="line"><a name="l01056"></a><span class="lineno"><a class="line" href="classoomph_1_1ProjectablePMLHelmholtzElement.html#ab90d84e474fccf3a814ea99ecd02e61c"> 1056</a></span>&#160;<span class="comment"></span>  <span class="keywordtype">unsigned</span> <a class="code" href="classoomph_1_1ProjectablePMLHelmholtzElement.html#ab90d84e474fccf3a814ea99ecd02e61c">nfields_for_projection</a>()</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;   {</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;    <span class="keywordflow">return</span> 2;</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;   }</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;<span class="comment">  /// \short Number of history values to be stored for fld-th field.</span></div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;<span class="comment">  /// (Note: count includes current value!)</span></div>
<div class="line"><a name="l01063"></a><span class="lineno"><a class="line" href="classoomph_1_1ProjectablePMLHelmholtzElement.html#a5b0bad4b386bf0d31aeccb963e0814a0"> 1063</a></span>&#160;<span class="comment"></span>  <span class="keywordtype">unsigned</span> <a class="code" href="classoomph_1_1ProjectablePMLHelmholtzElement.html#a5b0bad4b386bf0d31aeccb963e0814a0">nhistory_values_for_projection</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;fld)</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;   {</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;    <span class="keywordflow">if</span> (fld&gt;1)</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;    {</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;     std::stringstream error_stream;</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;     error_stream</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;PMLHelmholtz elements only store two fields so fld = &quot;</span></div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;      &lt;&lt; fld &lt;&lt; <span class="stringliteral">&quot; is illegal\n&quot;</span>;</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;     <span class="keywordflow">throw</span> <a class="code" href="classoomph_1_1OomphLibError.html">OomphLibError</a>(</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;      error_stream.str(),</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;      OOMPH_CURRENT_FUNCTION,</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;      OOMPH_EXCEPTION_LOCATION);</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;    }</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;    <span class="keywordflow">return</span> this-&gt;<a class="code" href="classoomph_1_1FiniteElement.html#ace0e7fb72a805b5c2c600347bfae7a9b">node_pt</a>(0)-&gt;<a class="code" href="classoomph_1_1Data.html#a9752205c5fb3bb886200b3fae9181e94">ntstorage</a>();</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;   }</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;<span class="comment">  ///\short Number of positional history values</span></div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;<span class="comment">  /// (Note: count includes current value!)</span></div>
<div class="line"><a name="l01083"></a><span class="lineno"><a class="line" href="classoomph_1_1ProjectablePMLHelmholtzElement.html#a3af221fe8b94d8a50917c92c3cc94b5d"> 1083</a></span>&#160;<span class="comment"></span>  <span class="keywordtype">unsigned</span> <a class="code" href="classoomph_1_1ProjectablePMLHelmholtzElement.html#a3af221fe8b94d8a50917c92c3cc94b5d">nhistory_values_for_coordinate_projection</a>()</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;   {</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;    <span class="keywordflow">return</span> this-&gt;<a class="code" href="classoomph_1_1FiniteElement.html#ace0e7fb72a805b5c2c600347bfae7a9b">node_pt</a>(0)-&gt;<a class="code" href="classoomph_1_1Node.html#a89175b154594ba5b1a6cdde6f385dc71">position_time_stepper_pt</a>()-&gt;<a class="code" href="classoomph_1_1TimeStepper.html#a3939b77ec3578e4bd5b453c85649d631">ntstorage</a>();</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;   }</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;<span class="comment">  /// \short Return Jacobian of mapping and shape functions of field fld</span></div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;<span class="comment">  /// at local coordinate s</span></div>
<div class="line"><a name="l01090"></a><span class="lineno"><a class="line" href="classoomph_1_1ProjectablePMLHelmholtzElement.html#aa4af5bb878fed3d1b286bde1da0f5419"> 1090</a></span>&#160;<span class="comment"></span>  <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1ProjectablePMLHelmholtzElement.html#aa4af5bb878fed3d1b286bde1da0f5419">jacobian_and_shape_of_field</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;fld,</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;                                     <span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;                                     <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;psi)</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;   {</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;    <span class="keywordflow">if</span> (fld&gt;1)</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;    {</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;     std::stringstream error_stream;</div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;     error_stream</div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;PMLHelmholtz elements only store two fields so fld = &quot;</span></div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;      &lt;&lt; fld &lt;&lt; <span class="stringliteral">&quot; is illegal.\n&quot;</span>;</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;     <span class="keywordflow">throw</span> <a class="code" href="classoomph_1_1OomphLibError.html">OomphLibError</a>(</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;      error_stream.str(),</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;      OOMPH_CURRENT_FUNCTION,</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;      OOMPH_EXCEPTION_LOCATION);</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;    }</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;    <span class="keywordtype">unsigned</span> n_dim=this-&gt;<a class="code" href="classoomph_1_1FiniteElement.html#a5f8fe59f06da1da9f6b7bbcbdb90ef93">dim</a>();</div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;    <span class="keywordtype">unsigned</span> n_node=this-&gt;<a class="code" href="classoomph_1_1FiniteElement.html#a6219ed269a6d89b5aa14659cce48905a">nnode</a>();</div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;    <a class="code" href="classoomph_1_1Shape.html">Shape</a> test(n_node);</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;    <a class="code" href="classoomph_1_1DShape.html">DShape</a> dpsidx(n_node,n_dim), dtestdx(n_node,n_dim);</div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;    <span class="keywordtype">double</span> J=this-&gt;dshape_and_dtest_eulerian_helmholtz(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,psi,dpsidx,</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;                                                       test,dtestdx);</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;    <span class="keywordflow">return</span> J;</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;   }</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160; </div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160; </div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;<span class="comment">  /// \short Return interpolated field fld at local coordinate s, at time level</span></div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;<span class="comment">  /// t (t=0: present; t&gt;0: history values)</span></div>
<div class="line"><a name="l01120"></a><span class="lineno"><a class="line" href="classoomph_1_1ProjectablePMLHelmholtzElement.html#a14a5a245ec1fa36c371a3937a3fb4e96"> 1120</a></span>&#160;<span class="comment"></span>  <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1ProjectablePMLHelmholtzElement.html#a14a5a245ec1fa36c371a3937a3fb4e96">get_field</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;<a class="code" href="cfortran_8h.html#af6f0bd3dc13317f895c91323c25c2b8f">t</a>,</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;                   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;fld,</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;                   <span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>)</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;   {</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;    <span class="keywordflow">if</span> (fld&gt;1)</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;    {</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;     std::stringstream error_stream;</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;     error_stream</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;PMLHelmholtz elements only store two fields so fld = &quot;</span></div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;      &lt;&lt; fld &lt;&lt; <span class="stringliteral">&quot; is illegal\n&quot;</span>;</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;     <span class="keywordflow">throw</span> <a class="code" href="classoomph_1_1OomphLibError.html">OomphLibError</a>(</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;      error_stream.str(),</div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;      OOMPH_CURRENT_FUNCTION,</div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;      OOMPH_EXCEPTION_LOCATION);</div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;    }</div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;    <span class="comment">//Find the index at which the variable is stored</span></div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;    std::complex&lt;unsigned&gt; complex_u_nodal_index = this-&gt;u_index_helmholtz();</div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;    <span class="keywordtype">unsigned</span> u_nodal_index = 0;</div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;    <span class="keywordflow">if</span> (fld==0)</div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;    {</div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;     u_nodal_index = complex_u_nodal_index.real();</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;    }</div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;    {</div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;     u_nodal_index = complex_u_nodal_index.imag();</div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;    }</div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160; </div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160; </div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;    <span class="comment">//Local shape function</span></div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;    <span class="keywordtype">unsigned</span> n_node=this-&gt;<a class="code" href="classoomph_1_1FiniteElement.html#a6219ed269a6d89b5aa14659cce48905a">nnode</a>();</div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;    <a class="code" href="classoomph_1_1Shape.html">Shape</a> psi(n_node);</div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160; </div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;    <span class="comment">//Find values of shape function</span></div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;    this-&gt;<a class="code" href="classoomph_1_1FiniteElement.html#a58a25b6859ddd43b7bfe64a19fee5023">shape</a>(s,psi);</div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160; </div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;    <span class="comment">//Initialise value of u</span></div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a> = 0.0;</div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160; </div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;    <span class="comment">//Sum over the local nodes</span></div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l=0;l&lt;n_node;l++)</div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;    {</div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;     <a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a> += this-&gt;<a class="code" href="classoomph_1_1FiniteElement.html#a28fd5c2d4aeba5ef65bee0e0d72569f5">nodal_value</a>(t,l,u_nodal_index)*psi[l];</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;    }</div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>;</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;   }</div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160; </div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160; </div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160; </div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;<span class="comment">  ///Return number of values in field fld: One per node</span></div>
<div class="line"><a name="l01172"></a><span class="lineno"><a class="line" href="classoomph_1_1ProjectablePMLHelmholtzElement.html#a08c9eee991edbaff38b8df1682e49a8e"> 1172</a></span>&#160;<span class="comment"></span>  <span class="keywordtype">unsigned</span> <a class="code" href="classoomph_1_1ProjectablePMLHelmholtzElement.html#a08c9eee991edbaff38b8df1682e49a8e">nvalue_of_field</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;fld)</div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;   {</div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;    <span class="keywordflow">if</span> (fld&gt;1)</div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;    {</div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;     std::stringstream error_stream;</div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;     error_stream</div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;PMLHelmholtz elements only store two fields so fld = &quot;</span></div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;      &lt;&lt; fld &lt;&lt; <span class="stringliteral">&quot; is illegal\n&quot;</span>;</div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;     <span class="keywordflow">throw</span> <a class="code" href="classoomph_1_1OomphLibError.html">OomphLibError</a>(</div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;      error_stream.str(),</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;      OOMPH_CURRENT_FUNCTION,</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;      OOMPH_EXCEPTION_LOCATION);</div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;    }</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;    <span class="keywordflow">return</span> this-&gt;<a class="code" href="classoomph_1_1FiniteElement.html#a6219ed269a6d89b5aa14659cce48905a">nnode</a>();</div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;   }</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160; </div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;<span class="comment">  ///Return local equation number of value j in field fld.</span></div>
<div class="line"><a name="l01192"></a><span class="lineno"><a class="line" href="classoomph_1_1ProjectablePMLHelmholtzElement.html#aaa23dc2e79e4185e5ee8665cd69ecc8d"> 1192</a></span>&#160;<span class="comment"></span>  <span class="keywordtype">int</span> <a class="code" href="classoomph_1_1ProjectablePMLHelmholtzElement.html#aaa23dc2e79e4185e5ee8665cd69ecc8d">local_equation</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;fld,</div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;                     <span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;j)</div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;   {</div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;    <span class="keywordflow">if</span> (fld&gt;1)</div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;    {</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;     std::stringstream error_stream;</div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;     error_stream</div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;PMLHelmholtz elements only store two fields so fld = &quot;</span></div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;      &lt;&lt; fld &lt;&lt; <span class="stringliteral">&quot; is illegal\n&quot;</span>;</div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;     <span class="keywordflow">throw</span> <a class="code" href="classoomph_1_1OomphLibError.html">OomphLibError</a>(</div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;      error_stream.str(),</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;      OOMPH_CURRENT_FUNCTION,</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;      OOMPH_EXCEPTION_LOCATION);</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;    }</div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;    std::complex&lt;unsigned&gt; complex_u_nodal_index = this-&gt;u_index_helmholtz();</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;    <span class="keywordtype">unsigned</span> u_nodal_index = 0;</div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;    <span class="keywordflow">if</span> (fld==0)</div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;    {</div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;     u_nodal_index = complex_u_nodal_index.real();</div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;    }</div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;    {</div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;     u_nodal_index = complex_u_nodal_index.imag();</div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;    }</div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;    <span class="keywordflow">return</span> this-&gt;<a class="code" href="classoomph_1_1FiniteElement.html#a5da80bbed97543e586f698251d67941d">nodal_local_eqn</a>(j,u_nodal_index);</div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;   }</div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;<span class="comment">  /// \short Output FE representation of soln: x,y,u or x,y,z,u at</span></div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;<span class="comment">  /// n_plot^DIM plot points</span></div>
<div class="line"><a name="l01223"></a><span class="lineno"><a class="line" href="classoomph_1_1ProjectablePMLHelmholtzElement.html#afc31f9a26ca4d6ac5089ef430139c380"> 1223</a></span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1ProjectablePMLHelmholtzElement.html#afc31f9a26ca4d6ac5089ef430139c380">output</a>(std::ostream &amp;outfile, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;nplot)</div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;   {</div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;    <a class="code" href="namespaceoomph.html#a2473930e2634d673e2a3bed63b6851f0">HELMHOLTZ_ELEMENT::output</a>(outfile,nplot);</div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;   }</div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160; </div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160; </div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160; };</div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160; </div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160; </div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;<span class="comment">//=======================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;<span class="comment">/// Face geometry for element is the same as that for the underlying</span></div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;<span class="comment">/// wrapped element</span></div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;<span class="comment"></span><span class="comment">//=======================================================================</span></div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160; <span class="keyword">template</span>&lt;<span class="keyword">class</span> ELEMENT&gt;</div>
<div class="line"><a name="l01237"></a><span class="lineno"><a class="line" href="classoomph_1_1FaceGeometry_3_01ProjectablePMLHelmholtzElement_3_01ELEMENT_01_4_01_4.html"> 1237</a></span>&#160; <span class="keyword">class </span><a class="code" href="classoomph_1_1FaceGeometry.html">FaceGeometry</a>&lt;<a class="code" href="classoomph_1_1ProjectablePMLHelmholtzElement.html">ProjectablePMLHelmholtzElement</a>&lt;ELEMENT&gt; &gt;</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;  : <span class="keyword">public</span> <span class="keyword">virtual</span> <a class="code" href="classoomph_1_1FaceGeometry.html">FaceGeometry</a>&lt;ELEMENT&gt;</div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160; {</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160; <span class="keyword">public</span>:</div>
<div class="line"><a name="l01241"></a><span class="lineno"><a class="line" href="classoomph_1_1FaceGeometry_3_01ProjectablePMLHelmholtzElement_3_01ELEMENT_01_4_01_4.html#ac68bbbfd50ee9671387ce432a63e166e"> 1241</a></span>&#160;  <a class="code" href="classoomph_1_1FaceGeometry_3_01ProjectablePMLHelmholtzElement_3_01ELEMENT_01_4_01_4.html#ac68bbbfd50ee9671387ce432a63e166e">FaceGeometry</a>() : <a class="code" href="classoomph_1_1FaceGeometry.html">FaceGeometry</a>&lt;ELEMENT&gt;() {}</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160; };</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;<span class="comment">//=======================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;<span class="comment">/// Policy class defining the elements to be used in the actual</span></div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;<span class="comment">/// PML layers. Same!</span></div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;<span class="comment"></span><span class="comment">//=======================================================================</span></div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160; <span class="keyword">template</span>&lt;<span class="keywordtype">unsigned</span> NNODE_1D&gt;</div>
<div class="line"><a name="l01253"></a><span class="lineno"><a class="line" href="classoomph_1_1PMLLayerElement_3_01QPMLHelmholtzElement_3_012_00_01NNODE__1D_01_4_01_4.html"> 1253</a></span>&#160; <span class="keyword">class </span><a class="code" href="classoomph_1_1PMLLayerElement.html">PMLLayerElement</a>&lt;</div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;  <a class="code" href="classoomph_1_1QPMLHelmholtzElement.html">QPMLHelmholtzElement</a>&lt;2,NNODE_1D&gt; &gt; :</div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;  <span class="keyword">public</span> <span class="keyword">virtual</span> <a class="code" href="classoomph_1_1QPMLHelmholtzElement.html">QPMLHelmholtzElement</a>&lt;2,NNODE_1D&gt;</div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160; {</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160; </div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160; <span class="keyword">public</span>:</div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;<span class="comment">  /// \short Constructor: Call the constructor for the</span></div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;<span class="comment">  /// appropriate QElement</span></div>
<div class="line"><a name="l01262"></a><span class="lineno"><a class="line" href="classoomph_1_1PMLLayerElement_3_01QPMLHelmholtzElement_3_012_00_01NNODE__1D_01_4_01_4.html#a50598a6a950fdb028464f5bc8c639dc1"> 1262</a></span>&#160;<span class="comment"></span>  <a class="code" href="classoomph_1_1PMLLayerElement_3_01QPMLHelmholtzElement_3_012_00_01NNODE__1D_01_4_01_4.html#a50598a6a950fdb028464f5bc8c639dc1">PMLLayerElement</a>() :</div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;   <a class="code" href="classoomph_1_1QPMLHelmholtzElement.html">QPMLHelmholtzElement</a>&lt;2,NNODE_1D&gt;()</div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;   {}</div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160; </div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160; };</div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160; </div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;} <span class="comment">// End of Namespace oomph</span></div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160; </div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;<span class="preprocessor">#endif</span></div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="aclassoomph_1_1ProjectablePMLHelmholtzElement_html_afc31f9a26ca4d6ac5089ef430139c380"><div class="ttname"><a href="classoomph_1_1ProjectablePMLHelmholtzElement.html#afc31f9a26ca4d6ac5089ef430139c380">oomph::ProjectablePMLHelmholtzElement::output</a></div><div class="ttdeci">void output(std::ostream &amp;outfile, const unsigned &amp;nplot)</div><div class="ttdoc">Output FE representation of soln: x,y,u or x,y,z,u at n_plot^DIM plot points.</div><div class="ttdef"><b>Definition:</b> <a href="pml__helmholtz__elements_8h_source.html#l01223">pml_helmholtz_elements.h:1223</a></div></div>
<div class="ttc" id="aclassoomph_1_1ProjectablePMLHelmholtzElement_html_a08c9eee991edbaff38b8df1682e49a8e"><div class="ttname"><a href="classoomph_1_1ProjectablePMLHelmholtzElement.html#a08c9eee991edbaff38b8df1682e49a8e">oomph::ProjectablePMLHelmholtzElement::nvalue_of_field</a></div><div class="ttdeci">unsigned nvalue_of_field(const unsigned &amp;fld)</div><div class="ttdoc">Return number of values in field fld: One per node.</div><div class="ttdef"><b>Definition:</b> <a href="pml__helmholtz__elements_8h_source.html#l01172">pml_helmholtz_elements.h:1172</a></div></div>
<div class="ttc" id="aclassoomph_1_1PMLHelmholtzEquations_html_a27edadffabd4df1cdfd0560e0c526882"><div class="ttname"><a href="classoomph_1_1PMLHelmholtzEquations.html#a27edadffabd4df1cdfd0560e0c526882">oomph::PMLHelmholtzEquations::source_fct_pt</a></div><div class="ttdeci">PMLHelmholtzSourceFctPt &amp; source_fct_pt()</div><div class="ttdoc">Access function: Pointer to source function.</div><div class="ttdef"><b>Definition:</b> <a href="pml__helmholtz__elements_8h_source.html#l00399">pml_helmholtz_elements.h:399</a></div></div>
<div class="ttc" id="aclassoomph_1_1FiniteElement_html_ace0e7fb72a805b5c2c600347bfae7a9b"><div class="ttname"><a href="classoomph_1_1FiniteElement.html#ace0e7fb72a805b5c2c600347bfae7a9b">oomph::FiniteElement::node_pt</a></div><div class="ttdeci">Node *&amp; node_pt(const unsigned &amp;n)</div><div class="ttdoc">Return a pointer to the local node n.</div><div class="ttdef"><b>Definition:</b> <a href="elements_8h_source.html#l02122">elements.h:2122</a></div></div>
<div class="ttc" id="aclassoomph_1_1PMLHelmholtzEquations_html_a88ca4602a7152f1723ba85be0fc8eaf6"><div class="ttname"><a href="classoomph_1_1PMLHelmholtzEquations.html#a88ca4602a7152f1723ba85be0fc8eaf6">oomph::PMLHelmholtzEquations::output_real</a></div><div class="ttdeci">void output_real(std::ostream &amp;outfile, const double &amp;phi, const unsigned &amp;n_plot)</div><div class="ttdoc">Output function for real part of full time-dependent solution u = Re( (u_r +i u_i) exp(-i omega t)) a...</div><div class="ttdef"><b>Definition:</b> <a href="pml__helmholtz__elements_8cc_source.html#l00381">pml_helmholtz_elements.cc:381</a></div></div>
<div class="ttc" id="aclassoomph_1_1PMLHelmholtzEquations_html_a1f2e029596dae700c376fe6a9b2d4223"><div class="ttname"><a href="classoomph_1_1PMLHelmholtzEquations.html#a1f2e029596dae700c376fe6a9b2d4223">oomph::PMLHelmholtzEquations::Pml_mapping_pt</a></div><div class="ttdeci">PMLMapping * Pml_mapping_pt</div><div class="ttdoc">Pointer to class which holds the pml mapping function, also known as gamma.</div><div class="ttdef"><b>Definition:</b> <a href="pml__helmholtz__elements_8h_source.html#l00720">pml_helmholtz_elements.h:720</a></div></div>
<div class="ttc" id="aclassoomph_1_1ProjectableElement_html"><div class="ttname"><a href="classoomph_1_1ProjectableElement.html">oomph::ProjectableElement</a></div><div class="ttdef"><b>Definition:</b> <a href="projection_8h_source.html#l00175">projection.h:175</a></div></div>
<div class="ttc" id="athe__data__structure_8txt_html_a5448c72da3359c7796cf0c5f800732a1"><div class="ttname"><a href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a></div><div class="ttdeci">and code FiniteElement::J_eulerian(...) \endcode returns the Jacobian of the mapping from Eulerian coordinates to local coordinates. - The function \c GeneralisedElement c QElement&lt; 3, 2 &gt; is an node brick element with a trilinear mapping between and global coordinates The dimension and the number of c Nodes must be set by calling the appropriate c set_ functions in the see ref set_commands above The most important member functions implemented at this level include Functions that evaluate the shape in terms of the c FiniteElement s coordinates functions that determine whether a c Node is located at a particular coordinate Output functions that allow the element shapes to be plotted we specify a pointer to a spatial integration the default assignment can be over written at a higher level This is discussed in more detail in a&lt; A HREF=&quot;../../optimisation/html/index.html&quot;&gt; separate document&lt;/A &gt; subsubsection Maths_Element we implement the equations that are represented by the specific element We implement the employing either the geometric shape functions that already exist on or employing additional shape functions defined at this level This allows us to write further member functions such as c interpolated_u(...)</div></div>
<div class="ttc" id="aclassoomph_1_1PMLHelmholtzEquations_html_a9756e606bfd0be5ff36f463d1de09b90"><div class="ttname"><a href="classoomph_1_1PMLHelmholtzEquations.html#a9756e606bfd0be5ff36f463d1de09b90">oomph::PMLHelmholtzEquations::get_dof_numbers_for_unknowns</a></div><div class="ttdeci">void get_dof_numbers_for_unknowns(std::list&lt; std::pair&lt; unsigned long, unsigned &gt; &gt; &amp;dof_lookup_list) const</div><div class="ttdoc">Create a list of pairs for all unknowns in this element, so that the first entry in each pair contain...</div><div class="ttdef"><b>Definition:</b> <a href="pml__helmholtz__elements_8h_source.html#l00638">pml_helmholtz_elements.h:638</a></div></div>
<div class="ttc" id="aclassoomph_1_1FiniteElement_html_a5f8fe59f06da1da9f6b7bbcbdb90ef93"><div class="ttname"><a href="classoomph_1_1FiniteElement.html#a5f8fe59f06da1da9f6b7bbcbdb90ef93">oomph::FiniteElement::dim</a></div><div class="ttdeci">unsigned dim() const</div><div class="ttdoc">Return the spatial dimension of the element, i.e. the number of local coordinates required to paramet...</div><div class="ttdef"><b>Definition:</b> <a href="elements_8h_source.html#l02495">elements.h:2495</a></div></div>
<div class="ttc" id="athe__data__structure_8txt_html_a1400a973def57b85051cfe1070be1810"><div class="ttname"><a href="the__data__structure_8txt.html#a1400a973def57b85051cfe1070be1810">residuals</a></div><div class="ttdeci">endcode The default implementation of c the simplest possible implementation of a new element requires only the specification of c we need to know which c Data affects the residuals(and hence the Jacobian matrix). For a \c GeneralisedElement such \c Data exists in two forms</div></div>
<div class="ttc" id="aclassoomph_1_1PMLHelmholtzEquations_html_a069e4a1971a30829c8eabc8527aa663f"><div class="ttname"><a href="classoomph_1_1PMLHelmholtzEquations.html#a069e4a1971a30829c8eabc8527aa663f">oomph::PMLHelmholtzEquations::Source_fct_pt</a></div><div class="ttdeci">PMLHelmholtzSourceFctPt Source_fct_pt</div><div class="ttdoc">Pointer to source function:</div><div class="ttdef"><b>Definition:</b> <a href="pml__helmholtz__elements_8h_source.html#l00714">pml_helmholtz_elements.h:714</a></div></div>
<div class="ttc" id="aclassoomph_1_1PMLHelmholtzEquations_html_a644da4b6bf85b4df7bfcf69beacca3f7"><div class="ttname"><a href="classoomph_1_1PMLHelmholtzEquations.html#a644da4b6bf85b4df7bfcf69beacca3f7">oomph::PMLHelmholtzEquations::scalar_value_fct_paraview</a></div><div class="ttdeci">void scalar_value_fct_paraview(std::ofstream &amp;file_out, const unsigned &amp;i, const unsigned &amp;nplot, FiniteElement::SteadyExactSolutionFctPt exact_soln_pt) const</div><div class="ttdoc">Write values of the i-th scalar field at the plot points. Needs to be implemented for each new specif...</div><div class="ttdef"><b>Definition:</b> <a href="pml__helmholtz__elements_8h_source.html#l00189">pml_helmholtz_elements.h:189</a></div></div>
<div class="ttc" id="aclassoomph_1_1QElement_html"><div class="ttname"><a href="classoomph_1_1QElement.html">oomph::QElement</a></div><div class="ttdef"><b>Definition:</b> <a href="Qelements_8h_source.html#l00481">Qelements.h:481</a></div></div>
<div class="ttc" id="aclassoomph_1_1PMLElementBase_html_a0b0e980998764978801a1f0463a31989"><div class="ttname"><a href="classoomph_1_1PMLElementBase.html#a0b0e980998764978801a1f0463a31989">oomph::PMLElementBase::Pml_is_enabled</a></div><div class="ttdeci">bool Pml_is_enabled</div><div class="ttdoc">Boolean indicating if element is used in pml mode.</div><div class="ttdef"><b>Definition:</b> <a href="pml__meshes_8h_source.html#l00121">pml_meshes.h:121</a></div></div>
<div class="ttc" id="aclassoomph_1_1PMLHelmholtzEquations_html_a6c26381bc4aab3ff5a4e059989778128"><div class="ttname"><a href="classoomph_1_1PMLHelmholtzEquations.html#a6c26381bc4aab3ff5a4e059989778128">oomph::PMLHelmholtzEquations::compute_norm</a></div><div class="ttdeci">void compute_norm(double &amp;norm)</div><div class="ttdoc">Compute norm of fe solution.</div><div class="ttdef"><b>Definition:</b> <a href="pml__helmholtz__elements_8cc_source.html#l00812">pml_helmholtz_elements.cc:812</a></div></div>
<div class="ttc" id="aclassoomph_1_1FiniteElement_html"><div class="ttname"><a href="classoomph_1_1FiniteElement.html">oomph::FiniteElement</a></div><div class="ttdoc">A general Finite Element class.</div><div class="ttdef"><b>Definition:</b> <a href="elements_8h_source.html#l01287">elements.h:1287</a></div></div>
<div class="ttc" id="aclassoomph_1_1PMLHelmholtzEquations_html_a8a428d379ececc74c03bf2a5e12538a5"><div class="ttname"><a href="classoomph_1_1PMLHelmholtzEquations.html#a8a428d379ececc74c03bf2a5e12538a5">oomph::PMLHelmholtzEquations::PMLHelmholtzEquations</a></div><div class="ttdeci">PMLHelmholtzEquations(const PMLHelmholtzEquations &amp;dummy)</div><div class="ttdoc">Broken copy constructor.</div><div class="ttdef"><b>Definition:</b> <a href="pml__helmholtz__elements_8h_source.html#l00083">pml_helmholtz_elements.h:83</a></div></div>
<div class="ttc" id="aclassoomph_1_1OomphLibError_html"><div class="ttname"><a href="classoomph_1_1OomphLibError.html">oomph::OomphLibError</a></div><div class="ttdef"><b>Definition:</b> <a href="oomph__definitions_8h_source.html#l00225">oomph_definitions.h:225</a></div></div>
<div class="ttc" id="aclassoomph_1_1PMLElementBase_html_a7f3365fcb393848b926a836e10a3a288"><div class="ttname"><a href="classoomph_1_1PMLElementBase.html#a7f3365fcb393848b926a836e10a3a288">oomph::PMLElementBase::Pml_outer_boundary</a></div><div class="ttdeci">Vector&lt; double &gt; Pml_outer_boundary</div><div class="ttdoc">Coordinate of outer pml boundary (Storage is provided for any coordinate direction; only the entries ...</div><div class="ttdef"><b>Definition:</b> <a href="pml__meshes_8h_source.html#l00136">pml_meshes.h:136</a></div></div>
<div class="ttc" id="aclassoomph_1_1QPMLHelmholtzElement_html_a63cb39a7b1bd6e381fe837086d42316a"><div class="ttname"><a href="classoomph_1_1QPMLHelmholtzElement.html#a63cb39a7b1bd6e381fe837086d42316a">oomph::QPMLHelmholtzElement::QPMLHelmholtzElement</a></div><div class="ttdeci">QPMLHelmholtzElement()</div><div class="ttdoc">Constructor: Call constructors for QElement and PMLHelmholtz equations.</div><div class="ttdef"><b>Definition:</b> <a href="pml__helmholtz__elements_8h_source.html#l00755">pml_helmholtz_elements.h:755</a></div></div>
<div class="ttc" id="aclassoomph_1_1PMLHelmholtzEquations_html_a2f7c4305049616d71efba341cb9f2074"><div class="ttname"><a href="classoomph_1_1PMLHelmholtzEquations.html#a2f7c4305049616d71efba341cb9f2074">oomph::PMLHelmholtzEquations::dshape_and_dtest_eulerian_helmholtz</a></div><div class="ttdeci">virtual double dshape_and_dtest_eulerian_helmholtz(const Vector&lt; double &gt; &amp;s, Shape &amp;psi, DShape &amp;dpsidx, Shape &amp;test, DShape &amp;dtestdx) const =0</div><div class="ttdoc">Shape/test functions and derivs w.r.t. to global coords at local coord. s; return Jacobian of mapping...</div></div>
<div class="ttc" id="aclassoomph_1_1ProjectablePMLHelmholtzElement_html_a14a5a245ec1fa36c371a3937a3fb4e96"><div class="ttname"><a href="classoomph_1_1ProjectablePMLHelmholtzElement.html#a14a5a245ec1fa36c371a3937a3fb4e96">oomph::ProjectablePMLHelmholtzElement::get_field</a></div><div class="ttdeci">double get_field(const unsigned &amp;t, const unsigned &amp;fld, const Vector&lt; double &gt; &amp;s)</div><div class="ttdoc">Return interpolated field fld at local coordinate s, at time level t (t=0: present; t&gt;0: history valu...</div><div class="ttdef"><b>Definition:</b> <a href="pml__helmholtz__elements_8h_source.html#l01120">pml_helmholtz_elements.h:1120</a></div></div>
<div class="ttc" id="aclassoomph_1_1PMLHelmholtzEquations_html_a156959a72a8a67eccd1b9adf1c888b3e"><div class="ttname"><a href="classoomph_1_1PMLHelmholtzEquations.html#a156959a72a8a67eccd1b9adf1c888b3e">oomph::PMLHelmholtzEquations::pml_mapping_pt</a></div><div class="ttdeci">PMLMapping *&amp; pml_mapping_pt()</div><div class="ttdoc">Return a pointer to the PML Mapping object.</div><div class="ttdef"><b>Definition:</b> <a href="pml__helmholtz__elements_8h_source.html#l00616">pml_helmholtz_elements.h:616</a></div></div>
<div class="ttc" id="aclassoomph_1_1PMLHelmholtzEquations_html_ade525679c4e2d4ad0ba128008cf8e4f0"><div class="ttname"><a href="classoomph_1_1PMLHelmholtzEquations.html#ade525679c4e2d4ad0ba128008cf8e4f0">oomph::PMLHelmholtzEquations::Default_Physical_Constant_Value</a></div><div class="ttdeci">static double Default_Physical_Constant_Value</div><div class="ttdoc">Static default value for the physical constants (initialised to zero)</div><div class="ttdef"><b>Definition:</b> <a href="pml__helmholtz__elements_8h_source.html#l00723">pml_helmholtz_elements.h:723</a></div></div>
<div class="ttc" id="aclassoomph_1_1FiniteElement_html_a5a9c1ead9819cd17603096e63087020f"><div class="ttname"><a href="classoomph_1_1FiniteElement.html#a5a9c1ead9819cd17603096e63087020f">oomph::FiniteElement::interpolated_x</a></div><div class="ttdeci">virtual double interpolated_x(const Vector&lt; double &gt; &amp;s, const unsigned &amp;i) const</div><div class="ttdoc">Return FE interpolated coordinate x[i] at local coordinate s.</div><div class="ttdef"><b>Definition:</b> <a href="elements_8cc_source.html#l03877">elements.cc:3877</a></div></div>
<div class="ttc" id="aclassoomph_1_1FiniteElement_html_a690fd33af26cc3e84f39bba6d5a85202"><div class="ttname"><a href="classoomph_1_1FiniteElement.html#a690fd33af26cc3e84f39bba6d5a85202">oomph::FiniteElement::SteadyExactSolutionFctPt</a></div><div class="ttdeci">void(* SteadyExactSolutionFctPt)(const Vector&lt; double &gt; &amp;, Vector&lt; double &gt; &amp;)</div><div class="ttdoc">Function pointer for function that computes vector-valued steady &quot;exact solution&quot;  as .</div><div class="ttdef"><b>Definition:</b> <a href="elements_8h_source.html#l01736">elements.h:1736</a></div></div>
<div class="ttc" id="aclassoomph_1_1PMLHelmholtzEquations_html_a401e24e48170bd25d6b035a577f3cc62"><div class="ttname"><a href="classoomph_1_1PMLHelmholtzEquations.html#a401e24e48170bd25d6b035a577f3cc62">oomph::PMLHelmholtzEquations::k_squared</a></div><div class="ttdeci">double k_squared()</div><div class="ttdoc">Get the square of wavenumber.</div><div class="ttdef"><b>Definition:</b> <a href="pml__helmholtz__elements_8h_source.html#l00108">pml_helmholtz_elements.h:108</a></div></div>
<div class="ttc" id="aclassoomph_1_1TimeStepper_html_a3939b77ec3578e4bd5b453c85649d631"><div class="ttname"><a href="classoomph_1_1TimeStepper.html#a3939b77ec3578e4bd5b453c85649d631">oomph::TimeStepper::ntstorage</a></div><div class="ttdeci">unsigned ntstorage() const</div><div class="ttdoc">Return the number of doubles required to represent history (one for steady)</div><div class="ttdef"><b>Definition:</b> <a href="timesteppers_8h_source.html#l00558">timesteppers.h:558</a></div></div>
<div class="ttc" id="aclassoomph_1_1PMLHelmholtzEquations_html_a2aabee86a58b5d985a34c9d5c6988306"><div class="ttname"><a href="classoomph_1_1PMLHelmholtzEquations.html#a2aabee86a58b5d985a34c9d5c6988306">oomph::PMLHelmholtzEquations::output_fct</a></div><div class="ttdeci">virtual void output_fct(std::ostream &amp;outfile, const unsigned &amp;n_plot, const double &amp;time, FiniteElement::UnsteadyExactSolutionFctPt exact_soln_pt)</div><div class="ttdoc">Output exact soln: (dummy time-dependent version to keep intel compiler happy)</div><div class="ttdef"><b>Definition:</b> <a href="pml__helmholtz__elements_8h_source.html#l00343">pml_helmholtz_elements.h:343</a></div></div>
<div class="ttc" id="aclassoomph_1_1QPMLHelmholtzElement_html_a3abd5007b3b32a8bad25dd3b1121fb80"><div class="ttname"><a href="classoomph_1_1QPMLHelmholtzElement.html#a3abd5007b3b32a8bad25dd3b1121fb80">oomph::QPMLHelmholtzElement::output_real</a></div><div class="ttdeci">void output_real(std::ostream &amp;outfile, const double &amp;phi, const unsigned &amp;n_plot)</div><div class="ttdoc">Output function for real part of full time-dependent solution u = Re( (u_r +i u_i) exp(-i omega t) at...</div><div class="ttdef"><b>Definition:</b> <a href="pml__helmholtz__elements_8h_source.html#l00794">pml_helmholtz_elements.h:794</a></div></div>
<div class="ttc" id="aclassoomph_1_1QPMLHelmholtzElement_html_a2d0d6f63dd0b16bbe7c43c8cae73d4b5"><div class="ttname"><a href="classoomph_1_1QPMLHelmholtzElement.html#a2d0d6f63dd0b16bbe7c43c8cae73d4b5">oomph::QPMLHelmholtzElement::output</a></div><div class="ttdeci">void output(FILE *file_pt, const unsigned &amp;n_plot)</div><div class="ttdoc">C-style output function: x,y,u or x,y,z,u at n_plot^DIM plot points.</div><div class="ttdef"><b>Definition:</b> <a href="pml__helmholtz__elements_8h_source.html#l00816">pml_helmholtz_elements.h:816</a></div></div>
<div class="ttc" id="aclassoomph_1_1PMLHelmholtzEquations_html_ae56afa0bfd1de461e033a7ecc5a4f895"><div class="ttname"><a href="classoomph_1_1PMLHelmholtzEquations.html#ae56afa0bfd1de461e033a7ecc5a4f895">oomph::PMLHelmholtzEquations::output_fct</a></div><div class="ttdeci">void output_fct(std::ostream &amp;outfile, const unsigned &amp;n_plot, FiniteElement::SteadyExactSolutionFctPt exact_soln_pt)</div><div class="ttdef"><b>Definition:</b> <a href="pml__helmholtz__elements_8cc_source.html#l00567">pml_helmholtz_elements.cc:567</a></div></div>
<div class="ttc" id="aclassoomph_1_1PMLLayerElement_3_01QPMLHelmholtzElement_3_012_00_01NNODE__1D_01_4_01_4_html_a50598a6a950fdb028464f5bc8c639dc1"><div class="ttname"><a href="classoomph_1_1PMLLayerElement_3_01QPMLHelmholtzElement_3_012_00_01NNODE__1D_01_4_01_4.html#a50598a6a950fdb028464f5bc8c639dc1">oomph::PMLLayerElement&lt; QPMLHelmholtzElement&lt; 2, NNODE_1D &gt; &gt;::PMLLayerElement</a></div><div class="ttdeci">PMLLayerElement()</div><div class="ttdoc">Constructor: Call the constructor for the appropriate QElement.</div><div class="ttdef"><b>Definition:</b> <a href="pml__helmholtz__elements_8h_source.html#l01262">pml_helmholtz_elements.h:1262</a></div></div>
<div class="ttc" id="aclassoomph_1_1FiniteElement_html_a9296c17b134688049256a4bbc886df69"><div class="ttname"><a href="classoomph_1_1FiniteElement.html#a9296c17b134688049256a4bbc886df69">oomph::FiniteElement::dshape_eulerian</a></div><div class="ttdeci">double dshape_eulerian(const Vector&lt; double &gt; &amp;s, Shape &amp;psi, DShape &amp;dpsidx) const</div><div class="ttdoc">Compute the geometric shape functions and also first derivatives w.r.t. global coordinates at local c...</div><div class="ttdef"><b>Definition:</b> <a href="elements_8cc_source.html#l03223">elements.cc:3223</a></div></div>
<div class="ttc" id="aclassoomph_1_1PMLHelmholtzEquations_html_a0036936eb0f4f683d91aa6dbd76c9900"><div class="ttname"><a href="classoomph_1_1PMLHelmholtzEquations.html#a0036936eb0f4f683d91aa6dbd76c9900">oomph::PMLHelmholtzEquations::fill_in_contribution_to_jacobian</a></div><div class="ttdeci">void fill_in_contribution_to_jacobian(Vector&lt; double &gt; &amp;residuals, DenseMatrix&lt; double &gt; &amp;jacobian)</div><div class="ttdoc">Add the element's contribution to its residual vector and element Jacobian matrix (wrapper)</div><div class="ttdef"><b>Definition:</b> <a href="pml__helmholtz__elements_8h_source.html#l00488">pml_helmholtz_elements.h:488</a></div></div>
<div class="ttc" id="aclassoomph_1_1PMLHelmholtzEquations_html_a69c8bd10c24571e4058d081ae43dc449"><div class="ttname"><a href="classoomph_1_1PMLHelmholtzEquations.html#a69c8bd10c24571e4058d081ae43dc449">oomph::PMLHelmholtzEquations::alpha_pt</a></div><div class="ttdeci">double *&amp; alpha_pt()</div><div class="ttdoc">Pointer to Alpha, wavenumber complex shift.</div><div class="ttdef"><b>Definition:</b> <a href="pml__helmholtz__elements_8h_source.html#l00126">pml_helmholtz_elements.h:126</a></div></div>
<div class="ttc" id="aclassoomph_1_1PMLHelmholtzEquations_html_a8ee852e8cde8c0f6a399bfc53bb7ad92"><div class="ttname"><a href="classoomph_1_1PMLHelmholtzEquations.html#a8ee852e8cde8c0f6a399bfc53bb7ad92">oomph::PMLHelmholtzEquations::fill_in_contribution_to_residuals</a></div><div class="ttdeci">void fill_in_contribution_to_residuals(Vector&lt; double &gt; &amp;residuals)</div><div class="ttdoc">Add the element's contribution to its residual vector (wrapper)</div><div class="ttdef"><b>Definition:</b> <a href="pml__helmholtz__elements_8h_source.html#l00477">pml_helmholtz_elements.h:477</a></div></div>
<div class="ttc" id="aclassoomph_1_1PMLHelmholtzEquations_html_a8ac463e252c5d20255e810e52f32c6ef"><div class="ttname"><a href="classoomph_1_1PMLHelmholtzEquations.html#a8ac463e252c5d20255e810e52f32c6ef">oomph::PMLHelmholtzEquations::output</a></div><div class="ttdeci">void output(FILE *file_pt)</div><div class="ttdoc">C_style output with default number of plot points.</div><div class="ttdef"><b>Definition:</b> <a href="pml__helmholtz__elements_8h_source.html#l00326">pml_helmholtz_elements.h:326</a></div></div>
<div class="ttc" id="aclassoomph_1_1PMLHelmholtzEquations_html_a90b8967699246bffa58aaf21de5a561e"><div class="ttname"><a href="classoomph_1_1PMLHelmholtzEquations.html#a90b8967699246bffa58aaf21de5a561e">oomph::PMLHelmholtzEquations::PMLHelmholtzEquations</a></div><div class="ttdeci">PMLHelmholtzEquations()</div><div class="ttdoc">Constructor.</div><div class="ttdef"><b>Definition:</b> <a href="pml__helmholtz__elements_8h_source.html#l00073">pml_helmholtz_elements.h:73</a></div></div>
<div class="ttc" id="aclassoomph_1_1DenseMatrix_html"><div class="ttname"><a href="classoomph_1_1DenseMatrix.html">oomph::DenseMatrix&lt; double &gt;</a></div></div>
<div class="ttc" id="aclassoomph_1_1PMLHelmholtzEquations_html_ae7fc8ea11298122c8c30be76b8398ad5"><div class="ttname"><a href="classoomph_1_1PMLHelmholtzEquations.html#ae7fc8ea11298122c8c30be76b8398ad5">oomph::PMLHelmholtzEquations::get_flux</a></div><div class="ttdeci">void get_flux(const Vector&lt; double &gt; &amp;s, Vector&lt; std::complex&lt; double &gt; &gt; &amp;flux) const</div><div class="ttdoc">Get flux: flux[i] = du/dx_i for real and imag part.</div><div class="ttdef"><b>Definition:</b> <a href="pml__helmholtz__elements_8h_source.html#l00439">pml_helmholtz_elements.h:439</a></div></div>
<div class="ttc" id="aclassoomph_1_1FaceGeometry_3_01QPMLHelmholtzElement_3_011_00_01NNODE__1D_01_4_01_4_html_a8656bdcb771bb955fb1dd67eb1849d67"><div class="ttname"><a href="classoomph_1_1FaceGeometry_3_01QPMLHelmholtzElement_3_011_00_01NNODE__1D_01_4_01_4.html#a8656bdcb771bb955fb1dd67eb1849d67">oomph::FaceGeometry&lt; QPMLHelmholtzElement&lt; 1, NNODE_1D &gt; &gt;::FaceGeometry</a></div><div class="ttdeci">FaceGeometry()</div><div class="ttdoc">Constructor: Call the constructor for the appropriate lower-dimensional QElement.</div><div class="ttdef"><b>Definition:</b> <a href="pml__helmholtz__elements_8h_source.html#l00995">pml_helmholtz_elements.h:995</a></div></div>
<div class="ttc" id="aclassoomph_1_1PMLHelmholtzEquations_html_aa03e7e88993070afa6d3fcf9a01cc5d9"><div class="ttname"><a href="classoomph_1_1PMLHelmholtzEquations.html#aa03e7e88993070afa6d3fcf9a01cc5d9">oomph::PMLHelmholtzEquations::pml_mapping_pt</a></div><div class="ttdeci">PMLMapping *const &amp; pml_mapping_pt() const</div><div class="ttdoc">Return a pointer to the PML Mapping object (const version)</div><div class="ttdef"><b>Definition:</b> <a href="pml__helmholtz__elements_8h_source.html#l00619">pml_helmholtz_elements.h:619</a></div></div>
<div class="ttc" id="aclassoomph_1_1PMLHelmholtzEquations_html_a482d11f6ad579f71a796ffc077b0ee81"><div class="ttname"><a href="classoomph_1_1PMLHelmholtzEquations.html#a482d11f6ad579f71a796ffc077b0ee81">oomph::PMLHelmholtzEquations::source_fct_pt</a></div><div class="ttdeci">PMLHelmholtzSourceFctPt source_fct_pt() const</div><div class="ttdoc">Access function: Pointer to source function. Const version.</div><div class="ttdef"><b>Definition:</b> <a href="pml__helmholtz__elements_8h_source.html#l00402">pml_helmholtz_elements.h:402</a></div></div>
<div class="ttc" id="aclassoomph_1_1PMLHelmholtzEquations_html_a2a36f64af504f8836aff147c455f31ac"><div class="ttname"><a href="classoomph_1_1PMLHelmholtzEquations.html#a2a36f64af504f8836aff147c455f31ac">oomph::PMLHelmholtzEquations::u_index_helmholtz</a></div><div class="ttdeci">virtual std::complex&lt; unsigned &gt; u_index_helmholtz() const</div><div class="ttdoc">Broken assignment operator.</div><div class="ttdef"><b>Definition:</b> <a href="pml__helmholtz__elements_8h_source.html#l00100">pml_helmholtz_elements.h:100</a></div></div>
<div class="ttc" id="aclassoomph_1_1PMLMapping_html_a4402061fe7e7b8a1d7a53f990c9a22fb"><div class="ttname"><a href="classoomph_1_1PMLMapping.html#a4402061fe7e7b8a1d7a53f990c9a22fb">oomph::PMLMapping::gamma</a></div><div class="ttdeci">virtual std::complex&lt; double &gt; gamma(const double &amp;nu_i, const double &amp;pml_width_i, const double &amp;wavenumber_squared, const double &amp;alpha_shift=0.0)=0</div><div class="ttdoc">Pure virtual to return Pml mapping gamma, where gamma is the  as function of  where  where h is the v...</div></div>
<div class="ttc" id="aclassoomph_1_1PMLHelmholtzEquations_html_a42f1a2b82fe37e76fb037a06e71f1082"><div class="ttname"><a href="classoomph_1_1PMLHelmholtzEquations.html#a42f1a2b82fe37e76fb037a06e71f1082">oomph::PMLHelmholtzEquations::compute_pml_coefficients</a></div><div class="ttdeci">void compute_pml_coefficients(const unsigned &amp;ipt, const Vector&lt; double &gt; &amp;x, Vector&lt; std::complex&lt; double &gt; &gt; &amp;pml_laplace_factor, std::complex&lt; double &gt; &amp;pml_k_squared_factor)</div><div class="ttdoc">Compute pml coefficients at position x and integration point ipt. pml_laplace_factor is used in the r...</div><div class="ttdef"><b>Definition:</b> <a href="pml__helmholtz__elements_8h_source.html#l00540">pml_helmholtz_elements.h:540</a></div></div>
<div class="ttc" id="aclassoomph_1_1PMLHelmholtzEquations_html_ad01f5a39cc376ab238d2443e39732bcb"><div class="ttname"><a href="classoomph_1_1PMLHelmholtzEquations.html#ad01f5a39cc376ab238d2443e39732bcb">oomph::PMLHelmholtzEquations::nscalar_paraview</a></div><div class="ttdeci">unsigned nscalar_paraview() const</div><div class="ttdoc">Number of scalars/fields output by this element. Reimplements broken virtual function in base class.</div><div class="ttdef"><b>Definition:</b> <a href="pml__helmholtz__elements_8h_source.html#l00131">pml_helmholtz_elements.h:131</a></div></div>
<div class="ttc" id="aclassoomph_1_1ProjectablePMLHelmholtzElement_html_a3af221fe8b94d8a50917c92c3cc94b5d"><div class="ttname"><a href="classoomph_1_1ProjectablePMLHelmholtzElement.html#a3af221fe8b94d8a50917c92c3cc94b5d">oomph::ProjectablePMLHelmholtzElement::nhistory_values_for_coordinate_projection</a></div><div class="ttdeci">unsigned nhistory_values_for_coordinate_projection()</div><div class="ttdoc">Number of positional history values (Note: count includes current value!)</div><div class="ttdef"><b>Definition:</b> <a href="pml__helmholtz__elements_8h_source.html#l01083">pml_helmholtz_elements.h:1083</a></div></div>
<div class="ttc" id="aclassoomph_1_1QPMLHelmholtzElement_html_a37929db1002d8628c4da96be8b9dde96"><div class="ttname"><a href="classoomph_1_1QPMLHelmholtzElement.html#a37929db1002d8628c4da96be8b9dde96">oomph::QPMLHelmholtzElement::output</a></div><div class="ttdeci">void output(FILE *file_pt)</div><div class="ttdoc">C-style output function: x,y,u or x,y,z,u.</div><div class="ttdef"><b>Definition:</b> <a href="pml__helmholtz__elements_8h_source.html#l00810">pml_helmholtz_elements.h:810</a></div></div>
<div class="ttc" id="aclassoomph_1_1QPMLHelmholtzElement_html_a951f66c2e2286d54068ceb4e70f4cf1b"><div class="ttname"><a href="classoomph_1_1QPMLHelmholtzElement.html#a951f66c2e2286d54068ceb4e70f4cf1b">oomph::QPMLHelmholtzElement::required_nvalue</a></div><div class="ttdeci">unsigned required_nvalue(const unsigned &amp;n) const</div><div class="ttdoc">Broken assignment operator.</div><div class="ttdef"><b>Definition:</b> <a href="pml__helmholtz__elements_8h_source.html#l00775">pml_helmholtz_elements.h:775</a></div></div>
<div class="ttc" id="acfortran_8h_html_af6f0bd3dc13317f895c91323c25c2b8f"><div class="ttname"><a href="cfortran_8h.html#af6f0bd3dc13317f895c91323c25c2b8f">t</a></div><div class="ttdeci">char t</div><div class="ttdef"><b>Definition:</b> <a href="cfortran_8h_source.html#l00568">cfortran.h:568</a></div></div>
<div class="ttc" id="anamespaceoomph_1_1BrokenCopy_html_a7e5cd7fda8b8c790003151bee77a84ac"><div class="ttname"><a href="namespaceoomph_1_1BrokenCopy.html#a7e5cd7fda8b8c790003151bee77a84ac">oomph::BrokenCopy::broken_copy</a></div><div class="ttdeci">void broken_copy(const std::string &amp;class_name)</div><div class="ttdoc">Issue error message and terminate execution.</div><div class="ttdef"><b>Definition:</b> <a href="oomph__utilities_8cc_source.html#l00214">oomph_utilities.cc:214</a></div></div>
<div class="ttc" id="aclassoomph_1_1FiniteElement_html_a82da844fd3ebb2005842464cdc148a03"><div class="ttname"><a href="classoomph_1_1FiniteElement.html#a82da844fd3ebb2005842464cdc148a03">oomph::FiniteElement::get_s_plot</a></div><div class="ttdeci">virtual void get_s_plot(const unsigned &amp;i, const unsigned &amp;nplot, Vector&lt; double &gt; &amp;s, const bool &amp;shifted_to_interior=false) const</div><div class="ttdoc">Get cector of local coordinates of plot point i (when plotting nplot points in each &quot;coordinate direc...</div><div class="ttdef"><b>Definition:</b> <a href="elements_8h_source.html#l03006">elements.h:3006</a></div></div>
<div class="ttc" id="aclassoomph_1_1QPMLHelmholtzElement_html"><div class="ttname"><a href="classoomph_1_1QPMLHelmholtzElement.html">oomph::QPMLHelmholtzElement</a></div><div class="ttdoc">QPMLHelmholtzElement elements are linear/quadrilateral/ brick-shaped PMLHelmholtz elements with isopa...</div><div class="ttdef"><b>Definition:</b> <a href="pml__helmholtz__elements_8h_source.html#l00740">pml_helmholtz_elements.h:740</a></div></div>
<div class="ttc" id="aclassoomph_1_1QPMLHelmholtzElement_html_a436860ac0bf4df77d0359cd9edea4b18"><div class="ttname"><a href="classoomph_1_1QPMLHelmholtzElement.html#a436860ac0bf4df77d0359cd9edea4b18">oomph::QPMLHelmholtzElement::output_imag</a></div><div class="ttdeci">void output_imag(std::ostream &amp;outfile, const double &amp;phi, const unsigned &amp;n_plot)</div><div class="ttdoc">Output function for imaginary part of full time-dependent solution u = Im( (u_r +i u_i) exp(-i omega ...</div><div class="ttdef"><b>Definition:</b> <a href="pml__helmholtz__elements_8h_source.html#l00803">pml_helmholtz_elements.h:803</a></div></div>
<div class="ttc" id="aclassoomph_1_1ProjectablePMLHelmholtzElement_html_aaa23dc2e79e4185e5ee8665cd69ecc8d"><div class="ttname"><a href="classoomph_1_1ProjectablePMLHelmholtzElement.html#aaa23dc2e79e4185e5ee8665cd69ecc8d">oomph::ProjectablePMLHelmholtzElement::local_equation</a></div><div class="ttdeci">int local_equation(const unsigned &amp;fld, const unsigned &amp;j)</div><div class="ttdoc">Return local equation number of value j in field fld.</div><div class="ttdef"><b>Definition:</b> <a href="pml__helmholtz__elements_8h_source.html#l01192">pml_helmholtz_elements.h:1192</a></div></div>
<div class="ttc" id="aclassoomph_1_1GeneralisedElement_html_a4bff11b8ff97aefabb2df41e61e1779f"><div class="ttname"><a href="classoomph_1_1GeneralisedElement.html#a4bff11b8ff97aefabb2df41e61e1779f">oomph::GeneralisedElement::Dummy_matrix</a></div><div class="ttdeci">static DenseMatrix&lt; double &gt; Dummy_matrix</div><div class="ttdoc">Empty dense matrix used as a dummy argument to combined residual and jacobian functions in the case w...</div><div class="ttdef"><b>Definition:</b> <a href="elements_8h_source.html#l00224">elements.h:224</a></div></div>
<div class="ttc" id="aclassoomph_1_1QPMLHelmholtzElement_html_ad63b4b8965a17ea8f5df8e6ec6d5ce9b"><div class="ttname"><a href="classoomph_1_1QPMLHelmholtzElement.html#ad63b4b8965a17ea8f5df8e6ec6d5ce9b">oomph::QPMLHelmholtzElement::output_imag_fct</a></div><div class="ttdeci">void output_imag_fct(std::ostream &amp;outfile, const double &amp;phi, const unsigned &amp;n_plot, FiniteElement::SteadyExactSolutionFctPt exact_soln_pt)</div><div class="ttdoc">Output function for imaginary part of full time-dependent fct u = Im( (u_r +i u_i) exp(-i omega t)) a...</div><div class="ttdef"><b>Definition:</b> <a href="pml__helmholtz__elements_8h_source.html#l00850">pml_helmholtz_elements.h:850</a></div></div>
<div class="ttc" id="aclassoomph_1_1FiniteElement_html_ad4ecf2b61b158a4b4d351a60d23c633e"><div class="ttname"><a href="classoomph_1_1FiniteElement.html#ad4ecf2b61b158a4b4d351a60d23c633e">oomph::FiniteElement::UnsteadyExactSolutionFctPt</a></div><div class="ttdeci">void(* UnsteadyExactSolutionFctPt)(const double &amp;, const Vector&lt; double &gt; &amp;, Vector&lt; double &gt; &amp;)</div><div class="ttdoc">Function pointer for function that computes Vector-valued time-dependent function  as .</div><div class="ttdef"><b>Definition:</b> <a href="elements_8h_source.html#l01742">elements.h:1742</a></div></div>
<div class="ttc" id="aclassoomph_1_1GeneralisedElement_html_a37ac5a1d5234fa931ab710c0c74d55d2"><div class="ttname"><a href="classoomph_1_1GeneralisedElement.html#a37ac5a1d5234fa931ab710c0c74d55d2">oomph::GeneralisedElement::eqn_number</a></div><div class="ttdeci">unsigned long eqn_number(const unsigned &amp;ieqn_local) const</div><div class="ttdoc">Return the global equation number corresponding to the ieqn_local-th local equation number.</div><div class="ttdef"><b>Definition:</b> <a href="elements_8h_source.html#l00705">elements.h:705</a></div></div>
<div class="ttc" id="aclassoomph_1_1QPMLHelmholtzElement_html_a6d39a3233c4b8b25ce007d7650421287"><div class="ttname"><a href="classoomph_1_1QPMLHelmholtzElement.html#a6d39a3233c4b8b25ce007d7650421287">oomph::QPMLHelmholtzElement::dshape_and_dtest_eulerian_helmholtz</a></div><div class="ttdeci">double dshape_and_dtest_eulerian_helmholtz(const Vector&lt; double &gt; &amp;s, Shape &amp;psi, DShape &amp;dpsidx, Shape &amp;test, DShape &amp;dtestdx) const</div><div class="ttdoc">Shape, test functions &amp; derivs. w.r.t. to global coords. Return Jacobian.</div><div class="ttdef"><b>Definition:</b> <a href="pml__helmholtz__elements_8h_source.html#l00905">pml_helmholtz_elements.h:905</a></div></div>
<div class="ttc" id="aclassoomph_1_1PMLHelmholtzEquations_html_a9316a71cecd3c6c26ee6ab273800d3ec"><div class="ttname"><a href="classoomph_1_1PMLHelmholtzEquations.html#a9316a71cecd3c6c26ee6ab273800d3ec">oomph::PMLHelmholtzEquations::PMLHelmholtzSourceFctPt</a></div><div class="ttdeci">void(* PMLHelmholtzSourceFctPt)(const Vector&lt; double &gt; &amp;x, std::complex&lt; double &gt; &amp;f)</div><div class="ttdoc">Function pointer to source function fct(x,f(x))  x is a Vector!</div><div class="ttdef"><b>Definition:</b> <a href="pml__helmholtz__elements_8h_source.html#l00069">pml_helmholtz_elements.h:69</a></div></div>
<div class="ttc" id="aclassoomph_1_1PMLHelmholtzEquations_html_ab2fa1d02ac3fa90ba66b76f868e0d3b4"><div class="ttname"><a href="classoomph_1_1PMLHelmholtzEquations.html#ab2fa1d02ac3fa90ba66b76f868e0d3b4">oomph::PMLHelmholtzEquations::compute_error</a></div><div class="ttdeci">void compute_error(std::ostream &amp;outfile, FiniteElement::SteadyExactSolutionFctPt exact_soln_pt, double &amp;error, double &amp;norm)</div><div class="ttdoc">Get error against and norm of exact solution.</div><div class="ttdef"><b>Definition:</b> <a href="pml__helmholtz__elements_8cc_source.html#l00731">pml_helmholtz_elements.cc:731</a></div></div>
<div class="ttc" id="anamespaceoomph_html"><div class="ttname"><a href="namespaceoomph.html">oomph</a></div><div class="ttdoc">DRAIG: Change all instances of (SPATIAL_DIM) to (DIM-1).</div><div class="ttdef"><b>Definition:</b> <a href="advection__diffusion__elements_8cc_source.html#l00029">advection_diffusion_elements.cc:29</a></div></div>
<div class="ttc" id="aclassoomph_1_1QPMLHelmholtzElement_html_a243a9941c4268cd9d1d947ad08e9cddf"><div class="ttname"><a href="classoomph_1_1QPMLHelmholtzElement.html#a243a9941c4268cd9d1d947ad08e9cddf">oomph::QPMLHelmholtzElement::Initial_Nvalue</a></div><div class="ttdeci">static const unsigned Initial_Nvalue</div><div class="ttdoc">Static int that holds the number of variables at nodes: always the same.</div><div class="ttdef"><b>Definition:</b> <a href="pml__helmholtz__elements_8h_source.html#l00748">pml_helmholtz_elements.h:748</a></div></div>
<div class="ttc" id="aclassoomph_1_1FiniteElement_html_a6219ed269a6d89b5aa14659cce48905a"><div class="ttname"><a href="classoomph_1_1FiniteElement.html#a6219ed269a6d89b5aa14659cce48905a">oomph::FiniteElement::nnode</a></div><div class="ttdeci">unsigned nnode() const</div><div class="ttdoc">Return the number of nodes.</div><div class="ttdef"><b>Definition:</b> <a href="elements_8h_source.html#l02159">elements.h:2159</a></div></div>
<div class="ttc" id="aclassoomph_1_1FaceGeometry_3_01ProjectablePMLHelmholtzElement_3_01ELEMENT_01_4_01_4_html_ac68bbbfd50ee9671387ce432a63e166e"><div class="ttname"><a href="classoomph_1_1FaceGeometry_3_01ProjectablePMLHelmholtzElement_3_01ELEMENT_01_4_01_4.html#ac68bbbfd50ee9671387ce432a63e166e">oomph::FaceGeometry&lt; ProjectablePMLHelmholtzElement&lt; ELEMENT &gt; &gt;::FaceGeometry</a></div><div class="ttdeci">FaceGeometry()</div><div class="ttdef"><b>Definition:</b> <a href="pml__helmholtz__elements_8h_source.html#l01241">pml_helmholtz_elements.h:1241</a></div></div>
<div class="ttc" id="aclassoomph_1_1ProjectablePMLHelmholtzElement_html"><div class="ttname"><a href="classoomph_1_1ProjectablePMLHelmholtzElement.html">oomph::ProjectablePMLHelmholtzElement</a></div><div class="ttdoc">PMLHelmholtz upgraded to become projectable.</div><div class="ttdef"><b>Definition:</b> <a href="pml__helmholtz__elements_8h_source.html#l01009">pml_helmholtz_elements.h:1009</a></div></div>
<div class="ttc" id="aclassoomph_1_1PMLHelmholtzEquations_html_ade29ee33fc008a0ff318f34f43014724"><div class="ttname"><a href="classoomph_1_1PMLHelmholtzEquations.html#ade29ee33fc008a0ff318f34f43014724">oomph::PMLHelmholtzEquations::output_imag</a></div><div class="ttdeci">void output_imag(std::ostream &amp;outfile, const double &amp;phi, const unsigned &amp;n_plot)</div><div class="ttdoc">Output function for imaginary part of full time-dependent solution u = Im( (u_r +i u_i) exp(-i omega ...</div><div class="ttdef"><b>Definition:</b> <a href="pml__helmholtz__elements_8cc_source.html#l00482">pml_helmholtz_elements.cc:482</a></div></div>
<div class="ttc" id="aclassoomph_1_1Vector_html"><div class="ttname"><a href="classoomph_1_1Vector.html">oomph::Vector&lt; double &gt;</a></div></div>
<div class="ttc" id="aclassoomph_1_1PMLHelmholtzEquations_html_a8d5428a705d254ffb7e448cac84538ba"><div class="ttname"><a href="classoomph_1_1PMLHelmholtzEquations.html#a8d5428a705d254ffb7e448cac84538ba">oomph::PMLHelmholtzEquations::Default_pml_mapping</a></div><div class="ttdeci">static BermudezPMLMapping Default_pml_mapping</div><div class="ttdef"><b>Definition:</b> <a href="pml__helmholtz__elements_8h_source.html#l00623">pml_helmholtz_elements.h:623</a></div></div>
<div class="ttc" id="aclassoomph_1_1ProjectablePMLHelmholtzElement_html_a7bae5d4f8a8716c9db2119094f9f08bc"><div class="ttname"><a href="classoomph_1_1ProjectablePMLHelmholtzElement.html#a7bae5d4f8a8716c9db2119094f9f08bc">oomph::ProjectablePMLHelmholtzElement::data_values_of_field</a></div><div class="ttdeci">Vector&lt; std::pair&lt; Data *, unsigned &gt; &gt; data_values_of_field(const unsigned &amp;fld)</div><div class="ttdoc">Specify the values associated with field fld. The information is returned in a vector of pairs which ...</div><div class="ttdef"><b>Definition:</b> <a href="pml__helmholtz__elements_8h_source.html#l01023">pml_helmholtz_elements.h:1023</a></div></div>
<div class="ttc" id="aclassoomph_1_1FaceGeometry_3_01QPMLHelmholtzElement_3_01DIM_00_01NNODE__1D_01_4_01_4_html_ae2c09ca30f694a462a56b47ff6913398"><div class="ttname"><a href="classoomph_1_1FaceGeometry_3_01QPMLHelmholtzElement_3_01DIM_00_01NNODE__1D_01_4_01_4.html#ae2c09ca30f694a462a56b47ff6913398">oomph::FaceGeometry&lt; QPMLHelmholtzElement&lt; DIM, NNODE_1D &gt; &gt;::FaceGeometry</a></div><div class="ttdeci">FaceGeometry()</div><div class="ttdoc">Constructor: Call the constructor for the appropriate lower-dimensional QElement.</div><div class="ttdef"><b>Definition:</b> <a href="pml__helmholtz__elements_8h_source.html#l00973">pml_helmholtz_elements.h:973</a></div></div>
<div class="ttc" id="aclassoomph_1_1QPMLHelmholtzElement_html_a76aeac6f55eb83e97fd862d7bc581477"><div class="ttname"><a href="classoomph_1_1QPMLHelmholtzElement.html#a76aeac6f55eb83e97fd862d7bc581477">oomph::QPMLHelmholtzElement::output_real_fct</a></div><div class="ttdeci">void output_real_fct(std::ostream &amp;outfile, const double &amp;phi, const unsigned &amp;n_plot, FiniteElement::SteadyExactSolutionFctPt exact_soln_pt)</div><div class="ttdoc">Output function for real part of full time-dependent fct u = Re( (u_r +i u_i) exp(-i omega t) at phas...</div><div class="ttdef"><b>Definition:</b> <a href="pml__helmholtz__elements_8h_source.html#l00834">pml_helmholtz_elements.h:834</a></div></div>
<div class="ttc" id="aclassoomph_1_1FiniteElement_html_a58a25b6859ddd43b7bfe64a19fee5023"><div class="ttname"><a href="classoomph_1_1FiniteElement.html#a58a25b6859ddd43b7bfe64a19fee5023">oomph::FiniteElement::shape</a></div><div class="ttdeci">virtual void shape(const Vector&lt; double &gt; &amp;s, Shape &amp;psi) const =0</div><div class="ttdoc">Calculate the geometric shape functions at local coordinate s. This function must be overloaded for e...</div></div>
<div class="ttc" id="aclassoomph_1_1ProjectablePMLHelmholtzElement_html_a5b0bad4b386bf0d31aeccb963e0814a0"><div class="ttname"><a href="classoomph_1_1ProjectablePMLHelmholtzElement.html#a5b0bad4b386bf0d31aeccb963e0814a0">oomph::ProjectablePMLHelmholtzElement::nhistory_values_for_projection</a></div><div class="ttdeci">unsigned nhistory_values_for_projection(const unsigned &amp;fld)</div><div class="ttdoc">Number of history values to be stored for fld-th field. (Note: count includes current value!...</div><div class="ttdef"><b>Definition:</b> <a href="pml__helmholtz__elements_8h_source.html#l01063">pml_helmholtz_elements.h:1063</a></div></div>
<div class="ttc" id="aclassoomph_1_1QPMLHelmholtzElement_html_a11cffc61d0cf6cac32ffb004d26d836c"><div class="ttname"><a href="classoomph_1_1QPMLHelmholtzElement.html#a11cffc61d0cf6cac32ffb004d26d836c">oomph::QPMLHelmholtzElement::output_fct</a></div><div class="ttdeci">void output_fct(std::ostream &amp;outfile, const unsigned &amp;n_plot, const double &amp;time, FiniteElement::UnsteadyExactSolutionFctPt exact_soln_pt)</div><div class="ttdoc">Output function for a time-dependent exact solution. x,y,u_exact or x,y,z,u_exact at n_plot^DIM plot ...</div><div class="ttdef"><b>Definition:</b> <a href="pml__helmholtz__elements_8h_source.html#l00865">pml_helmholtz_elements.h:865</a></div></div>
<div class="ttc" id="aclassoomph_1_1BermudezPMLMapping_html"><div class="ttname"><a href="classoomph_1_1BermudezPMLMapping.html">oomph::BermudezPMLMapping</a></div><div class="ttdef"><b>Definition:</b> <a href="pml__mapping__functions_8h_source.html#l00068">pml_mapping_functions.h:68</a></div></div>
<div class="ttc" id="acfortran_8h_html_adb50e893b86b3e55e751a42eab3cba82"><div class="ttname"><a href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a></div><div class="ttdeci">cstr elem_len * i</div><div class="ttdef"><b>Definition:</b> <a href="cfortran_8h_source.html#l00603">cfortran.h:603</a></div></div>
<div class="ttc" id="aclassoomph_1_1PMLHelmholtzEquations_html_ab1a6fa3fb13973c597e8faeb1ff4b2e1"><div class="ttname"><a href="classoomph_1_1PMLHelmholtzEquations.html#ab1a6fa3fb13973c597e8faeb1ff4b2e1">oomph::PMLHelmholtzEquations::alpha</a></div><div class="ttdeci">const double &amp; alpha() const</div><div class="ttdoc">Alpha, wavenumber complex shift.</div><div class="ttdef"><b>Definition:</b> <a href="pml__helmholtz__elements_8h_source.html#l00123">pml_helmholtz_elements.h:123</a></div></div>
<div class="ttc" id="aclassoomph_1_1Data_html_a9752205c5fb3bb886200b3fae9181e94"><div class="ttname"><a href="classoomph_1_1Data.html#a9752205c5fb3bb886200b3fae9181e94">oomph::Data::ntstorage</a></div><div class="ttdeci">unsigned ntstorage() const</div><div class="ttdoc">Return total number of doubles stored per value to record time history of each value (one for steady ...</div><div class="ttdef"><b>Definition:</b> <a href="nodes_8cc_source.html#l00843">nodes.cc:843</a></div></div>
<div class="ttc" id="aclassoomph_1_1QPMLHelmholtzElement_html_a478b379a92507b5ddf6de3ff91257695"><div class="ttname"><a href="classoomph_1_1QPMLHelmholtzElement.html#a478b379a92507b5ddf6de3ff91257695">oomph::QPMLHelmholtzElement::dshape_and_dtest_eulerian_at_knot_helmholtz</a></div><div class="ttdeci">double dshape_and_dtest_eulerian_at_knot_helmholtz(const unsigned &amp;ipt, Shape &amp;psi, DShape &amp;dpsidx, Shape &amp;test, DShape &amp;dtestdx) const</div><div class="ttdoc">Shape, test functions &amp; derivs. w.r.t. to global coords. at integration point ipt....</div><div class="ttdef"><b>Definition:</b> <a href="pml__helmholtz__elements_8h_source.html#l00934">pml_helmholtz_elements.h:934</a></div></div>
<div class="ttc" id="aclassoomph_1_1Node_html_a89175b154594ba5b1a6cdde6f385dc71"><div class="ttname"><a href="classoomph_1_1Node.html#a89175b154594ba5b1a6cdde6f385dc71">oomph::Node::position_time_stepper_pt</a></div><div class="ttdeci">TimeStepper *&amp; position_time_stepper_pt()</div><div class="ttdoc">Return a pointer to the position timestepper.</div><div class="ttdef"><b>Definition:</b> <a href="nodes_8h_source.html#l00964">nodes.h:964</a></div></div>
<div class="ttc" id="aclassoomph_1_1DShape_html"><div class="ttname"><a href="classoomph_1_1DShape.html">oomph::DShape</a></div><div class="ttdef"><b>Definition:</b> <a href="shape_8h_source.html#l00271">shape.h:271</a></div></div>
<div class="ttc" id="aclassoomph_1_1PMLElementBase_html"><div class="ttname"><a href="classoomph_1_1PMLElementBase.html">oomph::PMLElementBase</a></div><div class="ttdoc">Base class for elements with pml capabilities.</div><div class="ttdef"><b>Definition:</b> <a href="pml__meshes_8h_source.html#l00061">pml_meshes.h:61</a></div></div>
<div class="ttc" id="aclassoomph_1_1PMLHelmholtzEquations_html_a9cf611c517509c8b2bc5c76d89d3da91"><div class="ttname"><a href="classoomph_1_1PMLHelmholtzEquations.html#a9cf611c517509c8b2bc5c76d89d3da91">oomph::PMLHelmholtzEquations::Alpha_pt</a></div><div class="ttdeci">double * Alpha_pt</div><div class="ttdoc">Pointer to wavenumber complex shift.</div><div class="ttdef"><b>Definition:</b> <a href="pml__helmholtz__elements_8h_source.html#l00711">pml_helmholtz_elements.h:711</a></div></div>
<div class="ttc" id="aclassoomph_1_1QPMLHelmholtzElement_html_ab8c2433419a29ea74346fe35072d6933"><div class="ttname"><a href="classoomph_1_1QPMLHelmholtzElement.html#ab8c2433419a29ea74346fe35072d6933">oomph::QPMLHelmholtzElement::output</a></div><div class="ttdeci">void output(std::ostream &amp;outfile)</div><div class="ttdoc">Output function: x,y,u or x,y,z,u.</div><div class="ttdef"><b>Definition:</b> <a href="pml__helmholtz__elements_8h_source.html#l00780">pml_helmholtz_elements.h:780</a></div></div>
<div class="ttc" id="aclassoomph_1_1PMLHelmholtzEquations_html_a11b6be67faf29eaf1f20405e43c4afe9"><div class="ttname"><a href="classoomph_1_1PMLHelmholtzEquations.html#a11b6be67faf29eaf1f20405e43c4afe9">oomph::PMLHelmholtzEquations::fill_in_generic_residual_contribution_helmholtz</a></div><div class="ttdeci">virtual void fill_in_generic_residual_contribution_helmholtz(Vector&lt; double &gt; &amp;residuals, DenseMatrix&lt; double &gt; &amp;jacobian, const unsigned &amp;flag)</div><div class="ttdoc">Compute element residual Vector only (if flag=and/or element Jacobian matrix.</div><div class="ttdef"><b>Definition:</b> <a href="pml__helmholtz__elements_8cc_source.html#l00055">pml_helmholtz_elements.cc:55</a></div></div>
<div class="ttc" id="anamespaceoomph_html_a2473930e2634d673e2a3bed63b6851f0"><div class="ttname"><a href="namespaceoomph.html#a2473930e2634d673e2a3bed63b6851f0">oomph::output</a></div><div class="ttdeci">void output(std::ostream &amp;outfile)</div><div class="ttdoc">Output with default number of plot points.</div><div class="ttdef"><b>Definition:</b> <a href="gen__axisym__advection__diffusion__elements_8h_source.html#l00160">gen_axisym_advection_diffusion_elements.h:160</a></div></div>
<div class="ttc" id="aclassoomph_1_1PMLMapping_html"><div class="ttname"><a href="classoomph_1_1PMLMapping.html">oomph::PMLMapping</a></div><div class="ttdef"><b>Definition:</b> <a href="pml__mapping__functions_8h_source.html#l00045">pml_mapping_functions.h:45</a></div></div>
<div class="ttc" id="athe__data__structure_8txt_html_af88b2d950fae19ab641bd1690e08445c"><div class="ttname"><a href="the__data__structure_8txt.html#af88b2d950fae19ab641bd1690e08445c">n</a></div><div class="ttdeci">endcode We introduce wrapper functions to access function so that we can formulate The Maths in generic terms Rather than referring to the pressure at node c n</div><div class="ttdef"><b>Definition:</b> <a href="the__data__structure_8txt_source.html#l00582">the_data_structure.txt:582</a></div></div>
<div class="ttc" id="aclassoomph_1_1QPMLHelmholtzElement_html_aa61e5de6798f150e1dc720a955944b86"><div class="ttname"><a href="classoomph_1_1QPMLHelmholtzElement.html#aa61e5de6798f150e1dc720a955944b86">oomph::QPMLHelmholtzElement::output_fct</a></div><div class="ttdeci">void output_fct(std::ostream &amp;outfile, const unsigned &amp;n_plot, FiniteElement::SteadyExactSolutionFctPt exact_soln_pt)</div><div class="ttdoc">Output function for an exact solution: x,y,u_exact or x,y,z,u_exact at n_plot^DIM plot points.</div><div class="ttdef"><b>Definition:</b> <a href="pml__helmholtz__elements_8h_source.html#l00822">pml_helmholtz_elements.h:822</a></div></div>
<div class="ttc" id="aclassoomph_1_1FiniteElement_html_a5da80bbed97543e586f698251d67941d"><div class="ttname"><a href="classoomph_1_1FiniteElement.html#a5da80bbed97543e586f698251d67941d">oomph::FiniteElement::nodal_local_eqn</a></div><div class="ttdeci">int nodal_local_eqn(const unsigned &amp;n, const unsigned &amp;i) const</div><div class="ttdoc">Return the local equation number corresponding to the i-th value at the n-th local node.</div><div class="ttdef"><b>Definition:</b> <a href="elements_8h_source.html#l01399">elements.h:1399</a></div></div>
<div class="ttc" id="aclassoomph_1_1PMLHelmholtzEquations_html"><div class="ttname"><a href="classoomph_1_1PMLHelmholtzEquations.html">oomph::PMLHelmholtzEquations</a></div><div class="ttdef"><b>Definition:</b> <a href="pml__helmholtz__elements_8h_source.html#l00061">pml_helmholtz_elements.h:61</a></div></div>
<div class="ttc" id="aclassoomph_1_1PMLHelmholtzEquations_html_aa9470aba0c301c8d98281cd3a7bf046e"><div class="ttname"><a href="classoomph_1_1PMLHelmholtzEquations.html#aa9470aba0c301c8d98281cd3a7bf046e">oomph::PMLHelmholtzEquations::k_squared_pt</a></div><div class="ttdeci">double *&amp; k_squared_pt()</div><div class="ttdoc">Get pointer to k_squared.</div><div class="ttdef"><b>Definition:</b> <a href="pml__helmholtz__elements_8h_source.html#l00104">pml_helmholtz_elements.h:104</a></div></div>
<div class="ttc" id="aclassoomph_1_1PMLLayerElement_html"><div class="ttname"><a href="classoomph_1_1PMLLayerElement.html">oomph::PMLLayerElement</a></div><div class="ttdef"><b>Definition:</b> <a href="pml__meshes_8h_source.html#l00048">pml_meshes.h:48</a></div></div>
<div class="ttc" id="aclassoomph_1_1GeneralisedElement_html_a3d46b71d27f94aeba21aff1ef84fd0a6"><div class="ttname"><a href="classoomph_1_1GeneralisedElement.html#a3d46b71d27f94aeba21aff1ef84fd0a6">oomph::GeneralisedElement::local_eqn_number</a></div><div class="ttdeci">int local_eqn_number(const unsigned long &amp;ieqn_global) const</div><div class="ttdoc">Return the local equation number corresponding to the ieqn_global-th global equation number....</div><div class="ttdef"><b>Definition:</b> <a href="elements_8h_source.html#l00727">elements.h:727</a></div></div>
<div class="ttc" id="aclassoomph_1_1ProjectablePMLHelmholtzElement_html_aa4af5bb878fed3d1b286bde1da0f5419"><div class="ttname"><a href="classoomph_1_1ProjectablePMLHelmholtzElement.html#aa4af5bb878fed3d1b286bde1da0f5419">oomph::ProjectablePMLHelmholtzElement::jacobian_and_shape_of_field</a></div><div class="ttdeci">double jacobian_and_shape_of_field(const unsigned &amp;fld, const Vector&lt; double &gt; &amp;s, Shape &amp;psi)</div><div class="ttdoc">Return Jacobian of mapping and shape functions of field fld at local coordinate s.</div><div class="ttdef"><b>Definition:</b> <a href="pml__helmholtz__elements_8h_source.html#l01090">pml_helmholtz_elements.h:1090</a></div></div>
<div class="ttc" id="aclassoomph_1_1PMLHelmholtzEquations_html_a1b6f4cae7b6ee3a1cce7253912b1acb0"><div class="ttname"><a href="classoomph_1_1PMLHelmholtzEquations.html#a1b6f4cae7b6ee3a1cce7253912b1acb0">oomph::PMLHelmholtzEquations::output</a></div><div class="ttdeci">void output(std::ostream &amp;outfile)</div><div class="ttdoc">Output with default number of plot points.</div><div class="ttdef"><b>Definition:</b> <a href="pml__helmholtz__elements_8h_source.html#l00286">pml_helmholtz_elements.h:286</a></div></div>
<div class="ttc" id="aclassoomph_1_1ProjectablePMLHelmholtzElement_html_a005f750d15074893d3ac428b49f2318d"><div class="ttname"><a href="classoomph_1_1ProjectablePMLHelmholtzElement.html#a005f750d15074893d3ac428b49f2318d">oomph::ProjectablePMLHelmholtzElement::ProjectablePMLHelmholtzElement</a></div><div class="ttdeci">ProjectablePMLHelmholtzElement()</div><div class="ttdoc">Constructor [this was only required explicitly from gcc 4.5.2 onwards...].</div><div class="ttdef"><b>Definition:</b> <a href="pml__helmholtz__elements_8h_source.html#l01018">pml_helmholtz_elements.h:1018</a></div></div>
<div class="ttc" id="aclassoomph_1_1ProjectablePMLHelmholtzElement_html_ab90d84e474fccf3a814ea99ecd02e61c"><div class="ttname"><a href="classoomph_1_1ProjectablePMLHelmholtzElement.html#ab90d84e474fccf3a814ea99ecd02e61c">oomph::ProjectablePMLHelmholtzElement::nfields_for_projection</a></div><div class="ttdeci">unsigned nfields_for_projection()</div><div class="ttdoc">Number of fields to be projected: 2 (real and imag part)</div><div class="ttdef"><b>Definition:</b> <a href="pml__helmholtz__elements_8h_source.html#l01056">pml_helmholtz_elements.h:1056</a></div></div>
<div class="ttc" id="aclassoomph_1_1PMLHelmholtzEquations_html_aa4ea2eb142d7db69206d66415bc673ee"><div class="ttname"><a href="classoomph_1_1PMLHelmholtzEquations.html#aa4ea2eb142d7db69206d66415bc673ee">oomph::PMLHelmholtzEquations::K_squared_pt</a></div><div class="ttdeci">double * K_squared_pt</div><div class="ttdoc">Pointer to wave number (must be set!)</div><div class="ttdef"><b>Definition:</b> <a href="pml__helmholtz__elements_8h_source.html#l00717">pml_helmholtz_elements.h:717</a></div></div>
<div class="ttc" id="aclassoomph_1_1PMLHelmholtzEquations_html_a1f4dad243537bdf8d02340dfdb7612bb"><div class="ttname"><a href="classoomph_1_1PMLHelmholtzEquations.html#a1f4dad243537bdf8d02340dfdb7612bb">oomph::PMLHelmholtzEquations::get_source_helmholtz</a></div><div class="ttdeci">virtual void get_source_helmholtz(const unsigned &amp;ipt, const Vector&lt; double &gt; &amp;x, std::complex&lt; double &gt; &amp;source) const</div><div class="ttdef"><b>Definition:</b> <a href="pml__helmholtz__elements_8h_source.html#l00409">pml_helmholtz_elements.h:409</a></div></div>
<div class="ttc" id="aclassoomph_1_1PMLHelmholtzEquations_html_a9894f96deeea40768c047978674e72e9"><div class="ttname"><a href="classoomph_1_1PMLHelmholtzEquations.html#a9894f96deeea40768c047978674e72e9">oomph::PMLHelmholtzEquations::ndof_types</a></div><div class="ttdeci">unsigned ndof_types() const</div><div class="ttdoc">The number of &quot;DOF types&quot; that degrees of freedom in this element are sub-divided into: real and imag...</div><div class="ttdef"><b>Definition:</b> <a href="pml__helmholtz__elements_8h_source.html#l00627">pml_helmholtz_elements.h:627</a></div></div>
<div class="ttc" id="athe__data__structure_8txt_html_aaa5287b1cf3ca06b3f413cb95bd1ec60"><div class="ttname"><a href="the__data__structure_8txt.html#aaa5287b1cf3ca06b3f413cb95bd1ec60">u</a></div><div class="ttdeci">Vector&lt; double &gt; u(3)</div></div>
<div class="ttc" id="aclassoomph_1_1PMLHelmholtzEquations_html_af590f98d401b50f72b67ef7f0813fe7f"><div class="ttname"><a href="classoomph_1_1PMLHelmholtzEquations.html#af590f98d401b50f72b67ef7f0813fe7f">oomph::PMLHelmholtzEquations::output_real_fct</a></div><div class="ttdeci">void output_real_fct(std::ostream &amp;outfile, const double &amp;phi, const unsigned &amp;n_plot, FiniteElement::SteadyExactSolutionFctPt exact_soln_pt)</div><div class="ttdoc">Output function for real part of full time-dependent fct u = Re( (u_r +i u_i) exp(-i omega t) at phas...</div><div class="ttdef"><b>Definition:</b> <a href="pml__helmholtz__elements_8cc_source.html#l00621">pml_helmholtz_elements.cc:621</a></div></div>
<div class="ttc" id="aclassoomph_1_1PMLHelmholtzEquations_html_a1312be0dbd1bc6a2499c4928c8ea152b"><div class="ttname"><a href="classoomph_1_1PMLHelmholtzEquations.html#a1312be0dbd1bc6a2499c4928c8ea152b">oomph::PMLHelmholtzEquations::compute_error</a></div><div class="ttdeci">void compute_error(std::ostream &amp;outfile, FiniteElement::UnsteadyExactSolutionFctPt exact_soln_pt, const double &amp;time, double &amp;error, double &amp;norm)</div><div class="ttdoc">Dummy, time dependent error checker.</div><div class="ttdef"><b>Definition:</b> <a href="pml__helmholtz__elements_8h_source.html#l00384">pml_helmholtz_elements.h:384</a></div></div>
<div class="ttc" id="aclassoomph_1_1PointElement_html"><div class="ttname"><a href="classoomph_1_1PointElement.html">oomph::PointElement</a></div><div class="ttdef"><b>Definition:</b> <a href="elements_8h_source.html#l03301">elements.h:3301</a></div></div>
<div class="ttc" id="aclassoomph_1_1PMLHelmholtzEquations_html_a3ad0d6e6a8750200e9802b1f32aec11b"><div class="ttname"><a href="classoomph_1_1PMLHelmholtzEquations.html#a3ad0d6e6a8750200e9802b1f32aec11b">oomph::PMLHelmholtzEquations::scalar_name_paraview</a></div><div class="ttdeci">std::string scalar_name_paraview(const unsigned &amp;i) const</div><div class="ttdoc">Name of the i-th scalar field. Default implementation returns V1 for the first one,...</div><div class="ttdef"><b>Definition:</b> <a href="pml__helmholtz__elements_8h_source.html#l00253">pml_helmholtz_elements.h:253</a></div></div>
<div class="ttc" id="aclassoomph_1_1FiniteElement_html_a28fd5c2d4aeba5ef65bee0e0d72569f5"><div class="ttname"><a href="classoomph_1_1FiniteElement.html#a28fd5c2d4aeba5ef65bee0e0d72569f5">oomph::FiniteElement::nodal_value</a></div><div class="ttdeci">double nodal_value(const unsigned &amp;n, const unsigned &amp;i) const</div><div class="ttdoc">Return the i-th value stored at local node n. Produces suitably interpolated values for hanging nodes...</div><div class="ttdef"><b>Definition:</b> <a href="elements_8h_source.html#l02483">elements.h:2483</a></div></div>
<div class="ttc" id="aclassoomph_1_1PMLElementBase_html_a5e460c58f3fe82696004d21e3f713d73"><div class="ttname"><a href="classoomph_1_1PMLElementBase.html#a5e460c58f3fe82696004d21e3f713d73">oomph::PMLElementBase::Pml_direction_active</a></div><div class="ttdeci">std::vector&lt; bool &gt; Pml_direction_active</div><div class="ttdoc">Coordinate direction along which pml boundary is constant; alternatively: coordinate direction in whi...</div><div class="ttdef"><b>Definition:</b> <a href="pml__meshes_8h_source.html#l00126">pml_meshes.h:126</a></div></div>
<div class="ttc" id="aclassoomph_1_1PMLHelmholtzEquations_html_ae660ab230566958c73f12eecd494364f"><div class="ttname"><a href="classoomph_1_1PMLHelmholtzEquations.html#ae660ab230566958c73f12eecd494364f">oomph::PMLHelmholtzEquations::scalar_value_paraview</a></div><div class="ttdeci">void scalar_value_paraview(std::ofstream &amp;file_out, const unsigned &amp;i, const unsigned &amp;nplot) const</div><div class="ttdoc">Write values of the i-th scalar field at the plot points. Needs to be implemented for each new specif...</div><div class="ttdef"><b>Definition:</b> <a href="pml__helmholtz__elements_8h_source.html#l00138">pml_helmholtz_elements.h:138</a></div></div>
<div class="ttc" id="aclassoomph_1_1PMLHelmholtzEquations_html_abe36a7e5ce224ac04cfb745b278da301"><div class="ttname"><a href="classoomph_1_1PMLHelmholtzEquations.html#abe36a7e5ce224ac04cfb745b278da301">oomph::PMLHelmholtzEquations::interpolated_u_pml_helmholtz</a></div><div class="ttdeci">std::complex&lt; double &gt; interpolated_u_pml_helmholtz(const Vector&lt; double &gt; &amp;s) const</div><div class="ttdoc">Return FE representation of function value u_helmholtz(s) at local coordinate s.</div><div class="ttdef"><b>Definition:</b> <a href="pml__helmholtz__elements_8h_source.html#l00500">pml_helmholtz_elements.h:500</a></div></div>
<div class="ttc" id="aclassoomph_1_1FiniteElement_html_a06d32c85753a1e302c3b345ea27f6c85"><div class="ttname"><a href="classoomph_1_1FiniteElement.html#a06d32c85753a1e302c3b345ea27f6c85">oomph::FiniteElement::nplot_points_paraview</a></div><div class="ttdeci">virtual unsigned nplot_points_paraview(const unsigned &amp;nplot) const</div><div class="ttdoc">Return the number of actual plot points for paraview plot with parameter nplot. Broken virtual; can b...</div><div class="ttdef"><b>Definition:</b> <a href="elements_8h_source.html#l02725">elements.h:2725</a></div></div>
<div class="ttc" id="aclassoomph_1_1PMLElementBase_html_a952ab0485b0834249e5eac1e8448f43f"><div class="ttname"><a href="classoomph_1_1PMLElementBase.html#a952ab0485b0834249e5eac1e8448f43f">oomph::PMLElementBase::Pml_inner_boundary</a></div><div class="ttdeci">Vector&lt; double &gt; Pml_inner_boundary</div><div class="ttdoc">Coordinate of inner pml boundary (Storage is provided for any coordinate direction; only the entries ...</div><div class="ttdef"><b>Definition:</b> <a href="pml__meshes_8h_source.html#l00131">pml_meshes.h:131</a></div></div>
<div class="ttc" id="aclassoomph_1_1Shape_html"><div class="ttname"><a href="classoomph_1_1Shape.html">oomph::Shape</a></div><div class="ttdef"><b>Definition:</b> <a href="shape_8h_source.html#l00077">shape.h:77</a></div></div>
<div class="ttc" id="aclassoomph_1_1PMLHelmholtzEquations_html_aea8423961cbcc8db267399364f9f8433"><div class="ttname"><a href="classoomph_1_1PMLHelmholtzEquations.html#aea8423961cbcc8db267399364f9f8433">oomph::PMLHelmholtzEquations::self_test</a></div><div class="ttdeci">unsigned self_test()</div><div class="ttdoc">Self-test: Return 0 for OK.</div><div class="ttdef"><b>Definition:</b> <a href="pml__helmholtz__elements_8cc_source.html#l00303">pml_helmholtz_elements.cc:303</a></div></div>
<div class="ttc" id="aclassoomph_1_1QPMLHelmholtzElement_html_a72fce9b0be92c83f0741cec44176f4ef"><div class="ttname"><a href="classoomph_1_1QPMLHelmholtzElement.html#a72fce9b0be92c83f0741cec44176f4ef">oomph::QPMLHelmholtzElement::output</a></div><div class="ttdeci">void output(std::ostream &amp;outfile, const unsigned &amp;n_plot)</div><div class="ttdoc">Output function: x,y,u or x,y,z,u at n_plot^DIM plot points.</div><div class="ttdef"><b>Definition:</b> <a href="pml__helmholtz__elements_8h_source.html#l00786">pml_helmholtz_elements.h:786</a></div></div>
<div class="ttc" id="aclassoomph_1_1PMLHelmholtzEquations_html_a184e425cb3444c8b600fafd20538d5e8"><div class="ttname"><a href="classoomph_1_1PMLHelmholtzEquations.html#a184e425cb3444c8b600fafd20538d5e8">oomph::PMLHelmholtzEquations::dshape_and_dtest_eulerian_at_knot_helmholtz</a></div><div class="ttdeci">virtual double dshape_and_dtest_eulerian_at_knot_helmholtz(const unsigned &amp;ipt, Shape &amp;psi, DShape &amp;dpsidx, Shape &amp;test, DShape &amp;dtestdx) const =0</div><div class="ttdoc">Shape/test functions and derivs w.r.t. to global coords at integration point ipt; return Jacobian of ...</div></div>
<div class="ttc" id="aclassoomph_1_1PMLHelmholtzEquations_html_a08c72ef039f4dd155df7bc660554c666"><div class="ttname"><a href="classoomph_1_1PMLHelmholtzEquations.html#a08c72ef039f4dd155df7bc660554c666">oomph::PMLHelmholtzEquations::values_to_be_pinned_on_outer_pml_boundary</a></div><div class="ttdeci">void values_to_be_pinned_on_outer_pml_boundary(Vector&lt; unsigned &gt; &amp;values_to_pin)</div><div class="ttdoc">Pure virtual function in which we specify the values to be pinned (and set to zero) on the outer edge...</div><div class="ttdef"><b>Definition:</b> <a href="pml__helmholtz__elements_8h_source.html#l00428">pml_helmholtz_elements.h:428</a></div></div>
<div class="ttc" id="acfortran_8h_html_ab7123126e4885ef647dd9c6e3807a21c"><div class="ttname"><a href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a></div><div class="ttdeci">static char t char * s</div><div class="ttdef"><b>Definition:</b> <a href="cfortran_8h_source.html#l00568">cfortran.h:568</a></div></div>
<div class="ttc" id="aclassoomph_1_1FaceGeometry_html"><div class="ttname"><a href="classoomph_1_1FaceGeometry.html">oomph::FaceGeometry</a></div><div class="ttdef"><b>Definition:</b> <a href="elements_8h_source.html#l04837">elements.h:4837</a></div></div>
<div class="ttc" id="aclassoomph_1_1PMLHelmholtzEquations_html_af69f13a00113d097075285db5f12feeb"><div class="ttname"><a href="classoomph_1_1PMLHelmholtzEquations.html#af69f13a00113d097075285db5f12feeb">oomph::PMLHelmholtzEquations::output_total_real</a></div><div class="ttdeci">void output_total_real(std::ostream &amp;outfile, FiniteElement::SteadyExactSolutionFctPt incoming_wave_fct_pt, const double &amp;phi, const unsigned &amp;nplot)</div><div class="ttdef"><b>Definition:</b> <a href="pml__helmholtz__elements_8cc_source.html#l00424">pml_helmholtz_elements.cc:424</a></div></div>
<div class="ttc" id="anamespaceoomph_1_1Global__string__for__annotation_html_ac5379de2fa7fe44f2cb31785fc208135"><div class="ttname"><a href="namespaceoomph_1_1Global__string__for__annotation.html#ac5379de2fa7fe44f2cb31785fc208135">oomph::Global_string_for_annotation::string</a></div><div class="ttdeci">std::string string(const unsigned &amp;i)</div><div class="ttdoc">Return the i-th string or &quot;&quot; if the relevant string hasn't been defined.</div><div class="ttdef"><b>Definition:</b> <a href="oomph__definitions_8cc_source.html#l00289">oomph_definitions.cc:289</a></div></div>
<div class="ttc" id="aclassoomph_1_1PMLHelmholtzEquations_html_a8290cabe737e4260a58ff7feb087023c"><div class="ttname"><a href="classoomph_1_1PMLHelmholtzEquations.html#a8290cabe737e4260a58ff7feb087023c">oomph::PMLHelmholtzEquations::output_imag_fct</a></div><div class="ttdeci">void output_imag_fct(std::ostream &amp;outfile, const double &amp;phi, const unsigned &amp;n_plot, FiniteElement::SteadyExactSolutionFctPt exact_soln_pt)</div><div class="ttdoc">Output function for imaginary part of full time-dependent fct u = Im( (u_r +i u_i) exp(-i omega t)) a...</div><div class="ttdef"><b>Definition:</b> <a href="pml__helmholtz__elements_8cc_source.html#l00676">pml_helmholtz_elements.cc:676</a></div></div>

    <!-- jQuery for Bootstrap and Doxygen -->
    <script src="../../js/jquery-1.12.0.min.js"></script>
    <!-- Minified boostrap plugins-->
    <script src="../../js/bootstrap.js"></script>
    <!-- Doxygen dependency to add powertips to source code-->
    <script src="../../js/jquery.powertip.min.js"></script>
    <!-- The  following script is generated by doxygen and hides/shows levels in 
         the data structure lists and adds powertips to source code-->
    <script src="../../js/dynsections.js" ></script>
    <!-- add to Doxygen's class names so bootstrap css and js recognises them-->
    <script type="text/javascript">
    $(".contents").addClass("container");
    $(".header").addClass("container");
    $(".navpath").addClass("container");
    $("#navrow3").addClass("container");
    $("#navrow4").addClass("container");
    $(".mlabel").addClass("label");
    $(".mlabel").addClass("label-default");
    $(".memitem").addClass("panel");
    $(".memitem").addClass("panel-info");
    $(".memproto").addClass("panel-heading");
    $(".memdoc").addClass("panel-body");
    </script>
    <footer>
      <div class="container">
        <div class="text-muted" style="float:right;">Generated by <a href="http://www.doxygen.org/index.html">
          <img style="height:18px;" class="footer-img" src="doxygen.png" alt="doxygen"></a> on Wed Jul 21 2021 19:03:43
        </div>
      </div>
    </footer>
</body>
</html>

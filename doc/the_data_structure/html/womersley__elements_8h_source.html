<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
<title>oomph-lib: womersley_elements.h Source File</title>
<link rel="apple-touch-icon" sizes="57x57" href="../../figures/apple-touch-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="../../figures/apple-touch-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="../../figures/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="../../figures/apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="../../figures/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="../../figures/apple-touch-icon-120x120.png">
<link rel="icon" type="image/png" href="../../figures/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="../../figures/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="../../figures/favicon-16x16.png" sizes="16x16">
<link rel="manifest" href="../../figures/manifest.json">
<link rel="mask-icon" href="../../figures/safari-pinned-tab.svg" color="#008000">
<link rel="shortcut icon" href="../../figures/favicon.ico">
<meta name="msapplication-TileColor" content="#00a300">
<meta name="msapplication-config" content="../../figures/browserconfig.xml">
<meta name="theme-color" content="#008000">
<link href="http://fonts.googleapis.com/css?family=Open+Sans:400,300,600" rel="stylesheet" type="text/css">
<!-- Doxygen css-->
<!-- <link rel="stylesheet" type="text/css" href="doxygen.css"> -->
<!-- Bootstrap -->
<link href="../../css/bootstrap.css" rel="stylesheet">
<!-- oomph-lib specific overrides -->
<link rel="stylesheet" type="text/css" href="../../css/oomph_header.css">
</head>
<body>
<nav class="navbar navbar-default">
<div class="container">
<div class="container-fluid">
  <!-- Brand and toggle get grouped for better mobile display -->
  <div class="navbar-header">
    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
      <span class="sr-only">Toggle navigation</span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="../../html/index.html"><img alt="oomph-lib" src="../../figures/oomph_logo.png"></a>
  </div>
  <!-- Collect the nav links, forms, and other content for toggling -->
  <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
    <ul class="nav navbar-nav">          
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Documentation <span class="caret"></span></a>
        <ul class="dropdown-menu">
          <li class="dropdown-header">Big picture</li>
          <li><a href="../../../doc/intro/html/index.html">The finite element method</a></li>
          <li><a href="../../../doc/the_data_structure/html/index.html">The data structure</a></li>
          <li><a href="../../../doc/quick_guide/html/index.html">Not-so-quick guide</a></li>
          <li><a href="../../../doc/optimisation/html/index.html">Optimisation</a></li>
          <li><a href="../../../doc/order_of_action_functions/html/index.html">Order of action functions</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Example codes and tutorials</li>
          <li><a href="../../../doc/example_code_list/html/index.html">List of example codes and tutorials</a></li>
          <li><a href="../../../doc/example_code_list/html/index.html#meshes">Meshing</a></li>
          <li><a href="../../../doc/example_code_list/html/index.html#solvers">Solvers</a></li>
          <li><a href="../../../doc/example_code_list/html/index.html#parallel">MPI parallel processing</a></li>
          <li><a href="../../../doc/example_code_list/html/index.html#visualisation">Post-processing/visualisation</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Other</li>
          <li><a href="../../../doc/change_log/html/index.html">Change log</a></li>
          <li><a href="../../../doc/creating_doc/html/index.html">Creating documentation</a></li>
          <li><a href="../../../doc/coding_conventions/html/index.html">Coding conventions</a></li>
          <li><a href="../../../doc/index/html/index.html">Index</a></li>
          <li><a href="../../../doc/FAQ/html/index.html">FAQ</a></li>
        </ul>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Get it <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../doc/the_distribution/html/index.html">Installation guide</a></li>
            <li><a href="../../../doc/subversion/html/index.html">Get code from subversion repository</a></li>
            <li><a href="../../../doc/download/html/index.html">Get code as tar file</a></li>
            <li><a href="../../../doc/copyright/html/index.html">Copyright</a></li>
          </ul>
        </li>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">About <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../doc/people/html/index.html">People</a></li>            
            <li><a href="../../../doc/contact/html/index.html">Contact/Get involved</a></li>
            <li><a href="../../../doc/publications/html/index.html">Publications</a></li>
            <li><a href="../../../doc/acknowledgements/html/index.html">Acknowledgements</a></li>
            <li><a href="../../../doc/picture_show/index.html">Picture show</a></li>
          </ul>
        </li>
      </li>
    </ul>
    <ul class="nav navbar-nav navbar-right navbar-search">
      <form class="navbar-form" role="search" action="../../../doc/search_results/html/index.html">
        <div class="input-group">
          <input type="text" class="form-control" placeholder="Search" name="q">
          <span class="input-group-btn">
            <button class="btn btn-default" type="submit">Go</button>
          </span>
        </div><!-- /input-group -->
       <!--<div class="form-group">
          <input type="text" class="form-control" placeholder="Search">
        </div>
        <button type="submit" class="btn btn-default">Submit</button>-->
      </form>
    </ul>
  </div><!-- /.navbar-collapse -->
</div><!-- /.container-fluid -->
</div>
</nav>
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_c97d1a0435d693572670f522cd403889.html">womersley</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">womersley_elements.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="womersley__elements_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">//LIC// ====================================================================</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">//LIC// This file forms part of oomph-lib, the object-oriented, </span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">//LIC// multi-physics finite-element library, available </span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">//LIC// at http://www.oomph-lib.org.</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">//LIC// Copyright (C) 2006-2021 Matthias Heil and Andrew Hazel</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">//LIC// This library is free software; you can redistribute it and/or</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">//LIC// modify it under the terms of the GNU Lesser General Public</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">//LIC// License as published by the Free Software Foundation; either</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">//LIC// version 2.1 of the License, or (at your option) any later version.</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">//LIC// This library is distributed in the hope that it will be useful,</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">//LIC// but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">//LIC// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">//LIC// Lesser General Public License for more details.</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">//LIC// You should have received a copy of the GNU Lesser General Public</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">//LIC// License along with this library; if not, write to the Free Software</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">//LIC// Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">//LIC// 02110-1301  USA.</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">//LIC// The authors may be contacted at oomph-lib@maths.man.ac.uk.</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">//LIC//====================================================================</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160; </div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160; </div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment">//Header file for Womersley elements</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#ifndef OOMPH_WOMERSLEY_ELEMENTS_HEADER</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#define OOMPH_WOMERSLEY_ELEMENTS_HEADER</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;                                                               </div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment">// Config header generated by autoconfig</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#ifdef HAVE_CONFIG_H</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor"> #include &lt;oomph-lib-config.h&gt;</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160; </div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160; </div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment">//OOMPH-LIB headers</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="preprocessor">#include &quot;../generic/nodes.h&quot;</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="preprocessor">#include &quot;../generic/Qelements.h&quot;</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="preprocessor">#include &quot;../generic/mesh.h&quot;</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="preprocessor">#include &quot;../generic/problem.h&quot;</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="preprocessor">#include &quot;../generic/oomph_utilities.h&quot;</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="preprocessor">#include &quot;../navier_stokes/navier_stokes_flux_control_elements.h&quot;</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160; </div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160; </div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespaceoomph.html">oomph</a></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;{</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160; </div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment">/////////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment">/////////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment">/////////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160; </div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment">//===============================================================</span><span class="comment"></span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="comment">/// Template-free base class for Impedance Tube -- to faciliate</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment">/// interactions between the Womersley elements and the</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment">/// Navier Stokes impedance traction elements.</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment"></span><span class="comment">//===============================================================</span></div>
<div class="line"><a name="l00061"></a><span class="lineno"><a class="line" href="classoomph_1_1TemplateFreeWomersleyImpedanceTubeBase.html">   61</a></span>&#160;<span class="keyword">class </span><a class="code" href="classoomph_1_1TemplateFreeWomersleyImpedanceTubeBase.html">TemplateFreeWomersleyImpedanceTubeBase</a></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;{</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160; </div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  <span class="keyword">public</span>:</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  <span class="comment"></span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment"> /// Empty constructor</span></div>
<div class="line"><a name="l00067"></a><span class="lineno"><a class="line" href="classoomph_1_1TemplateFreeWomersleyImpedanceTubeBase.html#a52044dbd661e704066760426547fc3e8">   67</a></span>&#160;<span class="comment"></span> <a class="code" href="classoomph_1_1TemplateFreeWomersleyImpedanceTubeBase.html#a52044dbd661e704066760426547fc3e8">TemplateFreeWomersleyImpedanceTubeBase</a>() {}</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="comment"> /// Empty virtual destructor</span></div>
<div class="line"><a name="l00070"></a><span class="lineno"><a class="line" href="classoomph_1_1TemplateFreeWomersleyImpedanceTubeBase.html#a534a6daaac837e88cdb05961c90d636b">   70</a></span>&#160;<span class="comment"></span> <span class="keyword">virtual</span> <a class="code" href="classoomph_1_1TemplateFreeWomersleyImpedanceTubeBase.html#a534a6daaac837e88cdb05961c90d636b">~TemplateFreeWomersleyImpedanceTubeBase</a>() {}</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="comment"> /// \short Empty virtual dummy member function -- every base class</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment"> /// needs at least one virtual member function if it&#39;s </span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="comment"> /// to be used as a base class for a polymorphic object.</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="comment"></span><span class="comment">// virtual void dummy(){};</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="comment"> /// \short Pure virtual function to compute inlet pressure, p_in, </span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="comment"> /// required to achieve the currently imposed, instantaneous </span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="comment"> /// volume flux q prescribed by total_volume_flux_into_impedance_tube(),</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="comment"> /// and its derivative, dp_in/dq.</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="comment"></span> <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1TemplateFreeWomersleyImpedanceTubeBase.html#a95c60d5f7661be3ee298cd2b4bd45de5">get_response</a>(<span class="keywordtype">double</span>&amp; p_in,</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;                           <span class="keywordtype">double</span>&amp; dp_in_dq)=0;</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="comment"> /// Zero!</span></div>
<div class="line"><a name="l00085"></a><span class="lineno"><a class="line" href="classoomph_1_1TemplateFreeWomersleyImpedanceTubeBase.html#a37b438da1f862ccadbdb80cf8258a781">   85</a></span>&#160;<span class="comment"></span> <span class="keyword">static</span> <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1TemplateFreeWomersleyImpedanceTubeBase.html#a37b438da1f862ccadbdb80cf8258a781">Zero</a>;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160; </div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;};</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160; </div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160; </div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="comment">/////////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="comment">/////////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="comment">/////////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160; </div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160; </div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160; </div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="comment">//======================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="comment">/// A  base class for elements that allow the imposition of an impedance </span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="comment">/// type boundary condition to the Navier--Stokes equations. Establishes</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="comment">/// the template-free common functionality, that they must have to be able</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="comment">/// to compute the volume flux that passes through them, etc.</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="comment"></span><span class="comment">//======================================================================</span></div>
<div class="line"><a name="l00104"></a><span class="lineno"><a class="line" href="classoomph_1_1NavierStokesImpedanceTractionElementBase.html">  104</a></span>&#160;<span class="keyword">class </span><a class="code" href="classoomph_1_1NavierStokesImpedanceTractionElementBase.html">NavierStokesImpedanceTractionElementBase</a></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;{</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160; </div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160; </div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160; <span class="comment">//Empty constructor</span></div>
<div class="line"><a name="l00110"></a><span class="lineno"><a class="line" href="classoomph_1_1NavierStokesImpedanceTractionElementBase.html#a5879757e9fd1c596fa2bb60321c97270">  110</a></span>&#160; <a class="code" href="classoomph_1_1NavierStokesImpedanceTractionElementBase.html#a5879757e9fd1c596fa2bb60321c97270">NavierStokesImpedanceTractionElementBase</a>() {}</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="comment"> ///Empty vitual destructor</span></div>
<div class="line"><a name="l00113"></a><span class="lineno"><a class="line" href="classoomph_1_1NavierStokesImpedanceTractionElementBase.html#a3162972ba2dfdff8bbae08f27efaf132">  113</a></span>&#160;<span class="comment"></span> <span class="keyword">virtual</span> <a class="code" href="classoomph_1_1NavierStokesImpedanceTractionElementBase.html#a3162972ba2dfdff8bbae08f27efaf132">~NavierStokesImpedanceTractionElementBase</a>() {}</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="comment"> /// \short Pure virtual function that must be implemented to compute</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="comment"> /// the volume flux that passes through this element</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="comment"></span> <span class="keyword">virtual</span> <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1NavierStokesImpedanceTractionElementBase.html#a7f71882ae8a0d34e3d5a5c91586081b3">get_volume_flux</a>()=0;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="comment"> /// \short Add the element&#39;s contribution to the auxiliary integral</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="comment"> /// used in the element&#39;s Jacobian. The aux_integral contains</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="comment"> /// the derivative of the total volume flux through the</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="comment"> /// outflow boundary of the (higher-dimensional) Navier-Stokes mesh w.r.t. </span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="comment"> /// to the discrete (global) (velocity) degrees of freedom.</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="comment"></span> <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1NavierStokesImpedanceTractionElementBase.html#a4ce2150b59ff999c24e623b645f1c899">add_element_contribution_to_aux_integral</a>(</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  std::map&lt;unsigned,double&gt;* aux_integral_pt)=0;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="comment"> /// \short Pass the pointer to the pre-computed auxiliary integral</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="comment"> /// to the element so it can be accessed when computing the</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="comment"> /// elemental Jacobian.</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="comment"></span> <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1NavierStokesImpedanceTractionElementBase.html#ac9583fd74bc1bb57101bce20fffa39d3">set_aux_integral_pt</a>(std::map&lt;unsigned,double&gt;*</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;                                  aux_integral_pt)=0;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="comment"> /// \short Pass the pointer to the &quot;impedance tube&quot; that computes</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="comment"> /// the flow resistance via the solution of Womersley&#39;s equations</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="comment"> /// to the element.</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="comment"></span> <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1NavierStokesImpedanceTractionElementBase.html#add9c7ae3f33b8e03805c256daf038ab4">set_impedance_tube_pt</a>(<a class="code" href="classoomph_1_1TemplateFreeWomersleyImpedanceTubeBase.html">TemplateFreeWomersleyImpedanceTubeBase</a>*</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;                                    impedance_tube_pt)=0;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160; </div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="comment"> /// \short Pass the pointer to the mesh containing all </span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="comment"> ///  NavierStokesImpedanceTractionElements that contribute</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="comment"> /// to the volume flux into the downstream &quot;impedance tube&quot;</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="comment"> /// to the element and classify all nodes in that mesh</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="comment"> /// as external Data for this element (unless the nodes</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="comment"> /// are also the element&#39;s own nodes, of course).</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="comment"></span> <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1NavierStokesImpedanceTractionElementBase.html#a648cfcbd9bf1f3404b0e7f184cecdc62">set_external_data_from_navier_stokes_outflow_mesh</a>(</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  <a class="code" href="classoomph_1_1Mesh.html">Mesh</a>* navier_stokes_outflow_mesh_pt_mesh_pt)=0;</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160; </div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;  <span class="keyword">protected</span>:</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="comment"> ///\short Pointer to mesh containing the NavierStokesImpedanceTractionElements</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="comment"> /// that contribute to the volume flux into the &quot;downstream tube&quot; that</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="comment"> /// provides the flow resistance</span></div>
<div class="line"><a name="l00154"></a><span class="lineno"><a class="line" href="classoomph_1_1NavierStokesImpedanceTractionElementBase.html#a460dbb1435dcd04e506b90d029513fc2">  154</a></span>&#160;<span class="comment"></span> <a class="code" href="classoomph_1_1Mesh.html">Mesh</a>* <a class="code" href="classoomph_1_1NavierStokesImpedanceTractionElementBase.html#a460dbb1435dcd04e506b90d029513fc2">Navier_stokes_outflow_mesh_pt</a>;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160; </div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160; </div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;};</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160; </div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160; </div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160; </div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="comment">/////////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="comment">/////////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="comment">/////////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160; </div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="comment">//=============================================================</span><span class="comment"></span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="comment">/// A class for all isoparametric elements that solve the </span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="comment">/// Womersley (parallel flow) equations.</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="comment">/// \f[ </span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="comment">/// Re St \frac{\partial u}{\partial t} = - g + </span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="comment">/// \frac{\partial^2 u}{\partial x_i^2}</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="comment">/// \f]</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="comment">/// which may be derived from the full Navier-Stokes equations</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="comment">/// (with a viscous scaling of the pressure) under the assumption of</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="comment">/// parallel flow in the z direction. u then represents the axial</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;<span class="comment">/// velocity and g is the (spatially constant) axial component of </span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="comment">/// the pressure gradient.</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="comment">///  </span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="comment">/// This class contains the generic maths. Shape functions, geometric</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="comment">/// mapping etc. must get implemented in derived class.</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="comment">/// Note that this class assumes an isoparametric formulation, i.e. that</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="comment">/// the scalar unknown is interpolated using the same shape functions</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="comment">/// as the position.</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;<span class="comment">/// </span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="comment">/// Generally, the instantaneous value of the pressure gradient, g,</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<span class="comment">/// is prescribed (and specified via a pointer to a single-valued</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<span class="comment">/// Data object whose current (pinned) value contains the pressure.</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="comment">/// It is also possible to prescribe the flow rate through </span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="comment">/// a mesh of Womersley elements and to determine the pressure</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="comment">/// gradient required to achieve this flow rate as an unknown.</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="comment">/// In that case the external pressure is treated as </span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="comment">/// an external Data object that an associated</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="comment">/// ImposeFluxForWomersleyElement is in charge of. Note that only</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="comment">/// the ImposeFluxForWomersleyElement can set the pressure gradient</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="comment">/// Data object as external Data. This is because (counter to</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="comment">/// general practice) the WomersleyEquations make contributions</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="comment">/// to the residuals of the ImposeFluxForWomersleyElements in order</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="comment">/// to keep the elemental Jacobians as small as possible.</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="comment"></span><span class="comment">//=============================================================</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="keyword">template</span> &lt;<span class="keywordtype">unsigned</span> DIM&gt;</div>
<div class="line"><a name="l00203"></a><span class="lineno"><a class="line" href="classoomph_1_1WomersleyEquations.html">  203</a></span>&#160;<span class="keyword">class </span><a class="code" href="classoomph_1_1WomersleyEquations.html">WomersleyEquations</a> : <span class="keyword">public</span> <span class="keyword">virtual</span> <a class="code" href="classoomph_1_1FiniteElement.html">FiniteElement</a></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;{</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160; </div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="comment"> /// \short Constructor: Initialises the Pressure_gradient_data_pt to null </span></div>
<div class="line"><a name="l00209"></a><span class="lineno"><a class="line" href="classoomph_1_1WomersleyEquations.html#a22ad21d028f961d08c2ec17ed59bd88b">  209</a></span>&#160;<span class="comment"></span> <a class="code" href="classoomph_1_1WomersleyEquations.html#a22ad21d028f961d08c2ec17ed59bd88b">WomersleyEquations</a>() : <a class="code" href="classoomph_1_1WomersleyEquations.html#acf9f462d481937ec282ccb48c34e77bc">Pressure_gradient_data_pt</a>(0) </div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;  {</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;   <a class="code" href="classoomph_1_1WomersleyEquations.html#af6aa8745284573bf740816c394fa5437">ReSt_pt</a> = &amp;<a class="code" href="classoomph_1_1WomersleyEquations.html#a9f25fbad09d6e3b14971755ea81f0189">Default_ReSt_value</a>;</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;  }</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160; </div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="comment"> /// Broken copy constructor</span></div>
<div class="line"><a name="l00216"></a><span class="lineno"><a class="line" href="classoomph_1_1WomersleyEquations.html#aed4568c1736e6027eb111d090b4cb5e9">  216</a></span>&#160;<span class="comment"></span> <a class="code" href="classoomph_1_1WomersleyEquations.html#aed4568c1736e6027eb111d090b4cb5e9">WomersleyEquations</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1WomersleyEquations.html">WomersleyEquations</a>&amp; dummy) </div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;  { </div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;   <a class="code" href="namespaceoomph_1_1BrokenCopy.html#a7e5cd7fda8b8c790003151bee77a84ac">BrokenCopy::broken_copy</a>(<span class="stringliteral">&quot;WomersleyEquations&quot;</span>);</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;  } </div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160; </div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="comment"> /// Broken assignment operator</span></div>
<div class="line"><a name="l00223"></a><span class="lineno"><a class="line" href="classoomph_1_1WomersleyEquations.html#a429ed0a68543a77c4182fa977ffe549c">  223</a></span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1WomersleyEquations.html#a429ed0a68543a77c4182fa977ffe549c">operator=</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1WomersleyEquations.html">WomersleyEquations</a>&amp;) </div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;  {</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;   <a class="code" href="namespaceoomph_1_1BrokenCopy.html#a32dc384e671e786bac0c67cbff701f45">BrokenCopy::broken_assign</a>(<span class="stringliteral">&quot;WomersleyEquations&quot;</span>);</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;  }</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160; </div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="comment"> /// Set pointer to pressure gradient (single-valued Data)</span></div>
<div class="line"><a name="l00230"></a><span class="lineno"><a class="line" href="classoomph_1_1WomersleyEquations.html#ada82ee649d9a6d7469166fd497222594">  230</a></span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1WomersleyEquations.html#ada82ee649d9a6d7469166fd497222594">set_pressure_gradient_pt</a>(<a class="code" href="classoomph_1_1Data.html">Data</a>*&amp; pressure_gradient_data_pt)</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;  {</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;   <span class="keywordflow">if</span> (pressure_gradient_data_pt-&gt;<a class="code" href="classoomph_1_1Data.html#a7e67fc78a2e8a2fd6eb75bd292d42ff8">nvalue</a>()!=1)</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    {</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;     <span class="keywordflow">throw</span> <a class="code" href="classoomph_1_1OomphLibError.html">OomphLibError</a>(</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;      <span class="stringliteral">&quot;Pressure gradient Data must only contain a single value!\n&quot;</span>,</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;      OOMPH_CURRENT_FUNCTION,</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;      OOMPH_EXCEPTION_LOCATION);</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    }</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;   <a class="code" href="classoomph_1_1WomersleyEquations.html#acf9f462d481937ec282ccb48c34e77bc">Pressure_gradient_data_pt</a>=pressure_gradient_data_pt;</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;  }</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160; </div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160; </div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;<span class="comment"> /// Read-only access to pointer to pressure gradient</span></div>
<div class="line"><a name="l00247"></a><span class="lineno"><a class="line" href="classoomph_1_1WomersleyEquations.html#a72c6fc82b100bd997a6d707d8bccd9d2">  247</a></span>&#160;<span class="comment"></span> <a class="code" href="classoomph_1_1Data.html">Data</a>* <a class="code" href="classoomph_1_1WomersleyEquations.html#a72c6fc82b100bd997a6d707d8bccd9d2">set_pressure_gradient_pt</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="classoomph_1_1WomersleyEquations.html#acf9f462d481937ec282ccb48c34e77bc">Pressure_gradient_data_pt</a>;</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;  }</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160; </div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;<span class="comment"> /// Product of Reynolds and Strouhal number (=Womersley number)</span></div>
<div class="line"><a name="l00254"></a><span class="lineno"><a class="line" href="classoomph_1_1WomersleyEquations.html#a4db194b9f71a69779b3450d40288b55d">  254</a></span>&#160;<span class="comment"></span> <span class="keyword">const</span> <span class="keywordtype">double</span> &amp;<a class="code" href="classoomph_1_1WomersleyEquations.html#a4db194b9f71a69779b3450d40288b55d">re_st</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> *<a class="code" href="classoomph_1_1WomersleyEquations.html#af6aa8745284573bf740816c394fa5437">ReSt_pt</a>;}</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160; </div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;<span class="comment"> /// Pointer to product of Reynolds and Strouhal number (=Womersley number)</span></div>
<div class="line"><a name="l00258"></a><span class="lineno"><a class="line" href="classoomph_1_1WomersleyEquations.html#aaca21f4cfb0b6614b9b796073ce9c8b8">  258</a></span>&#160;<span class="comment"></span> <span class="keywordtype">double</span>* &amp;<a class="code" href="classoomph_1_1WomersleyEquations.html#aaca21f4cfb0b6614b9b796073ce9c8b8">re_st_pt</a>() {<span class="keywordflow">return</span> <a class="code" href="classoomph_1_1WomersleyEquations.html#af6aa8745284573bf740816c394fa5437">ReSt_pt</a>;}</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160; </div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="comment"> /// \short Return the index at which the unknown value</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="comment"> /// is stored. The default value, 0, is appropriate for single-physics</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="comment"> /// problems, when there is only one variable, the value that satisfies the</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="comment"> /// Womersley equation. </span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="comment"> /// In derived multi-physics elements, this function should be overloaded</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="comment"> /// to reflect the chosen storage scheme. Note that these equations require</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="comment"> /// that the unknown is always stored at the same index at each node.</span></div>
<div class="line"><a name="l00268"></a><span class="lineno"><a class="line" href="classoomph_1_1WomersleyEquations.html#afd739de1c8e01b1d9409c05db9ced366">  268</a></span>&#160;<span class="comment"></span> <span class="keyword">virtual</span> <span class="keyword">inline</span> <span class="keywordtype">unsigned</span> <a class="code" href="classoomph_1_1WomersleyEquations.html#afd739de1c8e01b1d9409c05db9ced366">u_index_womersley</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> 0;}</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160; </div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;<span class="comment"> /// \short du/dt at local node n. </span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;<span class="comment"> /// Uses suitably interpolated value for hanging nodes.</span></div>
<div class="line"><a name="l00273"></a><span class="lineno"><a class="line" href="classoomph_1_1WomersleyEquations.html#a6012a6010fc26e347214492f6c590e74">  273</a></span>&#160;<span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1WomersleyEquations.html#a6012a6010fc26e347214492f6c590e74">du_dt_womersley</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;<a class="code" href="the__data__structure_8txt.html#af88b2d950fae19ab641bd1690e08445c">n</a>)<span class="keyword"> const</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;   <span class="comment">// Get the data&#39;s timestepper</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;   <a class="code" href="classoomph_1_1TimeStepper.html">TimeStepper</a>* <a class="code" href="classoomph_1_1GeomObject.html#a3c92023891dd4a0e818022f467eeb7f1">time_stepper_pt</a>= this-&gt;<a class="code" href="classoomph_1_1FiniteElement.html#ace0e7fb72a805b5c2c600347bfae7a9b">node_pt</a>(n)-&gt;<a class="code" href="classoomph_1_1Data.html#a5b34970d16205921dca3ada720da8445">time_stepper_pt</a>();</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160; </div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;   <span class="comment">//Initialise dudt</span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;   <span class="keywordtype">double</span> dudt=0.0;</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;   </div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;   <span class="comment">//Loop over the timesteps, if there is a non Steady timestepper</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="classoomph_1_1GeomObject.html#a3c92023891dd4a0e818022f467eeb7f1">time_stepper_pt</a>-&gt;<a class="code" href="classoomph_1_1TimeStepper.html#ad341ba9e80265e1c26c1cda0f40c8292">is_steady</a>())</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    {</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;     <span class="comment">//Find the index at which the variable is stored</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;     <span class="keyword">const</span> <span class="keywordtype">unsigned</span> u_nodal_index = <a class="code" href="classoomph_1_1WomersleyEquations.html#afd739de1c8e01b1d9409c05db9ced366">u_index_womersley</a>();</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;     </div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;     <span class="comment">// Number of timsteps (past &amp; present)</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;     <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_time = <a class="code" href="classoomph_1_1GeomObject.html#a3c92023891dd4a0e818022f467eeb7f1">time_stepper_pt</a>-&gt;<a class="code" href="classoomph_1_1TimeStepper.html#a3939b77ec3578e4bd5b453c85649d631">ntstorage</a>();</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;     </div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;     <span class="comment">//Add the contributions to the time derivative</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#af6f0bd3dc13317f895c91323c25c2b8f">t</a>=0;<a class="code" href="cfortran_8h.html#af6f0bd3dc13317f895c91323c25c2b8f">t</a>&lt;n_time;<a class="code" href="cfortran_8h.html#af6f0bd3dc13317f895c91323c25c2b8f">t</a>++)</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;      {</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;       dudt += <a class="code" href="classoomph_1_1GeomObject.html#a3c92023891dd4a0e818022f467eeb7f1">time_stepper_pt</a>-&gt;<a class="code" href="classoomph_1_1TimeStepper.html#a4cb0aecb044b77ba0553cdd54b586d8a">weight</a>(1,<a class="code" href="cfortran_8h.html#af6f0bd3dc13317f895c91323c25c2b8f">t</a>)*<a class="code" href="classoomph_1_1FiniteElement.html#a28fd5c2d4aeba5ef65bee0e0d72569f5">nodal_value</a>(<a class="code" href="cfortran_8h.html#af6f0bd3dc13317f895c91323c25c2b8f">t</a>,<a class="code" href="the__data__structure_8txt.html#af88b2d950fae19ab641bd1690e08445c">n</a>,u_nodal_index);</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;      }</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    }</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;   <span class="keywordflow">return</span> dudt;</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;  }</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160; </div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;<span class="comment"> /// Output with default number of plot points</span></div>
<div class="line"><a name="l00301"></a><span class="lineno"><a class="line" href="classoomph_1_1WomersleyEquations.html#a9c1246d883f937888bf052b7078aee9a">  301</a></span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1WomersleyEquations.html#a9c1246d883f937888bf052b7078aee9a">output</a>(std::ostream &amp;outfile) </div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;  {</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;   <span class="keywordtype">unsigned</span> nplot=5;</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;   <a class="code" href="classoomph_1_1WomersleyEquations.html#a9c1246d883f937888bf052b7078aee9a">output</a>(outfile,nplot);</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;  }</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;<span class="comment"> /// \short Output function:  x,y,z_out,0,0,u,0 to allow comparison</span></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;<span class="comment"> /// against full Navier Stokes at n_nplot x n_plot points (2D)</span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1WomersleyEquations.html#af97b58e933b49d84f2eda3c10fec9cd1">output_3d</a>(std::ostream &amp;outfile, </div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;                <span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;n_plot,</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;                <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; z_out);</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="comment"> /// \short Output FE representation of soln: x,y,u or x,y,z,u at </span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="comment"> /// n_plot^DIM plot points</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1WomersleyEquations.html#a9c1246d883f937888bf052b7078aee9a">output</a>(std::ostream &amp;outfile, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;nplot);</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160; </div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;<span class="comment"> /// C_style output with default number of plot points</span></div>
<div class="line"><a name="l00319"></a><span class="lineno"><a class="line" href="classoomph_1_1WomersleyEquations.html#ab317caeb41aefe218596c1ff1c39d40f">  319</a></span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1WomersleyEquations.html#ab317caeb41aefe218596c1ff1c39d40f">output</a>(FILE* file_pt)</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;  {</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;   <span class="keywordtype">unsigned</span> n_plot=5;</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;   <a class="code" href="classoomph_1_1WomersleyEquations.html#a9c1246d883f937888bf052b7078aee9a">output</a>(file_pt,n_plot);</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;  }</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160; </div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;<span class="comment"> /// \short C-style output FE representation of soln: x,y,u or x,y,z,u at </span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;<span class="comment"> /// n_plot^DIM plot points</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1WomersleyEquations.html#a9c1246d883f937888bf052b7078aee9a">output</a>(FILE* file_pt, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;n_plot);</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160; </div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;<span class="comment"> /// Output exact soln: x,y,u_exact or x,y,z,u_exact at nplot^DIM plot points</span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1WomersleyEquations.html#aebc178cae7a5f50da1f76eed2ea3972d">output_fct</a>(std::ostream &amp;outfile, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;nplot, </div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;                 <a class="code" href="classoomph_1_1FiniteElement.html#a690fd33af26cc3e84f39bba6d5a85202">FiniteElement::SteadyExactSolutionFctPt</a> </div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;                 exact_soln_pt);</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160; </div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;<span class="comment"> /// \short Output exact soln: x,y,u_exact or x,y,z,u_exact at </span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;<span class="comment"> /// nplot^DIM plot points (time-dependent version)</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;<span class="comment"></span> <span class="keyword">virtual</span> </div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1WomersleyEquations.html#aebc178cae7a5f50da1f76eed2ea3972d">output_fct</a>(std::ostream &amp;outfile, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;nplot,</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;                  <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; time, </div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;                  <a class="code" href="classoomph_1_1FiniteElement.html#ad4ecf2b61b158a4b4d351a60d23c633e">FiniteElement::UnsteadyExactSolutionFctPt</a> </div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;                  exact_soln_pt);</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160; </div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;<span class="comment"> /// Get error against and norm of exact solution</span></div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1WomersleyEquations.html#a29f1f7483545f64e8e04b24dcdce29ef">compute_error</a>(std::ostream &amp;outfile, </div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;                    <a class="code" href="classoomph_1_1FiniteElement.html#a690fd33af26cc3e84f39bba6d5a85202">FiniteElement::SteadyExactSolutionFctPt</a> </div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;                    exact_soln_pt,</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;                    <span class="keywordtype">double</span>&amp; error, <span class="keywordtype">double</span>&amp; norm);</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160; </div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;<span class="comment"> /// Get error against and norm of exact solution</span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1WomersleyEquations.html#a29f1f7483545f64e8e04b24dcdce29ef">compute_error</a>(std::ostream &amp;outfile, </div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;                    <a class="code" href="classoomph_1_1FiniteElement.html#ad4ecf2b61b158a4b4d351a60d23c633e">FiniteElement::UnsteadyExactSolutionFctPt</a> </div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;                    exact_soln_pt,</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;                    <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; time, <span class="keywordtype">double</span>&amp; error, <span class="keywordtype">double</span>&amp; norm);</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;<span class="comment"> /// Get flux: flux[i] = du/dx_i</span></div>
<div class="line"><a name="l00360"></a><span class="lineno"><a class="line" href="classoomph_1_1WomersleyEquations.html#a5dccff3c238209806fefdebbbef91756">  360</a></span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1WomersleyEquations.html#a5dccff3c238209806fefdebbbef91756">get_flux</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>, <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; flux)<span class="keyword"> const</span></div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;   <span class="comment">//Find out how many nodes there are in the element</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;   <span class="keywordtype">unsigned</span> n_node = <a class="code" href="classoomph_1_1FiniteElement.html#a6219ed269a6d89b5aa14659cce48905a">nnode</a>();</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160; </div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;   <span class="comment">//Find the index at which the variable is stored</span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;   <span class="keywordtype">unsigned</span> u_nodal_index = <a class="code" href="classoomph_1_1WomersleyEquations.html#afd739de1c8e01b1d9409c05db9ced366">u_index_womersley</a>();</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160; </div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;   <span class="comment">//Set up memory for the shape and test functions</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;   <a class="code" href="classoomph_1_1Shape.html">Shape</a> psi(n_node);</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;   <a class="code" href="classoomph_1_1DShape.html">DShape</a> dpsidx(n_node,DIM);</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160; </div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;   <span class="comment">//Call the derivatives of the shape and test functions</span></div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;   <a class="code" href="classoomph_1_1FiniteElement.html#a9296c17b134688049256a4bbc886df69">dshape_eulerian</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,psi,dpsidx);</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;     </div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;   <span class="comment">//Initialise to zero</span></div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> j=0;j&lt;DIM;j++) {flux[j] = 0.0;}</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;   </div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;   <span class="comment">// Loop over nodes</span></div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l=0;l&lt;n_node;l++) </div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    {</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;     <span class="comment">//Loop over derivative directions</span></div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> j=0;j&lt;DIM;j++)</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;      {                               </div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;       flux[j] += <a class="code" href="classoomph_1_1FiniteElement.html#a28fd5c2d4aeba5ef65bee0e0d72569f5">nodal_value</a>(l,u_nodal_index)*dpsidx(l,j);</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;      }</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    }</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;  }</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160; </div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;<span class="comment"> /// Compute element residual Vector (wrapper)</span></div>
<div class="line"><a name="l00391"></a><span class="lineno"><a class="line" href="classoomph_1_1WomersleyEquations.html#ad0c342503c279bc697530d87059e7d48">  391</a></span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1WomersleyEquations.html#ad0c342503c279bc697530d87059e7d48">fill_in_contribution_to_residuals</a>(<a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;<a class="code" href="the__data__structure_8txt.html#a1400a973def57b85051cfe1070be1810">residuals</a>)</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;  {</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;   <span class="comment">//Call the generic residuals function with flag set to 0</span></div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;   <span class="comment">//using a dummy matrix argument</span></div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;   <a class="code" href="classoomph_1_1WomersleyEquations.html#a5aebac86c117c1cc99437d26686d000e">fill_in_generic_residual_contribution_womersley</a>(</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    <a class="code" href="the__data__structure_8txt.html#a1400a973def57b85051cfe1070be1810">residuals</a>,<a class="code" href="classoomph_1_1GeneralisedElement.html#a4bff11b8ff97aefabb2df41e61e1779f">GeneralisedElement::Dummy_matrix</a>,0);</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;  }</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160; </div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;<span class="comment"> /// Compute element residual Vector and element Jacobian matrix (wrapper)</span></div>
<div class="line"><a name="l00401"></a><span class="lineno"><a class="line" href="classoomph_1_1WomersleyEquations.html#a4a0779392d756b1450d17879d0c10027">  401</a></span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1WomersleyEquations.html#a4a0779392d756b1450d17879d0c10027">fill_in_contribution_to_jacobian</a>(<a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;<a class="code" href="the__data__structure_8txt.html#a1400a973def57b85051cfe1070be1810">residuals</a>,</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;                                   <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> &amp;jacobian)</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;  {</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;   <span class="comment">//Call the generic routine with the flag set to 1</span></div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;   <a class="code" href="classoomph_1_1WomersleyEquations.html#a5aebac86c117c1cc99437d26686d000e">fill_in_generic_residual_contribution_womersley</a>(<a class="code" href="the__data__structure_8txt.html#a1400a973def57b85051cfe1070be1810">residuals</a>,jacobian,1);</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;  }</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160; </div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;<span class="comment"> /// Return FE representation of function value u(s) at local coordinate s</span></div>
<div class="line"><a name="l00410"></a><span class="lineno"><a class="line" href="classoomph_1_1WomersleyEquations.html#a6b45d8a95f8f811e766fcf3466bfeb09">  410</a></span>&#160;<span class="comment"></span> <span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1WomersleyEquations.html#a6b45d8a95f8f811e766fcf3466bfeb09">interpolated_u_womersley</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>)<span class="keyword"> const</span></div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;   <span class="comment">//Find number of nodes</span></div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;   <span class="keywordtype">unsigned</span> n_node = <a class="code" href="classoomph_1_1FiniteElement.html#a6219ed269a6d89b5aa14659cce48905a">nnode</a>();</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160; </div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;   <span class="comment">//Find the index at which the variable is stored</span></div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;   <span class="keywordtype">unsigned</span> u_nodal_index = <a class="code" href="classoomph_1_1WomersleyEquations.html#afd739de1c8e01b1d9409c05db9ced366">u_index_womersley</a>();</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160; </div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;   <span class="comment">//Local shape function</span></div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;   <a class="code" href="classoomph_1_1Shape.html">Shape</a> psi(n_node);</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160; </div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;   <span class="comment">//Find values of shape function</span></div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;   <a class="code" href="classoomph_1_1FiniteElement.html#a58a25b6859ddd43b7bfe64a19fee5023">shape</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,psi);</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160; </div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;   <span class="comment">//Initialise value of u</span></div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;   <span class="keywordtype">double</span> <a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a> = 0.0;</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160; </div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;   <span class="comment">//Loop over the local nodes and sum</span></div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l=0;l&lt;n_node;l++) </div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    {</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;     <a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a> += <a class="code" href="classoomph_1_1FiniteElement.html#a28fd5c2d4aeba5ef65bee0e0d72569f5">nodal_value</a>(l,u_nodal_index)*psi[l];</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    }</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160; </div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;   <span class="keywordflow">return</span>(<a class="code" href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a>);</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;  }</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;<span class="comment"> /// \short Self-test: Return 0 for OK</span></div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;<span class="comment"></span> <span class="keywordtype">unsigned</span> <a class="code" href="classoomph_1_1WomersleyEquations.html#acdcc63b1f495caa704aec0c5c170b030">self_test</a>();</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;<span class="comment"> /// Compute total volume flux through element</span></div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;<span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1WomersleyEquations.html#ab04034e44e876ea9935a4ae102c34ce9">get_volume_flux</a>();</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160; </div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;<span class="keyword">protected</span>:</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;<span class="comment"> /// \short Shape/test functions and derivs w.r.t. to global coords at </span></div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;<span class="comment"> /// local coord. s; return  Jacobian of mapping</span></div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;<span class="comment"></span> <span class="keyword">virtual</span> <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1WomersleyEquations.html#a26d31e02c3fb483c76402823e09d67c7">dshape_and_dtest_eulerian_womersley</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>, </div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;                                                   <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;psi, </div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;                                                   <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;dpsidx, </div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;                                                   <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;test, </div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;                                                   <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;dtestdx) <span class="keyword">const</span>=0;</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160; </div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;<span class="comment"> /// \short Shape/test functions and derivs w.r.t. to global coords at </span></div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;<span class="comment"> /// integration point ipt; return  Jacobian of mapping</span></div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;<span class="comment"></span> <span class="keyword">virtual</span> <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1WomersleyEquations.html#a5f8bd506dbebc304f30f86ef4acfbd9d">dshape_and_dtest_eulerian_at_knot_womersley</a>(</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;ipt, </div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;  <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;psi, </div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;  <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;dpsidx,</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;  <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;test, </div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;  <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;dtestdx)</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;  <span class="keyword">const</span>=0;</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;<span class="comment"> /// \short Compute element residual Vector only (if flag=and/or element </span></div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;<span class="comment"> /// Jacobian matrix </span></div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;<span class="comment"></span> <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1WomersleyEquations.html#a5aebac86c117c1cc99437d26686d000e">fill_in_generic_residual_contribution_womersley</a>(</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;  <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;<a class="code" href="the__data__structure_8txt.html#a1400a973def57b85051cfe1070be1810">residuals</a>, <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> &amp;jacobian, </div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;  <span class="keywordtype">unsigned</span> flag); </div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;<span class="comment"> /// Pointer to pressure gradient Data (single value Data item)</span></div>
<div class="line"><a name="l00470"></a><span class="lineno"><a class="line" href="classoomph_1_1WomersleyEquations.html#acf9f462d481937ec282ccb48c34e77bc">  470</a></span>&#160;<span class="comment"></span> <a class="code" href="classoomph_1_1Data.html">Data</a>* <a class="code" href="classoomph_1_1WomersleyEquations.html#acf9f462d481937ec282ccb48c34e77bc">Pressure_gradient_data_pt</a>;</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;<span class="comment"> /// Pointer to global Reynolds number x Strouhal number (=Womersley)</span></div>
<div class="line"><a name="l00473"></a><span class="lineno"><a class="line" href="classoomph_1_1WomersleyEquations.html#af6aa8745284573bf740816c394fa5437">  473</a></span>&#160;<span class="comment"></span> <span class="keywordtype">double</span> *<a class="code" href="classoomph_1_1WomersleyEquations.html#af6aa8745284573bf740816c394fa5437">ReSt_pt</a>;</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;<span class="comment"> /// Static default value for the Womersley number</span></div>
<div class="line"><a name="l00476"></a><span class="lineno"><a class="line" href="classoomph_1_1WomersleyEquations.html#a9f25fbad09d6e3b14971755ea81f0189">  476</a></span>&#160;<span class="comment"></span> <span class="keyword">static</span> <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1WomersleyEquations.html#a9f25fbad09d6e3b14971755ea81f0189">Default_ReSt_value</a>;</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160; </div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160; </div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160; <span class="keyword">template</span>&lt;<span class="keywordtype">unsigned</span> DIMM&gt;</div>
<div class="line"><a name="l00481"></a><span class="lineno"><a class="line" href="classoomph_1_1WomersleyEquations.html#a216440116a86af2614ff792554f8f745">  481</a></span>&#160; <span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="classoomph_1_1ImposeFluxForWomersleyElement.html">ImposeFluxForWomersleyElement</a>;</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;<span class="comment"> /// \short Set pointer to pressure gradient (single-valued Data) and </span></div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;<span class="comment"> /// treat it as external data -- this can only be called</span></div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;<span class="comment"> /// by the friend class ImposeFluxForWomersleyElement which</span></div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;<span class="comment"> /// imposes a volume flux constraint and trades it</span></div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;<span class="comment"> /// for the now unknown pressure gradient Data that is</span></div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;<span class="comment"> /// treated as external Data for this element.</span></div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;<span class="comment"> /// This slightly convoluted (private/friend) construction </span></div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;<span class="comment"> /// is necessary because, counter to practice,  the current </span></div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;<span class="comment"> /// element adds contributions to the equation that determines</span></div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;<span class="comment"> /// the external data. This obviously requires that the</span></div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;<span class="comment"> /// ImposeFluxForWomersleyElement doesn&#39;t do the same. We know</span></div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;<span class="comment"> /// that it doesn&#39;t and therefore we make it a friend that&#39;s allowed</span></div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;<span class="comment"> /// to collaborate with this element...</span></div>
<div class="line"><a name="l00496"></a><span class="lineno"><a class="line" href="classoomph_1_1WomersleyEquations.html#ae4c9206bebee065874acb318d2abf20d">  496</a></span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1WomersleyEquations.html#ae4c9206bebee065874acb318d2abf20d">set_pressure_gradient_and_add_as_external_data</a>(</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;  <a class="code" href="classoomph_1_1Data.html">Data</a>* pressure_gradient_data_pt)</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;  {</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;   <a class="code" href="classoomph_1_1WomersleyEquations.html#acf9f462d481937ec282ccb48c34e77bc">Pressure_gradient_data_pt</a>=pressure_gradient_data_pt;</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;   <a class="code" href="classoomph_1_1GeneralisedElement.html#afc58b505360aa5d172e50baad9aae46d">add_external_data</a>(pressure_gradient_data_pt);</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;  }</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160; </div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;};</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160; </div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;<span class="comment">///////////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;<span class="comment">///////////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;<span class="comment">///////////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160; </div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160; </div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;<span class="comment">//========================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;<span class="comment">/// \short Element to impose volume flux through collection of Womersley</span></div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;<span class="comment">/// elements, in exchange for treating the pressure gradient</span></div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;<span class="comment">/// as an unknown. The pressure gradient is created (as a single-valued</span></div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;<span class="comment">/// Data item) in the constructor for this element which also</span></div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;<span class="comment">/// takes a pointer to the Mesh containing  the Womersley elements whose</span></div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;<span class="comment">/// total flux is being controlled. While doing this we tell them</span></div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;<span class="comment">/// that their pressure gradient is now an unknown and must be</span></div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;<span class="comment">/// treated as external Data.</span></div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;<span class="comment"></span><span class="comment">//========================================================================</span></div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;<span class="keyword">template</span>&lt;<span class="keywordtype">unsigned</span> DIM&gt;</div>
<div class="line"><a name="l00523"></a><span class="lineno"><a class="line" href="classoomph_1_1ImposeFluxForWomersleyElement.html">  523</a></span>&#160;<span class="keyword">class </span><a class="code" href="classoomph_1_1ImposeFluxForWomersleyElement.html">ImposeFluxForWomersleyElement</a> : <span class="keyword">public</span> <span class="keyword">virtual</span> <a class="code" href="classoomph_1_1GeneralisedElement.html">GeneralisedElement</a></div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;{</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160; </div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;<span class="comment"> /// \short Constructor: Pass pointer to mesh that contains the</span></div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;<span class="comment"> /// Womersley elements whose volume flux is controlled, and pointer to </span></div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;<span class="comment"> /// double that contains the instantaneous value of the</span></div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;<span class="comment"> /// prescribed flux </span></div>
<div class="line"><a name="l00532"></a><span class="lineno"><a class="line" href="classoomph_1_1ImposeFluxForWomersleyElement.html#ac7fc5594b9f38a3587f0cd798ff3dfb2">  532</a></span>&#160;<span class="comment"></span> <a class="code" href="classoomph_1_1ImposeFluxForWomersleyElement.html#ac7fc5594b9f38a3587f0cd798ff3dfb2">ImposeFluxForWomersleyElement</a>(<a class="code" href="classoomph_1_1Mesh.html">Mesh</a>* womersley_mesh_pt, </div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;                               <span class="keywordtype">double</span>* prescribed_flux_pt) :</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;  <a class="code" href="classoomph_1_1ImposeFluxForWomersleyElement.html#a40cd4288395b34cd199080c136da4d7b">Prescribed_flux_pt</a>(prescribed_flux_pt)</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;  {</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;   <span class="comment">// Store the mesh of the flux-controlled Womerersley elements</span></div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;   <a class="code" href="classoomph_1_1ImposeFluxForWomersleyElement.html#aa6b7bb4b9d527576ca8ee16918d0cbb4">Womersley_mesh_pt</a>=womersley_mesh_pt;</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160; </div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;   <span class="comment">// Create the pressure gradient Data</span></div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;   <a class="code" href="classoomph_1_1ImposeFluxForWomersleyElement.html#a4c8079994c71ce43a36645c2b2dc4580">Pressure_gradient_data_pt</a>=<span class="keyword">new</span> <a class="code" href="the__data__structure_8txt.html#ae789c4a233fe5f1aa45cf1f92efdf494">Data</a>(1);</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;   <a class="code" href="classoomph_1_1ImposeFluxForWomersleyElement.html#a4c8079994c71ce43a36645c2b2dc4580">Pressure_gradient_data_pt</a>-&gt;<a class="code" href="classoomph_1_1Data.html#a7289ca322725c6fd493970a19474b382">set_value</a>(0,0.0);</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160; </div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;   <span class="comment">// Pressure gradient is internal data of this element</span></div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;   <a class="code" href="classoomph_1_1GeneralisedElement.html#a36571ae9c4b6d2a26c36004e5be88389">add_internal_data</a>(<a class="code" href="classoomph_1_1ImposeFluxForWomersleyElement.html#a4c8079994c71ce43a36645c2b2dc4580">Pressure_gradient_data_pt</a>);</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160; </div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;   <span class="comment">// Find number of elements in the mesh of Womersley elements</span></div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;   <span class="comment">// whose total flux is controlled</span></div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;   <span class="keywordtype">unsigned</span> n_element = womersley_mesh_pt-&gt;<a class="code" href="classoomph_1_1Mesh.html#af01dfefb66c15579b540be62999d93ee">nelement</a>();</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;   </div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;   <span class="comment">// Loop over the elements to tell them that the pressure</span></div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;   <span class="comment">// gradient is given by the newly created Data object</span></div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;   <span class="comment">// which is to be treated as external Data.</span></div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#a37cd013acc76697829c324bdd8562d82">e</a>=0;<a class="code" href="cfortran_8h.html#a37cd013acc76697829c324bdd8562d82">e</a>&lt;n_element;<a class="code" href="cfortran_8h.html#a37cd013acc76697829c324bdd8562d82">e</a>++)</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;    {</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;     <span class="comment">// Upcast from FiniteElement to the present element</span></div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;     <a class="code" href="classoomph_1_1WomersleyEquations.html">WomersleyEquations&lt;DIM&gt;</a>* el_pt = </div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;      <span class="keyword">dynamic_cast&lt;</span><a class="code" href="classoomph_1_1WomersleyEquations.html">WomersleyEquations&lt;DIM&gt;</a>*<span class="keyword">&gt;</span>(womersley_mesh_pt-&gt;<a class="code" href="classoomph_1_1Mesh.html#a3c3b85a1be4d9b01f1c0805142a37966">element_pt</a>(<a class="code" href="cfortran_8h.html#a37cd013acc76697829c324bdd8562d82">e</a>));</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;     </div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;     <span class="comment">//Set the pressure gradient function pointer</span></div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;     el_pt-&gt;<a class="code" href="classoomph_1_1WomersleyEquations.html#ae4c9206bebee065874acb318d2abf20d">set_pressure_gradient_and_add_as_external_data</a>(</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;      <a class="code" href="classoomph_1_1ImposeFluxForWomersleyElement.html#a4c8079994c71ce43a36645c2b2dc4580">Pressure_gradient_data_pt</a>);</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;    }</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160; </div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;  }</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;<span class="comment"> /// \short Read-only access to the single-valued Data item that</span></div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;<span class="comment"> /// stores the pressure gradient (to be determined via the</span></div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;<span class="comment"> /// flux control)</span></div>
<div class="line"><a name="l00569"></a><span class="lineno"><a class="line" href="classoomph_1_1ImposeFluxForWomersleyElement.html#a77a13b7dad46eaf222164be9a62b0269">  569</a></span>&#160;<span class="comment"></span> <a class="code" href="classoomph_1_1Data.html">Data</a>* <a class="code" href="classoomph_1_1ImposeFluxForWomersleyElement.html#a77a13b7dad46eaf222164be9a62b0269">pressure_gradient_data_pt</a>()</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;  {</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="classoomph_1_1ImposeFluxForWomersleyElement.html#a4c8079994c71ce43a36645c2b2dc4580">Pressure_gradient_data_pt</a>;</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;  }</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160; </div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;<span class="comment"> /// Get volume flux through all Womersley elements</span></div>
<div class="line"><a name="l00576"></a><span class="lineno"><a class="line" href="classoomph_1_1ImposeFluxForWomersleyElement.html#a9e3ca0a6477d9d4bb89d726f4e0f07b1">  576</a></span>&#160;<span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1ImposeFluxForWomersleyElement.html#a9e3ca0a6477d9d4bb89d726f4e0f07b1">total_volume_flux</a>()</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;  {</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;   <span class="comment">// Initialise</span></div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;   <span class="keywordtype">double</span> flux=0.0;</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160; </div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;   <span class="comment">// Assemble contributions from elements</span></div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;   <span class="keywordtype">unsigned</span> nelem=<a class="code" href="classoomph_1_1ImposeFluxForWomersleyElement.html#aa6b7bb4b9d527576ca8ee16918d0cbb4">Womersley_mesh_pt</a>-&gt;<a class="code" href="classoomph_1_1Mesh.html#af01dfefb66c15579b540be62999d93ee">nelement</a>();</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#a37cd013acc76697829c324bdd8562d82">e</a>=0;<a class="code" href="cfortran_8h.html#a37cd013acc76697829c324bdd8562d82">e</a>&lt;nelem;<a class="code" href="cfortran_8h.html#a37cd013acc76697829c324bdd8562d82">e</a>++)</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;    {</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;     <a class="code" href="classoomph_1_1WomersleyEquations.html">WomersleyEquations&lt;DIM&gt;</a>* el_pt=</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;      <span class="keyword">dynamic_cast&lt;</span><a class="code" href="classoomph_1_1WomersleyEquations.html">WomersleyEquations&lt;DIM&gt;</a>*<span class="keyword">&gt;</span>(<a class="code" href="classoomph_1_1ImposeFluxForWomersleyElement.html#aa6b7bb4b9d527576ca8ee16918d0cbb4">Womersley_mesh_pt</a>-&gt;<a class="code" href="classoomph_1_1Mesh.html#a3c3b85a1be4d9b01f1c0805142a37966">element_pt</a>(<a class="code" href="cfortran_8h.html#a37cd013acc76697829c324bdd8562d82">e</a>));</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;     <span class="keywordflow">if</span> (el_pt!=0) flux+=el_pt-&gt;<a class="code" href="classoomph_1_1WomersleyEquations.html#ab04034e44e876ea9935a4ae102c34ce9">get_volume_flux</a>();</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;    }</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160; </div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;   <span class="comment">// Return total volume flux</span></div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;   <span class="keywordflow">return</span> flux;</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;  }</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160; </div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;<span class="comment"> /// \short Compute residual vector: the volume flux constraint</span></div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;<span class="comment"> /// determines this element&#39;s one-and-only internal Data which represents</span></div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;<span class="comment"> /// the pressure gradient</span></div>
<div class="line"><a name="l00598"></a><span class="lineno"><a class="line" href="classoomph_1_1ImposeFluxForWomersleyElement.html#a6109bae3e5eb55b567e7ea85fca10884">  598</a></span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1ImposeFluxForWomersleyElement.html#a6109bae3e5eb55b567e7ea85fca10884">get_residuals</a>(<a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;<a class="code" href="the__data__structure_8txt.html#a1400a973def57b85051cfe1070be1810">residuals</a>)</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;  {</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;   <span class="comment">// Local equation number of volume flux constraint -- associated</span></div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;   <span class="comment">// with the internal data (the unknown pressure gradient)</span></div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;   <span class="keywordtype">int</span> local_eqn=<a class="code" href="classoomph_1_1GeneralisedElement.html#aa9db9d3c59caed7ff927373caf5ea4b6">internal_local_eqn</a>(0,0);</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;   <span class="keywordflow">if</span> (local_eqn&gt;=0)</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;    {</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;     <a class="code" href="the__data__structure_8txt.html#a1400a973def57b85051cfe1070be1810">residuals</a>[local_eqn]+=<a class="code" href="classoomph_1_1ImposeFluxForWomersleyElement.html#a9e3ca0a6477d9d4bb89d726f4e0f07b1">total_volume_flux</a>()-(*Prescribed_flux_pt);</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;    }</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;  }</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160; </div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;<span class="comment"> /// \short Compute element residual Vector and element Jacobian matrix </span></div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;<span class="comment"> /// Note: Jacobian is zero because the derivatives w.r.t. to </span></div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;<span class="comment"> /// velocity dofs are added by the Womersley elements; the current</span></div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;<span class="comment"> /// element&#39;s internal Data (the pressure gradient) does not feature</span></div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;<span class="comment"> /// in the volume constraint. </span></div>
<div class="line"><a name="l00615"></a><span class="lineno"><a class="line" href="classoomph_1_1ImposeFluxForWomersleyElement.html#a7c5c2bbd9577949c1fa78395930fd764">  615</a></span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1ImposeFluxForWomersleyElement.html#a7c5c2bbd9577949c1fa78395930fd764">get_jacobian</a>(<a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;<a class="code" href="the__data__structure_8txt.html#a1400a973def57b85051cfe1070be1810">residuals</a>,</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;                   <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> &amp;jacobian)</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;  {</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;   <span class="comment">// Initialise Jacobian</span></div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;   <span class="keywordtype">unsigned</span> n_dof=<a class="code" href="classoomph_1_1GeneralisedElement.html#a37204f67b37d212fd170c68d48f6da57">ndof</a>();</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;n_dof;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;    {</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j=0;j&lt;n_dof;j++)</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;      {</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;       jacobian(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>,j)=0.0;</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;      }</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;    }</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;   <span class="comment">// Get residuals</span></div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;   <a class="code" href="classoomph_1_1ImposeFluxForWomersleyElement.html#a6109bae3e5eb55b567e7ea85fca10884">get_residuals</a>(<a class="code" href="the__data__structure_8txt.html#a1400a973def57b85051cfe1070be1810">residuals</a>);</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;  } </div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160; </div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;<span class="comment"> /// Pointer to mesh that contains the Womersley elements</span></div>
<div class="line"><a name="l00634"></a><span class="lineno"><a class="line" href="classoomph_1_1ImposeFluxForWomersleyElement.html#aa6b7bb4b9d527576ca8ee16918d0cbb4">  634</a></span>&#160;<span class="comment"></span> <a class="code" href="classoomph_1_1Mesh.html">Mesh</a>* <a class="code" href="classoomph_1_1ImposeFluxForWomersleyElement.html#aa6b7bb4b9d527576ca8ee16918d0cbb4">Womersley_mesh_pt</a>;</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;<span class="comment"> /// \short Data item whose one and only value contains the pressure</span></div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;<span class="comment"> /// gradient</span></div>
<div class="line"><a name="l00638"></a><span class="lineno"><a class="line" href="classoomph_1_1ImposeFluxForWomersleyElement.html#a4c8079994c71ce43a36645c2b2dc4580">  638</a></span>&#160;<span class="comment"></span> <a class="code" href="classoomph_1_1Data.html">Data</a>* <a class="code" href="classoomph_1_1ImposeFluxForWomersleyElement.html#a4c8079994c71ce43a36645c2b2dc4580">Pressure_gradient_data_pt</a>;</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;<span class="comment"> /// \short Pointer to current value of prescribed flux</span></div>
<div class="line"><a name="l00641"></a><span class="lineno"><a class="line" href="classoomph_1_1ImposeFluxForWomersleyElement.html#a40cd4288395b34cd199080c136da4d7b">  641</a></span>&#160;<span class="comment"></span> <span class="keywordtype">double</span>* <a class="code" href="classoomph_1_1ImposeFluxForWomersleyElement.html#a40cd4288395b34cd199080c136da4d7b">Prescribed_flux_pt</a>;</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160; </div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;};</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160; </div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160; </div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160; </div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;<span class="comment">///////////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;<span class="comment">///////////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;<span class="comment">///////////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160; </div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160; </div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;<span class="comment">//======================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;<span class="comment">/// QWomersleyElement elements are linear/quadrilateral/brick-shaped </span></div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;<span class="comment">/// Womersley elements with isoparametric interpolation for the function.</span></div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;<span class="comment"></span><span class="comment">//======================================================================</span></div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;<span class="keyword">template</span> &lt;<span class="keywordtype">unsigned</span> DIM, <span class="keywordtype">unsigned</span> NNODE_1D&gt;</div>
<div class="line"><a name="l00659"></a><span class="lineno"><a class="line" href="classoomph_1_1QWomersleyElement.html">  659</a></span>&#160; <span class="keyword">class </span><a class="code" href="classoomph_1_1QWomersleyElement.html">QWomersleyElement</a> : <span class="keyword">public</span> <span class="keyword">virtual</span> <a class="code" href="classoomph_1_1QElement.html">QElement</a>&lt;DIM,NNODE_1D&gt;,</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160; <span class="keyword">public</span> <span class="keyword">virtual</span> <a class="code" href="classoomph_1_1WomersleyEquations.html">WomersleyEquations</a>&lt;DIM&gt;</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;{</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;  <span class="keyword">private</span>:</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;<span class="comment"> /// \short Static array of ints to hold number of variables at </span></div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;<span class="comment"> /// nodes: Initial_Nvalue[n]</span></div>
<div class="line"><a name="l00666"></a><span class="lineno"><a class="line" href="classoomph_1_1QWomersleyElement.html#ae91c242198d9b4683a446f711e6acd4b">  666</a></span>&#160;<span class="comment"></span> <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <a class="code" href="classoomph_1_1QWomersleyElement.html#ae91c242198d9b4683a446f711e6acd4b">Initial_Nvalue</a>;</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160; </div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;  <span class="keyword">public</span>:</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;<span class="comment"> ///\short  Constructor: Call constructors for QElement and </span></div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;<span class="comment"> /// Womersley equations</span></div>
<div class="line"><a name="l00672"></a><span class="lineno"><a class="line" href="classoomph_1_1QWomersleyElement.html#a42dc522e6a7adb0b87e335a797d07bf4">  672</a></span>&#160;<span class="comment"></span> <a class="code" href="classoomph_1_1QWomersleyElement.html#a42dc522e6a7adb0b87e335a797d07bf4">QWomersleyElement</a>() : <a class="code" href="classoomph_1_1QElement.html">QElement</a>&lt;DIM,NNODE_1D&gt;(), </div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;  <a class="code" href="classoomph_1_1WomersleyEquations.html">WomersleyEquations</a>&lt;DIM&gt;()</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;  { }</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;<span class="comment"> /// Broken copy constructor</span></div>
<div class="line"><a name="l00677"></a><span class="lineno"><a class="line" href="classoomph_1_1QWomersleyElement.html#a4dee9f42d861ede7e487652ed6cc0927">  677</a></span>&#160;<span class="comment"></span> <a class="code" href="classoomph_1_1QWomersleyElement.html#a4dee9f42d861ede7e487652ed6cc0927">QWomersleyElement</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1QWomersleyElement.html">QWomersleyElement&lt;DIM,NNODE_1D&gt;</a>&amp; dummy) </div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;  { </div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;   <a class="code" href="namespaceoomph_1_1BrokenCopy.html#a7e5cd7fda8b8c790003151bee77a84ac">BrokenCopy::broken_copy</a>(<span class="stringliteral">&quot;QWomersleyElement&quot;</span>);</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;  } </div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;<span class="comment"> /// Broken assignment operator</span></div>
<div class="line"><a name="l00683"></a><span class="lineno"><a class="line" href="classoomph_1_1QWomersleyElement.html#af95b3c5a12638d2bfcc97435a987f8cf">  683</a></span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1QWomersleyElement.html#af95b3c5a12638d2bfcc97435a987f8cf">operator=</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1QWomersleyElement.html">QWomersleyElement&lt;DIM,NNODE_1D&gt;</a>&amp;) </div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;  {</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;   <a class="code" href="namespaceoomph_1_1BrokenCopy.html#a32dc384e671e786bac0c67cbff701f45">BrokenCopy::broken_assign</a>(<span class="stringliteral">&quot;QWomersleyElement&quot;</span>);</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;  }</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;<span class="comment"> /// \short  Required  # of `values&#39; (pinned or dofs) </span></div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;<span class="comment"> /// at node n</span></div>
<div class="line"><a name="l00690"></a><span class="lineno"><a class="line" href="classoomph_1_1QWomersleyElement.html#a31a20c3d89a4bc5698c81e01ca22dc8d">  690</a></span>&#160;<span class="comment"></span> <span class="keyword">inline</span> <span class="keywordtype">unsigned</span> <a class="code" href="classoomph_1_1QWomersleyElement.html#a31a20c3d89a4bc5698c81e01ca22dc8d">required_nvalue</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;<a class="code" href="the__data__structure_8txt.html#af88b2d950fae19ab641bd1690e08445c">n</a>)<span class="keyword"> const </span></div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;<span class="keyword">  </span>{<span class="keywordflow">return</span> <a class="code" href="classoomph_1_1QWomersleyElement.html#ae91c242198d9b4683a446f711e6acd4b">Initial_Nvalue</a>;}</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;<span class="comment"> /// \short Output function:  </span></div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;<span class="comment"> ///  x,y,u   or    x,y,z,u</span></div>
<div class="line"><a name="l00695"></a><span class="lineno"><a class="line" href="classoomph_1_1QWomersleyElement.html#a5a8951b6a947e120821c1a83048975d4">  695</a></span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1QWomersleyElement.html#a5a8951b6a947e120821c1a83048975d4">output</a>(std::ostream &amp;outfile)</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;  {<a class="code" href="classoomph_1_1WomersleyEquations.html#a9c1246d883f937888bf052b7078aee9a">WomersleyEquations&lt;DIM&gt;::output</a>(outfile);}</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160; </div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;<span class="comment"> ///  \short Output function:  </span></div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;<span class="comment"> ///   x,y,u   or    x,y,z,u at n_plot^DIM plot points</span></div>
<div class="line"><a name="l00701"></a><span class="lineno"><a class="line" href="classoomph_1_1QWomersleyElement.html#a98968ff614577c7796f293cb020831da">  701</a></span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1QWomersleyElement.html#a98968ff614577c7796f293cb020831da">output</a>(std::ostream &amp;outfile, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;n_plot)</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;  {<a class="code" href="classoomph_1_1WomersleyEquations.html#a9c1246d883f937888bf052b7078aee9a">WomersleyEquations&lt;DIM&gt;::output</a>(outfile,n_plot);}</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160; </div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160; </div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;<span class="comment"> /// \short C-style output function:  </span></div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;<span class="comment"> ///  x,y,u   or    x,y,z,u</span></div>
<div class="line"><a name="l00708"></a><span class="lineno"><a class="line" href="classoomph_1_1QWomersleyElement.html#a2d73507033cac13eed334354502663d6">  708</a></span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1QWomersleyElement.html#a2d73507033cac13eed334354502663d6">output</a>(FILE* file_pt)</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;  {<a class="code" href="classoomph_1_1WomersleyEquations.html#a9c1246d883f937888bf052b7078aee9a">WomersleyEquations&lt;DIM&gt;::output</a>(file_pt);}</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160; </div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;<span class="comment"> ///  \short C-style output function:  </span></div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;<span class="comment"> ///   x,y,u   or    x,y,z,u at n_plot^DIM plot points</span></div>
<div class="line"><a name="l00714"></a><span class="lineno"><a class="line" href="classoomph_1_1QWomersleyElement.html#aedac8e0c2b41e446b7c835731b179255">  714</a></span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1QWomersleyElement.html#aedac8e0c2b41e446b7c835731b179255">output</a>(FILE* file_pt, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;n_plot)</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;  {<a class="code" href="classoomph_1_1WomersleyEquations.html#a9c1246d883f937888bf052b7078aee9a">WomersleyEquations&lt;DIM&gt;::output</a>(file_pt,n_plot);}</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160; </div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;<span class="comment"> /// \short Output function for an exact solution:</span></div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;<span class="comment"> ///  x,y,u_exact   or    x,y,z,u_exact at n_plot^DIM plot points</span></div>
<div class="line"><a name="l00720"></a><span class="lineno"><a class="line" href="classoomph_1_1QWomersleyElement.html#ae15d32d03c1e64811cc29098c85d1e23">  720</a></span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1QWomersleyElement.html#ae15d32d03c1e64811cc29098c85d1e23">output_fct</a>(std::ostream &amp;outfile, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;n_plot,</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;                 <a class="code" href="classoomph_1_1FiniteElement.html#a690fd33af26cc3e84f39bba6d5a85202">FiniteElement::SteadyExactSolutionFctPt</a> </div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;                 exact_soln_pt)</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;  {<a class="code" href="classoomph_1_1WomersleyEquations.html#aebc178cae7a5f50da1f76eed2ea3972d">WomersleyEquations&lt;DIM&gt;::output_fct</a>(outfile,n_plot,exact_soln_pt);}</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160; </div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160; </div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;<span class="comment"> /// \short Output function for a time-dependent exact solution.</span></div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;<span class="comment"> ///  x,y,u_exact   or    x,y,z,u_exact at n_plot^DIM plot points</span></div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;<span class="comment"> /// (Calls the steady version)</span></div>
<div class="line"><a name="l00730"></a><span class="lineno"><a class="line" href="classoomph_1_1QWomersleyElement.html#a2730f3cf9212c0b5cbc22939a376af07">  730</a></span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1QWomersleyElement.html#a2730f3cf9212c0b5cbc22939a376af07">output_fct</a>(std::ostream &amp;outfile, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;n_plot,</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;                 <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; time,</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;                 <a class="code" href="classoomph_1_1FiniteElement.html#ad4ecf2b61b158a4b4d351a60d23c633e">FiniteElement::UnsteadyExactSolutionFctPt</a> exact_soln_pt)</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;  {<a class="code" href="classoomph_1_1WomersleyEquations.html#aebc178cae7a5f50da1f76eed2ea3972d">WomersleyEquations&lt;DIM&gt;::output_fct</a>(outfile,n_plot,time,exact_soln_pt);}</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160; </div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160; </div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160; </div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;<span class="keyword">protected</span>:</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;<span class="comment"> /// Shape, test functions &amp; derivs. w.r.t. to global coords. Return Jacobian.</span></div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;<span class="comment"></span> <span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1QWomersleyElement.html#afe507e9f0d7359d47c0c682fed7c952b">dshape_and_dtest_eulerian_womersley</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>, </div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;                                                  <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;psi, </div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;                                                  <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;dpsidx, </div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;                                                  <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;test, </div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;                                                  <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;dtestdx) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160; </div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;<span class="comment"> /// \short Shape/test functions and derivs w.r.t. to global coords at </span></div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;<span class="comment"> /// integration point ipt; return  Jacobian of mapping</span></div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;<span class="comment"></span> <span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1QWomersleyElement.html#a5c4db93fb861995c7910ffe44751f449">dshape_and_dtest_eulerian_at_knot_womersley</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;ipt, </div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;                                                          <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;psi, </div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;                                                          <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;dpsidx,</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;                                                          <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;test, </div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;                                                          <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;dtestdx)</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;  <span class="keyword">const</span>;</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160; </div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;};</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160; </div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160; </div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;<span class="comment">//=====start_of_problem_class=========================================</span><span class="comment"></span></div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;<span class="comment">/// Womersley problem </span></div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;<span class="comment"></span><span class="comment">//====================================================================</span></div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> ELEMENT, <span class="keywordtype">unsigned</span> DIM&gt;</div>
<div class="line"><a name="l00768"></a><span class="lineno"><a class="line" href="classoomph_1_1WomersleyProblem.html">  768</a></span>&#160;<span class="keyword">class </span><a class="code" href="classoomph_1_1WomersleyProblem.html">WomersleyProblem</a> : <span class="keyword">public</span> <a class="code" href="classoomph_1_1Problem.html">Problem</a></div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;{</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160; </div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;<span class="comment"> /// \short Function pointer to fct that prescribes pressure gradient </span></div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;<span class="comment"> /// g=fct(t)</span></div>
<div class="line"><a name="l00775"></a><span class="lineno"><a class="line" href="classoomph_1_1WomersleyProblem.html#ac3607d12a92dede9ed2e93ae64f300b3">  775</a></span>&#160;<span class="comment"></span> <span class="keyword">typedef</span> double (*<a class="code" href="classoomph_1_1WomersleyProblem.html#ac3607d12a92dede9ed2e93ae64f300b3">PrescribedPressureGradientFctPt</a>)(<span class="keyword">const</span> <span class="keywordtype">double</span>&amp; <a class="code" href="classoomph_1_1Problem.html#a6e6329fadca85c56eff22af23338dfe9">time</a>);</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160; </div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;<span class="comment"> /// \short Constructor: Pass pointer to Womersley number, pointer to the</span></div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;<span class="comment"> /// double that stores the currently imposed flow rate, the pointer</span></div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;<span class="comment"> /// to the mesh of WomersleyElements (of the type specified by the template</span></div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;<span class="comment"> /// argument) and the TimeStepper used in these</span></div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;<span class="comment"> /// elements. (Note that the mesh must be created, and boundary</span></div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;<span class="comment"> /// conditions applied BEFORE creating the Womersley problem.</span></div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;<span class="comment"> /// This is to facilitate the re-use of this class</span></div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;<span class="comment"> /// for different geometries.</span></div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;<span class="comment"></span> <a class="code" href="classoomph_1_1WomersleyProblem.html#aa3b907c22d24bd76659a2f7c3b35c91a">WomersleyProblem</a>(<span class="keywordtype">double</span>* re_st_pt, </div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;                  <span class="keywordtype">double</span>* prescribed_volume_flux_pt,</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;                  <a class="code" href="classoomph_1_1TimeStepper.html">TimeStepper</a>* <a class="code" href="classoomph_1_1Problem.html#acfdb74e8522fa5d486064998e7223fc6">time_stepper_pt</a>,</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;                  <a class="code" href="classoomph_1_1Mesh.html">Mesh</a>* womersley_mesh_pt);</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160; </div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;<span class="comment"> /// \short Constructor: Pass pointer to Womersley number, pointer to the</span></div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;<span class="comment"> /// function that returns the imposed pressure gradient, the pointer</span></div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;<span class="comment"> /// to the mesh of WomersleyElements and the TimeStepper used in these</span></div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;<span class="comment"> /// elements. (Note that the mesh must be created, and boundary</span></div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;<span class="comment"> /// conditions applied BEFORE creating the Womersley problem.</span></div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;<span class="comment"> /// This is to allow the facilitate the re-use of this class</span></div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;<span class="comment"> /// for different geometries.)</span></div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;<span class="comment"></span> <a class="code" href="classoomph_1_1WomersleyProblem.html#aa3b907c22d24bd76659a2f7c3b35c91a">WomersleyProblem</a>(<span class="keywordtype">double</span>* re_st_pt, </div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;                  <a class="code" href="classoomph_1_1WomersleyProblem.html#ac3607d12a92dede9ed2e93ae64f300b3">PrescribedPressureGradientFctPt</a> pressure_gradient_fct_pt,</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;                  <a class="code" href="classoomph_1_1TimeStepper.html">TimeStepper</a>* <a class="code" href="classoomph_1_1Problem.html#acfdb74e8522fa5d486064998e7223fc6">time_stepper_pt</a>,</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;                  <a class="code" href="classoomph_1_1Mesh.html">Mesh</a>* womersley_mesh_pt);</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;<span class="comment"> /// Destructor to clean up memory</span></div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;<span class="comment"></span> <a class="code" href="classoomph_1_1WomersleyProblem.html#a9a8cc169abe4814d9f9851f4eb936701">~WomersleyProblem</a>();</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;<span class="comment"> /// Update the problem specs after solve (empty)</span></div>
<div class="line"><a name="l00808"></a><span class="lineno"><a class="line" href="classoomph_1_1WomersleyProblem.html#a248ab44d5058e1e29dab4fbfc52bf942">  808</a></span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1WomersleyProblem.html#a248ab44d5058e1e29dab4fbfc52bf942">actions_after_newton_solve</a>() {}</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;<span class="comment"> /// \short Update the problem specs before solve (empty)</span></div>
<div class="line"><a name="l00811"></a><span class="lineno"><a class="line" href="classoomph_1_1WomersleyProblem.html#a7aa82fe18099c9770edf9fa8e79a2028">  811</a></span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1WomersleyProblem.html#a7aa82fe18099c9770edf9fa8e79a2028">actions_before_newton_solve</a>() {}</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160; </div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;<span class="comment"> /// \short Update the problem specs before next timestep: </span></div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;<span class="comment"> /// Update time-varying pressure gradient (if prescribed)</span></div>
<div class="line"><a name="l00816"></a><span class="lineno"><a class="line" href="classoomph_1_1WomersleyProblem.html#af87f80658aaadaee2d7c8d0c06ad159e">  816</a></span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1WomersleyProblem.html#af87f80658aaadaee2d7c8d0c06ad159e">actions_before_implicit_timestep</a>()</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;  {<span class="comment"></span></div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;<span class="comment">   /// Assign current prescribed pressure gradient to Data</span></div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;<span class="comment"></span>   <span class="keywordflow">if</span> (<a class="code" href="classoomph_1_1WomersleyProblem.html#a54d5137eeb495e40382576392720611f">Prescribed_pressure_gradient_fct_pt</a>!=0)</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;    {</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;     <a class="code" href="classoomph_1_1WomersleyProblem.html#ad82799a978674bc9f49ac3240d43c34d">Pressure_gradient_data_pt</a>-&gt;<a class="code" href="classoomph_1_1Data.html#a7289ca322725c6fd493970a19474b382">set_value</a>(</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;      0,<a class="code" href="classoomph_1_1WomersleyProblem.html#a54d5137eeb495e40382576392720611f">Prescribed_pressure_gradient_fct_pt</a>(<a class="code" href="classoomph_1_1Problem.html#a425403e4cb6678015b20f2dddc7a2f89">time_pt</a>()-&gt;<a class="code" href="classoomph_1_1Problem.html#a6e6329fadca85c56eff22af23338dfe9">time</a>()));</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;    }</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;  }</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;<span class="comment"> /// \short Doc the solution incl. trace file for various quantities of</span></div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;<span class="comment"> /// interest (to some...)</span></div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1WomersleyProblem.html#a6ed55a744929154a6b8d3b7bb9f0570a">doc_solution</a>(<a class="code" href="classoomph_1_1DocInfo.html">DocInfo</a>&amp; doc_info, </div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;                   std::ofstream&amp; trace_file,</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;                   <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; z_out=0.0);</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;<span class="comment"> /// Doc the solution</span></div>
<div class="line"><a name="l00833"></a><span class="lineno"><a class="line" href="classoomph_1_1WomersleyProblem.html#a367c83d9a996c426cb65a7baa86af81b">  833</a></span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1WomersleyProblem.html#a367c83d9a996c426cb65a7baa86af81b">doc_solution</a>(<a class="code" href="classoomph_1_1DocInfo.html">DocInfo</a>&amp; doc_info, </div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;                   <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; z_out=0.0)</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160; {</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;  std::ofstream trace_file;</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;  <a class="code" href="classoomph_1_1WomersleyProblem.html#a6ed55a744929154a6b8d3b7bb9f0570a">doc_solution</a>(doc_info,trace_file,z_out);</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160; }</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;<span class="comment"> /// \short Access function to the single-valued Data object that</span></div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;<span class="comment"> /// contains the unknown pressure gradient (used if flux is prescribed)</span></div>
<div class="line"><a name="l00842"></a><span class="lineno"><a class="line" href="classoomph_1_1WomersleyProblem.html#a648496a026e53b453e16c161f9f44434">  842</a></span>&#160;<span class="comment"></span> <a class="code" href="classoomph_1_1Data.html">Data</a>* <a class="code" href="classoomph_1_1WomersleyProblem.html#a648496a026e53b453e16c161f9f44434">pressure_gradient_data_pt</a>()</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;  {</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="classoomph_1_1WomersleyProblem.html#ad82799a978674bc9f49ac3240d43c34d">Pressure_gradient_data_pt</a>;</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;  }</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160; </div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160; </div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;<span class="comment"> /// Pointer to currently prescribed volume flux</span></div>
<div class="line"><a name="l00851"></a><span class="lineno"><a class="line" href="classoomph_1_1WomersleyProblem.html#a8880c101a67eb960adac41775ebf2029">  851</a></span>&#160;<span class="comment"></span> <span class="keywordtype">double</span>* <a class="code" href="classoomph_1_1WomersleyProblem.html#a8880c101a67eb960adac41775ebf2029">Prescribed_volume_flux_pt</a>;</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;<span class="comment"> /// \short Pointer to element that imposes the flux through the collection</span></div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;<span class="comment"> /// of Womersley elements</span></div>
<div class="line"><a name="l00855"></a><span class="lineno"><a class="line" href="classoomph_1_1WomersleyProblem.html#a4816844a22263d5f39ff8ca5d2c370ba">  855</a></span>&#160;<span class="comment"></span> <a class="code" href="classoomph_1_1ImposeFluxForWomersleyElement.html">ImposeFluxForWomersleyElement&lt;DIM&gt;</a>* <a class="code" href="classoomph_1_1WomersleyProblem.html#a4816844a22263d5f39ff8ca5d2c370ba">Flux_el_pt</a>;</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;<span class="comment"> /// Fct pointer to fct that prescribes pressure gradient</span></div>
<div class="line"><a name="l00858"></a><span class="lineno"><a class="line" href="classoomph_1_1WomersleyProblem.html#a54d5137eeb495e40382576392720611f">  858</a></span>&#160;<span class="comment"></span> <a class="code" href="classoomph_1_1WomersleyProblem.html#ac3607d12a92dede9ed2e93ae64f300b3">PrescribedPressureGradientFctPt</a> <a class="code" href="classoomph_1_1WomersleyProblem.html#a54d5137eeb495e40382576392720611f">Prescribed_pressure_gradient_fct_pt</a>;</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;<span class="comment"> /// Pointer to single-valued Data item that stores pressure gradient</span></div>
<div class="line"><a name="l00861"></a><span class="lineno"><a class="line" href="classoomph_1_1WomersleyProblem.html#ad82799a978674bc9f49ac3240d43c34d">  861</a></span>&#160;<span class="comment"></span> <a class="code" href="classoomph_1_1Data.html">Data</a>* <a class="code" href="classoomph_1_1WomersleyProblem.html#ad82799a978674bc9f49ac3240d43c34d">Pressure_gradient_data_pt</a>;</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160; </div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;}; <span class="comment">// end of problem class</span></div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160; </div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160; </div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160; </div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160; </div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160; </div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;<span class="comment">//========start_of_constructor============================================</span><span class="comment"></span></div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;<span class="comment">/// Constructor: Pass pointer to Womersley number, fct pointer to the</span></div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;<span class="comment">/// function that returns the prescribed pressure gradient, the pointer</span></div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;<span class="comment">/// to the mesh of WomersleyElements (of the type specified by the</span></div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;<span class="comment">/// template argument), and the TimeStepper used in these</span></div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;<span class="comment">/// elements. (Note that the mesh must be created, and boundary</span></div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;<span class="comment">/// conditions applied BEFORE creating the Womersley problem.</span></div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;<span class="comment">/// This is to facilitate the re-use of this class</span></div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;<span class="comment">/// for different geometries.)</span></div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;<span class="comment"></span><span class="comment">//========================================================================</span></div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> ELEMENT, <span class="keywordtype">unsigned</span> DIM&gt;</div>
<div class="line"><a name="l00880"></a><span class="lineno"><a class="line" href="classoomph_1_1WomersleyProblem.html#adc4074cd09df4505feb27e22abb6922a">  880</a></span>&#160;<a class="code" href="classoomph_1_1WomersleyProblem.html#aa3b907c22d24bd76659a2f7c3b35c91a">WomersleyProblem&lt;ELEMENT,DIM&gt;::WomersleyProblem</a>(</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160; <span class="keywordtype">double</span>* re_st_pt, </div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160; PrescribedPressureGradientFctPt pressure_gradient_fct_pt,</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160; <a class="code" href="classoomph_1_1TimeStepper.html">TimeStepper</a>* time_stepper_pt,</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160; <a class="code" href="classoomph_1_1Mesh.html">Mesh</a>* womersley_mesh_pt) :</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160; Prescribed_volume_flux_pt(0),</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160; Flux_el_pt(0),</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160; Prescribed_pressure_gradient_fct_pt(pressure_gradient_fct_pt)</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;{</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160; </div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160; <span class="comment">// Problem is linear: Skip convergence check in Newton solver</span></div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160; Problem_is_nonlinear=<span class="keyword">false</span>;</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160; </div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160; <span class="comment">// Set the timestepper</span></div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160; add_time_stepper_pt(time_stepper_pt);</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160; </div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160; <span class="comment">// Set the mesh (bcs have already been allocated!)</span></div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160; mesh_pt() = womersley_mesh_pt;</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160; </div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160; <span class="comment">// Complete the build of all elements so they are fully functional</span></div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160; <span class="comment">//----------------------------------------------------------------</span></div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160; </div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160; <span class="comment">// Find number of elements in mesh</span></div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160; <span class="keywordtype">unsigned</span> n_element = mesh_pt()-&gt;<a class="code" href="classoomph_1_1Mesh.html#af01dfefb66c15579b540be62999d93ee">nelement</a>();</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160; </div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160; <span class="comment">// Loop over the elements to set up element-specific </span></div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160; <span class="comment">// things that cannot be handled by constructor</span></div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160; <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;n_element;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;  {</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;   <span class="comment">// Upcast from FiniteElement to the present element</span></div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;   ELEMENT *el_pt = <span class="keyword">dynamic_cast&lt;</span>ELEMENT*<span class="keyword">&gt;</span>(mesh_pt()-&gt;element_pt(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>));</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160; </div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;   <span class="comment">// Set pointer to Womersley number</span></div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;   el_pt-&gt;re_st_pt()=re_st_pt;</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;  }</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160; </div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160; <span class="comment">// Create pressure gradient as pinned, single-valued Data item</span></div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160; Pressure_gradient_data_pt=<span class="keyword">new</span> <a class="code" href="the__data__structure_8txt.html#ae789c4a233fe5f1aa45cf1f92efdf494">Data</a>(1);</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160; Pressure_gradient_data_pt-&gt;pin(0);</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160; </div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160; <span class="comment">// Pass pointer to pressure gradient Data to elements</span></div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160; <span class="keywordtype">unsigned</span> nelem=mesh_pt()-&gt;nelement();</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160; <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#a37cd013acc76697829c324bdd8562d82">e</a>=0;<a class="code" href="cfortran_8h.html#a37cd013acc76697829c324bdd8562d82">e</a>&lt;nelem;<a class="code" href="cfortran_8h.html#a37cd013acc76697829c324bdd8562d82">e</a>++)</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;  {</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;   ELEMENT* el_pt=<span class="keyword">dynamic_cast&lt;</span>ELEMENT*<span class="keyword">&gt;</span>(mesh_pt()-&gt;element_pt(<a class="code" href="cfortran_8h.html#a37cd013acc76697829c324bdd8562d82">e</a>));</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;   <span class="keywordflow">if</span> (el_pt!=0)</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;    {</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;     el_pt-&gt;set_pressure_gradient_pt(Pressure_gradient_data_pt);</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;    }</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;  }</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160; </div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160; </div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160; <span class="comment">// Do equation numbering</span></div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160; <a class="code" href="namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt;<span class="stringliteral">&quot;Number of equations in WomersleyProblem: &quot;</span> </div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;            &lt;&lt; assign_eqn_numbers() &lt;&lt; std::endl; </div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160; </div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;} <span class="comment">// end of constructor</span></div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160; </div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160; </div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160; </div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160; </div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160; </div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;<span class="comment">//========start_of_constructor============================================</span><span class="comment"></span></div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;<span class="comment">/// Constructor: Pass pointer to Womersley number,  pointer to the</span></div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;<span class="comment">/// double that stores the currently imposed flow rate, the pointer</span></div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;<span class="comment">/// to the mesh of WomersleyElements and the TimeStepper used in these</span></div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;<span class="comment">/// elements. (Note that the mesh must be created, and boundary</span></div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;<span class="comment">/// conditions applied BEFORE creating the Womersley problem.</span></div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;<span class="comment">/// This is to facilitate the re-use of this class</span></div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;<span class="comment">/// for different geometries.)</span></div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;<span class="comment"></span><span class="comment">//========================================================================</span></div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> ELEMENT, <span class="keywordtype">unsigned</span> DIM&gt;</div>
<div class="line"><a name="l00952"></a><span class="lineno"><a class="line" href="classoomph_1_1WomersleyProblem.html#aa3b907c22d24bd76659a2f7c3b35c91a">  952</a></span>&#160;<a class="code" href="classoomph_1_1WomersleyProblem.html">WomersleyProblem&lt;ELEMENT,DIM&gt;::WomersleyProblem</a>(</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160; <span class="keywordtype">double</span>* re_st_pt,</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160; <span class="keywordtype">double</span>* prescribed_volume_flux_pt,</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160; <a class="code" href="classoomph_1_1TimeStepper.html">TimeStepper</a>* time_stepper_pt,</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160; <a class="code" href="classoomph_1_1Mesh.html">Mesh</a>* womersley_mesh_pt) : </div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160; Prescribed_volume_flux_pt(prescribed_volume_flux_pt),</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160; Flux_el_pt(0),</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160; Prescribed_pressure_gradient_fct_pt(0)</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;{</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160; <span class="comment">// Problem is linear: Skip convergence check in Newton solver</span></div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160; Problem_is_nonlinear=<span class="keyword">false</span>;</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160; </div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160; <span class="comment">// Set the timestepper</span></div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160; add_time_stepper_pt(time_stepper_pt);</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160; </div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160; <span class="comment">// Set the mesh (bcs have already been allocated!)</span></div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160; mesh_pt() = womersley_mesh_pt;</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160; </div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160; </div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160; <span class="comment">// Complete the build of all elements so they are fully functional</span></div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160; <span class="comment">//----------------------------------------------------------------</span></div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160; </div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160; <span class="comment">// Find number of elements in mesh</span></div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160; <span class="keywordtype">unsigned</span> n_element = mesh_pt()-&gt;<a class="code" href="classoomph_1_1Mesh.html#af01dfefb66c15579b540be62999d93ee">nelement</a>();</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160; </div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160; <span class="comment">// Loop over the elements to set up element-specific </span></div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160; <span class="comment">// things that cannot be handled by constructor</span></div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160; <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;n_element;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;  {</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;   <span class="comment">// Upcast from FiniteElement to the present element</span></div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;   ELEMENT *el_pt = <span class="keyword">dynamic_cast&lt;</span>ELEMENT*<span class="keyword">&gt;</span>(mesh_pt()-&gt;element_pt(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>));</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160; </div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;   <span class="comment">// Set pointer to Womersley number</span></div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;   el_pt-&gt;re_st_pt()=re_st_pt;</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;  }</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160; </div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160; <span class="comment">// Create element that imposes the flux -- this element creates</span></div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160; <span class="comment">// the single-valued Data object that represents the (unknown)</span></div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160; <span class="comment">// pressure gradient internally. It also passes the pointer to </span></div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160; <span class="comment">// this Data object to the Womersley elements contained in the</span></div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160; <span class="comment">// mesh. The Womersley elements treat this Data as external Data.</span></div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160; Flux_el_pt=<span class="keyword">new</span> <a class="code" href="classoomph_1_1ImposeFluxForWomersleyElement.html">ImposeFluxForWomersleyElement&lt;DIM&gt;</a>(</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;  mesh_pt(),Prescribed_volume_flux_pt);</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160; </div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160; <span class="comment">// Add the ImposeFluxForWomersleyElement to the mesh</span></div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160; mesh_pt()-&gt;add_element_pt(Flux_el_pt);</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160; </div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160; <span class="comment">// Store pressure gradient data that was</span></div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160; <span class="comment">// created in the ImposeFluxForWomersleyElement </span></div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160; Pressure_gradient_data_pt=Flux_el_pt-&gt;pressure_gradient_data_pt();</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160; </div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160; <span class="comment">// Do equation numbering</span></div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160; <a class="code" href="namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt;<span class="stringliteral">&quot;Number of equations in WomersleyProblem: &quot;</span> </div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;            &lt;&lt; assign_eqn_numbers() &lt;&lt; std::endl; </div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160; </div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;} <span class="comment">// end of constructor</span></div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160; </div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160; </div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;<span class="comment">//======start_of_destructor===============================================</span><span class="comment"></span></div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;<span class="comment">/// Destructor for Womersley problem</span></div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;<span class="comment"></span><span class="comment">//========================================================================</span></div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> ELEMENT, <span class="keywordtype">unsigned</span> DIM&gt;</div>
<div class="line"><a name="l01014"></a><span class="lineno"><a class="line" href="classoomph_1_1WomersleyProblem.html#a9a8cc169abe4814d9f9851f4eb936701"> 1014</a></span>&#160;<a class="code" href="classoomph_1_1WomersleyProblem.html">WomersleyProblem&lt;ELEMENT,DIM&gt;::~WomersleyProblem</a>()</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;{ </div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160; <span class="comment">// Timestepper gets killed in general problem destructor</span></div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160; </div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160; <span class="comment">// Mesh gets killed in general problem destructor</span></div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160; </div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;} <span class="comment">// end of destructor</span></div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160; </div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160; </div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160; </div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;<span class="comment">//=======start_of_doc_solution============================================</span><span class="comment"></span></div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;<span class="comment">/// Doc the solution</span></div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;<span class="comment"></span><span class="comment">//========================================================================</span></div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> ELEMENT, <span class="keywordtype">unsigned</span> DIM&gt;</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classoomph_1_1WomersleyProblem.html">WomersleyProblem&lt;ELEMENT,DIM&gt;::</a></div>
<div class="line"><a name="l01029"></a><span class="lineno"><a class="line" href="classoomph_1_1WomersleyProblem.html#a6ed55a744929154a6b8d3b7bb9f0570a"> 1029</a></span>&#160;<a class="code" href="classoomph_1_1WomersleyProblem.html">doc_solution</a>(<a class="code" href="classoomph_1_1DocInfo.html">DocInfo</a>&amp; doc_info,</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;             std::ofstream&amp; trace_file,</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;             <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; z_out)</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;{ </div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160; </div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160; std::ofstream some_file; </div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160; std::ofstream some_file1;</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160; std::ostringstream filename;</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160; </div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160; <span class="comment">// Number of plot points</span></div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160; <span class="keywordtype">unsigned</span> npts;</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160; npts=5;</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160; </div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160; </div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160; <span class="comment">// Compute total volume flux directly</span></div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160; <span class="keywordtype">double</span> flux=0.0;</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160; </div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160; <span class="comment">// Output solution </span></div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160; <span class="comment">//-----------------</span></div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160; filename &lt;&lt; doc_info.<a class="code" href="classoomph_1_1DocInfo.html#a85d58bcfce0a7b7cae461624e6fcd08a">directory</a>() &lt;&lt; <span class="stringliteral">&quot;/womersley_soln&quot;</span></div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;          &lt;&lt; doc_info.<a class="code" href="classoomph_1_1DocInfo.html#af27224b25da5b758442753f0947e62d4">number</a>() &lt;&lt; <span class="stringliteral">&quot;.dat&quot;</span>;</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160; some_file1.open(filename.str().c_str());</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160; </div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160; filename.str(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160; filename &lt;&lt; doc_info.<a class="code" href="classoomph_1_1DocInfo.html#a85d58bcfce0a7b7cae461624e6fcd08a">directory</a>() &lt;&lt; <span class="stringliteral">&quot;/womersley_soln_3d_&quot;</span></div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;          &lt;&lt; doc_info.<a class="code" href="classoomph_1_1DocInfo.html#af27224b25da5b758442753f0947e62d4">number</a>() &lt;&lt; <span class="stringliteral">&quot;.dat&quot;</span>;</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160; some_file.open(filename.str().c_str());</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160; </div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160; <span class="comment">// Assemble contributions from elements and output 3D solution</span></div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160; <span class="keywordtype">unsigned</span> nelem=mesh_pt()-&gt;nelement();</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160; <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#a37cd013acc76697829c324bdd8562d82">e</a>=0;<a class="code" href="cfortran_8h.html#a37cd013acc76697829c324bdd8562d82">e</a>&lt;nelem;<a class="code" href="cfortran_8h.html#a37cd013acc76697829c324bdd8562d82">e</a>++)</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;  {</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;   ELEMENT* el_pt = <span class="keyword">dynamic_cast&lt;</span>ELEMENT*<span class="keyword">&gt;</span>(mesh_pt()-&gt;element_pt(<a class="code" href="cfortran_8h.html#a37cd013acc76697829c324bdd8562d82">e</a>));</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;   <span class="keywordflow">if</span> (el_pt!=0)</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;    {</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;     flux+=el_pt-&gt;get_volume_flux();</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;     el_pt-&gt;output_3d(some_file,npts,z_out); </div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;     el_pt-&gt;output(some_file1,npts); </div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;    }</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;  }</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160; some_file.close();</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160; some_file1.close();</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160; </div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160; <span class="keywordtype">double</span> prescribed_g=0.0;</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160; <span class="keywordflow">if</span> (Prescribed_pressure_gradient_fct_pt!=0)</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;  {</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;   prescribed_g=Prescribed_pressure_gradient_fct_pt(time_pt()-&gt;time());</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;  }</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160; </div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160; </div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160; <span class="keywordtype">double</span> prescribed_q=0.0;</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160; <span class="keywordflow">if</span> (Prescribed_volume_flux_pt!=0)</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;  {</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;   prescribed_q=*Prescribed_volume_flux_pt;</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;  }</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160; </div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160; <span class="keywordflow">if</span> (trace_file.is_open())</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;  {</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;   trace_file </div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;    &lt;&lt; time_pt()-&gt;time() &lt;&lt; <span class="stringliteral">&quot; &quot;</span> </div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;    &lt;&lt; pressure_gradient_data_pt()-&gt;value(0) &lt;&lt; <span class="stringliteral">&quot; &quot;</span> </div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;    &lt;&lt; flux &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;    &lt;&lt; prescribed_g &lt;&lt; <span class="stringliteral">&quot; &quot;</span> </div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;    &lt;&lt; prescribed_q &lt;&lt; <span class="stringliteral">&quot; &quot;</span> </div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;    &lt;&lt; std::endl;</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;  }</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160; </div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;} <span class="comment">// end of doc_solution</span></div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160; </div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160; </div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160; </div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160; </div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160; </div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;<span class="comment">//====================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;<span class="comment">/// Base class for Womersley impedance tube. Allows the computation</span></div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;<span class="comment">/// of the inlet pressure p_in into a uniform tube of specified length </span></div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;<span class="comment">/// that is assumed to convey fully-developed, but time-dependent flow with a</span></div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;<span class="comment">/// presribed instantaneous flow rate, q. Also computes the derivative</span></div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;<span class="comment">/// dp_in/dq required when this is used to determine impedance-type</span></div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;<span class="comment">/// outlet boundary conditions in a Navier-Stokes computation. </span></div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;<span class="comment"></span><span class="comment">//====================================================================</span></div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> ELEMENT, <span class="keywordtype">unsigned</span> DIM&gt;</div>
<div class="line"><a name="l01116"></a><span class="lineno"><a class="line" href="classoomph_1_1WomersleyImpedanceTubeBase.html"> 1116</a></span>&#160;<span class="keyword">class </span><a class="code" href="classoomph_1_1WomersleyImpedanceTubeBase.html">WomersleyImpedanceTubeBase</a> : </div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;<span class="keyword">public</span> <span class="keyword">virtual</span> <a class="code" href="classoomph_1_1TemplateFreeWomersleyImpedanceTubeBase.html">TemplateFreeWomersleyImpedanceTubeBase</a></div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;{</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160; </div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;<span class="comment"> /// \short Function pointer to fct that prescribes volume flux </span></div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;<span class="comment"> /// q=fct(t)  -- mainly used for validation purposes.</span></div>
<div class="line"><a name="l01124"></a><span class="lineno"><a class="line" href="classoomph_1_1WomersleyImpedanceTubeBase.html#a329107c12ef8f97c5afd4e0ae5d67b70"> 1124</a></span>&#160;<span class="comment"></span> <span class="keyword">typedef</span> double (*PrescribedVolumeFluxFctPt)(<span class="keyword">const</span> <span class="keywordtype">double</span>&amp; time);</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160; </div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;<span class="comment"> /// \short Constructor: Specify length of tube and pointer to function that</span></div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;<span class="comment"> /// specifies the prescribed volume flux. Outlet pressure is set to zero.</span></div>
<div class="line"><a name="l01129"></a><span class="lineno"><a class="line" href="classoomph_1_1WomersleyImpedanceTubeBase.html#a552fa003624cfb4e31da70f800f0669c"> 1129</a></span>&#160;<span class="comment"></span> <a class="code" href="classoomph_1_1WomersleyImpedanceTubeBase.html#a552fa003624cfb4e31da70f800f0669c">WomersleyImpedanceTubeBase</a>(</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; length,</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;  PrescribedVolumeFluxFctPt prescribed_volume_flux_fct_pt) : </div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;  Length(length),</div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;  P_out(0.0), </div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;  Prescribed_volume_flux_fct_pt(prescribed_volume_flux_fct_pt),</div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;  Navier_stokes_outflow_mesh_pt(0)</div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;  {</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;   <span class="comment">// Initialise currently prescribed flux</span></div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;   Current_volume_flux_pt= <span class="keyword">new</span> double(0.0);</div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160; </div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;   <span class="comment">// Auxiliary integral isn&#39;t used if flux isn&#39;t prescribed</span></div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;   <span class="comment">// via outflow through NavierStokesImpedanceTractionElements</span></div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;   Aux_integral_pt=0;</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;  }</div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160; </div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;<span class="comment"> /// \short Constructor: Specify length of tube and the pointer to the</span></div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;<span class="comment"> /// mesh of either NavierStokesImpedanceTractionElements or</span></div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;<span class="comment"> /// NavierStokesFluxControlElements that are attached </span></div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;<span class="comment"> /// to the outflow cross-section of a (higher-dimensional) </span></div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;<span class="comment"> /// Navier Stokes mesh and provide the inflow into the ImpedanceTube.</span></div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;<span class="comment"> /// Outlet pressure is set to zero.</span></div>
<div class="line"><a name="l01152"></a><span class="lineno"><a class="line" href="classoomph_1_1WomersleyImpedanceTubeBase.html#a79e8b7fb0c3edb3956aef7cf7c8bf719"> 1152</a></span>&#160;<span class="comment"></span> <a class="code" href="classoomph_1_1WomersleyImpedanceTubeBase.html#a79e8b7fb0c3edb3956aef7cf7c8bf719">WomersleyImpedanceTubeBase</a>(</div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; length,</div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;  <a class="code" href="classoomph_1_1Mesh.html">Mesh</a>* navier_stokes_outflow_mesh_pt) :</div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;  Length(length),</div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;  P_out(0.0), </div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;  Prescribed_volume_flux_fct_pt(0),</div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;  Navier_stokes_outflow_mesh_pt(navier_stokes_outflow_mesh_pt)</div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;  {</div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;   <span class="comment">// Initialise currently prescribed flux</span></div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;   Current_volume_flux_pt= <span class="keyword">new</span> double(0.0);</div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160; </div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;   <span class="comment">// Initialise flag to record if NavierStokesFluxControlElement </span></div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;   <span class="comment">// or NavierStokesImpedanceTractionElement elements are being used</span></div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;   Using_flux_control_elements=<span class="keyword">true</span>;</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160; </div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;   <span class="comment">// Attempt to cast 1st element to NavierStokesImpedanceTractionElementBase</span></div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;   <span class="keywordflow">if</span> (<span class="keyword">dynamic_cast&lt;</span><a class="code" href="classoomph_1_1NavierStokesImpedanceTractionElementBase.html">NavierStokesImpedanceTractionElementBase</a>*<span class="keyword">&gt;</span>(</div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;        navier_stokes_outflow_mesh_pt-&gt;<a class="code" href="classoomph_1_1Mesh.html#a3c3b85a1be4d9b01f1c0805142a37966">element_pt</a>(0)))</div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;    {</div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;     Using_flux_control_elements=<span class="keyword">false</span>;</div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;     </div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;     <span class="comment">// Create map used to store the non-zero entries of the</span></div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;     <span class="comment">// auxiliary integral, containing the derivative of the total</span></div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;     <span class="comment">// volume flux through the outflow boundary of the (higher-dimensional)</span></div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;     <span class="comment">// Navier-Stokes mesh w.r.t. to the discrete (global) (velocity)</span></div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;     <span class="comment">// degrees of freedom.</span></div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;     Aux_integral_pt=<span class="keyword">new</span> std::map&lt;unsigned,double&gt;;</div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;     </div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;     <span class="comment">// Pass pointer to Navier_stokes_outflow_mesh_pt to the Navier</span></div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;     <span class="comment">// Stokes traction elements</span></div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;     <span class="keywordtype">unsigned</span> nelem=navier_stokes_outflow_mesh_pt-&gt;<a class="code" href="classoomph_1_1Mesh.html#af01dfefb66c15579b540be62999d93ee">nelement</a>();</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#a37cd013acc76697829c324bdd8562d82">e</a>=0;<a class="code" href="cfortran_8h.html#a37cd013acc76697829c324bdd8562d82">e</a>&lt;nelem;<a class="code" href="cfortran_8h.html#a37cd013acc76697829c324bdd8562d82">e</a>++)</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;      {</div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;       <a class="code" href="classoomph_1_1NavierStokesImpedanceTractionElementBase.html">NavierStokesImpedanceTractionElementBase</a>* el_pt=</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;        <span class="keyword">dynamic_cast&lt;</span><a class="code" href="classoomph_1_1NavierStokesImpedanceTractionElementBase.html">NavierStokesImpedanceTractionElementBase</a>*<span class="keyword">&gt;</span>(</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;         navier_stokes_outflow_mesh_pt-&gt;<a class="code" href="classoomph_1_1Mesh.html#a3c3b85a1be4d9b01f1c0805142a37966">element_pt</a>(<a class="code" href="cfortran_8h.html#a37cd013acc76697829c324bdd8562d82">e</a>));</div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;       </div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;       <span class="comment">// Pass the mesh of all NavierStokesImpedanceTractionElements to</span></div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;       <span class="comment">// each NavierStokesImpedanceTractionElements in that mesh</span></div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;       <span class="comment">// and treat nodes in that mesh that are not part of the element</span></div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;       <span class="comment">// itself as external data (since they affect the total volume</span></div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;       <span class="comment">// flux and therefore the traction onto the element).</span></div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;       el_pt-&gt;<a class="code" href="classoomph_1_1NavierStokesImpedanceTractionElementBase.html#a648cfcbd9bf1f3404b0e7f184cecdc62">set_external_data_from_navier_stokes_outflow_mesh</a>(</div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;        navier_stokes_outflow_mesh_pt);</div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;      }</div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;    }</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;   <span class="comment">// Test to make sure the elements in the mesh are valid</span></div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;   <span class="keywordflow">else</span></div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;    {</div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;     <span class="keywordflow">if</span> (!<span class="keyword">dynamic_cast&lt;</span><a class="code" href="classoomph_1_1TemplateFreeNavierStokesFluxControlElementBase.html">TemplateFreeNavierStokesFluxControlElementBase</a>*<span class="keyword">&gt;</span>(</div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;          navier_stokes_outflow_mesh_pt-&gt;<a class="code" href="classoomph_1_1Mesh.html#a3c3b85a1be4d9b01f1c0805142a37966">element_pt</a>(0)))</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;      {</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;       std::ostringstream error_message;</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;       error_message &lt;&lt; <span class="stringliteral">&quot;WomersleyImpedanceTubeBase requires a Navier-Stokes\n&quot;</span></div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;                     &lt;&lt; <span class="stringliteral">&quot;outflow mesh of elements which inherit from either\n&quot;</span></div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;                     &lt;&lt; <span class="stringliteral">&quot;TemplateFreeNavierStokesFluxControlElementBase or\n&quot;</span></div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;                     &lt;&lt; <span class="stringliteral">&quot;NavierStokesImpedanceTractionElementBase.\n&quot;</span>;</div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;       <span class="keywordflow">throw</span> <a class="code" href="classoomph_1_1OomphLibError.html">OomphLibError</a>(</div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;        error_message.str(),</div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;        OOMPH_CURRENT_FUNCTION,</div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;        OOMPH_EXCEPTION_LOCATION);</div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;      }</div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;    }</div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;  }</div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;<span class="comment"> /// Access fct to outlet pressure</span></div>
<div class="line"><a name="l01220"></a><span class="lineno"><a class="line" href="classoomph_1_1WomersleyImpedanceTubeBase.html#abdb65e815a6b49ffb2b4ac180c968ccc"> 1220</a></span>&#160;<span class="comment"></span> <span class="keywordtype">double</span>&amp; <a class="code" href="classoomph_1_1WomersleyImpedanceTubeBase.html#abdb65e815a6b49ffb2b4ac180c968ccc">p_out</a>(){<span class="keywordflow">return</span> P_out;}</div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;<span class="comment"> /// \short Pure virtual function in which the user of a derived class</span></div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;<span class="comment"> /// must create the mesh of WomersleyElements (of the type specified</span></div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;<span class="comment"> /// by the class&#39;s template argument) and apply the boundary conditions.</span></div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;<span class="comment"> /// The Womersley elements use the timestepper specified as the</span></div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;<span class="comment"> /// input argument.</span></div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;<span class="comment"></span> <span class="keyword">virtual</span> <a class="code" href="classoomph_1_1Mesh.html">Mesh</a>* build_mesh_and_apply_boundary_conditions(<a class="code" href="classoomph_1_1TimeStepper.html">TimeStepper</a>* </div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;                                                        time_stepper_pt)=0;</div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160; </div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;<span class="comment"> /// \short Set up the Womersley tubes so that a subsequent call</span></div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;<span class="comment"> /// to get_response(...) computes the inlet pressure for the currently</span></div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;<span class="comment"> /// prescribed instantaneous flow rate. Steady version!</span></div>
<div class="line"><a name="l01234"></a><span class="lineno"><a class="line" href="classoomph_1_1WomersleyImpedanceTubeBase.html#a8524aff02e221d6fd8d9cfe58c2ef596"> 1234</a></span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1WomersleyImpedanceTubeBase.html#a8524aff02e221d6fd8d9cfe58c2ef596">setup</a>()</div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160; {</div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;  <span class="comment">// Dummy parameters</span></div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;  <span class="keywordtype">double</span>* re_st_pt=&amp;<a class="code" href="namespaceoomph_1_1PseudoSolidHelper.html#a4d6244e865fddd406dc8589beb58a654">Zero</a>; </div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;  <span class="keywordtype">double</span> dt=0.0; </div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;  <span class="keywordtype">double</span> q_initial=0;</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;  <a class="code" href="classoomph_1_1TimeStepper.html">TimeStepper</a>* time_stepper_pt=&amp;Mesh::Default_TimeStepper;</div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;  <a class="code" href="namespaceoomph_1_1TerminateHelper.html#a38ec1b047a4438b6eba8a21b669c229d">setup</a>(re_st_pt,dt,q_initial,time_stepper_pt);</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160; }</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160; </div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;<span class="comment"> /// \short Set up the Womersley tubes so that a subsequent call</span></div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;<span class="comment"> /// to get_response(...) computes the inlet pressure for the currently</span></div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;<span class="comment"> /// prescribed instantaneous flow rate, assuming that at all previous times</span></div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;<span class="comment"> /// the tube conveyed steady, fully-developed flow with flowrate q_initial.</span></div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;<span class="comment"> /// dt specifies the timestep for the subsequent time integration.</span></div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;<span class="comment"> /// Specify: Womersley number, (constant) timestep, the initial volume</span></div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;<span class="comment"> /// flux (from which the subsequent impulsive start is performed) and,</span></div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;<span class="comment"> /// optionally the pointer to the timestepper to be used in the Womersley</span></div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;<span class="comment"> /// elements (defaults to BDF&lt;2&gt;).</span></div>
<div class="line"><a name="l01254"></a><span class="lineno"><a class="line" href="classoomph_1_1WomersleyImpedanceTubeBase.html#a912ef51e8ac9c44e80566126da7d591f"> 1254</a></span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1WomersleyImpedanceTubeBase.html#a912ef51e8ac9c44e80566126da7d591f">setup</a>(<span class="keywordtype">double</span>* re_st_pt, </div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; dt, </div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; q_initial,</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;            <a class="code" href="classoomph_1_1TimeStepper.html">TimeStepper</a>* time_stepper_pt=0)</div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;  {</div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;   <span class="comment">// Create timestepper if none specified so far</span></div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;   <span class="keywordflow">if</span> (time_stepper_pt==0)</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;    {</div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;     time_stepper_pt=<span class="keyword">new</span> <a class="code" href="classoomph_1_1BDF.html">BDF&lt;2&gt;</a>;</div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;    }</div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160; </div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;   <span class="comment">//Build mesh and apply bcs</span></div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;   <a class="code" href="classoomph_1_1Mesh.html">Mesh</a>* my_mesh_pt=build_mesh_and_apply_boundary_conditions(time_stepper_pt);</div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160; </div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;   <span class="comment">// Build problem</span></div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;   Womersley_problem_pt=</div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;    <span class="keyword">new</span> <a class="code" href="classoomph_1_1WomersleyProblem.html">WomersleyProblem&lt;ELEMENT,DIM&gt;</a>(re_st_pt,Current_volume_flux_pt,</div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;                                      time_stepper_pt,my_mesh_pt);</div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;<span class="comment">   /// By default, we do want to suppress the output from the</span></div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;<span class="comment">   /// Newton solver</span></div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;<span class="comment"></span>   Womersley_problem_pt-&gt;disable_info_in_newton_solve();</div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;   <a class="code" href="namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a></div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;    &lt;&lt; <span class="stringliteral">&quot;NOTE: We&#39;re suppressing timings etc from \n&quot;</span></div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;    &lt;&lt; <span class="stringliteral">&quot;      Newton solver in WomersleyImpedanceTubeBase. &quot;</span></div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;    &lt;&lt; std::endl;</div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160; </div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;   <span class="comment">// Precompute the auxiliary integrals for the Navier-Stokes</span></div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;   <span class="comment">// impedance traction elements (if they&#39;re used to specify the inflow </span></div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;   <span class="keywordflow">if</span> ((!Using_flux_control_elements) &amp;&amp; (Navier_stokes_outflow_mesh_pt!=0))</div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;    {</div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;     precompute_aux_integrals();</div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;    }</div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160; </div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;   <span class="comment">// Initialise timestep -- also sets the weights for all timesteppers</span></div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;   <span class="comment">// in the problem.</span></div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;   Womersley_problem_pt-&gt;initialise_dt(dt);</div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160; </div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;   <span class="comment">// Set currently imposed flux </span></div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;   *Current_volume_flux_pt=q_initial;</div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160; </div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;   <span class="comment">// Assign steady initial solution for this flux</span></div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;   Womersley_problem_pt-&gt;steady_newton_solve();</div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;   </div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;   <span class="comment">// Allow for resolve</span></div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;   Womersley_problem_pt-&gt;linear_solver_pt()-&gt;enable_resolve();</div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160; </div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;   <span class="comment">// Re-use Jacobian</span></div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;   Womersley_problem_pt-&gt;enable_jacobian_reuse();</div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160; </div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;   <span class="comment">// Shut up</span></div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;   Womersley_problem_pt-&gt;linear_solver_pt()-&gt;disable_doc_time();</div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160; </div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;   <span class="comment">// Do a dummy solve with time-dependent terms switched on</span></div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;   <span class="comment">// to generate (and store) the Jacobian. (We&#39;re not using</span></div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;   <span class="comment">// a Newton solve because the initial residual may be zero</span></div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;   <span class="comment">// in which case the Jacobian would never be computed!)</span></div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;   <span class="keywordtype">unsigned</span> n_dof=Womersley_problem_pt-&gt;ndof();</div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160; </div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;   <span class="comment">// Local scope to make sure dx goes out of scope</span></div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;   {</div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;    <a class="code" href="classoomph_1_1DoubleVector.html">DoubleVector</a> dx;</div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;    Womersley_problem_pt-&gt;linear_solver_pt()-&gt;solve(Womersley_problem_pt,dx);</div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;   }</div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160; </div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;   </div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;   <span class="comment">// Pre-compute derivative of p_in w.r.t. q</span></div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160; </div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;   <span class="comment">// Setup vector of derivatives of residuals &amp; unknowns w.r.t. Q</span></div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;   <a class="code" href="classoomph_1_1LinearAlgebraDistribution.html">LinearAlgebraDistribution</a> dist(Womersley_problem_pt-&gt;communicator_pt(),</div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;                                  n_dof,<span class="keyword">false</span>);</div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;   <a class="code" href="classoomph_1_1DoubleVector.html">DoubleVector</a> drdq(&amp;dist,0.0);</div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;   <a class="code" href="classoomph_1_1DoubleVector.html">DoubleVector</a> dxdq(&amp;dist,0.0);</div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160; </div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;   <span class="comment">// What&#39;s the global equation number of the equation that</span></div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;   <span class="comment">// determines the pressure gradient</span></div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;   <span class="keywordtype">unsigned</span> g_eqn=Womersley_problem_pt-&gt;</div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;    pressure_gradient_data_pt()-&gt;eqn_number(0);</div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160; </div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;   <span class="comment">// Derivative of volume constraint residual w.r.t. prescribed</span></div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;   <span class="comment">// instantaenous volume flux (in ImposeFluxForWomersleyElement)</span></div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;   drdq[g_eqn]=-1.0;</div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160; </div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;   <span class="comment">// Solve for derivatives of unknowns in Womersley problem, w.r.t.</span></div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;   <span class="comment">// instantaenous volume flux (in ImposeFluxForWomersleyElement)</span></div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;   Womersley_problem_pt-&gt;linear_solver_pt()-&gt;resolve(drdq,dxdq);</div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;   </div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;   <span class="comment">// Rate of change of inflow pressure w.r.t to instantaneous</span></div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;   <span class="comment">// volume flux</span></div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;   Dp_in_dq=dxdq[g_eqn]*Length;</div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160; </div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160; </div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;  }</div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160; </div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;<span class="comment"> /// Access to underlying Womersley problem</span></div>
<div class="line"><a name="l01350"></a><span class="lineno"><a class="line" href="classoomph_1_1WomersleyImpedanceTubeBase.html#a59aa99fe9771f53ee482218da67d87c7"> 1350</a></span>&#160;<span class="comment"></span> <a class="code" href="classoomph_1_1WomersleyProblem.html">WomersleyProblem&lt;ELEMENT,DIM&gt;</a>* <a class="code" href="classoomph_1_1WomersleyImpedanceTubeBase.html#a59aa99fe9771f53ee482218da67d87c7">womersley_problem_pt</a>()</div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;  {</div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;   <span class="keywordflow">return</span> Womersley_problem_pt;</div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;  }</div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160; </div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160; </div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;<span class="comment"> /// \short Shift history values to allow coputation of next timestep.</span></div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;<span class="comment"> /// Note: When used with a full Navier-Stokes problem this function</span></div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;<span class="comment"> /// must be called in actions_before_implicit_timestep()</span></div>
<div class="line"><a name="l01360"></a><span class="lineno"><a class="line" href="classoomph_1_1WomersleyImpedanceTubeBase.html#ad5796e64a6f25944dc9be6489149f513"> 1360</a></span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1WomersleyImpedanceTubeBase.html#ad5796e64a6f25944dc9be6489149f513">shift_time_values</a>(<span class="keyword">const</span> <span class="keywordtype">double</span>&amp; dt)</div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;  {</div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;   <span class="comment">// Shift the history values in the Womersley problem</span></div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;   Womersley_problem_pt-&gt;shift_time_values();</div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160; </div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;   <span class="comment">// Advance global time and set current value of dt </span></div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;   Womersley_problem_pt-&gt;time_pt()-&gt;time()+=dt;</div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;   Womersley_problem_pt-&gt;time_pt()-&gt;dt()=dt;</div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;   </div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;   <span class="comment">//Find out how many timesteppers there are</span></div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;   <span class="keywordtype">unsigned</span> n_time_steppers = Womersley_problem_pt-&gt;ntime_stepper();</div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;   </div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;   <span class="comment">//Loop over them all and set the weights</span></div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;n_time_steppers;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;    {</div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;     Womersley_problem_pt-&gt;time_stepper_pt(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>)-&gt;set_weights();</div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;    }</div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;  }</div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160; </div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160; </div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;<span class="comment"> /// \short Compute total current volume flux into the &quot;impedance tube&quot; that</span></div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;<span class="comment"> /// provides the flow resistance (flux is either obtained from</span></div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;<span class="comment"> /// the function that specifies it externally or by by adding up the flux</span></div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;<span class="comment"> /// through all  NavierStokesImpedanceTractionElements in</span></div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;<span class="comment"> /// the mesh pointed to by the Navier_stokes_outflow_mesh_pt.</span></div>
<div class="line"><a name="l01386"></a><span class="lineno"><a class="line" href="classoomph_1_1WomersleyImpedanceTubeBase.html#aa321d54eb9f818975854f8f3cc568256"> 1386</a></span>&#160;<span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1WomersleyImpedanceTubeBase.html#aa321d54eb9f818975854f8f3cc568256">total_volume_flux_into_impedance_tube</a>() </div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;  {</div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;   <span class="keywordflow">if</span> (Prescribed_volume_flux_fct_pt!=0)</div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;    {</div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;     <span class="keywordflow">return</span> Prescribed_volume_flux_fct_pt(</div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;      Womersley_problem_pt-&gt;time_pt()-&gt;time());</div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;    }</div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;   <span class="keywordflow">else</span></div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;    {</div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;     <span class="keywordtype">unsigned</span> nelem=Navier_stokes_outflow_mesh_pt-&gt;nelement();</div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;     <span class="keywordtype">double</span> flux=0.0;</div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;     <span class="keywordflow">if</span> (Using_flux_control_elements)</div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;      {</div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;       <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#a37cd013acc76697829c324bdd8562d82">e</a>=0;<a class="code" href="cfortran_8h.html#a37cd013acc76697829c324bdd8562d82">e</a>&lt;nelem;<a class="code" href="cfortran_8h.html#a37cd013acc76697829c324bdd8562d82">e</a>++)</div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;        {</div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;         flux+=<span class="keyword">dynamic_cast&lt;</span><a class="code" href="classoomph_1_1TemplateFreeNavierStokesFluxControlElementBase.html">TemplateFreeNavierStokesFluxControlElementBase</a>*<span class="keyword">&gt;</span>(</div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;          Navier_stokes_outflow_mesh_pt-&gt;element_pt(<a class="code" href="cfortran_8h.html#a37cd013acc76697829c324bdd8562d82">e</a>))-&gt;get_volume_flux();</div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;        }</div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;      }</div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;     <span class="keywordflow">else</span></div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;      {</div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;       <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#a37cd013acc76697829c324bdd8562d82">e</a>=0;<a class="code" href="cfortran_8h.html#a37cd013acc76697829c324bdd8562d82">e</a>&lt;nelem;<a class="code" href="cfortran_8h.html#a37cd013acc76697829c324bdd8562d82">e</a>++)</div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;        {</div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;         flux+=<span class="keyword">dynamic_cast&lt;</span><a class="code" href="classoomph_1_1NavierStokesImpedanceTractionElementBase.html">NavierStokesImpedanceTractionElementBase</a>*<span class="keyword">&gt;</span>(</div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;          Navier_stokes_outflow_mesh_pt-&gt;element_pt(<a class="code" href="cfortran_8h.html#a37cd013acc76697829c324bdd8562d82">e</a>))-&gt;get_volume_flux();</div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;        }</div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;      }</div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;     <span class="keywordflow">return</span> flux;</div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;    }</div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;  }</div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160; </div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160; </div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160; </div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;<span class="comment"> /// \short Compute inlet pressure, p_in, required to achieve the currently</span></div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;<span class="comment"> /// imposed, instantaneous volume flux q prescribed by </span></div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;<span class="comment"> /// total_volume_flux_into_impedance_tube(), and its</span></div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;<span class="comment"> /// derivative, dp_in/dq.</span></div>
<div class="line"><a name="l01424"></a><span class="lineno"><a class="line" href="classoomph_1_1WomersleyImpedanceTubeBase.html#a62628115802f53da76c5e4f29de628c7"> 1424</a></span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1WomersleyImpedanceTubeBase.html#a62628115802f53da76c5e4f29de628c7">get_response</a>(<span class="keywordtype">double</span>&amp; p_in,</div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;                   <span class="keywordtype">double</span>&amp; dp_in_dq)</div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;  {</div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;   <span class="comment">// Set currently imposed flux </span></div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;   *Current_volume_flux_pt=total_volume_flux_into_impedance_tube();</div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160; </div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;   <span class="comment">// Do a Newton solve to compute the pressure gradient</span></div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;   <span class="comment">// required to achieve the imposed instantaneous flow rate</span></div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;   Womersley_problem_pt-&gt;newton_solve();</div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;   </div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;   <span class="comment">// Compute inflow pressure based on computed pressure gradient,</span></div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;   <span class="comment">// the length of tube, and the outlet pressure</span></div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;   p_in=-Womersley_problem_pt-&gt;pressure_gradient_data_pt()-&gt;value(0)*Length+</div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;    P_out;</div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;  </div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;   <span class="comment">// Return pre-computed value  for dp_in/dq</span></div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;   dp_in_dq=Dp_in_dq; </div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;  }</div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160; </div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160; </div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;<span class="keyword">protected</span>:</div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;<span class="comment"> /// \short Precompute auxiliary integrals required for the computation of the</span></div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;<span class="comment"> /// Jacobian in the NavierStokesImpedanceTractionElement. Also pass the</span></div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;<span class="comment"> /// pointer to the pre-computed integrals to the elements in the </span></div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;<span class="comment"> /// Navier_stokes_outflow_mesh_pt so they can refer to it.</span></div>
<div class="line"><a name="l01450"></a><span class="lineno"><a class="line" href="classoomph_1_1WomersleyImpedanceTubeBase.html#a64f2f3eeb09a5637b32661baab3ac1e4"> 1450</a></span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1WomersleyImpedanceTubeBase.html#a64f2f3eeb09a5637b32661baab3ac1e4">precompute_aux_integrals</a>()</div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160; {</div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;  <span class="comment">// Loop over all elements</span></div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;  <span class="keywordtype">unsigned</span> nelem=Navier_stokes_outflow_mesh_pt-&gt;nelement();</div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#a37cd013acc76697829c324bdd8562d82">e</a>=0;<a class="code" href="cfortran_8h.html#a37cd013acc76697829c324bdd8562d82">e</a>&lt;nelem;<a class="code" href="cfortran_8h.html#a37cd013acc76697829c324bdd8562d82">e</a>++)</div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;   {</div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;    <a class="code" href="classoomph_1_1NavierStokesImpedanceTractionElementBase.html">NavierStokesImpedanceTractionElementBase</a>* el_pt</div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;     =<span class="keyword">dynamic_cast&lt;</span><a class="code" href="classoomph_1_1NavierStokesImpedanceTractionElementBase.html">NavierStokesImpedanceTractionElementBase</a>*<span class="keyword">&gt;</span>(</div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;      Navier_stokes_outflow_mesh_pt-&gt;element_pt(<a class="code" href="cfortran_8h.html#a37cd013acc76697829c324bdd8562d82">e</a>));</div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160; </div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;    <span class="comment">// Add the element&#39;s contribution</span></div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;    el_pt-&gt;<a class="code" href="classoomph_1_1NavierStokesImpedanceTractionElementBase.html#a4ce2150b59ff999c24e623b645f1c899">add_element_contribution_to_aux_integral</a>(Aux_integral_pt);</div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160; </div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;    <span class="comment">// Tell the elements who&#39;s setting their flow resistance</span></div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;    el_pt-&gt;<a class="code" href="classoomph_1_1NavierStokesImpedanceTractionElementBase.html#add9c7ae3f33b8e03805c256daf038ab4">set_impedance_tube_pt</a>(<span class="keyword">this</span>);</div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160; </div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;   }</div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160; </div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;  <span class="comment">// Pass pointer to Aux_integral to the elements so they can</span></div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;  <span class="comment">// use it in the computation of the Jacobian </span></div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#a37cd013acc76697829c324bdd8562d82">e</a>=0;<a class="code" href="cfortran_8h.html#a37cd013acc76697829c324bdd8562d82">e</a>&lt;nelem;<a class="code" href="cfortran_8h.html#a37cd013acc76697829c324bdd8562d82">e</a>++)</div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;   {</div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;    <a class="code" href="classoomph_1_1NavierStokesImpedanceTractionElementBase.html">NavierStokesImpedanceTractionElementBase</a>* el_pt</div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;     =<span class="keyword">dynamic_cast&lt;</span></div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;     <a class="code" href="classoomph_1_1NavierStokesImpedanceTractionElementBase.html">NavierStokesImpedanceTractionElementBase</a>*<span class="keyword">&gt;</span>(</div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;      Navier_stokes_outflow_mesh_pt-&gt;element_pt(<a class="code" href="cfortran_8h.html#a37cd013acc76697829c324bdd8562d82">e</a>));</div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;    </div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;    <span class="comment">// Pass pointer to elements</span></div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;    el_pt-&gt;<a class="code" href="classoomph_1_1NavierStokesImpedanceTractionElementBase.html#ac9583fd74bc1bb57101bce20fffa39d3">set_aux_integral_pt</a>(Aux_integral_pt);</div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;    </div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;   }</div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160; </div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160; }  </div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;<span class="comment"> /// Length of the tube</span></div>
<div class="line"><a name="l01485"></a><span class="lineno"><a class="line" href="classoomph_1_1WomersleyImpedanceTubeBase.html#a3be3a17477e68ee912699b1cc8749ee7"> 1485</a></span>&#160;<span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1WomersleyImpedanceTubeBase.html#a3be3a17477e68ee912699b1cc8749ee7">Length</a>;</div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;<span class="comment"> /// \short Derivative of inflow pressure w.r.t. instantaenous volume flux</span></div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;<span class="comment"> /// (Note: Can be pre-computed)</span></div>
<div class="line"><a name="l01489"></a><span class="lineno"><a class="line" href="classoomph_1_1WomersleyImpedanceTubeBase.html#a4f6f0c9043ea66a5b0c3a623cf1e7354"> 1489</a></span>&#160;<span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1WomersleyImpedanceTubeBase.html#a4f6f0c9043ea66a5b0c3a623cf1e7354">Dp_in_dq</a>;</div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;<span class="comment"> /// \short Pointer to double that specifies the currently imposed </span></div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;<span class="comment"> /// instantaneous volume flux into the impedance tube. This is</span></div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;<span class="comment"> /// used to communicate with the Womersley elements which require</span></div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;<span class="comment"> /// access to the flux via a pointer to a double.</span></div>
<div class="line"><a name="l01495"></a><span class="lineno"><a class="line" href="classoomph_1_1WomersleyImpedanceTubeBase.html#a7363d921cd306353eae884b9cfe5c8e9"> 1495</a></span>&#160;<span class="comment"></span> <span class="keywordtype">double</span>* <a class="code" href="classoomph_1_1WomersleyImpedanceTubeBase.html#a7363d921cd306353eae884b9cfe5c8e9">Current_volume_flux_pt</a>;</div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;<span class="comment"> /// \short Pointer to Womersley problem that determines the</span></div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;<span class="comment"> /// pressure gradient along the tube</span></div>
<div class="line"><a name="l01499"></a><span class="lineno"><a class="line" href="classoomph_1_1WomersleyImpedanceTubeBase.html#ab424ec7b47d3f31acd44dcf93be6b5e5"> 1499</a></span>&#160;<span class="comment"></span> <a class="code" href="classoomph_1_1WomersleyProblem.html">WomersleyProblem&lt;ELEMENT,DIM&gt;</a>* <a class="code" href="classoomph_1_1WomersleyImpedanceTubeBase.html#ab424ec7b47d3f31acd44dcf93be6b5e5">Womersley_problem_pt</a>;</div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;<span class="comment"> /// Outlet pressure</span></div>
<div class="line"><a name="l01502"></a><span class="lineno"><a class="line" href="classoomph_1_1WomersleyImpedanceTubeBase.html#afa4f6e203c33d02e82a92986b1aeee0d"> 1502</a></span>&#160;<span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1WomersleyImpedanceTubeBase.html#afa4f6e203c33d02e82a92986b1aeee0d">P_out</a>;</div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;<span class="comment"> /// Pointer to function that specifies the prescribed volume flux</span></div>
<div class="line"><a name="l01505"></a><span class="lineno"><a class="line" href="classoomph_1_1WomersleyImpedanceTubeBase.html#ae7d57d4ab999bc30db552a265fbadf92"> 1505</a></span>&#160;<span class="comment"></span> PrescribedVolumeFluxFctPt <a class="code" href="classoomph_1_1WomersleyImpedanceTubeBase.html#ae7d57d4ab999bc30db552a265fbadf92">Prescribed_volume_flux_fct_pt</a>;</div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;<span class="comment"> /// \short Pointer to the mesh of NavierStokesImpedanceTractionElements</span></div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;<span class="comment"> /// that are attached to the outflow cross-section of the higher-dimensional</span></div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;<span class="comment"> /// Navier Stokes mesh and provide the inflow into the Impedance tube.</span></div>
<div class="line"><a name="l01510"></a><span class="lineno"><a class="line" href="classoomph_1_1WomersleyImpedanceTubeBase.html#a59b41acf37d7bfce3c1a8676304915d7"> 1510</a></span>&#160;<span class="comment"></span> <a class="code" href="classoomph_1_1Mesh.html">Mesh</a>* <a class="code" href="classoomph_1_1WomersleyImpedanceTubeBase.html#a59b41acf37d7bfce3c1a8676304915d7">Navier_stokes_outflow_mesh_pt</a>;</div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;<span class="comment"> /// \short Pointer to auxiliary integral, containing</span></div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;<span class="comment"> /// the derivative of the total volume flux through the</span></div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;<span class="comment"> /// outflow boundary of the (higher-dimensional) Navier-Stokes mesh w.r.t. </span></div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;<span class="comment"> /// to the discrete (global) (velocity) degrees of freedom.</span></div>
<div class="line"><a name="l01516"></a><span class="lineno"><a class="line" href="classoomph_1_1WomersleyImpedanceTubeBase.html#ad8b569812e4c3fa5ae6c1064689bb2fe"> 1516</a></span>&#160;<span class="comment"></span> std::map&lt;unsigned,double&gt;* <a class="code" href="classoomph_1_1WomersleyImpedanceTubeBase.html#ad8b569812e4c3fa5ae6c1064689bb2fe">Aux_integral_pt</a>;</div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160; </div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;  <span class="keyword">private</span>:</div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160; </div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160; <span class="comment">// \short Flag to record if NavierStokesFluxControlElement </span></div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160; <span class="comment">// or NavierStokesImpedanceTractionElement elements are being used</span></div>
<div class="line"><a name="l01522"></a><span class="lineno"><a class="line" href="classoomph_1_1WomersleyImpedanceTubeBase.html#a01ab12fe40acf7a477b892e7c7cd0831"> 1522</a></span>&#160; <span class="keywordtype">bool</span> <a class="code" href="classoomph_1_1WomersleyImpedanceTubeBase.html#a01ab12fe40acf7a477b892e7c7cd0831">Using_flux_control_elements</a>;</div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160; </div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;};</div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;<span class="comment">//Inline functions:</span></div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160; </div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160; </div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;<span class="comment">//======================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;<span class="comment">/// Define the shape functions and test functions and derivatives</span></div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;<span class="comment">/// w.r.t. global coordinates and return Jacobian of mapping.</span></div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;<span class="comment">/// Galerkin: Test functions = shape functions</span></div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;<span class="comment"></span><span class="comment">//======================================================================</span></div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;<span class="keyword">template</span>&lt;<span class="keywordtype">unsigned</span> DIM, <span class="keywordtype">unsigned</span> NNODE_1D&gt;</div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;<span class="keywordtype">double</span> <a class="code" href="classoomph_1_1QWomersleyElement.html">QWomersleyElement&lt;DIM,NNODE_1D&gt;::</a></div>
<div class="line"><a name="l01541"></a><span class="lineno"><a class="line" href="classoomph_1_1QWomersleyElement.html#afe507e9f0d7359d47c0c682fed7c952b"> 1541</a></span>&#160;<a class="code" href="classoomph_1_1QWomersleyElement.html"> dshape_and_dtest_eulerian_womersley</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,</div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;                                    <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;psi, </div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;                                    <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;dpsidx,</div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;                                    <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;test, </div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;                                    <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;dtestdx)<span class="keyword"> const</span></div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160; <span class="comment">//Call the geometrical shape functions and derivatives  </span></div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160; <span class="keywordtype">double</span> J = this-&gt;dshape_eulerian(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,psi,dpsidx);</div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160; </div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160; <span class="comment">//Loop over the test functions and derivatives and set them equal to the</span></div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160; <span class="comment">//shape functions</span></div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160; <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;NNODE_1D;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;  {</div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;   test[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] = psi[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]; </div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> j=0;j&lt;DIM;j++)</div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;    {</div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;     dtestdx(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>,j) = dpsidx(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>,j);</div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;    }</div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;  }</div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160; </div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160; <span class="comment">//Return the jacobian</span></div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160; <span class="keywordflow">return</span> J;</div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;}</div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160; </div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160; </div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;<span class="comment">//======================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;<span class="comment">/// Define the shape functions and test functions and derivatives</span></div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;<span class="comment">/// w.r.t. global coordinates and return Jacobian of mapping.</span></div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;<span class="comment">/// Galerkin: Test functions = shape functions</span></div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;<span class="comment"></span><span class="comment">//======================================================================</span></div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;<span class="keyword">template</span>&lt;<span class="keywordtype">unsigned</span> DIM,<span class="keywordtype">unsigned</span> NNODE_1D&gt;</div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;<span class="keywordtype">double</span> <a class="code" href="classoomph_1_1QWomersleyElement.html">QWomersleyElement&lt;DIM,NNODE_1D&gt;::</a></div>
<div class="line"><a name="l01574"></a><span class="lineno"><a class="line" href="classoomph_1_1QWomersleyElement.html#a5c4db93fb861995c7910ffe44751f449"> 1574</a></span>&#160;<a class="code" href="classoomph_1_1QWomersleyElement.html"> dshape_and_dtest_eulerian_at_knot_womersley</a>(</div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160; <span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;ipt,</div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160; <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;psi, </div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160; <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;dpsidx,</div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160; <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;test, </div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160; <a class="code" href="classoomph_1_1DShape.html">DShape</a> &amp;dtestdx)<span class="keyword"> const</span></div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160; <span class="comment">//Call the geometrical shape functions and derivatives  </span></div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160; <span class="keywordtype">double</span> J = this-&gt;dshape_eulerian_at_knot(ipt,psi,dpsidx);</div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160; </div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160; <span class="comment">//Set the test functions equal to the shape functions </span></div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160; <span class="comment">//(sets internal pointers)</span></div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160; test = psi;</div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160; dtestdx = dpsidx;</div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160; </div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160; <span class="comment">//Return the jacobian</span></div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160; <span class="keywordflow">return</span> J;</div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;}</div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160; </div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160; </div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160; </div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;<span class="comment">//=======================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;<span class="comment">/// Face geometry for the QWomersleyElement elements: The spatial </span></div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;<span class="comment">/// dimension of the face elements is one lower than that of the</span></div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;<span class="comment">/// bulk element but they have the same number of points</span></div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;<span class="comment">/// along their 1D edges.</span></div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;<span class="comment"></span><span class="comment">//=======================================================================</span></div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;<span class="keyword">template</span>&lt;<span class="keywordtype">unsigned</span> DIM, <span class="keywordtype">unsigned</span> NNODE_1D&gt;</div>
<div class="line"><a name="l01606"></a><span class="lineno"><a class="line" href="classoomph_1_1FaceGeometry_3_01QWomersleyElement_3_01DIM_00_01NNODE__1D_01_4_01_4.html"> 1606</a></span>&#160;<span class="keyword">class </span><a class="code" href="classoomph_1_1FaceGeometry.html">FaceGeometry</a>&lt;<a class="code" href="classoomph_1_1QWomersleyElement.html">QWomersleyElement</a>&lt;DIM,NNODE_1D&gt; &gt;: </div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;<span class="keyword">public</span> <span class="keyword">virtual</span> <a class="code" href="classoomph_1_1QElement.html">QElement</a>&lt;DIM-1,NNODE_1D&gt;</div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;{</div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160; </div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;  <span class="keyword">public</span>:</div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;<span class="comment"> /// \short Constructor: Call the constructor for the</span></div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;<span class="comment"> /// appropriate lower-dimensional QElement</span></div>
<div class="line"><a name="l01614"></a><span class="lineno"><a class="line" href="classoomph_1_1FaceGeometry_3_01QWomersleyElement_3_01DIM_00_01NNODE__1D_01_4_01_4.html#ad9f21ddf6af09368e24e8d5ac74babcc"> 1614</a></span>&#160;<span class="comment"></span> <a class="code" href="classoomph_1_1FaceGeometry_3_01QWomersleyElement_3_01DIM_00_01NNODE__1D_01_4_01_4.html#ad9f21ddf6af09368e24e8d5ac74babcc">FaceGeometry</a>() : <a class="code" href="classoomph_1_1QElement.html">QElement</a>&lt;DIM-1,NNODE_1D&gt;() {}</div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160; </div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;};</div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160; </div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160; </div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;<span class="comment">//=======================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;<span class="comment">/// Face geometry for the 1D QWomersleyElement elements: Point elements</span></div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;<span class="comment"></span><span class="comment">//=======================================================================</span></div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;<span class="keyword">template</span>&lt;<span class="keywordtype">unsigned</span> NNODE_1D&gt;</div>
<div class="line"><a name="l01628"></a><span class="lineno"><a class="line" href="classoomph_1_1FaceGeometry_3_01QWomersleyElement_3_011_00_01NNODE__1D_01_4_01_4.html"> 1628</a></span>&#160;<span class="keyword">class </span><a class="code" href="classoomph_1_1FaceGeometry.html">FaceGeometry</a>&lt;<a class="code" href="classoomph_1_1QWomersleyElement.html">QWomersleyElement</a>&lt;1,NNODE_1D&gt; &gt;: </div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160; <span class="keyword">public</span> <span class="keyword">virtual</span> <a class="code" href="classoomph_1_1PointElement.html">PointElement</a></div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;{</div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160; </div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;  <span class="keyword">public</span>:</div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;<span class="comment"> /// \short Constructor: Call the constructor for the</span></div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;<span class="comment"> /// appropriate lower-dimensional QElement</span></div>
<div class="line"><a name="l01636"></a><span class="lineno"><a class="line" href="classoomph_1_1FaceGeometry_3_01QWomersleyElement_3_011_00_01NNODE__1D_01_4_01_4.html#a565684012c2ea2a9abfc9364d2905448"> 1636</a></span>&#160;<span class="comment"></span> <a class="code" href="classoomph_1_1FaceGeometry_3_01QWomersleyElement_3_011_00_01NNODE__1D_01_4_01_4.html#a565684012c2ea2a9abfc9364d2905448">FaceGeometry</a>() : <a class="code" href="classoomph_1_1PointElement.html">PointElement</a>() {}</div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160; </div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;};</div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160; </div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160; </div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;<span class="comment">//====================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;<span class="comment">/// Template-free base class</span></div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;<span class="comment"></span><span class="comment">//====================================================================</span></div>
<div class="line"><a name="l01649"></a><span class="lineno"><a class="line" href="classoomph_1_1TemplateFreeWomersleyMeshBase.html"> 1649</a></span>&#160;<span class="keyword">class </span><a class="code" href="classoomph_1_1TemplateFreeWomersleyMeshBase.html">TemplateFreeWomersleyMeshBase</a> </div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;{</div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160; </div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;<span class="comment"> /// Static bool to suppress warning</span></div>
<div class="line"><a name="l01655"></a><span class="lineno"><a class="line" href="classoomph_1_1TemplateFreeWomersleyMeshBase.html#acafc84fe27a65ac15185aebc1a4d0974"> 1655</a></span>&#160;<span class="comment"></span> <span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="classoomph_1_1TemplateFreeWomersleyMeshBase.html#acafc84fe27a65ac15185aebc1a4d0974">Suppress_warning_about_unpinned_nst_dofs</a>;</div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160; </div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;};</div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160; </div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160; </div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;<span class="comment">//====================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;<span class="comment">/// Mesh of Womersley elements whose topology, nodal position etc.</span></div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;<span class="comment">/// matches that of a given mesh of face elements in the outflow</span></div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;<span class="comment">/// cross-section of a full Navier-Stokes mesh.</span></div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;<span class="comment"></span><span class="comment">//====================================================================</span></div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> WOMERSLEY_ELEMENT&gt;</div>
<div class="line"><a name="l01671"></a><span class="lineno"><a class="line" href="classoomph_1_1WomersleyMesh.html"> 1671</a></span>&#160; <span class="keyword">class </span><a class="code" href="classoomph_1_1WomersleyMesh.html">WomersleyMesh</a> : <span class="keyword">public</span> <span class="keyword">virtual</span> <a class="code" href="classoomph_1_1Mesh.html">Mesh</a>, </div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160; <span class="keyword">public</span> <span class="keyword">virtual</span> <a class="code" href="classoomph_1_1TemplateFreeWomersleyMeshBase.html">TemplateFreeWomersleyMeshBase</a> </div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;{</div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160; </div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160; </div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;<span class="comment"> /// \short Constructor: Pass pointer to  mesh of face elements in the outflow</span></div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;<span class="comment"> /// cross-section of a full Navier-Stokes mesh, the timestepper</span></div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;<span class="comment"> /// to be used for the Womersley elements, the coordinate (in the</span></div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;<span class="comment"> /// higher-dimensional Navier-Stokes mesh) that is constant</span></div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;<span class="comment"> /// in the outflow cross-section and the velocity component</span></div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;<span class="comment"> /// (in terms of the nodal index) that represents the outflow</span></div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;<span class="comment"> /// component -- the latter is used to automatically apply</span></div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;<span class="comment"> /// the boundary conditions for the Womersley problem.</span></div>
<div class="line"><a name="l01686"></a><span class="lineno"><a class="line" href="classoomph_1_1WomersleyMesh.html#a1fc3a748ff68d01051759c9e3c39bca2"> 1686</a></span>&#160;<span class="comment"></span> <a class="code" href="classoomph_1_1WomersleyMesh.html#a1fc3a748ff68d01051759c9e3c39bca2">WomersleyMesh</a>(<a class="code" href="classoomph_1_1Mesh.html">Mesh</a>* n_st_outflow_mesh_pt, </div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;               <a class="code" href="classoomph_1_1TimeStepper.html">TimeStepper</a>* time_stepper_pt,</div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;               <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; fixed_coordinate,</div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;               <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; w_index)</div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;  {<span class="comment"></span></div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;<span class="comment">   /// How many elements and nodes are there in the original mesh?</span></div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;<span class="comment"></span>   <span class="keywordtype">unsigned</span> nelem=n_st_outflow_mesh_pt-&gt;<a class="code" href="classoomph_1_1Mesh.html#af01dfefb66c15579b540be62999d93ee">nelement</a>();</div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160; </div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;   <span class="comment">// Navier-Stokes outflow mesh may not have any nodes stored (it usually</span></div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;   <span class="comment">// just acts as a container for traction elements) --&gt;</span></div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;   <span class="comment">// Count number of distinct Navier-Stokes nodes by adding</span></div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;   <span class="comment">// the elements&#39; nodes to a set</span></div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;   std::set&lt;Node*&gt; n_st_nodes;</div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#a37cd013acc76697829c324bdd8562d82">e</a>=0;<a class="code" href="cfortran_8h.html#a37cd013acc76697829c324bdd8562d82">e</a>&lt;nelem;<a class="code" href="cfortran_8h.html#a37cd013acc76697829c324bdd8562d82">e</a>++)</div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;    { </div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;     <a class="code" href="classoomph_1_1FiniteElement.html">FiniteElement</a>* el_pt=n_st_outflow_mesh_pt-&gt;<a class="code" href="classoomph_1_1Mesh.html#a4f274774435e9454bf77bf70de69367a">finite_element_pt</a>(<a class="code" href="cfortran_8h.html#a37cd013acc76697829c324bdd8562d82">e</a>);</div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;     <span class="keywordtype">unsigned</span> nnod_el=el_pt-&gt;<a class="code" href="classoomph_1_1FiniteElement.html#a6219ed269a6d89b5aa14659cce48905a">nnode</a>();</div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j=0;j&lt;nnod_el;j++)</div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;      {</div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;       n_st_nodes.insert(el_pt-&gt;<a class="code" href="classoomph_1_1FiniteElement.html#ace0e7fb72a805b5c2c600347bfae7a9b">node_pt</a>(j));</div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160; </div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;       <span class="comment">// Careful: It there are hanging nodes this won&#39;t work!</span></div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;       <span class="keywordflow">if</span> (el_pt-&gt;<a class="code" href="classoomph_1_1FiniteElement.html#ace0e7fb72a805b5c2c600347bfae7a9b">node_pt</a>(j)-&gt;<a class="code" href="classoomph_1_1Node.html#af0e6237dfafad62cf427ff5013ddcfef">is_hanging</a>())</div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;        {</div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;         <span class="keywordflow">throw</span> <a class="code" href="classoomph_1_1OomphLibError.html">OomphLibError</a>(</div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;          <span class="stringliteral">&quot;Cannot build WomersleyMesh from mesh with hanging nodes!&quot;</span>,</div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;          OOMPH_CURRENT_FUNCTION,</div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;          OOMPH_EXCEPTION_LOCATION);       </div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;        }      </div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;      }</div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;    }</div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;  </div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;   <span class="comment">// Extract size then wipe</span></div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;   <span class="keywordtype">unsigned</span> nnode_n_st= n_st_nodes.size();</div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;   n_st_nodes.clear();</div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160; </div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;   <span class="comment">// Create enough storage</span></div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;   Node_pt.resize(nnode_n_st);</div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;<span class="comment">   /// Create new elements</span></div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;<span class="comment"></span>   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#a37cd013acc76697829c324bdd8562d82">e</a>=0;<a class="code" href="cfortran_8h.html#a37cd013acc76697829c324bdd8562d82">e</a>&lt;nelem;<a class="code" href="cfortran_8h.html#a37cd013acc76697829c324bdd8562d82">e</a>++)</div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;    { </div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;     add_element_pt(<span class="keyword">new</span> WOMERSLEY_ELEMENT);</div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;     <span class="keywordflow">if</span> (finite_element_pt(<a class="code" href="cfortran_8h.html#a37cd013acc76697829c324bdd8562d82">e</a>)-&gt;nnode()!=</div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;         n_st_outflow_mesh_pt-&gt;<a class="code" href="classoomph_1_1Mesh.html#a4f274774435e9454bf77bf70de69367a">finite_element_pt</a>(<a class="code" href="cfortran_8h.html#a37cd013acc76697829c324bdd8562d82">e</a>)-&gt;<a class="code" href="classoomph_1_1FiniteElement.html#a6219ed269a6d89b5aa14659cce48905a">nnode</a>())</div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;      {</div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;       <span class="keywordflow">throw</span> <a class="code" href="classoomph_1_1OomphLibError.html">OomphLibError</a>(</div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;        <span class="stringliteral">&quot;Number of nodes in existing and new elements don&#39;t match&quot;</span>,</div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;        OOMPH_CURRENT_FUNCTION,</div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;        OOMPH_EXCEPTION_LOCATION);       </div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;      }</div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;    }</div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160; </div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;   <span class="comment">// Map to record which Navier-Stokes nodes have been visited (default</span></div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;   <span class="comment">// return is false)</span></div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;   std::map&lt;Node*,bool&gt; n_st_node_done;</div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160; </div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;   <span class="comment">// Map to store the Womersley node that corresponds to a</span></div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;   <span class="comment">// Navier Stokes node</span></div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;   std::map&lt;Node*,Node*&gt; equivalent_womersley_node_pt;</div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160; </div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;   <span class="comment">// Initialise count of newly created nodes</span></div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;   <span class="keywordtype">unsigned</span> node_count=0;</div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160; </div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160; </div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;   <span class="comment">// This is awkward do diagnose: We&#39;re assuming that</span></div>
<div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;   <span class="comment">// the boundary conditions have been applied for the</span></div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;   <span class="comment">// underlying Navier-Stokes problem before calling</span></div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;   <span class="comment">// this function (otherwise it&#39;s really tricky to </span></div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;   <span class="comment">// apply the right boundary conditions here), but it&#39;s</span></div>
<div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;   <span class="comment">// hard to police. Issue definite (but suppressable) </span></div>
<div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;   <span class="comment">// warning if nothing has been pinned at all.</span></div>
<div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;   <span class="keywordtype">unsigned</span> n_pinned_nodes=0;</div>
<div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160; </div>
<div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;   <span class="comment">// Loop over nst and womersley elements in tandem to sort out</span></div>
<div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;   <span class="comment">// which new nodes are required</span></div>
<div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#a37cd013acc76697829c324bdd8562d82">e</a>=0;<a class="code" href="cfortran_8h.html#a37cd013acc76697829c324bdd8562d82">e</a>&lt;nelem;<a class="code" href="cfortran_8h.html#a37cd013acc76697829c324bdd8562d82">e</a>++)</div>
<div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;    {</div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;     <a class="code" href="classoomph_1_1FiniteElement.html">FiniteElement</a>* n_st_el_pt=n_st_outflow_mesh_pt-&gt;<a class="code" href="classoomph_1_1Mesh.html#a4f274774435e9454bf77bf70de69367a">finite_element_pt</a>(<a class="code" href="cfortran_8h.html#a37cd013acc76697829c324bdd8562d82">e</a>);</div>
<div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;     <span class="keywordtype">unsigned</span> nnod_el=n_st_el_pt-&gt;<a class="code" href="classoomph_1_1FiniteElement.html#a6219ed269a6d89b5aa14659cce48905a">nnode</a>();</div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j=0;j&lt;nnod_el;j++)</div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;      {</div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;       <span class="comment">// Has the Navier Stokes node been done yet?</span></div>
<div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;       <a class="code" href="classoomph_1_1Node.html">Node</a>* n_st_node_pt=n_st_el_pt-&gt;<a class="code" href="classoomph_1_1FiniteElement.html#ace0e7fb72a805b5c2c600347bfae7a9b">node_pt</a>(j);</div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160; </div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;       <span class="comment">// Hasn&#39;t been done: Create new node in Womersley element</span></div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;       <span class="keywordflow">if</span> (!n_st_node_done[n_st_node_pt])</div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;        {</div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;         <span class="comment">// Create a new node in the Womersley element</span></div>
<div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;         <a class="code" href="classoomph_1_1Node.html">Node</a>* new_node_pt=</div>
<div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;          finite_element_pt(<a class="code" href="cfortran_8h.html#a37cd013acc76697829c324bdd8562d82">e</a>)-&gt;construct_node(j,time_stepper_pt);</div>
<div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;         </div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;         <span class="comment">// Add newly created node</span></div>
<div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;         Node_pt[node_count]=new_node_pt;</div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;         node_count++;</div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160; </div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160; </div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;         <span class="comment">// Set coordinates</span></div>
<div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;         <span class="keywordtype">unsigned</span> dim=n_st_node_pt-&gt;<a class="code" href="classoomph_1_1Node.html#a786c96a8e46eb27a03b2b31f629d41b3">ndim</a>();</div>
<div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;         <span class="keywordtype">unsigned</span> icount=0;</div>
<div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;         <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;dim;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;          {</div>
<div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;           <span class="keywordflow">if</span> (<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>!=fixed_coordinate)</div>
<div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;            {</div>
<div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;             new_node_pt-&gt;<a class="code" href="classoomph_1_1Node.html#a056f8e82da938369cd38541c5cdc598a">x</a>(icount)=n_st_node_pt-&gt;x(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>);</div>
<div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;             icount++;</div>
<div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;            }</div>
<div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;          }</div>
<div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160; </div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;         <span class="comment">// Set pin status</span></div>
<div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;         <span class="keywordflow">if</span> (n_st_node_pt-&gt;is_pinned(w_index))</div>
<div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;          {</div>
<div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;           new_node_pt-&gt;<a class="code" href="classoomph_1_1Data.html#a422231c58e423f0b43822827aa334d79">pin</a>(0);</div>
<div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;           n_pinned_nodes++;</div>
<div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;          }</div>
<div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;         <span class="keywordflow">else</span></div>
<div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;          {</div>
<div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;           <span class="comment">// shouldn&#39;t need this, but...</span></div>
<div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;           new_node_pt-&gt;<a class="code" href="classoomph_1_1Data.html#a4e5cb031bf8eceb8f97c2c4fbd74cb05">unpin</a>(0);</div>
<div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;          }</div>
<div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160; </div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;         <span class="comment">// Record which Womersley node the </span></div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;         <span class="comment">// Navier Stokes node is associated with</span></div>
<div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;         equivalent_womersley_node_pt[n_st_node_pt]=new_node_pt;</div>
<div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160; </div>
<div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;         <span class="comment">// Now the Navier-Stokes node has been done</span></div>
<div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;         n_st_node_done[n_st_node_pt]=<span class="keyword">true</span>;</div>
<div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;        }</div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;       <span class="comment">// The node has already been done -- set pointer to existing</span></div>
<div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;       <span class="comment">// Womersley node </span></div>
<div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;       <span class="keywordflow">else</span></div>
<div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;        {</div>
<div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;         finite_element_pt(<a class="code" href="cfortran_8h.html#a37cd013acc76697829c324bdd8562d82">e</a>)-&gt;node_pt(j)=</div>
<div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;          equivalent_womersley_node_pt[n_st_node_pt];</div>
<div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;        }</div>
<div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;      }</div>
<div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;     </div>
<div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;     <span class="keywordtype">bool</span> passed=<span class="keyword">true</span>;</div>
<div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;     finite_element_pt(<a class="code" href="cfortran_8h.html#a37cd013acc76697829c324bdd8562d82">e</a>)-&gt;check_J_eulerian_at_knots(passed);</div>
<div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;     <span class="keywordflow">if</span> (!passed)</div>
<div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;      {</div>
<div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;       <span class="comment">//Reverse the nodes</span></div>
<div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;       <span class="keywordtype">unsigned</span> nnod=finite_element_pt(<a class="code" href="cfortran_8h.html#a37cd013acc76697829c324bdd8562d82">e</a>)-&gt;nnode();</div>
<div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;       <a class="code" href="classoomph_1_1Vector.html">Vector&lt;Node*&gt;</a> orig_nod_pt(nnod);</div>
<div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;       <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j=0;j&lt;nnod;j++)</div>
<div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;        {</div>
<div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;         orig_nod_pt[j]=finite_element_pt(<a class="code" href="cfortran_8h.html#a37cd013acc76697829c324bdd8562d82">e</a>)-&gt;node_pt(j);</div>
<div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;        }</div>
<div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;       <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j=0;j&lt;nnod;j++)</div>
<div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;        {</div>
<div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;         finite_element_pt(<a class="code" href="cfortran_8h.html#a37cd013acc76697829c324bdd8562d82">e</a>)-&gt;node_pt(j)=orig_nod_pt[nnod-j-1];</div>
<div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;        }</div>
<div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;       <span class="keywordtype">bool</span> passed=<span class="keyword">true</span>;</div>
<div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;       finite_element_pt(<a class="code" href="cfortran_8h.html#a37cd013acc76697829c324bdd8562d82">e</a>)-&gt;check_J_eulerian_at_knots(passed);</div>
<div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;       <span class="keywordflow">if</span> (!passed)</div>
<div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;        {</div>
<div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;         <span class="keywordflow">throw</span> <a class="code" href="classoomph_1_1OomphLibError.html">OomphLibError</a>(</div>
<div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;          <span class="stringliteral">&quot;Element remains inverted even after reversing the local node numbers&quot;</span>,</div>
<div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;          OOMPH_CURRENT_FUNCTION,</div>
<div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;          OOMPH_EXCEPTION_LOCATION);       </div>
<div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;        }</div>
<div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;      }</div>
<div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;    }</div>
<div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;   </div>
<div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;   </div>
<div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;   <span class="keywordflow">if</span> (!Suppress_warning_about_unpinned_nst_dofs)</div>
<div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;    {</div>
<div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;     <span class="keywordflow">if</span> (n_pinned_nodes==0)</div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;      {</div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;       std::stringstream bla;</div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;       bla &lt;&lt; <span class="stringliteral">&quot;Boundary conditions must be applied in Navier-Stokes\n&quot;</span></div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;           &lt;&lt; <span class="stringliteral">&quot;problem before attaching impedance elements.\n&quot;</span></div>
<div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;           &lt;&lt; <span class="stringliteral">&quot;Note: This warning can be suppressed by setting the\n&quot;</span></div>
<div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;           &lt;&lt; <span class="stringliteral">&quot;global static boolean\n\n&quot;</span></div>
<div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;           &lt;&lt; <span class="stringliteral">&quot;     TemplateFreeWomersleyMeshBase::Suppress_warning_about_unpinned_nst_dofs\n\n&quot;</span></div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;           &lt;&lt; <span class="stringliteral">&quot;to true\n&quot;</span>;</div>
<div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;       <a class="code" href="classoomph_1_1OomphLibWarning.html">OomphLibWarning</a>(bla.str(),</div>
<div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;                       OOMPH_CURRENT_FUNCTION,</div>
<div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;                       OOMPH_EXCEPTION_LOCATION);       </div>
<div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;      }</div>
<div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;    }</div>
<div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;   </div>
<div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;     <span class="keywordflow">if</span> (nnode()!=nnode_n_st)</div>
<div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;      {</div>
<div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;       <span class="keywordflow">throw</span> <a class="code" href="classoomph_1_1OomphLibError.html">OomphLibError</a>(</div>
<div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;        <span class="stringliteral">&quot;Number of nodes in the new mesh don&#39;t match that in the old one&quot;</span>,</div>
<div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;        OOMPH_CURRENT_FUNCTION,</div>
<div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;        OOMPH_EXCEPTION_LOCATION);       </div>
<div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;      }</div>
<div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160; </div>
<div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;  }</div>
<div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160; </div>
<div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;};</div>
<div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160; </div>
<div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;<span class="comment">/////////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;<span class="comment">/////////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160; </div>
<div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160; </div>
<div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;<span class="comment">//====================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;<span class="comment">/// WomersleyImpedanceTube that attaches itself to the outflow</span></div>
<div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;<span class="comment">/// of a Navier-Stokes mesh.</span></div>
<div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;<span class="comment"></span><span class="comment">//====================================================================</span></div>
<div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> ELEMENT, <span class="keywordtype">unsigned</span> DIM&gt;</div>
<div class="line"><a name="l01898"></a><span class="lineno"><a class="line" href="classoomph_1_1WomersleyOutflowImpedanceTube.html"> 1898</a></span>&#160;<span class="keyword">class </span><a class="code" href="classoomph_1_1WomersleyOutflowImpedanceTube.html">WomersleyOutflowImpedanceTube</a> : </div>
<div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;<span class="keyword">public</span> <a class="code" href="classoomph_1_1WomersleyImpedanceTubeBase.html">WomersleyImpedanceTubeBase</a>&lt;ELEMENT,DIM&gt;</div>
<div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;{</div>
<div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160; </div>
<div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;<span class="comment"> /// \short Constructor: Pass length and mesh of face elements that</span></div>
<div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;<span class="comment"> /// are attached to the outflow cross-section of the Navier Stokes mesh</span></div>
<div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;<span class="comment"> /// to constructor of underlying base class. Also specify</span></div>
<div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;<span class="comment"> /// the coordinate (in the higher-dimensional </span></div>
<div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;<span class="comment"> /// Navier-Stokes mesh) that is constant</span></div>
<div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;<span class="comment"> /// in the outflow cross-section and the velocity component</span></div>
<div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;<span class="comment"> /// (in terms of the nodal index) that represents the outflow</span></div>
<div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;<span class="comment"> /// component -- the latter is used to automatically apply</span></div>
<div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;<span class="comment"> /// the boundary conditions for the Womersley problem.</span></div>
<div class="line"><a name="l01913"></a><span class="lineno"><a class="line" href="classoomph_1_1WomersleyOutflowImpedanceTube.html#a43c6028b6a11ae3c73b26271f0176c58"> 1913</a></span>&#160;<span class="comment"></span> <a class="code" href="classoomph_1_1WomersleyOutflowImpedanceTube.html#a43c6028b6a11ae3c73b26271f0176c58">WomersleyOutflowImpedanceTube</a>(</div>
<div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; length,  </div>
<div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;  <a class="code" href="classoomph_1_1Mesh.html">Mesh</a>* navier_stokes_outflow_mesh_pt,</div>
<div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; fixed_coordinate,</div>
<div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; w_index) : </div>
<div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;  <a class="code" href="classoomph_1_1WomersleyImpedanceTubeBase.html">WomersleyImpedanceTubeBase</a>&lt;ELEMENT,DIM&gt;(length,</div>
<div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;                                          navier_stokes_outflow_mesh_pt),</div>
<div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;  Fixed_coordinate(fixed_coordinate), W_index(w_index)</div>
<div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;  {}</div>
<div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;<span class="comment"> /// \short Implement pure virtual fct (defined in the base class </span></div>
<div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;<span class="comment"> /// WomersleyImpedanceTubeBase) that builds the mesh of Womersley elements</span></div>
<div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;<span class="comment"> /// (of the type specified by the template argument), using the</span></div>
<div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;<span class="comment"> /// specified timestepper. Also applies the boundary condition.</span></div>
<div class="line"><a name="l01927"></a><span class="lineno"><a class="line" href="classoomph_1_1WomersleyOutflowImpedanceTube.html#a31655c396b473246a6a9840d789dc046"> 1927</a></span>&#160;<span class="comment"></span> <a class="code" href="classoomph_1_1Mesh.html">Mesh</a>* <a class="code" href="classoomph_1_1WomersleyOutflowImpedanceTube.html#a31655c396b473246a6a9840d789dc046">build_mesh_and_apply_boundary_conditions</a>(<a class="code" href="classoomph_1_1TimeStepper.html">TimeStepper</a>* time_stepper_pt)</div>
<div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;  {</div>
<div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;   <span class="comment">// Build mesh and automatically apply the same boundary</span></div>
<div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;   <span class="comment">// conditions as those that are applied to the W_index-th</span></div>
<div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;   <span class="comment">// value of the nodes in the Navier-Stokes mesh.</span></div>
<div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;   <a class="code" href="classoomph_1_1WomersleyMesh.html">WomersleyMesh&lt;ELEMENT&gt;</a>* womersley_mesh_pt=      </div>
<div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;    <span class="keyword">new</span> <a class="code" href="classoomph_1_1WomersleyMesh.html">WomersleyMesh&lt;ELEMENT&gt;</a>(</div>
<div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;     this-&gt;Navier_stokes_outflow_mesh_pt,</div>
<div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;     time_stepper_pt,</div>
<div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;     Fixed_coordinate,</div>
<div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;     W_index);</div>
<div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160; </div>
<div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;   <span class="keywordflow">return</span> womersley_mesh_pt;</div>
<div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160; </div>
<div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;  }</div>
<div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160; </div>
<div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;  <span class="keyword">private</span>:</div>
<div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;<span class="comment"> /// \short The coordinate (in the higher-dimensional Navier-Stokes </span></div>
<div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;<span class="comment"> /// mesh) that is constant in the outflow cross-section</span></div>
<div class="line"><a name="l01947"></a><span class="lineno"><a class="line" href="classoomph_1_1WomersleyOutflowImpedanceTube.html#aaed332bd590c1d300cd796a799ae9db8"> 1947</a></span>&#160;<span class="comment"></span> <span class="keywordtype">unsigned</span> <a class="code" href="classoomph_1_1WomersleyOutflowImpedanceTube.html#aaed332bd590c1d300cd796a799ae9db8">Fixed_coordinate</a>;</div>
<div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;<span class="comment"> /// \short The velocity component</span></div>
<div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;<span class="comment"> /// (in terms of the nodal index) that represents the outflow</span></div>
<div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;<span class="comment"> /// component -- the latter is used to automatically apply</span></div>
<div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;<span class="comment"> /// the boundary conditions for the Womersley problem.</span></div>
<div class="line"><a name="l01953"></a><span class="lineno"><a class="line" href="classoomph_1_1WomersleyOutflowImpedanceTube.html#ab695df8342d00c65a16d79af35c49ad1"> 1953</a></span>&#160;<span class="comment"></span> <span class="keywordtype">unsigned</span> <a class="code" href="classoomph_1_1WomersleyOutflowImpedanceTube.html#ab695df8342d00c65a16d79af35c49ad1">W_index</a>;</div>
<div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160; </div>
<div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160; </div>
<div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;};</div>
<div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;<span class="comment">/////////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;<span class="comment">/////////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160; </div>
<div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160; </div>
<div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;<span class="comment">/* //==================================================================== */</span></div>
<div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;<span class="comment">/* /// WomersleyImpedanceTube that attaches itself to the outflow */</span></div>
<div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;<span class="comment">/* /// of a Navier-Stokes mesh for use with . */</span></div>
<div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;<span class="comment">/* //==================================================================== */</span></div>
<div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;<span class="comment">/* template&lt;class ELEMENT, unsigned DIM&gt; */</span></div>
<div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;<span class="comment">/* class WomersleyOutflowImpedanceTubeForNavierStokesBlockPreconditioner :  */</span></div>
<div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;<span class="comment">/* public WomersleyImpedanceTubeBaseForNavierStokesBlockPreconditioner */</span></div>
<div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;<span class="comment">/* &lt;ELEMENT,DIM&gt; */</span></div>
<div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;<span class="comment">/* { */</span></div>
<div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160; </div>
<div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;<span class="comment">/* public: */</span></div>
<div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160; </div>
<div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;<span class="comment">/*  /// \short Constructor: Pass length and mesh of face elements that */</span></div>
<div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;<span class="comment">/*  /// are attached to the outflow cross-section of the Navier Stokes mesh */</span></div>
<div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;<span class="comment">/*  /// to constructor of underlying base class. Also specify */</span></div>
<div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;<span class="comment">/*  /// the coordinate (in the higher-dimensional  */</span></div>
<div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;<span class="comment">/*  /// Navier-Stokes mesh) that is constant */</span></div>
<div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;<span class="comment">/*  /// in the outflow cross-section and the velocity component */</span></div>
<div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;<span class="comment">/*  /// (in terms of the nodal index) that represents the outflow */</span></div>
<div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;<span class="comment">/*  /// component -- the latter is used to automatically apply */</span></div>
<div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;<span class="comment">/*  /// the boundary conditions for the Womersley problem. */</span></div>
<div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;<span class="comment">/*  WomersleyOutflowImpedanceTubeForNavierStokesBlockPreconditioner( */</span></div>
<div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;<span class="comment">/*   const double&amp; length,   */</span></div>
<div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;<span class="comment">/*   Mesh* navier_stokes_outflow_mesh_pt, */</span></div>
<div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;<span class="comment">/*   const unsigned&amp; fixed_coordinate, */</span></div>
<div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;<span class="comment">/*   const unsigned&amp; w_index) :  */</span></div>
<div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;<span class="comment">/*   WomersleyImpedanceTubeBaseForNavierStokesBlockPreconditioner&lt;ELEMENT,DIM&gt; */</span></div>
<div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;<span class="comment">/*   (length, */</span></div>
<div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;<span class="comment">/*    navier_stokes_outflow_mesh_pt), */</span></div>
<div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;<span class="comment">/*   Fixed_coordinate(fixed_coordinate), W_index(w_index) */</span></div>
<div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;<span class="comment">/*   {} */</span></div>
<div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160; </div>
<div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;<span class="comment">/*  /// \short Implement pure virtual fct (defined in the base class  */</span></div>
<div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;<span class="comment">/*  /// WomersleyImpedanceTubeBase) that builds the mesh of Womersley elements */</span></div>
<div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;<span class="comment">/*  /// (of the type specified by the template argument), using the */</span></div>
<div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;<span class="comment">/*  /// specified timestepper. Also applies the boundary condition. */</span></div>
<div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;<span class="comment">/*  Mesh* build_mesh_and_apply_boundary_conditions(TimeStepper* time_stepper_pt) */</span></div>
<div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;<span class="comment">/*   { */</span></div>
<div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;<span class="comment">/*    // Build mesh and automatically apply the same boundary */</span></div>
<div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;<span class="comment">/*    // conditions as those that are applied to the W_index-th */</span></div>
<div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;<span class="comment">/*    // value of the nodes in the Navier-Stokes mesh. */</span></div>
<div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;<span class="comment">/*    WomersleyMesh&lt;ELEMENT&gt;* womersley_mesh_pt=       // CHANGED TO USE ELEMENT */</span></div>
<div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;<span class="comment">/*     new WomersleyMesh&lt;ELEMENT&gt;( */</span></div>
<div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;<span class="comment">/*      this-&gt;Navier_stokes_outflow_mesh_pt, */</span></div>
<div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;<span class="comment">/*      time_stepper_pt, */</span></div>
<div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;<span class="comment">/*      Fixed_coordinate, */</span></div>
<div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;<span class="comment">/*      W_index); */</span></div>
<div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160; </div>
<div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;<span class="comment">/*    return womersley_mesh_pt; */</span></div>
<div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160; </div>
<div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;<span class="comment">/*   } */</span></div>
<div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160; </div>
<div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;<span class="comment">/*   private: */</span></div>
<div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160; </div>
<div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;<span class="comment">/*  /// \short The coordinate (in the higher-dimensional Navier-Stokes  */</span></div>
<div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;<span class="comment">/*  /// mesh) that is constant in the outflow cross-section */</span></div>
<div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;<span class="comment">/*  unsigned Fixed_coordinate; */</span></div>
<div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160; </div>
<div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;<span class="comment">/*  /// \short The velocity component */</span></div>
<div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;<span class="comment">/*  /// (in terms of the nodal index) that represents the outflow */</span></div>
<div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;<span class="comment">/*  /// component -- the latter is used to automatically apply */</span></div>
<div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;<span class="comment">/*  /// the boundary conditions for the Womersley problem. */</span></div>
<div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;<span class="comment">/*  unsigned W_index; */</span></div>
<div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160; </div>
<div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160; </div>
<div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;<span class="comment">/* }; */</span></div>
<div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160; </div>
<div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160; </div>
<div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;<span class="comment">/////////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;<span class="comment">/////////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;<span class="comment">/////////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160; </div>
<div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160; </div>
<div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;<span class="comment">//======================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;<span class="comment">/// A class for elements that allow the imposition of an impedance type </span></div>
<div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;<span class="comment">/// traction boundary condition to the Navier--Stokes equations </span></div>
<div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;<span class="comment">/// The geometrical information can be read from the FaceGeometery&lt;ELEMENT&gt; </span></div>
<div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;<span class="comment">/// class and and thus, we can be generic enough without the need to have</span></div>
<div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;<span class="comment">/// a separate equations class. Template arguments specify the</span></div>
<div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;<span class="comment">/// type of the bulk Navier Stokes elements that the elements are</span></div>
<div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;<span class="comment">/// attached to, and the type of the Womersley element used</span></div>
<div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;<span class="comment">/// to compute the flow resistance in the downstream &quot;impedance tube&quot;.</span></div>
<div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;<span class="comment"></span><span class="comment">//======================================================================</span></div>
<div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class </span>BULK_NAVIER_STOKES_ELEMENT, </div>
<div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;          <span class="keyword">class </span>WOMERSLEY_ELEMENT,</div>
<div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;          <span class="keywordtype">unsigned</span> DIM&gt;</div>
<div class="line"><a name="l02052"></a><span class="lineno"><a class="line" href="classoomph_1_1NavierStokesImpedanceTractionElement.html"> 2052</a></span>&#160;<span class="keyword">class </span><a class="code" href="classoomph_1_1NavierStokesImpedanceTractionElement.html">NavierStokesImpedanceTractionElement</a> : </div>
<div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;  <span class="keyword">public</span> <span class="keyword">virtual</span> <a class="code" href="classoomph_1_1FaceGeometry.html">FaceGeometry</a>&lt;BULK_NAVIER_STOKES_ELEMENT&gt;, </div>
<div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;  <span class="keyword">public</span> <span class="keyword">virtual</span> <a class="code" href="classoomph_1_1FaceElement.html">FaceElement</a>,</div>
<div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;  <span class="keyword">public</span> <span class="keyword">virtual</span> <a class="code" href="classoomph_1_1NavierStokesImpedanceTractionElementBase.html">NavierStokesImpedanceTractionElementBase</a></div>
<div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;{</div>
<div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160; </div>
<div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;  <span class="keyword">private</span>:</div>
<div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;<span class="comment"> /// \short Pointer to auxiliary integral, containing</span></div>
<div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;<span class="comment"> /// the derivative of the total volume flux through the</span></div>
<div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;<span class="comment"> /// outflow boundary of the (higher-dimensional) Navier-Stokes mesh w.r.t. </span></div>
<div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;<span class="comment"> /// to the discrete (global) (velocity) degrees of freedom.</span></div>
<div class="line"><a name="l02064"></a><span class="lineno"><a class="line" href="classoomph_1_1NavierStokesImpedanceTractionElement.html#a15020b8235206fc52d2fcf967e471904"> 2064</a></span>&#160;<span class="comment"></span> std::map&lt;unsigned,double&gt;* <a class="code" href="classoomph_1_1NavierStokesImpedanceTractionElement.html#a15020b8235206fc52d2fcf967e471904">Aux_integral_pt</a>;</div>
<div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;<span class="comment"> /// Pointer to ImpedanceTubeProblem that computes the flow resistance</span></div>
<div class="line"><a name="l02067"></a><span class="lineno"><a class="line" href="classoomph_1_1NavierStokesImpedanceTractionElement.html#a65123707e91f7a351bb9cffb64e1b81c"> 2067</a></span>&#160;<span class="comment"></span> <a class="code" href="classoomph_1_1WomersleyImpedanceTubeBase.html">WomersleyImpedanceTubeBase&lt;WOMERSLEY_ELEMENT,DIM&gt;</a>* <a class="code" href="classoomph_1_1NavierStokesImpedanceTractionElement.html#a65123707e91f7a351bb9cffb64e1b81c">Impedance_tube_pt</a>;</div>
<div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160; </div>
<div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160; </div>
<div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;  <span class="keyword">protected</span>:</div>
<div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;<span class="comment"> /// \short Access function that returns the local equation numbers</span></div>
<div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;<span class="comment"> /// for velocity components.</span></div>
<div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;<span class="comment"> /// u_local_eqn(n,i) = local equation number or &lt; 0 if pinned.</span></div>
<div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;<span class="comment"> /// The default is to asssume that n is the local node number</span></div>
<div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;<span class="comment"> /// and the i-th velocity component is the i-th unknown stored at the node.</span></div>
<div class="line"><a name="l02077"></a><span class="lineno"><a class="line" href="classoomph_1_1NavierStokesImpedanceTractionElement.html#ac5070c5b06b172cb7f1cb36b853e8edf"> 2077</a></span>&#160;<span class="comment"></span> <span class="keyword">virtual</span> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="classoomph_1_1NavierStokesImpedanceTractionElement.html#ac5070c5b06b172cb7f1cb36b853e8edf">u_local_eqn</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;<a class="code" href="the__data__structure_8txt.html#af88b2d950fae19ab641bd1690e08445c">n</a>, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>)</div>
<div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;  {<span class="keywordflow">return</span> nodal_local_eqn(<a class="code" href="the__data__structure_8txt.html#af88b2d950fae19ab641bd1690e08445c">n</a>,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>);}</div>
<div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;<span class="comment"> ///\short Function to compute the shape and test functions and to return </span></div>
<div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;<span class="comment"> ///the Jacobian of mapping </span></div>
<div class="line"><a name="l02082"></a><span class="lineno"><a class="line" href="classoomph_1_1NavierStokesImpedanceTractionElement.html#aa1738496ef280139a8bd1dbda979d8b1"> 2082</a></span>&#160;<span class="comment"></span> <span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1NavierStokesImpedanceTractionElement.html#aa1738496ef280139a8bd1dbda979d8b1">shape_and_test_at_knot</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;ipt, </div>
<div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;                                      <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;psi, <a class="code" href="classoomph_1_1Shape.html">Shape</a> &amp;test)<span class="keyword"></span></div>
<div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;<span class="keyword">  const</span></div>
<div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;   <span class="comment">//Find number of nodes</span></div>
<div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;   <span class="keywordtype">unsigned</span> n_node = nnode();</div>
<div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160; </div>
<div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;   <span class="comment">//Calculate the shape functions</span></div>
<div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;   shape_at_knot(ipt,psi);</div>
<div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160; </div>
<div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;   <span class="comment">//Set the test functions to be the same as the shape functions</span></div>
<div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;n_node;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++) {test[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] = psi[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>];}</div>
<div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160; </div>
<div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;   <span class="comment">//Return the value of the jacobian</span></div>
<div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;   <span class="keywordflow">return</span> J_eulerian_at_knot(ipt);</div>
<div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;  }</div>
<div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160; </div>
<div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;<span class="comment"> ///\short This function returns the residuals for the </span></div>
<div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;<span class="comment"> /// traction function.</span></div>
<div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;<span class="comment"> ///flag=1(or 0): do (or don&#39;t) compute the Jacobian as well. </span></div>
<div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> fill_in_generic_residual_contribution_fluid_traction(</div>
<div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;  <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;<a class="code" href="the__data__structure_8txt.html#a1400a973def57b85051cfe1070be1810">residuals</a>, </div>
<div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;  <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> &amp;jacobian, </div>
<div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;  <span class="keywordtype">unsigned</span> flag);</div>
<div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160; </div>
<div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160; </div>
<div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;  <span class="keyword">public</span>:</div>
<div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;<span class="comment"> ///Constructor, which takes a &quot;bulk&quot; element and the value of the index</span></div>
<div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;<span class="comment"> ///and its limit</span></div>
<div class="line"><a name="l02113"></a><span class="lineno"><a class="line" href="classoomph_1_1NavierStokesImpedanceTractionElement.html#a6d3191bb5be1c304b71e24140017eab5"> 2113</a></span>&#160;<span class="comment"></span> <a class="code" href="classoomph_1_1NavierStokesImpedanceTractionElement.html#a6d3191bb5be1c304b71e24140017eab5">NavierStokesImpedanceTractionElement</a>(<a class="code" href="classoomph_1_1FiniteElement.html">FiniteElement</a>* <span class="keyword">const</span> &amp;element_pt, </div>
<div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;                                      <span class="keyword">const</span> <span class="keywordtype">int</span> &amp;face_index) : </div>
<div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;  <a class="code" href="classoomph_1_1FaceGeometry.html">FaceGeometry</a>&lt;BULK_NAVIER_STOKES_ELEMENT&gt;(), <a class="code" href="classoomph_1_1FaceElement.html">FaceElement</a>()</div>
<div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;   { </div>
<div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160; </div>
<div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;   <span class="comment">//Attach the geometrical information to the element. N.B. This function</span></div>
<div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;   <span class="comment">//also assigns nbulk_value from the required_nvalue of the bulk element</span></div>
<div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;   element_pt-&gt;<a class="code" href="classoomph_1_1FiniteElement.html#aaf7bead5b462cfd5401d97b3dbdc7af7">build_face_element</a>(face_index,<span class="keyword">this</span>);</div>
<div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160; </div>
<div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;   <span class="comment">// Initialise pointer to mesh containing the </span></div>
<div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;   <span class="comment">// NavierStokesImpedanceTractionElements</span></div>
<div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;   <span class="comment">// that contribute to the volume flux into the &quot;downstream tube&quot; that</span></div>
<div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;   <span class="comment">// provides the impedance</span></div>
<div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;   Navier_stokes_outflow_mesh_pt=0;</div>
<div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160; </div>
<div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;   <span class="comment">// Initialise pointer to impedance tube</span></div>
<div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;   Impedance_tube_pt=0;</div>
<div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160; </div>
<div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;   <span class="comment">// Initialise pointer to auxiliary integral</span></div>
<div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;   Aux_integral_pt=0;</div>
<div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160; </div>
<div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;   <span class="comment">//Set the dimension from the dimension of the first node</span></div>
<div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;   <span class="comment">//Dim = this-&gt;node_pt(0)-&gt;ndim();</span></div>
<div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160; </div>
<div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;    {</div>
<div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;     <span class="comment">//Check that the element is not a refineable 3d element</span></div>
<div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;     BULK_NAVIER_STOKES_ELEMENT* elem_pt = </div>
<div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;      <span class="keyword">dynamic_cast&lt;</span>BULK_NAVIER_STOKES_ELEMENT*<span class="keyword">&gt;</span>(element_pt);</div>
<div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;     <span class="comment">//If it&#39;s three-d</span></div>
<div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;     <span class="keywordflow">if</span>(elem_pt-&gt;dim()==3)</div>
<div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;      {</div>
<div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;       <span class="comment">//Is it refineable</span></div>
<div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;       <a class="code" href="classoomph_1_1RefineableElement.html">RefineableElement</a>* ref_el_pt=<span class="keyword">dynamic_cast&lt;</span><a class="code" href="classoomph_1_1RefineableElement.html">RefineableElement</a>*<span class="keyword">&gt;</span>(elem_pt);</div>
<div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;       <span class="keywordflow">if</span>(ref_el_pt!=0)</div>
<div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;        {</div>
<div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;         <span class="keywordflow">if</span> (this-&gt;has_hanging_nodes())</div>
<div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;          {</div>
<div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;           <span class="keywordflow">throw</span> <a class="code" href="classoomph_1_1OomphLibError.html">OomphLibError</a>(</div>
<div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;            <span class="stringliteral">&quot;This flux element will not work correctly if nodes are hanging\n&quot;</span>,</div>
<div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;            OOMPH_CURRENT_FUNCTION,</div>
<div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;            OOMPH_EXCEPTION_LOCATION);</div>
<div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;          }</div>
<div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;        }</div>
<div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;      }</div>
<div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;    }</div>
<div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160; }</div>
<div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160; </div>
<div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;<span class="comment"> /// Destructor should not delete anything</span></div>
<div class="line"><a name="l02164"></a><span class="lineno"><a class="line" href="classoomph_1_1NavierStokesImpedanceTractionElement.html#a19a1379dee4fab03c2f8574665bc4184"> 2164</a></span>&#160;<span class="comment"></span> <a class="code" href="classoomph_1_1NavierStokesImpedanceTractionElement.html#a19a1379dee4fab03c2f8574665bc4184">~NavierStokesImpedanceTractionElement</a>() { }</div>
<div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;<span class="comment"> /// \short Access to mesh containing all NavierStokesImpedanceTractionElements</span></div>
<div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;<span class="comment"> /// that contribute to the volume flux into the &quot;downstream tube&quot; that</span></div>
<div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;<span class="comment"> /// provides the impedance</span></div>
<div class="line"><a name="l02169"></a><span class="lineno"><a class="line" href="classoomph_1_1NavierStokesImpedanceTractionElement.html#a6ddd1fa5b0e8c498aa1fc03f4492ee34"> 2169</a></span>&#160;<span class="comment"></span> <a class="code" href="classoomph_1_1Mesh.html">Mesh</a>*&amp; <a class="code" href="classoomph_1_1NavierStokesImpedanceTractionElement.html#a6ddd1fa5b0e8c498aa1fc03f4492ee34">navier_stokes_outflow_mesh_pt</a>()</div>
<div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;  {</div>
<div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;   <span class="keywordflow">return</span> Navier_stokes_outflow_mesh_pt;</div>
<div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;  }</div>
<div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;<span class="comment"> /// \short Get integral of volume flux through element</span></div>
<div class="line"><a name="l02175"></a><span class="lineno"><a class="line" href="classoomph_1_1NavierStokesImpedanceTractionElement.html#a853055ebb50a6500602288a6f0563852"> 2175</a></span>&#160;<span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1NavierStokesImpedanceTractionElement.html#a853055ebb50a6500602288a6f0563852">get_volume_flux</a>()</div>
<div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;  {</div>
<div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;   <span class="comment">// Initialise</span></div>
<div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;   <span class="keywordtype">double</span> volume_flux_integral=0.0;</div>
<div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160; </div>
<div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;   <span class="comment">//Vector of local coordinates in face element</span></div>
<div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;   <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>(DIM);</div>
<div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160; </div>
<div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;   <span class="comment">// Vector for global Eulerian coordinates</span></div>
<div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;   <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> x(DIM+1);</div>
<div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160; </div>
<div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;   <span class="comment">// Vector for local coordinates in bulk element</span></div>
<div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;   <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> s_bulk(DIM+1);</div>
<div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160; </div>
<div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;   <span class="comment">//Set the value of n_intpt</span></div>
<div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;   <span class="keywordtype">unsigned</span> n_intpt = integral_pt()-&gt;nweight();</div>
<div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;   </div>
<div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;   <span class="comment">// Get pointer to assocated bulk element</span></div>
<div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;   BULK_NAVIER_STOKES_ELEMENT* bulk_el_pt=</div>
<div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;    <span class="keyword">dynamic_cast&lt;</span>BULK_NAVIER_STOKES_ELEMENT*<span class="keyword">&gt;</span>(bulk_element_pt());</div>
<div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160; </div>
<div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;   <span class="comment">//Loop over the integration points</span></div>
<div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> ipt=0;ipt&lt;n_intpt;ipt++)</div>
<div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;    {</div>
<div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160; </div>
<div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;     <span class="comment">//Assign values of s in FaceElement and local coordinates in bulk element</span></div>
<div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;DIM;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;      {</div>
<div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;       <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] = integral_pt()-&gt;knot(ipt,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>);</div>
<div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;      }</div>
<div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160; </div>
<div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;     <span class="comment">//Get the bulk coordinates</span></div>
<div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;     this-&gt;get_local_coordinate_in_bulk(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,s_bulk);</div>
<div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;     </div>
<div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;     <span class="comment">//Get the integral weight</span></div>
<div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;     <span class="keywordtype">double</span> w = integral_pt()-&gt;weight(ipt);</div>
<div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160; </div>
<div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;     <span class="comment">// Get jacobian of mapping</span></div>
<div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;     <span class="keywordtype">double</span> J=J_eulerian(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>);</div>
<div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160; </div>
<div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;     <span class="comment">//Premultiply the weights and the Jacobian</span></div>
<div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;     <span class="keywordtype">double</span> <a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a> = w*J;</div>
<div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160; </div>
<div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160; </div>
<div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160; </div>
<div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;     <span class="comment">// Get x position as Vector</span></div>
<div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;     interpolated_x(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,x);</div>
<div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160; </div>
<div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;     <span class="comment">// Get x position as Vector from bulk element</span></div>
<div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;     <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> x_bulk(DIM+1);</div>
<div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;     bulk_el_pt-&gt;interpolated_x(s_bulk,x_bulk);</div>
<div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160; </div>
<div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;     <span class="keywordtype">double</span> max_legal_error=1.0e-12;</div>
<div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;     <span class="keywordtype">double</span> error=0.0;</div>
<div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;DIM+1;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;      {</div>
<div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160;       error+=std::fabs(x[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]- x_bulk[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]);</div>
<div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160;      }</div>
<div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;     <span class="keywordflow">if</span> (error&gt;max_legal_error)</div>
<div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;      {</div>
<div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;       std::ostringstream error_stream;</div>
<div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;       error_stream &lt;&lt; <span class="stringliteral">&quot;difference in Eulerian posn from bulk and face: &quot;</span> </div>
<div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;                    &lt;&lt; error &lt;&lt; <span class="stringliteral">&quot; exceeds threshold &quot;</span> &lt;&lt; max_legal_error </div>
<div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;                    &lt;&lt; std::endl;</div>
<div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;       <span class="keywordflow">throw</span> <a class="code" href="classoomph_1_1OomphLibError.html">OomphLibError</a>(</div>
<div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;        error_stream.str(),</div>
<div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;        OOMPH_CURRENT_FUNCTION,</div>
<div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;        OOMPH_EXCEPTION_LOCATION);</div>
<div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;      }</div>
<div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160; </div>
<div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;     <span class="comment">// Outer unit normal</span></div>
<div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;     <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> normal(DIM+1);</div>
<div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;     outer_unit_normal(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,normal);</div>
<div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160; </div>
<div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;     <span class="comment">// Get velocity from bulk element</span></div>
<div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;     <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> veloc(DIM+1);</div>
<div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;     bulk_el_pt-&gt;interpolated_u_nst(s_bulk,veloc);</div>
<div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160; </div>
<div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;     <span class="comment">// Volume flux</span></div>
<div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;     <span class="keywordtype">double</span> volume_flux=0.0;</div>
<div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;DIM+1;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;      {</div>
<div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;       volume_flux+=normal[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]*veloc[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>];</div>
<div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;      }</div>
<div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160; </div>
<div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160;     <span class="comment">// Add to integral</span></div>
<div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160;     volume_flux_integral+=volume_flux*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160; </div>
<div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160;    }</div>
<div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160;   </div>
<div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160;   <span class="keywordflow">return</span> volume_flux_integral;</div>
<div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160; </div>
<div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160;  }</div>
<div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160; </div>
<div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;<span class="comment"> /// \short NavierStokesImpedanceTractionElements that contribute</span></div>
<div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;<span class="comment"> /// to the volume flux into the downstream &quot;impedance tube&quot;</span></div>
<div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160;<span class="comment"> /// to the element and classify all nodes in that mesh</span></div>
<div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;<span class="comment"> /// as external Data for this element (unless the nodes</span></div>
<div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160;<span class="comment"> /// are also the element&#39;s own nodes, of course). </span></div>
<div class="line"><a name="l02277"></a><span class="lineno"><a class="line" href="classoomph_1_1NavierStokesImpedanceTractionElement.html#afd73c927eab27d77f54d83c67ef84a0f"> 2277</a></span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1NavierStokesImpedanceTractionElement.html#afd73c927eab27d77f54d83c67ef84a0f">set_external_data_from_navier_stokes_outflow_mesh</a>(</div>
<div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160;  <a class="code" href="classoomph_1_1Mesh.html">Mesh</a>* navier_stokes_outflow_mesh_pt)</div>
<div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;  {</div>
<div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160; </div>
<div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160;   <span class="comment">// Store pointer to mesh of NavierStokesImpedanceTractionElement</span></div>
<div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160;   <span class="comment">// that contribute to the volume flux into the &quot;impedance tube&quot; that </span></div>
<div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;   <span class="comment">// provides the flow resistance</span></div>
<div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160;   Navier_stokes_outflow_mesh_pt=navier_stokes_outflow_mesh_pt;</div>
<div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160; </div>
<div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160;   <span class="comment">// Create a set the contains all nodal Data in the flux mesh</span></div>
<div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160;   std::set&lt;Data*&gt; external_data_set;</div>
<div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160;   <span class="keywordtype">unsigned</span> nelem=Navier_stokes_outflow_mesh_pt-&gt;<a class="code" href="classoomph_1_1Mesh.html#af01dfefb66c15579b540be62999d93ee">nelement</a>();</div>
<div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#a37cd013acc76697829c324bdd8562d82">e</a>=0;<a class="code" href="cfortran_8h.html#a37cd013acc76697829c324bdd8562d82">e</a>&lt;nelem;<a class="code" href="cfortran_8h.html#a37cd013acc76697829c324bdd8562d82">e</a>++)</div>
<div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160;    {</div>
<div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160;     <a class="code" href="classoomph_1_1FiniteElement.html">FiniteElement</a>* el_pt=Navier_stokes_outflow_mesh_pt-&gt;finite_element_pt(<a class="code" href="cfortran_8h.html#a37cd013acc76697829c324bdd8562d82">e</a>);</div>
<div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160;     <span class="keywordtype">unsigned</span> nnod=el_pt-&gt;<a class="code" href="classoomph_1_1FiniteElement.html#a6219ed269a6d89b5aa14659cce48905a">nnode</a>();</div>
<div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160;     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j=0;j&lt;nnod;j++)</div>
<div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;      {</div>
<div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160;       external_data_set.insert(el_pt-&gt;<a class="code" href="classoomph_1_1FiniteElement.html#ace0e7fb72a805b5c2c600347bfae7a9b">node_pt</a>(j));</div>
<div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160;      }</div>
<div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;    }                      </div>
<div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;   </div>
<div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;   <span class="comment">// Remove the element&#39;s own nodes</span></div>
<div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;   <span class="keywordtype">unsigned</span> nnod=nnode();</div>
<div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j=0;j&lt;nnod;j++)</div>
<div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;    {</div>
<div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;     external_data_set.erase(node_pt(j));</div>
<div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;    }     </div>
<div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160; </div>
<div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;   <span class="comment">// Copy across</span></div>
<div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160;   <span class="keywordflow">for</span> (std::set&lt;Data*&gt;::iterator it=external_data_set.begin();</div>
<div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;        it!=external_data_set.end();it++)</div>
<div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160;    {</div>
<div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160;     add_external_data(*it);</div>
<div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160;    }</div>
<div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160;  }</div>
<div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160; </div>
<div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160;<span class="comment"> /// \short Set pointer to the precomputed auxiliary integral that contains </span></div>
<div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160;<span class="comment"> /// the derivative of the total volume flux through the</span></div>
<div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160;<span class="comment"> /// outflow boundary of the (higher-dimensional) Navier-Stokes mesh w.r.t. </span></div>
<div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160;<span class="comment"> /// to the discrete (global) (velocity) degrees of freedom.</span></div>
<div class="line"><a name="l02319"></a><span class="lineno"><a class="line" href="classoomph_1_1NavierStokesImpedanceTractionElement.html#abd5db43a552949e7d2ab4c1c25a68e96"> 2319</a></span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1NavierStokesImpedanceTractionElement.html#abd5db43a552949e7d2ab4c1c25a68e96">set_aux_integral_pt</a>(std::map&lt;unsigned,double&gt;* aux_integral_pt)</div>
<div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160;  {</div>
<div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160;   Aux_integral_pt=aux_integral_pt;</div>
<div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160;  }</div>
<div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160; </div>
<div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;<span class="comment"> /// \short Compute total volume flux into the &quot;downstream tube&quot; that</span></div>
<div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;<span class="comment"> /// provides the impedance (computed by adding up the flux</span></div>
<div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160;<span class="comment"> /// through all  NavierStokesImpedanceTractionElements in</span></div>
<div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160;<span class="comment"> /// the mesh specified by volume_flux_mesh_pt().</span></div>
<div class="line"><a name="l02329"></a><span class="lineno"><a class="line" href="classoomph_1_1NavierStokesImpedanceTractionElement.html#ade2eae5b0a6ecac82949f05a073217ea"> 2329</a></span>&#160;<span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1NavierStokesImpedanceTractionElement.html#ade2eae5b0a6ecac82949f05a073217ea">total_volume_flux_into_downstream_tube</a>()</div>
<div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;  {</div>
<div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160;   <span class="keywordflow">if</span> (Navier_stokes_outflow_mesh_pt==0)</div>
<div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160;    {</div>
<div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160;     <span class="keywordflow">throw</span> <a class="code" href="classoomph_1_1OomphLibError.html">OomphLibError</a>(</div>
<div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160;      <span class="stringliteral">&quot;Navier_stokes_outflow_mesh_pt==0 -- set it with \n set_external_data_from_navier_stokes_outflow_mesh() before calling this function!\n&quot;</span>,</div>
<div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160;      OOMPH_CURRENT_FUNCTION,</div>
<div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160;      OOMPH_EXCEPTION_LOCATION);    }</div>
<div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160; </div>
<div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160; </div>
<div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160;   <span class="keywordtype">double</span> total_flux=0.0;</div>
<div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160;   <span class="keywordtype">unsigned</span> nelem=Navier_stokes_outflow_mesh_pt-&gt;nelement();</div>
<div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#a37cd013acc76697829c324bdd8562d82">e</a>=0;<a class="code" href="cfortran_8h.html#a37cd013acc76697829c324bdd8562d82">e</a>&lt;nelem;<a class="code" href="cfortran_8h.html#a37cd013acc76697829c324bdd8562d82">e</a>++)</div>
<div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160;    {</div>
<div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160;     <a class="code" href="classoomph_1_1NavierStokesImpedanceTractionElement.html">NavierStokesImpedanceTractionElement</a>&lt;BULK_NAVIER_STOKES_ELEMENT, </div>
<div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160;      WOMERSLEY_ELEMENT,DIM&gt;* el_pt=</div>
<div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160;      <span class="keyword">dynamic_cast&lt;</span></div>
<div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160;      <a class="code" href="classoomph_1_1NavierStokesImpedanceTractionElement.html">NavierStokesImpedanceTractionElement</a>&lt;BULK_NAVIER_STOKES_ELEMENT, </div>
<div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160;      WOMERSLEY_ELEMENT,DIM<span class="keyword">&gt;</span>*&gt;(</div>
<div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160;       Navier_stokes_outflow_mesh_pt-&gt;element_pt(<a class="code" href="cfortran_8h.html#a37cd013acc76697829c324bdd8562d82">e</a>));</div>
<div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160;     total_flux+=el_pt-&gt;<a class="code" href="classoomph_1_1NavierStokesImpedanceTractionElement.html#a853055ebb50a6500602288a6f0563852">get_volume_flux</a>(); </div>
<div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160;    }</div>
<div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160;   <span class="keywordflow">return</span> total_flux;</div>
<div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160;  }</div>
<div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160; </div>
<div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;<span class="comment"> /// \short Set pointer to &quot;impedance tube&quot; that provides the flow</span></div>
<div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160;<span class="comment"> /// resistance</span></div>
<div class="line"><a name="l02359"></a><span class="lineno"><a class="line" href="classoomph_1_1NavierStokesImpedanceTractionElement.html#aab0f649a0569d9caa428b8a932cc1c40"> 2359</a></span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1NavierStokesImpedanceTractionElement.html#aab0f649a0569d9caa428b8a932cc1c40">set_impedance_tube_pt</a>(<a class="code" href="classoomph_1_1TemplateFreeWomersleyImpedanceTubeBase.html">TemplateFreeWomersleyImpedanceTubeBase</a>*</div>
<div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160;                            impedance_tube_pt)</div>
<div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160;  {</div>
<div class="line"><a name="l02362"></a><span class="lineno"> 2362</span>&#160;   Impedance_tube_pt=<span class="keyword">dynamic_cast&lt;</span></div>
<div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160;    <a class="code" href="classoomph_1_1WomersleyImpedanceTubeBase.html">WomersleyImpedanceTubeBase&lt;WOMERSLEY_ELEMENT,DIM&gt;</a>*<span class="keyword">&gt;</span>(impedance_tube_pt);</div>
<div class="line"><a name="l02364"></a><span class="lineno"> 2364</span>&#160;  }</div>
<div class="line"><a name="l02365"></a><span class="lineno"> 2365</span>&#160; </div>
<div class="line"><a name="l02366"></a><span class="lineno"> 2366</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160;<span class="comment"> /// Add the element&#39;s contribution to the auxiliary integral</span></div>
<div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160;<span class="comment"> /// that contains the derivative of the total volume flux through the</span></div>
<div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160;<span class="comment"> /// outflow boundary of the (higher-dimensional) Navier-Stokes mesh w.r.t. </span></div>
<div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160;<span class="comment"> /// to the discrete (global) (velocity) degrees of freedom.</span></div>
<div class="line"><a name="l02371"></a><span class="lineno"><a class="line" href="classoomph_1_1NavierStokesImpedanceTractionElement.html#addae9a132e1004423ce501f71a84fe07"> 2371</a></span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1NavierStokesImpedanceTractionElement.html#addae9a132e1004423ce501f71a84fe07">add_element_contribution_to_aux_integral</a>(std::map&lt;unsigned,double&gt;* </div>
<div class="line"><a name="l02372"></a><span class="lineno"> 2372</span>&#160;                                               aux_integral_pt)</div>
<div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160;  {</div>
<div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160;   <span class="comment">// Spatial dimension of element</span></div>
<div class="line"><a name="l02375"></a><span class="lineno"> 2375</span>&#160;   <span class="comment">// unsigned ndim=dim();</span></div>
<div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160;   </div>
<div class="line"><a name="l02377"></a><span class="lineno"> 2377</span>&#160;   <span class="comment">//Vector of local coordinates in face element</span></div>
<div class="line"><a name="l02378"></a><span class="lineno"> 2378</span>&#160;   <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>(DIM);</div>
<div class="line"><a name="l02379"></a><span class="lineno"> 2379</span>&#160; </div>
<div class="line"><a name="l02380"></a><span class="lineno"> 2380</span>&#160;   <span class="comment">// Create storage for shape functions</span></div>
<div class="line"><a name="l02381"></a><span class="lineno"> 2381</span>&#160;   <span class="keywordtype">unsigned</span> nnod=nnode();</div>
<div class="line"><a name="l02382"></a><span class="lineno"> 2382</span>&#160;   <a class="code" href="classoomph_1_1Shape.html">Shape</a> psi(nnod);</div>
<div class="line"><a name="l02383"></a><span class="lineno"> 2383</span>&#160; </div>
<div class="line"><a name="l02384"></a><span class="lineno"> 2384</span>&#160;   <span class="comment">//Set the value of n_intpt</span></div>
<div class="line"><a name="l02385"></a><span class="lineno"> 2385</span>&#160;   <span class="keywordtype">unsigned</span> n_intpt = integral_pt()-&gt;nweight();</div>
<div class="line"><a name="l02386"></a><span class="lineno"> 2386</span>&#160;   </div>
<div class="line"><a name="l02387"></a><span class="lineno"> 2387</span>&#160;   <span class="comment">//Loop over the integration points</span></div>
<div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> ipt=0;ipt&lt;n_intpt;ipt++)</div>
<div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160;    {</div>
<div class="line"><a name="l02390"></a><span class="lineno"> 2390</span>&#160; </div>
<div class="line"><a name="l02391"></a><span class="lineno"> 2391</span>&#160;     <span class="comment">//Assign values of s in FaceElement and local coordinates in bulk element</span></div>
<div class="line"><a name="l02392"></a><span class="lineno"> 2392</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;DIM;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l02393"></a><span class="lineno"> 2393</span>&#160;      {</div>
<div class="line"><a name="l02394"></a><span class="lineno"> 2394</span>&#160;       <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] = integral_pt()-&gt;knot(ipt,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>);</div>
<div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160;      }</div>
<div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160; </div>
<div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160;     <span class="comment">//Get the integral weight</span></div>
<div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160;     <span class="keywordtype">double</span> w = integral_pt()-&gt;weight(ipt);</div>
<div class="line"><a name="l02399"></a><span class="lineno"> 2399</span>&#160; </div>
<div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160;     <span class="comment">// Get jacobian of mapping</span></div>
<div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160;     <span class="keywordtype">double</span> J=J_eulerian(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>);</div>
<div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160; </div>
<div class="line"><a name="l02403"></a><span class="lineno"> 2403</span>&#160;     <span class="comment">// Get shape functions</span></div>
<div class="line"><a name="l02404"></a><span class="lineno"> 2404</span>&#160;     <a class="code" href="namespaceoomph_1_1OneDimLagrange.html#a117f8b892dc89989ecdad99ff261e120">shape</a>(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,psi);</div>
<div class="line"><a name="l02405"></a><span class="lineno"> 2405</span>&#160; </div>
<div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160;     <span class="comment">//Premultiply the weights and the Jacobian</span></div>
<div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160;     <span class="keywordtype">double</span> <a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a> = w*J;</div>
<div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160; </div>
<div class="line"><a name="l02409"></a><span class="lineno"> 2409</span>&#160;     <span class="comment">// Outer unit normal</span></div>
<div class="line"><a name="l02410"></a><span class="lineno"> 2410</span>&#160;     <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> normal(DIM+1);</div>
<div class="line"><a name="l02411"></a><span class="lineno"> 2411</span>&#160;     outer_unit_normal(<a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,normal);</div>
<div class="line"><a name="l02412"></a><span class="lineno"> 2412</span>&#160; </div>
<div class="line"><a name="l02413"></a><span class="lineno"> 2413</span>&#160;     <span class="comment">// Loop over nodes</span></div>
<div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160;     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j=0;j&lt;nnod;j++)</div>
<div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160;      {</div>
<div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160;       <span class="comment">// Get pointer to Node</span></div>
<div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160;       <a class="code" href="classoomph_1_1Node.html">Node</a>* nod_pt=node_pt(j);</div>
<div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160; </div>
<div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160;       <span class="comment">// Loop over directions</span></div>
<div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160;       <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;(DIM+1);<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160;        {</div>
<div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160;         <span class="comment">// Get global equation number</span></div>
<div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160;         <span class="keywordtype">int</span> <a class="code" href="the__data__structure_8txt.html#a0ca71de52c9f65466ea6eefc4f332736">i_global</a>=nod_pt-&gt;<a class="code" href="classoomph_1_1Data.html#a13206dcb7a088db0ef845ab71af505d2">eqn_number</a>(<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>);</div>
<div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160;         </div>
<div class="line"><a name="l02425"></a><span class="lineno"> 2425</span>&#160;         <span class="comment">// Real dof or bc?</span></div>
<div class="line"><a name="l02426"></a><span class="lineno"> 2426</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="the__data__structure_8txt.html#a0ca71de52c9f65466ea6eefc4f332736">i_global</a>&gt;=0)</div>
<div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160;          {</div>
<div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160;           (*aux_integral_pt)[<a class="code" href="the__data__structure_8txt.html#a0ca71de52c9f65466ea6eefc4f332736">i_global</a>]+=psi[j]*normal[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l02429"></a><span class="lineno"> 2429</span>&#160;          }</div>
<div class="line"><a name="l02430"></a><span class="lineno"> 2430</span>&#160;        }</div>
<div class="line"><a name="l02431"></a><span class="lineno"> 2431</span>&#160;      }</div>
<div class="line"><a name="l02432"></a><span class="lineno"> 2432</span>&#160;    }</div>
<div class="line"><a name="l02433"></a><span class="lineno"> 2433</span>&#160;  }</div>
<div class="line"><a name="l02434"></a><span class="lineno"> 2434</span>&#160; </div>
<div class="line"><a name="l02435"></a><span class="lineno"> 2435</span>&#160; </div>
<div class="line"><a name="l02436"></a><span class="lineno"> 2436</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02437"></a><span class="lineno"> 2437</span>&#160;<span class="comment"> /// Fill in the element&#39;s contribution to the element&#39;s residual vector</span></div>
<div class="line"><a name="l02438"></a><span class="lineno"><a class="line" href="classoomph_1_1NavierStokesImpedanceTractionElement.html#a59864479b537aae999dceaa38e8856ef"> 2438</a></span>&#160;<span class="comment"></span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1NavierStokesImpedanceTractionElement.html#a59864479b537aae999dceaa38e8856ef">fill_in_contribution_to_residuals</a>(<a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;<a class="code" href="the__data__structure_8txt.html#a1400a973def57b85051cfe1070be1810">residuals</a>)</div>
<div class="line"><a name="l02439"></a><span class="lineno"> 2439</span>&#160;  {</div>
<div class="line"><a name="l02440"></a><span class="lineno"> 2440</span>&#160;   <span class="comment">//Call the generic residuals function with flag set to 0</span></div>
<div class="line"><a name="l02441"></a><span class="lineno"> 2441</span>&#160;   <span class="comment">//using a dummy matrix argument</span></div>
<div class="line"><a name="l02442"></a><span class="lineno"> 2442</span>&#160;   fill_in_generic_residual_contribution_fluid_traction(</div>
<div class="line"><a name="l02443"></a><span class="lineno"> 2443</span>&#160;    <a class="code" href="the__data__structure_8txt.html#a1400a973def57b85051cfe1070be1810">residuals</a>,GeneralisedElement::Dummy_matrix,0);</div>
<div class="line"><a name="l02444"></a><span class="lineno"> 2444</span>&#160;  }</div>
<div class="line"><a name="l02445"></a><span class="lineno"> 2445</span>&#160; </div>
<div class="line"><a name="l02446"></a><span class="lineno"> 2446</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02447"></a><span class="lineno"> 2447</span>&#160;<span class="comment"> /// \short Fill in the element&#39;s contribution to the element&#39;s residual vector</span></div>
<div class="line"><a name="l02448"></a><span class="lineno"> 2448</span>&#160;<span class="comment"> /// and Jacobian matrix</span></div>
<div class="line"><a name="l02449"></a><span class="lineno"><a class="line" href="classoomph_1_1NavierStokesImpedanceTractionElement.html#a708121c1a4224d0d2c572904f74f2fb6"> 2449</a></span>&#160;<span class="comment"></span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1NavierStokesImpedanceTractionElement.html#a708121c1a4224d0d2c572904f74f2fb6">fill_in_contribution_to_jacobian</a>(<a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;<a class="code" href="the__data__structure_8txt.html#a1400a973def57b85051cfe1070be1810">residuals</a>,</div>
<div class="line"><a name="l02450"></a><span class="lineno"> 2450</span>&#160;                                              <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> &amp;jacobian)</div>
<div class="line"><a name="l02451"></a><span class="lineno"> 2451</span>&#160;  {</div>
<div class="line"><a name="l02452"></a><span class="lineno"> 2452</span>&#160;   <span class="comment">//Call the generic routine with the flag set to 1</span></div>
<div class="line"><a name="l02453"></a><span class="lineno"> 2453</span>&#160;   fill_in_generic_residual_contribution_fluid_traction(<a class="code" href="the__data__structure_8txt.html#a1400a973def57b85051cfe1070be1810">residuals</a>,jacobian,1);</div>
<div class="line"><a name="l02454"></a><span class="lineno"> 2454</span>&#160;  }</div>
<div class="line"><a name="l02455"></a><span class="lineno"> 2455</span>&#160; </div>
<div class="line"><a name="l02456"></a><span class="lineno"> 2456</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160;<span class="comment"> /// Specify the value of nodal zeta from the face geometry</span></div>
<div class="line"><a name="l02458"></a><span class="lineno"> 2458</span>&#160;<span class="comment"> /// \short The &quot;global&quot; intrinsic coordinate of the element when</span></div>
<div class="line"><a name="l02459"></a><span class="lineno"> 2459</span>&#160;<span class="comment"> /// viewed as part of a geometric object should be given by</span></div>
<div class="line"><a name="l02460"></a><span class="lineno"> 2460</span>&#160;<span class="comment"> /// the FaceElement representation, by default (needed to break</span></div>
<div class="line"><a name="l02461"></a><span class="lineno"> 2461</span>&#160;<span class="comment"> /// indeterminacy if bulk element is SolidElement)</span></div>
<div class="line"><a name="l02462"></a><span class="lineno"><a class="line" href="classoomph_1_1NavierStokesImpedanceTractionElement.html#a3be6b5b3152e35c76339a5de6ec1e93a"> 2462</a></span>&#160;<span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1NavierStokesImpedanceTractionElement.html#a3be6b5b3152e35c76339a5de6ec1e93a">zeta_nodal</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;<a class="code" href="the__data__structure_8txt.html#af88b2d950fae19ab641bd1690e08445c">n</a>, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;k,           </div>
<div class="line"><a name="l02463"></a><span class="lineno"> 2463</span>&#160;                   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>)<span class="keyword"> const </span></div>
<div class="line"><a name="l02464"></a><span class="lineno"> 2464</span>&#160;<span class="keyword"> </span>{<span class="keywordflow">return</span> FaceElement::zeta_nodal(<a class="code" href="the__data__structure_8txt.html#af88b2d950fae19ab641bd1690e08445c">n</a>,k,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>);}     </div>
<div class="line"><a name="l02465"></a><span class="lineno"> 2465</span>&#160; </div>
<div class="line"><a name="l02466"></a><span class="lineno"> 2466</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l02467"></a><span class="lineno"> 2467</span>&#160;<span class="comment"> ///Overload the output function</span></div>
<div class="line"><a name="l02468"></a><span class="lineno"><a class="line" href="classoomph_1_1NavierStokesImpedanceTractionElement.html#a43b61cca808fed11ace680439488c3df"> 2468</a></span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1NavierStokesImpedanceTractionElement.html#a43b61cca808fed11ace680439488c3df">output</a>(std::ostream &amp;outfile) {<a class="code" href="namespaceoomph.html#a2473930e2634d673e2a3bed63b6851f0">FiniteElement::output</a>(outfile);}</div>
<div class="line"><a name="l02469"></a><span class="lineno"> 2469</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l02470"></a><span class="lineno"> 2470</span>&#160;<span class="comment">///Output function: x,y,[z],u,v,[w],p in tecplot format</span></div>
<div class="line"><a name="l02471"></a><span class="lineno"><a class="line" href="classoomph_1_1NavierStokesImpedanceTractionElement.html#a11722da061d3972b24932181b2ef9ae4"> 2471</a></span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1NavierStokesImpedanceTractionElement.html#a11722da061d3972b24932181b2ef9ae4">output</a>(std::ostream &amp;outfile, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;nplot)</div>
<div class="line"><a name="l02472"></a><span class="lineno"> 2472</span>&#160;  {<a class="code" href="namespaceoomph.html#a2473930e2634d673e2a3bed63b6851f0">FiniteElement::output</a>(outfile,nplot);}</div>
<div class="line"><a name="l02473"></a><span class="lineno"> 2473</span>&#160; </div>
<div class="line"><a name="l02474"></a><span class="lineno"> 2474</span>&#160;}; </div>
<div class="line"><a name="l02475"></a><span class="lineno"> 2475</span>&#160; </div>
<div class="line"><a name="l02476"></a><span class="lineno"> 2476</span>&#160; </div>
<div class="line"><a name="l02477"></a><span class="lineno"> 2477</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02478"></a><span class="lineno"> 2478</span>&#160;<span class="comment">///////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l02479"></a><span class="lineno"> 2479</span>&#160;<span class="comment">///////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l02480"></a><span class="lineno"> 2480</span>&#160;<span class="comment">///////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l02481"></a><span class="lineno"> 2481</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02482"></a><span class="lineno"> 2482</span>&#160; </div>
<div class="line"><a name="l02483"></a><span class="lineno"> 2483</span>&#160; </div>
<div class="line"><a name="l02484"></a><span class="lineno"> 2484</span>&#160;<span class="comment">//============================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l02485"></a><span class="lineno"> 2485</span>&#160;<span class="comment">/// Function that returns the residuals for the imposed traction Navier_Stokes</span></div>
<div class="line"><a name="l02486"></a><span class="lineno"> 2486</span>&#160;<span class="comment">/// equations</span></div>
<div class="line"><a name="l02487"></a><span class="lineno"> 2487</span>&#160;<span class="comment"></span><span class="comment">//============================================================================</span></div>
<div class="line"><a name="l02488"></a><span class="lineno"> 2488</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class </span>BULK_NAVIER_STOKES_ELEMENT, </div>
<div class="line"><a name="l02489"></a><span class="lineno"> 2489</span>&#160;          <span class="keyword">class </span>WOMERSLEY_ELEMENT,</div>
<div class="line"><a name="l02490"></a><span class="lineno"> 2490</span>&#160;          <span class="keywordtype">unsigned</span> DIM&gt;</div>
<div class="line"><a name="l02491"></a><span class="lineno"> 2491</span>&#160;<span class="keywordtype">void</span> NavierStokesImpedanceTractionElement&lt;BULK_NAVIER_STOKES_ELEMENT,</div>
<div class="line"><a name="l02492"></a><span class="lineno"> 2492</span>&#160;                                          WOMERSLEY_ELEMENT,</div>
<div class="line"><a name="l02493"></a><span class="lineno"> 2493</span>&#160;                                          DIM&gt;::</div>
<div class="line"><a name="l02494"></a><span class="lineno"><a class="line" href="classoomph_1_1NavierStokesImpedanceTractionElement.html#a0ebea8eb00325fda0ff0b4ad38b78dc0"> 2494</a></span>&#160;fill_in_generic_residual_contribution_fluid_traction(</div>
<div class="line"><a name="l02495"></a><span class="lineno"> 2495</span>&#160; <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;<a class="code" href="the__data__structure_8txt.html#a1400a973def57b85051cfe1070be1810">residuals</a>, </div>
<div class="line"><a name="l02496"></a><span class="lineno"> 2496</span>&#160; <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> &amp;jacobian, </div>
<div class="line"><a name="l02497"></a><span class="lineno"> 2497</span>&#160; <span class="keywordtype">unsigned</span> flag)</div>
<div class="line"><a name="l02498"></a><span class="lineno"> 2498</span>&#160;{</div>
<div class="line"><a name="l02499"></a><span class="lineno"> 2499</span>&#160; <span class="comment">//Find out how many nodes there are</span></div>
<div class="line"><a name="l02500"></a><span class="lineno"> 2500</span>&#160; <span class="keywordtype">unsigned</span> n_node = nnode();</div>
<div class="line"><a name="l02501"></a><span class="lineno"> 2501</span>&#160; </div>
<div class="line"><a name="l02502"></a><span class="lineno"> 2502</span>&#160; <span class="comment">//Set up memory for the shape and test functions</span></div>
<div class="line"><a name="l02503"></a><span class="lineno"> 2503</span>&#160; <a class="code" href="classoomph_1_1Shape.html">Shape</a> psif(n_node), testf(n_node);</div>
<div class="line"><a name="l02504"></a><span class="lineno"> 2504</span>&#160; </div>
<div class="line"><a name="l02505"></a><span class="lineno"> 2505</span>&#160; <span class="comment">//Set the value of n_intpt</span></div>
<div class="line"><a name="l02506"></a><span class="lineno"> 2506</span>&#160; <span class="keywordtype">unsigned</span> n_intpt = integral_pt()-&gt;nweight();</div>
<div class="line"><a name="l02507"></a><span class="lineno"> 2507</span>&#160; </div>
<div class="line"><a name="l02508"></a><span class="lineno"> 2508</span>&#160; <span class="comment">//Integers to store local equation numbers</span></div>
<div class="line"><a name="l02509"></a><span class="lineno"> 2509</span>&#160; <span class="keywordtype">int</span> local_eqn=0;</div>
<div class="line"><a name="l02510"></a><span class="lineno"> 2510</span>&#160; <span class="keywordtype">int</span> local_unknown=0;</div>
<div class="line"><a name="l02511"></a><span class="lineno"> 2511</span>&#160; </div>
<div class="line"><a name="l02512"></a><span class="lineno"> 2512</span>&#160; <span class="comment">//Loop over the integration points</span></div>
<div class="line"><a name="l02513"></a><span class="lineno"> 2513</span>&#160; <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> ipt=0;ipt&lt;n_intpt;ipt++)</div>
<div class="line"><a name="l02514"></a><span class="lineno"> 2514</span>&#160;  {</div>
<div class="line"><a name="l02515"></a><span class="lineno"> 2515</span>&#160;   <span class="comment">//Get the integral weight</span></div>
<div class="line"><a name="l02516"></a><span class="lineno"> 2516</span>&#160;   <span class="keywordtype">double</span> w = integral_pt()-&gt;weight(ipt);</div>
<div class="line"><a name="l02517"></a><span class="lineno"> 2517</span>&#160;   </div>
<div class="line"><a name="l02518"></a><span class="lineno"> 2518</span>&#160;   <span class="comment">//Find the shape and test functions and return the Jacobian</span></div>
<div class="line"><a name="l02519"></a><span class="lineno"> 2519</span>&#160;   <span class="comment">//of the mapping</span></div>
<div class="line"><a name="l02520"></a><span class="lineno"> 2520</span>&#160;   <span class="keywordtype">double</span> J = shape_and_test_at_knot(ipt,psif,testf);</div>
<div class="line"><a name="l02521"></a><span class="lineno"> 2521</span>&#160;   </div>
<div class="line"><a name="l02522"></a><span class="lineno"> 2522</span>&#160;   <span class="comment">//Premultiply the weights and the Jacobian</span></div>
<div class="line"><a name="l02523"></a><span class="lineno"> 2523</span>&#160;   <span class="keywordtype">double</span> <a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a> = w*J;</div>
<div class="line"><a name="l02524"></a><span class="lineno"> 2524</span>&#160;   </div>
<div class="line"><a name="l02525"></a><span class="lineno"> 2525</span>&#160;   <span class="comment">// Traction vector</span></div>
<div class="line"><a name="l02526"></a><span class="lineno"> 2526</span>&#160;   <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> traction(DIM+1);</div>
<div class="line"><a name="l02527"></a><span class="lineno"> 2527</span>&#160;   </div>
<div class="line"><a name="l02528"></a><span class="lineno"> 2528</span>&#160;   <span class="comment">// Initialise response</span></div>
<div class="line"><a name="l02529"></a><span class="lineno"> 2529</span>&#160;   <span class="keywordtype">double</span> p_in=0.0;</div>
<div class="line"><a name="l02530"></a><span class="lineno"> 2530</span>&#160;   <span class="keywordtype">double</span> dp_in_dq=0.0;</div>
<div class="line"><a name="l02531"></a><span class="lineno"> 2531</span>&#160;   </div>
<div class="line"><a name="l02532"></a><span class="lineno"> 2532</span>&#160;   <span class="comment">// Traction= outer unit normal x pressure at upstream end of </span></div>
<div class="line"><a name="l02533"></a><span class="lineno"> 2533</span>&#160;   <span class="comment">// impedance tube </span></div>
<div class="line"><a name="l02534"></a><span class="lineno"> 2534</span>&#160;   <span class="keywordflow">if</span> (Navier_stokes_outflow_mesh_pt!=0)</div>
<div class="line"><a name="l02535"></a><span class="lineno"> 2535</span>&#160;    {</div>
<div class="line"><a name="l02536"></a><span class="lineno"> 2536</span>&#160;     <span class="comment">// Get response of the impedance tube:</span></div>
<div class="line"><a name="l02537"></a><span class="lineno"> 2537</span>&#160;     Impedance_tube_pt-&gt;get_response(p_in, dp_in_dq);</div>
<div class="line"><a name="l02538"></a><span class="lineno"> 2538</span>&#160;    }</div>
<div class="line"><a name="l02539"></a><span class="lineno"> 2539</span>&#160;   </div>
<div class="line"><a name="l02540"></a><span class="lineno"> 2540</span>&#160;   <span class="comment">// Get outer unit normal at current integration point</span></div>
<div class="line"><a name="l02541"></a><span class="lineno"> 2541</span>&#160;   <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> unit_normal(DIM+1);</div>
<div class="line"><a name="l02542"></a><span class="lineno"> 2542</span>&#160;   outer_unit_normal(ipt, unit_normal); </div>
<div class="line"><a name="l02543"></a><span class="lineno"> 2543</span>&#160;   </div>
<div class="line"><a name="l02544"></a><span class="lineno"> 2544</span>&#160;   <span class="comment">//Loop over the directions</span></div>
<div class="line"><a name="l02545"></a><span class="lineno"> 2545</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;DIM+1;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l02546"></a><span class="lineno"> 2546</span>&#160;    {    </div>
<div class="line"><a name="l02547"></a><span class="lineno"> 2547</span>&#160;     traction[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]=-unit_normal[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]*p_in;</div>
<div class="line"><a name="l02548"></a><span class="lineno"> 2548</span>&#160;    }</div>
<div class="line"><a name="l02549"></a><span class="lineno"> 2549</span>&#160;   </div>
<div class="line"><a name="l02550"></a><span class="lineno"> 2550</span>&#160;   </div>
<div class="line"><a name="l02551"></a><span class="lineno"> 2551</span>&#160;   <span class="comment">//Loop over the test functions</span></div>
<div class="line"><a name="l02552"></a><span class="lineno"> 2552</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l=0;l&lt;n_node;l++)</div>
<div class="line"><a name="l02553"></a><span class="lineno"> 2553</span>&#160;    {</div>
<div class="line"><a name="l02554"></a><span class="lineno"> 2554</span>&#160;     </div>
<div class="line"><a name="l02555"></a><span class="lineno"> 2555</span>&#160;     <span class="comment">//Loop over the velocity components</span></div>
<div class="line"><a name="l02556"></a><span class="lineno"> 2556</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;DIM+1;<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div>
<div class="line"><a name="l02557"></a><span class="lineno"> 2557</span>&#160;      {</div>
<div class="line"><a name="l02558"></a><span class="lineno"> 2558</span>&#160;       local_eqn = u_local_eqn(l,<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>);</div>
<div class="line"><a name="l02559"></a><span class="lineno"> 2559</span>&#160;       <span class="comment">/*IF it&#39;s not a boundary condition*/</span></div>
<div class="line"><a name="l02560"></a><span class="lineno"> 2560</span>&#160;       <span class="keywordflow">if</span>(local_eqn &gt;= 0)</div>
<div class="line"><a name="l02561"></a><span class="lineno"> 2561</span>&#160;        {</div>
<div class="line"><a name="l02562"></a><span class="lineno"> 2562</span>&#160;         <span class="comment">//Add the user-defined traction terms</span></div>
<div class="line"><a name="l02563"></a><span class="lineno"> 2563</span>&#160;         <a class="code" href="the__data__structure_8txt.html#a1400a973def57b85051cfe1070be1810">residuals</a>[local_eqn] += traction[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]*testf[l]*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l02564"></a><span class="lineno"> 2564</span>&#160;         </div>
<div class="line"><a name="l02565"></a><span class="lineno"> 2565</span>&#160;         <span class="comment">// Compute the Jacobian too?</span></div>
<div class="line"><a name="l02566"></a><span class="lineno"> 2566</span>&#160;         <span class="keywordflow">if</span> (flag&amp;&amp;(Navier_stokes_outflow_mesh_pt!=0))</div>
<div class="line"><a name="l02567"></a><span class="lineno"> 2567</span>&#160;          {</div>
<div class="line"><a name="l02568"></a><span class="lineno"> 2568</span>&#160;           </div>
<div class="line"><a name="l02569"></a><span class="lineno"> 2569</span>&#160;           <span class="comment">//Loop over the nodes</span></div>
<div class="line"><a name="l02570"></a><span class="lineno"> 2570</span>&#160;           <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> j=0;j&lt;n_node;j++)</div>
<div class="line"><a name="l02571"></a><span class="lineno"> 2571</span>&#160;            {</div>
<div class="line"><a name="l02572"></a><span class="lineno"> 2572</span>&#160;             </div>
<div class="line"><a name="l02573"></a><span class="lineno"> 2573</span>&#160;             <span class="comment">// Get pointer to Node</span></div>
<div class="line"><a name="l02574"></a><span class="lineno"> 2574</span>&#160;             <a class="code" href="classoomph_1_1Node.html">Node</a>* nod_pt=node_pt(j);</div>
<div class="line"><a name="l02575"></a><span class="lineno"> 2575</span>&#160;             </div>
<div class="line"><a name="l02576"></a><span class="lineno"> 2576</span>&#160;             <span class="comment">//Loop over the velocity components</span></div>
<div class="line"><a name="l02577"></a><span class="lineno"> 2577</span>&#160;             <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> ii=0;ii&lt;DIM+1;ii++)</div>
<div class="line"><a name="l02578"></a><span class="lineno"> 2578</span>&#160;              {</div>
<div class="line"><a name="l02579"></a><span class="lineno"> 2579</span>&#160;               local_unknown = u_local_eqn(j,ii);</div>
<div class="line"><a name="l02580"></a><span class="lineno"> 2580</span>&#160;               </div>
<div class="line"><a name="l02581"></a><span class="lineno"> 2581</span>&#160;               <span class="comment">/*IF it&#39;s not a boundary condition*/</span></div>
<div class="line"><a name="l02582"></a><span class="lineno"> 2582</span>&#160;               <span class="keywordflow">if</span>(local_unknown &gt;= 0)</div>
<div class="line"><a name="l02583"></a><span class="lineno"> 2583</span>&#160;                {</div>
<div class="line"><a name="l02584"></a><span class="lineno"> 2584</span>&#160;                 <span class="comment">// Get corresponding global unknown number</span></div>
<div class="line"><a name="l02585"></a><span class="lineno"> 2585</span>&#160;                 <span class="keywordtype">unsigned</span> global_unknown=nod_pt-&gt;<a class="code" href="classoomph_1_1Data.html#a13206dcb7a088db0ef845ab71af505d2">eqn_number</a>(ii);</div>
<div class="line"><a name="l02586"></a><span class="lineno"> 2586</span>&#160;                 </div>
<div class="line"><a name="l02587"></a><span class="lineno"> 2587</span>&#160;                 <span class="comment">// Add contribution</span></div>
<div class="line"><a name="l02588"></a><span class="lineno"> 2588</span>&#160;                 jacobian(local_eqn,local_unknown)-=</div>
<div class="line"><a name="l02589"></a><span class="lineno"> 2589</span>&#160;                  (*Aux_integral_pt)[global_unknown]</div>
<div class="line"><a name="l02590"></a><span class="lineno"> 2590</span>&#160;                  *psif[l]*unit_normal[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]*dp_in_dq*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l02591"></a><span class="lineno"> 2591</span>&#160;                }</div>
<div class="line"><a name="l02592"></a><span class="lineno"> 2592</span>&#160;              }</div>
<div class="line"><a name="l02593"></a><span class="lineno"> 2593</span>&#160;            }</div>
<div class="line"><a name="l02594"></a><span class="lineno"> 2594</span>&#160;           </div>
<div class="line"><a name="l02595"></a><span class="lineno"> 2595</span>&#160;           </div>
<div class="line"><a name="l02596"></a><span class="lineno"> 2596</span>&#160;           <span class="comment">// Loop over external dofs for unknowns</span></div>
<div class="line"><a name="l02597"></a><span class="lineno"> 2597</span>&#160;           <span class="keywordtype">unsigned</span> n_ext=nexternal_data();</div>
<div class="line"><a name="l02598"></a><span class="lineno"> 2598</span>&#160;           <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j=0;j&lt;n_ext;j++)</div>
<div class="line"><a name="l02599"></a><span class="lineno"> 2599</span>&#160;            {</div>
<div class="line"><a name="l02600"></a><span class="lineno"> 2600</span>&#160;             <span class="comment">// Get pointer to external Data (=other nodes)</span></div>
<div class="line"><a name="l02601"></a><span class="lineno"> 2601</span>&#160;             <a class="code" href="classoomph_1_1Data.html">Data</a>* ext_data_pt=external_data_pt(j);</div>
<div class="line"><a name="l02602"></a><span class="lineno"> 2602</span>&#160;             </div>
<div class="line"><a name="l02603"></a><span class="lineno"> 2603</span>&#160;             <span class="comment">// Loop over directions for equation</span></div>
<div class="line"><a name="l02604"></a><span class="lineno"> 2604</span>&#160;             <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> ii=0;ii&lt;DIM+1;ii++)</div>
<div class="line"><a name="l02605"></a><span class="lineno"> 2605</span>&#160;              {</div>
<div class="line"><a name="l02606"></a><span class="lineno"> 2606</span>&#160;               <span class="comment">// Get local unknown number</span></div>
<div class="line"><a name="l02607"></a><span class="lineno"> 2607</span>&#160;               <span class="keywordtype">int</span> local_unknown=external_local_eqn(j,ii); </div>
<div class="line"><a name="l02608"></a><span class="lineno"> 2608</span>&#160;               </div>
<div class="line"><a name="l02609"></a><span class="lineno"> 2609</span>&#160;               <span class="comment">// Real dof or bc?</span></div>
<div class="line"><a name="l02610"></a><span class="lineno"> 2610</span>&#160;               <span class="keywordflow">if</span> (local_unknown&gt;=0)</div>
<div class="line"><a name="l02611"></a><span class="lineno"> 2611</span>&#160;                {</div>
<div class="line"><a name="l02612"></a><span class="lineno"> 2612</span>&#160;                 <span class="comment">// Get corresponding global unknown number</span></div>
<div class="line"><a name="l02613"></a><span class="lineno"> 2613</span>&#160;                 <span class="keywordtype">unsigned</span> global_unknown=ext_data_pt-&gt;<a class="code" href="classoomph_1_1Data.html#a13206dcb7a088db0ef845ab71af505d2">eqn_number</a>(ii);</div>
<div class="line"><a name="l02614"></a><span class="lineno"> 2614</span>&#160;                 </div>
<div class="line"><a name="l02615"></a><span class="lineno"> 2615</span>&#160;                 <span class="comment">// Add contribution</span></div>
<div class="line"><a name="l02616"></a><span class="lineno"> 2616</span>&#160;                 jacobian(local_eqn,local_unknown)-=</div>
<div class="line"><a name="l02617"></a><span class="lineno"> 2617</span>&#160;                  (*Aux_integral_pt)[global_unknown]</div>
<div class="line"><a name="l02618"></a><span class="lineno"> 2618</span>&#160;                  *psif[l]*unit_normal[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>]*dp_in_dq*<a class="code" href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l02619"></a><span class="lineno"> 2619</span>&#160;                }</div>
<div class="line"><a name="l02620"></a><span class="lineno"> 2620</span>&#160;              }</div>
<div class="line"><a name="l02621"></a><span class="lineno"> 2621</span>&#160;            }</div>
<div class="line"><a name="l02622"></a><span class="lineno"> 2622</span>&#160;          } <span class="comment">// end of computation of Jacobian terms</span></div>
<div class="line"><a name="l02623"></a><span class="lineno"> 2623</span>&#160;        }</div>
<div class="line"><a name="l02624"></a><span class="lineno"> 2624</span>&#160;      } <span class="comment">//End of loop over dimension</span></div>
<div class="line"><a name="l02625"></a><span class="lineno"> 2625</span>&#160;    } <span class="comment">//End of loop over shape functions</span></div>
<div class="line"><a name="l02626"></a><span class="lineno"> 2626</span>&#160;   </div>
<div class="line"><a name="l02627"></a><span class="lineno"> 2627</span>&#160;  }</div>
<div class="line"><a name="l02628"></a><span class="lineno"> 2628</span>&#160;}</div>
<div class="line"><a name="l02629"></a><span class="lineno"> 2629</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l02630"></a><span class="lineno"> 2630</span>&#160;<span class="comment">//////////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l02631"></a><span class="lineno"> 2631</span>&#160;<span class="comment">//////////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l02632"></a><span class="lineno"> 2632</span>&#160;<span class="comment">//////////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l02633"></a><span class="lineno"> 2633</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02634"></a><span class="lineno"> 2634</span>&#160; </div>
<div class="line"><a name="l02635"></a><span class="lineno"> 2635</span>&#160;<span class="comment">//======================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l02636"></a><span class="lineno"> 2636</span>&#160;<span class="comment">/// An element to impose a fluid pressure obtained from a Womersley</span></div>
<div class="line"><a name="l02637"></a><span class="lineno"> 2637</span>&#160;<span class="comment">/// impedance tube at a boundary. This element is used in conjunction with a </span></div>
<div class="line"><a name="l02638"></a><span class="lineno"> 2638</span>&#160;<span class="comment">/// NetFluxControlElementForWomersleyPressureControl element, and is </span></div>
<div class="line"><a name="l02639"></a><span class="lineno"> 2639</span>&#160;<span class="comment">/// passed to the NetFluxControlElementForWomersleyPressureControl element&#39;s</span></div>
<div class="line"><a name="l02640"></a><span class="lineno"> 2640</span>&#160;<span class="comment">/// constructor. The volume flux across the boundary is then an </span></div>
<div class="line"><a name="l02641"></a><span class="lineno"> 2641</span>&#160;<span class="comment">/// unknown of the problem. The constructor argument for this element</span></div>
<div class="line"><a name="l02642"></a><span class="lineno"> 2642</span>&#160;<span class="comment">/// is a suitable Womersley impedance tube to give the pressure via </span></div>
<div class="line"><a name="l02643"></a><span class="lineno"> 2643</span>&#160;<span class="comment">/// its get_response(...) function.</span></div>
<div class="line"><a name="l02644"></a><span class="lineno"> 2644</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l02645"></a><span class="lineno"> 2645</span>&#160;<span class="comment">/// Note: the NavierStokesWomersleyPressureControlElement element calculates </span></div>
<div class="line"><a name="l02646"></a><span class="lineno"> 2646</span>&#160;<span class="comment">/// Jacobian entries BOTH for itself AND for the </span></div>
<div class="line"><a name="l02647"></a><span class="lineno"> 2647</span>&#160;<span class="comment">/// NetFluxControlElementForWomersleyPressureControl with respect to </span></div>
<div class="line"><a name="l02648"></a><span class="lineno"> 2648</span>&#160;<span class="comment">/// the unknowns in this (NavierStokesWomersleyPressureControlElement)</span></div>
<div class="line"><a name="l02649"></a><span class="lineno"> 2649</span>&#160;<span class="comment">/// element.</span></div>
<div class="line"><a name="l02650"></a><span class="lineno"> 2650</span>&#160;<span class="comment"></span><span class="comment">//======================================================================</span></div>
<div class="line"><a name="l02651"></a><span class="lineno"><a class="line" href="classoomph_1_1NavierStokesWomersleyPressureControlElement.html"> 2651</a></span>&#160;<span class="keyword">class </span><a class="code" href="classoomph_1_1NavierStokesWomersleyPressureControlElement.html">NavierStokesWomersleyPressureControlElement</a> : </div>
<div class="line"><a name="l02652"></a><span class="lineno"> 2652</span>&#160;<span class="keyword">public</span> <span class="keyword">virtual</span> <a class="code" href="classoomph_1_1GeneralisedElement.html">GeneralisedElement</a> </div>
<div class="line"><a name="l02653"></a><span class="lineno"> 2653</span>&#160;{</div>
<div class="line"><a name="l02654"></a><span class="lineno"> 2654</span>&#160; public :</div>
<div class="line"><a name="l02655"></a><span class="lineno"> 2655</span>&#160;  <span class="comment"></span></div>
<div class="line"><a name="l02656"></a><span class="lineno"> 2656</span>&#160;<span class="comment">  /// \short Constructor takes a pointer to a suitable Womersley</span></div>
<div class="line"><a name="l02657"></a><span class="lineno"> 2657</span>&#160;<span class="comment">  /// impedance tube which defines the pressure via get_response(...)</span></div>
<div class="line"><a name="l02658"></a><span class="lineno"><a class="line" href="classoomph_1_1NavierStokesWomersleyPressureControlElement.html#ad3293da10ac3a22cd70ae7c8c11980d9"> 2658</a></span>&#160;<span class="comment"></span>  <a class="code" href="classoomph_1_1NavierStokesWomersleyPressureControlElement.html#ad3293da10ac3a22cd70ae7c8c11980d9">NavierStokesWomersleyPressureControlElement</a>(</div>
<div class="line"><a name="l02659"></a><span class="lineno"> 2659</span>&#160;   <a class="code" href="classoomph_1_1TemplateFreeWomersleyImpedanceTubeBase.html">TemplateFreeWomersleyImpedanceTubeBase</a>* womersley_tube_pt) </div>
<div class="line"><a name="l02660"></a><span class="lineno"> 2660</span>&#160;  : Womersley_tube_pt(womersley_tube_pt)</div>
<div class="line"><a name="l02661"></a><span class="lineno"> 2661</span>&#160;  {</div>
<div class="line"><a name="l02662"></a><span class="lineno"> 2662</span>&#160;   <span class="comment">// Create the new Data which contains the volume flux.</span></div>
<div class="line"><a name="l02663"></a><span class="lineno"> 2663</span>&#160;   Volume_flux_data_pt = <span class="keyword">new</span> <a class="code" href="the__data__structure_8txt.html#ae789c4a233fe5f1aa45cf1f92efdf494">Data</a>(1);</div>
<div class="line"><a name="l02664"></a><span class="lineno"> 2664</span>&#160;   </div>
<div class="line"><a name="l02665"></a><span class="lineno"> 2665</span>&#160;   <span class="comment">// Add new Data to internal data</span></div>
<div class="line"><a name="l02666"></a><span class="lineno"> 2666</span>&#160;   Volume_flux_data_id=add_internal_data(Volume_flux_data_pt);</div>
<div class="line"><a name="l02667"></a><span class="lineno"> 2667</span>&#160;  }</div>
<div class="line"><a name="l02668"></a><span class="lineno"> 2668</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l02669"></a><span class="lineno"> 2669</span>&#160;<span class="comment"> /// Destructor should not delete anything</span></div>
<div class="line"><a name="l02670"></a><span class="lineno"><a class="line" href="classoomph_1_1NavierStokesWomersleyPressureControlElement.html#aaa4bdb2c63aea8177b120f39a309b645"> 2670</a></span>&#160;<span class="comment"></span> <a class="code" href="classoomph_1_1NavierStokesWomersleyPressureControlElement.html#aaa4bdb2c63aea8177b120f39a309b645">~NavierStokesWomersleyPressureControlElement</a>() {}</div>
<div class="line"><a name="l02671"></a><span class="lineno"> 2671</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l02672"></a><span class="lineno"> 2672</span>&#160;<span class="comment"> /// This function returns the residuals</span></div>
<div class="line"><a name="l02673"></a><span class="lineno"><a class="line" href="classoomph_1_1NavierStokesWomersleyPressureControlElement.html#a336e39637cd1405c5edefbcb4c9e26e8"> 2673</a></span>&#160;<span class="comment"></span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1NavierStokesWomersleyPressureControlElement.html#a336e39637cd1405c5edefbcb4c9e26e8">fill_in_contribution_to_residuals</a>(<a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;<a class="code" href="the__data__structure_8txt.html#a1400a973def57b85051cfe1070be1810">residuals</a>)</div>
<div class="line"><a name="l02674"></a><span class="lineno"> 2674</span>&#160;  {</div>
<div class="line"><a name="l02675"></a><span class="lineno"> 2675</span>&#160;   <span class="comment">//Call the generic residuals function using a dummy matrix argument</span></div>
<div class="line"><a name="l02676"></a><span class="lineno"> 2676</span>&#160;   fill_in_generic_residual_contribution_pressure_control(</div>
<div class="line"><a name="l02677"></a><span class="lineno"> 2677</span>&#160;    <a class="code" href="the__data__structure_8txt.html#a1400a973def57b85051cfe1070be1810">residuals</a>,</div>
<div class="line"><a name="l02678"></a><span class="lineno"> 2678</span>&#160;    GeneralisedElement::Dummy_matrix,</div>
<div class="line"><a name="l02679"></a><span class="lineno"> 2679</span>&#160;    0);</div>
<div class="line"><a name="l02680"></a><span class="lineno"> 2680</span>&#160;  }</div>
<div class="line"><a name="l02681"></a><span class="lineno"> 2681</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l02682"></a><span class="lineno"> 2682</span>&#160;<span class="comment"> /// \short This function returns the residuals and the Jacobian, </span></div>
<div class="line"><a name="l02683"></a><span class="lineno"> 2683</span>&#160;<span class="comment"> /// plus the Jacobian contribution for the</span></div>
<div class="line"><a name="l02684"></a><span class="lineno"> 2684</span>&#160;<span class="comment"> /// NetFluxControlElementForWomersleyPressureControl</span></div>
<div class="line"><a name="l02685"></a><span class="lineno"> 2685</span>&#160;<span class="comment"> /// with respect to unknowns in this element </span></div>
<div class="line"><a name="l02686"></a><span class="lineno"><a class="line" href="classoomph_1_1NavierStokesWomersleyPressureControlElement.html#aa899b746f1831673358ba6a71409e45c"> 2686</a></span>&#160;<span class="comment"></span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1NavierStokesWomersleyPressureControlElement.html#aa899b746f1831673358ba6a71409e45c">fill_in_contribution_to_jacobian</a>(<a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;<a class="code" href="the__data__structure_8txt.html#a1400a973def57b85051cfe1070be1810">residuals</a>,</div>
<div class="line"><a name="l02687"></a><span class="lineno"> 2687</span>&#160;                                              <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> &amp;jacobian)</div>
<div class="line"><a name="l02688"></a><span class="lineno"> 2688</span>&#160;  {</div>
<div class="line"><a name="l02689"></a><span class="lineno"> 2689</span>&#160;   <span class="comment">//Call the generic routine</span></div>
<div class="line"><a name="l02690"></a><span class="lineno"> 2690</span>&#160;   fill_in_generic_residual_contribution_pressure_control(<a class="code" href="the__data__structure_8txt.html#a1400a973def57b85051cfe1070be1810">residuals</a>,</div>
<div class="line"><a name="l02691"></a><span class="lineno"> 2691</span>&#160;                                                          jacobian,1);</div>
<div class="line"><a name="l02692"></a><span class="lineno"> 2692</span>&#160;  }</div>
<div class="line"><a name="l02693"></a><span class="lineno"> 2693</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l02694"></a><span class="lineno"> 2694</span>&#160;<span class="comment"> /// \short Function to return a pointer to the Data object whose</span></div>
<div class="line"><a name="l02695"></a><span class="lineno"> 2695</span>&#160;<span class="comment"> /// single value is the flux degree of freedom</span></div>
<div class="line"><a name="l02696"></a><span class="lineno"><a class="line" href="classoomph_1_1NavierStokesWomersleyPressureControlElement.html#a091e01b1894fc97c8cca758f9c6cc121"> 2696</a></span>&#160;<span class="comment"></span> <a class="code" href="classoomph_1_1Data.html">Data</a>* <a class="code" href="classoomph_1_1NavierStokesWomersleyPressureControlElement.html#a091e01b1894fc97c8cca758f9c6cc121">volume_flux_data_pt</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> Volume_flux_data_pt;}</div>
<div class="line"><a name="l02697"></a><span class="lineno"> 2697</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l02698"></a><span class="lineno"> 2698</span>&#160;<span class="comment"> /// \short Function to add to external data the Data object whose</span></div>
<div class="line"><a name="l02699"></a><span class="lineno"> 2699</span>&#160;<span class="comment"> /// single value is the pressure applied at the boundary</span></div>
<div class="line"><a name="l02700"></a><span class="lineno"><a class="line" href="classoomph_1_1NavierStokesWomersleyPressureControlElement.html#a88706386c6cbdf93ccdbf78d38424ee9"> 2700</a></span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1NavierStokesWomersleyPressureControlElement.html#a88706386c6cbdf93ccdbf78d38424ee9">add_pressure_data</a>(<a class="code" href="classoomph_1_1Data.html">Data</a>* pressure_data_pt)</div>
<div class="line"><a name="l02701"></a><span class="lineno"> 2701</span>&#160;  {</div>
<div class="line"><a name="l02702"></a><span class="lineno"> 2702</span>&#160;   Pressure_data_id = add_external_data(pressure_data_pt);</div>
<div class="line"><a name="l02703"></a><span class="lineno"> 2703</span>&#160;  }</div>
<div class="line"><a name="l02704"></a><span class="lineno"> 2704</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l02705"></a><span class="lineno"> 2705</span>&#160;<span class="comment"> /// \short The number of &quot;DOF types&quot; that degrees of freedom in this element</span></div>
<div class="line"><a name="l02706"></a><span class="lineno"> 2706</span>&#160;<span class="comment"> /// are sub-divided into - set to 1</span></div>
<div class="line"><a name="l02707"></a><span class="lineno"><a class="line" href="classoomph_1_1NavierStokesWomersleyPressureControlElement.html#a65a9d8901d8d0690f82b873c0dafe1bd"> 2707</a></span>&#160;<span class="comment"></span> <span class="keywordtype">unsigned</span> <a class="code" href="classoomph_1_1NavierStokesWomersleyPressureControlElement.html#a65a9d8901d8d0690f82b873c0dafe1bd">ndof_types</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l02708"></a><span class="lineno"> 2708</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l02709"></a><span class="lineno"> 2709</span>&#160;   <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l02710"></a><span class="lineno"> 2710</span>&#160;  }</div>
<div class="line"><a name="l02711"></a><span class="lineno"> 2711</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l02712"></a><span class="lineno"> 2712</span>&#160;<span class="comment"> /// \short Create a list of pairs for all unknowns in this element,</span></div>
<div class="line"><a name="l02713"></a><span class="lineno"> 2713</span>&#160;<span class="comment"> /// so that the first entry in each pair contains the global equation</span></div>
<div class="line"><a name="l02714"></a><span class="lineno"> 2714</span>&#160;<span class="comment"> /// number of the unknown, while the second one contains the number</span></div>
<div class="line"><a name="l02715"></a><span class="lineno"> 2715</span>&#160;<span class="comment"> /// of the &quot;DOF type&quot; that this unknown is associated with.</span></div>
<div class="line"><a name="l02716"></a><span class="lineno"> 2716</span>&#160;<span class="comment"> /// (Function can obviously only be called if the equation numbering</span></div>
<div class="line"><a name="l02717"></a><span class="lineno"> 2717</span>&#160;<span class="comment"> /// scheme has been set up.) </span></div>
<div class="line"><a name="l02718"></a><span class="lineno"><a class="line" href="classoomph_1_1NavierStokesWomersleyPressureControlElement.html#ac06944c7b24e71a1d9341166049fc360"> 2718</a></span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1NavierStokesWomersleyPressureControlElement.html#ac06944c7b24e71a1d9341166049fc360">get_dof_numbers_for_unknowns</a>(</div>
<div class="line"><a name="l02719"></a><span class="lineno"> 2719</span>&#160;  std::list&lt;std::pair&lt;unsigned long, unsigned&gt; &gt;&amp; dof_lookup_list)<span class="keyword"> const</span></div>
<div class="line"><a name="l02720"></a><span class="lineno"> 2720</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l02721"></a><span class="lineno"> 2721</span>&#160;   <span class="comment">// pair to store dof lookup prior to being added to list</span></div>
<div class="line"><a name="l02722"></a><span class="lineno"> 2722</span>&#160;   std::pair&lt;unsigned,unsigned&gt; dof_lookup;</div>
<div class="line"><a name="l02723"></a><span class="lineno"> 2723</span>&#160;   </div>
<div class="line"><a name="l02724"></a><span class="lineno"> 2724</span>&#160;   dof_lookup.first = this-&gt;eqn_number(0);</div>
<div class="line"><a name="l02725"></a><span class="lineno"> 2725</span>&#160;   dof_lookup.second = 0;</div>
<div class="line"><a name="l02726"></a><span class="lineno"> 2726</span>&#160;   </div>
<div class="line"><a name="l02727"></a><span class="lineno"> 2727</span>&#160;   <span class="comment">// add to list</span></div>
<div class="line"><a name="l02728"></a><span class="lineno"> 2728</span>&#160;   dof_lookup_list.push_front(dof_lookup);</div>
<div class="line"><a name="l02729"></a><span class="lineno"> 2729</span>&#160;  }</div>
<div class="line"><a name="l02730"></a><span class="lineno"> 2730</span>&#160; </div>
<div class="line"><a name="l02731"></a><span class="lineno"> 2731</span>&#160;  <span class="keyword">protected</span>:</div>
<div class="line"><a name="l02732"></a><span class="lineno"> 2732</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l02733"></a><span class="lineno"> 2733</span>&#160;<span class="comment"> /// \short This function returns the residuals.</span></div>
<div class="line"><a name="l02734"></a><span class="lineno"> 2734</span>&#160;<span class="comment"> /// flag=1(or 0): do (or don&#39;t) compute the Jacobian as well. </span></div>
<div class="line"><a name="l02735"></a><span class="lineno"> 2735</span>&#160;<span class="comment"> /// Note that this function also calculates the Jacobian contribution</span></div>
<div class="line"><a name="l02736"></a><span class="lineno"> 2736</span>&#160;<span class="comment"> /// for the NetFluxControlElementForWomersleyPressureControl</span></div>
<div class="line"><a name="l02737"></a><span class="lineno"><a class="line" href="classoomph_1_1NavierStokesWomersleyPressureControlElement.html#a615400a9e8489a2ea7e1b1722d98c95e"> 2737</a></span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1NavierStokesWomersleyPressureControlElement.html#a615400a9e8489a2ea7e1b1722d98c95e">fill_in_generic_residual_contribution_pressure_control</a>(</div>
<div class="line"><a name="l02738"></a><span class="lineno"> 2738</span>&#160;  <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;<a class="code" href="the__data__structure_8txt.html#a1400a973def57b85051cfe1070be1810">residuals</a>, </div>
<div class="line"><a name="l02739"></a><span class="lineno"> 2739</span>&#160;  <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> &amp;jacobian,</div>
<div class="line"><a name="l02740"></a><span class="lineno"> 2740</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; flag)</div>
<div class="line"><a name="l02741"></a><span class="lineno"> 2741</span>&#160;  {</div>
<div class="line"><a name="l02742"></a><span class="lineno"> 2742</span>&#160;   <span class="comment">// Get Womersley pressure and derivative with respect to the flux</span></div>
<div class="line"><a name="l02743"></a><span class="lineno"> 2743</span>&#160;   <span class="keywordtype">double</span> womersley_pressure=0.0;</div>
<div class="line"><a name="l02744"></a><span class="lineno"> 2744</span>&#160;   <span class="keywordtype">double</span> d_womersley_pressure_d_q=0.0;</div>
<div class="line"><a name="l02745"></a><span class="lineno"> 2745</span>&#160;   </div>
<div class="line"><a name="l02746"></a><span class="lineno"> 2746</span>&#160;   <span class="comment">// Get response of impedance tube</span></div>
<div class="line"><a name="l02747"></a><span class="lineno"> 2747</span>&#160;   Womersley_tube_pt-&gt;get_response(womersley_pressure,</div>
<div class="line"><a name="l02748"></a><span class="lineno"> 2748</span>&#160;                                   d_womersley_pressure_d_q);</div>
<div class="line"><a name="l02749"></a><span class="lineno"> 2749</span>&#160;   </div>
<div class="line"><a name="l02750"></a><span class="lineno"> 2750</span>&#160;   <span class="comment">// Get the current pressure</span></div>
<div class="line"><a name="l02751"></a><span class="lineno"> 2751</span>&#160;   <span class="keywordtype">double</span> pressure = external_data_pt(Pressure_data_id)-&gt;value(0);</div>
<div class="line"><a name="l02752"></a><span class="lineno"> 2752</span>&#160; </div>
<div class="line"><a name="l02753"></a><span class="lineno"> 2753</span>&#160;   <span class="comment">// Get equation number of the volume flux unknown</span></div>
<div class="line"><a name="l02754"></a><span class="lineno"> 2754</span>&#160;   <span class="keywordtype">int</span> local_eq = internal_local_eqn(Volume_flux_data_id,0);</div>
<div class="line"><a name="l02755"></a><span class="lineno"> 2755</span>&#160;   </div>
<div class="line"><a name="l02756"></a><span class="lineno"> 2756</span>&#160;   <span class="comment">// Calculate residuals</span></div>
<div class="line"><a name="l02757"></a><span class="lineno"> 2757</span>&#160;   <a class="code" href="the__data__structure_8txt.html#a1400a973def57b85051cfe1070be1810">residuals</a>[local_eq] += pressure - womersley_pressure;</div>
<div class="line"><a name="l02758"></a><span class="lineno"> 2758</span>&#160; </div>
<div class="line"><a name="l02759"></a><span class="lineno"> 2759</span>&#160;   <span class="comment">// Calculate Jacobian contributions if required</span></div>
<div class="line"><a name="l02760"></a><span class="lineno"> 2760</span>&#160;   <span class="keywordflow">if</span> (flag)</div>
<div class="line"><a name="l02761"></a><span class="lineno"> 2761</span>&#160;    {</div>
<div class="line"><a name="l02762"></a><span class="lineno"> 2762</span>&#160;     <span class="comment">//Get equation number of the pressure data unknown</span></div>
<div class="line"><a name="l02763"></a><span class="lineno"> 2763</span>&#160;     <span class="keywordtype">int</span> local_unknown = external_local_eqn(Pressure_data_id,0);</div>
<div class="line"><a name="l02764"></a><span class="lineno"> 2764</span>&#160;     </div>
<div class="line"><a name="l02765"></a><span class="lineno"> 2765</span>&#160;     <span class="comment">//Add the Jacobian contriburions</span></div>
<div class="line"><a name="l02766"></a><span class="lineno"> 2766</span>&#160;     jacobian(local_eq,local_eq) -= d_womersley_pressure_d_q;</div>
<div class="line"><a name="l02767"></a><span class="lineno"> 2767</span>&#160;     jacobian(local_eq,local_unknown) += 1.0; </div>
<div class="line"><a name="l02768"></a><span class="lineno"> 2768</span>&#160;     jacobian(local_unknown,local_eq) += 1.0;</div>
<div class="line"><a name="l02769"></a><span class="lineno"> 2769</span>&#160;    }</div>
<div class="line"><a name="l02770"></a><span class="lineno"> 2770</span>&#160;  }</div>
<div class="line"><a name="l02771"></a><span class="lineno"> 2771</span>&#160; </div>
<div class="line"><a name="l02772"></a><span class="lineno"> 2772</span>&#160;  <span class="keyword">private</span>:</div>
<div class="line"><a name="l02773"></a><span class="lineno"> 2773</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l02774"></a><span class="lineno"> 2774</span>&#160;<span class="comment"> /// \short Data object whose single value is the volume flux</span></div>
<div class="line"><a name="l02775"></a><span class="lineno"> 2775</span>&#160;<span class="comment"> /// applied by the elements in the Flux_control_mesh_pt</span></div>
<div class="line"><a name="l02776"></a><span class="lineno"><a class="line" href="classoomph_1_1NavierStokesWomersleyPressureControlElement.html#ab7385fe09993adfda19e4787f91abeb6"> 2776</a></span>&#160;<span class="comment"></span> <a class="code" href="classoomph_1_1Data.html">Data</a>* <a class="code" href="classoomph_1_1NavierStokesWomersleyPressureControlElement.html#ab7385fe09993adfda19e4787f91abeb6">Volume_flux_data_pt</a>;</div>
<div class="line"><a name="l02777"></a><span class="lineno"> 2777</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l02778"></a><span class="lineno"> 2778</span>&#160;<span class="comment"> /// Pointer to the Womersley impedance tube</span></div>
<div class="line"><a name="l02779"></a><span class="lineno"><a class="line" href="classoomph_1_1NavierStokesWomersleyPressureControlElement.html#a8aedb28c49fd569eb65687efd2139abc"> 2779</a></span>&#160;<span class="comment"></span> <a class="code" href="classoomph_1_1TemplateFreeWomersleyImpedanceTubeBase.html">TemplateFreeWomersleyImpedanceTubeBase</a>* <a class="code" href="classoomph_1_1NavierStokesWomersleyPressureControlElement.html#a8aedb28c49fd569eb65687efd2139abc">Womersley_tube_pt</a>;</div>
<div class="line"><a name="l02780"></a><span class="lineno"> 2780</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02781"></a><span class="lineno"> 2781</span>&#160;<span class="comment"> /// \short Id of external Data object whose single value is the pressure</span></div>
<div class="line"><a name="l02782"></a><span class="lineno"><a class="line" href="classoomph_1_1NavierStokesWomersleyPressureControlElement.html#acf1843645f77e2616aa851e902713c91"> 2782</a></span>&#160;<span class="comment"></span> <span class="keywordtype">unsigned</span> <a class="code" href="classoomph_1_1NavierStokesWomersleyPressureControlElement.html#acf1843645f77e2616aa851e902713c91">Pressure_data_id</a>;</div>
<div class="line"><a name="l02783"></a><span class="lineno"> 2783</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l02784"></a><span class="lineno"> 2784</span>&#160;<span class="comment"> /// \short Id of internal Data object whose single value is the volume</span></div>
<div class="line"><a name="l02785"></a><span class="lineno"> 2785</span>&#160;<span class="comment"> /// flux</span></div>
<div class="line"><a name="l02786"></a><span class="lineno"><a class="line" href="classoomph_1_1NavierStokesWomersleyPressureControlElement.html#a90810e440b763afca53dc50b24a7848c"> 2786</a></span>&#160;<span class="comment"></span> <span class="keywordtype">unsigned</span> <a class="code" href="classoomph_1_1NavierStokesWomersleyPressureControlElement.html#a90810e440b763afca53dc50b24a7848c">Volume_flux_data_id</a>; </div>
<div class="line"><a name="l02787"></a><span class="lineno"> 2787</span>&#160;};</div>
<div class="line"><a name="l02788"></a><span class="lineno"> 2788</span>&#160; </div>
<div class="line"><a name="l02789"></a><span class="lineno"> 2789</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02790"></a><span class="lineno"> 2790</span>&#160;<span class="comment">//////////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l02791"></a><span class="lineno"> 2791</span>&#160;<span class="comment">//////////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l02792"></a><span class="lineno"> 2792</span>&#160;<span class="comment">//////////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l02793"></a><span class="lineno"> 2793</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02794"></a><span class="lineno"> 2794</span>&#160; </div>
<div class="line"><a name="l02795"></a><span class="lineno"> 2795</span>&#160; </div>
<div class="line"><a name="l02796"></a><span class="lineno"> 2796</span>&#160;<span class="comment">//======================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l02797"></a><span class="lineno"> 2797</span>&#160;<span class="comment">/// A class for an element to control net fluid flux across a boundary </span></div>
<div class="line"><a name="l02798"></a><span class="lineno"> 2798</span>&#160;<span class="comment">/// by imposing an applied pressure to the Navier-Stokes equations.</span></div>
<div class="line"><a name="l02799"></a><span class="lineno"> 2799</span>&#160;<span class="comment">/// This element is used with a mesh of NavierStokesFluxControlElements </span></div>
<div class="line"><a name="l02800"></a><span class="lineno"> 2800</span>&#160;<span class="comment">/// attached to the boundary. The flux imposed by this element is given</span></div>
<div class="line"><a name="l02801"></a><span class="lineno"> 2801</span>&#160;<span class="comment">/// by a NavierStokesWomersleyPressureControlElement.</span></div>
<div class="line"><a name="l02802"></a><span class="lineno"> 2802</span>&#160;<span class="comment">/// Note: fill_in_contribution_to_jacobian() does not calculate any </span></div>
<div class="line"><a name="l02803"></a><span class="lineno"> 2803</span>&#160;<span class="comment">/// Jacobian contributions for this element as they are calculated by</span></div>
<div class="line"><a name="l02804"></a><span class="lineno"> 2804</span>&#160;<span class="comment">/// NavierStokesFluxControlElement::fill_in_contribution_to_jacobian(...)</span></div>
<div class="line"><a name="l02805"></a><span class="lineno"> 2805</span>&#160;<span class="comment">/// and</span></div>
<div class="line"><a name="l02806"></a><span class="lineno"> 2806</span>&#160;<span class="comment">/// NavierStokesWomersleyPressureControlElement::</span></div>
<div class="line"><a name="l02807"></a><span class="lineno"> 2807</span>&#160;<span class="comment">/// fill_in_contribution_to_jacobian(...)</span></div>
<div class="line"><a name="l02808"></a><span class="lineno"> 2808</span>&#160;<span class="comment"></span><span class="comment">//======================================================================</span></div>
<div class="line"><a name="l02809"></a><span class="lineno"><a class="line" href="classoomph_1_1NetFluxControlElementForWomersleyPressureControl.html"> 2809</a></span>&#160;<span class="keyword">class </span><a class="code" href="classoomph_1_1NetFluxControlElementForWomersleyPressureControl.html">NetFluxControlElementForWomersleyPressureControl</a> : </div>
<div class="line"><a name="l02810"></a><span class="lineno"> 2810</span>&#160;<span class="keyword">public</span> <span class="keyword">virtual</span> <a class="code" href="classoomph_1_1NetFluxControlElement.html">NetFluxControlElement</a></div>
<div class="line"><a name="l02811"></a><span class="lineno"> 2811</span>&#160;{</div>
<div class="line"><a name="l02812"></a><span class="lineno"> 2812</span>&#160;  <span class="keyword">public</span>:</div>
<div class="line"><a name="l02813"></a><span class="lineno"> 2813</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l02814"></a><span class="lineno"> 2814</span>&#160;<span class="comment"> /// \short Constructor takes the mesh of  </span></div>
<div class="line"><a name="l02815"></a><span class="lineno"> 2815</span>&#160;<span class="comment"> /// TemplateFreeNavierStokesFluxControlElementBase which impose </span></div>
<div class="line"><a name="l02816"></a><span class="lineno"> 2816</span>&#160;<span class="comment"> /// the pressure to controls the flux, plus a pointer to</span></div>
<div class="line"><a name="l02817"></a><span class="lineno"> 2817</span>&#160;<span class="comment"> /// the PressureControlElement whoes internal data is the prescribed</span></div>
<div class="line"><a name="l02818"></a><span class="lineno"> 2818</span>&#160;<span class="comment"> /// flux. </span></div>
<div class="line"><a name="l02819"></a><span class="lineno"><a class="line" href="classoomph_1_1NetFluxControlElementForWomersleyPressureControl.html#a395d5cf74e6e8c4dc581b52048963f38"> 2819</a></span>&#160;<span class="comment"></span> <a class="code" href="classoomph_1_1NetFluxControlElementForWomersleyPressureControl.html#a395d5cf74e6e8c4dc581b52048963f38">NetFluxControlElementForWomersleyPressureControl</a>(</div>
<div class="line"><a name="l02820"></a><span class="lineno"> 2820</span>&#160;  <a class="code" href="classoomph_1_1Mesh.html">Mesh</a>* flux_control_mesh_pt,</div>
<div class="line"><a name="l02821"></a><span class="lineno"> 2821</span>&#160;  <a class="code" href="classoomph_1_1NavierStokesWomersleyPressureControlElement.html">NavierStokesWomersleyPressureControlElement</a>* pressure_control_element_pt) </div>
<div class="line"><a name="l02822"></a><span class="lineno"> 2822</span>&#160;  : <a class="code" href="classoomph_1_1NetFluxControlElement.html">NetFluxControlElement</a>(</div>
<div class="line"><a name="l02823"></a><span class="lineno"> 2823</span>&#160;   flux_control_mesh_pt,</div>
<div class="line"><a name="l02824"></a><span class="lineno"> 2824</span>&#160;   pressure_control_element_pt-&gt;volume_flux_data_pt()-&gt;value_pt(0))</div>
<div class="line"><a name="l02825"></a><span class="lineno"> 2825</span>&#160;  {</div>
<div class="line"><a name="l02826"></a><span class="lineno"> 2826</span>&#160;   <span class="comment">// There&#39;s no need to add external data to this element since</span></div>
<div class="line"><a name="l02827"></a><span class="lineno"> 2827</span>&#160;   <span class="comment">// this element&#39;s Jacobian contributions are calculated by the</span></div>
<div class="line"><a name="l02828"></a><span class="lineno"> 2828</span>&#160;   <span class="comment">// NavierStokesFluxControlElements and the P</span></div>
<div class="line"><a name="l02829"></a><span class="lineno"> 2829</span>&#160;   <span class="comment">// NavierStokesWomersleyPressureControlElement</span></div>
<div class="line"><a name="l02830"></a><span class="lineno"> 2830</span>&#160;   </div>
<div class="line"><a name="l02831"></a><span class="lineno"> 2831</span>&#160;   <span class="comment">// Add this elements Data to the external data of the </span></div>
<div class="line"><a name="l02832"></a><span class="lineno"> 2832</span>&#160;   <span class="comment">// PressureControlElement</span></div>
<div class="line"><a name="l02833"></a><span class="lineno"> 2833</span>&#160;   pressure_control_element_pt-&gt;<a class="code" href="classoomph_1_1NavierStokesWomersleyPressureControlElement.html#a88706386c6cbdf93ccdbf78d38424ee9">add_pressure_data</a>(pressure_data_pt());</div>
<div class="line"><a name="l02834"></a><span class="lineno"> 2834</span>&#160;  }</div>
<div class="line"><a name="l02835"></a><span class="lineno"> 2835</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l02836"></a><span class="lineno"> 2836</span>&#160;<span class="comment"> /// Empty Destructor - Data gets deleted automatically</span></div>
<div class="line"><a name="l02837"></a><span class="lineno"><a class="line" href="classoomph_1_1NetFluxControlElementForWomersleyPressureControl.html#a6b7c6f8529d0194db68ae1202c9fa100"> 2837</a></span>&#160;<span class="comment"></span> <a class="code" href="classoomph_1_1NetFluxControlElementForWomersleyPressureControl.html#a6b7c6f8529d0194db68ae1202c9fa100">~NetFluxControlElementForWomersleyPressureControl</a>() {}</div>
<div class="line"><a name="l02838"></a><span class="lineno"> 2838</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l02839"></a><span class="lineno"> 2839</span>&#160;<span class="comment"> /// Broken copy constructor</span></div>
<div class="line"><a name="l02840"></a><span class="lineno"><a class="line" href="classoomph_1_1NetFluxControlElementForWomersleyPressureControl.html#a0c105f9f6451a881079e3198b51a5593"> 2840</a></span>&#160;<span class="comment"></span> <a class="code" href="classoomph_1_1NetFluxControlElementForWomersleyPressureControl.html#a0c105f9f6451a881079e3198b51a5593">NetFluxControlElementForWomersleyPressureControl</a>(</div>
<div class="line"><a name="l02841"></a><span class="lineno"> 2841</span>&#160;  <span class="keyword">const</span> <a class="code" href="classoomph_1_1NetFluxControlElementForWomersleyPressureControl.html">NetFluxControlElementForWomersleyPressureControl</a>&amp; dummy) : </div>
<div class="line"><a name="l02842"></a><span class="lineno"> 2842</span>&#160;  <a class="code" href="classoomph_1_1NetFluxControlElement.html">NetFluxControlElement</a>(dummy)</div>
<div class="line"><a name="l02843"></a><span class="lineno"> 2843</span>&#160;  {</div>
<div class="line"><a name="l02844"></a><span class="lineno"> 2844</span>&#160;   <a class="code" href="namespaceoomph_1_1BrokenCopy.html#a7e5cd7fda8b8c790003151bee77a84ac">BrokenCopy::broken_copy</a>(</div>
<div class="line"><a name="l02845"></a><span class="lineno"> 2845</span>&#160;    <span class="stringliteral">&quot;NetFluxControlElementForWomersleyPressureControl&quot;</span>);</div>
<div class="line"><a name="l02846"></a><span class="lineno"> 2846</span>&#160;  }</div>
<div class="line"><a name="l02847"></a><span class="lineno"> 2847</span>&#160; </div>
<div class="line"><a name="l02848"></a><span class="lineno"> 2848</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l02849"></a><span class="lineno"> 2849</span>&#160;<span class="comment"> /// Broken assignment operator</span></div>
<div class="line"><a name="l02850"></a><span class="lineno"><a class="line" href="classoomph_1_1NetFluxControlElementForWomersleyPressureControl.html#a499dc308316bda2ce079d89773562418"> 2850</a></span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1NetFluxControlElementForWomersleyPressureControl.html#a499dc308316bda2ce079d89773562418">operator=</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1NetFluxControlElementForWomersleyPressureControl.html">NetFluxControlElementForWomersleyPressureControl</a>&amp;)</div>
<div class="line"><a name="l02851"></a><span class="lineno"> 2851</span>&#160;  {</div>
<div class="line"><a name="l02852"></a><span class="lineno"> 2852</span>&#160;   <a class="code" href="namespaceoomph_1_1BrokenCopy.html#a32dc384e671e786bac0c67cbff701f45">BrokenCopy::broken_assign</a>(</div>
<div class="line"><a name="l02853"></a><span class="lineno"> 2853</span>&#160;    <span class="stringliteral">&quot;NetFluxControlElementForWomersleyPressureControl&quot;</span>);</div>
<div class="line"><a name="l02854"></a><span class="lineno"> 2854</span>&#160;  }</div>
<div class="line"><a name="l02855"></a><span class="lineno"> 2855</span>&#160; </div>
<div class="line"><a name="l02856"></a><span class="lineno"> 2856</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l02857"></a><span class="lineno"> 2857</span>&#160;<span class="comment"> /// \short The number of &quot;DOF types&quot; that degrees of freedom in this element</span></div>
<div class="line"><a name="l02858"></a><span class="lineno"> 2858</span>&#160;<span class="comment"> /// are sub-divided into - set to 1</span></div>
<div class="line"><a name="l02859"></a><span class="lineno"><a class="line" href="classoomph_1_1NetFluxControlElementForWomersleyPressureControl.html#a538b22e5aceecf140d03e400a8848a33"> 2859</a></span>&#160;<span class="comment"></span> <span class="keywordtype">unsigned</span> <a class="code" href="classoomph_1_1NetFluxControlElementForWomersleyPressureControl.html#a538b22e5aceecf140d03e400a8848a33">ndof_types</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l02860"></a><span class="lineno"> 2860</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l02861"></a><span class="lineno"> 2861</span>&#160;   <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l02862"></a><span class="lineno"> 2862</span>&#160;  }</div>
<div class="line"><a name="l02863"></a><span class="lineno"> 2863</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l02864"></a><span class="lineno"> 2864</span>&#160;<span class="comment"> /// \short Create a list of pairs for all unknowns in this element,</span></div>
<div class="line"><a name="l02865"></a><span class="lineno"> 2865</span>&#160;<span class="comment"> /// so that the first entry in each pair contains the global equation</span></div>
<div class="line"><a name="l02866"></a><span class="lineno"> 2866</span>&#160;<span class="comment"> /// number of the unknown, while the second one contains the number</span></div>
<div class="line"><a name="l02867"></a><span class="lineno"> 2867</span>&#160;<span class="comment"> /// of the &quot;DOF type&quot; that this unknown is associated with.</span></div>
<div class="line"><a name="l02868"></a><span class="lineno"> 2868</span>&#160;<span class="comment"> /// (Function can obviously only be called if the equation numbering</span></div>
<div class="line"><a name="l02869"></a><span class="lineno"> 2869</span>&#160;<span class="comment"> /// scheme has been set up.)</span></div>
<div class="line"><a name="l02870"></a><span class="lineno"><a class="line" href="classoomph_1_1NetFluxControlElementForWomersleyPressureControl.html#a63f6761cad384044fae2c8339422c9df"> 2870</a></span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1NetFluxControlElementForWomersleyPressureControl.html#a63f6761cad384044fae2c8339422c9df">get_dof_numbers_for_unknowns</a>(</div>
<div class="line"><a name="l02871"></a><span class="lineno"> 2871</span>&#160;  std::list&lt;std::pair&lt;unsigned long, unsigned&gt; &gt;&amp; dof_lookup_list)<span class="keyword"> const</span></div>
<div class="line"><a name="l02872"></a><span class="lineno"> 2872</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l02873"></a><span class="lineno"> 2873</span>&#160;   <span class="comment">// pair to store dof lookup prior to being added to list</span></div>
<div class="line"><a name="l02874"></a><span class="lineno"> 2874</span>&#160;   std::pair&lt;unsigned,unsigned&gt; dof_lookup;</div>
<div class="line"><a name="l02875"></a><span class="lineno"> 2875</span>&#160; </div>
<div class="line"><a name="l02876"></a><span class="lineno"> 2876</span>&#160;   dof_lookup.first = this-&gt;eqn_number(0);</div>
<div class="line"><a name="l02877"></a><span class="lineno"> 2877</span>&#160;   dof_lookup.second = 0;</div>
<div class="line"><a name="l02878"></a><span class="lineno"> 2878</span>&#160;     </div>
<div class="line"><a name="l02879"></a><span class="lineno"> 2879</span>&#160;   <span class="comment">// add to list</span></div>
<div class="line"><a name="l02880"></a><span class="lineno"> 2880</span>&#160;   dof_lookup_list.push_front(dof_lookup);</div>
<div class="line"><a name="l02881"></a><span class="lineno"> 2881</span>&#160;  }</div>
<div class="line"><a name="l02882"></a><span class="lineno"> 2882</span>&#160; </div>
<div class="line"><a name="l02883"></a><span class="lineno"> 2883</span>&#160;};</div>
<div class="line"><a name="l02884"></a><span class="lineno"> 2884</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02885"></a><span class="lineno"> 2885</span>&#160;<span class="comment">/////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l02886"></a><span class="lineno"> 2886</span>&#160;<span class="comment">/////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l02887"></a><span class="lineno"> 2887</span>&#160;<span class="comment">/////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l02888"></a><span class="lineno"> 2888</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02889"></a><span class="lineno"> 2889</span>&#160;}</div>
<div class="line"><a name="l02890"></a><span class="lineno"> 2890</span>&#160; </div>
<div class="line"><a name="l02891"></a><span class="lineno"> 2891</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02892"></a><span class="lineno"> 2892</span>&#160; </div>
<div class="line"><a name="l02893"></a><span class="lineno"> 2893</span>&#160; </div>
<div class="line"><a name="l02894"></a><span class="lineno"> 2894</span>&#160; </div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="aclassoomph_1_1NavierStokesWomersleyPressureControlElement_html_a65a9d8901d8d0690f82b873c0dafe1bd"><div class="ttname"><a href="classoomph_1_1NavierStokesWomersleyPressureControlElement.html#a65a9d8901d8d0690f82b873c0dafe1bd">oomph::NavierStokesWomersleyPressureControlElement::ndof_types</a></div><div class="ttdeci">unsigned ndof_types() const</div><div class="ttdoc">The number of &quot;DOF types&quot; that degrees of freedom in this element are sub-divided into - set to 1.</div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l02707">womersley_elements.h:2707</a></div></div>
<div class="ttc" id="aclassoomph_1_1WomersleyProblem_html_a6ed55a744929154a6b8d3b7bb9f0570a"><div class="ttname"><a href="classoomph_1_1WomersleyProblem.html#a6ed55a744929154a6b8d3b7bb9f0570a">oomph::WomersleyProblem::doc_solution</a></div><div class="ttdeci">void doc_solution(DocInfo &amp;doc_info, std::ofstream &amp;trace_file, const double &amp;z_out=0.0)</div><div class="ttdoc">Doc the solution incl. trace file for various quantities of interest (to some...)</div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l01029">womersley_elements.h:1029</a></div></div>
<div class="ttc" id="anamespaceoomph_html_aec474227917784dc0a255faf289cfc16"><div class="ttname"><a href="namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph::oomph_info</a></div><div class="ttdeci">OomphInfo oomph_info</div><div class="ttdef"><b>Definition:</b> <a href="oomph__definitions_8cc_source.html#l00322">oomph_definitions.cc:322</a></div></div>
<div class="ttc" id="aclassoomph_1_1NetFluxControlElementForWomersleyPressureControl_html_a0c105f9f6451a881079e3198b51a5593"><div class="ttname"><a href="classoomph_1_1NetFluxControlElementForWomersleyPressureControl.html#a0c105f9f6451a881079e3198b51a5593">oomph::NetFluxControlElementForWomersleyPressureControl::NetFluxControlElementForWomersleyPressureControl</a></div><div class="ttdeci">NetFluxControlElementForWomersleyPressureControl(const NetFluxControlElementForWomersleyPressureControl &amp;dummy)</div><div class="ttdoc">Broken copy constructor.</div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l02840">womersley_elements.h:2840</a></div></div>
<div class="ttc" id="aclassoomph_1_1TemplateFreeWomersleyMeshBase_html_acafc84fe27a65ac15185aebc1a4d0974"><div class="ttname"><a href="classoomph_1_1TemplateFreeWomersleyMeshBase.html#acafc84fe27a65ac15185aebc1a4d0974">oomph::TemplateFreeWomersleyMeshBase::Suppress_warning_about_unpinned_nst_dofs</a></div><div class="ttdeci">static bool Suppress_warning_about_unpinned_nst_dofs</div><div class="ttdoc">Static bool to suppress warning.</div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l01655">womersley_elements.h:1655</a></div></div>
<div class="ttc" id="aclassoomph_1_1NavierStokesImpedanceTractionElement_html_a6ddd1fa5b0e8c498aa1fc03f4492ee34"><div class="ttname"><a href="classoomph_1_1NavierStokesImpedanceTractionElement.html#a6ddd1fa5b0e8c498aa1fc03f4492ee34">oomph::NavierStokesImpedanceTractionElement::navier_stokes_outflow_mesh_pt</a></div><div class="ttdeci">Mesh *&amp; navier_stokes_outflow_mesh_pt()</div><div class="ttdoc">Access to mesh containing all NavierStokesImpedanceTractionElements that contribute to the volume flu...</div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l02169">womersley_elements.h:2169</a></div></div>
<div class="ttc" id="aclassoomph_1_1QWomersleyElement_html_a2730f3cf9212c0b5cbc22939a376af07"><div class="ttname"><a href="classoomph_1_1QWomersleyElement.html#a2730f3cf9212c0b5cbc22939a376af07">oomph::QWomersleyElement::output_fct</a></div><div class="ttdeci">void output_fct(std::ostream &amp;outfile, const unsigned &amp;n_plot, const double &amp;time, FiniteElement::UnsteadyExactSolutionFctPt exact_soln_pt)</div><div class="ttdoc">Output function for a time-dependent exact solution. x,y,u_exact or x,y,z,u_exact at n_plot^DIM plot ...</div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l00730">womersley_elements.h:730</a></div></div>
<div class="ttc" id="aclassoomph_1_1FiniteElement_html_ace0e7fb72a805b5c2c600347bfae7a9b"><div class="ttname"><a href="classoomph_1_1FiniteElement.html#ace0e7fb72a805b5c2c600347bfae7a9b">oomph::FiniteElement::node_pt</a></div><div class="ttdeci">Node *&amp; node_pt(const unsigned &amp;n)</div><div class="ttdoc">Return a pointer to the local node n.</div><div class="ttdef"><b>Definition:</b> <a href="elements_8h_source.html#l02122">elements.h:2122</a></div></div>
<div class="ttc" id="aclassoomph_1_1ImposeFluxForWomersleyElement_html_a40cd4288395b34cd199080c136da4d7b"><div class="ttname"><a href="classoomph_1_1ImposeFluxForWomersleyElement.html#a40cd4288395b34cd199080c136da4d7b">oomph::ImposeFluxForWomersleyElement::Prescribed_flux_pt</a></div><div class="ttdeci">double * Prescribed_flux_pt</div><div class="ttdoc">Pointer to current value of prescribed flux.</div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l00641">womersley_elements.h:641</a></div></div>
<div class="ttc" id="aclassoomph_1_1WomersleyEquations_html_aebc178cae7a5f50da1f76eed2ea3972d"><div class="ttname"><a href="classoomph_1_1WomersleyEquations.html#aebc178cae7a5f50da1f76eed2ea3972d">oomph::WomersleyEquations::output_fct</a></div><div class="ttdeci">void output_fct(std::ostream &amp;outfile, const unsigned &amp;nplot, FiniteElement::SteadyExactSolutionFctPt exact_soln_pt)</div><div class="ttdoc">Output exact soln: x,y,u_exact or x,y,z,u_exact at nplot^DIM plot points.</div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8cc_source.html#l00450">womersley_elements.cc:450</a></div></div>
<div class="ttc" id="aclassoomph_1_1WomersleyProblem_html_a367c83d9a996c426cb65a7baa86af81b"><div class="ttname"><a href="classoomph_1_1WomersleyProblem.html#a367c83d9a996c426cb65a7baa86af81b">oomph::WomersleyProblem::doc_solution</a></div><div class="ttdeci">void doc_solution(DocInfo &amp;doc_info, const double &amp;z_out=0.0)</div><div class="ttdoc">Doc the solution.</div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l00833">womersley_elements.h:833</a></div></div>
<div class="ttc" id="aclassoomph_1_1WomersleyImpedanceTubeBase_html"><div class="ttname"><a href="classoomph_1_1WomersleyImpedanceTubeBase.html">oomph::WomersleyImpedanceTubeBase</a></div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l01116">womersley_elements.h:1116</a></div></div>
<div class="ttc" id="athe__data__structure_8txt_html_a5448c72da3359c7796cf0c5f800732a1"><div class="ttname"><a href="the__data__structure_8txt.html#a5448c72da3359c7796cf0c5f800732a1">interpolated_u</a></div><div class="ttdeci">and code FiniteElement::J_eulerian(...) \endcode returns the Jacobian of the mapping from Eulerian coordinates to local coordinates. - The function \c GeneralisedElement c QElement&lt; 3, 2 &gt; is an node brick element with a trilinear mapping between and global coordinates The dimension and the number of c Nodes must be set by calling the appropriate c set_ functions in the see ref set_commands above The most important member functions implemented at this level include Functions that evaluate the shape in terms of the c FiniteElement s coordinates functions that determine whether a c Node is located at a particular coordinate Output functions that allow the element shapes to be plotted we specify a pointer to a spatial integration the default assignment can be over written at a higher level This is discussed in more detail in a&lt; A HREF=&quot;../../optimisation/html/index.html&quot;&gt; separate document&lt;/A &gt; subsubsection Maths_Element we implement the equations that are represented by the specific element We implement the employing either the geometric shape functions that already exist on or employing additional shape functions defined at this level This allows us to write further member functions such as c interpolated_u(...)</div></div>
<div class="ttc" id="aclassoomph_1_1WomersleyEquations_html_a5f8bd506dbebc304f30f86ef4acfbd9d"><div class="ttname"><a href="classoomph_1_1WomersleyEquations.html#a5f8bd506dbebc304f30f86ef4acfbd9d">oomph::WomersleyEquations::dshape_and_dtest_eulerian_at_knot_womersley</a></div><div class="ttdeci">virtual double dshape_and_dtest_eulerian_at_knot_womersley(const unsigned &amp;ipt, Shape &amp;psi, DShape &amp;dpsidx, Shape &amp;test, DShape &amp;dtestdx) const =0</div><div class="ttdoc">Shape/test functions and derivs w.r.t. to global coords at integration point ipt; return Jacobian of ...</div></div>
<div class="ttc" id="aclassoomph_1_1NavierStokesImpedanceTractionElement_html_ac5070c5b06b172cb7f1cb36b853e8edf"><div class="ttname"><a href="classoomph_1_1NavierStokesImpedanceTractionElement.html#ac5070c5b06b172cb7f1cb36b853e8edf">oomph::NavierStokesImpedanceTractionElement::u_local_eqn</a></div><div class="ttdeci">virtual int u_local_eqn(const unsigned &amp;n, const unsigned &amp;i)</div><div class="ttdoc">Access function that returns the local equation numbers for velocity components. u_local_eqn(n,...</div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l02077">womersley_elements.h:2077</a></div></div>
<div class="ttc" id="aclassoomph_1_1NavierStokesImpedanceTractionElement_html_a43b61cca808fed11ace680439488c3df"><div class="ttname"><a href="classoomph_1_1NavierStokesImpedanceTractionElement.html#a43b61cca808fed11ace680439488c3df">oomph::NavierStokesImpedanceTractionElement::output</a></div><div class="ttdeci">void output(std::ostream &amp;outfile)</div><div class="ttdoc">Overload the output function.</div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l02468">womersley_elements.h:2468</a></div></div>
<div class="ttc" id="aclassoomph_1_1NavierStokesWomersleyPressureControlElement_html_a88706386c6cbdf93ccdbf78d38424ee9"><div class="ttname"><a href="classoomph_1_1NavierStokesWomersleyPressureControlElement.html#a88706386c6cbdf93ccdbf78d38424ee9">oomph::NavierStokesWomersleyPressureControlElement::add_pressure_data</a></div><div class="ttdeci">void add_pressure_data(Data *pressure_data_pt)</div><div class="ttdoc">Function to add to external data the Data object whose single value is the pressure applied at the bo...</div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l02700">womersley_elements.h:2700</a></div></div>
<div class="ttc" id="aclassoomph_1_1NetFluxControlElementForWomersleyPressureControl_html_a395d5cf74e6e8c4dc581b52048963f38"><div class="ttname"><a href="classoomph_1_1NetFluxControlElementForWomersleyPressureControl.html#a395d5cf74e6e8c4dc581b52048963f38">oomph::NetFluxControlElementForWomersleyPressureControl::NetFluxControlElementForWomersleyPressureControl</a></div><div class="ttdeci">NetFluxControlElementForWomersleyPressureControl(Mesh *flux_control_mesh_pt, NavierStokesWomersleyPressureControlElement *pressure_control_element_pt)</div><div class="ttdoc">Constructor takes the mesh of   TemplateFreeNavierStokesFluxControlElementBase which impose the press...</div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l02819">womersley_elements.h:2819</a></div></div>
<div class="ttc" id="aclassoomph_1_1Data_html_a7289ca322725c6fd493970a19474b382"><div class="ttname"><a href="classoomph_1_1Data.html#a7289ca322725c6fd493970a19474b382">oomph::Data::set_value</a></div><div class="ttdeci">void set_value(const unsigned &amp;i, const double &amp;value_)</div><div class="ttdoc">Set the i-th stored data value to specified value. The only reason that we require an explicit set fu...</div><div class="ttdef"><b>Definition:</b> <a href="nodes_8h_source.html#l00263">nodes.h:263</a></div></div>
<div class="ttc" id="aclassoomph_1_1QWomersleyElement_html_a5a8951b6a947e120821c1a83048975d4"><div class="ttname"><a href="classoomph_1_1QWomersleyElement.html#a5a8951b6a947e120821c1a83048975d4">oomph::QWomersleyElement::output</a></div><div class="ttdeci">void output(std::ostream &amp;outfile)</div><div class="ttdoc">Output function:   x,y,u or x,y,z,u.</div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l00695">womersley_elements.h:695</a></div></div>
<div class="ttc" id="aclassoomph_1_1WomersleyProblem_html"><div class="ttname"><a href="classoomph_1_1WomersleyProblem.html">oomph::WomersleyProblem</a></div><div class="ttdoc">Womersley problem.</div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l00768">womersley_elements.h:768</a></div></div>
<div class="ttc" id="athe__data__structure_8txt_html_a1400a973def57b85051cfe1070be1810"><div class="ttname"><a href="the__data__structure_8txt.html#a1400a973def57b85051cfe1070be1810">residuals</a></div><div class="ttdeci">endcode The default implementation of c the simplest possible implementation of a new element requires only the specification of c we need to know which c Data affects the residuals(and hence the Jacobian matrix). For a \c GeneralisedElement such \c Data exists in two forms</div></div>
<div class="ttc" id="aclassoomph_1_1FaceGeometry_3_01QWomersleyElement_3_011_00_01NNODE__1D_01_4_01_4_html_a565684012c2ea2a9abfc9364d2905448"><div class="ttname"><a href="classoomph_1_1FaceGeometry_3_01QWomersleyElement_3_011_00_01NNODE__1D_01_4_01_4.html#a565684012c2ea2a9abfc9364d2905448">oomph::FaceGeometry&lt; QWomersleyElement&lt; 1, NNODE_1D &gt; &gt;::FaceGeometry</a></div><div class="ttdeci">FaceGeometry()</div><div class="ttdoc">Constructor: Call the constructor for the appropriate lower-dimensional QElement.</div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l01636">womersley_elements.h:1636</a></div></div>
<div class="ttc" id="aclassoomph_1_1WomersleyImpedanceTubeBase_html_ab424ec7b47d3f31acd44dcf93be6b5e5"><div class="ttname"><a href="classoomph_1_1WomersleyImpedanceTubeBase.html#ab424ec7b47d3f31acd44dcf93be6b5e5">oomph::WomersleyImpedanceTubeBase::Womersley_problem_pt</a></div><div class="ttdeci">WomersleyProblem&lt; ELEMENT, DIM &gt; * Womersley_problem_pt</div><div class="ttdoc">Pointer to Womersley problem that determines the pressure gradient along the tube.</div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l01499">womersley_elements.h:1499</a></div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_acfdb74e8522fa5d486064998e7223fc6"><div class="ttname"><a href="classoomph_1_1Problem.html#acfdb74e8522fa5d486064998e7223fc6">oomph::Problem::time_stepper_pt</a></div><div class="ttdeci">TimeStepper *&amp; time_stepper_pt()</div><div class="ttdoc">Access function for the pointer to the first (presumably only) timestepper.</div><div class="ttdef"><b>Definition:</b> <a href="problem_8h_source.html#l01463">problem.h:1463</a></div></div>
<div class="ttc" id="aclassoomph_1_1QElement_html"><div class="ttname"><a href="classoomph_1_1QElement.html">oomph::QElement</a></div><div class="ttdef"><b>Definition:</b> <a href="Qelements_8h_source.html#l00481">Qelements.h:481</a></div></div>
<div class="ttc" id="aclassoomph_1_1FiniteElement_html_aaf7bead5b462cfd5401d97b3dbdc7af7"><div class="ttname"><a href="classoomph_1_1FiniteElement.html#aaf7bead5b462cfd5401d97b3dbdc7af7">oomph::FiniteElement::build_face_element</a></div><div class="ttdeci">virtual void build_face_element(const int &amp;face_index, FaceElement *face_element_pt)</div><div class="ttdoc">Function for building a lower dimensional FaceElement on the specified face of the FiniteElement....</div><div class="ttdef"><b>Definition:</b> <a href="elements_8cc_source.html#l05001">elements.cc:5001</a></div></div>
<div class="ttc" id="aclassoomph_1_1NavierStokesWomersleyPressureControlElement_html_ac06944c7b24e71a1d9341166049fc360"><div class="ttname"><a href="classoomph_1_1NavierStokesWomersleyPressureControlElement.html#ac06944c7b24e71a1d9341166049fc360">oomph::NavierStokesWomersleyPressureControlElement::get_dof_numbers_for_unknowns</a></div><div class="ttdeci">void get_dof_numbers_for_unknowns(std::list&lt; std::pair&lt; unsigned long, unsigned &gt; &gt; &amp;dof_lookup_list) const</div><div class="ttdoc">Create a list of pairs for all unknowns in this element, so that the first entry in each pair contain...</div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l02718">womersley_elements.h:2718</a></div></div>
<div class="ttc" id="aclassoomph_1_1Data_html_a4e5cb031bf8eceb8f97c2c4fbd74cb05"><div class="ttname"><a href="classoomph_1_1Data.html#a4e5cb031bf8eceb8f97c2c4fbd74cb05">oomph::Data::unpin</a></div><div class="ttdeci">void unpin(const unsigned &amp;i)</div><div class="ttdoc">Unpin the i-th stored variable.</div><div class="ttdef"><b>Definition:</b> <a href="nodes_8h_source.html#l00382">nodes.h:382</a></div></div>
<div class="ttc" id="aclassoomph_1_1WomersleyEquations_html_a9f25fbad09d6e3b14971755ea81f0189"><div class="ttname"><a href="classoomph_1_1WomersleyEquations.html#a9f25fbad09d6e3b14971755ea81f0189">oomph::WomersleyEquations::Default_ReSt_value</a></div><div class="ttdeci">static double Default_ReSt_value</div><div class="ttdoc">Static default value for the Womersley number.</div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l00476">womersley_elements.h:476</a></div></div>
<div class="ttc" id="aclassoomph_1_1WomersleyEquations_html_a72c6fc82b100bd997a6d707d8bccd9d2"><div class="ttname"><a href="classoomph_1_1WomersleyEquations.html#a72c6fc82b100bd997a6d707d8bccd9d2">oomph::WomersleyEquations::set_pressure_gradient_pt</a></div><div class="ttdeci">Data * set_pressure_gradient_pt() const</div><div class="ttdoc">Read-only access to pointer to pressure gradient.</div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l00247">womersley_elements.h:247</a></div></div>
<div class="ttc" id="aclassoomph_1_1WomersleyEquations_html_afd739de1c8e01b1d9409c05db9ced366"><div class="ttname"><a href="classoomph_1_1WomersleyEquations.html#afd739de1c8e01b1d9409c05db9ced366">oomph::WomersleyEquations::u_index_womersley</a></div><div class="ttdeci">virtual unsigned u_index_womersley() const</div><div class="ttdoc">Return the index at which the unknown value is stored. The default value, 0, is appropriate for singl...</div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l00268">womersley_elements.h:268</a></div></div>
<div class="ttc" id="aclassoomph_1_1WomersleyEquations_html_aaca21f4cfb0b6614b9b796073ce9c8b8"><div class="ttname"><a href="classoomph_1_1WomersleyEquations.html#aaca21f4cfb0b6614b9b796073ce9c8b8">oomph::WomersleyEquations::re_st_pt</a></div><div class="ttdeci">double *&amp; re_st_pt()</div><div class="ttdoc">Pointer to product of Reynolds and Strouhal number (=Womersley number)</div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l00258">womersley_elements.h:258</a></div></div>
<div class="ttc" id="aclassoomph_1_1FiniteElement_html"><div class="ttname"><a href="classoomph_1_1FiniteElement.html">oomph::FiniteElement</a></div><div class="ttdoc">A general Finite Element class.</div><div class="ttdef"><b>Definition:</b> <a href="elements_8h_source.html#l01287">elements.h:1287</a></div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_a6e6329fadca85c56eff22af23338dfe9"><div class="ttname"><a href="classoomph_1_1Problem.html#a6e6329fadca85c56eff22af23338dfe9">oomph::Problem::time</a></div><div class="ttdeci">double &amp; time()</div><div class="ttdoc">Return the current value of continuous time.</div><div class="ttdef"><b>Definition:</b> <a href="problem_8cc_source.html#l11415">problem.cc:11415</a></div></div>
<div class="ttc" id="aclassoomph_1_1WomersleyEquations_html_ad0c342503c279bc697530d87059e7d48"><div class="ttname"><a href="classoomph_1_1WomersleyEquations.html#ad0c342503c279bc697530d87059e7d48">oomph::WomersleyEquations::fill_in_contribution_to_residuals</a></div><div class="ttdeci">void fill_in_contribution_to_residuals(Vector&lt; double &gt; &amp;residuals)</div><div class="ttdoc">Compute element residual Vector (wrapper)</div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l00391">womersley_elements.h:391</a></div></div>
<div class="ttc" id="aclassoomph_1_1NetFluxControlElement_html"><div class="ttname"><a href="classoomph_1_1NetFluxControlElement.html">oomph::NetFluxControlElement</a></div><div class="ttdef"><b>Definition:</b> <a href="navier__stokes__flux__control__elements_8h_source.html#l00107">navier_stokes_flux_control_elements.h:107</a></div></div>
<div class="ttc" id="aclassoomph_1_1OomphLibError_html"><div class="ttname"><a href="classoomph_1_1OomphLibError.html">oomph::OomphLibError</a></div><div class="ttdef"><b>Definition:</b> <a href="oomph__definitions_8h_source.html#l00225">oomph_definitions.h:225</a></div></div>
<div class="ttc" id="aclassoomph_1_1Mesh_html_a4f274774435e9454bf77bf70de69367a"><div class="ttname"><a href="classoomph_1_1Mesh.html#a4f274774435e9454bf77bf70de69367a">oomph::Mesh::finite_element_pt</a></div><div class="ttdeci">FiniteElement * finite_element_pt(const unsigned &amp;e) const</div><div class="ttdoc">Upcast (downcast?) to FiniteElement (needed to access FiniteElement member functions).</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8h_source.html#l00473">mesh.h:473</a></div></div>
<div class="ttc" id="aclassoomph_1_1WomersleyProblem_html_a4816844a22263d5f39ff8ca5d2c370ba"><div class="ttname"><a href="classoomph_1_1WomersleyProblem.html#a4816844a22263d5f39ff8ca5d2c370ba">oomph::WomersleyProblem::Flux_el_pt</a></div><div class="ttdeci">ImposeFluxForWomersleyElement&lt; DIM &gt; * Flux_el_pt</div><div class="ttdoc">Pointer to element that imposes the flux through the collection of Womersley elements.</div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l00855">womersley_elements.h:855</a></div></div>
<div class="ttc" id="aclassoomph_1_1Mesh_html_a3c3b85a1be4d9b01f1c0805142a37966"><div class="ttname"><a href="classoomph_1_1Mesh.html#a3c3b85a1be4d9b01f1c0805142a37966">oomph::Mesh::element_pt</a></div><div class="ttdeci">GeneralisedElement *&amp; element_pt(const unsigned long &amp;e)</div><div class="ttdoc">Return pointer to element e.</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8h_source.html#l00458">mesh.h:458</a></div></div>
<div class="ttc" id="aclassoomph_1_1WomersleyProblem_html_ad82799a978674bc9f49ac3240d43c34d"><div class="ttname"><a href="classoomph_1_1WomersleyProblem.html#ad82799a978674bc9f49ac3240d43c34d">oomph::WomersleyProblem::Pressure_gradient_data_pt</a></div><div class="ttdeci">Data * Pressure_gradient_data_pt</div><div class="ttdoc">Pointer to single-valued Data item that stores pressure gradient.</div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l00861">womersley_elements.h:861</a></div></div>
<div class="ttc" id="aclassoomph_1_1NavierStokesWomersleyPressureControlElement_html_ab7385fe09993adfda19e4787f91abeb6"><div class="ttname"><a href="classoomph_1_1NavierStokesWomersleyPressureControlElement.html#ab7385fe09993adfda19e4787f91abeb6">oomph::NavierStokesWomersleyPressureControlElement::Volume_flux_data_pt</a></div><div class="ttdeci">Data * Volume_flux_data_pt</div><div class="ttdoc">Data object whose single value is the volume flux applied by the elements in the Flux_control_mesh_pt...</div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l02776">womersley_elements.h:2776</a></div></div>
<div class="ttc" id="aclassoomph_1_1NavierStokesImpedanceTractionElement_html_aa1738496ef280139a8bd1dbda979d8b1"><div class="ttname"><a href="classoomph_1_1NavierStokesImpedanceTractionElement.html#aa1738496ef280139a8bd1dbda979d8b1">oomph::NavierStokesImpedanceTractionElement::shape_and_test_at_knot</a></div><div class="ttdeci">double shape_and_test_at_knot(const unsigned &amp;ipt, Shape &amp;psi, Shape &amp;test) const</div><div class="ttdoc">Function to compute the shape and test functions and to return the Jacobian of mapping</div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l02082">womersley_elements.h:2082</a></div></div>
<div class="ttc" id="aclassoomph_1_1WomersleyImpedanceTubeBase_html_a4f6f0c9043ea66a5b0c3a623cf1e7354"><div class="ttname"><a href="classoomph_1_1WomersleyImpedanceTubeBase.html#a4f6f0c9043ea66a5b0c3a623cf1e7354">oomph::WomersleyImpedanceTubeBase::Dp_in_dq</a></div><div class="ttdeci">double Dp_in_dq</div><div class="ttdoc">Derivative of inflow pressure w.r.t. instantaenous volume flux (Note: Can be pre-computed)</div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l01489">womersley_elements.h:1489</a></div></div>
<div class="ttc" id="aclassoomph_1_1NavierStokesWomersleyPressureControlElement_html_a091e01b1894fc97c8cca758f9c6cc121"><div class="ttname"><a href="classoomph_1_1NavierStokesWomersleyPressureControlElement.html#a091e01b1894fc97c8cca758f9c6cc121">oomph::NavierStokesWomersleyPressureControlElement::volume_flux_data_pt</a></div><div class="ttdeci">Data * volume_flux_data_pt() const</div><div class="ttdoc">Function to return a pointer to the Data object whose single value is the flux degree of freedom.</div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l02696">womersley_elements.h:2696</a></div></div>
<div class="ttc" id="aclassoomph_1_1QWomersleyElement_html_a2d73507033cac13eed334354502663d6"><div class="ttname"><a href="classoomph_1_1QWomersleyElement.html#a2d73507033cac13eed334354502663d6">oomph::QWomersleyElement::output</a></div><div class="ttdeci">void output(FILE *file_pt)</div><div class="ttdoc">C-style output function:   x,y,u or x,y,z,u.</div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l00708">womersley_elements.h:708</a></div></div>
<div class="ttc" id="aclassoomph_1_1FiniteElement_html_a690fd33af26cc3e84f39bba6d5a85202"><div class="ttname"><a href="classoomph_1_1FiniteElement.html#a690fd33af26cc3e84f39bba6d5a85202">oomph::FiniteElement::SteadyExactSolutionFctPt</a></div><div class="ttdeci">void(* SteadyExactSolutionFctPt)(const Vector&lt; double &gt; &amp;, Vector&lt; double &gt; &amp;)</div><div class="ttdoc">Function pointer for function that computes vector-valued steady &quot;exact solution&quot;  as .</div><div class="ttdef"><b>Definition:</b> <a href="elements_8h_source.html#l01736">elements.h:1736</a></div></div>
<div class="ttc" id="aclassoomph_1_1WomersleyImpedanceTubeBase_html_a59aa99fe9771f53ee482218da67d87c7"><div class="ttname"><a href="classoomph_1_1WomersleyImpedanceTubeBase.html#a59aa99fe9771f53ee482218da67d87c7">oomph::WomersleyImpedanceTubeBase::womersley_problem_pt</a></div><div class="ttdeci">WomersleyProblem&lt; ELEMENT, DIM &gt; * womersley_problem_pt()</div><div class="ttdoc">Access to underlying Womersley problem.</div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l01350">womersley_elements.h:1350</a></div></div>
<div class="ttc" id="aclassoomph_1_1WomersleyEquations_html_a6b45d8a95f8f811e766fcf3466bfeb09"><div class="ttname"><a href="classoomph_1_1WomersleyEquations.html#a6b45d8a95f8f811e766fcf3466bfeb09">oomph::WomersleyEquations::interpolated_u_womersley</a></div><div class="ttdeci">double interpolated_u_womersley(const Vector&lt; double &gt; &amp;s) const</div><div class="ttdoc">Return FE representation of function value u(s) at local coordinate s.</div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l00410">womersley_elements.h:410</a></div></div>
<div class="ttc" id="aclassoomph_1_1WomersleyProblem_html_aa3b907c22d24bd76659a2f7c3b35c91a"><div class="ttname"><a href="classoomph_1_1WomersleyProblem.html#aa3b907c22d24bd76659a2f7c3b35c91a">oomph::WomersleyProblem::WomersleyProblem</a></div><div class="ttdeci">WomersleyProblem(double *re_st_pt, double *prescribed_volume_flux_pt, TimeStepper *time_stepper_pt, Mesh *womersley_mesh_pt)</div><div class="ttdoc">Constructor: Pass pointer to Womersley number, pointer to the double that stores the currently impose...</div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l00952">womersley_elements.h:952</a></div></div>
<div class="ttc" id="aclassoomph_1_1WomersleyImpedanceTubeBase_html_a3be3a17477e68ee912699b1cc8749ee7"><div class="ttname"><a href="classoomph_1_1WomersleyImpedanceTubeBase.html#a3be3a17477e68ee912699b1cc8749ee7">oomph::WomersleyImpedanceTubeBase::Length</a></div><div class="ttdeci">double Length</div><div class="ttdoc">Length of the tube.</div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l01485">womersley_elements.h:1485</a></div></div>
<div class="ttc" id="aclassoomph_1_1WomersleyImpedanceTubeBase_html_a59b41acf37d7bfce3c1a8676304915d7"><div class="ttname"><a href="classoomph_1_1WomersleyImpedanceTubeBase.html#a59b41acf37d7bfce3c1a8676304915d7">oomph::WomersleyImpedanceTubeBase::Navier_stokes_outflow_mesh_pt</a></div><div class="ttdeci">Mesh * Navier_stokes_outflow_mesh_pt</div><div class="ttdoc">Pointer to the mesh of NavierStokesImpedanceTractionElements that are attached to the outflow cross-s...</div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l01510">womersley_elements.h:1510</a></div></div>
<div class="ttc" id="aclassoomph_1_1NavierStokesImpedanceTractionElementBase_html"><div class="ttname"><a href="classoomph_1_1NavierStokesImpedanceTractionElementBase.html">oomph::NavierStokesImpedanceTractionElementBase</a></div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l00104">womersley_elements.h:104</a></div></div>
<div class="ttc" id="aclassoomph_1_1TimeStepper_html_a3939b77ec3578e4bd5b453c85649d631"><div class="ttname"><a href="classoomph_1_1TimeStepper.html#a3939b77ec3578e4bd5b453c85649d631">oomph::TimeStepper::ntstorage</a></div><div class="ttdeci">unsigned ntstorage() const</div><div class="ttdoc">Return the number of doubles required to represent history (one for steady)</div><div class="ttdef"><b>Definition:</b> <a href="timesteppers_8h_source.html#l00558">timesteppers.h:558</a></div></div>
<div class="ttc" id="aclassoomph_1_1ImposeFluxForWomersleyElement_html_ac7fc5594b9f38a3587f0cd798ff3dfb2"><div class="ttname"><a href="classoomph_1_1ImposeFluxForWomersleyElement.html#ac7fc5594b9f38a3587f0cd798ff3dfb2">oomph::ImposeFluxForWomersleyElement::ImposeFluxForWomersleyElement</a></div><div class="ttdeci">ImposeFluxForWomersleyElement(Mesh *womersley_mesh_pt, double *prescribed_flux_pt)</div><div class="ttdoc">Constructor: Pass pointer to mesh that contains the Womersley elements whose volume flux is controlle...</div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l00532">womersley_elements.h:532</a></div></div>
<div class="ttc" id="aclassoomph_1_1WomersleyEquations_html_a429ed0a68543a77c4182fa977ffe549c"><div class="ttname"><a href="classoomph_1_1WomersleyEquations.html#a429ed0a68543a77c4182fa977ffe549c">oomph::WomersleyEquations::operator=</a></div><div class="ttdeci">void operator=(const WomersleyEquations &amp;)</div><div class="ttdoc">Broken assignment operator.</div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l00223">womersley_elements.h:223</a></div></div>
<div class="ttc" id="aclassoomph_1_1WomersleyOutflowImpedanceTube_html_ab695df8342d00c65a16d79af35c49ad1"><div class="ttname"><a href="classoomph_1_1WomersleyOutflowImpedanceTube.html#ab695df8342d00c65a16d79af35c49ad1">oomph::WomersleyOutflowImpedanceTube::W_index</a></div><div class="ttdeci">unsigned W_index</div><div class="ttdoc">The velocity component (in terms of the nodal index) that represents the outflow component  the latt...</div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l01953">womersley_elements.h:1953</a></div></div>
<div class="ttc" id="aclassoomph_1_1NavierStokesImpedanceTractionElement_html_addae9a132e1004423ce501f71a84fe07"><div class="ttname"><a href="classoomph_1_1NavierStokesImpedanceTractionElement.html#addae9a132e1004423ce501f71a84fe07">oomph::NavierStokesImpedanceTractionElement::add_element_contribution_to_aux_integral</a></div><div class="ttdeci">void add_element_contribution_to_aux_integral(std::map&lt; unsigned, double &gt; *aux_integral_pt)</div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l02371">womersley_elements.h:2371</a></div></div>
<div class="ttc" id="aclassoomph_1_1Data_html"><div class="ttname"><a href="classoomph_1_1Data.html">oomph::Data</a></div><div class="ttdoc">A class that represents a collection of data; each Data object may contain many different individual ...</div><div class="ttdef"><b>Definition:</b> <a href="nodes_8h_source.html#l00085">nodes.h:85</a></div></div>
<div class="ttc" id="aclassoomph_1_1QWomersleyElement_html_ae15d32d03c1e64811cc29098c85d1e23"><div class="ttname"><a href="classoomph_1_1QWomersleyElement.html#ae15d32d03c1e64811cc29098c85d1e23">oomph::QWomersleyElement::output_fct</a></div><div class="ttdeci">void output_fct(std::ostream &amp;outfile, const unsigned &amp;n_plot, FiniteElement::SteadyExactSolutionFctPt exact_soln_pt)</div><div class="ttdoc">Output function for an exact solution: x,y,u_exact or x,y,z,u_exact at n_plot^DIM plot points.</div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l00720">womersley_elements.h:720</a></div></div>
<div class="ttc" id="aclassoomph_1_1WomersleyImpedanceTubeBase_html_a79e8b7fb0c3edb3956aef7cf7c8bf719"><div class="ttname"><a href="classoomph_1_1WomersleyImpedanceTubeBase.html#a79e8b7fb0c3edb3956aef7cf7c8bf719">oomph::WomersleyImpedanceTubeBase::WomersleyImpedanceTubeBase</a></div><div class="ttdeci">WomersleyImpedanceTubeBase(const double &amp;length, Mesh *navier_stokes_outflow_mesh_pt)</div><div class="ttdoc">Constructor: Specify length of tube and the pointer to the mesh of either NavierStokesImpedanceTracti...</div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l01152">womersley_elements.h:1152</a></div></div>
<div class="ttc" id="aclassoomph_1_1NetFluxControlElementForWomersleyPressureControl_html_a6b7c6f8529d0194db68ae1202c9fa100"><div class="ttname"><a href="classoomph_1_1NetFluxControlElementForWomersleyPressureControl.html#a6b7c6f8529d0194db68ae1202c9fa100">oomph::NetFluxControlElementForWomersleyPressureControl::~NetFluxControlElementForWomersleyPressureControl</a></div><div class="ttdeci">~NetFluxControlElementForWomersleyPressureControl()</div><div class="ttdoc">Empty Destructor - Data gets deleted automatically.</div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l02837">womersley_elements.h:2837</a></div></div>
<div class="ttc" id="aclassoomph_1_1WomersleyProblem_html_a54d5137eeb495e40382576392720611f"><div class="ttname"><a href="classoomph_1_1WomersleyProblem.html#a54d5137eeb495e40382576392720611f">oomph::WomersleyProblem::Prescribed_pressure_gradient_fct_pt</a></div><div class="ttdeci">PrescribedPressureGradientFctPt Prescribed_pressure_gradient_fct_pt</div><div class="ttdoc">Fct pointer to fct that prescribes pressure gradient.</div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l00858">womersley_elements.h:858</a></div></div>
<div class="ttc" id="aclassoomph_1_1NavierStokesWomersleyPressureControlElement_html_ad3293da10ac3a22cd70ae7c8c11980d9"><div class="ttname"><a href="classoomph_1_1NavierStokesWomersleyPressureControlElement.html#ad3293da10ac3a22cd70ae7c8c11980d9">oomph::NavierStokesWomersleyPressureControlElement::NavierStokesWomersleyPressureControlElement</a></div><div class="ttdeci">NavierStokesWomersleyPressureControlElement(TemplateFreeWomersleyImpedanceTubeBase *womersley_tube_pt)</div><div class="ttdoc">Constructor takes a pointer to a suitable Womersley impedance tube which defines the pressure via get...</div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l02658">womersley_elements.h:2658</a></div></div>
<div class="ttc" id="aclassoomph_1_1WomersleyOutflowImpedanceTube_html_a31655c396b473246a6a9840d789dc046"><div class="ttname"><a href="classoomph_1_1WomersleyOutflowImpedanceTube.html#a31655c396b473246a6a9840d789dc046">oomph::WomersleyOutflowImpedanceTube::build_mesh_and_apply_boundary_conditions</a></div><div class="ttdeci">Mesh * build_mesh_and_apply_boundary_conditions(TimeStepper *time_stepper_pt)</div><div class="ttdoc">Implement pure virtual fct (defined in the base class WomersleyImpedanceTubeBase) that builds the mes...</div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l01927">womersley_elements.h:1927</a></div></div>
<div class="ttc" id="aclassoomph_1_1FiniteElement_html_a9296c17b134688049256a4bbc886df69"><div class="ttname"><a href="classoomph_1_1FiniteElement.html#a9296c17b134688049256a4bbc886df69">oomph::FiniteElement::dshape_eulerian</a></div><div class="ttdeci">double dshape_eulerian(const Vector&lt; double &gt; &amp;s, Shape &amp;psi, DShape &amp;dpsidx) const</div><div class="ttdoc">Compute the geometric shape functions and also first derivatives w.r.t. global coordinates at local c...</div><div class="ttdef"><b>Definition:</b> <a href="elements_8cc_source.html#l03223">elements.cc:3223</a></div></div>
<div class="ttc" id="aclassoomph_1_1ImposeFluxForWomersleyElement_html"><div class="ttname"><a href="classoomph_1_1ImposeFluxForWomersleyElement.html">oomph::ImposeFluxForWomersleyElement</a></div><div class="ttdoc">Element to impose volume flux through collection of Womersley elements, in exchange for treating the ...</div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l00523">womersley_elements.h:523</a></div></div>
<div class="ttc" id="athe__data__structure_8txt_html_a0ca71de52c9f65466ea6eefc4f332736"><div class="ttname"><a href="the__data__structure_8txt.html#a0ca71de52c9f65466ea6eefc4f332736">i_global</a></div><div class="ttdeci">unsigned i_global</div><div class="ttdef"><b>Definition:</b> <a href="the__data__structure_8txt_source.html#l00391">the_data_structure.txt:391</a></div></div>
<div class="ttc" id="aclassoomph_1_1WomersleyEquations_html_ab317caeb41aefe218596c1ff1c39d40f"><div class="ttname"><a href="classoomph_1_1WomersleyEquations.html#ab317caeb41aefe218596c1ff1c39d40f">oomph::WomersleyEquations::output</a></div><div class="ttdeci">void output(FILE *file_pt)</div><div class="ttdoc">C_style output with default number of plot points.</div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l00319">womersley_elements.h:319</a></div></div>
<div class="ttc" id="aclassoomph_1_1TemplateFreeNavierStokesFluxControlElementBase_html"><div class="ttname"><a href="classoomph_1_1TemplateFreeNavierStokesFluxControlElementBase.html">oomph::TemplateFreeNavierStokesFluxControlElementBase</a></div><div class="ttdef"><b>Definition:</b> <a href="navier__stokes__flux__control__elements_8h_source.html#l00054">navier_stokes_flux_control_elements.h:54</a></div></div>
<div class="ttc" id="aclassoomph_1_1WomersleyEquations_html_a5aebac86c117c1cc99437d26686d000e"><div class="ttname"><a href="classoomph_1_1WomersleyEquations.html#a5aebac86c117c1cc99437d26686d000e">oomph::WomersleyEquations::fill_in_generic_residual_contribution_womersley</a></div><div class="ttdeci">virtual void fill_in_generic_residual_contribution_womersley(Vector&lt; double &gt; &amp;residuals, DenseMatrix&lt; double &gt; &amp;jacobian, unsigned flag)</div><div class="ttdoc">Compute element residual Vector only (if flag=and/or element Jacobian matrix</div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8cc_source.html#l00072">womersley_elements.cc:72</a></div></div>
<div class="ttc" id="aclassoomph_1_1ImposeFluxForWomersleyElement_html_a4c8079994c71ce43a36645c2b2dc4580"><div class="ttname"><a href="classoomph_1_1ImposeFluxForWomersleyElement.html#a4c8079994c71ce43a36645c2b2dc4580">oomph::ImposeFluxForWomersleyElement::Pressure_gradient_data_pt</a></div><div class="ttdeci">Data * Pressure_gradient_data_pt</div><div class="ttdoc">Data item whose one and only value contains the pressure gradient.</div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l00638">womersley_elements.h:638</a></div></div>
<div class="ttc" id="aclassoomph_1_1NavierStokesImpedanceTractionElementBase_html_add9c7ae3f33b8e03805c256daf038ab4"><div class="ttname"><a href="classoomph_1_1NavierStokesImpedanceTractionElementBase.html#add9c7ae3f33b8e03805c256daf038ab4">oomph::NavierStokesImpedanceTractionElementBase::set_impedance_tube_pt</a></div><div class="ttdeci">virtual void set_impedance_tube_pt(TemplateFreeWomersleyImpedanceTubeBase *impedance_tube_pt)=0</div><div class="ttdoc">Pass the pointer to the &quot;impedance tube&quot; that computes the flow resistance via the solution of Womers...</div></div>
<div class="ttc" id="aclassoomph_1_1NavierStokesImpedanceTractionElementBase_html_a5879757e9fd1c596fa2bb60321c97270"><div class="ttname"><a href="classoomph_1_1NavierStokesImpedanceTractionElementBase.html#a5879757e9fd1c596fa2bb60321c97270">oomph::NavierStokesImpedanceTractionElementBase::NavierStokesImpedanceTractionElementBase</a></div><div class="ttdeci">NavierStokesImpedanceTractionElementBase()</div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l00110">womersley_elements.h:110</a></div></div>
<div class="ttc" id="aclassoomph_1_1WomersleyImpedanceTubeBase_html_a64f2f3eeb09a5637b32661baab3ac1e4"><div class="ttname"><a href="classoomph_1_1WomersleyImpedanceTubeBase.html#a64f2f3eeb09a5637b32661baab3ac1e4">oomph::WomersleyImpedanceTubeBase::precompute_aux_integrals</a></div><div class="ttdeci">void precompute_aux_integrals()</div><div class="ttdoc">Precompute auxiliary integrals required for the computation of the Jacobian in the NavierStokesImpeda...</div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l01450">womersley_elements.h:1450</a></div></div>
<div class="ttc" id="aclassoomph_1_1QWomersleyElement_html_af95b3c5a12638d2bfcc97435a987f8cf"><div class="ttname"><a href="classoomph_1_1QWomersleyElement.html#af95b3c5a12638d2bfcc97435a987f8cf">oomph::QWomersleyElement::operator=</a></div><div class="ttdeci">void operator=(const QWomersleyElement&lt; DIM, NNODE_1D &gt; &amp;)</div><div class="ttdoc">Broken assignment operator.</div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l00683">womersley_elements.h:683</a></div></div>
<div class="ttc" id="aclassoomph_1_1LinearAlgebraDistribution_html"><div class="ttname"><a href="classoomph_1_1LinearAlgebraDistribution.html">oomph::LinearAlgebraDistribution</a></div><div class="ttdoc">Describes the distribution of a distributable linear algebra type object. Typically this is a contain...</div><div class="ttdef"><b>Definition:</b> <a href="linear__algebra__distribution_8h_source.html#l00064">linear_algebra_distribution.h:64</a></div></div>
<div class="ttc" id="aclassoomph_1_1TemplateFreeWomersleyImpedanceTubeBase_html_a37b438da1f862ccadbdb80cf8258a781"><div class="ttname"><a href="classoomph_1_1TemplateFreeWomersleyImpedanceTubeBase.html#a37b438da1f862ccadbdb80cf8258a781">oomph::TemplateFreeWomersleyImpedanceTubeBase::Zero</a></div><div class="ttdeci">static double Zero</div><div class="ttdoc">Zero!</div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l00085">womersley_elements.h:85</a></div></div>
<div class="ttc" id="aclassoomph_1_1ImposeFluxForWomersleyElement_html_aa6b7bb4b9d527576ca8ee16918d0cbb4"><div class="ttname"><a href="classoomph_1_1ImposeFluxForWomersleyElement.html#aa6b7bb4b9d527576ca8ee16918d0cbb4">oomph::ImposeFluxForWomersleyElement::Womersley_mesh_pt</a></div><div class="ttdeci">Mesh * Womersley_mesh_pt</div><div class="ttdoc">Pointer to mesh that contains the Womersley elements.</div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l00634">womersley_elements.h:634</a></div></div>
<div class="ttc" id="aclassoomph_1_1Mesh_html"><div class="ttname"><a href="classoomph_1_1Mesh.html">oomph::Mesh</a></div><div class="ttdoc">A general mesh class.</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8h_source.html#l00070">mesh.h:70</a></div></div>
<div class="ttc" id="aclassoomph_1_1QWomersleyElement_html_a31a20c3d89a4bc5698c81e01ca22dc8d"><div class="ttname"><a href="classoomph_1_1QWomersleyElement.html#a31a20c3d89a4bc5698c81e01ca22dc8d">oomph::QWomersleyElement::required_nvalue</a></div><div class="ttdeci">unsigned required_nvalue(const unsigned &amp;n) const</div><div class="ttdoc">Required # of values (pinned or dofs) at node n.</div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l00690">womersley_elements.h:690</a></div></div>
<div class="ttc" id="aclassoomph_1_1WomersleyEquations_html_a4db194b9f71a69779b3450d40288b55d"><div class="ttname"><a href="classoomph_1_1WomersleyEquations.html#a4db194b9f71a69779b3450d40288b55d">oomph::WomersleyEquations::re_st</a></div><div class="ttdeci">const double &amp; re_st() const</div><div class="ttdoc">Product of Reynolds and Strouhal number (=Womersley number)</div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l00254">womersley_elements.h:254</a></div></div>
<div class="ttc" id="aclassoomph_1_1NavierStokesImpedanceTractionElementBase_html_a4ce2150b59ff999c24e623b645f1c899"><div class="ttname"><a href="classoomph_1_1NavierStokesImpedanceTractionElementBase.html#a4ce2150b59ff999c24e623b645f1c899">oomph::NavierStokesImpedanceTractionElementBase::add_element_contribution_to_aux_integral</a></div><div class="ttdeci">virtual void add_element_contribution_to_aux_integral(std::map&lt; unsigned, double &gt; *aux_integral_pt)=0</div><div class="ttdoc">Add the element's contribution to the auxiliary integral used in the element's Jacobian....</div></div>
<div class="ttc" id="aclassoomph_1_1QWomersleyElement_html_aedac8e0c2b41e446b7c835731b179255"><div class="ttname"><a href="classoomph_1_1QWomersleyElement.html#aedac8e0c2b41e446b7c835731b179255">oomph::QWomersleyElement::output</a></div><div class="ttdeci">void output(FILE *file_pt, const unsigned &amp;n_plot)</div><div class="ttdoc">C-style output function:   x,y,u or x,y,z,u at n_plot^DIM plot points.</div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l00714">womersley_elements.h:714</a></div></div>
<div class="ttc" id="aclassoomph_1_1WomersleyEquations_html_ab04034e44e876ea9935a4ae102c34ce9"><div class="ttname"><a href="classoomph_1_1WomersleyEquations.html#ab04034e44e876ea9935a4ae102c34ce9">oomph::WomersleyEquations::get_volume_flux</a></div><div class="ttdeci">double get_volume_flux()</div><div class="ttdoc">Compute total volume flux through element.</div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8cc_source.html#l00232">womersley_elements.cc:232</a></div></div>
<div class="ttc" id="aclassoomph_1_1NavierStokesImpedanceTractionElement_html"><div class="ttname"><a href="classoomph_1_1NavierStokesImpedanceTractionElement.html">oomph::NavierStokesImpedanceTractionElement</a></div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l02052">womersley_elements.h:2052</a></div></div>
<div class="ttc" id="anamespaceoomph_1_1TerminateHelper_html_a38ec1b047a4438b6eba8a21b669c229d"><div class="ttname"><a href="namespaceoomph_1_1TerminateHelper.html#a38ec1b047a4438b6eba8a21b669c229d">oomph::TerminateHelper::setup</a></div><div class="ttdeci">void setup()</div><div class="ttdoc">Setup terminate helper.</div><div class="ttdef"><b>Definition:</b> <a href="oomph__definitions_8cc_source.html#l00067">oomph_definitions.cc:67</a></div></div>
<div class="ttc" id="aclassoomph_1_1Data_html_a7e67fc78a2e8a2fd6eb75bd292d42ff8"><div class="ttname"><a href="classoomph_1_1Data.html#a7e67fc78a2e8a2fd6eb75bd292d42ff8">oomph::Data::nvalue</a></div><div class="ttdeci">unsigned nvalue() const</div><div class="ttdoc">Return number of values stored in data object (incl pinned ones).</div><div class="ttdef"><b>Definition:</b> <a href="nodes_8h_source.html#l00444">nodes.h:444</a></div></div>
<div class="ttc" id="aclassoomph_1_1DenseMatrix_html"><div class="ttname"><a href="classoomph_1_1DenseMatrix.html">oomph::DenseMatrix&lt; double &gt;</a></div></div>
<div class="ttc" id="aclassoomph_1_1RefineableElement_html"><div class="ttname"><a href="classoomph_1_1RefineableElement.html">oomph::RefineableElement</a></div><div class="ttdef"><b>Definition:</b> <a href="refineable__elements_8h_source.html#l00097">refineable_elements.h:97</a></div></div>
<div class="ttc" id="aclassoomph_1_1WomersleyProblem_html_a248ab44d5058e1e29dab4fbfc52bf942"><div class="ttname"><a href="classoomph_1_1WomersleyProblem.html#a248ab44d5058e1e29dab4fbfc52bf942">oomph::WomersleyProblem::actions_after_newton_solve</a></div><div class="ttdeci">void actions_after_newton_solve()</div><div class="ttdoc">Update the problem specs after solve (empty)</div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l00808">womersley_elements.h:808</a></div></div>
<div class="ttc" id="aclassoomph_1_1NavierStokesImpedanceTractionElementBase_html_a648cfcbd9bf1f3404b0e7f184cecdc62"><div class="ttname"><a href="classoomph_1_1NavierStokesImpedanceTractionElementBase.html#a648cfcbd9bf1f3404b0e7f184cecdc62">oomph::NavierStokesImpedanceTractionElementBase::set_external_data_from_navier_stokes_outflow_mesh</a></div><div class="ttdeci">virtual void set_external_data_from_navier_stokes_outflow_mesh(Mesh *navier_stokes_outflow_mesh_pt_mesh_pt)=0</div><div class="ttdoc">Pass the pointer to the mesh containing all NavierStokesImpedanceTractionElements that contribute to ...</div></div>
<div class="ttc" id="aclassoomph_1_1NavierStokesImpedanceTractionElement_html_abd5db43a552949e7d2ab4c1c25a68e96"><div class="ttname"><a href="classoomph_1_1NavierStokesImpedanceTractionElement.html#abd5db43a552949e7d2ab4c1c25a68e96">oomph::NavierStokesImpedanceTractionElement::set_aux_integral_pt</a></div><div class="ttdeci">void set_aux_integral_pt(std::map&lt; unsigned, double &gt; *aux_integral_pt)</div><div class="ttdoc">Set pointer to the precomputed auxiliary integral that contains the derivative of the total volume fl...</div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l02319">womersley_elements.h:2319</a></div></div>
<div class="ttc" id="aclassoomph_1_1WomersleyEquations_html_a5dccff3c238209806fefdebbbef91756"><div class="ttname"><a href="classoomph_1_1WomersleyEquations.html#a5dccff3c238209806fefdebbbef91756">oomph::WomersleyEquations::get_flux</a></div><div class="ttdeci">void get_flux(const Vector&lt; double &gt; &amp;s, Vector&lt; double &gt; &amp;flux) const</div><div class="ttdoc">Get flux: flux[i] = du/dx_i.</div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l00360">womersley_elements.h:360</a></div></div>
<div class="ttc" id="aclassoomph_1_1WomersleyOutflowImpedanceTube_html_aaed332bd590c1d300cd796a799ae9db8"><div class="ttname"><a href="classoomph_1_1WomersleyOutflowImpedanceTube.html#aaed332bd590c1d300cd796a799ae9db8">oomph::WomersleyOutflowImpedanceTube::Fixed_coordinate</a></div><div class="ttdeci">unsigned Fixed_coordinate</div><div class="ttdoc">The coordinate (in the higher-dimensional Navier-Stokes mesh) that is constant in the outflow cross-s...</div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l01947">womersley_elements.h:1947</a></div></div>
<div class="ttc" id="aclassoomph_1_1NavierStokesWomersleyPressureControlElement_html"><div class="ttname"><a href="classoomph_1_1NavierStokesWomersleyPressureControlElement.html">oomph::NavierStokesWomersleyPressureControlElement</a></div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l02651">womersley_elements.h:2651</a></div></div>
<div class="ttc" id="aclassoomph_1_1WomersleyEquations_html_a6012a6010fc26e347214492f6c590e74"><div class="ttname"><a href="classoomph_1_1WomersleyEquations.html#a6012a6010fc26e347214492f6c590e74">oomph::WomersleyEquations::du_dt_womersley</a></div><div class="ttdeci">double du_dt_womersley(const unsigned &amp;n) const</div><div class="ttdoc">du/dt at local node n. Uses suitably interpolated value for hanging nodes.</div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l00273">womersley_elements.h:273</a></div></div>
<div class="ttc" id="aclassoomph_1_1NavierStokesImpedanceTractionElement_html_a59864479b537aae999dceaa38e8856ef"><div class="ttname"><a href="classoomph_1_1NavierStokesImpedanceTractionElement.html#a59864479b537aae999dceaa38e8856ef">oomph::NavierStokesImpedanceTractionElement::fill_in_contribution_to_residuals</a></div><div class="ttdeci">void fill_in_contribution_to_residuals(Vector&lt; double &gt; &amp;residuals)</div><div class="ttdoc">Fill in the element's contribution to the element's residual vector.</div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l02438">womersley_elements.h:2438</a></div></div>
<div class="ttc" id="aclassoomph_1_1NavierStokesImpedanceTractionElement_html_a15020b8235206fc52d2fcf967e471904"><div class="ttname"><a href="classoomph_1_1NavierStokesImpedanceTractionElement.html#a15020b8235206fc52d2fcf967e471904">oomph::NavierStokesImpedanceTractionElement::Aux_integral_pt</a></div><div class="ttdeci">std::map&lt; unsigned, double &gt; * Aux_integral_pt</div><div class="ttdoc">Pointer to auxiliary integral, containing the derivative of the total volume flux through the outflow...</div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l02064">womersley_elements.h:2064</a></div></div>
<div class="ttc" id="acfortran_8h_html_af6f0bd3dc13317f895c91323c25c2b8f"><div class="ttname"><a href="cfortran_8h.html#af6f0bd3dc13317f895c91323c25c2b8f">t</a></div><div class="ttdeci">char t</div><div class="ttdef"><b>Definition:</b> <a href="cfortran_8h_source.html#l00568">cfortran.h:568</a></div></div>
<div class="ttc" id="aclassoomph_1_1QWomersleyElement_html_a5c4db93fb861995c7910ffe44751f449"><div class="ttname"><a href="classoomph_1_1QWomersleyElement.html#a5c4db93fb861995c7910ffe44751f449">oomph::QWomersleyElement::dshape_and_dtest_eulerian_at_knot_womersley</a></div><div class="ttdeci">double dshape_and_dtest_eulerian_at_knot_womersley(const unsigned &amp;ipt, Shape &amp;psi, DShape &amp;dpsidx, Shape &amp;test, DShape &amp;dtestdx) const</div><div class="ttdoc">Shape/test functions and derivs w.r.t. to global coords at integration point ipt; return Jacobian of ...</div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l01574">womersley_elements.h:1574</a></div></div>
<div class="ttc" id="aclassoomph_1_1WomersleyImpedanceTubeBase_html_a912ef51e8ac9c44e80566126da7d591f"><div class="ttname"><a href="classoomph_1_1WomersleyImpedanceTubeBase.html#a912ef51e8ac9c44e80566126da7d591f">oomph::WomersleyImpedanceTubeBase::setup</a></div><div class="ttdeci">void setup(double *re_st_pt, const double &amp;dt, const double &amp;q_initial, TimeStepper *time_stepper_pt=0)</div><div class="ttdoc">Set up the Womersley tubes so that a subsequent call to get_response(...) computes the inlet pressure...</div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l01254">womersley_elements.h:1254</a></div></div>
<div class="ttc" id="aclassoomph_1_1QWomersleyElement_html_ae91c242198d9b4683a446f711e6acd4b"><div class="ttname"><a href="classoomph_1_1QWomersleyElement.html#ae91c242198d9b4683a446f711e6acd4b">oomph::QWomersleyElement::Initial_Nvalue</a></div><div class="ttdeci">static const unsigned Initial_Nvalue</div><div class="ttdoc">Static array of ints to hold number of variables at nodes: Initial_Nvalue[n].</div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l00666">womersley_elements.h:666</a></div></div>
<div class="ttc" id="anamespaceoomph_1_1QuadTreeNames_html_a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6"><div class="ttname"><a href="namespaceoomph_1_1QuadTreeNames.html#a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6">oomph::QuadTreeNames::W</a></div><div class="ttdeci">@ W</div><div class="ttdef"><b>Definition:</b> <a href="quadtree_8h_source.html#l00056">quadtree.h:56</a></div></div>
<div class="ttc" id="aclassoomph_1_1FaceGeometry_3_01QWomersleyElement_3_01DIM_00_01NNODE__1D_01_4_01_4_html_ad9f21ddf6af09368e24e8d5ac74babcc"><div class="ttname"><a href="classoomph_1_1FaceGeometry_3_01QWomersleyElement_3_01DIM_00_01NNODE__1D_01_4_01_4.html#ad9f21ddf6af09368e24e8d5ac74babcc">oomph::FaceGeometry&lt; QWomersleyElement&lt; DIM, NNODE_1D &gt; &gt;::FaceGeometry</a></div><div class="ttdeci">FaceGeometry()</div><div class="ttdoc">Constructor: Call the constructor for the appropriate lower-dimensional QElement.</div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l01614">womersley_elements.h:1614</a></div></div>
<div class="ttc" id="anamespaceoomph_1_1BrokenCopy_html_a7e5cd7fda8b8c790003151bee77a84ac"><div class="ttname"><a href="namespaceoomph_1_1BrokenCopy.html#a7e5cd7fda8b8c790003151bee77a84ac">oomph::BrokenCopy::broken_copy</a></div><div class="ttdeci">void broken_copy(const std::string &amp;class_name)</div><div class="ttdoc">Issue error message and terminate execution.</div><div class="ttdef"><b>Definition:</b> <a href="oomph__utilities_8cc_source.html#l00214">oomph_utilities.cc:214</a></div></div>
<div class="ttc" id="aclassoomph_1_1WomersleyEquations_html_aed4568c1736e6027eb111d090b4cb5e9"><div class="ttname"><a href="classoomph_1_1WomersleyEquations.html#aed4568c1736e6027eb111d090b4cb5e9">oomph::WomersleyEquations::WomersleyEquations</a></div><div class="ttdeci">WomersleyEquations(const WomersleyEquations &amp;dummy)</div><div class="ttdoc">Broken copy constructor.</div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l00216">womersley_elements.h:216</a></div></div>
<div class="ttc" id="aclassoomph_1_1Data_html_a422231c58e423f0b43822827aa334d79"><div class="ttname"><a href="classoomph_1_1Data.html#a422231c58e423f0b43822827aa334d79">oomph::Data::pin</a></div><div class="ttdeci">void pin(const unsigned &amp;i)</div><div class="ttdoc">Pin the i-th stored variable.</div><div class="ttdef"><b>Definition:</b> <a href="nodes_8h_source.html#l00379">nodes.h:379</a></div></div>
<div class="ttc" id="aclassoomph_1_1ImposeFluxForWomersleyElement_html_a77a13b7dad46eaf222164be9a62b0269"><div class="ttname"><a href="classoomph_1_1ImposeFluxForWomersleyElement.html#a77a13b7dad46eaf222164be9a62b0269">oomph::ImposeFluxForWomersleyElement::pressure_gradient_data_pt</a></div><div class="ttdeci">Data * pressure_gradient_data_pt()</div><div class="ttdoc">Read-only access to the single-valued Data item that stores the pressure gradient (to be determined v...</div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l00569">womersley_elements.h:569</a></div></div>
<div class="ttc" id="anamespaceoomph_1_1OneDimLagrange_html_a117f8b892dc89989ecdad99ff261e120"><div class="ttname"><a href="namespaceoomph_1_1OneDimLagrange.html#a117f8b892dc89989ecdad99ff261e120">oomph::OneDimLagrange::shape</a></div><div class="ttdeci">void shape(const double &amp;s, double *Psi)</div><div class="ttdoc">Definition for 1D Lagrange shape functions. The value of all the shape functions at the local coordin...</div><div class="ttdef"><b>Definition:</b> <a href="shape_8h_source.html#l00545">shape.h:545</a></div></div>
<div class="ttc" id="aclassoomph_1_1WomersleyEquations_html_af6aa8745284573bf740816c394fa5437"><div class="ttname"><a href="classoomph_1_1WomersleyEquations.html#af6aa8745284573bf740816c394fa5437">oomph::WomersleyEquations::ReSt_pt</a></div><div class="ttdeci">double * ReSt_pt</div><div class="ttdoc">Pointer to global Reynolds number x Strouhal number (=Womersley)</div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l00473">womersley_elements.h:473</a></div></div>
<div class="ttc" id="aclassoomph_1_1Node_html_a056f8e82da938369cd38541c5cdc598a"><div class="ttname"><a href="classoomph_1_1Node.html#a056f8e82da938369cd38541c5cdc598a">oomph::Node::x</a></div><div class="ttdeci">double &amp; x(const unsigned &amp;i)</div><div class="ttdoc">Return the i-th nodal coordinate.</div><div class="ttdef"><b>Definition:</b> <a href="nodes_8h_source.html#l00990">nodes.h:990</a></div></div>
<div class="ttc" id="aclassoomph_1_1NavierStokesImpedanceTractionElement_html_a6d3191bb5be1c304b71e24140017eab5"><div class="ttname"><a href="classoomph_1_1NavierStokesImpedanceTractionElement.html#a6d3191bb5be1c304b71e24140017eab5">oomph::NavierStokesImpedanceTractionElement::NavierStokesImpedanceTractionElement</a></div><div class="ttdeci">NavierStokesImpedanceTractionElement(FiniteElement *const &amp;element_pt, const int &amp;face_index)</div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l02113">womersley_elements.h:2113</a></div></div>
<div class="ttc" id="aclassoomph_1_1NavierStokesImpedanceTractionElementBase_html_ac9583fd74bc1bb57101bce20fffa39d3"><div class="ttname"><a href="classoomph_1_1NavierStokesImpedanceTractionElementBase.html#ac9583fd74bc1bb57101bce20fffa39d3">oomph::NavierStokesImpedanceTractionElementBase::set_aux_integral_pt</a></div><div class="ttdeci">virtual void set_aux_integral_pt(std::map&lt; unsigned, double &gt; *aux_integral_pt)=0</div><div class="ttdoc">Pass the pointer to the pre-computed auxiliary integral to the element so it can be accessed when com...</div></div>
<div class="ttc" id="aclassoomph_1_1GeomObject_html_a3c92023891dd4a0e818022f467eeb7f1"><div class="ttname"><a href="classoomph_1_1GeomObject.html#a3c92023891dd4a0e818022f467eeb7f1">oomph::GeomObject::time_stepper_pt</a></div><div class="ttdeci">TimeStepper *&amp; time_stepper_pt()</div><div class="ttdoc">Access function for pointer to time stepper: Null if object is not time-dependent.</div><div class="ttdef"><b>Definition:</b> <a href="geom__objects_8h_source.html#l00193">geom_objects.h:193</a></div></div>
<div class="ttc" id="athe__data__structure_8txt_html_ae789c4a233fe5f1aa45cf1f92efdf494"><div class="ttname"><a href="the__data__structure_8txt.html#ae789c4a233fe5f1aa45cf1f92efdf494">Data</a></div><div class="ttdeci">c Data can also store a certain number of c Data stores a pointer to a c TimeStepper whose member functions relate the history values to the values time derivatives pointer based read write access to the c Data values is provided by the functions code and by code Data::value_pt(t, i) \endcode which returns a pointer to the \c t -th history value associated with value \c i. Read-only access is also provided by the functions \code Data and its time dependent counterpart code whereas the values associated with t correspond to history values In many but this is not guaranteed See the section ref timestepping for further details subsection nodes Nodes In FE all c Nodes in a finite element mesh have c Data associated with them c Nodes are therefore derived from c Data</div><div class="ttdef"><b>Definition:</b> <a href="the__data__structure_8txt_source.html#l00148">the_data_structure.txt:148</a></div></div>
<div class="ttc" id="aclassoomph_1_1TimeStepper_html"><div class="ttname"><a href="classoomph_1_1TimeStepper.html">oomph::TimeStepper</a></div><div class="ttdoc">Base class for time-stepping schemes. Timestepper provides an approximation of the temporal derivativ...</div><div class="ttdef"><b>Definition:</b> <a href="timesteppers_8h_source.html#l00215">timesteppers.h:215</a></div></div>
<div class="ttc" id="aclassoomph_1_1WomersleyImpedanceTubeBase_html_ad5796e64a6f25944dc9be6489149f513"><div class="ttname"><a href="classoomph_1_1WomersleyImpedanceTubeBase.html#ad5796e64a6f25944dc9be6489149f513">oomph::WomersleyImpedanceTubeBase::shift_time_values</a></div><div class="ttdeci">void shift_time_values(const double &amp;dt)</div><div class="ttdoc">Shift history values to allow coputation of next timestep. Note: When used with a full Navier-Stokes ...</div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l01360">womersley_elements.h:1360</a></div></div>
<div class="ttc" id="aclassoomph_1_1WomersleyMesh_html"><div class="ttname"><a href="classoomph_1_1WomersleyMesh.html">oomph::WomersleyMesh</a></div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l01671">womersley_elements.h:1671</a></div></div>
<div class="ttc" id="aclassoomph_1_1GeneralisedElement_html"><div class="ttname"><a href="classoomph_1_1GeneralisedElement.html">oomph::GeneralisedElement</a></div><div class="ttdoc">A Generalised Element class.</div><div class="ttdef"><b>Definition:</b> <a href="elements_8h_source.html#l00072">elements.h:72</a></div></div>
<div class="ttc" id="aclassoomph_1_1GeneralisedElement_html_a4bff11b8ff97aefabb2df41e61e1779f"><div class="ttname"><a href="classoomph_1_1GeneralisedElement.html#a4bff11b8ff97aefabb2df41e61e1779f">oomph::GeneralisedElement::Dummy_matrix</a></div><div class="ttdeci">static DenseMatrix&lt; double &gt; Dummy_matrix</div><div class="ttdoc">Empty dense matrix used as a dummy argument to combined residual and jacobian functions in the case w...</div><div class="ttdef"><b>Definition:</b> <a href="elements_8h_source.html#l00224">elements.h:224</a></div></div>
<div class="ttc" id="aclassoomph_1_1NavierStokesImpedanceTractionElementBase_html_a3162972ba2dfdff8bbae08f27efaf132"><div class="ttname"><a href="classoomph_1_1NavierStokesImpedanceTractionElementBase.html#a3162972ba2dfdff8bbae08f27efaf132">oomph::NavierStokesImpedanceTractionElementBase::~NavierStokesImpedanceTractionElementBase</a></div><div class="ttdeci">virtual ~NavierStokesImpedanceTractionElementBase()</div><div class="ttdoc">Empty vitual destructor.</div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l00113">womersley_elements.h:113</a></div></div>
<div class="ttc" id="aclassoomph_1_1WomersleyOutflowImpedanceTube_html_a43c6028b6a11ae3c73b26271f0176c58"><div class="ttname"><a href="classoomph_1_1WomersleyOutflowImpedanceTube.html#a43c6028b6a11ae3c73b26271f0176c58">oomph::WomersleyOutflowImpedanceTube::WomersleyOutflowImpedanceTube</a></div><div class="ttdeci">WomersleyOutflowImpedanceTube(const double &amp;length, Mesh *navier_stokes_outflow_mesh_pt, const unsigned &amp;fixed_coordinate, const unsigned &amp;w_index)</div><div class="ttdoc">Constructor: Pass length and mesh of face elements that are attached to the outflow cross-section of ...</div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l01913">womersley_elements.h:1913</a></div></div>
<div class="ttc" id="aclassoomph_1_1FiniteElement_html_ad4ecf2b61b158a4b4d351a60d23c633e"><div class="ttname"><a href="classoomph_1_1FiniteElement.html#ad4ecf2b61b158a4b4d351a60d23c633e">oomph::FiniteElement::UnsteadyExactSolutionFctPt</a></div><div class="ttdeci">void(* UnsteadyExactSolutionFctPt)(const double &amp;, const Vector&lt; double &gt; &amp;, Vector&lt; double &gt; &amp;)</div><div class="ttdoc">Function pointer for function that computes Vector-valued time-dependent function  as .</div><div class="ttdef"><b>Definition:</b> <a href="elements_8h_source.html#l01742">elements.h:1742</a></div></div>
<div class="ttc" id="aclassoomph_1_1Node_html_af0e6237dfafad62cf427ff5013ddcfef"><div class="ttname"><a href="classoomph_1_1Node.html#af0e6237dfafad62cf427ff5013ddcfef">oomph::Node::is_hanging</a></div><div class="ttdeci">bool is_hanging() const</div><div class="ttdoc">Test whether the node is geometrically hanging.</div><div class="ttdef"><b>Definition:</b> <a href="nodes_8h_source.html#l01202">nodes.h:1202</a></div></div>
<div class="ttc" id="aclassoomph_1_1TemplateFreeWomersleyImpedanceTubeBase_html_a534a6daaac837e88cdb05961c90d636b"><div class="ttname"><a href="classoomph_1_1TemplateFreeWomersleyImpedanceTubeBase.html#a534a6daaac837e88cdb05961c90d636b">oomph::TemplateFreeWomersleyImpedanceTubeBase::~TemplateFreeWomersleyImpedanceTubeBase</a></div><div class="ttdeci">virtual ~TemplateFreeWomersleyImpedanceTubeBase()</div><div class="ttdoc">Empty virtual destructor.</div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l00070">womersley_elements.h:70</a></div></div>
<div class="ttc" id="aclassoomph_1_1WomersleyProblem_html_a648496a026e53b453e16c161f9f44434"><div class="ttname"><a href="classoomph_1_1WomersleyProblem.html#a648496a026e53b453e16c161f9f44434">oomph::WomersleyProblem::pressure_gradient_data_pt</a></div><div class="ttdeci">Data * pressure_gradient_data_pt()</div><div class="ttdoc">Access function to the single-valued Data object that contains the unknown pressure gradient (used if...</div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l00842">womersley_elements.h:842</a></div></div>
<div class="ttc" id="aclassoomph_1_1ImposeFluxForWomersleyElement_html_a6109bae3e5eb55b567e7ea85fca10884"><div class="ttname"><a href="classoomph_1_1ImposeFluxForWomersleyElement.html#a6109bae3e5eb55b567e7ea85fca10884">oomph::ImposeFluxForWomersleyElement::get_residuals</a></div><div class="ttdeci">void get_residuals(Vector&lt; double &gt; &amp;residuals)</div><div class="ttdoc">Compute residual vector: the volume flux constraint determines this element's one-and-only internal D...</div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l00598">womersley_elements.h:598</a></div></div>
<div class="ttc" id="aclassoomph_1_1WomersleyEquations_html_a9c1246d883f937888bf052b7078aee9a"><div class="ttname"><a href="classoomph_1_1WomersleyEquations.html#a9c1246d883f937888bf052b7078aee9a">oomph::WomersleyEquations::output</a></div><div class="ttdeci">void output(std::ostream &amp;outfile)</div><div class="ttdoc">Output with default number of plot points.</div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l00301">womersley_elements.h:301</a></div></div>
<div class="ttc" id="aclassoomph_1_1WomersleyImpedanceTubeBase_html_ae7d57d4ab999bc30db552a265fbadf92"><div class="ttname"><a href="classoomph_1_1WomersleyImpedanceTubeBase.html#ae7d57d4ab999bc30db552a265fbadf92">oomph::WomersleyImpedanceTubeBase::Prescribed_volume_flux_fct_pt</a></div><div class="ttdeci">PrescribedVolumeFluxFctPt Prescribed_volume_flux_fct_pt</div><div class="ttdoc">Pointer to function that specifies the prescribed volume flux.</div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l01505">womersley_elements.h:1505</a></div></div>
<div class="ttc" id="aclassoomph_1_1WomersleyProblem_html_af87f80658aaadaee2d7c8d0c06ad159e"><div class="ttname"><a href="classoomph_1_1WomersleyProblem.html#af87f80658aaadaee2d7c8d0c06ad159e">oomph::WomersleyProblem::actions_before_implicit_timestep</a></div><div class="ttdeci">void actions_before_implicit_timestep()</div><div class="ttdoc">Update the problem specs before next timestep: Update time-varying pressure gradient (if prescribed)</div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l00816">womersley_elements.h:816</a></div></div>
<div class="ttc" id="aclassoomph_1_1NavierStokesImpedanceTractionElement_html_a3be6b5b3152e35c76339a5de6ec1e93a"><div class="ttname"><a href="classoomph_1_1NavierStokesImpedanceTractionElement.html#a3be6b5b3152e35c76339a5de6ec1e93a">oomph::NavierStokesImpedanceTractionElement::zeta_nodal</a></div><div class="ttdeci">double zeta_nodal(const unsigned &amp;n, const unsigned &amp;k, const unsigned &amp;i) const</div><div class="ttdoc">The &quot;global&quot; intrinsic coordinate of the element when viewed as part of a geometric object should be ...</div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l02462">womersley_elements.h:2462</a></div></div>
<div class="ttc" id="aclassoomph_1_1NetFluxControlElementForWomersleyPressureControl_html_a63f6761cad384044fae2c8339422c9df"><div class="ttname"><a href="classoomph_1_1NetFluxControlElementForWomersleyPressureControl.html#a63f6761cad384044fae2c8339422c9df">oomph::NetFluxControlElementForWomersleyPressureControl::get_dof_numbers_for_unknowns</a></div><div class="ttdeci">void get_dof_numbers_for_unknowns(std::list&lt; std::pair&lt; unsigned long, unsigned &gt; &gt; &amp;dof_lookup_list) const</div><div class="ttdoc">Create a list of pairs for all unknowns in this element, so that the first entry in each pair contain...</div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l02870">womersley_elements.h:2870</a></div></div>
<div class="ttc" id="aclassoomph_1_1NetFluxControlElementForWomersleyPressureControl_html_a538b22e5aceecf140d03e400a8848a33"><div class="ttname"><a href="classoomph_1_1NetFluxControlElementForWomersleyPressureControl.html#a538b22e5aceecf140d03e400a8848a33">oomph::NetFluxControlElementForWomersleyPressureControl::ndof_types</a></div><div class="ttdeci">unsigned ndof_types() const</div><div class="ttdoc">The number of &quot;DOF types&quot; that degrees of freedom in this element are sub-divided into - set to 1.</div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l02859">womersley_elements.h:2859</a></div></div>
<div class="ttc" id="anamespaceoomph_html"><div class="ttname"><a href="namespaceoomph.html">oomph</a></div><div class="ttdoc">DRAIG: Change all instances of (SPATIAL_DIM) to (DIM-1).</div><div class="ttdef"><b>Definition:</b> <a href="advection__diffusion__elements_8cc_source.html#l00029">advection_diffusion_elements.cc:29</a></div></div>
<div class="ttc" id="aclassoomph_1_1ImposeFluxForWomersleyElement_html_a9e3ca0a6477d9d4bb89d726f4e0f07b1"><div class="ttname"><a href="classoomph_1_1ImposeFluxForWomersleyElement.html#a9e3ca0a6477d9d4bb89d726f4e0f07b1">oomph::ImposeFluxForWomersleyElement::total_volume_flux</a></div><div class="ttdeci">double total_volume_flux()</div><div class="ttdoc">Get volume flux through all Womersley elements.</div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l00576">womersley_elements.h:576</a></div></div>
<div class="ttc" id="aclassoomph_1_1WomersleyImpedanceTubeBase_html_a7363d921cd306353eae884b9cfe5c8e9"><div class="ttname"><a href="classoomph_1_1WomersleyImpedanceTubeBase.html#a7363d921cd306353eae884b9cfe5c8e9">oomph::WomersleyImpedanceTubeBase::Current_volume_flux_pt</a></div><div class="ttdeci">double * Current_volume_flux_pt</div><div class="ttdoc">Pointer to double that specifies the currently imposed instantaneous volume flux into the impedance t...</div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l01495">womersley_elements.h:1495</a></div></div>
<div class="ttc" id="aclassoomph_1_1WomersleyEquations_html_a4a0779392d756b1450d17879d0c10027"><div class="ttname"><a href="classoomph_1_1WomersleyEquations.html#a4a0779392d756b1450d17879d0c10027">oomph::WomersleyEquations::fill_in_contribution_to_jacobian</a></div><div class="ttdeci">void fill_in_contribution_to_jacobian(Vector&lt; double &gt; &amp;residuals, DenseMatrix&lt; double &gt; &amp;jacobian)</div><div class="ttdoc">Compute element residual Vector and element Jacobian matrix (wrapper)</div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l00401">womersley_elements.h:401</a></div></div>
<div class="ttc" id="aclassoomph_1_1FiniteElement_html_a6219ed269a6d89b5aa14659cce48905a"><div class="ttname"><a href="classoomph_1_1FiniteElement.html#a6219ed269a6d89b5aa14659cce48905a">oomph::FiniteElement::nnode</a></div><div class="ttdeci">unsigned nnode() const</div><div class="ttdoc">Return the number of nodes.</div><div class="ttdef"><b>Definition:</b> <a href="elements_8h_source.html#l02159">elements.h:2159</a></div></div>
<div class="ttc" id="aclassoomph_1_1Node_html"><div class="ttname"><a href="classoomph_1_1Node.html">oomph::Node</a></div><div class="ttdoc">Nodes are derived from Data, but, in addition, have a definite (Eulerian) position in a space of a gi...</div><div class="ttdef"><b>Definition:</b> <a href="nodes_8h_source.html#l00847">nodes.h:847</a></div></div>
<div class="ttc" id="aclassoomph_1_1NavierStokesWomersleyPressureControlElement_html_a8aedb28c49fd569eb65687efd2139abc"><div class="ttname"><a href="classoomph_1_1NavierStokesWomersleyPressureControlElement.html#a8aedb28c49fd569eb65687efd2139abc">oomph::NavierStokesWomersleyPressureControlElement::Womersley_tube_pt</a></div><div class="ttdeci">TemplateFreeWomersleyImpedanceTubeBase * Womersley_tube_pt</div><div class="ttdoc">Pointer to the Womersley impedance tube.</div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l02779">womersley_elements.h:2779</a></div></div>
<div class="ttc" id="aclassoomph_1_1Vector_html"><div class="ttname"><a href="classoomph_1_1Vector.html">oomph::Vector&lt; double &gt;</a></div></div>
<div class="ttc" id="aclassoomph_1_1GeneralisedElement_html_a36571ae9c4b6d2a26c36004e5be88389"><div class="ttname"><a href="classoomph_1_1GeneralisedElement.html#a36571ae9c4b6d2a26c36004e5be88389">oomph::GeneralisedElement::add_internal_data</a></div><div class="ttdeci">unsigned add_internal_data(Data *const &amp;data_pt, const bool &amp;fd=true)</div><div class="ttdoc">Add a (pointer to an) internal data object to the element and return the index required to obtain it ...</div><div class="ttdef"><b>Definition:</b> <a href="elements_8cc_source.html#l00062">elements.cc:62</a></div></div>
<div class="ttc" id="aclassoomph_1_1NavierStokesImpedanceTractionElement_html_a19a1379dee4fab03c2f8574665bc4184"><div class="ttname"><a href="classoomph_1_1NavierStokesImpedanceTractionElement.html#a19a1379dee4fab03c2f8574665bc4184">oomph::NavierStokesImpedanceTractionElement::~NavierStokesImpedanceTractionElement</a></div><div class="ttdeci">~NavierStokesImpedanceTractionElement()</div><div class="ttdoc">Destructor should not delete anything.</div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l02164">womersley_elements.h:2164</a></div></div>
<div class="ttc" id="aclassoomph_1_1QWomersleyElement_html_a4dee9f42d861ede7e487652ed6cc0927"><div class="ttname"><a href="classoomph_1_1QWomersleyElement.html#a4dee9f42d861ede7e487652ed6cc0927">oomph::QWomersleyElement::QWomersleyElement</a></div><div class="ttdeci">QWomersleyElement(const QWomersleyElement&lt; DIM, NNODE_1D &gt; &amp;dummy)</div><div class="ttdoc">Broken copy constructor.</div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l00677">womersley_elements.h:677</a></div></div>
<div class="ttc" id="aclassoomph_1_1QWomersleyElement_html_a98968ff614577c7796f293cb020831da"><div class="ttname"><a href="classoomph_1_1QWomersleyElement.html#a98968ff614577c7796f293cb020831da">oomph::QWomersleyElement::output</a></div><div class="ttdeci">void output(std::ostream &amp;outfile, const unsigned &amp;n_plot)</div><div class="ttdoc">Output function:   x,y,u or x,y,z,u at n_plot^DIM plot points.</div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l00701">womersley_elements.h:701</a></div></div>
<div class="ttc" id="aclassoomph_1_1WomersleyEquations_html"><div class="ttname"><a href="classoomph_1_1WomersleyEquations.html">oomph::WomersleyEquations</a></div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l00203">womersley_elements.h:203</a></div></div>
<div class="ttc" id="aclassoomph_1_1FiniteElement_html_a58a25b6859ddd43b7bfe64a19fee5023"><div class="ttname"><a href="classoomph_1_1FiniteElement.html#a58a25b6859ddd43b7bfe64a19fee5023">oomph::FiniteElement::shape</a></div><div class="ttdeci">virtual void shape(const Vector&lt; double &gt; &amp;s, Shape &amp;psi) const =0</div><div class="ttdoc">Calculate the geometric shape functions at local coordinate s. This function must be overloaded for e...</div></div>
<div class="ttc" id="aclassoomph_1_1NetFluxControlElementForWomersleyPressureControl_html"><div class="ttname"><a href="classoomph_1_1NetFluxControlElementForWomersleyPressureControl.html">oomph::NetFluxControlElementForWomersleyPressureControl</a></div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l02809">womersley_elements.h:2809</a></div></div>
<div class="ttc" id="aclassoomph_1_1WomersleyEquations_html_a22ad21d028f961d08c2ec17ed59bd88b"><div class="ttname"><a href="classoomph_1_1WomersleyEquations.html#a22ad21d028f961d08c2ec17ed59bd88b">oomph::WomersleyEquations::WomersleyEquations</a></div><div class="ttdeci">WomersleyEquations()</div><div class="ttdoc">Constructor: Initialises the Pressure_gradient_data_pt to null.</div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l00209">womersley_elements.h:209</a></div></div>
<div class="ttc" id="aclassoomph_1_1TemplateFreeWomersleyImpedanceTubeBase_html_a95c60d5f7661be3ee298cd2b4bd45de5"><div class="ttname"><a href="classoomph_1_1TemplateFreeWomersleyImpedanceTubeBase.html#a95c60d5f7661be3ee298cd2b4bd45de5">oomph::TemplateFreeWomersleyImpedanceTubeBase::get_response</a></div><div class="ttdeci">virtual void get_response(double &amp;p_in, double &amp;dp_in_dq)=0</div><div class="ttdoc">Empty virtual dummy member function  every base class needs at least one virtual member function if ...</div></div>
<div class="ttc" id="aclassoomph_1_1NavierStokesImpedanceTractionElement_html_a708121c1a4224d0d2c572904f74f2fb6"><div class="ttname"><a href="classoomph_1_1NavierStokesImpedanceTractionElement.html#a708121c1a4224d0d2c572904f74f2fb6">oomph::NavierStokesImpedanceTractionElement::fill_in_contribution_to_jacobian</a></div><div class="ttdeci">void fill_in_contribution_to_jacobian(Vector&lt; double &gt; &amp;residuals, DenseMatrix&lt; double &gt; &amp;jacobian)</div><div class="ttdoc">Fill in the element's contribution to the element's residual vector and Jacobian matrix.</div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l02449">womersley_elements.h:2449</a></div></div>
<div class="ttc" id="aclassoomph_1_1QWomersleyElement_html_afe507e9f0d7359d47c0c682fed7c952b"><div class="ttname"><a href="classoomph_1_1QWomersleyElement.html#afe507e9f0d7359d47c0c682fed7c952b">oomph::QWomersleyElement::dshape_and_dtest_eulerian_womersley</a></div><div class="ttdeci">double dshape_and_dtest_eulerian_womersley(const Vector&lt; double &gt; &amp;s, Shape &amp;psi, DShape &amp;dpsidx, Shape &amp;test, DShape &amp;dtestdx) const</div><div class="ttdoc">Shape, test functions &amp; derivs. w.r.t. to global coords. Return Jacobian.</div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l01541">womersley_elements.h:1541</a></div></div>
<div class="ttc" id="aclassoomph_1_1NavierStokesWomersleyPressureControlElement_html_a90810e440b763afca53dc50b24a7848c"><div class="ttname"><a href="classoomph_1_1NavierStokesWomersleyPressureControlElement.html#a90810e440b763afca53dc50b24a7848c">oomph::NavierStokesWomersleyPressureControlElement::Volume_flux_data_id</a></div><div class="ttdeci">unsigned Volume_flux_data_id</div><div class="ttdoc">Id of internal Data object whose single value is the volume flux.</div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l02786">womersley_elements.h:2786</a></div></div>
<div class="ttc" id="acfortran_8h_html_adb50e893b86b3e55e751a42eab3cba82"><div class="ttname"><a href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a></div><div class="ttdeci">cstr elem_len * i</div><div class="ttdef"><b>Definition:</b> <a href="cfortran_8h_source.html#l00603">cfortran.h:603</a></div></div>
<div class="ttc" id="aclassoomph_1_1WomersleyEquations_html_a29f1f7483545f64e8e04b24dcdce29ef"><div class="ttname"><a href="classoomph_1_1WomersleyEquations.html#a29f1f7483545f64e8e04b24dcdce29ef">oomph::WomersleyEquations::compute_error</a></div><div class="ttdeci">void compute_error(std::ostream &amp;outfile, FiniteElement::SteadyExactSolutionFctPt exact_soln_pt, double &amp;error, double &amp;norm)</div><div class="ttdoc">Get error against and norm of exact solution.</div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8cc_source.html#l00565">womersley_elements.cc:565</a></div></div>
<div class="ttc" id="aclassoomph_1_1NavierStokesWomersleyPressureControlElement_html_aaa4bdb2c63aea8177b120f39a309b645"><div class="ttname"><a href="classoomph_1_1NavierStokesWomersleyPressureControlElement.html#aaa4bdb2c63aea8177b120f39a309b645">oomph::NavierStokesWomersleyPressureControlElement::~NavierStokesWomersleyPressureControlElement</a></div><div class="ttdeci">~NavierStokesWomersleyPressureControlElement()</div><div class="ttdoc">Destructor should not delete anything.</div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l02670">womersley_elements.h:2670</a></div></div>
<div class="ttc" id="aclassoomph_1_1Node_html_a786c96a8e46eb27a03b2b31f629d41b3"><div class="ttname"><a href="classoomph_1_1Node.html#a786c96a8e46eb27a03b2b31f629d41b3">oomph::Node::ndim</a></div><div class="ttdeci">unsigned ndim() const</div><div class="ttdoc">Return (Eulerian) spatial dimension of the node.</div><div class="ttdef"><b>Definition:</b> <a href="nodes_8h_source.html#l00987">nodes.h:987</a></div></div>
<div class="ttc" id="aclassoomph_1_1GeneralisedElement_html_afc58b505360aa5d172e50baad9aae46d"><div class="ttname"><a href="classoomph_1_1GeneralisedElement.html#afc58b505360aa5d172e50baad9aae46d">oomph::GeneralisedElement::add_external_data</a></div><div class="ttdeci">unsigned add_external_data(Data *const &amp;data_pt, const bool &amp;fd=true)</div><div class="ttdef"><b>Definition:</b> <a href="elements_8cc_source.html#l00289">elements.cc:289</a></div></div>
<div class="ttc" id="aclassoomph_1_1DocInfo_html_a85d58bcfce0a7b7cae461624e6fcd08a"><div class="ttname"><a href="classoomph_1_1DocInfo.html#a85d58bcfce0a7b7cae461624e6fcd08a">oomph::DocInfo::directory</a></div><div class="ttdeci">std::string directory() const</div><div class="ttdoc">Output directory.</div><div class="ttdef"><b>Definition:</b> <a href="oomph__utilities_8h_source.html#l00515">oomph_utilities.h:515</a></div></div>
<div class="ttc" id="aclassoomph_1_1TemplateFreeWomersleyMeshBase_html"><div class="ttname"><a href="classoomph_1_1TemplateFreeWomersleyMeshBase.html">oomph::TemplateFreeWomersleyMeshBase</a></div><div class="ttdoc">Template-free base class.</div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l01649">womersley_elements.h:1649</a></div></div>
<div class="ttc" id="aclassoomph_1_1GeneralisedElement_html_a37204f67b37d212fd170c68d48f6da57"><div class="ttname"><a href="classoomph_1_1GeneralisedElement.html#a37204f67b37d212fd170c68d48f6da57">oomph::GeneralisedElement::ndof</a></div><div class="ttdeci">unsigned ndof() const</div><div class="ttdoc">Return the number of equations/dofs in the element.</div><div class="ttdef"><b>Definition:</b> <a href="elements_8h_source.html#l00830">elements.h:830</a></div></div>
<div class="ttc" id="aclassoomph_1_1WomersleyImpedanceTubeBase_html_a01ab12fe40acf7a477b892e7c7cd0831"><div class="ttname"><a href="classoomph_1_1WomersleyImpedanceTubeBase.html#a01ab12fe40acf7a477b892e7c7cd0831">oomph::WomersleyImpedanceTubeBase::Using_flux_control_elements</a></div><div class="ttdeci">bool Using_flux_control_elements</div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l01522">womersley_elements.h:1522</a></div></div>
<div class="ttc" id="aclassoomph_1_1NavierStokesWomersleyPressureControlElement_html_a336e39637cd1405c5edefbcb4c9e26e8"><div class="ttname"><a href="classoomph_1_1NavierStokesWomersleyPressureControlElement.html#a336e39637cd1405c5edefbcb4c9e26e8">oomph::NavierStokesWomersleyPressureControlElement::fill_in_contribution_to_residuals</a></div><div class="ttdeci">void fill_in_contribution_to_residuals(Vector&lt; double &gt; &amp;residuals)</div><div class="ttdoc">This function returns the residuals.</div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l02673">womersley_elements.h:2673</a></div></div>
<div class="ttc" id="aclassoomph_1_1DocInfo_html"><div class="ttname"><a href="classoomph_1_1DocInfo.html">oomph::DocInfo</a></div><div class="ttdoc">Information for documentation of results: Directory and file number to enable output in the form RESL...</div><div class="ttdef"><b>Definition:</b> <a href="oomph__utilities_8h_source.html#l00496">oomph_utilities.h:496</a></div></div>
<div class="ttc" id="aclassoomph_1_1QWomersleyElement_html"><div class="ttname"><a href="classoomph_1_1QWomersleyElement.html">oomph::QWomersleyElement</a></div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l00659">womersley_elements.h:659</a></div></div>
<div class="ttc" id="aclassoomph_1_1Data_html_a13206dcb7a088db0ef845ab71af505d2"><div class="ttname"><a href="classoomph_1_1Data.html#a13206dcb7a088db0ef845ab71af505d2">oomph::Data::eqn_number</a></div><div class="ttdeci">long &amp; eqn_number(const unsigned &amp;i)</div><div class="ttdoc">Return the equation number of the i-th stored variable.</div><div class="ttdef"><b>Definition:</b> <a href="nodes_8h_source.html#l00361">nodes.h:361</a></div></div>
<div class="ttc" id="aclassoomph_1_1DShape_html"><div class="ttname"><a href="classoomph_1_1DShape.html">oomph::DShape</a></div><div class="ttdef"><b>Definition:</b> <a href="shape_8h_source.html#l00271">shape.h:271</a></div></div>
<div class="ttc" id="aclassoomph_1_1WomersleyEquations_html_acdcc63b1f495caa704aec0c5c170b030"><div class="ttname"><a href="classoomph_1_1WomersleyEquations.html#acdcc63b1f495caa704aec0c5c170b030">oomph::WomersleyEquations::self_test</a></div><div class="ttdeci">unsigned self_test()</div><div class="ttdoc">Self-test: Return 0 for OK.</div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8cc_source.html#l00300">womersley_elements.cc:300</a></div></div>
<div class="ttc" id="anamespaceoomph_1_1PseudoSolidHelper_html_a4d6244e865fddd406dc8589beb58a654"><div class="ttname"><a href="namespaceoomph_1_1PseudoSolidHelper.html#a4d6244e865fddd406dc8589beb58a654">oomph::PseudoSolidHelper::Zero</a></div><div class="ttdeci">double Zero</div><div class="ttdoc">Static variable to hold the default value for the pseudo-solid's inertia parameter Lambda^2.</div><div class="ttdef"><b>Definition:</b> <a href="pseudosolid__node__update__elements_8cc_source.html#l00039">pseudosolid_node_update_elements.cc:39</a></div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_a425403e4cb6678015b20f2dddc7a2f89"><div class="ttname"><a href="classoomph_1_1Problem.html#a425403e4cb6678015b20f2dddc7a2f89">oomph::Problem::time_pt</a></div><div class="ttdeci">Time *&amp; time_pt()</div><div class="ttdoc">Return a pointer to the global time object.</div><div class="ttdef"><b>Definition:</b> <a href="problem_8h_source.html#l01449">problem.h:1449</a></div></div>
<div class="ttc" id="aclassoomph_1_1NavierStokesImpedanceTractionElement_html_a11722da061d3972b24932181b2ef9ae4"><div class="ttname"><a href="classoomph_1_1NavierStokesImpedanceTractionElement.html#a11722da061d3972b24932181b2ef9ae4">oomph::NavierStokesImpedanceTractionElement::output</a></div><div class="ttdeci">void output(std::ostream &amp;outfile, const unsigned &amp;nplot)</div><div class="ttdoc">Output function: x,y,[z],u,v,[w],p in tecplot format.</div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l02471">womersley_elements.h:2471</a></div></div>
<div class="ttc" id="aclassoomph_1_1WomersleyImpedanceTubeBase_html_abdb65e815a6b49ffb2b4ac180c968ccc"><div class="ttname"><a href="classoomph_1_1WomersleyImpedanceTubeBase.html#abdb65e815a6b49ffb2b4ac180c968ccc">oomph::WomersleyImpedanceTubeBase::p_out</a></div><div class="ttdeci">double &amp; p_out()</div><div class="ttdoc">Access fct to outlet pressure.</div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l01220">womersley_elements.h:1220</a></div></div>
<div class="ttc" id="aclassoomph_1_1WomersleyProblem_html_a9a8cc169abe4814d9f9851f4eb936701"><div class="ttname"><a href="classoomph_1_1WomersleyProblem.html#a9a8cc169abe4814d9f9851f4eb936701">oomph::WomersleyProblem::~WomersleyProblem</a></div><div class="ttdeci">~WomersleyProblem()</div><div class="ttdoc">Destructor to clean up memory.</div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l01014">womersley_elements.h:1014</a></div></div>
<div class="ttc" id="aclassoomph_1_1WomersleyImpedanceTubeBase_html_aa321d54eb9f818975854f8f3cc568256"><div class="ttname"><a href="classoomph_1_1WomersleyImpedanceTubeBase.html#aa321d54eb9f818975854f8f3cc568256">oomph::WomersleyImpedanceTubeBase::total_volume_flux_into_impedance_tube</a></div><div class="ttdeci">double total_volume_flux_into_impedance_tube()</div><div class="ttdoc">Compute total current volume flux into the &quot;impedance tube&quot; that provides the flow resistance (flux i...</div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l01386">womersley_elements.h:1386</a></div></div>
<div class="ttc" id="aclassoomph_1_1NavierStokesImpedanceTractionElement_html_aab0f649a0569d9caa428b8a932cc1c40"><div class="ttname"><a href="classoomph_1_1NavierStokesImpedanceTractionElement.html#aab0f649a0569d9caa428b8a932cc1c40">oomph::NavierStokesImpedanceTractionElement::set_impedance_tube_pt</a></div><div class="ttdeci">void set_impedance_tube_pt(TemplateFreeWomersleyImpedanceTubeBase *impedance_tube_pt)</div><div class="ttdoc">Set pointer to &quot;impedance tube&quot; that provides the flow resistance.</div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l02359">womersley_elements.h:2359</a></div></div>
<div class="ttc" id="aclassoomph_1_1WomersleyOutflowImpedanceTube_html"><div class="ttname"><a href="classoomph_1_1WomersleyOutflowImpedanceTube.html">oomph::WomersleyOutflowImpedanceTube</a></div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l01898">womersley_elements.h:1898</a></div></div>
<div class="ttc" id="anamespaceoomph_html_a2473930e2634d673e2a3bed63b6851f0"><div class="ttname"><a href="namespaceoomph.html#a2473930e2634d673e2a3bed63b6851f0">oomph::output</a></div><div class="ttdeci">void output(std::ostream &amp;outfile)</div><div class="ttdoc">Output with default number of plot points.</div><div class="ttdef"><b>Definition:</b> <a href="gen__axisym__advection__diffusion__elements_8h_source.html#l00160">gen_axisym_advection_diffusion_elements.h:160</a></div></div>
<div class="ttc" id="athe__data__structure_8txt_html_af88b2d950fae19ab641bd1690e08445c"><div class="ttname"><a href="the__data__structure_8txt.html#af88b2d950fae19ab641bd1690e08445c">n</a></div><div class="ttdeci">endcode We introduce wrapper functions to access function so that we can formulate The Maths in generic terms Rather than referring to the pressure at node c n</div><div class="ttdef"><b>Definition:</b> <a href="the__data__structure_8txt_source.html#l00582">the_data_structure.txt:582</a></div></div>
<div class="ttc" id="aclassoomph_1_1WomersleyMesh_html_a1fc3a748ff68d01051759c9e3c39bca2"><div class="ttname"><a href="classoomph_1_1WomersleyMesh.html#a1fc3a748ff68d01051759c9e3c39bca2">oomph::WomersleyMesh::WomersleyMesh</a></div><div class="ttdeci">WomersleyMesh(Mesh *n_st_outflow_mesh_pt, TimeStepper *time_stepper_pt, const unsigned &amp;fixed_coordinate, const unsigned &amp;w_index)</div><div class="ttdoc">Constructor: Pass pointer to mesh of face elements in the outflow cross-section of a full Navier-Stok...</div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l01686">womersley_elements.h:1686</a></div></div>
<div class="ttc" id="aclassoomph_1_1OomphLibWarning_html"><div class="ttname"><a href="classoomph_1_1OomphLibWarning.html">oomph::OomphLibWarning</a></div><div class="ttdef"><b>Definition:</b> <a href="oomph__definitions_8h_source.html#l00262">oomph_definitions.h:262</a></div></div>
<div class="ttc" id="aclassoomph_1_1NavierStokesImpedanceTractionElementBase_html_a7f71882ae8a0d34e3d5a5c91586081b3"><div class="ttname"><a href="classoomph_1_1NavierStokesImpedanceTractionElementBase.html#a7f71882ae8a0d34e3d5a5c91586081b3">oomph::NavierStokesImpedanceTractionElementBase::get_volume_flux</a></div><div class="ttdeci">virtual double get_volume_flux()=0</div><div class="ttdoc">Pure virtual function that must be implemented to compute the volume flux that passes through this el...</div></div>
<div class="ttc" id="aclassoomph_1_1GeneralisedElement_html_aa9db9d3c59caed7ff927373caf5ea4b6"><div class="ttname"><a href="classoomph_1_1GeneralisedElement.html#aa9db9d3c59caed7ff927373caf5ea4b6">oomph::GeneralisedElement::internal_local_eqn</a></div><div class="ttdeci">int internal_local_eqn(const unsigned &amp;i, const unsigned &amp;j) const</div><div class="ttdoc">Return the local equation number corresponding to the j-th value stored at the i-th internal data.</div><div class="ttdef"><b>Definition:</b> <a href="elements_8h_source.html#l00264">elements.h:264</a></div></div>
<div class="ttc" id="aclassoomph_1_1WomersleyEquations_html_acf9f462d481937ec282ccb48c34e77bc"><div class="ttname"><a href="classoomph_1_1WomersleyEquations.html#acf9f462d481937ec282ccb48c34e77bc">oomph::WomersleyEquations::Pressure_gradient_data_pt</a></div><div class="ttdeci">Data * Pressure_gradient_data_pt</div><div class="ttdoc">Pointer to pressure gradient Data (single value Data item)</div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l00470">womersley_elements.h:470</a></div></div>
<div class="ttc" id="aclassoomph_1_1TimeStepper_html_ad341ba9e80265e1c26c1cda0f40c8292"><div class="ttname"><a href="classoomph_1_1TimeStepper.html#ad341ba9e80265e1c26c1cda0f40c8292">oomph::TimeStepper::is_steady</a></div><div class="ttdeci">bool is_steady() const</div><div class="ttdoc">Flag to indicate if a timestepper has been made steady (possibly temporarily to switch off time-depen...</div><div class="ttdef"><b>Definition:</b> <a href="timesteppers_8h_source.html#l00371">timesteppers.h:371</a></div></div>
<div class="ttc" id="aclassoomph_1_1QWomersleyElement_html_a42dc522e6a7adb0b87e335a797d07bf4"><div class="ttname"><a href="classoomph_1_1QWomersleyElement.html#a42dc522e6a7adb0b87e335a797d07bf4">oomph::QWomersleyElement::QWomersleyElement</a></div><div class="ttdeci">QWomersleyElement()</div><div class="ttdoc">Constructor: Call constructors for QElement and Womersley equations.</div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l00672">womersley_elements.h:672</a></div></div>
<div class="ttc" id="aclassoomph_1_1Data_html_a5b34970d16205921dca3ada720da8445"><div class="ttname"><a href="classoomph_1_1Data.html#a5b34970d16205921dca3ada720da8445">oomph::Data::time_stepper_pt</a></div><div class="ttdeci">TimeStepper *&amp; time_stepper_pt()</div><div class="ttdoc">Return the pointer to the timestepper.</div><div class="ttdef"><b>Definition:</b> <a href="nodes_8h_source.html#l00242">nodes.h:242</a></div></div>
<div class="ttc" id="aclassoomph_1_1NavierStokesImpedanceTractionElement_html_a65123707e91f7a351bb9cffb64e1b81c"><div class="ttname"><a href="classoomph_1_1NavierStokesImpedanceTractionElement.html#a65123707e91f7a351bb9cffb64e1b81c">oomph::NavierStokesImpedanceTractionElement::Impedance_tube_pt</a></div><div class="ttdeci">WomersleyImpedanceTubeBase&lt; WOMERSLEY_ELEMENT, DIM &gt; * Impedance_tube_pt</div><div class="ttdoc">Pointer to ImpedanceTubeProblem that computes the flow resistance.</div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l02067">womersley_elements.h:2067</a></div></div>
<div class="ttc" id="aclassoomph_1_1WomersleyEquations_html_a26d31e02c3fb483c76402823e09d67c7"><div class="ttname"><a href="classoomph_1_1WomersleyEquations.html#a26d31e02c3fb483c76402823e09d67c7">oomph::WomersleyEquations::dshape_and_dtest_eulerian_womersley</a></div><div class="ttdeci">virtual double dshape_and_dtest_eulerian_womersley(const Vector&lt; double &gt; &amp;s, Shape &amp;psi, DShape &amp;dpsidx, Shape &amp;test, DShape &amp;dtestdx) const =0</div><div class="ttdoc">Shape/test functions and derivs w.r.t. to global coords at local coord. s; return Jacobian of mapping...</div></div>
<div class="ttc" id="aclassoomph_1_1NetFluxControlElementForWomersleyPressureControl_html_a499dc308316bda2ce079d89773562418"><div class="ttname"><a href="classoomph_1_1NetFluxControlElementForWomersleyPressureControl.html#a499dc308316bda2ce079d89773562418">oomph::NetFluxControlElementForWomersleyPressureControl::operator=</a></div><div class="ttdeci">void operator=(const NetFluxControlElementForWomersleyPressureControl &amp;)</div><div class="ttdoc">Broken assignment operator.</div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l02850">womersley_elements.h:2850</a></div></div>
<div class="ttc" id="aclassoomph_1_1WomersleyImpedanceTubeBase_html_a62628115802f53da76c5e4f29de628c7"><div class="ttname"><a href="classoomph_1_1WomersleyImpedanceTubeBase.html#a62628115802f53da76c5e4f29de628c7">oomph::WomersleyImpedanceTubeBase::get_response</a></div><div class="ttdeci">void get_response(double &amp;p_in, double &amp;dp_in_dq)</div><div class="ttdoc">Compute inlet pressure, p_in, required to achieve the currently imposed, instantaneous volume flux q ...</div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l01424">womersley_elements.h:1424</a></div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html"><div class="ttname"><a href="classoomph_1_1Problem.html">oomph::Problem</a></div><div class="ttdoc">The Problem class.</div><div class="ttdef"><b>Definition:</b> <a href="problem_8h_source.html#l00148">problem.h:148</a></div></div>
<div class="ttc" id="aclassoomph_1_1WomersleyProblem_html_a8880c101a67eb960adac41775ebf2029"><div class="ttname"><a href="classoomph_1_1WomersleyProblem.html#a8880c101a67eb960adac41775ebf2029">oomph::WomersleyProblem::Prescribed_volume_flux_pt</a></div><div class="ttdeci">double * Prescribed_volume_flux_pt</div><div class="ttdoc">Pointer to currently prescribed volume flux.</div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l00851">womersley_elements.h:851</a></div></div>
<div class="ttc" id="aclassoomph_1_1Mesh_html_af01dfefb66c15579b540be62999d93ee"><div class="ttname"><a href="classoomph_1_1Mesh.html#af01dfefb66c15579b540be62999d93ee">oomph::Mesh::nelement</a></div><div class="ttdeci">unsigned long nelement() const</div><div class="ttdoc">Return number of elements in the mesh.</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8h_source.html#l00583">mesh.h:583</a></div></div>
<div class="ttc" id="aclassoomph_1_1WomersleyImpedanceTubeBase_html_a552fa003624cfb4e31da70f800f0669c"><div class="ttname"><a href="classoomph_1_1WomersleyImpedanceTubeBase.html#a552fa003624cfb4e31da70f800f0669c">oomph::WomersleyImpedanceTubeBase::WomersleyImpedanceTubeBase</a></div><div class="ttdeci">WomersleyImpedanceTubeBase(const double &amp;length, PrescribedVolumeFluxFctPt prescribed_volume_flux_fct_pt)</div><div class="ttdoc">Constructor: Specify length of tube and pointer to function that specifies the prescribed volume flux...</div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l01129">womersley_elements.h:1129</a></div></div>
<div class="ttc" id="aclassoomph_1_1FaceElement_html"><div class="ttname"><a href="classoomph_1_1FaceElement.html">oomph::FaceElement</a></div><div class="ttdef"><b>Definition:</b> <a href="elements_8h_source.html#l04215">elements.h:4215</a></div></div>
<div class="ttc" id="aclassoomph_1_1NavierStokesImpedanceTractionElement_html_a853055ebb50a6500602288a6f0563852"><div class="ttname"><a href="classoomph_1_1NavierStokesImpedanceTractionElement.html#a853055ebb50a6500602288a6f0563852">oomph::NavierStokesImpedanceTractionElement::get_volume_flux</a></div><div class="ttdeci">double get_volume_flux()</div><div class="ttdoc">Get integral of volume flux through element.</div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l02175">womersley_elements.h:2175</a></div></div>
<div class="ttc" id="aclassoomph_1_1TimeStepper_html_a4cb0aecb044b77ba0553cdd54b586d8a"><div class="ttname"><a href="classoomph_1_1TimeStepper.html#a4cb0aecb044b77ba0553cdd54b586d8a">oomph::TimeStepper::weight</a></div><div class="ttdeci">virtual double weight(const unsigned &amp;i, const unsigned &amp;j) const</div><div class="ttdoc">Access function for j-th weight for the i-th derivative.</div><div class="ttdef"><b>Definition:</b> <a href="timesteppers_8h_source.html#l00553">timesteppers.h:553</a></div></div>
<div class="ttc" id="aclassoomph_1_1NavierStokesImpedanceTractionElement_html_ade2eae5b0a6ecac82949f05a073217ea"><div class="ttname"><a href="classoomph_1_1NavierStokesImpedanceTractionElement.html#ade2eae5b0a6ecac82949f05a073217ea">oomph::NavierStokesImpedanceTractionElement::total_volume_flux_into_downstream_tube</a></div><div class="ttdeci">double total_volume_flux_into_downstream_tube()</div><div class="ttdoc">Compute total volume flux into the &quot;downstream tube&quot; that provides the impedance (computed by adding ...</div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l02329">womersley_elements.h:2329</a></div></div>
<div class="ttc" id="aclassoomph_1_1WomersleyEquations_html_ae4c9206bebee065874acb318d2abf20d"><div class="ttname"><a href="classoomph_1_1WomersleyEquations.html#ae4c9206bebee065874acb318d2abf20d">oomph::WomersleyEquations::set_pressure_gradient_and_add_as_external_data</a></div><div class="ttdeci">void set_pressure_gradient_and_add_as_external_data(Data *pressure_gradient_data_pt)</div><div class="ttdoc">Set pointer to pressure gradient (single-valued Data) and treat it as external data  this can only b...</div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l00496">womersley_elements.h:496</a></div></div>
<div class="ttc" id="aclassoomph_1_1DocInfo_html_af27224b25da5b758442753f0947e62d4"><div class="ttname"><a href="classoomph_1_1DocInfo.html#af27224b25da5b758442753f0947e62d4">oomph::DocInfo::number</a></div><div class="ttdeci">unsigned &amp; number()</div><div class="ttdoc">Number used (e.g.) for labeling output files.</div><div class="ttdef"><b>Definition:</b> <a href="oomph__utilities_8h_source.html#l00533">oomph_utilities.h:533</a></div></div>
<div class="ttc" id="aclassoomph_1_1PointElement_html"><div class="ttname"><a href="classoomph_1_1PointElement.html">oomph::PointElement</a></div><div class="ttdef"><b>Definition:</b> <a href="elements_8h_source.html#l03301">elements.h:3301</a></div></div>
<div class="ttc" id="aclassoomph_1_1WomersleyProblem_html_a7aa82fe18099c9770edf9fa8e79a2028"><div class="ttname"><a href="classoomph_1_1WomersleyProblem.html#a7aa82fe18099c9770edf9fa8e79a2028">oomph::WomersleyProblem::actions_before_newton_solve</a></div><div class="ttdeci">void actions_before_newton_solve()</div><div class="ttdoc">Update the problem specs before solve (empty)</div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l00811">womersley_elements.h:811</a></div></div>
<div class="ttc" id="aclassoomph_1_1NavierStokesWomersleyPressureControlElement_html_aa899b746f1831673358ba6a71409e45c"><div class="ttname"><a href="classoomph_1_1NavierStokesWomersleyPressureControlElement.html#aa899b746f1831673358ba6a71409e45c">oomph::NavierStokesWomersleyPressureControlElement::fill_in_contribution_to_jacobian</a></div><div class="ttdeci">void fill_in_contribution_to_jacobian(Vector&lt; double &gt; &amp;residuals, DenseMatrix&lt; double &gt; &amp;jacobian)</div><div class="ttdoc">This function returns the residuals and the Jacobian, plus the Jacobian contribution for the NetFluxC...</div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l02686">womersley_elements.h:2686</a></div></div>
<div class="ttc" id="acfortran_8h_html_a37cd013acc76697829c324bdd8562d82"><div class="ttname"><a href="cfortran_8h.html#a37cd013acc76697829c324bdd8562d82">e</a></div><div class="ttdeci">e</div><div class="ttdef"><b>Definition:</b> <a href="cfortran_8h_source.html#l00571">cfortran.h:571</a></div></div>
<div class="ttc" id="aclassoomph_1_1WomersleyImpedanceTubeBase_html_ad8b569812e4c3fa5ae6c1064689bb2fe"><div class="ttname"><a href="classoomph_1_1WomersleyImpedanceTubeBase.html#ad8b569812e4c3fa5ae6c1064689bb2fe">oomph::WomersleyImpedanceTubeBase::Aux_integral_pt</a></div><div class="ttdeci">std::map&lt; unsigned, double &gt; * Aux_integral_pt</div><div class="ttdoc">Pointer to auxiliary integral, containing the derivative of the total volume flux through the outflow...</div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l01516">womersley_elements.h:1516</a></div></div>
<div class="ttc" id="aclassoomph_1_1TemplateFreeWomersleyImpedanceTubeBase_html"><div class="ttname"><a href="classoomph_1_1TemplateFreeWomersleyImpedanceTubeBase.html">oomph::TemplateFreeWomersleyImpedanceTubeBase</a></div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l00061">womersley_elements.h:61</a></div></div>
<div class="ttc" id="aclassoomph_1_1WomersleyEquations_html_af97b58e933b49d84f2eda3c10fec9cd1"><div class="ttname"><a href="classoomph_1_1WomersleyEquations.html#af97b58e933b49d84f2eda3c10fec9cd1">oomph::WomersleyEquations::output_3d</a></div><div class="ttdeci">void output_3d(std::ostream &amp;outfile, const unsigned &amp;n_plot, const double &amp;z_out)</div><div class="ttdoc">Output function: x,y,z_out,0,0,u,0 to allow comparison against full Navier Stokes at n_nplot x n_plot...</div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8cc_source.html#l00331">womersley_elements.cc:331</a></div></div>
<div class="ttc" id="aclassoomph_1_1ImposeFluxForWomersleyElement_html_a7c5c2bbd9577949c1fa78395930fd764"><div class="ttname"><a href="classoomph_1_1ImposeFluxForWomersleyElement.html#a7c5c2bbd9577949c1fa78395930fd764">oomph::ImposeFluxForWomersleyElement::get_jacobian</a></div><div class="ttdeci">void get_jacobian(Vector&lt; double &gt; &amp;residuals, DenseMatrix&lt; double &gt; &amp;jacobian)</div><div class="ttdoc">Compute element residual Vector and element Jacobian matrix Note: Jacobian is zero because the deriva...</div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l00615">womersley_elements.h:615</a></div></div>
<div class="ttc" id="aclassoomph_1_1FiniteElement_html_a28fd5c2d4aeba5ef65bee0e0d72569f5"><div class="ttname"><a href="classoomph_1_1FiniteElement.html#a28fd5c2d4aeba5ef65bee0e0d72569f5">oomph::FiniteElement::nodal_value</a></div><div class="ttdeci">double nodal_value(const unsigned &amp;n, const unsigned &amp;i) const</div><div class="ttdoc">Return the i-th value stored at local node n. Produces suitably interpolated values for hanging nodes...</div><div class="ttdef"><b>Definition:</b> <a href="elements_8h_source.html#l02483">elements.h:2483</a></div></div>
<div class="ttc" id="aclassoomph_1_1WomersleyImpedanceTubeBase_html_afa4f6e203c33d02e82a92986b1aeee0d"><div class="ttname"><a href="classoomph_1_1WomersleyImpedanceTubeBase.html#afa4f6e203c33d02e82a92986b1aeee0d">oomph::WomersleyImpedanceTubeBase::P_out</a></div><div class="ttdeci">double P_out</div><div class="ttdoc">Outlet pressure.</div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l01502">womersley_elements.h:1502</a></div></div>
<div class="ttc" id="aclassoomph_1_1NavierStokesWomersleyPressureControlElement_html_a615400a9e8489a2ea7e1b1722d98c95e"><div class="ttname"><a href="classoomph_1_1NavierStokesWomersleyPressureControlElement.html#a615400a9e8489a2ea7e1b1722d98c95e">oomph::NavierStokesWomersleyPressureControlElement::fill_in_generic_residual_contribution_pressure_control</a></div><div class="ttdeci">void fill_in_generic_residual_contribution_pressure_control(Vector&lt; double &gt; &amp;residuals, DenseMatrix&lt; double &gt; &amp;jacobian, const unsigned &amp;flag)</div><div class="ttdoc">This function returns the residuals. flag=1(or 0): do (or don't) compute the Jacobian as well....</div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l02737">womersley_elements.h:2737</a></div></div>
<div class="ttc" id="aclassoomph_1_1TemplateFreeWomersleyImpedanceTubeBase_html_a52044dbd661e704066760426547fc3e8"><div class="ttname"><a href="classoomph_1_1TemplateFreeWomersleyImpedanceTubeBase.html#a52044dbd661e704066760426547fc3e8">oomph::TemplateFreeWomersleyImpedanceTubeBase::TemplateFreeWomersleyImpedanceTubeBase</a></div><div class="ttdeci">TemplateFreeWomersleyImpedanceTubeBase()</div><div class="ttdoc">Empty constructor.</div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l00067">womersley_elements.h:67</a></div></div>
<div class="ttc" id="aclassoomph_1_1Shape_html"><div class="ttname"><a href="classoomph_1_1Shape.html">oomph::Shape</a></div><div class="ttdef"><b>Definition:</b> <a href="shape_8h_source.html#l00077">shape.h:77</a></div></div>
<div class="ttc" id="aclassoomph_1_1DoubleVector_html"><div class="ttname"><a href="classoomph_1_1DoubleVector.html">oomph::DoubleVector</a></div><div class="ttdoc">A vector in the mathematical sense, initially developed for linear algebra type applications....</div><div class="ttdef"><b>Definition:</b> <a href="double__vector_8h_source.html#l00057">double_vector.h:57</a></div></div>
<div class="ttc" id="aclassoomph_1_1BDF_html"><div class="ttname"><a href="classoomph_1_1BDF.html">oomph::BDF</a></div><div class="ttdoc">Templated class for BDF-type time-steppers with fixed or variable timestep. 1st time derivative recov...</div><div class="ttdef"><b>Definition:</b> <a href="timesteppers_8h_source.html#l01137">timesteppers.h:1137</a></div></div>
<div class="ttc" id="aclassoomph_1_1WomersleyProblem_html_ac3607d12a92dede9ed2e93ae64f300b3"><div class="ttname"><a href="classoomph_1_1WomersleyProblem.html#ac3607d12a92dede9ed2e93ae64f300b3">oomph::WomersleyProblem::PrescribedPressureGradientFctPt</a></div><div class="ttdeci">double(* PrescribedPressureGradientFctPt)(const double &amp;time)</div><div class="ttdoc">Function pointer to fct that prescribes pressure gradient g=fct(t)</div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l00775">womersley_elements.h:775</a></div></div>
<div class="ttc" id="aclassoomph_1_1WomersleyImpedanceTubeBase_html_a8524aff02e221d6fd8d9cfe58c2ef596"><div class="ttname"><a href="classoomph_1_1WomersleyImpedanceTubeBase.html#a8524aff02e221d6fd8d9cfe58c2ef596">oomph::WomersleyImpedanceTubeBase::setup</a></div><div class="ttdeci">void setup()</div><div class="ttdoc">Set up the Womersley tubes so that a subsequent call to get_response(...) computes the inlet pressure...</div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l01234">womersley_elements.h:1234</a></div></div>
<div class="ttc" id="acfortran_8h_html_ab7123126e4885ef647dd9c6e3807a21c"><div class="ttname"><a href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a></div><div class="ttdeci">static char t char * s</div><div class="ttdef"><b>Definition:</b> <a href="cfortran_8h_source.html#l00568">cfortran.h:568</a></div></div>
<div class="ttc" id="aclassoomph_1_1WomersleyEquations_html_ada82ee649d9a6d7469166fd497222594"><div class="ttname"><a href="classoomph_1_1WomersleyEquations.html#ada82ee649d9a6d7469166fd497222594">oomph::WomersleyEquations::set_pressure_gradient_pt</a></div><div class="ttdeci">void set_pressure_gradient_pt(Data *&amp;pressure_gradient_data_pt)</div><div class="ttdoc">Set pointer to pressure gradient (single-valued Data)</div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l00230">womersley_elements.h:230</a></div></div>
<div class="ttc" id="aclassoomph_1_1FaceGeometry_html"><div class="ttname"><a href="classoomph_1_1FaceGeometry.html">oomph::FaceGeometry</a></div><div class="ttdef"><b>Definition:</b> <a href="elements_8h_source.html#l04837">elements.h:4837</a></div></div>
<div class="ttc" id="anamespaceoomph_1_1BrokenCopy_html_a32dc384e671e786bac0c67cbff701f45"><div class="ttname"><a href="namespaceoomph_1_1BrokenCopy.html#a32dc384e671e786bac0c67cbff701f45">oomph::BrokenCopy::broken_assign</a></div><div class="ttdeci">void broken_assign(const std::string &amp;class_name)</div><div class="ttdoc">Issue error message and terminate execution.</div><div class="ttdef"><b>Definition:</b> <a href="oomph__utilities_8cc_source.html#l00197">oomph_utilities.cc:197</a></div></div>
<div class="ttc" id="aclassoomph_1_1NavierStokesImpedanceTractionElement_html_afd73c927eab27d77f54d83c67ef84a0f"><div class="ttname"><a href="classoomph_1_1NavierStokesImpedanceTractionElement.html#afd73c927eab27d77f54d83c67ef84a0f">oomph::NavierStokesImpedanceTractionElement::set_external_data_from_navier_stokes_outflow_mesh</a></div><div class="ttdeci">void set_external_data_from_navier_stokes_outflow_mesh(Mesh *navier_stokes_outflow_mesh_pt)</div><div class="ttdoc">NavierStokesImpedanceTractionElements that contribute to the volume flux into the downstream &quot;impedan...</div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l02277">womersley_elements.h:2277</a></div></div>
<div class="ttc" id="aclassoomph_1_1NavierStokesImpedanceTractionElementBase_html_a460dbb1435dcd04e506b90d029513fc2"><div class="ttname"><a href="classoomph_1_1NavierStokesImpedanceTractionElementBase.html#a460dbb1435dcd04e506b90d029513fc2">oomph::NavierStokesImpedanceTractionElementBase::Navier_stokes_outflow_mesh_pt</a></div><div class="ttdeci">Mesh * Navier_stokes_outflow_mesh_pt</div><div class="ttdoc">Pointer to mesh containing the NavierStokesImpedanceTractionElements that contribute to the volume fl...</div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l00154">womersley_elements.h:154</a></div></div>
<div class="ttc" id="aclassoomph_1_1NavierStokesWomersleyPressureControlElement_html_acf1843645f77e2616aa851e902713c91"><div class="ttname"><a href="classoomph_1_1NavierStokesWomersleyPressureControlElement.html#acf1843645f77e2616aa851e902713c91">oomph::NavierStokesWomersleyPressureControlElement::Pressure_data_id</a></div><div class="ttdeci">unsigned Pressure_data_id</div><div class="ttdoc">Id of external Data object whose single value is the pressure.</div><div class="ttdef"><b>Definition:</b> <a href="womersley__elements_8h_source.html#l02782">womersley_elements.h:2782</a></div></div>

    <!-- jQuery for Bootstrap and Doxygen -->
    <script src="../../js/jquery-1.12.0.min.js"></script>
    <!-- Minified boostrap plugins-->
    <script src="../../js/bootstrap.js"></script>
    <!-- Doxygen dependency to add powertips to source code-->
    <script src="../../js/jquery.powertip.min.js"></script>
    <!-- The  following script is generated by doxygen and hides/shows levels in 
         the data structure lists and adds powertips to source code-->
    <script src="../../js/dynsections.js" ></script>
    <!-- add to Doxygen's class names so bootstrap css and js recognises them-->
    <script type="text/javascript">
    $(".contents").addClass("container");
    $(".header").addClass("container");
    $(".navpath").addClass("container");
    $("#navrow3").addClass("container");
    $("#navrow4").addClass("container");
    $(".mlabel").addClass("label");
    $(".mlabel").addClass("label-default");
    $(".memitem").addClass("panel");
    $(".memitem").addClass("panel-info");
    $(".memproto").addClass("panel-heading");
    $(".memdoc").addClass("panel-body");
    </script>
    <footer>
      <div class="container">
        <div class="text-muted" style="float:right;">Generated by <a href="http://www.doxygen.org/index.html">
          <img style="height:18px;" class="footer-img" src="doxygen.png" alt="doxygen"></a> on Wed Jul 21 2021 16:05:08
        </div>
      </div>
    </footer>
</body>
</html>

\hypertarget{tet__mesh_8cc_source}{}\doxysection{tet\+\_\+mesh.\+cc}
\label{tet__mesh_8cc_source}\index{tet\_mesh.cc@{tet\_mesh.cc}}
\mbox{\hyperlink{tet__mesh_8cc}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00001}00001 \textcolor{comment}{// LIC// ====================================================================}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00002}00002 \textcolor{comment}{// LIC// This file forms part of oomph-\/lib, the object-\/oriented,}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00003}00003 \textcolor{comment}{// LIC// multi-\/physics finite-\/element library, available}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00004}00004 \textcolor{comment}{// LIC// at http://www.oomph-\/lib.org.}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00005}00005 \textcolor{comment}{// LIC//}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00006}00006 \textcolor{comment}{// LIC// Copyright (C) 2006-\/2021 Matthias Heil and Andrew Hazel}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00007}00007 \textcolor{comment}{// LIC//}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00008}00008 \textcolor{comment}{// LIC// This library is free software; you can redistribute it and/or}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00009}00009 \textcolor{comment}{// LIC// modify it under the terms of the GNU Lesser General Public}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00010}00010 \textcolor{comment}{// LIC// License as published by the Free Software Foundation; either}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00011}00011 \textcolor{comment}{// LIC// version 2.1 of the License, or (at your option) any later version.}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00012}00012 \textcolor{comment}{// LIC//}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00013}00013 \textcolor{comment}{// LIC// This library is distributed in the hope that it will be useful,}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00014}00014 \textcolor{comment}{// LIC// but WITHOUT ANY WARRANTY; without even the implied warranty of}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00015}00015 \textcolor{comment}{// LIC// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00016}00016 \textcolor{comment}{// LIC// Lesser General Public License for more details.}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00017}00017 \textcolor{comment}{// LIC//}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00018}00018 \textcolor{comment}{// LIC// You should have received a copy of the GNU Lesser General Public}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00019}00019 \textcolor{comment}{// LIC// License along with this library; if not, write to the Free Software}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00020}00020 \textcolor{comment}{// LIC// Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00021}00021 \textcolor{comment}{// LIC// 02110-\/1301  USA.}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00022}00022 \textcolor{comment}{// LIC//}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00023}00023 \textcolor{comment}{// LIC// The authors may be contacted at oomph-\/lib@maths.man.ac.uk.}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00024}00024 \textcolor{comment}{// LIC//}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00025}00025 \textcolor{comment}{// LIC//====================================================================}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00026}00026 }
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00027}00027 \textcolor{preprocessor}{\#include <algorithm>}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00028}00028 }
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00029}00029 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{map__matrix_8h}{map\_matrix.h}}"{}}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00030}00030 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{tet__mesh_8h}{tet\_mesh.h}}"{}}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00031}00031 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{Telements_8h}{Telements.h}}"{}}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00032}00032 }
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00033}00033 }
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00034}00034 \textcolor{keyword}{namespace }\mbox{\hyperlink{namespaceoomph}{oomph}}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00035}00035 \{}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00036}00036   \textcolor{comment}{//=======================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00037}00037 \textcolor{comment}{  /// Constructor for a FacetedSurface created from a list of nodes}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00038}00038 \textcolor{comment}{  /// and connectivity information. This is used in remeshing}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00039}00039 \textcolor{comment}{}  \textcolor{comment}{//=======================================================================}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00040}\mbox{\hyperlink{classoomph_1_1TetMeshFacetedClosedSurfaceForRemesh_a7b391693935d08cc63a41d6accbabd57}{00040}}   \mbox{\hyperlink{classoomph_1_1TetMeshFacetedClosedSurfaceForRemesh_a7b391693935d08cc63a41d6accbabd57}{TetMeshFacetedClosedSurfaceForRemesh::TetMeshFacetedClosedSurfaceForRemesh}}(}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00041}00041     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<Node*>}} \textcolor{keyword}{const}\& vertex\_node\_pt,}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00042}00042     \mbox{\hyperlink{classoomph_1_1Vector}{Vector}}<\mbox{\hyperlink{classoomph_1_1Vector}{Vector<unsigned>}}> \textcolor{keyword}{const}\& facet\_connectivity,}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00043}00043     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<unsigned>}} \textcolor{keyword}{const}\& facet\_boundary\_id)}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00044}00044     : \mbox{\hyperlink{classoomph_1_1TetMeshFacetedClosedSurface}{TetMeshFacetedClosedSurface}}()}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00045}00045   \{}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00046}00046     \textcolor{comment}{// Create the vertices}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00047}00047     \textcolor{keywordtype}{unsigned} n\_vertex = vertex\_node\_pt.size();}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00048}00048     \mbox{\hyperlink{classoomph_1_1TetMeshFacetedSurface_a5a755b2062fa4ed18f3bdd18236b0f72}{Vertex\_pt}}.resize(n\_vertex);}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00049}00049     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} v = 0; v < n\_vertex; ++v)}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00050}00050     \{}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00051}00051       \mbox{\hyperlink{classoomph_1_1TetMeshFacetedSurface_a5a755b2062fa4ed18f3bdd18236b0f72}{Vertex\_pt}}[v] = \textcolor{keyword}{new} \mbox{\hyperlink{classoomph_1_1TetMeshVertex}{TetMeshVertex}}(vertex\_node\_pt[v]);}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00052}00052     \}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00053}00053 }
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00054}00054     \textcolor{comment}{// Create the facets}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00055}00055     \textcolor{keywordtype}{unsigned} n\_facet = facet\_connectivity.size();}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00056}00056     \mbox{\hyperlink{classoomph_1_1TetMeshFacetedSurface_a84ddd979ab9031b80c6328b150669986}{Facet\_pt}}.resize(n\_facet);}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00057}00057     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{namespaceoomph_ad835af913df4cbdc5648440f91b794ab}{f}} = 0; \mbox{\hyperlink{namespaceoomph_ad835af913df4cbdc5648440f91b794ab}{f}} < n\_facet; ++\mbox{\hyperlink{namespaceoomph_ad835af913df4cbdc5648440f91b794ab}{f}})}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00058}00058     \{}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00059}00059       \textcolor{keywordtype}{unsigned} n\_vertex\_on\_facet = facet\_connectivity[\mbox{\hyperlink{namespaceoomph_ad835af913df4cbdc5648440f91b794ab}{f}}].size();}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00060}00060       \mbox{\hyperlink{classoomph_1_1TetMeshFacetedSurface_a84ddd979ab9031b80c6328b150669986}{Facet\_pt}}[\mbox{\hyperlink{namespaceoomph_ad835af913df4cbdc5648440f91b794ab}{f}}] = \textcolor{keyword}{new} \mbox{\hyperlink{classoomph_1_1TetMeshFacet}{TetMeshFacet}}(n\_vertex\_on\_facet);}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00061}00061       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < n\_vertex\_on\_facet; ++\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}})}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00062}00062       \{}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00063}00063         \mbox{\hyperlink{classoomph_1_1TetMeshFacetedSurface_a84ddd979ab9031b80c6328b150669986}{Facet\_pt}}[\mbox{\hyperlink{namespaceoomph_ad835af913df4cbdc5648440f91b794ab}{f}}]-\/>set\_vertex\_pt(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}, \mbox{\hyperlink{classoomph_1_1TetMeshFacetedSurface_a5a755b2062fa4ed18f3bdd18236b0f72}{Vertex\_pt}}[facet\_connectivity[\mbox{\hyperlink{namespaceoomph_ad835af913df4cbdc5648440f91b794ab}{f}}][\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]]);}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00064}00064       \}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00065}00065       \textcolor{comment}{// Add in the boundary id}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00066}00066       \mbox{\hyperlink{classoomph_1_1TetMeshFacetedSurface_a84ddd979ab9031b80c6328b150669986}{Facet\_pt}}[\mbox{\hyperlink{namespaceoomph_ad835af913df4cbdc5648440f91b794ab}{f}}]-\/>set\_one\_based\_boundary\_id(facet\_boundary\_id[\mbox{\hyperlink{namespaceoomph_ad835af913df4cbdc5648440f91b794ab}{f}}]);}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00067}00067     \}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00068}00068   \}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00069}00069 }
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00070}00070   \textcolor{comment}{//=================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00071}00071 \textcolor{comment}{  /// Destructor. Delete allocated memory}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00072}00072 \textcolor{comment}{}  \textcolor{comment}{//================================================================}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00073}\mbox{\hyperlink{classoomph_1_1TetMeshFacetedClosedSurfaceForRemesh_a25c25f16a18e2ff4551a4683fbdb3686}{00073}}   \mbox{\hyperlink{classoomph_1_1TetMeshFacetedClosedSurfaceForRemesh_a25c25f16a18e2ff4551a4683fbdb3686}{TetMeshFacetedClosedSurfaceForRemesh::\string~TetMeshFacetedClosedSurfaceForRemesh}}()}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00074}00074   \{}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00075}00075     \textcolor{comment}{// Delete the facets and the vertices}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00076}00076     \textcolor{keywordtype}{unsigned} n\_facet = this-\/>\mbox{\hyperlink{classoomph_1_1TetMeshFacetedSurface_a6036f2a5e11bea9d72f9bba9a89faec7}{nfacet}}();}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00077}00077     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{namespaceoomph_ad835af913df4cbdc5648440f91b794ab}{f}} = 0; \mbox{\hyperlink{namespaceoomph_ad835af913df4cbdc5648440f91b794ab}{f}} < n\_facet; \mbox{\hyperlink{namespaceoomph_ad835af913df4cbdc5648440f91b794ab}{f}}++)}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00078}00078     \{}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00079}00079       \textcolor{keyword}{delete} \mbox{\hyperlink{classoomph_1_1TetMeshFacetedSurface_a84ddd979ab9031b80c6328b150669986}{Facet\_pt}}[\mbox{\hyperlink{namespaceoomph_ad835af913df4cbdc5648440f91b794ab}{f}}];}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00080}00080     \}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00081}00081     \textcolor{keywordtype}{unsigned} n\_vertex = this-\/>\mbox{\hyperlink{classoomph_1_1TetMeshFacetedSurface_aae77dfb3a856e3840564e21716f4c3b1}{nvertex}}();}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00082}00082     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} v = 0; v < n\_vertex; v++)}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00083}00083     \{}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00084}00084       \textcolor{keyword}{delete} \mbox{\hyperlink{classoomph_1_1TetMeshFacetedSurface_a5a755b2062fa4ed18f3bdd18236b0f72}{Vertex\_pt}}[v];}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00085}00085     \}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00086}00086   \}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00087}00087 }
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00088}00088 }
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00089}00089   \textcolor{comment}{//================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00090}00090 \textcolor{comment}{  /// Global static data that specifies the permitted}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00091}00091 \textcolor{comment}{  /// error in the setup of the boundary coordinates}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00092}00092 \textcolor{comment}{}  \textcolor{comment}{//================================================================}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00093}00093   \textcolor{keywordtype}{double} \mbox{\hyperlink{classoomph_1_1TetMeshBase_a8ec167eda551633acb8896cb0e87be40}{TetMeshBase::Tolerance\_for\_boundary\_finding}} = 1.0e-\/5;}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00094}00094 }
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00095}00095 }
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00096}00096   \textcolor{comment}{//================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00097}00097 \textcolor{comment}{  /// Setup lookup schemes which establish which elements are located}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00098}00098 \textcolor{comment}{  /// next to which boundaries (Doc to outfile if it's open).}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00099}00099 \textcolor{comment}{}  \textcolor{comment}{//================================================================}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00100}\mbox{\hyperlink{classoomph_1_1TetMeshBase_a5982b96584e7f60eeb62f51153ef29f4}{00100}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1TetMeshBase_ac372c93f2834c864f7376f1aceda718f}{TetMeshBase::setup\_boundary\_element\_info}}(std::ostream\& outfile)}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00101}00101   \{}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00102}00102     \textcolor{comment}{// Should we document the output here}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00103}00103     \textcolor{keywordtype}{bool} \mbox{\hyperlink{namespaceoomph_1_1LeakCheckNames_ad5ef7bca3a63e643b0eec22dd3bab58b}{doc}} = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00104}00104 }
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00105}00105     \textcolor{keywordflow}{if} (outfile) \mbox{\hyperlink{namespaceoomph_1_1LeakCheckNames_ad5ef7bca3a63e643b0eec22dd3bab58b}{doc}} = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00106}00106 }
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00107}00107     \textcolor{comment}{// Number of boundaries}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00108}00108     \textcolor{keywordtype}{unsigned} nbound = \mbox{\hyperlink{classoomph_1_1Mesh_a84543564d6babe4faacbb9d87043fc19}{nboundary}}();}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00109}00109 }
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00110}00110     \textcolor{comment}{// Wipe/allocate storage for arrays}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00111}00111     \mbox{\hyperlink{classoomph_1_1Mesh_a266ac14a3e884f978c8605f7b5786e81}{Boundary\_element\_pt}}.clear();}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00112}00112     \mbox{\hyperlink{classoomph_1_1Mesh_a62adbe45fe65ff9cd329bb45d197347c}{Face\_index\_at\_boundary}}.clear();}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00113}00113     \mbox{\hyperlink{classoomph_1_1Mesh_a266ac14a3e884f978c8605f7b5786e81}{Boundary\_element\_pt}}.resize(nbound);}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00114}00114     \mbox{\hyperlink{classoomph_1_1Mesh_a62adbe45fe65ff9cd329bb45d197347c}{Face\_index\_at\_boundary}}.resize(nbound);}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00115}00115     \mbox{\hyperlink{classoomph_1_1Mesh_a37f6d27447f643a74694012b09350ce9}{Lookup\_for\_elements\_next\_boundary\_is\_setup}} = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00116}00116 }
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00117}00117     \textcolor{comment}{// Temporary vector of vectors of pointers to elements on the boundaries:}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00118}00118     \textcolor{comment}{// This is a vector to ensure UNIQUE ordering in all processors}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00119}00119     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<Vector<FiniteElement*>}}> vector\_of\_boundary\_element\_pt;}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00120}00120     vector\_of\_boundary\_element\_pt.resize(nbound);}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00121}00121 }
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00122}00122     \textcolor{comment}{// Matrix map for working out the fixed face for elements on boundary}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00123}00123     \mbox{\hyperlink{classoomph_1_1MapMatrixMixed}{MapMatrixMixed<unsigned, FiniteElement*, int>}} face\_identifier;}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00124}00124 }
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00125}00125     \textcolor{comment}{// Loop over elements}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00126}00126     \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00127}00127     \textcolor{keywordtype}{unsigned} nel = \mbox{\hyperlink{classoomph_1_1Mesh_af01dfefb66c15579b540be62999d93ee}{nelement}}();}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00128}00128 }
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00129}00129 }
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00130}00130     \textcolor{comment}{// Get pointer to vector of boundaries that the}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00131}00131     \textcolor{comment}{// node lives on}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00132}00132     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<std::set<unsigned>}}*> boundaries\_pt(4, 0);}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00133}00133 }
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00134}00134     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} = 0; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} < nel; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}++)}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00135}00135     \{}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00136}00136       \textcolor{comment}{// Get pointer to element}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00137}00137       \mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}* fe\_pt = \mbox{\hyperlink{classoomph_1_1Mesh_a479059b0964826a8cee6eb506b57268a}{finite\_element\_pt}}(\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}});}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00138}00138 }
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00139}00139       \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespaceoomph_1_1LeakCheckNames_ad5ef7bca3a63e643b0eec22dd3bab58b}{doc}}) outfile << \textcolor{stringliteral}{"{}Element: "{}} << \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} << \textcolor{stringliteral}{"{} "{}} << fe\_pt << std::endl;}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00140}00140 }
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00141}00141       \textcolor{comment}{// Only include 3D elements! Some meshes contain interface elements too.}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00142}00142       \textcolor{keywordflow}{if} (fe\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a5f8fe59f06da1da9f6b7bbcbdb90ef93}{dim}}() == 3)}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00143}00143       \{}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00144}00144         \textcolor{comment}{// Loop over the element's nodes and find out which boundaries they're}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00145}00145         \textcolor{comment}{// on}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00146}00146         \textcolor{comment}{// -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00147}00147         \textcolor{comment}{// We need only loop over the corner nodes}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00148}00148         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < 4; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00149}00149         \{}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00150}00150           fe\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a9addfe893ab8205619963aa96204cdc4}{node\_pt}}(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}})-\/>get\_boundaries\_pt(boundaries\_pt[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]);}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00151}00151         \}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00152}00152 }
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00153}00153         \textcolor{comment}{// Find the common boundaries of each face}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00154}00154         \mbox{\hyperlink{classoomph_1_1Vector}{Vector<std::set<unsigned>}}> face(4);}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00155}00155 }
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00156}00156         \textcolor{comment}{// NOTE: Face indices defined in Telements.h}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00157}00157 }
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00158}00158         \textcolor{comment}{// Face 3 connnects points 0, 1 and 2}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00159}00159         \textcolor{keywordflow}{if} (boundaries\_pt[0] \&\& boundaries\_pt[1] \&\& boundaries\_pt[2])}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00160}00160         \{}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00161}00161           std::set<unsigned> aux;}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00162}00162 }
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00163}00163           std::set\_intersection(}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00164}00164             boundaries\_pt[0]-\/>begin(),}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00165}00165             boundaries\_pt[0]-\/>end(),}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00166}00166             boundaries\_pt[1]-\/>begin(),}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00167}00167             boundaries\_pt[1]-\/>end(),}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00168}00168             std::insert\_iterator<std::set<unsigned>>(aux, aux.begin()));}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00169}00169 }
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00170}00170           std::set\_intersection(}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00171}00171             aux.begin(),}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00172}00172             aux.end(),}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00173}00173             boundaries\_pt[2]-\/>begin(),}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00174}00174             boundaries\_pt[2]-\/>end(),}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00175}00175             std::insert\_iterator<std::set<unsigned>>(face[3], face[3].begin()));}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00176}00176         \}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00177}00177 }
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00178}00178         \textcolor{comment}{// Face 2 connects points 0, 1 and 3}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00179}00179         \textcolor{keywordflow}{if} (boundaries\_pt[0] \&\& boundaries\_pt[1] \&\& boundaries\_pt[3])}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00180}00180         \{}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00181}00181           std::set<unsigned> aux;}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00182}00182 }
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00183}00183           std::set\_intersection(}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00184}00184             boundaries\_pt[0]-\/>begin(),}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00185}00185             boundaries\_pt[0]-\/>end(),}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00186}00186             boundaries\_pt[1]-\/>begin(),}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00187}00187             boundaries\_pt[1]-\/>end(),}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00188}00188             std::insert\_iterator<std::set<unsigned>>(aux, aux.begin()));}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00189}00189 }
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00190}00190           std::set\_intersection(}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00191}00191             aux.begin(),}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00192}00192             aux.end(),}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00193}00193             boundaries\_pt[3]-\/>begin(),}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00194}00194             boundaries\_pt[3]-\/>end(),}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00195}00195             std::insert\_iterator<std::set<unsigned>>(face[2], face[2].begin()));}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00196}00196         \}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00197}00197 }
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00198}00198         \textcolor{comment}{// Face 1 connects points 0, 2 and 3}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00199}00199         \textcolor{keywordflow}{if} (boundaries\_pt[0] \&\& boundaries\_pt[2] \&\& boundaries\_pt[3])}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00200}00200         \{}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00201}00201           std::set<unsigned> aux;}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00202}00202 }
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00203}00203           std::set\_intersection(}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00204}00204             boundaries\_pt[0]-\/>begin(),}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00205}00205             boundaries\_pt[0]-\/>end(),}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00206}00206             boundaries\_pt[2]-\/>begin(),}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00207}00207             boundaries\_pt[2]-\/>end(),}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00208}00208             std::insert\_iterator<std::set<unsigned>>(aux, aux.begin()));}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00209}00209 }
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00210}00210           std::set\_intersection(}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00211}00211             aux.begin(),}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00212}00212             aux.end(),}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00213}00213             boundaries\_pt[3]-\/>begin(),}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00214}00214             boundaries\_pt[3]-\/>end(),}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00215}00215             std::insert\_iterator<std::set<unsigned>>(face[1], face[1].begin()));}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00216}00216         \}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00217}00217 }
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00218}00218         \textcolor{comment}{// Face 0 connects points 1, 2 and 3}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00219}00219         \textcolor{keywordflow}{if} (boundaries\_pt[1] \&\& boundaries\_pt[2] \&\& boundaries\_pt[3])}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00220}00220         \{}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00221}00221           std::set<unsigned> aux;}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00222}00222 }
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00223}00223           std::set\_intersection(}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00224}00224             boundaries\_pt[1]-\/>begin(),}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00225}00225             boundaries\_pt[1]-\/>end(),}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00226}00226             boundaries\_pt[2]-\/>begin(),}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00227}00227             boundaries\_pt[2]-\/>end(),}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00228}00228             std::insert\_iterator<std::set<unsigned>>(aux, aux.begin()));}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00229}00229 }
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00230}00230           std::set\_intersection(}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00231}00231             aux.begin(),}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00232}00232             aux.end(),}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00233}00233             boundaries\_pt[3]-\/>begin(),}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00234}00234             boundaries\_pt[3]-\/>end(),}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00235}00235             std::insert\_iterator<std::set<unsigned>>(face[0], face[0].begin()));}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00236}00236         \}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00237}00237 }
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00238}00238 }
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00239}00239         \textcolor{comment}{// We now know whether any faces lay on the boundaries}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00240}00240         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < 4; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00241}00241         \{}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00242}00242           \textcolor{comment}{// How many boundaries are there}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00243}00243           \textcolor{keywordtype}{unsigned} count = 0;}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00244}00244 }
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00245}00245           \textcolor{comment}{// The number of the boundary}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00246}00246           \textcolor{keywordtype}{int} boundary = -\/1;}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00247}00247 }
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00248}00248           \textcolor{comment}{// Loop over all the members of the set and add to the count}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00249}00249           \textcolor{comment}{// and set the boundary}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00250}00250           \textcolor{keywordflow}{for} (std::set<unsigned>::iterator it = face[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}].begin();}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00251}00251                it != face[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}].end();}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00252}00252                ++it)}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00253}00253           \{}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00254}00254             ++count;}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00255}00255             boundary = *it;}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00256}00256           \}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00257}00257 }
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00258}00258           \textcolor{comment}{// If we're on more than one boundary, this is weird, so die}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00259}00259           \textcolor{keywordflow}{if} (count > 1)}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00260}00260           \{}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00261}00261             std::ostringstream error\_stream;}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00262}00262             fe\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a2ad98a3d2ef4999f1bef62c0ff13f2a7}{output}}(error\_stream);}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00263}00263             error\_stream << \textcolor{stringliteral}{"{}Face "{}} << \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} << \textcolor{stringliteral}{"{} is on "{}} << count}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00264}00264                          << \textcolor{stringliteral}{"{} boundaries.\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00265}00265             error\_stream << \textcolor{stringliteral}{"{}This is rather strange.\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00266}00266             error\_stream << \textcolor{stringliteral}{"{}Your mesh may be too coarse or your tet mesh\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00267}00267             error\_stream << \textcolor{stringliteral}{"{}may be screwed up. I'm skipping the automated\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00268}00268             error\_stream << \textcolor{stringliteral}{"{}setup of the elements next to the boundaries\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00269}00269             error\_stream << \textcolor{stringliteral}{"{}lookup schemes.\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00270}00270             \mbox{\hyperlink{classoomph_1_1OomphLibWarning}{OomphLibWarning}}(error\_stream.str(),}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00271}00271                             OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00272}00272                             OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00273}00273           \}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00274}00274 }
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00275}00275           \textcolor{comment}{// If we have a boundary then add this to the appropriate set}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00276}00276           \textcolor{keywordflow}{if} (boundary >= 0)}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00277}00277           \{}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00278}00278             \textcolor{comment}{// Does the pointer already exits in the vector}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00279}00279             \mbox{\hyperlink{classoomph_1_1Vector}{Vector<FiniteElement*>::iterator}} b\_el\_it = std::find(}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00280}00280               vector\_of\_boundary\_element\_pt[\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{unsigned}\textcolor{keyword}{>}(boundary)]}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00281}00281                 .begin(),}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00282}00282               vector\_of\_boundary\_element\_pt[\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{unsigned}\textcolor{keyword}{>}(boundary)]}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00283}00283                 .end(),}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00284}00284               fe\_pt);}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00285}00285 }
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00286}00286             \textcolor{comment}{// Only insert if we have not found it (i.e. got to the end)}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00287}00287             \textcolor{keywordflow}{if} (b\_el\_it ==}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00288}00288                 vector\_of\_boundary\_element\_pt[\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{unsigned}\textcolor{keyword}{>}(boundary)]}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00289}00289                   .end())}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00290}00290             \{}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00291}00291               vector\_of\_boundary\_element\_pt[\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{unsigned}\textcolor{keyword}{>}(boundary)]}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00292}00292                 .push\_back(fe\_pt);}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00293}00293             \}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00294}00294 }
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00295}00295             \textcolor{comment}{// Also set the fixed face}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00296}00296             face\_identifier(\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{unsigned}\textcolor{keyword}{>}(boundary), fe\_pt) = \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}};}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00297}00297           \}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00298}00298         \}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00299}00299 }
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00300}00300         \textcolor{comment}{// Now we set the pointers to the boundary sets to zero}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00301}00301         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < 4; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00302}00302         \{}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00303}00303           boundaries\_pt[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] = 0;}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00304}00304         \}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00305}00305       \}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00306}00306     \}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00307}00307 }
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00308}00308     \textcolor{comment}{// Now copy everything across into permanent arrays}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00309}00309     \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00310}00310 }
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00311}00311     \textcolor{comment}{// Loop over boundaries}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00312}00312     \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00313}00313     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < nbound; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00314}00314     \{}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00315}00315       \textcolor{comment}{// Number of elements on this boundary (currently stored in a set)}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00316}00316       \textcolor{keywordtype}{unsigned} nel = vector\_of\_boundary\_element\_pt[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}].size();}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00317}00317 }
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00318}00318       \textcolor{comment}{// Allocate storage for the coordinate identifiers}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00319}00319       \mbox{\hyperlink{classoomph_1_1Mesh_a62adbe45fe65ff9cd329bb45d197347c}{Face\_index\_at\_boundary}}[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}].resize(nel);}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00320}00320 }
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00321}00321       \textcolor{keywordtype}{unsigned} e\_count = 0;}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00322}00322       \textcolor{keyword}{typedef} \mbox{\hyperlink{classoomph_1_1Vector}{Vector<FiniteElement*>::iterator}} IT;}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00323}00323       \textcolor{keywordflow}{for} (IT it = vector\_of\_boundary\_element\_pt[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}].begin();}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00324}00324            it != vector\_of\_boundary\_element\_pt[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}].end();}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00325}00325            it++)}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00326}00326       \{}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00327}00327         \textcolor{comment}{// Recover pointer to element}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00328}00328         \mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}* fe\_pt = *it;}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00329}00329 }
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00330}00330         \textcolor{comment}{// Add to permanent storage}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00331}00331         \mbox{\hyperlink{classoomph_1_1Mesh_a266ac14a3e884f978c8605f7b5786e81}{Boundary\_element\_pt}}[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}].push\_back(fe\_pt);}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00332}00332 }
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00333}00333         \mbox{\hyperlink{classoomph_1_1Mesh_a62adbe45fe65ff9cd329bb45d197347c}{Face\_index\_at\_boundary}}[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}][e\_count] = face\_identifier(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}, fe\_pt);}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00334}00334 }
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00335}00335         \textcolor{comment}{// Increment counter}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00336}00336         e\_count++;}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00337}00337       \}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00338}00338     \}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00339}00339 }
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00340}00340 }
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00341}00341     \textcolor{comment}{// Doc?}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00342}00342     \textcolor{comment}{//-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00343}00343     \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespaceoomph_1_1LeakCheckNames_ad5ef7bca3a63e643b0eec22dd3bab58b}{doc}})}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00344}00344     \{}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00345}00345       \textcolor{comment}{// Loop over boundaries}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00346}00346       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < nbound; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00347}00347       \{}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00348}00348         \textcolor{keywordtype}{unsigned} nel = \mbox{\hyperlink{classoomph_1_1Mesh_a266ac14a3e884f978c8605f7b5786e81}{Boundary\_element\_pt}}[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}].size();}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00349}00349         outfile << \textcolor{stringliteral}{"{}Boundary: "{}} << \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} << \textcolor{stringliteral}{"{} is adjacent to "{}} << nel << \textcolor{stringliteral}{"{} elements"{}}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00350}00350                 << std::endl;}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00351}00351 }
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00352}00352         \textcolor{comment}{// Loop over elements on given boundary}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00353}00353         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} = 0; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} < nel; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}++)}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00354}00354         \{}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00355}00355           \mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}* fe\_pt = \mbox{\hyperlink{classoomph_1_1Mesh_a266ac14a3e884f978c8605f7b5786e81}{Boundary\_element\_pt}}[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}][\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}];}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00356}00356           outfile << \textcolor{stringliteral}{"{}Boundary element:"{}} << fe\_pt}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00357}00357                   << \textcolor{stringliteral}{"{} Face index of boundary is "{}}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00358}00358                   << \mbox{\hyperlink{classoomph_1_1Mesh_a62adbe45fe65ff9cd329bb45d197347c}{Face\_index\_at\_boundary}}[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}][\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}] << std::endl;}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00359}00359         \}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00360}00360       \}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00361}00361     \}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00362}00362 }
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00363}00363 }
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00364}00364     \textcolor{comment}{// Lookup scheme has now been setup yet}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00365}00365     \mbox{\hyperlink{classoomph_1_1Mesh_a37f6d27447f643a74694012b09350ce9}{Lookup\_for\_elements\_next\_boundary\_is\_setup}} = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00366}00366   \}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00367}00367 }
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00368}00368 }
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00369}00369   \textcolor{comment}{//======================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00370}00370 \textcolor{comment}{  /// Assess mesh quality: Ratio of max. edge length to min. height,}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00371}00371 \textcolor{comment}{  /// so if it's very large it's BAAAAAD.}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00372}00372 \textcolor{comment}{}  \textcolor{comment}{//======================================================================}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00373}\mbox{\hyperlink{classoomph_1_1TetMeshBase_aa8b4e18d5f358a5bc64151861d990ca3}{00373}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1TetMeshBase_aa8b4e18d5f358a5bc64151861d990ca3}{TetMeshBase::assess\_mesh\_quality}}(std::ofstream\& some\_file)}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00374}00374   \{}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00375}00375     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<Vector<double>}}> edge(6);}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00376}00376     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} = 0; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} < 6; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}++)}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00377}00377     \{}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00378}00378       edge[\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}].resize(3);}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00379}00379     \}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00380}00380     \textcolor{keywordtype}{unsigned} nel = this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_af01dfefb66c15579b540be62999d93ee}{nelement}}();}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00381}00381     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} = 0; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} < nel; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}++)}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00382}00382     \{}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00383}00383       \mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}* fe\_pt = this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a479059b0964826a8cee6eb506b57268a}{finite\_element\_pt}}(\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}});}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00384}00384       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < 3; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00385}00385       \{}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00386}00386         edge[0][\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] = fe\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a9addfe893ab8205619963aa96204cdc4}{node\_pt}}(2)-\/>x(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) -\/ fe\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a9addfe893ab8205619963aa96204cdc4}{node\_pt}}(1)-\/>x(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}});}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00387}00387         edge[1][\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] = fe\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a9addfe893ab8205619963aa96204cdc4}{node\_pt}}(0)-\/>x(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) -\/ fe\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a9addfe893ab8205619963aa96204cdc4}{node\_pt}}(2)-\/>x(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}});}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00388}00388         edge[2][\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] = fe\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a9addfe893ab8205619963aa96204cdc4}{node\_pt}}(1)-\/>x(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) -\/ fe\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a9addfe893ab8205619963aa96204cdc4}{node\_pt}}(0)-\/>x(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}});}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00389}00389         edge[3][\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] = fe\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a9addfe893ab8205619963aa96204cdc4}{node\_pt}}(3)-\/>x(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) -\/ fe\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a9addfe893ab8205619963aa96204cdc4}{node\_pt}}(0)-\/>x(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}});}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00390}00390         edge[4][\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] = fe\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a9addfe893ab8205619963aa96204cdc4}{node\_pt}}(3)-\/>x(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) -\/ fe\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a9addfe893ab8205619963aa96204cdc4}{node\_pt}}(1)-\/>x(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}});}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00391}00391         edge[5][\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] = fe\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a9addfe893ab8205619963aa96204cdc4}{node\_pt}}(3)-\/>x(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) -\/ fe\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a9addfe893ab8205619963aa96204cdc4}{node\_pt}}(2)-\/>x(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}});}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00392}00392       \}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00393}00393 }
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00394}00394       \textcolor{keywordtype}{double} max\_length = 0.0;}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00395}00395       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < 6; j++)}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00396}00396       \{}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00397}00397         \textcolor{keywordtype}{double} length = 0.0;}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00398}00398         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < 3; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00399}00399         \{}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00400}00400           length += edge[j][\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] * edge[j][\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}];}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00401}00401         \}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00402}00402         length = sqrt(length);}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00403}00403         \textcolor{keywordflow}{if} (length > max\_length) max\_length = length;}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00404}00404       \}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00405}00405 }
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00406}00406 }
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00407}00407       \textcolor{keywordtype}{double} min\_height = DBL\_MAX;}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00408}00408       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < 4; j++)}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00409}00409       \{}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00410}00410         \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} normal(3);}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00411}00411         \textcolor{keywordtype}{unsigned} e0 = 0;}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00412}00412         \textcolor{keywordtype}{unsigned} e1 = 0;}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00413}00413         \textcolor{keywordtype}{unsigned} e2 = 0;}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00414}00414         \textcolor{keywordflow}{switch} (j)}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00415}00415         \{}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00416}00416           \textcolor{keywordflow}{case} 0:}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00417}00417             e0 = 4;}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00418}00418             e1 = 5;}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00419}00419             e2 = 1;}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00420}00420             \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00421}00421 }
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00422}00422           \textcolor{keywordflow}{case} 1:}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00423}00423             e0 = 1;}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00424}00424             e1 = 3;}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00425}00425             e2 = 2;}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00426}00426             \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00427}00427 }
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00428}00428           \textcolor{keywordflow}{case} 2:}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00429}00429             e0 = 3;}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00430}00430             e1 = 4;}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00431}00431             e2 = 1;}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00432}00432             \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00433}00433 }
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00434}00434           \textcolor{keywordflow}{case} 3:}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00435}00435             e0 = 1;}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00436}00436             e1 = 2;}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00437}00437             e2 = 3;}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00438}00438             \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00439}00439 }
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00440}00440           \textcolor{keywordflow}{default}:}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00441}00441 }
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00442}00442             \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{}never get here\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00443}00443             abort();}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00444}00444         \}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00445}00445 }
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00446}00446         normal[0] = edge[e0][1] * edge[e1][2] -\/ edge[e0][2] * edge[e1][1];}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00447}00447         normal[1] = edge[e0][2] * edge[e1][0] -\/ edge[e0][0] * edge[e1][2];}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00448}00448         normal[2] = edge[e0][0] * edge[e1][1] -\/ edge[e0][1] * edge[e1][0];}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00449}00449         \textcolor{keywordtype}{double} norm =}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00450}00450           normal[0] * normal[0] + normal[1] * normal[1] + normal[2] * normal[2];}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00451}00451         \textcolor{keywordtype}{double} inv\_norm = 1.0 / sqrt(norm);}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00452}00452         normal[0] *= inv\_norm;}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00453}00453         normal[1] *= inv\_norm;}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00454}00454         normal[2] *= inv\_norm;}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00455}00455 }
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00456}00456         \textcolor{keywordtype}{double} height = fabs(edge[e2][0] * normal[0] + edge[e2][1] * normal[1] +}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00457}00457                              edge[e2][2] * normal[2]);}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00458}00458 }
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00459}00459         \textcolor{keywordflow}{if} (height < min\_height) min\_height = height;}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00460}00460       \}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00461}00461 }
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00462}00462       \textcolor{keywordtype}{double} aspect\_ratio = max\_length / min\_height;}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00463}00463 }
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00464}00464       some\_file << \textcolor{stringliteral}{"{}ZONE N=4, E=1, F=FEPOINT, ET=TETRAHEDRON\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00465}00465       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < 4; j++)}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00466}00466       \{}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00467}00467         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < 3; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00468}00468         \{}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00469}00469           some\_file << fe\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a9addfe893ab8205619963aa96204cdc4}{node\_pt}}(j)-\/>x(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) << \textcolor{stringliteral}{"{} "{}};}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00470}00470         \}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00471}00471         some\_file << aspect\_ratio << std::endl;}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00472}00472       \}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00473}00473       some\_file << \textcolor{stringliteral}{"{}1 2 3 4"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00474}00474     \}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00475}00475   \}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00476}00476 }
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00477}00477 }
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00478}00478   \textcolor{comment}{//======================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00479}00479 \textcolor{comment}{  /// Move the nodes on boundaries with associated Geometric Objects (if any)}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00480}00480 \textcolor{comment}{  /// so that they exactly coincide with the geometric object. This requires}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00481}00481 \textcolor{comment}{  /// that the boundary coordinates are set up consistently}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00482}00482 \textcolor{comment}{}  \textcolor{comment}{//======================================================================}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00483}\mbox{\hyperlink{classoomph_1_1TetMeshBase_a1670b81c0ed5509661c179d9e46bdd1c}{00483}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1TetMeshBase_a1670b81c0ed5509661c179d9e46bdd1c}{TetMeshBase::snap\_nodes\_onto\_geometric\_objects}}()}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00484}00484   \{}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00485}00485     \textcolor{comment}{// Backup in case elements get inverted}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00486}00486     std::map<Node*, Vector<double>> old\_nodal\_posn;}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00487}00487     std::map<Node*, Vector<double>> new\_nodal\_posn;}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00488}00488     \textcolor{keywordtype}{unsigned} nnod = \mbox{\hyperlink{classoomph_1_1Mesh_a945e7823d1a2af243b5b7f7866aaff5e}{nnode}}();}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00489}00489     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < nnod; j++)}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00490}00490     \{}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00491}00491       Node* nod\_pt = \mbox{\hyperlink{classoomph_1_1Mesh_a69d22c2070f1649c4cb2607f26070d7c}{node\_pt}}(j);}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00492}00492       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} \mbox{\hyperlink{namespaceoomph_a9d1d2da2b8bb8e73af72b5cadb8fe97c}{x}}(3);}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00493}00493       nod\_pt-\/>position(\mbox{\hyperlink{namespaceoomph_a9d1d2da2b8bb8e73af72b5cadb8fe97c}{x}});}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00494}00494       old\_nodal\_posn[nod\_pt] = \mbox{\hyperlink{namespaceoomph_a9d1d2da2b8bb8e73af72b5cadb8fe97c}{x}};}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00495}00495     \}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00496}00496 }
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00497}00497     \textcolor{comment}{// Loop over all boundaries}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00498}00498     \textcolor{keywordtype}{unsigned} n\_bound = this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a84543564d6babe4faacbb9d87043fc19}{nboundary}}();}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00499}00499     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} b = 0; b < n\_bound; b++)}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00500}00500     \{}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00501}00501       \textcolor{keywordtype}{bool} do\_it = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00502}00502 }
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00503}00503       \textcolor{comment}{// Accumulate reason for not snapping}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00504}00504       std::stringstream reason;}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00505}00505       reason << \textcolor{stringliteral}{"{}Can't snap nodes on boundary "{}} << b}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00506}00506              << \textcolor{stringliteral}{"{} onto geom object because: \(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00507}00507 }
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00508}00508       \mbox{\hyperlink{classoomph_1_1TetMeshFacetedSurface}{TetMeshFacetedSurface}}* faceted\_surface\_pt = 0;}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00509}00509       std::map<unsigned, TetMeshFacetedSurface*>::iterator it =}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00510}00510         \mbox{\hyperlink{classoomph_1_1TetMeshBase_a6ac02bd3a8ba954a82e14fe3d120c62b}{Tet\_mesh\_faceted\_surface\_pt}}.find(b);}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00511}00511       \textcolor{keywordflow}{if} (it != \mbox{\hyperlink{classoomph_1_1TetMeshBase_a6ac02bd3a8ba954a82e14fe3d120c62b}{Tet\_mesh\_faceted\_surface\_pt}}.end())}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00512}00512       \{}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00513}00513         faceted\_surface\_pt = (*it).second;}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00514}00514       \}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00515}00515 }
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00516}00516       \textcolor{comment}{// Facet associated with this boundary?}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00517}00517       \textcolor{keywordflow}{if} (faceted\_surface\_pt == 0)}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00518}00518       \{}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00519}00519         reason << \textcolor{stringliteral}{"{}-\/-\/ no facets asssociated with boundary\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00520}00520         do\_it = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00521}00521       \}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00522}00522 }
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00523}00523       \textcolor{comment}{// Get geom object associated with facet}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00524}00524       \mbox{\hyperlink{classoomph_1_1GeomObject}{GeomObject}}* geom\_obj\_pt = 0;}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00525}00525       \textcolor{keywordflow}{if} (do\_it)}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00526}00526       \{}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00527}00527         geom\_obj\_pt = faceted\_surface\_pt-\/>\mbox{\hyperlink{classoomph_1_1TetMeshFacetedSurface_aa91cc535194a675b82d9360a1c7e11d9}{geom\_object\_with\_boundaries\_pt}}();}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00528}00528         \textcolor{keywordflow}{if} (geom\_obj\_pt == 0)}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00529}00529         \{}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00530}00530           reason << \textcolor{stringliteral}{"{}-\/-\/ no geom object associated with boundary\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00531}00531           do\_it = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00532}00532         \}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00533}00533       \}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00534}00534 }
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00535}00535       \textcolor{comment}{// Triangular facet?}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00536}00536       \textcolor{keywordflow}{if} (\mbox{\hyperlink{classoomph_1_1TetMeshBase_acc7c8edda4f0f95cd8894620379905d5}{Triangular\_facet\_vertex\_boundary\_coordinate}}[b].size() == 0)}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00537}00537       \{}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00538}00538         reason << \textcolor{stringliteral}{"{}-\/-\/ facet has to be triangular and vertex coordinates have\(\backslash\)n"{}}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00539}00539                << \textcolor{stringliteral}{"{}   to have been set up\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00540}00540         do\_it = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00541}00541       \}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00542}00542 }
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00543}00543       \textcolor{comment}{// We need boundary coordinates!}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00544}00544       \textcolor{keywordflow}{if} (!\mbox{\hyperlink{classoomph_1_1Mesh_a412a5051be9e81f0ba61bf85e5abc4a6}{Boundary\_coordinate\_exists}}[b])}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00545}00545       \{}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00546}00546         reason << \textcolor{stringliteral}{"{}-\/-\/ no boundary coordinates were set up\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00547}00547         do\_it = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00548}00548       \}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00549}00549 }
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00550}00550 }
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00551}00551       \textcolor{comment}{// Which facet is associated with this boundary?}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00552}00552       \textcolor{keywordtype}{unsigned} facet\_id\_of\_boundary = 0;}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00553}00553       \mbox{\hyperlink{classoomph_1_1TetMeshFacet}{TetMeshFacet}}* f\_pt = 0;}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00554}00554       \textcolor{keywordflow}{if} (do\_it)}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00555}00555       \{}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00556}00556         \textcolor{keywordtype}{unsigned} nf = faceted\_surface\_pt-\/>\mbox{\hyperlink{classoomph_1_1TetMeshFacetedSurface_a6036f2a5e11bea9d72f9bba9a89faec7}{nfacet}}();}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00557}00557         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{namespaceoomph_ad835af913df4cbdc5648440f91b794ab}{f}} = 0; \mbox{\hyperlink{namespaceoomph_ad835af913df4cbdc5648440f91b794ab}{f}} < nf; \mbox{\hyperlink{namespaceoomph_ad835af913df4cbdc5648440f91b794ab}{f}}++)}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00558}00558         \{}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00559}00559           \textcolor{keywordflow}{if} ((faceted\_surface\_pt-\/>\mbox{\hyperlink{classoomph_1_1TetMeshFacetedSurface_a86b099447be23301fdfd4abdeee75560}{one\_based\_facet\_boundary\_id}}(\mbox{\hyperlink{namespaceoomph_ad835af913df4cbdc5648440f91b794ab}{f}}) -\/ 1) == b)}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00560}00560           \{}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00561}00561             facet\_id\_of\_boundary = \mbox{\hyperlink{namespaceoomph_ad835af913df4cbdc5648440f91b794ab}{f}};}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00562}00562             \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00563}00563           \}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00564}00564         \}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00565}00565         f\_pt = faceted\_surface\_pt-\/>\mbox{\hyperlink{classoomph_1_1TetMeshFacetedSurface_a03ee576b3a3127a722f47905f05034da}{facet\_pt}}(facet\_id\_of\_boundary);}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00566}00566 }
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00567}00567 }
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00568}00568         \textcolor{comment}{// Three vertices?}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00569}00569         \textcolor{keywordtype}{unsigned} nv = f\_pt-\/>\mbox{\hyperlink{classoomph_1_1TetMeshFacet_aa6f08ddc938cd6a52f601c63831148ea}{nvertex}}();}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00570}00570         \textcolor{keywordflow}{if} (nv != 3)}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00571}00571         \{}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00572}00572           reason << \textcolor{stringliteral}{"{}-\/-\/ number of facet vertices is "{}} << nv}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00573}00573                  << \textcolor{stringliteral}{"{} rather than 3\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00574}00574           do\_it = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00575}00575         \}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00576}00576 }
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00577}00577         \textcolor{comment}{// Have we set up zeta coordinates in geometric object?}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00578}00578         \textcolor{keywordflow}{if} ((f\_pt-\/>\mbox{\hyperlink{classoomph_1_1TetMeshFacet_ac3e8bb06cabd39c2108af501b163df48}{vertex\_pt}}(0)-\/>\mbox{\hyperlink{classoomph_1_1TetMeshVertex_a2eacd82ac6d8292ae8e33614cc23145d}{zeta\_in\_geom\_object}}().size() != 2) ||}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00579}00579             (f\_pt-\/>\mbox{\hyperlink{classoomph_1_1TetMeshFacet_ac3e8bb06cabd39c2108af501b163df48}{vertex\_pt}}(1)-\/>\mbox{\hyperlink{classoomph_1_1TetMeshVertex_a2eacd82ac6d8292ae8e33614cc23145d}{zeta\_in\_geom\_object}}().size() != 2) ||}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00580}00580             (f\_pt-\/>\mbox{\hyperlink{classoomph_1_1TetMeshFacet_ac3e8bb06cabd39c2108af501b163df48}{vertex\_pt}}(2)-\/>\mbox{\hyperlink{classoomph_1_1TetMeshVertex_a2eacd82ac6d8292ae8e33614cc23145d}{zeta\_in\_geom\_object}}().size() != 2))}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00581}00581         \{}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00582}00582           reason << \textcolor{stringliteral}{"{}-\/-\/ no boundary coordinates were set up\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00583}00583           do\_it = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00584}00584         \}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00585}00585       \}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00586}00586 }
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00587}00587 }
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00588}00588       \textcolor{comment}{// Are we ready to go?}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00589}00589       \textcolor{keywordflow}{if} (!do\_it)}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00590}00590       \{}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00591}00591         \textcolor{keyword}{const} \textcolor{keywordtype}{bool} tell\_us\_why = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00592}00592         \textcolor{keywordflow}{if} (tell\_us\_why)}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00593}00593         \{}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00594}00594           \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << reason.str() << std::endl;}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00595}00595         \}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00596}00596       \}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00597}00597       \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00598}00598       \{}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00599}00599         \textcolor{comment}{// Setup area coordinantes in triangular facet}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00600}00600         \textcolor{keywordtype}{double} x1 = \mbox{\hyperlink{classoomph_1_1TetMeshBase_acc7c8edda4f0f95cd8894620379905d5}{Triangular\_facet\_vertex\_boundary\_coordinate}}[b][0][0];}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00601}00601         \textcolor{keywordtype}{double} y1 = \mbox{\hyperlink{classoomph_1_1TetMeshBase_acc7c8edda4f0f95cd8894620379905d5}{Triangular\_facet\_vertex\_boundary\_coordinate}}[b][0][1];}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00602}00602 }
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00603}00603         \textcolor{keywordtype}{double} x2 = \mbox{\hyperlink{classoomph_1_1TetMeshBase_acc7c8edda4f0f95cd8894620379905d5}{Triangular\_facet\_vertex\_boundary\_coordinate}}[b][1][0];}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00604}00604         \textcolor{keywordtype}{double} y2 = \mbox{\hyperlink{classoomph_1_1TetMeshBase_acc7c8edda4f0f95cd8894620379905d5}{Triangular\_facet\_vertex\_boundary\_coordinate}}[b][1][1];}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00605}00605 }
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00606}00606         \textcolor{keywordtype}{double} x3 = \mbox{\hyperlink{classoomph_1_1TetMeshBase_acc7c8edda4f0f95cd8894620379905d5}{Triangular\_facet\_vertex\_boundary\_coordinate}}[b][2][0];}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00607}00607         \textcolor{keywordtype}{double} y3 = \mbox{\hyperlink{classoomph_1_1TetMeshBase_acc7c8edda4f0f95cd8894620379905d5}{Triangular\_facet\_vertex\_boundary\_coordinate}}[b][2][1];}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00608}00608 }
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00609}00609         \textcolor{keywordtype}{double} detT = (y2 -\/ y3) * (x1 -\/ x3) + (x3 -\/ x2) * (y1 -\/ y3);}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00610}00610 }
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00611}00611 }
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00612}00612         \textcolor{comment}{// Boundary coordinate (cartesian coordinates inside facet)}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00613}00613         \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} zeta(2);}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00614}00614 }
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00615}00615         \textcolor{comment}{// Loop over all nodes on that boundary}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00616}00616         \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} n\_boundary\_node = this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a034677ceb48c67769acb83f304c84f7d}{nboundary\_node}}(b);}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00617}00617         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} n = 0; n < n\_boundary\_node; ++n)}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00618}00618         \{}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00619}00619           \textcolor{comment}{// Get the boundary node and coordinates}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00620}00620           Node* \textcolor{keyword}{const} nod\_pt = this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_afc4d1204afc31b9ec88fe82d8fc01625}{boundary\_node\_pt}}(b, n);}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00621}00621           nod\_pt-\/>get\_coordinates\_on\_boundary(b, zeta);}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00622}00622 }
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00623}00623           \textcolor{comment}{// Now we have zeta, the cartesian boundary coordinates}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00624}00624           \textcolor{comment}{// in the (assumed to be triangular) boundary facet; let's}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00625}00625           \textcolor{comment}{// work out the area coordinates}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00626}00626           \textcolor{comment}{// Notation as in}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00627}00627           \textcolor{comment}{// https://en.wikipedia.org/wiki/Barycentric\_coordinate\_system}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00628}00628           \textcolor{keywordtype}{double} s0 =}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00629}00629             ((y2 -\/ y3) * (zeta[0] -\/ x3) + (x3 -\/ x2) * (zeta[1] -\/ y3)) / detT;}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00630}00630           \textcolor{keywordtype}{double} s1 =}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00631}00631             ((y3 -\/ y1) * (zeta[0] -\/ x3) + (x1 -\/ x3) * (zeta[1] -\/ y3)) / detT;}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00632}00632           \textcolor{keywordtype}{double} s2 = 1.0 -\/ s0 -\/ s1;}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00633}00633 }
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00634}00634           \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} zeta\_in\_geom\_obj(2, 0.0);}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00635}00635           \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} position\_from\_geom\_obj(3, 0.0);}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00636}00636 }
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00637}00637           \textcolor{comment}{// Vertex zeta coordinates}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00638}00638           \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} zeta\_0(2);}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00639}00639           zeta\_0 = f\_pt-\/>\mbox{\hyperlink{classoomph_1_1TetMeshFacet_ac3e8bb06cabd39c2108af501b163df48}{vertex\_pt}}(0)-\/>\mbox{\hyperlink{classoomph_1_1TetMeshVertex_a2eacd82ac6d8292ae8e33614cc23145d}{zeta\_in\_geom\_object}}();}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00640}00640 }
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00641}00641           \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} zeta\_1(2);}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00642}00642           zeta\_1 = f\_pt-\/>\mbox{\hyperlink{classoomph_1_1TetMeshFacet_ac3e8bb06cabd39c2108af501b163df48}{vertex\_pt}}(1)-\/>\mbox{\hyperlink{classoomph_1_1TetMeshVertex_a2eacd82ac6d8292ae8e33614cc23145d}{zeta\_in\_geom\_object}}();}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00643}00643 }
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00644}00644           \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} zeta\_2(2);}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00645}00645           zeta\_2 = f\_pt-\/>\mbox{\hyperlink{classoomph_1_1TetMeshFacet_ac3e8bb06cabd39c2108af501b163df48}{vertex\_pt}}(2)-\/>\mbox{\hyperlink{classoomph_1_1TetMeshVertex_a2eacd82ac6d8292ae8e33614cc23145d}{zeta\_in\_geom\_object}}();}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00646}00646 }
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00647}00647 }
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00648}00648 \textcolor{preprocessor}{\#ifdef PARANOID}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00649}00649 }
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00650}00650           \textcolor{comment}{// Compute zeta values of the vertices from parametrisation of}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00651}00651           \textcolor{comment}{// boundaries}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00652}00652           \textcolor{keywordtype}{double} tol = 1.0e-\/12;}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00653}00653           \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} zeta\_from\_boundary(2);}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00654}00654           \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} zeta\_vertex(2);}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00655}00655           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} v = 0; v < 3; v++)}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00656}00656           \{}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00657}00657             zeta\_vertex = f\_pt-\/>\mbox{\hyperlink{classoomph_1_1TetMeshFacet_ac3e8bb06cabd39c2108af501b163df48}{vertex\_pt}}(v)-\/>\mbox{\hyperlink{classoomph_1_1TetMeshVertex_a2eacd82ac6d8292ae8e33614cc23145d}{zeta\_in\_geom\_object}}();}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00658}00658             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} alt = 0; alt < 2; alt++)}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00659}00659             \{}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00660}00660               \textcolor{keywordflow}{switch} (v)}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00661}00661               \{}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00662}00662                 \textcolor{keywordflow}{case} 0:}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00663}00663 }
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00664}00664                   \textcolor{keywordflow}{if} (alt == 0)}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00665}00665                   \{}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00666}00666                     faceted\_surface\_pt-\/>\mbox{\hyperlink{classoomph_1_1TetMeshFacetedSurface_a5882667d66ad8460782b9fa36f39f485}{boundary\_zeta01}}(}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00667}00667                       facet\_id\_of\_boundary, 0.0, zeta\_from\_boundary);}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00668}00668                   \}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00669}00669                   \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00670}00670                   \{}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00671}00671                     faceted\_surface\_pt-\/>\mbox{\hyperlink{classoomph_1_1TetMeshFacetedSurface_aa9c92e3c5ba628cdcc91086c9cb38c22}{boundary\_zeta20}}(}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00672}00672                       facet\_id\_of\_boundary, 1.0, zeta\_from\_boundary);}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00673}00673                   \}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00674}00674                   \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00675}00675 }
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00676}00676                 \textcolor{keywordflow}{case} 1:}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00677}00677 }
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00678}00678                   \textcolor{keywordflow}{if} (alt == 0)}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00679}00679                   \{}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00680}00680                     faceted\_surface\_pt-\/>\mbox{\hyperlink{classoomph_1_1TetMeshFacetedSurface_a5882667d66ad8460782b9fa36f39f485}{boundary\_zeta01}}(}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00681}00681                       facet\_id\_of\_boundary, 1.0, zeta\_from\_boundary);}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00682}00682                   \}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00683}00683                   \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00684}00684                   \{}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00685}00685                     faceted\_surface\_pt-\/>\mbox{\hyperlink{classoomph_1_1TetMeshFacetedSurface_a7dd49826326e9926d92fc773853a9afb}{boundary\_zeta12}}(}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00686}00686                       facet\_id\_of\_boundary, 0.0, zeta\_from\_boundary);}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00687}00687                   \}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00688}00688                   \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00689}00689 }
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00690}00690                 \textcolor{keywordflow}{case} 2:}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00691}00691 }
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00692}00692                   \textcolor{keywordflow}{if} (alt == 0)}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00693}00693                   \{}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00694}00694                     faceted\_surface\_pt-\/>\mbox{\hyperlink{classoomph_1_1TetMeshFacetedSurface_a7dd49826326e9926d92fc773853a9afb}{boundary\_zeta12}}(}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00695}00695                       facet\_id\_of\_boundary, 1.0, zeta\_from\_boundary);}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00696}00696                   \}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00697}00697                   \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00698}00698                   \{}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00699}00699                     faceted\_surface\_pt-\/>\mbox{\hyperlink{classoomph_1_1TetMeshFacetedSurface_aa9c92e3c5ba628cdcc91086c9cb38c22}{boundary\_zeta20}}(}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00700}00700                       facet\_id\_of\_boundary, 0.0, zeta\_from\_boundary);}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00701}00701                   \}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00702}00702                   \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00703}00703               \}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00704}00704 }
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00705}00705               \textcolor{keywordtype}{double} error =}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00706}00706                 sqrt(pow((zeta\_vertex[0] -\/ zeta\_from\_boundary[0]), 2) +}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00707}00707                      pow((zeta\_vertex[1] -\/ zeta\_from\_boundary[1]), 2));}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00708}00708               \textcolor{keywordflow}{if} (error > tol)}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00709}00709               \{}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00710}00710                 std::ostringstream error\_message;}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00711}00711                 error\_message}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00712}00712                   << \textcolor{stringliteral}{"{}Error in parametrisation of boundary coordinates \(\backslash\)n"{}}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00713}00713                   << \textcolor{stringliteral}{"{}for vertex "{}} << v << \textcolor{stringliteral}{"{} [alt="{}} << alt << \textcolor{stringliteral}{"{}] in facet "{}}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00714}00714                   << facet\_id\_of\_boundary << \textcolor{stringliteral}{"{} : \(\backslash\)n"{}}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00715}00715                   << \textcolor{stringliteral}{"{}zeta\_vertex = [ "{}} << zeta\_vertex[0] << \textcolor{stringliteral}{"{} "{}}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00716}00716                   << zeta\_vertex[1] << \textcolor{stringliteral}{"{} ] \(\backslash\)n"{}}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00717}00717                   << \textcolor{stringliteral}{"{}zeta\_from\_boundary      = [ "{}} << zeta\_from\_boundary[0]}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00718}00718                   << \textcolor{stringliteral}{"{} "{}} << zeta\_from\_boundary[1] << \textcolor{stringliteral}{"{} ] \(\backslash\)n"{}}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00719}00719                   << std::endl;}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00720}00720                 \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(error\_message.str(),}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00721}00721                                     OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00722}00722                                     OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00723}00723               \}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00724}00724             \}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00725}00725           \}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00726}00726 }
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00727}00727 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00728}00728 }
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00729}00729           \textcolor{comment}{// Compute zeta values of the interpolation parameters}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00730}00730           \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} zeta\_a(3, 0.0);}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00731}00731           \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} zeta\_b(3, 0.0);}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00732}00732           \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} zeta\_c(3, 0.0);}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00733}00733           \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} zeta\_d(3, 0.0);}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00734}00734           \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} zeta\_e(3, 0.0);}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00735}00735           \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} zeta\_f(3, 0.0);}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00736}00736           faceted\_surface\_pt-\/>\mbox{\hyperlink{classoomph_1_1TetMeshFacetedSurface_a5882667d66ad8460782b9fa36f39f485}{boundary\_zeta01}}(facet\_id\_of\_boundary, s1, zeta\_a);}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00737}00737           faceted\_surface\_pt-\/>\mbox{\hyperlink{classoomph_1_1TetMeshFacetedSurface_a5882667d66ad8460782b9fa36f39f485}{boundary\_zeta01}}(}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00738}00738             facet\_id\_of\_boundary, 1.0 -\/ s0, zeta\_d);}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00739}00739 }
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00740}00740           faceted\_surface\_pt-\/>\mbox{\hyperlink{classoomph_1_1TetMeshFacetedSurface_a7dd49826326e9926d92fc773853a9afb}{boundary\_zeta12}}(facet\_id\_of\_boundary, s2, zeta\_c);}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00741}00741           faceted\_surface\_pt-\/>\mbox{\hyperlink{classoomph_1_1TetMeshFacetedSurface_a7dd49826326e9926d92fc773853a9afb}{boundary\_zeta12}}(}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00742}00742             facet\_id\_of\_boundary, 1.0 -\/ s1, zeta\_f);}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00743}00743 }
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00744}00744           faceted\_surface\_pt-\/>\mbox{\hyperlink{classoomph_1_1TetMeshFacetedSurface_aa9c92e3c5ba628cdcc91086c9cb38c22}{boundary\_zeta20}}(}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00745}00745             facet\_id\_of\_boundary, 1.0 -\/ s2, zeta\_b);}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00746}00746           faceted\_surface\_pt-\/>\mbox{\hyperlink{classoomph_1_1TetMeshFacetedSurface_aa9c92e3c5ba628cdcc91086c9cb38c22}{boundary\_zeta20}}(facet\_id\_of\_boundary, s0, zeta\_e);}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00747}00747 }
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00748}00748           \textcolor{comment}{// Transfinite mapping}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00749}00749           zeta\_in\_geom\_obj[0] = s0 * (zeta\_a[0] + zeta\_b[0] -\/ zeta\_0[0]) +}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00750}00750                                 s1 * (zeta\_c[0] + zeta\_d[0] -\/ zeta\_1[0]) +}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00751}00751                                 s2 * (zeta\_e[0] + zeta\_f[0] -\/ zeta\_2[0]);}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00752}00752           zeta\_in\_geom\_obj[1] = s0 * (zeta\_a[1] + zeta\_b[1] -\/ zeta\_0[1]) +}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00753}00753                                 s1 * (zeta\_c[1] + zeta\_d[1] -\/ zeta\_1[1]) +}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00754}00754                                 s2 * (zeta\_e[1] + zeta\_f[1] -\/ zeta\_2[1]);}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00755}00755 }
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00756}00756           \textcolor{keywordtype}{unsigned} n\_tvalues =}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00757}00757             1 + nod\_pt-\/>position\_time\_stepper\_pt()-\/>nprev\_values();}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00758}00758           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}} = 0; \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}} < n\_tvalues; ++\mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}})}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00759}00759           \{}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00760}00760             \textcolor{comment}{// Get the position according to the underlying geometric object}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00761}00761             geom\_obj\_pt-\/>\mbox{\hyperlink{classoomph_1_1GeomObject_a0d04c9d4667817f3ef24bb660fd56065}{position}}(\mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}, zeta\_in\_geom\_obj, position\_from\_geom\_obj);}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00762}00762 }
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00763}00763             \textcolor{comment}{// Move the node}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00764}00764             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < 3; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00765}00765             \{}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00766}00766               nod\_pt-\/>x(\mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) = position\_from\_geom\_obj[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}];}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00767}00767             \}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00768}00768           \}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00769}00769         \}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00770}00770       \}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00771}00771     \}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00772}00772 }
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00773}00773     \textcolor{comment}{// Check if any element is inverted}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00774}00774     \textcolor{keywordtype}{bool} some\_element\_is\_inverted = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00775}00775     \textcolor{keywordtype}{unsigned} count = 0;}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00776}00776     \textcolor{keywordtype}{unsigned} nel = \mbox{\hyperlink{classoomph_1_1Mesh_af01dfefb66c15579b540be62999d93ee}{nelement}}();}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00777}00777     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} = 0; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} < nel; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}++)}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00778}00778     \{}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00779}00779       \mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}* el\_pt = \mbox{\hyperlink{classoomph_1_1Mesh_a479059b0964826a8cee6eb506b57268a}{finite\_element\_pt}}(\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}});}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00780}00780       \textcolor{keywordtype}{bool} passed = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00781}00781       el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a9d44b28a6aa0152ffb6b187befe35bf9}{check\_J\_eulerian\_at\_knots}}(passed);}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00782}00782       \textcolor{keywordflow}{if} (!passed)}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00783}00783       \{}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00784}00784         some\_element\_is\_inverted = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00785}00785         \textcolor{keywordtype}{char} filename[100];}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00786}00786         std::ofstream some\_file;}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00787}00787         sprintf(filename, \textcolor{stringliteral}{"{}overly\_distorted\_element\%i.dat"{}}, count);}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00788}00788         some\_file.open(filename);}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00789}00789         \textcolor{keywordtype}{unsigned} nnod\_1d = el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_ab65c7a94dda80c1876a09ac12be4e39c}{nnode\_1d}}();}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00790}00790         el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a2ad98a3d2ef4999f1bef62c0ff13f2a7}{output}}(some\_file, nnod\_1d);}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00791}00791         some\_file.close();}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00792}00792 }
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00793}00793         \textcolor{comment}{// Reset to old nodal position}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00794}00794         \textcolor{keywordtype}{unsigned} nnod = el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a6219ed269a6d89b5aa14659cce48905a}{nnode}}();}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00795}00795         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < nnod; j++)}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00796}00796         \{}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00797}00797           Node* nod\_pt = el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a9addfe893ab8205619963aa96204cdc4}{node\_pt}}(j);}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00798}00798           \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} x\_current(3);}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00799}00799           nod\_pt-\/>position(x\_current);}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00800}00800           new\_nodal\_posn[nod\_pt] = x\_current;}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00801}00801           \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} old\_x(old\_nodal\_posn[nod\_pt]);}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00802}00802           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < 3; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00803}00803           \{}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00804}00804             nod\_pt-\/>x(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) = old\_x[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}];}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00805}00805           \}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00806}00806         \}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00807}00807 }
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00808}00808         \textcolor{comment}{// Plot}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00809}00809         sprintf(filename, \textcolor{stringliteral}{"{}orig\_overly\_distorted\_element\%i.dat"{}}, count);}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00810}00810         some\_file.open(filename);}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00811}00811         el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a2ad98a3d2ef4999f1bef62c0ff13f2a7}{output}}(some\_file, nnod\_1d);}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00812}00812         some\_file.close();}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00813}00813 }
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00814}00814         \textcolor{comment}{// Reset}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00815}00815         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < nnod; j++)}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00816}00816         \{}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00817}00817           Node* nod\_pt = el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a9addfe893ab8205619963aa96204cdc4}{node\_pt}}(j);}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00818}00818           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < 3; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00819}00819           \{}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00820}00820             nod\_pt-\/>x(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) = new\_nodal\_posn[nod\_pt][\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}];}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00821}00821           \}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00822}00822         \}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00823}00823 }
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00824}00824         \textcolor{comment}{// Bump}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00825}00825         count++;}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00826}00826       \}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00827}00827     \}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00828}00828     \textcolor{keywordflow}{if} (some\_element\_is\_inverted)}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00829}00829     \{}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00830}00830       std::ostringstream error\_message;}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00831}00831       error\_message}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00832}00832         << \textcolor{stringliteral}{"{}A number of elements, namely: "{}} << count}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00833}00833         << \textcolor{stringliteral}{"{} are inverted after snapping. Their shapes are in "{}}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00834}00834         << \textcolor{stringliteral}{"{} overly\_distorted\_element*.dat and "{}}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00835}00835            \textcolor{stringliteral}{"{}orig\_overly\_distorted\_element*.dat"{}}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00836}00836         << \textcolor{stringliteral}{"{}Next person to get this error: Please implement a straightforward\(\backslash\)n"{}}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00837}00837         << \textcolor{stringliteral}{"{}variant of one of the functors in src/mesh\_smoothing to switch\(\backslash\)n"{}}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00838}00838         << \textcolor{stringliteral}{"{}to harmonic mapping\(\backslash\)n"{}}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00839}00839         << std::endl;}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00840}00840       \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00841}00841         error\_message.str(), OOMPH\_CURRENT\_FUNCTION, OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00842}00842     \}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00843}00843     \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00844}00844     \{}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00845}00845       \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{}No elements are inverted after snapping. Yay!"{}}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00846}00846                  << std::endl;}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00847}00847     \}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00848}00848   \}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00849}00849 }
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00850}00850 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00851}00851 \textcolor{comment}{  /// //////////////////////////////////////////////////////////////////}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00852}00852 \textcolor{comment}{  /// //////////////////////////////////////////////////////////////////}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00853}00853 \textcolor{comment}{  /// //////////////////////////////////////////////////////////////////}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00854}00854 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00855}00855 }
\DoxyCodeLine{\Hypertarget{tet__mesh_8cc_source_l00856}00856 \} \textcolor{comment}{// namespace oomph}}

\end{DoxyCode}

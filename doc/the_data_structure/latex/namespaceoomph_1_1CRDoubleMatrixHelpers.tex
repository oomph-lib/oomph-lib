\doxysection{oomph\+::CRDouble\+Matrix\+Helpers Namespace Reference}
\hypertarget{namespaceoomph_1_1CRDoubleMatrixHelpers}{}\label{namespaceoomph_1_1CRDoubleMatrixHelpers}\index{oomph::CRDoubleMatrixHelpers@{oomph::CRDoubleMatrixHelpers}}


Namespace for helper functions for CRDouble\+Matrices.  


\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classoomph_1_1TAdvectionDiffusionReactionElement}{void}} \mbox{\hyperlink{namespaceoomph_1_1CRDoubleMatrixHelpers_ae3c10e59d5857457c7e34be8e9262035}{create\+\_\+uniformly\+\_\+distributed\+\_\+matrix}} (\mbox{\hyperlink{classoomph_1_1TAdvectionDiffusionReactionElement}{const}} \mbox{\hyperlink{classoomph_1_1TAdvectionDiffusionReactionElement}{unsigned}} \&nrow, \mbox{\hyperlink{classoomph_1_1TAdvectionDiffusionReactionElement}{const}} \mbox{\hyperlink{classoomph_1_1TAdvectionDiffusionReactionElement}{unsigned}} \&ncol, \mbox{\hyperlink{classoomph_1_1TAdvectionDiffusionReactionElement}{const}} \mbox{\hyperlink{classoomph_1_1OomphCommunicator}{Oomph\+Communicator}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{classoomph_1_1TAdvectionDiffusionReactionElement}{const}} comm\+\_\+pt, \mbox{\hyperlink{classoomph_1_1TAdvectionDiffusionReactionElement}{const}} \mbox{\hyperlink{classoomph_1_1Vector}{Vector}}$<$ \mbox{\hyperlink{classoomph_1_1TAdvectionDiffusionReactionElement}{double}} $>$ \&values, \mbox{\hyperlink{classoomph_1_1TAdvectionDiffusionReactionElement}{const}} \mbox{\hyperlink{classoomph_1_1Vector}{Vector}}$<$ \mbox{\hyperlink{classoomph_1_1TAdvectionDiffusionReactionElement}{int}} $>$ \&\mbox{\hyperlink{classoomph_1_1TAdvectionDiffusionReactionElement}{column\+\_\+indices}}, \mbox{\hyperlink{classoomph_1_1TAdvectionDiffusionReactionElement}{const}} \mbox{\hyperlink{classoomph_1_1Vector}{Vector}}$<$ \mbox{\hyperlink{classoomph_1_1TAdvectionDiffusionReactionElement}{int}} $>$ \&row\+\_\+start, \mbox{\hyperlink{classoomph_1_1CRDoubleMatrix}{CRDouble\+Matrix}} \&\mbox{\hyperlink{classoomph_1_1TAdvectionDiffusionReactionElement}{matrix\+\_\+out}})
\begin{DoxyCompactList}\small\item\em Builds a uniformly distributed matrix. A locally replicated matrix is constructed then redistributed using OOMPH-\/\+LIB\textquotesingle{}s default uniform row distribution. This is memory intensive thus should be used for testing or small problems only. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classoomph_1_1TAdvectionDiffusionReactionElement}{double}} \mbox{\hyperlink{namespaceoomph_1_1CRDoubleMatrixHelpers_ab17222c9461096e3d5b8cf6250524644}{inf\+\_\+norm}} (\mbox{\hyperlink{classoomph_1_1TAdvectionDiffusionReactionElement}{const}} \mbox{\hyperlink{classoomph_1_1DenseMatrix}{Dense\+Matrix}}$<$ \mbox{\hyperlink{classoomph_1_1CRDoubleMatrix}{CRDouble\+Matrix}} \texorpdfstring{$\ast$}{*} $>$ \&matrix\+\_\+pt)
\begin{DoxyCompactList}\small\item\em Compute infinity (maximum) norm of sub blocks as if it was one matrix. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classoomph_1_1TAdvectionDiffusionReactionElement}{double}} \mbox{\hyperlink{namespaceoomph_1_1CRDoubleMatrixHelpers_a02b5962dbe2bbfb93f54b668100afffc}{gershgorin\+\_\+eigenvalue\+\_\+estimate}} (\mbox{\hyperlink{classoomph_1_1TAdvectionDiffusionReactionElement}{const}} \mbox{\hyperlink{classoomph_1_1DenseMatrix}{Dense\+Matrix}}$<$ \mbox{\hyperlink{classoomph_1_1CRDoubleMatrix}{CRDouble\+Matrix}} \texorpdfstring{$\ast$}{*} $>$ \&matrix\+\_\+pt)
\begin{DoxyCompactList}\small\item\em Calculates the largest Gershgorin disc whilst preserving the sign. Let A be an n by n matrix, with entries aij. For $ i \in \{ 1,...,n \} $ let $ R_i = \sum_{i\neq j} |a_{ij}| $ be the sum of the absolute values of the non-\/diagonal entries in the i-\/th row. Let $ D(a_{ii},R_i) $ be the closed disc centered at $ a_{ii} $ with radius $ R_i $, such a disc is called a Gershgorin disc. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classoomph_1_1TAdvectionDiffusionReactionElement}{void}} \mbox{\hyperlink{namespaceoomph_1_1CRDoubleMatrixHelpers_ab7e3ac344aa644292a143a3917a03e65}{concatenate}} (\mbox{\hyperlink{classoomph_1_1TAdvectionDiffusionReactionElement}{const}} \mbox{\hyperlink{classoomph_1_1DenseMatrix}{Dense\+Matrix}}$<$ \mbox{\hyperlink{classoomph_1_1CRDoubleMatrix}{CRDouble\+Matrix}} \texorpdfstring{$\ast$}{*} $>$ \&matrix\+\_\+pt, \mbox{\hyperlink{classoomph_1_1CRDoubleMatrix}{CRDouble\+Matrix}} \&\mbox{\hyperlink{classoomph_1_1TAdvectionDiffusionReactionElement}{result\+\_\+matrix}})
\begin{DoxyCompactList}\small\item\em Concatenate \doxylink{classoomph_1_1CRDoubleMatrix}{CRDouble\+Matrix} matrices. The in matrices are concatenated such that the block structure of the in matrices are preserved in the result matrix. Communication between processors is required. If the block structure of the sub matrices does not need to be preserved, consider using CRDouble\+Matrix\+Helpers\+::concatenate\+\_\+without\+\_\+communication(...). \end{DoxyCompactList}\item 
\mbox{\hyperlink{classoomph_1_1TAdvectionDiffusionReactionElement}{void}} \mbox{\hyperlink{namespaceoomph_1_1CRDoubleMatrixHelpers_a996568831ca0db90f080560dd400b3d6}{concatenate\+\_\+without\+\_\+communication}} (\mbox{\hyperlink{classoomph_1_1TAdvectionDiffusionReactionElement}{const}} \mbox{\hyperlink{classoomph_1_1Vector}{Vector}}$<$ \mbox{\hyperlink{classoomph_1_1LinearAlgebraDistribution}{Linear\+Algebra\+Distribution}} \texorpdfstring{$\ast$}{*} $>$ \&\mbox{\hyperlink{classoomph_1_1TAdvectionDiffusionReactionElement}{row\+\_\+distribution\+\_\+pt}}, \mbox{\hyperlink{classoomph_1_1TAdvectionDiffusionReactionElement}{const}} \mbox{\hyperlink{classoomph_1_1Vector}{Vector}}$<$ \mbox{\hyperlink{classoomph_1_1LinearAlgebraDistribution}{Linear\+Algebra\+Distribution}} \texorpdfstring{$\ast$}{*} $>$ \&\mbox{\hyperlink{classoomph_1_1TAdvectionDiffusionReactionElement}{col\+\_\+distribution\+\_\+pt}}, \mbox{\hyperlink{classoomph_1_1TAdvectionDiffusionReactionElement}{const}} \mbox{\hyperlink{classoomph_1_1DenseMatrix}{Dense\+Matrix}}$<$ \mbox{\hyperlink{classoomph_1_1CRDoubleMatrix}{CRDouble\+Matrix}} \texorpdfstring{$\ast$}{*} $>$ \&matrix\+\_\+pt, \mbox{\hyperlink{classoomph_1_1CRDoubleMatrix}{CRDouble\+Matrix}} \&\mbox{\hyperlink{classoomph_1_1TAdvectionDiffusionReactionElement}{result\+\_\+matrix}})
\begin{DoxyCompactList}\small\item\em Concatenate \doxylink{classoomph_1_1CRDoubleMatrix}{CRDouble\+Matrix} matrices. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classoomph_1_1TAdvectionDiffusionReactionElement}{void}} \mbox{\hyperlink{namespaceoomph_1_1CRDoubleMatrixHelpers_ac04e094c973da752da4b76071ad09f44}{concatenate\+\_\+without\+\_\+communication}} (\mbox{\hyperlink{classoomph_1_1TAdvectionDiffusionReactionElement}{const}} \mbox{\hyperlink{classoomph_1_1Vector}{Vector}}$<$ \mbox{\hyperlink{classoomph_1_1LinearAlgebraDistribution}{Linear\+Algebra\+Distribution}} \texorpdfstring{$\ast$}{*} $>$ \&block\+\_\+distribution\+\_\+pt, \mbox{\hyperlink{classoomph_1_1TAdvectionDiffusionReactionElement}{const}} \mbox{\hyperlink{classoomph_1_1DenseMatrix}{Dense\+Matrix}}$<$ \mbox{\hyperlink{classoomph_1_1CRDoubleMatrix}{CRDouble\+Matrix}} \texorpdfstring{$\ast$}{*} $>$ \&matrix\+\_\+pt, \mbox{\hyperlink{classoomph_1_1CRDoubleMatrix}{CRDouble\+Matrix}} \&\mbox{\hyperlink{classoomph_1_1TAdvectionDiffusionReactionElement}{result\+\_\+matrix}})
\begin{DoxyCompactList}\small\item\em Concatenate \doxylink{classoomph_1_1CRDoubleMatrix}{CRDouble\+Matrix} matrices. This calls the other concatenate\+\_\+without\+\_\+communication(...) function, passing block\+\_\+distribution\+\_\+pt as both the row\+\_\+distribution\+\_\+pt and col\+\_\+distribution\+\_\+pt. This should only be called for block square matrices. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classoomph_1_1TAdvectionDiffusionReactionElement}{void}} \mbox{\hyperlink{namespaceoomph_1_1CRDoubleMatrixHelpers_a157511f700993ab8bc014f9d0d44f4c7}{deep\+\_\+copy}} (\mbox{\hyperlink{classoomph_1_1TAdvectionDiffusionReactionElement}{const}} \mbox{\hyperlink{classoomph_1_1CRDoubleMatrix}{CRDouble\+Matrix}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{classoomph_1_1TAdvectionDiffusionReactionElement}{const}} \mbox{\hyperlink{classoomph_1_1TAdvectionDiffusionReactionElement}{in\+\_\+matrix\+\_\+pt}}, \mbox{\hyperlink{classoomph_1_1CRDoubleMatrix}{CRDouble\+Matrix}} \&\mbox{\hyperlink{classoomph_1_1TAdvectionDiffusionReactionElement}{out\+\_\+matrix}})
\begin{DoxyCompactList}\small\item\em Create a deep copy of the matrix pointed to by in\+\_\+matrix\+\_\+pt. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Namespace for helper functions for CRDouble\+Matrices. 

\doxysubsection{Function Documentation}
\Hypertarget{namespaceoomph_1_1CRDoubleMatrixHelpers_ab7e3ac344aa644292a143a3917a03e65}\label{namespaceoomph_1_1CRDoubleMatrixHelpers_ab7e3ac344aa644292a143a3917a03e65} 
\index{oomph::CRDoubleMatrixHelpers@{oomph::CRDoubleMatrixHelpers}!concatenate@{concatenate}}
\index{concatenate@{concatenate}!oomph::CRDoubleMatrixHelpers@{oomph::CRDoubleMatrixHelpers}}
\doxysubsubsection{\texorpdfstring{concatenate()}{concatenate()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classoomph_1_1TAdvectionDiffusionReactionElement}{void}} oomph\+::\+CRDouble\+Matrix\+Helpers\+::concatenate (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classoomph_1_1TAdvectionDiffusionReactionElement}{const}} \mbox{\hyperlink{classoomph_1_1DenseMatrix}{Dense\+Matrix}}$<$ \mbox{\hyperlink{classoomph_1_1CRDoubleMatrix}{CRDouble\+Matrix}} \texorpdfstring{$\ast$}{*} $>$ \&}]{matrix\+\_\+pt,  }\item[{\mbox{\hyperlink{classoomph_1_1CRDoubleMatrix}{CRDouble\+Matrix}} \&}]{result\+\_\+matrix }\end{DoxyParamCaption})}



Concatenate \doxylink{classoomph_1_1CRDoubleMatrix}{CRDouble\+Matrix} matrices. The in matrices are concatenated such that the block structure of the in matrices are preserved in the result matrix. Communication between processors is required. If the block structure of the sub matrices does not need to be preserved, consider using CRDouble\+Matrix\+Helpers\+::concatenate\+\_\+without\+\_\+communication(...). 

The matrix manipulation functions CRDouble\+Matrix\+Helpers\+::concatenate(...) and CRDouble\+Matrix\+Helpers\+::concatenate\+\_\+without\+\_\+communication(...) are analogous to the \doxylink{classoomph_1_1Vector}{Vector} manipulation functions Double\+Vector\+Helpers\+::concatenate(...) and Double\+Vector\+Helpers\+::concatenate\+\_\+without\+\_\+communication(...). Please look at the \doxylink{classoomph_1_1DoubleVector}{Double\+Vector} functions for an illustration of the differences between concatenate(...) and concatenate\+\_\+without\+\_\+communication(...).

Distribution of the result matrix\+: If the result matrix does not have a distribution built, then it will be given a uniform row distribution. Otherwise we use the existing distribution. This gives the user the ability to define their own distribution, or save computing power if a distribution has been pre-\/built.

NOTE\+: ALL the matrices pointed to by matrix\+\_\+pt has to be built. This is not the case with concatenate\+\_\+without\+\_\+communication(...) 

Definition at line \mbox{\hyperlink{matrices_8cc_source_l04349}{4349}} of file \mbox{\hyperlink{matrices_8cc_source}{matrices.\+cc}}.



References \mbox{\hyperlink{oomph__definitions_8cc_source_l00326}{oomph\+::oomph\+\_\+info}}, \mbox{\hyperlink{elements_8cc_source_l04320}{oomph\+::\+Finite\+Element\+::size()}}, and \mbox{\hyperlink{oomph__utilities_8cc_source_l01303}{oomph\+::\+Timing\+Helpers\+::timer()}}.



Referenced by \mbox{\hyperlink{general__purpose__space__time__subsidiary__block__preconditioner_8cc_source_l00061}{oomph\+::\+Space\+Time\+Navier\+Stokes\+Subsidiary\+Preconditioner\+::setup()}}.

\Hypertarget{namespaceoomph_1_1CRDoubleMatrixHelpers_ac04e094c973da752da4b76071ad09f44}\label{namespaceoomph_1_1CRDoubleMatrixHelpers_ac04e094c973da752da4b76071ad09f44} 
\index{oomph::CRDoubleMatrixHelpers@{oomph::CRDoubleMatrixHelpers}!concatenate\_without\_communication@{concatenate\_without\_communication}}
\index{concatenate\_without\_communication@{concatenate\_without\_communication}!oomph::CRDoubleMatrixHelpers@{oomph::CRDoubleMatrixHelpers}}
\doxysubsubsection{\texorpdfstring{concatenate\_without\_communication()}{concatenate\_without\_communication()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily \mbox{\hyperlink{classoomph_1_1TAdvectionDiffusionReactionElement}{void}} oomph\+::\+CRDouble\+Matrix\+Helpers\+::concatenate\+\_\+without\+\_\+communication (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classoomph_1_1TAdvectionDiffusionReactionElement}{const}} \mbox{\hyperlink{classoomph_1_1Vector}{Vector}}$<$ \mbox{\hyperlink{classoomph_1_1LinearAlgebraDistribution}{Linear\+Algebra\+Distribution}} \texorpdfstring{$\ast$}{*} $>$ \&}]{block\+\_\+distribution\+\_\+pt,  }\item[{\mbox{\hyperlink{classoomph_1_1TAdvectionDiffusionReactionElement}{const}} \mbox{\hyperlink{classoomph_1_1DenseMatrix}{Dense\+Matrix}}$<$ \mbox{\hyperlink{classoomph_1_1CRDoubleMatrix}{CRDouble\+Matrix}} \texorpdfstring{$\ast$}{*} $>$ \&}]{matrix\+\_\+pt,  }\item[{\mbox{\hyperlink{classoomph_1_1CRDoubleMatrix}{CRDouble\+Matrix}} \&}]{result\+\_\+matrix }\end{DoxyParamCaption})}



Concatenate \doxylink{classoomph_1_1CRDoubleMatrix}{CRDouble\+Matrix} matrices. This calls the other concatenate\+\_\+without\+\_\+communication(...) function, passing block\+\_\+distribution\+\_\+pt as both the row\+\_\+distribution\+\_\+pt and col\+\_\+distribution\+\_\+pt. This should only be called for block square matrices. 



Definition at line \mbox{\hyperlink{matrices_8cc_source_l05885}{5885}} of file \mbox{\hyperlink{matrices_8cc_source}{matrices.\+cc}}.



References \mbox{\hyperlink{matrices_8cc_source_l05223}{concatenate\+\_\+without\+\_\+communication()}}.

\Hypertarget{namespaceoomph_1_1CRDoubleMatrixHelpers_a996568831ca0db90f080560dd400b3d6}\label{namespaceoomph_1_1CRDoubleMatrixHelpers_a996568831ca0db90f080560dd400b3d6} 
\index{oomph::CRDoubleMatrixHelpers@{oomph::CRDoubleMatrixHelpers}!concatenate\_without\_communication@{concatenate\_without\_communication}}
\index{concatenate\_without\_communication@{concatenate\_without\_communication}!oomph::CRDoubleMatrixHelpers@{oomph::CRDoubleMatrixHelpers}}
\doxysubsubsection{\texorpdfstring{concatenate\_without\_communication()}{concatenate\_without\_communication()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily \mbox{\hyperlink{classoomph_1_1TAdvectionDiffusionReactionElement}{void}} oomph\+::\+CRDouble\+Matrix\+Helpers\+::concatenate\+\_\+without\+\_\+communication (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classoomph_1_1TAdvectionDiffusionReactionElement}{const}} \mbox{\hyperlink{classoomph_1_1Vector}{Vector}}$<$ \mbox{\hyperlink{classoomph_1_1LinearAlgebraDistribution}{Linear\+Algebra\+Distribution}} \texorpdfstring{$\ast$}{*} $>$ \&}]{row\+\_\+distribution\+\_\+pt,  }\item[{\mbox{\hyperlink{classoomph_1_1TAdvectionDiffusionReactionElement}{const}} \mbox{\hyperlink{classoomph_1_1Vector}{Vector}}$<$ \mbox{\hyperlink{classoomph_1_1LinearAlgebraDistribution}{Linear\+Algebra\+Distribution}} \texorpdfstring{$\ast$}{*} $>$ \&}]{col\+\_\+distribution\+\_\+pt,  }\item[{\mbox{\hyperlink{classoomph_1_1TAdvectionDiffusionReactionElement}{const}} \mbox{\hyperlink{classoomph_1_1DenseMatrix}{Dense\+Matrix}}$<$ \mbox{\hyperlink{classoomph_1_1CRDoubleMatrix}{CRDouble\+Matrix}} \texorpdfstring{$\ast$}{*} $>$ \&}]{matrix\+\_\+pt,  }\item[{\mbox{\hyperlink{classoomph_1_1CRDoubleMatrix}{CRDouble\+Matrix}} \&}]{result\+\_\+matrix }\end{DoxyParamCaption})}



Concatenate \doxylink{classoomph_1_1CRDoubleMatrix}{CRDouble\+Matrix} matrices. 

The \doxylink{classoomph_1_1Vector}{Vector} row\+\_\+distribution\+\_\+pt contains the \doxylink{classoomph_1_1LinearAlgebraDistribution}{Linear\+Algebra\+Distribution} of each block row. The \doxylink{classoomph_1_1Vector}{Vector} col\+\_\+distribution\+\_\+pt contains the \doxylink{classoomph_1_1LinearAlgebraDistribution}{Linear\+Algebra\+Distribution} of each block column. The \doxylink{classoomph_1_1DenseMatrix}{Dense\+Matrix} matrix\+\_\+pt contains pointers to the CRDouble\+Matrices to concatenate. The \doxylink{classoomph_1_1CRDoubleMatrix}{CRDouble\+Matrix} result\+\_\+matrix is the result matrix.

The result matrix is a permutation of the sub matrices such that the data stays on the same processor when the result matrix is built, there is no communication between processors. Thus the block structure of the sub matrices are NOT preserved in the result matrix. The rows are block-\/permuted, defined by the concatenation of the distributions in row\+\_\+distribution\+\_\+pt. Similarly, the columns are block-\/permuted, defined by the concatenation of the distributions in col\+\_\+distribution\+\_\+pt. For more details on the block-\/permutation, see Linear\+Algebra\+Distribution\+Helpers\+::concatenate(...).

If one wishes to preserve the block structure of the sub matrices in the result matrix, consider using CRDouble\+Matrix\+Helpers\+::concatenate(...), which uses communication between processors to ensure that the block structure of the sub matrices are preserved.

The matrix manipulation functions CRDouble\+Matrix\+Helpers\+::concatenate(...) and CRDouble\+Matrix\+Helpers\+::concatenate\+\_\+without\+\_\+communication(...) are analogous to the \doxylink{classoomph_1_1Vector}{Vector} manipulation functions Double\+Vector\+Helpers\+::concatenate(...) and Double\+Vector\+Helpers\+::concatenate\+\_\+without\+\_\+communication(...). Please look at the \doxylink{classoomph_1_1DoubleVector}{Double\+Vector} functions for an illustration of the differences between concatenate(...) and concatenate\+\_\+without\+\_\+communication(...).

Distribution of the result matrix\+: If the result matrix does not have a distribution built, then it will be given a distribution built from the concatenation of the distributions from row\+\_\+distribution\+\_\+pt, see Linear\+Algebra\+Distribution\+Helpers\+::concatenate(...) for more detail. Otherwise we use the existing distribution. If there is an existing distribution then it must be the same as the distribution from the concatenation of row distributions as described above. Why don\textquotesingle{}t we always compute the distribution "{}on the fly"{}? Because a non-\/uniform distribution requires communication. All block preconditioner distributions are concatenations of the distributions of the individual blocks. 

Definition at line \mbox{\hyperlink{matrices_8cc_source_l05223}{5223}} of file \mbox{\hyperlink{matrices_8cc_source}{matrices.\+cc}}.



References \mbox{\hyperlink{linear__algebra__distribution_8cc_source_l00367}{oomph\+::\+Linear\+Algebra\+Distribution\+Helpers\+::concatenate()}}, \mbox{\hyperlink{cfortran_8h_source_l00603}{i}}, and \mbox{\hyperlink{elements_8cc_source_l04320}{oomph\+::\+Finite\+Element\+::size()}}.



Referenced by \mbox{\hyperlink{matrices_8cc_source_l05885}{concatenate\+\_\+without\+\_\+communication()}}, \mbox{\hyperlink{block__preconditioner_8h_source_l00673}{oomph\+::\+Block\+Preconditioner$<$ MATRIX $>$\+::get\+\_\+block()}}, \mbox{\hyperlink{block__preconditioner_8h_source_l01134}{oomph\+::\+Block\+Preconditioner$<$ MATRIX $>$\+::get\+\_\+concatenated\+\_\+block()}}, and \mbox{\hyperlink{block__preconditioner_8cc_source_l05670}{oomph\+::\+Block\+Preconditioner$<$ MATRIX $>$\+::get\+\_\+dof\+\_\+level\+\_\+block()}}.

\Hypertarget{namespaceoomph_1_1CRDoubleMatrixHelpers_ae3c10e59d5857457c7e34be8e9262035}\label{namespaceoomph_1_1CRDoubleMatrixHelpers_ae3c10e59d5857457c7e34be8e9262035} 
\index{oomph::CRDoubleMatrixHelpers@{oomph::CRDoubleMatrixHelpers}!create\_uniformly\_distributed\_matrix@{create\_uniformly\_distributed\_matrix}}
\index{create\_uniformly\_distributed\_matrix@{create\_uniformly\_distributed\_matrix}!oomph::CRDoubleMatrixHelpers@{oomph::CRDoubleMatrixHelpers}}
\doxysubsubsection{\texorpdfstring{create\_uniformly\_distributed\_matrix()}{create\_uniformly\_distributed\_matrix()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classoomph_1_1TAdvectionDiffusionReactionElement}{void}} oomph\+::\+CRDouble\+Matrix\+Helpers\+::create\+\_\+uniformly\+\_\+distributed\+\_\+matrix (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classoomph_1_1TAdvectionDiffusionReactionElement}{const}} \mbox{\hyperlink{classoomph_1_1TAdvectionDiffusionReactionElement}{unsigned}} \&}]{nrow,  }\item[{\mbox{\hyperlink{classoomph_1_1TAdvectionDiffusionReactionElement}{const}} \mbox{\hyperlink{classoomph_1_1TAdvectionDiffusionReactionElement}{unsigned}} \&}]{ncol,  }\item[{\mbox{\hyperlink{classoomph_1_1TAdvectionDiffusionReactionElement}{const}} \mbox{\hyperlink{classoomph_1_1OomphCommunicator}{Oomph\+Communicator}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{classoomph_1_1TAdvectionDiffusionReactionElement}{const}}}]{comm\+\_\+pt,  }\item[{\mbox{\hyperlink{classoomph_1_1TAdvectionDiffusionReactionElement}{const}} \mbox{\hyperlink{classoomph_1_1Vector}{Vector}}$<$ \mbox{\hyperlink{classoomph_1_1TAdvectionDiffusionReactionElement}{double}} $>$ \&}]{values,  }\item[{\mbox{\hyperlink{classoomph_1_1TAdvectionDiffusionReactionElement}{const}} \mbox{\hyperlink{classoomph_1_1Vector}{Vector}}$<$ \mbox{\hyperlink{classoomph_1_1TAdvectionDiffusionReactionElement}{int}} $>$ \&}]{column\+\_\+indices,  }\item[{\mbox{\hyperlink{classoomph_1_1TAdvectionDiffusionReactionElement}{const}} \mbox{\hyperlink{classoomph_1_1Vector}{Vector}}$<$ \mbox{\hyperlink{classoomph_1_1TAdvectionDiffusionReactionElement}{int}} $>$ \&}]{row\+\_\+start,  }\item[{\mbox{\hyperlink{classoomph_1_1CRDoubleMatrix}{CRDouble\+Matrix}} \&}]{matrix\+\_\+out }\end{DoxyParamCaption})}



Builds a uniformly distributed matrix. A locally replicated matrix is constructed then redistributed using OOMPH-\/\+LIB\textquotesingle{}s default uniform row distribution. This is memory intensive thus should be used for testing or small problems only. 

Builds a uniformly distributed matrix. A locally replicated matrix is constructed then redistributed using OOMPH-\/\+LIB\textquotesingle{}s default uniform row distribution. This is memory intensive thus should be used for testing or small problems only. The resulting matrix (mat\+\_\+out) must not have been built. 

Definition at line \mbox{\hyperlink{matrices_8cc_source_l03676}{3676}} of file \mbox{\hyperlink{matrices_8cc_source}{matrices.\+cc}}.

\Hypertarget{namespaceoomph_1_1CRDoubleMatrixHelpers_a157511f700993ab8bc014f9d0d44f4c7}\label{namespaceoomph_1_1CRDoubleMatrixHelpers_a157511f700993ab8bc014f9d0d44f4c7} 
\index{oomph::CRDoubleMatrixHelpers@{oomph::CRDoubleMatrixHelpers}!deep\_copy@{deep\_copy}}
\index{deep\_copy@{deep\_copy}!oomph::CRDoubleMatrixHelpers@{oomph::CRDoubleMatrixHelpers}}
\doxysubsubsection{\texorpdfstring{deep\_copy()}{deep\_copy()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classoomph_1_1TAdvectionDiffusionReactionElement}{void}} oomph\+::\+CRDouble\+Matrix\+Helpers\+::deep\+\_\+copy (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classoomph_1_1TAdvectionDiffusionReactionElement}{const}} \mbox{\hyperlink{classoomph_1_1CRDoubleMatrix}{CRDouble\+Matrix}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{classoomph_1_1TAdvectionDiffusionReactionElement}{const}}}]{in\+\_\+matrix\+\_\+pt,  }\item[{\mbox{\hyperlink{classoomph_1_1CRDoubleMatrix}{CRDouble\+Matrix}} \&}]{out\+\_\+matrix }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [private]}}



Create a deep copy of the matrix pointed to by in\+\_\+matrix\+\_\+pt. 



Definition at line \mbox{\hyperlink{matrices_8h_source_l03490}{3490}} of file \mbox{\hyperlink{matrices_8h_source}{matrices.\+h}}.



Referenced by \mbox{\hyperlink{block__preconditioner_8h_source_l00673}{oomph\+::\+Block\+Preconditioner$<$ MATRIX $>$\+::get\+\_\+block()}}, and \mbox{\hyperlink{block__preconditioner_8cc_source_l05670}{oomph\+::\+Block\+Preconditioner$<$ MATRIX $>$\+::get\+\_\+dof\+\_\+level\+\_\+block()}}.

\Hypertarget{namespaceoomph_1_1CRDoubleMatrixHelpers_a02b5962dbe2bbfb93f54b668100afffc}\label{namespaceoomph_1_1CRDoubleMatrixHelpers_a02b5962dbe2bbfb93f54b668100afffc} 
\index{oomph::CRDoubleMatrixHelpers@{oomph::CRDoubleMatrixHelpers}!gershgorin\_eigenvalue\_estimate@{gershgorin\_eigenvalue\_estimate}}
\index{gershgorin\_eigenvalue\_estimate@{gershgorin\_eigenvalue\_estimate}!oomph::CRDoubleMatrixHelpers@{oomph::CRDoubleMatrixHelpers}}
\doxysubsubsection{\texorpdfstring{gershgorin\_eigenvalue\_estimate()}{gershgorin\_eigenvalue\_estimate()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classoomph_1_1TAdvectionDiffusionReactionElement}{double}} oomph\+::\+CRDouble\+Matrix\+Helpers\+::gershgorin\+\_\+eigenvalue\+\_\+estimate (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classoomph_1_1TAdvectionDiffusionReactionElement}{const}} \mbox{\hyperlink{classoomph_1_1DenseMatrix}{Dense\+Matrix}}$<$ \mbox{\hyperlink{classoomph_1_1CRDoubleMatrix}{CRDouble\+Matrix}} \texorpdfstring{$\ast$}{*} $>$ \&}]{matrix\+\_\+pt }\end{DoxyParamCaption})}



Calculates the largest Gershgorin disc whilst preserving the sign. Let A be an n by n matrix, with entries aij. For $ i \in \{ 1,...,n \} $ let $ R_i = \sum_{i\neq j} |a_{ij}| $ be the sum of the absolute values of the non-\/diagonal entries in the i-\/th row. Let $ D(a_{ii},R_i) $ be the closed disc centered at $ a_{ii} $ with radius $ R_i $, such a disc is called a Gershgorin disc. 

~\newline
 We calculate $ |D(a_{ii},R_i)|_{max} $ and multiply by the sign of the diagonal entry.

~\newline
 The \doxylink{classoomph_1_1DenseMatrix}{Dense\+Matrix} of CRDouble\+Matrices are treated as if they are one large matrix. Therefore the dimensions of the sub matrices has to "{}make sense"{}, there is a paranoid check for this.

~\newline
 We calculate $ |D(a_{ii},R_i)|_{max} $and multiply by the sign of the diagonal entry.

~\newline
 The \doxylink{classoomph_1_1DenseMatrix}{Dense\+Matrix} of CRDouble\+Matrices are treated as if they are one large matrix. Therefore the dimensions of the sub matrices has to "{}make sense"{}, there is a paranoid check for this. 

Definition at line \mbox{\hyperlink{matrices_8cc_source_l04003}{4003}} of file \mbox{\hyperlink{matrices_8cc_source}{matrices.\+cc}}.

\Hypertarget{namespaceoomph_1_1CRDoubleMatrixHelpers_ab17222c9461096e3d5b8cf6250524644}\label{namespaceoomph_1_1CRDoubleMatrixHelpers_ab17222c9461096e3d5b8cf6250524644} 
\index{oomph::CRDoubleMatrixHelpers@{oomph::CRDoubleMatrixHelpers}!inf\_norm@{inf\_norm}}
\index{inf\_norm@{inf\_norm}!oomph::CRDoubleMatrixHelpers@{oomph::CRDoubleMatrixHelpers}}
\doxysubsubsection{\texorpdfstring{inf\_norm()}{inf\_norm()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classoomph_1_1TAdvectionDiffusionReactionElement}{double}} oomph\+::\+CRDouble\+Matrix\+Helpers\+::inf\+\_\+norm (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classoomph_1_1TAdvectionDiffusionReactionElement}{const}} \mbox{\hyperlink{classoomph_1_1DenseMatrix}{Dense\+Matrix}}$<$ \mbox{\hyperlink{classoomph_1_1CRDoubleMatrix}{CRDouble\+Matrix}} \texorpdfstring{$\ast$}{*} $>$ \&}]{matrix\+\_\+pt }\end{DoxyParamCaption})}



Compute infinity (maximum) norm of sub blocks as if it was one matrix. 

Calculates the infinity (maximum) norm of a Dense\+Martrix of CRDouble\+Matrices as if it was one large matrix. This avoids creating a concatenation of the sub-\/blocks just to calculate the infinity norm. 

Definition at line \mbox{\hyperlink{matrices_8cc_source_l03731}{3731}} of file \mbox{\hyperlink{matrices_8cc_source}{matrices.\+cc}}.



References \mbox{\hyperlink{matrices_8cc_source_l03731}{inf\+\_\+norm()}}.



Referenced by \mbox{\hyperlink{matrices_8cc_source_l03731}{inf\+\_\+norm()}}, \mbox{\hyperlink{pseudo__elastic__preconditioner_8cc_source_l00114}{oomph\+::\+Pseudo\+Elastic\+Preconditioner\+::setup()}}, and \mbox{\hyperlink{lagrange__enforced__flow__preconditioner_8cc_source_l00507}{oomph\+::\+Lagrange\+Enforced\+Flow\+Preconditioner\+::setup()}}.


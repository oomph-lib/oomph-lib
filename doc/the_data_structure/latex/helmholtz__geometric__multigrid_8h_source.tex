\hypertarget{helmholtz__geometric__multigrid_8h_source}{}\doxysection{helmholtz\+\_\+geometric\+\_\+multigrid.\+h}
\label{helmholtz__geometric__multigrid_8h_source}\index{helmholtz\_geometric\_multigrid.h@{helmholtz\_geometric\_multigrid.h}}
\mbox{\hyperlink{helmholtz__geometric__multigrid_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00001}00001 \textcolor{comment}{// LIC// ====================================================================}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00002}00002 \textcolor{comment}{// LIC// This file forms part of oomph-\/lib, the object-\/oriented,}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00003}00003 \textcolor{comment}{// LIC// multi-\/physics finite-\/element library, available}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00004}00004 \textcolor{comment}{// LIC// at http://www.oomph-\/lib.org.}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00005}00005 \textcolor{comment}{// LIC//}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00006}00006 \textcolor{comment}{// LIC// Copyright (C) 2006-\/2021 Matthias Heil and Andrew Hazel}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00007}00007 \textcolor{comment}{// LIC//}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00008}00008 \textcolor{comment}{// LIC// This library is free software; you can redistribute it and/or}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00009}00009 \textcolor{comment}{// LIC// modify it under the terms of the GNU Lesser General Public}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00010}00010 \textcolor{comment}{// LIC// License as published by the Free Software Foundation; either}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00011}00011 \textcolor{comment}{// LIC// version 2.1 of the License, or (at your option) any later version.}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00012}00012 \textcolor{comment}{// LIC//}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00013}00013 \textcolor{comment}{// LIC// This library is distributed in the hope that it will be useful,}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00014}00014 \textcolor{comment}{// LIC// but WITHOUT ANY WARRANTY; without even the implied warranty of}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00015}00015 \textcolor{comment}{// LIC// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00016}00016 \textcolor{comment}{// LIC// Lesser General Public License for more details.}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00017}00017 \textcolor{comment}{// LIC//}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00018}00018 \textcolor{comment}{// LIC// You should have received a copy of the GNU Lesser General Public}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00019}00019 \textcolor{comment}{// LIC// License along with this library; if not, write to the Free Software}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00020}00020 \textcolor{comment}{// LIC// Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00021}00021 \textcolor{comment}{// LIC// 02110-\/1301  USA.}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00022}00022 \textcolor{comment}{// LIC//}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00023}00023 \textcolor{comment}{// LIC// The authors may be contacted at oomph-\/lib@maths.man.ac.uk.}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00024}00024 \textcolor{comment}{// LIC//}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00025}00025 \textcolor{comment}{// LIC//====================================================================}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00026}00026 \textcolor{comment}{// Include guards}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00027}00027 \textcolor{preprocessor}{\#ifndef OOMPH\_HELMHOLTZ\_GEOMETRIC\_MULTIGRID\_HEADER}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00028}00028 \textcolor{preprocessor}{\#define OOMPH\_HELMHOLTZ\_GEOMETRIC\_MULTIGRID\_HEADER}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00029}00029 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00030}00030 \textcolor{comment}{// Config header generated by autoconfig}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00031}00031 \textcolor{preprocessor}{\#ifdef HAVE\_CONFIG\_H}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00032}00032 \textcolor{preprocessor}{\#include <config.h>}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00033}00033 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00034}00034 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00035}00035 \textcolor{comment}{// Oomph-\/lib headers}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00036}00036 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{problem_8h}{generic/problem.h}}"{}}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00037}00037 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{matrices_8h}{generic/matrices.h}}"{}}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00038}00038 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{preconditioner_8h}{generic/preconditioner.h}}"{}}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00039}00039 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00040}00040 \textcolor{comment}{// Include the complex smoother}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00041}00041 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{complex__smoother_8h}{complex\_smoother.h}}"{}}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00042}00042 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00043}00043 \textcolor{comment}{// Namespace extension}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00044}00044 \textcolor{keyword}{namespace }\mbox{\hyperlink{namespaceoomph}{oomph}}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00045}00045 \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00046}00046   \textcolor{comment}{//======================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00047}00047 \textcolor{comment}{  /// HelmholtzMGProblem class; subclass of Problem}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00048}00048 \textcolor{comment}{}  \textcolor{comment}{//======================================================================}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00049}\mbox{\hyperlink{classoomph_1_1HelmholtzMGProblem}{00049}}   \textcolor{keyword}{class }\mbox{\hyperlink{classoomph_1_1HelmholtzMGProblem}{HelmholtzMGProblem}} : \textcolor{keyword}{public} \textcolor{keyword}{virtual} \mbox{\hyperlink{classoomph_1_1Problem}{Problem}}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00050}00050   \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00051}00051   \textcolor{keyword}{public}:\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00052}00052 \textcolor{comment}{    /// Constructor. Initialise pointers to coarser and finer levels}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00053}\mbox{\hyperlink{classoomph_1_1HelmholtzMGProblem_ab74fba72dcdfc8f448a992944764cd4c}{00053}} \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1HelmholtzMGProblem_ab74fba72dcdfc8f448a992944764cd4c}{HelmholtzMGProblem}}() \{\}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00054}00054 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00055}00055 \textcolor{comment}{    /// Destructor (empty)}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00056}\mbox{\hyperlink{classoomph_1_1HelmholtzMGProblem_a0cc940bfc51d6e95e420b60938640e54}{00056}} \textcolor{comment}{}    \textcolor{keyword}{virtual} \mbox{\hyperlink{classoomph_1_1HelmholtzMGProblem_a0cc940bfc51d6e95e420b60938640e54}{\string~HelmholtzMGProblem}}() \{\}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00057}00057 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00058}00058 \textcolor{comment}{    /// This function needs to be implemented in the derived problem:}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00059}00059 \textcolor{comment}{    /// Returns a pointer to a new object of the same type as the derived}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00060}00060 \textcolor{comment}{    /// problem}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00061}\mbox{\hyperlink{classoomph_1_1HelmholtzMGProblem_a174dfbef9a1f46e103e50046c47138e6}{00061}} \textcolor{comment}{}    \textcolor{keyword}{virtual} \mbox{\hyperlink{classoomph_1_1HelmholtzMGProblem}{HelmholtzMGProblem}}* \mbox{\hyperlink{classoomph_1_1HelmholtzMGProblem_a174dfbef9a1f46e103e50046c47138e6}{make\_new\_problem}}() = 0;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00062}00062 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00063}00063 \textcolor{comment}{    /// Function to get a pointer to the mesh we will be working}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00064}00064 \textcolor{comment}{    /// with. If there are flux elements present in the mesh this will}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00065}00065 \textcolor{comment}{    /// be overloaded to return a pointer to the bulk mesh otherwise}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00066}00066 \textcolor{comment}{    /// it can be overloaded to point to the global mesh but it must}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00067}00067 \textcolor{comment}{    /// be of type RefineableMeshBase}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00068}\mbox{\hyperlink{classoomph_1_1HelmholtzMGProblem_a647ea79cc9e3e032158aa8416419af8c}{00068}} \textcolor{comment}{}    \textcolor{keyword}{virtual} \mbox{\hyperlink{classoomph_1_1TreeBasedRefineableMeshBase}{TreeBasedRefineableMeshBase}}* \mbox{\hyperlink{classoomph_1_1HelmholtzMGProblem_a647ea79cc9e3e032158aa8416419af8c}{mg\_bulk\_mesh\_pt}}() = 0;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00069}00069 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00070}00070   \}; \textcolor{comment}{// End of HelmholtzMGProblem class}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00071}00071 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00072}00072 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00073}00073 \textcolor{comment}{  /// ///////////////////////////////////////////////////////}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00074}00074 \textcolor{comment}{  /// ///////////////////////////////////////////////////////}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00075}00075 \textcolor{comment}{  /// ///////////////////////////////////////////////////////}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00076}00076 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00077}00077 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00078}00078   \textcolor{comment}{//======================================================================}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00079}00079   \textcolor{comment}{// MG solver class}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00080}00080   \textcolor{comment}{//======================================================================}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00081}00081   \textcolor{keyword}{template}<\textcolor{keywordtype}{unsigned} DIM>}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00082}\mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner}{00082}}   \textcolor{keyword}{class }\mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner}{HelmholtzMGPreconditioner}} : \textcolor{keyword}{public} \mbox{\hyperlink{classoomph_1_1BlockPreconditioner}{BlockPreconditioner}}<CRDoubleMatrix>}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00083}00083   \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00084}00084   \textcolor{keyword}{public}:\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00085}00085 \textcolor{comment}{    /// typedef for a function that returns a pointer to an object}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00086}00086 \textcolor{comment}{    /// of the class HelmholtzSmoother to be used as the pre-\/smoother}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00087}\mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_aca6ee77e89305b85d919de7bde5b615a}{00087}} \textcolor{comment}{}    \textcolor{keyword}{typedef} \mbox{\hyperlink{classoomph_1_1HelmholtzSmoother}{HelmholtzSmoother}}* (*PreSmootherFactoryFctPt)();}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00088}00088 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00089}00089 \textcolor{comment}{    /// typedef for a function that returns a pointer to an object}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00090}00090 \textcolor{comment}{    /// of the class HelmholtzSmoother to be used as the post-\/smoother}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00091}\mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a8a406608f8023396db4a11ad1e3bd3f8}{00091}} \textcolor{comment}{}    \textcolor{keyword}{typedef} \mbox{\hyperlink{classoomph_1_1HelmholtzSmoother}{HelmholtzSmoother}}* (*PostSmootherFactoryFctPt)();}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00092}00092 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00093}00093 \textcolor{comment}{    /// Access function to set the pre-\/smoother creation function.}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00094}\mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_acb562183934ee547bcd359fb45304522}{00094}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_acb562183934ee547bcd359fb45304522}{set\_pre\_smoother\_factory\_function}}(}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00095}00095       \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_aca6ee77e89305b85d919de7bde5b615a}{PreSmootherFactoryFctPt}} pre\_smoother\_fn)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00096}00096     \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00097}00097       \textcolor{comment}{// Assign the function pointer}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00098}00098       \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a22d2d1b715d6789ea56301d79a952d6a}{Pre\_smoother\_factory\_function\_pt}} = pre\_smoother\_fn;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00099}00099     \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00100}00100 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00101}00101 \textcolor{comment}{    /// Access function to set the post-\/smoother creation function.}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00102}\mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a986dc273c291bcaa9607661f9f3ab06f}{00102}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a986dc273c291bcaa9607661f9f3ab06f}{set\_post\_smoother\_factory\_function}}(}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00103}00103       \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a8a406608f8023396db4a11ad1e3bd3f8}{PostSmootherFactoryFctPt}} post\_smoother\_fn)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00104}00104     \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00105}00105       \textcolor{comment}{// Assign the function pointer}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00106}00106       \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a6c837962598479ba2eafd3978fccab9c}{Post\_smoother\_factory\_function\_pt}} = post\_smoother\_fn;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00107}00107     \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00108}00108 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00109}00109 \textcolor{comment}{    /// Constructor: Set up default values for number of V-\/cycles}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00110}00110 \textcolor{comment}{    /// and pre-\/ and post-\/smoothing steps.}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00111}\mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a8a91f0e5891cf326143e83071073e01d}{00111}} \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a8a91f0e5891cf326143e83071073e01d}{HelmholtzMGPreconditioner}}(\mbox{\hyperlink{classoomph_1_1HelmholtzMGProblem}{HelmholtzMGProblem}}* mg\_problem\_pt)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00112}00112       : \mbox{\hyperlink{classoomph_1_1BlockPreconditioner}{BlockPreconditioner}}<\mbox{\hyperlink{classoomph_1_1CRDoubleMatrix}{CRDoubleMatrix}}>(),}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00113}00113         \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a22d2d1b715d6789ea56301d79a952d6a}{Pre\_smoother\_factory\_function\_pt}}(0),}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00114}00114         \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a6c837962598479ba2eafd3978fccab9c}{Post\_smoother\_factory\_function\_pt}}(0),}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00115}00115         \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_abfc68dd81954261a2d5dbdc891c4aa67}{Mg\_problem\_pt}}(mg\_problem\_pt),}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00116}00116         \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a3d152eb2679cab29ae536c5016111e38}{Tolerance}}(1.0e-\/09),}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00117}00117         \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a61acd84465a380527d9b0dc24b85ac42}{Npre\_smooth}}(2),}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00118}00118         \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a752216736f7fcb37f8476cea03916b6e}{Npost\_smooth}}(2),}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00119}00119         \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_ad7cd9523e0f32e2f882d570db7382d6c}{Nvcycle}}(1),}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00120}00120         \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a74fc85625ca9007857e14f38c6cbc260}{Doc\_time}}(true),}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00121}00121         \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a7d2d22a686e109645a7e2fb39f3de704}{Suppress\_v\_cycle\_output}}(false),}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00122}00122         \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_acfa013d5b84d1e611c9c2514aedd71cc}{Suppress\_all\_output}}(false),}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00123}00123         \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a5f55a8429e948ec42cad90add3b74488}{Has\_been\_setup}}(false),}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00124}00124         \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_ad388b2b7f4f099f5bc478dfc7088c1a2}{Has\_been\_solved}}(false),}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00125}00125         \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_ab6fb66075019d6d68be33e2dc8332d83}{Stream\_pt}}(0),}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00126}00126         \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a99ced707bfbb8f6d0428419675236879}{Alpha\_shift}}(0.0)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00127}00127     \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00128}00128       \textcolor{comment}{// Set the pointer to the finest level as the first}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00129}00129       \textcolor{comment}{// entry in Mg\_hierarchy\_pt}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00130}00130       \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a77c24f2c136211274a0f0326694eff51}{Mg\_hierarchy\_pt}}.push\_back(\mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_abfc68dd81954261a2d5dbdc891c4aa67}{Mg\_problem\_pt}});}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00131}00131     \} \textcolor{comment}{// End of HelmholtzMGPreconditioner}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00132}00132 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00133}00133 \textcolor{comment}{    /// Delete any dynamically allocated data}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00134}\mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_adf5e9f25f44d6447c6368da87de8057e}{00134}} \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_adf5e9f25f44d6447c6368da87de8057e}{\string~HelmholtzMGPreconditioner}}()}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00135}00135     \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00136}00136       \textcolor{comment}{// Run the function written to clean up the memory}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00137}00137       \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a8ffcf85fcfeac6c4d17c14c6ee35549b}{clean\_up\_memory}}();}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00138}00138     \} \textcolor{comment}{// End of \string~HelmholtzMGPreconditioner}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00139}00139 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00140}00140 \textcolor{comment}{    /// Clean up anything that needs to be cleaned up}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00141}\mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a8ffcf85fcfeac6c4d17c14c6ee35549b}{00141}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a8ffcf85fcfeac6c4d17c14c6ee35549b}{clean\_up\_memory}}()}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00142}00142     \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00143}00143       \textcolor{comment}{// We only need to destroy data if the solver has been set up and}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00144}00144       \textcolor{comment}{// the data hasn't already been cleared}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00145}00145       \textcolor{keywordflow}{if} (\mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a5f55a8429e948ec42cad90add3b74488}{Has\_been\_setup}})}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00146}00146       \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00147}00147         \textcolor{comment}{// Loop over all of the levels in the hierarchy}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00148}00148         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_af9e0d8ee42dc6f596f384cbe0d9ce882}{Nlevel}} -\/ 1; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00149}00149         \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00150}00150           \textcolor{comment}{// Delete the pre-\/smoother associated with this level}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00151}00151           \textcolor{keyword}{delete} \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_ab00508738be7bfdf669d54cef639838f}{Pre\_smoothers\_storage\_pt}}[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}];}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00152}00152 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00153}00153           \textcolor{comment}{// Make it a null pointer}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00154}00154           \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_ab00508738be7bfdf669d54cef639838f}{Pre\_smoothers\_storage\_pt}}[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] = 0;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00155}00155 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00156}00156           \textcolor{comment}{// Delete the post-\/smoother associated with this level}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00157}00157           \textcolor{keyword}{delete} \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_abb0d32382cd2a06081359b3fda7cc15d}{Post\_smoothers\_storage\_pt}}[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}];}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00158}00158 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00159}00159           \textcolor{comment}{// Make it a null pointer}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00160}00160           \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_abb0d32382cd2a06081359b3fda7cc15d}{Post\_smoothers\_storage\_pt}}[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] = 0;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00161}00161 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00162}00162           \textcolor{comment}{// Loop over the real and imaginary parts of the system matrix}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00163}00163           \textcolor{comment}{// associated with the i-\/th level}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00164}00164           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < 2; j++)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00165}00165           \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00166}00166             \textcolor{comment}{// Delete the real/imaginary part of the system matrix}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00167}00167             \textcolor{keyword}{delete} \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_ae916b035dd57061a64cef1314ef50d0c}{Mg\_matrices\_storage\_pt}}[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}][j];}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00168}00168 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00169}00169             \textcolor{comment}{// Make it a null pointer}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00170}00170             \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_ae916b035dd57061a64cef1314ef50d0c}{Mg\_matrices\_storage\_pt}}[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}][j] = 0;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00171}00171           \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00172}00172         \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00173}00173 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00174}00174         \textcolor{comment}{// Delete the expanded matrix associated with the problem on the}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00175}00175         \textcolor{comment}{// coarsest level}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00176}00176         \textcolor{keyword}{delete} \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a3258a6f09f4c4378cd6619f194e5d24b}{Coarsest\_matrix\_mg\_pt}};}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00177}00177 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00178}00178         \textcolor{comment}{// Make it a null pointer}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00179}00179         \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a3258a6f09f4c4378cd6619f194e5d24b}{Coarsest\_matrix\_mg\_pt}} = 0;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00180}00180 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00181}00181         \textcolor{comment}{// Loop over all but the coarsest of the levels in the hierarchy}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00182}00182         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_af9e0d8ee42dc6f596f384cbe0d9ce882}{Nlevel}} -\/ 1; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00183}00183         \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00184}00184           \textcolor{comment}{// Delete the interpolation matrix associated with the i-\/th level}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00185}00185           \textcolor{keyword}{delete} \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a661811aae02c456b338964cb5e918e70}{Interpolation\_matrices\_storage\_pt}}[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}];}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00186}00186 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00187}00187           \textcolor{comment}{// Make it a null pointer}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00188}00188           \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a661811aae02c456b338964cb5e918e70}{Interpolation\_matrices\_storage\_pt}}[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] = 0;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00189}00189 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00190}00190           \textcolor{comment}{// Delete the restriction matrix associated with the i-\/th level}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00191}00191           \textcolor{keyword}{delete} \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a4a268a461998cabc0b65e256ee6a039f}{Restriction\_matrices\_storage\_pt}}[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}];}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00192}00192 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00193}00193           \textcolor{comment}{// Make it a null pointer}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00194}00194           \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a4a268a461998cabc0b65e256ee6a039f}{Restriction\_matrices\_storage\_pt}}[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] = 0;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00195}00195         \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00196}00196 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00197}00197         \textcolor{comment}{// Everything has been deleted now so we need to indicate that the}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00198}00198         \textcolor{comment}{// solver is not set up}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00199}00199         \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a5f55a8429e948ec42cad90add3b74488}{Has\_been\_setup}} = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00200}00200       \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00201}00201     \} \textcolor{comment}{// End of clean\_up\_memory}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00202}00202 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00203}00203 \textcolor{comment}{    /// Access function for the variable Tolerance (lvalue)}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00204}\mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_ad88861e8f80011fd863e7f798767b57f}{00204}} \textcolor{comment}{}    \textcolor{keywordtype}{double}\& \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_ad88861e8f80011fd863e7f798767b57f}{tolerance}}()}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00205}00205     \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00206}00206       \textcolor{comment}{// Return the variable, Tolerance}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00207}00207       \textcolor{keywordflow}{return} \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a3d152eb2679cab29ae536c5016111e38}{Tolerance}};}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00208}00208     \} \textcolor{comment}{// End of tolerance}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00209}00209 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00210}00210 \textcolor{comment}{    /// Function to change the value of the shift}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00211}\mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_aad93f23acc3730992bd46a1d16dcea66}{00211}} \textcolor{comment}{}    \textcolor{keywordtype}{double}\& \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_aad93f23acc3730992bd46a1d16dcea66}{alpha\_shift}}()}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00212}00212     \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00213}00213       \textcolor{comment}{// Return the alpha shift value}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00214}00214       \textcolor{keywordflow}{return} \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a99ced707bfbb8f6d0428419675236879}{Alpha\_shift}};}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00215}00215     \} \textcolor{comment}{// End of alpha\_shift}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00216}00216 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00217}00217 \textcolor{comment}{    /// Disable time documentation}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00218}\mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a52d0a5e2e0b2ac9cdbfbe639cd743eab}{00218}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a52d0a5e2e0b2ac9cdbfbe639cd743eab}{disable\_doc\_time}}()}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00219}00219     \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00220}00220       \textcolor{comment}{// Set the value of Doc\_time to false}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00221}00221       \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a74fc85625ca9007857e14f38c6cbc260}{Doc\_time}} = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00222}00222     \} \textcolor{comment}{// End of disable\_doc\_time}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00223}00223 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00224}00224 \textcolor{comment}{    /// Disable all output from mg\_solve apart from the number of}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00225}00225 \textcolor{comment}{    /// V-\/cycles used to solve the problem}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00226}\mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a2b5549471018be9d22b5ecdc95c9c113}{00226}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a2b5549471018be9d22b5ecdc95c9c113}{disable\_v\_cycle\_output}}()}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00227}00227     \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00228}00228       \textcolor{comment}{// Set the value of Doc\_time to false}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00229}00229       \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a74fc85625ca9007857e14f38c6cbc260}{Doc\_time}} = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00230}00230 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00231}00231       \textcolor{comment}{// Enable the suppression of output from the V-\/cycle}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00232}00232       \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a7d2d22a686e109645a7e2fb39f3de704}{Suppress\_v\_cycle\_output}} = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00233}00233     \} \textcolor{comment}{// End of disable\_v\_cycle\_output}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00234}00234 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00235}00235 \textcolor{comment}{    /// Suppress anything that can be suppressed, i.e. any timings.}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00236}00236 \textcolor{comment}{    /// Things like mesh adaptation can not however be silenced using this}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00237}\mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a313a399ae5138487c8d45efcfdc72fe3}{00237}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a313a399ae5138487c8d45efcfdc72fe3}{disable\_output}}()}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00238}00238     \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00239}00239       \textcolor{comment}{// Set the value of Doc\_time to false}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00240}00240       \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a74fc85625ca9007857e14f38c6cbc260}{Doc\_time}} = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00241}00241 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00242}00242       \textcolor{comment}{// Enable the suppression of output from the V-\/cycle}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00243}00243       \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a7d2d22a686e109645a7e2fb39f3de704}{Suppress\_v\_cycle\_output}} = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00244}00244 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00245}00245       \textcolor{comment}{// Enable the suppression of everything}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00246}00246       \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_acfa013d5b84d1e611c9c2514aedd71cc}{Suppress\_all\_output}} = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00247}00247 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00248}00248       \textcolor{comment}{// Store the output stream pointer}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00249}00249       \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_ab6fb66075019d6d68be33e2dc8332d83}{Stream\_pt}} = \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}}.\mbox{\hyperlink{classoomph_1_1OomphInfo_a353cd56d96da9152d6d730b328c07a06}{stream\_pt}}();}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00250}00250 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00251}00251       \textcolor{comment}{// Now set the oomph\_info stream pointer to the null stream to}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00252}00252       \textcolor{comment}{// disable all possible output}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00253}00253       \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}}.\mbox{\hyperlink{classoomph_1_1OomphInfo_a353cd56d96da9152d6d730b328c07a06}{stream\_pt}}() = \&\mbox{\hyperlink{namespaceoomph_a71421688cd14bcbb18a23c64b7245941}{oomph\_nullstream}};}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00254}00254     \} \textcolor{comment}{// End of disable\_output}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00255}00255 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00256}00256 \textcolor{comment}{    /// Enable time documentation}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00257}\mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a9a67bdd2dc6b32b89026fb5e70c4883f}{00257}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a9a67bdd2dc6b32b89026fb5e70c4883f}{enable\_doc\_time}}()}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00258}00258     \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00259}00259       \textcolor{comment}{// Set the value of Doc\_time to true}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00260}00260       \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a74fc85625ca9007857e14f38c6cbc260}{Doc\_time}} = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00261}00261     \} \textcolor{comment}{// End of enable\_doc\_time}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00262}00262 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00263}00263 \textcolor{comment}{    /// Enable the output of the V-\/cycle timings and other output}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00264}\mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a0978e7e6cfa01eb58c10b88ba4c9f2e5}{00264}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a0978e7e6cfa01eb58c10b88ba4c9f2e5}{enable\_v\_cycle\_output}}()}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00265}00265     \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00266}00266       \textcolor{comment}{// Enable time documentation}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00267}00267       \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a74fc85625ca9007857e14f38c6cbc260}{Doc\_time}} = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00268}00268 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00269}00269       \textcolor{comment}{// Enable output from the MG solver}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00270}00270       \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a7d2d22a686e109645a7e2fb39f3de704}{Suppress\_v\_cycle\_output}} = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00271}00271     \} \textcolor{comment}{// End of enable\_v\_cycle\_output}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00272}00272 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00273}00273 \textcolor{comment}{    /// Enable the output from anything that could have been suppressed}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00274}\mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a91ba5204f62cf8df208d51025cb56fba}{00274}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a91ba5204f62cf8df208d51025cb56fba}{enable\_output}}()}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00275}00275     \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00276}00276       \textcolor{comment}{// Enable time documentation}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00277}00277       \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a74fc85625ca9007857e14f38c6cbc260}{Doc\_time}} = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00278}00278 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00279}00279       \textcolor{comment}{// Enable output from everything during the full setup of the solver}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00280}00280       \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_acfa013d5b84d1e611c9c2514aedd71cc}{Suppress\_all\_output}} = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00281}00281 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00282}00282       \textcolor{comment}{// Enable output from the MG solver}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00283}00283       \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a7d2d22a686e109645a7e2fb39f3de704}{Suppress\_v\_cycle\_output}} = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00284}00284     \} \textcolor{comment}{// End of enable\_output}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00285}00285 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00286}00286 \textcolor{comment}{    /// Suppress the output of both smoothers and SuperLU}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00287}\mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a68e5048a3e62dac7036e36eb1e514b95}{00287}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a68e5048a3e62dac7036e36eb1e514b95}{disable\_smoother\_and\_superlu\_doc\_time}}()}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00288}00288     \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00289}00289       \textcolor{comment}{// Loop over all levels of the hierarchy}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00290}00290       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_af9e0d8ee42dc6f596f384cbe0d9ce882}{Nlevel}} -\/ 1; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00291}00291       \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00292}00292         \textcolor{comment}{// Disable time documentation on each level (for each pre-\/smoother)}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00293}00293         \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_ab00508738be7bfdf669d54cef639838f}{Pre\_smoothers\_storage\_pt}}[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]-\/>disable\_doc\_time();}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00294}00294 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00295}00295         \textcolor{comment}{// Disable time documentation on each level (for each post-\/smoother)}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00296}00296         \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_abb0d32382cd2a06081359b3fda7cc15d}{Post\_smoothers\_storage\_pt}}[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]-\/>disable\_doc\_time();}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00297}00297       \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00298}00298 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00299}00299       \textcolor{comment}{// We only need a direct solve on the coarsest level so this is the}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00300}00300       \textcolor{comment}{// only place we need to silence SuperLU}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00301}00301       \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a3258a6f09f4c4378cd6619f194e5d24b}{Coarsest\_matrix\_mg\_pt}}-\/>\mbox{\hyperlink{classoomph_1_1DoubleMatrixBase_aa2ef063bc84bee59fec7a933093ac8f7}{linear\_solver\_pt}}()-\/>\mbox{\hyperlink{classoomph_1_1LinearSolver_a91ffe51f3de82dad1a110c099f256d73}{disable\_doc\_time}}();}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00302}00302     \} \textcolor{comment}{// End of disable\_smoother\_and\_superlu\_doc\_time}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00303}00303 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00304}00304 \textcolor{comment}{    /// Return the number of post-\/smoothing iterations (lvalue)}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00305}\mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_abe6c2e45b2d0eedb67bc6ddbcad1e5d5}{00305}} \textcolor{comment}{}    \textcolor{keywordtype}{unsigned}\& \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_abe6c2e45b2d0eedb67bc6ddbcad1e5d5}{npost\_smooth}}()}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00306}00306     \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00307}00307       \textcolor{comment}{// Return the number of post-\/smoothing iterations to be done on each}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00308}00308       \textcolor{comment}{// level of the hierarchy}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00309}00309       \textcolor{keywordflow}{return} \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a752216736f7fcb37f8476cea03916b6e}{Npost\_smooth}};}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00310}00310     \} \textcolor{comment}{// End of npost\_smooth}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00311}00311 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00312}00312 \textcolor{comment}{    /// Return the number of pre-\/smoothing iterations (lvalue)}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00313}\mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_acf5912f915a913095454adc9b78092d7}{00313}} \textcolor{comment}{}    \textcolor{keywordtype}{unsigned}\& \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_acf5912f915a913095454adc9b78092d7}{npre\_smooth}}()}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00314}00314     \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00315}00315       \textcolor{comment}{// Return the number of pre-\/smoothing iterations to be done on each}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00316}00316       \textcolor{comment}{// level of the hierarchy}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00317}00317       \textcolor{keywordflow}{return} \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a61acd84465a380527d9b0dc24b85ac42}{Npre\_smooth}};}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00318}00318     \} \textcolor{comment}{// End of npre\_smooth}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00319}00319 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00320}00320 \textcolor{comment}{    /// Pre-\/smoother: Perform 'max\_iter' smoothing steps on the}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00321}00321 \textcolor{comment}{    /// linear system Ax=b with current RHS vector, b, starting with}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00322}00322 \textcolor{comment}{    /// current solution vector, x. Return the residual vector r=b-\/Ax.}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00323}00323 \textcolor{comment}{    /// Uses the default smoother (set in the HelmholtzMGProblem constructor)}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00324}00324 \textcolor{comment}{    /// which can be overloaded for a specific problem.}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00325}\mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a045e772c0854d1410696a33f0459eec8}{00325}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a045e772c0854d1410696a33f0459eec8}{pre\_smooth}}(\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\& level)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00326}00326     \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00327}00327       \textcolor{comment}{// Run pre-\/smoother 'max\_iter' times}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00328}00328       \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_ab00508738be7bfdf669d54cef639838f}{Pre\_smoothers\_storage\_pt}}[level]-\/>complex\_smoother\_solve(}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00329}00329         \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_afcd8e10b971adcb3e68eacefd876e833}{Rhs\_mg\_vectors\_storage}}[level], \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a636cb6f321d27cb892d61d7cdddd9338}{X\_mg\_vectors\_storage}}[level]);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00330}00330 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00331}00331       \textcolor{comment}{// Calculate the residual vector on this level}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00332}00332       \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_adc1a81bd9eee5b45e5c19cd6dd53d4d9}{residual\_norm}}(level);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00333}00333     \} \textcolor{comment}{// End of pre\_smooth}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00334}00334 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00335}00335 \textcolor{comment}{    /// Post-\/smoother: Perform max\_iter smoothing steps on the}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00336}00336 \textcolor{comment}{    /// linear system Ax=b with current RHS vector, b, starting with}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00337}00337 \textcolor{comment}{    /// current solution vector, x. Uses the default smoother (set in}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00338}00338 \textcolor{comment}{    /// the HelmholtzMGProblem constructor) which can be overloaded for specific}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00339}00339 \textcolor{comment}{    /// problem.}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00340}\mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a7512c2c6c3dec57da2a2e4d7422f5bd1}{00340}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a7512c2c6c3dec57da2a2e4d7422f5bd1}{post\_smooth}}(\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\& level)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00341}00341     \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00342}00342       \textcolor{comment}{// Run post-\/smoother 'max\_iter' times}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00343}00343       \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_abb0d32382cd2a06081359b3fda7cc15d}{Post\_smoothers\_storage\_pt}}[level]-\/>complex\_smoother\_solve(}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00344}00344         \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_afcd8e10b971adcb3e68eacefd876e833}{Rhs\_mg\_vectors\_storage}}[level], \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a636cb6f321d27cb892d61d7cdddd9338}{X\_mg\_vectors\_storage}}[level]);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00345}00345 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00346}00346       \textcolor{comment}{// Calculate the residual vector on this level}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00347}00347       \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_adc1a81bd9eee5b45e5c19cd6dd53d4d9}{residual\_norm}}(level);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00348}00348     \} \textcolor{comment}{// End of post\_smooth}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00349}00349 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00350}00350 \textcolor{comment}{    /// Return norm of residual r=b-\/Ax and the residual vector itself}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00351}00351 \textcolor{comment}{    /// on the level-\/th level}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00352}\mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_adc1a81bd9eee5b45e5c19cd6dd53d4d9}{00352}} \textcolor{comment}{}    \textcolor{keywordtype}{double} \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_adc1a81bd9eee5b45e5c19cd6dd53d4d9}{residual\_norm}}(\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\& level)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00353}00353     \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00354}00354       \textcolor{comment}{// Loop over the real and imaginary part of the residual vector on}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00355}00355       \textcolor{comment}{// the given level}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00356}00356       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < 2; j++)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00357}00357       \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00358}00358         \textcolor{comment}{// And zero the entries of residual}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00359}00359         \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a9fb9b1da7264ccfa054a6d57120e5568}{Residual\_mg\_vectors\_storage}}[level][j].initialise(0.0);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00360}00360       \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00361}00361 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00362}00362       \textcolor{comment}{// Return the norm of the residual}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00363}00363       \textcolor{keywordflow}{return} \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_adc1a81bd9eee5b45e5c19cd6dd53d4d9}{residual\_norm}}(level, \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a9fb9b1da7264ccfa054a6d57120e5568}{Residual\_mg\_vectors\_storage}}[level]);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00364}00364     \} \textcolor{comment}{// End of residual\_norm}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00365}00365 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00366}00366 \textcolor{comment}{    /// Calculate the norm of the residual vector, r=b-\/Ax}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00367}00367 \textcolor{comment}{}    \textcolor{keywordtype}{double} \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_adc1a81bd9eee5b45e5c19cd6dd53d4d9}{residual\_norm}}(\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\& level, \mbox{\hyperlink{classoomph_1_1Vector}{Vector<DoubleVector>}}\& residual);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00368}00368 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00369}00369 \textcolor{comment}{    /// Function to create the fully expanded system matrix on the}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00370}00370 \textcolor{comment}{    /// coarsest level}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00371}00371 \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a2436c6189b4cda832bf28471f4f9e23c}{setup\_coarsest\_level\_structures}}();}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00372}00372 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00373}00373 \textcolor{comment}{    /// Call the direct solver (SuperLU) to solve the problem exactly.}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00374}00374 \textcolor{comment}{}    \textcolor{comment}{// The result is placed in X\_mg}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00375}\mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a1725e615a59cc6986efd313167295aa5}{00375}}     \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a1725e615a59cc6986efd313167295aa5}{direct\_solve}}()}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00376}00376     \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00377}00377       \textcolor{comment}{// Concatenate the vectors in X\_mg into one vector, coarsest\_x\_mg}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00378}00378       \mbox{\hyperlink{namespaceoomph_1_1DoubleVectorHelpers_acf43b80ace3f8a4633190ab36136083b}{DoubleVectorHelpers::concatenate}}(\mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a636cb6f321d27cb892d61d7cdddd9338}{X\_mg\_vectors\_storage}}[\mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_af9e0d8ee42dc6f596f384cbe0d9ce882}{Nlevel}} -\/ 1],}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00379}00379                                        \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a931536210d5862f28bd7f84f1c880b8a}{Coarsest\_x\_mg}});}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00380}00380 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00381}00381       \textcolor{comment}{// Concatenate the vectors in Rhs\_mg into one vector, coarsest\_rhs\_mg}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00382}00382       \mbox{\hyperlink{namespaceoomph_1_1DoubleVectorHelpers_acf43b80ace3f8a4633190ab36136083b}{DoubleVectorHelpers::concatenate}}(\mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_afcd8e10b971adcb3e68eacefd876e833}{Rhs\_mg\_vectors\_storage}}[\mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_af9e0d8ee42dc6f596f384cbe0d9ce882}{Nlevel}} -\/ 1],}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00383}00383                                        \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a592d08dd3b84f6818ba18913d72c3a1c}{Coarsest\_rhs\_mg}});}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00384}00384 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00385}00385       \textcolor{comment}{// Get solution by direct solve:}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00386}00386       \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a3258a6f09f4c4378cd6619f194e5d24b}{Coarsest\_matrix\_mg\_pt}}-\/>\mbox{\hyperlink{classoomph_1_1DoubleMatrixBase_a4d445c4a1204da569f40ec1bdace9ef3}{solve}}(\mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a592d08dd3b84f6818ba18913d72c3a1c}{Coarsest\_rhs\_mg}}, \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a931536210d5862f28bd7f84f1c880b8a}{Coarsest\_x\_mg}});}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00387}00387 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00388}00388       \textcolor{comment}{// Split the solution vector into a vector of DoubleVectors and store it}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00389}00389       \mbox{\hyperlink{namespaceoomph_1_1DoubleVectorHelpers_a3c0fa6de2c35301c556b9530c9ab2bc4}{DoubleVectorHelpers::split}}(\mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a931536210d5862f28bd7f84f1c880b8a}{Coarsest\_x\_mg}},}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00390}00390                                  \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a636cb6f321d27cb892d61d7cdddd9338}{X\_mg\_vectors\_storage}}[\mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_af9e0d8ee42dc6f596f384cbe0d9ce882}{Nlevel}} -\/ 1]);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00391}00391     \} \textcolor{comment}{// End of direct\_solve}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00392}00392 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00393}00393 \textcolor{comment}{    /// Builds a CRDoubleMatrix that is used to interpolate the}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00394}00394 \textcolor{comment}{    /// residual between levels. The transpose can be used as the full}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00395}00395 \textcolor{comment}{    /// weighting restriction.}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00396}\mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a2c7591ae2de4d1c461bca085d3210e73}{00396}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a2c7591ae2de4d1c461bca085d3210e73}{interpolation\_matrix\_set}}(\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\& level,}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00397}00397                                   \textcolor{keywordtype}{double}* value,}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00398}00398                                   \textcolor{keywordtype}{int}* col\_index,}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00399}00399                                   \textcolor{keywordtype}{int}* row\_st,}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00400}00400                                   \textcolor{keywordtype}{unsigned}\& ncol,}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00401}00401                                   \textcolor{keywordtype}{unsigned}\& nnz)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00402}00402     \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00403}00403       \textcolor{comment}{// Dynamically allocate the interpolation matrix}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00404}00404       \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a661811aae02c456b338964cb5e918e70}{Interpolation\_matrices\_storage\_pt}}[level] = \textcolor{keyword}{new} \mbox{\hyperlink{classoomph_1_1CRDoubleMatrix}{CRDoubleMatrix}};}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00405}00405 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00406}00406       \textcolor{comment}{// Build the matrix}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00407}00407       \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a661811aae02c456b338964cb5e918e70}{Interpolation\_matrices\_storage\_pt}}[level]-\/>build\_without\_copy(}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00408}00408         ncol, nnz, value, col\_index, row\_st);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00409}00409 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00410}00410     \} \textcolor{comment}{// End of interpolation\_matrix\_set}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00411}00411 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00412}00412 \textcolor{comment}{    /// Builds a CRDoubleMatrix that is used to interpolate the}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00413}00413 \textcolor{comment}{    /// residual between levels. The transpose can be used as the full}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00414}00414 \textcolor{comment}{    /// weighting restriction.}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00415}\mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a45b4d0a9f16d23b8571ed9b09ca5764d}{00415}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a45b4d0a9f16d23b8571ed9b09ca5764d}{interpolation\_matrix\_set}}(\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\& level,}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00416}00416                                   \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}}\& value,}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00417}00417                                   \mbox{\hyperlink{classoomph_1_1Vector}{Vector<int>}}\& col\_index,}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00418}00418                                   \mbox{\hyperlink{classoomph_1_1Vector}{Vector<int>}}\& row\_st,}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00419}00419                                   \textcolor{keywordtype}{unsigned}\& ncol,}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00420}00420                                   \textcolor{keywordtype}{unsigned}\& \mbox{\hyperlink{classoomph_1_1DistributableLinearAlgebraObject_a7569556f14fd68b28508920e89bd5eee}{nrow}})}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00421}00421     \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00422}00422       \textcolor{comment}{// Dynamically allocate the interpolation matrix}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00423}00423       \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a661811aae02c456b338964cb5e918e70}{Interpolation\_matrices\_storage\_pt}}[level] = \textcolor{keyword}{new} \mbox{\hyperlink{classoomph_1_1CRDoubleMatrix}{CRDoubleMatrix}};}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00424}00424 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00425}00425       \textcolor{comment}{// Make the distribution pointer}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00426}00426       \mbox{\hyperlink{classoomph_1_1LinearAlgebraDistribution}{LinearAlgebraDistribution}}* dist\_pt = \textcolor{keyword}{new} \mbox{\hyperlink{classoomph_1_1LinearAlgebraDistribution}{LinearAlgebraDistribution}}(}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00427}00427         \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a77c24f2c136211274a0f0326694eff51}{Mg\_hierarchy\_pt}}[level]-\/>communicator\_pt(), \mbox{\hyperlink{classoomph_1_1DistributableLinearAlgebraObject_a7569556f14fd68b28508920e89bd5eee}{nrow}}, \textcolor{keyword}{false});}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00428}00428 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00429}00429 \textcolor{preprocessor}{\#ifdef PARANOID}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00430}00430 \textcolor{preprocessor}{\#ifdef OOMPH\_HAS\_MPI}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00431}00431       \textcolor{comment}{// Set up the warning messages}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00432}00432       \mbox{\hyperlink{namespaceoomph_1_1Global__string__for__annotation_ac5379de2fa7fe44f2cb31785fc208135}{std::string}} warning\_message =}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00433}00433         \textcolor{stringliteral}{"{}Setup of interpolation matrix distribution "{}};}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00434}00434       warning\_message += \textcolor{stringliteral}{"{}has not been tested with MPI."{}};}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00435}00435 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00436}00436       \textcolor{comment}{// If we're not running the code in serial}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00437}00437       \textcolor{keywordflow}{if} (dist\_pt-\/>\mbox{\hyperlink{classoomph_1_1LinearAlgebraDistribution_a2760847d45ab334f6d902efc2620b615}{communicator\_pt}}()-\/>nproc() > 1)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00438}00438       \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00439}00439         \textcolor{comment}{// Throw a warning}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00440}00440         \mbox{\hyperlink{classoomph_1_1OomphLibWarning}{OomphLibWarning}}(}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00441}00441           warning\_message, OOMPH\_CURRENT\_FUNCTION, OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00442}00442       \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00443}00443 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00444}00444 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00445}00445 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00446}00446       \textcolor{comment}{// Build the matrix itself}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00447}00447       \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a661811aae02c456b338964cb5e918e70}{Interpolation\_matrices\_storage\_pt}}[level]-\/>build(}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00448}00448         dist\_pt, ncol, value, col\_index, row\_st);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00449}00449 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00450}00450       \textcolor{comment}{// Delete the newly created distribution pointer}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00451}00451       \textcolor{keyword}{delete} dist\_pt;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00452}00452 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00453}00453       \textcolor{comment}{// Make it a null pointer}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00454}00454       dist\_pt = 0;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00455}00455 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00456}00456     \} \textcolor{comment}{// End of interpolation\_matrix\_set}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00457}00457 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00458}00458 \textcolor{comment}{    /// Builds a CRDoubleMatrix on each level that is used to}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00459}00459 \textcolor{comment}{    /// restrict the residual between levels. The transpose can be used}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00460}00460 \textcolor{comment}{    /// as the interpolation matrix}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00461}\mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a9199207c647475375acd63944e28fdf2}{00461}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a9199207c647475375acd63944e28fdf2}{set\_restriction\_matrices\_as\_interpolation\_transposes}}()}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00462}00462     \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00463}00463       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_af9e0d8ee42dc6f596f384cbe0d9ce882}{Nlevel}} -\/ 1; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00464}00464       \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00465}00465         \textcolor{comment}{// Dynamically allocate the restriction matrix}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00466}00466         \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a4a268a461998cabc0b65e256ee6a039f}{Restriction\_matrices\_storage\_pt}}[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] = \textcolor{keyword}{new} \mbox{\hyperlink{classoomph_1_1CRDoubleMatrix}{CRDoubleMatrix}};}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00467}00467 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00468}00468         \textcolor{comment}{// Set the restriction matrix to be the transpose of the}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00469}00469         \textcolor{comment}{// interpolation matrix}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00470}00470         \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a661811aae02c456b338964cb5e918e70}{Interpolation\_matrices\_storage\_pt}}[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]-\/>get\_matrix\_transpose(}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00471}00471           \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a4a268a461998cabc0b65e256ee6a039f}{Restriction\_matrices\_storage\_pt}}[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00472}00472       \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00473}00473     \} \textcolor{comment}{// End of set\_restriction\_matrices\_as\_interpolation\_transposes}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00474}00474 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00475}00475 \textcolor{comment}{    /// Restrict residual (computed on level-\/th MG level) to the next}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00476}00476 \textcolor{comment}{    /// coarser mesh and stick it into the coarse mesh RHS vector.}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00477}00477 \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a013c21557363edf86790fa98a1da2aff}{restrict\_residual}}(\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\& level);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00478}00478 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00479}00479 \textcolor{comment}{    /// Interpolate solution at current level onto next finer mesh}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00480}00480 \textcolor{comment}{    /// and correct the solution x at that level}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00481}00481 \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a8198021ac078989b3593acf8dbb7f572}{interpolate\_and\_correct}}(\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\& level);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00482}00482 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00483}00483 \textcolor{comment}{    /// Given the son\_type of an element and a local node number}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00484}00484 \textcolor{comment}{    /// j in that element with nnode\_1d nodes per coordinate direction,}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00485}00485 \textcolor{comment}{    /// return the local coordinate s in its father element. Needed in}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00486}00486 \textcolor{comment}{    /// the setup of the interpolation matrices}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00487}\mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a6a82f0212ff1277a1e8c33a6a81bfeff}{00487}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a6a82f0212ff1277a1e8c33a6a81bfeff}{level\_up\_local\_coord\_of\_node}}(\textcolor{keyword}{const} \textcolor{keywordtype}{int}\& son\_type, \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}}\& \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}});}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00488}00488 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00489}00489 \textcolor{comment}{    /// Setup the interpolation matrix on each level}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00490}00490 \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a5df19abf7f40f713d709273843260bab}{setup\_interpolation\_matrices}}();}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00491}00491 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00492}00492 \textcolor{comment}{    /// Setup the interpolation matrix on each level (used for}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00493}00493 \textcolor{comment}{    /// unstructured meshes)}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00494}00494 \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_ac392a7156bbf904f7c5ec1c4ed3d4b96}{setup\_interpolation\_matrices\_unstructured}}();}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00495}00495 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00496}00496 \textcolor{comment}{    /// Setup the transfer matrices on each level}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00497}00497 \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a8a02de0cfbfcf01aabb7201aeaf0fd85}{setup\_transfer\_matrices}}();}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00498}00498 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00499}00499 \textcolor{comment}{    /// Do a full setup (assumes everything will be setup around the}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00500}00500 \textcolor{comment}{    /// HelmholtzMGProblem pointer given in the constructor)}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00501}00501 \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a5fa312e5c0b1dc263172010c78f3279c}{full\_setup}}();}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00502}00502 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00503}00503 \textcolor{comment}{    /// Function applies MG to the vector r for a full solve}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00504}\mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a20e891e7a2d84f81fc56a003d7f2925f}{00504}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a20e891e7a2d84f81fc56a003d7f2925f}{preconditioner\_solve}}(\textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1DoubleVector}{DoubleVector}}\& r, \mbox{\hyperlink{classoomph_1_1DoubleVector}{DoubleVector}}\& z)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00505}00505     \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00506}00506       \textcolor{comment}{// Split up the RHS vector into DoubleVectors, whose entries are}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00507}00507       \textcolor{comment}{// arranged to match the matrix blocks and assign it}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00508}00508       this-\/>\mbox{\hyperlink{classoomph_1_1BlockPreconditioner_ad356946d5de4f0817cdf8793fa3cdc74}{get\_block\_vectors}}(r, \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_afcd8e10b971adcb3e68eacefd876e833}{Rhs\_mg\_vectors\_storage}}[0]);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00509}00509 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00510}00510       \textcolor{comment}{// Split up the solution vector into DoubleVectors, whose entries are}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00511}00511       \textcolor{comment}{// arranged to match the matrix blocks and assign it}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00512}00512       this-\/>\mbox{\hyperlink{classoomph_1_1BlockPreconditioner_ad356946d5de4f0817cdf8793fa3cdc74}{get\_block\_vectors}}(z, \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a636cb6f321d27cb892d61d7cdddd9338}{X\_mg\_vectors\_storage}}[0]);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00513}00513 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00514}00514       \textcolor{comment}{// Run the MG method and assign the solution to z}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00515}00515       this-\/>\mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_aedd9102297d40354bd8d769ca2c343cb}{mg\_solve}}(\mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a636cb6f321d27cb892d61d7cdddd9338}{X\_mg\_vectors\_storage}}[0]);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00516}00516 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00517}00517       \textcolor{comment}{// Copy solution in block vectors block\_z back to z}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00518}00518       this-\/>\mbox{\hyperlink{classoomph_1_1BlockPreconditioner_a71d48d8a70151ef0febd4537a2214c53}{return\_block\_vectors}}(\mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a636cb6f321d27cb892d61d7cdddd9338}{X\_mg\_vectors\_storage}}[0], z);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00519}00519 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00520}00520       \textcolor{comment}{// Only output if the V-\/cycle output isn't suppressed}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00521}00521       \textcolor{keywordflow}{if} (!(this-\/>\mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a7d2d22a686e109645a7e2fb39f3de704}{Suppress\_v\_cycle\_output}}))}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00522}00522       \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00523}00523         \textcolor{comment}{// Notify user that the hierarchy of levels is complete}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00524}00524         \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{}\(\backslash\)n=========="{}}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00525}00525                    << \textcolor{stringliteral}{"{}Multigrid Preconditioner Solve Complete"{}}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00526}00526                    << \textcolor{stringliteral}{"{}========="{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00527}00527       \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00528}00528 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00529}00529       \textcolor{comment}{// Only enable and assign the stream pointer again if we originally}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00530}00530       \textcolor{comment}{// suppressed everything otherwise it won't be set yet}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00531}00531       \textcolor{keywordflow}{if} (this-\/>\mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_acfa013d5b84d1e611c9c2514aedd71cc}{Suppress\_all\_output}})}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00532}00532       \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00533}00533         \textcolor{comment}{// Now enable the stream pointer again}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00534}00534         \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}}.\mbox{\hyperlink{classoomph_1_1OomphInfo_a353cd56d96da9152d6d730b328c07a06}{stream\_pt}}() = this-\/>\mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_ab6fb66075019d6d68be33e2dc8332d83}{Stream\_pt}};}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00535}00535       \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00536}00536     \} \textcolor{comment}{// End of preconditioner\_solve}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00537}00537 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00538}00538 \textcolor{comment}{    /// Number of iterations}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00539}\mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a5493abcc56c45c927d918d097f747957}{00539}} \textcolor{comment}{}    \textcolor{keywordtype}{unsigned} \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a5493abcc56c45c927d918d097f747957}{iterations}}()\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00540}00540 \textcolor{keyword}{    }\{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00541}00541       \textcolor{comment}{// Return the number of V-\/cycles which have been done}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00542}00542       \textcolor{keywordflow}{return} \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_ae7ebf565efd370c075ad22688bc2b288}{V\_cycle\_counter}};}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00543}00543     \} \textcolor{comment}{// End of iterations}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00544}00544 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00545}00545 \textcolor{comment}{    /// Use the version in the Preconditioner base class for the}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00546}00546 \textcolor{comment}{    /// alternative setup function that takes a matrix pointer as an argument.}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00547}00547 \textcolor{comment}{}    \textcolor{keyword}{using} \mbox{\hyperlink{classoomph_1_1Preconditioner_af4886f4efe510e5c9b0eb19422943588}{Preconditioner::setup}};}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00548}00548 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00549}00549   \textcolor{keyword}{private}:\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00550}00550 \textcolor{comment}{    /// Function to create pre-\/smoothers}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00551}\mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a22d2d1b715d6789ea56301d79a952d6a}{00551}} \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_aca6ee77e89305b85d919de7bde5b615a}{PreSmootherFactoryFctPt}} \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a22d2d1b715d6789ea56301d79a952d6a}{Pre\_smoother\_factory\_function\_pt}};}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00552}00552 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00553}00553 \textcolor{comment}{    /// Function to create post-\/smoothers}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00554}\mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a6c837962598479ba2eafd3978fccab9c}{00554}} \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a8a406608f8023396db4a11ad1e3bd3f8}{PostSmootherFactoryFctPt}} \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a6c837962598479ba2eafd3978fccab9c}{Post\_smoother\_factory\_function\_pt}};}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00555}00555 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00556}00556 \textcolor{comment}{    /// Do the actual solve -\/-\/ this is called through the pure virtual}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00557}00557 \textcolor{comment}{    /// solve function in the LinearSolver base class. The function is stored}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00558}00558 \textcolor{comment}{    /// as protected to allow the HelmholtzMGPreconditioner derived class to use}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00559}00559 \textcolor{comment}{    /// the solver}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00560}00560 \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_aedd9102297d40354bd8d769ca2c343cb}{mg\_solve}}(\mbox{\hyperlink{classoomph_1_1Vector}{Vector<DoubleVector>}}\& result);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00561}00561 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00562}00562 \textcolor{comment}{    /// Function to ensure the block form of the Jacobian matches}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00563}00563 \textcolor{comment}{    /// the form described, i.e. we should have:}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00564}00564 \textcolor{comment}{    ///                       |-\/-\/-\/-\/-\/|-\/-\/-\/-\/-\/-\/|}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00565}00565 \textcolor{comment}{    ///                       | A\_r | -\/A\_c |}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00566}00566 \textcolor{comment}{    ///                   A = |-\/-\/-\/-\/-\/|-\/-\/-\/-\/-\/-\/|.}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00567}00567 \textcolor{comment}{    ///                       | A\_c |  A\_r |}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00568}00568 \textcolor{comment}{    ///                       |-\/-\/-\/-\/-\/|-\/-\/-\/-\/-\/-\/|}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00569}00569 \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a935a8245757bc2bd7bf29f1ce029af77}{block\_preconditioner\_self\_test}}();}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00570}00570 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00571}00571 \textcolor{comment}{    /// Function to set up the hierachy of levels. Creates a vector}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00572}00572 \textcolor{comment}{    /// of pointers to each MG level}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00573}\mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_aba7a7fb0549452ac56c7e97bd5557c3f}{00573}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_aba7a7fb0549452ac56c7e97bd5557c3f}{setup}}()}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00574}00574     \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00575}00575       \textcolor{comment}{// Run the full setup}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00576}00576       this-\/>\mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a5fa312e5c0b1dc263172010c78f3279c}{full\_setup}}();}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00577}00577 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00578}00578       \textcolor{comment}{// Only enable and assign the stream pointer again if we originally}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00579}00579       \textcolor{comment}{// suppressed everything otherwise it won't be set yet}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00580}00580       \textcolor{keywordflow}{if} (this-\/>\mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_acfa013d5b84d1e611c9c2514aedd71cc}{Suppress\_all\_output}})}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00581}00581       \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00582}00582         \textcolor{comment}{// Now enable the stream pointer again}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00583}00583         \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}}.\mbox{\hyperlink{classoomph_1_1OomphInfo_a353cd56d96da9152d6d730b328c07a06}{stream\_pt}}() = this-\/>\mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_ab6fb66075019d6d68be33e2dc8332d83}{Stream\_pt}};}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00584}00584       \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00585}00585     \} \textcolor{comment}{// End of setup}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00586}00586 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00587}00587 \textcolor{comment}{    /// Function to set up the hierachy of levels. Creates a vector}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00588}00588 \textcolor{comment}{    /// of pointers to each MG level}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00589}00589 \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_ad811c870bf06b25f3237c84b5037e089}{setup\_mg\_hierarchy}}();}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00590}00590 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00591}00591 \textcolor{comment}{    /// Function to set up the hierachy of levels. Creates a vector}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00592}00592 \textcolor{comment}{    /// of pointers to each MG level}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00593}00593 \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a4285eee67bbf57ae00ca2aada2744743}{setup\_mg\_structures}}();}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00594}00594 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00595}00595 \textcolor{comment}{    /// Estimate the value of the parameter h on the level-\/th problem}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00596}00596 \textcolor{comment}{    /// in the hierarchy.}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00597}\mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_aaf65774e7e6c81e4960fcb451e7434e6}{00597}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_aaf65774e7e6c81e4960fcb451e7434e6}{maximum\_edge\_width}}(\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\& level, \textcolor{keywordtype}{double}\& h);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00598}00598 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00599}00599 \textcolor{comment}{    /// Function to set up all of the smoothers once the system matrices}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00600}00600 \textcolor{comment}{    /// have been set up}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00601}00601 \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a8e6345b2fd41602dd6a91e9bcecf718c}{setup\_smoothers}}();}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00602}00602 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00603}00603 \textcolor{comment}{    /// Pointer to the MG problem (deep copy)}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00604}\mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_abfc68dd81954261a2d5dbdc891c4aa67}{00604}} \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1HelmholtzMGProblem}{HelmholtzMGProblem}}* \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_abfc68dd81954261a2d5dbdc891c4aa67}{Mg\_problem\_pt}};}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00605}00605 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00606}00606 \textcolor{comment}{    /// Vector containing pointers to problems in hierarchy}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00607}\mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a77c24f2c136211274a0f0326694eff51}{00607}} \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1Vector}{Vector<HelmholtzMGProblem*>}} \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a77c24f2c136211274a0f0326694eff51}{Mg\_hierarchy\_pt}};}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00608}00608 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00609}00609 \textcolor{comment}{    /// Vector of vectors to store the system matrices. The i-\/th}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00610}00610 \textcolor{comment}{    /// entry in this vector contains a vector of length two. The first}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00611}00611 \textcolor{comment}{    /// entry of which contains the real part of the system matrix which}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00612}00612 \textcolor{comment}{    /// we refer to as A\_r and the second entry contains the imaginary}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00613}00613 \textcolor{comment}{    /// part of the system matrix which we refer to as A\_c. That is to say,}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00614}00614 \textcolor{comment}{    /// the true system matrix is given by A = A\_r + iA\_c}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00615}\mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_ae916b035dd57061a64cef1314ef50d0c}{00615}} \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1Vector}{Vector<Vector<CRDoubleMatrix*>}}> \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_ae916b035dd57061a64cef1314ef50d0c}{Mg\_matrices\_storage\_pt}};}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00616}00616 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00617}00617 \textcolor{comment}{    /// Stores the system matrix on the coarest level in the fully}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00618}00618 \textcolor{comment}{    /// expanded format:}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00619}00619 \textcolor{comment}{    ///                       |-\/-\/-\/-\/-\/|-\/-\/-\/-\/-\/-\/|}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00620}00620 \textcolor{comment}{    ///                       | A\_r | -\/A\_c |}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00621}00621 \textcolor{comment}{    ///                   A = |-\/-\/-\/-\/-\/|-\/-\/-\/-\/-\/-\/|.}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00622}00622 \textcolor{comment}{    ///                       | A\_c |  A\_r |}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00623}00623 \textcolor{comment}{    ///                       |-\/-\/-\/-\/-\/|-\/-\/-\/-\/-\/-\/|}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00624}00624 \textcolor{comment}{    /// Note: this is NOT the same as A = A\_r + iA\_c}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00625}\mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a3258a6f09f4c4378cd6619f194e5d24b}{00625}} \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1CRDoubleMatrix}{CRDoubleMatrix}}* \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a3258a6f09f4c4378cd6619f194e5d24b}{Coarsest\_matrix\_mg\_pt}};}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00626}00626 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00627}00627 \textcolor{comment}{    /// Assuming we're solving the system Ax=b, this vector will}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00628}00628 \textcolor{comment}{    /// contain the expanded solution vector on the coarsest level of the}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00629}00629 \textcolor{comment}{    /// heirarchy. This will have the form:}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00630}00630 \textcolor{comment}{    ///                           |-\/-\/-\/-\/-\/|}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00631}00631 \textcolor{comment}{    ///                           | x\_r |}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00632}00632 \textcolor{comment}{    ///                       x = |-\/-\/-\/-\/-\/|.}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00633}00633 \textcolor{comment}{    ///                           | x\_c |}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00634}00634 \textcolor{comment}{    ///                           |-\/-\/-\/-\/-\/|}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00635}\mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a931536210d5862f28bd7f84f1c880b8a}{00635}} \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1DoubleVector}{DoubleVector}} \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a931536210d5862f28bd7f84f1c880b8a}{Coarsest\_x\_mg}};}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00636}00636 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00637}00637 \textcolor{comment}{    /// Assuming we're solving the system Ax=b, this vector will}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00638}00638 \textcolor{comment}{    /// contain the expanded solution vector on the coarsest level of the}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00639}00639 \textcolor{comment}{    /// heirarchy. This will have the form:}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00640}00640 \textcolor{comment}{    ///                           |-\/-\/-\/-\/-\/|}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00641}00641 \textcolor{comment}{    ///                           | b\_r |}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00642}00642 \textcolor{comment}{    ///                       b = |-\/-\/-\/-\/-\/|.}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00643}00643 \textcolor{comment}{    ///                           | b\_c |}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00644}00644 \textcolor{comment}{    ///                           |-\/-\/-\/-\/-\/|}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00645}\mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a592d08dd3b84f6818ba18913d72c3a1c}{00645}} \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1DoubleVector}{DoubleVector}} \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a592d08dd3b84f6818ba18913d72c3a1c}{Coarsest\_rhs\_mg}};}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00646}00646 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00647}00647 \textcolor{comment}{    /// Vector to store the interpolation matrices}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00648}\mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a661811aae02c456b338964cb5e918e70}{00648}} \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1Vector}{Vector<CRDoubleMatrix*>}} \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a661811aae02c456b338964cb5e918e70}{Interpolation\_matrices\_storage\_pt}};}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00649}00649 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00650}00650 \textcolor{comment}{    /// Vector to store the restriction matrices}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00651}\mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a4a268a461998cabc0b65e256ee6a039f}{00651}} \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1Vector}{Vector<CRDoubleMatrix*>}} \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a4a268a461998cabc0b65e256ee6a039f}{Restriction\_matrices\_storage\_pt}};}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00652}00652 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00653}00653 \textcolor{comment}{    /// Vector of vectors to store the solution vectors (X\_mg) in two}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00654}00654 \textcolor{comment}{    /// parts; the real and imaginary. To access the real part of the solution}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00655}00655 \textcolor{comment}{    /// vector on the i-\/th level we need to access X\_mg\_vectors\_storage[i][0]}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00656}00656 \textcolor{comment}{    /// while accessing X\_mg\_vectors\_storage[i][1] will give us the}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00657}00657 \textcolor{comment}{    /// corresponding imaginary part}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00658}\mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a636cb6f321d27cb892d61d7cdddd9338}{00658}} \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1Vector}{Vector<Vector<DoubleVector>}}> \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a636cb6f321d27cb892d61d7cdddd9338}{X\_mg\_vectors\_storage}};}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00659}00659 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00660}00660 \textcolor{comment}{    /// Vector of vectors to store the RHS vectors. This uses the same}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00661}00661 \textcolor{comment}{    /// format as the X\_mg\_vectors\_storage vector}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00662}\mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_afcd8e10b971adcb3e68eacefd876e833}{00662}} \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1Vector}{Vector<Vector<DoubleVector>}}> \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_afcd8e10b971adcb3e68eacefd876e833}{Rhs\_mg\_vectors\_storage}};}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00663}00663 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00664}00664 \textcolor{comment}{    /// Vector to vectors to store the residual vectors. This uses}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00665}00665 \textcolor{comment}{    /// the same format as the X\_mg\_vectors\_storage vector}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00666}\mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a9fb9b1da7264ccfa054a6d57120e5568}{00666}} \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1Vector}{Vector<Vector<DoubleVector>}}> \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a9fb9b1da7264ccfa054a6d57120e5568}{Residual\_mg\_vectors\_storage}};}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00667}00667 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00668}00668 \textcolor{comment}{    /// Vector to store the pre-\/smoothers}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00669}\mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_ab00508738be7bfdf669d54cef639838f}{00669}} \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1Vector}{Vector<HelmholtzSmoother*>}} \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_ab00508738be7bfdf669d54cef639838f}{Pre\_smoothers\_storage\_pt}};}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00670}00670 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00671}00671 \textcolor{comment}{    /// Vector to store the post-\/smoothers}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00672}\mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_abb0d32382cd2a06081359b3fda7cc15d}{00672}} \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1Vector}{Vector<HelmholtzSmoother*>}} \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_abb0d32382cd2a06081359b3fda7cc15d}{Post\_smoothers\_storage\_pt}};}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00673}00673 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00674}00674 \textcolor{comment}{    /// Vector to storage the maximum edge width of each mesh. We only}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00675}00675 \textcolor{comment}{    /// need the maximum edge width on levels where we use a smoother to}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00676}00676 \textcolor{comment}{    /// determine the value of kh}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00677}\mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a2ca185f62bdfff032503899ea2fbc22c}{00677}} \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a2ca185f62bdfff032503899ea2fbc22c}{Max\_edge\_width}};}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00678}00678 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00679}00679 \textcolor{comment}{    /// The value of the wavenumber, k}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00680}\mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_ab20414b53c2e1a576da68c50a3b89e5e}{00680}} \textcolor{comment}{}    \textcolor{keywordtype}{double} \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_ab20414b53c2e1a576da68c50a3b89e5e}{Wavenumber}};}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00681}00681 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00682}00682 \textcolor{comment}{    /// The tolerance of the multigrid preconditioner}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00683}\mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a3d152eb2679cab29ae536c5016111e38}{00683}} \textcolor{comment}{}    \textcolor{keywordtype}{double} \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a3d152eb2679cab29ae536c5016111e38}{Tolerance}};}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00684}00684 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00685}00685 \textcolor{comment}{    /// The number of levels in the multigrid heirachy}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00686}\mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_af9e0d8ee42dc6f596f384cbe0d9ce882}{00686}} \textcolor{comment}{}    \textcolor{keywordtype}{unsigned} \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_af9e0d8ee42dc6f596f384cbe0d9ce882}{Nlevel}};}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00687}00687 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00688}00688 \textcolor{comment}{    /// Number of pre-\/smoothing steps}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00689}\mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a61acd84465a380527d9b0dc24b85ac42}{00689}} \textcolor{comment}{}    \textcolor{keywordtype}{unsigned} \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a61acd84465a380527d9b0dc24b85ac42}{Npre\_smooth}};}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00690}00690 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00691}00691 \textcolor{comment}{    /// Number of post-\/smoothing steps}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00692}\mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a752216736f7fcb37f8476cea03916b6e}{00692}} \textcolor{comment}{}    \textcolor{keywordtype}{unsigned} \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a752216736f7fcb37f8476cea03916b6e}{Npost\_smooth}};}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00693}00693 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00694}00694 \textcolor{comment}{    /// Maximum number of V-\/cycles}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00695}\mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_ad7cd9523e0f32e2f882d570db7382d6c}{00695}} \textcolor{comment}{}    \textcolor{keywordtype}{unsigned} \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_ad7cd9523e0f32e2f882d570db7382d6c}{Nvcycle}};}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00696}00696 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00697}00697 \textcolor{comment}{    /// Pointer to counter for V-\/cycles}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00698}\mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_ae7ebf565efd370c075ad22688bc2b288}{00698}} \textcolor{comment}{}    \textcolor{keywordtype}{unsigned} \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_ae7ebf565efd370c075ad22688bc2b288}{V\_cycle\_counter}};}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00699}00699 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00700}00700 \textcolor{comment}{    /// Indicates whether or not time documentation should be used}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00701}\mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a74fc85625ca9007857e14f38c6cbc260}{00701}} \textcolor{comment}{}    \textcolor{keywordtype}{bool} \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a74fc85625ca9007857e14f38c6cbc260}{Doc\_time}};}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00702}00702 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00703}00703 \textcolor{comment}{    /// Indicates whether or not the V-\/cycle output should be suppressed.}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00704}\mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a7d2d22a686e109645a7e2fb39f3de704}{00704}} \textcolor{comment}{}    \textcolor{keywordtype}{bool} \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a7d2d22a686e109645a7e2fb39f3de704}{Suppress\_v\_cycle\_output}};}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00705}00705 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00706}00706 \textcolor{comment}{    /// If this is set to true then all output from the solver is suppressed}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00707}\mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_acfa013d5b84d1e611c9c2514aedd71cc}{00707}} \textcolor{comment}{}    \textcolor{keywordtype}{bool} \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_acfa013d5b84d1e611c9c2514aedd71cc}{Suppress\_all\_output}};}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00708}00708 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00709}00709 \textcolor{comment}{    /// Boolean variable to indicate whether or not the solver has been setup}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00710}\mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a5f55a8429e948ec42cad90add3b74488}{00710}} \textcolor{comment}{}    \textcolor{keywordtype}{bool} \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a5f55a8429e948ec42cad90add3b74488}{Has\_been\_setup}};}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00711}00711 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00712}00712 \textcolor{comment}{    /// Boolean variable to indicate whether or not the problem was}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00713}00713 \textcolor{comment}{    /// successfully solved}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00714}\mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_ad388b2b7f4f099f5bc478dfc7088c1a2}{00714}} \textcolor{comment}{}    \textcolor{keywordtype}{bool} \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_ad388b2b7f4f099f5bc478dfc7088c1a2}{Has\_been\_solved}};}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00715}00715 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00716}00716 \textcolor{comment}{    /// Pointer to the output stream -\/-\/ defaults to std::cout}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00717}\mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_ab6fb66075019d6d68be33e2dc8332d83}{00717}} \textcolor{comment}{}    std::ostream* \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_ab6fb66075019d6d68be33e2dc8332d83}{Stream\_pt}};}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00718}00718 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00719}00719 \textcolor{comment}{    /// Temporary version of the shift -\/-\/ to run bash scripts}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00720}\mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a99ced707bfbb8f6d0428419675236879}{00720}} \textcolor{comment}{}    \textcolor{keywordtype}{double} \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a99ced707bfbb8f6d0428419675236879}{Alpha\_shift}};}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00721}00721   \};}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00722}00722 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00723}00723   \textcolor{comment}{//========================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00724}00724 \textcolor{comment}{  /// Calculating the residual r=b-\/Ax in the complex case requires}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00725}00725 \textcolor{comment}{  /// more care than the real case. To calculate the residual vector we}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00726}00726 \textcolor{comment}{  /// split A, x and b into their complex components:}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00727}00727 \textcolor{comment}{  ///           r = b -\/ A*x,}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00728}00728 \textcolor{comment}{  ///             = (b\_r + i*b\_c) -\/ (A\_r + i*A\_c)*(x\_r + i*x\_c),}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00729}00729 \textcolor{comment}{  ///             = [b\_r -\/ A\_r*x\_r + A\_c*x\_c] + i*[b\_c -\/ A\_r*x\_c -\/ A\_c*x\_r],}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00730}00730 \textcolor{comment}{  /// ==> real(r) = b\_r -\/ A\_r*x\_r + A\_c*x\_c,}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00731}00731 \textcolor{comment}{  ///   \& imag(r) = b\_c -\/ A\_r*x\_c -\/ A\_c*x\_r.}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00732}00732 \textcolor{comment}{}  \textcolor{comment}{//========================================================================}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00733}00733   \textcolor{keyword}{template}<\textcolor{keywordtype}{unsigned} DIM>}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00734}\mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_ab12e150cab2c6349bf3453d75261fca6}{00734}}   \textcolor{keywordtype}{double} \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_adc1a81bd9eee5b45e5c19cd6dd53d4d9}{HelmholtzMGPreconditioner<DIM>::residual\_norm}}(}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00735}00735     \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\& level, \mbox{\hyperlink{classoomph_1_1Vector}{Vector<DoubleVector>}}\& residual)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00736}00736   \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00737}00737     \textcolor{comment}{// Number of rows in each block vector}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00738}00738     \textcolor{keywordtype}{unsigned} n\_rows = X\_mg\_vectors\_storage[level][0].nrow();}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00739}00739 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00740}00740 \textcolor{preprocessor}{\#ifdef PARANOID}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00741}00741     \textcolor{comment}{// PARANOID check -\/ if the residual vector doesn't have length 2 it cannot}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00742}00742     \textcolor{comment}{// be used here since we need two vectors corresponding to the real and}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00743}00743     \textcolor{comment}{// imaginary part of the residual}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00744}00744     \textcolor{keywordflow}{if} (residual.size() != 2)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00745}00745     \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00746}00746       \textcolor{comment}{// Throw an error if the residual vector doesn't have the correct length}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00747}00747       \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(\textcolor{stringliteral}{"{}This residual vector must have length 2. "{}},}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00748}00748                           OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00749}00749                           OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00750}00750     \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00751}00751     \textcolor{keywordflow}{if} (residual[0].nrow() != residual[1].nrow())}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00752}00752     \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00753}00753       \textcolor{comment}{// Create an output stream}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00754}00754       std::ostringstream error\_message\_stream;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00755}00755 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00756}00756       \textcolor{comment}{// Store the error message}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00757}00757       error\_message\_stream << \textcolor{stringliteral}{"{}Residual[0] has length: "{}} << residual[0].nrow()}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00758}00758                            << \textcolor{stringliteral}{"{}\(\backslash\)nResidual[1] has length: "{}} << residual[1].nrow()}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00759}00759                            << \textcolor{stringliteral}{"{}\(\backslash\)nThis method requires that the constituent "{}}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00760}00760                            << \textcolor{stringliteral}{"{}DoubleVectors in residual have the same length. "{}}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00761}00761                            << std::endl;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00762}00762 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00763}00763       \textcolor{comment}{// Throw an error}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00764}00764       \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(error\_message\_stream.str(),}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00765}00765                           OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00766}00766                           OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00767}00767     \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00768}00768 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00769}00769 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00770}00770     \textcolor{comment}{// Loop over the block vectors}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00771}00771     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < 2; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00772}00772     \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00773}00773       \textcolor{comment}{// Start by setting the distribution of the residuals vector if}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00774}00774       \textcolor{comment}{// it is not set up}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00775}00775       \textcolor{keywordflow}{if} (!residual[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}].distribution\_built())}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00776}00776       \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00777}00777         \textcolor{comment}{// Set up distribution}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00778}00778         \mbox{\hyperlink{classoomph_1_1LinearAlgebraDistribution}{LinearAlgebraDistribution}} dist(}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00779}00779           Mg\_hierarchy\_pt[level]-\/>communicator\_pt(), n\_rows, \textcolor{keyword}{false});}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00780}00780 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00781}00781         \textcolor{comment}{// Build the distribution}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00782}00782         residual[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}].build(\&dist, 0.0);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00783}00783       \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00784}00784       \textcolor{comment}{// Otherwise just zero the entries of residual}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00785}00785       \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00786}00786       \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00787}00787 \textcolor{preprocessor}{\#ifdef PARANOID}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00788}00788         \textcolor{comment}{// PARANOID check -\/ if the residuals are distributed then this method}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00789}00789         \textcolor{comment}{// cannot be used, a distributed residuals can only be assembled by}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00790}00790         \textcolor{comment}{// get\_jacobian(...) for CRDoubleMatrices}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00791}00791         \textcolor{keywordflow}{if} (residual[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}].distributed())}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00792}00792         \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00793}00793           \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00794}00794             \textcolor{stringliteral}{"{}This method can only assemble a non-\/distributed residuals vector "{}},}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00795}00795             OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00796}00796             OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00797}00797         \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00798}00798 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00799}00799 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00800}00800         \textcolor{comment}{// And zero the entries of residual}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00801}00801         residual[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}].\mbox{\hyperlink{classoomph_1_1Vector_ad526bb1acccf11b485ebe12c9cde44fd}{initialise}}(0.0);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00802}00802       \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00803}00803     \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00804}00804 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00805}00805     \textcolor{comment}{// Store the pointer to the distribution of Matrix\_real\_pt (the same as}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00806}00806     \textcolor{comment}{// Matrix\_imag\_pt presumably so we only need to use one)}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00807}00807     \mbox{\hyperlink{classoomph_1_1LinearAlgebraDistribution}{LinearAlgebraDistribution}}* dist\_pt =}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00808}00808       Mg\_matrices\_storage\_pt[level][0]-\/>distribution\_pt();}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00809}00809 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00810}00810     \textcolor{comment}{// Create 4 temporary vectors to store the various matrix-\/vector products}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00811}00811     \textcolor{comment}{// required. The appropriate combination has been appended to the name of}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00812}00812     \textcolor{comment}{// the vector:}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00813}00813     \textcolor{comment}{// Vector to store A\_r*x\_r:}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00814}00814     \mbox{\hyperlink{classoomph_1_1DoubleVector}{DoubleVector}} temp\_vec\_rr(dist\_pt, 0.0);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00815}00815 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00816}00816     \textcolor{comment}{// Vector to store A\_r*x\_c:}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00817}00817     \mbox{\hyperlink{classoomph_1_1DoubleVector}{DoubleVector}} temp\_vec\_rc(dist\_pt, 0.0);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00818}00818 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00819}00819     \textcolor{comment}{// Vector to store A\_c*x\_r:}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00820}00820     \mbox{\hyperlink{classoomph_1_1DoubleVector}{DoubleVector}} temp\_vec\_cr(dist\_pt, 0.0);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00821}00821 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00822}00822     \textcolor{comment}{// Vector to store A\_c*x\_c:}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00823}00823     \mbox{\hyperlink{classoomph_1_1DoubleVector}{DoubleVector}} temp\_vec\_cc(dist\_pt, 0.0);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00824}00824 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00825}00825     \textcolor{comment}{// We can't delete the distribution pointer because the Jacobian on the}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00826}00826     \textcolor{comment}{// finest level is using it but we can make it a null pointer}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00827}00827     dist\_pt = 0;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00828}00828 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00829}00829     \textcolor{comment}{// Calculate the different combinations of A*x (or A*e depending on the}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00830}00830     \textcolor{comment}{// level in the heirarchy) in the complex case:}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00831}00831     \textcolor{comment}{// A\_r*x\_r:}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00832}00832     Mg\_matrices\_storage\_pt[level][0]-\/>multiply(X\_mg\_vectors\_storage[level][0],}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00833}00833                                                temp\_vec\_rr);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00834}00834 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00835}00835     \textcolor{comment}{// A\_r*x\_c:}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00836}00836     Mg\_matrices\_storage\_pt[level][0]-\/>multiply(X\_mg\_vectors\_storage[level][1],}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00837}00837                                                temp\_vec\_rc);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00838}00838 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00839}00839     \textcolor{comment}{// A\_c*x\_r:}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00840}00840     Mg\_matrices\_storage\_pt[level][1]-\/>multiply(X\_mg\_vectors\_storage[level][0],}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00841}00841                                                temp\_vec\_cr);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00842}00842 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00843}00843     \textcolor{comment}{// A\_c*x\_c:}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00844}00844     Mg\_matrices\_storage\_pt[level][1]-\/>multiply(X\_mg\_vectors\_storage[level][1],}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00845}00845                                                temp\_vec\_cc);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00846}00846 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00847}00847     \textcolor{comment}{// Real part of the residual:}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00848}00848     residual[0] = Rhs\_mg\_vectors\_storage[level][0];}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00849}00849     residual[0] -\/= temp\_vec\_rr;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00850}00850     residual[0] += temp\_vec\_cc;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00851}00851 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00852}00852     \textcolor{comment}{// Imaginary part of the residual:}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00853}00853     residual[1] = Rhs\_mg\_vectors\_storage[level][1];}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00854}00854     residual[1] -\/= temp\_vec\_rc;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00855}00855     residual[1] -\/= temp\_vec\_cr;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00856}00856 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00857}00857     \textcolor{comment}{// Get the residual norm of the real part of the residual vector}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00858}00858     \textcolor{keywordtype}{double} norm\_r = residual[0].norm();}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00859}00859 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00860}00860     \textcolor{comment}{// Get the residual norm of the imaginary part of the residual vector}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00861}00861     \textcolor{keywordtype}{double} norm\_c = residual[1].norm();}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00862}00862 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00863}00863     \textcolor{comment}{// Return the true norm of the residual vector which depends on the}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00864}00864     \textcolor{comment}{// norm of the real part and the norm of the imaginary part}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00865}00865     \textcolor{keywordflow}{return} sqrt(norm\_r * norm\_r + norm\_c * norm\_c);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00866}00866   \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00867}00867 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00868}00868   \textcolor{comment}{//=====================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00869}00869 \textcolor{comment}{  /// Check the block preconditioner framework returns the correct}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00870}00870 \textcolor{comment}{  /// system matrix}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00871}00871 \textcolor{comment}{}  \textcolor{comment}{//=====================================================================}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00872}00872   \textcolor{keyword}{template}<\textcolor{keywordtype}{unsigned} DIM>}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00873}\mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a935a8245757bc2bd7bf29f1ce029af77}{00873}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a935a8245757bc2bd7bf29f1ce029af77}{HelmholtzMGPreconditioner<DIM>::block\_preconditioner\_self\_test}}()}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00874}00874   \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00875}00875     \textcolor{comment}{// Start clock}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00876}00876     clock\_t t\_bl\_start = clock();}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00877}00877 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00878}00878 \textcolor{preprocessor}{\#ifdef PARANOID}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00879}00879     \textcolor{keywordflow}{if} (Mg\_hierarchy\_pt[0]-\/>mesh\_pt() == 0)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00880}00880     \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00881}00881       std::stringstream err;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00882}00882       err << \textcolor{stringliteral}{"{}Please set pointer to mesh using set\_bulk\_helmholtz\_mesh(...).\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00883}00883       \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00884}00884         err.str(), OOMPH\_CURRENT\_FUNCTION, OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00885}00885     \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00886}00886 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00887}00887 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00888}00888     \textcolor{comment}{// The preconditioner works with one mesh; set it! Since we only use the}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00889}00889     \textcolor{comment}{// block preconditioner on the finest level, we use the mesh from that level}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00890}00890     this-\/>set\_nmesh(1);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00891}00891 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00892}00892     \textcolor{comment}{// Elements in actual pml layer are trivially wrapped versions of}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00893}00893     \textcolor{comment}{// their bulk counterparts. Technically they are different}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00894}00894     \textcolor{comment}{// elements so we have to allow different element types}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00895}00895     \textcolor{keywordtype}{bool} allow\_different\_element\_types\_in\_mesh = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00896}00896     this-\/>set\_mesh(}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00897}00897       0, Mg\_problem\_pt-\/>mesh\_pt(), allow\_different\_element\_types\_in\_mesh);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00898}00898 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00899}00899 \textcolor{preprocessor}{\#ifdef PARANOID}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00900}00900     \textcolor{comment}{// This preconditioner only works for 2 dof types}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00901}00901     \textcolor{keywordtype}{unsigned} n\_dof\_types = this-\/>ndof\_types();}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00902}00902     \textcolor{keywordflow}{if} (n\_dof\_types != 2)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00903}00903     \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00904}00904       std::stringstream tmp;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00905}00905       tmp << \textcolor{stringliteral}{"{}This preconditioner only works for problems with 2 dof types\(\backslash\)n"{}}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00906}00906           << \textcolor{stringliteral}{"{}Yours has "{}} << n\_dof\_types;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00907}00907       \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00908}00908         tmp.str(), OOMPH\_CURRENT\_FUNCTION, OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00909}00909     \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00910}00910 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00911}00911 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00912}00912     \textcolor{comment}{// Set up the generic block look up scheme}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00913}00913     this-\/>block\_setup();}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00914}00914 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00915}00915     \textcolor{comment}{// Extract the number of blocks.}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00916}00916     \textcolor{keywordtype}{unsigned} nblock\_types = this-\/>nblock\_types();}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00917}00917 \textcolor{preprocessor}{\#ifdef PARANOID}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00918}00918     \textcolor{keywordflow}{if} (nblock\_types != 2)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00919}00919     \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00920}00920       std::stringstream tmp;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00921}00921       tmp << \textcolor{stringliteral}{"{}There are supposed to be two block types.\(\backslash\)n"{}}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00922}00922           << \textcolor{stringliteral}{"{}Yours has "{}} << nblock\_types;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00923}00923       \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00924}00924         tmp.str(), OOMPH\_CURRENT\_FUNCTION, OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00925}00925     \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00926}00926 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00927}00927 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00928}00928     \textcolor{comment}{// This is how the 2x2 block matrices are extracted. We retain the sanity}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00929}00929     \textcolor{comment}{// check (i.e. the diagonals are the same and the off-\/diagonals are}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00930}00930     \textcolor{comment}{// negatives of each other in PARANOID mode. Otherwise we only extract 2}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00931}00931     \textcolor{comment}{// matrices}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00932}00932     \mbox{\hyperlink{classoomph_1_1DenseMatrix}{DenseMatrix<CRDoubleMatrix*>}} block\_pt(nblock\_types, nblock\_types, 0);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00933}00933     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < nblock\_types; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00934}00934     \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00935}00935       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < nblock\_types; j++)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00936}00936       \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00937}00937         \textcolor{comment}{// we want...}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00938}00938         block\_pt(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}, j) = \textcolor{keyword}{new} \mbox{\hyperlink{classoomph_1_1CRDoubleMatrix}{CRDoubleMatrix}};}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00939}00939         this-\/>get\_block(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}, j, *block\_pt(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}, j));}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00940}00940       \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00941}00941     \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00942}00942 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00943}00943     \textcolor{comment}{// Check that diagonal matrices are the same}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00944}00944     \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00945}00945     \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00946}00946       \textcolor{keywordtype}{unsigned} nnz1 = block\_pt(0, 0)-\/>nnz();}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00947}00947       \textcolor{keywordtype}{unsigned} nnz2 = block\_pt(1, 1)-\/>nnz();}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00948}00948       \textcolor{keywordflow}{if} (nnz1 != nnz2)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00949}00949       \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00950}00950         std::stringstream tmp;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00951}00951         tmp << \textcolor{stringliteral}{"{}nnz of diagonal blocks doesn't match: "{}} << nnz1}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00952}00952             << \textcolor{stringliteral}{"{} != "{}} << nnz2 << std::endl;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00953}00953         \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00954}00954           tmp.str(), OOMPH\_CURRENT\_FUNCTION, OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00955}00955       \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00956}00956       \textcolor{keywordtype}{unsigned} nrow1 = block\_pt(0, 0)-\/>\mbox{\hyperlink{classoomph_1_1DenseMatrix_a1b425094510d833ffe91920747a0a962}{nrow}}();}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00957}00957       \textcolor{keywordtype}{unsigned} nrow2 = block\_pt(1, 1)-\/>\mbox{\hyperlink{classoomph_1_1DenseMatrix_a1b425094510d833ffe91920747a0a962}{nrow}}();}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00958}00958       \textcolor{keywordflow}{if} (nrow1 != nrow2)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00959}00959       \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00960}00960         std::stringstream tmp;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00961}00961         tmp << \textcolor{stringliteral}{"{}nrow of diagonal blocks doesn't match: "{}} << nrow1}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00962}00962             << \textcolor{stringliteral}{"{} != "{}} << nrow2 << std::endl;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00963}00963         \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00964}00964           tmp.str(), OOMPH\_CURRENT\_FUNCTION, OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00965}00965       \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00966}00966 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00967}00967       \textcolor{comment}{// Check entries}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00968}00968       \textcolor{keywordtype}{bool} fail = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00969}00969       \textcolor{keywordtype}{double} tol = 1.0e-\/15;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00970}00970       std::stringstream tmp;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00971}00971 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00972}00972       \textcolor{comment}{// Check row starts}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00973}00973       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < nrow1 + 1; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00974}00974       \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00975}00975         \textcolor{keywordflow}{if} (block\_pt(0, 0)-\/>row\_start()[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] != block\_pt(1, 1)-\/>row\_start()[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}])}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00976}00976         \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00977}00977           fail = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00978}00978           tmp << \textcolor{stringliteral}{"{}Row starts of diag matrices don't match for row "{}} << \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00979}00979               << \textcolor{stringliteral}{"{} : "{}} << block\_pt(0, 0)-\/>row\_start()[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] << \textcolor{stringliteral}{"{} "{}}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00980}00980               << block\_pt(1, 1)-\/>row\_start()[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] << \textcolor{stringliteral}{"{} "{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00981}00981         \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00982}00982       \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00983}00983 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00984}00984       \textcolor{comment}{// Check values and column indices}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00985}00985       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < nnz1; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00986}00986       \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00987}00987         \textcolor{keywordflow}{if} (block\_pt(0, 0)-\/>column\_index()[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] !=}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00988}00988             block\_pt(1, 1)-\/>column\_index()[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}])}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00989}00989         \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00990}00990           fail = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00991}00991           tmp << \textcolor{stringliteral}{"{}Column  of diag matrices indices don't match for entry "{}} << \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00992}00992               << \textcolor{stringliteral}{"{} : "{}} << block\_pt(0, 0)-\/>column\_index()[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] << \textcolor{stringliteral}{"{} "{}}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00993}00993               << block\_pt(1, 1)-\/>column\_index()[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] << \textcolor{stringliteral}{"{} "{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00994}00994         \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00995}00995 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00996}00996         \textcolor{keywordflow}{if} (fabs(block\_pt(0, 0)-\/>value()[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] -\/ block\_pt(1, 1)-\/>value()[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]) > tol)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00997}00997         \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00998}00998           fail = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l00999}00999           tmp << \textcolor{stringliteral}{"{}Values of diag matrices don't match for entry "{}} << \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} << \textcolor{stringliteral}{"{} : "{}}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01000}01000               << block\_pt(0, 0)-\/>value()[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] << \textcolor{stringliteral}{"{} "{}} << block\_pt(1, 1)-\/>value()[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01001}01001               << \textcolor{stringliteral}{"{} "{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01002}01002         \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01003}01003       \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01004}01004       \textcolor{keywordflow}{if} (fail)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01005}01005       \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01006}01006         \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01007}01007           tmp.str(), OOMPH\_CURRENT\_FUNCTION, OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01008}01008       \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01009}01009     \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01010}01010 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01011}01011     \textcolor{comment}{// Check that off-\/diagonal matrices are negatives}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01012}01012     \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01013}01013     \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01014}01014       \textcolor{keywordtype}{unsigned} nnz1 = block\_pt(0, 1)-\/>nnz();}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01015}01015       \textcolor{keywordtype}{unsigned} nnz2 = block\_pt(1, 0)-\/>nnz();}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01016}01016       \textcolor{keywordflow}{if} (nnz1 != nnz2)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01017}01017       \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01018}01018         std::stringstream tmp;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01019}01019         tmp << \textcolor{stringliteral}{"{}nnz of diagonal blocks doesn't match: "{}} << nnz1}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01020}01020             << \textcolor{stringliteral}{"{} != "{}} << nnz2 << std::endl;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01021}01021         \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01022}01022           tmp.str(), OOMPH\_CURRENT\_FUNCTION, OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01023}01023       \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01024}01024       \textcolor{keywordtype}{unsigned} nrow1 = block\_pt(0, 1)-\/>\mbox{\hyperlink{classoomph_1_1DenseMatrix_a1b425094510d833ffe91920747a0a962}{nrow}}();}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01025}01025       \textcolor{keywordtype}{unsigned} nrow2 = block\_pt(1, 0)-\/>\mbox{\hyperlink{classoomph_1_1DenseMatrix_a1b425094510d833ffe91920747a0a962}{nrow}}();}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01026}01026       \textcolor{keywordflow}{if} (nrow1 != nrow2)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01027}01027       \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01028}01028         std::stringstream tmp;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01029}01029         tmp << \textcolor{stringliteral}{"{}nrow of off-\/diagonal blocks doesn't match: "{}} << nrow1}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01030}01030             << \textcolor{stringliteral}{"{} != "{}} << nrow2 << std::endl;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01031}01031         \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01032}01032           tmp.str(), OOMPH\_CURRENT\_FUNCTION, OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01033}01033       \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01034}01034 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01035}01035 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01036}01036       \textcolor{comment}{// Check entries}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01037}01037       \textcolor{keywordtype}{bool} fail = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01038}01038       \textcolor{keywordtype}{double} tol = 1.0e-\/15;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01039}01039       std::stringstream tmp;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01040}01040 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01041}01041       \textcolor{comment}{// Check row starts}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01042}01042       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < nrow1 + 1; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01043}01043       \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01044}01044         \textcolor{keywordflow}{if} (block\_pt(0, 1)-\/>row\_start()[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] != block\_pt(1, 0)-\/>row\_start()[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}])}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01045}01045         \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01046}01046           fail = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01047}01047           tmp << \textcolor{stringliteral}{"{}Row starts of off-\/diag matrices don't match for row "{}} << \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01048}01048               << \textcolor{stringliteral}{"{} : "{}} << block\_pt(0, 1)-\/>row\_start()[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] << \textcolor{stringliteral}{"{} "{}}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01049}01049               << block\_pt(1, 0)-\/>row\_start()[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] << \textcolor{stringliteral}{"{} "{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01050}01050         \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01051}01051       \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01052}01052 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01053}01053       \textcolor{comment}{// Check values and column indices}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01054}01054       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < nnz1; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01055}01055       \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01056}01056         \textcolor{keywordflow}{if} (block\_pt(0, 1)-\/>column\_index()[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] !=}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01057}01057             block\_pt(1, 0)-\/>column\_index()[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}])}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01058}01058         \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01059}01059           fail = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01060}01060           tmp << \textcolor{stringliteral}{"{}Column indices of off-\/diag matrices don't match for entry "{}}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01061}01061               << \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} << \textcolor{stringliteral}{"{} : "{}} << block\_pt(0, 1)-\/>column\_index()[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] << \textcolor{stringliteral}{"{} "{}}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01062}01062               << block\_pt(1, 0)-\/>column\_index()[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] << \textcolor{stringliteral}{"{} "{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01063}01063         \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01064}01064 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01065}01065         \textcolor{keywordflow}{if} (fabs(block\_pt(0, 1)-\/>value()[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] + block\_pt(1, 0)-\/>value()[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]) > tol)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01066}01066         \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01067}01067           fail = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01068}01068           tmp << \textcolor{stringliteral}{"{}Values of off-\/diag matrices aren't negatives of "{}}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01069}01069               << \textcolor{stringliteral}{"{}each other for entry "{}} << \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} << \textcolor{stringliteral}{"{} : "{}}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01070}01070               << block\_pt(0, 1)-\/>value()[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] << \textcolor{stringliteral}{"{} "{}} << block\_pt(1, 0)-\/>value()[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01071}01071               << \textcolor{stringliteral}{"{} "{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01072}01072         \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01073}01073       \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01074}01074       \textcolor{keywordflow}{if} (fail)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01075}01075       \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01076}01076         \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01077}01077           tmp.str(), OOMPH\_CURRENT\_FUNCTION, OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01078}01078       \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01079}01079     \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01080}01080 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01081}01081     \textcolor{comment}{// Clean up}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01082}01082     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < nblock\_types; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01083}01083     \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01084}01084       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < nblock\_types; j++)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01085}01085       \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01086}01086         \textcolor{keyword}{delete} block\_pt(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}, j);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01087}01087         block\_pt(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}, j) = 0;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01088}01088       \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01089}01089     \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01090}01090 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01091}01091     \textcolor{comment}{// Stop clock}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01092}01092     clock\_t t\_bl\_end = clock();}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01093}01093     \textcolor{keywordtype}{double} total\_setup\_time = double(t\_bl\_end -\/ t\_bl\_start) / CLOCKS\_PER\_SEC;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01094}01094     \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{}CPU time for block preconditioner self-\/test [sec]: "{}}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01095}01095                << total\_setup\_time << \textcolor{stringliteral}{"{}\(\backslash\)n"{}}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01096}01096                << std::endl;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01097}01097   \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01098}01098 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01099}01099   \textcolor{comment}{//===================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01100}01100 \textcolor{comment}{  /// Runs a full setup of the MG solver}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01101}01101 \textcolor{comment}{}  \textcolor{comment}{//===================================================================}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01102}01102   \textcolor{keyword}{template}<\textcolor{keywordtype}{unsigned} DIM>}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01103}\mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a5fa312e5c0b1dc263172010c78f3279c}{01103}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a5fa312e5c0b1dc263172010c78f3279c}{HelmholtzMGPreconditioner<DIM>::full\_setup}}()}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01104}01104   \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01105}01105 \textcolor{preprocessor}{\#ifdef OOMPH\_HAS\_MPI}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01106}01106     \textcolor{comment}{// Make sure that this is running in serial. Can't guarantee it'll}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01107}01107     \textcolor{comment}{// work when the problem is distributed over several processors}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01108}01108     \textcolor{keywordflow}{if} (\mbox{\hyperlink{classoomph_1_1MPI__Helpers_ac16964b22bfd4f657490802beb600ffe}{MPI\_Helpers::communicator\_pt}}()-\/>nproc() > 1)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01109}01109     \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01110}01110       \textcolor{comment}{// Throw a warning}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01111}01111       \mbox{\hyperlink{classoomph_1_1OomphLibWarning}{OomphLibWarning}}(\textcolor{stringliteral}{"{}Can't guarantee the MG solver will work in parallel!"{}},}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01112}01112                       OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01113}01113                       OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01114}01114     \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01115}01115 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01116}01116 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01117}01117     \textcolor{comment}{// Initialise the timer start variable}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01118}01118     \textcolor{keywordtype}{double} t\_fs\_start = 0.0;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01119}01119 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01120}01120     \textcolor{comment}{// If we're allowed to output}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01121}01121     \textcolor{keywordflow}{if} (!Suppress\_all\_output)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01122}01122     \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01123}01123       \textcolor{comment}{// Start the timer}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01124}01124       t\_fs\_start = \mbox{\hyperlink{namespaceoomph_1_1TimingHelpers_a9fb6ad7e2e01b0914e9f7072ef9ebfa6}{TimingHelpers::timer}}();}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01125}01125 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01126}01126       \textcolor{comment}{// Notify user that the hierarchy of levels is complete}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01127}01127       \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01128}01128         << \textcolor{stringliteral}{"{}\(\backslash\)n========Starting Setup of Multigrid Preconditioner========"{}}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01129}01129         << std::endl;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01130}01130 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01131}01131       \textcolor{comment}{// Notify user that the hierarchy of levels is complete}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01132}01132       \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01133}01133         << \textcolor{stringliteral}{"{}\(\backslash\)nStarting the full setup of the Helmholtz multigrid solver."{}}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01134}01134         << std::endl;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01135}01135     \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01136}01136 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01137}01137 \textcolor{preprocessor}{\#ifdef PARANOID}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01138}01138     \textcolor{comment}{// PARANOID check -\/ Make sure the dimension of the solver matches the}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01139}01139     \textcolor{comment}{// dimension of the elements used in the problems mesh}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01140}01140     \textcolor{keywordflow}{if} (\textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}*\textcolor{keyword}{>}(Mg\_problem\_pt-\/>mesh\_pt()-\/>element\_pt(0))}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01141}01141           -\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a5f8fe59f06da1da9f6b7bbcbdb90ef93}{dim}}() != DIM)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01142}01142     \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01143}01143       \textcolor{comment}{// Create an error message}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01144}01144       \mbox{\hyperlink{namespaceoomph_1_1Global__string__for__annotation_ac5379de2fa7fe44f2cb31785fc208135}{std::string}} err\_strng = \textcolor{stringliteral}{"{}The dimension of the elements used in the mesh "{}};}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01145}01145       err\_strng += \textcolor{stringliteral}{"{}does not match the dimension of the solver."{}};}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01146}01146 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01147}01147       \textcolor{comment}{// Throw the error}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01148}01148       \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01149}01149         err\_strng, OOMPH\_CURRENT\_FUNCTION, OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01150}01150     \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01151}01151 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01152}01152     \textcolor{comment}{// PARANOID check -\/ The elements of the bulk mesh must all be refineable}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01153}01153     \textcolor{comment}{// elements otherwise we cannot deal with this}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01154}01154     \textcolor{keywordflow}{if} (Mg\_problem\_pt-\/>mg\_bulk\_mesh\_pt() != 0)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01155}01155     \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01156}01156       \textcolor{comment}{// Find the number of elements in the bulk mesh}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01157}01157       \textcolor{keywordtype}{unsigned} n\_elements = Mg\_problem\_pt-\/>mg\_bulk\_mesh\_pt()-\/>nelement();}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01158}01158 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01159}01159       \textcolor{comment}{// Loop over the elements in the mesh and ensure that they are}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01160}01160       \textcolor{comment}{// all refineable elements}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01161}01161       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} el\_counter = 0; el\_counter < n\_elements; el\_counter++)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01162}01162       \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01163}01163         \textcolor{comment}{// Upcast global mesh element to a refineable element}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01164}01164         \mbox{\hyperlink{classoomph_1_1RefineableElement}{RefineableElement}}* el\_pt = \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1RefineableElement}{RefineableElement}}*\textcolor{keyword}{>}(}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01165}01165           Mg\_problem\_pt-\/>mg\_bulk\_mesh\_pt()-\/>element\_pt(el\_counter));}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01166}01166 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01167}01167         \textcolor{comment}{// Check if the upcast worked or not; if el\_pt is a null pointer the}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01168}01168         \textcolor{comment}{// element is not refineable}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01169}01169         \textcolor{keywordflow}{if} (el\_pt == 0)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01170}01170         \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01171}01171           \textcolor{comment}{// Create an output steam}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01172}01172           std::ostringstream error\_message\_stream;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01173}01173 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01174}01174           \textcolor{comment}{// Store the error message}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01175}01175           error\_message\_stream << \textcolor{stringliteral}{"{}Element in bulk mesh could not be upcast to "{}}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01176}01176                                << \textcolor{stringliteral}{"{}a refineable element."{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01177}01177 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01178}01178           \textcolor{comment}{// Throw an error}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01179}01179           \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(error\_message\_stream.str(),}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01180}01180                               OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01181}01181                               OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01182}01182         \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01183}01183       \} \textcolor{comment}{// for (unsigned el\_counter=0;el\_counter<n\_elements;el\_counter++)}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01184}01184     \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01185}01185     \textcolor{comment}{// If the provided bulk mesh pointer is a null pointer}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01186}01186     \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01187}01187     \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01188}01188       \textcolor{comment}{// Create an output steam}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01189}01189       std::ostringstream error\_message\_stream;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01190}01190 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01191}01191       \textcolor{comment}{// Store the error message}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01192}01192       error\_message\_stream}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01193}01193         << \textcolor{stringliteral}{"{}The provided bulk mesh pointer is a null pointer. "{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01194}01194 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01195}01195       \textcolor{comment}{// Throw an error}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01196}01196       \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(error\_message\_stream.str(),}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01197}01197                           OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01198}01198                           OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01199}01199     \} \textcolor{comment}{// if (Mg\_problem\_pt-\/>mg\_bulk\_mesh\_pt()!=0)}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01200}01200 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01201}01201 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01202}01202     \textcolor{comment}{// If this is not the first Newton step then we will already have things}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01203}01203     \textcolor{comment}{// in storage. If this is the case, delete them}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01204}01204     \mbox{\hyperlink{namespaceoomph_1_1TerminateHelper_a20615123e22554c3c485484f4c23bfb5}{clean\_up\_memory}}();}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01205}01205 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01206}01206     \textcolor{comment}{// Resize the Mg\_hierarchy\_pt vector}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01207}01207     Mg\_hierarchy\_pt.resize(1, 0);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01208}01208 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01209}01209     \textcolor{comment}{// Set the pointer to the finest level as the first entry in Mg\_hierarchy\_pt}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01210}01210     Mg\_hierarchy\_pt[0] = Mg\_problem\_pt;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01211}01211 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01212}01212     \textcolor{comment}{// Create the hierarchy of levels}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01213}01213     setup\_mg\_hierarchy();}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01214}01214 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01215}01215     \textcolor{comment}{// Set up the interpolation and restriction matrices}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01216}01216     setup\_transfer\_matrices();}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01217}01217 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01218}01218     \textcolor{comment}{// Set up the data structures on each level, i.e. the system matrix,}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01219}01219     \textcolor{comment}{// LHS and RHS vectors and smoothers}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01220}01220     setup\_mg\_structures();}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01221}01221 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01222}01222     \textcolor{comment}{// Set up the smoothers on all of the levels}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01223}01223     setup\_smoothers();}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01224}01224 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01225}01225     \textcolor{comment}{// Loop over all of the coarser levels}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01226}01226     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 1; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < Nlevel; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01227}01227     \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01228}01228       \textcolor{comment}{// Delete the i-\/th coarse-\/grid HelmholtzMGProblem object}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01229}01229       \textcolor{keyword}{delete} Mg\_hierarchy\_pt[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}];}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01230}01230 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01231}01231       \textcolor{comment}{// Set it to be a null pointer}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01232}01232       Mg\_hierarchy\_pt[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] = 0;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01233}01233     \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01234}01234 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01235}01235     \textcolor{comment}{// Indicate that the full setup has been completed}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01236}01236     Has\_been\_setup = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01237}01237 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01238}01238     \textcolor{comment}{// If we're allowed to output to the screen}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01239}01239     \textcolor{keywordflow}{if} (!Suppress\_all\_output)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01240}01240     \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01241}01241       \textcolor{comment}{// Output the time taken to complete the full setup}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01242}01242       \textcolor{keywordtype}{double} t\_fs\_end = \mbox{\hyperlink{namespaceoomph_1_1TimingHelpers_a9fb6ad7e2e01b0914e9f7072ef9ebfa6}{TimingHelpers::timer}}();}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01243}01243       \textcolor{keywordtype}{double} full\_setup\_time = t\_fs\_end -\/ t\_fs\_start;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01244}01244 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01245}01245       \textcolor{comment}{// Output the CPU time}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01246}01246       \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{}\(\backslash\)nCPU time for full setup [sec]: "{}} << full\_setup\_time}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01247}01247                  << std::endl;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01248}01248 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01249}01249       \textcolor{comment}{// Notify user that the hierarchy of levels is complete}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01250}01250       \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{}\(\backslash\)n==============="{}}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01251}01251                  << \textcolor{stringliteral}{"{}Multigrid Full Setup Complete"{}}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01252}01252                  << \textcolor{stringliteral}{"{}==============\(\backslash\)n"{}}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01253}01253                  << std::endl;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01254}01254     \} \textcolor{comment}{// if (!Suppress\_all\_output)}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01255}01255   \} \textcolor{comment}{// End of full\_setup}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01256}01256 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01257}01257   \textcolor{comment}{//===================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01258}01258 \textcolor{comment}{  /// Set up the MG hierarchy. Creates a vector of pointers to}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01259}01259 \textcolor{comment}{  /// each MG level and resizes internal storage for multigrid data}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01260}01260 \textcolor{comment}{}  \textcolor{comment}{//===================================================================}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01261}01261   \textcolor{comment}{// Function to set up the hierachy of levels.}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01262}01262   \textcolor{keyword}{template}<\textcolor{keywordtype}{unsigned} DIM>}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01263}\mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_ad811c870bf06b25f3237c84b5037e089}{01263}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_ad811c870bf06b25f3237c84b5037e089}{HelmholtzMGPreconditioner<DIM>::setup\_mg\_hierarchy}}()}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01264}01264   \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01265}01265     \textcolor{comment}{// Initialise the timer start variable}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01266}01266     \textcolor{keywordtype}{double} t\_m\_start = 0.0;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01267}01267 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01268}01268     \textcolor{comment}{// Notify the user if it is allowed}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01269}01269     \textcolor{keywordflow}{if} (!Suppress\_all\_output)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01270}01270     \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01271}01271       \textcolor{comment}{// Notify user of progress}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01272}01272       \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{}\(\backslash\)n==============="{}}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01273}01273                  << \textcolor{stringliteral}{"{}Creating Multigrid Hierarchy"{}}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01274}01274                  << \textcolor{stringliteral}{"{}===============\(\backslash\)n"{}}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01275}01275                  << std::endl;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01276}01276 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01277}01277       \textcolor{comment}{// Start clock}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01278}01278       t\_m\_start = \mbox{\hyperlink{namespaceoomph_1_1TimingHelpers_a9fb6ad7e2e01b0914e9f7072ef9ebfa6}{TimingHelpers::timer}}();}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01279}01279     \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01280}01280 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01281}01281     \textcolor{comment}{// Create a bool to indicate whether or not we could create an unrefined}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01282}01282     \textcolor{comment}{// copy. This bool will be assigned the value FALSE when the current copy}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01283}01283     \textcolor{comment}{// is the last level of the multigrid hierarchy}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01284}01284     \textcolor{keywordtype}{bool} managed\_to\_create\_unrefined\_copy = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01285}01285 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01286}01286     \textcolor{comment}{// Now keep making copies and try to make an unrefined copy of}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01287}01287     \textcolor{comment}{// the mesh}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01288}01288     \textcolor{keywordtype}{unsigned} level = 0;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01289}01289 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01290}01290     \textcolor{comment}{// Set up all of the levels by making a completely unrefined copy}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01291}01291     \textcolor{comment}{// of the problem using the function make\_new\_problem}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01292}01292     \textcolor{keywordflow}{while} (managed\_to\_create\_unrefined\_copy)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01293}01293     \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01294}01294       \textcolor{comment}{// Make a new object of the same type as the derived problem}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01295}01295       \mbox{\hyperlink{classoomph_1_1HelmholtzMGProblem}{HelmholtzMGProblem}}* new\_problem\_pt = Mg\_problem\_pt-\/>\mbox{\hyperlink{classoomph_1_1HelmholtzMGProblem_a174dfbef9a1f46e103e50046c47138e6}{make\_new\_problem}}();}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01296}01296 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01297}01297       \textcolor{comment}{// Do anything that needs to be done before we can refine the mesh}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01298}01298       new\_problem\_pt-\/>\mbox{\hyperlink{classoomph_1_1Problem_a6130d5c9a762cdd1569919a601620796}{actions\_before\_adapt}}();}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01299}01299 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01300}01300       \textcolor{comment}{// To create the next level in the hierarchy we need to create a mesh}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01301}01301       \textcolor{comment}{// which matches the refinement of the current problem and then unrefine}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01302}01302       \textcolor{comment}{// the mesh. This can alternatively be done using the function}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01303}01303       \textcolor{comment}{// refine\_base\_mesh\_as\_in\_reference\_mesh\_minus\_one which takes a}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01304}01304       \textcolor{comment}{// reference mesh to do precisely the above with}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01305}01305       managed\_to\_create\_unrefined\_copy =}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01306}01306         new\_problem\_pt-\/>\mbox{\hyperlink{classoomph_1_1HelmholtzMGProblem_a647ea79cc9e3e032158aa8416419af8c}{mg\_bulk\_mesh\_pt}}()}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01307}01307           -\/>\mbox{\hyperlink{classoomph_1_1TreeBasedRefineableMeshBase_ae6fc7cc7acf368423cc49cc10ab276bc}{refine\_base\_mesh\_as\_in\_reference\_mesh\_minus\_one}}(}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01308}01308             Mg\_hierarchy\_pt[level]-\/>mg\_bulk\_mesh\_pt());}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01309}01309 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01310}01310       \textcolor{comment}{// If we were able to unrefine the problem on the current level}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01311}01311       \textcolor{comment}{// then add the unrefined problem to a vector of the levels}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01312}01312       \textcolor{keywordflow}{if} (managed\_to\_create\_unrefined\_copy)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01313}01313       \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01314}01314         \textcolor{comment}{// Another level has been created so increment the level counter}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01315}01315         level++;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01316}01316 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01317}01317         \textcolor{comment}{// If the documentation of everything has not been suppressed}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01318}01318         \textcolor{comment}{// then tell the user we managed to create another level}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01319}01319         \textcolor{keywordflow}{if} (!Suppress\_all\_output)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01320}01320         \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01321}01321           \textcolor{comment}{// Notify user that unrefinement was successful}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01322}01322           \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{}Success! Level "{}} << level}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01323}01323                      << \textcolor{stringliteral}{"{} has been created:"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01324}01324         \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01325}01325 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01326}01326         \textcolor{comment}{// Do anything that needs to be done after refinement}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01327}01327         new\_problem\_pt-\/>\mbox{\hyperlink{classoomph_1_1Problem_ada40ec6730506c01109622c8383fe36e}{actions\_after\_adapt}}();}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01328}01328 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01329}01329         \textcolor{comment}{// Do the equation numbering for the new problem}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01330}01330         \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{}\(\backslash\)n -\/ Number of equations: "{}}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01331}01331                    << new\_problem\_pt-\/>\mbox{\hyperlink{classoomph_1_1Problem_a0df501c6aed60c4938861df776b10119}{assign\_eqn\_numbers}}() << \textcolor{stringliteral}{"{}\(\backslash\)n"{}}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01332}01332                    << std::endl;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01333}01333 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01334}01334         \textcolor{comment}{// Add the new problem pointer onto the vector of MG levels}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01335}01335         \textcolor{comment}{// and increment the value of level by 1}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01336}01336         Mg\_hierarchy\_pt.push\_back(new\_problem\_pt);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01337}01337       \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01338}01338       \textcolor{comment}{// If we weren't able to create an unrefined copy}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01339}01339       \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01340}01340       \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01341}01341         \textcolor{comment}{// Delete the new problem}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01342}01342         \textcolor{keyword}{delete} new\_problem\_pt;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01343}01343 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01344}01344         \textcolor{comment}{// Make it a null pointer}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01345}01345         new\_problem\_pt = 0;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01346}01346 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01347}01347         \textcolor{comment}{// Assign the number of levels to Nlevel}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01348}01348         Nlevel = Mg\_hierarchy\_pt.size();}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01349}01349 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01350}01350         \textcolor{comment}{// If we're allowed to document then tell the user we've reached}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01351}01351         \textcolor{comment}{// the coarsest level of the hierarchy}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01352}01352         \textcolor{keywordflow}{if} (!Suppress\_all\_output)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01353}01353         \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01354}01354           \textcolor{comment}{// Notify the user}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01355}01355           \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{}Reached the coarsest level! "{}}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01356}01356                      << \textcolor{stringliteral}{"{}Number of levels: "{}} << Nlevel << std::endl;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01357}01357         \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01358}01358       \} \textcolor{comment}{// if (managed\_to\_create\_unrefined\_copy)}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01359}01359     \} \textcolor{comment}{// while (managed\_to\_create\_unrefined\_copy)}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01360}01360 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01361}01361     \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01362}01362     \textcolor{comment}{// Given that we know the number of levels in the hierarchy we can}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01363}01363     \textcolor{comment}{// resize the vectors which will store all the information required}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01364}01364     \textcolor{comment}{// for our solver:}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01365}01365     \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01366}01366     \textcolor{comment}{// Resize the vector storing all of the system matrices}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01367}01367     Mg\_matrices\_storage\_pt.resize(Nlevel);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01368}01368 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01369}01369     \textcolor{comment}{// Resize the vector storing all of the solution vectors (X\_mg)}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01370}01370     X\_mg\_vectors\_storage.resize(Nlevel);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01371}01371 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01372}01372     \textcolor{comment}{// Resize the vector storing all of the RHS vectors (Rhs\_mg)}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01373}01373     Rhs\_mg\_vectors\_storage.resize(Nlevel);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01374}01374 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01375}01375     \textcolor{comment}{// Resize the vector storing all of the residual vectors}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01376}01376     Residual\_mg\_vectors\_storage.resize(Nlevel);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01377}01377 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01378}01378     \textcolor{comment}{// Allocate space for the Max\_edge\_width vector, we only need the value}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01379}01379     \textcolor{comment}{// of h on the levels where we use a smoother}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01380}01380     Max\_edge\_width.resize(Nlevel -\/ 1, 0.0);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01381}01381 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01382}01382     \textcolor{comment}{// Allocate space for the pre-\/smoother storage vector (remember, we do}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01383}01383     \textcolor{comment}{// not need a smoother on the coarsest level; we use a direct solve there)}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01384}01384     Pre\_smoothers\_storage\_pt.resize(Nlevel -\/ 1, 0);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01385}01385 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01386}01386     \textcolor{comment}{// Allocate space for the post-\/smoother storage vector (remember, we do}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01387}01387     \textcolor{comment}{// not need a smoother on the coarsest level; we use a direct solve there)}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01388}01388     Post\_smoothers\_storage\_pt.resize(Nlevel -\/ 1, 0);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01389}01389 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01390}01390     \textcolor{comment}{// Resize the vector storing all of the interpolation matrices}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01391}01391     Interpolation\_matrices\_storage\_pt.resize(Nlevel -\/ 1, 0);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01392}01392 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01393}01393     \textcolor{comment}{// Resize the vector storing all of the restriction matrices}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01394}01394     Restriction\_matrices\_storage\_pt.resize(Nlevel -\/ 1, 0);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01395}01395 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01396}01396     \textcolor{comment}{// If we're allowed to output information to the screen}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01397}01397     \textcolor{keywordflow}{if} (!Suppress\_all\_output)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01398}01398     \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01399}01399       \textcolor{comment}{// Stop clock}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01400}01400       \textcolor{keywordtype}{double} t\_m\_end = \mbox{\hyperlink{namespaceoomph_1_1TimingHelpers_a9fb6ad7e2e01b0914e9f7072ef9ebfa6}{TimingHelpers::timer}}();}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01401}01401       \textcolor{keywordtype}{double} total\_setup\_time = double(t\_m\_end -\/ t\_m\_start);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01402}01402       \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01403}01403         << \textcolor{stringliteral}{"{}\(\backslash\)nCPU time for creation of hierarchy of MG problems [sec]: "{}}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01404}01404         << total\_setup\_time << std::endl;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01405}01405 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01406}01406       \textcolor{comment}{// Notify user that the hierarchy of levels is complete}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01407}01407       \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{}\(\backslash\)n==============="{}}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01408}01408                  << \textcolor{stringliteral}{"{}Hierarchy Creation Complete"{}}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01409}01409                  << \textcolor{stringliteral}{"{}================\(\backslash\)n"{}}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01410}01410                  << std::endl;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01411}01411     \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01412}01412   \} \textcolor{comment}{// End of setup\_mg\_hierarchy}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01413}01413 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01414}01414   \textcolor{comment}{//===================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01415}01415 \textcolor{comment}{  /// Set up the transfer matrices. Both the pure injection and}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01416}01416 \textcolor{comment}{  /// full weighting method have been implemented here but it is highly}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01417}01417 \textcolor{comment}{  /// recommended that full weighting is used in general. In both}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01418}01418 \textcolor{comment}{  /// methods the transpose of the transfer matrix is used to transfer}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01419}01419 \textcolor{comment}{  /// a vector back}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01420}01420 \textcolor{comment}{}  \textcolor{comment}{//===================================================================}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01421}01421   \textcolor{keyword}{template}<\textcolor{keywordtype}{unsigned} DIM>}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01422}\mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a8a02de0cfbfcf01aabb7201aeaf0fd85}{01422}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a8a02de0cfbfcf01aabb7201aeaf0fd85}{HelmholtzMGPreconditioner<DIM>::setup\_transfer\_matrices}}()}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01423}01423   \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01424}01424     \textcolor{comment}{// Initialise the timer start variable}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01425}01425     \textcolor{keywordtype}{double} t\_r\_start = 0.0;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01426}01426 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01427}01427     \textcolor{comment}{// Notify the user (if we're allowed)}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01428}01428     \textcolor{keywordflow}{if} (!Suppress\_all\_output)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01429}01429     \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01430}01430       \textcolor{comment}{// Notify user of progress}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01431}01431       \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{}Creating the transfer matrices."{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01432}01432 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01433}01433       \textcolor{comment}{// Start the clock!}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01434}01434       t\_r\_start = \mbox{\hyperlink{namespaceoomph_1_1TimingHelpers_a9fb6ad7e2e01b0914e9f7072ef9ebfa6}{TimingHelpers::timer}}();}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01435}01435     \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01436}01436 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01437}01437     \textcolor{comment}{// Using full weighting so use setup\_interpolation\_matrices.}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01438}01438     \textcolor{comment}{// Note: There are two methods to choose from here, the ideal choice is}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01439}01439     \textcolor{comment}{// setup\_interpolation\_matrices() but that requires a refineable mesh base}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01440}01440     \textcolor{keywordflow}{if} (\textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1TreeBasedRefineableMeshBase}{TreeBasedRefineableMeshBase}}*\textcolor{keyword}{>}(}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01441}01441           Mg\_problem\_pt-\/>mg\_bulk\_mesh\_pt()))}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01442}01442     \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01443}01443       setup\_interpolation\_matrices();}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01444}01444     \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01445}01445     \textcolor{comment}{// If the mesh is unstructured we have to use the locate\_zeta function}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01446}01446     \textcolor{comment}{// to set up the interpolation matrices}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01447}01447     \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01448}01448     \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01449}01449       setup\_interpolation\_matrices\_unstructured();}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01450}01450     \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01451}01451 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01452}01452     \textcolor{comment}{// Loop over all levels that will be assigned a restriction matrix}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01453}01453     set\_restriction\_matrices\_as\_interpolation\_transposes();}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01454}01454 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01455}01455     \textcolor{comment}{// If we're allowed}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01456}01456     \textcolor{keywordflow}{if} (!Suppress\_all\_output)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01457}01457     \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01458}01458       \textcolor{comment}{// Stop the clock}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01459}01459       \textcolor{keywordtype}{double} t\_r\_end = \mbox{\hyperlink{namespaceoomph_1_1TimingHelpers_a9fb6ad7e2e01b0914e9f7072ef9ebfa6}{TimingHelpers::timer}}();}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01460}01460       \textcolor{keywordtype}{double} total\_G\_setup\_time = double(t\_r\_end -\/ t\_r\_start);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01461}01461       \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{}\(\backslash\)nCPU time for transfer matrices setup [sec]: "{}}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01462}01462                  << total\_G\_setup\_time << std::endl;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01463}01463 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01464}01464       \textcolor{comment}{// Notify user that the hierarchy of levels is complete}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01465}01465       \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01466}01466         << \textcolor{stringliteral}{"{}\(\backslash\)n============Transfer Matrices Setup Complete=============="{}}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01467}01467         << \textcolor{stringliteral}{"{}\(\backslash\)n"{}}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01468}01468         << std::endl;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01469}01469     \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01470}01470   \} \textcolor{comment}{// End of setup\_transfer\_matrices function}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01471}01471 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01472}01472   \textcolor{comment}{//===================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01473}01473 \textcolor{comment}{  /// Set up the MG structures on each level}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01474}01474 \textcolor{comment}{}  \textcolor{comment}{//===================================================================}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01475}01475   \textcolor{keyword}{template}<\textcolor{keywordtype}{unsigned} DIM>}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01476}\mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a4285eee67bbf57ae00ca2aada2744743}{01476}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a4285eee67bbf57ae00ca2aada2744743}{HelmholtzMGPreconditioner<DIM>::setup\_mg\_structures}}()}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01477}01477   \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01478}01478     \textcolor{comment}{// Initialise the timer start variable}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01479}01479     \textcolor{keywordtype}{double} t\_m\_start = 0.0;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01480}01480 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01481}01481     \textcolor{comment}{// Start the clock (if we're allowed to time things)}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01482}01482     \textcolor{keywordflow}{if} (!Suppress\_all\_output)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01483}01483     \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01484}01484       \textcolor{comment}{// Start the clock}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01485}01485       t\_m\_start = \mbox{\hyperlink{namespaceoomph_1_1TimingHelpers_a9fb6ad7e2e01b0914e9f7072ef9ebfa6}{TimingHelpers::timer}}();}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01486}01486     \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01487}01487 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01488}01488     \textcolor{comment}{// Calculate the wavenumber value:}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01489}01489     \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01490}01490     \textcolor{comment}{// Reset the value of Wavenumber}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01491}01491     Wavenumber = 0.0;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01492}01492 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01493}01493     \textcolor{comment}{// Upcast the first element in the bulk mesh}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01494}01494     \mbox{\hyperlink{classoomph_1_1PMLHelmholtzEquations}{PMLHelmholtzEquations<DIM>}}* pml\_helmholtz\_el\_pt =}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01495}01495       \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1PMLHelmholtzEquations}{PMLHelmholtzEquations<DIM>}}*\textcolor{keyword}{>}(}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01496}01496         Mg\_problem\_pt-\/>mg\_bulk\_mesh\_pt()-\/>element\_pt(0));}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01497}01497 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01498}01498     \textcolor{comment}{// Grab the k\_squared value from the element pointer and square root.}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01499}01499     \textcolor{comment}{// Note, we assume the wavenumber is the same everywhere in the mesh}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01500}01500     \textcolor{comment}{// and it is also the same on every level.}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01501}01501     Wavenumber = sqrt(pml\_helmholtz\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1PMLHelmholtzEquations_a401e24e48170bd25d6b035a577f3cc62}{k\_squared}}());}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01502}01502 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01503}01503     \textcolor{comment}{// We don't need the pointer anymore so make it a null pointer but don't}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01504}01504     \textcolor{comment}{// delete the underlying element data}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01505}01505     pml\_helmholtz\_el\_pt = 0;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01506}01506 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01507}01507     \textcolor{comment}{// Set up the system matrix and accompanying vectors on each level:}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01508}01508     \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01509}01509     \textcolor{comment}{// Loop over each level and extract the system matrix, solution vector}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01510}01510     \textcolor{comment}{// right-\/hand side vector and residual vector (to store the value of r=b-\/Ax)}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01511}01511     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < Nlevel; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01512}01512     \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01513}01513       \textcolor{comment}{// If we're allowed to output}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01514}01514       \textcolor{keywordflow}{if} (!Suppress\_all\_output)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01515}01515       \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01516}01516         \textcolor{comment}{// Output the level we're working on}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01517}01517         \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{}Setting up MG structures on level: "{}} << \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} << \textcolor{stringliteral}{"{}\(\backslash\)n"{}}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01518}01518                    << std::endl;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01519}01519       \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01520}01520 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01521}01521       \textcolor{comment}{// Resize the solution and RHS vector}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01522}01522       \textcolor{keywordtype}{unsigned} n\_dof\_per\_block = Mg\_hierarchy\_pt[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]-\/>ndof() / 2;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01523}01523 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01524}01524       \textcolor{comment}{// Create the linear algebra distribution to build the vectors}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01525}01525       \mbox{\hyperlink{classoomph_1_1LinearAlgebraDistribution}{LinearAlgebraDistribution}}* dist\_pt = \textcolor{keyword}{new} \mbox{\hyperlink{classoomph_1_1LinearAlgebraDistribution}{LinearAlgebraDistribution}}(}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01526}01526         Mg\_hierarchy\_pt[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]-\/>communicator\_pt(), n\_dof\_per\_block, \textcolor{keyword}{false});}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01527}01527 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01528}01528 \textcolor{preprocessor}{\#ifdef PARANOID}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01529}01529 \textcolor{preprocessor}{\#ifdef OOMPH\_HAS\_MPI}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01530}01530       \textcolor{comment}{// Set up the warning messages}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01531}01531       \mbox{\hyperlink{namespaceoomph_1_1Global__string__for__annotation_ac5379de2fa7fe44f2cb31785fc208135}{std::string}} warning\_message = \textcolor{stringliteral}{"{}Setup of distribution has not been "{}};}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01532}01532       warning\_message += \textcolor{stringliteral}{"{}tested with MPI."{}};}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01533}01533 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01534}01534       \textcolor{comment}{// If we're not running the code in serial}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01535}01535       \textcolor{keywordflow}{if} (dist\_pt-\/>\mbox{\hyperlink{classoomph_1_1LinearAlgebraDistribution_a2760847d45ab334f6d902efc2620b615}{communicator\_pt}}()-\/>nproc() > 1)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01536}01536       \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01537}01537         \textcolor{comment}{// Throw a warning}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01538}01538         \mbox{\hyperlink{classoomph_1_1OomphLibWarning}{OomphLibWarning}}(}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01539}01539           warning\_message, OOMPH\_CURRENT\_FUNCTION, OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01540}01540       \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01541}01541 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01542}01542 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01543}01543 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01544}01544       \textcolor{comment}{// Create storage for the i-\/th level system matrix:}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01545}01545       \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01546}01546       \textcolor{comment}{// Resize the i-\/th entry of the matrix storage vector to contain two}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01547}01547       \textcolor{comment}{// CRDoubleMatrix pointers}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01548}01548       Mg\_matrices\_storage\_pt[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}].resize(2, 0);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01549}01549 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01550}01550       \textcolor{comment}{// Loop over the real and imaginary part}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01551}01551       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < 2; j++)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01552}01552       \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01553}01553         \textcolor{comment}{// Dynamically allocate a new CRDoubleMatrix}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01554}01554         Mg\_matrices\_storage\_pt[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}][j] = \textcolor{keyword}{new} \mbox{\hyperlink{classoomph_1_1CRDoubleMatrix}{CRDoubleMatrix}};}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01555}01555       \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01556}01556 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01557}01557       \textcolor{comment}{// Build the matrix distribution (real part)}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01558}01558       Mg\_matrices\_storage\_pt[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}][0]-\/>\mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_af44bac2acd071317f96dae49cbb0d977}{build}}(dist\_pt);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01559}01559 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01560}01560       \textcolor{comment}{// Build the matrix distribution (imaginary part)}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01561}01561       Mg\_matrices\_storage\_pt[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}][1]-\/>build(dist\_pt);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01562}01562 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01563}01563       \textcolor{comment}{// Create storage for the i-\/th level solution vector:}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01564}01564       \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01565}01565       \textcolor{comment}{// Resize the i-\/th level solution vector to contain two DoubleVectors}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01566}01566       X\_mg\_vectors\_storage[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}].resize(2);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01567}01567 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01568}01568       \textcolor{comment}{// Build the approximate solution (real part)}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01569}01569       X\_mg\_vectors\_storage[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}][0].build(dist\_pt);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01570}01570 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01571}01571       \textcolor{comment}{// Build the approximate solution (imaginary part)}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01572}01572       X\_mg\_vectors\_storage[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}][1].build(dist\_pt);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01573}01573 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01574}01574       \textcolor{comment}{// Create storage for the i-\/th level RHS vector:}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01575}01575       \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01576}01576       \textcolor{comment}{// Resize the i-\/th level RHS vector to contain two DoubleVectors}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01577}01577       Rhs\_mg\_vectors\_storage[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}].resize(2);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01578}01578 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01579}01579       \textcolor{comment}{// Build the point source function (real part)}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01580}01580       Rhs\_mg\_vectors\_storage[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}][0].build(dist\_pt);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01581}01581 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01582}01582       \textcolor{comment}{// Build the point source function (imaginary part)}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01583}01583       Rhs\_mg\_vectors\_storage[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}][1].build(dist\_pt);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01584}01584 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01585}01585       \textcolor{comment}{// Create storage for the i-\/th level residual vector:}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01586}01586       \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01587}01587       \textcolor{comment}{// Resize the i-\/th level residual vector to contain two DoubleVectors}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01588}01588       Residual\_mg\_vectors\_storage[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}].resize(2);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01589}01589 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01590}01590       \textcolor{comment}{// Build the residual vector, r=b-\/Ax (real part)}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01591}01591       Residual\_mg\_vectors\_storage[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}][0].build(dist\_pt);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01592}01592 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01593}01593       \textcolor{comment}{// Build the residual vector, r=b-\/Ax (imaginary part)}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01594}01594       Residual\_mg\_vectors\_storage[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}][1].build(dist\_pt);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01595}01595 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01596}01596       \textcolor{comment}{// Delete the distribution pointer}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01597}01597       \textcolor{keyword}{delete} dist\_pt;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01598}01598 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01599}01599       \textcolor{comment}{// Make it a null pointer}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01600}01600       dist\_pt = 0;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01601}01601 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01602}01602       \textcolor{comment}{// Compute system matrix on the current level. On the finest level of the}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01603}01603       \textcolor{comment}{// hierarchy the system matrix is given by the complex-\/shifted Laplacian}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01604}01604       \textcolor{comment}{// preconditioner. On the subsequent levels the Galerkin approximation}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01605}01605       \textcolor{comment}{// is used to give us a coarse-\/grid representation of the problem}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01606}01606       \textcolor{keywordflow}{if} (\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} == 0)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01607}01607       \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01608}01608         \textcolor{comment}{// Initialise the timer start variable}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01609}01609         \textcolor{keywordtype}{double} t\_jac\_start = 0.0;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01610}01610 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01611}01611         \textcolor{comment}{// If we're allowed to output things}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01612}01612         \textcolor{keywordflow}{if} (!Suppress\_all\_output)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01613}01613         \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01614}01614           \textcolor{comment}{// Start timer for Jacobian setup}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01615}01615           t\_jac\_start = \mbox{\hyperlink{namespaceoomph_1_1TimingHelpers_a9fb6ad7e2e01b0914e9f7072ef9ebfa6}{TimingHelpers::timer}}();}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01616}01616         \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01617}01617 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01618}01618 \textcolor{preprocessor}{\#ifdef PARANOID}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01619}01619         \textcolor{comment}{// Make sure the block preconditioner returns the correct sort of matrix}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01620}01620         block\_preconditioner\_self\_test();}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01621}01621 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01622}01622 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01623}01623         \textcolor{comment}{// The preconditioner works with one mesh; set it!}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01624}01624         this-\/>set\_nmesh(1);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01625}01625 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01626}01626         \textcolor{comment}{// Elements in actual pml layer are trivially wrapped versions of their}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01627}01627         \textcolor{comment}{// bulk counterparts. Technically they are different elements so we have}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01628}01628         \textcolor{comment}{// to allow different element types}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01629}01629         \textcolor{keywordtype}{bool} allow\_different\_element\_types\_in\_mesh = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01630}01630         this-\/>set\_mesh(0,}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01631}01631                        Mg\_hierarchy\_pt[0]-\/>mesh\_pt(),}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01632}01632                        allow\_different\_element\_types\_in\_mesh);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01633}01633 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01634}01634 \textcolor{preprocessor}{\#ifdef PARANOID}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01635}01635         \textcolor{comment}{// Find the number of dof types we're dealing with}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01636}01636         \textcolor{keywordtype}{unsigned} n\_dof\_types = this-\/>ndof\_types();}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01637}01637 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01638}01638         \textcolor{comment}{// This preconditioner only works for 2 dof types}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01639}01639         \textcolor{keywordflow}{if} (n\_dof\_types != 2)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01640}01640         \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01641}01641           \textcolor{comment}{// Create an error message}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01642}01642           std::stringstream tmp;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01643}01643           tmp}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01644}01644             << \textcolor{stringliteral}{"{}This preconditioner only works for problems with 2 dof types\(\backslash\)n"{}}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01645}01645             << \textcolor{stringliteral}{"{}Yours has "{}} << n\_dof\_types;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01646}01646 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01647}01647           \textcolor{comment}{// Throw an error}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01648}01648           \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01649}01649             tmp.str(), OOMPH\_CURRENT\_FUNCTION, OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01650}01650         \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01651}01651 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01652}01652 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01653}01653         \textcolor{comment}{// If we're not using a value of zero for the alpha shift}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01654}01654         \textcolor{keywordflow}{if} (Alpha\_shift != 0.0)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01655}01655         \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01656}01656           \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01657}01657           \textcolor{comment}{// Set the damping in all of the PML elements to create the complex-\/}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01658}01658           \textcolor{comment}{// shifted Laplacian preconditioner:}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01659}01659           \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01660}01660           \textcolor{comment}{// Create a pointer which will contain the value of the shift given}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01661}01661           \textcolor{comment}{// by Alpha\_shift}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01662}01662           \textcolor{keywordtype}{double}* alpha\_shift\_pt = \textcolor{keyword}{new} double(Alpha\_shift);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01663}01663 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01664}01664           \textcolor{comment}{// Calculate the number of elements in the mesh}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01665}01665           \textcolor{keywordtype}{unsigned} n\_element = Mg\_hierarchy\_pt[0]-\/>mesh\_pt()-\/>nelement();}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01666}01666 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01667}01667           \textcolor{comment}{// To grab the static variable used to set the value of alpha we first}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01668}01668           \textcolor{comment}{// need to get an element of type PMLHelmholtzEquations (we}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01669}01669           \textcolor{comment}{// arbitrarily chose the first element in the mesh)}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01670}01670           \mbox{\hyperlink{classoomph_1_1PMLHelmholtzEquations}{PMLHelmholtzEquations<DIM>}}* el\_pt =}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01671}01671             \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1PMLHelmholtzEquations}{PMLHelmholtzEquations<DIM>}}*\textcolor{keyword}{>}(}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01672}01672               Mg\_hierarchy\_pt[0]-\/>mesh\_pt()-\/>element\_pt(0));}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01673}01673 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01674}01674           \textcolor{comment}{// Now grab the pointer from the element}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01675}01675           \textcolor{keyword}{static} \textcolor{keywordtype}{double}* default\_physical\_constant\_value\_pt = el\_pt-\/>\mbox{\hyperlink{classoomph_1_1PMLHelmholtzEquations_a8c6cab41f68894dc463c00812ba007b3}{alpha\_pt}}();}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01676}01676 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01677}01677           \textcolor{comment}{// Loop over all of the elements}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01678}01678           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} i\_el = 0; i\_el < n\_element; i\_el++)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01679}01679           \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01680}01680             \textcolor{comment}{// Upcast from a GeneralisedElement to a PmlHelmholtzElement}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01681}01681             \mbox{\hyperlink{classoomph_1_1PMLHelmholtzEquations}{PMLHelmholtzEquations<DIM>}}* el\_pt =}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01682}01682               \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1PMLHelmholtzEquations}{PMLHelmholtzEquations<DIM>}}*\textcolor{keyword}{>}(}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01683}01683                 Mg\_hierarchy\_pt[0]-\/>mesh\_pt()-\/>element\_pt(i\_el));}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01684}01684 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01685}01685             \textcolor{comment}{// Make the internal element alpha pointer point to Alpha\_shift (the}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01686}01686             \textcolor{comment}{// chosen value of the shift to be applied to the problem)}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01687}01687             el\_pt-\/>\mbox{\hyperlink{classoomph_1_1PMLHelmholtzEquations_a8c6cab41f68894dc463c00812ba007b3}{alpha\_pt}}() = alpha\_shift\_pt;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01688}01688           \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01689}01689 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01690}01690           \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01691}01691           \textcolor{comment}{// We want to solve the problem with the modified Jacobian but the}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01692}01692           \textcolor{comment}{// Preconditioner will have a handle to pointer which points to the}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01693}01693           \textcolor{comment}{// system matrix. If we wish to use the block preconditioner to}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01694}01694           \textcolor{comment}{// extract the appropriate blocks of the matrix we need to assign it.}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01695}01695           \textcolor{comment}{// To avoid losing the original system matrix we will create a}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01696}01696           \textcolor{comment}{// temporary pointer to it which will be reassigned after we have use}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01697}01697           \textcolor{comment}{// the block preconditioner to extract the blocks of the shifted}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01698}01698           \textcolor{comment}{// matrix:}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01699}01699           \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01700}01700           \textcolor{comment}{// Create a temporary pointer to the Jacobian}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01701}01701           \mbox{\hyperlink{classoomph_1_1CRDoubleMatrix}{CRDoubleMatrix}}* jacobian\_pt = this-\/>matrix\_pt();}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01702}01702 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01703}01703           \textcolor{comment}{// Create a new CRDoubleMatrix to hold the shifted Jacobian matrix}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01704}01704           \mbox{\hyperlink{classoomph_1_1CRDoubleMatrix}{CRDoubleMatrix}}* shifted\_jacobian\_pt = \textcolor{keyword}{new} \mbox{\hyperlink{classoomph_1_1CRDoubleMatrix}{CRDoubleMatrix}};}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01705}01705 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01706}01706           \textcolor{comment}{// Allocate space for the residuals}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01707}01707           \mbox{\hyperlink{classoomph_1_1DoubleVector}{DoubleVector}} residuals;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01708}01708 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01709}01709           \textcolor{comment}{// Get the residuals vector and the shifted Jacobian. Note, we do}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01710}01710           \textcolor{comment}{// not need to assign the residuals vector; we're simply using}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01711}01711           \textcolor{comment}{// MG as a preconditioner}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01712}01712           Mg\_hierarchy\_pt[0]-\/>get\_jacobian(residuals, *shifted\_jacobian\_pt);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01713}01713 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01714}01714           \textcolor{comment}{// Replace the current matrix used in Preconditioner by the new matrix}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01715}01715           this-\/>set\_matrix\_pt(shifted\_jacobian\_pt);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01716}01716 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01717}01717           \textcolor{comment}{// Set up the generic block look up scheme}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01718}01718           this-\/>block\_setup();}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01719}01719 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01720}01720           \textcolor{comment}{// Extract the number of blocks.}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01721}01721           \textcolor{keywordtype}{unsigned} nblock\_types = this-\/>nblock\_types();}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01722}01722 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01723}01723 \textcolor{preprocessor}{\#ifdef PARANOID}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01724}01724           \textcolor{comment}{// PARANOID check -\/ there must only be two block types}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01725}01725           \textcolor{keywordflow}{if} (nblock\_types != 2)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01726}01726           \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01727}01727             \textcolor{comment}{// Create the error message}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01728}01728             std::stringstream tmp;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01729}01729             tmp << \textcolor{stringliteral}{"{}There are supposed to be two block types.\(\backslash\)nYours has "{}}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01730}01730                 << nblock\_types << std::endl;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01731}01731 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01732}01732             \textcolor{comment}{// Throw an error}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01733}01733             \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01734}01734               tmp.str(), OOMPH\_CURRENT\_FUNCTION, OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01735}01735           \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01736}01736 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01737}01737 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01738}01738           \textcolor{comment}{// Store the level}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01739}01739           \textcolor{keywordtype}{unsigned} level = 0;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01740}01740 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01741}01741           \textcolor{comment}{// Loop over the rows of the block matrix}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01742}01742           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} i\_row = 0; i\_row < nblock\_types; i\_row++)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01743}01743           \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01744}01744             \textcolor{comment}{// Fix the column index}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01745}01745             \textcolor{keywordtype}{unsigned} j\_col = 0;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01746}01746 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01747}01747             \textcolor{comment}{// Extract the required blocks, i.e. the first column}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01748}01748             this-\/>get\_block(}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01749}01749               i\_row, j\_col, *Mg\_matrices\_storage\_pt[level][i\_row]);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01750}01750           \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01751}01751 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01752}01752           \textcolor{comment}{// The blocks have been extracted from the shifted Jacobian therefore}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01753}01753           \textcolor{comment}{// we no longer have any use for it}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01754}01754           \textcolor{keyword}{delete} shifted\_jacobian\_pt;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01755}01755 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01756}01756           \textcolor{comment}{// Now the appropriate blocks have been extracted from the shifted}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01757}01757           \textcolor{comment}{// Jacobian we reset the matrix pointer in Preconditioner to the}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01758}01758           \textcolor{comment}{// original Jacobian so the linear solver isn't affected}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01759}01759           this-\/>set\_matrix\_pt(jacobian\_pt);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01760}01760 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01761}01761           \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01762}01762           \textcolor{comment}{// Reassign the damping factor in all of the PML elements:}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01763}01763           \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01764}01764           \textcolor{comment}{// Loop over all of the elements}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01765}01765           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} i\_el = 0; i\_el < n\_element; i\_el++)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01766}01766           \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01767}01767             \textcolor{comment}{// Upcast from a GeneralisedElement to a PmlHelmholtzElement}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01768}01768             \mbox{\hyperlink{classoomph_1_1PMLHelmholtzEquations}{PMLHelmholtzEquations<DIM>}}* el\_pt =}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01769}01769               \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1PMLHelmholtzEquations}{PMLHelmholtzEquations<DIM>}}*\textcolor{keyword}{>}(}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01770}01770                 Mg\_hierarchy\_pt[0]-\/>mesh\_pt()-\/>element\_pt(i\_el));}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01771}01771 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01772}01772             \textcolor{comment}{// Set the value of alpha}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01773}01773             el\_pt-\/>\mbox{\hyperlink{classoomph_1_1PMLHelmholtzEquations_a8c6cab41f68894dc463c00812ba007b3}{alpha\_pt}}() = default\_physical\_constant\_value\_pt;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01774}01774           \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01775}01775 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01776}01776           \textcolor{comment}{// We've finished using the alpha\_shift\_pt pointer so delete it}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01777}01777           \textcolor{comment}{// as it was dynamically allocated}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01778}01778           \textcolor{keyword}{delete} alpha\_shift\_pt;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01779}01779 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01780}01780           \textcolor{comment}{// Make it a null pointer}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01781}01781           alpha\_shift\_pt = 0;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01782}01782         \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01783}01783         \textcolor{comment}{// If the value of the shift is zero then we use the original}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01784}01784         \textcolor{comment}{// Jacobian matrix}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01785}01785         \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01786}01786         \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01787}01787           \textcolor{comment}{// The Jacobian has already been provided so now we just need to set}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01788}01788           \textcolor{comment}{// up the generic block look up scheme}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01789}01789           this-\/>block\_setup();}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01790}01790 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01791}01791           \textcolor{comment}{// Extract the number of blocks.}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01792}01792           \textcolor{keywordtype}{unsigned} nblock\_types = this-\/>nblock\_types();}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01793}01793 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01794}01794 \textcolor{preprocessor}{\#ifdef PARANOID}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01795}01795           \textcolor{comment}{// If there are not only two block types we have a problem}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01796}01796           \textcolor{keywordflow}{if} (nblock\_types != 2)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01797}01797           \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01798}01798             std::stringstream tmp;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01799}01799             tmp << \textcolor{stringliteral}{"{}There are supposed to be two block types.\(\backslash\)n"{}}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01800}01800                 << \textcolor{stringliteral}{"{}Yours has "{}} << nblock\_types;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01801}01801             \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01802}01802               tmp.str(), OOMPH\_CURRENT\_FUNCTION, OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01803}01803           \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01804}01804 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01805}01805 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01806}01806           \textcolor{comment}{// Store the level}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01807}01807           \textcolor{keywordtype}{unsigned} level = 0;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01808}01808 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01809}01809           \textcolor{comment}{// Loop over the rows of the block matrix}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01810}01810           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} i\_row = 0; i\_row < nblock\_types; i\_row++)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01811}01811           \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01812}01812             \textcolor{comment}{// Fix the column index (since we only want the first column)}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01813}01813             \textcolor{keywordtype}{unsigned} j\_col = 0;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01814}01814 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01815}01815             \textcolor{comment}{// Extract the required blocks}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01816}01816             this-\/>get\_block(}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01817}01817               i\_row, j\_col, *Mg\_matrices\_storage\_pt[level][i\_row]);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01818}01818           \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01819}01819         \} \textcolor{comment}{// if (Alpha\_shift!=0.0) else}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01820}01820 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01821}01821         \textcolor{keywordflow}{if} (!Suppress\_all\_output)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01822}01822         \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01823}01823           \textcolor{comment}{// Document the time taken}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01824}01824           \textcolor{keywordtype}{double} t\_jac\_end = \mbox{\hyperlink{namespaceoomph_1_1TimingHelpers_a9fb6ad7e2e01b0914e9f7072ef9ebfa6}{TimingHelpers::timer}}();}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01825}01825           \textcolor{keywordtype}{double} jacobian\_setup\_time = t\_jac\_end -\/ t\_jac\_start;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01826}01826           \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{} -\/ Time for setup of Jacobian block matrix [sec]: "{}}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01827}01827                      << jacobian\_setup\_time << \textcolor{stringliteral}{"{}\(\backslash\)n"{}}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01828}01828                      << std::endl;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01829}01829         \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01830}01830       \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01831}01831       \textcolor{comment}{// If we're not dealing with the finest level we're dealing with a}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01832}01832       \textcolor{comment}{// coarse-\/grid problem}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01833}01833       \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01834}01834       \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01835}01835         \textcolor{comment}{// Initialise the timer start variable}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01836}01836         \textcolor{keywordtype}{double} t\_gal\_start = 0.0;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01837}01837 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01838}01838         \textcolor{comment}{// If we're allowed}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01839}01839         \textcolor{keywordflow}{if} (!Suppress\_all\_output)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01840}01840         \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01841}01841           \textcolor{comment}{// Start timer for Galerkin matrix calculation}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01842}01842           t\_gal\_start = \mbox{\hyperlink{namespaceoomph_1_1TimingHelpers_a9fb6ad7e2e01b0914e9f7072ef9ebfa6}{TimingHelpers::timer}}();}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01843}01843         \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01844}01844 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01845}01845         \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01846}01846         \textcolor{comment}{// The system matrix on the coarser levels must be formed using the}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01847}01847         \textcolor{comment}{// Galerkin approximation which we do by calculating the product}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01848}01848         \textcolor{comment}{// A\string^2h = I\string^2h\_h * A\string^h * I\string^h\_2h, i.e. the coarser version of the}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01849}01849         \textcolor{comment}{// finer grid system matrix is formed by multiplying by the (fine grid)}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01850}01850         \textcolor{comment}{// restriction matrix from the left and the (fine grid) interpolation}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01851}01851         \textcolor{comment}{// matrix from the left. Fortunately, since the restriction and}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01852}01852         \textcolor{comment}{// interpolation acts on the real and imaginary parts separately we}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01853}01853         \textcolor{comment}{// can calculate the real and imaginary parts of the Galerkin}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01854}01854         \textcolor{comment}{// approximation separately.}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01855}01855         \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01856}01856 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01857}01857         \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01858}01858         \textcolor{comment}{// Real component of the Galerkin approximation:}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01859}01859         \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01860}01860         \textcolor{comment}{// First we need to calculate A\string^h * I\string^h\_2h which we store as A\string^2h}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01861}01861         Mg\_matrices\_storage\_pt[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} -\/ 1][0]-\/>multiply(}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01862}01862           *Interpolation\_matrices\_storage\_pt[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} -\/ 1],}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01863}01863           *Mg\_matrices\_storage\_pt[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}][0]);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01864}01864 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01865}01865         \textcolor{comment}{// Now calculate I\string^2h\_h * (A\string^h * I\string^h\_2h) where the quantity in brackets}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01866}01866         \textcolor{comment}{// was just calculated. This updates A\string^2h to give us the true}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01867}01867         \textcolor{comment}{// Galerkin approximation to the finer grid matrix}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01868}01868         Restriction\_matrices\_storage\_pt[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} -\/ 1]-\/>multiply(}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01869}01869           *Mg\_matrices\_storage\_pt[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}][0], *Mg\_matrices\_storage\_pt[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}][0]);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01870}01870 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01871}01871         \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01872}01872         \textcolor{comment}{// Imaginary component of the Galerkin approximation:}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01873}01873         \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01874}01874         \textcolor{comment}{// First we need to calculate A\string^h * I\string^h\_2h which we store as A\string^2h}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01875}01875         Mg\_matrices\_storage\_pt[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} -\/ 1][1]-\/>multiply(}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01876}01876           *Interpolation\_matrices\_storage\_pt[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} -\/ 1],}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01877}01877           *Mg\_matrices\_storage\_pt[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}][1]);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01878}01878 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01879}01879         \textcolor{comment}{// Now calculate I\string^2h\_h * (A\string^h * I\string^h\_2h) where the quantity in brackets}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01880}01880         \textcolor{comment}{// was just calculated. This updates A\string^2h to give us the true}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01881}01881         \textcolor{comment}{// Galerkin approximation to the finer grid matrix}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01882}01882         Restriction\_matrices\_storage\_pt[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} -\/ 1]-\/>multiply(}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01883}01883           *Mg\_matrices\_storage\_pt[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}][1], *Mg\_matrices\_storage\_pt[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}][1]);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01884}01884 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01885}01885         \textcolor{comment}{// If the user did not choose to suppress everything}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01886}01886         \textcolor{keywordflow}{if} (!Suppress\_all\_output)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01887}01887         \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01888}01888           \textcolor{comment}{// End timer for Galerkin matrix calculation}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01889}01889           \textcolor{keywordtype}{double} t\_gal\_end = \mbox{\hyperlink{namespaceoomph_1_1TimingHelpers_a9fb6ad7e2e01b0914e9f7072ef9ebfa6}{TimingHelpers::timer}}();}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01890}01890 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01891}01891           \textcolor{comment}{// Calculate setup time}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01892}01892           \textcolor{keywordtype}{double} galerkin\_matrix\_calculation\_time = t\_gal\_end -\/ t\_gal\_start;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01893}01893 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01894}01894           \textcolor{comment}{// Document the time taken}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01895}01895           \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{} -\/ Time for system block matrix formation using the "{}}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01896}01896                      << \textcolor{stringliteral}{"{}Galerkin approximation [sec]: "{}}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01897}01897                      << galerkin\_matrix\_calculation\_time << \textcolor{stringliteral}{"{}\(\backslash\)n"{}}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01898}01898                      << std::endl;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01899}01899         \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01900}01900       \} \textcolor{comment}{// if (i==0) else}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01901}01901 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01902}01902       \textcolor{comment}{// We only}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01903}01903       \textcolor{keywordflow}{if} (\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < Nlevel -\/ 1)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01904}01904       \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01905}01905         \textcolor{comment}{// Find the maximum edge width, h:}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01906}01906         \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01907}01907         \textcolor{comment}{// Initialise the timer start variable}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01908}01908         \textcolor{keywordtype}{double} t\_para\_start = 0.0;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01909}01909 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01910}01910         \textcolor{comment}{// If we're allowed to output things}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01911}01911         \textcolor{keywordflow}{if} (!Suppress\_all\_output)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01912}01912         \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01913}01913           \textcolor{comment}{// Start timer for parameter calculation on the i-\/th level}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01914}01914           t\_para\_start = \mbox{\hyperlink{namespaceoomph_1_1TimingHelpers_a9fb6ad7e2e01b0914e9f7072ef9ebfa6}{TimingHelpers::timer}}();}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01915}01915         \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01916}01916 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01917}01917         \textcolor{comment}{// Calculate the i-\/th entry of Wavenumber and Max\_edge\_width}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01918}01918         maximum\_edge\_width(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}, Max\_edge\_width[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01919}01919 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01920}01920         \textcolor{comment}{// If the user did not choose to suppress everything}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01921}01921         \textcolor{keywordflow}{if} (!Suppress\_all\_output)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01922}01922         \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01923}01923           \textcolor{comment}{// End timer for Galerkin matrix calculation}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01924}01924           \textcolor{keywordtype}{double} t\_para\_end = \mbox{\hyperlink{namespaceoomph_1_1TimingHelpers_a9fb6ad7e2e01b0914e9f7072ef9ebfa6}{TimingHelpers::timer}}();}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01925}01925 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01926}01926           \textcolor{comment}{// Calculate setup time}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01927}01927           \textcolor{keywordtype}{double} parameter\_calculation\_time = t\_para\_end -\/ t\_para\_start;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01928}01928 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01929}01929           \textcolor{comment}{// Document the time taken}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01930}01930           \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{} -\/ Time for maximum edge width calculation [sec]: "{}}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01931}01931                      << parameter\_calculation\_time << \textcolor{stringliteral}{"{}\(\backslash\)n"{}}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01932}01932                      << std::endl;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01933}01933         \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01934}01934       \} \textcolor{comment}{// if (i<Nlevel-\/1)}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01935}01935     \} \textcolor{comment}{// for (unsigned i=0;i<Nlevel;i++)}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01936}01936 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01937}01937     \textcolor{comment}{// The last system matrix that needs to be setup is the fully expanded}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01938}01938     \textcolor{comment}{// version of the system matrix on the coarsest level. This is needed}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01939}01939     \textcolor{comment}{// for the direct solve on the coarsest level}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01940}01940     setup\_coarsest\_level\_structures();}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01941}01941 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01942}01942     \textcolor{comment}{// If we're allowed to output}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01943}01943     \textcolor{keywordflow}{if} (!Suppress\_all\_output)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01944}01944     \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01945}01945       \textcolor{comment}{// Stop clock}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01946}01946       \textcolor{keywordtype}{double} t\_m\_end = \mbox{\hyperlink{namespaceoomph_1_1TimingHelpers_a9fb6ad7e2e01b0914e9f7072ef9ebfa6}{TimingHelpers::timer}}();}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01947}01947       \textcolor{keywordtype}{double} total\_setup\_time = double(t\_m\_end -\/ t\_m\_start);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01948}01948       \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{}CPU time for setup of MG structures [sec]: "{}}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01949}01949                  << total\_setup\_time << std::endl;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01950}01950 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01951}01951       \textcolor{comment}{// Notify user that the hierarchy of levels is complete}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01952}01952       \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{}\(\backslash\)n============"{}}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01953}01953                  << \textcolor{stringliteral}{"{}Multigrid Structures Setup Complete"{}}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01954}01954                  << \textcolor{stringliteral}{"{}===========\(\backslash\)n"{}}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01955}01955                  << std::endl;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01956}01956     \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01957}01957   \} \textcolor{comment}{// End of setup\_mg\_structures}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01958}01958 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01959}01959   \textcolor{comment}{//=========================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01960}01960 \textcolor{comment}{  /// Function to set up structures on the coarsest level of the MG}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01961}01961 \textcolor{comment}{  /// hierarchy. This includes setting up the CRDoubleMatrix version of the}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01962}01962 \textcolor{comment}{  /// coarsest level system matrix. This would otherwise be stored as a}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01963}01963 \textcolor{comment}{  /// vector of pointers to the constituent CRDoubleMatrix objects which}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01964}01964 \textcolor{comment}{  /// has the form:}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01965}01965 \textcolor{comment}{  ///                |-\/-\/-\/-\/-\/|}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01966}01966 \textcolor{comment}{  ///                | A\_r |}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01967}01967 \textcolor{comment}{  /// Matrix\_mg\_pt = |-\/-\/-\/-\/-\/|}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01968}01968 \textcolor{comment}{  ///                | A\_i |}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01969}01969 \textcolor{comment}{  ///                |-\/-\/-\/-\/-\/|}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01970}01970 \textcolor{comment}{  /// and we want to construct:}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01971}01971 \textcolor{comment}{  ///                       |-\/-\/-\/-\/-\/|-\/-\/-\/-\/-\/-\/|}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01972}01972 \textcolor{comment}{  ///                       | A\_r | -\/A\_c |}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01973}01973 \textcolor{comment}{  /// Coarse\_matrix\_mg\_pt = |-\/-\/-\/-\/-\/|-\/-\/-\/-\/-\/-\/|}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01974}01974 \textcolor{comment}{  ///                       | A\_c |  A\_r |}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01975}01975 \textcolor{comment}{  ///                       |-\/-\/-\/-\/-\/|-\/-\/-\/-\/-\/-\/|}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01976}01976 \textcolor{comment}{  /// Once this is done we have to set up the distributions of the vectors}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01977}01977 \textcolor{comment}{  /// associated with Coarse\_matrix\_mg\_pt}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01978}01978 \textcolor{comment}{}  \textcolor{comment}{//=========================================================================}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01979}01979   \textcolor{keyword}{template}<\textcolor{keywordtype}{unsigned} DIM>}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01980}\mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a2436c6189b4cda832bf28471f4f9e23c}{01980}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a2436c6189b4cda832bf28471f4f9e23c}{HelmholtzMGPreconditioner<DIM>::setup\_coarsest\_level\_structures}}()}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01981}01981   \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01982}01982     \textcolor{comment}{// Start timer}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01983}01983     \textcolor{keywordtype}{double} t\_cm\_start = \mbox{\hyperlink{namespaceoomph_1_1TimingHelpers_a9fb6ad7e2e01b0914e9f7072ef9ebfa6}{TimingHelpers::timer}}();}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01984}01984 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01985}01985     \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01986}01986     \textcolor{comment}{// Extract information from the constituent matrices:}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01987}01987     \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01988}01988 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01989}01989     \textcolor{comment}{// Grab the real and imaginary matrix parts from storage}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01990}01990     \mbox{\hyperlink{classoomph_1_1CRDoubleMatrix}{CRDoubleMatrix}}* real\_matrix\_pt = Mg\_matrices\_storage\_pt[Nlevel -\/ 1][0];}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01991}01991     \mbox{\hyperlink{classoomph_1_1CRDoubleMatrix}{CRDoubleMatrix}}* imag\_matrix\_pt = Mg\_matrices\_storage\_pt[Nlevel -\/ 1][1];}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01992}01992 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01993}01993     \textcolor{comment}{// Number of nonzero entries in A\_r}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01994}01994     \textcolor{keywordtype}{unsigned} nnz\_r = real\_matrix\_pt-\/>\mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_a9482dafc0a17ebc5b7431369d8d07565}{nnz}}();}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01995}01995     \textcolor{keywordtype}{unsigned} nnz\_c = imag\_matrix\_pt-\/>\mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_a9482dafc0a17ebc5b7431369d8d07565}{nnz}}();}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01996}01996 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01997}01997     \textcolor{comment}{// Calculate the total number of rows (and thus columns) in the real matrix}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01998}01998     \textcolor{keywordtype}{unsigned} n\_rows\_r = real\_matrix\_pt-\/>\mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_abd8d231b0549540144b4739a667b1e75}{nrow}}();}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l01999}01999 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02000}02000     \textcolor{comment}{// Acquire access to the value, row\_start and column\_index arrays from}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02001}02001     \textcolor{comment}{// the real and imaginary portions of the full matrix.}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02002}02002     \textcolor{comment}{// Real part:}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02003}02003     \textcolor{keyword}{const} \textcolor{keywordtype}{double}* value\_r\_pt = real\_matrix\_pt-\/>\mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_aafc5f1896dc3a317cdeddb067290c796}{value}}();}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02004}02004     \textcolor{keyword}{const} \textcolor{keywordtype}{int}* row\_start\_r\_pt = real\_matrix\_pt-\/>\mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_a31a5d05c00d653a02e7b07714472d372}{row\_start}}();}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02005}02005     \textcolor{keyword}{const} \textcolor{keywordtype}{int}* column\_index\_r\_pt = real\_matrix\_pt-\/>\mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_a925b465e7e86cf1ec45c1fb70a37c105}{column\_index}}();}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02006}02006 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02007}02007     \textcolor{comment}{// Imaginary part:}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02008}02008     \textcolor{keyword}{const} \textcolor{keywordtype}{double}* value\_c\_pt = imag\_matrix\_pt-\/>\mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_aafc5f1896dc3a317cdeddb067290c796}{value}}();}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02009}02009     \textcolor{keyword}{const} \textcolor{keywordtype}{int}* row\_start\_c\_pt = imag\_matrix\_pt-\/>\mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_a31a5d05c00d653a02e7b07714472d372}{row\_start}}();}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02010}02010     \textcolor{keyword}{const} \textcolor{keywordtype}{int}* column\_index\_c\_pt = imag\_matrix\_pt-\/>\mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_a925b465e7e86cf1ec45c1fb70a37c105}{column\_index}}();}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02011}02011 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02012}02012 \textcolor{preprocessor}{\#ifdef PARANOID}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02013}02013     \textcolor{comment}{// PARANOID check -\/ make sure the matrices have the same number of rows}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02014}02014     \textcolor{comment}{// to ensure they are compatible}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02015}02015     \textcolor{keywordflow}{if} (real\_matrix\_pt-\/>\mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_abd8d231b0549540144b4739a667b1e75}{nrow}}() != imag\_matrix\_pt-\/>\mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_abd8d231b0549540144b4739a667b1e75}{nrow}}())}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02016}02016     \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02017}02017       std::ostringstream error\_message\_stream;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02018}02018       error\_message\_stream << \textcolor{stringliteral}{"{}The real and imaginary matrices do not have "{}}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02019}02019                            << \textcolor{stringliteral}{"{}compatible sizes"{}};}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02020}02020       \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(error\_message\_stream.str(),}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02021}02021                           OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02022}02022                           OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02023}02023     \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02024}02024     \textcolor{comment}{// PARANOID check -\/ make sure the matrices have the same number of columns}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02025}02025     \textcolor{comment}{// to ensure they are compatible}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02026}02026     \textcolor{keywordflow}{if} (real\_matrix\_pt-\/>\mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_a4ed5597d8a34dd14f90b0e6cfb88ca2e}{ncol}}() != imag\_matrix\_pt-\/>\mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_a4ed5597d8a34dd14f90b0e6cfb88ca2e}{ncol}}())}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02027}02027     \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02028}02028       std::ostringstream error\_message\_stream;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02029}02029       error\_message\_stream << \textcolor{stringliteral}{"{}The real and imaginary matrices do not have "{}}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02030}02030                            << \textcolor{stringliteral}{"{}compatible sizes"{}};}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02031}02031       \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(error\_message\_stream.str(),}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02032}02032                           OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02033}02033                           OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02034}02034     \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02035}02035 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02036}02036 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02037}02037     \textcolor{comment}{// Calculate the total number of nonzeros in the full matrix}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02038}02038     \textcolor{keywordtype}{unsigned} nnz = 2 * (nnz\_r + nnz\_c);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02039}02039 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02040}02040     \textcolor{comment}{// Allocate space for the row\_start and column\_index vectors associated with}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02041}02041     \textcolor{comment}{// the complete matrix}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02042}02042     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} value(nnz, 0.0);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02043}02043     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<int>}} column\_index(nnz, 0);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02044}02044     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<int>}} row\_start(2 * n\_rows\_r + 1, 0);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02045}02045 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02046}02046     \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02047}02047     \textcolor{comment}{// Build the row start vector:}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02048}02048     \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02049}02049 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02050}02050     \textcolor{comment}{// Loop over the rows of the row\_start vector. This is decomposed into}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02051}02051     \textcolor{comment}{// two parts. The first (n\_rows\_r+1) entries are found by computing}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02052}02052     \textcolor{comment}{// the entry-\/wise addition of row\_start\_r+row\_start\_c. The remaining}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02053}02053     \textcolor{comment}{// entries are almost the same as the first (n\_rows\_r+1). The only}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02054}02054     \textcolor{comment}{// distinction is that we need to shift the values of the entries by}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02055}02055     \textcolor{comment}{// the number of nonzeros in the top half of A. This is obvious from}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02056}02056     \textcolor{comment}{// observing the structure of the complete matrix.}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02057}02057 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02058}02058     \textcolor{comment}{// Loop over the rows in the top half:}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02059}02059     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < n\_rows\_r; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02060}02060     \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02061}02061       \textcolor{comment}{// Set the i-\/th entry in the row start vector}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02062}02062       row\_start[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] = *(row\_start\_r\_pt + \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) + *(row\_start\_c\_pt + \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}});}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02063}02063     \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02064}02064 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02065}02065     \textcolor{comment}{// Loop over the rows in the bottom half:}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02066}02066     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = n\_rows\_r; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < 2 * n\_rows\_r; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02067}02067     \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02068}02068       \textcolor{comment}{// Set the i-\/th entry in the row start vector (bottom half)}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02069}02069       row\_start[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] = row\_start[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} -\/ n\_rows\_r] + (nnz\_r + nnz\_c);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02070}02070     \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02071}02071 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02072}02072     \textcolor{comment}{// Set the last entry in the row start vector}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02073}02073     row\_start[2 * n\_rows\_r] = nnz;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02074}02074 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02075}02075     \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02076}02076     \textcolor{comment}{// Build the column index and value vector:}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02077}02077     \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02078}02078 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02079}02079     \textcolor{comment}{// Variable to store the index of the nonzero}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02080}02080     \textcolor{keywordtype}{unsigned} i\_nnz = 0;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02081}02081 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02082}02082     \textcolor{comment}{// Loop over the top half of the complete matrix}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02083}02083     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < n\_rows\_r; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02084}02084     \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02085}02085       \textcolor{comment}{// Calculate the number of nonzeros in the i-\/th row of A\_r}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02086}02086       \textcolor{keywordtype}{unsigned} i\_row\_r\_nnz = *(row\_start\_r\_pt + \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} + 1) -\/ *(row\_start\_r\_pt + \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}});}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02087}02087 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02088}02088       \textcolor{comment}{// Calculate the number of nonzeros in the i-\/th row of A\_c}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02089}02089       \textcolor{keywordtype}{unsigned} i\_row\_c\_nnz = *(row\_start\_c\_pt + \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} + 1) -\/ *(row\_start\_c\_pt + \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}});}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02090}02090 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02091}02091       \textcolor{comment}{// The index of the first entry in the i-\/th row of A\_r}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02092}02092       \textcolor{keywordtype}{unsigned} i\_first\_entry\_r = *(row\_start\_r\_pt + \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}});}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02093}02093 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02094}02094       \textcolor{comment}{// The index of the first entry in the i-\/th row of A\_c}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02095}02095       \textcolor{keywordtype}{unsigned} i\_first\_entry\_c = *(row\_start\_c\_pt + \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}});}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02096}02096 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02097}02097       \textcolor{comment}{// Loop over the number of nonzeros in the row associated with A\_r}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02098}02098       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < i\_row\_r\_nnz; j++)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02099}02099       \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02100}02100         \textcolor{comment}{// Assign the column index of the j-\/th entry in the i-\/th row of A\_r}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02101}02101         \textcolor{comment}{// to the column\_index vector}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02102}02102         column\_index[i\_nnz] = *(column\_index\_r\_pt + i\_first\_entry\_r + j);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02103}02103 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02104}02104         \textcolor{comment}{// Assign the corresponding entry in the value vector}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02105}02105         value[i\_nnz] = *(value\_r\_pt + i\_first\_entry\_r + j);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02106}02106 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02107}02107         \textcolor{comment}{// Increment the value of i\_nnz}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02108}02108         i\_nnz++;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02109}02109       \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02110}02110 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02111}02111       \textcolor{comment}{// Loop over the number of nonzeros in the row associated with -\/A\_c}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02112}02112       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < i\_row\_c\_nnz; j++)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02113}02113       \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02114}02114         \textcolor{comment}{// Assign the column index of the j-\/th entry in the i-\/th row of -\/A\_c}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02115}02115         \textcolor{comment}{// to the column\_index vector}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02116}02116         column\_index[i\_nnz] =}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02117}02117           *(column\_index\_c\_pt + i\_first\_entry\_c + j) + n\_rows\_r;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02118}02118 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02119}02119         \textcolor{comment}{// Assign the corresponding entry in the value vector}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02120}02120         value[i\_nnz] = -\/*(value\_c\_pt + i\_first\_entry\_c + j);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02121}02121 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02122}02122         \textcolor{comment}{// Increment the value of i\_nnz}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02123}02123         i\_nnz++;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02124}02124       \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02125}02125     \} \textcolor{comment}{// for (unsigned i=0;i<n\_rows\_r;i++)}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02126}02126 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02127}02127     \textcolor{comment}{// Loop over the bottom half of the complete matrix}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02128}02128     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = n\_rows\_r; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < 2 * n\_rows\_r; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02129}02129     \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02130}02130       \textcolor{comment}{// Calculate the number of nonzeros in row i of A\_r}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02131}02131       \textcolor{keywordtype}{unsigned} i\_row\_r\_nnz =}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02132}02132         *(row\_start\_r\_pt + \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} -\/ n\_rows\_r + 1) -\/ *(row\_start\_r\_pt + \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} -\/ n\_rows\_r);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02133}02133 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02134}02134       \textcolor{comment}{// Calculate the number of nonzeros in row i of A\_c}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02135}02135       \textcolor{keywordtype}{unsigned} i\_row\_c\_nnz =}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02136}02136         *(row\_start\_c\_pt + \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} -\/ n\_rows\_r + 1) -\/ *(row\_start\_c\_pt + \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} -\/ n\_rows\_r);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02137}02137 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02138}02138       \textcolor{comment}{// Get the index of the first entry in the i-\/th row of A\_r}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02139}02139       \textcolor{keywordtype}{unsigned} i\_first\_entry\_r = *(row\_start\_r\_pt + \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} -\/ n\_rows\_r);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02140}02140 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02141}02141       \textcolor{comment}{// Get the index of the first entry in the i-\/th row of A\_c}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02142}02142       \textcolor{keywordtype}{unsigned} i\_first\_entry\_c = *(row\_start\_c\_pt + \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} -\/ n\_rows\_r);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02143}02143 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02144}02144       \textcolor{comment}{// Loop over the number of nonzeros in the row associated with A\_c}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02145}02145       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < i\_row\_c\_nnz; j++)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02146}02146       \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02147}02147         \textcolor{comment}{// Assign the column index of the j-\/th entry in the i-\/th row of A\_c}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02148}02148         \textcolor{comment}{// to the column\_index vector}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02149}02149         column\_index[i\_nnz] = *(column\_index\_c\_pt + i\_first\_entry\_c + j);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02150}02150 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02151}02151         \textcolor{comment}{// Assign the corresponding entry in the value vector}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02152}02152         value[i\_nnz] = *(value\_c\_pt + i\_first\_entry\_c + j);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02153}02153 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02154}02154         \textcolor{comment}{// Increment the value of i\_nnz}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02155}02155         i\_nnz++;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02156}02156       \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02157}02157 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02158}02158       \textcolor{comment}{// Loop over the number of nonzeros in the row associated with A\_r}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02159}02159       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < i\_row\_r\_nnz; j++)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02160}02160       \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02161}02161         \textcolor{comment}{// Assign the column index of the j-\/th entry in the i-\/th row of A\_r}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02162}02162         \textcolor{comment}{// to the column\_index vector}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02163}02163         column\_index[i\_nnz] =}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02164}02164           *(column\_index\_r\_pt + i\_first\_entry\_r + j) + n\_rows\_r;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02165}02165 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02166}02166         \textcolor{comment}{// Assign the corresponding entry in the value vector}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02167}02167         value[i\_nnz] = *(value\_r\_pt + i\_first\_entry\_r + j);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02168}02168 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02169}02169         \textcolor{comment}{// Increment the value of i\_nnz}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02170}02170         i\_nnz++;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02171}02171       \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02172}02172     \} \textcolor{comment}{// for (unsigned i=n\_rows\_r;i<2*n\_rows\_r;i++)}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02173}02173 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02174}02174     \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02175}02175     \textcolor{comment}{// Build the full matrix:}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02176}02176     \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02177}02177 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02178}02178     \textcolor{comment}{// Allocate space for a CRDoubleMatrix}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02179}02179     Coarsest\_matrix\_mg\_pt = \textcolor{keyword}{new} \mbox{\hyperlink{classoomph_1_1CRDoubleMatrix}{CRDoubleMatrix}};}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02180}02180 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02181}02181     \textcolor{comment}{// Make the distribution pointer}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02182}02182     \mbox{\hyperlink{classoomph_1_1LinearAlgebraDistribution}{LinearAlgebraDistribution}}* dist\_pt = \textcolor{keyword}{new} \mbox{\hyperlink{classoomph_1_1LinearAlgebraDistribution}{LinearAlgebraDistribution}}(}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02183}02183       Mg\_hierarchy\_pt[Nlevel -\/ 1]-\/>communicator\_pt(), 2 * n\_rows\_r, \textcolor{keyword}{false});}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02184}02184 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02185}02185     \textcolor{comment}{// First, we need to build the matrix. Making use of its particular}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02186}02186     \textcolor{comment}{// structure we know that there are 2*n\_rows\_r columns in this matrix.}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02187}02187     \textcolor{comment}{// The remaining information has just been sorted out}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02188}02188     Coarsest\_matrix\_mg\_pt-\/>build(}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02189}02189       dist\_pt, 2 * n\_rows\_r, value, column\_index, row\_start);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02190}02190 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02191}02191     \textcolor{comment}{// Build the distribution of associated solution vector}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02192}02192     Coarsest\_x\_mg.build(dist\_pt);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02193}02193 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02194}02194     \textcolor{comment}{// Build the distribution of associated RHS vector}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02195}02195     Coarsest\_rhs\_mg.build(dist\_pt);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02196}02196 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02197}02197     \textcolor{comment}{// Delete the associated distribution pointer}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02198}02198     \textcolor{keyword}{delete} dist\_pt;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02199}02199 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02200}02200     \textcolor{comment}{// Summarise setup}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02201}02201     \textcolor{keywordtype}{double} t\_cm\_end = \mbox{\hyperlink{namespaceoomph_1_1TimingHelpers_a9fb6ad7e2e01b0914e9f7072ef9ebfa6}{TimingHelpers::timer}}();}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02202}02202     \textcolor{keywordtype}{double} total\_setup\_time = double(t\_cm\_end -\/ t\_cm\_start);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02203}02203     \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{} -\/ Time for formation of the full matrix "{}}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02204}02204                << \textcolor{stringliteral}{"{}on the coarsest level [sec]: "{}} << total\_setup\_time << \textcolor{stringliteral}{"{}\(\backslash\)n"{}}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02205}02205                << std::endl;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02206}02206   \} \textcolor{comment}{// End of setup\_coarsest\_matrix\_mg}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02207}02207 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02208}02208 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02209}02209   \textcolor{comment}{//==========================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02210}02210 \textcolor{comment}{  /// Find the value of the parameters h on the level-\/th problem in}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02211}02211 \textcolor{comment}{  /// the hierarchy. The value of h is determined by looping over each element}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02212}02212 \textcolor{comment}{  /// in the mesh and calculating the length of each side and take the maximum}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02213}02213 \textcolor{comment}{  /// value.Note, this is a heuristic calculation; if the mesh is nonuniform}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02214}02214 \textcolor{comment}{  /// or adaptive refinement is used then the value of h, is not the same}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02215}02215 \textcolor{comment}{  /// everywhere so we find the maximum edge width instead. If, however,}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02216}02216 \textcolor{comment}{  /// uniform refinement is used on a uniform mesh (using quad elements) then}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02217}02217 \textcolor{comment}{  /// this will return the correct value of h.}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02218}02218 \textcolor{comment}{  ///}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02219}02219 \textcolor{comment}{  /// This is the explicit template specialisation of the case DIM=2.}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02220}02220 \textcolor{comment}{}  \textcolor{comment}{//==========================================================================}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02221}02221   \textcolor{keyword}{template}<>}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02222}\mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_aebb6b0d6bdc0796ab150818a4790381f}{02222}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_aaf65774e7e6c81e4960fcb451e7434e6}{HelmholtzMGPreconditioner<2>::maximum\_edge\_width}}(\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\& level,}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02223}02223                                                         \textcolor{keywordtype}{double}\& h)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02224}02224   \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02225}02225     \textcolor{comment}{// Create a pointer to the "{}bulk"{} mesh}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02226}02226     \mbox{\hyperlink{classoomph_1_1TreeBasedRefineableMeshBase}{TreeBasedRefineableMeshBase}}* bulk\_mesh\_pt =}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02227}02227       Mg\_hierarchy\_pt[level]-\/>mg\_bulk\_mesh\_pt();}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02228}02228 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02229}02229     \textcolor{comment}{// Reset the value of h}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02230}02230     h = 0.0;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02231}02231 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02232}02232     \textcolor{comment}{// Find out how many nodes there are along one edge of the first element.}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02233}02233     \textcolor{comment}{// We assume here that all elements have the same number of nodes}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02234}02234     \textcolor{keywordtype}{unsigned} nnode\_1d =}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02235}02235       \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}*\textcolor{keyword}{>}(bulk\_mesh\_pt-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a9a5d03afb8730e9459ecbc67c6439143}{element\_pt}}(0))-\/>nnode\_1d();}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02236}02236 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02237}02237     \textcolor{comment}{// Sort out corner node IDs:}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02238}02238     \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02239}02239     \textcolor{comment}{// Initialise a vector to store local node IDs of the corners}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02240}02240     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<unsigned>}} corner\_node\_id(4, 0);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02241}02241 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02242}02242     \textcolor{comment}{// Identify the local node ID of the first corner}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02243}02243     corner\_node\_id[0] = 0;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02244}02244 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02245}02245     \textcolor{comment}{// Identify the local node ID of the second corner}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02246}02246     corner\_node\_id[1] = nnode\_1d -\/ 1;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02247}02247 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02248}02248     \textcolor{comment}{// Identify the local node ID of the third corner}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02249}02249     corner\_node\_id[2] = nnode\_1d * nnode\_1d -\/ 1;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02250}02250 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02251}02251     \textcolor{comment}{// Identify the local node ID of the fourth corner}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02252}02252     corner\_node\_id[3] = nnode\_1d * (nnode\_1d -\/ 1);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02253}02253 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02254}02254     \textcolor{comment}{// Create storage for the nodal information:}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02255}02255     \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02256}02256     \textcolor{comment}{// Pointer to the first corner node on the j-\/th edge}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02257}02257     Node* first\_node\_pt = 0;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02258}02258 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02259}02259     \textcolor{comment}{// Pointer to the second corner node on the j-\/th edge}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02260}02260     Node* second\_node\_pt = 0;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02261}02261 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02262}02262     \textcolor{comment}{// Vector to store the (Eulerian) position of the first corner node}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02263}02263     \textcolor{comment}{// along a given edge of the element}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02264}02264     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} first\_node\_x(2, 0.0);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02265}02265 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02266}02266     \textcolor{comment}{// Vector to store the (Eulerian) position of the second corner node}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02267}02267     \textcolor{comment}{// along a given edge of the element}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02268}02268     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} second\_node\_x(2, 0.0);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02269}02269 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02270}02270     \textcolor{comment}{// Calculate h:}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02271}02271     \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02272}02272     \textcolor{comment}{// Find out how many elements there are in the bulk mesh}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02273}02273     \textcolor{keywordtype}{unsigned} n\_element = bulk\_mesh\_pt-\/>\mbox{\hyperlink{classoomph_1_1Mesh_af01dfefb66c15579b540be62999d93ee}{nelement}}();}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02274}02274 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02275}02275     \textcolor{comment}{// Store a pointer which will point to a given element in the bulk mesh}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02276}02276     \mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}* el\_pt = 0;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02277}02277 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02278}02278     \textcolor{comment}{// Initialise a dummy variable to compare with h}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02279}02279     \textcolor{keywordtype}{double} test\_h = 0.0;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02280}02280 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02281}02281     \textcolor{comment}{// Store the number of edges in a 2D quad element}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02282}02282     \textcolor{keywordtype}{unsigned} n\_edge = 4;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02283}02283 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02284}02284     \textcolor{comment}{// Loop over all of the elements in the bulk mesh}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02285}02285     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < n\_element; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02286}02286     \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02287}02287       \textcolor{comment}{// Upcast the pointer to the i-\/th element to a FiniteElement pointer}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02288}02288       el\_pt = \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}*\textcolor{keyword}{>}(bulk\_mesh\_pt-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a9a5d03afb8730e9459ecbc67c6439143}{element\_pt}}(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}));}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02289}02289 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02290}02290       \textcolor{comment}{// Loop over the edges of the element}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02291}02291       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < n\_edge; j++)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02292}02292       \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02293}02293         \textcolor{comment}{// Get the local node ID of the first corner node on the j-\/th edge}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02294}02294         first\_node\_pt = el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a9addfe893ab8205619963aa96204cdc4}{node\_pt}}(corner\_node\_id[j]);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02295}02295 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02296}02296         \textcolor{comment}{// Get the local node ID of the second corner node on the j-\/th edge}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02297}02297         second\_node\_pt = el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a9addfe893ab8205619963aa96204cdc4}{node\_pt}}(corner\_node\_id[(j + 1) \% 4]);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02298}02298 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02299}02299         \textcolor{comment}{// Obtain the (Eulerian) position of the first corner node}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02300}02300         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} n = 0; n < 2; n++)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02301}02301         \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02302}02302           \textcolor{comment}{// Grab the n-\/th coordinate of this node}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02303}02303           first\_node\_x[n] = first\_node\_pt-\/>x(n);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02304}02304         \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02305}02305 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02306}02306         \textcolor{comment}{// Obtain the (Eulerian) position of the second corner node}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02307}02307         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} n = 0; n < 2; n++)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02308}02308         \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02309}02309           \textcolor{comment}{// Grab the n-\/th coordinate of this node}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02310}02310           second\_node\_x[n] = second\_node\_pt-\/>x(n);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02311}02311         \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02312}02312 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02313}02313         \textcolor{comment}{// Reset the value of test\_h}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02314}02314         test\_h = 0.0;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02315}02315 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02316}02316         \textcolor{comment}{// Calculate the norm of (second\_node\_x-\/first\_node\_x)}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02317}02317         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} n = 0; n < 2; n++)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02318}02318         \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02319}02319           \textcolor{comment}{// Update the value of test\_h}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02320}02320           test\_h += pow(second\_node\_x[n] -\/ first\_node\_x[n], 2.0);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02321}02321         \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02322}02322 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02323}02323         \textcolor{comment}{// Square root the value of h}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02324}02324         test\_h = sqrt(test\_h);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02325}02325 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02326}02326         \textcolor{comment}{// Check if the value of test\_h is greater than h}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02327}02327         \textcolor{keywordflow}{if} (test\_h > h)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02328}02328         \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02329}02329           \textcolor{comment}{// If the value of test\_h is greater than h then store it}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02330}02330           h = test\_h;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02331}02331         \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02332}02332       \} \textcolor{comment}{// for (unsigned j=0;j<n\_edge;j++)}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02333}02333     \} \textcolor{comment}{// for (unsigned i=0;i<n\_element;i++)}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02334}02334   \} \textcolor{comment}{// End of maximum\_edge\_width}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02335}02335 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02336}02336   \textcolor{comment}{//==========================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02337}02337 \textcolor{comment}{  /// Find the value of the parameters h on the level-\/th problem in}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02338}02338 \textcolor{comment}{  /// the hierarchy. The value of h is determined by looping over each element}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02339}02339 \textcolor{comment}{  /// in the mesh and calculating the length of each side and take the maximum}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02340}02340 \textcolor{comment}{  /// value. Note, this is a heuristic calculation; if the mesh is non-\/uniform}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02341}02341 \textcolor{comment}{  /// or adaptive refinement is used then the value of h, is not the same}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02342}02342 \textcolor{comment}{  /// everywhere so we find the maximum edge width instead. If, however,}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02343}02343 \textcolor{comment}{  /// uniform refinement is used on a uniform mesh (using quad elements) then}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02344}02344 \textcolor{comment}{  /// this will return the correct value of h.}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02345}02345 \textcolor{comment}{  ///}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02346}02346 \textcolor{comment}{  /// This is the explicit template specialisation of the case DIM=3. The}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02347}02347 \textcolor{comment}{  /// calculation of h is different here. In 2D we were able to loop over}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02348}02348 \textcolor{comment}{  /// each pair of nodes in an anti-\/clockwise manner since the only node}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02349}02349 \textcolor{comment}{  /// pairs were \{(C0,C1),(C1,C2),(C2,C3),(C3,C0)\} where CN denotes the N-\/th}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02350}02350 \textcolor{comment}{  /// corner in the element. In 3D this method cannot be used since we have}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02351}02351 \textcolor{comment}{  /// 12 edges to consider.}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02352}02352 \textcolor{comment}{}  \textcolor{comment}{//==========================================================================}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02353}02353   \textcolor{keyword}{template}<>}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02354}\mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a36fb9f013bdf8454e112b785c5afa30e}{02354}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_aaf65774e7e6c81e4960fcb451e7434e6}{HelmholtzMGPreconditioner<3>::maximum\_edge\_width}}(\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\& level,}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02355}02355                                                         \textcolor{keywordtype}{double}\& h)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02356}02356   \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02357}02357     \textcolor{comment}{// Create a pointer to the "{}bulk"{} mesh}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02358}02358     \mbox{\hyperlink{classoomph_1_1TreeBasedRefineableMeshBase}{TreeBasedRefineableMeshBase}}* bulk\_mesh\_pt =}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02359}02359       Mg\_hierarchy\_pt[level]-\/>mg\_bulk\_mesh\_pt();}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02360}02360 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02361}02361     \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02362}02362     \textcolor{comment}{// Find the maximum edge width, h:}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02363}02363     \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02364}02364     \textcolor{comment}{// Reset the value of h}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02365}02365     h = 0.0;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02366}02366 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02367}02367     \textcolor{comment}{// Find out how many nodes there are along one edge of the first element.}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02368}02368     \textcolor{comment}{// We assume here that all elements have the same number of nodes}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02369}02369     \textcolor{keywordtype}{unsigned} nnode\_1d =}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02370}02370       \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}*\textcolor{keyword}{>}(bulk\_mesh\_pt-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a9a5d03afb8730e9459ecbc67c6439143}{element\_pt}}(0))-\/>nnode\_1d();}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02371}02371 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02372}02372     \textcolor{comment}{// Sort out corner node IDs:}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02373}02373     \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02374}02374     \textcolor{comment}{// Grab the octree pointer from the first element in the bulk mesh}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02375}02375     \mbox{\hyperlink{classoomph_1_1OcTree}{OcTree}}* octree\_pt =}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02376}02376       \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1RefineableQElement_3_013_01_4}{RefineableQElement<3>}}*\textcolor{keyword}{>}(bulk\_mesh\_pt-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a9a5d03afb8730e9459ecbc67c6439143}{element\_pt}}(0))}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02377}02377         -\/>octree\_pt();}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02378}02378 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02379}02379     \textcolor{comment}{// Initialise a vector to store local node IDs of the corners}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02380}02380     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<unsigned>}} corner\_node\_id(8, 0);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02381}02381 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02382}02382     \textcolor{comment}{// Identify the local node ID of the first corner}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02383}02383     corner\_node\_id[0] =}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02384}02384       octree\_pt-\/>\mbox{\hyperlink{classoomph_1_1OcTree_af2a129b95ad303ed340bb8bd86e05384}{vertex\_to\_node\_number}}(\mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40abed39d2cabdadba8a0746381691ccf77}{OcTreeNames::LDB}}, nnode\_1d);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02385}02385 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02386}02386     \textcolor{comment}{// Identify the local node ID of the second corner}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02387}02387     corner\_node\_id[1] =}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02388}02388       octree\_pt-\/>\mbox{\hyperlink{classoomph_1_1OcTree_af2a129b95ad303ed340bb8bd86e05384}{vertex\_to\_node\_number}}(\mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a8f4fba3e9fa2aa0c76ec6bb85fe89e1b}{OcTreeNames::RDB}}, nnode\_1d);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02389}02389 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02390}02390     \textcolor{comment}{// Identify the local node ID of the third corner}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02391}02391     corner\_node\_id[2] =}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02392}02392       octree\_pt-\/>\mbox{\hyperlink{classoomph_1_1OcTree_af2a129b95ad303ed340bb8bd86e05384}{vertex\_to\_node\_number}}(\mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a9717fc1b8f4e28fe7271b90dba57802d}{OcTreeNames::LUB}}, nnode\_1d);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02393}02393 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02394}02394     \textcolor{comment}{// Identify the local node ID of the fourth corner}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02395}02395     corner\_node\_id[3] =}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02396}02396       octree\_pt-\/>\mbox{\hyperlink{classoomph_1_1OcTree_af2a129b95ad303ed340bb8bd86e05384}{vertex\_to\_node\_number}}(\mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a4876386f3bfaed6e524e2a251945b57d}{OcTreeNames::RUB}}, nnode\_1d);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02397}02397 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02398}02398     \textcolor{comment}{// Identify the local node ID of the fifth corner}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02399}02399     corner\_node\_id[4] =}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02400}02400       octree\_pt-\/>\mbox{\hyperlink{classoomph_1_1OcTree_af2a129b95ad303ed340bb8bd86e05384}{vertex\_to\_node\_number}}(\mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a7bf18855ab002d44e301413456917d9c}{OcTreeNames::LDF}}, nnode\_1d);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02401}02401 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02402}02402     \textcolor{comment}{// Identify the local node ID of the sixth corner}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02403}02403     corner\_node\_id[5] =}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02404}02404       octree\_pt-\/>\mbox{\hyperlink{classoomph_1_1OcTree_af2a129b95ad303ed340bb8bd86e05384}{vertex\_to\_node\_number}}(\mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a172055f90c2c767808f297a31c9844be}{OcTreeNames::RDF}}, nnode\_1d);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02405}02405 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02406}02406     \textcolor{comment}{// Identify the local node ID of the seventh corner}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02407}02407     corner\_node\_id[6] =}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02408}02408       octree\_pt-\/>\mbox{\hyperlink{classoomph_1_1OcTree_af2a129b95ad303ed340bb8bd86e05384}{vertex\_to\_node\_number}}(\mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a6357637fc339bbb6745b6b5ce101b45a}{OcTreeNames::LUF}}, nnode\_1d);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02409}02409 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02410}02410     \textcolor{comment}{// Identify the local node ID of the eighth corner}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02411}02411     corner\_node\_id[7] =}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02412}02412       octree\_pt-\/>\mbox{\hyperlink{classoomph_1_1OcTree_af2a129b95ad303ed340bb8bd86e05384}{vertex\_to\_node\_number}}(\mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a9db7ad20ea4f76808cd9cf026229bcdc}{OcTreeNames::RUF}}, nnode\_1d);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02413}02413 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02414}02414     \textcolor{comment}{// Sort out the local node ID pairs:}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02415}02415     \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02416}02416     \textcolor{comment}{// Store the number of edges in a 3D cubic element}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02417}02417     \textcolor{keywordtype}{unsigned} n\_edge = 12;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02418}02418 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02419}02419     \textcolor{comment}{// Create a vector to store the pairs of adjacent nodes}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02420}02420     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<std::pair<unsigned, unsigned>}}> edge\_node\_pair(n\_edge);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02421}02421 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02422}02422     \textcolor{comment}{// First edge}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02423}02423     edge\_node\_pair[0] = std::make\_pair(corner\_node\_id[0], corner\_node\_id[1]);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02424}02424 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02425}02425     \textcolor{comment}{// Second edge}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02426}02426     edge\_node\_pair[1] = std::make\_pair(corner\_node\_id[0], corner\_node\_id[2]);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02427}02427 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02428}02428     \textcolor{comment}{// Third edge}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02429}02429     edge\_node\_pair[2] = std::make\_pair(corner\_node\_id[0], corner\_node\_id[4]);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02430}02430 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02431}02431     \textcolor{comment}{// Fourth edge}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02432}02432     edge\_node\_pair[3] = std::make\_pair(corner\_node\_id[1], corner\_node\_id[3]);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02433}02433 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02434}02434     \textcolor{comment}{// Fifth edge}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02435}02435     edge\_node\_pair[4] = std::make\_pair(corner\_node\_id[1], corner\_node\_id[5]);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02436}02436 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02437}02437     \textcolor{comment}{// Sixth edge}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02438}02438     edge\_node\_pair[5] = std::make\_pair(corner\_node\_id[2], corner\_node\_id[3]);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02439}02439 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02440}02440     \textcolor{comment}{// Seventh edge}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02441}02441     edge\_node\_pair[6] = std::make\_pair(corner\_node\_id[2], corner\_node\_id[6]);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02442}02442 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02443}02443     \textcolor{comment}{// Eighth edge}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02444}02444     edge\_node\_pair[7] = std::make\_pair(corner\_node\_id[3], corner\_node\_id[7]);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02445}02445 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02446}02446     \textcolor{comment}{// Ninth edge}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02447}02447     edge\_node\_pair[8] = std::make\_pair(corner\_node\_id[4], corner\_node\_id[5]);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02448}02448 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02449}02449     \textcolor{comment}{// Tenth edge}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02450}02450     edge\_node\_pair[9] = std::make\_pair(corner\_node\_id[4], corner\_node\_id[6]);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02451}02451 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02452}02452     \textcolor{comment}{// Eleventh edge}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02453}02453     edge\_node\_pair[10] = std::make\_pair(corner\_node\_id[5], corner\_node\_id[7]);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02454}02454 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02455}02455     \textcolor{comment}{// Twelfth edge}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02456}02456     edge\_node\_pair[11] = std::make\_pair(corner\_node\_id[6], corner\_node\_id[7]);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02457}02457 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02458}02458     \textcolor{comment}{// Create storage for the nodal information:}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02459}02459     \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02460}02460     \textcolor{comment}{// Pointer to the first corner node on the j-\/th edge}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02461}02461     Node* first\_node\_pt = 0;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02462}02462 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02463}02463     \textcolor{comment}{// Pointer to the second corner node on the j-\/th edge}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02464}02464     Node* second\_node\_pt = 0;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02465}02465 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02466}02466     \textcolor{comment}{// Vector to store the (Eulerian) position of the first corner node}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02467}02467     \textcolor{comment}{// along a given edge of the element}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02468}02468     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} first\_node\_x(3, 0.0);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02469}02469 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02470}02470     \textcolor{comment}{// Vector to store the (Eulerian) position of the second corner node}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02471}02471     \textcolor{comment}{// along a given edge of the element}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02472}02472     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} second\_node\_x(3, 0.0);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02473}02473 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02474}02474     \textcolor{comment}{// Calculate h:}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02475}02475     \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02476}02476     \textcolor{comment}{// Find out how many elements there are in the bulk mesh}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02477}02477     \textcolor{keywordtype}{unsigned} n\_element = bulk\_mesh\_pt-\/>\mbox{\hyperlink{classoomph_1_1Mesh_af01dfefb66c15579b540be62999d93ee}{nelement}}();}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02478}02478 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02479}02479     \textcolor{comment}{// Store a pointer which will point to a given element in the bulk mesh}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02480}02480     \mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}* el\_pt = 0;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02481}02481 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02482}02482     \textcolor{comment}{// Initialise a dummy variable to compare with h}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02483}02483     \textcolor{keywordtype}{double} test\_h = 0.0;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02484}02484 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02485}02485     \textcolor{comment}{// Loop over all of the elements in the bulk mesh}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02486}02486     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < n\_element; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02487}02487     \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02488}02488       \textcolor{comment}{// Upcast the pointer to the i-\/th element to a FiniteElement pointer}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02489}02489       el\_pt = \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}*\textcolor{keyword}{>}(bulk\_mesh\_pt-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a9a5d03afb8730e9459ecbc67c6439143}{element\_pt}}(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}));}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02490}02490 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02491}02491       \textcolor{comment}{// Loop over the edges of the element}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02492}02492       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < n\_edge; j++)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02493}02493       \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02494}02494         \textcolor{comment}{// Get the local node ID of the first corner node on the j-\/th edge}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02495}02495         first\_node\_pt = el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a9addfe893ab8205619963aa96204cdc4}{node\_pt}}(edge\_node\_pair[j].first);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02496}02496 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02497}02497         \textcolor{comment}{// Get the local node ID of the second corner node on the j-\/th edge}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02498}02498         second\_node\_pt = el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a9addfe893ab8205619963aa96204cdc4}{node\_pt}}(edge\_node\_pair[j].second);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02499}02499 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02500}02500         \textcolor{comment}{// Obtain the (Eulerian) position of the first corner node}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02501}02501         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} n = 0; n < 3; n++)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02502}02502         \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02503}02503           \textcolor{comment}{// Grab the n-\/th coordinate of this node}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02504}02504           first\_node\_x[n] = first\_node\_pt-\/>x(n);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02505}02505         \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02506}02506 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02507}02507         \textcolor{comment}{// Obtain the (Eulerian) position of the second corner node}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02508}02508         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} n = 0; n < 3; n++)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02509}02509         \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02510}02510           \textcolor{comment}{// Grab the n-\/th coordinate of this node}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02511}02511           second\_node\_x[n] = second\_node\_pt-\/>x(n);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02512}02512         \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02513}02513 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02514}02514         \textcolor{comment}{// Reset the value of test\_h}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02515}02515         test\_h = 0.0;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02516}02516 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02517}02517         \textcolor{comment}{// Calculate the norm of (second\_node\_x-\/first\_node\_x)}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02518}02518         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} n = 0; n < 3; n++)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02519}02519         \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02520}02520           \textcolor{comment}{// Update the value of test\_h}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02521}02521           test\_h += pow(second\_node\_x[n] -\/ first\_node\_x[n], 2.0);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02522}02522         \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02523}02523 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02524}02524         \textcolor{comment}{// Square root the value of h}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02525}02525         test\_h = sqrt(test\_h);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02526}02526 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02527}02527         \textcolor{comment}{// Check if the value of test\_h is greater than h}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02528}02528         \textcolor{keywordflow}{if} (test\_h > h)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02529}02529         \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02530}02530           \textcolor{comment}{// If the value of test\_h is greater than h then store it}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02531}02531           h = test\_h;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02532}02532         \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02533}02533       \} \textcolor{comment}{// for (unsigned j=0;j<n\_edge;j++)}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02534}02534     \} \textcolor{comment}{// for (unsigned i=0;i<n\_element;i++)}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02535}02535   \} \textcolor{comment}{// End of maximum\_edge\_width}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02536}02536 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02537}02537   \textcolor{comment}{//=========================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02538}02538 \textcolor{comment}{  /// Set up the smoothers on all levels}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02539}02539 \textcolor{comment}{}  \textcolor{comment}{//=========================================================================}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02540}02540   \textcolor{keyword}{template}<\textcolor{keywordtype}{unsigned} DIM>}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02541}\mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a8e6345b2fd41602dd6a91e9bcecf718c}{02541}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a8e6345b2fd41602dd6a91e9bcecf718c}{HelmholtzMGPreconditioner<DIM>::setup\_smoothers}}()}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02542}02542   \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02543}02543     \textcolor{comment}{// Initialise the timer start variable}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02544}02544     \textcolor{keywordtype}{double} t\_m\_start = 0.0;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02545}02545 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02546}02546     \textcolor{comment}{// Start the clock (if we're allowed to time things)}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02547}02547     \textcolor{keywordflow}{if} (!Suppress\_all\_output)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02548}02548     \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02549}02549       \textcolor{comment}{// Notify user}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02550}02550       \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{}Starting the setup of all smoothers.\(\backslash\)n"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02551}02551 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02552}02552       \textcolor{comment}{// Start the clock}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02553}02553       t\_m\_start = \mbox{\hyperlink{namespaceoomph_1_1TimingHelpers_a9fb6ad7e2e01b0914e9f7072ef9ebfa6}{TimingHelpers::timer}}();}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02554}02554     \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02555}02555 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02556}02556     \textcolor{comment}{// Loop over the levels and assign the pre-\/ and post-\/smoother pointers}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02557}02557     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < Nlevel -\/ 1; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02558}02558     \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02559}02559       \textcolor{comment}{// If the pre-\/smoother factory function pointer hasn't been assigned}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02560}02560       \textcolor{comment}{// then we simply create a new instance of the ComplexDampedJacobi}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02561}02561       \textcolor{comment}{// smoother which is the default pre-\/smoother}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02562}02562       \textcolor{keywordflow}{if} (0 == Pre\_smoother\_factory\_function\_pt)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02563}02563       \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02564}02564         \textcolor{comment}{// If the value of kh is strictly less than 0.5 then use damped Jacobi}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02565}02565         \textcolor{comment}{// as a smoother on this level otherwise use complex GMRES as a smoother}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02566}02566         \textcolor{comment}{// [see Elman et al."{}A multigrid method enhanced by Krylov subspace}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02567}02567         \textcolor{comment}{// iteration for discrete Helmholtz equations"{}, p.1305]}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02568}02568         \textcolor{keywordflow}{if} (Wavenumber * Max\_edge\_width[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] < 0.5)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02569}02569         \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02570}02570           \textcolor{comment}{// Make a new ComplexDampedJacobi object and assign its pointer}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02571}02571           \mbox{\hyperlink{classoomph_1_1ComplexDampedJacobi}{ComplexDampedJacobi<CRDoubleMatrix>}}* damped\_jacobi\_pt =}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02572}02572             \textcolor{keyword}{new} \mbox{\hyperlink{classoomph_1_1ComplexDampedJacobi}{ComplexDampedJacobi<CRDoubleMatrix>}};}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02573}02573 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02574}02574           \textcolor{comment}{// Assign the pre-\/smoother pointer}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02575}02575           Pre\_smoothers\_storage\_pt[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] = damped\_jacobi\_pt;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02576}02576 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02577}02577           \textcolor{comment}{// Make the smoother calculate the value of omega and store it}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02578}02578           damped\_jacobi\_pt-\/>\mbox{\hyperlink{classoomph_1_1ComplexDampedJacobi_af7a53121690e157bdd5bc191a31f9892}{calculate\_omega}}(Wavenumber, Max\_edge\_width[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02579}02579         \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02580}02580         \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02581}02581         \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02582}02582           \textcolor{comment}{// Make a new ComplexGMRES object and assign its pointer}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02583}02583           \mbox{\hyperlink{classoomph_1_1ComplexGMRES}{ComplexGMRES<CRDoubleMatrix>}}* gmres\_pt =}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02584}02584             \textcolor{keyword}{new} \mbox{\hyperlink{classoomph_1_1ComplexGMRES}{ComplexGMRES<CRDoubleMatrix>}};}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02585}02585 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02586}02586           \textcolor{comment}{// Assign the pre-\/smoother pointer}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02587}02587           Pre\_smoothers\_storage\_pt[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] = gmres\_pt;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02588}02588         \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02589}02589       \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02590}02590       \textcolor{comment}{// Otherwise we use the pre-\/smoother factory function pointer to}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02591}02591       \textcolor{comment}{// generate a new pre-\/smoother}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02592}02592       \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02593}02593       \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02594}02594         \textcolor{comment}{// Get a pointer to an object of the same type as the pre-\/smoother}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02595}02595         Pre\_smoothers\_storage\_pt[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] = (*Pre\_smoother\_factory\_function\_pt)();}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02596}02596       \} \textcolor{comment}{// if (0==Pre\_smoother\_factory\_function\_pt)}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02597}02597 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02598}02598       \textcolor{comment}{// If the post-\/smoother factory function pointer hasn't been assigned}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02599}02599       \textcolor{comment}{// then we simply create a new instance of the ComplexDampedJacobi}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02600}02600       \textcolor{comment}{// smoother which is the default post-\/smoother}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02601}02601       \textcolor{keywordflow}{if} (0 == Post\_smoother\_factory\_function\_pt)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02602}02602       \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02603}02603         \textcolor{comment}{// If the value of kh is strictly less than 0.52 then use damped Jacobi}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02604}02604         \textcolor{comment}{// as a smoother on this level otherwise use complex GMRES as a smoother}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02605}02605         \textcolor{comment}{// [see Elman et al."{}A multigrid method enhanced by Krylov subspace}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02606}02606         \textcolor{comment}{// iteration for discrete Helmholtz equations"{}, p.1295]}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02607}02607         \textcolor{keywordflow}{if} (Wavenumber * Max\_edge\_width[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] < 0.5)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02608}02608         \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02609}02609           \textcolor{comment}{// Make a new ComplexDampedJacobi object and assign its pointer}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02610}02610           \mbox{\hyperlink{classoomph_1_1ComplexDampedJacobi}{ComplexDampedJacobi<CRDoubleMatrix>}}* damped\_jacobi\_pt =}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02611}02611             \textcolor{keyword}{new} \mbox{\hyperlink{classoomph_1_1ComplexDampedJacobi}{ComplexDampedJacobi<CRDoubleMatrix>}};}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02612}02612 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02613}02613           \textcolor{comment}{// Assign the pre-\/smoother pointer}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02614}02614           Post\_smoothers\_storage\_pt[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] = damped\_jacobi\_pt;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02615}02615 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02616}02616           \textcolor{comment}{// Make the smoother calculate the value of omega and store it}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02617}02617           damped\_jacobi\_pt-\/>\mbox{\hyperlink{classoomph_1_1ComplexDampedJacobi_af7a53121690e157bdd5bc191a31f9892}{calculate\_omega}}(Wavenumber, Max\_edge\_width[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02618}02618         \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02619}02619         \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02620}02620         \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02621}02621           \textcolor{comment}{// Make a new ComplexGMRES object and assign its pointer}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02622}02622           \mbox{\hyperlink{classoomph_1_1ComplexGMRES}{ComplexGMRES<CRDoubleMatrix>}}* gmres\_pt =}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02623}02623             \textcolor{keyword}{new} \mbox{\hyperlink{classoomph_1_1ComplexGMRES}{ComplexGMRES<CRDoubleMatrix>}};}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02624}02624 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02625}02625           \textcolor{comment}{// Assign the pre-\/smoother pointer}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02626}02626           Post\_smoothers\_storage\_pt[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] = gmres\_pt;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02627}02627         \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02628}02628       \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02629}02629       \textcolor{comment}{// Otherwise we use the post-\/smoother factory function pointer to}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02630}02630       \textcolor{comment}{// generate a new post-\/smoother}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02631}02631       \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02632}02632       \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02633}02633         \textcolor{comment}{// Get a pointer to an object of the same type as the post-\/smoother}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02634}02634         Post\_smoothers\_storage\_pt[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] = (*Post\_smoother\_factory\_function\_pt)();}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02635}02635       \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02636}02636     \} \textcolor{comment}{// if (0==Post\_smoother\_factory\_function\_pt)}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02637}02637 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02638}02638     \textcolor{comment}{// Set the tolerance for the pre-\/ and post-\/smoothers. The norm of the}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02639}02639     \textcolor{comment}{// solution which is compared against the tolerance is calculated}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02640}02640     \textcolor{comment}{// differently to the multigrid solver. To ensure that the smoother}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02641}02641     \textcolor{comment}{// continues to solve for the prescribed number of iterations we}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02642}02642     \textcolor{comment}{// lower the tolerance}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02643}02643     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < Nlevel -\/ 1; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02644}02644     \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02645}02645       \textcolor{comment}{// Set the tolerance of the i-\/th level pre-\/smoother}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02646}02646       Pre\_smoothers\_storage\_pt[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]-\/>\mbox{\hyperlink{classoomph_1_1IterativeLinearSolver_a7be3c4ea16f1fc9b397e7c87eae253d8}{tolerance}}() = 1.0e-\/16;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02647}02647 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02648}02648       \textcolor{comment}{// Set the tolerance of the i-\/th level post-\/smoother}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02649}02649       Post\_smoothers\_storage\_pt[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]-\/>tolerance() = 1.0e-\/16;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02650}02650     \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02651}02651 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02652}02652     \textcolor{comment}{// Set the number of pre-\/ and post-\/smoothing iterations in each}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02653}02653     \textcolor{comment}{// pre-\/ and post-\/smoother}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02654}02654     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < Nlevel -\/ 1; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02655}02655     \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02656}02656       \textcolor{comment}{// Set the number of pre-\/smoothing iterations as the value of Npre\_smooth}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02657}02657       Pre\_smoothers\_storage\_pt[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]-\/>max\_iter() = Npre\_smooth;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02658}02658 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02659}02659       \textcolor{comment}{// Set the number of pre-\/smoothing iterations as the value of Npost\_smooth}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02660}02660       Post\_smoothers\_storage\_pt[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]-\/>max\_iter() = Npost\_smooth;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02661}02661     \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02662}02662 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02663}02663     \textcolor{comment}{// Complete the setup of all of the smoothers}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02664}02664     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < Nlevel -\/ 1; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02665}02665     \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02666}02666       \textcolor{comment}{// Pass a pointer to the system matrix on the i-\/th level to the i-\/th}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02667}02667       \textcolor{comment}{// level pre-\/smoother}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02668}02668       Pre\_smoothers\_storage\_pt[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]-\/>complex\_smoother\_setup(}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02669}02669         Mg\_matrices\_storage\_pt[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02670}02670 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02671}02671       \textcolor{comment}{// Pass a pointer to the system matrix on the i-\/th level to the i-\/th}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02672}02672       \textcolor{comment}{// level post-\/smoother}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02673}02673       Post\_smoothers\_storage\_pt[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]-\/>complex\_smoother\_setup(}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02674}02674         Mg\_matrices\_storage\_pt[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02675}02675     \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02676}02676 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02677}02677     \textcolor{comment}{// Set up the distributions of each smoother}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02678}02678     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < Nlevel -\/ 1; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02679}02679     \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02680}02680       \textcolor{comment}{// Get the number of dofs on the i-\/th level of the hierarchy.}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02681}02681       \textcolor{comment}{// This will be the same as the size of the solution vector}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02682}02682       \textcolor{comment}{// associated with the i-\/th level}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02683}02683       \textcolor{keywordtype}{unsigned} n\_dof = X\_mg\_vectors\_storage[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}][0].nrow();}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02684}02684 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02685}02685       \textcolor{comment}{// Create a LinearAlgebraDistribution which will be passed to the}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02686}02686       \textcolor{comment}{// linear solver}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02687}02687       \mbox{\hyperlink{classoomph_1_1LinearAlgebraDistribution}{LinearAlgebraDistribution}} dist(}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02688}02688         Mg\_hierarchy\_pt[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]-\/>communicator\_pt(), n\_dof, \textcolor{keyword}{false});}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02689}02689 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02690}02690 \textcolor{preprocessor}{\#ifdef PARANOID}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02691}02691 \textcolor{preprocessor}{\#ifdef OOMPH\_HAS\_MPI}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02692}02692       \textcolor{comment}{// Set up the warning messages}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02693}02693       \mbox{\hyperlink{namespaceoomph_1_1Global__string__for__annotation_ac5379de2fa7fe44f2cb31785fc208135}{std::string}} warning\_message =}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02694}02694         \textcolor{stringliteral}{"{}Setup of pre-\/ and post-\/smoother distribution "{}};}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02695}02695       warning\_message += \textcolor{stringliteral}{"{}has not been tested with MPI."{}};}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02696}02696 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02697}02697       \textcolor{comment}{// If we're not running the code in serial}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02698}02698       \textcolor{keywordflow}{if} (dist.\mbox{\hyperlink{classoomph_1_1LinearAlgebraDistribution_a2760847d45ab334f6d902efc2620b615}{communicator\_pt}}()-\/>nproc() > 1)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02699}02699       \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02700}02700         \textcolor{comment}{// Throw a warning}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02701}02701         \mbox{\hyperlink{classoomph_1_1OomphLibWarning}{OomphLibWarning}}(}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02702}02702           warning\_message, OOMPH\_CURRENT\_FUNCTION, OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02703}02703       \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02704}02704 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02705}02705 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02706}02706 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02707}02707       \textcolor{comment}{// Build the distribution of the pre-\/smoother}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02708}02708       Pre\_smoothers\_storage\_pt[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]-\/>build\_distribution(dist);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02709}02709 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02710}02710       \textcolor{comment}{// Build the distribution of the post-\/smoother}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02711}02711       Post\_smoothers\_storage\_pt[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]-\/>build\_distribution(dist);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02712}02712     \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02713}02713 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02714}02714     \textcolor{comment}{// Disable the smoother output}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02715}02715     \textcolor{keywordflow}{if} (!Doc\_time)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02716}02716     \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02717}02717       \textcolor{comment}{// Disable time documentation from the smoothers and the SuperLU linear}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02718}02718       \textcolor{comment}{// solver (this latter is only done on the coarsest level where it is}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02719}02719       \textcolor{comment}{// required)}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02720}02720       disable\_smoother\_and\_superlu\_doc\_time();}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02721}02721     \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02722}02722 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02723}02723     \textcolor{comment}{// If we're allowed to output}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02724}02724     \textcolor{keywordflow}{if} (!Suppress\_all\_output)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02725}02725     \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02726}02726       \textcolor{comment}{// Stop clock}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02727}02727       \textcolor{keywordtype}{double} t\_m\_end = \mbox{\hyperlink{namespaceoomph_1_1TimingHelpers_a9fb6ad7e2e01b0914e9f7072ef9ebfa6}{TimingHelpers::timer}}();}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02728}02728       \textcolor{keywordtype}{double} total\_setup\_time = double(t\_m\_end -\/ t\_m\_start);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02729}02729       \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{}CPU time for setup of smoothers on all levels [sec]: "{}}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02730}02730                  << total\_setup\_time << std::endl;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02731}02731 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02732}02732       \textcolor{comment}{// Notify user that the extraction is complete}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02733}02733       \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{}\(\backslash\)n=================="{}}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02734}02734                  << \textcolor{stringliteral}{"{}Smoother Setup Complete"{}}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02735}02735                  << \textcolor{stringliteral}{"{}================="{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02736}02736     \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02737}02737   \} \textcolor{comment}{// End of setup\_smoothers}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02738}02738 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02739}02739 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02740}02740   \textcolor{comment}{//===================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02741}02741 \textcolor{comment}{  /// Set up the interpolation matrices}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02742}02742 \textcolor{comment}{}  \textcolor{comment}{//===================================================================}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02743}02743   \textcolor{keyword}{template}<\textcolor{keywordtype}{unsigned} DIM>}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02744}\mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a5df19abf7f40f713d709273843260bab}{02744}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a5df19abf7f40f713d709273843260bab}{HelmholtzMGPreconditioner<DIM>::setup\_interpolation\_matrices}}()}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02745}02745   \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02746}02746     \textcolor{comment}{// Variable to hold the number of sons in an element}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02747}02747     \textcolor{keywordtype}{unsigned} n\_sons;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02748}02748 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02749}02749     \textcolor{comment}{// Number of son elements}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02750}02750     \textcolor{keywordflow}{if} (DIM == 2)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02751}02751     \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02752}02752       n\_sons = 4;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02753}02753     \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02754}02754     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (DIM == 3)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02755}02755     \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02756}02756       n\_sons = 8;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02757}02757     \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02758}02758     \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02759}02759     \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02760}02760       std::ostringstream error\_message\_stream;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02761}02761       error\_message\_stream << \textcolor{stringliteral}{"{}DIM should be 2 or 3 not "{}} << DIM << std::endl;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02762}02762       \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(error\_message\_stream.str(),}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02763}02763                           OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02764}02764                           OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02765}02765     \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02766}02766 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02767}02767 \textcolor{preprocessor}{\#ifdef PARANOID}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02768}02768     \textcolor{comment}{// PARANOID check -\/ for our implementation we demand that the first}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02769}02769     \textcolor{comment}{// submesh is the refineable bulk mesh that is provided by the function}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02770}02770     \textcolor{comment}{// mg\_bulk\_mesh\_pt. Since each mesh in the hierarchy will be set up}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02771}02771     \textcolor{comment}{// in the same manner through the problem constructor we only needed}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02772}02772     \textcolor{comment}{// to check the finest level mesh}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02773}02773     \textcolor{keywordflow}{if} (Mg\_hierarchy\_pt[0]-\/>mesh\_pt(0) != Mg\_hierarchy\_pt[0]-\/>mg\_bulk\_mesh\_pt())}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02774}02774     \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02775}02775       \textcolor{comment}{// Create an output stream}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02776}02776       std::ostringstream error\_message\_stream;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02777}02777 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02778}02778       \textcolor{comment}{// Create the error message}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02779}02779       error\_message\_stream << \textcolor{stringliteral}{"{}MG solver requires the first submesh be the "{}}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02780}02780                            << \textcolor{stringliteral}{"{}refineable bulk mesh provided by the user."{}}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02781}02781                            << std::endl;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02782}02782 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02783}02783       \textcolor{comment}{// Throw the error message}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02784}02784       \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(error\_message\_stream.str(),}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02785}02785                           OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02786}02786                           OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02787}02787     \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02788}02788 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02789}02789 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02790}02790     \textcolor{comment}{// Vector of local coordinates in the element}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02791}02791     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}(DIM, 0.0);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02792}02792 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02793}02793     \textcolor{comment}{// Vector to contain the (Eulerian) spatial location of the fine node.}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02794}02794     \textcolor{comment}{// This will only be used if we have a PML layer attached to the mesh}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02795}02795     \textcolor{comment}{// which will require the use of locate\_zeta functionality}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02796}02796     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} fine\_node\_position(DIM, 0.0);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02797}02797 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02798}02798     \textcolor{comment}{// Find the number of nodes in an element in the mesh. Since this}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02799}02799     \textcolor{comment}{// quantity will be the same in all meshes we can precompute it here}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02800}02800     \textcolor{comment}{// using the original problem pointer}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02801}02801     \textcolor{keywordtype}{unsigned} nnod\_element =}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02802}02802       \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}*\textcolor{keyword}{>}(Mg\_problem\_pt-\/>mesh\_pt()-\/>element\_pt(0))}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02803}02803         -\/>nnode();}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02804}02804 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02805}02805     \textcolor{comment}{// Initialise a null pointer which will be used to point to an object}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02806}02806     \textcolor{comment}{// of the class MeshAsGeomObject}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02807}02807     \mbox{\hyperlink{classoomph_1_1MeshAsGeomObject}{MeshAsGeomObject}}* coarse\_mesh\_from\_obj\_pt = 0;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02808}02808 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02809}02809     \textcolor{comment}{// Loop over each level (apart from the coarsest level; an interpolation}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02810}02810     \textcolor{comment}{// matrix and thus a restriction matrix is not needed here), with 0 being}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02811}02811     \textcolor{comment}{// the finest level and Nlevel-\/1 being the coarsest level}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02812}02812     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} level = 0; level < Nlevel -\/ 1; level++)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02813}02813     \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02814}02814       \textcolor{comment}{// Store the ID of the fine level}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02815}02815       \textcolor{keywordtype}{unsigned} fine\_level = level;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02816}02816 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02817}02817       \textcolor{comment}{// Store the ID of the coarse level}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02818}02818       \textcolor{keywordtype}{unsigned} coarse\_level = level + 1;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02819}02819 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02820}02820       \textcolor{comment}{// Make a pointer to the mesh on the finer level and dynamic\_cast}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02821}02821       \textcolor{comment}{// it as an object of the refineable mesh class.}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02822}02822       \mbox{\hyperlink{classoomph_1_1Mesh}{Mesh}}* ref\_fine\_mesh\_pt = Mg\_hierarchy\_pt[fine\_level]-\/>mesh\_pt();}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02823}02823 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02824}02824       \textcolor{comment}{// Make a pointer to the mesh on the coarse level and dynamic\_cast}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02825}02825       \textcolor{comment}{// it as an object of the refineable mesh class}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02826}02826       \mbox{\hyperlink{classoomph_1_1Mesh}{Mesh}}* ref\_coarse\_mesh\_pt = Mg\_hierarchy\_pt[coarse\_level]-\/>mesh\_pt();}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02827}02827 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02828}02828       \textcolor{comment}{// Access information about the number of elements in the fine mesh}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02829}02829       \textcolor{comment}{// from the pointer to the fine mesh (to loop over the rows of the}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02830}02830       \textcolor{comment}{// interpolation matrix)}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02831}02831       \textcolor{keywordtype}{unsigned} fine\_n\_element = ref\_fine\_mesh\_pt-\/>\mbox{\hyperlink{classoomph_1_1Mesh_af01dfefb66c15579b540be62999d93ee}{nelement}}();}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02832}02832 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02833}02833       \textcolor{comment}{// Find the number of elements in the bulk mesh}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02834}02834       \textcolor{keywordtype}{unsigned} n\_bulk\_mesh\_element =}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02835}02835         Mg\_hierarchy\_pt[fine\_level]-\/>mg\_bulk\_mesh\_pt()-\/>nelement();}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02836}02836 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02837}02837       \textcolor{comment}{// If there are elements apart from those in the bulk mesh}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02838}02838       \textcolor{comment}{// then we require locate\_zeta functionality. For this reason}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02839}02839       \textcolor{comment}{// we have to assign a value to the MeshAsGeomObject pointer}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02840}02840       \textcolor{comment}{// which we do by creating a MeshAsGeomObject from the coarse}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02841}02841       \textcolor{comment}{// mesh pointer}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02842}02842       \textcolor{keywordflow}{if} (fine\_n\_element > n\_bulk\_mesh\_element)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02843}02843       \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02844}02844         \textcolor{comment}{// Assign the pointer to coarse\_mesh\_from\_obj\_pt}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02845}02845         coarse\_mesh\_from\_obj\_pt =}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02846}02846           \textcolor{keyword}{new} \mbox{\hyperlink{classoomph_1_1MeshAsGeomObject}{MeshAsGeomObject}}(Mg\_hierarchy\_pt[coarse\_level]-\/>mesh\_pt());}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02847}02847       \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02848}02848 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02849}02849       \textcolor{comment}{// Find the number of dofs in the fine mesh}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02850}02850       \textcolor{keywordtype}{unsigned} n\_fine\_dof = Mg\_hierarchy\_pt[fine\_level]-\/>ndof();}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02851}02851 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02852}02852       \textcolor{comment}{// Find the number of dofs in the coarse mesh}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02853}02853       \textcolor{keywordtype}{unsigned} n\_coarse\_dof = Mg\_hierarchy\_pt[coarse\_level]-\/>ndof();}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02854}02854 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02855}02855       \textcolor{comment}{// To get the number of rows in the interpolation matrix we divide}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02856}02856       \textcolor{comment}{// the number of dofs on each level by 2 since there are 2 dofs at}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02857}02857       \textcolor{comment}{// each node in the mesh corresponding to the real and imaginary}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02858}02858       \textcolor{comment}{// part of the solution:}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02859}02859 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02860}02860       \textcolor{comment}{// Get the numbers of rows in the interpolation matrix.}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02861}02861       \textcolor{keywordtype}{unsigned} n\_row = n\_fine\_dof / 2.0;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02862}02862 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02863}02863       \textcolor{comment}{// Get the numbers of columns in the interpolation matrix}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02864}02864       \textcolor{keywordtype}{unsigned} n\_col = n\_coarse\_dof / 2.0;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02865}02865 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02866}02866       \textcolor{comment}{// Mapping relating the pointers to related elements in the coarse}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02867}02867       \textcolor{comment}{// and fine meshes: coarse\_mesh\_element\_pt[fine\_mesh\_element\_pt]. If}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02868}02868       \textcolor{comment}{// the element in the fine mesh has been unrefined between these two}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02869}02869       \textcolor{comment}{// levels, this map returns the father element in the coarsened mesh.}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02870}02870       \textcolor{comment}{// If this element in the fine mesh has not been unrefined, the map}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02871}02871       \textcolor{comment}{// returns the pointer to the same-\/sized equivalent element in the}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02872}02872       \textcolor{comment}{// coarsened mesh.}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02873}02873       std::map<RefineableQElement<DIM>*, \mbox{\hyperlink{classoomph_1_1RefineableQElement}{RefineableQElement<DIM>}}*>}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02874}02874         coarse\_mesh\_reference\_element\_pt;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02875}02875 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02876}02876       \textcolor{comment}{// Variable to count the number of elements in the fine mesh}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02877}02877       \textcolor{keywordtype}{unsigned} e\_fine = 0;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02878}02878 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02879}02879       \textcolor{comment}{// Variable to count the number of elements in the coarse mesh}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02880}02880       \textcolor{keywordtype}{unsigned} e\_coarse = 0;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02881}02881 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02882}02882       \textcolor{comment}{// While loop over fine elements (while because we're incrementing the}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02883}02883       \textcolor{comment}{// counter internally if the element was unrefined...). We only bother}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02884}02884       \textcolor{comment}{// going until we've covered all of the elements in the bulk mesh}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02885}02885       \textcolor{comment}{// because once we reach the PML layer (if there is one) there will be}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02886}02886       \textcolor{comment}{// no tree structure to match in between levels as PML elements are}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02887}02887       \textcolor{comment}{// simply regenerated once the bulk mesh has been refined.}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02888}02888       \textcolor{keywordflow}{while} (e\_fine < n\_bulk\_mesh\_element)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02889}02889       \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02890}02890         \textcolor{comment}{// Pointer to element in fine mesh}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02891}02891         \mbox{\hyperlink{classoomph_1_1RefineableQElement}{RefineableQElement<DIM>}}* el\_fine\_pt =}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02892}02892           \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1RefineableQElement}{RefineableQElement<DIM>}}*\textcolor{keyword}{>}(}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02893}02893             ref\_fine\_mesh\_pt-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a479059b0964826a8cee6eb506b57268a}{finite\_element\_pt}}(e\_fine));}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02894}02894 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02895}02895 \textcolor{preprocessor}{\#ifdef PARANOID}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02896}02896         \textcolor{comment}{// Make sure the coarse level element pointer is not a null pointer. If}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02897}02897         \textcolor{comment}{// it is something has gone wrong}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02898}02898         \textcolor{keywordflow}{if} (e\_coarse > ref\_coarse\_mesh\_pt-\/>\mbox{\hyperlink{classoomph_1_1Mesh_af01dfefb66c15579b540be62999d93ee}{nelement}}() -\/ 1)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02899}02899         \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02900}02900           \textcolor{comment}{// Create an output stream}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02901}02901           std::ostringstream error\_message\_stream;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02902}02902 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02903}02903           \textcolor{comment}{// Create an error message}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02904}02904           error\_message\_stream}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02905}02905             << \textcolor{stringliteral}{"{}The coarse level mesh has "{}} << ref\_coarse\_mesh\_pt-\/>\mbox{\hyperlink{classoomph_1_1Mesh_af01dfefb66c15579b540be62999d93ee}{nelement}}()}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02906}02906             << \textcolor{stringliteral}{"{} elements but the coarse\(\backslash\)nelement loop "{}}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02907}02907             << \textcolor{stringliteral}{"{}is looking at the "{}} << e\_coarse << \textcolor{stringliteral}{"{}-\/th element!"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02908}02908 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02909}02909           \textcolor{comment}{// Throw the error message}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02910}02910           \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(error\_message\_stream.str(),}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02911}02911                               OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02912}02912                               OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02913}02913         \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02914}02914 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02915}02915 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02916}02916         \textcolor{comment}{// Pointer to element in coarse mesh}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02917}02917         \mbox{\hyperlink{classoomph_1_1RefineableQElement}{RefineableQElement<DIM>}}* el\_coarse\_pt =}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02918}02918           \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1RefineableQElement}{RefineableQElement<DIM>}}*\textcolor{keyword}{>}(}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02919}02919             ref\_coarse\_mesh\_pt-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a479059b0964826a8cee6eb506b57268a}{finite\_element\_pt}}(e\_coarse));}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02920}02920 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02921}02921         \textcolor{comment}{// If the levels are different then the element in the fine}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02922}02922         \textcolor{comment}{// mesh has been unrefined between these two levels}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02923}02923         \textcolor{keywordflow}{if} (el\_fine\_pt-\/>tree\_pt()-\/>level() > el\_coarse\_pt-\/>tree\_pt()-\/>level())}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02924}02924         \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02925}02925           \textcolor{comment}{// The element in the fine mesh has been unrefined between these two}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02926}02926           \textcolor{comment}{// levels. Hence it and its three brothers (ASSUMED to be stored}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02927}02927           \textcolor{comment}{// consecutively in the Mesh's vector of pointers to its constituent}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02928}02928           \textcolor{comment}{// elements -\/-\/ we'll check this!) share the same father element in}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02929}02929           \textcolor{comment}{// the coarse mesh, currently pointed to by el\_coarse\_pt.}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02930}02930           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < n\_sons; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02931}02931           \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02932}02932             \textcolor{comment}{// Set mapping to father element in coarse mesh}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02933}02933             coarse\_mesh\_reference\_element\_pt}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02934}02934               [\textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1RefineableQElement}{RefineableQElement<DIM>}}*\textcolor{keyword}{>}(}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02935}02935                 ref\_fine\_mesh\_pt-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a479059b0964826a8cee6eb506b57268a}{finite\_element\_pt}}(e\_fine))] = el\_coarse\_pt;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02936}02936 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02937}02937             \textcolor{comment}{// Increment counter for elements in fine mesh}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02938}02938             e\_fine++;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02939}02939           \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02940}02940         \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02941}02941         \textcolor{comment}{// The element in the fine mesh has not been unrefined between}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02942}02942         \textcolor{comment}{// these two levels, so the reference element is the same-\/sized}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02943}02943         \textcolor{comment}{// equivalent element in the coarse mesh}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02944}02944         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (el\_fine\_pt-\/>tree\_pt()-\/>level() ==}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02945}02945                  el\_coarse\_pt-\/>tree\_pt()-\/>level())}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02946}02946         \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02947}02947           \textcolor{comment}{// The element in the fine mesh has not been unrefined between these}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02948}02948           \textcolor{comment}{// two levels}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02949}02949           coarse\_mesh\_reference\_element\_pt}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02950}02950             [\textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1RefineableQElement}{RefineableQElement<DIM>}}*\textcolor{keyword}{>}(}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02951}02951               ref\_fine\_mesh\_pt-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a479059b0964826a8cee6eb506b57268a}{finite\_element\_pt}}(e\_fine))] = el\_coarse\_pt;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02952}02952 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02953}02953           \textcolor{comment}{// Increment counter for elements in fine mesh}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02954}02954           e\_fine++;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02955}02955         \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02956}02956         \textcolor{comment}{// If the element has been unrefined between levels. Not something}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02957}02957         \textcolor{comment}{// we can deal with at the moment (although it would be relatively}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02958}02958         \textcolor{comment}{// simply to implement...).}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02959}02959         \textcolor{comment}{// Option 1: Find the son elements (from the coarse mesh) associated}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02960}02960         \textcolor{comment}{// with the father element (from the fine mesh) and extract the}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02961}02961         \textcolor{comment}{// appropriate nodal values to find the nodal values in the father}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02962}02962         \textcolor{comment}{// element.}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02963}02963         \textcolor{comment}{// Option 2: Use the function}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02964}02964         \textcolor{comment}{//                       unrefine\_uniformly();}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02965}02965         \textcolor{comment}{// to ensure that the coarser meshes really only have father elements}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02966}02966         \textcolor{comment}{// or the element itself.}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02967}02967         \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02968}02968         \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02969}02969           \textcolor{comment}{// Create an output stream}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02970}02970           std::ostringstream error\_message\_stream;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02971}02971 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02972}02972           \textcolor{comment}{// Create an error message}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02973}02973           error\_message\_stream << \textcolor{stringliteral}{"{}Element unrefined between levels! Can't "{}}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02974}02974                                << \textcolor{stringliteral}{"{}handle this case yet..."{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02975}02975 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02976}02976           \textcolor{comment}{// Throw the error message}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02977}02977           \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(error\_message\_stream.str(),}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02978}02978                               OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02979}02979                               OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02980}02980         \} \textcolor{comment}{// if (el\_fine\_pt-\/>tree\_pt()-\/>level()!=...)}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02981}02981 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02982}02982         \textcolor{comment}{// Increment counter for elements in coarse mesh}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02983}02983         e\_coarse++;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02984}02984       \} \textcolor{comment}{// while(e\_fine<n\_bulk\_mesh\_element)}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02985}02985 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02986}02986       \textcolor{comment}{// To allow an update of a row only once we use STL vectors for bools}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02987}02987       std::vector<bool> contribution\_made(n\_row, \textcolor{keyword}{false});}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02988}02988 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02989}02989       \textcolor{comment}{// Create the row start vector whose i-\/th entry will contain the index}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02990}02990       \textcolor{comment}{// in column\_start where the entries in the i-\/th row of the matrix start}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02991}02991       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<int>}} row\_start(n\_row + 1);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02992}02992 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02993}02993       \textcolor{comment}{// Create the column index vector whose entries will store the column}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02994}02994       \textcolor{comment}{// index of each contribution, i.e. the global equation of the coarse}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02995}02995       \textcolor{comment}{// mesh node which supplies a contribution. We don't know how many}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02996}02996       \textcolor{comment}{// entries this will have so we dynamically allocate entries at run time}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02997}02997       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<int>}} column\_index;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02998}02998 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l02999}02999       \textcolor{comment}{// Create the value vector which will be used to store the nonzero}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03000}03000       \textcolor{comment}{// entries in the CRDoubleMatrix. We don't know how many entries this}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03001}03001       \textcolor{comment}{// will have either so we dynamically allocate its entries at run time}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03002}03002       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} value;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03003}03003 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03004}03004       \textcolor{comment}{// The value of index will tell us which row of the interpolation matrix}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03005}03005       \textcolor{comment}{// we're working on in the following for loop}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03006}03006       \textcolor{comment}{// DRAIG: Should this worry us? We assume that every node we cover is}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03007}03007       \textcolor{comment}{// the next node in the mesh (we loop over the elements and the nodes}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03008}03008       \textcolor{comment}{// inside that). This does work but it may not work for some meshes}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03009}03009       \textcolor{keywordtype}{unsigned} index = 0;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03010}03010 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03011}03011       \textcolor{comment}{// New loop to go over each element in the fine mesh}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03012}03012       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} k = 0; k < fine\_n\_element; k++)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03013}03013       \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03014}03014         \textcolor{comment}{// Set a pointer to the element in the fine mesh}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03015}03015         \mbox{\hyperlink{classoomph_1_1RefineableQElement}{RefineableQElement<DIM>}}* el\_fine\_pt =}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03016}03016           \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1RefineableQElement}{RefineableQElement<DIM>}}*\textcolor{keyword}{>}(}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03017}03017             ref\_fine\_mesh\_pt-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a479059b0964826a8cee6eb506b57268a}{finite\_element\_pt}}(k));}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03018}03018 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03019}03019         \textcolor{comment}{// Initialise a null pointer which will point to the corresponding}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03020}03020         \textcolor{comment}{// coarse mesh element. If we're in the bulk mesh, this will point}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03021}03021         \textcolor{comment}{// to the parent element of the fine mesh element or itself (if}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03022}03022         \textcolor{comment}{// there was no refinement between the levels). If, however, we're}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03023}03023         \textcolor{comment}{// in the PML layer then this will point to element that encloses}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03024}03024         \textcolor{comment}{// the fine mesh PML element}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03025}03025         \mbox{\hyperlink{classoomph_1_1RefineableQElement}{RefineableQElement<DIM>}}* el\_coarse\_pt = 0;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03026}03026 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03027}03027         \textcolor{comment}{// Variable to store the son type of the fine mesh element with}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03028}03028         \textcolor{comment}{// respect to the corresponding coarse mesh element (set to OMEGA}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03029}03029         \textcolor{comment}{// if no unrefinement took place)}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03030}03030         \textcolor{keywordtype}{int} son\_type = 0;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03031}03031 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03032}03032         \textcolor{comment}{// If we're in the bulk mesh we can assign the coarse mesh element}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03033}03033         \textcolor{comment}{// pointer right now using the map coarse\_mesh\_reference\_element\_pt}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03034}03034         \textcolor{keywordflow}{if} (k < n\_bulk\_mesh\_element)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03035}03035         \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03036}03036           \textcolor{comment}{// Get the reference element (either the father element or the}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03037}03037           \textcolor{comment}{// same-\/sized element) in the coarse mesh}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03038}03038           el\_coarse\_pt = coarse\_mesh\_reference\_element\_pt[el\_fine\_pt];}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03039}03039 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03040}03040           \textcolor{comment}{// Check if the elements are different on both levels (i.e. to check}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03041}03041           \textcolor{comment}{// if any unrefinement took place)}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03042}03042           \textcolor{keywordflow}{if} (el\_fine\_pt-\/>tree\_pt()-\/>level() !=}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03043}03043               el\_coarse\_pt-\/>tree\_pt()-\/>level())}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03044}03044           \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03045}03045             \textcolor{comment}{// If the element was refined then we need the son type}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03046}03046             son\_type = el\_fine\_pt-\/>tree\_pt()-\/>son\_type();}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03047}03047           \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03048}03048           \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03049}03049           \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03050}03050             \textcolor{comment}{// If the element is the same in both meshes}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03051}03051             son\_type = \mbox{\hyperlink{classoomph_1_1Tree_a9e532196340dcd859ff8207eea2ddbbc}{Tree::OMEGA}};}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03052}03052           \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03053}03053         \} \textcolor{comment}{// if (k<n\_bulk\_mesh\_element)}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03054}03054 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03055}03055         \textcolor{comment}{// Loop through all the nodes in an element in the fine mesh}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03056}03056         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < nnod\_element; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03057}03057         \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03058}03058           \textcolor{comment}{// Row number in interpolation matrix: Global equation number}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03059}03059           \textcolor{comment}{// of the d.o.f. stored at this node in the fine element}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03060}03060           \textcolor{keywordtype}{int} ii = el\_fine\_pt-\/>node\_pt(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}})-\/>eqn\_number(0);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03061}03061 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03062}03062           \textcolor{comment}{// Check whether or not the node is a proper d.o.f.}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03063}03063           \textcolor{keywordflow}{if} (ii >= 0)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03064}03064           \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03065}03065             \textcolor{comment}{// Only assign values to the given row of the interpolation matrix}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03066}03066             \textcolor{comment}{// if they haven't already been assigned. Notice, we check if the}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03067}03067             \textcolor{comment}{// (ii/2)-\/th entry has been set. This is because there are two dofs}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03068}03068             \textcolor{comment}{// at each node so dividing by two will give us the row number}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03069}03069             \textcolor{comment}{// associated with this node}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03070}03070             \textcolor{keywordflow}{if} (contribution\_made[ii / 2] == \textcolor{keyword}{false})}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03071}03071             \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03072}03072               \textcolor{comment}{// The value of index was initialised when we allocated space}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03073}03073               \textcolor{comment}{// for the three vectors to store the CRDoubleMatrix. We use}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03074}03074               \textcolor{comment}{// index to go through the entries of the row\_start vector.}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03075}03075               \textcolor{comment}{// The next row starts at the value.size() (draw out the entries}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03076}03076               \textcolor{comment}{// in value if this doesn't make sense noting that the storage}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03077}03077               \textcolor{comment}{// for the vector 'value' is dynamically allocated)}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03078}03078               row\_start[index] = value.size();}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03079}03079 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03080}03080               \textcolor{comment}{// If we're in the PML layer then we need to find the parent}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03081}03081               \textcolor{comment}{// element associated with a given node using locate\_zeta.}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03082}03082               \textcolor{comment}{// Unfortunately, if this is the case and a given local node in}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03083}03083               \textcolor{comment}{// the fine mesh element lies on the interface between two}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03084}03084               \textcolor{comment}{// elements (E1) and (E2) in the coarse mesh then either element}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03085}03085               \textcolor{comment}{// will be returned. Suppose, for instance, a pointer to (E1) is}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03086}03086               \textcolor{comment}{// returned. If the next local node lies in the (E2) then the}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03087}03087               \textcolor{comment}{// contributions which we pick up from the local nodes in (E1)}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03088}03088               \textcolor{comment}{// will most likely be incorrect while the column index (the}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03089}03089               \textcolor{comment}{// global equation number of the coarse mesh node) corresponding}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03090}03090               \textcolor{comment}{// to the given contribution will definitely be incorrect. If}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03091}03091               \textcolor{comment}{// we're not using linear quad elements we can get around this by}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03092}03092               \textcolor{comment}{// using locate\_zeta carefully by identifying a node which is}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03093}03093               \textcolor{comment}{// internal to the fine mesh element. This will allow us to}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03094}03094               \textcolor{comment}{// correctly obtain the corresponding element in the coarse mesh}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03095}03095               \textcolor{keywordflow}{if} (k >= n\_bulk\_mesh\_element)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03096}03096               \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03097}03097                 \textcolor{comment}{// Get the (Eulerian) spatial location of the i-\/th local node}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03098}03098                 \textcolor{comment}{// in the fine mesh element}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03099}03099                 el\_fine\_pt-\/>node\_pt(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}})-\/>position(fine\_node\_position);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03100}03100 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03101}03101                 \textcolor{comment}{// Initalise a null pointer to point to an object of the class}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03102}03102                 \textcolor{comment}{// GeomObject}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03103}03103                 \mbox{\hyperlink{classoomph_1_1GeomObject}{GeomObject}}* el\_pt = 0;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03104}03104 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03105}03105                 \textcolor{comment}{// Get the reference element (either the father element or the}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03106}03106                 \textcolor{comment}{// same-\/sized element) in the coarse-\/mesh PML layer using}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03107}03107                 \textcolor{comment}{// the locate\_zeta functionality}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03108}03108                 coarse\_mesh\_from\_obj\_pt-\/>\mbox{\hyperlink{classoomph_1_1MeshAsGeomObject_a8a9fecb98d4e0a151e3b9e58aa433be9}{locate\_zeta}}(}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03109}03109                   fine\_node\_position, el\_pt, \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}});}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03110}03110 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03111}03111                 \textcolor{comment}{// Upcast the GeomElement object to a RefineableQElement object}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03112}03112                 el\_coarse\_pt = \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1RefineableQElement}{RefineableQElement<DIM>}}*\textcolor{keyword}{>}(el\_pt);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03113}03113               \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03114}03114               \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03115}03115               \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03116}03116                 \textcolor{comment}{// Calculate the local coordinates of the given node}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03117}03117                 el\_fine\_pt-\/>local\_coordinate\_of\_node(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}, \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}});}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03118}03118 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03119}03119                 \textcolor{comment}{// Find the local coordinates s, of the present node, in the}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03120}03120                 \textcolor{comment}{// reference element in the coarse mesh, given the element's}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03121}03121                 \textcolor{comment}{// son\_type (e.g. SW,SE... )}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03122}03122                 level\_up\_local\_coord\_of\_node(son\_type, \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}});}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03123}03123               \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03124}03124 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03125}03125               \textcolor{comment}{// Allocate space for shape functions in the coarse mesh}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03126}03126               \mbox{\hyperlink{classoomph_1_1Shape}{Shape}} psi(el\_coarse\_pt-\/>nnode());}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03127}03127 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03128}03128               \textcolor{comment}{// Set the shape function in the reference element}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03129}03129               el\_coarse\_pt-\/>shape(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, psi);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03130}03130 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03131}03131               \textcolor{comment}{// Auxiliary storage}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03132}03132               std::map<unsigned, double> contribution;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03133}03133               \mbox{\hyperlink{classoomph_1_1Vector}{Vector<unsigned>}} keys;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03134}03134 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03135}03135               \textcolor{comment}{// Find the number of nodes in an element in the coarse mesh}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03136}03136               \textcolor{keywordtype}{unsigned} nnod\_coarse = el\_coarse\_pt-\/>nnode();}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03137}03137 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03138}03138               \textcolor{comment}{// Loop through all the nodes in the reference element}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03139}03139               \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < nnod\_coarse; j++)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03140}03140               \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03141}03141                 \textcolor{comment}{// Column number in interpolation matrix: Global equation}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03142}03142                 \textcolor{comment}{// number of the d.o.f. stored at this node in the coarse}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03143}03143                 \textcolor{comment}{// element}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03144}03144                 \textcolor{keywordtype}{int} jj = el\_coarse\_pt-\/>node\_pt(j)-\/>eqn\_number(0);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03145}03145 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03146}03146                 \textcolor{comment}{// If the value stored at this node is pinned or hanging}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03147}03147                 \textcolor{keywordflow}{if} (jj < 0)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03148}03148                 \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03149}03149                   \textcolor{comment}{// Hanging node: In this case we need to accumulate the}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03150}03150                   \textcolor{comment}{// contributions from the master nodes}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03151}03151                   \textcolor{keywordflow}{if} (el\_coarse\_pt-\/>node\_pt(j)-\/>is\_hanging())}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03152}03152                   \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03153}03153                     \textcolor{comment}{// Find the number of master nodes of the hanging}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03154}03154                     \textcolor{comment}{// the node in the reference element}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03155}03155                     \mbox{\hyperlink{classoomph_1_1HangInfo}{HangInfo}}* hang\_info\_pt =}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03156}03156                       el\_coarse\_pt-\/>node\_pt(j)-\/>hanging\_pt();}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03157}03157                     \textcolor{keywordtype}{unsigned} nmaster = hang\_info\_pt-\/>\mbox{\hyperlink{classoomph_1_1HangInfo_aa9c1130b58db2ff6d5eee4f923ba365c}{nmaster}}();}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03158}03158 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03159}03159                     \textcolor{comment}{// Loop over the master nodes}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03160}03160                     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} i\_master = 0; i\_master < nmaster; i\_master++)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03161}03161                     \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03162}03162                       \textcolor{comment}{// Set up a pointer to the master node}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03163}03163                       Node* master\_node\_pt =}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03164}03164                         hang\_info\_pt-\/>\mbox{\hyperlink{classoomph_1_1HangInfo_a7a935ae7eeca594a648ca1800444827c}{master\_node\_pt}}(i\_master);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03165}03165 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03166}03166                       \textcolor{comment}{// The column number in the interpolation matrix: the}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03167}03167                       \textcolor{comment}{// global equation number of the d.o.f. stored at this}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03168}03168                       \textcolor{comment}{// master node for the coarse element}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03169}03169                       \textcolor{keywordtype}{int} master\_jj = master\_node\_pt-\/>eqn\_number(0);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03170}03170 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03171}03171                       \textcolor{comment}{// Is the master node a proper d.o.f.?}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03172}03172                       \textcolor{keywordflow}{if} (master\_jj >= 0)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03173}03173                       \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03174}03174                         \textcolor{comment}{// If the weight of the master node is non-\/zero}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03175}03175                         \textcolor{keywordflow}{if} (psi(j) * hang\_info\_pt-\/>\mbox{\hyperlink{classoomph_1_1HangInfo_ac49ebdd8957a658fe4a2420108d2dcee}{master\_weight}}(i\_master) !=}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03176}03176                             0.0)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03177}03177                         \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03178}03178                           contribution[master\_jj / 2] +=}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03179}03179                             psi(j) * hang\_info\_pt-\/>\mbox{\hyperlink{classoomph_1_1HangInfo_ac49ebdd8957a658fe4a2420108d2dcee}{master\_weight}}(i\_master);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03180}03180                         \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03181}03181                       \} \textcolor{comment}{// if (master\_jj>=0)}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03182}03182                     \} \textcolor{comment}{// for (unsigned i\_master=0;i\_master<nmaster;i\_master++)}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03183}03183                   \} \textcolor{comment}{// if (el\_coarse\_pt-\/>node\_pt(j)-\/>is\_hanging())}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03184}03184                 \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03185}03185                 \textcolor{comment}{// In the case that the node is not pinned or hanging}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03186}03186                 \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03187}03187                 \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03188}03188                   \textcolor{comment}{// If we can get a nonzero contribution from the shape}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03189}03189                   \textcolor{comment}{// function}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03190}03190                   \textcolor{keywordflow}{if} (psi(j) != 0.0)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03191}03191                   \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03192}03192                     contribution[jj / 2] += psi(j);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03193}03193                   \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03194}03194                 \} \textcolor{comment}{// if (jj<0) else}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03195}03195               \} \textcolor{comment}{// for (unsigned j=0;j<nnod\_coarse;j++)}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03196}03196 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03197}03197               \textcolor{comment}{// Put the contributions into the value vector}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03198}03198               \textcolor{keywordflow}{for} (std::map<unsigned, double>::iterator it =}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03199}03199                      contribution.begin();}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03200}03200                    it != contribution.end();}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03201}03201                    ++it)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03202}03202               \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03203}03203                 \textcolor{keywordflow}{if} (it-\/>second != 0)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03204}03204                 \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03205}03205                   \textcolor{comment}{// The first entry in contribution is the column index}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03206}03206                   column\_index.push\_back(it-\/>first);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03207}03207 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03208}03208                   \textcolor{comment}{// The second entry in contribution is the value of the}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03209}03209                   \textcolor{comment}{// contribution}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03210}03210                   value.push\_back(it-\/>second);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03211}03211                 \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03212}03212               \} \textcolor{comment}{// for (std::map<unsigned,double>::iterator it=...)}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03213}03213 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03214}03214               \textcolor{comment}{// Increment the value of index by 1 to indicate that we have}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03215}03215               \textcolor{comment}{// finished the row, or equivalently, covered another global}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03216}03216               \textcolor{comment}{// node in the fine mesh}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03217}03217               index++;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03218}03218 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03219}03219               \textcolor{comment}{// Change the entry in contribution\_made to true now to indicate}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03220}03220               \textcolor{comment}{// that the row has been filled}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03221}03221               contribution\_made[ii / 2] = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03222}03222             \} \textcolor{comment}{// if(contribution\_made[ii/2]==false)}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03223}03223           \} \textcolor{comment}{// if (ii>=0)}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03224}03224         \} \textcolor{comment}{// for(unsigned i=0;i<nnod\_element;i++)}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03225}03225       \} \textcolor{comment}{// for (unsigned k=0;k<fine\_n\_element;k++)}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03226}03226 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03227}03227       \textcolor{comment}{// Set the last entry in the row\_start vector}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03228}03228       row\_start[n\_row] = value.size();}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03229}03229 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03230}03230       \textcolor{comment}{// Set the interpolation matrix to be that formed as the CRDoubleMatrix}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03231}03231       \textcolor{comment}{// using the vectors value, row\_start, column\_index and the value}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03232}03232       \textcolor{comment}{// of fine\_n\_unknowns and coarse\_n\_unknowns}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03233}03233       interpolation\_matrix\_set(}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03234}03234         level, value, column\_index, row\_start, n\_col, n\_row);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03235}03235     \} \textcolor{comment}{// for (unsigned level=0;level<Nlevel-\/1;level++)}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03236}03236   \} \textcolor{comment}{// End of setup\_interpolation\_matrices}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03237}03237 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03238}03238   \textcolor{comment}{//===================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03239}03239 \textcolor{comment}{  /// Setup the interpolation matrices}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03240}03240 \textcolor{comment}{}  \textcolor{comment}{//===================================================================}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03241}03241   \textcolor{keyword}{template}<\textcolor{keywordtype}{unsigned} DIM>}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03242}03242   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner}{HelmholtzMGPreconditioner}}<}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03243}\mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_ac392a7156bbf904f7c5ec1c4ed3d4b96}{03243}}     DIM>::setup\_interpolation\_matrices\_unstructured()}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03244}03244   \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03245}03245 \textcolor{preprocessor}{\#ifdef PARANOID}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03246}03246     \textcolor{keywordflow}{if} ((DIM != 2) \&\& (DIM != 3))}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03247}03247     \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03248}03248       std::ostringstream error\_message\_stream;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03249}03249       error\_message\_stream << \textcolor{stringliteral}{"{}DIM should be 2 or 3 not "{}} << DIM << std::endl;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03250}03250       \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(error\_message\_stream.str(),}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03251}03251                           OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03252}03252                           OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03253}03253     \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03254}03254 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03255}03255 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03256}03256     \textcolor{comment}{// Vector of local coordinates in the element}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03257}03257     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}(DIM, 0.0);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03258}03258 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03259}03259     \textcolor{comment}{// Loop over each level (apart from the coarsest level; an interpolation}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03260}03260     \textcolor{comment}{// matrix and thus a restriction matrix is not needed here), with 0 being}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03261}03261     \textcolor{comment}{// the finest level and Nlevel-\/1 being the coarsest level}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03262}03262     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} level = 0; level < Nlevel -\/ 1; level++)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03263}03263     \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03264}03264       \textcolor{comment}{// Assign values to a couple of variables to help out}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03265}03265       \textcolor{keywordtype}{unsigned} coarse\_level = level + 1;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03266}03266       \textcolor{keywordtype}{unsigned} fine\_level = level;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03267}03267 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03268}03268       \textcolor{comment}{// Make a pointer to the mesh on the finer level and dynamic\_cast}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03269}03269       \textcolor{comment}{// it as an object of the refineable mesh class}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03270}03270       \mbox{\hyperlink{classoomph_1_1Mesh}{Mesh}}* ref\_fine\_mesh\_pt = Mg\_hierarchy\_pt[fine\_level]-\/>mg\_bulk\_mesh\_pt();}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03271}03271 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03272}03272       \textcolor{comment}{// To use the locate zeta functionality the coarse mesh must be of the}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03273}03273       \textcolor{comment}{// type MeshAsGeomObject}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03274}03274       \mbox{\hyperlink{classoomph_1_1MeshAsGeomObject}{MeshAsGeomObject}}* coarse\_mesh\_from\_obj\_pt =}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03275}03275         \textcolor{keyword}{new} \mbox{\hyperlink{classoomph_1_1MeshAsGeomObject}{MeshAsGeomObject}}(Mg\_hierarchy\_pt[coarse\_level]-\/>mg\_bulk\_mesh\_pt());}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03276}03276 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03277}03277       \textcolor{comment}{// Access information about the number of degrees of freedom}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03278}03278       \textcolor{comment}{// from the pointers to the problem on each level}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03279}03279       \textcolor{keywordtype}{unsigned} coarse\_n\_unknowns = Mg\_hierarchy\_pt[coarse\_level]-\/>ndof();}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03280}03280       \textcolor{keywordtype}{unsigned} fine\_n\_unknowns = Mg\_hierarchy\_pt[fine\_level]-\/>ndof();}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03281}03281 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03282}03282       \textcolor{comment}{// Make storage vectors to form the interpolation matrix using a}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03283}03283       \textcolor{comment}{// condensed row matrix (CRDoubleMatrix). The i-\/th value of the vector}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03284}03284       \textcolor{comment}{// row\_start contains entries which tells us at which entry of the}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03285}03285       \textcolor{comment}{// vector column\_start we start on the i-\/th row of the actual matrix.}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03286}03286       \textcolor{comment}{// The entries of column\_start indicate the column position of each}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03287}03287       \textcolor{comment}{// non-\/zero entry in every row. This runs through the first row}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03288}03288       \textcolor{comment}{// from left to right then the second row (again, left to right)}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03289}03289       \textcolor{comment}{// and so on until the end. The entries in value are the entries in}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03290}03290       \textcolor{comment}{// the interpolation matrix. The vector column\_start has the same length}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03291}03291       \textcolor{comment}{// as the vector value.}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03292}03292       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} value;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03293}03293       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<int>}} column\_index;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03294}03294       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<int>}} row\_start(fine\_n\_unknowns + 1);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03295}03295 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03296}03296       \textcolor{comment}{// Vector to contain the (Eulerian) spatial location of the fine node}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03297}03297       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} fine\_node\_position(DIM);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03298}03298 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03299}03299       \textcolor{comment}{// Find the number of nodes in the mesh}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03300}03300       \textcolor{keywordtype}{unsigned} n\_node\_fine\_mesh = ref\_fine\_mesh\_pt-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a945e7823d1a2af243b5b7f7866aaff5e}{nnode}}();}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03301}03301 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03302}03302       \textcolor{comment}{// Loop over the unknowns in the mesh}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03303}03303       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} i\_fine\_node = 0; i\_fine\_node < n\_node\_fine\_mesh;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03304}03304            i\_fine\_node++)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03305}03305       \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03306}03306         \textcolor{comment}{// Set a pointer to the i\_fine\_unknown-\/th node in the fine mesh}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03307}03307         Node* fine\_node\_pt = ref\_fine\_mesh\_pt-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a69d22c2070f1649c4cb2607f26070d7c}{node\_pt}}(i\_fine\_node);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03308}03308 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03309}03309         \textcolor{comment}{// Get the global equation number}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03310}03310         \textcolor{keywordtype}{int} i\_fine = fine\_node\_pt-\/>eqn\_number(0);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03311}03311 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03312}03312         \textcolor{comment}{// If the node is a proper d.o.f.}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03313}03313         \textcolor{keywordflow}{if} (i\_fine >= 0)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03314}03314         \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03315}03315           \textcolor{comment}{// Row number in interpolation matrix: Global equation number}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03316}03316           \textcolor{comment}{// of the d.o.f. stored at this node in the fine element}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03317}03317           row\_start[i\_fine] = value.size();}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03318}03318 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03319}03319           \textcolor{comment}{// Get the (Eulerian) spatial location of the fine node}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03320}03320           fine\_node\_pt-\/>position(fine\_node\_position);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03321}03321 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03322}03322           \textcolor{comment}{// Create a null pointer to the GeomObject class}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03323}03323           \mbox{\hyperlink{classoomph_1_1GeomObject}{GeomObject}}* el\_pt = 0;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03324}03324 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03325}03325           \textcolor{comment}{// Get the reference element (either the father element or the}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03326}03326           \textcolor{comment}{// same-\/sized element) in the coarse mesh using locate\_zeta}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03327}03327           coarse\_mesh\_from\_obj\_pt-\/>\mbox{\hyperlink{classoomph_1_1MeshAsGeomObject_a8a9fecb98d4e0a151e3b9e58aa433be9}{locate\_zeta}}(fine\_node\_position, el\_pt, \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}});}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03328}03328 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03329}03329           \textcolor{comment}{// Upcast GeomElement as a FiniteElement}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03330}03330           \mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}* el\_coarse\_pt = \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}*\textcolor{keyword}{>}(el\_pt);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03331}03331 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03332}03332           \textcolor{comment}{// Find the number of nodes in the element}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03333}03333           \textcolor{keywordtype}{unsigned} n\_node = el\_coarse\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a6219ed269a6d89b5aa14659cce48905a}{nnode}}();}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03334}03334 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03335}03335           \textcolor{comment}{// Allocate space for shape functions in the coarse mesh}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03336}03336           \mbox{\hyperlink{classoomph_1_1Shape}{Shape}} psi(n\_node);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03337}03337 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03338}03338           \textcolor{comment}{// Calculate the geometric shape functions at local coordinate s}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03339}03339           el\_coarse\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a58a25b6859ddd43b7bfe64a19fee5023}{shape}}(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, psi);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03340}03340 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03341}03341           \textcolor{comment}{// Auxiliary storage}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03342}03342           std::map<unsigned, double> contribution;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03343}03343           \mbox{\hyperlink{classoomph_1_1Vector}{Vector<unsigned>}} keys;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03344}03344 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03345}03345           \textcolor{comment}{// Loop through all the nodes in the (coarse mesh) element containing}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03346}03346           \textcolor{comment}{// the node pointed to by fine\_node\_pt (fine mesh)}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03347}03347           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j\_node = 0; j\_node < n\_node; j\_node++)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03348}03348           \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03349}03349             \textcolor{comment}{// Get the j\_coarse\_unknown-\/th node in the coarse element}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03350}03350             Node* coarse\_node\_pt = el\_coarse\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a9addfe893ab8205619963aa96204cdc4}{node\_pt}}(j\_node);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03351}03351 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03352}03352             \textcolor{comment}{// Column number in interpolation matrix: Global equation number of}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03353}03353             \textcolor{comment}{// the d.o.f. stored at this node in the coarse element}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03354}03354             \textcolor{keywordtype}{int} j\_coarse = coarse\_node\_pt-\/>eqn\_number(0);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03355}03355 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03356}03356             \textcolor{comment}{// If the value stored at this node is pinned or hanging}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03357}03357             \textcolor{keywordflow}{if} (j\_coarse < 0)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03358}03358             \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03359}03359               \textcolor{comment}{// Hanging node: In this case we need to accumulate the}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03360}03360               \textcolor{comment}{// contributions from the master nodes}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03361}03361               \textcolor{keywordflow}{if} (el\_coarse\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a9addfe893ab8205619963aa96204cdc4}{node\_pt}}(j\_node)-\/>is\_hanging())}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03362}03362               \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03363}03363                 \textcolor{comment}{// Find the number of master nodes of the hanging}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03364}03364                 \textcolor{comment}{// the node in the reference element}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03365}03365                 \mbox{\hyperlink{classoomph_1_1HangInfo}{HangInfo}}* hang\_info\_pt = coarse\_node\_pt-\/>hanging\_pt();}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03366}03366                 \textcolor{keywordtype}{unsigned} nmaster = hang\_info\_pt-\/>\mbox{\hyperlink{classoomph_1_1HangInfo_aa9c1130b58db2ff6d5eee4f923ba365c}{nmaster}}();}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03367}03367 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03368}03368                 \textcolor{comment}{// Loop over the master nodes}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03369}03369                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} i\_master = 0; i\_master < nmaster; i\_master++)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03370}03370                 \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03371}03371                   \textcolor{comment}{// Set up a pointer to the master node}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03372}03372                   Node* master\_node\_pt = hang\_info\_pt-\/>\mbox{\hyperlink{classoomph_1_1HangInfo_a7a935ae7eeca594a648ca1800444827c}{master\_node\_pt}}(i\_master);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03373}03373 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03374}03374                   \textcolor{comment}{// The column number in the interpolation matrix: the}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03375}03375                   \textcolor{comment}{// global equation number of the d.o.f. stored at this master}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03376}03376                   \textcolor{comment}{// node for the coarse element}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03377}03377                   \textcolor{keywordtype}{int} master\_jj = master\_node\_pt-\/>eqn\_number(0);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03378}03378 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03379}03379                   \textcolor{comment}{// Is the master node a proper d.o.f.?}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03380}03380                   \textcolor{keywordflow}{if} (master\_jj >= 0)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03381}03381                   \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03382}03382                     \textcolor{comment}{// If the weight of the master node is non-\/zero}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03383}03383                     \textcolor{keywordflow}{if} (psi(j\_node) * hang\_info\_pt-\/>\mbox{\hyperlink{classoomph_1_1HangInfo_ac49ebdd8957a658fe4a2420108d2dcee}{master\_weight}}(i\_master) !=}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03384}03384                         0.0)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03385}03385                     \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03386}03386                       contribution[master\_jj] +=}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03387}03387                         psi(j\_node) * hang\_info\_pt-\/>\mbox{\hyperlink{classoomph_1_1HangInfo_ac49ebdd8957a658fe4a2420108d2dcee}{master\_weight}}(i\_master);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03388}03388                     \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03389}03389                   \} \textcolor{comment}{// End of if statement (check it's not a boundary node)}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03390}03390                 \} \textcolor{comment}{// End of the loop over the master nodes}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03391}03391               \} \textcolor{comment}{// End of the if statement for only hanging nodes}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03392}03392             \} \textcolor{comment}{// End of the if statement for pinned or hanging nodes}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03393}03393             \textcolor{comment}{// In the case that the node is not pinned or hanging}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03394}03394             \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03395}03395             \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03396}03396               \textcolor{comment}{// If we can get a nonzero contribution from the shape function}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03397}03397               \textcolor{comment}{// at the j\_node-\/th node in the element}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03398}03398               \textcolor{keywordflow}{if} (psi(j\_node) != 0.0)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03399}03399               \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03400}03400                 contribution[j\_coarse] += psi(j\_node);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03401}03401               \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03402}03402             \} \textcolor{comment}{// End of the if-\/else statement (check if the node was}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03403}03403               \textcolor{comment}{// pinned/hanging)}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03404}03404           \} \textcolor{comment}{// Finished loop over the nodes j in the reference element (coarse)}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03405}03405 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03406}03406           \textcolor{comment}{// Put the contributions into the value vector}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03407}03407           \textcolor{keywordflow}{for} (std::map<unsigned, double>::iterator it = contribution.begin();}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03408}03408                it != contribution.end();}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03409}03409                ++it)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03410}03410           \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03411}03411             \textcolor{keywordflow}{if} (it-\/>second != 0)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03412}03412             \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03413}03413               value.push\_back(it-\/>second);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03414}03414               column\_index.push\_back(it-\/>first);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03415}03415             \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03416}03416           \} \textcolor{comment}{// End of putting contributions into the value vector}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03417}03417         \} \textcolor{comment}{// End check (whether or not the fine node was a d.o.f.)}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03418}03418       \} \textcolor{comment}{// End of the for-\/loop over nodes in the fine mesh}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03419}03419 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03420}03420       \textcolor{comment}{// Set the last entry of row\_start}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03421}03421       row\_start[fine\_n\_unknowns] = value.size();}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03422}03422 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03423}03423       \textcolor{comment}{// Set the interpolation matrix to be that formed as the CRDoubleMatrix}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03424}03424       \textcolor{comment}{// using the vectors value, row\_start, column\_index and the value}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03425}03425       \textcolor{comment}{// of fine\_n\_unknowns and coarse\_n\_unknowns}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03426}03426       interpolation\_matrix\_set(level,}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03427}03427                                value,}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03428}03428                                column\_index,}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03429}03429                                row\_start,}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03430}03430                                coarse\_n\_unknowns,}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03431}03431                                fine\_n\_unknowns);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03432}03432     \} \textcolor{comment}{// End of loop over each level}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03433}03433   \} \textcolor{comment}{// End of setup\_interpolation\_matrices\_unstructured}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03434}03434 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03435}03435   \textcolor{comment}{//=========================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03436}03436 \textcolor{comment}{  /// Given the son type of the element and the local coordinate s of}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03437}03437 \textcolor{comment}{  /// a given node in the son element, return the local coordinate s in its}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03438}03438 \textcolor{comment}{  /// father element. 3D case.}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03439}03439 \textcolor{comment}{}  \textcolor{comment}{//=========================================================================}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03440}03440   \textcolor{keyword}{template}<>}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03441}\mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a0ca757ac0d43da4c2962bec3610f175b}{03441}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a6a82f0212ff1277a1e8c33a6a81bfeff}{HelmholtzMGPreconditioner<3>::level\_up\_local\_coord\_of\_node}}(}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03442}03442     \textcolor{keyword}{const} \textcolor{keywordtype}{int}\& son\_type, \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}}\& \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}})}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03443}03443   \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03444}03444     \textcolor{comment}{// If the element is unrefined between the levels the local coordinate}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03445}03445     \textcolor{comment}{// of the node in one element is the same as that in the other element}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03446}03446     \textcolor{comment}{// therefore we only need to perform calculations if the levels are}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03447}03447     \textcolor{comment}{// different (i.e. son\_type is not OMEGA)}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03448}03448     \textcolor{keywordflow}{if} (son\_type != \mbox{\hyperlink{classoomph_1_1Tree_a9e532196340dcd859ff8207eea2ddbbc}{Tree::OMEGA}})}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03449}03449     \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03450}03450       \textcolor{comment}{// Scale the local coordinate from the range [-\/1,1]x[-\/1,1]x[-\/1,1]}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03451}03451       \textcolor{comment}{// to the range [0,1]x[0,1]x[0,1] to match the width of the local}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03452}03452       \textcolor{comment}{// coordinate range of the fine element from the perspective of}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03453}03453       \textcolor{comment}{// the father element. This then simply requires a shift of the}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03454}03454       \textcolor{comment}{// coordinates to match which type of son element we're dealing with}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03455}03455       \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0] = (\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0] + 1.0) / 2.0;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03456}03456       \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[1] = (\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[1] + 1.0) / 2.0;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03457}03457       \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[2] = (\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[2] + 1.0) / 2.0;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03458}03458 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03459}03459       \textcolor{comment}{// Cases: The son\_type determines how the local coordinates should be}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03460}03460       \textcolor{comment}{// shifted to give the local coordinates in the coarse mesh element}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03461}03461       \textcolor{keywordflow}{switch} (son\_type)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03462}03462       \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03463}03463         \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a7bf18855ab002d44e301413456917d9c}{OcTreeNames::LDF}}:}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03464}03464           \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0] -\/= 1;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03465}03465           \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[1] -\/= 1;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03466}03466           \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03467}03467 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03468}03468         \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40abed39d2cabdadba8a0746381691ccf77}{OcTreeNames::LDB}}:}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03469}03469           \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0] -\/= 1;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03470}03470           \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[1] -\/= 1;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03471}03471           \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[2] -\/= 1;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03472}03472           \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03473}03473 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03474}03474         \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a6357637fc339bbb6745b6b5ce101b45a}{OcTreeNames::LUF}}:}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03475}03475           \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0] -\/= 1;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03476}03476           \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03477}03477 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03478}03478         \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a9717fc1b8f4e28fe7271b90dba57802d}{OcTreeNames::LUB}}:}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03479}03479           \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0] -\/= 1;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03480}03480           \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[2] -\/= 1;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03481}03481           \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03482}03482 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03483}03483         \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a172055f90c2c767808f297a31c9844be}{OcTreeNames::RDF}}:}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03484}03484           \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[1] -\/= 1;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03485}03485           \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03486}03486 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03487}03487         \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a8f4fba3e9fa2aa0c76ec6bb85fe89e1b}{OcTreeNames::RDB}}:}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03488}03488           \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[1] -\/= 1;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03489}03489           \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[2] -\/= 1;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03490}03490           \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03491}03491 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03492}03492         \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a9db7ad20ea4f76808cd9cf026229bcdc}{OcTreeNames::RUF}}:}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03493}03493           \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03494}03494 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03495}03495         \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a4876386f3bfaed6e524e2a251945b57d}{OcTreeNames::RUB}}:}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03496}03496           \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[2] -\/= 1;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03497}03497           \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03498}03498       \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03499}03499     \} \textcolor{comment}{// if son\_type!=Tree::OMEGA}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03500}03500   \} \textcolor{comment}{// End of level\_up\_local\_coord\_of\_node}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03501}03501 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03502}03502   \textcolor{comment}{//=========================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03503}03503 \textcolor{comment}{  /// Given the son type of the element and the local coordinate s of}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03504}03504 \textcolor{comment}{  /// a given node in the son element, return the local coordinate s in its}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03505}03505 \textcolor{comment}{  /// father element. 2D case.}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03506}03506 \textcolor{comment}{}  \textcolor{comment}{//=========================================================================}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03507}03507   \textcolor{keyword}{template}<>}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03508}\mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a02c06c060fe55ba537f03c5bd7066323}{03508}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a6a82f0212ff1277a1e8c33a6a81bfeff}{HelmholtzMGPreconditioner<2>::level\_up\_local\_coord\_of\_node}}(}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03509}03509     \textcolor{keyword}{const} \textcolor{keywordtype}{int}\& son\_type, \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}}\& \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}})}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03510}03510   \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03511}03511     \textcolor{comment}{// If the element is unrefined between the levels the local coordinate}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03512}03512     \textcolor{comment}{// of the node in one element is the same as that in the other element}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03513}03513     \textcolor{comment}{// therefore we only need to perform calculations if the levels are}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03514}03514     \textcolor{comment}{// different (i.e. son\_type is not OMEGA)}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03515}03515     \textcolor{keywordflow}{if} (son\_type != \mbox{\hyperlink{classoomph_1_1Tree_a9e532196340dcd859ff8207eea2ddbbc}{Tree::OMEGA}})}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03516}03516     \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03517}03517       \textcolor{comment}{// Scale the local coordinate from the range [-\/1,1]x[-\/1,1] to the range}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03518}03518       \textcolor{comment}{// [0,1]x[0,1] to match the width of the local coordinate range of the}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03519}03519       \textcolor{comment}{// fine element from the perspective of the father element. This}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03520}03520       \textcolor{comment}{// then simply requires a shift of the coordinates to match which type}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03521}03521       \textcolor{comment}{// of son element we're dealing with}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03522}03522       \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0] = (\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0] + 1.0) / 2.0;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03523}03523       \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[1] = (\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[1] + 1.0) / 2.0;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03524}03524 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03525}03525       \textcolor{comment}{// Cases: The son\_type determines how the local coordinates should be}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03526}03526       \textcolor{comment}{// shifted to give the local coordinates in the coarse mesh element}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03527}03527       \textcolor{keywordflow}{switch} (son\_type)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03528}03528       \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03529}03529           \textcolor{comment}{// If we're dealing with the bottom-\/left element we need to shift}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03530}03530           \textcolor{comment}{// the range [0,1]x[0,1] to [-\/1,0]x[-\/1,0]}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03531}03531         \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7dab02ffb52d34a25323447061474613d81}{QuadTreeNames::SW}}:}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03532}03532           \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0] -\/= 1;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03533}03533           \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[1] -\/= 1;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03534}03534           \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03535}03535 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03536}03536           \textcolor{comment}{// If we're dealing with the bottom-\/right element we need to shift}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03537}03537           \textcolor{comment}{// the range [0,1]x[0,1] to [0,1]x[-\/1,0]}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03538}03538         \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7da03479dd620c853ccd3c767125d6f29a4}{QuadTreeNames::SE}}:}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03539}03539           \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[1] -\/= 1;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03540}03540           \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03541}03541 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03542}03542           \textcolor{comment}{// If we're dealing with the top-\/right element we need to shift the}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03543}03543           \textcolor{comment}{// range [0,1]x[0,1] to [0,1]x[0,1], i.e. nothing needs to be done}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03544}03544         \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7daa66bca2eb077ff943b39305b1965826f}{QuadTreeNames::NE}}:}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03545}03545           \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03546}03546 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03547}03547           \textcolor{comment}{// If we're dealing with the top-\/left element we need to shift}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03548}03548           \textcolor{comment}{// the range [0,1]x[0,1] to [-\/1,0]x[0,1]}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03549}03549         \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7daa01c8378aad2e474250e6ebefb9fa942}{QuadTreeNames::NW}}:}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03550}03550           \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0] -\/= 1;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03551}03551           \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03552}03552       \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03553}03553     \} \textcolor{comment}{// if son\_type!=Tree::OMEGA}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03554}03554   \} \textcolor{comment}{// End of level\_up\_local\_coord\_of\_node}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03555}03555 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03556}03556   \textcolor{comment}{//===================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03557}03557 \textcolor{comment}{  /// Restrict residual (computed on current MG level) to}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03558}03558 \textcolor{comment}{  /// next coarser mesh and stick it into the coarse mesh RHS vector}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03559}03559 \textcolor{comment}{  /// using the restriction matrix (if restrict\_flag=1) or the transpose}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03560}03560 \textcolor{comment}{  /// of the interpolation matrix (if restrict\_flag=2)}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03561}03561 \textcolor{comment}{}  \textcolor{comment}{//===================================================================}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03562}03562   \textcolor{keyword}{template}<\textcolor{keywordtype}{unsigned} DIM>}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03563}\mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a013c21557363edf86790fa98a1da2aff}{03563}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a013c21557363edf86790fa98a1da2aff}{HelmholtzMGPreconditioner<DIM>::restrict\_residual}}(\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\& level)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03564}03564   \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03565}03565 \textcolor{preprocessor}{\#ifdef PARANOID}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03566}03566     \textcolor{comment}{// Check to make sure we can actually restrict the vector}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03567}03567     \textcolor{keywordflow}{if} (!(level < Nlevel -\/ 1))}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03568}03568     \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03569}03569       \textcolor{comment}{// Throw an error}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03570}03570       \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(\textcolor{stringliteral}{"{}Input level exceeds the possible parameter choice."{}},}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03571}03571                           OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03572}03572                           OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03573}03573     \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03574}03574 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03575}03575 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03576}03576     \textcolor{comment}{// Multiply the real part of the residual vector by the restriction}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03577}03577     \textcolor{comment}{// matrix on the level-\/th level}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03578}03578     Restriction\_matrices\_storage\_pt[level]-\/>multiply(}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03579}03579       Residual\_mg\_vectors\_storage[level][0],}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03580}03580       Rhs\_mg\_vectors\_storage[level + 1][0]);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03581}03581 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03582}03582     \textcolor{comment}{// Multiply the imaginary part of the residual vector by the restriction}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03583}03583     \textcolor{comment}{// matrix on the level-\/th level}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03584}03584     Restriction\_matrices\_storage\_pt[level]-\/>multiply(}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03585}03585       Residual\_mg\_vectors\_storage[level][1],}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03586}03586       Rhs\_mg\_vectors\_storage[level + 1][1]);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03587}03587 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03588}03588   \} \textcolor{comment}{// End of restrict\_residual}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03589}03589 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03590}03590   \textcolor{comment}{//===================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03591}03591 \textcolor{comment}{  /// Interpolate solution at current level onto}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03592}03592 \textcolor{comment}{  /// next finer mesh and correct the solution x at that level}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03593}03593 \textcolor{comment}{}  \textcolor{comment}{//===================================================================}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03594}03594   \textcolor{keyword}{template}<\textcolor{keywordtype}{unsigned} DIM>}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03595}\mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a8198021ac078989b3593acf8dbb7f572}{03595}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_a8198021ac078989b3593acf8dbb7f572}{HelmholtzMGPreconditioner<DIM>::interpolate\_and\_correct}}(}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03596}03596     \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\& level)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03597}03597   \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03598}03598 \textcolor{preprocessor}{\#ifdef PARANOID}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03599}03599     \textcolor{comment}{// Check to make sure we can actually restrict the vector}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03600}03600     \textcolor{keywordflow}{if} (!(level > 0))}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03601}03601     \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03602}03602       \textcolor{comment}{// Throw an error}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03603}03603       \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(\textcolor{stringliteral}{"{}Input level exceeds the possible parameter choice."{}},}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03604}03604                           OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03605}03605                           OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03606}03606     \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03607}03607 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03608}03608 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03609}03609     \textcolor{comment}{// Build distribution of a temporary vector (real part)}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03610}03610     \mbox{\hyperlink{classoomph_1_1DoubleVector}{DoubleVector}} temp\_soln\_r(}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03611}03611       X\_mg\_vectors\_storage[level -\/ 1][0].distribution\_pt());}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03612}03612 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03613}03613     \textcolor{comment}{// Build distribution of a temporary vector (imaginary part)}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03614}03614     \mbox{\hyperlink{classoomph_1_1DoubleVector}{DoubleVector}} temp\_soln\_c(}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03615}03615       X\_mg\_vectors\_storage[level -\/ 1][1].distribution\_pt());}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03616}03616 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03617}03617     \textcolor{comment}{// Interpolate the solution vector}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03618}03618     Interpolation\_matrices\_storage\_pt[level -\/ 1]-\/>multiply(}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03619}03619       X\_mg\_vectors\_storage[level][0], temp\_soln\_r);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03620}03620 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03621}03621     \textcolor{comment}{// Interpolate the solution vector}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03622}03622     Interpolation\_matrices\_storage\_pt[level -\/ 1]-\/>multiply(}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03623}03623       X\_mg\_vectors\_storage[level][1], temp\_soln\_c);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03624}03624 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03625}03625     \textcolor{comment}{// Update the real part of the solution}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03626}03626     X\_mg\_vectors\_storage[level -\/ 1][0] += temp\_soln\_r;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03627}03627 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03628}03628     \textcolor{comment}{// Update the imaginary part of the solution}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03629}03629     X\_mg\_vectors\_storage[level -\/ 1][1] += temp\_soln\_c;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03630}03630 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03631}03631   \} \textcolor{comment}{// End of interpolate\_and\_correct}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03632}03632 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03633}03633   \textcolor{comment}{//===================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03634}03634 \textcolor{comment}{  /// Linear solver. This is where the general V-\/cycle algorithm}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03635}03635 \textcolor{comment}{  /// is implemented}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03636}03636 \textcolor{comment}{}  \textcolor{comment}{//===================================================================}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03637}03637   \textcolor{keyword}{template}<\textcolor{keywordtype}{unsigned} DIM>}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03638}\mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_aedd9102297d40354bd8d769ca2c343cb}{03638}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1HelmholtzMGPreconditioner_aedd9102297d40354bd8d769ca2c343cb}{HelmholtzMGPreconditioner<DIM>::mg\_solve}}(\mbox{\hyperlink{classoomph_1_1Vector}{Vector<DoubleVector>}}\& result)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03639}03639   \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03640}03640     \textcolor{comment}{// If we're allowed to time things}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03641}03641     \textcolor{keywordtype}{double} t\_mg\_start = 0.0;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03642}03642     \textcolor{keywordflow}{if} (!Suppress\_v\_cycle\_output)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03643}03643     \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03644}03644       \textcolor{comment}{// Start the clock!}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03645}03645       t\_mg\_start = \mbox{\hyperlink{namespaceoomph_1_1TimingHelpers_a9fb6ad7e2e01b0914e9f7072ef9ebfa6}{TimingHelpers::timer}}();}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03646}03646     \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03647}03647 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03648}03648     \textcolor{comment}{// Current level}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03649}03649     \textcolor{keywordtype}{unsigned} finest\_level = 0;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03650}03650 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03651}03651     \textcolor{comment}{// Initialise the V-\/cycle counter}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03652}03652     V\_cycle\_counter = 0;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03653}03653 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03654}03654     \textcolor{comment}{// Calculate the norm of the residual then output}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03655}03655     \textcolor{keywordtype}{double} normalised\_residual\_norm = residual\_norm(finest\_level);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03656}03656     \textcolor{keywordflow}{if} (!Suppress\_v\_cycle\_output)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03657}03657     \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03658}03658       \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{}\(\backslash\)nResidual on finest level for V-\/cycle: "{}}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03659}03659                  << normalised\_residual\_norm << std::endl;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03660}03660     \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03661}03661 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03662}03662     \textcolor{comment}{// Outer loop over V-\/cycles}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03663}03663     \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03664}03664     \textcolor{comment}{// While the tolerance is not met and the maximum number of}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03665}03665     \textcolor{comment}{// V-\/cycles has not been completed}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03666}03666     \textcolor{keywordflow}{while} ((normalised\_residual\_norm > Tolerance) \&\&}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03667}03667            (V\_cycle\_counter != Nvcycle))}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03668}03668     \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03669}03669       \textcolor{comment}{// If the user did not wish to suppress the V-\/cycle output}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03670}03670       \textcolor{keywordflow}{if} (!Suppress\_v\_cycle\_output)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03671}03671       \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03672}03672         \textcolor{comment}{// Output the V-\/cycle counter}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03673}03673         \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{}\(\backslash\)nStarting V-\/cycle: "{}} << V\_cycle\_counter << std::endl;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03674}03674       \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03675}03675 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03676}03676       \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03677}03677       \textcolor{comment}{// Loop downwards over all levels that have coarser levels beneath them}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03678}03678       \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03679}03679       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < Nlevel -\/ 1; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03680}03680       \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03681}03681         \textcolor{comment}{// Initialise X\_mg and Residual\_mg to 0.0 except for the finest level}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03682}03682         \textcolor{comment}{// since X\_mg contains the current approximation to the solution and}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03683}03683         \textcolor{comment}{// Residual\_mg contains the RHS vector on the finest level}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03684}03684         \textcolor{keywordflow}{if} (\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} != 0)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03685}03685         \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03686}03686           \textcolor{comment}{// Initialise the real part of the solution vector}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03687}03687           X\_mg\_vectors\_storage[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}][0].initialise(0.0);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03688}03688 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03689}03689           \textcolor{comment}{// Initialise the imaginary part of the solution vector}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03690}03690           X\_mg\_vectors\_storage[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}][1].initialise(0.0);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03691}03691 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03692}03692           \textcolor{comment}{// Initialise the real part of the residual vector}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03693}03693           Residual\_mg\_vectors\_storage[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}][0].initialise(0.0);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03694}03694 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03695}03695           \textcolor{comment}{// Initialise the imaginary part of the residual vector}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03696}03696           Residual\_mg\_vectors\_storage[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}][1].initialise(0.0);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03697}03697         \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03698}03698 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03699}03699         \textcolor{comment}{// Perform a few pre-\/smoothing steps and return vector that contains}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03700}03700         \textcolor{comment}{// the residuals of the linear system at this level.}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03701}03701         pre\_smooth(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}});}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03702}03702 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03703}03703         \textcolor{comment}{// Restrict the residual to the next coarser mesh and}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03704}03704         \textcolor{comment}{// assign it to the RHS vector at that level}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03705}03705         restrict\_residual(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}});}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03706}03706 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03707}03707       \} \textcolor{comment}{// Moving down the V-\/cycle}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03708}03708 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03709}03709       \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03710}03710       \textcolor{comment}{// Reached the lowest level: Do a direct solve, using the RHS}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03711}03711       \textcolor{comment}{// vector obtained by restriction from above.}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03712}03712       \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03713}03713       direct\_solve();}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03714}03714 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03715}03715       \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03716}03716       \textcolor{comment}{// Loop upwards over all levels that have finer levels above them}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03717}03717       \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03718}03718       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = Nlevel -\/ 1; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} > 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}-\/-\/)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03719}03719       \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03720}03720         \textcolor{comment}{// Interpolate solution at current level onto}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03721}03721         \textcolor{comment}{// next finer mesh and correct the solution x at that level}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03722}03722         interpolate\_and\_correct(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}});}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03723}03723 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03724}03724         \textcolor{comment}{// Perform a few post-\/smoothing steps (ignore}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03725}03725         \textcolor{comment}{// vector that contains the residuals of the linear system}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03726}03726         \textcolor{comment}{// at this level)}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03727}03727         post\_smooth(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} -\/ 1);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03728}03728       \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03729}03729 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03730}03730       \textcolor{comment}{// Set counter for number of cycles (for doc)}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03731}03731       V\_cycle\_counter++;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03732}03732 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03733}03733       \textcolor{comment}{// Calculate the new residual norm then output (if allowed)}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03734}03734       normalised\_residual\_norm = residual\_norm(finest\_level);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03735}03735 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03736}03736       \textcolor{comment}{// Print the residual on the finest level}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03737}03737       \textcolor{keywordflow}{if} (!Suppress\_v\_cycle\_output)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03738}03738       \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03739}03739         \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{}Residual on finest level of V-\/cycle: "{}}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03740}03740                    << normalised\_residual\_norm << std::endl;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03741}03741       \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03742}03742     \} \textcolor{comment}{// End of the V-\/cycles}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03743}03743 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03744}03744     \textcolor{comment}{// Copy the solution into the result vector}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03745}03745     result = X\_mg\_vectors\_storage[finest\_level];}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03746}03746 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03747}03747     \textcolor{comment}{// Need an extra line space if V-\/cycle output is suppressed}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03748}03748     \textcolor{keywordflow}{if} (!Suppress\_v\_cycle\_output)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03749}03749     \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03750}03750       \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << std::endl;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03751}03751     \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03752}03752 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03753}03753     \textcolor{comment}{// If all output is to be suppressed}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03754}03754     \textcolor{keywordflow}{if} (!Suppress\_all\_output)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03755}03755     \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03756}03756       \textcolor{comment}{// Output number of V-\/cycles taken to solve}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03757}03757       \textcolor{keywordflow}{if} (normalised\_residual\_norm < Tolerance)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03758}03758       \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03759}03759         Has\_been\_solved = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03760}03760       \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03761}03761     \} \textcolor{comment}{// if (!Suppress\_all\_output)}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03762}03762 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03763}03763     \textcolor{comment}{// If the V-\/cycle output isn't suppressed}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03764}03764     \textcolor{keywordflow}{if} (!Suppress\_v\_cycle\_output)}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03765}03765     \{}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03766}03766       \textcolor{comment}{// Stop the clock}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03767}03767       \textcolor{keywordtype}{double} t\_mg\_end = \mbox{\hyperlink{namespaceoomph_1_1TimingHelpers_a9fb6ad7e2e01b0914e9f7072ef9ebfa6}{TimingHelpers::timer}}();}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03768}03768       \textcolor{keywordtype}{double} total\_G\_setup\_time = double(t\_mg\_end -\/ t\_mg\_start);}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03769}03769       \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{}CPU time for MG solver [sec]: "{}} << total\_G\_setup\_time}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03770}03770                  << std::endl;}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03771}03771     \}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03772}03772   \} \textcolor{comment}{// end of mg\_solve}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03773}03773 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03774}03774 \} \textcolor{comment}{// End of namespace oomph}}
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03775}03775 }
\DoxyCodeLine{\Hypertarget{helmholtz__geometric__multigrid_8h_source_l03776}03776 \textcolor{preprocessor}{\#endif}}

\end{DoxyCode}

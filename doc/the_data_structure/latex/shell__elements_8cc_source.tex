\hypertarget{shell__elements_8cc_source}{}\doxysection{shell\+\_\+elements.\+cc}
\label{shell__elements_8cc_source}\index{shell\_elements.cc@{shell\_elements.cc}}
\mbox{\hyperlink{shell__elements_8cc}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00001}00001 \textcolor{comment}{// LIC// ====================================================================}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00002}00002 \textcolor{comment}{// LIC// This file forms part of oomph-\/lib, the object-\/oriented,}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00003}00003 \textcolor{comment}{// LIC// multi-\/physics finite-\/element library, available}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00004}00004 \textcolor{comment}{// LIC// at http://www.oomph-\/lib.org.}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00005}00005 \textcolor{comment}{// LIC//}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00006}00006 \textcolor{comment}{// LIC// Copyright (C) 2006-\/2021 Matthias Heil and Andrew Hazel}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00007}00007 \textcolor{comment}{// LIC//}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00008}00008 \textcolor{comment}{// LIC// This library is free software; you can redistribute it and/or}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00009}00009 \textcolor{comment}{// LIC// modify it under the terms of the GNU Lesser General Public}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00010}00010 \textcolor{comment}{// LIC// License as published by the Free Software Foundation; either}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00011}00011 \textcolor{comment}{// LIC// version 2.1 of the License, or (at your option) any later version.}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00012}00012 \textcolor{comment}{// LIC//}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00013}00013 \textcolor{comment}{// LIC// This library is distributed in the hope that it will be useful,}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00014}00014 \textcolor{comment}{// LIC// but WITHOUT ANY WARRANTY; without even the implied warranty of}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00015}00015 \textcolor{comment}{// LIC// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00016}00016 \textcolor{comment}{// LIC// Lesser General Public License for more details.}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00017}00017 \textcolor{comment}{// LIC//}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00018}00018 \textcolor{comment}{// LIC// You should have received a copy of the GNU Lesser General Public}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00019}00019 \textcolor{comment}{// LIC// License along with this library; if not, write to the Free Software}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00020}00020 \textcolor{comment}{// LIC// Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00021}00021 \textcolor{comment}{// LIC// 02110-\/1301  USA.}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00022}00022 \textcolor{comment}{// LIC//}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00023}00023 \textcolor{comment}{// LIC// The authors may be contacted at oomph-\/lib@maths.man.ac.uk.}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00024}00024 \textcolor{comment}{// LIC//}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00025}00025 \textcolor{comment}{// LIC//====================================================================}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00026}00026 \textcolor{comment}{// Non-\/inline functions for Kirchhoff Love shell elements}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00027}00027 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{shell__elements_8h}{shell\_elements.h}}"{}}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00028}00028 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00029}00029 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00030}00030 \textcolor{keyword}{namespace }\mbox{\hyperlink{namespaceoomph}{oomph}}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00031}00031 \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00032}00032   \textcolor{comment}{//====================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00033}00033 \textcolor{comment}{  /// Default value for the Poisson ratio: 0.49 for no particular reason}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00034}00034 \textcolor{comment}{}  \textcolor{comment}{//====================================================================}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00035}00035   \textcolor{keywordtype}{double} \mbox{\hyperlink{classoomph_1_1KirchhoffLoveShellEquations_aaf47c41aacd7404d522737fc60ad2972}{KirchhoffLoveShellEquations::Default\_nu\_value}} = 0.49;}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00036}00036 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00037}00037   \textcolor{comment}{//=======================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00038}00038 \textcolor{comment}{  /// Static default value for timescale ratio (1.0 for natural scaling)}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00039}00039 \textcolor{comment}{}  \textcolor{comment}{//=======================================================================}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00040}00040   \textcolor{keywordtype}{double} \mbox{\hyperlink{classoomph_1_1KirchhoffLoveShellEquations_a62a599a88cfaa4a6b1c67eee80fb2d8b}{KirchhoffLoveShellEquations::Default\_lambda\_sq\_value}} = 1.0;}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00041}00041 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00042}00042   \textcolor{comment}{//====================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00043}00043 \textcolor{comment}{  /// Static default value for non-\/dim wall thickness (1/20)}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00044}00044 \textcolor{comment}{}  \textcolor{comment}{//===================================================================}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00045}00045   \textcolor{keywordtype}{double} \mbox{\hyperlink{classoomph_1_1KirchhoffLoveShellEquations_a8f671ff89dbfd2fbe3afa9636ac5960a}{KirchhoffLoveShellEquations::Default\_h\_value}} = 0.05;}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00046}00046 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00047}00047   \textcolor{comment}{//=======================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00048}00048 \textcolor{comment}{  /// Default load function (zero traction)}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00049}00049 \textcolor{comment}{}  \textcolor{comment}{//=======================================================================}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00050}\mbox{\hyperlink{classoomph_1_1KirchhoffLoveShellEquations_a13cfb1791eee82943ca56fef1a4f9dbe}{00050}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1KirchhoffLoveShellEquations_a13cfb1791eee82943ca56fef1a4f9dbe}{KirchhoffLoveShellEquations::Zero\_traction\_fct}}(\textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}}\& xi,}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00051}00051                                                       \textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}}\& x,}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00052}00052                                                       \textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}}\& \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7dabc60bec4cc294aa2adf92726c6d6823a}{N}},}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00053}00053                                                       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}}\& load)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00054}00054   \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00055}00055     \textcolor{keywordtype}{unsigned} n\_dim = load.size();}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00056}00056     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < n\_dim; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00057}00057     \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00058}00058       load[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] = 0.0;}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00059}00059     \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00060}00060   \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00061}00061 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00062}00062 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00063}00063   \textcolor{comment}{//=======================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00064}00064 \textcolor{comment}{  /// Static default for prestress (set to zero)}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00065}00065 \textcolor{comment}{}  \textcolor{comment}{//=======================================================================}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00066}00066   \textcolor{keywordtype}{double} \mbox{\hyperlink{classoomph_1_1KirchhoffLoveShellEquations_a746594460f0130626b5be18d6aca48d5}{KirchhoffLoveShellEquations::Zero\_prestress}} = 0.0;}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00067}00067 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00068}00068 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00069}00069   \textcolor{comment}{//======================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00070}00070 \textcolor{comment}{  /// Get normal to the shell}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00071}00071 \textcolor{comment}{}  \textcolor{comment}{//=====================================================================}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00072}\mbox{\hyperlink{classoomph_1_1KirchhoffLoveShellEquations_a797e455634ac8b8e8669c4adff84e644}{00072}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1KirchhoffLoveShellEquations_a797e455634ac8b8e8669c4adff84e644}{KirchhoffLoveShellEquations::get\_normal}}(\textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}}\& \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}},}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00073}00073                                                \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}}\& \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7dabc60bec4cc294aa2adf92726c6d6823a}{N}})}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00074}00074   \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00075}00075     \textcolor{comment}{// Set the dimension of the coordinates}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00076}00076     \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} n\_dim = 3;}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00077}00077 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00078}00078     \textcolor{comment}{// Set the number of lagrangian coordinates}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00079}00079     \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} n\_lagrangian = 2;}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00080}00080 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00081}00081     \textcolor{comment}{// Find out how many nodes there are}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00082}00082     \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} n\_node = \mbox{\hyperlink{classoomph_1_1FiniteElement_a6219ed269a6d89b5aa14659cce48905a}{nnode}}();}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00083}00083 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00084}00084     \textcolor{comment}{// Find out how many positional dofs there are}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00085}00085     \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} n\_position\_type = \mbox{\hyperlink{classoomph_1_1FiniteElement_a36f4cb7569a545a9d93b66e6ee03cc91}{nnodal\_position\_type}}();}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00086}00086 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00087}00087     \textcolor{comment}{// Set up memory for the shape functions}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00088}00088     \mbox{\hyperlink{classoomph_1_1Shape}{Shape}} psi(n\_node, n\_position\_type);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00089}00089     \mbox{\hyperlink{classoomph_1_1DShape}{DShape}} dpsidxi(n\_node, n\_position\_type, n\_lagrangian);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00090}00090 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00091}00091     \textcolor{comment}{// Could/Should we make this more general?}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00092}00092     \mbox{\hyperlink{classoomph_1_1DShape}{DShape}} d2psidxi(n\_node, n\_position\_type, 3);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00093}00093 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00094}00094 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00095}00095     \textcolor{comment}{// Call the derivatives of the shape functions:}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00096}00096     \textcolor{comment}{// d2psidxi(i,0) = \(\backslash\)f\$ \(\backslash\)partial\string^2 \(\backslash\)psi\_j / \(\backslash\)partial\string^2 \(\backslash\)xi\_0\string^2 \(\backslash\)f\$}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00097}00097     \textcolor{comment}{// d2psidxi(i,1) = \(\backslash\)f\$ \(\backslash\)partial\string^2 \(\backslash\)psi\_j / \(\backslash\)partial\string^2 \(\backslash\)xi\_1\string^2 \(\backslash\)f\$}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00098}00098     \textcolor{comment}{// d2psidxi(i,2) = \(\backslash\)f\$ \(\backslash\)partial\string^2 \(\backslash\)psi\_j/\(\backslash\)partial \(\backslash\)xi\_0 \(\backslash\)partial \(\backslash\)xi\_1 \(\backslash\)f\$}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00099}00099     (void)\mbox{\hyperlink{classoomph_1_1SolidFiniteElement_a4154c1d362b12905f2b5e6cbcfafa9f6}{dshape\_lagrangian}}(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, psi, dpsidxi);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00100}00100 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00101}00101     \textcolor{comment}{// Calculate local values of lagrangian position and}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00102}00102     \textcolor{comment}{// the derivative of global position wrt lagrangian coordinates}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00103}00103     \mbox{\hyperlink{classoomph_1_1DenseMatrix}{DenseMatrix<double>}} interpolated\_A(2, 3);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00104}00104 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00105}00105     \textcolor{comment}{// Initialise to zero}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00106}00106     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < n\_dim; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00107}00107     \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00108}00108       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < n\_lagrangian; j++)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00109}00109       \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00110}00110         interpolated\_A(j, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) = 0.0;}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00111}00111       \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00112}00112     \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00113}00113 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00114}00114     \textcolor{comment}{// Calculate displacements and derivatives}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00115}00115     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} l = 0; l < n\_node; l++)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00116}00116     \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00117}00117       \textcolor{comment}{// Loop over positional dofs}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00118}00118       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} k = 0; k < n\_position\_type; k++)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00119}00119       \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00120}00120         \textcolor{comment}{// Loop over displacement components (deformed position)}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00121}00121         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < n\_dim; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00122}00122         \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00123}00123           \textcolor{keywordtype}{double} x\_value = \mbox{\hyperlink{classoomph_1_1FiniteElement_add91f6d02c8819cf778bc76afb4f03d1}{raw\_nodal\_position\_gen}}(l, k, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}});}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00124}00124 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00125}00125           \textcolor{comment}{// Loop over derivative directions}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00126}00126           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < n\_lagrangian; j++)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00127}00127           \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00128}00128             interpolated\_A(j, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) += x\_value * dpsidxi(l, k, j);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00129}00129           \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00130}00130         \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00131}00131       \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00132}00132     \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00133}00133 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00134}00134     \textcolor{comment}{// Unscaled normal}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00135}00135     \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7dabc60bec4cc294aa2adf92726c6d6823a}{N}}[0] = (interpolated\_A(0, 1) * interpolated\_A(1, 2) -\/}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00136}00136             interpolated\_A(0, 2) * interpolated\_A(1, 1));}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00137}00137     \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7dabc60bec4cc294aa2adf92726c6d6823a}{N}}[1] = (interpolated\_A(0, 2) * interpolated\_A(1, 0) -\/}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00138}00138             interpolated\_A(0, 0) * interpolated\_A(1, 2));}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00139}00139     \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7dabc60bec4cc294aa2adf92726c6d6823a}{N}}[2] = (interpolated\_A(0, 0) * interpolated\_A(1, 1) -\/}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00140}00140             interpolated\_A(0, 1) * interpolated\_A(1, 0));}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00141}00141 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00142}00142     \textcolor{comment}{// Normalise}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00143}00143     \textcolor{keywordtype}{double} norm = 1.0 / sqrt(\mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7dabc60bec4cc294aa2adf92726c6d6823a}{N}}[0] * \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7dabc60bec4cc294aa2adf92726c6d6823a}{N}}[0] + \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7dabc60bec4cc294aa2adf92726c6d6823a}{N}}[1] * \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7dabc60bec4cc294aa2adf92726c6d6823a}{N}}[1] + \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7dabc60bec4cc294aa2adf92726c6d6823a}{N}}[2] * \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7dabc60bec4cc294aa2adf92726c6d6823a}{N}}[2]);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00144}00144     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < 3; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00145}00145     \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00146}00146       \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7dabc60bec4cc294aa2adf92726c6d6823a}{N}}[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] *= norm;}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00147}00147     \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00148}00148   \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00149}00149 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00150}00150 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00151}00151   \textcolor{comment}{//======================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00152}00152 \textcolor{comment}{  /// Get strain and bending tensors}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00153}00153 \textcolor{comment}{}  \textcolor{comment}{//=====================================================================}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00154}\mbox{\hyperlink{classoomph_1_1KirchhoffLoveShellEquations_ad5a82826cad1b458c849e44114ea7d63}{00154}}   std::pair<double, double> \mbox{\hyperlink{classoomph_1_1KirchhoffLoveShellEquations_ad5a82826cad1b458c849e44114ea7d63}{KirchhoffLoveShellEquations::get\_strain\_and\_bend}}(}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00155}00155     \textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}}\& \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, \mbox{\hyperlink{classoomph_1_1DenseDoubleMatrix}{DenseDoubleMatrix}}\& strain, \mbox{\hyperlink{classoomph_1_1DenseDoubleMatrix}{DenseDoubleMatrix}}\& bend)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00156}00156   \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00157}00157     \textcolor{comment}{// Set the dimension of the coordinates}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00158}00158     \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} n\_dim = 3;}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00159}00159 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00160}00160     \textcolor{comment}{// Set the number of lagrangian coordinates}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00161}00161     \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} n\_lagrangian = 2;}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00162}00162 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00163}00163     \textcolor{comment}{// Find out how many nodes there are}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00164}00164     \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} n\_node = \mbox{\hyperlink{classoomph_1_1FiniteElement_a6219ed269a6d89b5aa14659cce48905a}{nnode}}();}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00165}00165 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00166}00166     \textcolor{comment}{// Find out how many positional dofs there are}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00167}00167     \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} n\_position\_type = \mbox{\hyperlink{classoomph_1_1FiniteElement_a36f4cb7569a545a9d93b66e6ee03cc91}{nnodal\_position\_type}}();}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00168}00168 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00169}00169     \textcolor{comment}{// Set up memory for the shape functions}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00170}00170     \mbox{\hyperlink{classoomph_1_1Shape}{Shape}} psi(n\_node, n\_position\_type);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00171}00171     \mbox{\hyperlink{classoomph_1_1DShape}{DShape}} dpsidxi(n\_node, n\_position\_type, n\_lagrangian);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00172}00172 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00173}00173     \textcolor{comment}{// Could/Should we make this more general?}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00174}00174     \mbox{\hyperlink{classoomph_1_1DShape}{DShape}} d2psidxi(n\_node, n\_position\_type, 3);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00175}00175 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00176}00176 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00177}00177     \textcolor{comment}{// Call the derivatives of the shape functions:}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00178}00178     \textcolor{comment}{// d2psidxi(i,0) = \(\backslash\)f\$ \(\backslash\)partial\string^2 \(\backslash\)psi\_j / \(\backslash\)partial\string^2 \(\backslash\)xi\_0\string^2 \(\backslash\)f\$}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00179}00179     \textcolor{comment}{// d2psidxi(i,1) = \(\backslash\)f\$ \(\backslash\)partial\string^2 \(\backslash\)psi\_j / \(\backslash\)partial\string^2 \(\backslash\)xi\_1\string^2 \(\backslash\)f\$}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00180}00180     \textcolor{comment}{// d2psidxi(i,2) = \(\backslash\)f\$ \(\backslash\)partial\string^2 \(\backslash\)psi\_j/\(\backslash\)partial \(\backslash\)xi\_0 \(\backslash\)partial \(\backslash\)xi\_1 \(\backslash\)f\$}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00181}00181     (void)\mbox{\hyperlink{classoomph_1_1SolidFiniteElement_ac87b12010837978f9a419c8097721af4}{d2shape\_lagrangian}}(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, psi, dpsidxi, d2psidxi);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00182}00182 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00183}00183     \textcolor{comment}{// Calculate local values of lagrangian position and}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00184}00184     \textcolor{comment}{// the derivative of global position wrt lagrangian coordinates}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00185}00185     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} \mbox{\hyperlink{classoomph_1_1SolidFiniteElement_a94ab4919b462d52cfdf6235bb9367d15}{interpolated\_xi}}(2, 0.0), \mbox{\hyperlink{classoomph_1_1FiniteElement_a5a9c1ead9819cd17603096e63087020f}{interpolated\_x}}(3, 0.0);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00186}00186     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} accel(3, 0.0);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00187}00187     \mbox{\hyperlink{classoomph_1_1DenseMatrix}{DenseMatrix<double>}} interpolated\_A(2, 3);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00188}00188     \mbox{\hyperlink{classoomph_1_1DenseMatrix}{DenseMatrix<double>}} interpolated\_dAdxi(3);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00189}00189 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00190}00190     \textcolor{comment}{// Initialise to zero}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00191}00191     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < n\_dim; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00192}00192     \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00193}00193       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < n\_lagrangian; j++)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00194}00194       \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00195}00195         interpolated\_A(j, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) = 0.0;}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00196}00196       \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00197}00197       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < 3; j++)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00198}00198       \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00199}00199         interpolated\_dAdxi(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}, j) = 0.0;}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00200}00200       \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00201}00201     \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00202}00202 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00203}00203     \textcolor{comment}{// Calculate displacements and derivatives}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00204}00204     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} l = 0; l < n\_node; l++)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00205}00205     \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00206}00206       \textcolor{comment}{// Loop over positional dofs}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00207}00207       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} k = 0; k < n\_position\_type; k++)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00208}00208       \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00209}00209         \textcolor{comment}{// Loop over lagrangian coordinate directions}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00210}00210         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < n\_lagrangian; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00211}00211         \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00212}00212           \mbox{\hyperlink{classoomph_1_1SolidFiniteElement_a94ab4919b462d52cfdf6235bb9367d15}{interpolated\_xi}}[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] +=}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00213}00213             \mbox{\hyperlink{classoomph_1_1SolidFiniteElement_a1fe7adc8a71165fb86404d6028d19ae1}{raw\_lagrangian\_position\_gen}}(l, k, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) * psi(l, k);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00214}00214         \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00215}00215 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00216}00216         \textcolor{comment}{// Loop over displacement components (deformed position)}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00217}00217         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < n\_dim; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00218}00218         \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00219}00219           \textcolor{keywordtype}{double} x\_value = \mbox{\hyperlink{classoomph_1_1FiniteElement_add91f6d02c8819cf778bc76afb4f03d1}{raw\_nodal\_position\_gen}}(l, k, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}});}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00220}00220 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00221}00221           \textcolor{comment}{// Calculate interpolated (deformed) position}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00222}00222           \mbox{\hyperlink{classoomph_1_1FiniteElement_a5a9c1ead9819cd17603096e63087020f}{interpolated\_x}}[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] += x\_value * psi(l, k);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00223}00223 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00224}00224           \textcolor{comment}{// Calculate the acceleration}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00225}00225           accel[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] += \mbox{\hyperlink{classoomph_1_1FiniteElement_ab558009bb2957be292181d44b7e08df3}{raw\_dnodal\_position\_gen\_dt}}(2, l, k, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) * psi(l, k);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00226}00226 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00227}00227           \textcolor{comment}{// Loop over derivative directions}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00228}00228           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < n\_lagrangian; j++)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00229}00229           \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00230}00230             interpolated\_A(j, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) += x\_value * dpsidxi(l, k, j);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00231}00231           \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00232}00232           \textcolor{comment}{// Loop over the second derivative directions}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00233}00233           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < 3; j++)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00234}00234           \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00235}00235             interpolated\_dAdxi(j, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) += x\_value * d2psidxi(l, k, j);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00236}00236           \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00237}00237         \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00238}00238       \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00239}00239     \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00240}00240 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00241}00241     \textcolor{comment}{// Get the values of the undeformed parameters}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00242}00242     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} interpolated\_R(3);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00243}00243     \mbox{\hyperlink{classoomph_1_1DenseMatrix}{DenseMatrix<double>}} interpolated\_a(2, 3);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00244}00244     \mbox{\hyperlink{classoomph_1_1RankThreeTensor}{RankThreeTensor<double>}} dadxi(2, 2, 3);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00245}00245 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00246}00246     \textcolor{comment}{// Read out the undeformed position from the geometric object}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00247}00247     \mbox{\hyperlink{classoomph_1_1KirchhoffLoveShellEquations_aec919dec7bab41fe5f7012ae8ebc8411}{Undeformed\_midplane\_pt}}-\/>\mbox{\hyperlink{classoomph_1_1GeomObject_a08472dbe196123490ea109762cefd00c}{d2position}}(}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00248}00248       \mbox{\hyperlink{classoomph_1_1SolidFiniteElement_a94ab4919b462d52cfdf6235bb9367d15}{interpolated\_xi}}, interpolated\_R, interpolated\_a, dadxi);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00249}00249 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00250}00250     \textcolor{comment}{// Copy the values of the second derivatives into a slightly}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00251}00251     \textcolor{comment}{// different data structure, where the mixed derivatives [0][1] and [1][0]}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00252}00252     \textcolor{comment}{// are given by the single index [2]}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00253}00253     \mbox{\hyperlink{classoomph_1_1DenseMatrix}{DenseMatrix<double>}} interpolated\_dadxi(3);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00254}00254     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < 3; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00255}00255     \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00256}00256       interpolated\_dadxi(0, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) = dadxi(0, 0, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}});}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00257}00257       interpolated\_dadxi(1, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) = dadxi(1, 1, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}});}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00258}00258       interpolated\_dadxi(2, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) = dadxi(0, 1, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}});}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00259}00259     \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00260}00260 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00261}00261     \textcolor{comment}{// Declare and calculate the undeformed and deformed metric tensor}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00262}00262     \textcolor{keywordtype}{double} a[2][2], A[2][2], aup[2][2], Aup[2][2];}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00263}00263 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00264}00264     \textcolor{comment}{// Assign values of A and gamma}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00265}00265     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} al = 0; al < 2; al++)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00266}00266     \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00267}00267       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} be = 0; be < 2; be++)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00268}00268       \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00269}00269         \textcolor{comment}{// Initialise a(al,be) and A(al,be) to zero}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00270}00270         a[al][be] = 0.0;}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00271}00271         A[al][be] = 0.0;}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00272}00272         \textcolor{comment}{// Now calculate the dot product}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00273}00273         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} k = 0; k < 3; k++)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00274}00274         \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00275}00275           a[al][be] += interpolated\_a(al, k) * interpolated\_a(be, k);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00276}00276           A[al][be] += interpolated\_A(al, k) * interpolated\_A(be, k);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00277}00277         \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00278}00278         \textcolor{comment}{// Calculate strain tensor}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00279}00279         strain(al, be) = 0.5 * (A[al][be] -\/ a[al][be]);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00280}00280       \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00281}00281     \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00282}00282 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00283}00283     \textcolor{comment}{// Calculate the contravariant metric tensor}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00284}00284     \textcolor{keywordtype}{double} adet = \mbox{\hyperlink{classoomph_1_1KirchhoffLoveShellEquations_a6badfc9d15c8f6a8a66f663019e19cee}{calculate\_contravariant}}(a, aup);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00285}00285     \textcolor{keywordtype}{double} Adet = \mbox{\hyperlink{classoomph_1_1KirchhoffLoveShellEquations_a6badfc9d15c8f6a8a66f663019e19cee}{calculate\_contravariant}}(A, Aup);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00286}00286 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00287}00287     \textcolor{comment}{// Square roots are expensive, so let's do them once here}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00288}00288     \textcolor{keywordtype}{double} sqrt\_adet = sqrt(adet);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00289}00289     \textcolor{keywordtype}{double} sqrt\_Adet = sqrt(Adet);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00290}00290 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00291}00291     \textcolor{comment}{// Calculate the normal Vectors}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00292}00292     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} n(3), \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7dabc60bec4cc294aa2adf92726c6d6823a}{N}}(3);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00293}00293     n[0] = (interpolated\_a(0, 1) * interpolated\_a(1, 2) -\/}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00294}00294             interpolated\_a(0, 2) * interpolated\_a(1, 1)) /}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00295}00295            sqrt\_adet;}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00296}00296     n[1] = (interpolated\_a(0, 2) * interpolated\_a(1, 0) -\/}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00297}00297             interpolated\_a(0, 0) * interpolated\_a(1, 2)) /}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00298}00298            sqrt\_adet;}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00299}00299     n[2] = (interpolated\_a(0, 0) * interpolated\_a(1, 1) -\/}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00300}00300             interpolated\_a(0, 1) * interpolated\_a(1, 0)) /}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00301}00301            sqrt\_adet;}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00302}00302     \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7dabc60bec4cc294aa2adf92726c6d6823a}{N}}[0] = (interpolated\_A(0, 1) * interpolated\_A(1, 2) -\/}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00303}00303             interpolated\_A(0, 2) * interpolated\_A(1, 1)) /}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00304}00304            sqrt\_Adet;}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00305}00305     \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7dabc60bec4cc294aa2adf92726c6d6823a}{N}}[1] = (interpolated\_A(0, 2) * interpolated\_A(1, 0) -\/}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00306}00306             interpolated\_A(0, 0) * interpolated\_A(1, 2)) /}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00307}00307            sqrt\_Adet;}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00308}00308     \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7dabc60bec4cc294aa2adf92726c6d6823a}{N}}[2] = (interpolated\_A(0, 0) * interpolated\_A(1, 1) -\/}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00309}00309             interpolated\_A(0, 1) * interpolated\_A(1, 0)) /}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00310}00310            sqrt\_Adet;}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00311}00311 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00312}00312 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00313}00313     \textcolor{comment}{// Calculate the curvature tensors}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00314}00314     \textcolor{keywordtype}{double} b[2][2], \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a43c804e2bcf9862a4bf629d5f01761e8}{B}}[2][2];}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00315}00315 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00316}00316     b[0][0] = n[0] * interpolated\_dadxi(0, 0) +}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00317}00317               n[1] * interpolated\_dadxi(0, 1) + n[2] * interpolated\_dadxi(0, 2);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00318}00318 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00319}00319     \textcolor{comment}{// Off-\/diagonal terms are the same}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00320}00320     b[0][1] = b[1][0] = n[0] * interpolated\_dadxi(2, 0) +}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00321}00321                         n[1] * interpolated\_dadxi(2, 1) +}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00322}00322                         n[2] * interpolated\_dadxi(2, 2);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00323}00323 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00324}00324     b[1][1] = n[0] * interpolated\_dadxi(1, 0) +}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00325}00325               n[1] * interpolated\_dadxi(1, 1) + n[2] * interpolated\_dadxi(1, 2);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00326}00326 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00327}00327     \textcolor{comment}{// Deformed curvature tensor}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00328}00328     \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a43c804e2bcf9862a4bf629d5f01761e8}{B}}[0][0] = \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7dabc60bec4cc294aa2adf92726c6d6823a}{N}}[0] * interpolated\_dAdxi(0, 0) +}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00329}00329               \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7dabc60bec4cc294aa2adf92726c6d6823a}{N}}[1] * interpolated\_dAdxi(0, 1) + \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7dabc60bec4cc294aa2adf92726c6d6823a}{N}}[2] * interpolated\_dAdxi(0, 2);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00330}00330 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00331}00331     \textcolor{comment}{// Off-\/diagonal terms are the same}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00332}00332     \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a43c804e2bcf9862a4bf629d5f01761e8}{B}}[0][1] = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a43c804e2bcf9862a4bf629d5f01761e8}{B}}[1][0] = \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7dabc60bec4cc294aa2adf92726c6d6823a}{N}}[0] * interpolated\_dAdxi(2, 0) +}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00333}00333                         \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7dabc60bec4cc294aa2adf92726c6d6823a}{N}}[1] * interpolated\_dAdxi(2, 1) +}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00334}00334                         \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7dabc60bec4cc294aa2adf92726c6d6823a}{N}}[2] * interpolated\_dAdxi(2, 2);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00335}00335 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00336}00336     \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a43c804e2bcf9862a4bf629d5f01761e8}{B}}[1][1] = \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7dabc60bec4cc294aa2adf92726c6d6823a}{N}}[0] * interpolated\_dAdxi(1, 0) +}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00337}00337               \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7dabc60bec4cc294aa2adf92726c6d6823a}{N}}[1] * interpolated\_dAdxi(1, 1) + \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7dabc60bec4cc294aa2adf92726c6d6823a}{N}}[2] * interpolated\_dAdxi(1, 2);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00338}00338 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00339}00339     \textcolor{comment}{// Set up the change of curvature tensor}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00340}00340     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < 2; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00341}00341     \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00342}00342       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < 2; j++)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00343}00343       \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00344}00344         bend(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}, j) = b[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}][j] -\/ \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a43c804e2bcf9862a4bf629d5f01761e8}{B}}[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}][j];}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00345}00345       \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00346}00346     \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00347}00347 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00348}00348     \textcolor{comment}{// Return undeformed and deformed determinant of in-\/plane metric}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00349}00349     \textcolor{comment}{// tensor}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00350}00350     \textcolor{keywordflow}{return} std::make\_pair(adet, Adet);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00351}00351   \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00352}00352 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00353}00353 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00354}00354   \textcolor{comment}{//====================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00355}00355 \textcolor{comment}{  /// Return the residuals for the equations of KL shell theory}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00356}00356 \textcolor{comment}{}  \textcolor{comment}{//====================================================================}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00357}\mbox{\hyperlink{classoomph_1_1KirchhoffLoveShellEquations_a083c16732460cb430553239b9eaa1325}{00357}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1KirchhoffLoveShellEquations_a083c16732460cb430553239b9eaa1325}{KirchhoffLoveShellEquations::fill\_in\_contribution\_to\_residuals\_shell}}(}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00358}00358     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}}\& residuals)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00359}00359   \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00360}00360     \textcolor{comment}{// Set the dimension of the coordinates}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00361}00361     \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} n\_dim = 3;}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00362}00362 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00363}00363     \textcolor{comment}{// Set the number of lagrangian coordinates}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00364}00364     \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} n\_lagrangian = 2;}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00365}00365 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00366}00366     \textcolor{comment}{// Find out how many nodes there are}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00367}00367     \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} n\_node = \mbox{\hyperlink{classoomph_1_1FiniteElement_a6219ed269a6d89b5aa14659cce48905a}{nnode}}();}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00368}00368 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00369}00369     \textcolor{comment}{// Find out how many positional dofs there are}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00370}00370     \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} n\_position\_type = \mbox{\hyperlink{classoomph_1_1FiniteElement_a36f4cb7569a545a9d93b66e6ee03cc91}{nnodal\_position\_type}}();}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00371}00371 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00372}00372     \textcolor{comment}{// Set up memory for the shape functions}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00373}00373     \mbox{\hyperlink{classoomph_1_1Shape}{Shape}} psi(n\_node, n\_position\_type);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00374}00374     \mbox{\hyperlink{classoomph_1_1DShape}{DShape}} dpsidxi(n\_node, n\_position\_type, n\_lagrangian);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00375}00375 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00376}00376     \textcolor{comment}{// Could/Should we make this more general?}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00377}00377     \mbox{\hyperlink{classoomph_1_1DShape}{DShape}} d2psidxi(n\_node, n\_position\_type, 3);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00378}00378 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00379}00379     \textcolor{comment}{// Set the value of n\_intpt}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00380}00380     \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} n\_intpt = \mbox{\hyperlink{classoomph_1_1FiniteElement_a1a4723c4ee3fe4c6404203bb987f804e}{integral\_pt}}()-\/>\mbox{\hyperlink{classoomph_1_1Integral_a1a270de9d99a1fcf1d25a6c1017f65fa}{nweight}}();}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00381}00381 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00382}00382     \textcolor{comment}{// Get Physical Variables from Element}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00383}00383     \textcolor{comment}{// External pressure, Poisson ratio , and non-\/dim thickness h}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00384}00384     \textcolor{keyword}{const} \textcolor{keywordtype}{double} nu\_cached = \mbox{\hyperlink{classoomph_1_1KirchhoffLoveShellEquations_ad23e213c6f5fd10575a4fb1aba27eed3}{nu}}();}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00385}00385     \textcolor{keyword}{const} \textcolor{keywordtype}{double} h\_cached = \mbox{\hyperlink{classoomph_1_1KirchhoffLoveShellEquations_a5228ebb72cceae574ba2a824ddab6725}{h}}();}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00386}00386     \textcolor{keyword}{const} \textcolor{keywordtype}{double} lambda\_sq\_cached = \mbox{\hyperlink{classoomph_1_1KirchhoffLoveShellEquations_a0c11eef145483321f7376b6a09057520}{lambda\_sq}}();}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00387}00387 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00388}00388     \textcolor{comment}{// Integers used to store the local equation numbers}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00389}00389     \textcolor{keywordtype}{int} local\_eqn = 0;}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00390}00390 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00391}00391     \textcolor{keyword}{const} \textcolor{keywordtype}{double} bending\_scale = (1.0 / 12.0) * h\_cached * h\_cached;}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00392}00392 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00393}00393     \textcolor{comment}{// Loop over the integration points}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00394}00394     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} ipt = 0; ipt < n\_intpt; ipt++)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00395}00395     \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00396}00396       \textcolor{comment}{// Get the integral weight}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00397}00397       \textcolor{keywordtype}{double} w = \mbox{\hyperlink{classoomph_1_1FiniteElement_a1a4723c4ee3fe4c6404203bb987f804e}{integral\_pt}}()-\/>\mbox{\hyperlink{classoomph_1_1Integral_ac65335e2aab120b285b3d6c294507b06}{weight}}(ipt);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00398}00398 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00399}00399       \textcolor{comment}{// Call the derivatives of the shape functions:}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00400}00400       \textcolor{comment}{// d2psidxi(i,0) = \(\backslash\)f\$ \(\backslash\)partial\string^2 \(\backslash\)psi\_j / \(\backslash\)partial\string^2 \(\backslash\)xi\_0\string^2 \(\backslash\)f\$}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00401}00401       \textcolor{comment}{// d2psidxi(i,1) = \(\backslash\)f\$ \(\backslash\)partial\string^2 \(\backslash\)psi\_j / \(\backslash\)partial\string^2 \(\backslash\)xi\_1\string^2 \(\backslash\)f\$}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00402}00402       \textcolor{comment}{// d2psidxi(i,2) = \(\backslash\)f\$ \(\backslash\)partial\string^2 \(\backslash\)psi\_j/\(\backslash\)partial \(\backslash\)xi\_0 \(\backslash\)partial \(\backslash\)xi\_1 \(\backslash\)f\$}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00403}00403       \textcolor{keywordtype}{double} J = \mbox{\hyperlink{classoomph_1_1SolidFiniteElement_a69d17ec5fa308adae42e2f3171649bfe}{d2shape\_lagrangian\_at\_knot}}(ipt, psi, dpsidxi, d2psidxi);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00404}00404 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00405}00405       \textcolor{comment}{// Premultiply the weights and the Jacobian}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00406}00406       \textcolor{keywordtype}{double} \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6}{W}} = w * J;}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00407}00407 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00408}00408       \textcolor{comment}{// Calculate local values of lagrangian position and}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00409}00409       \textcolor{comment}{// the derivative of global position wrt lagrangian coordinates}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00410}00410       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} \mbox{\hyperlink{classoomph_1_1SolidFiniteElement_a94ab4919b462d52cfdf6235bb9367d15}{interpolated\_xi}}(2, 0.0), \mbox{\hyperlink{classoomph_1_1FiniteElement_a5a9c1ead9819cd17603096e63087020f}{interpolated\_x}}(3, 0.0);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00411}00411       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} accel(3, 0.0);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00412}00412       \mbox{\hyperlink{classoomph_1_1DenseMatrix}{DenseMatrix<double>}} interpolated\_A(2, 3);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00413}00413       \mbox{\hyperlink{classoomph_1_1DenseMatrix}{DenseMatrix<double>}} interpolated\_dAdxi(3);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00414}00414 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00415}00415       \textcolor{comment}{// Initialise to zero}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00416}00416       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < n\_dim; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00417}00417       \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00418}00418         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < n\_lagrangian; j++)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00419}00419         \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00420}00420           interpolated\_A(j, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) = 0.0;}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00421}00421         \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00422}00422         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < 3; j++)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00423}00423         \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00424}00424           interpolated\_dAdxi(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}, j) = 0.0;}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00425}00425         \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00426}00426       \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00427}00427 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00428}00428       \textcolor{comment}{// Calculate displacements and derivatives}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00429}00429       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} l = 0; l < n\_node; l++)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00430}00430       \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00431}00431         \textcolor{comment}{// Loop over positional dofs}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00432}00432         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} k = 0; k < n\_position\_type; k++)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00433}00433         \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00434}00434           \textcolor{comment}{// Loop over lagrangian coordinate directions}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00435}00435           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < n\_lagrangian; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00436}00436           \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00437}00437             \mbox{\hyperlink{classoomph_1_1SolidFiniteElement_a94ab4919b462d52cfdf6235bb9367d15}{interpolated\_xi}}[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] +=}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00438}00438               \mbox{\hyperlink{classoomph_1_1SolidFiniteElement_a1fe7adc8a71165fb86404d6028d19ae1}{raw\_lagrangian\_position\_gen}}(l, k, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) * psi(l, k);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00439}00439           \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00440}00440 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00441}00441           \textcolor{comment}{// Loop over displacement components (deformed position)}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00442}00442           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < n\_dim; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00443}00443           \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00444}00444             \textcolor{keywordtype}{double} x\_value = \mbox{\hyperlink{classoomph_1_1FiniteElement_add91f6d02c8819cf778bc76afb4f03d1}{raw\_nodal\_position\_gen}}(l, k, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}});}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00445}00445 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00446}00446             \textcolor{comment}{// Calculate interpolated (deformed) position}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00447}00447             \mbox{\hyperlink{classoomph_1_1FiniteElement_a5a9c1ead9819cd17603096e63087020f}{interpolated\_x}}[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] += x\_value * psi(l, k);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00448}00448 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00449}00449             \textcolor{comment}{// Calculate the acceleration}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00450}00450             accel[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] += \mbox{\hyperlink{classoomph_1_1FiniteElement_ab558009bb2957be292181d44b7e08df3}{raw\_dnodal\_position\_gen\_dt}}(2, l, k, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) * psi(l, k);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00451}00451 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00452}00452             \textcolor{comment}{// Loop over derivative directions}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00453}00453             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < n\_lagrangian; j++)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00454}00454             \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00455}00455               interpolated\_A(j, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) += x\_value * dpsidxi(l, k, j);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00456}00456             \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00457}00457             \textcolor{comment}{// Loop over the second derivative directions}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00458}00458             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < 3; j++)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00459}00459             \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00460}00460               interpolated\_dAdxi(j, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) += x\_value * d2psidxi(l, k, j);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00461}00461             \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00462}00462           \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00463}00463         \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00464}00464       \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00465}00465 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00466}00466       \textcolor{comment}{// Get the values of the undeformed parameters}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00467}00467       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} interpolated\_R(3);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00468}00468       \mbox{\hyperlink{classoomph_1_1DenseMatrix}{DenseMatrix<double>}} interpolated\_a(2, 3);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00469}00469       \mbox{\hyperlink{classoomph_1_1RankThreeTensor}{RankThreeTensor<double>}} dadxi(2, 2, 3);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00470}00470 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00471}00471       \textcolor{comment}{// Read out the undeformed position from the geometric object}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00472}00472       \mbox{\hyperlink{classoomph_1_1KirchhoffLoveShellEquations_aec919dec7bab41fe5f7012ae8ebc8411}{Undeformed\_midplane\_pt}}-\/>\mbox{\hyperlink{classoomph_1_1GeomObject_a08472dbe196123490ea109762cefd00c}{d2position}}(}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00473}00473         \mbox{\hyperlink{classoomph_1_1SolidFiniteElement_a94ab4919b462d52cfdf6235bb9367d15}{interpolated\_xi}}, interpolated\_R, interpolated\_a, dadxi);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00474}00474 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00475}00475       \textcolor{comment}{// Copy the values of the second derivatives into a slightly}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00476}00476       \textcolor{comment}{// different data structure, where the mixed derivatives [0][1] and [1][0]}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00477}00477       \textcolor{comment}{// are given by the single index [2]}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00478}00478       \mbox{\hyperlink{classoomph_1_1DenseMatrix}{DenseMatrix<double>}} interpolated\_dadxi(3);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00479}00479       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < 3; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00480}00480       \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00481}00481         interpolated\_dadxi(0, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) = dadxi(0, 0, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}});}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00482}00482         interpolated\_dadxi(1, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) = dadxi(1, 1, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}});}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00483}00483         interpolated\_dadxi(2, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) = dadxi(0, 1, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}});}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00484}00484       \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00485}00485 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00486}00486       \textcolor{comment}{// Declare and calculate the undeformed and deformed metric tensor,}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00487}00487       \textcolor{comment}{// the strain tensor}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00488}00488       \textcolor{keywordtype}{double} a[2][2], A[2][2], aup[2][2], Aup[2][2], gamma[2][2];}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00489}00489 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00490}00490       \textcolor{comment}{// Assign values of A and gamma}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00491}00491       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} al = 0; al < 2; al++)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00492}00492       \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00493}00493         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} be = 0; be < 2; be++)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00494}00494         \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00495}00495           \textcolor{comment}{// Initialise a(al,be) and A(al,be) to zero}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00496}00496           a[al][be] = 0.0;}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00497}00497           A[al][be] = 0.0;}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00498}00498           \textcolor{comment}{// Now calculate the dot product}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00499}00499           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} k = 0; k < 3; k++)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00500}00500           \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00501}00501             a[al][be] += interpolated\_a(al, k) * interpolated\_a(be, k);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00502}00502             A[al][be] += interpolated\_A(al, k) * interpolated\_A(be, k);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00503}00503           \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00504}00504           \textcolor{comment}{// Calculate strain tensor}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00505}00505           gamma[al][be] = 0.5 * (A[al][be] -\/ a[al][be]);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00506}00506         \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00507}00507       \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00508}00508 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00509}00509       \textcolor{comment}{// Calculate the contravariant metric tensor}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00510}00510       \textcolor{keywordtype}{double} adet = \mbox{\hyperlink{classoomph_1_1KirchhoffLoveShellEquations_a6badfc9d15c8f6a8a66f663019e19cee}{calculate\_contravariant}}(a, aup);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00511}00511       \textcolor{keywordtype}{double} Adet = \mbox{\hyperlink{classoomph_1_1KirchhoffLoveShellEquations_a6badfc9d15c8f6a8a66f663019e19cee}{calculate\_contravariant}}(A, Aup);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00512}00512 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00513}00513       \textcolor{comment}{// Square roots are expensive, so let's do them once here}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00514}00514       \textcolor{keywordtype}{double} sqrt\_adet = sqrt(adet);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00515}00515       \textcolor{keywordtype}{double} sqrt\_Adet = sqrt(Adet);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00516}00516 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00517}00517       \textcolor{comment}{// Calculate the normal Vectors}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00518}00518       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} n(3), \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7dabc60bec4cc294aa2adf92726c6d6823a}{N}}(3);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00519}00519       n[0] = (interpolated\_a(0, 1) * interpolated\_a(1, 2) -\/}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00520}00520               interpolated\_a(0, 2) * interpolated\_a(1, 1)) /}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00521}00521              sqrt\_adet;}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00522}00522       n[1] = (interpolated\_a(0, 2) * interpolated\_a(1, 0) -\/}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00523}00523               interpolated\_a(0, 0) * interpolated\_a(1, 2)) /}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00524}00524              sqrt\_adet;}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00525}00525       n[2] = (interpolated\_a(0, 0) * interpolated\_a(1, 1) -\/}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00526}00526               interpolated\_a(0, 1) * interpolated\_a(1, 0)) /}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00527}00527              sqrt\_adet;}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00528}00528       \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7dabc60bec4cc294aa2adf92726c6d6823a}{N}}[0] = (interpolated\_A(0, 1) * interpolated\_A(1, 2) -\/}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00529}00529               interpolated\_A(0, 2) * interpolated\_A(1, 1)) /}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00530}00530              sqrt\_Adet;}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00531}00531       \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7dabc60bec4cc294aa2adf92726c6d6823a}{N}}[1] = (interpolated\_A(0, 2) * interpolated\_A(1, 0) -\/}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00532}00532               interpolated\_A(0, 0) * interpolated\_A(1, 2)) /}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00533}00533              sqrt\_Adet;}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00534}00534       \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7dabc60bec4cc294aa2adf92726c6d6823a}{N}}[2] = (interpolated\_A(0, 0) * interpolated\_A(1, 1) -\/}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00535}00535               interpolated\_A(0, 1) * interpolated\_A(1, 0)) /}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00536}00536              sqrt\_Adet;}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00537}00537 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00538}00538 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00539}00539       \textcolor{comment}{// Calculate the curvature tensors}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00540}00540       \textcolor{keywordtype}{double} b[2][2], \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a43c804e2bcf9862a4bf629d5f01761e8}{B}}[2][2];}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00541}00541 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00542}00542       b[0][0] = n[0] * interpolated\_dadxi(0, 0) +}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00543}00543                 n[1] * interpolated\_dadxi(0, 1) +}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00544}00544                 n[2] * interpolated\_dadxi(0, 2);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00545}00545 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00546}00546       \textcolor{comment}{// Off-\/diagonal terms are the same}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00547}00547       b[0][1] = b[1][0] = n[0] * interpolated\_dadxi(2, 0) +}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00548}00548                           n[1] * interpolated\_dadxi(2, 1) +}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00549}00549                           n[2] * interpolated\_dadxi(2, 2);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00550}00550 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00551}00551       b[1][1] = n[0] * interpolated\_dadxi(1, 0) +}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00552}00552                 n[1] * interpolated\_dadxi(1, 1) +}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00553}00553                 n[2] * interpolated\_dadxi(1, 2);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00554}00554 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00555}00555       \textcolor{comment}{// Deformed curvature tensor}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00556}00556       \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a43c804e2bcf9862a4bf629d5f01761e8}{B}}[0][0] = \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7dabc60bec4cc294aa2adf92726c6d6823a}{N}}[0] * interpolated\_dAdxi(0, 0) +}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00557}00557                 \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7dabc60bec4cc294aa2adf92726c6d6823a}{N}}[1] * interpolated\_dAdxi(0, 1) +}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00558}00558                 \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7dabc60bec4cc294aa2adf92726c6d6823a}{N}}[2] * interpolated\_dAdxi(0, 2);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00559}00559 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00560}00560       \textcolor{comment}{// Off-\/diagonal terms are the same}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00561}00561       \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a43c804e2bcf9862a4bf629d5f01761e8}{B}}[0][1] = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a43c804e2bcf9862a4bf629d5f01761e8}{B}}[1][0] = \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7dabc60bec4cc294aa2adf92726c6d6823a}{N}}[0] * interpolated\_dAdxi(2, 0) +}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00562}00562                           \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7dabc60bec4cc294aa2adf92726c6d6823a}{N}}[1] * interpolated\_dAdxi(2, 1) +}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00563}00563                           \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7dabc60bec4cc294aa2adf92726c6d6823a}{N}}[2] * interpolated\_dAdxi(2, 2);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00564}00564 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00565}00565       \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a43c804e2bcf9862a4bf629d5f01761e8}{B}}[1][1] = \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7dabc60bec4cc294aa2adf92726c6d6823a}{N}}[0] * interpolated\_dAdxi(1, 0) +}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00566}00566                 \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7dabc60bec4cc294aa2adf92726c6d6823a}{N}}[1] * interpolated\_dAdxi(1, 1) +}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00567}00567                 \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7dabc60bec4cc294aa2adf92726c6d6823a}{N}}[2] * interpolated\_dAdxi(1, 2);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00568}00568 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00569}00569       \textcolor{comment}{// Set up the change of curvature tensor}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00570}00570       \textcolor{keywordtype}{double} kappa[2][2];}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00571}00571 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00572}00572       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < 2; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00573}00573       \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00574}00574         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < 2; j++)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00575}00575         \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00576}00576           kappa[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}][j] = b[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}][j] -\/ \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a43c804e2bcf9862a4bf629d5f01761e8}{B}}[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}][j];}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00577}00577         \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00578}00578       \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00579}00579 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00580}00580       \textcolor{comment}{// Calculate the plane stress stiffness tensor}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00581}00581       \textcolor{keywordtype}{double} Et[2][2][2][2];}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00582}00582 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00583}00583       \textcolor{comment}{// Premultiply some constants}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00584}00584       \textcolor{comment}{// NOTE C2 has 1.0-\/Nu in the denominator}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00585}00585       \textcolor{comment}{// double C1 = 1.0/(2.0*(1.0+nu\_cached)), C2}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00586}00586       \textcolor{comment}{// = 2.0*nu\_cached/(1.0-\/nu\_cached);}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00587}00587 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00588}00588       \textcolor{comment}{// Some constants}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00589}00589       \textcolor{keywordtype}{double} C1 = 0.5 * (1.0 -\/ nu\_cached);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00590}00590       \textcolor{keywordtype}{double} C2 = nu\_cached;}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00591}00591 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00592}00592       \textcolor{comment}{// Loop over first index}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00593}00593       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < 2; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00594}00594       \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00595}00595         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < 2; j++)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00596}00596         \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00597}00597           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} k = 0; k < 2; k++)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00598}00598           \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00599}00599             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} l = 0; l < 2; l++)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00600}00600             \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00601}00601               \textcolor{comment}{// Et[i][j][k][l] = C1*(aup[i][k]*aup[j][l] + aup[i][l]*aup[j][k]}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00602}00602               \textcolor{comment}{//                     + C2*aup[i][j]*aup[k][l]);}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00603}00603               Et[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}][j][k][l] =}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00604}00604                 C1 * (aup[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}][k] * aup[j][l] + aup[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}][l] * aup[j][k]) +}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00605}00605                 C2 * aup[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}][j] * aup[k][l];}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00606}00606             \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00607}00607           \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00608}00608         \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00609}00609       \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00610}00610 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00611}00611       \textcolor{comment}{// Define the load Vector}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00612}00612       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} f(3);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00613}00613       \textcolor{comment}{// Determine the load}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00614}00614       \mbox{\hyperlink{classoomph_1_1KirchhoffLoveShellEquations_ad404001c9a8c9587ece41bc4ff8c1ce1}{load\_vector}}(ipt, \mbox{\hyperlink{classoomph_1_1SolidFiniteElement_a94ab4919b462d52cfdf6235bb9367d15}{interpolated\_xi}}, \mbox{\hyperlink{classoomph_1_1FiniteElement_a5a9c1ead9819cd17603096e63087020f}{interpolated\_x}}, \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7dabc60bec4cc294aa2adf92726c6d6823a}{N}}, f);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00615}00615 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00616}00616       \textcolor{comment}{// Scale the load by the bending stiffness scale}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00617}00617       \textcolor{comment}{// for(unsigned i=0;i<3;i++)\{f[i] *=}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00618}00618       \textcolor{comment}{// bending\_scale/(1.0-\/nu\_cached*nu\_cached);\}}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00619}00619 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00620}00620       \textcolor{comment}{// Allocate storage for variations of the the normal vector}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00621}00621       \textcolor{keywordtype}{double} normal\_var[3][3];}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00622}00622 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00623}00623       \textcolor{comment}{//=====EQUATIONS OF ELASTICITY FROM PRINCIPLE OF VIRTUAL}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00624}00624       \textcolor{comment}{// DISPLACEMENTS========}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00625}00625 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00626}00626       \textcolor{comment}{// Little tensor to handle the mixed derivative terms}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00627}00627       \textcolor{keywordtype}{unsigned} mix[2][2] = \{\{0, 2\}, \{2, 1\}\};}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00628}00628 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00629}00629       \textcolor{comment}{// Loop over the number of nodes}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00630}00630       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} l = 0; l < n\_node; l++)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00631}00631       \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00632}00632         \textcolor{comment}{// Loop over the type of degree of freedom}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00633}00633         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} k = 0; k < n\_position\_type; k++)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00634}00634         \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00635}00635           \textcolor{comment}{// Setup components of variations in the normal vector}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00636}00636           normal\_var[0][0] = 0.0;}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00637}00637           normal\_var[0][1] = (-\/interpolated\_A(1, 2) * dpsidxi(l, k, 0) +}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00638}00638                               interpolated\_A(0, 2) * dpsidxi(l, k, 1)) /}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00639}00639                              sqrt\_Adet;}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00640}00640           normal\_var[0][2] = (interpolated\_A(1, 1) * dpsidxi(l, k, 0) -\/}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00641}00641                               interpolated\_A(0, 1) * dpsidxi(l, k, 1)) /}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00642}00642                              sqrt\_Adet;}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00643}00643 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00644}00644           normal\_var[1][0] = (interpolated\_A(1, 2) * dpsidxi(l, k, 0) -\/}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00645}00645                               interpolated\_A(0, 2) * dpsidxi(l, k, 1)) /}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00646}00646                              sqrt\_Adet;}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00647}00647           normal\_var[1][1] = 0.0;}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00648}00648           normal\_var[1][2] = (-\/interpolated\_A(1, 0) * dpsidxi(l, k, 0) +}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00649}00649                               interpolated\_A(0, 0) * dpsidxi(l, k, 1)) /}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00650}00650                              sqrt\_Adet;}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00651}00651 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00652}00652           normal\_var[2][0] = (-\/interpolated\_A(1, 1) * dpsidxi(l, k, 0) +}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00653}00653                               interpolated\_A(0, 1) * dpsidxi(l, k, 1)) /}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00654}00654                              sqrt\_Adet;}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00655}00655           normal\_var[2][1] = (interpolated\_A(1, 0) * dpsidxi(l, k, 0) -\/}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00656}00656                               interpolated\_A(0, 0) * dpsidxi(l, k, 1)) /}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00657}00657                              sqrt\_Adet;}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00658}00658           normal\_var[2][2] = 0.0;}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00659}00659 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00660}00660           \textcolor{comment}{// Loop over the coordinate direction}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00661}00661           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < 3; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00662}00662           \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00663}00663             \textcolor{comment}{// Get the local equation number}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00664}00664             local\_eqn = \mbox{\hyperlink{classoomph_1_1SolidFiniteElement_a8632178393e76ffcd88888ab96616b1a}{position\_local\_eqn}}(l, k, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}});}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00665}00665 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00666}00666             \textcolor{comment}{// If it's not a boundary condition}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00667}00667             \textcolor{keywordflow}{if} (local\_eqn >= 0)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00668}00668             \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00669}00669               \textcolor{comment}{// Temporary to hold a common part of the bending terms}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00670}00670               \textcolor{keywordtype}{double} bending\_dot\_product\_multiplier =}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00671}00671                 ((A[1][1] * interpolated\_A(0, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) -\/}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00672}00672                   A[1][0] * interpolated\_A(1, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}})) *}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00673}00673                    dpsidxi(l, k, 0) +}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00674}00674                  (A[0][0] * interpolated\_A(1, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) -\/}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00675}00675                   A[0][1] * interpolated\_A(0, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}})) *}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00676}00676                    dpsidxi(l, k, 1)) /}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00677}00677                 Adet;}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00678}00678 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00679}00679               \textcolor{comment}{// Combine the cross and dot product bending terms}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00680}00680               \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} i2 = 0; i2 < 3; i2++)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00681}00681               \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00682}00682                 normal\_var[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}][i2] -\/= \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7dabc60bec4cc294aa2adf92726c6d6823a}{N}}[i2] * bending\_dot\_product\_multiplier;}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00683}00683               \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00684}00684 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00685}00685               \textcolor{comment}{// Add in external forcing}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00686}00686               residuals[local\_eqn] -\/=}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00687}00687                 f[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] / h\_cached * psi(l, k) * \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6}{W}} * sqrt\_Adet;}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00688}00688 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00689}00689               \textcolor{comment}{// Storage for all residual terms that are multipled by the}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00690}00690               \textcolor{comment}{// Jacobian and area of the undeformed shell}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00691}00691               \textcolor{comment}{// Start with the acceleration term}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00692}00692               \textcolor{keywordtype}{double} other\_residual\_terms =}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00693}00693                 lambda\_sq\_cached * accel[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] * psi(l, k);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00694}00694 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00695}00695               \textcolor{comment}{// Now need the loops over the Greek indicies}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00696}00696               \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} al = 0; al < 2; al++)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00697}00697               \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00698}00698                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} be = 0; be < 2; be++)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00699}00699                 \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00700}00700                   \textcolor{comment}{// Membrane prestress}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00701}00701                   other\_residual\_terms += *\mbox{\hyperlink{classoomph_1_1KirchhoffLoveShellEquations_a6e2455e49a707f5ffdf8439a6dffcea9}{Prestress\_pt}}(al, be) *}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00702}00702                                           interpolated\_A(al, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) *}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00703}00703                                           dpsidxi(l, k, be);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00704}00704 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00705}00705                   \textcolor{comment}{// Remaining terms}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00706}00706                   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} ga = 0; ga < 2; ga++)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00707}00707                   \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00708}00708                     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} de = 0; de < 2; de++)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00709}00709                     \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00710}00710                       \textcolor{keywordflow}{if} (!\mbox{\hyperlink{classoomph_1_1KirchhoffLoveShellEquations_a2799b63fc1219f6aab912a8e3e9824eb}{Ignore\_membrane\_terms}})}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00711}00711                       \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00712}00712                         \textcolor{comment}{// Pure membrane term}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00713}00713                         other\_residual\_terms +=}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00714}00714                           Et[al][be][ga][de] * gamma[al][be] *}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00715}00715                           interpolated\_A(ga, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) * dpsidxi(l, k, de);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00716}00716                       \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00717}00717 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00718}00718                       \textcolor{comment}{// Bending terms}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00719}00719                       other\_residual\_terms -\/=}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00720}00720                         bending\_scale * Et[al][be][ga][de] * kappa[al][be] *}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00721}00721                         (\mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7dabc60bec4cc294aa2adf92726c6d6823a}{N}}[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] * d2psidxi(l, k, mix[ga][de])}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00722}00722                          \textcolor{comment}{// Cross and dot product terms}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00723}00723                          +}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00724}00724                          normal\_var[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}][0] * interpolated\_dAdxi(mix[ga][de], 0) +}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00725}00725                          normal\_var[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}][1] * interpolated\_dAdxi(mix[ga][de], 1) +}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00726}00726                          normal\_var[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}][2] * interpolated\_dAdxi(mix[ga][de], 2));}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00727}00727                     \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00728}00728                   \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00729}00729                 \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00730}00730               \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00731}00731 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00732}00732               residuals[local\_eqn] += other\_residual\_terms * \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6}{W}} * sqrt\_adet;}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00733}00733             \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00734}00734           \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00735}00735         \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00736}00736       \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00737}00737 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00738}00738     \} \textcolor{comment}{// End of loop over the integration points}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00739}00739   \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00740}00740 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00741}00741   \textcolor{comment}{//=========================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00742}00742 \textcolor{comment}{  /// Return the jacobian is calculated by finite differences by default,}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00743}00743 \textcolor{comment}{}  \textcolor{comment}{//=========================================================================}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00744}\mbox{\hyperlink{classoomph_1_1KirchhoffLoveShellEquations_a2c8049fa371d484a43e157ebef54b474}{00744}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1KirchhoffLoveShellEquations_a2c8049fa371d484a43e157ebef54b474}{KirchhoffLoveShellEquations::fill\_in\_contribution\_to\_jacobian}}(}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00745}00745     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}}\& residuals, \mbox{\hyperlink{classoomph_1_1DenseMatrix}{DenseMatrix<double>}}\& jacobian)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00746}00746   \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00747}00747     \textcolor{comment}{// Call the element's residuals vector}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00748}00748     \mbox{\hyperlink{classoomph_1_1KirchhoffLoveShellEquations_a083c16732460cb430553239b9eaa1325}{fill\_in\_contribution\_to\_residuals\_shell}}(residuals);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00749}00749 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00750}00750     \textcolor{comment}{// Solve for the consistent acceleration in Newmark scheme?}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00751}00751     \textcolor{keywordflow}{if} (\mbox{\hyperlink{classoomph_1_1SolidFiniteElement_a52ba6cbb89b5edfe7592a49171aeb436}{Solve\_for\_consistent\_newmark\_accel\_flag}})}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00752}00752     \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00753}00753       \mbox{\hyperlink{classoomph_1_1SolidFiniteElement_ae9b760377a56194d802510527b33c76f}{fill\_in\_jacobian\_for\_newmark\_accel}}(jacobian);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00754}00754       \textcolor{keywordflow}{return};}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00755}00755     \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00756}00756 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00757}00757     \textcolor{comment}{// Allocate storage for the full residuals of the element}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00758}00758     \textcolor{keywordtype}{unsigned} n\_dof = \mbox{\hyperlink{classoomph_1_1GeneralisedElement_a37204f67b37d212fd170c68d48f6da57}{ndof}}();}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00759}00759     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} full\_residuals(n\_dof);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00760}00760 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00761}00761     \textcolor{comment}{// Call the full residuals}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00762}00762     \mbox{\hyperlink{classoomph_1_1GeneralisedElement_a53d348ab71c86b53619129a1dd411d30}{get\_residuals}}(full\_residuals);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00763}00763 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00764}00764     \textcolor{comment}{// Get the solid entries in the jacobian using finite differences}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00765}00765     \mbox{\hyperlink{classoomph_1_1SolidFiniteElement_aa4d7dab326ceb0167da34ad4c535fa0d}{SolidFiniteElement::fill\_in\_jacobian\_from\_solid\_position\_by\_fd}}(}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00766}00766       full\_residuals, jacobian);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00767}00767 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00768}00768     \textcolor{comment}{// Get the entries from the external data, usually load terms}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00769}00769     \mbox{\hyperlink{classoomph_1_1GeneralisedElement_a01ccf0a6a959cff46a36a4b7f1cf1554}{SolidFiniteElement::fill\_in\_jacobian\_from\_external\_by\_fd}}(full\_residuals,}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00770}00770                                                              jacobian);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00771}00771   \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00772}00772 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00773}00773   \textcolor{comment}{//=======================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00774}00774 \textcolor{comment}{  /// Compute the potential (strain) and kinetic energy of the}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00775}00775 \textcolor{comment}{  /// element.}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00776}00776 \textcolor{comment}{}  \textcolor{comment}{//=======================================================================}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00777}\mbox{\hyperlink{classoomph_1_1KirchhoffLoveShellEquations_a766bde0ab2904a6d73e2fa116dfa8738}{00777}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1KirchhoffLoveShellEquations_a766bde0ab2904a6d73e2fa116dfa8738}{KirchhoffLoveShellEquations::get\_energy}}(\textcolor{keywordtype}{double}\& pot\_en, \textcolor{keywordtype}{double}\& kin\_en)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00778}00778   \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00779}00779     \textcolor{comment}{// Initialise}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00780}00780     pot\_en = 0.0;}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00781}00781     kin\_en = 0.0;}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00782}00782 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00783}00783     \textcolor{comment}{// Set the dimension of the coordinates}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00784}00784     \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} n\_dim = \mbox{\hyperlink{classoomph_1_1KirchhoffLoveShellEquations_aec919dec7bab41fe5f7012ae8ebc8411}{Undeformed\_midplane\_pt}}-\/>\mbox{\hyperlink{classoomph_1_1GeomObject_a0305c3102fa6f5042461afb600a082df}{ndim}}();}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00785}00785 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00786}00786     \textcolor{comment}{// Set the number of lagrangian coordinates}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00787}00787     \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} n\_lagrangian = \mbox{\hyperlink{classoomph_1_1KirchhoffLoveShellEquations_aec919dec7bab41fe5f7012ae8ebc8411}{Undeformed\_midplane\_pt}}-\/>\mbox{\hyperlink{classoomph_1_1GeomObject_ae8974ee138b0f879c459340a9f05e06c}{nlagrangian}}();}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00788}00788 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00789}00789     \textcolor{comment}{// Find out how many nodes there are}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00790}00790     \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} n\_node = \mbox{\hyperlink{classoomph_1_1FiniteElement_a6219ed269a6d89b5aa14659cce48905a}{nnode}}();}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00791}00791 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00792}00792     \textcolor{comment}{// Find out how many positional dofs there are}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00793}00793     \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} n\_position\_type = \mbox{\hyperlink{classoomph_1_1FiniteElement_a36f4cb7569a545a9d93b66e6ee03cc91}{nnodal\_position\_type}}();}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00794}00794 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00795}00795     \textcolor{comment}{// Set up memory for the shape functions}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00796}00796     \mbox{\hyperlink{classoomph_1_1Shape}{Shape}} psi(n\_node, n\_position\_type);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00797}00797     \mbox{\hyperlink{classoomph_1_1DShape}{DShape}} dpsidxi(n\_node, n\_position\_type, n\_lagrangian);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00798}00798     \mbox{\hyperlink{classoomph_1_1DShape}{DShape}} d2psidxi(n\_node, n\_position\_type, 3);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00799}00799 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00800}00800     \textcolor{comment}{// Set the value of n\_intpt}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00801}00801     \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} n\_intpt = \mbox{\hyperlink{classoomph_1_1FiniteElement_a1a4723c4ee3fe4c6404203bb987f804e}{integral\_pt}}()-\/>\mbox{\hyperlink{classoomph_1_1Integral_a1a270de9d99a1fcf1d25a6c1017f65fa}{nweight}}();}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00802}00802 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00803}00803     \textcolor{comment}{// Get Physical Variables from Element}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00804}00804     \textcolor{comment}{// External pressure, Poisson ratio , and non-\/dim thickness h}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00805}00805     \textcolor{keyword}{const} \textcolor{keywordtype}{double} nu\_cached = \mbox{\hyperlink{classoomph_1_1KirchhoffLoveShellEquations_ad23e213c6f5fd10575a4fb1aba27eed3}{nu}}();}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00806}00806     \textcolor{keyword}{const} \textcolor{keywordtype}{double} h\_cached = \mbox{\hyperlink{classoomph_1_1KirchhoffLoveShellEquations_a5228ebb72cceae574ba2a824ddab6725}{h}}();}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00807}00807     \textcolor{keyword}{const} \textcolor{keywordtype}{double} lambda\_sq\_cached = \mbox{\hyperlink{classoomph_1_1KirchhoffLoveShellEquations_a0c11eef145483321f7376b6a09057520}{lambda\_sq}}();}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00808}00808 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00809}00809 \textcolor{preprocessor}{\#ifdef PARANOID}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00810}00810     \textcolor{comment}{// Check for non-\/zero prestress}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00811}00811     \textcolor{keywordflow}{if} ((\mbox{\hyperlink{classoomph_1_1KirchhoffLoveShellEquations_a5e088d691fff72ff1bce3e528d245018}{prestress}}(0, 0) != 0) || (\mbox{\hyperlink{classoomph_1_1KirchhoffLoveShellEquations_a5e088d691fff72ff1bce3e528d245018}{prestress}}(1, 0) != 0) ||}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00812}00812         (\mbox{\hyperlink{classoomph_1_1KirchhoffLoveShellEquations_a5e088d691fff72ff1bce3e528d245018}{prestress}}(1, 1) != 0))}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00813}00813     \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00814}00814       \mbox{\hyperlink{namespaceoomph_1_1Global__string__for__annotation_ac5379de2fa7fe44f2cb31785fc208135}{std::string}} error\_message =}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00815}00815         \textcolor{stringliteral}{"{}Warning: Not sure if the energy is computed correctly\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00816}00816       error\_message += \textcolor{stringliteral}{"{} for nonzero prestress\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00817}00817 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00818}00818       \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << error\_message << std::endl;}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00819}00819 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00820}00820       \textcolor{comment}{//    throw OomphLibWarning(error\_message,}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00821}00821       \textcolor{comment}{//                          "{}KirchhoffLoveShellEquations::get\_energy()"{},}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00822}00822       \textcolor{comment}{//                          OOMPH\_EXCEPTION\_LOCATION);}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00823}00823     \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00824}00824 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00825}00825 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00826}00826     \textcolor{comment}{// Setup storage for various quantities}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00827}00827     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} veloc(n\_dim);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00828}00828     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} \mbox{\hyperlink{classoomph_1_1SolidFiniteElement_a94ab4919b462d52cfdf6235bb9367d15}{interpolated\_xi}}(n\_lagrangian);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00829}00829     \mbox{\hyperlink{classoomph_1_1DenseMatrix}{DenseMatrix<double>}} interpolated\_A(n\_lagrangian, n\_dim);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00830}00830     \mbox{\hyperlink{classoomph_1_1DenseMatrix}{DenseMatrix<double>}} interpolated\_dAdxi(3);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00831}00831 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00832}00832     \textcolor{keyword}{const} \textcolor{keywordtype}{double} bending\_scale = (1.0 / 12.0) * h\_cached * h\_cached;}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00833}00833 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00834}00834     \textcolor{comment}{// Loop over the integration points}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00835}00835     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} ipt = 0; ipt < n\_intpt; ipt++)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00836}00836     \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00837}00837       \textcolor{comment}{// Get the integral weight}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00838}00838       \textcolor{keywordtype}{double} w = \mbox{\hyperlink{classoomph_1_1FiniteElement_a1a4723c4ee3fe4c6404203bb987f804e}{integral\_pt}}()-\/>\mbox{\hyperlink{classoomph_1_1Integral_ac65335e2aab120b285b3d6c294507b06}{weight}}(ipt);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00839}00839 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00840}00840       \textcolor{comment}{// Call the derivatives of the shape functions:}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00841}00841       \textcolor{keywordtype}{double} J = \mbox{\hyperlink{classoomph_1_1SolidFiniteElement_a69d17ec5fa308adae42e2f3171649bfe}{d2shape\_lagrangian\_at\_knot}}(ipt, psi, dpsidxi, d2psidxi);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00842}00842 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00843}00843       \textcolor{comment}{// Premultiply the weights and the Jacobian}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00844}00844       \textcolor{keywordtype}{double} \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6}{W}} = w * J;}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00845}00845 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00846}00846       \textcolor{comment}{// Initialise values to zero}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00847}00847       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < n\_dim; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00848}00848       \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00849}00849         veloc[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] = 0.0;}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00850}00850         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < n\_lagrangian; j++)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00851}00851         \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00852}00852           interpolated\_A(j, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) = 0.0;}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00853}00853         \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00854}00854         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < 3; j++)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00855}00855         \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00856}00856           interpolated\_dAdxi(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}, j) = 0.0;}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00857}00857         \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00858}00858       \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00859}00859       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < n\_lagrangian; j++)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00860}00860       \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00861}00861         \mbox{\hyperlink{classoomph_1_1SolidFiniteElement_a94ab4919b462d52cfdf6235bb9367d15}{interpolated\_xi}}[j] = 0.0;}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00862}00862       \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00863}00863 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00864}00864       \textcolor{comment}{// Calculate velocity and derivatives}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00865}00865       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} l = 0; l < n\_node; l++)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00866}00866       \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00867}00867         \textcolor{comment}{// Loop over positional dofs}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00868}00868         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} k = 0; k < n\_position\_type; k++)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00869}00869         \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00870}00870           \textcolor{comment}{// Loop over lagrangian coordinate directions}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00871}00871           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < n\_lagrangian; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00872}00872           \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00873}00873             \mbox{\hyperlink{classoomph_1_1SolidFiniteElement_a94ab4919b462d52cfdf6235bb9367d15}{interpolated\_xi}}[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] += \mbox{\hyperlink{classoomph_1_1SolidFiniteElement_a1c49e9ed87230b5e3024442b3a59dfdb}{lagrangian\_position\_gen}}(l, k, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) * psi(l, k);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00874}00874           \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00875}00875 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00876}00876           \textcolor{comment}{// Loop over displacement components}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00877}00877           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < n\_dim; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00878}00878           \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00879}00879             veloc[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] += \mbox{\hyperlink{classoomph_1_1FiniteElement_a45de68c68866ee5a15902ae185d9d511}{dnodal\_position\_gen\_dt}}(1, l, k, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) * psi(l, k);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00880}00880 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00881}00881             \textcolor{keywordtype}{double} x\_value = \mbox{\hyperlink{classoomph_1_1FiniteElement_a61c5f4b9a62607313692d713bf95edc5}{nodal\_position\_gen}}(l, k, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}});}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00882}00882 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00883}00883             \textcolor{comment}{// Loop over derivative directions}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00884}00884             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < n\_lagrangian; j++)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00885}00885             \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00886}00886               interpolated\_A(j, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) += x\_value * dpsidxi(l, k, j);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00887}00887             \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00888}00888             \textcolor{comment}{// Loop over the second derivative directions}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00889}00889             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < 3; j++)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00890}00890             \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00891}00891               interpolated\_dAdxi(j, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) += x\_value * d2psidxi(l, k, j);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00892}00892             \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00893}00893           \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00894}00894         \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00895}00895       \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00896}00896 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00897}00897       \textcolor{comment}{// Get square of veloc}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00898}00898       \textcolor{keywordtype}{double} veloc\_sq = 0;}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00899}00899       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < n\_dim; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00900}00900       \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00901}00901         veloc\_sq += veloc[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] * veloc[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}];}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00902}00902       \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00903}00903 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00904}00904       \textcolor{comment}{// Get the values of the undeformed parameters}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00905}00905       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} interpolated\_r(n\_dim);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00906}00906       \mbox{\hyperlink{classoomph_1_1DenseMatrix}{DenseMatrix<double>}} interpolated\_a(n\_lagrangian, n\_dim);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00907}00907       \mbox{\hyperlink{classoomph_1_1RankThreeTensor}{RankThreeTensor<double>}} dadxi(n\_lagrangian, n\_lagrangian, n\_dim);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00908}00908 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00909}00909       \textcolor{comment}{// Read out the undeformed position from the geometric object}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00910}00910       \mbox{\hyperlink{classoomph_1_1KirchhoffLoveShellEquations_aec919dec7bab41fe5f7012ae8ebc8411}{Undeformed\_midplane\_pt}}-\/>\mbox{\hyperlink{classoomph_1_1GeomObject_a08472dbe196123490ea109762cefd00c}{d2position}}(}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00911}00911         \mbox{\hyperlink{classoomph_1_1SolidFiniteElement_a94ab4919b462d52cfdf6235bb9367d15}{interpolated\_xi}}, interpolated\_r, interpolated\_a, dadxi);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00912}00912 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00913}00913       \textcolor{comment}{// Copy the values of the second derivatives into a slightly}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00914}00914       \textcolor{comment}{// different data structure, where the mixed derivatives [0][1] and [1][0]}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00915}00915       \textcolor{comment}{// are given by the single index [2]}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00916}00916       \mbox{\hyperlink{classoomph_1_1DenseMatrix}{DenseMatrix<double>}} interpolated\_dadxi(3);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00917}00917       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < 3; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00918}00918       \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00919}00919         interpolated\_dadxi(0, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) = dadxi(0, 0, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}});}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00920}00920         interpolated\_dadxi(1, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) = dadxi(1, 1, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}});}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00921}00921         interpolated\_dadxi(2, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) = dadxi(0, 1, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}});}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00922}00922       \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00923}00923 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00924}00924       \textcolor{comment}{// Declare and calculate the undeformed and deformed metric tensor,}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00925}00925       \textcolor{comment}{// the strain tensor}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00926}00926       \textcolor{keywordtype}{double} a[2][2], A[2][2], aup[2][2], Aup[2][2], gamma[2][2];}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00927}00927 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00928}00928       \textcolor{comment}{// Assign values of A and gamma}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00929}00929       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} al = 0; al < 2; al++)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00930}00930       \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00931}00931         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} be = 0; be < 2; be++)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00932}00932         \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00933}00933           \textcolor{comment}{// Initialise a(al,be) and A(al,be) to zero}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00934}00934           a[al][be] = 0.0;}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00935}00935           A[al][be] = 0.0;}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00936}00936           \textcolor{comment}{// Now calculate the dot product}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00937}00937           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} k = 0; k < n\_dim; k++)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00938}00938           \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00939}00939             a[al][be] += interpolated\_a(al, k) * interpolated\_a(be, k);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00940}00940             A[al][be] += interpolated\_A(al, k) * interpolated\_A(be, k);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00941}00941           \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00942}00942           \textcolor{comment}{// Calculate strain tensor}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00943}00943           gamma[al][be] = 0.5 * (A[al][be] -\/ a[al][be]);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00944}00944         \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00945}00945       \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00946}00946 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00947}00947       \textcolor{comment}{// Calculate the contravariant metric tensor}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00948}00948       \textcolor{keywordtype}{double} adet = \mbox{\hyperlink{classoomph_1_1KirchhoffLoveShellEquations_a6badfc9d15c8f6a8a66f663019e19cee}{calculate\_contravariant}}(a, aup);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00949}00949       \textcolor{keywordtype}{double} Adet = \mbox{\hyperlink{classoomph_1_1KirchhoffLoveShellEquations_a6badfc9d15c8f6a8a66f663019e19cee}{calculate\_contravariant}}(A, Aup);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00950}00950 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00951}00951       \textcolor{comment}{// Square roots are expensive, so let's do them once here}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00952}00952       \textcolor{keywordtype}{double} sqrt\_adet = sqrt(adet);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00953}00953       \textcolor{keywordtype}{double} sqrt\_Adet = sqrt(Adet);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00954}00954 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00955}00955       \textcolor{comment}{// Calculate the normal Vectors}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00956}00956       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} n(3), \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7dabc60bec4cc294aa2adf92726c6d6823a}{N}}(3);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00957}00957       n[0] = (interpolated\_a(0, 1) * interpolated\_a(1, 2) -\/}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00958}00958               interpolated\_a(0, 2) * interpolated\_a(1, 1)) /}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00959}00959              sqrt\_adet;}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00960}00960       n[1] = (interpolated\_a(0, 2) * interpolated\_a(1, 0) -\/}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00961}00961               interpolated\_a(0, 0) * interpolated\_a(1, 2)) /}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00962}00962              sqrt\_adet;}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00963}00963       n[2] = (interpolated\_a(0, 0) * interpolated\_a(1, 1) -\/}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00964}00964               interpolated\_a(0, 1) * interpolated\_a(1, 0)) /}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00965}00965              sqrt\_adet;}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00966}00966       \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7dabc60bec4cc294aa2adf92726c6d6823a}{N}}[0] = (interpolated\_A(0, 1) * interpolated\_A(1, 2) -\/}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00967}00967               interpolated\_A(0, 2) * interpolated\_A(1, 1)) /}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00968}00968              sqrt\_Adet;}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00969}00969       \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7dabc60bec4cc294aa2adf92726c6d6823a}{N}}[1] = (interpolated\_A(0, 2) * interpolated\_A(1, 0) -\/}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00970}00970               interpolated\_A(0, 0) * interpolated\_A(1, 2)) /}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00971}00971              sqrt\_Adet;}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00972}00972       \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7dabc60bec4cc294aa2adf92726c6d6823a}{N}}[2] = (interpolated\_A(0, 0) * interpolated\_A(1, 1) -\/}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00973}00973               interpolated\_A(0, 1) * interpolated\_A(1, 0)) /}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00974}00974              sqrt\_Adet;}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00975}00975 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00976}00976 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00977}00977       \textcolor{comment}{// Calculate the curvature tensors}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00978}00978       \textcolor{keywordtype}{double} b[2][2], \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a43c804e2bcf9862a4bf629d5f01761e8}{B}}[2][2];}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00979}00979 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00980}00980       b[0][0] = n[0] * interpolated\_dadxi(0, 0) +}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00981}00981                 n[1] * interpolated\_dadxi(0, 1) +}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00982}00982                 n[2] * interpolated\_dadxi(0, 2);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00983}00983 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00984}00984       \textcolor{comment}{// Off-\/diagonal terms are the same}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00985}00985       b[0][1] = b[1][0] = n[0] * interpolated\_dadxi(2, 0) +}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00986}00986                           n[1] * interpolated\_dadxi(2, 1) +}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00987}00987                           n[2] * interpolated\_dadxi(2, 2);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00988}00988 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00989}00989       b[1][1] = n[0] * interpolated\_dadxi(1, 0) +}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00990}00990                 n[1] * interpolated\_dadxi(1, 1) +}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00991}00991                 n[2] * interpolated\_dadxi(1, 2);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00992}00992 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00993}00993       \textcolor{comment}{// Deformed curvature tensor}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00994}00994       \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a43c804e2bcf9862a4bf629d5f01761e8}{B}}[0][0] = \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7dabc60bec4cc294aa2adf92726c6d6823a}{N}}[0] * interpolated\_dAdxi(0, 0) +}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00995}00995                 \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7dabc60bec4cc294aa2adf92726c6d6823a}{N}}[1] * interpolated\_dAdxi(0, 1) +}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00996}00996                 \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7dabc60bec4cc294aa2adf92726c6d6823a}{N}}[2] * interpolated\_dAdxi(0, 2);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00997}00997 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00998}00998       \textcolor{comment}{// Off-\/diagonal terms are the same}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l00999}00999       \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a43c804e2bcf9862a4bf629d5f01761e8}{B}}[0][1] = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a43c804e2bcf9862a4bf629d5f01761e8}{B}}[1][0] = \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7dabc60bec4cc294aa2adf92726c6d6823a}{N}}[0] * interpolated\_dAdxi(2, 0) +}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01000}01000                           \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7dabc60bec4cc294aa2adf92726c6d6823a}{N}}[1] * interpolated\_dAdxi(2, 1) +}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01001}01001                           \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7dabc60bec4cc294aa2adf92726c6d6823a}{N}}[2] * interpolated\_dAdxi(2, 2);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01002}01002 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01003}01003       \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a43c804e2bcf9862a4bf629d5f01761e8}{B}}[1][1] = \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7dabc60bec4cc294aa2adf92726c6d6823a}{N}}[0] * interpolated\_dAdxi(1, 0) +}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01004}01004                 \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7dabc60bec4cc294aa2adf92726c6d6823a}{N}}[1] * interpolated\_dAdxi(1, 1) +}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01005}01005                 \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7dabc60bec4cc294aa2adf92726c6d6823a}{N}}[2] * interpolated\_dAdxi(1, 2);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01006}01006 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01007}01007       \textcolor{comment}{// Set up the change of curvature tensor}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01008}01008       \textcolor{keywordtype}{double} kappa[2][2];}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01009}01009 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01010}01010       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < 2; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01011}01011       \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01012}01012         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < 2; j++)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01013}01013         \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01014}01014           kappa[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}][j] = b[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}][j] -\/ \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a43c804e2bcf9862a4bf629d5f01761e8}{B}}[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}][j];}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01015}01015         \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01016}01016       \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01017}01017 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01018}01018       \textcolor{comment}{// Calculate the plane stress stiffness tensor}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01019}01019       \textcolor{keywordtype}{double} Et[2][2][2][2];}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01020}01020 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01021}01021       \textcolor{comment}{// Some constants}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01022}01022       \textcolor{keywordtype}{double} C1 = 0.5 * (1.0 -\/ nu\_cached);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01023}01023       \textcolor{keywordtype}{double} C2 = nu\_cached;}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01024}01024 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01025}01025       \textcolor{comment}{// Loop over first index}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01026}01026       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < 2; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01027}01027       \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01028}01028         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < 2; j++)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01029}01029         \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01030}01030           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} k = 0; k < 2; k++)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01031}01031           \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01032}01032             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} l = 0; l < 2; l++)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01033}01033             \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01034}01034               Et[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}][j][k][l] =}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01035}01035                 C1 * (aup[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}][k] * aup[j][l] + aup[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}][l] * aup[j][k]) +}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01036}01036                 C2 * aup[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}][j] * aup[k][l];}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01037}01037             \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01038}01038           \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01039}01039         \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01040}01040       \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01041}01041 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01042}01042       \textcolor{comment}{// Add contributions to potential energy}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01043}01043       \textcolor{keywordtype}{double} pot\_en\_cont = 0.0;}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01044}01044 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01045}01045       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < 2; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01046}01046       \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01047}01047         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < 2; j++)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01048}01048         \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01049}01049           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} k = 0; k < 2; k++)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01050}01050           \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01051}01051             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} l = 0; l < 2; l++)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01052}01052             \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01053}01053               pot\_en\_cont +=}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01054}01054                 Et[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}][j][k][l] * (gamma[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}][j] * gamma[k][l] +}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01055}01055                                   bending\_scale * kappa[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}][j] * kappa[k][l]);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01056}01056             \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01057}01057           \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01058}01058         \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01059}01059       \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01060}01060       pot\_en += pot\_en\_cont * 0.5 * \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6}{W}} * sqrt\_adet;}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01061}01061 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01062}01062       \textcolor{comment}{// Add contribution to kinetic energy}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01063}01063       kin\_en += 0.5 * lambda\_sq\_cached * veloc\_sq * \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6}{W}} * sqrt\_adet;}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01064}01064 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01065}01065     \} \textcolor{comment}{// End of loop over the integration points}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01066}01066   \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01067}01067 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01068}01068 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01069}01069   \textcolor{comment}{//===================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01070}01070 \textcolor{comment}{  /// Get integral of instantaneous rate of work done on}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01071}01071 \textcolor{comment}{  /// the wall due to the load returned by the virtual}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01072}01072 \textcolor{comment}{  /// function load\_vector\_for\_rate\_of\_work\_computation(...).}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01073}01073 \textcolor{comment}{  /// In the current class}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01074}01074 \textcolor{comment}{  /// the latter function simply de-\/references the external}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01075}01075 \textcolor{comment}{  /// load but this can be overloaded in derived classes}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01076}01076 \textcolor{comment}{  /// (e.g. in FSI elements) to determine the rate of work done}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01077}01077 \textcolor{comment}{  /// by individual constituents of this load (e.g. the fluid load}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01078}01078 \textcolor{comment}{  /// in an FSI problem).}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01079}01079 \textcolor{comment}{}  \textcolor{comment}{//===================================================================}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01080}\mbox{\hyperlink{classoomph_1_1KirchhoffLoveShellEquations_a98601ae4af61f4a3fa7159afeeec2535}{01080}}   \textcolor{keywordtype}{double} \mbox{\hyperlink{classoomph_1_1KirchhoffLoveShellEquations_a98601ae4af61f4a3fa7159afeeec2535}{KirchhoffLoveShellEquations::load\_rate\_of\_work}}()}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01081}01081   \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01082}01082     \textcolor{comment}{// Initialise}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01083}01083     \textcolor{keywordtype}{double} rate\_of\_work\_integral = 0.0;}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01084}01084 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01085}01085     \textcolor{comment}{// The number of dimensions}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01086}01086     \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} n\_dim = 3;}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01087}01087 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01088}01088     \textcolor{comment}{// The number of lagrangian coordinates}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01089}01089     \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} n\_lagrangian = 2;}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01090}01090 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01091}01091     \textcolor{comment}{// The number of nodes}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01092}01092     \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} n\_node = \mbox{\hyperlink{classoomph_1_1FiniteElement_a6219ed269a6d89b5aa14659cce48905a}{nnode}}();}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01093}01093 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01094}01094     \textcolor{comment}{// Number of integration points}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01095}01095     \textcolor{keywordtype}{unsigned} n\_intpt = \mbox{\hyperlink{classoomph_1_1FiniteElement_a1a4723c4ee3fe4c6404203bb987f804e}{integral\_pt}}()-\/>\mbox{\hyperlink{classoomph_1_1Integral_a1a270de9d99a1fcf1d25a6c1017f65fa}{nweight}}();}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01096}01096 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01097}01097     \textcolor{comment}{// Find out how many positional dofs there are}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01098}01098     \textcolor{keywordtype}{unsigned} n\_position\_type = \mbox{\hyperlink{classoomph_1_1FiniteElement_a36f4cb7569a545a9d93b66e6ee03cc91}{nnodal\_position\_type}}();}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01099}01099 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01100}01100     \textcolor{comment}{// Vector to hold local coordinate in element}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01101}01101     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}(n\_lagrangian);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01102}01102 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01103}01103     \textcolor{comment}{// Set up storage for shape functions and derivatives of shape functions}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01104}01104     \mbox{\hyperlink{classoomph_1_1Shape}{Shape}} psi(n\_node, n\_position\_type);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01105}01105     \mbox{\hyperlink{classoomph_1_1DShape}{DShape}} dpsidxi(n\_node, n\_position\_type, n\_lagrangian);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01106}01106 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01107}01107     \textcolor{comment}{// Storage for jacobian of mapping from local to Lagrangian coords}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01108}01108     \mbox{\hyperlink{classoomph_1_1DenseMatrix}{DenseMatrix<double>}} jacobian(n\_lagrangian);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01109}01109 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01110}01110     \textcolor{comment}{// Storage for velocity vector}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01111}01111     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} velocity(n\_dim);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01112}01112 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01113}01113     \textcolor{comment}{// Storage for load vector}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01114}01114     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} load(n\_dim);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01115}01115 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01116}01116     \textcolor{comment}{// Storage for normal vector}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01117}01117     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} normal(n\_dim);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01118}01118 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01119}01119     \textcolor{comment}{// Storage for Lagrangian and Eulerian coordinates}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01120}01120     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} xi(n\_lagrangian);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01121}01121     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} x(n\_dim);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01122}01122 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01123}01123     \textcolor{comment}{// Storage for covariant vectors}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01124}01124     \mbox{\hyperlink{classoomph_1_1DenseMatrix}{DenseMatrix<double>}} interpolated\_A(n\_lagrangian, n\_dim);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01125}01125 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01126}01126     \textcolor{comment}{// Loop over the integration points}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01127}01127     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} ipt = 0; ipt < n\_intpt; ipt++)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01128}01128     \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01129}01129       \textcolor{comment}{// Get the integral weight}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01130}01130       \textcolor{keywordtype}{double} w = \mbox{\hyperlink{classoomph_1_1FiniteElement_a1a4723c4ee3fe4c6404203bb987f804e}{integral\_pt}}()-\/>\mbox{\hyperlink{classoomph_1_1Integral_ac65335e2aab120b285b3d6c294507b06}{weight}}(ipt);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01131}01131 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01132}01132       \textcolor{comment}{// Get local coords at knot}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01133}01133       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < n\_lagrangian; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01134}01134       \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01135}01135         \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] = \mbox{\hyperlink{classoomph_1_1FiniteElement_a1a4723c4ee3fe4c6404203bb987f804e}{integral\_pt}}()-\/>\mbox{\hyperlink{classoomph_1_1Integral_a1a2122f99a87c18649bafdd9ed739758}{knot}}(ipt, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}});}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01136}01136       \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01137}01137 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01138}01138       \textcolor{comment}{// Get shape functions, derivatives, determinant of Jacobian of mapping}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01139}01139       \textcolor{keywordtype}{double} J = \mbox{\hyperlink{classoomph_1_1SolidFiniteElement_a4154c1d362b12905f2b5e6cbcfafa9f6}{dshape\_lagrangian}}(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, psi, dpsidxi);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01140}01140 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01141}01141       \textcolor{comment}{// Premultiply the weights and the Jacobian}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01142}01142       \textcolor{keywordtype}{double} \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6}{W}} = w * J;}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01143}01143 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01144}01144       \textcolor{comment}{// Initialise velocity, x and interpolated\_A to zero}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01145}01145       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < n\_dim; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01146}01146       \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01147}01147         velocity[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] = 0.0;}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01148}01148         x[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] = 0.0;}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01149}01149         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < n\_lagrangian; j++)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01150}01150         \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01151}01151           interpolated\_A(j, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) = 0.0;}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01152}01152         \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01153}01153       \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01154}01154 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01155}01155       \textcolor{comment}{// Initialise xi to zero}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01156}01156       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < n\_lagrangian; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01157}01157       \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01158}01158         xi[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] = 0.0;}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01159}01159       \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01160}01160 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01161}01161       \textcolor{comment}{// Calculate velocity, coordinates and derivatives}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01162}01162       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} l = 0; l < n\_node; l++)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01163}01163       \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01164}01164         \textcolor{comment}{// Loop over positional dofs}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01165}01165         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} k = 0; k < n\_position\_type; k++)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01166}01166         \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01167}01167           \textcolor{comment}{// Loop over lagrangian coordinate directions}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01168}01168           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < n\_lagrangian; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01169}01169           \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01170}01170             xi[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] += \mbox{\hyperlink{classoomph_1_1SolidFiniteElement_a1c49e9ed87230b5e3024442b3a59dfdb}{lagrangian\_position\_gen}}(l, k, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) * psi(l, k);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01171}01171           \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01172}01172 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01173}01173           \textcolor{comment}{// Loop over displacement components}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01174}01174           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < n\_dim; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01175}01175           \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01176}01176             velocity[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] += \mbox{\hyperlink{classoomph_1_1FiniteElement_a45de68c68866ee5a15902ae185d9d511}{dnodal\_position\_gen\_dt}}(1, l, k, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) * psi(l, k);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01177}01177 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01178}01178             \textcolor{keywordtype}{double} x\_value = \mbox{\hyperlink{classoomph_1_1FiniteElement_a61c5f4b9a62607313692d713bf95edc5}{nodal\_position\_gen}}(l, k, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}});}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01179}01179             x[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] += x\_value * psi(l, k);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01180}01180 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01181}01181             \textcolor{comment}{// Loop over derivative directions}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01182}01182             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < n\_lagrangian; j++)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01183}01183             \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01184}01184               interpolated\_A(j, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) += x\_value * dpsidxi(l, k, j);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01185}01185             \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01186}01186           \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01187}01187         \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01188}01188       \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01189}01189 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01190}01190       \textcolor{comment}{// Get deformed metric tensor}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01191}01191       \textcolor{keywordtype}{double} A[2][2];}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01192}01192       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} al = 0; al < 2; al++)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01193}01193       \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01194}01194         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} be = 0; be < 2; be++)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01195}01195         \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01196}01196           \textcolor{comment}{// Initialise A(al,be) to zero}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01197}01197           A[al][be] = 0.0;}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01198}01198           \textcolor{comment}{// Calculate the dot product}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01199}01199           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} k = 0; k < n\_dim; k++)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01200}01200           \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01201}01201             A[al][be] += interpolated\_A(al, k) * interpolated\_A(be, k);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01202}01202           \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01203}01203         \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01204}01204       \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01205}01205 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01206}01206       \textcolor{comment}{// Get determinant of metric tensor}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01207}01207       \textcolor{keywordtype}{double} A\_det = A[0][0] * A[1][1] -\/ A[0][1] * A[1][0];}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01208}01208 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01209}01209       \textcolor{comment}{// Get outer unit normal}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01210}01210       \mbox{\hyperlink{classoomph_1_1KirchhoffLoveShellEquations_a797e455634ac8b8e8669c4adff84e644}{get\_normal}}(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, normal);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01211}01211 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01212}01212       \textcolor{comment}{// Get load vector}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01213}01213       \mbox{\hyperlink{classoomph_1_1KirchhoffLoveShellEquations_ae565dc5fcdf60d733f6d19361e88d22d}{load\_vector\_for\_rate\_of\_work\_computation}}(ipt, xi, x, normal, load);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01214}01214 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01215}01215       \textcolor{comment}{// Local rate of work:}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01216}01216       \textcolor{keywordtype}{double} rate\_of\_work = 0.0;}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01217}01217       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < n\_dim; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01218}01218       \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01219}01219         rate\_of\_work += load[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] * velocity[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}];}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01220}01220       \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01221}01221 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01222}01222       \textcolor{comment}{// Add rate of work}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01223}01223       rate\_of\_work\_integral += rate\_of\_work / \mbox{\hyperlink{classoomph_1_1KirchhoffLoveShellEquations_a5228ebb72cceae574ba2a824ddab6725}{h}}() * \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6}{W}} * A\_det;}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01224}01224     \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01225}01225 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01226}01226     \textcolor{keywordflow}{return} rate\_of\_work\_integral;}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01227}01227   \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01228}01228 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01229}01229 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01230}01230   \textcolor{comment}{//===================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01231}01231 \textcolor{comment}{  /// The output function: position, veloc and accel.}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01232}01232 \textcolor{comment}{}  \textcolor{comment}{//===================================================================}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01233}\mbox{\hyperlink{classoomph_1_1HermiteShellElement_a78713ac47c51ca8e8081ce7a5bfce592}{01233}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1HermiteShellElement_a78713ac47c51ca8e8081ce7a5bfce592}{HermiteShellElement::output\_with\_time\_dep\_quantities}}(}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01234}01234     std::ostream\& outfile, \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\& n\_plot)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01235}01235   \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01236}01236     \textcolor{comment}{// Local variables}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01237}01237     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}(2);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01238}01238 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01239}01239     \textcolor{comment}{// Tecplot header info}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01240}01240     outfile << \textcolor{stringliteral}{"{}ZONE I="{}} << n\_plot << \textcolor{stringliteral}{"{}, J="{}} << n\_plot << std::endl;}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01241}01241 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01242}01242     \textcolor{comment}{// Loop over plot points}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01243}01243     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} l2 = 0; l2 < n\_plot; l2++)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01244}01244     \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01245}01245       \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[1] = -\/1.0 + l2 * 2.0 / (n\_plot -\/ 1);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01246}01246       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} l1 = 0; l1 < n\_plot; l1++)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01247}01247       \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01248}01248         \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0] = -\/1.0 + l1 * 2.0 / (n\_plot -\/ 1);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01249}01249 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01250}01250         \textcolor{comment}{// Output}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01251}01251         outfile << \mbox{\hyperlink{classoomph_1_1FiniteElement_a5a9c1ead9819cd17603096e63087020f}{interpolated\_x}}(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, 0) << \textcolor{stringliteral}{"{} "{}} << \mbox{\hyperlink{classoomph_1_1FiniteElement_a5a9c1ead9819cd17603096e63087020f}{interpolated\_x}}(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, 1) << \textcolor{stringliteral}{"{} "{}}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01252}01252                 << \mbox{\hyperlink{classoomph_1_1FiniteElement_a5a9c1ead9819cd17603096e63087020f}{interpolated\_x}}(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, 2) << \textcolor{stringliteral}{"{} "{}} << \mbox{\hyperlink{classoomph_1_1FiniteElement_a7e5ddde616cfd7fdd86a71d4120c9784}{interpolated\_dxdt}}(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, 0, 1)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01253}01253                 << \textcolor{stringliteral}{"{} "{}} << \mbox{\hyperlink{classoomph_1_1FiniteElement_a7e5ddde616cfd7fdd86a71d4120c9784}{interpolated\_dxdt}}(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, 1, 1) << \textcolor{stringliteral}{"{} "{}}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01254}01254                 << \mbox{\hyperlink{classoomph_1_1FiniteElement_a7e5ddde616cfd7fdd86a71d4120c9784}{interpolated\_dxdt}}(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, 2, 1) << \textcolor{stringliteral}{"{} "{}}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01255}01255                 << \mbox{\hyperlink{classoomph_1_1FiniteElement_a7e5ddde616cfd7fdd86a71d4120c9784}{interpolated\_dxdt}}(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, 0, 2) << \textcolor{stringliteral}{"{} "{}}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01256}01256                 << \mbox{\hyperlink{classoomph_1_1FiniteElement_a7e5ddde616cfd7fdd86a71d4120c9784}{interpolated\_dxdt}}(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, 1, 2) << \textcolor{stringliteral}{"{} "{}}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01257}01257                 << \mbox{\hyperlink{classoomph_1_1FiniteElement_a7e5ddde616cfd7fdd86a71d4120c9784}{interpolated\_dxdt}}(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, 2, 2) << \textcolor{stringliteral}{"{} "{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01258}01258       \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01259}01259     \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01260}01260     outfile << std::endl;}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01261}01261   \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01262}01262 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01263}01263 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01264}01264   \textcolor{comment}{//===================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01265}01265 \textcolor{comment}{  /// The output function}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01266}01266 \textcolor{comment}{}  \textcolor{comment}{//===================================================================}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01267}\mbox{\hyperlink{classoomph_1_1HermiteShellElement_a2f76280c3af060304800b5bc0aeb02d8}{01267}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1HermiteShellElement_af2313040b66727088dc044738b652677}{HermiteShellElement::output}}(std::ostream\& outfile,}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01268}01268                                    \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\& n\_plot)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01269}01269   \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01270}01270     \textcolor{comment}{// Local variables}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01271}01271     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}(2);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01272}01272 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01273}01273     \textcolor{comment}{// Tecplot header info}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01274}01274     outfile << \textcolor{stringliteral}{"{}ZONE I="{}} << n\_plot << \textcolor{stringliteral}{"{}, J="{}} << n\_plot << std::endl;}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01275}01275 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01276}01276     \textcolor{comment}{// Loop over plot points}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01277}01277     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} l2 = 0; l2 < n\_plot; l2++)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01278}01278     \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01279}01279       \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[1] = -\/1.0 + l2 * 2.0 / (n\_plot -\/ 1);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01280}01280       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} l1 = 0; l1 < n\_plot; l1++)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01281}01281       \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01282}01282         \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0] = -\/1.0 + l1 * 2.0 / (n\_plot -\/ 1);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01283}01283 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01284}01284         \textcolor{comment}{// Output the x and y positions}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01285}01285         outfile << \mbox{\hyperlink{classoomph_1_1FiniteElement_a5a9c1ead9819cd17603096e63087020f}{interpolated\_x}}(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, 0) << \textcolor{stringliteral}{"{} "{}} << \mbox{\hyperlink{classoomph_1_1FiniteElement_a5a9c1ead9819cd17603096e63087020f}{interpolated\_x}}(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, 1) << \textcolor{stringliteral}{"{} "{}}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01286}01286                 << \mbox{\hyperlink{classoomph_1_1FiniteElement_a5a9c1ead9819cd17603096e63087020f}{interpolated\_x}}(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, 2) << \textcolor{stringliteral}{"{} "{}};}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01287}01287         outfile << \mbox{\hyperlink{classoomph_1_1SolidFiniteElement_a94ab4919b462d52cfdf6235bb9367d15}{interpolated\_xi}}(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, 0) << \textcolor{stringliteral}{"{} "{}} << \mbox{\hyperlink{classoomph_1_1SolidFiniteElement_a94ab4919b462d52cfdf6235bb9367d15}{interpolated\_xi}}(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, 1)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01288}01288                 << std::endl;}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01289}01289       \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01290}01290     \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01291}01291     outfile << std::endl;}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01292}01292   \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01293}01293 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01294}01294 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01295}01295   \textcolor{comment}{//===================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01296}01296 \textcolor{comment}{  /// The output function}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01297}01297 \textcolor{comment}{}  \textcolor{comment}{//===================================================================}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01298}\mbox{\hyperlink{classoomph_1_1HermiteShellElement_a805a6e65b4dbb7bcffab6180ff9686ba}{01298}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1HermiteShellElement_af2313040b66727088dc044738b652677}{HermiteShellElement::output}}(FILE* file\_pt, \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\& n\_plot)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01299}01299   \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01300}01300     \textcolor{comment}{// Local variables}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01301}01301     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}(2);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01302}01302 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01303}01303     \textcolor{comment}{// Tecplot header info}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01304}01304     fprintf(file\_pt, \textcolor{stringliteral}{"{}ZONE I=\%i, J=\%i \(\backslash\)n"{}}, n\_plot, n\_plot);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01305}01305 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01306}01306     \textcolor{comment}{// Loop over plot points}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01307}01307     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} l2 = 0; l2 < n\_plot; l2++)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01308}01308     \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01309}01309       \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[1] = -\/1.0 + l2 * 2.0 / (n\_plot -\/ 1);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01310}01310       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} l1 = 0; l1 < n\_plot; l1++)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01311}01311       \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01312}01312         \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0] = -\/1.0 + l1 * 2.0 / (n\_plot -\/ 1);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01313}01313 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01314}01314         \textcolor{comment}{// Output the x and y positions}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01315}01315         fprintf(file\_pt,}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01316}01316                 \textcolor{stringliteral}{"{}\%g \%g \%g "{}},}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01317}01317                 \mbox{\hyperlink{classoomph_1_1FiniteElement_a5a9c1ead9819cd17603096e63087020f}{interpolated\_x}}(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, 0),}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01318}01318                 \mbox{\hyperlink{classoomph_1_1FiniteElement_a5a9c1ead9819cd17603096e63087020f}{interpolated\_x}}(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, 1),}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01319}01319                 \mbox{\hyperlink{classoomph_1_1FiniteElement_a5a9c1ead9819cd17603096e63087020f}{interpolated\_x}}(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, 2));}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01320}01320         fprintf(}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01321}01321           file\_pt, \textcolor{stringliteral}{"{}\%g \%g \(\backslash\)n "{}}, \mbox{\hyperlink{classoomph_1_1SolidFiniteElement_a94ab4919b462d52cfdf6235bb9367d15}{interpolated\_xi}}(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, 0), \mbox{\hyperlink{classoomph_1_1SolidFiniteElement_a94ab4919b462d52cfdf6235bb9367d15}{interpolated\_xi}}(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, 1));}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01322}01322       \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01323}01323     \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01324}01324     fprintf(file\_pt, \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01325}01325   \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01326}01326 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01327}01327 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01328}01328   \textcolor{comment}{//=========================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01329}01329 \textcolor{comment}{  /// Define the dposition function. This is used to set no-\/slip boundary}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01330}01330 \textcolor{comment}{  /// conditions in some FSI problems.}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01331}01331 \textcolor{comment}{}  \textcolor{comment}{//=========================================================================}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01332}\mbox{\hyperlink{classoomph_1_1FSIDiagHermiteShellElement_a96062fcb7f6329ceca0635ee5cc4d5f8}{01332}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1FSIDiagHermiteShellElement_a96062fcb7f6329ceca0635ee5cc4d5f8}{FSIDiagHermiteShellElement::dposition\_dlagrangian\_at\_local\_coordinate}}(}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01333}01333     \textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}}\& \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, \mbox{\hyperlink{classoomph_1_1DenseMatrix}{DenseMatrix<double>}}\& drdxi)\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01334}01334 \textcolor{keyword}{  }\{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01335}01335 \textcolor{preprocessor}{\#ifdef PARANOID}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01336}01336     \textcolor{keywordflow}{if} (\mbox{\hyperlink{classoomph_1_1KirchhoffLoveShellEquations_aec919dec7bab41fe5f7012ae8ebc8411}{Undeformed\_midplane\_pt}} == 0)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01337}01337     \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01338}01338       \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(\textcolor{stringliteral}{"{}Undeformed\_midplane\_pt has not been set"{}},}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01339}01339                           \textcolor{stringliteral}{"{}FSIDiagHermiteShellElement::dposition\_dlagrangian\_"{}}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01340}01340                           \textcolor{stringliteral}{"{}at\_local\_coordinate()"{}},}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01341}01341                           OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01342}01342     \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01343}01343 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01344}01344 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01345}01345     \textcolor{comment}{// Find the dimension of the global coordinate}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01346}01346     \textcolor{keywordtype}{unsigned} n\_dim = \mbox{\hyperlink{classoomph_1_1KirchhoffLoveShellEquations_aec919dec7bab41fe5f7012ae8ebc8411}{Undeformed\_midplane\_pt}}-\/>\mbox{\hyperlink{classoomph_1_1GeomObject_a0305c3102fa6f5042461afb600a082df}{ndim}}();}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01347}01347 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01348}01348     \textcolor{comment}{// Find the number of lagrangian coordinates}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01349}01349     \textcolor{keywordtype}{unsigned} n\_lagrangian = \mbox{\hyperlink{classoomph_1_1KirchhoffLoveShellEquations_aec919dec7bab41fe5f7012ae8ebc8411}{Undeformed\_midplane\_pt}}-\/>\mbox{\hyperlink{classoomph_1_1GeomObject_ae8974ee138b0f879c459340a9f05e06c}{nlagrangian}}();}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01350}01350 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01351}01351     \textcolor{comment}{// Find out how many nodes there are}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01352}01352     \textcolor{keywordtype}{unsigned} n\_node = \mbox{\hyperlink{classoomph_1_1FiniteElement_a6219ed269a6d89b5aa14659cce48905a}{nnode}}();}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01353}01353 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01354}01354     \textcolor{comment}{// Find out how many positional dofs there are}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01355}01355     \textcolor{keywordtype}{unsigned} n\_position\_type = this-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a36f4cb7569a545a9d93b66e6ee03cc91}{nnodal\_position\_type}}();}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01356}01356 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01357}01357     \textcolor{comment}{// Set up memory for the shape functions}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01358}01358     \mbox{\hyperlink{classoomph_1_1Shape}{Shape}} psi(n\_node, n\_position\_type);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01359}01359     \mbox{\hyperlink{classoomph_1_1DShape}{DShape}} dpsidxi(n\_node, n\_position\_type, n\_lagrangian);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01360}01360 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01361}01361     \textcolor{comment}{// Get the derivatives of the shape functions w.r.t local coordinates}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01362}01362     \textcolor{comment}{// at this point}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01363}01363     \mbox{\hyperlink{classoomph_1_1SolidFiniteElement_a4154c1d362b12905f2b5e6cbcfafa9f6}{dshape\_lagrangian}}(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, psi, dpsidxi);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01364}01364 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01365}01365     \textcolor{comment}{// Initialise the derivatives to zero}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01366}01366     drdxi.\mbox{\hyperlink{classoomph_1_1DenseMatrix_aafcfbb0309fdcbd84f8654fe1b5601fd}{initialise}}(0.0);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01367}01367 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01368}01368     \textcolor{comment}{// Loop over the nodes}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01369}01369     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} l = 0; l < n\_node; l++)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01370}01370     \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01371}01371       \textcolor{comment}{// Loop over the positional types}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01372}01372       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} k = 0; k < n\_position\_type; k++)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01373}01373       \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01374}01374         \textcolor{comment}{// Loop over the dimensions}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01375}01375         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < n\_dim; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01376}01376         \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01377}01377           \textcolor{comment}{// Loop over the lagrangian coordinates}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01378}01378           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < n\_lagrangian; j++)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01379}01379           \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01380}01380             \textcolor{comment}{// Add the contribution to the derivative}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01381}01381             drdxi(j, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) += \mbox{\hyperlink{classoomph_1_1FiniteElement_a61c5f4b9a62607313692d713bf95edc5}{nodal\_position\_gen}}(l, k, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) * dpsidxi(l, k, j);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01382}01382           \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01383}01383         \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01384}01384       \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01385}01385     \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01386}01386   \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01387}01387 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01388}01388 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01389}01389   \textcolor{comment}{//=============================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01390}01390 \textcolor{comment}{  /// Create a list of pairs for all unknowns in this element,}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01391}01391 \textcolor{comment}{  /// so that the first entry in each pair contains the global equation}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01392}01392 \textcolor{comment}{  /// number of the unknown, while the second one contains the number}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01393}01393 \textcolor{comment}{  /// of the "{}DOF types"{} that this unknown is associated with.}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01394}01394 \textcolor{comment}{  /// (Function can obviously only be called if the equation numbering}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01395}01395 \textcolor{comment}{  /// scheme has been set up.)}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01396}01396 \textcolor{comment}{  /// This element is only in charge of the solid dofs.}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01397}01397 \textcolor{comment}{}  \textcolor{comment}{//=============================================================================}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01398}\mbox{\hyperlink{classoomph_1_1FSIDiagHermiteShellElement_a41c37ca0ac22147cc0b16dea14b70418}{01398}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1FSIDiagHermiteShellElement_a41c37ca0ac22147cc0b16dea14b70418}{FSIDiagHermiteShellElement::get\_dof\_numbers\_for\_unknowns}}(}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01399}01399     std::list<std::pair<unsigned long, unsigned>>\& dof\_lookup\_list)\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01400}01400 \textcolor{keyword}{  }\{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01401}01401     \textcolor{comment}{// temporary pair (used to store dof lookup prior to being added to list)}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01402}01402     std::pair<unsigned long, unsigned> dof\_lookup;}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01403}01403 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01404}01404     \textcolor{comment}{// number of nodes}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01405}01405     \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} n\_node = this-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a6219ed269a6d89b5aa14659cce48905a}{nnode}}();}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01406}01406 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01407}01407     \textcolor{comment}{// Get the number of position dofs and dimensions at the node}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01408}01408     \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} n\_position\_type = \mbox{\hyperlink{classoomph_1_1FiniteElement_a36f4cb7569a545a9d93b66e6ee03cc91}{nnodal\_position\_type}}();}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01409}01409     \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} nodal\_dim = \mbox{\hyperlink{classoomph_1_1FiniteElement_ab6602b43c3a2f1a5e48729b0b23c0d91}{nodal\_dimension}}();}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01410}01410 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01411}01411     \textcolor{comment}{// Integer storage for local unknown}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01412}01412     \textcolor{keywordtype}{int} local\_unknown = 0;}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01413}01413 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01414}01414     \textcolor{comment}{// Loop over the nodes}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01415}01415     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} n = 0; n < n\_node; n++)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01416}01416     \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01417}01417       \textcolor{comment}{// Loop over position dofs}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01418}01418       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} k = 0; k < n\_position\_type; k++)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01419}01419       \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01420}01420         \textcolor{comment}{// Loop over dimension}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01421}01421         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < nodal\_dim; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01422}01422         \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01423}01423           \textcolor{comment}{// If the variable is free}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01424}01424           local\_unknown = \mbox{\hyperlink{classoomph_1_1SolidFiniteElement_a8632178393e76ffcd88888ab96616b1a}{position\_local\_eqn}}(n, k, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}});}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01425}01425 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01426}01426           \textcolor{comment}{// ignore pinned values}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01427}01427           \textcolor{keywordflow}{if} (local\_unknown >= 0)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01428}01428           \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01429}01429             \textcolor{comment}{// store dof lookup in temporary pair: First entry in pair}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01430}01430             \textcolor{comment}{// is global equation number; second entry is dof type}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01431}01431             dof\_lookup.first = this-\/>\mbox{\hyperlink{classoomph_1_1GeneralisedElement_a37ac5a1d5234fa931ab710c0c74d55d2}{eqn\_number}}(local\_unknown);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01432}01432             dof\_lookup.second = 0;}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01433}01433 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01434}01434             \textcolor{comment}{// add to list}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01435}01435             dof\_lookup\_list.push\_front(dof\_lookup);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01436}01436           \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01437}01437         \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01438}01438       \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01439}01439     \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01440}01440   \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01441}01441 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01442}01442 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01443}01443 \textcolor{comment}{  /// /////////////////////////////////////////////////////////////////////}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01444}01444 \textcolor{comment}{  /// /////////////////////////////////////////////////////////////////////}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01445}01445 \textcolor{comment}{  /// /////////////////////////////////////////////////////////////////////}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01446}01446 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01447}01447 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01448}01448   \textcolor{comment}{//===========================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01449}01449 \textcolor{comment}{  /// Constructor, takes the pointer to the "{}bulk"{} element, the}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01450}01450 \textcolor{comment}{  /// index of the fixed local coordinate and its value represented}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01451}01451 \textcolor{comment}{  /// by an integer (+/-\/ 1), indicating that the face is located}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01452}01452 \textcolor{comment}{  /// at the max. or min. value of the "{}fixed"{} local coordinate}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01453}01453 \textcolor{comment}{  /// in the bulk element.}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01454}01454 \textcolor{comment}{}  \textcolor{comment}{//===========================================================================}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01455}\mbox{\hyperlink{classoomph_1_1ClampedHermiteShellBoundaryConditionElement_ac2c060fc25233cb0c73fdff218c25922}{01455}}   \mbox{\hyperlink{classoomph_1_1ClampedHermiteShellBoundaryConditionElement_a72fed47743a1a079d39307c63d06a65b}{ClampedHermiteShellBoundaryConditionElement::}}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01456}01456 \mbox{\hyperlink{classoomph_1_1ClampedHermiteShellBoundaryConditionElement_a72fed47743a1a079d39307c63d06a65b}{    ClampedHermiteShellBoundaryConditionElement}}(}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01457}01457       \mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}* \textcolor{keyword}{const}\& bulk\_el\_pt, \textcolor{keyword}{const} \textcolor{keywordtype}{int}\& face\_index)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01458}01458     : \mbox{\hyperlink{classoomph_1_1FaceGeometry}{FaceGeometry}}<\mbox{\hyperlink{classoomph_1_1HermiteShellElement}{HermiteShellElement}}>(), \mbox{\hyperlink{classoomph_1_1FaceElement}{FaceElement}}()}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01459}01459   \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01460}01460     \textcolor{comment}{// Let the bulk element build the FaceElement, i.e. setup the pointers}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01461}01461     \textcolor{comment}{// to its nodes (by referring to the appropriate nodes in the bulk}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01462}01462     \textcolor{comment}{// element), etc.}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01463}01463     bulk\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_aaf7bead5b462cfd5401d97b3dbdc7af7}{build\_face\_element}}(\mbox{\hyperlink{classoomph_1_1FaceElement_a14990bd081523c47cfe57e5ecf54dfe1}{face\_index}}, \textcolor{keyword}{this});}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01464}01464 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01465}01465     \textcolor{comment}{// Overwrite default assignments:}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01466}01466 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01467}01467     \textcolor{comment}{// Number of position types (for automatic local equation numbering)}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01468}01468     \textcolor{comment}{// must be re-\/set to the shell case because the constraint}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01469}01469     \textcolor{comment}{// equation makes contributions to all 3 (coordinate directions) x}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01470}01470     \textcolor{comment}{// 4 (types of positional dofs) = 12 dofs associated with each node in the}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01471}01471     \textcolor{comment}{// shell element. But keep reading...}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01472}01472     \mbox{\hyperlink{classoomph_1_1FiniteElement_a28916ab3a512b5329e016d90450eb66a}{set\_nnodal\_position\_type}}(4);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01473}01473 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01474}01474 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01475}01475     \textcolor{comment}{// The trouble with the above is that the parametrisation of the}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01476}01476     \textcolor{comment}{// element geometry (used in J\_eulerian and elsewhere)}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01477}01477     \textcolor{comment}{// is based on the 4 (2 nodes x 2 types -\/-\/ value and slope) shape functions}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01478}01478     \textcolor{comment}{// in the 1D element. In general this is done by looping over the}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01479}01479     \textcolor{comment}{// nodal position types (2 per node) and referring to the}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01480}01480     \textcolor{comment}{// relevant position Data at the nodes indirectly via the}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01481}01481     \textcolor{comment}{// bulk\_position\_type(...) function. This is now screwed up}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01482}01482     \textcolor{comment}{// because we've bumped up the number of nodal position types}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01483}01483     \textcolor{comment}{// to four! The slightly hacky way around this is resize}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01484}01484     \textcolor{comment}{// the lookup scheme underlying the bulk\_position\_type(...)}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01485}01485     \textcolor{comment}{// to four types of degree of freedom per node so it's consistent}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01486}01486     \textcolor{comment}{// with the above assignement. However, we only have shape}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01487}01487     \textcolor{comment}{// functions associated with the two types of degree of freedom,}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01488}01488     \textcolor{comment}{// so (below) we overload shape(...) and dshape\_local(...)}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01489}01489     \textcolor{comment}{// to that it returns zero for all "{}superfluous"{} shape functions.}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01490}01490     \mbox{\hyperlink{classoomph_1_1FaceElement_a7e6ac88c4dbc58f16e9c7ca60b6b9c0f}{bulk\_position\_type\_resize}}(4);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01491}01491 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01492}01492     \textcolor{comment}{// Make some dummy assigments to the position types that}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01493}01493     \textcolor{comment}{// correspond to the two superfluous ones -\/-\/ the values associated}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01494}01494     \textcolor{comment}{// with these will never be used since we're setting the}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01495}01495     \textcolor{comment}{// associated shape functions to zero!}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01496}01496     \mbox{\hyperlink{classoomph_1_1FaceElement_ac1a600a66791142918b29e65e19777a8}{bulk\_position\_type}}(2) = 0;}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01497}01497     \mbox{\hyperlink{classoomph_1_1FaceElement_ac1a600a66791142918b29e65e19777a8}{bulk\_position\_type}}(3) = 0;}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01498}01498 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01499}01499     \textcolor{comment}{// Resize normal to clamping plane and initialise for clamping}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01500}01500     \textcolor{comment}{// being applied in a plane where z=const.}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01501}01501     \mbox{\hyperlink{classoomph_1_1ClampedHermiteShellBoundaryConditionElement_ae374c52cd948ff9871ea64442ef8a53d}{Normal\_to\_clamping\_plane}}.resize(3);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01502}01502     \mbox{\hyperlink{classoomph_1_1ClampedHermiteShellBoundaryConditionElement_ae374c52cd948ff9871ea64442ef8a53d}{Normal\_to\_clamping\_plane}}[0] = 0.0;}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01503}01503     \mbox{\hyperlink{classoomph_1_1ClampedHermiteShellBoundaryConditionElement_ae374c52cd948ff9871ea64442ef8a53d}{Normal\_to\_clamping\_plane}}[1] = 0.0;}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01504}01504     \mbox{\hyperlink{classoomph_1_1ClampedHermiteShellBoundaryConditionElement_ae374c52cd948ff9871ea64442ef8a53d}{Normal\_to\_clamping\_plane}}[2] = 1.0;}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01505}01505 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01506}01506     \textcolor{comment}{// We need two additional values (for the two types of the Lagrange}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01507}01507     \textcolor{comment}{// multiplier interpolated by the 1D Hermite basis functions)}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01508}01508     \textcolor{comment}{// at the element's two nodes}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01509}01509     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<unsigned>}} nadditional\_data\_values(2);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01510}01510     nadditional\_data\_values[0] = 2;}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01511}01511     nadditional\_data\_values[1] = 2;}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01512}01512     \mbox{\hyperlink{classoomph_1_1FaceElement_ae7513d0db79b9ec47f9d72f40dbb4417}{resize\_nodes}}(nadditional\_data\_values);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01513}01513   \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01514}01514 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01515}01515 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01516}01516   \textcolor{comment}{//===========================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01517}01517 \textcolor{comment}{  /// Add the element's contribution to its residual vector}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01518}01518 \textcolor{comment}{}  \textcolor{comment}{//===========================================================================}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01519}\mbox{\hyperlink{classoomph_1_1ClampedHermiteShellBoundaryConditionElement_ab50bd8d39186b633c398c508f9caf7fb}{01519}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1ClampedHermiteShellBoundaryConditionElement_ab50bd8d39186b633c398c508f9caf7fb}{ClampedHermiteShellBoundaryConditionElement::}}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01520}01520 \mbox{\hyperlink{classoomph_1_1ClampedHermiteShellBoundaryConditionElement_ab50bd8d39186b633c398c508f9caf7fb}{    fill\_in\_contribution\_to\_residuals}}(\mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}}\& residuals)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01521}01521   \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01522}01522     \textcolor{comment}{// Get position vector to and normal vector on wall (from bulk element)}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01523}01523     \mbox{\hyperlink{classoomph_1_1HermiteShellElement}{HermiteShellElement}}* bulk\_el\_pt =}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01524}01524       \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1HermiteShellElement}{HermiteShellElement}}*\textcolor{keyword}{>}(\mbox{\hyperlink{classoomph_1_1FaceElement_a89e9f7ebc8019c47d54dded72f05479e}{bulk\_element\_pt}}());}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01525}01525 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01526}01526     \textcolor{comment}{// Local coordinates in bulk}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01527}01527     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} s\_bulk(2);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01528}01528 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01529}01529     \textcolor{comment}{// Local coordinate in FaceElement:}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01530}01530     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}(1);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01531}01531 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01532}01532     \textcolor{comment}{// Normal to shell}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01533}01533     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} shell\_normal(3);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01534}01534     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} shell\_normal\_plus(3);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01535}01535 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01536}01536     \textcolor{comment}{// Find out how many nodes there are}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01537}01537     \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} n\_node = \mbox{\hyperlink{classoomph_1_1FiniteElement_a6219ed269a6d89b5aa14659cce48905a}{nnode}}();}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01538}01538 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01539}01539     \textcolor{comment}{// Types of (nonzero) shape/test fcts (for Lagrange multiplier) in}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01540}01540     \textcolor{comment}{// this element}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01541}01541     \textcolor{keywordtype}{unsigned} n\_type = 2;}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01542}01542 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01543}01543     \textcolor{comment}{// Integer to store the local equation number}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01544}01544     \textcolor{keywordtype}{int} local\_eqn = 0;}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01545}01545 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01546}01546     \textcolor{comment}{// Set up memory for the shape functions:}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01547}01547 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01548}01548     \textcolor{comment}{// Shape fcts}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01549}01549     \mbox{\hyperlink{classoomph_1_1Shape}{Shape}} psi(n\_node, n\_type);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01550}01550 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01551}01551     \textcolor{comment}{// Set \# of integration points}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01552}01552     \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} n\_intpt = \mbox{\hyperlink{classoomph_1_1FiniteElement_a1a4723c4ee3fe4c6404203bb987f804e}{integral\_pt}}()-\/>\mbox{\hyperlink{classoomph_1_1Integral_a1a270de9d99a1fcf1d25a6c1017f65fa}{nweight}}();}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01553}01553 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01554}01554     \textcolor{comment}{// Loop over the integration points}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01555}01555     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} ipt = 0; ipt < n\_intpt; ipt++)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01556}01556     \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01557}01557       \textcolor{comment}{// Get the integral weight}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01558}01558       \textcolor{keywordtype}{double} w = \mbox{\hyperlink{classoomph_1_1FiniteElement_a1a4723c4ee3fe4c6404203bb987f804e}{integral\_pt}}()-\/>\mbox{\hyperlink{classoomph_1_1Integral_ac65335e2aab120b285b3d6c294507b06}{weight}}(ipt);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01559}01559 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01560}01560       \textcolor{comment}{// Get integration point in local coordinates}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01561}01561       \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0] = \mbox{\hyperlink{classoomph_1_1FiniteElement_a1a4723c4ee3fe4c6404203bb987f804e}{integral\_pt}}()-\/>\mbox{\hyperlink{classoomph_1_1Integral_a1a2122f99a87c18649bafdd9ed739758}{knot}}(ipt, 0);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01562}01562 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01563}01563       \textcolor{comment}{// Get shape functions}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01564}01564       \mbox{\hyperlink{classoomph_1_1ClampedHermiteShellBoundaryConditionElement_ae9a3033b7bcba34dafcb7154be331b7f}{shape}}(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, psi);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01565}01565 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01566}01566       \textcolor{comment}{// Get jacobian}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01567}01567       \textcolor{keywordtype}{double} J = \mbox{\hyperlink{classoomph_1_1FaceElement_a919d0d76746eaa78a8a3c7f75f99a9e5}{J\_eulerian}}(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}});}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01568}01568 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01569}01569       \textcolor{comment}{// Assemble the Lagrange multiplier}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01570}01570       \textcolor{keywordtype}{double} lambda = 0.0;}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01571}01571       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < n\_node; j++)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01572}01572       \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01573}01573         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} k = 0; k < n\_type; k++)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01574}01574         \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01575}01575           \textcolor{comment}{// The (additional) Lagrange multiplier values are stored}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01576}01576           \textcolor{comment}{// after those that were created by the bulk elements:}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01577}01577           lambda += \mbox{\hyperlink{classoomph_1_1FiniteElement_a9addfe893ab8205619963aa96204cdc4}{node\_pt}}(j)-\/>\mbox{\hyperlink{classoomph_1_1Node_afcc5cdba40bca251826ae5bee5ca15b4}{value}}(\mbox{\hyperlink{classoomph_1_1FaceElement_abd04b85066da626341294b5f0b97516e}{Nbulk\_value}}[j] + k) * psi(j, k);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01578}01578         \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01579}01579       \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01580}01580 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01581}01581       \textcolor{comment}{// Get vector of coordinates in bulk element}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01582}01582       s\_bulk = \mbox{\hyperlink{classoomph_1_1FaceElement_a5dd56d5b438c316aca9efa815441b74d}{local\_coordinate\_in\_bulk}}(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}});}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01583}01583 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01584}01584       \textcolor{comment}{// Get unit normal on bulk shell element}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01585}01585       bulk\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1KirchhoffLoveShellEquations_a797e455634ac8b8e8669c4adff84e644}{get\_normal}}(s\_bulk, shell\_normal);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01586}01586 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01587}01587       \textcolor{comment}{// Premultiply the weights and the Jacobian}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01588}01588       \textcolor{keywordtype}{double} \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6}{W}} = w * J;}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01589}01589 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01590}01590       \textcolor{comment}{// Here's the actual constraint}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01591}01591       \textcolor{keywordtype}{double} constraint\_residual =}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01592}01592         shell\_normal[0] * \mbox{\hyperlink{classoomph_1_1ClampedHermiteShellBoundaryConditionElement_ae374c52cd948ff9871ea64442ef8a53d}{Normal\_to\_clamping\_plane}}[0] +}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01593}01593         shell\_normal[1] * \mbox{\hyperlink{classoomph_1_1ClampedHermiteShellBoundaryConditionElement_ae374c52cd948ff9871ea64442ef8a53d}{Normal\_to\_clamping\_plane}}[1] +}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01594}01594         shell\_normal[2] * \mbox{\hyperlink{classoomph_1_1ClampedHermiteShellBoundaryConditionElement_ae374c52cd948ff9871ea64442ef8a53d}{Normal\_to\_clamping\_plane}}[2];}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01595}01595 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01596}01596 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01597}01597       \textcolor{comment}{// Assemble residual for Lagrange multiplier:}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01598}01598       \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01599}01599 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01600}01600       \textcolor{comment}{// Loop over the number of nodes}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01601}01601       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < n\_node; j++)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01602}01602       \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01603}01603         \textcolor{comment}{// Loop over the type of degree of freedom}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01604}01604         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} k = 0; k < n\_type; k++)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01605}01605         \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01606}01606           \textcolor{comment}{// Local eqn number. Recall that the}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01607}01607           \textcolor{comment}{// (additional) Lagrange multiplier values are stored}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01608}01608           \textcolor{comment}{// after those that were created by the bulk elements:}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01609}01609           local\_eqn = \mbox{\hyperlink{classoomph_1_1FiniteElement_a5da80bbed97543e586f698251d67941d}{nodal\_local\_eqn}}(j, \mbox{\hyperlink{classoomph_1_1FaceElement_abd04b85066da626341294b5f0b97516e}{Nbulk\_value}}[j] + k);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01610}01610           \textcolor{keywordflow}{if} (local\_eqn >= 0)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01611}01611           \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01612}01612             residuals[local\_eqn] += constraint\_residual * psi(j, k) * \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6}{W}};}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01613}01613           \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01614}01614         \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01615}01615       \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01616}01616 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01617}01617 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01618}01618       \textcolor{comment}{// Add Lagrange multiplier contribution to bulk equations}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01619}01619       \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01620}01620 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01621}01621       \textcolor{comment}{// Derivatives of constraint equations w.r.t. positional values}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01622}01622       \textcolor{comment}{// is done by finite differencing}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01623}01623       \textcolor{keywordtype}{double} fd\_step = 1.0e-\/8;}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01624}01624 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01625}01625       \textcolor{comment}{// Loop over the number of nodes}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01626}01626       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < n\_node; j++)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01627}01627       \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01628}01628         \mbox{\hyperlink{classoomph_1_1Node}{Node}}* nod\_pt = \mbox{\hyperlink{classoomph_1_1FiniteElement_a9addfe893ab8205619963aa96204cdc4}{node\_pt}}(j);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01629}01629 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01630}01630         \textcolor{comment}{// Loop over directions}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01631}01631         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < 3; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01632}01632         \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01633}01633           \textcolor{comment}{// Loop over the type of degree of freedom}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01634}01634           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} k = 0; k < 4; k++)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01635}01635           \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01636}01636             \textcolor{comment}{// Local eqn number: Node, type, direction}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01637}01637             local\_eqn = \mbox{\hyperlink{classoomph_1_1SolidFiniteElement_a8632178393e76ffcd88888ab96616b1a}{position\_local\_eqn}}(j, k, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}});}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01638}01638             \textcolor{keywordflow}{if} (local\_eqn >= 0)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01639}01639             \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01640}01640               \textcolor{comment}{// Backup}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01641}01641               \textcolor{keywordtype}{double} backup = nod\_pt-\/>\mbox{\hyperlink{classoomph_1_1Node_af7fdc0dfda495d69bd31c790ee77da73}{x\_gen}}(k, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}});}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01642}01642 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01643}01643               \textcolor{comment}{// Increment}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01644}01644               nod\_pt-\/>\mbox{\hyperlink{classoomph_1_1Node_af7fdc0dfda495d69bd31c790ee77da73}{x\_gen}}(k, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) += fd\_step;}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01645}01645 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01646}01646               \textcolor{comment}{// Re-\/evaluate unit normal on bulk shell element}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01647}01647               bulk\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1KirchhoffLoveShellEquations_a797e455634ac8b8e8669c4adff84e644}{get\_normal}}(s\_bulk, shell\_normal\_plus);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01648}01648 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01649}01649               \textcolor{comment}{// Re-\/evaluate the constraint}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01650}01650               \textcolor{keywordtype}{double} constraint\_residual\_plus =}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01651}01651                 shell\_normal\_plus[0] * \mbox{\hyperlink{classoomph_1_1ClampedHermiteShellBoundaryConditionElement_ae374c52cd948ff9871ea64442ef8a53d}{Normal\_to\_clamping\_plane}}[0] +}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01652}01652                 shell\_normal\_plus[1] * \mbox{\hyperlink{classoomph_1_1ClampedHermiteShellBoundaryConditionElement_ae374c52cd948ff9871ea64442ef8a53d}{Normal\_to\_clamping\_plane}}[1] +}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01653}01653                 shell\_normal\_plus[2] * \mbox{\hyperlink{classoomph_1_1ClampedHermiteShellBoundaryConditionElement_ae374c52cd948ff9871ea64442ef8a53d}{Normal\_to\_clamping\_plane}}[2];}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01654}01654 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01655}01655               \textcolor{comment}{// Derivarive of constraint w.r.t. to current discrete}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01656}01656               \textcolor{comment}{// displacement}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01657}01657               \textcolor{keywordtype}{double} dres\_dx =}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01658}01658                 (constraint\_residual\_plus -\/ constraint\_residual) / fd\_step;}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01659}01659 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01660}01660               \textcolor{comment}{// Add to residual}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01661}01661               residuals[local\_eqn] += lambda * dres\_dx * \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6}{W}};}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01662}01662 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01663}01663               \textcolor{comment}{// Reset}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01664}01664               nod\_pt-\/>\mbox{\hyperlink{classoomph_1_1Node_af7fdc0dfda495d69bd31c790ee77da73}{x\_gen}}(k, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) = backup;}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01665}01665             \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01666}01666           \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01667}01667         \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01668}01668       \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01669}01669     \} \textcolor{comment}{// End of loop over the integration points}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01670}01670 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01671}01671     \textcolor{comment}{// Loop over integration points}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01672}01672   \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01673}01673 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01674}01674 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01675}01675   \textcolor{comment}{//===========================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01676}01676 \textcolor{comment}{  /// Output function}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01677}01677 \textcolor{comment}{}  \textcolor{comment}{//===========================================================================}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01678}\mbox{\hyperlink{classoomph_1_1ClampedHermiteShellBoundaryConditionElement_a099a046661da996bac32617c0479b220}{01678}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1ClampedHermiteShellBoundaryConditionElement_a1595e604991ff18f4d907da5a8fdf40b}{ClampedHermiteShellBoundaryConditionElement::output}}(}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01679}01679     std::ostream\& outfile, \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\& n\_plot)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01680}01680   \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01681}01681     \textcolor{comment}{// Get bulk element}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01682}01682     \mbox{\hyperlink{classoomph_1_1HermiteShellElement}{HermiteShellElement}}* bulk\_el\_pt =}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01683}01683       \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1HermiteShellElement}{HermiteShellElement}}*\textcolor{keyword}{>}(\mbox{\hyperlink{classoomph_1_1FaceElement_a89e9f7ebc8019c47d54dded72f05479e}{bulk\_element\_pt}}());}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01684}01684 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01685}01685     \textcolor{comment}{// Local coord}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01686}01686     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}(1);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01687}01687 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01688}01688     \textcolor{comment}{// Coordinate in bulk}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01689}01689     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} s\_bulk(2);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01690}01690 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01691}01691     \textcolor{comment}{// Normal vector}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01692}01692     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} shell\_normal(3);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01693}01693 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01694}01694     \textcolor{comment}{// \# of nodes, \# of dof types}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01695}01695     \mbox{\hyperlink{classoomph_1_1Shape}{Shape}} psi(2, 2);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01696}01696 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01697}01697     \textcolor{comment}{// Tecplot header info}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01698}01698     outfile << \textcolor{stringliteral}{"{}ZONE I="{}} << n\_plot << std::endl;}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01699}01699 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01700}01700     \textcolor{comment}{// Loop over plot points}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01701}01701     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} l = 0; l < n\_plot; l++)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01702}01702     \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01703}01703       \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0] = -\/1.0 + l * 2.0 / (n\_plot -\/ 1);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01704}01704 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01705}01705       \textcolor{comment}{// Get vector of coordinates in bulk element}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01706}01706       s\_bulk = \mbox{\hyperlink{classoomph_1_1FaceElement_a5dd56d5b438c316aca9efa815441b74d}{local\_coordinate\_in\_bulk}}(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}});}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01707}01707 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01708}01708       \textcolor{comment}{// Get unit normal on bulk shell element}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01709}01709       bulk\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1KirchhoffLoveShellEquations_a797e455634ac8b8e8669c4adff84e644}{get\_normal}}(s\_bulk, shell\_normal);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01710}01710 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01711}01711       \textcolor{comment}{// Get shape function}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01712}01712       \mbox{\hyperlink{classoomph_1_1ClampedHermiteShellBoundaryConditionElement_ae9a3033b7bcba34dafcb7154be331b7f}{shape}}(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, psi);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01713}01713 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01714}01714       \textcolor{comment}{// Assemble the Lagrange multiplier}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01715}01715       \textcolor{keywordtype}{double} lambda = 0.0;}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01716}01716       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < 2; j++)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01717}01717       \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01718}01718         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} k = 0; k < 2; k++)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01719}01719         \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01720}01720           \textcolor{comment}{// The (additional) Lagrange multiplier values are stored}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01721}01721           \textcolor{comment}{// after those that were created by the bulk elements:}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01722}01722           lambda += \mbox{\hyperlink{classoomph_1_1FiniteElement_a9addfe893ab8205619963aa96204cdc4}{node\_pt}}(j)-\/>\mbox{\hyperlink{classoomph_1_1Node_afcc5cdba40bca251826ae5bee5ca15b4}{value}}(\mbox{\hyperlink{classoomph_1_1FaceElement_abd04b85066da626341294b5f0b97516e}{Nbulk\_value}}[j] + k) * psi(j, k);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01723}01723         \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01724}01724       \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01725}01725 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01726}01726       \textcolor{keywordtype}{double} dot\_product = shell\_normal[0] * \mbox{\hyperlink{classoomph_1_1ClampedHermiteShellBoundaryConditionElement_ae374c52cd948ff9871ea64442ef8a53d}{Normal\_to\_clamping\_plane}}[0] +}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01727}01727                            shell\_normal[1] * \mbox{\hyperlink{classoomph_1_1ClampedHermiteShellBoundaryConditionElement_ae374c52cd948ff9871ea64442ef8a53d}{Normal\_to\_clamping\_plane}}[1] +}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01728}01728                            shell\_normal[2] * \mbox{\hyperlink{classoomph_1_1ClampedHermiteShellBoundaryConditionElement_ae374c52cd948ff9871ea64442ef8a53d}{Normal\_to\_clamping\_plane}}[2];}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01729}01729 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01730}01730       \textcolor{comment}{// Output stuff}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01731}01731       outfile << \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0] << \textcolor{stringliteral}{"{} "{}} << \mbox{\hyperlink{classoomph_1_1SolidFaceElement_ace3eb64ce511c869bd140922b6597667}{interpolated\_xi}}(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, 0) << \textcolor{stringliteral}{"{} "{}}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01732}01732               << \mbox{\hyperlink{classoomph_1_1SolidFaceElement_ace3eb64ce511c869bd140922b6597667}{interpolated\_xi}}(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, 1) << \textcolor{stringliteral}{"{} "{}} << \mbox{\hyperlink{classoomph_1_1FaceElement_a7aa612fec3604e08344503fbcdc357c8}{interpolated\_x}}(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, 0) << \textcolor{stringliteral}{"{} "{}}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01733}01733               << \mbox{\hyperlink{classoomph_1_1FaceElement_a7aa612fec3604e08344503fbcdc357c8}{interpolated\_x}}(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, 1) << \textcolor{stringliteral}{"{} "{}} << \mbox{\hyperlink{classoomph_1_1FaceElement_a7aa612fec3604e08344503fbcdc357c8}{interpolated\_x}}(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, 2) << \textcolor{stringliteral}{"{} "{}}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01734}01734               << \mbox{\hyperlink{classoomph_1_1FaceElement_a919d0d76746eaa78a8a3c7f75f99a9e5}{J\_eulerian}}(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}) << \textcolor{stringliteral}{"{} "{}} << bulk\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1SolidFiniteElement_a94ab4919b462d52cfdf6235bb9367d15}{interpolated\_xi}}(s\_bulk, 0)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01735}01735               << \textcolor{stringliteral}{"{} "{}} << bulk\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1SolidFiniteElement_a94ab4919b462d52cfdf6235bb9367d15}{interpolated\_xi}}(s\_bulk, 1) << \textcolor{stringliteral}{"{} "{}}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01736}01736               << bulk\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a5a9c1ead9819cd17603096e63087020f}{interpolated\_x}}(s\_bulk, 0) << \textcolor{stringliteral}{"{} "{}}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01737}01737               << bulk\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a5a9c1ead9819cd17603096e63087020f}{interpolated\_x}}(s\_bulk, 1) << \textcolor{stringliteral}{"{} "{}}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01738}01738               << bulk\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a5a9c1ead9819cd17603096e63087020f}{interpolated\_x}}(s\_bulk, 2) << \textcolor{stringliteral}{"{} "{}} << lambda << \textcolor{stringliteral}{"{} "{}}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01739}01739               << shell\_normal[0] << \textcolor{stringliteral}{"{} "{}} << shell\_normal[1] << \textcolor{stringliteral}{"{} "{}}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01740}01740               << shell\_normal[2] << \textcolor{stringliteral}{"{} "{}} << \mbox{\hyperlink{classoomph_1_1ClampedHermiteShellBoundaryConditionElement_ae374c52cd948ff9871ea64442ef8a53d}{Normal\_to\_clamping\_plane}}[0] << \textcolor{stringliteral}{"{} "{}}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01741}01741               << \mbox{\hyperlink{classoomph_1_1ClampedHermiteShellBoundaryConditionElement_ae374c52cd948ff9871ea64442ef8a53d}{Normal\_to\_clamping\_plane}}[1] << \textcolor{stringliteral}{"{} "{}}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01742}01742               << \mbox{\hyperlink{classoomph_1_1ClampedHermiteShellBoundaryConditionElement_ae374c52cd948ff9871ea64442ef8a53d}{Normal\_to\_clamping\_plane}}[2] << \textcolor{stringliteral}{"{} "{}} << dot\_product << \textcolor{stringliteral}{"{} "{}}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01743}01743               << std::endl;}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01744}01744     \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01745}01745 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01746}01746 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01747}01747     \textcolor{comment}{// Initialise error}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01748}01748     \textcolor{keyword}{const} \textcolor{keywordtype}{bool} check\_error = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01749}01749     \textcolor{keywordflow}{if} (check\_error)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01750}01750     \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01751}01751       \textcolor{keywordtype}{double} max\_error = 0.0;}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01752}01752 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01753}01753       \textcolor{comment}{// Set \# of integration points}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01754}01754       \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} n\_intpt = \mbox{\hyperlink{classoomph_1_1FiniteElement_a1a4723c4ee3fe4c6404203bb987f804e}{integral\_pt}}()-\/>\mbox{\hyperlink{classoomph_1_1Integral_a1a270de9d99a1fcf1d25a6c1017f65fa}{nweight}}();}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01755}01755 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01756}01756       \textcolor{comment}{// Loop over the integration points}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01757}01757       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} ipt = 0; ipt < n\_intpt; ipt++)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01758}01758       \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01759}01759         \textcolor{comment}{// Get integration point in local coordinates}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01760}01760         \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0] = \mbox{\hyperlink{classoomph_1_1FiniteElement_a1a4723c4ee3fe4c6404203bb987f804e}{integral\_pt}}()-\/>\mbox{\hyperlink{classoomph_1_1Integral_a1a2122f99a87c18649bafdd9ed739758}{knot}}(ipt, 0);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01761}01761 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01762}01762         \textcolor{comment}{// Get eulerian jacobian via s}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01763}01763         \textcolor{keywordtype}{double} J\_via\_s = \mbox{\hyperlink{classoomph_1_1FaceElement_a919d0d76746eaa78a8a3c7f75f99a9e5}{J\_eulerian}}(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}});}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01764}01764 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01765}01765         \textcolor{comment}{// Get eulerian jacobian via ipt}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01766}01766         \textcolor{keywordtype}{double} J\_via\_ipt = \mbox{\hyperlink{classoomph_1_1FaceElement_aa6380a08afc18bd4f35e337a1131a9d8}{J\_eulerian\_at\_knot}}(ipt);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01767}01767 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01768}01768         \textcolor{keywordtype}{double} error = std::fabs(J\_via\_s -\/ J\_via\_ipt);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01769}01769         \textcolor{keywordflow}{if} (error > max\_error) max\_error = error;}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01770}01770       \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01771}01771       \textcolor{keywordflow}{if} (max\_error > 1.0e-\/14)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01772}01772       \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01773}01773         \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{}Warning: Max. error between J\_via\_s J\_via\_ipt "{}}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01774}01774                    << max\_error << std::endl;}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01775}01775       \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01776}01776     \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01777}01777   \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01778}01778 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01779}01779   \textcolor{comment}{//=============================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01780}01780 \textcolor{comment}{  /// Create a list of pairs for all unknowns in this element,}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01781}01781 \textcolor{comment}{  /// so that the first entry in each pair contains the global equation}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01782}01782 \textcolor{comment}{  /// number of the unknown, while the second one contains the number}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01783}01783 \textcolor{comment}{  /// of the "{}DOF types"{} that this unknown is associated with.}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01784}01784 \textcolor{comment}{  /// (Function can obviously only be called if the equation numbering}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01785}01785 \textcolor{comment}{  /// scheme has been set up.)}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01786}01786 \textcolor{comment}{  /// This element is only in charge of the solid dofs.}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01787}01787 \textcolor{comment}{}  \textcolor{comment}{//=============================================================================}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01788}\mbox{\hyperlink{classoomph_1_1ClampedHermiteShellBoundaryConditionElement_a7b18a5df8ade2926ccd6e7bcfa182dd9}{01788}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1ClampedHermiteShellBoundaryConditionElement_a7b18a5df8ade2926ccd6e7bcfa182dd9}{ClampedHermiteShellBoundaryConditionElement::}}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01789}01789 \mbox{\hyperlink{classoomph_1_1ClampedHermiteShellBoundaryConditionElement_a7b18a5df8ade2926ccd6e7bcfa182dd9}{    get\_dof\_numbers\_for\_unknowns}}(}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01790}01790       std::list<std::pair<unsigned long, unsigned>>\& dof\_lookup\_list)\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01791}01791 \textcolor{keyword}{  }\{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01792}01792     \textcolor{comment}{// temporary pair (used to store dof lookup prior to being added to list)}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01793}01793     std::pair<unsigned long, unsigned> dof\_lookup;}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01794}01794 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01795}01795     \textcolor{comment}{// number of nodes}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01796}01796     \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} n\_node = this-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a6219ed269a6d89b5aa14659cce48905a}{nnode}}();}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01797}01797 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01798}01798     \textcolor{comment}{// Get the number of position dofs and dimensions at the node}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01799}01799     \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} n\_position\_type = \mbox{\hyperlink{classoomph_1_1FiniteElement_a36f4cb7569a545a9d93b66e6ee03cc91}{nnodal\_position\_type}}();}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01800}01800     \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} nodal\_dim = \mbox{\hyperlink{classoomph_1_1FiniteElement_ab6602b43c3a2f1a5e48729b0b23c0d91}{nodal\_dimension}}();}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01801}01801 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01802}01802     \textcolor{comment}{// Integer storage for local unknown}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01803}01803     \textcolor{keywordtype}{int} local\_unknown = 0;}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01804}01804 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01805}01805     \textcolor{comment}{// Loop over the nodes}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01806}01806     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} n = 0; n < n\_node; n++)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01807}01807     \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01808}01808       \mbox{\hyperlink{classoomph_1_1Node}{Node}}* nod\_pt = this-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a9addfe893ab8205619963aa96204cdc4}{node\_pt}}(n);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01809}01809 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01810}01810       \textcolor{comment}{// Loop over position dofs}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01811}01811       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} k = 0; k < n\_position\_type; k++)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01812}01812       \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01813}01813         \textcolor{comment}{// Loop over dimension}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01814}01814         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < nodal\_dim; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01815}01815         \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01816}01816           \textcolor{comment}{// If the variable is free}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01817}01817           local\_unknown = \mbox{\hyperlink{classoomph_1_1SolidFiniteElement_a8632178393e76ffcd88888ab96616b1a}{position\_local\_eqn}}(n, k, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}});}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01818}01818 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01819}01819           \textcolor{comment}{// ignore pinned values}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01820}01820           \textcolor{keywordflow}{if} (local\_unknown >= 0)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01821}01821           \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01822}01822             \textcolor{comment}{// store dof lookup in temporary pair: First entry in pair}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01823}01823             \textcolor{comment}{// is global equation number; second entry is dof type}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01824}01824             dof\_lookup.first = this-\/>\mbox{\hyperlink{classoomph_1_1GeneralisedElement_a37ac5a1d5234fa931ab710c0c74d55d2}{eqn\_number}}(local\_unknown);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01825}01825             dof\_lookup.second = 0;}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01826}01826 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01827}01827             \textcolor{comment}{// add to list}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01828}01828             dof\_lookup\_list.push\_front(dof\_lookup);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01829}01829           \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01830}01830         \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01831}01831       \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01832}01832 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01833}01833       \textcolor{comment}{// Loop over values}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01834}01834       \textcolor{keywordtype}{unsigned} n\_val = nod\_pt-\/>\mbox{\hyperlink{classoomph_1_1Data_a7e67fc78a2e8a2fd6eb75bd292d42ff8}{nvalue}}();}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01835}01835       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < n\_val; j++)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01836}01836       \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01837}01837         \textcolor{comment}{// If the variable is free}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01838}01838         local\_unknown = \mbox{\hyperlink{classoomph_1_1FiniteElement_a5da80bbed97543e586f698251d67941d}{nodal\_local\_eqn}}(n, j);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01839}01839 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01840}01840         \textcolor{comment}{// ignore pinned values}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01841}01841         \textcolor{keywordflow}{if} (local\_unknown >= 0)}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01842}01842         \{}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01843}01843           \textcolor{comment}{// store dof lookup in temporary pair: First entry in pair}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01844}01844           \textcolor{comment}{// is global equation number; second entry is dof type}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01845}01845           dof\_lookup.first = this-\/>\mbox{\hyperlink{classoomph_1_1GeneralisedElement_a37ac5a1d5234fa931ab710c0c74d55d2}{eqn\_number}}(local\_unknown);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01846}01846           dof\_lookup.second = 0;}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01847}01847 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01848}01848           \textcolor{comment}{// add to list}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01849}01849           dof\_lookup\_list.push\_front(dof\_lookup);}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01850}01850         \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01851}01851       \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01852}01852     \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01853}01853   \}}
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01854}01854 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01855}01855 }
\DoxyCodeLine{\Hypertarget{shell__elements_8cc_source_l01856}01856 \} \textcolor{comment}{// namespace oomph}}

\end{DoxyCode}

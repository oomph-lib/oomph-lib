\hypertarget{extruded__domain_8cc_source}{}\doxysection{extruded\+\_\+domain.\+cc}
\label{extruded__domain_8cc_source}\index{extruded\_domain.cc@{extruded\_domain.cc}}
\mbox{\hyperlink{extruded__domain_8cc}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00001}00001 \textcolor{comment}{// LIC// ====================================================================}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00002}00002 \textcolor{comment}{// LIC// This file forms part of oomph-\/lib, the object-\/oriented,}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00003}00003 \textcolor{comment}{// LIC// multi-\/physics finite-\/element library, available}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00004}00004 \textcolor{comment}{// LIC// at http://www.oomph-\/lib.org.}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00005}00005 \textcolor{comment}{// LIC//}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00006}00006 \textcolor{comment}{// LIC// Copyright (C) 2006-\/2022 Matthias Heil and Andrew Hazel}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00007}00007 \textcolor{comment}{// LIC//}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00008}00008 \textcolor{comment}{// LIC// This library is free software; you can redistribute it and/or}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00009}00009 \textcolor{comment}{// LIC// modify it under the terms of the GNU Lesser General Public}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00010}00010 \textcolor{comment}{// LIC// License as published by the Free Software Foundation; either}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00011}00011 \textcolor{comment}{// LIC// version 2.1 of the License, or (at your option) any later version.}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00012}00012 \textcolor{comment}{// LIC//}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00013}00013 \textcolor{comment}{// LIC// This library is distributed in the hope that it will be useful,}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00014}00014 \textcolor{comment}{// LIC// but WITHOUT ANY WARRANTY; without even the implied warranty of}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00015}00015 \textcolor{comment}{// LIC// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00016}00016 \textcolor{comment}{// LIC// Lesser General Public License for more details.}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00017}00017 \textcolor{comment}{// LIC//}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00018}00018 \textcolor{comment}{// LIC// You should have received a copy of the GNU Lesser General Public}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00019}00019 \textcolor{comment}{// LIC// License along with this library; if not, write to the Free Software}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00020}00020 \textcolor{comment}{// LIC// Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00021}00021 \textcolor{comment}{// LIC// 02110-\/1301  USA.}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00022}00022 \textcolor{comment}{// LIC//}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00023}00023 \textcolor{comment}{// LIC// The authors may be contacted at oomph-\/lib@maths.man.ac.uk.}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00024}00024 \textcolor{comment}{// LIC//}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00025}00025 \textcolor{comment}{// LIC//====================================================================}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00026}00026 \textcolor{comment}{// oomph-\/lib headers}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00027}00027 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{extruded__domain_8h}{extruded\_domain.h}}"{}}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00028}00028 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{extruded__macro__element_8h}{extruded\_macro\_element.h}}"{}}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00029}00029 }
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00030}00030 \textcolor{keyword}{namespace }\mbox{\hyperlink{namespaceoomph}{oomph}}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00031}00031 \{}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00032}00032   \textcolor{comment}{//=================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00033}00033 \textcolor{comment}{  /// Constructor}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00034}00034 \textcolor{comment}{}  \textcolor{comment}{//=================================================================}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00035}\mbox{\hyperlink{classoomph_1_1ExtrudedDomain_a3aec641345ecc5502afbb29feb2b0006}{00035}}   \mbox{\hyperlink{classoomph_1_1ExtrudedDomain_a3aec641345ecc5502afbb29feb2b0006}{ExtrudedDomain::ExtrudedDomain}}(\mbox{\hyperlink{classoomph_1_1Domain}{Domain}}* domain\_pt,}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00036}00036                                  \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\& n\_extruded\_element,}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00037}00037                                  \textcolor{keyword}{const} \textcolor{keywordtype}{double}\& extrusion\_length)}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00038}00038     : \mbox{\hyperlink{classoomph_1_1Domain}{Domain}}(),}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00039}00039       Domain\_pt(domain\_pt),}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00040}00040       N\_extruded\_element(n\_extruded\_element),}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00041}00041       T\_min(0.0),}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00042}00042       T\_max(extrusion\_length)}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00043}00043   \{}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00044}00044     \textcolor{comment}{// The number of macro elements to create in the extruded domain}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00045}00045     \textcolor{keywordtype}{unsigned} n\_macro\_element =}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00046}00046       \mbox{\hyperlink{classoomph_1_1ExtrudedDomain_a413f4a9c0ed71a03fbafdc813ee23ddb}{N\_extruded\_element}} * (\mbox{\hyperlink{classoomph_1_1ExtrudedDomain_abdc23c046616ea3335e9c34b7386d86e}{Domain\_pt}}-\/>\mbox{\hyperlink{classoomph_1_1Domain_a3ed63583615d0e8471d95ba13ccc0aff}{nmacro\_element}}());}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00047}00047 }
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00048}00048     \textcolor{comment}{// There are four macro elements}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00049}00049     \mbox{\hyperlink{classoomph_1_1Domain_a3a54693bb493f31acccadc62468dd7ae}{Macro\_element\_pt}}.resize(n\_macro\_element);}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00050}00050 }
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00051}00051     \textcolor{comment}{// Build the 3D extruded macro elements}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00052}00052     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < n\_macro\_element; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00053}00053     \{}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00054}00054       \textcolor{comment}{// Create the i-\/th macro element}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00055}00055       \mbox{\hyperlink{classoomph_1_1Domain_a3a54693bb493f31acccadc62468dd7ae}{Macro\_element\_pt}}[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] = \textcolor{keyword}{new} \mbox{\hyperlink{classoomph_1_1QExtrudedMacroElement_3_013_01_4}{QExtrudedMacroElement<3>}}(\textcolor{keyword}{this}, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}});}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00056}00056     \}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00057}00057   \} \textcolor{comment}{// End of ExtrudedDomain}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00058}00058 }
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00059}00059 }
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00060}00060   \textcolor{comment}{//=================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00061}00061 \textcolor{comment}{  /// Constructor}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00062}00062 \textcolor{comment}{}  \textcolor{comment}{//=================================================================}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00063}\mbox{\hyperlink{classoomph_1_1ExtrudedDomain_a8895282a7ebc08be6473062fbc5c9c60}{00063}}   \mbox{\hyperlink{classoomph_1_1ExtrudedDomain_a3aec641345ecc5502afbb29feb2b0006}{ExtrudedDomain::ExtrudedDomain}}(\mbox{\hyperlink{classoomph_1_1Domain}{Domain}}* domain\_pt,}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00064}00064                                  \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\& n\_extruded\_element,}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00065}00065                                  \textcolor{keyword}{const} \textcolor{keywordtype}{double}\& t\_min,}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00066}00066                                  \textcolor{keyword}{const} \textcolor{keywordtype}{double}\& t\_max)}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00067}00067     : \mbox{\hyperlink{classoomph_1_1Domain}{Domain}}(),}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00068}00068       Domain\_pt(domain\_pt),}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00069}00069       N\_extruded\_element(n\_extruded\_element),}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00070}00070       T\_min(t\_min),}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00071}00071       T\_max(t\_max)}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00072}00072   \{}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00073}00073     \textcolor{comment}{// The number of macro elements to create in the extruded domain}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00074}00074     \textcolor{keywordtype}{unsigned} n\_macro\_element =}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00075}00075       \mbox{\hyperlink{classoomph_1_1ExtrudedDomain_a413f4a9c0ed71a03fbafdc813ee23ddb}{N\_extruded\_element}} * (\mbox{\hyperlink{classoomph_1_1ExtrudedDomain_abdc23c046616ea3335e9c34b7386d86e}{Domain\_pt}}-\/>\mbox{\hyperlink{classoomph_1_1Domain_a3ed63583615d0e8471d95ba13ccc0aff}{nmacro\_element}}());}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00076}00076 }
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00077}00077     \textcolor{comment}{// There are four macro elements}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00078}00078     \mbox{\hyperlink{classoomph_1_1Domain_a3a54693bb493f31acccadc62468dd7ae}{Macro\_element\_pt}}.resize(n\_macro\_element);}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00079}00079 }
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00080}00080     \textcolor{comment}{// Build the 3D extruded macro elements}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00081}00081     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < n\_macro\_element; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00082}00082     \{}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00083}00083       \textcolor{comment}{// Create the i-\/th macro element}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00084}00084       \mbox{\hyperlink{classoomph_1_1Domain_a3a54693bb493f31acccadc62468dd7ae}{Macro\_element\_pt}}[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] = \textcolor{keyword}{new} \mbox{\hyperlink{classoomph_1_1QExtrudedMacroElement_3_013_01_4}{QExtrudedMacroElement<3>}}(\textcolor{keyword}{this}, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}});}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00085}00085     \}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00086}00086 }
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00087}00087     \textcolor{comment}{/*}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00088}00088 \textcolor{comment}{      // DRAIG: Might be worth having this as an output function if it's not}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00089}00089 \textcolor{comment}{      // already in the base class...}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00090}00090 \textcolor{comment}{      // Loop over the number of macro elements}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00091}00091 \textcolor{comment}{      for (unsigned i=0;i<n\_macro\_element;i++)}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00092}00092 \textcolor{comment}{      \{}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00093}00093 \textcolor{comment}{      // Create an output stream}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00094}00094 \textcolor{comment}{      std::ofstream some\_file;}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00095}00095 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00096}00096 \textcolor{comment}{      // Allocate space for the filename}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00097}00097 \textcolor{comment}{      char filename[1000];}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00098}00098 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00099}00099 \textcolor{comment}{      // Number of plot points}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00100}00100 \textcolor{comment}{      unsigned n\_pts=20;}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00101}00101 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00102}00102 \textcolor{comment}{      // Create the file name}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00103}00103 \textcolor{comment}{      sprintf(filename,"{}RESLT/extruded\_element\%i.dat"{},i);}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00104}00104 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00105}00105 \textcolor{comment}{      // Open a file with the created filename}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00106}00106 \textcolor{comment}{      some\_file.open(filename);}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00107}00107 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00108}00108 \textcolor{comment}{      // Output macro element}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00109}00109 \textcolor{comment}{      macro\_element\_pt(i)-\/>output(some\_file,n\_pts);}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00110}00110 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00111}00111 \textcolor{comment}{      // Close the file}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00112}00112 \textcolor{comment}{      some\_file.close();}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00113}00113 \textcolor{comment}{      \}}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00114}00114 \textcolor{comment}{      exit(0);}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00115}00115 \textcolor{comment}{    */}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00116}00116   \} \textcolor{comment}{// End of ExtrudedDomain}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00117}00117 }
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00118}00118 }
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00119}00119   \textcolor{comment}{//=================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00120}00120 \textcolor{comment}{  /// Number of macro elements in domain}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00121}00121 \textcolor{comment}{}  \textcolor{comment}{//=================================================================}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00122}\mbox{\hyperlink{classoomph_1_1ExtrudedDomain_a62769f3dd74db326b534997fc87cd2ff}{00122}}   \textcolor{keywordtype}{unsigned} \mbox{\hyperlink{classoomph_1_1ExtrudedDomain_a62769f3dd74db326b534997fc87cd2ff}{ExtrudedDomain::nmacro\_element}}()}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00123}00123   \{}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00124}00124     \textcolor{comment}{// Return the size of the macro element container}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00125}00125     \textcolor{keywordflow}{return} \mbox{\hyperlink{classoomph_1_1Domain_a3a54693bb493f31acccadc62468dd7ae}{Macro\_element\_pt}}.size();}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00126}00126   \} \textcolor{comment}{// End of nmacro\_element}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00127}00127 }
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00128}00128 }
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00129}00129   \textcolor{comment}{//=================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00130}00130 \textcolor{comment}{  /// Access to i-\/th extruded macro element}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00131}00131 \textcolor{comment}{}  \textcolor{comment}{//=================================================================}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00132}\mbox{\hyperlink{classoomph_1_1ExtrudedDomain_a76a4d16eeb05a2576c74594755d6185c}{00132}}   \mbox{\hyperlink{classoomph_1_1ExtrudedMacroElement}{ExtrudedMacroElement}}* \mbox{\hyperlink{classoomph_1_1ExtrudedDomain_a76a4d16eeb05a2576c74594755d6185c}{ExtrudedDomain::macro\_element\_pt}}(\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\& \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}})}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00133}00133   \{}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00134}00134     \textcolor{comment}{// Return a pointer to the i-\/th macro element in storage}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00135}00135     \textcolor{keywordflow}{return} \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1ExtrudedMacroElement}{ExtrudedMacroElement}}*\textcolor{keyword}{>}(\mbox{\hyperlink{classoomph_1_1Domain_a3a54693bb493f31acccadc62468dd7ae}{Macro\_element\_pt}}[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]);}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00136}00136   \} \textcolor{comment}{// End of macro\_element\_pt}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00137}00137 }
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00138}00138 }
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00139}00139   \textcolor{comment}{//=================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00140}00140 \textcolor{comment}{  /// Vector representation of the i\_macro-\/th macro element}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00141}00141 \textcolor{comment}{  /// boundary i\_direct (e.g. N/S/W/E in 2D spatial = 3D space-\/time).}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00142}00142 \textcolor{comment}{  /// NOTE: Some extra care has to be taken here to translate the}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00143}00143 \textcolor{comment}{  /// OcTree enumeration to the QuadTree enumeration (in the}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00144}00144 \textcolor{comment}{  /// appropriate manner) so that the original Domain object can be}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00145}00145 \textcolor{comment}{  /// used to calculate the global coordinate associated with the}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00146}00146 \textcolor{comment}{  /// provided local coordinates.}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00147}00147 \textcolor{comment}{}  \textcolor{comment}{//=================================================================}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00148}\mbox{\hyperlink{classoomph_1_1ExtrudedDomain_a10a824075e2d2ee6efcf3485966dbadc}{00148}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1ExtrudedDomain_a10a824075e2d2ee6efcf3485966dbadc}{ExtrudedDomain::macro\_element\_boundary}}(\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\& time,}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00149}00149                                               \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\& i\_macro,}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00150}00150                                               \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\& i\_direct,}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00151}00151                                               \textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}}\& \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}},}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00152}00152                                               \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}}\& x)}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00153}00153   \{}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00154}00154     \textcolor{comment}{// Make sure that time=0 otherwise this doesn't make sense}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00155}00155     \textcolor{keywordflow}{if} (time != 0)}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00156}00156     \{}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00157}00157       \textcolor{comment}{// Create an output stream}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00158}00158       std::ostringstream error\_message\_stream;}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00159}00159 }
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00160}00160       \textcolor{comment}{// Create an error message}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00161}00161       error\_message\_stream << \textcolor{stringliteral}{"{}This output function outputs a space-\/time\(\backslash\)n"{}}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00162}00162                            << \textcolor{stringliteral}{"{}representation of the domain. As such, it\(\backslash\)n"{}}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00163}00163                            << \textcolor{stringliteral}{"{}does not make sense to output the domain\(\backslash\)n"{}}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00164}00164                            << \textcolor{stringliteral}{"{}at a previous time level!"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00165}00165 }
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00166}00166       \textcolor{comment}{// Throw an error}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00167}00167       \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(error\_message\_stream.str(),}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00168}00168                           OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00169}00169                           OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00170}00170     \}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00171}00171 }
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00172}00172     \textcolor{comment}{// The number of dimensions}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00173}00173     \textcolor{keywordtype}{unsigned} n\_dim = 3;}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00174}00174 }
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00175}00175     \textcolor{comment}{// The number of macro elements in the original spatial Domain}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00176}00176     \textcolor{keywordtype}{unsigned} n\_macro = \mbox{\hyperlink{classoomph_1_1ExtrudedDomain_abdc23c046616ea3335e9c34b7386d86e}{Domain\_pt}}-\/>\mbox{\hyperlink{classoomph_1_1Domain_a3ed63583615d0e8471d95ba13ccc0aff}{nmacro\_element}}();}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00177}00177 }
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00178}00178     \textcolor{comment}{// Calculate the shifted macro element number (to correspond to the}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00179}00179     \textcolor{comment}{// correct macro element in the original spatial Domain)}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00180}00180     \textcolor{keywordtype}{unsigned} true\_macro\_id = i\_macro \% n\_macro;}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00181}00181 }
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00182}00182     \textcolor{comment}{// Which layer of the extruded domain are we in? Layer 0 corresponds to}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00183}00183     \textcolor{comment}{// elements closest to t=T\_min and the layer N\_extruded\_element-\/1}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00184}00184     \textcolor{comment}{// corresponds to elements closest to t=T\_max}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00185}00185     \textcolor{keywordtype}{unsigned} i\_layer = (i\_macro -\/ true\_macro\_id) / n\_macro;}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00186}00186 }
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00187}00187     \textcolor{comment}{// Calculate the width of an extrusion layer}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00188}00188     \textcolor{keywordtype}{double} layer\_width = (\mbox{\hyperlink{classoomph_1_1ExtrudedDomain_a22bebc406919888b8524f039a8cb784b}{T\_max}} -\/ \mbox{\hyperlink{classoomph_1_1ExtrudedDomain_ada72a38780f4b85e5f9dda48082cf633}{T\_min}}) / \textcolor{keywordtype}{double}(\mbox{\hyperlink{classoomph_1_1ExtrudedDomain_a413f4a9c0ed71a03fbafdc813ee23ddb}{N\_extruded\_element}});}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00189}00189 }
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00190}00190     \textcolor{comment}{// Storage for the global (spatial) coordinates}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00191}00191     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} x\_project(n\_dim -\/ 1, 0.0);}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00192}00192 }
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00193}00193     \textcolor{comment}{// Calculate the time value associated with the start of the i-\/layer-\/th}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00194}00194     \textcolor{comment}{// extrusion layer}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00195}00195     \textcolor{keywordtype}{double} t\_lower = (\mbox{\hyperlink{classoomph_1_1ExtrudedDomain_ada72a38780f4b85e5f9dda48082cf633}{T\_min}} + i\_layer * layer\_width);}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00196}00196 }
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00197}00197     \textcolor{comment}{// Initialise the time value}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00198}00198     \textcolor{keywordtype}{double} \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}} = t\_lower;}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00199}00199 }
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00200}00200     \textcolor{comment}{// If we're on one of the edges (once projected to 2D in the t-\/direction)}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00201}00201     \textcolor{keywordflow}{if} ((i\_direct == \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a56b1e55e65e346693677249c84b86176}{OcTreeNames::L}}) || (i\_direct == \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a5e03c0a30df340df04d44883d52b425d}{OcTreeNames::R}}) ||}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00202}00202         (i\_direct == \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a51292b8e4d96f2bb9f0d6bb0340d1620}{OcTreeNames::D}}) || (i\_direct == \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a9d5dc3f8f9d04ae80237132101f4258f}{OcTreeNames::U}}))}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00203}00203     \{}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00204}00204       \textcolor{comment}{// Update the time value to get the time value associated}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00205}00205       \textcolor{comment}{// with the input surface coordinates}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00206}00206       \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}} += 0.5 * (1.0 + \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[1]) * layer\_width;}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00207}00207 }
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00208}00208       \textcolor{comment}{// Get the local coordinate associated with the surface coordinate}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00209}00209       \textcolor{comment}{// in the projected Domain. This is the first surface coordinate}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00210}00210       \textcolor{comment}{// on the left, right, down and up faces of the 3D macro element.}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00211}00211       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} s\_project(1, \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0]);}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00212}00212 }
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00213}00213       \textcolor{comment}{// If we're on the left face (or the West face once projected to 2D)}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00214}00214       \textcolor{keywordflow}{if} (i\_direct == \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a56b1e55e65e346693677249c84b86176}{OcTreeNames::L}})}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00215}00215       \{}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00216}00216         \textcolor{comment}{// Call the corresponding function through the provided Domain object}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00217}00217         \mbox{\hyperlink{classoomph_1_1ExtrudedDomain_abdc23c046616ea3335e9c34b7386d86e}{Domain\_pt}}-\/>\mbox{\hyperlink{classoomph_1_1Domain_a95f3e00d28ea37e6c4d3027bfac91096}{macro\_element\_boundary}}(}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00218}00218           \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}, true\_macro\_id, \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6}{QuadTreeNames::W}}, s\_project, x\_project);}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00219}00219       \}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00220}00220       \textcolor{comment}{// If we're on the right face (or the East face once projected to 2D)}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00221}00221       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (i\_direct == \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a5e03c0a30df340df04d44883d52b425d}{OcTreeNames::R}})}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00222}00222       \{}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00223}00223         \textcolor{comment}{// Call the corresponding function through the provided Domain object}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00224}00224         \mbox{\hyperlink{classoomph_1_1ExtrudedDomain_abdc23c046616ea3335e9c34b7386d86e}{Domain\_pt}}-\/>\mbox{\hyperlink{classoomph_1_1Domain_a95f3e00d28ea37e6c4d3027bfac91096}{macro\_element\_boundary}}(}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00225}00225           \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}, true\_macro\_id, \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7da585070bd0e3801c3bbed287ef3c4a265}{QuadTreeNames::E}}, s\_project, x\_project);}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00226}00226       \}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00227}00227       \textcolor{comment}{// If we're on the down face (or the South face once projected to 2D)}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00228}00228       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (i\_direct == \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a51292b8e4d96f2bb9f0d6bb0340d1620}{OcTreeNames::D}})}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00229}00229       \{}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00230}00230         \textcolor{comment}{// Call the corresponding function through the provided Domain object}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00231}00231         \mbox{\hyperlink{classoomph_1_1ExtrudedDomain_abdc23c046616ea3335e9c34b7386d86e}{Domain\_pt}}-\/>\mbox{\hyperlink{classoomph_1_1Domain_a95f3e00d28ea37e6c4d3027bfac91096}{macro\_element\_boundary}}(}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00232}00232           \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}, true\_macro\_id, \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7da85b07d6c087e0cb66bac32a0b6a45198}{QuadTreeNames::S}}, s\_project, x\_project);}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00233}00233       \}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00234}00234       \textcolor{comment}{// If we're on the up face (or the North face once projected to 2D)}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00235}00235       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (i\_direct == \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a9d5dc3f8f9d04ae80237132101f4258f}{OcTreeNames::U}})}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00236}00236       \{}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00237}00237         \textcolor{comment}{// Call the corresponding function through the provided Domain object}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00238}00238         \mbox{\hyperlink{classoomph_1_1ExtrudedDomain_abdc23c046616ea3335e9c34b7386d86e}{Domain\_pt}}-\/>\mbox{\hyperlink{classoomph_1_1Domain_a95f3e00d28ea37e6c4d3027bfac91096}{macro\_element\_boundary}}(}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00239}00239           \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}, true\_macro\_id, \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7dabc60bec4cc294aa2adf92726c6d6823a}{QuadTreeNames::N}}, s\_project, x\_project);}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00240}00240       \}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00241}00241     \}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00242}00242     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ((i\_direct == \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a43c804e2bcf9862a4bf629d5f01761e8}{OcTreeNames::B}}) || (i\_direct == \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a755807a4724a0f4d96f0817559c0a927}{OcTreeNames::F}}))}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00243}00243     \{}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00244}00244       \textcolor{comment}{// Grab the i\_macro-\/th macro element from the Domain object}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00245}00245       \mbox{\hyperlink{classoomph_1_1MacroElement}{MacroElement}}* \mbox{\hyperlink{classoomph_1_1ExtrudedDomain_a76a4d16eeb05a2576c74594755d6185c}{macro\_element\_pt}} =}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00246}00246         \mbox{\hyperlink{classoomph_1_1ExtrudedDomain_abdc23c046616ea3335e9c34b7386d86e}{Domain\_pt}}-\/>\mbox{\hyperlink{classoomph_1_1Domain_abef3886384a9b9e722e490268feecc2d}{macro\_element\_pt}}(true\_macro\_id);}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00247}00247 }
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00248}00248       \textcolor{comment}{// If we're on the back face (or the whole element at t=T\_max)}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00249}00249       \textcolor{keywordflow}{if} (i\_direct == \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a43c804e2bcf9862a4bf629d5f01761e8}{OcTreeNames::B}})}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00250}00250       \{}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00251}00251         \textcolor{comment}{// Call the macro\_map function to calculate the global (spatial)}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00252}00252         \textcolor{comment}{// coordinates associated with the given surface coordinates}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00253}00253         \mbox{\hyperlink{classoomph_1_1ExtrudedDomain_a76a4d16eeb05a2576c74594755d6185c}{macro\_element\_pt}}-\/>\mbox{\hyperlink{classoomph_1_1MacroElement_a85e7842ad949bb4062a9ff302fa452e5}{macro\_map}}(\mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}, \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, x\_project);}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00254}00254       \}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00255}00255       \textcolor{comment}{// If we're on the front face (or the whole element at t=T\_max)}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00256}00256       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (i\_direct == \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a755807a4724a0f4d96f0817559c0a927}{OcTreeNames::F}})}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00257}00257       \{}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00258}00258         \textcolor{comment}{// Update the time value to get the time value associated}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00259}00259         \textcolor{comment}{// with the input surface coordinates}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00260}00260         \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}} += layer\_width;}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00261}00261 }
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00262}00262         \textcolor{comment}{// Call the macro\_map function to calculate the global (spatial)}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00263}00263         \textcolor{comment}{// coordinates associated with the given surface coordinates}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00264}00264         \mbox{\hyperlink{classoomph_1_1ExtrudedDomain_a76a4d16eeb05a2576c74594755d6185c}{macro\_element\_pt}}-\/>\mbox{\hyperlink{classoomph_1_1MacroElement_a85e7842ad949bb4062a9ff302fa452e5}{macro\_map}}(\mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}, \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, x\_project);}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00265}00265       \}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00266}00266     \}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00267}00267     \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00268}00268     \{}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00269}00269       \textcolor{comment}{// Create an output stream}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00270}00270       std::ostringstream error\_message\_stream;}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00271}00271 }
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00272}00272       \textcolor{comment}{// Create an error message}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00273}00273       error\_message\_stream << \textcolor{stringliteral}{"{}Incorrect face enumeration input! Should either "{}}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00274}00274                            << \textcolor{stringliteral}{"{}be L,R,D,U,B or F. You input "{}}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00275}00275                            << \mbox{\hyperlink{classoomph_1_1OcTree_a2e9487b716f4d583aada06a850b8eae9}{OcTree::Direct\_string}}[i\_direct] << \textcolor{stringliteral}{"{}!"{}}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00276}00276                            << std::endl;}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00277}00277 }
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00278}00278       \textcolor{comment}{// We should never get here so throw an error if we do}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00279}00279       \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(error\_message\_stream.str(),}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00280}00280                           OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00281}00281                           OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00282}00282     \} \textcolor{comment}{// if ((i\_direct==OcTreeNames::L)||(i\_direct==OcTreeNames::R)||...}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00283}00283 }
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00284}00284     \textcolor{comment}{// Loop over the global (spatial) coordinates}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00285}00285     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < n\_dim -\/ 1; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00286}00286     \{}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00287}00287       \textcolor{comment}{// Copy the global coordinates over}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00288}00288       x[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] = x\_project[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}];}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00289}00289     \}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00290}00290 }
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00291}00291     \textcolor{comment}{// Finally, add in the final coordinate (the time value)}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00292}00292     x[n\_dim -\/ 1] = \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}};}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00293}00293   \} \textcolor{comment}{// End of macro\_element\_boundary}}
\DoxyCodeLine{\Hypertarget{extruded__domain_8cc_source_l00294}00294 \} \textcolor{comment}{// End of namespace oomph}}

\end{DoxyCode}
